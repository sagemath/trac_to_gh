# Issue 22421: Pynac's to_gamma() is buggy

archive/issues_022184.json:
```json
{
    "body": "See https://github.com/pynac/pynac/issues/231\n\nOn some systems (possibly depending on the linker), this doctest fails:\n\n```\nsage -t src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 9627, in sage.symbolic.expression.Expression.to_gamma\nFailed example:\n    binomial(m,n).to_gamma()\nExpected:\n    gamma(m + 1)/(gamma(m - n + 1)*gamma(n + 1))\nGot:\n    binomial(m, n)\n**********************************************************************\n```\n\n**CC:**  @rwst\n\n**Branch/Commit:** [0a733596fab3a285fbded6a02f9e65050a7cc306](https://github.com/sagemath/sagetrac-mirror/commit/0a733596fab3a285fbded6a02f9e65050a7cc306)\n\n**Upstream:** Fixed upstream, but not in a stable release.\n\n**Reviewer:** Jeroen Demeyer\n\n**Author:** Ralf Stephan\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22421\n\n",
    "closed_at": "2017-03-01T18:51:17Z",
    "created_at": "2017-02-23T10:33:06Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Pynac's to_gamma() is buggy",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22421",
    "user": "https://github.com/jdemeyer"
}
```
See https://github.com/pynac/pynac/issues/231

On some systems (possibly depending on the linker), this doctest fails:

```
sage -t src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 9627, in sage.symbolic.expression.Expression.to_gamma
Failed example:
    binomial(m,n).to_gamma()
Expected:
    gamma(m + 1)/(gamma(m - n + 1)*gamma(n + 1))
Got:
    binomial(m, n)
**********************************************************************
```

**CC:**  @rwst

**Branch/Commit:** [0a733596fab3a285fbded6a02f9e65050a7cc306](https://github.com/sagemath/sagetrac-mirror/commit/0a733596fab3a285fbded6a02f9e65050a7cc306)

**Upstream:** Fixed upstream, but not in a stable release.

**Reviewer:** Jeroen Demeyer

**Author:** Ralf Stephan

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/22421





---

archive/issue_comments_418661.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,16 @@\n See https://github.com/pynac/pynac/issues/231\n+\n+On some systems (possibly depending on the linker), this doctest fails:\n+\n+```\n+sage -t src/sage/symbolic/expression.pyx\n+**********************************************************************\n+File \"src/sage/symbolic/expression.pyx\", line 9627, in sage.symbolic.expression.Expression.to_gamma\n+Failed example:\n+    binomial(m,n).to_gamma()\n+Expected:\n+    gamma(m + 1)/(gamma(m - n + 1)*gamma(n + 1))\n+Got:\n+    binomial(m, n)\n+**********************************************************************\n+```\n``````\n",
    "created_at": "2017-02-23T10:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418661",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,16 @@
 See https://github.com/pynac/pynac/issues/231
+
+On some systems (possibly depending on the linker), this doctest fails:
+
+```
+sage -t src/sage/symbolic/expression.pyx
+**********************************************************************
+File "src/sage/symbolic/expression.pyx", line 9627, in sage.symbolic.expression.Expression.to_gamma
+Failed example:
+    binomial(m,n).to_gamma()
+Expected:
+    gamma(m + 1)/(gamma(m - n + 1)*gamma(n + 1))
+Got:
+    binomial(m, n)
+**********************************************************************
+```
``````




---

archive/issue_comments_418662.json:
```json
{
    "body": "<a id='comment:2'></a>\nDo you have an idea how much time you need to fix the problems with #22364? Given that #22364 needs work anyway, it makes sense to fix this ticket there (and close this as duplicate). On the other hand, if you don't manage to fix #22364 quickly, we should fix this ticket first because it gives doctest failures.",
    "created_at": "2017-02-23T16:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418662",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
Do you have an idea how much time you need to fix the problems with #22364? Given that #22364 needs work anyway, it makes sense to fix this ticket there (and close this as duplicate). On the other hand, if you don't manage to fix #22364 quickly, we should fix this ticket first because it gives doctest failures.



---

archive/issue_comments_418663.json:
```json
{
    "body": "**Changing upstream** from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\".",
    "created_at": "2017-02-23T16:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418663",
    "user": "https://github.com/jdemeyer"
}
```

**Changing upstream** from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release.".



---

archive/issue_comments_418664.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [jdemeyer](#comment%3A2):\n> Do you have an idea how much time you need to fix the problems with #22364? Given that #22364 needs work anyway, it makes sense to fix this ticket there (and close this as duplicate). On the other hand, if you don't manage to fix #22364 quickly, we should fix this ticket first because it gives doctest failures.\n\n\nNo idea about the time because the cause of that is not established with certainty. So, as fixing this the usual way would need a new release that includes #22364 it would be best to not do a release but commit a Pynac patch (containing https://github.com/pynac/pynac/commit/a4dce19f33fc52245f324cb535d24233988dcfa1.diff) with this branch.",
    "created_at": "2017-02-24T06:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418664",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'></a>
Replying to [jdemeyer](#comment%3A2):
> Do you have an idea how much time you need to fix the problems with #22364? Given that #22364 needs work anyway, it makes sense to fix this ticket there (and close this as duplicate). On the other hand, if you don't manage to fix #22364 quickly, we should fix this ticket first because it gives doctest failures.


No idea about the time because the cause of that is not established with certainty. So, as fixing this the usual way would need a new release that includes #22364 it would be best to not do a release but commit a Pynac patch (containing https://github.com/pynac/pynac/commit/a4dce19f33fc52245f324cb535d24233988dcfa1.diff) with this branch.



---

archive/issue_comments_418665.json:
```json
{
    "body": "**Branch:** [u/rws/pynac_s_to_gamma___is_buggy](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/pynac_s_to_gamma___is_buggy)",
    "created_at": "2017-02-24T07:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418665",
    "user": "https://github.com/rwst"
}
```

**Branch:** [u/rws/pynac_s_to_gamma___is_buggy](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/pynac_s_to_gamma___is_buggy)



---

archive/issue_comments_418666.json:
```json
{
    "body": "**Commit:** [7cdbdb0144be8c9fb413b1c33571598c5c43562c](https://github.com/sagemath/sagetrac-mirror/commit/7cdbdb0144be8c9fb413b1c33571598c5c43562c)",
    "created_at": "2017-02-24T07:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418666",
    "user": "https://github.com/rwst"
}
```

**Commit:** [7cdbdb0144be8c9fb413b1c33571598c5c43562c](https://github.com/sagemath/sagetrac-mirror/commit/7cdbdb0144be8c9fb413b1c33571598c5c43562c)



---

archive/issue_comments_418667.json:
```json
{
    "body": "<a id='comment:6'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7cdbdb0144be8c9fb413b1c33571598c5c43562c\">7cdbdb0</a></td><td><code>22421: apply commit from (future) Pynac master</code></td></tr></table>\n",
    "created_at": "2017-02-24T07:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418667",
    "user": "https://github.com/rwst"
}
```

<a id='comment:6'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7cdbdb0144be8c9fb413b1c33571598c5c43562c">7cdbdb0</a></td><td><code>22421: apply commit from (future) Pynac master</code></td></tr></table>




---

archive/issue_comments_418668.json:
```json
{
    "body": "**Author:** Ralf Stephan",
    "created_at": "2017-02-24T07:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418668",
    "user": "https://github.com/rwst"
}
```

**Author:** Ralf Stephan



---

archive/issue_comments_418669.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2017-02-24T07:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418669",
    "user": "https://github.com/rwst"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_418670.json:
```json
{
    "body": "<a id='comment:7'></a>\nPatches are automatically applied now, you should not manually run `sage-apply-patches` (so you can remove the whole `patch()` function).",
    "created_at": "2017-02-24T09:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418670",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Patches are automatically applied now, you should not manually run `sage-apply-patches` (so you can remove the whole `patch()` function).



---

archive/issue_comments_418671.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2017-02-24T09:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418671",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_418672.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2017-02-24T09:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418672",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_comments_418673.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a733596fab3a285fbded6a02f9e65050a7cc306\">0a73359</a></td><td><code>22421: clean up spkg-install</code></td></tr></table>\n",
    "created_at": "2017-02-24T13:50:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418673",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a733596fab3a285fbded6a02f9e65050a7cc306">0a73359</a></td><td><code>22421: clean up spkg-install</code></td></tr></table>




---

archive/issue_comments_418674.json:
```json
{
    "body": "**Changing commit** from \"[7cdbdb0144be8c9fb413b1c33571598c5c43562c](https://github.com/sagemath/sagetrac-mirror/commit/7cdbdb0144be8c9fb413b1c33571598c5c43562c)\" to \"[0a733596fab3a285fbded6a02f9e65050a7cc306](https://github.com/sagemath/sagetrac-mirror/commit/0a733596fab3a285fbded6a02f9e65050a7cc306)\".",
    "created_at": "2017-02-24T13:50:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418674",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7cdbdb0144be8c9fb413b1c33571598c5c43562c](https://github.com/sagemath/sagetrac-mirror/commit/7cdbdb0144be8c9fb413b1c33571598c5c43562c)" to "[0a733596fab3a285fbded6a02f9e65050a7cc306](https://github.com/sagemath/sagetrac-mirror/commit/0a733596fab3a285fbded6a02f9e65050a7cc306)".



---

archive/issue_comments_418675.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-02-24T13:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418675",
    "user": "https://github.com/rwst"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_418676.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2017-02-25T07:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418676",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_066726.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-01T18:51:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22421#event-66726"
}
```



---

archive/issue_comments_418677.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2017-03-01T18:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418677",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed



---

archive/issue_comments_418678.json:
```json
{
    "body": "**Changing branch** from \"[u/rws/pynac_s_to_gamma___is_buggy](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/pynac_s_to_gamma___is_buggy)\" to \"[0a733596fab3a285fbded6a02f9e65050a7cc306](https://github.com/sagemath/sagetrac-mirror/commit/0a733596fab3a285fbded6a02f9e65050a7cc306)\".",
    "created_at": "2017-03-01T18:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22421#issuecomment-418678",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/rws/pynac_s_to_gamma___is_buggy](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/pynac_s_to_gamma___is_buggy)" to "[0a733596fab3a285fbded6a02f9e65050a7cc306](https://github.com/sagemath/sagetrac-mirror/commit/0a733596fab3a285fbded6a02f9e65050a7cc306)".
