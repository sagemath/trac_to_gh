# Issue 22280: Giac miscompiles on non-x86_64 platforms

archive/issues_022043.json:
```json
{
    "assignees": [],
    "body": "Executing `1+1` with giac-1.2.2.103 on ppc64le POWER8:\n\n```\n0>> 1+1;\n[New Thread 0x3fff7443f180 (LWP 173710)]\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x3fff7443f180 (LWP 173710)]\n0x00003fffb7b9e544 in giac::gen::in_eval (this=0x3fff7443e768, level=25, evaled=..., contextptr=0x3fffffffda40) at gen.cc:2109\n2109              evaled=(*_SYMBptr->sommet.ptr())(evaled,contextptr);\n(gdb) bt\n#0  0x00003fffb7b9e544 in giac::gen::in_eval (this=0x3fff7443e768, level=25, evaled=..., contextptr=0x3fffffffda40) at gen.cc:2109\n#1  0x00003fffb7b9bcdc in giac::gen::eval (this=0x3fff7443e768, level=25, contextptr=0x3fffffffda40) at gen.cc:1899\n#2  0x00003fffb789e6ac in giac::protecteval (g=..., level=25, contextptr=0x3fffffffda40) at prog.cc:6881\n#3  0x00003fffb767ff44 in giac::in_thread_eval (arg=0x100a9cd8) at global.cc:3463\n#4  0x00003fffb5b18070 in start_thread () from /lib/powerpc64le-linux-gnu/libpthread.so.0\n#5  0x00003fffb5763230 in clone () from /lib/powerpc64le-linux-gnu/libc.so.6\n(gdb) list\n2104              evaled=_SYMBptr->feuille;\n2105            }\n2106            if (is_ifte)\n2107              evaled=ifte(evaled,true,contextptr);\n2108            else\n2109              evaled=(*_SYMBptr->sommet.ptr())(evaled,contextptr);\n2110            elevel=slevel;\n2111          }\n2112          else\n2113            evaled=_SYMBptr->eval(level,contextptr);\n```\n\nUpgrading to giac-1.2.3.25 (#22101) does **not** fix this problem.\n\n---\n\nUse > -45 version:\nThe upstream tarball is at http://www-fourier.ujf-grenoble.fr/~parisse/debian/dists/stable/main/source/giac_1.2.3-47.tar.gz\nRepackaged tarball is at:\n* http://perso.telecom-paristech.fr/~flori/giac-1.2.3.47.tar.bz2\nAnd pass `-Dx86_64` in CPPFLAGS.\n\nDepends on #22101\n\nCC:  @rwst @frederichan-IMJPRG @vbraun\n\nBranch: **[8dc4c88](https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **Thierry Monteil, Jean-Pierre Flori, Fran\u00e7ois Bissey**\n\nAuthor: **Jean-Pierre Flori**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22280_\n\n",
    "closed_at": "2017-06-22T07:24:57Z",
    "created_at": "2017-01-31T14:41:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Giac miscompiles on non-x86_64 platforms",
    "type": "issue",
    "updated_at": "2017-07-19T12:14:23Z",
    "url": "https://github.com/sagemath/sage/issues/22280",
    "user": "https://github.com/jpflori"
}
```
Executing `1+1` with giac-1.2.2.103 on ppc64le POWER8:

```
0>> 1+1;
[New Thread 0x3fff7443f180 (LWP 173710)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x3fff7443f180 (LWP 173710)]
0x00003fffb7b9e544 in giac::gen::in_eval (this=0x3fff7443e768, level=25, evaled=..., contextptr=0x3fffffffda40) at gen.cc:2109
2109              evaled=(*_SYMBptr->sommet.ptr())(evaled,contextptr);
(gdb) bt
#0  0x00003fffb7b9e544 in giac::gen::in_eval (this=0x3fff7443e768, level=25, evaled=..., contextptr=0x3fffffffda40) at gen.cc:2109
#1  0x00003fffb7b9bcdc in giac::gen::eval (this=0x3fff7443e768, level=25, contextptr=0x3fffffffda40) at gen.cc:1899
#2  0x00003fffb789e6ac in giac::protecteval (g=..., level=25, contextptr=0x3fffffffda40) at prog.cc:6881
#3  0x00003fffb767ff44 in giac::in_thread_eval (arg=0x100a9cd8) at global.cc:3463
#4  0x00003fffb5b18070 in start_thread () from /lib/powerpc64le-linux-gnu/libpthread.so.0
#5  0x00003fffb5763230 in clone () from /lib/powerpc64le-linux-gnu/libc.so.6
(gdb) list
2104              evaled=_SYMBptr->feuille;
2105            }
2106            if (is_ifte)
2107              evaled=ifte(evaled,true,contextptr);
2108            else
2109              evaled=(*_SYMBptr->sommet.ptr())(evaled,contextptr);
2110            elevel=slevel;
2111          }
2112          else
2113            evaled=_SYMBptr->eval(level,contextptr);
```

Upgrading to giac-1.2.3.25 (#22101) does **not** fix this problem.

---

Use > -45 version:
The upstream tarball is at http://www-fourier.ujf-grenoble.fr/~parisse/debian/dists/stable/main/source/giac_1.2.3-47.tar.gz
Repackaged tarball is at:
* http://perso.telecom-paristech.fr/~flori/giac-1.2.3.47.tar.bz2
And pass `-Dx86_64` in CPPFLAGS.

Depends on #22101

CC:  @rwst @frederichan-IMJPRG @vbraun

Branch: **[8dc4c88](https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **Thierry Monteil, Jean-Pierre Flori, Fran√ßois Bissey**

Author: **Jean-Pierre Flori**

_Issue created by migration from https://trac.sagemath.org/ticket/22280_





---

archive/issue_events_293865.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2017-01-31T14:41:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293865"
}
```



---

archive/issue_events_293866.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2017-01-31T14:41:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293866"
}
```



---

archive/issue_events_293867.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2017-01-31T14:41:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293867"
}
```



---

archive/issue_events_293868.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2017-01-31T14:41:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293868"
}
```



---

archive/issue_comments_331950.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nI can confirm the issue. The trick fells very dirty but I can easily test it I think.",
    "created_at": "2017-02-01T00:12:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331950",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:1" align="right">Comment 1</div>

I can confirm the issue. The trick fells very dirty but I can easily test it I think.



---

archive/issue_comments_331951.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nHas expected passing `-D__x86_64__ -DSMARTPTR64` choke the build. Fails as soon as we load gmp headers which complain about the ABI being unsupported.\nNow by default the thing builds but fails in calling `pari`. We could temporarily disable building against `pari` on non x86 (`--disable-pari` in giac-1.2.3-13).\n\nMore fundamentally I suspect the way pari is called is what is really wrong here, as discussed on sage-packaging   https://groups.google.com/d/msgid/sage-packaging/ac9575ae-4dd3-4d29-97aa-a3ef785d3509%40googlegroups.com",
    "created_at": "2017-02-01T01:00:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331951",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:2" align="right">Comment 2</div>

Has expected passing `-D__x86_64__ -DSMARTPTR64` choke the build. Fails as soon as we load gmp headers which complain about the ABI being unsupported.
Now by default the thing builds but fails in calling `pari`. We could temporarily disable building against `pari` on non x86 (`--disable-pari` in giac-1.2.3-13).

More fundamentally I suspect the way pari is called is what is really wrong here, as discussed on sage-packaging   https://groups.google.com/d/msgid/sage-packaging/ac9575ae-4dd3-4d29-97aa-a3ef785d3509%40googlegroups.com



---

archive/issue_comments_331952.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,2 @@\n-One can maybe cheat and pass  \"-D__x86_64__ -DSMARTPTR64\" in CPPFLAGS but that's dirty, see:\n+One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:\n * http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=19&t=1723\n``````\n",
    "created_at": "2017-02-01T01:00:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331952",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,2 @@
-One can maybe cheat and pass  "-D__x86_64__ -DSMARTPTR64" in CPPFLAGS but that's dirty, see:
+One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:
 * http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=19&t=1723
``````




---

archive/issue_comments_331953.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nI don't know if it helps but the 1.2.3.25 version such as in #22101 contains the modifications for pari asked there:\n\nhttp://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1776",
    "created_at": "2017-02-13T20:31:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331953",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:3" align="right">Comment 3</div>

I don't know if it helps but the 1.2.3.25 version such as in #22101 contains the modifications for pari asked there:

http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1776



---

archive/issue_comments_331954.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nStill failing. Those changes are, I think are a progress but not the full changes that are needed - not that I would really be able to do them myself. The fact that we still have\n\n```\n#ifdef ENABLE_TLS\n  extern THREAD void *PARI_stack_limit;\n#else\n   extern void *PARI_stack_limit;\n#endif\n```\nwhich is a private function is a sign you are doing something wrong.",
    "created_at": "2017-02-16T10:22:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331954",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:4" align="right">Comment 4</div>

Still failing. Those changes are, I think are a progress but not the full changes that are needed - not that I would really be able to do them myself. The fact that we still have

```
#ifdef ENABLE_TLS
  extern THREAD void *PARI_stack_limit;
#else
   extern void *PARI_stack_limit;
#endif
```
which is a private function is a sign you are doing something wrong.



---

archive/issue_comments_331955.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nSee http://pari.math.u-bordeaux.fr/archives/pari-users-1702/msg00002.html for a suggestion from the PARI developers on how this should be fixed.",
    "created_at": "2017-02-16T10:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331955",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">Comment 5</div>

See http://pari.math.u-bordeaux.fr/archives/pari-users-1702/msg00002.html for a suggestion from the PARI developers on how this should be fixed.



---

archive/issue_comments_331956.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,34 @@\n+Executing `1+1` with giac-1.2.2.103 on ppc64le POWER8:\n+\n+```\n+0>> 1+1;\n+[New Thread 0x3fff7443f180 (LWP 173710)]\n+\n+Program received signal SIGSEGV, Segmentation fault.\n+[Switching to Thread 0x3fff7443f180 (LWP 173710)]\n+0x00003fffb7b9e544 in giac::gen::in_eval (this=0x3fff7443e768, level=25, evaled=..., contextptr=0x3fffffffda40) at gen.cc:2109\n+2109              evaled=(*_SYMBptr->sommet.ptr())(evaled,contextptr);\n+(gdb) bt\n+#0  0x00003fffb7b9e544 in giac::gen::in_eval (this=0x3fff7443e768, level=25, evaled=..., contextptr=0x3fffffffda40) at gen.cc:2109\n+#1  0x00003fffb7b9bcdc in giac::gen::eval (this=0x3fff7443e768, level=25, contextptr=0x3fffffffda40) at gen.cc:1899\n+#2  0x00003fffb789e6ac in giac::protecteval (g=..., level=25, contextptr=0x3fffffffda40) at prog.cc:6881\n+#3  0x00003fffb767ff44 in giac::in_thread_eval (arg=0x100a9cd8) at global.cc:3463\n+#4  0x00003fffb5b18070 in start_thread () from /lib/powerpc64le-linux-gnu/libpthread.so.0\n+#5  0x00003fffb5763230 in clone () from /lib/powerpc64le-linux-gnu/libc.so.6\n+(gdb) list\n+2104              evaled=_SYMBptr->feuille;\n+2105            }\n+2106            if (is_ifte)\n+2107              evaled=ifte(evaled,true,contextptr);\n+2108            else\n+2109              evaled=(*_SYMBptr->sommet.ptr())(evaled,contextptr);\n+2110            elevel=slevel;\n+2111          }\n+2112          else\n+2113            evaled=_SYMBptr->eval(level,contextptr);\n+```\n+\n+---\n+\n One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:\n * http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=19&t=1723\n``````\n",
    "created_at": "2017-02-19T10:45:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331956",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,34 @@
+Executing `1+1` with giac-1.2.2.103 on ppc64le POWER8:
+
+```
+0>> 1+1;
+[New Thread 0x3fff7443f180 (LWP 173710)]
+
+Program received signal SIGSEGV, Segmentation fault.
+[Switching to Thread 0x3fff7443f180 (LWP 173710)]
+0x00003fffb7b9e544 in giac::gen::in_eval (this=0x3fff7443e768, level=25, evaled=..., contextptr=0x3fffffffda40) at gen.cc:2109
+2109              evaled=(*_SYMBptr->sommet.ptr())(evaled,contextptr);
+(gdb) bt
+#0  0x00003fffb7b9e544 in giac::gen::in_eval (this=0x3fff7443e768, level=25, evaled=..., contextptr=0x3fffffffda40) at gen.cc:2109
+#1  0x00003fffb7b9bcdc in giac::gen::eval (this=0x3fff7443e768, level=25, contextptr=0x3fffffffda40) at gen.cc:1899
+#2  0x00003fffb789e6ac in giac::protecteval (g=..., level=25, contextptr=0x3fffffffda40) at prog.cc:6881
+#3  0x00003fffb767ff44 in giac::in_thread_eval (arg=0x100a9cd8) at global.cc:3463
+#4  0x00003fffb5b18070 in start_thread () from /lib/powerpc64le-linux-gnu/libpthread.so.0
+#5  0x00003fffb5763230 in clone () from /lib/powerpc64le-linux-gnu/libc.so.6
+(gdb) list
+2104              evaled=_SYMBptr->feuille;
+2105            }
+2106            if (is_ifte)
+2107              evaled=ifte(evaled,true,contextptr);
+2108            else
+2109              evaled=(*_SYMBptr->sommet.ptr())(evaled,contextptr);
+2110            elevel=slevel;
+2111          }
+2112          else
+2113            evaled=_SYMBptr->eval(level,contextptr);
+```
+
+---
+
 One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:
 * http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=19&t=1723
``````




---

archive/issue_comments_331957.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\n(1) What does this refer to:\n\n> One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:\n> * http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=19&t=1723\n\n(2) From the comments it seems that you think that there is a problem with PARI. Why do you think that?",
    "created_at": "2017-02-19T10:45:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331957",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">Comment 6</div>

(1) What does this refer to:

> One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:
> * http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=19&t=1723

(2) From the comments it seems that you think that there is a problem with PARI. Why do you think that?



---

archive/issue_comments_331958.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,6 +28,8 @@\n 2113            evaled=_SYMBptr->eval(level,contextptr);\n ```\n \n+Upgrading to giac-1.2.3.25 (#22101) does **not** fix this problem.\n+\n ---\n \n One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:\n``````\n",
    "created_at": "2017-02-19T10:46:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331958",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,6 +28,8 @@
 2113            evaled=_SYMBptr->eval(level,contextptr);
 ```
 
+Upgrading to giac-1.2.3.25 (#22101) does **not** fix this problem.
+
 ---
 
 One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:
``````




---

archive/issue_comments_331959.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nNote that compiling with `-D__x86_64__` obviously does not work due to the use of inline assembly in `ifactor.cc`.",
    "created_at": "2017-02-19T11:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331959",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">Comment 8</div>

Note that compiling with `-D__x86_64__` obviously does not work due to the use of inline assembly in `ifactor.cc`.



---

archive/issue_comments_331960.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nAnd compiling with `-DSMARTPTR64` (whatever that means) does not change anything.",
    "created_at": "2017-02-19T11:25:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331960",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">Comment 9</div>

And compiling with `-DSMARTPTR64` (whatever that means) does not change anything.



---

archive/issue_comments_331961.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nThere is a related topic (about SMARTPTR64 that should not be undefined by first.h)here:\nhttp://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1785",
    "created_at": "2017-02-28T12:16:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331961",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:10" align="right">Comment 10</div>

There is a related topic (about SMARTPTR64 that should not be undefined by first.h)here:
http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1785



---

archive/issue_comments_331962.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI am not sure if it is the same error, but i cannot build+check `giac` on Debian Jessie 32bits, see the attached log. It fails at `chk_fhan1` and before there are tons of \"bug in PARI/GP (Segmentation Fault), please report.\"\n\nSince `giac` is a standard package, i set the priority to blocker.",
    "created_at": "2017-03-13T11:36:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331962",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:11" align="right">Comment 11</div>

I am not sure if it is the same error, but i cannot build+check `giac` on Debian Jessie 32bits, see the attached log. It fails at `chk_fhan1` and before there are tons of "bug in PARI/GP (Segmentation Fault), please report."

Since `giac` is a standard package, i set the priority to blocker.



---

archive/issue_events_293869.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2017-03-13T11:36:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293869"
}
```



---

archive/issue_events_293870.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2017-03-13T11:36:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293870"
}
```



---

archive/issue_comments_331963.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nAttachment: **[giac-1.2.2.103.log.7.6.rc0.gz](https://github.com/sagemath/sage/files/ticket22280/giac-1.2.2.103.log.7.6.rc0.gz)**\n\nReplying to [@sagetrac-tmonteil](#comment%3A11):\n> I am not sure if it is the same error, but i cannot build+check `giac` on Debian Jessie 32bits, see the attached log. It fails at `chk_fhan1` and before there are tons of \"bug in PARI/GP (Segmentation Fault), please report.\"\n> \n> Since `giac` is a standard package, i set the priority to blocker.\n> \n\nOn linux 32bits there is the following problem  #22101 and it should be already solved by giac-1.2.3.25 but I am waiting the next one to have a new config.guess as it was requested in #22101.",
    "created_at": "2017-03-13T11:55:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331963",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:12" align="right">Comment 12</div>

Attachment: **[giac-1.2.2.103.log.7.6.rc0.gz](https://github.com/sagemath/sage/files/ticket22280/giac-1.2.2.103.log.7.6.rc0.gz)**

Replying to [@sagetrac-tmonteil](#comment%3A11):
> I am not sure if it is the same error, but i cannot build+check `giac` on Debian Jessie 32bits, see the attached log. It fails at `chk_fhan1` and before there are tons of "bug in PARI/GP (Segmentation Fault), please report."
> 
> Since `giac` is a standard package, i set the priority to blocker.
> 

On linux 32bits there is the following problem  #22101 and it should be already solved by giac-1.2.3.25 but I am waiting the next one to have a new config.guess as it was requested in #22101.



---

archive/issue_comments_331964.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nUnless something happens real soon I'll ignore this for sage 7.6. If it isn't fixed we should think about downgrading giac to optional.\n\nThe snippet in the description is hopefully not repesentative of the giac code quality:\n* Randomly mixed French / English names for identifiers.\n* Use of reserved identifiers (starts with leading underscore + capital letter)",
    "created_at": "2017-03-15T19:18:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331964",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">Comment 13</div>

Unless something happens real soon I'll ignore this for sage 7.6. If it isn't fixed we should think about downgrading giac to optional.

The snippet in the description is hopefully not repesentative of the giac code quality:
* Randomly mixed French / English names for identifiers.
* Use of reserved identifiers (starts with leading underscore + capital letter)



---

archive/issue_comments_331965.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nIf the upgrade can not be done soon (i hope it could!), another possibility would be to downgrade `giac/giacpy_sage` to a previously working version. Indeed, `pynac` is standard and depends on `giac`.",
    "created_at": "2017-03-16T09:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331965",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:14" align="right">Comment 14</div>

If the upgrade can not be done soon (i hope it could!), another possibility would be to downgrade `giac/giacpy_sage` to a previously working version. Indeed, `pynac` is standard and depends on `giac`.



---

archive/issue_comments_331966.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A14):\n> If the upgrade can not be done soon (i hope it could!), another possibility would be to downgrade `giac/giacpy_sage` to a previously working version. Indeed, `pynac` is standard and depends on `giac`.\n\n`pynac` doesn't currently depend on `giac`. Ralf wants it to happen, but things keep getting in the way. Enabling giac in pynac will cause at least two doctests to fail.",
    "created_at": "2017-03-16T09:32:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331966",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">Comment 15</div>

Replying to [@sagetrac-tmonteil](#comment%3A14):
> If the upgrade can not be done soon (i hope it could!), another possibility would be to downgrade `giac/giacpy_sage` to a previously working version. Indeed, `pynac` is standard and depends on `giac`.

`pynac` doesn't currently depend on `giac`. Ralf wants it to happen, but things keep getting in the way. Enabling giac in pynac will cause at least two doctests to fail.



---

archive/issue_comments_331967.json:
```json
{
    "body": "Dependencies: **#22101**",
    "created_at": "2017-03-16T16:47:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331967",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Dependencies: **#22101**



---

archive/issue_comments_331968.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nIf people running powerpc and other platforms coudl check #22101, it seems to solve the issue.",
    "created_at": "2017-03-16T16:48:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331968",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:17" align="right">Comment 17</div>

If people running powerpc and other platforms coudl check #22101, it seems to solve the issue.



---

archive/issue_comments_331969.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nTrying it on ppc64.",
    "created_at": "2017-03-16T16:50:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331969",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:18" align="right">Comment 18</div>

Trying it on ppc64.



---

archive/issue_comments_331970.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A17):\n> If people running powerpc and other platforms coudl check #22101, it seems to solve the issue.\n\nReally? I thought it was only improving for i386. (cf comment4)\nThe only (small) news I have for other architecture are about \narm64 from this topic:\nhttp://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1785\n\nwhere it seems that the static built of icas is functionnal while the original built crashes with 1+1",
    "created_at": "2017-03-16T18:32:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331970",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:19" align="right">Comment 19</div>

Replying to [@sagetrac-tmonteil](#comment%3A17):
> If people running powerpc and other platforms coudl check #22101, it seems to solve the issue.

Really? I thought it was only improving for i386. (cf comment4)
The only (small) news I have for other architecture are about 
arm64 from this topic:
http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1785

where it seems that the static built of icas is functionnal while the original built crashes with 1+1



---

archive/issue_comments_331971.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nI can confirm nothing changed on ppc64.",
    "created_at": "2017-03-16T19:52:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331971",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:20" align="right">Comment 20</div>

I can confirm nothing changed on ppc64.



---

archive/issue_comments_331972.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nI think `SMARTPTR64` is unrelated to our problems. It is added in some pre-made makefile, some of them for the debian package specifically. But there is no way I can see for it to make its way in the build system on a regular build - any system. Same story for `DOUBLEVAL` but this time with windows and OS X - it could be of interest since on OS X it included ppc.",
    "created_at": "2017-03-16T21:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331972",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:21" align="right">Comment 21</div>

I think `SMARTPTR64` is unrelated to our problems. It is added in some pre-made makefile, some of them for the debian package specifically. But there is no way I can see for it to make its way in the build system on a regular build - any system. Same story for `DOUBLEVAL` but this time with windows and OS X - it could be of interest since on OS X it included ppc.



---

archive/issue_comments_331973.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\ndoes\n\n```\n./configure --enable-shared=no\n```\nchanges things?",
    "created_at": "2017-03-16T21:26:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331973",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:22" align="right">Comment 22</div>

does

```
./configure --enable-shared=no
```
changes things?



---

archive/issue_comments_331974.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nI cannot test right now - I am waiting for a world update to finish on the machine (this is a gentoo prefix, everything is compiled) but I am putting it on the things to try.",
    "created_at": "2017-03-16T21:30:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331974",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">Comment 23</div>

I cannot test right now - I am waiting for a world update to finish on the machine (this is a gentoo prefix, everything is compiled) but I am putting it on the things to try.



---

archive/issue_comments_331975.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nReplying to [@frederichan-IMJPRG](#comment%3A19):\n> Replying to [@sagetrac-tmonteil](#comment%3A17):\n> > If people running powerpc and other platforms coudl check #22101, it seems to solve the issue.\n\n> Really? I thought it was only improving for i386. (cf comment4)\n\nSorry, i meant it solves the issue on i386.",
    "created_at": "2017-03-17T08:48:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331975",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:24" align="right">Comment 24</div>

Replying to [@frederichan-IMJPRG](#comment%3A19):
> Replying to [@sagetrac-tmonteil](#comment%3A17):
> > If people running powerpc and other platforms coudl check #22101, it seems to solve the issue.

> Really? I thought it was only improving for i386. (cf comment4)

Sorry, i meant it solves the issue on i386.



---

archive/issue_comments_331976.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nCurrently for me every single tests fails (but I can do 1+1) on ppc64. Trying to run a test manually I get the following back trace which is slightly different from Jeroen\n\n```\n#7480 <signal handler called>\n#7481 0x00000400020258e0 in ?? () from /shared/work_no_backup/ppc64-prefix/usr/lib64/libpari-gmp-2.8.so.0\n#7482 0x00000400020258b0 in ?? () from /shared/work_no_backup/ppc64-prefix/usr/lib64/libpari-gmp-2.8.so.0\n#7483 0x00000400020274f8 in .pari_err () from /shared/work_no_backup/ppc64-prefix/usr/lib64/libpari-gmp-2.8.so.0\n#7484 0x0000040002028290 in .pari_sighandler () from /shared/work_no_backup/ppc64-prefix/usr/lib64/libpari-gmp-2.8.so.0\n#7485 <signal handler called>\n#7486 0x00000400005565ec in .std::vector<char const*, std::allocator<char const*> >::_M_insert_aux(__gnu_cxx::__normal_iterator<char const**, std::vector<char const*, std::allocator<char const*> > >, char const* const&) () from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0\n#7487 0x00000400005550bc in .giac::symbolic::eval(int, giac::context const*) const () from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0\n#7488 0x0000040000c8e158 in .giac::gen::in_eval(int, giac::gen&, giac::context const*) const ()\n   from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0\n#7489 0x0000040000c8fb58 in .giac::gen::eval(int, giac::context const*) const () from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0\n#7490 0x0000040000a35074 in .giac::protecteval(giac::gen const&, int, giac::context const*) ()\n   from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0\n#7491 0x000004000083d654 in .giac::in_thread_eval(void*) () from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0\n#7492 0x0000040002bbbb10 in .start_thread () from /shared/work_no_backup/ppc64-prefix/lib64/libpthread.so.0\n#7493 0x000004000170b268 in .__clone () from /shared/work_no_backup/ppc64-prefix/lib64/libc.so.6\n```\nI have cut all the extra repetition of the pari signal handler. This is 1.2.2-105, with 1.2.3 compiled \"statically\" (same \"test case\"):\n\n```\n#0  0x000000001029321c in .std::vector<char const*, std::allocator<char const*> >::_M_insert_aux(__gnu_cxx::__normal_iterator<char const**, std::vector<char const*, std::allocator<char const*> > >, char const* const&) ()\n#1  0x0000000010291eec in .giac::symbolic::eval(int, giac::context const*) const ()\n#2  0x000000001098e0c0 in .giac::gen::in_eval(int, giac::gen&, giac::context const*) const ()\n#3  0x0000000010291b64 in .giac::symbolic::eval(int, giac::context const*) const ()\n#4  0x000000001098e0c0 in .giac::gen::in_eval(int, giac::gen&, giac::context const*) const ()\n#5  0x000000001098f570 in .giac::gen::eval(int, giac::context const*) const ()\n#6  0x000000001070fe14 in .giac::protecteval(giac::gen const&, int, giac::context const*) ()\n#7  0x0000000010568324 in .giac::in_thread_eval(void*) ()\n#8  0x00000400017fbb10 in .start_thread () from /shared/work_no_backup/ppc64-prefix/lib64/libpthread.so.0\n#9  0x0000040001f0b268 in .__clone () from /shared/work_no_backup/ppc64-prefix/lib64/libc.so.6\n```",
    "created_at": "2017-03-20T04:20:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331976",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">Comment 25</div>

Currently for me every single tests fails (but I can do 1+1) on ppc64. Trying to run a test manually I get the following back trace which is slightly different from Jeroen

```
#7480 <signal handler called>
#7481 0x00000400020258e0 in ?? () from /shared/work_no_backup/ppc64-prefix/usr/lib64/libpari-gmp-2.8.so.0
#7482 0x00000400020258b0 in ?? () from /shared/work_no_backup/ppc64-prefix/usr/lib64/libpari-gmp-2.8.so.0
#7483 0x00000400020274f8 in .pari_err () from /shared/work_no_backup/ppc64-prefix/usr/lib64/libpari-gmp-2.8.so.0
#7484 0x0000040002028290 in .pari_sighandler () from /shared/work_no_backup/ppc64-prefix/usr/lib64/libpari-gmp-2.8.so.0
#7485 <signal handler called>
#7486 0x00000400005565ec in .std::vector<char const*, std::allocator<char const*> >::_M_insert_aux(__gnu_cxx::__normal_iterator<char const**, std::vector<char const*, std::allocator<char const*> > >, char const* const&) () from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0
#7487 0x00000400005550bc in .giac::symbolic::eval(int, giac::context const*) const () from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0
#7488 0x0000040000c8e158 in .giac::gen::in_eval(int, giac::gen&, giac::context const*) const ()
   from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0
#7489 0x0000040000c8fb58 in .giac::gen::eval(int, giac::context const*) const () from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0
#7490 0x0000040000a35074 in .giac::protecteval(giac::gen const&, int, giac::context const*) ()
   from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0
#7491 0x000004000083d654 in .giac::in_thread_eval(void*) () from /dev/shm/portage/sci-mathematics/giac-1.2.2.105/work/giac-1.2.2/src/.libs/libgiac.so.0
#7492 0x0000040002bbbb10 in .start_thread () from /shared/work_no_backup/ppc64-prefix/lib64/libpthread.so.0
#7493 0x000004000170b268 in .__clone () from /shared/work_no_backup/ppc64-prefix/lib64/libc.so.6
```
I have cut all the extra repetition of the pari signal handler. This is 1.2.2-105, with 1.2.3 compiled "statically" (same "test case"):

```
#0  0x000000001029321c in .std::vector<char const*, std::allocator<char const*> >::_M_insert_aux(__gnu_cxx::__normal_iterator<char const**, std::vector<char const*, std::allocator<char const*> > >, char const* const&) ()
#1  0x0000000010291eec in .giac::symbolic::eval(int, giac::context const*) const ()
#2  0x000000001098e0c0 in .giac::gen::in_eval(int, giac::gen&, giac::context const*) const ()
#3  0x0000000010291b64 in .giac::symbolic::eval(int, giac::context const*) const ()
#4  0x000000001098e0c0 in .giac::gen::in_eval(int, giac::gen&, giac::context const*) const ()
#5  0x000000001098f570 in .giac::gen::eval(int, giac::context const*) const ()
#6  0x000000001070fe14 in .giac::protecteval(giac::gen const&, int, giac::context const*) ()
#7  0x0000000010568324 in .giac::in_thread_eval(void*) ()
#8  0x00000400017fbb10 in .start_thread () from /shared/work_no_backup/ppc64-prefix/lib64/libpthread.so.0
#9  0x0000040001f0b268 in .__clone () from /shared/work_no_backup/ppc64-prefix/lib64/libc.so.6
```



---

archive/issue_comments_331977.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\n(Sorry just small news)\nI have tried with qemu on the following:\n\n```\nLinux debianppc64 3.16.0-4-powerpc64le #1 SMP Debian 3.16.39-1+deb8u2 (2017-03-07) ppc64le GNU/Linux\n```\nto build giac on a basic debian (stable) system with just libgmp-dev and libmpfr-dev.\n\nWith the defaut compiler (gcc 4.9) I was able to built giac 1.2.3-31 and reproduce crashes with\n1+1  or also  just by evaluating: e     (it should answer exp(1))\n\ntrying with e it seems that the string giving the name of a fonction was not correctly stored.\n\n```\n(gdb) p sommet.ptr()\n$12 = (giac::unary_function_abstract *) 0xb7f71ee0\n(gdb) p sommet.ptr()->s\nCannot access memory at address 0xb7f71ee8\n```\n\nNB: as I am under qemu I have 1cpu and my threads value was 1. (yours may differ, I don't know if you are able to do: threads:=1)\n\n\n\nThen I tried to built with gcc 4.8 and I got a good version of giac.",
    "created_at": "2017-03-24T13:42:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331977",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:26" align="right">Comment 26</div>

(Sorry just small news)
I have tried with qemu on the following:

```
Linux debianppc64 3.16.0-4-powerpc64le #1 SMP Debian 3.16.39-1+deb8u2 (2017-03-07) ppc64le GNU/Linux
```
to build giac on a basic debian (stable) system with just libgmp-dev and libmpfr-dev.

With the defaut compiler (gcc 4.9) I was able to built giac 1.2.3-31 and reproduce crashes with
1+1  or also  just by evaluating: e     (it should answer exp(1))

trying with e it seems that the string giving the name of a fonction was not correctly stored.

```
(gdb) p sommet.ptr()
$12 = (giac::unary_function_abstract *) 0xb7f71ee0
(gdb) p sommet.ptr()->s
Cannot access memory at address 0xb7f71ee8
```

NB: as I am under qemu I have 1cpu and my threads value was 1. (yours may differ, I don't know if you are able to do: threads:=1)



Then I tried to built with gcc 4.8 and I got a good version of giac.



---

archive/issue_events_293871.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2017-04-14T16:27:08Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293871"
}
```



---

archive/issue_events_293872.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2017-04-14T16:27:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293872"
}
```



---

archive/issue_comments_331978.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nMy latest experiment on ppc64 build with `-O0 -ggdb`, pari and ntl disabled to simplify things and rule them out.\n\n```\n#0  0x0000040000b1a068 in giac::add_print_symbolic (s=..., g=..., contextptr=0xffff075a590) at symbolic.cc:483\n483         if ( g.sommet.ptr()->printsommet && g.sommet!=at_plus && g.sommet!=at_prod && g.sommet!=at_pow){\n[Current thread is 1 (Thread 0x4000004d460 (LWP 13277))]\n(gdb) bt\n#0  0x0000040000b1a068 in giac::add_print_symbolic (s=\"\", g=..., contextptr=0xffff075a590) at symbolic.cc:483\n#1  0x0000040000b1b18c in giac::symbolic::print[abi:cxx11](giac::context const*) const (this=0x10094d18, contextptr=0xffff075a590) at symbolic.cc:599\n#2  0x00000400013ea160 in giac::gen::print[abi:cxx11](giac::context const*) const (this=0xffff0743918, contextptr=0xffff075a590) at gen.cc:12815\n#3  0x00000400013069d4 in giac::warn_implicit (a=..., b=..., contextptr=0xffff075a590) at usual.cc:4950\n#4  0x0000040001306cbc in giac::check_symb_of (a=..., b0=..., contextptr=0xffff075a590) at usual.cc:4960\n#5  0x0000040000afed78 in giac::giac_yyparse (scanner=0x1008bdd0) at input_parser.yy:232\n#6  0x00000400013d7784 in giac::try_parse (\n    s=\" restart;maple_mode(1);cas_setup(0,0,0,1,0,1e-10,10,[1,50,0,25],0,0,0); #radians,pas de cmplx, pas de  Sqrt\\n/* astuces, a retenir: sous xcas on utilise unapply qui est en general plus sur\\243que la metho\"..., contextptr=0xffff075a590) at gen.cc:11074\n#7  0x00000400013d9284 in giac::protected_giac_yyparse (\n    chaine=\" restart;maple_mode(1);cas_setup(0,0,0,1,0,1e-10,10,[1,50,0,25],0,0,0); #radians,pas de cmplx, pas de  Sqrt\\n/* astuces, a retenir: sous xcas on utilise unapply qui est en general plus sur\\243que la metho\"..., parse_result=..., contextptr=0xffff075a590) at gen.cc:11237\n#8  0x00000400013d95d0 in giac::gen::gen (this=0xffff0759f58, \n    s=\" restart;maple_mode(1);cas_setup(0,0,0,1,0,1e-10,10,[1,50,0,25],0,0,0); #radians,pas de cmplx, pas de  Sqrt\\n/* astuces, a retenir: sous xcas on utilise unapply qui est en general plus sur\\243que la metho\"..., contextptr=0xffff075a590) at gen.cc:11267\n#9  0x000004000076788c in giac::readargs_from_stream (inf=..., args=..., contextptr=0xffff075a590) at sym2poly.cc:3869\n#10 0x0000040000767cf8 in giac::readargs (ARGC=2, ARGV=0xffff075b5e8, args=..., contextptr=0xffff075a590) at sym2poly.cc:3920\n#11 0x0000000010011b60 in main (ARGC=2, ARGV=0xffff075b5e8) at icas.cc:1615\n```\nI also noticed this warning during the build, nothing bad happens because of it on x86_64 but who knows\n\n```\nusual.cc: In function 'giac::complex_long_double giac::lngamma(giac::complex_long_double)':\nusual.cc:7138:30: note: the ABI of passing aggregates with 16-byte alignment has changed in GCC 5\n   static complex_long_double lngamma(complex_long_double x){\n                              ^\n```",
    "created_at": "2017-05-11T03:25:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331978",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:28" align="right">Comment 28</div>

My latest experiment on ppc64 build with `-O0 -ggdb`, pari and ntl disabled to simplify things and rule them out.

```
#0  0x0000040000b1a068 in giac::add_print_symbolic (s=..., g=..., contextptr=0xffff075a590) at symbolic.cc:483
483         if ( g.sommet.ptr()->printsommet && g.sommet!=at_plus && g.sommet!=at_prod && g.sommet!=at_pow){
[Current thread is 1 (Thread 0x4000004d460 (LWP 13277))]
(gdb) bt
#0  0x0000040000b1a068 in giac::add_print_symbolic (s="", g=..., contextptr=0xffff075a590) at symbolic.cc:483
#1  0x0000040000b1b18c in giac::symbolic::print[abi:cxx11](giac::context const*) const (this=0x10094d18, contextptr=0xffff075a590) at symbolic.cc:599
#2  0x00000400013ea160 in giac::gen::print[abi:cxx11](giac::context const*) const (this=0xffff0743918, contextptr=0xffff075a590) at gen.cc:12815
#3  0x00000400013069d4 in giac::warn_implicit (a=..., b=..., contextptr=0xffff075a590) at usual.cc:4950
#4  0x0000040001306cbc in giac::check_symb_of (a=..., b0=..., contextptr=0xffff075a590) at usual.cc:4960
#5  0x0000040000afed78 in giac::giac_yyparse (scanner=0x1008bdd0) at input_parser.yy:232
#6  0x00000400013d7784 in giac::try_parse (
    s=" restart;maple_mode(1);cas_setup(0,0,0,1,0,1e-10,10,[1,50,0,25],0,0,0); #radians,pas de cmplx, pas de  Sqrt\n/* astuces, a retenir: sous xcas on utilise unapply qui est en general plus sur\243que la metho"..., contextptr=0xffff075a590) at gen.cc:11074
#7  0x00000400013d9284 in giac::protected_giac_yyparse (
    chaine=" restart;maple_mode(1);cas_setup(0,0,0,1,0,1e-10,10,[1,50,0,25],0,0,0); #radians,pas de cmplx, pas de  Sqrt\n/* astuces, a retenir: sous xcas on utilise unapply qui est en general plus sur\243que la metho"..., parse_result=..., contextptr=0xffff075a590) at gen.cc:11237
#8  0x00000400013d95d0 in giac::gen::gen (this=0xffff0759f58, 
    s=" restart;maple_mode(1);cas_setup(0,0,0,1,0,1e-10,10,[1,50,0,25],0,0,0); #radians,pas de cmplx, pas de  Sqrt\n/* astuces, a retenir: sous xcas on utilise unapply qui est en general plus sur\243que la metho"..., contextptr=0xffff075a590) at gen.cc:11267
#9  0x000004000076788c in giac::readargs_from_stream (inf=..., args=..., contextptr=0xffff075a590) at sym2poly.cc:3869
#10 0x0000040000767cf8 in giac::readargs (ARGC=2, ARGV=0xffff075b5e8, args=..., contextptr=0xffff075a590) at sym2poly.cc:3920
#11 0x0000000010011b60 in main (ARGC=2, ARGV=0xffff075b5e8) at icas.cc:1615
```
I also noticed this warning during the build, nothing bad happens because of it on x86_64 but who knows

```
usual.cc: In function 'giac::complex_long_double giac::lngamma(giac::complex_long_double)':
usual.cc:7138:30: note: the ABI of passing aggregates with 16-byte alignment has changed in GCC 5
   static complex_long_double lngamma(complex_long_double x){
                              ^
```



---

archive/issue_comments_331979.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nI guess that \n`g.sommet.ptr()->printsommet`\ntry to acces to the string representation of a usual symbol. so it looks similar to what I got.\nMay be the less confusing example is to just type: `e`  in icas, it should crash also for you  when trying to obtain the exp string while `d` should return d because it is not a reserved keyword. Could it be an loader ordering problem?",
    "created_at": "2017-05-11T13:30:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331979",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:29" align="right">Comment 29</div>

I guess that 
`g.sommet.ptr()->printsommet`
try to acces to the string representation of a usual symbol. so it looks similar to what I got.
May be the less confusing example is to just type: `e`  in icas, it should crash also for you  when trying to obtain the exp string while `d` should return d because it is not a reserved keyword. Could it be an loader ordering problem?



---

archive/issue_comments_331980.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nTyping `e` in `icas` segfault and that's what I get from the core dump\n\n```\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0x0000040000b28538 in __gnu_cxx::new_allocator<char const*>::construct<char const*, char const* const&> (this=0x1007fc00, __p=0x40054000940)\n    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/ext/new_allocator.h:120\n120             { ::new((void *)__p) _Up(std::forward<_Args>(__args)...); }\n[Current thread is 1 (Thread 0x4005228f080 (LWP 40544))]\n(gdb) bt\n#0  0x0000040000b28538 in __gnu_cxx::new_allocator<char const*>::construct<char const*, char const* const&> (this=0x1007fc00, __p=0x40054000940)\n    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/ext/new_allocator.h:120\n#1  0x0000040000b274fc in std::allocator_traits<std::allocator<char const*> >::construct<char const*, char const* const&> (__a=..., __p=0x40054000940)\n    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/bits/alloc_traits.h:530\n#2  0x0000040000b275cc in std::vector<char const*, std::allocator<char const*> >::_M_emplace_back_aux<char const* const&> (this=0x1007fc00)\n    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/bits/vector.tcc:416\n#3  0x0000040000b263c4 in std::vector<char const*, std::allocator<char const*> >::push_back (this=0x1007fc00, __x=<error reading variable>)\n    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/bits/stl_vector.h:923\n#4  0x0000040000b21ca4 in giac::symbolic::eval (this=0x1013a1a8, level=25, contextptr=0xfffc02556f0) at symbolic.cc:1371\n#5  0x0000040001368ccc in giac::gen::in_eval (this=0x4005228e5c8, level=25, evaled=..., contextptr=0xfffc02556f0) at gen.cc:2113\n#6  0x0000040001366268 in giac::gen::eval (this=0x4005228e5c8, level=25, contextptr=0xfffc02556f0) at gen.cc:1899\n#7  0x000004000106fd7c in giac::protecteval (g=..., level=25, contextptr=0xfffc02556f0) at prog.cc:6881\n#8  0x0000040000e4e50c in giac::in_thread_eval (arg=0x1007ff28) at global.cc:3463\n#9  0x000004000265bb10 in .start_thread () from /shared/work_no_backup/ppc64-prefix/lib64/libpthread.so.0\n#10 0x0000040002d6b268 in .__clone () from /shared/work_no_backup/ppc64-prefix/lib64/libc.so.6\n```",
    "created_at": "2017-05-12T03:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331980",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:30" align="right">Comment 30</div>

Typing `e` in `icas` segfault and that's what I get from the core dump

```
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x0000040000b28538 in __gnu_cxx::new_allocator<char const*>::construct<char const*, char const* const&> (this=0x1007fc00, __p=0x40054000940)
    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/ext/new_allocator.h:120
120             { ::new((void *)__p) _Up(std::forward<_Args>(__args)...); }
[Current thread is 1 (Thread 0x4005228f080 (LWP 40544))]
(gdb) bt
#0  0x0000040000b28538 in __gnu_cxx::new_allocator<char const*>::construct<char const*, char const* const&> (this=0x1007fc00, __p=0x40054000940)
    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/ext/new_allocator.h:120
#1  0x0000040000b274fc in std::allocator_traits<std::allocator<char const*> >::construct<char const*, char const* const&> (__a=..., __p=0x40054000940)
    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/bits/alloc_traits.h:530
#2  0x0000040000b275cc in std::vector<char const*, std::allocator<char const*> >::_M_emplace_back_aux<char const* const&> (this=0x1007fc00)
    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/bits/vector.tcc:416
#3  0x0000040000b263c4 in std::vector<char const*, std::allocator<char const*> >::push_back (this=0x1007fc00, __x=<error reading variable>)
    at /shared/work_no_backup/ppc64-prefix/usr/lib/gcc/powerpc64-unknown-linux-gnu/5.4.0/include/g++-v5/bits/stl_vector.h:923
#4  0x0000040000b21ca4 in giac::symbolic::eval (this=0x1013a1a8, level=25, contextptr=0xfffc02556f0) at symbolic.cc:1371
#5  0x0000040001368ccc in giac::gen::in_eval (this=0x4005228e5c8, level=25, evaled=..., contextptr=0xfffc02556f0) at gen.cc:2113
#6  0x0000040001366268 in giac::gen::eval (this=0x4005228e5c8, level=25, contextptr=0xfffc02556f0) at gen.cc:1899
#7  0x000004000106fd7c in giac::protecteval (g=..., level=25, contextptr=0xfffc02556f0) at prog.cc:6881
#8  0x0000040000e4e50c in giac::in_thread_eval (arg=0x1007ff28) at global.cc:3463
#9  0x000004000265bb10 in .start_thread () from /shared/work_no_backup/ppc64-prefix/lib64/libpthread.so.0
#10 0x0000040002d6b268 in .__clone () from /shared/work_no_backup/ppc64-prefix/lib64/libc.so.6
```



---

archive/issue_comments_331981.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nSo you have the same debug as what I had with gcc4.9 in comment 26 where I put a break in symbolic.cc.\n\nBut for me, if after the built I rebuilt `icas` with `.libs/libgiac.a` instead of `.libs/libgiac.so` by doing in the src/ directory:\n\n```\nfred@debianppc64:~/giac-1.2.3-gcc49/src$ g++ -g -fno-strict-aliasing -DGIAC_GENERIC_CONSTANTS -o .libs/icas icas.o  ./.libs/libxcas.a /home/fred/giac-1.2.3-gcc49/src/.libs/libgiac.a -lreadline -ltermcap -lrt -lpthread -ldl -lm -lmpfr -lgmp\n``` \nthen I can run `.libs/icas` without problems.",
    "created_at": "2017-05-12T12:29:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331981",
    "user": "https://github.com/frederichan-IMJPRG"
}
```

<div id="comment:31" align="right">Comment 31</div>

So you have the same debug as what I had with gcc4.9 in comment 26 where I put a break in symbolic.cc.

But for me, if after the built I rebuilt `icas` with `.libs/libgiac.a` instead of `.libs/libgiac.so` by doing in the src/ directory:

```
fred@debianppc64:~/giac-1.2.3-gcc49/src$ g++ -g -fno-strict-aliasing -DGIAC_GENERIC_CONSTANTS -o .libs/icas icas.o  ./.libs/libxcas.a /home/fred/giac-1.2.3-gcc49/src/.libs/libgiac.a -lreadline -ltermcap -lrt -lpthread -ldl -lm -lmpfr -lgmp
``` 
then I can run `.libs/icas` without problems.



---

archive/issue_comments_331982.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nIndeed, if I configure giac with disable-shared, I can ask e in icas without sefgault.",
    "created_at": "2017-05-19T09:32:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331982",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:32" align="right">Comment 32</div>

Indeed, if I configure giac with disable-shared, I can ask e in icas without sefgault.



---

archive/issue_comments_331983.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nBut I still have similar failures:\n\n```\n0>> maple_mode(0);\n[New Thread 0x3fffaf10f1a0 (LWP 31223)]\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x3fffaf10f1a0 (LWP 31223)]\n0x000000001034c1a0 in __gnu_cxx::new_allocator<char const*>::construct (\n    this=0x1107a830, __p=0x3fffa8000940, \n    __val=@0xffffe3b0: <error reading variable>)\n    at /usr/include/c++/4.8.3/ext/new_allocator.h:130\n130           { ::new((void *)__p) _Tp(__val); }\nMissing separate debuginfos, use: debuginfo-install glibc-2.18-16.fc20.ppc64p7 libgcc-4.8.3-7.fc20.ppc64 libgfortran-4.8.3-7.fc20.ppc64 libstdc++-4.8.3-7.fc20.ppc64\n(gdb) bt\n#0  0x000000001034c1a0 in __gnu_cxx::new_allocator<char const*>::construct (\n    this=0x1107a830, __p=0x3fffa8000940, \n    __val=@0xffffe3b0: <error reading variable>)\n    at /usr/include/c++/4.8.3/ext/new_allocator.h:130\n#1  0x000000001034ae74 in __gnu_cxx::__alloc_traits<std::allocator<char const*> >::construct<char const*> (__a=..., __p=0x3fffa8000940, \n    __arg=@0xffffe3b0: <error reading variable>)\n    at /usr/include/c++/4.8.3/ext/alloc_traits.h:216\n#2  0x000000001034b024 in std::vector<char const*, std::allocator<char const*> >::_M_insert_aux (this=0x1107a830, \n    __position=<error reading variable: Cannot access memory at address 0x0>, \n    __x=@0xffffe3b0: <error reading variable>)\n    at /usr/include/c++/4.8.3/bits/vector.tcc:353\n#3  0x000000001034942c in std::vector<char const*, std::allocator<char const*> >::push_back (this=0x1107a830, __x=@0xffffe3b0: <error reading variable>)\n    at /usr/include/c++/4.8.3/bits/stl_vector.h:913\n#4  0x0000000010344af4 in giac::symbolic::eval (this=0x1119df98, level=25, \n    contextptr=0x3fffffffde10) at symbolic.cc:1372\n#5  0x0000000010b7f04c in giac::gen::in_eval (this=0x3fffaf10e6f8, level=25, \n    evaled=..., contextptr=0x3fffffffde10) at gen.cc:2109\n#6  0x0000000010b7c7f8 in giac::gen::eval (this=0x3fffaf10e6f8, level=25, \n    contextptr=0x3fffffffde10) at gen.cc:1893\n#7  0x0000000010887b2c in giac::protecteval (g=..., level=25, \n    contextptr=0x3fffffffde10) at prog.cc:7001\n#8  0x000000001068bb08 in giac::in_thread_eval (arg=0x1107aad8)\n    at global.cc:3467\n#9  0x00003fffb703c328 in .start_thread () from /lib64/libpthread.so.0\n#10 0x00003fffb6abdc70 in .__clone () from /lib64/libc.so.6\n```",
    "created_at": "2017-05-19T10:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331983",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:33" align="right">Comment 33</div>

But I still have similar failures:

```
0>> maple_mode(0);
[New Thread 0x3fffaf10f1a0 (LWP 31223)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x3fffaf10f1a0 (LWP 31223)]
0x000000001034c1a0 in __gnu_cxx::new_allocator<char const*>::construct (
    this=0x1107a830, __p=0x3fffa8000940, 
    __val=@0xffffe3b0: <error reading variable>)
    at /usr/include/c++/4.8.3/ext/new_allocator.h:130
130           { ::new((void *)__p) _Tp(__val); }
Missing separate debuginfos, use: debuginfo-install glibc-2.18-16.fc20.ppc64p7 libgcc-4.8.3-7.fc20.ppc64 libgfortran-4.8.3-7.fc20.ppc64 libstdc++-4.8.3-7.fc20.ppc64
(gdb) bt
#0  0x000000001034c1a0 in __gnu_cxx::new_allocator<char const*>::construct (
    this=0x1107a830, __p=0x3fffa8000940, 
    __val=@0xffffe3b0: <error reading variable>)
    at /usr/include/c++/4.8.3/ext/new_allocator.h:130
#1  0x000000001034ae74 in __gnu_cxx::__alloc_traits<std::allocator<char const*> >::construct<char const*> (__a=..., __p=0x3fffa8000940, 
    __arg=@0xffffe3b0: <error reading variable>)
    at /usr/include/c++/4.8.3/ext/alloc_traits.h:216
#2  0x000000001034b024 in std::vector<char const*, std::allocator<char const*> >::_M_insert_aux (this=0x1107a830, 
    __position=<error reading variable: Cannot access memory at address 0x0>, 
    __x=@0xffffe3b0: <error reading variable>)
    at /usr/include/c++/4.8.3/bits/vector.tcc:353
#3  0x000000001034942c in std::vector<char const*, std::allocator<char const*> >::push_back (this=0x1107a830, __x=@0xffffe3b0: <error reading variable>)
    at /usr/include/c++/4.8.3/bits/stl_vector.h:913
#4  0x0000000010344af4 in giac::symbolic::eval (this=0x1119df98, level=25, 
    contextptr=0x3fffffffde10) at symbolic.cc:1372
#5  0x0000000010b7f04c in giac::gen::in_eval (this=0x3fffaf10e6f8, level=25, 
    evaled=..., contextptr=0x3fffffffde10) at gen.cc:2109
#6  0x0000000010b7c7f8 in giac::gen::eval (this=0x3fffaf10e6f8, level=25, 
    contextptr=0x3fffffffde10) at gen.cc:1893
#7  0x0000000010887b2c in giac::protecteval (g=..., level=25, 
    contextptr=0x3fffffffde10) at prog.cc:7001
#8  0x000000001068bb08 in giac::in_thread_eval (arg=0x1107aad8)
    at global.cc:3467
#9  0x00003fffb703c328 in .start_thread () from /lib64/libpthread.so.0
#10 0x00003fffb6abdc70 in .__clone () from /lib64/libc.so.6
```



---

archive/issue_comments_331984.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nA shorter one:\n\n```\n0>> maple_mode\n[New Thread 0x3fffaf10f1a0 (LWP 35528)]\n[Thread 0x3fffaf10f1a0 (LWP 35528) exited]\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x0000000010bfc680 in giac::gen::print (this=0x3fffffffdb50, \n    contextptr=0x3fffffffde10) at gen.cc:12961\n12961         if (rpn_mode(contextptr) || _FUNCptr->ptr()->printsommet==&printastifunction || subtype==0) \n(gdb) bt\n#0  0x0000000010bfc680 in giac::gen::print (this=0x3fffffffdb50, \n    contextptr=0x3fffffffde10) at gen.cc:12961\n#1  0x00000000100174cc in main (ARGC=1, ARGV=0x3fffffffe398) at icas.cc:1536\n(gdb) \n```",
    "created_at": "2017-05-19T10:15:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331984",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:34" align="right">Comment 34</div>

A shorter one:

```
0>> maple_mode
[New Thread 0x3fffaf10f1a0 (LWP 35528)]
[Thread 0x3fffaf10f1a0 (LWP 35528) exited]

Program received signal SIGSEGV, Segmentation fault.
0x0000000010bfc680 in giac::gen::print (this=0x3fffffffdb50, 
    contextptr=0x3fffffffde10) at gen.cc:12961
12961         if (rpn_mode(contextptr) || _FUNCptr->ptr()->printsommet==&printastifunction || subtype==0) 
(gdb) bt
#0  0x0000000010bfc680 in giac::gen::print (this=0x3fffffffdb50, 
    contextptr=0x3fffffffde10) at gen.cc:12961
#1  0x00000000100174cc in main (ARGC=1, ARGV=0x3fffffffe398) at icas.cc:1536
(gdb) 
```



---

archive/issue_comments_331985.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nThis looks bad:\n\n```\n(gdb) p this->ref_FUNCptr()->ptr()\n$8 = (giac::unary_function_abstract *) 0xffffe3a8\n```\nAddress has been cut.",
    "created_at": "2017-05-19T10:23:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331985",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:35" align="right">Comment 35</div>

This looks bad:

```
(gdb) p this->ref_FUNCptr()->ptr()
$8 = (giac::unary_function_abstract *) 0xffffe3a8
```
Address has been cut.



---

archive/issue_comments_331986.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nOne can circumvent that by setting  `__x86_64__` but this automatically sets `SMARTPTR64` which might be broken on ppc64 because of endianness (vould work on ppc64le) and `_I386_` which includes assembly code.\n\nI'm now trying with proper 64 bits pointers but without \"smart\" pointers.",
    "created_at": "2017-05-19T13:30:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331986",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:36" align="right">Comment 36</div>

One can circumvent that by setting  `__x86_64__` but this automatically sets `SMARTPTR64` which might be broken on ppc64 because of endianness (vould work on ppc64le) and `_I386_` which includes assembly code.

I'm now trying with proper 64 bits pointers but without "smart" pointers.



---

archive/issue_comments_331987.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nOh yeah and on 64 bits systems, not using `SMARTPTR64` is doomed to fail because C(++) types of different lengths are used to access the `_FUNC_` part of a `gen`.",
    "created_at": "2017-05-19T13:32:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331987",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:37" align="right">Comment 37</div>

Oh yeah and on 64 bits systems, not using `SMARTPTR64` is doomed to fail because C(++) types of different lengths are used to access the `_FUNC_` part of a `gen`.



---

archive/issue_comments_331988.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nAnd `double` storage trick fails because of byte order and is fixed when passing `-DDOUBLEVAL`.",
    "created_at": "2017-05-19T15:20:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331988",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:38" align="right">Comment 38</div>

And `double` storage trick fails because of byte order and is fixed when passing `-DDOUBLEVAL`.



---

archive/issue_comments_331989.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nEverything seems fine now, patches on their way.",
    "created_at": "2017-05-19T15:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331989",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:39" align="right">Comment 39</div>

Everything seems fine now, patches on their way.



---

archive/issue_comments_331990.json:
```json
{
    "body": "Commit: **[f5e35f2](https://github.com/sagemath/sagetrac-mirror/commit/f5e35f22f55f56921aa3314689aa8a3c84db64b6)**",
    "created_at": "2017-05-22T11:41:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331990",
    "user": "https://github.com/jpflori"
}
```

Commit: **[f5e35f2](https://github.com/sagemath/sagetrac-mirror/commit/f5e35f22f55f56921aa3314689aa8a3c84db64b6)**



---

archive/issue_comments_331991.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nHere you go.\nPlease report any success/failure with this branch.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5e35f22f55f56921aa3314689aa8a3c84db64b6\">f5e35f2</a></td><td><code>Make giac behave correctly on 64 bits or big endian systems.</code></td></tr></table>\n",
    "created_at": "2017-05-22T11:41:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331991",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:40" align="right">Comment 40</div>

Here you go.
Please report any success/failure with this branch.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5e35f22f55f56921aa3314689aa8a3c84db64b6">f5e35f2</a></td><td><code>Make giac behave correctly on 64 bits or big endian systems.</code></td></tr></table>




---

archive/issue_comments_331992.json:
```json
{
    "body": "Branch: **[public/giac](https://github.com/sagemath/sagetrac-mirror/tree/public/giac)**",
    "created_at": "2017-05-22T11:41:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331992",
    "user": "https://github.com/jpflori"
}
```

Branch: **[public/giac](https://github.com/sagemath/sagetrac-mirror/tree/public/giac)**



---

archive/issue_comments_331993.json:
```json
{
    "body": "Author: **Jean-Pierre Flori**",
    "created_at": "2017-05-22T11:41:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331993",
    "user": "https://github.com/jpflori"
}
```

Author: **Jean-Pierre Flori**



---

archive/issue_events_293873.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2017-05-22T13:34:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293873"
}
```



---

archive/issue_comments_331994.json:
```json
{
    "body": "Upstream: **Not yet reported upstream; Will do shortly.**",
    "created_at": "2017-05-22T13:34:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331994",
    "user": "https://github.com/jpflori"
}
```

Upstream: **Not yet reported upstream; Will do shortly.**



---

archive/issue_comments_331995.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nAnd let's even say it's needs_review...",
    "created_at": "2017-05-22T13:34:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331995",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:41" align="right">Comment 41</div>

And let's even say it's needs_review...



---

archive/issue_comments_331996.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nI've been in contact with Bernard (Parisse = upstream) and made some efforts have been made towards more portability but according to my experiments not enough at the moment.\nSee:\n* https://dev.geogebra.org/trac/browser/trunk/geogebra/giac/src/giac?rev=52930 and https://dev.geogebra.org/trac/browser/trunk/geogebra/giac/src/giac?rev=52967 to rename some `__x86_64__` to `x86_64` which is kind of a good move though I'd prefer a better macro name and why not just use `__LP64__`; and this does not prevent inclusion of x86_64 assembly on non-x86_64 and this change (as mine) covers at the same times part where we want pointers to be 64 bit but also long to be (or long long? which would make it more easy to deal with)...\n* https://dev.geogebra.org/trac/browser/trunk/geogebra/giac/src/giac?rev=53251 to fix the type of `_FUNC_`\n* https://dev.geogebra.org/trac/browser/trunk/geogebra/giac/src/giac?rev=52324 to use `SMARTPTR64` on (approximatively) `__LP64__` and `__LLP64__` archs; but there is still the endianness issue with smart pointers.\n* there is still an endianness issue when smart pointers are not used and `DOUBLEVAL` is not defined but that should not happen when `x86_64` is defined.",
    "created_at": "2017-05-24T13:51:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331996",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:42" align="right">Comment 42</div>

I've been in contact with Bernard (Parisse = upstream) and made some efforts have been made towards more portability but according to my experiments not enough at the moment.
See:
* https://dev.geogebra.org/trac/browser/trunk/geogebra/giac/src/giac?rev=52930 and https://dev.geogebra.org/trac/browser/trunk/geogebra/giac/src/giac?rev=52967 to rename some `__x86_64__` to `x86_64` which is kind of a good move though I'd prefer a better macro name and why not just use `__LP64__`; and this does not prevent inclusion of x86_64 assembly on non-x86_64 and this change (as mine) covers at the same times part where we want pointers to be 64 bit but also long to be (or long long? which would make it more easy to deal with)...
* https://dev.geogebra.org/trac/browser/trunk/geogebra/giac/src/giac?rev=53251 to fix the type of `_FUNC_`
* https://dev.geogebra.org/trac/browser/trunk/geogebra/giac/src/giac?rev=52324 to use `SMARTPTR64` on (approximatively) `__LP64__` and `__LLP64__` archs; but there is still the endianness issue with smart pointers.
* there is still an endianness issue when smart pointers are not used and `DOUBLEVAL` is not defined but that should not happen when `x86_64` is defined.



---

archive/issue_comments_331997.json:
```json
{
    "body": "Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**",
    "created_at": "2017-05-24T13:51:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331997",
    "user": "https://github.com/jpflori"
}
```

Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**



---

archive/issue_comments_331998.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nDid you suggest the fix for libpng/lpng1x too ([/22159#comment:29 suggested on this comment])?",
    "created_at": "2017-05-25T16:14:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331998",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:44" align="right">Comment 44</div>

Did you suggest the fix for libpng/lpng1x too ([/22159#comment:29 suggested on this comment])?



---

archive/issue_comments_331999.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nWhich version is your starting point? I am trying with 1.2.3-25 at the moment (because I have it handy on ppc64 right now) and while it is an improvement there are still failures, and I seem to be hanging at `chk_morley_demo` and a few others.",
    "created_at": "2017-05-25T23:02:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-331999",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:45" align="right">Comment 45</div>

Which version is your starting point? I am trying with 1.2.3-25 at the moment (because I have it handy on ppc64 right now) and while it is an improvement there are still failures, and I seem to be hanging at `chk_morley_demo` and a few others.



---

archive/issue_comments_332000.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A44):\n> Did you suggest the fix for libpng/lpng1x too ([/22159#comment:29 suggested on this comment])?\n\nNope, I did not...",
    "created_at": "2017-05-30T10:09:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332000",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:46" align="right">Comment 46</div>

Replying to [@sagetrac-tmonteil](#comment%3A44):
> Did you suggest the fix for libpng/lpng1x too ([/22159#comment:29 suggested on this comment])?

Nope, I did not...



---

archive/issue_comments_332001.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nReplying to [@kiwifb](#comment%3A45):\n> Which version is your starting point? I am trying with 1.2.3-25 at the moment (because I have it handy on ppc64 right now) and while it is an improvement there are still failures, and I seem to be hanging at `chk_morley_demo` and a few others.\n\nHum, the one pointed in this ticket.\n\nThe latest \"unstable\" (which might have become stable) tarball should have equivalent fixes.\nSee:\n* https://dev.geogebra.org/trac/changeset/54223 for assembly and endianess issue.\n* https://dev.geogebra.org/trac/changeset/54269 for smart pointer tweaking.\n\nI guess you still have to pass `-Dx86_64` into `C[XX|PP]FLAGS` to make sure addresses are not cut at 32 bits.",
    "created_at": "2017-05-30T10:17:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332001",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:47" align="right">Comment 47</div>

Replying to [@kiwifb](#comment%3A45):
> Which version is your starting point? I am trying with 1.2.3-25 at the moment (because I have it handy on ppc64 right now) and while it is an improvement there are still failures, and I seem to be hanging at `chk_morley_demo` and a few others.

Hum, the one pointed in this ticket.

The latest "unstable" (which might have become stable) tarball should have equivalent fixes.
See:
* https://dev.geogebra.org/trac/changeset/54223 for assembly and endianess issue.
* https://dev.geogebra.org/trac/changeset/54269 for smart pointer tweaking.

I guess you still have to pass `-Dx86_64` into `C[XX|PP]FLAGS` to make sure addresses are not cut at 32 bits.



---

archive/issue_comments_332002.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nNote that using static or shared libraries makes no difference, both work well.",
    "created_at": "2017-05-30T10:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332002",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:48" align="right">Comment 48</div>

Note that using static or shared libraries makes no difference, both work well.



---

archive/issue_comments_332003.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nThanks to Bernard and debian folk work the latest stable version seems ok.\nPass `-Dx86_64` into `CPPFLAGS`.",
    "created_at": "2017-05-31T08:35:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332003",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:49" align="right">Comment 49</div>

Thanks to Bernard and debian folk work the latest stable version seems ok.
Pass `-Dx86_64` into `CPPFLAGS`.



---

archive/issue_comments_332004.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -32,5 +32,6 @@\n \n ---\n \n-One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:\n-* http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=19&t=1723\n+Use > -45 version:\n+* http://www-fourier.ujf-grenoble.fr/~parisse/debian/dists/stable/main/source/giac_1.2.3-47.tar.gz\n+And pass `-Dx86_64` in CPPFLAGS.\n``````\n",
    "created_at": "2017-05-31T08:38:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332004",
    "user": "https://github.com/jpflori"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -32,5 +32,6 @@
 
 ---
 
-One can maybe cheat and pass  `-D__x86_64__ -DSMARTPTR64` in CPPFLAGS but that's dirty, see:
-* http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=19&t=1723
+Use > -45 version:
+* http://www-fourier.ujf-grenoble.fr/~parisse/debian/dists/stable/main/source/giac_1.2.3-47.tar.gz
+And pass `-Dx86_64` in CPPFLAGS.
``````




---

archive/issue_comments_332005.json:
```json
{
    "body": "Changed commit from **[f5e35f2](https://github.com/sagemath/sagetrac-mirror/commit/f5e35f22f55f56921aa3314689aa8a3c84db64b6)** to **[8dc4c88](https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959)**",
    "created_at": "2017-05-31T21:14:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332005",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f5e35f2](https://github.com/sagemath/sagetrac-mirror/commit/f5e35f22f55f56921aa3314689aa8a3c84db64b6)** to **[8dc4c88](https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959)**



---

archive/issue_comments_332006.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959\">8dc4c88</a></td><td><code>Update to 1.2.3-47.</code></td></tr></table>\n",
    "created_at": "2017-05-31T21:14:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332006",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:51" align="right">Comment 51</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959">8dc4c88</a></td><td><code>Update to 1.2.3-47.</code></td></tr></table>




---

archive/issue_comments_332007.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -33,5 +33,7 @@\n ---\n \n Use > -45 version:\n-* http://www-fourier.ujf-grenoble.fr/~parisse/debian/dists/stable/main/source/giac_1.2.3-47.tar.gz\n+The upstream tarball is at http://www-fourier.ujf-grenoble.fr/~parisse/debian/dists/stable/main/source/giac_1.2.3-47.tar.gz\n+Repackaged tarball is at:\n+* http://perso.telecom-paristech.fr/~flori/giac-1.2.3.47.tar.bz2\n And pass `-Dx86_64` in CPPFLAGS.\n``````\n",
    "created_at": "2017-05-31T21:17:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332007",
    "user": "https://github.com/jpflori"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -33,5 +33,7 @@
 ---
 
 Use > -45 version:
-* http://www-fourier.ujf-grenoble.fr/~parisse/debian/dists/stable/main/source/giac_1.2.3-47.tar.gz
+The upstream tarball is at http://www-fourier.ujf-grenoble.fr/~parisse/debian/dists/stable/main/source/giac_1.2.3-47.tar.gz
+Repackaged tarball is at:
+* http://perso.telecom-paristech.fr/~flori/giac-1.2.3.47.tar.bz2
 And pass `-Dx86_64` in CPPFLAGS.
``````




---

archive/issue_comments_332008.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nIf you want to add `arm64` support, please do so.\nBut I think this is ready to go now.",
    "created_at": "2017-05-31T21:17:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332008",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:52" align="right">Comment 52</div>

If you want to add `arm64` support, please do so.
But I think this is ready to go now.



---

archive/issue_comments_332009.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nFeel free to send this to the bots!",
    "created_at": "2017-06-02T15:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332009",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:53" align="right">Comment 53</div>

Feel free to send this to the bots!



---

archive/issue_comments_332010.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2017-06-02T15:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332010",
    "user": "https://github.com/jpflori"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_332011.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nI am sorry I haven't had time to test this fully yet. I will try to give it another go over the weekend.",
    "created_at": "2017-06-02T23:13:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332011",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:55" align="right">Comment 55</div>

I am sorry I haven't had time to test this fully yet. I will try to give it another go over the weekend.



---

archive/issue_comments_332012.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\n\n```\nmake[3]: Entering directory '/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/check'\n*** stack smashing detected ***: /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/icas terminated\n======= Backtrace: =========\n/shared/work_no_backup/ppc64-prefix/lib64/libc.so.6(+0xa3ba8)[0x400016e3ba8]\n/shared/work_no_backup/ppc64-prefix/lib64/libc.so.6(__fortify_fail-0x89548)[0x40001782480]\n/shared/work_no_backup/ppc64-prefix/lib64/libc.so.6(__stack_chk_fail-0x89598)[0x40001782418]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac5substERKNS_3genERKNS_15dbgprint_vectorIS0_EES6_bPKNS_7contextE-0x836be0)[0x400007770d8]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(+0x6dbcc0)[0x4000074bcc0]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(+0x1ca518)[0x4000023a518]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(+0x6e0834)[0x40000750834]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac5limitERKNS_3genERKNS_14identificateurES2_iPKNS_7contextE-0x85b8e8)[0x40000751590]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac11quotedlimitERKNS_3genERKNS_14identificateurES2_iPKNS_7contextE-0x85b498)[0x400007519f8]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac6_limitERKNS_3genEPKNS_7contextE-0x85ab14)[0x40000752394]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac19unary_function_evalclERKNS_3genEPKNS_7contextE-0x3aa814)[0x40000c165b4]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac18unary_function_ptrclERKNS_3genEPKNS_7contextE-0x3b940c)[0x40000c07c5c]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac8symbolic4evalEiPKNS_7contextE-0xa07dd8)[0x4000059f9b8]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac3gen7in_evalEiRS0_PKNS_7contextE-0x2c80d0)[0x40000cfdc30]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac3gen4evalEiPKNS_7contextE-0x2c70d8)[0x40000cfec58]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac11protectevalERKNS_3genEiPKNS_7contextE-0x54a214)[0x40000a6fe34]\n/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(+0x81b894)[0x4000088b894]\n/shared/work_no_backup/ppc64-prefix/lib64/libpthread.so.0(+0xbb10)[0x40002c1bb10]\n/shared/work_no_backup/ppc64-prefix/lib64/libc.so.6(clone-0x9e5b8)[0x4000176b268]\n======= Memory map: ========\n10000000-10020000 r-xp 00000000 00:10 13112212                           /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/icas\n10020000-10030000 r--p 00010000 00:10 13112212                           /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/icas\n10030000-10040000 rw-p 00020000 00:10 13112212                           /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/icas\n10040000-100d0000 rw-p 00000000 00:00 0                                  [heap]\n40000000000-40000030000 r-xp 00000000 00:16 41936355                     /shared/work_no_backup/ppc64-prefix/lib64/ld-2.23.so\n40000030000-40000040000 r--p 00020000 00:16 41936355                     /shared/work_no_backup/ppc64-prefix/lib64/ld-2.23.so\n40000040000-40000050000 rw-p 00030000 00:16 41936355                     /shared/work_no_backup/ppc64-prefix/lib64/ld-2.23.so\n40000050000-40000070000 r-xp 00000000 00:00 0                            [vdso]\n40000070000-40000f60000 r-xp 00000000 00:10 13111890                     /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0.0.0\n40000f60000-40000f70000 ---p 00ef0000 00:10 13111890                     /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0.0.0\n40000f70000-40000fd0000 r--p 00ef0000 00:10 13111890                     /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0.0.0\n40000fd0000-40000ff0000 rw-p 00f50000 00:10 13111890                     /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0.0.0\n40000ff0000-40001020000 rw-p 00000000 00:00 0 \n40001020000-40001080000 r-xp 00000000 00:16 14674565                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libreadline.so.7.0\n40001080000-40001090000 r--p 00050000 00:16 14674565                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libreadline.so.7.0\n40001090000-400010a0000 rw-p 00060000 00:16 14674565                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libreadline.so.7.0\n400010a0000-40001340000 r-xp 00000000 00:16 16553231                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libgsl.so.19.3.0\n40001340000-40001370000 r--p 00290000 00:16 16553231                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libgsl.so.19.3.0\n40001370000-40001390000 rw-p 002c0000 00:16 16553231                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libgsl.so.19.3.0\n40001390000-400013a0000 rw-p 00000000 00:00 0 \n400013b0000-400015c0000 r-xp 00000000 00:16 15211125                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libstdc++.so.6.0.21\n400015c0000-400015f0000 r--p 00200000 00:16 15211125                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libstdc++.so.6.0.21\n400015f0000-40001600000 rw-p 00230000 00:16 15211125                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libstdc++.so.6.0.21\n40001600000-40001620000 r-xp 00000000 00:16 15211117                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libgcc_s.so.1\n40001620000-40001630000 r--p 00010000 00:16 15211117                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libgcc_s.so.1\n40001630000-40001640000 rw-p 00020000 00:16 15211117                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libgcc_s.so.1FAIL: chk_limit\nPASS: chk_partfrac\nFAIL: chk_fhan15\nPASS: chk_fhan13\nPASS: chk_factor\nPASS: chk_geo\nFAIL: chk_fhan0\nPASS: chk_fhan21\nPASS: chk_integrate\nFAIL: chk_fhan2\nFAIL: chk_cas\nPASS: chk_xavier\nFAIL: chk_fhan1\nPASS: chk_normalize\nFAIL: chk_morley_demo\nFAIL: chk_fhan18\nFAIL: chk_fhan12\nFAIL: chk_fhan7\nFAIL: chk_fhan20\nFAIL: chk_fhan16\nFAIL: chk_fhan9\nFAIL: chk_fhan17\nFAIL: chk_fhan8\nFAIL: chk_fhan5\nFAIL: chk_fhan3\nFAIL: chk_fhan4\nFAIL: chk_fhan6\nFAIL: chk_fhan19\nFAIL: chk_fhan14\nFAIL: chk_fhan11\n============================================================================\nTestsuite summary for giac 1.2.3\n============================================================================\n# TOTAL: 30\n# PASS:  8\n# SKIP:  0\n# XFAIL: 0\n# FAIL:  22\n# XPASS: 0\n# ERROR: 0\n```\nI am starting to think my g++ is at fault :(",
    "created_at": "2017-06-07T02:37:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332012",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:56" align="right">Comment 56</div>


```
make[3]: Entering directory '/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/check'
*** stack smashing detected ***: /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/icas terminated
======= Backtrace: =========
/shared/work_no_backup/ppc64-prefix/lib64/libc.so.6(+0xa3ba8)[0x400016e3ba8]
/shared/work_no_backup/ppc64-prefix/lib64/libc.so.6(__fortify_fail-0x89548)[0x40001782480]
/shared/work_no_backup/ppc64-prefix/lib64/libc.so.6(__stack_chk_fail-0x89598)[0x40001782418]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac5substERKNS_3genERKNS_15dbgprint_vectorIS0_EES6_bPKNS_7contextE-0x836be0)[0x400007770d8]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(+0x6dbcc0)[0x4000074bcc0]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(+0x1ca518)[0x4000023a518]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(+0x6e0834)[0x40000750834]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac5limitERKNS_3genERKNS_14identificateurES2_iPKNS_7contextE-0x85b8e8)[0x40000751590]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac11quotedlimitERKNS_3genERKNS_14identificateurES2_iPKNS_7contextE-0x85b498)[0x400007519f8]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac6_limitERKNS_3genEPKNS_7contextE-0x85ab14)[0x40000752394]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac19unary_function_evalclERKNS_3genEPKNS_7contextE-0x3aa814)[0x40000c165b4]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac18unary_function_ptrclERKNS_3genEPKNS_7contextE-0x3b940c)[0x40000c07c5c]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac8symbolic4evalEiPKNS_7contextE-0xa07dd8)[0x4000059f9b8]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac3gen7in_evalEiRS0_PKNS_7contextE-0x2c80d0)[0x40000cfdc30]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZNK4giac3gen4evalEiPKNS_7contextE-0x2c70d8)[0x40000cfec58]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(_ZN4giac11protectevalERKNS_3genEiPKNS_7contextE-0x54a214)[0x40000a6fe34]
/dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0(+0x81b894)[0x4000088b894]
/shared/work_no_backup/ppc64-prefix/lib64/libpthread.so.0(+0xbb10)[0x40002c1bb10]
/shared/work_no_backup/ppc64-prefix/lib64/libc.so.6(clone-0x9e5b8)[0x4000176b268]
======= Memory map: ========
10000000-10020000 r-xp 00000000 00:10 13112212                           /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/icas
10020000-10030000 r--p 00010000 00:10 13112212                           /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/icas
10030000-10040000 rw-p 00020000 00:10 13112212                           /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/icas
10040000-100d0000 rw-p 00000000 00:00 0                                  [heap]
40000000000-40000030000 r-xp 00000000 00:16 41936355                     /shared/work_no_backup/ppc64-prefix/lib64/ld-2.23.so
40000030000-40000040000 r--p 00020000 00:16 41936355                     /shared/work_no_backup/ppc64-prefix/lib64/ld-2.23.so
40000040000-40000050000 rw-p 00030000 00:16 41936355                     /shared/work_no_backup/ppc64-prefix/lib64/ld-2.23.so
40000050000-40000070000 r-xp 00000000 00:00 0                            [vdso]
40000070000-40000f60000 r-xp 00000000 00:10 13111890                     /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0.0.0
40000f60000-40000f70000 ---p 00ef0000 00:10 13111890                     /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0.0.0
40000f70000-40000fd0000 r--p 00ef0000 00:10 13111890                     /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0.0.0
40000fd0000-40000ff0000 rw-p 00f50000 00:10 13111890                     /dev/shm/portage/sci-mathematics/giac-1.2.3.47/work/giac-1.2.3/src/.libs/libgiac.so.0.0.0
40000ff0000-40001020000 rw-p 00000000 00:00 0 
40001020000-40001080000 r-xp 00000000 00:16 14674565                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libreadline.so.7.0
40001080000-40001090000 r--p 00050000 00:16 14674565                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libreadline.so.7.0
40001090000-400010a0000 rw-p 00060000 00:16 14674565                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libreadline.so.7.0
400010a0000-40001340000 r-xp 00000000 00:16 16553231                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libgsl.so.19.3.0
40001340000-40001370000 r--p 00290000 00:16 16553231                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libgsl.so.19.3.0
40001370000-40001390000 rw-p 002c0000 00:16 16553231                     /shared/work_no_backup/ppc64-prefix/usr/lib64/libgsl.so.19.3.0
40001390000-400013a0000 rw-p 00000000 00:00 0 
400013b0000-400015c0000 r-xp 00000000 00:16 15211125                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libstdc++.so.6.0.21
400015c0000-400015f0000 r--p 00200000 00:16 15211125                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libstdc++.so.6.0.21
400015f0000-40001600000 rw-p 00230000 00:16 15211125                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libstdc++.so.6.0.21
40001600000-40001620000 r-xp 00000000 00:16 15211117                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libgcc_s.so.1
40001620000-40001630000 r--p 00010000 00:16 15211117                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libgcc_s.so.1
40001630000-40001640000 rw-p 00020000 00:16 15211117                     /shared/work_no_backup/ppc64-prefix/usr/lib64/gcc/powerpc64-unknown-linux-gnu/5.4.0/libgcc_s.so.1FAIL: chk_limit
PASS: chk_partfrac
FAIL: chk_fhan15
PASS: chk_fhan13
PASS: chk_factor
PASS: chk_geo
FAIL: chk_fhan0
PASS: chk_fhan21
PASS: chk_integrate
FAIL: chk_fhan2
FAIL: chk_cas
PASS: chk_xavier
FAIL: chk_fhan1
PASS: chk_normalize
FAIL: chk_morley_demo
FAIL: chk_fhan18
FAIL: chk_fhan12
FAIL: chk_fhan7
FAIL: chk_fhan20
FAIL: chk_fhan16
FAIL: chk_fhan9
FAIL: chk_fhan17
FAIL: chk_fhan8
FAIL: chk_fhan5
FAIL: chk_fhan3
FAIL: chk_fhan4
FAIL: chk_fhan6
FAIL: chk_fhan19
FAIL: chk_fhan14
FAIL: chk_fhan11
============================================================================
Testsuite summary for giac 1.2.3
============================================================================
# TOTAL: 30
# PASS:  8
# SKIP:  0
# XFAIL: 0
# FAIL:  22
# XPASS: 0
# ERROR: 0
```
I am starting to think my g++ is at fault :(



---

archive/issue_comments_332013.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">Comment 57</div>\n\n@ Jean-Pierre, what version of gcc did you test this with?",
    "created_at": "2017-06-08T00:24:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332013",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:57" align="right">Comment 57</div>

@ Jean-Pierre, what version of gcc did you test this with?



---

archive/issue_comments_332014.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nAn old one:\n\n```\ngcc -v\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/libexec/gcc/ppc64-redhat-linux/4.8.3/lto-wrapper\nTarget: ppc64-redhat-linux\nConfigured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style=gnu --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-initfini-array --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-isl=/builddir/build/BUILD/gcc-4.8.3-20140911/obj-ppc64-redhat-linux/isl-install --with-cloog=/builddir/build/BUILD/gcc-4.8.3-20140911/obj-ppc64-redhat-linux/cloog-install --enable-secureplt --with-long-double-128 --build=ppc64-redhat-linux\nThread model: posix\ngcc version 4.8.3 20140911 (Red Hat 4.8.3-7) (GCC)\n```\nI did not run giac testsuite though.",
    "created_at": "2017-06-08T11:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332014",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:58" align="right">Comment 58</div>

An old one:

```
gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/libexec/gcc/ppc64-redhat-linux/4.8.3/lto-wrapper
Target: ppc64-redhat-linux
Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style=gnu --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-initfini-array --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-isl=/builddir/build/BUILD/gcc-4.8.3-20140911/obj-ppc64-redhat-linux/isl-install --with-cloog=/builddir/build/BUILD/gcc-4.8.3-20140911/obj-ppc64-redhat-linux/cloog-install --enable-secureplt --with-long-double-128 --build=ppc64-redhat-linux
Thread model: posix
gcc version 4.8.3 20140911 (Red Hat 4.8.3-7) (GCC)
```
I did not run giac testsuite though.



---

archive/issue_comments_332015.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nReplying to [@jpflori](#comment%3A58):\n> An old one:\n> \n> ```\n> gcc -v\n> Using built-in specs.\n> COLLECT_GCC=gcc\n> COLLECT_LTO_WRAPPER=/usr/libexec/gcc/ppc64-redhat-linux/4.8.3/lto-wrapper\n> Target: ppc64-redhat-linux\n> Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style=gnu --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-initfini-array --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-isl=/builddir/build/BUILD/gcc-4.8.3-20140911/obj-ppc64-redhat-linux/isl-install --with-cloog=/builddir/build/BUILD/gcc-4.8.3-20140911/obj-ppc64-redhat-linux/cloog-install --enable-secureplt --with-long-double-128 --build=ppc64-redhat-linux\n> Thread model: posix\n> gcc version 4.8.3 20140911 (Red Hat 4.8.3-7) (GCC)\n> ```\n> I did not run giac testsuite though.\n\nAh, I never had trouble building it. Just running/testing it. It will be some work to get things to build with gcc 4.8.x, will have to find all the C++ dependencies before building.",
    "created_at": "2017-06-08T11:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332015",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:59" align="right">Comment 59</div>

Replying to [@jpflori](#comment%3A58):
> An old one:
> 
> ```
> gcc -v
> Using built-in specs.
> COLLECT_GCC=gcc
> COLLECT_LTO_WRAPPER=/usr/libexec/gcc/ppc64-redhat-linux/4.8.3/lto-wrapper
> Target: ppc64-redhat-linux
> Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style=gnu --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-initfini-array --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-isl=/builddir/build/BUILD/gcc-4.8.3-20140911/obj-ppc64-redhat-linux/isl-install --with-cloog=/builddir/build/BUILD/gcc-4.8.3-20140911/obj-ppc64-redhat-linux/cloog-install --enable-secureplt --with-long-double-128 --build=ppc64-redhat-linux
> Thread model: posix
> gcc version 4.8.3 20140911 (Red Hat 4.8.3-7) (GCC)
> ```
> I did not run giac testsuite though.

Ah, I never had trouble building it. Just running/testing it. It will be some work to get things to build with gcc 4.8.x, will have to find all the C++ dependencies before building.



---

archive/issue_comments_332016.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">Comment 60</div>\n\nMost tests seem to pass on my machine except for some numerical noise and some very long or looping tests I killed.",
    "created_at": "2017-06-08T12:20:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332016",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:60" align="right">Comment 60</div>

Most tests seem to pass on my machine except for some numerical noise and some very long or looping tests I killed.



---

archive/issue_comments_332017.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">Comment 61</div>\n\nReplying to [@jpflori](#comment%3A46):\n> Replying to [@sagetrac-tmonteil](#comment%3A44):\n> > Did you suggest the fix for libpng/lpng1x too ([/22159#comment:29 suggested on this comment])?\n\n> Nope, I did not...\n\n\nCould you please give me some hints on how to achieve this (which file to modify, and how) ?\n\n(sorry for not being able to help on the review, i do not have any ppc machine, my intel 32bit VM is trying it right now, just in case)",
    "created_at": "2017-06-15T12:06:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332017",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:61" align="right">Comment 61</div>

Replying to [@jpflori](#comment%3A46):
> Replying to [@sagetrac-tmonteil](#comment%3A44):
> > Did you suggest the fix for libpng/lpng1x too ([/22159#comment:29 suggested on this comment])?

> Nope, I did not...


Could you please give me some hints on how to achieve this (which file to modify, and how) ?

(sorry for not being able to help on the review, i do not have any ppc machine, my intel 32bit VM is trying it right now, just in case)



---

archive/issue_comments_332018.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">Comment 62</div>\n\nJust patch the `Makefile` to use `-lpng16` rather than `-lpng`.",
    "created_at": "2017-06-15T12:16:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332018",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:62" align="right">Comment 62</div>

Just patch the `Makefile` to use `-lpng16` rather than `-lpng`.



---

archive/issue_comments_332019.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\nCurrently `giac` configure png with\n\n```\nCONFIG_PNG=\"yes\"\nAC_ARG_ENABLE(png,\n        [AS_HELP_STRING([--enable-png], [Enable PNG library])],\n        [ if test \"x$enableval\" = \"xno\"; then CONFIG_PNG=\"no\"; fi], [])\n  \nif test \"x$CONFIG_PNG\" = \"xyes\"; then\n   AC_CHECK_HEADERS(png.h, AC_CHECK_LIB(png,main))\nfi\n```\nin `configure.in`. An option is to use `AC_CHECK_LIBS(main,[png16,png14,png12,png])` instead of `AC_CHECK_LIB`. For Jean-Pierre suggestion you have to do the replacement after configure is run. Because `AC_CHECK_LIB` is used `-lpng` is added to `LIBS` by configure.",
    "created_at": "2017-06-15T12:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332019",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:63" align="right">Comment 63</div>

Currently `giac` configure png with

```
CONFIG_PNG="yes"
AC_ARG_ENABLE(png,
        [AS_HELP_STRING([--enable-png], [Enable PNG library])],
        [ if test "x$enableval" = "xno"; then CONFIG_PNG="no"; fi], [])
  
if test "x$CONFIG_PNG" = "xyes"; then
   AC_CHECK_HEADERS(png.h, AC_CHECK_LIB(png,main))
fi
```
in `configure.in`. An option is to use `AC_CHECK_LIBS(main,[png16,png14,png12,png])` instead of `AC_CHECK_LIB`. For Jean-Pierre suggestion you have to do the replacement after configure is run. Because `AC_CHECK_LIB` is used `-lpng` is added to `LIBS` by configure.



---

archive/issue_comments_332020.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">Comment 64</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A61):\n> (sorry for not being able to help on the review, i do not have any ppc machine, my intel 32bit VM is trying it right now, just in case)\n\nFor what it worth, giac-1.2.3.47 from this ticket compiles and pass self-tests on both my 64bit laptop and 32bit VM (both running Debian GNU/Linux jessie).",
    "created_at": "2017-06-17T09:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332020",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:64" align="right">Comment 64</div>

Replying to [@sagetrac-tmonteil](#comment%3A61):
> (sorry for not being able to help on the review, i do not have any ppc machine, my intel 32bit VM is trying it right now, just in case)

For what it worth, giac-1.2.3.47 from this ticket compiles and pass self-tests on both my 64bit laptop and 32bit VM (both running Debian GNU/Linux jessie).



---

archive/issue_comments_332021.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">Comment 65</div>\n\nRagarding building giac with png support, thanks Jean-Pierre and Fran\u00e7ois for your hints, i opened #23262.",
    "created_at": "2017-06-17T09:05:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332021",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:65" align="right">Comment 65</div>

Ragarding building giac with png support, thanks Jean-Pierre and Fran√ßois for your hints, i opened #23262.



---

archive/issue_comments_332022.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">Comment 66</div>\n\nUnfortunately, I still have no luck on ppc64 with gcc-5.4.0. It is better than before in that some tests are now succeeding. But things seems to get stuck in a C++ allocator for a number of them.",
    "created_at": "2017-06-17T09:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332022",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:66" align="right">Comment 66</div>

Unfortunately, I still have no luck on ppc64 with gcc-5.4.0. It is better than before in that some tests are now succeeding. But things seems to get stuck in a C++ allocator for a number of them.



---

archive/issue_comments_332023.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">Comment 67</div>\n\nIs `giac` itself functional?\nThat is: is it only failing its testsuite or is it completely broken as well?",
    "created_at": "2017-06-19T09:37:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332023",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:67" align="right">Comment 67</div>

Is `giac` itself functional?
That is: is it only failing its testsuite or is it completely broken as well?



---

archive/issue_comments_332024.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">Comment 68</div>\n\nFair question. \"1+1\" works, the fact that some tests work means that it is working up to a point. I haven't tried to run the sage testsuite with it. Any tests I should run?",
    "created_at": "2017-06-19T09:47:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332024",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:68" align="right">Comment 68</div>

Fair question. "1+1" works, the fact that some tests work means that it is working up to a point. I haven't tried to run the sage testsuite with it. Any tests I should run?



---

archive/issue_comments_332025.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">Comment 69</div>\n\nMaybe `sage -t src/sage/interfaces/giac.py` and `rings` and `symbolic` would tell you if it looks functional or not.\n\nOn my side, `giac` also fails a lot of its own testsuite, inlcuding bunch of numerical noise, but also more worrying stuff i did not investigate, but running tests as above seems to indicate it is good enough for sage.",
    "created_at": "2017-06-19T09:51:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332025",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:69" align="right">Comment 69</div>

Maybe `sage -t src/sage/interfaces/giac.py` and `rings` and `symbolic` would tell you if it looks functional or not.

On my side, `giac` also fails a lot of its own testsuite, inlcuding bunch of numerical noise, but also more worrying stuff i did not investigate, but running tests as above seems to indicate it is good enough for sage.



---

archive/issue_events_293874.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-06-19T12:10:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293874"
}
```



---

archive/issue_events_293875.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-06-19T12:10:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293875"
}
```



---

archive/issue_comments_332026.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">Comment 70</div>\n\nOK, I did run those tests and the few failures I have are unrelated to `giac` (I'll have to investigate some of them more deeply but they are definitely not `giac`). I guess we can go ahead with this.",
    "created_at": "2017-06-19T12:10:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332026",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:70" align="right">Comment 70</div>

OK, I did run those tests and the few failures I have are unrelated to `giac` (I'll have to investigate some of them more deeply but they are definitely not `giac`). I guess we can go ahead with this.



---

archive/issue_comments_332027.json:
```json
{
    "body": "Reviewer: **Thierry Monteil, Jean-Pierre Flori, Fran\u00e7ois Bissey**",
    "created_at": "2017-06-19T12:10:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332027",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **Thierry Monteil, Jean-Pierre Flori, Fran√ßois Bissey**



---

archive/issue_comments_332028.json:
```json
{
    "body": "Changed branch from **[public/giac](https://github.com/sagemath/sagetrac-mirror/tree/public/giac)** to **[8dc4c88](https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959)**",
    "created_at": "2017-06-22T07:24:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332028",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/giac](https://github.com/sagemath/sagetrac-mirror/tree/public/giac)** to **[8dc4c88](https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959)**



---

archive/issue_events_293876.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-22T07:24:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293876"
}
```



---

archive/issue_events_293877.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "28669e4220fac094ce6b22509f1045243f137e3c",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-06-22T07:24:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22280#event-293877"
}
```



---

archive/issue_comments_332029.json:
```json
{
    "body": "Changed commit from **[8dc4c88](https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959)** to none",
    "created_at": "2017-06-24T13:34:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332029",
    "user": "https://github.com/infinity0"
}
```

Changed commit from **[8dc4c88](https://github.com/sagemath/sagetrac-mirror/commit/8dc4c88c3f7a0f9a8710f54d839cacc0936fd959)** to none



---

archive/issue_comments_332030.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">Comment 72</div>\n\nDo you guys know *why* the `-Dx86_64` is needed on ppc64? That is still a bug that should be fixed upstream. In theory upstream should [now be detecting](http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?p=8877#p8877) 64-bit in a cross-platform way so I'm confused why it fails on ppc64.",
    "created_at": "2017-06-24T13:34:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332030",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:72" align="right">Comment 72</div>

Do you guys know *why* the `-Dx86_64` is needed on ppc64? That is still a bug that should be fixed upstream. In theory upstream should [now be detecting](http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?p=8877#p8877) 64-bit in a cross-platform way so I'm confused why it fails on ppc64.



---

archive/issue_comments_332031.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">Comment 73</div>\n\n(sorry, I have no idea why my comment there deleted the commit field)\n\n(I can't seem to fix it either, even by Modifying the ticket with that commit)",
    "created_at": "2017-06-24T13:35:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332031",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:73" align="right">Comment 73</div>

(sorry, I have no idea why my comment there deleted the commit field)

(I can't seem to fix it either, even by Modifying the ticket with that commit)



---

archive/issue_comments_332032.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">Comment 74</div>\n\nAll tests pass for me for 1.2.3-51 on arm64 on Debian without further changes or extra flags, btw.",
    "created_at": "2017-06-24T13:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332032",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:74" align="right">Comment 74</div>

All tests pass for me for 1.2.3-51 on arm64 on Debian without further changes or extra flags, btw.



---

archive/issue_comments_332033.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">Comment 75</div>\n\nI'll have to try 1.2.3-51 on ppc64 without extra flags then. 1.2.3-47 builds but a lot of tests fail for me. We may want to consider a further upgrade.\n\nThe removal of the commit when you comment further is a \"feature\" of track. It is annoying but not harmfull.",
    "created_at": "2017-06-24T20:27:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332033",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:75" align="right">Comment 75</div>

I'll have to try 1.2.3-51 on ppc64 without extra flags then. 1.2.3-47 builds but a lot of tests fail for me. We may want to consider a further upgrade.

The removal of the commit when you comment further is a "feature" of track. It is annoying but not harmfull.



---

archive/issue_comments_332034.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">Comment 76</div>\n\nWell, you probably don't have that problem but I allow compilation without gui, and sage itself doesn't depend on fltk\n\n```\n  bool has_graph3d(Fl_Widget * widget){\n#ifdef HAVE_LIBFLTK\n    Fl_Group * g=dynamic_cast<Fl_Group *>(widget);\n```\nOooops! in src/Xcas.cc (line 3360) there goes your compilation failure if you don't have fltk.",
    "created_at": "2017-06-24T21:46:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332034",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:76" align="right">Comment 76</div>

Well, you probably don't have that problem but I allow compilation without gui, and sage itself doesn't depend on fltk

```
  bool has_graph3d(Fl_Widget * widget){
#ifdef HAVE_LIBFLTK
    Fl_Group * g=dynamic_cast<Fl_Group *>(widget);
```
Oooops! in src/Xcas.cc (line 3360) there goes your compilation failure if you don't have fltk.



---

archive/issue_comments_332035.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">Comment 77</div>\n\nI have found that annoying too, in Debian I am forced to ship the non-GUI icas program (which is what Sage actually wants) together with the GUI xcas program, and it even links against X libraries. I've [filed a bug](http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1812) about it upstream, hopefully they can fix it.",
    "created_at": "2017-06-25T13:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332035",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:77" align="right">Comment 77</div>

I have found that annoying too, in Debian I am forced to ship the non-GUI icas program (which is what Sage actually wants) together with the GUI xcas program, and it even links against X libraries. I've [filed a bug](http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1812) about it upstream, hopefully they can fix it.



---

archive/issue_comments_332036.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">Comment 78</div>\n\nWell, I pilled up some more in http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1814 because your request, I felt, was much broader than mine (but yes something should be done about all that X stuff).",
    "created_at": "2017-06-25T22:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332036",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:78" align="right">Comment 78</div>

Well, I pilled up some more in http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?f=4&t=1814 because your request, I felt, was much broader than mine (but yes something should be done about all that X stuff).



---

archive/issue_comments_332037.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">Comment 79</div>\n\nUnfortunately giac fails to compile for me on a arm64 (aarch64) 4.9 Linux kernel:\n\nhttp://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?p=8941#p8941\n\nIt succeeded on a 3.16 Linux kernel though, as I reported above. Could someone reproduce this and if so re-open this ticket or open another one?",
    "created_at": "2017-07-19T12:08:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332037",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:79" align="right">Comment 79</div>

Unfortunately giac fails to compile for me on a arm64 (aarch64) 4.9 Linux kernel:

http://xcas.e.ujf-grenoble.fr/XCAS/viewtopic.php?p=8941#p8941

It succeeded on a 3.16 Linux kernel though, as I reported above. Could someone reproduce this and if so re-open this ticket or open another one?



---

archive/issue_comments_332038.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">Comment 80</div>\n\nA potential solution to this has been suggested on the Debian bug tracker: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=855078#29\n\nI'll try to test it next week, in the meantime feel free to jump in ahead.",
    "created_at": "2017-07-19T12:14:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22280",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22280#issuecomment-332038",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:80" align="right">Comment 80</div>

A potential solution to this has been suggested on the Debian bug tracker: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=855078#29

I'll try to test it next week, in the meantime feel free to jump in ahead.
