# Issue 22574: Add .change_ring() method for polyhedra

archive/issues_022337.json:
```json
{
    "body": "Polyhedra can be defined in different rings, and this method allows to transform between rings (compare to the similar feature for matrices).\n\nTODO:\n- Once done, add it to tutorial\n\nCC:  @mkoeppe @jplab\n\nKeywords: days84, polytope\n\nBranch/Commit: c9b92dbc55f09e73e00c307bf19fa59d52d898e0\n\nReviewer: Jean-Philippe Labb\u00e9\n\nAuthor: Laith Rastanawi\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22574\n\n",
    "closed_at": "2019-03-14T18:14:01Z",
    "created_at": "2017-03-10T15:18:54Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Add .change_ring() method for polyhedra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22574",
    "user": "https://github.com/mforets"
}
```
Polyhedra can be defined in different rings, and this method allows to transform between rings (compare to the similar feature for matrices).

TODO:
- Once done, add it to tutorial

CC:  @mkoeppe @jplab

Keywords: days84, polytope

Branch/Commit: c9b92dbc55f09e73e00c307bf19fa59d52d898e0

Reviewer: Jean-Philippe Labbé

Author: Laith Rastanawi

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22574





---

archive/issue_comments_419528.json:
```json
{
    "body": "<a id='comment:1'></a>\nThere is currently:\n\n```\n\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P\nA 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray\nsage: P_QQ = P.base_extend(QQ); P_QQ\nA 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 1 ray\n\n```\n\nCould there be a boolean parameter such as `inplace` (similar as in graphs and simplicial complexes...) to determine if one should create a new object or just change the base ring?\n\nI am wondering how much changing the base ring changes the internals of the polyhedron object. Would many things break? We can try and see...",
    "created_at": "2017-03-15T15:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419528",
    "user": "https://github.com/jplab"
}
```

<a id='comment:1'></a>
There is currently:

```

sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P
A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray
sage: P_QQ = P.base_extend(QQ); P_QQ
A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 2 vertices and 1 ray

```

Could there be a boolean parameter such as `inplace` (similar as in graphs and simplicial complexes...) to determine if one should create a new object or just change the base ring?

I am wondering how much changing the base ring changes the internals of the polyhedron object. Would many things break? We can try and see...



---

archive/issue_comments_419529.json:
```json
{
    "body": "<a id='comment:2'></a>\nI think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.",
    "created_at": "2017-03-15T19:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419529",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.



---

archive/issue_comments_419530.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [mkoeppe](#comment%3A2):\n> I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.\n\n\nAgreed.\n\nFurther, I don't really like the fact that hidden in `base_extend` is the possibility to change the backend, which as a matter of fact doesn't work. This is not user-friendly to say the least. I would therefore also deprecate the keyword completely and point to a `.change_backend()` method (see #22575). I guess that such a method will take care to handle the modifications of base ring if need be...",
    "created_at": "2017-03-15T19:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419530",
    "user": "https://github.com/jplab"
}
```

<a id='comment:3'></a>
Replying to [mkoeppe](#comment%3A2):
> I think there is no value in trying to implement `inplace` -- the various base rings are handled by different classes after all. Moreover, right now polyhedra are immutable - and it would be strange to be able to mutate the base ring but nothing else.


Agreed.

Further, I don't really like the fact that hidden in `base_extend` is the possibility to change the backend, which as a matter of fact doesn't work. This is not user-friendly to say the least. I would therefore also deprecate the keyword completely and point to a `.change_backend()` method (see #22575). I guess that such a method will take care to handle the modifications of base ring if need be...



---

archive/issue_comments_419531.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n Polyhedra can be defined in different rings, and this method allows to transform between rings (compare to the similar feature for matrices).\n+\n+TODO:\n+- Once done, add it to tutorial\n``````\n",
    "created_at": "2018-02-26T12:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419531",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,4 @@
 Polyhedra can be defined in different rings, and this method allows to transform between rings (compare to the similar feature for matrices).
+
+TODO:
+- Once done, add it to tutorial
``````




---

archive/issue_comments_419532.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-LaisRast/change_ring\"",
    "created_at": "2019-02-15T11:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419532",
    "user": "https://github.com/LaisRast"
}
```

Changing branch from "" to "u/gh-LaisRast/change_ring"



---

archive/issue_comments_419533.json:
```json
{
    "body": "<a id='comment:5'></a>\nNew commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[5f61767](https://git.sagemath.org/sage.git/commit?id=5f617670bb3af64f3fb1519f562a5e4dd5666c4d)|`add change_ring to base.py and parent.py`|",
    "created_at": "2019-02-15T11:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419533",
    "user": "https://github.com/LaisRast"
}
```

<a id='comment:5'></a>
New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[5f61767](https://git.sagemath.org/sage.git/commit?id=5f617670bb3af64f3fb1519f562a5e4dd5666c4d)|`add change_ring to base.py and parent.py`|



---

archive/issue_comments_419534.json:
```json
{
    "body": "Changing commit from \"\" to \"5f617670bb3af64f3fb1519f562a5e4dd5666c4d\"",
    "created_at": "2019-02-15T11:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419534",
    "user": "https://github.com/LaisRast"
}
```

Changing commit from "" to "5f617670bb3af64f3fb1519f562a5e4dd5666c4d"



---

archive/issue_comments_419535.json:
```json
{
    "body": "Changing commit from \"5f617670bb3af64f3fb1519f562a5e4dd5666c4d\" to \"6cdd9d551bbbb0521c1b08aa959ffeb51ce299f3\"",
    "created_at": "2019-02-15T15:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5f617670bb3af64f3fb1519f562a5e4dd5666c4d" to "6cdd9d551bbbb0521c1b08aa959ffeb51ce299f3"



---

archive/issue_comments_419536.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|\n|[6cdd9d5](https://git.sagemath.org/sage.git/commit/?id=6cdd9d551bbbb0521c1b08aa959ffeb51ce299f3)|`add documentation`|",
    "created_at": "2019-02-15T15:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419536",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------|
|[6cdd9d5](https://git.sagemath.org/sage.git/commit/?id=6cdd9d551bbbb0521c1b08aa959ffeb51ce299f3)|`add documentation`|



---

archive/issue_comments_419537.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-02-15T15:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419537",
    "user": "https://github.com/LaisRast"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_419538.json:
```json
{
    "body": "<a id='comment:8'></a>\nHi,\n\nHere are a couple of things I saw:\n\n- Adapt the convention for the input, see for example `vertex_facet_graph`:\n\n```diff\n+        - ``backend`` -- the new backend, see\n+            :func:`~sage.geometry.polyhedron.constructor.Polyhedron`.\n+            If ``None`` (the default), use the same defaulting behavior\n+            as described there; it is not attempted to keep the same\n+            backend.\n```\n- It would be good to have more examples with all the potential pairings.\n\n- Further, it would be nice to handle the potential error in the function when coercing from `QQ` to `ZZ` and return a message like: 'Can not change the ring to `ZZ`: a coordinate is rational'. And these examples should be added after the examples that do work.",
    "created_at": "2019-02-22T10:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419538",
    "user": "https://github.com/jplab"
}
```

<a id='comment:8'></a>
Hi,

Here are a couple of things I saw:

- Adapt the convention for the input, see for example `vertex_facet_graph`:

```diff
+        - ``backend`` -- the new backend, see
+            :func:`~sage.geometry.polyhedron.constructor.Polyhedron`.
+            If ``None`` (the default), use the same defaulting behavior
+            as described there; it is not attempted to keep the same
+            backend.
```
- It would be good to have more examples with all the potential pairings.

- Further, it would be nice to handle the potential error in the function when coercing from `QQ` to `ZZ` and return a message like: 'Can not change the ring to `ZZ`: a coordinate is rational'. And these examples should be added after the examples that do work.



---

archive/issue_comments_419539.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-22T10:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419539",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_419540.json:
```json
{
    "body": "Changing commit from \"6cdd9d551bbbb0521c1b08aa959ffeb51ce299f3\" to \"c9b92dbc55f09e73e00c307bf19fa59d52d898e0\"",
    "created_at": "2019-03-01T10:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419540",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6cdd9d551bbbb0521c1b08aa959ffeb51ce299f3" to "c9b92dbc55f09e73e00c307bf19fa59d52d898e0"



---

archive/issue_comments_419541.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[c9b92db](https://git.sagemath.org/sage.git/commit/?id=c9b92dbc55f09e73e00c307bf19fa59d52d898e0)|`Add more debug output/Add more documentation`|",
    "created_at": "2019-03-01T10:37:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419541",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[c9b92db](https://git.sagemath.org/sage.git/commit/?id=c9b92dbc55f09e73e00c307bf19fa59d52d898e0)|`Add more debug output/Add more documentation`|



---

archive/issue_comments_419542.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-03-01T10:39:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419542",
    "user": "https://github.com/LaisRast"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_058941.json:
```json
{
    "actor": "https://github.com/LaisRast",
    "created_at": "2019-03-01T10:39:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22574#event-58941"
}
```



---

archive/issue_comments_419543.json:
```json
{
    "body": "Changing author from \"\" to \"Laith Rastanawi\"",
    "created_at": "2019-03-05T13:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419543",
    "user": "https://github.com/jplab"
}
```

Changing author from "" to "Laith Rastanawi"



---

archive/issue_comments_419544.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jean-Philippe Labb\u00e9\"",
    "created_at": "2019-03-05T13:25:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419544",
    "user": "https://github.com/jplab"
}
```

Changing reviewer from "" to "Jean-Philippe Labbé"



---

archive/issue_comments_419545.json:
```json
{
    "body": "<a id='comment:12'></a>\nThis looks good to me.",
    "created_at": "2019-03-13T09:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419545",
    "user": "https://github.com/jplab"
}
```

<a id='comment:12'></a>
This looks good to me.



---

archive/issue_comments_419546.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-13T09:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419546",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_419547.json:
```json
{
    "body": "Changing branch from \"u/gh-LaisRast/change_ring\" to \"c9b92dbc55f09e73e00c307bf19fa59d52d898e0\"",
    "created_at": "2019-03-14T18:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419547",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/gh-LaisRast/change_ring" to "c9b92dbc55f09e73e00c307bf19fa59d52d898e0"



---

archive/issue_comments_419548.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-14T18:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22574#issuecomment-419548",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_058942.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-14T18:14:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22574",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22574#event-58942"
}
```
