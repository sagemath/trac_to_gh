# Issue 22439: Fix use of scipy rtol parameter

archive/issues_022202.json:
```json
{
    "assignees": [],
    "body": "Otherwise it doesn't work with Debian's version of scipy\n\n**Branch/Commit:** [e9ebab2e0fe8202c35a2f6070bf1ebd876136e05](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)\n\n**Reviewer:** Jeroen Demeyer\n\n**Author:** Ximin Luo\n\nIssue created by migration from https://trac.sagemath.org/ticket/22439\n\n",
    "closed_at": "2017-03-27T20:42:23Z",
    "created_at": "2017-02-25T15:18:27Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix use of scipy rtol parameter",
    "type": "issue",
    "updated_at": "2017-03-27T20:42:23Z",
    "url": "https://github.com/sagemath/sage/issues/22439",
    "user": "https://github.com/infinity0"
}
```
Otherwise it doesn't work with Debian's version of scipy

**Branch/Commit:** [e9ebab2e0fe8202c35a2f6070bf1ebd876136e05](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)

**Reviewer:** Jeroen Demeyer

**Author:** Ximin Luo

Issue created by migration from https://trac.sagemath.org/ticket/22439





---

archive/issue_events_272105.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:18:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272105"
}
```



---

archive/issue_comments_334571.json:
```json
{
    "body": "**Branch:** [u/infinity0/fix_use_of_scipy_rtol_parameter](https://github.com/sagemath/sagetrac-mirror/tree/u/infinity0/fix_use_of_scipy_rtol_parameter)",
    "created_at": "2017-02-25T15:18:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334571",
    "user": "https://github.com/infinity0"
}
```

**Branch:** [u/infinity0/fix_use_of_scipy_rtol_parameter](https://github.com/sagemath/sagetrac-mirror/tree/u/infinity0/fix_use_of_scipy_rtol_parameter)



---

archive/issue_comments_334572.json:
```json
{
    "body": "**Author:** Ximin Luo",
    "created_at": "2017-02-25T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334572",
    "user": "https://github.com/infinity0"
}
```

**Author:** Ximin Luo



---

archive/issue_comments_334573.json:
```json
{
    "body": "**Commit:** [50a0c646c900eaf24daca8e1aec54bd4eb373145](https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145)",
    "created_at": "2017-02-25T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334573",
    "user": "https://github.com/infinity0"
}
```

**Commit:** [50a0c646c900eaf24daca8e1aec54bd4eb373145](https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145)



---

archive/issue_comments_334574.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Otherwise it doesn't work with Debian's version of scipy\n``````\n",
    "created_at": "2017-02-25T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334574",
    "user": "https://github.com/infinity0"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Otherwise it doesn't work with Debian's version of scipy
``````




---

archive/issue_comments_334575.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145\">50a0c64</a></td><td><code>Fix Sage's use of scipy rtol parameter</code></td></tr></table>\n",
    "created_at": "2017-02-25T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334575",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:2'>**Comment 2:**</a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145">50a0c64</a></td><td><code>Fix Sage's use of scipy rtol parameter</code></td></tr></table>




---

archive/issue_events_272106.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:20:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272106"
}
```



---

archive/issue_events_272107.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:20:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
    "label_color": "08517b",
    "label_name": "component: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272107"
}
```



---

archive/issue_events_272108.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:26:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272108"
}
```



---

archive/issue_events_272109.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-02-25T19:18:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272109"
}
```



---

archive/issue_events_272110.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-02-25T19:18:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272110"
}
```



---

archive/issue_comments_334576.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nThis seems a bit over-engineered to me. What exactly is the problem?",
    "created_at": "2017-02-25T19:18:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334576",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'>**Comment 4:**</a>
This seems a bit over-engineered to me. What exactly is the problem?



---

archive/issue_comments_334577.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nI mean: why not just change the default value of `rtol` directly?",
    "created_at": "2017-02-25T20:01:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334577",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'>**Comment 5:**</a>
I mean: why not just change the default value of `rtol` directly?



---

archive/issue_comments_334578.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nOh, that is because `sage.numerical.optimize` is not imported until we actually run that function. But the default value of a function has to be available when the function is defined, i.e. before it is run.\n\nAn alternative is to define `default_rtol` in some other module and have both `sage/numerical/optimize.py` and `src/sage/symbolic/expression.pyx` import this module at the top, unconditionally. Do you have a suggestion on which module this could be?",
    "created_at": "2017-02-25T22:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334578",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:6'>**Comment 6:**</a>
Oh, that is because `sage.numerical.optimize` is not imported until we actually run that function. But the default value of a function has to be available when the function is defined, i.e. before it is run.

An alternative is to define `default_rtol` in some other module and have both `sage/numerical/optimize.py` and `src/sage/symbolic/expression.pyx` import this module at the top, unconditionally. Do you have a suggestion on which module this could be?



---

archive/issue_comments_334579.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nReplying to [@infinity0](#comment%3A6):\n> An alternative is to define `default_rtol`\n\nWhy is that needed?\n\nWhy not just change the default value and nothing else?",
    "created_at": "2017-02-26T10:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334579",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'>**Comment 7:**</a>
Replying to [@infinity0](#comment%3A6):
> An alternative is to define `default_rtol`

Why is that needed?

Why not just change the default value and nothing else?



---

archive/issue_comments_334580.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nTo change the default value in both locations as you're suggesting, I would have to write `4*finfo(float).eps` in two modules.\n\nThe definition comes from the [documentation](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq) of scipy yet is a calculation on a numpy architecture-dependent property. (The docs say `8.88..e-16`, giving away the architecture of the build machine.) I was unsure if this might change in the future, so I only wanted to define it once, and avoid coupling two Sage modules to what looks like a numpy implementation detail but is actually one of scipy's.\n\nIt's unfortunate that scipy don't expose the value themselves. Actually, I will send a patch to them for that, when I next get some time. I just noticed again that it's available as `from scipy.optimize.zeros import _rtol`, i.e. a \"private\" variable, but this could be properly exposed.\n\nIn the meantime, shall I do it your way and duplicate the definitions?",
    "created_at": "2017-02-26T12:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334580",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:8'>**Comment 8:**</a>
To change the default value in both locations as you're suggesting, I would have to write `4*finfo(float).eps` in two modules.

The definition comes from the [documentation](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq) of scipy yet is a calculation on a numpy architecture-dependent property. (The docs say `8.88..e-16`, giving away the architecture of the build machine.) I was unsure if this might change in the future, so I only wanted to define it once, and avoid coupling two Sage modules to what looks like a numpy implementation detail but is actually one of scipy's.

It's unfortunate that scipy don't expose the value themselves. Actually, I will send a patch to them for that, when I next get some time. I just noticed again that it's available as `from scipy.optimize.zeros import _rtol`, i.e. a "private" variable, but this could be properly exposed.

In the meantime, shall I do it your way and duplicate the definitions?



---

archive/issue_comments_334581.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nAre you sure that this value is architecture-dependent? I think it's just the constant `2.0 ** -50`.",
    "created_at": "2017-02-26T19:00:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334581",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'>**Comment 9:**</a>
Are you sure that this value is architecture-dependent? I think it's just the constant `2.0 ** -50`.



---

archive/issue_comments_334582.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nI'm not confident how architecture-dependent this is; numpy themselves perform quite a long complex calculation in `numpy.core.getlimits` and `numpy.core.machar`, and also Sage currently thinks it's a different value. (The code says 4.5e-16).\n\nI think it would be safer to use the symbolic value as indicated in the scipy documentation, than try to guess that it might be architecture-dependent. (It's true that Sage only works on x86 and x64 right now, but there's no need to add more obstacles to portability.)",
    "created_at": "2017-03-11T16:51:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334582",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:10'>**Comment 10:**</a>
I'm not confident how architecture-dependent this is; numpy themselves perform quite a long complex calculation in `numpy.core.getlimits` and `numpy.core.machar`, and also Sage currently thinks it's a different value. (The code says 4.5e-16).

I think it would be safer to use the symbolic value as indicated in the scipy documentation, than try to guess that it might be architecture-dependent. (It's true that Sage only works on x86 and x64 right now, but there's no need to add more obstacles to portability.)



---

archive/issue_comments_334583.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nReplying to [@infinity0](#comment%3A10):\n> also Sage currently thinks it's a different value. (The code says 4.5e-16).\n\nSage doesn't \"think\" it's a different value, Sage just hardcodes a different number.\n\nSo why does this default value for `rtol` even need to be equal to whatever `scipy` uses?",
    "created_at": "2017-03-11T19:51:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334583",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'>**Comment 11:**</a>
Replying to [@infinity0](#comment%3A10):
> also Sage currently thinks it's a different value. (The code says 4.5e-16).

Sage doesn't "think" it's a different value, Sage just hardcodes a different number.

So why does this default value for `rtol` even need to be equal to whatever `scipy` uses?



---

archive/issue_comments_334584.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nIt needs to be greater than the documented minimum, otherwise we get errors.\n\nFrom the [documentation](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq):\n\nrtol [..] cannot be smaller than its default value of `4*np.finfo(float).eps`.",
    "created_at": "2017-03-11T20:52:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334584",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:12'>**Comment 12:**</a>
It needs to be greater than the documented minimum, otherwise we get errors.

From the [documentation](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq):

rtol [..] cannot be smaller than its default value of `4*np.finfo(float).eps`.



---

archive/issue_comments_334585.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nReplying to [@infinity0](#comment%3A10):\n> I'm not confident how architecture-dependent this is\n\nAccording to [Wikipedia](https://en.wikipedia.org/wiki/Double-precision_floating-point_format#C_and_C.2B.2B), a C `double` (which is how Python implements `float`) is required by C99 to be an [IEEE-754](https://en.wikipedia.org/wiki/IEEE_floating_point) double precision number. So that would make it not architecture dependent.",
    "created_at": "2017-03-11T21:19:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334585",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'>**Comment 13:**</a>
Replying to [@infinity0](#comment%3A10):
> I'm not confident how architecture-dependent this is

According to [Wikipedia](https://en.wikipedia.org/wiki/Double-precision_floating-point_format#C_and_C.2B.2B), a C `double` (which is how Python implements `float`) is required by C99 to be an [IEEE-754](https://en.wikipedia.org/wiki/IEEE_floating_point) double precision number. So that would make it not architecture dependent.



---

archive/issue_comments_334586.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nIn other words: even though it might theoretically be architecture-dependent, in practice it's not.",
    "created_at": "2017-03-11T21:20:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334586",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'>**Comment 14:**</a>
In other words: even though it might theoretically be architecture-dependent, in practice it's not.



---

archive/issue_comments_334587.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nReplying to [@infinity0](#comment%3A10):\n> It's true that Sage only works on x86 and x64 right now\n\nFor the record: we do consider that a bug: #22280. In the past, Sage has worked on SPARC, Itanium, various kinds of PowerPCs, ARM (some of these with a few issues).",
    "created_at": "2017-03-11T21:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334587",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'>**Comment 15:**</a>
Replying to [@infinity0](#comment%3A10):
> It's true that Sage only works on x86 and x64 right now

For the record: we do consider that a bug: #22280. In the past, Sage has worked on SPARC, Itanium, various kinds of PowerPCs, ARM (some of these with a few issues).



---

archive/issue_comments_334588.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nOK, I see\n\n```\ntypedef struct {\n    PyObject_HEAD\n    double ob_fval;\n} PyFloatObject;\n```\n\nin python's `Include/floatobject.h` so I guess this is fine. So you want me to rewrite the patch to hard-code `2.0 ** -50` instead? I'll add some comments too.",
    "created_at": "2017-03-11T22:33:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334588",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:16'>**Comment 16:**</a>
OK, I see

```
typedef struct {
    PyObject_HEAD
    double ob_fval;
} PyFloatObject;
```

in python's `Include/floatobject.h` so I guess this is fine. So you want me to rewrite the patch to hard-code `2.0 ** -50` instead? I'll add some comments too.



---

archive/issue_comments_334589.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nReplying to [@infinity0](#comment%3A16):\n> So you want me to rewrite the patch to hard-code `2.0 ** -50` instead? I'll add some comments too.\n\n\nSounds good.",
    "created_at": "2017-03-12T08:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334589",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'>**Comment 17:**</a>
Replying to [@infinity0](#comment%3A16):
> So you want me to rewrite the patch to hard-code `2.0 ** -50` instead? I'll add some comments too.


Sounds good.



---

archive/issue_comments_334590.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05\">e9ebab2</a></td><td><code>Fix Sage's use of scipy rtol parameter</code></td></tr></table>\n",
    "created_at": "2017-03-12T15:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334590",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:18'>**Comment 18:**</a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05">e9ebab2</a></td><td><code>Fix Sage's use of scipy rtol parameter</code></td></tr></table>




---

archive/issue_comments_334591.json:
```json
{
    "body": "**Changing commit** from \"[50a0c646c900eaf24daca8e1aec54bd4eb373145](https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145)\" to \"[e9ebab2e0fe8202c35a2f6070bf1ebd876136e05](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)\".",
    "created_at": "2017-03-12T15:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334591",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[50a0c646c900eaf24daca8e1aec54bd4eb373145](https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145)" to "[e9ebab2e0fe8202c35a2f6070bf1ebd876136e05](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)".



---

archive/issue_events_272111.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-03-12T15:42:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272111"
}
```



---

archive/issue_events_272112.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-03-12T15:42:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272112"
}
```



---

archive/issue_comments_334592.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nOh, I dug a bit deeper and found that scipy changed the meaning of this flag between 0.17.1 and 0.18.1. Sage's current usage is also OK for the older version but not the newer version:\n\nhttps://github.com/scipy/scipy/commit/cbd91b93c752eb2e947c2b657fe0471a12759b83#diff-9167bb8d33bd7d9eb5e07e0ebe18e05e\n\nI'm unsure if this patch will cause any extra doctest failures for Sage upstream and scipy 0.17.1, but I guess we'll see that when a build is run.\n\n(On Debian, we are also patching some doctests to expect slightly different float results, but I can't remember which of these are caused by scipy. The differences are minute, of course.)",
    "created_at": "2017-03-12T15:52:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334592",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:20'>**Comment 20:**</a>
Oh, I dug a bit deeper and found that scipy changed the meaning of this flag between 0.17.1 and 0.18.1. Sage's current usage is also OK for the older version but not the newer version:

https://github.com/scipy/scipy/commit/cbd91b93c752eb2e947c2b657fe0471a12759b83#diff-9167bb8d33bd7d9eb5e07e0ebe18e05e

I'm unsure if this patch will cause any extra doctest failures for Sage upstream and scipy 0.17.1, but I guess we'll see that when a build is run.

(On Debian, we are also patching some doctests to expect slightly different float results, but I can't remember which of these are caused by scipy. The differences are minute, of course.)



---

archive/issue_comments_334593.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nI guess it may be best to put off this change until you guys upgrade to scipy >= 0.18.1. At least, the extra doc comment I added in that commit is wrong for scipy 0.17.1.",
    "created_at": "2017-03-12T15:59:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334593",
    "user": "https://github.com/infinity0"
}
```

<a id='comment:21'>**Comment 21:**</a>
I guess it may be best to put off this change until you guys upgrade to scipy >= 0.18.1. At least, the extra doc comment I added in that commit is wrong for scipy 0.17.1.



---

archive/issue_comments_334594.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2017-03-18T10:06:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334594",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_events_272113.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-03-18T10:06:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272113"
}
```



---

archive/issue_events_272114.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-03-18T10:06:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272114"
}
```



---

archive/issue_events_272115.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-27T20:42:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272115"
}
```



---

archive/issue_events_272116.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "1a2ac2be4a2934816dd2490f5e7f1e82540d8f5a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-03-27T20:42:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-272116"
}
```



---

archive/issue_comments_334595.json:
```json
{
    "body": "**Changing branch** from \"[u/infinity0/fix_use_of_scipy_rtol_parameter](https://github.com/sagemath/sagetrac-mirror/tree/u/infinity0/fix_use_of_scipy_rtol_parameter)\" to \"[e9ebab2e0fe8202c35a2f6070bf1ebd876136e05](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)\".",
    "created_at": "2017-03-27T20:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-334595",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/infinity0/fix_use_of_scipy_rtol_parameter](https://github.com/sagemath/sagetrac-mirror/tree/u/infinity0/fix_use_of_scipy_rtol_parameter)" to "[e9ebab2e0fe8202c35a2f6070bf1ebd876136e05](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)".
