# Issue 22439: Fix use of scipy rtol parameter

archive/issues_022202.json:
```json
{
    "assignees": [],
    "body": "Otherwise it doesn't work with Debian's version of scipy\n\nBranch/Commit: **[e9ebab2](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **Ximin Luo**\n\nComponent: **interfaces**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22439_\n\n",
    "closed_at": "2017-03-27T20:42:23Z",
    "created_at": "2017-02-25T15:18:27Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix use of scipy rtol parameter",
    "type": "issue",
    "updated_at": "2017-03-27T20:42:23Z",
    "url": "https://github.com/sagemath/sage/issues/22439",
    "user": "https://github.com/infinity0"
}
```
Otherwise it doesn't work with Debian's version of scipy

Branch/Commit: **[e9ebab2](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)**

Reviewer: **Jeroen Demeyer**

Author: **Ximin Luo**

Component: **interfaces**

_Issue created by migration from https://trac.sagemath.org/ticket/22439_





---

archive/issue_events_313661.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:18:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313661"
}
```



---

archive/issue_events_313662.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:18:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313662"
}
```



---

archive/issue_comments_332087.json:
```json
{
    "body": "Branch: **[u/infinity0/fix_use_of_scipy_rtol_parameter](https://github.com/sagemath/sagetrac-mirror/tree/u/infinity0/fix_use_of_scipy_rtol_parameter)**",
    "created_at": "2017-02-25T15:18:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332087",
    "user": "https://github.com/infinity0"
}
```

Branch: **[u/infinity0/fix_use_of_scipy_rtol_parameter](https://github.com/sagemath/sagetrac-mirror/tree/u/infinity0/fix_use_of_scipy_rtol_parameter)**



---

archive/issue_comments_332088.json:
```json
{
    "body": "Author: **Ximin Luo**",
    "created_at": "2017-02-25T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332088",
    "user": "https://github.com/infinity0"
}
```

Author: **Ximin Luo**



---

archive/issue_comments_332089.json:
```json
{
    "body": "Commit: **[50a0c64](https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145)**",
    "created_at": "2017-02-25T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332089",
    "user": "https://github.com/infinity0"
}
```

Commit: **[50a0c64](https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145)**



---

archive/issue_comments_332090.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Otherwise it doesn't work with Debian's version of scipy\n``````\n",
    "created_at": "2017-02-25T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332090",
    "user": "https://github.com/infinity0"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Otherwise it doesn't work with Debian's version of scipy
``````




---

archive/issue_comments_332091.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145\">50a0c64</a></td><td><code>Fix Sage's use of scipy rtol parameter</code></td></tr></table>\n",
    "created_at": "2017-02-25T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332091",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145">50a0c64</a></td><td><code>Fix Sage's use of scipy rtol parameter</code></td></tr></table>




---

archive/issue_events_313663.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:20:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313663"
}
```



---

archive/issue_events_313664.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:20:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "c: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313664"
}
```



---

archive/issue_events_313665.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-02-25T15:26:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313665"
}
```



---

archive/issue_events_313666.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-02-25T19:18:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313666"
}
```



---

archive/issue_events_313667.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-02-25T19:18:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313667"
}
```



---

archive/issue_comments_332092.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis seems a bit over-engineered to me. What exactly is the problem?",
    "created_at": "2017-02-25T19:18:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332092",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

This seems a bit over-engineered to me. What exactly is the problem?



---

archive/issue_comments_332093.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI mean: why not just change the default value of `rtol` directly?",
    "created_at": "2017-02-25T20:01:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332093",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

I mean: why not just change the default value of `rtol` directly?



---

archive/issue_comments_332094.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nOh, that is because `sage.numerical.optimize` is not imported until we actually run that function. But the default value of a function has to be available when the function is defined, i.e. before it is run.\n\nAn alternative is to define `default_rtol` in some other module and have both `sage/numerical/optimize.py` and `src/sage/symbolic/expression.pyx` import this module at the top, unconditionally. Do you have a suggestion on which module this could be?",
    "created_at": "2017-02-25T22:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332094",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:6" align="right">comment:6</div>

Oh, that is because `sage.numerical.optimize` is not imported until we actually run that function. But the default value of a function has to be available when the function is defined, i.e. before it is run.

An alternative is to define `default_rtol` in some other module and have both `sage/numerical/optimize.py` and `src/sage/symbolic/expression.pyx` import this module at the top, unconditionally. Do you have a suggestion on which module this could be?



---

archive/issue_comments_332095.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@infinity0](#comment:6):\n> An alternative is to define `default_rtol`\n\nWhy is that needed?\n\nWhy not just change the default value and nothing else?",
    "created_at": "2017-02-26T10:08:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332095",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@infinity0](#comment:6):
> An alternative is to define `default_rtol`

Why is that needed?

Why not just change the default value and nothing else?



---

archive/issue_comments_332096.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nTo change the default value in both locations as you're suggesting, I would have to write `4*finfo(float).eps` in two modules.\n\nThe definition comes from the [documentation](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq) of scipy yet is a calculation on a numpy architecture-dependent property. (The docs say `8.88..e-16`, giving away the architecture of the build machine.) I was unsure if this might change in the future, so I only wanted to define it once, and avoid coupling two Sage modules to what looks like a numpy implementation detail but is actually one of scipy's.\n\nIt's unfortunate that scipy don't expose the value themselves. Actually, I will send a patch to them for that, when I next get some time. I just noticed again that it's available as `from scipy.optimize.zeros import _rtol`, i.e. a \"private\" variable, but this could be properly exposed.\n\nIn the meantime, shall I do it your way and duplicate the definitions?",
    "created_at": "2017-02-26T12:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332096",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:8" align="right">comment:8</div>

To change the default value in both locations as you're suggesting, I would have to write `4*finfo(float).eps` in two modules.

The definition comes from the [documentation](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq) of scipy yet is a calculation on a numpy architecture-dependent property. (The docs say `8.88..e-16`, giving away the architecture of the build machine.) I was unsure if this might change in the future, so I only wanted to define it once, and avoid coupling two Sage modules to what looks like a numpy implementation detail but is actually one of scipy's.

It's unfortunate that scipy don't expose the value themselves. Actually, I will send a patch to them for that, when I next get some time. I just noticed again that it's available as `from scipy.optimize.zeros import _rtol`, i.e. a "private" variable, but this could be properly exposed.

In the meantime, shall I do it your way and duplicate the definitions?



---

archive/issue_comments_332097.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAre you sure that this value is architecture-dependent? I think it's just the constant `2.0 ** -50`.",
    "created_at": "2017-02-26T19:00:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332097",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Are you sure that this value is architecture-dependent? I think it's just the constant `2.0 ** -50`.



---

archive/issue_comments_332098.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI'm not confident how architecture-dependent this is; numpy themselves perform quite a long complex calculation in `numpy.core.getlimits` and `numpy.core.machar`, and also Sage currently thinks it's a different value. (The code says 4.5e-16).\n\nI think it would be safer to use the symbolic value as indicated in the scipy documentation, than try to guess that it might be architecture-dependent. (It's true that Sage only works on x86 and x64 right now, but there's no need to add more obstacles to portability.)",
    "created_at": "2017-03-11T16:51:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332098",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:10" align="right">comment:10</div>

I'm not confident how architecture-dependent this is; numpy themselves perform quite a long complex calculation in `numpy.core.getlimits` and `numpy.core.machar`, and also Sage currently thinks it's a different value. (The code says 4.5e-16).

I think it would be safer to use the symbolic value as indicated in the scipy documentation, than try to guess that it might be architecture-dependent. (It's true that Sage only works on x86 and x64 right now, but there's no need to add more obstacles to portability.)



---

archive/issue_comments_332099.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@infinity0](#comment:10):\n> also Sage currently thinks it's a different value. (The code says 4.5e-16).\n\nSage doesn't \"think\" it's a different value, Sage just hardcodes a different number.\n\nSo why does this default value for `rtol` even need to be equal to whatever `scipy` uses?",
    "created_at": "2017-03-11T19:51:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332099",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@infinity0](#comment:10):
> also Sage currently thinks it's a different value. (The code says 4.5e-16).

Sage doesn't "think" it's a different value, Sage just hardcodes a different number.

So why does this default value for `rtol` even need to be equal to whatever `scipy` uses?



---

archive/issue_comments_332100.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nIt needs to be greater than the documented minimum, otherwise we get errors.\n\nFrom the [documentation](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq):\n\nrtol [..] cannot be smaller than its default value of `4*np.finfo(float).eps`.",
    "created_at": "2017-03-11T20:52:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332100",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:12" align="right">comment:12</div>

It needs to be greater than the documented minimum, otherwise we get errors.

From the [documentation](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.optimize.brentq.html#scipy.optimize.brentq):

rtol [..] cannot be smaller than its default value of `4*np.finfo(float).eps`.



---

archive/issue_comments_332101.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@infinity0](#comment:10):\n> I'm not confident how architecture-dependent this is\n\nAccording to [Wikipedia](https://en.wikipedia.org/wiki/Double-precision_floating-point_format#C_and_C.2B.2B), a C `double` (which is how Python implements `float`) is required by C99 to be an [IEEE-754](https://en.wikipedia.org/wiki/IEEE_floating_point) double precision number. So that would make it not architecture dependent.",
    "created_at": "2017-03-11T21:19:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332101",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@infinity0](#comment:10):
> I'm not confident how architecture-dependent this is

According to [Wikipedia](https://en.wikipedia.org/wiki/Double-precision_floating-point_format#C_and_C.2B.2B), a C `double` (which is how Python implements `float`) is required by C99 to be an [IEEE-754](https://en.wikipedia.org/wiki/IEEE_floating_point) double precision number. So that would make it not architecture dependent.



---

archive/issue_comments_332102.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIn other words: even though it might theoretically be architecture-dependent, in practice it's not.",
    "created_at": "2017-03-11T21:20:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332102",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

In other words: even though it might theoretically be architecture-dependent, in practice it's not.



---

archive/issue_comments_332103.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@infinity0](#comment:10):\n> It's true that Sage only works on x86 and x64 right now\n\nFor the record: we do consider that a bug: #22280. In the past, Sage has worked on SPARC, Itanium, various kinds of PowerPCs, ARM (some of these with a few issues).",
    "created_at": "2017-03-11T21:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332103",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@infinity0](#comment:10):
> It's true that Sage only works on x86 and x64 right now

For the record: we do consider that a bug: #22280. In the past, Sage has worked on SPARC, Itanium, various kinds of PowerPCs, ARM (some of these with a few issues).



---

archive/issue_comments_332104.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOK, I see\n\n```\ntypedef struct {\n    PyObject_HEAD\n    double ob_fval;\n} PyFloatObject;\n```\n\nin python's `Include/floatobject.h` so I guess this is fine. So you want me to rewrite the patch to hard-code `2.0 ** -50` instead? I'll add some comments too.",
    "created_at": "2017-03-11T22:33:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332104",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:16" align="right">comment:16</div>

OK, I see

```
typedef struct {
    PyObject_HEAD
    double ob_fval;
} PyFloatObject;
```

in python's `Include/floatobject.h` so I guess this is fine. So you want me to rewrite the patch to hard-code `2.0 ** -50` instead? I'll add some comments too.



---

archive/issue_comments_332105.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@infinity0](#comment:16):\n> So you want me to rewrite the patch to hard-code `2.0 ** -50` instead? I'll add some comments too.\n\n\nSounds good.",
    "created_at": "2017-03-12T08:22:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332105",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@infinity0](#comment:16):
> So you want me to rewrite the patch to hard-code `2.0 ** -50` instead? I'll add some comments too.


Sounds good.



---

archive/issue_comments_332106.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05\">e9ebab2</a></td><td><code>Fix Sage's use of scipy rtol parameter</code></td></tr></table>\n",
    "created_at": "2017-03-12T15:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332106",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05">e9ebab2</a></td><td><code>Fix Sage's use of scipy rtol parameter</code></td></tr></table>




---

archive/issue_comments_332107.json:
```json
{
    "body": "Changed commit from **[50a0c64](https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145)** to **[e9ebab2](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)**",
    "created_at": "2017-03-12T15:41:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332107",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[50a0c64](https://github.com/sagemath/sagetrac-mirror/commit/50a0c646c900eaf24daca8e1aec54bd4eb373145)** to **[e9ebab2](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)**



---

archive/issue_events_313668.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-03-12T15:42:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313668"
}
```



---

archive/issue_events_313669.json:
```json
{
    "actor": "https://github.com/infinity0",
    "created_at": "2017-03-12T15:42:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313669"
}
```



---

archive/issue_comments_332108.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nOh, I dug a bit deeper and found that scipy changed the meaning of this flag between 0.17.1 and 0.18.1. Sage's current usage is also OK for the older version but not the newer version:\n\nhttps://github.com/scipy/scipy/commit/cbd91b93c752eb2e947c2b657fe0471a12759b83#diff-9167bb8d33bd7d9eb5e07e0ebe18e05e\n\nI'm unsure if this patch will cause any extra doctest failures for Sage upstream and scipy 0.17.1, but I guess we'll see that when a build is run.\n\n(On Debian, we are also patching some doctests to expect slightly different float results, but I can't remember which of these are caused by scipy. The differences are minute, of course.)",
    "created_at": "2017-03-12T15:52:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332108",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:20" align="right">comment:20</div>

Oh, I dug a bit deeper and found that scipy changed the meaning of this flag between 0.17.1 and 0.18.1. Sage's current usage is also OK for the older version but not the newer version:

https://github.com/scipy/scipy/commit/cbd91b93c752eb2e947c2b657fe0471a12759b83#diff-9167bb8d33bd7d9eb5e07e0ebe18e05e

I'm unsure if this patch will cause any extra doctest failures for Sage upstream and scipy 0.17.1, but I guess we'll see that when a build is run.

(On Debian, we are also patching some doctests to expect slightly different float results, but I can't remember which of these are caused by scipy. The differences are minute, of course.)



---

archive/issue_comments_332109.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI guess it may be best to put off this change until you guys upgrade to scipy >= 0.18.1. At least, the extra doc comment I added in that commit is wrong for scipy 0.17.1.",
    "created_at": "2017-03-12T15:59:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332109",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:21" align="right">comment:21</div>

I guess it may be best to put off this change until you guys upgrade to scipy >= 0.18.1. At least, the extra doc comment I added in that commit is wrong for scipy 0.17.1.



---

archive/issue_comments_332110.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2017-03-18T10:06:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332110",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_313670.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-03-18T10:06:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313670"
}
```



---

archive/issue_events_313671.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-03-18T10:06:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313671"
}
```



---

archive/issue_events_313672.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-27T20:42:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313672"
}
```



---

archive/issue_events_313673.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "1a2ac2be4a2934816dd2490f5e7f1e82540d8f5a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-03-27T20:42:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22439#event-313673"
}
```



---

archive/issue_comments_332111.json:
```json
{
    "body": "Changed branch from **[u/infinity0/fix_use_of_scipy_rtol_parameter](https://github.com/sagemath/sagetrac-mirror/tree/u/infinity0/fix_use_of_scipy_rtol_parameter)** to **[e9ebab2](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)**",
    "created_at": "2017-03-27T20:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22439",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22439#issuecomment-332111",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/infinity0/fix_use_of_scipy_rtol_parameter](https://github.com/sagemath/sagetrac-mirror/tree/u/infinity0/fix_use_of_scipy_rtol_parameter)** to **[e9ebab2](https://github.com/sagemath/sagetrac-mirror/commit/e9ebab2e0fe8202c35a2f6070bf1ebd876136e05)**
