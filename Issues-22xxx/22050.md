# Issue 22050: Complete graph on 2 vertices doesn't show any edges

archive/issues_021813.json:
```json
{
    "body": "\n```\ng = graphs.CompleteGraph(2)\ng.show()\n```\non the sage cell server http://sagecell.sagemath.org/ (running 'SageMath version 7.5.beta1, Release Date: 2016-10-31') and on Version 7.3 on my machine, running Ubuntu on X1 Carbon, produces a picture with no edges.  Other sizes of complete graphs seem to work fine.\n\nMore similar errors are all seemingly related to `matplotlib` being unable to draw not quite vertical line: same error in plotting\n`graphs.PathGraph(2,'circle')`, `graphs.StarGraph(1)`, `graphs.CircularLadderGraph(2)`,\n`graphs.StarGraph(2)`\n\nCC:  @dcoudert\n\nKeywords: graph theory, complete graph\n\nBranch/Commit: 9b3ffc60828e3993a2ad286d442916cf6ef68d78\n\nReviewer: Dima Pasechnik\n\nAuthor: David Coudert\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22050\n\n",
    "closed_at": "2018-10-05T16:56:46Z",
    "created_at": "2016-12-12T17:17:43Z",
    "labels": [
        "component: graph theory",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Complete graph on 2 vertices doesn't show any edges",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22050",
    "user": "https://github.com/katestange"
}
```

```
g = graphs.CompleteGraph(2)
g.show()
```
on the sage cell server http://sagecell.sagemath.org/ (running 'SageMath version 7.5.beta1, Release Date: 2016-10-31') and on Version 7.3 on my machine, running Ubuntu on X1 Carbon, produces a picture with no edges.  Other sizes of complete graphs seem to work fine.

More similar errors are all seemingly related to `matplotlib` being unable to draw not quite vertical line: same error in plotting
`graphs.PathGraph(2,'circle')`, `graphs.StarGraph(1)`, `graphs.CircularLadderGraph(2)`,
`graphs.StarGraph(2)`

CC:  @dcoudert

Keywords: graph theory, complete graph

Branch/Commit: 9b3ffc60828e3993a2ad286d442916cf6ef68d78

Reviewer: Dima Pasechnik

Author: David Coudert

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22050





---

archive/issue_comments_407780.json:
```json
{
    "body": "<a id='comment:1'></a>This happens with some other graphs, too, for example `graphs.CycleGraph(2)`.  In these cases, the layout is specified in the constructor and has positions extremely close to 0:\n\n```\nsage: C2 = graphs.CycleGraph(2)\nsage: C2.get_pos()\n{0: (6.123233995736766e-17, 1.0), 1: (-1.8369701987210297e-16, -1.0)}\nC2.show()\n```\n\nIf you manually set positions close to zero, the same phenomenon of invisible lines appears:\n\n```\nh = Graph([(0,1)])\nh.set_pos({0:(1e-3, 1), 1:(-1e-3,-1)})\nh.show()\n```\n\nThe same thing happens if the line is very nearly horizontal.",
    "created_at": "2017-01-30T18:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407780",
    "user": "https://trac.sagemath.org/admin/accounts/users/msaaltink"
}
```

<a id='comment:1'></a>This happens with some other graphs, too, for example `graphs.CycleGraph(2)`.  In these cases, the layout is specified in the constructor and has positions extremely close to 0:

```
sage: C2 = graphs.CycleGraph(2)
sage: C2.get_pos()
{0: (6.123233995736766e-17, 1.0), 1: (-1.8369701987210297e-16, -1.0)}
C2.show()
```

If you manually set positions close to zero, the same phenomenon of invisible lines appears:

```
h = Graph([(0,1)])
h.set_pos({0:(1e-3, 1), 1:(-1e-3,-1)})
h.show()
```

The same thing happens if the line is very nearly horizontal.



---

archive/issue_comments_407781.json:
```json
{
    "body": "<a id='comment:2'></a>This also happens with other graphics, e.g. a simple line:\n\n```\nsage: l = line2d([(1, 1e-6), (-1,-1e-6)])\nsage: l.set_aspect_ratio(1.0)\nsage: l.axes(False) \t\nsage: l\n```\n\nIn several of the output formats, e.g. pgf and png, I do not see this line (but I do see it if I save to a postscript file).  So I believe this is an issue with the plotting functions and not graph theory.",
    "created_at": "2017-02-13T20:21:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407781",
    "user": "https://trac.sagemath.org/admin/accounts/users/msaaltink"
}
```

<a id='comment:2'></a>This also happens with other graphics, e.g. a simple line:

```
sage: l = line2d([(1, 1e-6), (-1,-1e-6)])
sage: l.set_aspect_ratio(1.0)
sage: l.axes(False) 	
sage: l
```

In several of the output formats, e.g. pgf and png, I do not see this line (but I do see it if I save to a postscript file).  So I believe this is an issue with the plotting functions and not graph theory.



---

archive/issue_comments_407782.json:
```json
{
    "body": "<a id='comment:3'></a>In Sage 8.3 I get correct `CycleGraph(2)`-drawing, but still wrong `CompleteGraph(2)`-drawing.\n\nAnd indeed in the latter `get_pos()` returns\n\n```\n{0: (6.123233995736766e-17, 1.0), 1: (-1.8369701987210297e-16, -1.0)}\n```\nso this is basically very similar bug, fixed for `CycleGraph(2)` in #24512.",
    "created_at": "2018-08-14T08:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407782",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>In Sage 8.3 I get correct `CycleGraph(2)`-drawing, but still wrong `CompleteGraph(2)`-drawing.

And indeed in the latter `get_pos()` returns

```
{0: (6.123233995736766e-17, 1.0), 1: (-1.8369701987210297e-16, -1.0)}
```
so this is basically very similar bug, fixed for `CycleGraph(2)` in #24512.



---

archive/issue_comments_407783.json:
```json
{
    "body": "<a id='comment:4'></a>Same issue with `graphs.PathGraph(2,'circle')`, `graphs.StarGraph(1)`, `graphs.CircularLadderGraph(2)` and\n`graphs.StarGraph(2)`- it attempts to plot the vertical,\nbut not quite, line...\n\nAnd for some reason `graphs.CircularLadderGraph(1)` throws an error, should there be a check?",
    "created_at": "2018-08-14T10:10:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407783",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>Same issue with `graphs.PathGraph(2,'circle')`, `graphs.StarGraph(1)`, `graphs.CircularLadderGraph(2)` and
`graphs.StarGraph(2)`- it attempts to plot the vertical,
but not quite, line...

And for some reason `graphs.CircularLadderGraph(1)` throws an error, should there be a check?



---

archive/issue_comments_407784.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,3 +4,7 @@\n g.show()\n ```\n on the sage cell server http://sagecell.sagemath.org/ (running 'SageMath version 7.5.beta1, Release Date: 2016-10-31') and on Version 7.3 on my machine, running Ubuntu on X1 Carbon, produces a picture with no edges.  Other sizes of complete graphs seem to work fine.\n+\n+More similar errors are all seemingly related to `matplotlib` being unable to draw not quite vertical line: same error in plotting\n+`graphs.PathGraph(2,'circle')`, `graphs.StarGraph(1)`, `graphs.CircularLadderGraph(2)`,\n+`graphs.StarGraph(2)`\n``````\n",
    "created_at": "2018-08-14T10:10:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407784",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,3 +4,7 @@
 g.show()
 ```
 on the sage cell server http://sagecell.sagemath.org/ (running 'SageMath version 7.5.beta1, Release Date: 2016-10-31') and on Version 7.3 on my machine, running Ubuntu on X1 Carbon, produces a picture with no edges.  Other sizes of complete graphs seem to work fine.
+
+More similar errors are all seemingly related to `matplotlib` being unable to draw not quite vertical line: same error in plotting
+`graphs.PathGraph(2,'circle')`, `graphs.StarGraph(1)`, `graphs.CircularLadderGraph(2)`,
+`graphs.StarGraph(2)`
``````




---

archive/issue_comments_407785.json:
```json
{
    "body": "<a id='comment:5'></a>These methods should use method `_circular_embedding` from file `graph_plot.py`, and we should put in it the corrections that we did in #24512 for `CycleGraph`.\nNote that I have recently corrected method `_line_embedding` in #25403.\n\nThe embedding of the `CircularLadderGraph` could be simplified to:\n\n```\nfrom sage.graphs.graph_plot import _circle_embedding\n_circle_embedding(G, list(range(n)), radius=1)\n_circle_embedding(G, list(range(n, 2*n)), radius=2)\n```\n\nThe error in `graphs.CircularLadderGraph(1)` is due to methods `add_cycle` and `add_path` that do not check if the input list of vertices are empty, of length 1, etc.",
    "created_at": "2018-08-14T11:27:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407785",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>These methods should use method `_circular_embedding` from file `graph_plot.py`, and we should put in it the corrections that we did in #24512 for `CycleGraph`.
Note that I have recently corrected method `_line_embedding` in #25403.

The embedding of the `CircularLadderGraph` could be simplified to:

```
from sage.graphs.graph_plot import _circle_embedding
_circle_embedding(G, list(range(n)), radius=1)
_circle_embedding(G, list(range(n, 2*n)), radius=2)
```

The error in `graphs.CircularLadderGraph(1)` is due to methods `add_cycle` and `add_path` that do not check if the input list of vertices are empty, of length 1, etc.



---

archive/issue_comments_407786.json:
```json
{
    "body": "<a id='comment:6'></a>How to know which sin/cos functions are used ? In a sage session sin(pi) gives 0. Inside `_circular_embedding`, sin(pi) gives `1.2246467991473532e-16`, sin(2*pi) gives -2.44929359829e-16, sin(3*pi) gives 3.67394039744e-16, etc. Similar issues with cos(pi/2).",
    "created_at": "2018-08-14T16:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407786",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>How to know which sin/cos functions are used ? In a sage session sin(pi) gives 0. Inside `_circular_embedding`, sin(pi) gives `1.2246467991473532e-16`, sin(2*pi) gives -2.44929359829e-16, sin(3*pi) gives 3.67394039744e-16, etc. Similar issues with cos(pi/2).



---

archive/issue_comments_407787.json:
```json
{
    "body": "<a id='comment:7'></a>well, the problem might be somewhere else...\n\n```\nsage: pi\npi\nsage: float(pi)\n3.141592653589793\nsage: sin(float(pi))\n1.2246467991473532e-16\n```",
    "created_at": "2018-08-14T17:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407787",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:7'></a>well, the problem might be somewhere else...

```
sage: pi
pi
sage: float(pi)
3.141592653589793
sage: sin(float(pi))
1.2246467991473532e-16
```



---

archive/issue_comments_407788.json:
```json
{
    "body": "Changing branch from \"\" to \"public/22050_use_circle_embedding\"",
    "created_at": "2018-08-15T12:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407788",
    "user": "https://github.com/dcoudert"
}
```

Changing branch from "" to "public/22050_use_circle_embedding"



---

archive/issue_comments_407789.json:
```json
{
    "body": "Changing commit from \"\" to \"1c4ea2904f2b58ef8a5c29d9e9e04d04c5e62ae0\"",
    "created_at": "2018-08-15T12:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407789",
    "user": "https://github.com/dcoudert"
}
```

Changing commit from "" to "1c4ea2904f2b58ef8a5c29d9e9e04d04c5e62ae0"



---

archive/issue_comments_407790.json:
```json
{
    "body": "Changing author from \"katestange\" to \"David Coudert\"",
    "created_at": "2018-08-15T12:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407790",
    "user": "https://github.com/dcoudert"
}
```

Changing author from "katestange" to "David Coudert"



---

archive/issue_comments_407791.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-15T12:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407791",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_407792.json:
```json
{
    "body": "<a id='comment:8'></a>I did the following:\n- add rounding inside `_circle_embedding` so that `sin(pi)` is 0 and not `1.2246467991473532e-16`.\n- add a parameter `angle` to `_circle_embedding`\n- patch `add_circle` to avoid adding a loop when the list of vertices has a single node\n- use `_circle_embedding` in many methods\n \n---\nNew commits:",
    "created_at": "2018-08-15T12:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407792",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:8'></a>I did the following:
- add rounding inside `_circle_embedding` so that `sin(pi)` is 0 and not `1.2246467991473532e-16`.
- add a parameter `angle` to `_circle_embedding`
- patch `add_circle` to avoid adding a loop when the list of vertices has a single node
- use `_circle_embedding` in many methods
 
---
New commits:



---

archive/issue_comments_407793.json:
```json
{
    "body": "<a id='comment:9'></a>While we are at it, why are `_circle_embedding` and `_line_embedding` not member functions of the `GraphPlot` class, but these ugly side-effect beasts?\nShouldn't they be moved into `GraphPlot` ?",
    "created_at": "2018-08-15T21:42:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407793",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>While we are at it, why are `_circle_embedding` and `_line_embedding` not member functions of the `GraphPlot` class, but these ugly side-effect beasts?
Shouldn't they be moved into `GraphPlot` ?



---

archive/issue_comments_407794.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-16T10:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_407795.json:
```json
{
    "body": "Changing commit from \"1c4ea2904f2b58ef8a5c29d9e9e04d04c5e62ae0\" to \"990e39bbaf4f0ab3b12fdf3c665e98a2826c89bc\"",
    "created_at": "2018-08-16T10:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1c4ea2904f2b58ef8a5c29d9e9e04d04c5e62ae0" to "990e39bbaf4f0ab3b12fdf3c665e98a2826c89bc"



---

archive/issue_comments_407796.json:
```json
{
    "body": "<a id='comment:11'></a>If these methods are moved to `GraphPlot`, how can we use them to set the embedding of parts of a graph ? For instance for the `BarbellGraph` ?\n\nI just discovered another method producing a circular embedding: `layout_circular` in `generic_graph.py`. The difference is that it returns a dictionary, but clearly it should at least use `_circular_embedding` or be combined with it.\nI could for instance add a `return_dict` parameter to `_circular_embedding` to return a new dictionary instead of filling `_pos`, or add parameters to `layout_circular` to get the functionality of `_circular_embedding`...\n\nMore generally, we could move methods for graph layout and visualization out of `generic_graph.py` and gather them in a file for 2d and/or 3d plotting. That could ease our life for maintaining / simplifying / improving the code. For sure in another ticket.",
    "created_at": "2018-08-16T10:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407796",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:11'></a>If these methods are moved to `GraphPlot`, how can we use them to set the embedding of parts of a graph ? For instance for the `BarbellGraph` ?

I just discovered another method producing a circular embedding: `layout_circular` in `generic_graph.py`. The difference is that it returns a dictionary, but clearly it should at least use `_circular_embedding` or be combined with it.
I could for instance add a `return_dict` parameter to `_circular_embedding` to return a new dictionary instead of filling `_pos`, or add parameters to `layout_circular` to get the functionality of `_circular_embedding`...

More generally, we could move methods for graph layout and visualization out of `generic_graph.py` and gather them in a file for 2d and/or 3d plotting. That could ease our life for maintaining / simplifying / improving the code. For sure in another ticket.



---

archive/issue_comments_407797.json:
```json
{
    "body": "<a id='comment:12'></a>one can use set_pos() on a graph, why not _circular_embedding(), if moved to the same class as set_pos()  ?",
    "created_at": "2018-08-16T10:44:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407797",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>one can use set_pos() on a graph, why not _circular_embedding(), if moved to the same class as set_pos()  ?



---

archive/issue_comments_407798.json:
```json
{
    "body": "<a id='comment:13'></a>We can of course make it a method of `GenericGraph`.",
    "created_at": "2018-08-16T10:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407798",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:13'></a>We can of course make it a method of `GenericGraph`.



---

archive/issue_comments_407799.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [dcoudert](#comment%3A13):\n> We can of course make it a method of `GenericGraph`.\n\n\nperhaps, just add them as options for set_pos() ?",
    "created_at": "2018-08-16T11:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407799",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>Replying to [dcoudert](#comment%3A13):
> We can of course make it a method of `GenericGraph`.


perhaps, just add them as options for set_pos() ?



---

archive/issue_comments_407800.json:
```json
{
    "body": "<a id='comment:15'></a>one way or another, these _circular_ and _line_embedding are ugly hacks, done without regard for the pre-existing design.",
    "created_at": "2018-08-16T11:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407800",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>one way or another, these _circular_ and _line_embedding are ugly hacks, done without regard for the pre-existing design.



---

archive/issue_comments_407801.json:
```json
{
    "body": "Replying to [ticket:22050 katestange]:\n> More similar errors are all seemingly related to `matplotlib` being unable to draw not quite vertical line\n\n\nDid you ever try to find out why this is the case? It's obvious that `matplotlib` is to blame here. Fixing the positions of vertices in Sage is a work-around but not a structural fix.",
    "created_at": "2018-08-16T11:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407801",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:22050 katestange]:
> More similar errors are all seemingly related to `matplotlib` being unable to draw not quite vertical line


Did you ever try to find out why this is the case? It's obvious that `matplotlib` is to blame here. Fixing the positions of vertices in Sage is a work-around but not a structural fix.



---

archive/issue_comments_407802.json:
```json
{
    "body": "<a id='comment:17'></a>It would be cleaner if `_circle_embedding` would be a method of graphs (as opposed to a stand-alone function). Also conceptually, it feels like it should be method.",
    "created_at": "2018-08-16T11:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407802",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>It would be cleaner if `_circle_embedding` would be a method of graphs (as opposed to a stand-alone function). Also conceptually, it feels like it should be method.



---

archive/issue_comments_407803.json:
```json
{
    "body": "<a id='comment:18'></a>`@`dima: I searched ticket and discovered that `_line_embedding` was introduced in #12980 and `_circle_embedding` in #12942 while `layout_circular` was here before #7004... So you are fully right.\n\n`@`Jeroen: no, I have not investigated matplotlib yet. We should do it, but I'm no expert in matplotlib. Also, the I have not checked the `tikz` part yet, but without this patch you can see that there is a problem with the position of the vertices in `_latex_` (values of x and y in `\\Vertex` lines).\n\n```\nsage: print(graphs.CompleteGraph(2)._latex_())\n\\begin{tikzpicture}\n\\definecolor{cv0}{rgb}{0.0,0.0,0.0}\n\\definecolor{cfv0}{rgb}{1.0,1.0,1.0}\n\\definecolor{clv0}{rgb}{0.0,0.0,0.0}\n\\definecolor{cv1}{rgb}{0.0,0.0,0.0}\n\\definecolor{cfv1}{rgb}{1.0,1.0,1.0}\n\\definecolor{clv1}{rgb}{0.0,0.0,0.0}\n\\definecolor{cv0v1}{rgb}{0.0,0.0,0.0}\n%\n\\Vertex[style={minimum size=1.0cm,draw=cv0,fill=cfv0,text=clv0,shape=circle},LabelOut=false,L=\\hbox{$0$},x=5.0cm,y=5.0cm]{v0}\n\\Vertex[style={minimum size=1.0cm,draw=cv1,fill=cfv1,text=clv1,shape=circle},LabelOut=false,L=\\hbox{$1$},x=0.0cm,y=0.0cm]{v1}\n%\n\\Edge[lw=0.1cm,style={color=cv0v1,},](v0)(v1)\n%\n\\end{tikzpicture}\n```\nWith this patch, the positions are the following, so vertical.\n\n```\n\\Vertex[style={minimum size=1.0cm,draw=cv0,fill=cfv0,text=clv0,shape=circle},LabelOut=false,L=\\hbox{$0$},x=2.5cm,y=5.0cm]{v0}\n\\Vertex[style={minimum size=1.0cm,draw=cv1,fill=cfv1,text=clv1,shape=circle},LabelOut=false,L=\\hbox{$1$},x=2.5cm,y=0.0cm]{v1}\n```\n\n\nI will try to make `_circle_embedding` a method of `GenericGraph` and unify with `layout_circular`. It's better if such embedding is done in a single place.",
    "created_at": "2018-08-16T12:10:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407803",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:18'></a>`@`dima: I searched ticket and discovered that `_line_embedding` was introduced in #12980 and `_circle_embedding` in #12942 while `layout_circular` was here before #7004... So you are fully right.

`@`Jeroen: no, I have not investigated matplotlib yet. We should do it, but I'm no expert in matplotlib. Also, the I have not checked the `tikz` part yet, but without this patch you can see that there is a problem with the position of the vertices in `_latex_` (values of x and y in `\Vertex` lines).

```
sage: print(graphs.CompleteGraph(2)._latex_())
\begin{tikzpicture}
\definecolor{cv0}{rgb}{0.0,0.0,0.0}
\definecolor{cfv0}{rgb}{1.0,1.0,1.0}
\definecolor{clv0}{rgb}{0.0,0.0,0.0}
\definecolor{cv1}{rgb}{0.0,0.0,0.0}
\definecolor{cfv1}{rgb}{1.0,1.0,1.0}
\definecolor{clv1}{rgb}{0.0,0.0,0.0}
\definecolor{cv0v1}{rgb}{0.0,0.0,0.0}
%
\Vertex[style={minimum size=1.0cm,draw=cv0,fill=cfv0,text=clv0,shape=circle},LabelOut=false,L=\hbox{$0$},x=5.0cm,y=5.0cm]{v0}
\Vertex[style={minimum size=1.0cm,draw=cv1,fill=cfv1,text=clv1,shape=circle},LabelOut=false,L=\hbox{$1$},x=0.0cm,y=0.0cm]{v1}
%
\Edge[lw=0.1cm,style={color=cv0v1,},](v0)(v1)
%
\end{tikzpicture}
```
With this patch, the positions are the following, so vertical.

```
\Vertex[style={minimum size=1.0cm,draw=cv0,fill=cfv0,text=clv0,shape=circle},LabelOut=false,L=\hbox{$0$},x=2.5cm,y=5.0cm]{v0}
\Vertex[style={minimum size=1.0cm,draw=cv1,fill=cfv1,text=clv1,shape=circle},LabelOut=false,L=\hbox{$1$},x=2.5cm,y=0.0cm]{v1}
```


I will try to make `_circle_embedding` a method of `GenericGraph` and unify with `layout_circular`. It's better if such embedding is done in a single place.



---

archive/issue_comments_407804.json:
```json
{
    "body": "<a id='comment:19'></a>I don't now how tikz pictures are done. I'd be surprised if they are produced via matplotlib. If they are produced in some other way I guess it's not matplotlib's bug, it's Sage one. \nBut where I don't know---too many layers of classes etc for me :-)",
    "created_at": "2018-08-16T22:31:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407804",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'></a>I don't now how tikz pictures are done. I'd be surprised if they are produced via matplotlib. If they are produced in some other way I guess it's not matplotlib's bug, it's Sage one. 
But where I don't know---too many layers of classes etc for me :-)



---

archive/issue_comments_407805.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-17T11:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407805",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_407806.json:
```json
{
    "body": "Changing commit from \"990e39bbaf4f0ab3b12fdf3c665e98a2826c89bc\" to \"98bacd3d4f25b59e4431ae67a42fde84634711dd\"",
    "created_at": "2018-08-17T11:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407806",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "990e39bbaf4f0ab3b12fdf3c665e98a2826c89bc" to "98bacd3d4f25b59e4431ae67a42fde84634711dd"



---

archive/issue_comments_407807.json:
```json
{
    "body": "<a id='comment:21'></a>I have moved the methods to `generic_graph.py` and update usage everywhere. It was used many many times...\n\nI will check if I can understand the issue with tikz / matplotlib when we don't round `sin(pi)`.",
    "created_at": "2018-08-17T11:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407807",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:21'></a>I have moved the methods to `generic_graph.py` and update usage everywhere. It was used many many times...

I will check if I can understand the issue with tikz / matplotlib when we don't round `sin(pi)`.



---

archive/issue_comments_407808.json:
```json
{
    "body": "<a id='comment:22'></a>I'm also unable to guess what's going on with `plot`/`show`. Way to complicated for me.\n\n\nIn `GraphLatex`, the method `tkz_picture` computes `xmin`, `xmax`, `ymin`, `ymax` positions, and then the positions of the vertices are scaled to fill the specified image size (5*5 by default).\n\nWhen `xmin == xmax`, then vertices are placed at the middle of the x range, so by default 2.5.\n\nBut when we have `G._pos = {0: (6.123233995736766e-17, 1.0), 1: (-1.8369701987210297e-16, -1.0)}`, `xmax - xmin = 2.4492935982947064e-16` and so the vertices are spread in the x axis. Vertex 0 will be at `(5.0, 1.0)` and vertex 1 at `(0.0, -1.0)`.\n\nSo I think that the `round(cos(...), 10)` is needed.\n\n\nQuestion: some code is duplicated in `tkz_picture` (certainly a copy/paste error). Should I open a new ticket to remove it or can I do it here ?",
    "created_at": "2018-08-17T13:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407808",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:22'></a>I'm also unable to guess what's going on with `plot`/`show`. Way to complicated for me.


In `GraphLatex`, the method `tkz_picture` computes `xmin`, `xmax`, `ymin`, `ymax` positions, and then the positions of the vertices are scaled to fill the specified image size (5*5 by default).

When `xmin == xmax`, then vertices are placed at the middle of the x range, so by default 2.5.

But when we have `G._pos = {0: (6.123233995736766e-17, 1.0), 1: (-1.8369701987210297e-16, -1.0)}`, `xmax - xmin = 2.4492935982947064e-16` and so the vertices are spread in the x axis. Vertex 0 will be at `(5.0, 1.0)` and vertex 1 at `(0.0, -1.0)`.

So I think that the `round(cos(...), 10)` is needed.


Question: some code is duplicated in `tkz_picture` (certainly a copy/paste error). Should I open a new ticket to remove it or can I do it here ?



---

archive/issue_comments_407809.json:
```json
{
    "body": "<a id='comment:23'></a>I opened #26106 to remove the duplicated code in `tkz_picture`.",
    "created_at": "2018-08-22T10:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407809",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:23'></a>I opened #26106 to remove the duplicated code in `tkz_picture`.



---

archive/issue_events_058023.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2018-08-22T10:05:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22050#event-58023"
}
```



---

archive/issue_comments_407810.json:
```json
{
    "body": "Changing commit from \"98bacd3d4f25b59e4431ae67a42fde84634711dd\" to \"1f33553e55ea8acedfd5ea836735abc33accf7de\"",
    "created_at": "2018-09-02T12:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407810",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "98bacd3d4f25b59e4431ae67a42fde84634711dd" to "1f33553e55ea8acedfd5ea836735abc33accf7de"



---

archive/issue_comments_407811.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-02T12:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407811",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_407812.json:
```json
{
    "body": "<a id='comment:25'></a>Successfully tested over beta7 (just in case).",
    "created_at": "2018-10-04T15:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407812",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:25'></a>Successfully tested over beta7 (just in case).



---

archive/issue_comments_407813.json:
```json
{
    "body": "<a id='comment:26'></a>We should fix pyflakes warnings (from the patchbot)",
    "created_at": "2018-10-04T17:26:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407813",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>We should fix pyflakes warnings (from the patchbot)



---

archive/issue_comments_407814.json:
```json
{
    "body": "Changing commit from \"1f33553e55ea8acedfd5ea836735abc33accf7de\" to \"9b3ffc60828e3993a2ad286d442916cf6ef68d78\"",
    "created_at": "2018-10-04T17:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407814",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1f33553e55ea8acedfd5ea836735abc33accf7de" to "9b3ffc60828e3993a2ad286d442916cf6ef68d78"



---

archive/issue_comments_407815.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-04T17:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407815",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_407816.json:
```json
{
    "body": "<a id='comment:28'></a>I fixed the pyflakes warning in `families.py`.\nWarning in `generic_graph.py` are addressed in #26289.",
    "created_at": "2018-10-04T17:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407816",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:28'></a>I fixed the pyflakes warning in `families.py`.
Warning in `generic_graph.py` are addressed in #26289.



---

archive/issue_comments_407817.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2018-10-04T18:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407817",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_407818.json:
```json
{
    "body": "<a id='comment:29'></a>OK, it's certainly a shame we could not get to the bottom of the matter, but it's still an improvement.",
    "created_at": "2018-10-04T18:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407818",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:29'></a>OK, it's certainly a shame we could not get to the bottom of the matter, but it's still an improvement.



---

archive/issue_comments_407819.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-10-04T18:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407819",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_407820.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-05T16:56:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407820",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_407821.json:
```json
{
    "body": "Changing branch from \"public/22050_use_circle_embedding\" to \"9b3ffc60828e3993a2ad286d442916cf6ef68d78\"",
    "created_at": "2018-10-05T16:56:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22050#issuecomment-407821",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/22050_use_circle_embedding" to "9b3ffc60828e3993a2ad286d442916cf6ef68d78"



---

archive/issue_events_058024.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-05T16:56:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22050",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22050#event-58024"
}
```
