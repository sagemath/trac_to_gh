# Issue 22646: ./configure CC=/path/to/gcc ...

archive/issues_022409.json:
```json
{
    "body": "Standard autotools packages allow variables such as CC to be set at configure time using\n\n```\n./configure CC=/path/to/gcc\n```\nIn this ticket, we add support for this. (The syntax already works, but the settings right now only end up in the unused file `build/make/Makefile-auto`.)\n\nNew configure tarball:\n[https://trac.sagemath.org/raw-attachment/ticket/22646/configure-235.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/22646/configure-235.tar.gz)\n\n\nCC:  @jdemeyer @kiwifb\n\nReviewer: Matthias Koeppe, Jeroen Demeyer, Vincent Delecroix, John Palmieri, Dima Pasechnik\n\nAuthor: Fran\u00e7ois Bissey\n\nBranch: 99eb31f851a4fcdf1e17bd1671b5218ae9acc0be\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22646\n\n",
    "closed_at": "2017-09-04T06:10:56Z",
    "created_at": "2017-03-19T05:15:30Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "./configure CC=/path/to/gcc ...",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22646",
    "user": "https://github.com/mkoeppe"
}
```
Standard autotools packages allow variables such as CC to be set at configure time using

```
./configure CC=/path/to/gcc
```
In this ticket, we add support for this. (The syntax already works, but the settings right now only end up in the unused file `build/make/Makefile-auto`.)

New configure tarball:
[https://trac.sagemath.org/raw-attachment/ticket/22646/configure-235.tar.gz](https://trac.sagemath.org/raw-attachment/ticket/22646/configure-235.tar.gz)


CC:  @jdemeyer @kiwifb

Reviewer: Matthias Koeppe, Jeroen Demeyer, Vincent Delecroix, John Palmieri, Dima Pasechnik

Author: Fran√ßois Bissey

Branch: 99eb31f851a4fcdf1e17bd1671b5218ae9acc0be

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22646





---

archive/issue_comments_311675.json:
```json
{
    "body": "<a id='comment:2'></a>I guess that should be extended to `CXX`, `FC`, possibly `F77` and `CPP` (although I actually don't recommend to set that one and let the package decides unless it require hand holding. That's from my experience setting it in `sage-env` that sometimes backfire because `$CC -E` may work slightly differently and is what many package assume instead of plain `cpp`.\n\nWould that need to over-ride `sage-env` if sage's gcc has been installed? Useful for mad scientist experiments but probably not for common users.",
    "created_at": "2017-04-18T23:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311675",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>I guess that should be extended to `CXX`, `FC`, possibly `F77` and `CPP` (although I actually don't recommend to set that one and let the package decides unless it require hand holding. That's from my experience setting it in `sage-env` that sometimes backfire because `$CC -E` may work slightly differently and is what many package assume instead of plain `cpp`.

Would that need to over-ride `sage-env` if sage's gcc has been installed? Useful for mad scientist experiments but probably not for common users.



---

archive/issue_comments_311676.json:
```json
{
    "body": "<a id='comment:3'></a>Yes, all of CC, CXX, FC, etc.\nAs a guideline, one can look into the list of variables that appear in an automake-generated Makefile.\n\nIn my opinion, if the user provides a specific CC, CXX in this way and configure finds out that they are not suitable, that should be an error.\n\nA gcc package should only be installed if no CC, CXX were provided in this way by the user. \nOnly in that case, `sage-env` should do its special magic to set these variables to have the sage gcc used.",
    "created_at": "2017-04-18T23:40:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311676",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Yes, all of CC, CXX, FC, etc.
As a guideline, one can look into the list of variables that appear in an automake-generated Makefile.

In my opinion, if the user provides a specific CC, CXX in this way and configure finds out that they are not suitable, that should be an error.

A gcc package should only be installed if no CC, CXX were provided in this way by the user. 
Only in that case, `sage-env` should do its special magic to set these variables to have the sage gcc used.



---

archive/issue_comments_311677.json:
```json
{
    "body": "<a id='comment:4'></a>OK, past experience shows that if you set something special at build time, it is forgotten at runtime (see #21701) so we will need to leverage `sage-env-config`, considering the magic in `sage-env` that means moving quite a bit of stuff.",
    "created_at": "2017-04-18T23:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311677",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>OK, past experience shows that if you set something special at build time, it is forgotten at runtime (see #21701) so we will need to leverage `sage-env-config`, considering the magic in `sage-env` that means moving quite a bit of stuff.



---

archive/issue_comments_311678.json:
```json
{
    "body": "<a id='comment:5'></a>Yes, `sage-env-config` is what needs to be used.",
    "created_at": "2017-04-18T23:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311678",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Yes, `sage-env-config` is what needs to be used.



---

archive/issue_comments_311679.json:
```json
{
    "body": "<a id='comment:6'></a>This is a first draft for this. I am dropping the setting for `CPP`. If there are packages, not using autotools, that need it to be set, I'll reconsider.\n\n---\nNew commits:",
    "created_at": "2017-05-08T04:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311679",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>This is a first draft for this. I am dropping the setting for `CPP`. If there are packages, not using autotools, that need it to be set, I'll reconsider.

---
New commits:



---

archive/issue_comments_311680.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-19T01:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311680",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_311681.json:
```json
{
    "body": "<a id='comment:7'></a>OK I am looking to make #12426 on this soon and rework slightly the toolchain building in the case were we only build gfortran. In the absence of further comments, I am putting this for review. I'll attach a configure tarball.",
    "created_at": "2017-05-19T01:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311681",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>OK I am looking to make #12426 on this soon and rework slightly the toolchain building in the case were we only build gfortran. In the absence of further comments, I am putting this for review. I'll attach a configure tarball.



---

archive/issue_comments_311682.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-19T21:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311682",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311683.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-19T22:22:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311683",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311684.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-20T02:01:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311684",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311685.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-20T02:23:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311685",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311686.json:
```json
{
    "body": "<a id='comment:15'></a>regarding CPP, there are some packages (`gf2x`) that need CPP and CXXCPP to be [set on FreeBSD](https://trac.sagemath.org/ticket/22679#comment:73).",
    "created_at": "2017-06-20T06:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311686",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>regarding CPP, there are some packages (`gf2x`) that need CPP and CXXCPP to be [set on FreeBSD](https://trac.sagemath.org/ticket/22679#comment:73).



---

archive/issue_comments_311687.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 dimpase]:\n> regarding CPP, there are some packages (`gf2x`) that need CPP and CXXCPP to be [set on FreeBSD](https://trac.sagemath.org/ticket/22679#comment:73).\n\n\nIs it because `CC`/`CXX` is different from what you need for `C{,XX}PP`? Or is there something missing in `configure`? By default `AC_PROG_C{,XX}PP` check `C{C,XX} -E` first.",
    "created_at": "2017-06-20T07:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311687",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:16'></a>Replying to [comment:15 dimpase]:
> regarding CPP, there are some packages (`gf2x`) that need CPP and CXXCPP to be [set on FreeBSD](https://trac.sagemath.org/ticket/22679#comment:73).


Is it because `CC`/`CXX` is different from what you need for `C{,XX}PP`? Or is there something missing in `configure`? By default `AC_PROG_C{,XX}PP` check `C{C,XX} -E` first.



---

archive/issue_comments_311688.json:
```json
{
    "body": "<a id='comment:17'></a>Just looked over at `gf2x`' git repo. `configure.ac` doesn't check for `CPP` or `CXXPP` we may want to get that done for the next release. In the meantime, I'd rather have individual `spkg-install` set it as needed, because I don't want to interfere with what configure script may be looking for. \n\nThe thing that I particularly don't like is \n\n```\nif [ -x \"$SAGE_LOCAL/bin/cpp\" ]; then\n    CPP=cpp\nfi\n```\nin `sage-env`. Without it package using autoconf should naturally use `gcc -E`, but because of this, when you install sage's gcc you get `cpp`.",
    "created_at": "2017-06-20T07:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311688",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>Just looked over at `gf2x`' git repo. `configure.ac` doesn't check for `CPP` or `CXXPP` we may want to get that done for the next release. In the meantime, I'd rather have individual `spkg-install` set it as needed, because I don't want to interfere with what configure script may be looking for. 

The thing that I particularly don't like is 

```
if [ -x "$SAGE_LOCAL/bin/cpp" ]; then
    CPP=cpp
fi
```
in `sage-env`. Without it package using autoconf should naturally use `gcc -E`, but because of this, when you install sage's gcc you get `cpp`.



---

archive/issue_comments_311689.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:15 dimpase]:\n> regarding CPP, there are some packages (`gf2x`) that need CPP and CXXCPP to be [set on FreeBSD](https://trac.sagemath.org/ticket/22679#comment:73).\n\n\nReported to `gf2x` upstream at https://gforge.inria.fr/tracker/index.php?func=detail&aid=21377&group_id=1874&atid=6979",
    "created_at": "2017-06-20T21:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311689",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:18'></a>Replying to [comment:15 dimpase]:
> regarding CPP, there are some packages (`gf2x`) that need CPP and CXXCPP to be [set on FreeBSD](https://trac.sagemath.org/ticket/22679#comment:73).


Reported to `gf2x` upstream at https://gforge.inria.fr/tracker/index.php?func=detail&aid=21377&group_id=1874&atid=6979



---

archive/issue_comments_311690.json:
```json
{
    "body": "<a id='comment:19'></a>I would like to test this with gcc-6 because my defafult gcc 7.1 is causing troubles (see this [sage thread](https://groups.google.com/forum/#!topic/sage-devel/1CZHCmwG_RE)). Is that all what I should do on a freshly cloned Sage?\n\n```\n$ ./bootstrap\n$ ./configure CC=/usr/bin/gcc-6 CXX=/usr/bin/g++-6\n$ make\n```",
    "created_at": "2017-06-21T08:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311690",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>I would like to test this with gcc-6 because my defafult gcc 7.1 is causing troubles (see this [sage thread](https://groups.google.com/forum/#!topic/sage-devel/1CZHCmwG_RE)). Is that all what I should do on a freshly cloned Sage?

```
$ ./bootstrap
$ ./configure CC=/usr/bin/gcc-6 CXX=/usr/bin/g++-6
$ make
```



---

archive/issue_comments_311691.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 vdelecroix]:\n> I would like to test this with gcc-6 because my defafult gcc 7.1 is causing troubles (see this [sage thread](https://groups.google.com/forum/#!topic/sage-devel/1CZHCmwG_RE)). Is that all what I should do on a freshly cloned Sage?\n> \n> ```\n> $ ./bootstrap\n> $ ./configure CC=/usr/bin/gcc-6 CXX=/usr/bin/g++-6\n> $ make\n> ```\n\n\nPretty much.\n\n```\n$ ./bootstrap\n$ CC=/usr/bin/gcc-6 CXX=/usr/bin/g++-6 make\n```\nshould work too. Actually it would work without this ticket. But without this ticket once sage is built your settings for CC/CXX/FC is forgotten. You may want to read #21701 on the potential consequences of that amnesia.",
    "created_at": "2017-06-21T09:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311691",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:20'></a>Replying to [comment:19 vdelecroix]:
> I would like to test this with gcc-6 because my defafult gcc 7.1 is causing troubles (see this [sage thread](https://groups.google.com/forum/#!topic/sage-devel/1CZHCmwG_RE)). Is that all what I should do on a freshly cloned Sage?
> 
> ```
> $ ./bootstrap
> $ ./configure CC=/usr/bin/gcc-6 CXX=/usr/bin/g++-6
> $ make
> ```


Pretty much.

```
$ ./bootstrap
$ CC=/usr/bin/gcc-6 CXX=/usr/bin/g++-6 make
```
should work too. Actually it would work without this ticket. But without this ticket once sage is built your settings for CC/CXX/FC is forgotten. You may want to read #21701 on the potential consequences of that amnesia.



---

archive/issue_comments_311692.json:
```json
{
    "body": "<a id='comment:21'></a>I am trying the `./configure` way right now. I will report in few hours.",
    "created_at": "2017-06-21T09:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311692",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>I am trying the `./configure` way right now. I will report in few hours.



---

archive/issue_comments_311693.json:
```json
{
    "body": "<a id='comment:22'></a>... even sooner, compilation started but then Sage tries to download `gcc-5.4`! Is that expected? Should I also set `SAGE_INSTALL_GCC=no` somewhere?",
    "created_at": "2017-06-21T09:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311693",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>... even sooner, compilation started but then Sage tries to download `gcc-5.4`! Is that expected? Should I also set `SAGE_INSTALL_GCC=no` somewhere?



---

archive/issue_comments_311694.json:
```json
{
    "body": "<a id='comment:23'></a>I was writing that when your comment hit:\nSomething I didn't think about. sage may try to build its own gcc because the gfortran version is not the same as gcc.\n\nEither provide the matching gfortran or uses #12426 which is build on top of this ticket and decouples gfortran (because clang).",
    "created_at": "2017-06-21T09:16:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311694",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'></a>I was writing that when your comment hit:
Something I didn't think about. sage may try to build its own gcc because the gfortran version is not the same as gcc.

Either provide the matching gfortran or uses #12426 which is build on top of this ticket and decouples gfortran (because clang).



---

archive/issue_comments_311695.json:
```json
{
    "body": "<a id='comment:24'></a>It seems that archlinux do not provide the matching gfortran eventhough there is the Fortran runtime libraries for gcc-6... will try #12426",
    "created_at": "2017-06-21T09:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311695",
    "user": "https://github.com/videlec"
}
```

<a id='comment:24'></a>It seems that archlinux do not provide the matching gfortran eventhough there is the Fortran runtime libraries for gcc-6... will try #12426



---

archive/issue_comments_311696.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 vdelecroix]:\n> It seems that archlinux do not provide the matching gfortran eventhough there is the Fortran runtime libraries for gcc-6... will try #12426\n\n\nsometimes `gcc` can be called to compile fortran, e.g. something like `gcc6 -x f95` might be able to compile fortran.",
    "created_at": "2017-06-21T09:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311696",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:25'></a>Replying to [comment:24 vdelecroix]:
> It seems that archlinux do not provide the matching gfortran eventhough there is the Fortran runtime libraries for gcc-6... will try #12426


sometimes `gcc` can be called to compile fortran, e.g. something like `gcc6 -x f95` might be able to compile fortran.



---

archive/issue_comments_311697.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:25 dimpase]:\n> Replying to [comment:24 vdelecroix]:\n> > It seems that archlinux do not provide the matching gfortran eventhough there is the Fortran runtime libraries for gcc-6... will try #12426\n\n> \n> sometimes `gcc` can be called to compile fortran, e.g. something like `gcc6 -x f95` might be able to compile fortran.\n\n\nYou would need `f951` to be installed for that to work. gcc, g++ and gfortran are front end compiler drivers. cc1, cxx1 and f951 are the real compilers. When you do something like `gcc -x f95` you are basically instructing the main compiler driver to drive for f951 rather than cc1. f951 still needs to be present (usually in /usr/libexec/gcc/$host/$version/).",
    "created_at": "2017-06-21T09:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311697",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:26'></a>Replying to [comment:25 dimpase]:
> Replying to [comment:24 vdelecroix]:
> > It seems that archlinux do not provide the matching gfortran eventhough there is the Fortran runtime libraries for gcc-6... will try #12426

> 
> sometimes `gcc` can be called to compile fortran, e.g. something like `gcc6 -x f95` might be able to compile fortran.


You would need `f951` to be installed for that to work. gcc, g++ and gfortran are front end compiler drivers. cc1, cxx1 and f951 are the real compilers. When you do something like `gcc -x f95` you are basically instructing the main compiler driver to drive for f951 rather than cc1. f951 still needs to be present (usually in /usr/libexec/gcc/$host/$version/).



---

archive/issue_comments_311698.json:
```json
{
    "body": "<a id='comment:27'></a>Success (for both `make build` and `sage -i polymake`)! Tell me if you want me to test more stuff.",
    "created_at": "2017-06-21T13:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311698",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>Success (for both `make build` and `sage -i polymake`)! Tell me if you want me to test more stuff.



---

archive/issue_comments_311699.json:
```json
{
    "body": "<a id='comment:28'></a>Well, I'd like you to run the test suite (make ptestlong). Of course you ended up using the full #12426.",
    "created_at": "2017-06-21T21:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311699",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:28'></a>Well, I'd like you to run the test suite (make ptestlong). Of course you ended up using the full #12426.



---

archive/issue_comments_311700.json:
```json
{
    "body": "<a id='comment:29'></a>On top of #12426, ptestlong gives\n\n```\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```",
    "created_at": "2017-06-22T05:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311700",
    "user": "https://github.com/videlec"
}
```

<a id='comment:29'></a>On top of #12426, ptestlong gives

```
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```



---

archive/issue_comments_311701.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-22T22:06:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311702.json:
```json
{
    "body": "<a id='comment:32'></a>I am trying\n\n```\n ./configure CC=clang CXX=clang++\n```\non Fedora 23 (clang 3.7) with SAGE_INSTALL_GCC=no\nand I still see it doing some `g++` tests:\n\n```\n...\nchecking for complex.h... yes\nchecking whether clang++ supports C++11 features by default... no\nchecking whether clang++ supports C++11 features with -std=gnu++11... yes\nchecking for clang option to accept ISO C99... none needed\nchecking for Fortran flag needed to accept free-form source... -ffree-form\nchecking if gcc accepts -dumpversion option... yes\nchecking gcc version... 4.2.1\nchecking if g++ accepts -dumpversion option... yes\nchecking g++ version... 4.2.1\nchecking for sqrt in -lm... yes\n...\n```\nAnd I don't even get how it gets `4.2.1` there, as gcc/g++/gfortran installed is 5.3.1.\nIs it \"gcc emulation mode\"?!",
    "created_at": "2017-06-23T10:25:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311702",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:32'></a>I am trying

```
 ./configure CC=clang CXX=clang++
```
on Fedora 23 (clang 3.7) with SAGE_INSTALL_GCC=no
and I still see it doing some `g++` tests:

```
...
checking for complex.h... yes
checking whether clang++ supports C++11 features by default... no
checking whether clang++ supports C++11 features with -std=gnu++11... yes
checking for clang option to accept ISO C99... none needed
checking for Fortran flag needed to accept free-form source... -ffree-form
checking if gcc accepts -dumpversion option... yes
checking gcc version... 4.2.1
checking if g++ accepts -dumpversion option... yes
checking g++ version... 4.2.1
checking for sqrt in -lm... yes
...
```
And I don't even get how it gets `4.2.1` there, as gcc/g++/gfortran installed is 5.3.1.
Is it "gcc emulation mode"?!



---

archive/issue_comments_311703.json:
```json
{
    "body": "<a id='comment:33'></a>clang fakes gcc. Not any version of gcc, just 4.2.1. Same thing on OS X. So this is totally expected. I wouldn't call it an emulation mode. clang just happen to support all the pragmas identifying itself as gcc 4.2.1.",
    "created_at": "2017-06-23T10:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311703",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:33'></a>clang fakes gcc. Not any version of gcc, just 4.2.1. Same thing on OS X. So this is totally expected. I wouldn't call it an emulation mode. clang just happen to support all the pragmas identifying itself as gcc 4.2.1.



---

archive/issue_comments_311704.json:
```json
{
    "body": "<a id='comment:34'></a>So this ends up with a silly error in libfplll:\n\n```\n...\nchecking dependency style of clang... (cached) gcc3\nchecking whether make sets $(MAKE)... (cached) yes\nchecking whether clang++ supports C++11 features by default... no\nchecking whether clang++ supports C++11 features with -std=c++11... no\nchecking whether clang++ supports C++11 features with -std=c++0x... no\nchecking whether clang++ supports C++11 features with +std=c++11... no\nchecking whether clang++ supports C++11 features with -h std=c++11... no\nconfigure: error: *** A compiler with support for C++11 language features is required.\nError configuring fplll\n...\n```\n\nIs this known, are there any patches needed?",
    "created_at": "2017-06-23T10:46:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311704",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>So this ends up with a silly error in libfplll:

```
...
checking dependency style of clang... (cached) gcc3
checking whether make sets $(MAKE)... (cached) yes
checking whether clang++ supports C++11 features by default... no
checking whether clang++ supports C++11 features with -std=c++11... no
checking whether clang++ supports C++11 features with -std=c++0x... no
checking whether clang++ supports C++11 features with +std=c++11... no
checking whether clang++ supports C++11 features with -h std=c++11... no
configure: error: *** A compiler with support for C++11 language features is required.
Error configuring fplll
...
```

Is this known, are there any patches needed?



---

archive/issue_comments_311705.json:
```json
{
    "body": "<a id='comment:35'></a>I have no problem with clang 3.9. It looks like 3.7 may not have enough features. You may have noticed that sage's configure said that clang 3.7 could support c+11 with -std=gnu++11. It didn't check with -std=c++11. However fplll doesn't want gnu++11\n\n```\nAX_CXX_COMPILE_STDCXX([11],[noext],[mandatory])\n```\nthe `noext` in fplll's configure.ac prevents you from using gnu++11. It would probably work though.",
    "created_at": "2017-06-23T11:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311705",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:35'></a>I have no problem with clang 3.9. It looks like 3.7 may not have enough features. You may have noticed that sage's configure said that clang 3.7 could support c+11 with -std=gnu++11. It didn't check with -std=c++11. However fplll doesn't want gnu++11

```
AX_CXX_COMPILE_STDCXX([11],[noext],[mandatory])
```
the `noext` in fplll's configure.ac prevents you from using gnu++11. It would probably work though.



---

archive/issue_comments_311706.json:
```json
{
    "body": "<a id='comment:36'></a>As well, I have some linking gevalt with flint:\n\n```\n...\nclang  -r ../build/ulong_extras/mulmod_precomp.lo ../build/ulong_extras/factor_trial_partial.lo ../build/ulong_extras/sizeinbase.lo .\n./build/ulong_extras/randbits.lo ../build/ulong_extras/is_square.lo ../build/ulong_extras/inlines.lo ../build/ulong_extras/clog.lo ..\n/build/ulong_extras/mulmod2_preinv.lo ../build/ulong_extras/factor_SQUFOF.lo ../build/ulong_extras/cbrt_newton_iteration.lo ../build/\nulong_extras/nth_prime_bounds.lo ../build/ulong_extras/is_probabprime_lucas.lo ../build/ulong_extras/primes_clear.lo ../build/ulong_e\nxtras/jacobi.lo ../build/ulong_extras/factor_partial.lo ../build/ulong_extras/mod2_precomp.lo ../build/ulong_extras/flog.lo ../build/\nulong_extras/is_probabprime_fibonacci.lo ../build/ulong_extras/factorial_mod2_preinv.lo ../build/ulong_extras/invmod.lo ../build/ulon\ng_extras/factor_pp1.lo ../build/ulong_extras/prime_inverses_arr_readonly.lo ../build/ulong_extras/is_probabprime_BPSW.lo ../build/ulo\nng_extras/powmod_preinv.lo ../build/ulong_extras/gcdinv.lo ../build/ulong_extras/randprime.lo ../build/ulong_extras/rootrem.lo ../bui\nld/ulong_extras/powmod_precomp.lo ../build/ulong_extras/randint.lo ../build/ulong_extras/is_prime_pseudosquare.lo ../build/ulong_extras/primes_init.lo ../build/ulong_extras/primes_sieve_range.lo ../build/ulong_extras/mod2_preinv.lo ../build/ulong_extras/is_perfect_power235.lo ../build/ulong_extras/moebius_mu.lo ../build/ulong_extras/sqrtrem.lo ../build/ulong_extras/factor_insert.lo ../build/ulong_extras/revbin.lo ../build/ulong_extras/mod_precomp.lo ../build/ulong_extras/cbrt_estimate.lo ../build/ulong_extras/primitive_root_prime.lo ../build/ulong_extras/factor.lo ../build/ulong_extras/factor_trial.lo ../build/ulong_extras/is_strong_probabprime2_preinv.lo ../build/ulong_extras/lll_mod_preinv.lo ../build/ulong_extras/is_prime_pocklington.lo ../build/ulong_extras/pow.lo ../build/ulong_extras/factor_power235.lo ../build/ulong_extras/sqrt.lo ../build/ulong_extras/remove2_precomp.lo ../build/ulong_extras/sqrtmodn.lo ../build/ulong_extras/root_estimate.lo ../build/ulong_extras/cbrtrem.lo ../build/ulong_extras/discrete_log_bsgs.lo ../build/ulong_extras/prime_pi.lo ../build/ulong_extras/sqrtmod_primepow.lo ../build/ulong_extras/randlimb.lo ../build/ulong_extras/sqrtmod.lo ../build/ulong_extras/root.lo ../build/ulong_extras/divrem2_precomp.lo ../build/ulong_extras/factorial_fast_mod2_preinv.lo ../build/ulong_extras/cbrt.lo ../build/ulong_extras/remove.lo ../build/ulong_extras/is_probabprime.lo ../build/ulong_extras/is_squarefree.lo ../build/ulong_extras/is_probabprime_fermat.lo ../build/ulong_extras/randtest.lo ../build/ulong_extras/primes_arr_readonly.lo ../build/ulong_extras/primes_jump_after.lo ../build/ulong_extras/is_prime.lo ../build/ulong_extras/nextprime.lo ../build/ulong_extras/compute_primes.lo ../build/ulong_extras/gcd.lo ../build/ulong_extras/nth_prime.lo ../build/ulong_extras/factor_lehman.lo ../build/ulong_extras/ll_mod_preinv.lo ../build/ulong_extras/prime_pi_bounds.lo ../build/ulong_extras/primes_extend_small.lo ../build/ulong_extras/is_strong_probabprime_precomp.lo ../build/ulong_extras/is_oddprime_binary.lo ../build/ulong_extras/cbrt_chebyshev_approximation.lo ../build/ulong_extras/cleanup_primes.lo ../build/ulong_extras/euler_phi.lo ../build/ulong_extras/factor_trial_range.lo ../build/ulong_extras/factor_one_line.lo ../build/ulong_extras/cbrt_binary_search.lo ../build/ulong_extras/xgcd.lo ../build/ulong_extras/is_oddprime_small.lo ../build/ulong_extras/powmod2_preinv.lo ../build/ulong_extras/mulmod_preinv.lo -o ../build/ulong_extras/../ulong_extras.lo -nostdlib\nclang: warning: argument unused during compilation: '-r'\n/usr/bin/ld: warning: cannot find entry symbol _start; defaulting to 00000000004001f0\n../build/ulong_extras/is_square.lo: In function `n_is_square':\n/home/scratch/dimpase/sage/sage-clang/local/var/tmp/sage/build/flint-2.5.2.p1/src/ulong_extras/is_square.c:54: undefined reference to `sqrt'\n...\n```\n\nIs this all due to `-stdlib=libstdc++` ?",
    "created_at": "2017-06-23T11:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311706",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'></a>As well, I have some linking gevalt with flint:

```
...
clang  -r ../build/ulong_extras/mulmod_precomp.lo ../build/ulong_extras/factor_trial_partial.lo ../build/ulong_extras/sizeinbase.lo .
./build/ulong_extras/randbits.lo ../build/ulong_extras/is_square.lo ../build/ulong_extras/inlines.lo ../build/ulong_extras/clog.lo ..
/build/ulong_extras/mulmod2_preinv.lo ../build/ulong_extras/factor_SQUFOF.lo ../build/ulong_extras/cbrt_newton_iteration.lo ../build/
ulong_extras/nth_prime_bounds.lo ../build/ulong_extras/is_probabprime_lucas.lo ../build/ulong_extras/primes_clear.lo ../build/ulong_e
xtras/jacobi.lo ../build/ulong_extras/factor_partial.lo ../build/ulong_extras/mod2_precomp.lo ../build/ulong_extras/flog.lo ../build/
ulong_extras/is_probabprime_fibonacci.lo ../build/ulong_extras/factorial_mod2_preinv.lo ../build/ulong_extras/invmod.lo ../build/ulon
g_extras/factor_pp1.lo ../build/ulong_extras/prime_inverses_arr_readonly.lo ../build/ulong_extras/is_probabprime_BPSW.lo ../build/ulo
ng_extras/powmod_preinv.lo ../build/ulong_extras/gcdinv.lo ../build/ulong_extras/randprime.lo ../build/ulong_extras/rootrem.lo ../bui
ld/ulong_extras/powmod_precomp.lo ../build/ulong_extras/randint.lo ../build/ulong_extras/is_prime_pseudosquare.lo ../build/ulong_extras/primes_init.lo ../build/ulong_extras/primes_sieve_range.lo ../build/ulong_extras/mod2_preinv.lo ../build/ulong_extras/is_perfect_power235.lo ../build/ulong_extras/moebius_mu.lo ../build/ulong_extras/sqrtrem.lo ../build/ulong_extras/factor_insert.lo ../build/ulong_extras/revbin.lo ../build/ulong_extras/mod_precomp.lo ../build/ulong_extras/cbrt_estimate.lo ../build/ulong_extras/primitive_root_prime.lo ../build/ulong_extras/factor.lo ../build/ulong_extras/factor_trial.lo ../build/ulong_extras/is_strong_probabprime2_preinv.lo ../build/ulong_extras/lll_mod_preinv.lo ../build/ulong_extras/is_prime_pocklington.lo ../build/ulong_extras/pow.lo ../build/ulong_extras/factor_power235.lo ../build/ulong_extras/sqrt.lo ../build/ulong_extras/remove2_precomp.lo ../build/ulong_extras/sqrtmodn.lo ../build/ulong_extras/root_estimate.lo ../build/ulong_extras/cbrtrem.lo ../build/ulong_extras/discrete_log_bsgs.lo ../build/ulong_extras/prime_pi.lo ../build/ulong_extras/sqrtmod_primepow.lo ../build/ulong_extras/randlimb.lo ../build/ulong_extras/sqrtmod.lo ../build/ulong_extras/root.lo ../build/ulong_extras/divrem2_precomp.lo ../build/ulong_extras/factorial_fast_mod2_preinv.lo ../build/ulong_extras/cbrt.lo ../build/ulong_extras/remove.lo ../build/ulong_extras/is_probabprime.lo ../build/ulong_extras/is_squarefree.lo ../build/ulong_extras/is_probabprime_fermat.lo ../build/ulong_extras/randtest.lo ../build/ulong_extras/primes_arr_readonly.lo ../build/ulong_extras/primes_jump_after.lo ../build/ulong_extras/is_prime.lo ../build/ulong_extras/nextprime.lo ../build/ulong_extras/compute_primes.lo ../build/ulong_extras/gcd.lo ../build/ulong_extras/nth_prime.lo ../build/ulong_extras/factor_lehman.lo ../build/ulong_extras/ll_mod_preinv.lo ../build/ulong_extras/prime_pi_bounds.lo ../build/ulong_extras/primes_extend_small.lo ../build/ulong_extras/is_strong_probabprime_precomp.lo ../build/ulong_extras/is_oddprime_binary.lo ../build/ulong_extras/cbrt_chebyshev_approximation.lo ../build/ulong_extras/cleanup_primes.lo ../build/ulong_extras/euler_phi.lo ../build/ulong_extras/factor_trial_range.lo ../build/ulong_extras/factor_one_line.lo ../build/ulong_extras/cbrt_binary_search.lo ../build/ulong_extras/xgcd.lo ../build/ulong_extras/is_oddprime_small.lo ../build/ulong_extras/powmod2_preinv.lo ../build/ulong_extras/mulmod_preinv.lo -o ../build/ulong_extras/../ulong_extras.lo -nostdlib
clang: warning: argument unused during compilation: '-r'
/usr/bin/ld: warning: cannot find entry symbol _start; defaulting to 00000000004001f0
../build/ulong_extras/is_square.lo: In function `n_is_square':
/home/scratch/dimpase/sage/sage-clang/local/var/tmp/sage/build/flint-2.5.2.p1/src/ulong_extras/is_square.c:54: undefined reference to `sqrt'
...
```

Is this all due to `-stdlib=libstdc++` ?



---

archive/issue_comments_311707.json:
```json
{
    "body": "<a id='comment:37'></a>Ha... the fix for compiling flint on debian 9 with pie breaks that compiler... That's because flint insist on not using autotools (duck for cover).\n\nI don't know how your clang 3.7 is built, it may also be using g++ libstdc++ in which case the version of g++ is important for c++11 support. Which version of gcc/g++ is this?",
    "created_at": "2017-06-23T11:07:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311707",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:37'></a>Ha... the fix for compiling flint on debian 9 with pie breaks that compiler... That's because flint insist on not using autotools (duck for cover).

I don't know how your clang 3.7 is built, it may also be using g++ libstdc++ in which case the version of g++ is important for c++11 support. Which version of gcc/g++ is this?



---

archive/issue_comments_311708.json:
```json
{
    "body": "<a id='comment:38'></a>with giac it's definitely some lib(std)c++-related trouble:\n\n```\n./index.h:572:11: error: no template named 'hash_map' in namespace 'std'; did you mean '__gnu_cxx::hash_map'?\n  typedef std::hash_map< index_t,index_m,hash_function_object > hash_index ;\n          ^~~~~~~~~~~~~\n          __gnu_cxx::hash_map\n```\n\nShould we abandon efforts to run on clang++ with libstdc++, and only allow libc++ with clang++ ?",
    "created_at": "2017-06-23T11:08:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311708",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:38'></a>with giac it's definitely some lib(std)c++-related trouble:

```
./index.h:572:11: error: no template named 'hash_map' in namespace 'std'; did you mean '__gnu_cxx::hash_map'?
  typedef std::hash_map< index_t,index_m,hash_function_object > hash_index ;
          ^~~~~~~~~~~~~
          __gnu_cxx::hash_map
```

Should we abandon efforts to run on clang++ with libstdc++, and only allow libc++ with clang++ ?



---

archive/issue_comments_311709.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:37 fbissey]:\n> Ha... the fix for compiling flint on debian 9 with pie breaks that compiler... That's because flint insist on not using autotools (duck for cover).\n\n\nhear, hear, `@`wbhart :-)\n> \n> I don't know how your clang 3.7 is built, it may also be using g++ libstdc++ in which case the version of g++ is important for c++11 support. Which version of gcc/g++ is this?\n\n\nIt's g++ 5.3.1.",
    "created_at": "2017-06-23T11:10:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311709",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>Replying to [comment:37 fbissey]:
> Ha... the fix for compiling flint on debian 9 with pie breaks that compiler... That's because flint insist on not using autotools (duck for cover).


hear, hear, `@`wbhart :-)
> 
> I don't know how your clang 3.7 is built, it may also be using g++ libstdc++ in which case the version of g++ is important for c++11 support. Which version of gcc/g++ is this?


It's g++ 5.3.1.



---

archive/issue_comments_311710.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:38 dimpase]:\n> with giac it's definitely some lib(std)c++-related trouble:\n> \n> ```\n> ./index.h:572:11: error: no template named 'hash_map' in namespace 'std'; did you mean '__gnu_cxx::hash_map'?\n>   typedef std::hash_map< index_t,index_m,hash_function_object > hash_index ;\n>           ^~~~~~~~~~~~~\n>           __gnu_cxx::hash_map\n> ```\n> \n> Should we abandon efforts to run on clang++ with libstdc++, and only allow libc++ with clang++ ?\n\n\nPossibly. More checks to devise. That clang 3.7 is obviously not good enough.",
    "created_at": "2017-06-23T11:30:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311710",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:40'></a>Replying to [comment:38 dimpase]:
> with giac it's definitely some lib(std)c++-related trouble:
> 
> ```
> ./index.h:572:11: error: no template named 'hash_map' in namespace 'std'; did you mean '__gnu_cxx::hash_map'?
>   typedef std::hash_map< index_t,index_m,hash_function_object > hash_index ;
>           ^~~~~~~~~~~~~
>           __gnu_cxx::hash_map
> ```
> 
> Should we abandon efforts to run on clang++ with libstdc++, and only allow libc++ with clang++ ?


Possibly. More checks to devise. That clang 3.7 is obviously not good enough.



---

archive/issue_comments_311711.json:
```json
{
    "body": "<a id='comment:41'></a>~~I'm trying this to test #12426 but I get a download error.  I already created an `upstream/` directory and placed the tarball on this ticket on it, so I'm not sure why it's even trying to download it.  That said, I started completely from scratch with a new `git clone`.~~  Error was mine, or my browser's, perhaps.",
    "created_at": "2017-06-23T14:10:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311711",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:41'></a>~~I'm trying this to test #12426 but I get a download error.  I already created an `upstream/` directory and placed the tarball on this ticket on it, so I'm not sure why it's even trying to download it.  That said, I started completely from scratch with a new `git clone`.~~  Error was mine, or my browser's, perhaps.



---

archive/issue_comments_311712.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:35 fbissey]:\n> I have no problem with clang 3.9. It looks like 3.7 may not have enough features. You may have noticed that sage's configure said that clang 3.7 could support c+11 with -std=gnu++11. It didn't check with -std=c++11. However fplll doesn't want gnu++11\n\n\nShouldn't Sage ./configure check for C++11 support with`-std=c++11`?\nCurrently it checks for C++11 support `-std=gnu++11`; e.g. on FreeBSD I see\n\n```\nchecking whether clang++-devel supports C++11 features with -std=gnu++11... yes\n```",
    "created_at": "2017-06-23T16:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311712",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:42'></a>Replying to [comment:35 fbissey]:
> I have no problem with clang 3.9. It looks like 3.7 may not have enough features. You may have noticed that sage's configure said that clang 3.7 could support c+11 with -std=gnu++11. It didn't check with -std=c++11. However fplll doesn't want gnu++11


Shouldn't Sage ./configure check for C++11 support with`-std=c++11`?
Currently it checks for C++11 support `-std=gnu++11`; e.g. on FreeBSD I see

```
checking whether clang++-devel supports C++11 features with -std=gnu++11... yes
```



---

archive/issue_comments_311713.json:
```json
{
    "body": "<a id='comment:43'></a>If you are using #12426 to test this you need the configure tarball from #12426.\n\nThe c++11 test is a bit more subtle than that. If you don't say anything it will check for both in turn, but starts with gnu++11 and stops if that works. If you want to force the test for std=c++11 you have to pass `noext` to the macro. gnu++11 should be a super set of c++11 which is why it stops there. I am not sure why fplll insists that you shouldn't use gnu++11.",
    "created_at": "2017-06-23T19:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311713",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:43'></a>If you are using #12426 to test this you need the configure tarball from #12426.

The c++11 test is a bit more subtle than that. If you don't say anything it will check for both in turn, but starts with gnu++11 and stops if that works. If you want to force the test for std=c++11 you have to pass `noext` to the macro. gnu++11 should be a super set of c++11 which is why it stops there. I am not sure why fplll insists that you shouldn't use gnu++11.



---

archive/issue_comments_311714.json:
```json
{
    "body": "<a id='comment:44'></a>concerning GF2X on FreeBSD (cf comment [comment:16]), does the following patch fix the issue?\n\n```\n--- a/configure.ac\n+++ b/configure.ac\n@@ -93,10 +93,10 @@ AC_ARG_ENABLE([fft-interface],\n AM_CONDITIONAL([ENABLE_FFT_INTERFACE],[test \"x$enable_fft_interface\" = xyes])\n\n AC_PROG_CC\n-AC_PROG_CPP\n AC_PROG_CXX\n AC_COMPILE_WARNINGS\n AC_PROG_CC_C99\n+AC_PROG_CPP\n\n GF2X_PROG_CC_FOR_BUILD\n GF2X_PROG_EXEEXT_FOR_BUILD\n```",
    "created_at": "2017-06-26T09:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311714",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:44'></a>concerning GF2X on FreeBSD (cf comment [comment:16]), does the following patch fix the issue?

```
--- a/configure.ac
+++ b/configure.ac
@@ -93,10 +93,10 @@ AC_ARG_ENABLE([fft-interface],
 AM_CONDITIONAL([ENABLE_FFT_INTERFACE],[test "x$enable_fft_interface" = xyes])

 AC_PROG_CC
-AC_PROG_CPP
 AC_PROG_CXX
 AC_COMPILE_WARNINGS
 AC_PROG_CC_C99
+AC_PROG_CPP

 GF2X_PROG_CC_FOR_BUILD
 GF2X_PROG_EXEEXT_FOR_BUILD
```



---

archive/issue_comments_311715.json:
```json
{
    "body": "<a id='comment:45'></a>Replying to [comment:44 zimmerma]:\n> concerning GF2X on FreeBSD (cf comment [comment:16]), does the following patch fix the issue?\n> \n> ```\n> --- a/configure.ac\n> +++ b/configure.ac\n> @@ -93,10 +93,10 @@ AC_ARG_ENABLE([fft-interface],\n>  AM_CONDITIONAL([ENABLE_FFT_INTERFACE],[test \"x$enable_fft_interface\" = xyes])\n> \n>  AC_PROG_CC\n> -AC_PROG_CPP\n>  AC_PROG_CXX\n>  AC_COMPILE_WARNINGS\n>  AC_PROG_CC_C99\n> +AC_PROG_CPP\n> \n>  GF2X_PROG_CC_FOR_BUILD\n>  GF2X_PROG_EXEEXT_FOR_BUILD\n> ```\n\n\nThe patch is difficult to apply considering there is no `AC_PROG_CPP` in gf2x-1.1, I think you missed thome's first commit adding it and you are only quoting the one moving it. I don't think the move matters too much by the way.",
    "created_at": "2017-06-26T09:30:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311715",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:45'></a>Replying to [comment:44 zimmerma]:
> concerning GF2X on FreeBSD (cf comment [comment:16]), does the following patch fix the issue?
> 
> ```
> --- a/configure.ac
> +++ b/configure.ac
> @@ -93,10 +93,10 @@ AC_ARG_ENABLE([fft-interface],
>  AM_CONDITIONAL([ENABLE_FFT_INTERFACE],[test "x$enable_fft_interface" = xyes])
> 
>  AC_PROG_CC
> -AC_PROG_CPP
>  AC_PROG_CXX
>  AC_COMPILE_WARNINGS
>  AC_PROG_CC_C99
> +AC_PROG_CPP
> 
>  GF2X_PROG_CC_FOR_BUILD
>  GF2X_PROG_EXEEXT_FOR_BUILD
> ```


The patch is difficult to apply considering there is no `AC_PROG_CPP` in gf2x-1.1, I think you missed thome's first commit adding it and you are only quoting the one moving it. I don't think the move matters too much by the way.



---

archive/issue_comments_311716.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:44 zimmerma]:\n> concerning GF2X on FreeBSD (cf comment [comment:16]), does the following patch fix the issue?\n> \n> ```\n> --- a/configure.ac\n> +++ b/configure.ac\n> @@ -93,10 +93,10 @@ AC_ARG_ENABLE([fft-interface],\n>  AM_CONDITIONAL([ENABLE_FFT_INTERFACE],[test \"x$enable_fft_interface\" = xyes])\n> \n>  AC_PROG_CC\n> -AC_PROG_CPP\n>  AC_PROG_CXX\n>  AC_COMPILE_WARNINGS\n>  AC_PROG_CC_C99\n> +AC_PROG_CPP\n> \n>  GF2X_PROG_CC_FOR_BUILD\n>  GF2X_PROG_EXEEXT_FOR_BUILD\n> ```\n\n\nAt present even with CPP and CXXCPP properly set, I still need \n`GF2X_CONFIGURE=\"--disable-hardware-specific-code $GF2X_CONFIGURE\"` - otherwise I get non-sensical errors at tune stage, saying something along the lines of \"this code can only be run on a 64-bit system\" (see #22679, the last commit)\n\nI was not able to figure out what goes wrong. Perhaps it's indeed this change that is needed to get the toolchain right, any idea?",
    "created_at": "2017-06-26T09:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311716",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:46'></a>Replying to [comment:44 zimmerma]:
> concerning GF2X on FreeBSD (cf comment [comment:16]), does the following patch fix the issue?
> 
> ```
> --- a/configure.ac
> +++ b/configure.ac
> @@ -93,10 +93,10 @@ AC_ARG_ENABLE([fft-interface],
>  AM_CONDITIONAL([ENABLE_FFT_INTERFACE],[test "x$enable_fft_interface" = xyes])
> 
>  AC_PROG_CC
> -AC_PROG_CPP
>  AC_PROG_CXX
>  AC_COMPILE_WARNINGS
>  AC_PROG_CC_C99
> +AC_PROG_CPP
> 
>  GF2X_PROG_CC_FOR_BUILD
>  GF2X_PROG_EXEEXT_FOR_BUILD
> ```


At present even with CPP and CXXCPP properly set, I still need 
`GF2X_CONFIGURE="--disable-hardware-specific-code $GF2X_CONFIGURE"` - otherwise I get non-sensical errors at tune stage, saying something along the lines of "this code can only be run on a 64-bit system" (see #22679, the last commit)

I was not able to figure out what goes wrong. Perhaps it's indeed this change that is needed to get the toolchain right, any idea?



---

archive/issue_comments_311717.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:46 dimpase]:\n> I still need \n> `GF2X_CONFIGURE=\"--disable-hardware-specific-code $GF2X_CONFIGURE\"` - otherwise I get non-sensical errors at tune stage, saying something along the lines of \"this code can only be run on a 64-bit system\" (see #22679, the last commit)\n> \n> I was not able to figure out what goes wrong. Perhaps it's indeed this change that is needed to get the toolchain right, any idea?\n> \n\n\nSetting CPP wouldn't help I think. Really we would need the failure (compilation line+ error message) and config.log. One thing you could try is to pull the current git master and see if that works.",
    "created_at": "2017-06-26T09:59:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311717",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:47'></a>Replying to [comment:46 dimpase]:
> I still need 
> `GF2X_CONFIGURE="--disable-hardware-specific-code $GF2X_CONFIGURE"` - otherwise I get non-sensical errors at tune stage, saying something along the lines of "this code can only be run on a 64-bit system" (see #22679, the last commit)
> 
> I was not able to figure out what goes wrong. Perhaps it's indeed this change that is needed to get the toolchain right, any idea?
> 


Setting CPP wouldn't help I think. Really we would need the failure (compilation line+ error message) and config.log. One thing you could try is to pull the current git master and see if that works.



---

archive/issue_comments_311718.json:
```json
{
    "body": "<a id='comment:48'></a>this works nicely on FreeBSD (I did not try building gfortran though), and I do need a small patch on top of #12426, see #22679.",
    "created_at": "2017-06-26T14:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311718",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:48'></a>this works nicely on FreeBSD (I did not try building gfortran though), and I do need a small patch on top of #12426, see #22679.



---

archive/issue_comments_311719.json:
```json
{
    "body": "<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-29T23:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311719",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311720.json:
```json
{
    "body": "<a id='comment:51'></a>Why did you drop the checks like `if [ -z \"$CC\" ]` when moving the code from `sage-env` to `sage-env-config`? It should still be possible to override `$CC` at runtime.",
    "created_at": "2017-06-30T10:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311720",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'></a>Why did you drop the checks like `if [ -z "$CC" ]` when moving the code from `sage-env` to `sage-env-config`? It should still be possible to override `$CC` at runtime.



---

archive/issue_comments_311721.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-06-30T10:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311721",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_311722.json:
```json
{
    "body": "<a id='comment:52'></a>Why `AC_PROG_OBJC([clang])` instead of `AC_PROG_OBJC()`? Doesn't `autoconf` search for `clang` by default? If not, you should at least add `cc` to the search list (see the old `sage-env`).",
    "created_at": "2017-06-30T10:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311722",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:52'></a>Why `AC_PROG_OBJC([clang])` instead of `AC_PROG_OBJC()`? Doesn't `autoconf` search for `clang` by default? If not, you should at least add `cc` to the search list (see the old `sage-env`).



---

archive/issue_comments_311723.json:
```json
{
    "body": "<a id='comment:53'></a>Replying to [comment:51 jdemeyer]:\n> Why did you drop the checks like `if [ -z \"$CC\" ]` when moving the code from `sage-env` to `sage-env-config`? It should still be possible to override `$CC` at runtime.\n\n\nGiving people the means to shoot themselves in the foot? I guess overriding `CC` at runtime is relatively safe, `CXX` and `FC` not so much.\n\nAs for `AC_PROG_OBJC`, I cannot find the default order anymore. It is only used by R on OS X, the idea was to cut the chase to what we really want there. But with such a short list all it does over just setting it is checking the presence. I guess I do overreach there.",
    "created_at": "2017-06-30T10:38:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311723",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:53'></a>Replying to [comment:51 jdemeyer]:
> Why did you drop the checks like `if [ -z "$CC" ]` when moving the code from `sage-env` to `sage-env-config`? It should still be possible to override `$CC` at runtime.


Giving people the means to shoot themselves in the foot? I guess overriding `CC` at runtime is relatively safe, `CXX` and `FC` not so much.

As for `AC_PROG_OBJC`, I cannot find the default order anymore. It is only used by R on OS X, the idea was to cut the chase to what we really want there. But with such a short list all it does over just setting it is checking the presence. I guess I do overreach there.



---

archive/issue_comments_311724.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:53 fbissey]:\n> I guess overriding `CC` at runtime is relatively safe, `CXX` and `FC` not so much.\n\n\nI think that's not for you to decide. The autoconf philosophy is to have sensible defaults but always allow customizing everything. There will always be (obscure) cases where you would want to override some environment variable and it's not fun if you need to edit `sage-env-config` for that.",
    "created_at": "2017-06-30T11:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311724",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:54'></a>Replying to [comment:53 fbissey]:
> I guess overriding `CC` at runtime is relatively safe, `CXX` and `FC` not so much.


I think that's not for you to decide. The autoconf philosophy is to have sensible defaults but always allow customizing everything. There will always be (obscure) cases where you would want to override some environment variable and it's not fun if you need to edit `sage-env-config` for that.



---

archive/issue_comments_311725.json:
```json
{
    "body": "<a id='comment:55'></a>It all depends where you put the balance between convenience and safety, and all that kind of stuff. At least I am sure you know the price for convenience.",
    "created_at": "2017-06-30T11:37:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311725",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:55'></a>It all depends where you put the balance between convenience and safety, and all that kind of stuff. At least I am sure you know the price for convenience.



---

archive/issue_comments_311726.json:
```json
{
    "body": "<a id='comment:56'></a>Well, it has always been possible to customize `$CC` on the fly and I don't think that this has led to many problems. So I see no reason to start disallowing it in this ticket.",
    "created_at": "2017-06-30T11:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311726",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:56'></a>Well, it has always been possible to customize `$CC` on the fly and I don't think that this has led to many problems. So I see no reason to start disallowing it in this ticket.



---

archive/issue_comments_311727.json:
```json
{
    "body": "<a id='comment:57'></a>To keep consistent with autotools packages, setting an environment variable such as CC should NOT override what has been configured using \"configure\". \n(Rather, to override, a user would use `make CC=....`.)",
    "created_at": "2017-06-30T14:46:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311727",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:57'></a>To keep consistent with autotools packages, setting an environment variable such as CC should NOT override what has been configured using "configure". 
(Rather, to override, a user would use `make CC=....`.)



---

archive/issue_comments_311728.json:
```json
{
    "body": "<a id='comment:58'></a>Replying to [comment:57 mkoeppe]:\n> To keep consistent with autotools packages, setting an environment variable such as CC should NOT override what has been configured using \"configure\". \n> (Rather, to override, a user would use `make CC=....`.)\n\n\nI see your point. However, not all Sage package use `make`, so this cannot work for Sage.\n\nAlternatively, we need to ensure that `make CC=...` really does work in all cases.",
    "created_at": "2017-06-30T16:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311728",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:58'></a>Replying to [comment:57 mkoeppe]:
> To keep consistent with autotools packages, setting an environment variable such as CC should NOT override what has been configured using "configure". 
> (Rather, to override, a user would use `make CC=....`.)


I see your point. However, not all Sage package use `make`, so this cannot work for Sage.

Alternatively, we need to ensure that `make CC=...` really does work in all cases.



---

archive/issue_comments_311729.json:
```json
{
    "body": "<a id='comment:59'></a>Replying to [comment:58 jdemeyer]:\n> Replying to [comment:57 mkoeppe]:\n> > To keep consistent with autotools packages, setting an environment variable such as CC should NOT override what has been configured using \"configure\". \n> > (Rather, to override, a user would use `make CC=....`.)\n\n> \n> I see your point. However, not all Sage package use `make`, so this cannot work for Sage.\n\n\nThis unrelated to what build systems Sage packages use. They just use the environment prepared by Sage's top-level build scripts and Makefiles.",
    "created_at": "2017-06-30T17:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311729",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:59'></a>Replying to [comment:58 jdemeyer]:
> Replying to [comment:57 mkoeppe]:
> > To keep consistent with autotools packages, setting an environment variable such as CC should NOT override what has been configured using "configure". 
> > (Rather, to override, a user would use `make CC=....`.)

> 
> I see your point. However, not all Sage package use `make`, so this cannot work for Sage.


This unrelated to what build systems Sage packages use. They just use the environment prepared by Sage's top-level build scripts and Makefiles.



---

archive/issue_comments_311730.json:
```json
{
    "body": "<a id='comment:60'></a>Replying to [comment:59 mkoeppe]:\n> This unrelated to what build systems Sage packages use.\n\n\nNo, it's not. GNU make passes variables to sub-makes, so a top-level `make CC=foo` will pass `CC=foo` when running `make` inside a specific package.",
    "created_at": "2017-06-30T18:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311730",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:60'></a>Replying to [comment:59 mkoeppe]:
> This unrelated to what build systems Sage packages use.


No, it's not. GNU make passes variables to sub-makes, so a top-level `make CC=foo` will pass `CC=foo` when running `make` inside a specific package.



---

archive/issue_comments_311731.json:
```json
{
    "body": "<a id='comment:61'></a>\"because we always did...\" is a terrible reason. But there is a point to both parties. If you want to be able to recompile a package with `CC=foo ./sage -f bar` then it is very convenient. But then would `make CC=foo bar` work instead? Of course, it will not work when we set a compiler in `spkg-install` (and we do that quite a bit on OS X).\n\nWhat I don't like about overriding the compilers at runtime (to use sage proper rather its packaging system) is that you can get in the situation of #21701 where for a while I had no clue what was happening. When you invoke sagelib, and you do some compilation with cython from sagelib, having the right compiler is rather critical. I don't like the idea of that compiler be able to be changed. It is an invitation to broken behavior.",
    "created_at": "2017-06-30T19:59:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311731",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:61'></a>"because we always did..." is a terrible reason. But there is a point to both parties. If you want to be able to recompile a package with `CC=foo ./sage -f bar` then it is very convenient. But then would `make CC=foo bar` work instead? Of course, it will not work when we set a compiler in `spkg-install` (and we do that quite a bit on OS X).

What I don't like about overriding the compilers at runtime (to use sage proper rather its packaging system) is that you can get in the situation of #21701 where for a while I had no clue what was happening. When you invoke sagelib, and you do some compilation with cython from sagelib, having the right compiler is rather critical. I don't like the idea of that compiler be able to be changed. It is an invitation to broken behavior.



---

archive/issue_comments_311732.json:
```json
{
    "body": "<a id='comment:62'></a>Replying to [comment:61 fbissey]:\n> \"because we always did...\" is a terrible reason.\n\n\nLet me rephrase it as \"because it always was possible\". You are proposing to *remove* a feature: being able to change compilers at any time. If you remove a feature, there should be a good reason for that.",
    "created_at": "2017-07-01T09:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311732",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:62'></a>Replying to [comment:61 fbissey]:
> "because we always did..." is a terrible reason.


Let me rephrase it as "because it always was possible". You are proposing to *remove* a feature: being able to change compilers at any time. If you remove a feature, there should be a good reason for that.



---

archive/issue_comments_311733.json:
```json
{
    "body": "<a id='comment:63'></a>I presume we can add `CC=` etc. as options to `sage -i` and `sage -f`. This would allow per package overriding. Does this go far enough to make everyone happy?",
    "created_at": "2017-07-01T10:31:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311733",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:63'></a>I presume we can add `CC=` etc. as options to `sage -i` and `sage -f`. This would allow per package overriding. Does this go far enough to make everyone happy?



---

archive/issue_comments_311734.json:
```json
{
    "body": "<a id='comment:64'></a>Replying to [comment:63 dimpase]:\n> I presume we can add `CC=` etc. as options to `sage -i` and `sage -f`. This would allow per package overriding. Does this go far enough to make everyone happy?\n\n\nLet's not bother with that. We could do a survey on whether or not people are using this \"feature\", that is purely accidental, on sage-devel. We have enough people that we would get a few yeses, even if it is just for the principle of the thing.\n\nDriving changes through people's throat is usually not a good idea. The best ways are \n* to offer something in exchange of greater value one way or another. The current offer is obviously not appropriate.\n* let people figure themselves that things needs to be changed, usually for their own good.\n\nIn that context I am happy to provide the \"shoot in the foot gun\", if it ever become painful enough, someone else will drive the change. I don't expect it will happen anytime soon because the reality is that it is a very low use \"feature\" for people that don't mind taking it in the foot on a regular basis in the first place.",
    "created_at": "2017-07-02T22:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311734",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:64'></a>Replying to [comment:63 dimpase]:
> I presume we can add `CC=` etc. as options to `sage -i` and `sage -f`. This would allow per package overriding. Does this go far enough to make everyone happy?


Let's not bother with that. We could do a survey on whether or not people are using this "feature", that is purely accidental, on sage-devel. We have enough people that we would get a few yeses, even if it is just for the principle of the thing.

Driving changes through people's throat is usually not a good idea. The best ways are 
* to offer something in exchange of greater value one way or another. The current offer is obviously not appropriate.
* let people figure themselves that things needs to be changed, usually for their own good.

In that context I am happy to provide the "shoot in the foot gun", if it ever become painful enough, someone else will drive the change. I don't expect it will happen anytime soon because the reality is that it is a very low use "feature" for people that don't mind taking it in the foot on a regular basis in the first place.



---

archive/issue_comments_311735.json:
```json
{
    "body": "<a id='comment:65'></a>`@` Jeroen question on implementation of said feature:\n\nCurrently (not this branch) an installed gcc installed by sage will be selected even if you provide an alternative compiler. Do you want to continue with that behavior or would you prefer things to be consistent and have a provided compiler always be the one used?",
    "created_at": "2017-07-02T22:26:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311735",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:65'></a>`@` Jeroen question on implementation of said feature:

Currently (not this branch) an installed gcc installed by sage will be selected even if you provide an alternative compiler. Do you want to continue with that behavior or would you prefer things to be consistent and have a provided compiler always be the one used?



---

archive/issue_comments_311736.json:
```json
{
    "body": "<a id='comment:66'></a>Replying to [comment:65 fbissey]:\n> Currently (not this branch) an installed gcc installed by sage will be selected even if you provide an alternative compiler. Do you want to continue with that behavior or would you prefer things to be consistent and have a provided compiler always be the one used?\n\n\nThat's a good question. I think it's not a very relevant question, since the people who like to play with different compilers will usually *not* use the Sage-compiled GCC.\n\nStill, for consistency, it makes more sense if an environment variable would override the compiler in all cases. So, the compiler should be determined by the following in decreasing order of priority:\n\n1. Environment variables\n\n2. Sage-installed GCC\n\n3. `./configure` setting",
    "created_at": "2017-07-03T08:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311736",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:66'></a>Replying to [comment:65 fbissey]:
> Currently (not this branch) an installed gcc installed by sage will be selected even if you provide an alternative compiler. Do you want to continue with that behavior or would you prefer things to be consistent and have a provided compiler always be the one used?


That's a good question. I think it's not a very relevant question, since the people who like to play with different compilers will usually *not* use the Sage-compiled GCC.

Still, for consistency, it makes more sense if an environment variable would override the compiler in all cases. So, the compiler should be determined by the following in decreasing order of priority:

1. Environment variables

2. Sage-installed GCC

3. `./configure` setting



---

archive/issue_comments_311737.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:66 jdemeyer]:\n> Replying to [comment:65 fbissey]:\n> > Currently (not this branch) an installed gcc installed by sage will be selected even if you provide an alternative compiler. Do you want to continue with that behavior or would you prefer things to be consistent and have a provided compiler always be the one used?\n\n> \n> That's a good question. I think it's not a very relevant question, since the people who like to play with different compilers will usually *not* use the Sage-compiled GCC.\n> \n> Still, for consistency, it makes more sense if an environment variable would override the compiler in all cases. So, the compiler should be determined by the following in decreasing order of priority:\n> \n> 1. Environment variables\n> \n> 2. Sage-installed GCC\n> \n> 3. `./configure` setting\n\n\nExactly my opinion of what it should be for consistency, we are in agreement - but since that is changing the behavior and all, better check ;)\n\nNow to the best way of achieving all that....",
    "created_at": "2017-07-03T09:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311737",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:67'></a>Replying to [comment:66 jdemeyer]:
> Replying to [comment:65 fbissey]:
> > Currently (not this branch) an installed gcc installed by sage will be selected even if you provide an alternative compiler. Do you want to continue with that behavior or would you prefer things to be consistent and have a provided compiler always be the one used?

> 
> That's a good question. I think it's not a very relevant question, since the people who like to play with different compilers will usually *not* use the Sage-compiled GCC.
> 
> Still, for consistency, it makes more sense if an environment variable would override the compiler in all cases. So, the compiler should be determined by the following in decreasing order of priority:
> 
> 1. Environment variables
> 
> 2. Sage-installed GCC
> 
> 3. `./configure` setting


Exactly my opinion of what it should be for consistency, we are in agreement - but since that is changing the behavior and all, better check ;)

Now to the best way of achieving all that....



---

archive/issue_comments_311738.json:
```json
{
    "body": "<a id='comment:68'></a>Replying to [comment:67 fbissey]:\n> Replying to [comment:66 jdemeyer]:\n> > Replying to [comment:65 fbissey]:\n> > > Currently (not this branch) an installed gcc installed by sage will be selected even if you provide an alternative compiler. Do you want to continue with that behavior or would you prefer things to be consistent and have a provided compiler always be the one used?\n\n> > \n> > That's a good question. I think it's not a very relevant question, since the people who like to play with different compilers will usually *not* use the Sage-compiled GCC.\n> > \n\n\nFor people who use OSX it's not a play, it's matter of having working Sage, or not...",
    "created_at": "2017-07-03T09:40:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311738",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:68'></a>Replying to [comment:67 fbissey]:
> Replying to [comment:66 jdemeyer]:
> > Replying to [comment:65 fbissey]:
> > > Currently (not this branch) an installed gcc installed by sage will be selected even if you provide an alternative compiler. Do you want to continue with that behavior or would you prefer things to be consistent and have a provided compiler always be the one used?

> > 
> > That's a good question. I think it's not a very relevant question, since the people who like to play with different compilers will usually *not* use the Sage-compiled GCC.
> > 


For people who use OSX it's not a play, it's matter of having working Sage, or not...



---

archive/issue_comments_311739.json:
```json
{
    "body": "<a id='comment:69'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-03T10:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311739",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:69'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311740.json:
```json
{
    "body": "<a id='comment:70'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-03T10:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311740",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:70'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311741.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-03T10:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311741",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_311742.json:
```json
{
    "body": "<a id='comment:71'></a>New tarball will be up in the morning in my time zone. Otherwise back to review.",
    "created_at": "2017-07-03T10:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311742",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:71'></a>New tarball will be up in the morning in my time zone. Otherwise back to review.



---

archive/issue_comments_311743.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-03T13:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311743",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_311744.json:
```json
{
    "body": "<a id='comment:72'></a>I think that this logic\n\n```\n# On OS X 10.7 (Lion) or later when building GCC, use clang as\n# default C compiler as some older versions of XCode 4 ship broken\n# versions of GCC which fail to bootstrap GCC-4.6.3.\n# See http://trac.sagemath.org/sage_trac/ticket/12820\nif [ \"$SAGE_BUILD_TOOLCHAIN\" = yes ] && [ \"$UNAME\" = \"Darwin\" ] && [ \"$MACOSX_VERSION\" -ge 11 ; then\n    CC=`which clang 2>/dev/null`\n    CXX=`which clang++ 2>/dev/null`\n```\nshould also be moved to `configure`.\n\nUnfortunately, autoconf 2.69 (which is still the latest release despite being 5 years old) does not support `clang`.\n\nSo I suggest something along the lines of\n\n```\nif test -z \"$CC\"; then\n    if test -n \"$MACOSX_VERSION\" && test \"$MACOSX_VERSION\" -ge 11 ; then\n        AC_CHECK_TOOL(CC, clang)\n    fi\nfi\nAC_PROG_CC()\n```",
    "created_at": "2017-07-03T13:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311744",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:72'></a>I think that this logic

```
# On OS X 10.7 (Lion) or later when building GCC, use clang as
# default C compiler as some older versions of XCode 4 ship broken
# versions of GCC which fail to bootstrap GCC-4.6.3.
# See http://trac.sagemath.org/sage_trac/ticket/12820
if [ "$SAGE_BUILD_TOOLCHAIN" = yes ] && [ "$UNAME" = "Darwin" ] && [ "$MACOSX_VERSION" -ge 11 ; then
    CC=`which clang 2>/dev/null`
    CXX=`which clang++ 2>/dev/null`
```
should also be moved to `configure`.

Unfortunately, autoconf 2.69 (which is still the latest release despite being 5 years old) does not support `clang`.

So I suggest something along the lines of

```
if test -z "$CC"; then
    if test -n "$MACOSX_VERSION" && test "$MACOSX_VERSION" -ge 11 ; then
        AC_CHECK_TOOL(CC, clang)
    fi
fi
AC_PROG_CC()
```



---

archive/issue_comments_311745.json:
```json
{
    "body": "<a id='comment:73'></a>I think that's just scope creep. But I am willing to make some concessions. In that particular case I think we could just remove that particular piece of code. It seems to go back to when apple was still shipping a \"real\" apple patched gcc rather than having it being a clang wrapper. I don't think we should continue to support such snowflakes. In fact I don't think we realistically support anything older than xcode 6 but most likely 7.",
    "created_at": "2017-07-03T21:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311745",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:73'></a>I think that's just scope creep. But I am willing to make some concessions. In that particular case I think we could just remove that particular piece of code. It seems to go back to when apple was still shipping a "real" apple patched gcc rather than having it being a clang wrapper. I don't think we should continue to support such snowflakes. In fact I don't think we realistically support anything older than xcode 6 but most likely 7.



---

archive/issue_comments_311746.json:
```json
{
    "body": "<a id='comment:74'></a>Replying to [comment:73 fbissey]:\n> In fact I don't think we realistically support anything older than xcode 6 but most likely 7.\n\n\nSo you are saying that Sage 8.0 wouldn't build anyway on OS X 10.7 for example?",
    "created_at": "2017-07-04T08:00:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311746",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:74'></a>Replying to [comment:73 fbissey]:
> In fact I don't think we realistically support anything older than xcode 6 but most likely 7.


So you are saying that Sage 8.0 wouldn't build anyway on OS X 10.7 for example?



---

archive/issue_comments_311747.json:
```json
{
    "body": "<a id='comment:75'></a>Replying to [comment:74 jdemeyer]:\n> Replying to [comment:73 fbissey]:\n> > In fact I don't think we realistically support anything older than xcode 6 but most likely 7.\n\n> \n> So you are saying that Sage 8.0 wouldn't build anyway on OS X 10.7 for example?\n\n\nDepends which version of xcode you can put on there. But if you cannot install xcode 7, I'd say with difficulties. I could be wrong but I expect it wouldn't build out of the box. May be with a bit of hand holding. Do we know what versions we have on the build bots? A lot of the third party software binaries these days don't go further back than 10.9 in backward compatibility support. I think there are serious limitations in going further back.",
    "created_at": "2017-07-04T08:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311747",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:75'></a>Replying to [comment:74 jdemeyer]:
> Replying to [comment:73 fbissey]:
> > In fact I don't think we realistically support anything older than xcode 6 but most likely 7.

> 
> So you are saying that Sage 8.0 wouldn't build anyway on OS X 10.7 for example?


Depends which version of xcode you can put on there. But if you cannot install xcode 7, I'd say with difficulties. I could be wrong but I expect it wouldn't build out of the box. May be with a bit of hand holding. Do we know what versions we have on the build bots? A lot of the third party software binaries these days don't go further back than 10.9 in backward compatibility support. I think there are serious limitations in going further back.



---

archive/issue_comments_311748.json:
```json
{
    "body": "<a id='comment:76'></a>Replying to [comment:73 fbissey]:\n> It seems to go back to when apple was still shipping a \"real\" apple patched gcc rather than having it being a clang wrapper.\n\n\nSo, with XCode, the `gcc` and `clang` programs are exactly the same? That would indeed mean that there is no reason for the code in [comment:72]. Should we just remove it?",
    "created_at": "2017-07-04T08:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311748",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:76'></a>Replying to [comment:73 fbissey]:
> It seems to go back to when apple was still shipping a "real" apple patched gcc rather than having it being a clang wrapper.


So, with XCode, the `gcc` and `clang` programs are exactly the same? That would indeed mean that there is no reason for the code in [comment:72]. Should we just remove it?



---

archive/issue_comments_311749.json:
```json
{
    "body": "<a id='comment:77'></a>xcode 8:\n\n```\nMirage:~ fbissey$ /usr/bin/gcc -v\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 8.1.0 (clang-802.0.42)\nTarget: x86_64-apple-darwin16.6.0\nThread model: posix\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\n```\nxcode 7 and 6 were similar. I don't remember much before that. But yes you are now seeing it my way: removal seems a better idea.",
    "created_at": "2017-07-04T08:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311749",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:77'></a>xcode 8:

```
Mirage:~ fbissey$ /usr/bin/gcc -v
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 8.1.0 (clang-802.0.42)
Target: x86_64-apple-darwin16.6.0
Thread model: posix
InstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin
```
xcode 7 and 6 were similar. I don't remember much before that. But yes you are now seeing it my way: removal seems a better idea.



---

archive/issue_comments_311750.json:
```json
{
    "body": "<a id='comment:78'></a>IMHO we should drop OSX 10.6. On the other hand, Apple continues to sell OSX 10.7---it's probably the oldest system they currently support.",
    "created_at": "2017-07-04T08:51:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311750",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:78'></a>IMHO we should drop OSX 10.6. On the other hand, Apple continues to sell OSX 10.7---it's probably the oldest system they currently support.



---

archive/issue_comments_311751.json:
```json
{
    "body": "<a id='comment:79'></a>Replying to [comment:78 dimpase]:\n> IMHO we should drop OSX 10.6. On the other hand, Apple continues to sell OSX 10.7---it's probably the oldest system they currently support.\n\n\nReally??? Is it just an upgrade path or is it for \"vintage\" hardware?",
    "created_at": "2017-07-04T08:52:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311751",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:79'></a>Replying to [comment:78 dimpase]:
> IMHO we should drop OSX 10.6. On the other hand, Apple continues to sell OSX 10.7---it's probably the oldest system they currently support.


Really??? Is it just an upgrade path or is it for "vintage" hardware?



---

archive/issue_comments_311752.json:
```json
{
    "body": "<a id='comment:80'></a>Replying to [comment:79 fbissey]:\n> Replying to [comment:78 dimpase]:\n> > IMHO we should drop OSX 10.6. On the other hand, Apple continues to sell OSX 10.7---it's probably the oldest system they currently support.\n\n> \n> Really??? Is it just an upgrade path or is it for \"vintage\" hardware?\n\n\nthe latter, I think---one can buy an official DVD:\nhttps://www.apple.com/uk/shop/product/D6106ZM/A/os-x-lion",
    "created_at": "2017-07-04T08:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311752",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:80'></a>Replying to [comment:79 fbissey]:
> Replying to [comment:78 dimpase]:
> > IMHO we should drop OSX 10.6. On the other hand, Apple continues to sell OSX 10.7---it's probably the oldest system they currently support.

> 
> Really??? Is it just an upgrade path or is it for "vintage" hardware?


the latter, I think---one can buy an official DVD:
https://www.apple.com/uk/shop/product/D6106ZM/A/os-x-lion



---

archive/issue_comments_311753.json:
```json
{
    "body": "<a id='comment:81'></a>Could be an upgrade path as well. You need at least 10.7 to have the app store through which you can install OS X upgrades. I think you cannot do that from 10.6, you need a media or at the very least a `.dmg`. I had an old imac like that for which I would have needed the media (it's dead now, the gpu died). \n\nOr I could have my versions mixed up.",
    "created_at": "2017-07-04T09:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311753",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:81'></a>Could be an upgrade path as well. You need at least 10.7 to have the app store through which you can install OS X upgrades. I think you cannot do that from 10.6, you need a media or at the very least a `.dmg`. I had an old imac like that for which I would have needed the media (it's dead now, the gpu died). 

Or I could have my versions mixed up.



---

archive/issue_comments_311754.json:
```json
{
    "body": "<a id='comment:82'></a>> IMHO we should drop OSX 10.6. On the other hand, Apple continues to sell OSX 10.7---it's probably the oldest system they currently support.\n\n\nGiven that people with hardware for 10.6 can probably upgrade to 10.7, this might seem reasonable.",
    "created_at": "2017-07-04T13:32:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311754",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:82'></a>> IMHO we should drop OSX 10.6. On the other hand, Apple continues to sell OSX 10.7---it's probably the oldest system they currently support.


Given that people with hardware for 10.6 can probably upgrade to 10.7, this might seem reasonable.



---

archive/issue_comments_311755.json:
```json
{
    "body": "<a id='comment:83'></a>I just checked that one can still get official OSX 10.6 just as well...\n(but no 10.5).\n10.6 has a feature missing in 10.7, it can run PPC applications.\nOther than that, I don't see why people would want to stick with it.",
    "created_at": "2017-07-04T14:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311755",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:83'></a>I just checked that one can still get official OSX 10.6 just as well...
(but no 10.5).
10.6 has a feature missing in 10.7, it can run PPC applications.
Other than that, I don't see why people would want to stick with it.



---

archive/issue_comments_311756.json:
```json
{
    "body": "<a id='comment:84'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-05T03:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311756",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:84'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311757.json:
```json
{
    "body": "<a id='comment:85'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-05T03:11:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311757",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:85'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311758.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-05T03:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311758",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_311759.json:
```json
{
    "body": "<a id='comment:86'></a>OK so removed that old cruft for now. May be we'll discover one of the bots still has a very old version of OS X.",
    "created_at": "2017-07-05T03:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311759",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:86'></a>OK so removed that old cruft for now. May be we'll discover one of the bots still has a very old version of OS X.



---

archive/issue_comments_311760.json:
```json
{
    "body": "<a id='comment:87'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-06T01:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311760",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:87'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311761.json:
```json
{
    "body": "<a id='comment:89'></a>Two comments:\n\n1) Strong objection to mixing an autoconf feature with sage-specific behavior (environment CC overrides configured CC), which makes it different from any other autoconf-based package. It is an important feature that the configured variables stick in the build and that this works even in the presence of some polluted environment.\n\nIf it is really necessary to make overriding possible using environment settings, you can invent new variables such as `SAGE_OVERRIDE_CC` etc.\n\n2) I would suggest to only set variables in `sage-env-config` and keep all logic (if-then) in `sage-env`. For example:\n\n```\nSAGE_CONFIGURED_CC=\"@CC@\"\n```",
    "created_at": "2017-07-06T19:16:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311761",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:89'></a>Two comments:

1) Strong objection to mixing an autoconf feature with sage-specific behavior (environment CC overrides configured CC), which makes it different from any other autoconf-based package. It is an important feature that the configured variables stick in the build and that this works even in the presence of some polluted environment.

If it is really necessary to make overriding possible using environment settings, you can invent new variables such as `SAGE_OVERRIDE_CC` etc.

2) I would suggest to only set variables in `sage-env-config` and keep all logic (if-then) in `sage-env`. For example:

```
SAGE_CONFIGURED_CC="@CC@"
```



---

archive/issue_comments_311762.json:
```json
{
    "body": "<a id='comment:90'></a>Replying to [comment:89 mkoeppe]:\n> Two comments:\n> \n> 1) Strong objection to mixing an autoconf feature with sage-specific behavior (environment CC overrides configured CC), which makes it different from any other autoconf-based package. It is an important feature that the configured variables stick in the build and that this works even in the presence of some polluted environment.\n> \n> If it is really necessary to make overriding possible using environment settings, you can invent new variables such as `SAGE_OVERRIDE_CC` etc.\n> \n\n\nNo. I just tried an autotooled package (gf2x), you can configure with one compiler and over-ride it at build time with `CC` and co. However I discourage anyone to over-ride it at runtime if you need to compile `cython` files from inside sage. That's my usual dichotomy problem between sage the packaging stack and sage, the python runtime on which you do your math.\n\n> 2) I would suggest to only set variables in `sage-env-config` and keep all logic (if-then) in `sage-env`. For example:\n> \n> ```\n> SAGE_CONFIGURED_CC=\"@CC@\"\n> ```\n> \n\n\nAs the requester on this ticket I wish you had expressed yourself earlier on that particular design. It is a fine idea to confine `sage-env-config` to be a variable store without any logic in it. I just wish I had that requirement earlier. I had the first draft of the current design up 2 months ago and really opened to criticism 7 weeks ago.",
    "created_at": "2017-07-06T22:28:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311762",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:90'></a>Replying to [comment:89 mkoeppe]:
> Two comments:
> 
> 1) Strong objection to mixing an autoconf feature with sage-specific behavior (environment CC overrides configured CC), which makes it different from any other autoconf-based package. It is an important feature that the configured variables stick in the build and that this works even in the presence of some polluted environment.
> 
> If it is really necessary to make overriding possible using environment settings, you can invent new variables such as `SAGE_OVERRIDE_CC` etc.
> 


No. I just tried an autotooled package (gf2x), you can configure with one compiler and over-ride it at build time with `CC` and co. However I discourage anyone to over-ride it at runtime if you need to compile `cython` files from inside sage. That's my usual dichotomy problem between sage the packaging stack and sage, the python runtime on which you do your math.

> 2) I would suggest to only set variables in `sage-env-config` and keep all logic (if-then) in `sage-env`. For example:
> 
> ```
> SAGE_CONFIGURED_CC="@CC@"
> ```
> 


As the requester on this ticket I wish you had expressed yourself earlier on that particular design. It is a fine idea to confine `sage-env-config` to be a variable store without any logic in it. I just wish I had that requirement earlier. I had the first draft of the current design up 2 months ago and really opened to criticism 7 weeks ago.



---

archive/issue_comments_311763.json:
```json
{
    "body": "<a id='comment:91'></a>Replying to [comment:89 mkoeppe]:\n> Strong objection to mixing an autoconf feature with sage-specific behavior (environment CC overrides configured CC), which makes it different from any other autoconf-based package.\n\n\nI don't consider Sage to be a \"package\" (it's a distribution of packages), so I don't see it as an issue that it behaves differently from other packages. It's comparing an apple with oranges. It has always been the case in Sage that a `CC` environment variable overrides the default `CC` and nobody has ever considered this a problem.\n\n> If it is really necessary to make overriding possible using environment settings, you can invent new variables such as `SAGE_OVERRIDE_CC` etc.\n\n\nIn that case, we should simply support `make CC=...` from the top-level. But that will require some additional work.",
    "created_at": "2017-07-07T08:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311763",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:91'></a>Replying to [comment:89 mkoeppe]:
> Strong objection to mixing an autoconf feature with sage-specific behavior (environment CC overrides configured CC), which makes it different from any other autoconf-based package.


I don't consider Sage to be a "package" (it's a distribution of packages), so I don't see it as an issue that it behaves differently from other packages. It's comparing an apple with oranges. It has always been the case in Sage that a `CC` environment variable overrides the default `CC` and nobody has ever considered this a problem.

> If it is really necessary to make overriding possible using environment settings, you can invent new variables such as `SAGE_OVERRIDE_CC` etc.


In that case, we should simply support `make CC=...` from the top-level. But that will require some additional work.



---

archive/issue_comments_311764.json:
```json
{
    "body": "<a id='comment:92'></a>Replying to [comment:90 fbissey]:\n> Replying to [comment:89 mkoeppe]:\n> > 1) Strong objection to mixing an autoconf feature with sage-specific behavior (environment CC overrides configured CC), which makes it different from any other autoconf-based package. It is an important feature that the configured variables stick in the build and that this works even in the presence of some polluted environment.\n\n> \n> No. I just tried an autotooled package (gf2x), you can configure with one compiler and over-ride it at build time with `CC` and co. \n\n\nYou don't say what exactly you tried.\nMy point is that you *can* override by using makefile variables like this:\n\n```\n   make CC=xyzzy\n```\nbut you *cannot* override using environment variables:\n\n```\n  CC=xyzzy make\n```\n\nAny implementation for Sage should copy this behavior.",
    "created_at": "2017-07-07T17:20:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311764",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:92'></a>Replying to [comment:90 fbissey]:
> Replying to [comment:89 mkoeppe]:
> > 1) Strong objection to mixing an autoconf feature with sage-specific behavior (environment CC overrides configured CC), which makes it different from any other autoconf-based package. It is an important feature that the configured variables stick in the build and that this works even in the presence of some polluted environment.

> 
> No. I just tried an autotooled package (gf2x), you can configure with one compiler and over-ride it at build time with `CC` and co. 


You don't say what exactly you tried.
My point is that you *can* override by using makefile variables like this:

```
   make CC=xyzzy
```
but you *cannot* override using environment variables:

```
  CC=xyzzy make
```

Any implementation for Sage should copy this behavior.



---

archive/issue_comments_311765.json:
```json
{
    "body": "<a id='comment:93'></a>Replying to [comment:90 fbissey]:\n> As the requester on this ticket I wish you had expressed yourself earlier on that particular design. It is a fine idea to confine `sage-env-config` to be a variable store without any logic in it. I just wish I had that requirement earlier. I had the first draft of the current design up 2 months ago and really opened to criticism 7 weeks ago.\n\n\nRight, and I wish I had more time for Sage development lately. In any case, this one is just a suggestion. If #21707 is still something that we want to do, we can change the structure of these scripts at that time.",
    "created_at": "2017-07-07T17:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311765",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:93'></a>Replying to [comment:90 fbissey]:
> As the requester on this ticket I wish you had expressed yourself earlier on that particular design. It is a fine idea to confine `sage-env-config` to be a variable store without any logic in it. I just wish I had that requirement earlier. I had the first draft of the current design up 2 months ago and really opened to criticism 7 weeks ago.


Right, and I wish I had more time for Sage development lately. In any case, this one is just a suggestion. If #21707 is still something that we want to do, we can change the structure of these scripts at that time.



---

archive/issue_comments_311766.json:
```json
{
    "body": "<a id='comment:94'></a>`@` mkoeppe\nI guess we are all there in regards to time [in fact I started writting this answer more than 24 hours ago now...]. I was just venting.\n\nI have no vested interest in #21707. If anything I think this is misguided at this point. I think some other work like the decoupling of \"sagelib\" from the packaging system should be done first and would be beneficial to some of what you seek in #21707 in the long run (personal opinion).\n\nI will turn `sage-env-config` in a variable store in this ticket. It is not going to be included but could be material early in the 8.1 cycle.\n\nOn that note I will leave the current behavior for over-riding `CC`. I don't want to be part of that debate more than is necessary. Feel free to open a ticket to get the behavior you want, but I think you need to get traction from sage-devel first, since there is opposition.",
    "created_at": "2017-07-10T23:10:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311766",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:94'></a>`@` mkoeppe
I guess we are all there in regards to time [in fact I started writting this answer more than 24 hours ago now...]. I was just venting.

I have no vested interest in #21707. If anything I think this is misguided at this point. I think some other work like the decoupling of "sagelib" from the packaging system should be done first and would be beneficial to some of what you seek in #21707 in the long run (personal opinion).

I will turn `sage-env-config` in a variable store in this ticket. It is not going to be included but could be material early in the 8.1 cycle.

On that note I will leave the current behavior for over-riding `CC`. I don't want to be part of that debate more than is necessary. Feel free to open a ticket to get the behavior you want, but I think you need to get traction from sage-devel first, since there is opposition.



---

archive/issue_comments_311767.json:
```json
{
    "body": "<a id='comment:95'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-10T23:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311767",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:95'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_059051.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-07-10T23:26:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22646#event-59051"
}
```



---

archive/issue_comments_311768.json:
```json
{
    "body": "<a id='comment:97'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-22T21:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311768",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:97'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311769.json:
```json
{
    "body": "<a id='comment:99'></a>From looking at the latest patch, `$` seems to be missing in front of `CONFIGURED_CXX` etc. in several places in `src/bin/sage-env`. (Haven't tested.)",
    "created_at": "2017-07-26T04:42:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311769",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:99'></a>From looking at the latest patch, `$` seems to be missing in front of `CONFIGURED_CXX` etc. in several places in `src/bin/sage-env`. (Haven't tested.)



---

archive/issue_comments_311770.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-26T04:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311770",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_311771.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-26T04:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311771",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311772.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-26T04:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311772",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_311773.json:
```json
{
    "body": "<a id='comment:2'></a>Indeed, fixed.",
    "created_at": "2017-07-26T04:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311773",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>Indeed, fixed.



---

archive/issue_comments_311774.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-30T22:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311774",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311775.json:
```json
{
    "body": "<a id='comment:5'></a>It would be nice to get this merged soon, so it is early in the 8.1 release cycle. What are the obstacles to this?",
    "created_at": "2017-07-30T23:57:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311775",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'></a>It would be nice to get this merged soon, so it is early in the 8.1 release cycle. What are the obstacles to this?



---

archive/issue_comments_311776.json:
```json
{
    "body": "<a id='comment:106'></a>Replying to [comment:105 jhpalmieri]:\n> It would be nice to get this merged soon, so it is early in the 8.1 release cycle. What are the obstacles to this?\n\n\nPossibly bikering over what behavior it should enforce. Currently `CC=.. ./sage -f ...` or `CC=... make ....` will over-ride the configure time compiler. Some people think it shouldn't, only `make ... CC=...` should.",
    "created_at": "2017-07-31T00:01:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311776",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:106'></a>Replying to [comment:105 jhpalmieri]:
> It would be nice to get this merged soon, so it is early in the 8.1 release cycle. What are the obstacles to this?


Possibly bikering over what behavior it should enforce. Currently `CC=.. ./sage -f ...` or `CC=... make ....` will over-ride the configure time compiler. Some people think it shouldn't, only `make ... CC=...` should.



---

archive/issue_comments_311777.json:
```json
{
    "body": "<a id='comment:7'></a>But be my guest in reviewing this.",
    "created_at": "2017-07-31T02:13:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311777",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>But be my guest in reviewing this.



---

archive/issue_comments_311778.json:
```json
{
    "body": "<a id='comment:108'></a>Replying to [comment:106 fbissey]:\n> Possibly bikering over what behavior it should enforce. Currently `CC=.. ./sage -f ...` or `CC=... make ....` will over-ride the configure time compiler. Some people think it shouldn't, only `make ... CC=...` should.\n\n\nWould a simple renaming of the the configure parameters from `CC=` to `--c-compiler=`, etc, alleviate at least some of concerns (unless there is some hidden magic in naming the parameter `CC`---I hope not)? Personally, every time I do `./configure CC=...` I get deja vu---maybe it's just me though.",
    "created_at": "2017-07-31T07:21:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311778",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:108'></a>Replying to [comment:106 fbissey]:
> Possibly bikering over what behavior it should enforce. Currently `CC=.. ./sage -f ...` or `CC=... make ....` will over-ride the configure time compiler. Some people think it shouldn't, only `make ... CC=...` should.


Would a simple renaming of the the configure parameters from `CC=` to `--c-compiler=`, etc, alleviate at least some of concerns (unless there is some hidden magic in naming the parameter `CC`---I hope not)? Personally, every time I do `./configure CC=...` I get deja vu---maybe it's just me though.



---

archive/issue_comments_311779.json:
```json
{
    "body": "<a id='comment:9'></a>I am not sure what that would achieve. `AC_PROG_CC` makes sure that CC, which is used in standard makefile rules is set to something sensible - by going through a list or checking that the current setting of CC is sane. You may have deja vu because you haven't been on a system with a variety of compilers available out of the box and where you often wants something different from the default.\n\nIf you are going to use something non-standard like `--c-compiler=`I am almost tempted to tell you not to use it to set `CC` either. But then you lose some of the work `AC_PROG_CC` does for you [test that the compiler work, if it is gcc (real or fake)].",
    "created_at": "2017-07-31T10:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311779",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>I am not sure what that would achieve. `AC_PROG_CC` makes sure that CC, which is used in standard makefile rules is set to something sensible - by going through a list or checking that the current setting of CC is sane. You may have deja vu because you haven't been on a system with a variety of compilers available out of the box and where you often wants something different from the default.

If you are going to use something non-standard like `--c-compiler=`I am almost tempted to tell you not to use it to set `CC` either. But then you lose some of the work `AC_PROG_CC` does for you [test that the compiler work, if it is gcc (real or fake)].



---

archive/issue_comments_311780.json:
```json
{
    "body": "<a id='comment:110'></a>Replying to [comment:109 fbissey]:\n> I am not sure what that would achieve. `AC_PROG_CC` makes sure that CC, which is used in standard makefile rules is set to something sensible - by going through a list or checking that the current setting of CC is sane. You may have deja vu because you haven't been on a system with a variety of compilers available out of the box and where you often wants something different from the default.\n\n\n\nI certainly have been there and wanted that, my point is that having `CC=...` as a parameter to a script (rather than an environment variable) is akin to having two girlfriends with the same given name---sometimes convenient, but sometimes making you dazed and confused... ;-)\n\n  \n> \n> If you are going to use something non-standard like `--c-compiler=`I am almost tempted to tell you not to use it to set `CC` either. But then you lose some of the work `AC_PROG_CC` does for you [test that the compiler work, if it is gcc (real or fake)].\n\n\nI don't see what you mean here. E.g. in `configure.ac` one can probably do something like\n\n```\nCCORIG=gcc\nAC_SUBST(CC,$CCORIG)\nAC_ARG_WITH(cc,AS_HELP_STRING(--with-cc=...,specify the full path to the C compiler ($CC)),CC=$withval)\nAC_PROG_CC()\n...\nAC_ARG_WITH(cxx,...\n```\nto create `./configure` arguments such as `--with-cc=`, and set `CC`, etc to the right values.",
    "created_at": "2017-07-31T15:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311780",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:110'></a>Replying to [comment:109 fbissey]:
> I am not sure what that would achieve. `AC_PROG_CC` makes sure that CC, which is used in standard makefile rules is set to something sensible - by going through a list or checking that the current setting of CC is sane. You may have deja vu because you haven't been on a system with a variety of compilers available out of the box and where you often wants something different from the default.



I certainly have been there and wanted that, my point is that having `CC=...` as a parameter to a script (rather than an environment variable) is akin to having two girlfriends with the same given name---sometimes convenient, but sometimes making you dazed and confused... ;-)

  
> 
> If you are going to use something non-standard like `--c-compiler=`I am almost tempted to tell you not to use it to set `CC` either. But then you lose some of the work `AC_PROG_CC` does for you [test that the compiler work, if it is gcc (real or fake)].


I don't see what you mean here. E.g. in `configure.ac` one can probably do something like

```
CCORIG=gcc
AC_SUBST(CC,$CCORIG)
AC_ARG_WITH(cc,AS_HELP_STRING(--with-cc=...,specify the full path to the C compiler ($CC)),CC=$withval)
AC_PROG_CC()
...
AC_ARG_WITH(cxx,...
```
to create `./configure` arguments such as `--with-cc=`, and set `CC`, etc to the right values.



---

archive/issue_comments_311781.json:
```json
{
    "body": "<a id='comment:111'></a>Replying to [comment:110 dimpase]:\n> Replying to [comment:109 fbissey]:\n> > I am not sure what that would achieve. `AC_PROG_CC` makes sure that CC, which is used in standard makefile rules is set to something sensible - by going through a list or checking that the current setting of CC is sane. You may have deja vu because you haven't been on a system with a variety of compilers available out of the box and where you often wants something different from the default.\n\n> \n> \n> I certainly have been there and wanted that, my point is that having `CC=...` as a parameter to a script (rather than an environment variable) is akin to having two girlfriends with the same given name---sometimes convenient, but sometimes making you dazed and confused... ;-)\n> \n\n\nYou choose to see it as a parameter because it is put at the end of the line. But really it is just setting that environment variable while running that command. You could put it in front with the same result, the main point of putting it in a \"parameter\" position is that it is captured in `config.log`. But whether it is passed as, a parameter, a single shot environment variable or exported from the environment, it all give the same result.\n\nThere is no duality, it is always an environment variable. And setting it on that command line, either in front, or in parameter position, is all about not polluting your main environment with the setting in question.\n\nBut my feeling is that this is beside the point of this ticket.",
    "created_at": "2017-07-31T22:20:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311781",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:111'></a>Replying to [comment:110 dimpase]:
> Replying to [comment:109 fbissey]:
> > I am not sure what that would achieve. `AC_PROG_CC` makes sure that CC, which is used in standard makefile rules is set to something sensible - by going through a list or checking that the current setting of CC is sane. You may have deja vu because you haven't been on a system with a variety of compilers available out of the box and where you often wants something different from the default.

> 
> 
> I certainly have been there and wanted that, my point is that having `CC=...` as a parameter to a script (rather than an environment variable) is akin to having two girlfriends with the same given name---sometimes convenient, but sometimes making you dazed and confused... ;-)
> 


You choose to see it as a parameter because it is put at the end of the line. But really it is just setting that environment variable while running that command. You could put it in front with the same result, the main point of putting it in a "parameter" position is that it is captured in `config.log`. But whether it is passed as, a parameter, a single shot environment variable or exported from the environment, it all give the same result.

There is no duality, it is always an environment variable. And setting it on that command line, either in front, or in parameter position, is all about not polluting your main environment with the setting in question.

But my feeling is that this is beside the point of this ticket.



---

archive/issue_comments_311782.json:
```json
{
    "body": "<a id='comment:112'></a>Replying to [comment:111 fbissey]:\n\nIt did indeed escape me that `CC=` is not a script parameter, sorry. No objections then.",
    "created_at": "2017-08-01T07:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311782",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:112'></a>Replying to [comment:111 fbissey]:

It did indeed escape me that `CC=` is not a script parameter, sorry. No objections then.



---

archive/issue_comments_311783.json:
```json
{
    "body": "<a id='comment:113'></a>Replying to [comment:111 fbissey]:\n> You could put it in front with the same result, the main point of putting it in a \"parameter\" position is that it is captured in `config.log`. \n\n\n... and `config.status`, of course, so that the setting persists across `config.status --recheck` etc. \n\n\nFor positive review, I would like to see:\n-  the difference in behavior to standard autotools (comment 92) documented somewhere\n-  a follow-up ticket for making the behavior equal  to standard autotools should be created\n-  the ticket summary should be updated (support \"for all `SAGE_...` variables\" is not implemented in the branch) - follow-up ticket?",
    "created_at": "2017-08-01T13:03:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311783",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:113'></a>Replying to [comment:111 fbissey]:
> You could put it in front with the same result, the main point of putting it in a "parameter" position is that it is captured in `config.log`. 


... and `config.status`, of course, so that the setting persists across `config.status --recheck` etc. 


For positive review, I would like to see:
-  the difference in behavior to standard autotools (comment 92) documented somewhere
-  a follow-up ticket for making the behavior equal  to standard autotools should be created
-  the ticket summary should be updated (support "for all `SAGE_...` variables" is not implemented in the branch) - follow-up ticket?



---

archive/issue_comments_311784.json:
```json
{
    "body": "<a id='comment:114'></a>Replying to [comment:113 mkoeppe]:\n> Replying to [comment:111 fbissey]:\n> > You could put it in front with the same result, the main point of putting it in a \"parameter\" position is that it is captured in `config.log`. \n\n> \n> ... and `config.status`, of course, so that the setting persists across `config.status --recheck` etc. \n> \n> \n> For positive review, I would like to see:\n> -  the difference in behavior to standard autotools (comment 92) documented somewhere\n\n\nYes, certainly some documentation is warranted. Note that since \"sage\" is not an autotool \"product\", I have in fact no problem with `CC=... ./sage` changing the compiler. It is consistent with how I am changing the environment for one off runs on the command line for many applications. Example `OMP_NUM_THREADS=4 ./my_openmp_app`. May be I am wrong to put it in prefix position and putting it postfix would work, but I wasn't taught any better.\n\n>  -  a follow-up ticket for making the behavior equal  to standard autotools should be created\n\n\nI can create a follow up ticket and copy you onto it but I probably won't do any work on it. I will leave that to someone else.\n\n>  -  the ticket summary should be updated (support \"for all `SAGE_...` variables\" is not implemented in the branch) - follow-up ticket?\n\n\nI completely forgot about those I must say. This is more complicated as we will, at the very least, need to generate an exhaustive list of those variables, preferably automatically. Definitely another ticket.",
    "created_at": "2017-08-01T22:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311784",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:114'></a>Replying to [comment:113 mkoeppe]:
> Replying to [comment:111 fbissey]:
> > You could put it in front with the same result, the main point of putting it in a "parameter" position is that it is captured in `config.log`. 

> 
> ... and `config.status`, of course, so that the setting persists across `config.status --recheck` etc. 
> 
> 
> For positive review, I would like to see:
> -  the difference in behavior to standard autotools (comment 92) documented somewhere


Yes, certainly some documentation is warranted. Note that since "sage" is not an autotool "product", I have in fact no problem with `CC=... ./sage` changing the compiler. It is consistent with how I am changing the environment for one off runs on the command line for many applications. Example `OMP_NUM_THREADS=4 ./my_openmp_app`. May be I am wrong to put it in prefix position and putting it postfix would work, but I wasn't taught any better.

>  -  a follow-up ticket for making the behavior equal  to standard autotools should be created


I can create a follow up ticket and copy you onto it but I probably won't do any work on it. I will leave that to someone else.

>  -  the ticket summary should be updated (support "for all `SAGE_...` variables" is not implemented in the branch) - follow-up ticket?


I completely forgot about those I must say. This is more complicated as we will, at the very least, need to generate an exhaustive list of those variables, preferably automatically. Definitely another ticket.



---

archive/issue_comments_311785.json:
```json
{
    "body": "<a id='comment:5'></a>Actually, while I may add a bit of documentation on configuration, the current documentation is quite explicit about how `CC` and others is used\n\n```\n- :envvar:`CC` - while some programs allow you to use this to specify your C\n  compiler, **not every Sage package recognizes this**.\n  If GCC is installed within Sage, :envvar:`CC` is ignored and Sage's ``gcc``\n  is used instead.\n```\nWhen you have to use a variable in postfix position it is not treated as an environment variable. I may add anote that this differs from the behavior you expect from autotools.",
    "created_at": "2017-08-01T22:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311785",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>Actually, while I may add a bit of documentation on configuration, the current documentation is quite explicit about how `CC` and others is used

```
- :envvar:`CC` - while some programs allow you to use this to specify your C
  compiler, **not every Sage package recognizes this**.
  If GCC is installed within Sage, :envvar:`CC` is ignored and Sage's ``gcc``
  is used instead.
```
When you have to use a variable in postfix position it is not treated as an environment variable. I may add anote that this differs from the behavior you expect from autotools.



---

archive/issue_comments_311786.json:
```json
{
    "body": "<a id='comment:6'></a>Requested follow up at #23569 and #23570. I am working on the documentation (`doc/en/installation/source.rst` the document only exists in English so far) suggestions welcome.",
    "created_at": "2017-08-02T00:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311786",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>Requested follow up at #23569 and #23570. I am working on the documentation (`doc/en/installation/source.rst` the document only exists in English so far) suggestions welcome.



---

archive/issue_comments_311787.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-08T21:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311787",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311788.json:
```json
{
    "body": "<a id='comment:9'></a>Progress on the documentation?",
    "created_at": "2017-08-27T02:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311788",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Progress on the documentation?



---

archive/issue_comments_311789.json:
```json
{
    "body": "<a id='comment:0'></a>I have a draft somewhere. I am just on too spread out.",
    "created_at": "2017-08-27T03:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311789",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:0'></a>I have a draft somewhere. I am just on too spread out.



---

archive/issue_comments_311790.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-29T23:34:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311790",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311791.json:
```json
{
    "body": "<a id='comment:2'></a>Ok rebased and added some documentation. I don't think it is particularly great feedback appreciated.",
    "created_at": "2017-08-29T23:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311791",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>Ok rebased and added some documentation. I don't think it is particularly great feedback appreciated.



---

archive/issue_comments_311792.json:
```json
{
    "body": "<a id='comment:3'></a>Attachment [configure-235.tar.gz](tarball://root/attachments/some-uuid/ticket22646/configure-235.tar.gz) by @dimpase created at 2017-08-30 09:17:11",
    "created_at": "2017-08-30T09:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311792",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>Attachment [configure-235.tar.gz](tarball://root/attachments/some-uuid/ticket22646/configure-235.tar.gz) by @dimpase created at 2017-08-30 09:17:11



---

archive/issue_comments_311793.json:
```json
{
    "body": "<a id='comment:4'></a>A few minor suggestions for the documentation: in the first sentence, it is ambiguous about which variables need to be specified just for OS X. Maybe something like this instead:\n\n> Some environment variables deserve a special mention: `CC`, `CXX`, and `FC`; and on OS X, `OBJC` and `OBJCXX`.\n\n\nAlso, change \"over-riden\" to \"over-ridden\" and change \"sage\" to \"Sage\" (twice).\n\nOtherwise, I don't have anything to add to it; I think it's fine.",
    "created_at": "2017-08-30T15:40:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311793",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>A few minor suggestions for the documentation: in the first sentence, it is ambiguous about which variables need to be specified just for OS X. Maybe something like this instead:

> Some environment variables deserve a special mention: `CC`, `CXX`, and `FC`; and on OS X, `OBJC` and `OBJCXX`.


Also, change "over-riden" to "over-ridden" and change "sage" to "Sage" (twice).

Otherwise, I don't have anything to add to it; I think it's fine.



---

archive/issue_comments_311794.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-30T22:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311795.json:
```json
{
    "body": "<a id='comment:6'></a>OK, revision included. It is ready for someone to push the positive review button.",
    "created_at": "2017-08-30T22:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311795",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>OK, revision included. It is ready for someone to push the positive review button.



---

archive/issue_comments_311796.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-30T22:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311796",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_311797.json:
```json
{
    "body": "<a id='comment:8'></a>Great! Now on to #12426?",
    "created_at": "2017-08-30T22:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311797",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>Great! Now on to #12426?



---

archive/issue_comments_311798.json:
```json
{
    "body": "<a id='comment:129'></a>Replying to [comment:128 jhpalmieri]:\n> Great! Now on to #12426?\n\n\nyes, sure. I'll test it for building gfortran on FreeBSD.",
    "created_at": "2017-08-30T22:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311798",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:129'></a>Replying to [comment:128 jhpalmieri]:
> Great! Now on to #12426?


yes, sure. I'll test it for building gfortran on FreeBSD.



---

archive/issue_comments_311799.json:
```json
{
    "body": "<a id='comment:130'></a>Replying to [comment:128 jhpalmieri]:\n> Great! Now on to #12426?\n\n\nThanks everyone! \n\nFor #12426. It would be nice to have it in 8.1 but some people may feel the shift warrants it to go first thing in 8.2.beta0. We could take the debate to sage-devel. Things needed in my opinion for #12426:\n* new release of eclib - that won't solve all the problems but working with clang lead to improvement of the code.\n* update and fix ccache\n* a good discussion about the giac test",
    "created_at": "2017-08-30T22:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311799",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:130'></a>Replying to [comment:128 jhpalmieri]:
> Great! Now on to #12426?


Thanks everyone! 

For #12426. It would be nice to have it in 8.1 but some people may feel the shift warrants it to go first thing in 8.2.beta0. We could take the debate to sage-devel. Things needed in my opinion for #12426:
* new release of eclib - that won't solve all the problems but working with clang lead to improvement of the code.
* update and fix ccache
* a good discussion about the giac test



---

archive/issue_comments_311800.json:
```json
{
    "body": "<a id='comment:131'></a>Replying to [comment:130 fbissey]:\n> Replying to [comment:128 jhpalmieri]:\n> > Great! Now on to #12426?\n\n> \n> Thanks everyone! \n> \n> For #12426. It would be nice to have it in 8.1 but some people may feel the shift warrants it to go first thing in 8.2.beta0. We could take the debate to sage-devel. Things needed in my opinion for #12426:\n> * new release of eclib - that won't solve all the problems but working with clang lead to improvement of the code.\n\n\neclib already took advantage of clang, it helped finding a couple of ugly memory leaks... I think it can be done after this ticket - working without a properly supported toolchain is tricky.\n\n\n> * update and fix ccache\n\n\nWhy is this so urgent, and again, such things are harder to fix \nwithout a properly supported toolchain.\n\n> * a good discussion about the giac test\n\n\nWhat is this about? giac certainly would benefit from more uniform following c++11 or/and gnu++11...\n\n* How about clang on Linux? Are we aiming at it now here? Or, again, this could wait for another ticket? (I'd rather do the latter; it's after all not that urgent).",
    "created_at": "2017-08-30T23:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311800",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:131'></a>Replying to [comment:130 fbissey]:
> Replying to [comment:128 jhpalmieri]:
> > Great! Now on to #12426?

> 
> Thanks everyone! 
> 
> For #12426. It would be nice to have it in 8.1 but some people may feel the shift warrants it to go first thing in 8.2.beta0. We could take the debate to sage-devel. Things needed in my opinion for #12426:
> * new release of eclib - that won't solve all the problems but working with clang lead to improvement of the code.


eclib already took advantage of clang, it helped finding a couple of ugly memory leaks... I think it can be done after this ticket - working without a properly supported toolchain is tricky.


> * update and fix ccache


Why is this so urgent, and again, such things are harder to fix 
without a properly supported toolchain.

> * a good discussion about the giac test


What is this about? giac certainly would benefit from more uniform following c++11 or/and gnu++11...

* How about clang on Linux? Are we aiming at it now here? Or, again, this could wait for another ticket? (I'd rather do the latter; it's after all not that urgent).



---

archive/issue_comments_311801.json:
```json
{
    "body": "<a id='comment:2'></a>`ccache` is not urgent. While it is not a blocker we should aim at supporting a maximum of optional packages out of the box. So fixing the known problems make sense.\n\nMore urgent is doing all that is possible for standard packages that have a testsuite to pass it with clang. This won't happen at this stage for `eclib` and `giac`. `eclib` because it is hard, `giac` because there is currently a test that orders results differently depending on the compiler used :( - we would need a patching option in spkg-check to fix this kind of case and it would need a little extra infrastructure.\n\nclang on linux is just a nice side effect :) and the last ticket for it to work once #12426 is merged is in.\n\nNote that #12426 makes it possible to use `icc` and it works, at say ~95%, out of the box for standard sage. sqlite needs a fix that belongs upstream and pari optimisation needs to be tuned down on top of my head.",
    "created_at": "2017-08-30T23:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311801",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:2'></a>`ccache` is not urgent. While it is not a blocker we should aim at supporting a maximum of optional packages out of the box. So fixing the known problems make sense.

More urgent is doing all that is possible for standard packages that have a testsuite to pass it with clang. This won't happen at this stage for `eclib` and `giac`. `eclib` because it is hard, `giac` because there is currently a test that orders results differently depending on the compiler used :( - we would need a patching option in spkg-check to fix this kind of case and it would need a little extra infrastructure.

clang on linux is just a nice side effect :) and the last ticket for it to work once #12426 is merged is in.

Note that #12426 makes it possible to use `icc` and it works, at say ~95%, out of the box for standard sage. sqlite needs a fix that belongs upstream and pari optimisation needs to be tuned down on top of my head.



---

archive/issue_comments_311802.json:
```json
{
    "body": "<a id='comment:3'></a>IMHO, this all should be dealt with on follow-up tickets, and #12426 ought to get in without them.",
    "created_at": "2017-08-31T00:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311802",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>IMHO, this all should be dealt with on follow-up tickets, and #12426 ought to get in without them.



---

archive/issue_events_059052.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-04T06:10:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22646#event-59052"
}
```



---

archive/issue_comments_311803.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-04T06:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311803",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_311804.json:
```json
{
    "body": "<a id='comment:5'></a>Follow-up: #23789",
    "created_at": "2017-09-06T09:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22646",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22646#issuecomment-311804",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>Follow-up: #23789
