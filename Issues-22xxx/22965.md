# Issue 22965: Refactor axioms

archive/issues_022728.json:
```json
{
    "body": "This ticket brings:\n\n- a catalog of axioms `axioms.XXX` in the global namespace\n\n- axioms as objects rather than plain strings. This had been wished\n  for during the review #10963, and some of the code is reminiscent of\n  Volker's draft at #15501. The main advantage for now is to enable\n  the definition of axioms with custom printing, thus getting rid of the\n  crapy monolithic customization section.\n\n  The bijection axiom <-> \"axiom name\" remains mandatory to support\n  the syntax for implementing axioms in a category.\n\n- improved heuristic for printing categories with axioms. E.g.:\n  {{{\n  Category of finite enumerated fields  ->  Category of finite fields\n  Category of finite enumerated permutation groups  ->  Category of finite permutation groups\n  }}}\n\n  improved printing of `AssociativeXXX`:\n  {{{\n  Category of additive commutative additive magmas ->\n  Category of additive-commutative additive magmas\n  }}}\n  This was discussed and requested on sage-devel for better\n  readability when there are many axioms printed. E.g. in\n  {{{\n  sage: Semirings().super_categories()[0]\n  Category of associative additive-commutative additive-associative additive-unital distributive magmas and additive magmas\n  }}}\n\n  The above are the reasons why the commits touch many files)\n\n- some simplifications in the code (e.g. no more `_repr_object_names_static`)\n\nThe code is essentially backward compatible, at the price of having\n`axioms.Associative == \"Associative\"`, with compatible hash values.\nUsing axioms as strings is deprecated in code. In particular, the\nticket updates the Sage library in a few places to use the preferred\nidiom `P in C.Axiom` rather than `\"Axiom\" in P.category().axioms()`.\n\n\nRemaining questions:\n\n\n- Inside the code, do we want to call the catalog of axioms\n  `all_axioms` or `axioms`? The latter is more ambiguous,\n  but consistent with the name exported in global name space.\n\n- To fetch an existing axiom from a variable containing either the\n  axiom or its name, the current idiom is `all_axioms(name)`; that's\n  somewhat consistent with the `P(xx)` idiom to create elements of a\n  parent. Would we want some other idiom? `all_axioms[name]`?\n\n- Do we want to implement a `cmp` method for axioms?\n  - Comparing by string: this could avoid the repeated use of\n    `sorted(...,key=str)` in our documentation\n  - Comparing by index/definition time? This would be plausibly more\n    meaningful (axioms shown in some natural order). And simplify\n    a very tiny bit the one place where this sorting order is used in\n    the code.\n\n- Do we want to Cythonize axiom.py? Now? Later?\n\n- Do we want to import `all_axioms` from `category_with_axiom` rather than\n  `axiom`? This would avoid a double import in all the files specifying\n  `_base_category_and_axiom`\n\n- Do we want \"additive magmas\" to be renamed to \"additive-magmas\" for consistency?\n\n- Do we want to fix the inconsistency below by adding `additive-` in\n  the first output?\n\n  {{{\n  sage: CommutativeAdditiveGroups()\n  Category of commutative additive groups\n  sage: AdditiveMagmas().AdditiveCommutative()\n  Category of additive-commutative additive magmas\n  }}}\n\n- To recover the string associated to an axiom in the code, is it fine\n  to use `str(axiom)`, or do we want something more explicit and\n  possibly distinct from printing like `axiom.name()`?\n\n- Any better name for `axiom.index()`? It's only used internally,\n  and in a single place; we could also just use `axiom._index`.\n\n\nWork for followup tickets:\n\n- Improve the guessing to avoid having to specify\n  `_base_category_class_and_axiom` in\n  `FiniteDimensionalLieAlgebrasWithBasis` and friends.\n\n- Improve the pretty printing to get:\n  {{{\n  Category of associative additive-commutative additive-associative additive-unital distributive magmas and additive magmas\n  ->\n  Category of distributive semigroups and additive-commutative additive monoids\n  }}}\n\n\nCC:  @tscrim simonking @vbraun jpflori\n\nBranch: [u/nthiery/refactor_axioms](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/refactor_axioms)\n\nCommit: [f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0](https://github.com/sagemath/sagetrac-mirror/commit/f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0)\n\nAuthor: Nicolas M. Thi\u00e9ry\n\nStatus: needs_work\n\nIssue created by migration from https://trac.sagemath.org/ticket/22965\n\n",
    "created_at": "2017-05-10T03:34:05Z",
    "labels": [
        "component: categories"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Refactor axioms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22965",
    "user": "https://github.com/nthiery"
}
```
This ticket brings:

- a catalog of axioms `axioms.XXX` in the global namespace

- axioms as objects rather than plain strings. This had been wished
  for during the review #10963, and some of the code is reminiscent of
  Volker's draft at #15501. The main advantage for now is to enable
  the definition of axioms with custom printing, thus getting rid of the
  crapy monolithic customization section.

  The bijection axiom <-> "axiom name" remains mandatory to support
  the syntax for implementing axioms in a category.

- improved heuristic for printing categories with axioms. E.g.:
  {{{
  Category of finite enumerated fields  ->  Category of finite fields
  Category of finite enumerated permutation groups  ->  Category of finite permutation groups
  }}}

  improved printing of `AssociativeXXX`:
  {{{
  Category of additive commutative additive magmas ->
  Category of additive-commutative additive magmas
  }}}
  This was discussed and requested on sage-devel for better
  readability when there are many axioms printed. E.g. in
  {{{
  sage: Semirings().super_categories()[0]
  Category of associative additive-commutative additive-associative additive-unital distributive magmas and additive magmas
  }}}

  The above are the reasons why the commits touch many files)

- some simplifications in the code (e.g. no more `_repr_object_names_static`)

The code is essentially backward compatible, at the price of having
`axioms.Associative == "Associative"`, with compatible hash values.
Using axioms as strings is deprecated in code. In particular, the
ticket updates the Sage library in a few places to use the preferred
idiom `P in C.Axiom` rather than `"Axiom" in P.category().axioms()`.


Remaining questions:


- Inside the code, do we want to call the catalog of axioms
  `all_axioms` or `axioms`? The latter is more ambiguous,
  but consistent with the name exported in global name space.

- To fetch an existing axiom from a variable containing either the
  axiom or its name, the current idiom is `all_axioms(name)`; that's
  somewhat consistent with the `P(xx)` idiom to create elements of a
  parent. Would we want some other idiom? `all_axioms[name]`?

- Do we want to implement a `cmp` method for axioms?
  - Comparing by string: this could avoid the repeated use of
    `sorted(...,key=str)` in our documentation
  - Comparing by index/definition time? This would be plausibly more
    meaningful (axioms shown in some natural order). And simplify
    a very tiny bit the one place where this sorting order is used in
    the code.

- Do we want to Cythonize axiom.py? Now? Later?

- Do we want to import `all_axioms` from `category_with_axiom` rather than
  `axiom`? This would avoid a double import in all the files specifying
  `_base_category_and_axiom`

- Do we want "additive magmas" to be renamed to "additive-magmas" for consistency?

- Do we want to fix the inconsistency below by adding `additive-` in
  the first output?

  {{{
  sage: CommutativeAdditiveGroups()
  Category of commutative additive groups
  sage: AdditiveMagmas().AdditiveCommutative()
  Category of additive-commutative additive magmas
  }}}

- To recover the string associated to an axiom in the code, is it fine
  to use `str(axiom)`, or do we want something more explicit and
  possibly distinct from printing like `axiom.name()`?

- Any better name for `axiom.index()`? It's only used internally,
  and in a single place; we could also just use `axiom._index`.


Work for followup tickets:

- Improve the guessing to avoid having to specify
  `_base_category_class_and_axiom` in
  `FiniteDimensionalLieAlgebrasWithBasis` and friends.

- Improve the pretty printing to get:
  {{{
  Category of associative additive-commutative additive-associative additive-unital distributive magmas and additive magmas
  ->
  Category of distributive semigroups and additive-commutative additive monoids
  }}}


CC:  @tscrim simonking @vbraun jpflori

Branch: [u/nthiery/refactor_axioms](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/refactor_axioms)

Commit: [f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0](https://github.com/sagemath/sagetrac-mirror/commit/f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0)

Author: Nicolas M. Thi√©ry

Status: needs_work

Issue created by migration from https://trac.sagemath.org/ticket/22965





---

archive/issue_comments_432205.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,10 +12,12 @@\n \n - axioms as objects rather than plain strings. This had been wished\n   for during the review #12973, and some of the code is reminiscent of\n-  Volker's draft at #15501.\n+  Volker's draft at #15501. The main advantage for now is to enable\n+  the definition of axioms with custom printing, thus getting rid of the\n+  crapy monolithic customization section.\n \n The code is essentially backward compatible, at the price of having\n-Associative == \"Associative\", with compatible has values.\n+``axioms.Associative == \"Associative\"``, with compatible hash values.\n \n The bijection axiom <-> \"axiom name\" remains mandatory to support the\n syntax for implementing axioms in a category.\n``````\n",
    "created_at": "2017-05-10T03:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432205",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,10 +12,12 @@
 
 - axioms as objects rather than plain strings. This had been wished
   for during the review #12973, and some of the code is reminiscent of
-  Volker's draft at #15501.
+  Volker's draft at #15501. The main advantage for now is to enable
+  the definition of axioms with custom printing, thus getting rid of the
+  crapy monolithic customization section.
 
 The code is essentially backward compatible, at the price of having
-Associative == "Associative", with compatible has values.
+``axioms.Associative == "Associative"``, with compatible hash values.
 
 The bijection axiom <-> "axiom name" remains mandatory to support the
 syntax for implementing axioms in a category.
``````




---

archive/issue_comments_432206.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,7 +17,7 @@\n   crapy monolithic customization section.\n \n The code is essentially backward compatible, at the price of having\n-``axioms.Associative == \"Associative\"``, with compatible hash values.\n+`axioms.Associative == \"Associative\"`, with compatible hash values.\n \n The bijection axiom <-> \"axiom name\" remains mandatory to support the\n syntax for implementing axioms in a category.\n``````\n",
    "created_at": "2017-05-10T13:43:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432206",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,7 +17,7 @@
   crapy monolithic customization section.
 
 The code is essentially backward compatible, at the price of having
-``axioms.Associative == "Associative"``, with compatible hash values.
+`axioms.Associative == "Associative"`, with compatible hash values.
 
 The bijection axiom <-> "axiom name" remains mandatory to support the
 syntax for implementing axioms in a category.
``````




---

archive/issue_comments_432207.json:
```json
{
    "body": "Branch: [u/nthiery/refactor_axioms](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/refactor_axioms)",
    "created_at": "2017-05-10T20:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432207",
    "user": "https://github.com/nthiery"
}
```

Branch: [u/nthiery/refactor_axioms](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/refactor_axioms)



---

archive/issue_comments_432208.json:
```json
{
    "body": "<a id='comment:4'></a>\nI know it's not ready for review, but something I've been bit by in the past is only defining an `__eq__`. Make sure you define a `__ne__` as `return not (self == other)`.\n\n---\nNew commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[4b21055](https://github.com/sagemath/sagetrac-mirror/commit/4b21055f4282d23aee0bf929c5d0374a748af32c)|`22965: refactorisation of axioms (code part)`|",
    "created_at": "2017-05-10T21:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432208",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
I know it's not ready for review, but something I've been bit by in the past is only defining an `__eq__`. Make sure you define a `__ne__` as `return not (self == other)`.

---
New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[4b21055](https://github.com/sagemath/sagetrac-mirror/commit/4b21055f4282d23aee0bf929c5d0374a748af32c)|`22965: refactorisation of axioms (code part)`|



---

archive/issue_comments_432209.json:
```json
{
    "body": "Commit: [4b21055f4282d23aee0bf929c5d0374a748af32c](https://github.com/sagemath/sagetrac-mirror/commit/4b21055f4282d23aee0bf929c5d0374a748af32c)",
    "created_at": "2017-05-10T21:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432209",
    "user": "https://github.com/tscrim"
}
```

Commit: [4b21055f4282d23aee0bf929c5d0374a748af32c](https://github.com/sagemath/sagetrac-mirror/commit/4b21055f4282d23aee0bf929c5d0374a748af32c)



---

archive/issue_comments_432210.json:
```json
{
    "body": "Changing commit from \"[4b21055f4282d23aee0bf929c5d0374a748af32c](https://github.com/sagemath/sagetrac-mirror/commit/4b21055f4282d23aee0bf929c5d0374a748af32c)\" to \"[47d3b7ca29a764845c4732569ed86bff1626d1e4](https://github.com/sagemath/sagetrac-mirror/commit/47d3b7ca29a764845c4732569ed86bff1626d1e4)\"",
    "created_at": "2017-05-10T22:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432210",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[4b21055f4282d23aee0bf929c5d0374a748af32c](https://github.com/sagemath/sagetrac-mirror/commit/4b21055f4282d23aee0bf929c5d0374a748af32c)" to "[47d3b7ca29a764845c4732569ed86bff1626d1e4](https://github.com/sagemath/sagetrac-mirror/commit/47d3b7ca29a764845c4732569ed86bff1626d1e4)"



---

archive/issue_comments_432211.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|\n|[af59aff](https://github.com/sagemath/sagetrac-mirror/commit/af59afff7b450b6644659afbcca0055dc021998b)|`22965: Trivial doctest updates ('XXX' -> XXX, nicer category names)`|\n|[47d3b7c](https://github.com/sagemath/sagetrac-mirror/commit/47d3b7ca29a764845c4732569ed86bff1626d1e4)|`22965: updates in the categories to use axioms rather than strings`|",
    "created_at": "2017-05-10T22:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432211",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
|[af59aff](https://github.com/sagemath/sagetrac-mirror/commit/af59afff7b450b6644659afbcca0055dc021998b)|`22965: Trivial doctest updates ('XXX' -> XXX, nicer category names)`|
|[47d3b7c](https://github.com/sagemath/sagetrac-mirror/commit/47d3b7ca29a764845c4732569ed86bff1626d1e4)|`22965: updates in the categories to use axioms rather than strings`|



---

archive/issue_comments_432212.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|\n|[c4e0fb5](https://github.com/sagemath/sagetrac-mirror/commit/c4e0fb555fb64ef6d121a2a368dfed117844ff6d)|`22965: idiom update: use P in C.Axiom rather than \"Axiom\" in P.category().axioms()`|",
    "created_at": "2017-05-10T22:06:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432212",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
|[c4e0fb5](https://github.com/sagemath/sagetrac-mirror/commit/c4e0fb555fb64ef6d121a2a368dfed117844ff6d)|`22965: idiom update: use P in C.Axiom rather than "Axiom" in P.category().axioms()`|



---

archive/issue_comments_432213.json:
```json
{
    "body": "Changing commit from \"[47d3b7ca29a764845c4732569ed86bff1626d1e4](https://github.com/sagemath/sagetrac-mirror/commit/47d3b7ca29a764845c4732569ed86bff1626d1e4)\" to \"[c4e0fb555fb64ef6d121a2a368dfed117844ff6d](https://github.com/sagemath/sagetrac-mirror/commit/c4e0fb555fb64ef6d121a2a368dfed117844ff6d)\"",
    "created_at": "2017-05-10T22:06:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432213",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[47d3b7ca29a764845c4732569ed86bff1626d1e4](https://github.com/sagemath/sagetrac-mirror/commit/47d3b7ca29a764845c4732569ed86bff1626d1e4)" to "[c4e0fb555fb64ef6d121a2a368dfed117844ff6d](https://github.com/sagemath/sagetrac-mirror/commit/c4e0fb555fb64ef6d121a2a368dfed117844ff6d)"



---

archive/issue_comments_432214.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[efedd94](https://github.com/sagemath/sagetrac-mirror/commit/efedd94779391402f3138b23a6dbf15888514867)|`22965: documentation updates`|",
    "created_at": "2017-05-10T22:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[efedd94](https://github.com/sagemath/sagetrac-mirror/commit/efedd94779391402f3138b23a6dbf15888514867)|`22965: documentation updates`|



---

archive/issue_comments_432215.json:
```json
{
    "body": "Changing commit from \"[c4e0fb555fb64ef6d121a2a368dfed117844ff6d](https://github.com/sagemath/sagetrac-mirror/commit/c4e0fb555fb64ef6d121a2a368dfed117844ff6d)\" to \"[efedd94779391402f3138b23a6dbf15888514867](https://github.com/sagemath/sagetrac-mirror/commit/efedd94779391402f3138b23a6dbf15888514867)\"",
    "created_at": "2017-05-10T22:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432215",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[c4e0fb555fb64ef6d121a2a368dfed117844ff6d](https://github.com/sagemath/sagetrac-mirror/commit/c4e0fb555fb64ef6d121a2a368dfed117844ff6d)" to "[efedd94779391402f3138b23a6dbf15888514867](https://github.com/sagemath/sagetrac-mirror/commit/efedd94779391402f3138b23a6dbf15888514867)"



---

archive/issue_comments_432216.json:
```json
{
    "body": "Changing commit from \"[efedd94779391402f3138b23a6dbf15888514867](https://github.com/sagemath/sagetrac-mirror/commit/efedd94779391402f3138b23a6dbf15888514867)\" to \"[0f2464d0104ad87319519c94daf3dcc5ab93dae9](https://github.com/sagemath/sagetrac-mirror/commit/0f2464d0104ad87319519c94daf3dcc5ab93dae9)\"",
    "created_at": "2017-05-10T22:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432216",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[efedd94779391402f3138b23a6dbf15888514867](https://github.com/sagemath/sagetrac-mirror/commit/efedd94779391402f3138b23a6dbf15888514867)" to "[0f2464d0104ad87319519c94daf3dcc5ab93dae9](https://github.com/sagemath/sagetrac-mirror/commit/0f2464d0104ad87319519c94daf3dcc5ab93dae9)"



---

archive/issue_comments_432217.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|\n|[0f2464d](https://github.com/sagemath/sagetrac-mirror/commit/0f2464d0104ad87319519c94daf3dcc5ab93dae9)|`22965: refactorisation of axioms (code part: hunks missing from previous commit)`|",
    "created_at": "2017-05-10T22:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432217",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
|[0f2464d](https://github.com/sagemath/sagetrac-mirror/commit/0f2464d0104ad87319519c94daf3dcc5ab93dae9)|`22965: refactorisation of axioms (code part: hunks missing from previous commit)`|



---

archive/issue_comments_432218.json:
```json
{
    "body": "Changing commit from \"[0f2464d0104ad87319519c94daf3dcc5ab93dae9](https://github.com/sagemath/sagetrac-mirror/commit/0f2464d0104ad87319519c94daf3dcc5ab93dae9)\" to \"[75ea783992558b4b422ca4cf71f06f376c821ca5](https://github.com/sagemath/sagetrac-mirror/commit/75ea783992558b4b422ca4cf71f06f376c821ca5)\"",
    "created_at": "2017-05-10T22:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432218",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[0f2464d0104ad87319519c94daf3dcc5ab93dae9](https://github.com/sagemath/sagetrac-mirror/commit/0f2464d0104ad87319519c94daf3dcc5ab93dae9)" to "[75ea783992558b4b422ca4cf71f06f376c821ca5](https://github.com/sagemath/sagetrac-mirror/commit/75ea783992558b4b422ca4cf71f06f376c821ca5)"



---

archive/issue_comments_432219.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|\n|[75ea783](https://github.com/sagemath/sagetrac-mirror/commit/75ea783992558b4b422ca4cf71f06f376c821ca5)|`22965: Trivial doctest updates ('XXX' -> XXX, nicer category names)`|",
    "created_at": "2017-05-10T22:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432219",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
|[75ea783](https://github.com/sagemath/sagetrac-mirror/commit/75ea783992558b4b422ca4cf71f06f376c821ca5)|`22965: Trivial doctest updates ('XXX' -> XXX, nicer category names)`|



---

archive/issue_comments_432220.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,14 +1,6 @@\n This ticket brings:\n \n-- a catalog of axioms `axioms.XXX`\n-\n-- improved heuristic for displaying categories with axioms. E.g.:\n-   {{{\n-   Category of finite enumerated fields  ->  Category of finite fields\n-   Category of finite enumerated permutation groups  ->  Category of finite permutation groups\n-   }}}\n-\n-   (this is the reason why the commit touches many files)\n+- a catalog of axioms `axioms.XXX` in the global namespace\n \n - axioms as objects rather than plain strings. This had been wished\n   for during the review #12973, and some of the code is reminiscent of\n@@ -16,9 +8,95 @@\n   the definition of axioms with custom printing, thus getting rid of the\n   crapy monolithic customization section.\n \n+  The bijection axiom <-> \"axiom name\" remains mandatory to support\n+  the syntax for implementing axioms in a category.\n+\n+- improved heuristic for printing categories with axioms. E.g.:\n+  {{{\n+  Category of finite enumerated fields  ->  Category of finite fields\n+  Category of finite enumerated permutation groups  ->  Category of finite permutation groups\n+  }}}\n+\n+  improved printing of `AssociativeXXX`:\n+  {{{\n+  Category of additive commutative additive magmas ->\n+  Category of additive-commutative additive magmas\n+  }}}\n+  This was discussed and requested on sage-devel for better\n+  readability when there are many axioms printed. E.g. in\n+  {{{\n+  sage: Semirings().super_categories()[0]\n+  Category of associative additive-commutative additive-associative additive-unital distributive magmas and additive magmas\n+  }}}\n+\n+  The above are the reasons why the commits touch many files)\n+\n+- some simplifications in the code (e.g. no more `_repr_object_names_static`)\n+\n The code is essentially backward compatible, at the price of having\n `axioms.Associative == \"Associative\"`, with compatible hash values.\n+Using axioms as strings is deprecated in code. In particular, the\n+ticket updates the Sage library in a few places to use the preferred\n+idiom `P in C.Axiom` rather than `\"Axiom\" in P.category().axioms()`.\n \n-The bijection axiom <-> \"axiom name\" remains mandatory to support the\n-syntax for implementing axioms in a category.\n \n+Remaining questions:\n+\n+\n+- Inside the code, do we want to call the catalog of axioms\n+  `all_axioms` or `axioms`? The latter is more ambiguous,\n+  but consistent with the name exported in global name space.\n+\n+- To fetch an existing axiom from a variable containing either the\n+  axiom or its name, the current idiom is `all_axioms(name)`; that's\n+  somewhat consistent with the `P(xx)` idiom to create elements of a\n+  parent. Would we want some other idiom? `all_axioms[name]`?\n+\n+- Do we want to implement a `cmp` method for axioms?\n+  - Comparing by string: this could avoid the repeated use of\n+    sorted(...,key=str) in our documentation\n+\n+  - Comparing by index/definition time? This would be plausibly more\n+    meaningful (axioms shown in some natural order). And simplify\n+    a very tiny bit the one place where this sorting order is used in\n+    the code.\n+\n+- Do we want to Cythonize axiom.py? Now? Later?\n+\n+- Do we want to import `all_axioms` from `category_with_axiom` rather than\n+  `axiom`? This would avoid a double import in all the files specifying\n+  `_base_category_and_axiom`\n+\n+- Do we want \"additive magmas\" to be renamed to \"additive-magmas\" for consistency?\n+\n+- Do we want to fix the inconsistency below by adding `additive-` in\n+  the first output?\n+\n+  {{{\n+  sage: CommutativeAdditiveGroups()\n+  Category of commutative additive groups\n+  sage: AdditiveMagmas().AdditiveCommutative()\n+  Category of additive-commutative additive magmas\n+  }}}\n+\n+- To recover the string associated to an axiom in the code, is it fine\n+  to use `str(axiom)`, or do we want something more explicit and\n+  possibly distinct from printing like `axiom.name()`?\n+\n+- Any better name for `axiom.index()`? It's only used internally,\n+  and in a single place; we could also just use `axiom._index`.\n+\n+\n+Work for followup tickets:\n+\n+- Improve the guessing to avoid having to specify\n+  `_base_category_class_and_axiom` in\n+  `FiniteDimensionalLieAlgebrasWithBasis` and friends.\n+\n+- Improve the pretty printing to get:\n+  {{{\n+  Category of associative additive-commutative additive-associative additive-unital distributive magmas and additive magmas\n+  ->\n+  Category of distributive semigroups and additive-commutative additive monoids\n+  }}}\n+\n``````\n",
    "created_at": "2017-05-10T22:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432220",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,14 +1,6 @@
 This ticket brings:
 
-- a catalog of axioms `axioms.XXX`
-
-- improved heuristic for displaying categories with axioms. E.g.:
-   {{{
-   Category of finite enumerated fields  ->  Category of finite fields
-   Category of finite enumerated permutation groups  ->  Category of finite permutation groups
-   }}}
-
-   (this is the reason why the commit touches many files)
+- a catalog of axioms `axioms.XXX` in the global namespace
 
 - axioms as objects rather than plain strings. This had been wished
   for during the review #12973, and some of the code is reminiscent of
@@ -16,9 +8,95 @@
   the definition of axioms with custom printing, thus getting rid of the
   crapy monolithic customization section.
 
+  The bijection axiom <-> "axiom name" remains mandatory to support
+  the syntax for implementing axioms in a category.
+
+- improved heuristic for printing categories with axioms. E.g.:
+  {{{
+  Category of finite enumerated fields  ->  Category of finite fields
+  Category of finite enumerated permutation groups  ->  Category of finite permutation groups
+  }}}
+
+  improved printing of `AssociativeXXX`:
+  {{{
+  Category of additive commutative additive magmas ->
+  Category of additive-commutative additive magmas
+  }}}
+  This was discussed and requested on sage-devel for better
+  readability when there are many axioms printed. E.g. in
+  {{{
+  sage: Semirings().super_categories()[0]
+  Category of associative additive-commutative additive-associative additive-unital distributive magmas and additive magmas
+  }}}
+
+  The above are the reasons why the commits touch many files)
+
+- some simplifications in the code (e.g. no more `_repr_object_names_static`)
+
 The code is essentially backward compatible, at the price of having
 `axioms.Associative == "Associative"`, with compatible hash values.
+Using axioms as strings is deprecated in code. In particular, the
+ticket updates the Sage library in a few places to use the preferred
+idiom `P in C.Axiom` rather than `"Axiom" in P.category().axioms()`.
 
-The bijection axiom <-> "axiom name" remains mandatory to support the
-syntax for implementing axioms in a category.
 
+Remaining questions:
+
+
+- Inside the code, do we want to call the catalog of axioms
+  `all_axioms` or `axioms`? The latter is more ambiguous,
+  but consistent with the name exported in global name space.
+
+- To fetch an existing axiom from a variable containing either the
+  axiom or its name, the current idiom is `all_axioms(name)`; that's
+  somewhat consistent with the `P(xx)` idiom to create elements of a
+  parent. Would we want some other idiom? `all_axioms[name]`?
+
+- Do we want to implement a `cmp` method for axioms?
+  - Comparing by string: this could avoid the repeated use of
+    sorted(...,key=str) in our documentation
+
+  - Comparing by index/definition time? This would be plausibly more
+    meaningful (axioms shown in some natural order). And simplify
+    a very tiny bit the one place where this sorting order is used in
+    the code.
+
+- Do we want to Cythonize axiom.py? Now? Later?
+
+- Do we want to import `all_axioms` from `category_with_axiom` rather than
+  `axiom`? This would avoid a double import in all the files specifying
+  `_base_category_and_axiom`
+
+- Do we want "additive magmas" to be renamed to "additive-magmas" for consistency?
+
+- Do we want to fix the inconsistency below by adding `additive-` in
+  the first output?
+
+  {{{
+  sage: CommutativeAdditiveGroups()
+  Category of commutative additive groups
+  sage: AdditiveMagmas().AdditiveCommutative()
+  Category of additive-commutative additive magmas
+  }}}
+
+- To recover the string associated to an axiom in the code, is it fine
+  to use `str(axiom)`, or do we want something more explicit and
+  possibly distinct from printing like `axiom.name()`?
+
+- Any better name for `axiom.index()`? It's only used internally,
+  and in a single place; we could also just use `axiom._index`.
+
+
+Work for followup tickets:
+
+- Improve the guessing to avoid having to specify
+  `_base_category_class_and_axiom` in
+  `FiniteDimensionalLieAlgebrasWithBasis` and friends.
+
+- Improve the pretty printing to get:
+  {{{
+  Category of associative additive-commutative additive-associative additive-unital distributive magmas and additive magmas
+  ->
+  Category of distributive semigroups and additive-commutative additive monoids
+  }}}
+
``````




---

archive/issue_comments_432221.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-10T22:45:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432221",
    "user": "https://github.com/nthiery"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_432222.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -54,7 +54,7 @@\n \n - Do we want to implement a `cmp` method for axioms?\n   - Comparing by string: this could avoid the repeated use of\n-    sorted(...,key=str) in our documentation\n+    `sorted(...,key=str)` in our documentation\n \n   - Comparing by index/definition time? This would be plausibly more\n     meaningful (axioms shown in some natural order). And simplify\n``````\n",
    "created_at": "2017-05-10T22:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432222",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -54,7 +54,7 @@
 
 - Do we want to implement a `cmp` method for axioms?
   - Comparing by string: this could avoid the repeated use of
-    sorted(...,key=str) in our documentation
+    `sorted(...,key=str)` in our documentation
 
   - Comparing by index/definition time? This would be plausibly more
     meaningful (axioms shown in some natural order). And simplify
``````




---

archive/issue_comments_432223.json:
```json
{
    "body": "<a id='comment:12'></a>\nIf you're going to override \"__eq__\" and \"__hash__\" you should probably define the thing to be `CachedRepresentation`. Is there a good reason to be `CachedRepresentation`?\n\n(`CachedRepresentation` has a very nontrivial cost. You should only use it if you need its features)",
    "created_at": "2017-05-10T22:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432223",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:12'></a>
If you're going to override "__eq__" and "__hash__" you should probably define the thing to be `CachedRepresentation`. Is there a good reason to be `CachedRepresentation`?

(`CachedRepresentation` has a very nontrivial cost. You should only use it if you need its features)



---

archive/issue_comments_432224.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,7 +3,7 @@\n - a catalog of axioms `axioms.XXX` in the global namespace\n \n - axioms as objects rather than plain strings. This had been wished\n-  for during the review #12973, and some of the code is reminiscent of\n+  for during the review #10963, and some of the code is reminiscent of\n   Volker's draft at #15501. The main advantage for now is to enable\n   the definition of axioms with custom printing, thus getting rid of the\n   crapy monolithic customization section.\n``````\n",
    "created_at": "2017-05-10T22:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432224",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,7 +3,7 @@
 - a catalog of axioms `axioms.XXX` in the global namespace
 
 - axioms as objects rather than plain strings. This had been wished
-  for during the review #12973, and some of the code is reminiscent of
+  for during the review #10963, and some of the code is reminiscent of
   Volker's draft at #15501. The main advantage for now is to enable
   the definition of axioms with custom printing, thus getting rid of the
   crapy monolithic customization section.
``````




---

archive/issue_comments_432225.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [nbruin](#comment%3A12):\n> If you're going to override \"__eq__\" and \"__hash__\" you should probably define the thing to be `CachedRepresentation`. Is there a good reason to be `CachedRepresentation`?\n> \n> (`CachedRepresentation` has a very nontrivial cost. You should only use it if you need its features)\n\n\nThat's a good question. The `__eq__` and `__hash__` are really here just for backward compatibility (supporting the idiom `\"Foo\" in C.axioms()`). I used `UniqueRepresentation` because that's really what I mean :-) But you are right, it could be more proper to use `CachedRepresentation`.\n\nIn terms of speed, I believe the only important thing is fast equality and hash (which calls for Cythonizing them). Axioms will rarely be recreated.\n\nCheers,\n                                    Nicolas",
    "created_at": "2017-05-10T22:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432225",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:14'></a>
Replying to [nbruin](#comment%3A12):
> If you're going to override "__eq__" and "__hash__" you should probably define the thing to be `CachedRepresentation`. Is there a good reason to be `CachedRepresentation`?
> 
> (`CachedRepresentation` has a very nontrivial cost. You should only use it if you need its features)


That's a good question. The `__eq__` and `__hash__` are really here just for backward compatibility (supporting the idiom `"Foo" in C.axioms()`). I used `UniqueRepresentation` because that's really what I mean :-) But you are right, it could be more proper to use `CachedRepresentation`.

In terms of speed, I believe the only important thing is fast equality and hash (which calls for Cythonizing them). Axioms will rarely be recreated.

Cheers,
                                    Nicolas



---

archive/issue_comments_432226.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [tscrim](#comment%3A4):\n> I know it's not ready for review, but something I've been bit by in the past is only defining an `__eq__`. Make sure you define a `__ne__` as `return not (self == other)`.\n\n\nYeah, I pondered about this. Accepting `\"Associative\" == axioms.Associative` is really just here as a workaround for backward compatibility; namely to support idiom `\"Associative\" in C.axioms()` that people apparently have been using. I wondered whether I really wanted to enable more than just the strict minimum.",
    "created_at": "2017-05-10T23:06:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432226",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:16'></a>
Replying to [tscrim](#comment%3A4):
> I know it's not ready for review, but something I've been bit by in the past is only defining an `__eq__`. Make sure you define a `__ne__` as `return not (self == other)`.


Yeah, I pondered about this. Accepting `"Associative" == axioms.Associative` is really just here as a workaround for backward compatibility; namely to support idiom `"Associative" in C.axioms()` that people apparently have been using. I wondered whether I really wanted to enable more than just the strict minimum.



---

archive/issue_comments_432227.json:
```json
{
    "body": "<a id='comment:17'></a>\nIf you want to keep the `__eq__`, then you really need to define a `__ne__` to keep things consistent in case someone wants to test inequality. A slightly contrived example, but say someone has a constructor that accepts an axiom as an arg and they want to do something special when the axiom is not `axioms.Commutative`.\n\nAlso, `__init__`, `__repr__`, and `index` of `Axiom` do not have doctests.",
    "created_at": "2017-05-10T23:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432227",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
If you want to keep the `__eq__`, then you really need to define a `__ne__` to keep things consistent in case someone wants to test inequality. A slightly contrived example, but say someone has a constructor that accepts an axiom as an arg and they want to do something special when the axiom is not `axioms.Commutative`.

Also, `__init__`, `__repr__`, and `index` of `Axiom` do not have doctests.



---

archive/issue_comments_432228.json:
```json
{
    "body": "<a id='comment:18'></a>\nI'm not really commenting on whether you should define an `__eq__` or not.",
    "created_at": "2017-05-10T23:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432228",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>
I'm not really commenting on whether you should define an `__eq__` or not.



---

archive/issue_comments_432229.json:
```json
{
    "body": "<a id='comment:19'></a>\nAlso, why does `Axiom` inherit from `SageObject`? What features are you using?",
    "created_at": "2017-05-10T23:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432229",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>
Also, why does `Axiom` inherit from `SageObject`? What features are you using?



---

archive/issue_comments_432230.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[126bb50](https://github.com/sagemath/sagetrac-mirror/commit/126bb507aeef646d4535622aa3b0ea998042d29c)|`22965: fixed missing doctests`|",
    "created_at": "2017-05-10T23:17:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432230",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[126bb50](https://github.com/sagemath/sagetrac-mirror/commit/126bb507aeef646d4535622aa3b0ea998042d29c)|`22965: fixed missing doctests`|



---

archive/issue_comments_432231.json:
```json
{
    "body": "Changing commit from \"[75ea783992558b4b422ca4cf71f06f376c821ca5](https://github.com/sagemath/sagetrac-mirror/commit/75ea783992558b4b422ca4cf71f06f376c821ca5)\" to \"[126bb507aeef646d4535622aa3b0ea998042d29c](https://github.com/sagemath/sagetrac-mirror/commit/126bb507aeef646d4535622aa3b0ea998042d29c)\"",
    "created_at": "2017-05-10T23:17:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432231",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[75ea783992558b4b422ca4cf71f06f376c821ca5](https://github.com/sagemath/sagetrac-mirror/commit/75ea783992558b4b422ca4cf71f06f376c821ca5)" to "[126bb507aeef646d4535622aa3b0ea998042d29c](https://github.com/sagemath/sagetrac-mirror/commit/126bb507aeef646d4535622aa3b0ea998042d29c)"



---

archive/issue_comments_432232.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [tscrim](#comment%3A19):\n> Also, why does `Axiom` inherit from `SageObject`? What features are you using?\n\n\nI believe none at this stage. I just put that by default, mostly for consistency with Category.",
    "created_at": "2017-05-11T02:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432232",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:21'></a>
Replying to [tscrim](#comment%3A19):
> Also, why does `Axiom` inherit from `SageObject`? What features are you using?


I believe none at this stage. I just put that by default, mostly for consistency with Category.



---

archive/issue_comments_432233.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[f4ce06a](https://github.com/sagemath/sagetrac-mirror/commit/f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0)|`22965: added Axiom.__ne__ as negation of Axiom.__eq__`|",
    "created_at": "2017-05-11T02:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432233",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[f4ce06a](https://github.com/sagemath/sagetrac-mirror/commit/f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0)|`22965: added Axiom.__ne__ as negation of Axiom.__eq__`|



---

archive/issue_comments_432234.json:
```json
{
    "body": "Changing commit from \"[126bb507aeef646d4535622aa3b0ea998042d29c](https://github.com/sagemath/sagetrac-mirror/commit/126bb507aeef646d4535622aa3b0ea998042d29c)\" to \"[f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0](https://github.com/sagemath/sagetrac-mirror/commit/f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0)\"",
    "created_at": "2017-05-11T02:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432234",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[126bb507aeef646d4535622aa3b0ea998042d29c](https://github.com/sagemath/sagetrac-mirror/commit/126bb507aeef646d4535622aa3b0ea998042d29c)" to "[f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0](https://github.com/sagemath/sagetrac-mirror/commit/f4ce06aa2d0449e1ac4d33b1031f19b07a15dfb0)"



---

archive/issue_comments_432235.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -55,7 +55,6 @@\n - Do we want to implement a `cmp` method for axioms?\n   - Comparing by string: this could avoid the repeated use of\n     `sorted(...,key=str)` in our documentation\n-\n   - Comparing by index/definition time? This would be plausibly more\n     meaningful (axioms shown in some natural order). And simplify\n     a very tiny bit the one place where this sorting order is used in\n``````\n",
    "created_at": "2017-05-16T14:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432235",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -55,7 +55,6 @@
 - Do we want to implement a `cmp` method for axioms?
   - Comparing by string: this could avoid the repeated use of
     `sorted(...,key=str)` in our documentation
-
   - Comparing by index/definition time? This would be plausibly more
     meaningful (axioms shown in some natural order). And simplify
     a very tiny bit the one place where this sorting order is used in
``````




---

archive/issue_comments_432236.json:
```json
{
    "body": "<a id='comment:24'></a>\nHi; any comment on the questions raised in the description?",
    "created_at": "2017-05-16T14:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432236",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:24'></a>
Hi; any comment on the questions raised in the description?



---

archive/issue_comments_432237.json:
```json
{
    "body": "<a id='comment:25'></a>\n> - Inside the code, do we want to call the catalog of axioms\n>   `all_axioms` or `axioms`? The latter is more ambiguous,\n>   but consistent with the name exported in global name space.\n\n\nI say `axioms` both for consistency and naturality.\n\n> - To fetch an existing axiom from a variable containing either the\n>   axiom or its name, the current idiom is `all_axioms(name)`; that's\n>   somewhat consistent with the `P(xx)` idiom to create elements of a\n>   parent. Would we want some other idiom? `all_axioms[name]`?\n\n\nI would go for the latter since it is a container object and `all_axioms[name]` is how Python handles other container objects, e.g., `dict`.\n\n> - Do we want to implement a `cmp` method for axioms?\n\n\nNo, but rich comparisons are good.\n\n>   - Comparing by string: this could avoid the repeated use of\n>     `sorted(...,key=str)` in our documentation\n>   - Comparing by index/definition time? This would be plausibly more\n>     meaningful (axioms shown in some natural order). And simplify\n>     a very tiny bit the one place where this sorting order is used in\n>     the code.\n\n\nDefinitely Index/definition time as this will allow us to control the printing in a more straightforward way.\n\n> - Do we want to Cythonize axiom.py? Now? Later?\n\n\nI am inclined to say Cythonize it to keep the categories as fast as possible. I feel like even if highly optimized, this switch will slow down category creation because the string operations are lightweight and optimized at the machine level. However, I haven't done any timings.\n\nAlso, it would be good if you could get rid of the `SageObject` inheritance from `Axiom` so we could `cdef` it, and I don't see axioms fundamentally behaving like other instances of `SageObject`.\n\n> - Do we want to import `all_axioms` from `category_with_axiom` rather than\n>   `axiom`? This would avoid a double import in all the files specifying\n>   `_base_category_and_axiom`\n\n\n> - Do we want \"additive magmas\" to be renamed to \"additive-magmas\" for consistency?\n\n\nI don't think the hyphen there is completely grammatically correct, at least it is strange to me. So I'm -1.\n\n> - Do we want to fix the inconsistency below by adding `additive-` in\n>   the first output?\n> \n>   {{{\n>   sage: CommutativeAdditiveGroups()\n>   Category of commutative additive groups\n>   sage: AdditiveMagmas().AdditiveCommutative()\n>   Category of additive-commutative additive magmas\n>   }}}\n\n\nI would like the latter to be\n\n```\nCategory of commutative additive magmas\n```\nas this is more concise and easier to parse.\n\n> - To recover the string associated to an axiom in the code, is it fine\n>   to use `str(axiom)`, or do we want something more explicit and\n>   possibly distinct from printing like `axiom.name()`?\n\n\n`str(axiom)` is the most natural for me, but it doesn't hurt to have an alias `axiom.name()`.\n\n> - Any better name for `axiom.index()`? It's only used internally,\n>   and in a single place; we could also just use `axiom._index`.\n\n\nI would get rid of it all together and (mildly) break encapsulation here by using `axiom._index`. It is both faster, only done in one place, and is an implementation detail.",
    "created_at": "2017-05-16T22:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432237",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>
> - Inside the code, do we want to call the catalog of axioms
>   `all_axioms` or `axioms`? The latter is more ambiguous,
>   but consistent with the name exported in global name space.


I say `axioms` both for consistency and naturality.

> - To fetch an existing axiom from a variable containing either the
>   axiom or its name, the current idiom is `all_axioms(name)`; that's
>   somewhat consistent with the `P(xx)` idiom to create elements of a
>   parent. Would we want some other idiom? `all_axioms[name]`?


I would go for the latter since it is a container object and `all_axioms[name]` is how Python handles other container objects, e.g., `dict`.

> - Do we want to implement a `cmp` method for axioms?


No, but rich comparisons are good.

>   - Comparing by string: this could avoid the repeated use of
>     `sorted(...,key=str)` in our documentation
>   - Comparing by index/definition time? This would be plausibly more
>     meaningful (axioms shown in some natural order). And simplify
>     a very tiny bit the one place where this sorting order is used in
>     the code.


Definitely Index/definition time as this will allow us to control the printing in a more straightforward way.

> - Do we want to Cythonize axiom.py? Now? Later?


I am inclined to say Cythonize it to keep the categories as fast as possible. I feel like even if highly optimized, this switch will slow down category creation because the string operations are lightweight and optimized at the machine level. However, I haven't done any timings.

Also, it would be good if you could get rid of the `SageObject` inheritance from `Axiom` so we could `cdef` it, and I don't see axioms fundamentally behaving like other instances of `SageObject`.

> - Do we want to import `all_axioms` from `category_with_axiom` rather than
>   `axiom`? This would avoid a double import in all the files specifying
>   `_base_category_and_axiom`


> - Do we want "additive magmas" to be renamed to "additive-magmas" for consistency?


I don't think the hyphen there is completely grammatically correct, at least it is strange to me. So I'm -1.

> - Do we want to fix the inconsistency below by adding `additive-` in
>   the first output?
> 
>   {{{
>   sage: CommutativeAdditiveGroups()
>   Category of commutative additive groups
>   sage: AdditiveMagmas().AdditiveCommutative()
>   Category of additive-commutative additive magmas
>   }}}


I would like the latter to be

```
Category of commutative additive magmas
```
as this is more concise and easier to parse.

> - To recover the string associated to an axiom in the code, is it fine
>   to use `str(axiom)`, or do we want something more explicit and
>   possibly distinct from printing like `axiom.name()`?


`str(axiom)` is the most natural for me, but it doesn't hurt to have an alias `axiom.name()`.

> - Any better name for `axiom.index()`? It's only used internally,
>   and in a single place; we could also just use `axiom._index`.


I would get rid of it all together and (mildly) break encapsulation here by using `axiom._index`. It is both faster, only done in one place, and is an implementation detail.



---

archive/issue_comments_432238.json:
```json
{
    "body": "<a id='comment:27'></a>\nLooks like there are a lot of things in the comments to still be addressed and merge conflicts that need to be resolved.",
    "created_at": "2017-08-31T05:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432238",
    "user": "https://github.com/koffie"
}
```

<a id='comment:27'></a>
Looks like there are a lot of things in the comments to still be addressed and merge conflicts that need to be resolved.



---

archive/issue_comments_432239.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-08-31T05:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22965",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22965#issuecomment-432239",
    "user": "https://github.com/koffie"
}
```

Changing status from needs_review to needs_work.
