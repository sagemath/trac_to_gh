# Issue 22382: Fix facade option for DisjointUnionEnumeratedSets

archive/issues_022145.json:
```json
{
    "body": "Currently, `DisjointUnionEnumeratedSets` has an option to be a facade parent, but the category framework, and hence the coercion framework, does not know it is a facade parent. This can lead to test suite failures and some other unexpected behaviors, such as not being able to create elements. In particular, this causes problems noted on #22029.\n\nCC:  @jdemeyer @mezzarobba @nthiery\n\nBranch/Commit: 5c4716b23c12cd5fe929fd0bfe7370f4aeaf0e02\n\nReviewer: Andrew Mathas, Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22382\n\n",
    "closed_at": "2017-03-01T18:51:10Z",
    "created_at": "2017-02-14T23:07:45Z",
    "labels": [
        "component: categories",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Fix facade option for DisjointUnionEnumeratedSets",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22382",
    "user": "https://github.com/tscrim"
}
```
Currently, `DisjointUnionEnumeratedSets` has an option to be a facade parent, but the category framework, and hence the coercion framework, does not know it is a facade parent. This can lead to test suite failures and some other unexpected behaviors, such as not being able to create elements. In particular, this causes problems noted on #22029.

CC:  @jdemeyer @mezzarobba @nthiery

Branch/Commit: 5c4716b23c12cd5fe929fd0bfe7370f4aeaf0e02

Reviewer: Andrew Mathas, Frédéric Chapoton

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22382





---

archive/issue_comments_415139.json:
```json
{
    "body": "Changing commit from \"\" to \"2fdcc12160784b69223ae3fd48ab73388c3f90ce\"",
    "created_at": "2017-02-14T23:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415139",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "2fdcc12160784b69223ae3fd48ab73388c3f90ce"



---

archive/issue_comments_415140.json:
```json
{
    "body": "Changing branch from \"\" to \"public/sets/disjoint_union_facade-22382\"",
    "created_at": "2017-02-14T23:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415140",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/sets/disjoint_union_facade-22382"



---

archive/issue_comments_415141.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2017-02-14T23:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415141",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_415142.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-02-14T23:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415142",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_415143.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-14T23:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415143",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415144.json:
```json
{
    "body": "Changing commit from \"2fdcc12160784b69223ae3fd48ab73388c3f90ce\" to \"9be48c00d33f4ec27c3a95aaece067c5d04d1381\"",
    "created_at": "2017-02-14T23:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415144",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2fdcc12160784b69223ae3fd48ab73388c3f90ce" to "9be48c00d33f4ec27c3a95aaece067c5d04d1381"



---

archive/issue_comments_415145.json:
```json
{
    "body": "<a id='comment:3'></a>Waiting for the bots to run all of the tests.",
    "created_at": "2017-02-14T23:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415145",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>Waiting for the bots to run all of the tests.



---

archive/issue_comments_415146.json:
```json
{
    "body": "Changing commit from \"9be48c00d33f4ec27c3a95aaece067c5d04d1381\" to \"26503383caff15cda44a72f36b43b09d929a6776\"",
    "created_at": "2017-02-17T02:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415146",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9be48c00d33f4ec27c3a95aaece067c5d04d1381" to "26503383caff15cda44a72f36b43b09d929a6776"



---

archive/issue_comments_415147.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-17T02:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415147",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415148.json:
```json
{
    "body": "<a id='comment:5'></a>Looks good to me. All doc-tests past. I added one more doctest, which shows that this patch fixes an issue that I care about, and a missing `indirect doctest` tag to stop `sage -coverage` from complaining. I have not checked that the documentation builds but this should be OK because the changes only affect underscore methods. (There is no need to change the documentation because this patch ensures that `DisjointUnionEnumeratedSets` behaves as it is supposed to.)\n\nIf you are happy with my changes then please set to a positive review.",
    "created_at": "2017-02-17T02:51:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415148",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:5'></a>Looks good to me. All doc-tests past. I added one more doctest, which shows that this patch fixes an issue that I care about, and a missing `indirect doctest` tag to stop `sage -coverage` from complaining. I have not checked that the documentation builds but this should be OK because the changes only affect underscore methods. (There is no need to change the documentation because this patch ensures that `DisjointUnionEnumeratedSets` behaves as it is supposed to.)

If you are happy with my changes then please set to a positive review.



---

archive/issue_comments_415149.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Andrew Mathas\"",
    "created_at": "2017-02-17T02:51:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415149",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing reviewer from "" to "Andrew Mathas"



---

archive/issue_comments_415150.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-17T06:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415150",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415151.json:
```json
{
    "body": "Changing commit from \"26503383caff15cda44a72f36b43b09d929a6776\" to \"82bea355aef7a0749d1bc7f454c9ebc59f67ed10\"",
    "created_at": "2017-02-17T06:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415151",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "26503383caff15cda44a72f36b43b09d929a6776" to "82bea355aef7a0749d1bc7f454c9ebc59f67ed10"



---

archive/issue_comments_415152.json:
```json
{
    "body": "<a id='comment:7'></a>Thank you for looking at this. I made some formatting corrections to your changes, and I added a quick note about the wrapped elements from our discussion on sage-combinat-devel. If my changes are good, then positive review.",
    "created_at": "2017-02-17T06:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415152",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>Thank you for looking at this. I made some formatting corrections to your changes, and I added a quick note about the wrapped elements from our discussion on sage-combinat-devel. If my changes are good, then positive review.



---

archive/issue_comments_415153.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-17T08:06:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415153",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_415154.json:
```json
{
    "body": "<a id='comment:8'></a>Happy with this. Looks good -> positive review.",
    "created_at": "2017-02-17T08:06:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415154",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:8'></a>Happy with this. Looks good -> positive review.



---

archive/issue_comments_415155.json:
```json
{
    "body": "<a id='comment:9'></a>Thank you again.",
    "created_at": "2017-02-17T19:36:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415155",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>Thank you again.



---

archive/issue_comments_415156.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-22T15:14:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415156",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_415157.json:
```json
{
    "body": "<a id='comment:11'></a>Various test failures",
    "created_at": "2017-02-22T15:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415157",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>Various test failures



---

archive/issue_comments_415158.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-22T16:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415158",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415159.json:
```json
{
    "body": "Changing commit from \"82bea355aef7a0749d1bc7f454c9ebc59f67ed10\" to \"5c614b79b71ffda5a5dbe9c56c6eb8392d03e7c3\"",
    "created_at": "2017-02-22T16:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415159",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "82bea355aef7a0749d1bc7f454c9ebc59f67ed10" to "5c614b79b71ffda5a5dbe9c56c6eb8392d03e7c3"



---

archive/issue_comments_415160.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-22T16:23:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415160",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_415161.json:
```json
{
    "body": "<a id='comment:13'></a>The problem comes from the fact that coercion of the E<sub>6</sub> crystal is a bit too permissive. However, properly fixing this issue would likely be expensive in terms of computations, which I don't really want to do at this stage. Instead, the workaround is actually something we should do IMO: test if the element's parents is one of the parents used in the construction.",
    "created_at": "2017-02-22T16:23:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415161",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>The problem comes from the fact that coercion of the E<sub>6</sub> crystal is a bit too permissive. However, properly fixing this issue would likely be expensive in terms of computations, which I don't really want to do at this stage. Instead, the workaround is actually something we should do IMO: test if the element's parents is one of the parents used in the construction.



---

archive/issue_comments_415162.json:
```json
{
    "body": "<a id='comment:14'></a>still one failing doctest, see bot report",
    "created_at": "2017-02-23T15:15:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415162",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>still one failing doctest, see bot report



---

archive/issue_comments_415163.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-23T15:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415163",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415164.json:
```json
{
    "body": "Changing commit from \"5c614b79b71ffda5a5dbe9c56c6eb8392d03e7c3\" to \"5c4716b23c12cd5fe929fd0bfe7370f4aeaf0e02\"",
    "created_at": "2017-02-23T15:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415164",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5c614b79b71ffda5a5dbe9c56c6eb8392d03e7c3" to "5c4716b23c12cd5fe929fd0bfe7370f4aeaf0e02"



---

archive/issue_comments_415165.json:
```json
{
    "body": "<a id='comment:16'></a>Whoops, thought I got them all...",
    "created_at": "2017-02-23T15:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415165",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'></a>Whoops, thought I got them all...



---

archive/issue_comments_415166.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-25T07:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415166",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_415167.json:
```json
{
    "body": "<a id='comment:17'></a>ok, let it be",
    "created_at": "2017-02-25T07:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415167",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>ok, let it be



---

archive/issue_comments_415168.json:
```json
{
    "body": "Changing reviewer from \"Andrew Mathas\" to \"Andrew Mathas, Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2017-02-25T07:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415168",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "Andrew Mathas" to "Andrew Mathas, Frédéric Chapoton"



---

archive/issue_events_058610.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-01T18:51:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22382#event-58610"
}
```



---

archive/issue_comments_415169.json:
```json
{
    "body": "Changing branch from \"public/sets/disjoint_union_facade-22382\" to \"5c4716b23c12cd5fe929fd0bfe7370f4aeaf0e02\"",
    "created_at": "2017-03-01T18:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415169",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/sets/disjoint_union_facade-22382" to "5c4716b23c12cd5fe929fd0bfe7370f4aeaf0e02"



---

archive/issue_comments_415170.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-01T18:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22382",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22382#issuecomment-415170",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
