# Issue 22937: Implement a "distribute" method

archive/issues_022700.json:
```json
{
    "assignees": [],
    "body": "Motivation : some \"obvious\" transformations, sometimes helpful in routine calculations, cannot be obtained via the current methods. Some (elementary,\ni. e. high-school- or undergrad-level) exemples : given the declarations :\n\n```\nvar(\"a,b\")\nvar(\"j,p\", domain=\"integer\")\nf,g,X=function(\"f,g,X\")\n```\n\nthe following equalities, true under no or mild conditions, cannot be deduced currently :\n\n```\nsum(X(j)+Y(j),j,1,p)==sum(X(j),j,1,p)+sum(Y(j),j,1,p) ## (1)\nprod(X(j)*Y(j),j,1,p)==prod(X(j),j,1,p)*prod(Y(j),j,1,p) ## (2)\nintegrate(f(x)+g(x),x,a,b)==integrate(f(x),x,a,b)+integrate(g(x),x,a,b) ## (3)\n```\n\nSimilarly, if A, B and C are matrices over a suitable ring and of\nsuitable dimensions, the following equalities cannot be\nstraightforwardly obtained.\n\n```\n(A+B).trace()==A.trace()+B.trace() ## (4)\n(A*B).det()==A.det()*B.det() ## (5)\n```\n\n(Curiously, `(f(x)+g(x)).diff(x)` *does* return\n`diff(f(x),x)+diff(g(x),x)` (and a way to return to the original\nexpression does not seem to exist currently)).\n\nThe ability to generate the right-hand form from the left-hand form of\nthese various examples is sometimes useful in (low-level)\nexamples. The examples (1) and/or (2) arise naturally when deriving the\nmaximum-likelihood estimators of the mean and variance of a given\ndistribution. The third one is often encountered in elementary calculus\nexercises.\n\nIn all cases, an operator is \"distributed\" over another one :\n(1) : symbolic_sum is distributed over addition.\n(2) : symbolic product is distributed over multiplication.\n(3) : integration is ditributed over addition.\n(4) : trace is distributed over (matrix) addition.\n(5) : determinant is distributed over (matrix) multiplication.\n\nImplementing (1) as an extension of the `expand()` method of\nExpression is tempting (see #22915). However, there are situations\nwhere this expansion is **not** useful. So, creating a method for such\nsituations seems useful.\n\nOne should note that such \"distributions\" are not systematically\nvalid : we have a collection of special cases rather than a general\nmechanism. So this method shoud either limit itself to a few\nrecognized cases or take keyword argument(s) specifying what should be\ndistributed over what.\n\nAnother design choice is to know if these distributions should be\nrecursive or run only on the top level of a given expression\n(possibly controlled by another keyword argument).\n\nThe present ticket aims at implementing this method for `sage.symbolic.expression.Expression`, at least in cases (1) to (3) (case (2) needs an implementation of the symbolic products, see #17505). Further suggestions for other classes are welcome...\n\nDepends on #17505\n\nCC:  @rwst @tscrim\n\nBranch: **[7aee739](https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f)**\n\nUpstream: **None of the above - read trac for reasoning.**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Emmanuel Charpentier, Ralf Stephan**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22937_\n\n",
    "closed_at": "2017-05-14T08:19:59Z",
    "created_at": "2017-05-03T14:53:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement a \"distribute\" method",
    "type": "issue",
    "updated_at": "2017-05-19T12:10:56Z",
    "url": "https://github.com/sagemath/sage/issues/22937",
    "user": "https://github.com/EmmanuelCharpentier"
}
```
Motivation : some "obvious" transformations, sometimes helpful in routine calculations, cannot be obtained via the current methods. Some (elementary,
i. e. high-school- or undergrad-level) exemples : given the declarations :

```
var("a,b")
var("j,p", domain="integer")
f,g,X=function("f,g,X")
```

the following equalities, true under no or mild conditions, cannot be deduced currently :

```
sum(X(j)+Y(j),j,1,p)==sum(X(j),j,1,p)+sum(Y(j),j,1,p) ## (1)
prod(X(j)*Y(j),j,1,p)==prod(X(j),j,1,p)*prod(Y(j),j,1,p) ## (2)
integrate(f(x)+g(x),x,a,b)==integrate(f(x),x,a,b)+integrate(g(x),x,a,b) ## (3)
```

Similarly, if A, B and C are matrices over a suitable ring and of
suitable dimensions, the following equalities cannot be
straightforwardly obtained.

```
(A+B).trace()==A.trace()+B.trace() ## (4)
(A*B).det()==A.det()*B.det() ## (5)
```

(Curiously, `(f(x)+g(x)).diff(x)` *does* return
`diff(f(x),x)+diff(g(x),x)` (and a way to return to the original
expression does not seem to exist currently)).

The ability to generate the right-hand form from the left-hand form of
these various examples is sometimes useful in (low-level)
examples. The examples (1) and/or (2) arise naturally when deriving the
maximum-likelihood estimators of the mean and variance of a given
distribution. The third one is often encountered in elementary calculus
exercises.

In all cases, an operator is "distributed" over another one :
(1) : symbolic_sum is distributed over addition.
(2) : symbolic product is distributed over multiplication.
(3) : integration is ditributed over addition.
(4) : trace is distributed over (matrix) addition.
(5) : determinant is distributed over (matrix) multiplication.

Implementing (1) as an extension of the `expand()` method of
Expression is tempting (see #22915). However, there are situations
where this expansion is **not** useful. So, creating a method for such
situations seems useful.

One should note that such "distributions" are not systematically
valid : we have a collection of special cases rather than a general
mechanism. So this method shoud either limit itself to a few
recognized cases or take keyword argument(s) specifying what should be
distributed over what.

Another design choice is to know if these distributions should be
recursive or run only on the top level of a given expression
(possibly controlled by another keyword argument).

The present ticket aims at implementing this method for `sage.symbolic.expression.Expression`, at least in cases (1) to (3) (case (2) needs an implementation of the symbolic products, see #17505). Further suggestions for other classes are welcome...

Depends on #17505

CC:  @rwst @tscrim

Branch: **[7aee739](https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f)**

Upstream: **None of the above - read trac for reasoning.**

Reviewer: **Travis Scrimshaw**

Author: **Emmanuel Charpentier, Ralf Stephan**

_Issue created by migration from https://trac.sagemath.org/ticket/22937_





---

archive/issue_events_291078.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-03T14:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291078"
}
```



---

archive/issue_events_291079.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-03T14:53:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "component: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291079"
}
```



---

archive/issue_events_291080.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-03T14:53:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291080"
}
```



---

archive/issue_events_291081.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-03T14:53:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291081"
}
```



---

archive/issue_comments_345175.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nDiscussion opened on[sage-devel](https://groups.google.com/forum/#!topic/sage-devel/9Dd3IiHvTYA)",
    "created_at": "2017-05-03T15:10:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345175",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:1'>Comment 1:</a>
Discussion opened on[sage-devel](https://groups.google.com/forum/#!topic/sage-devel/9Dd3IiHvTYA)



---

archive/issue_comments_345176.json:
```json
{
    "body": "Branch: **[u/charpent/distribute](https://github.com/sagemath/sagetrac-mirror/tree/u/charpent/distribute)**",
    "created_at": "2017-05-09T04:55:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345176",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Branch: **[u/charpent/distribute](https://github.com/sagemath/sagetrac-mirror/tree/u/charpent/distribute)**



---

archive/issue_comments_345177.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nFirst implementation :\n- Symbolic sum of a sum ==> sum of symbolic sums\n- Integral (definite or not) of a sum ==> sum of integrals.\n\nPasses `ptestlong` with the same errors as those reported for 8.0.beta4 and 8.0.beta5\n\n==>`neeeds_review`\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3bcef0564e154e930191471334b7c43e5637bea\">c3bcef0</a></td><td><code>First implementation of distribute() : sums.</code></td></tr></table>\n",
    "created_at": "2017-05-09T05:02:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345177",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:3'>Comment 3:</a>
First implementation :
- Symbolic sum of a sum ==> sum of symbolic sums
- Integral (definite or not) of a sum ==> sum of integrals.

Passes `ptestlong` with the same errors as those reported for 8.0.beta4 and 8.0.beta5

==>`neeeds_review`

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3bcef0564e154e930191471334b7c43e5637bea">c3bcef0</a></td><td><code>First implementation of distribute() : sums.</code></td></tr></table>




---

archive/issue_comments_345178.json:
```json
{
    "body": "Commit: **[c3bcef0](https://github.com/sagemath/sagetrac-mirror/commit/c3bcef0564e154e930191471334b7c43e5637bea)**",
    "created_at": "2017-05-09T05:02:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345178",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Commit: **[c3bcef0](https://github.com/sagemath/sagetrac-mirror/commit/c3bcef0564e154e930191471334b7c43e5637bea)**



---

archive/issue_events_291082.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-09T05:02:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291082"
}
```



---

archive/issue_events_291083.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-09T13:33:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291083"
}
```



---

archive/issue_events_291084.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-09T13:33:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291084"
}
```



---

archive/issue_comments_345179.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nFurther verifications show that this does not work in all cases.\n\nBack to the old drawing board...",
    "created_at": "2017-05-09T13:33:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345179",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:4'>Comment 4:</a>
Further verifications show that this does not work in all cases.

Back to the old drawing board...



---

archive/issue_comments_345180.json:
```json
{
    "body": "Changed commit from **[c3bcef0](https://github.com/sagemath/sagetrac-mirror/commit/c3bcef0564e154e930191471334b7c43e5637bea)** to **[7f9666a](https://github.com/sagemath/sagetrac-mirror/commit/7f9666a22d0d290f4b3504bc1d4b61a4dcf7c455)**",
    "created_at": "2017-05-09T15:11:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345180",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c3bcef0](https://github.com/sagemath/sagetrac-mirror/commit/c3bcef0564e154e930191471334b7c43e5637bea)** to **[7f9666a](https://github.com/sagemath/sagetrac-mirror/commit/7f9666a22d0d290f4b3504bc1d4b61a4dcf7c455)**



---

archive/issue_comments_345181.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f9666a22d0d290f4b3504bc1d4b61a4dcf7c455\">7f9666a</a></td><td><code>Fixed recursion when non-match at toplevel.</code></td></tr></table>\n",
    "created_at": "2017-05-09T15:11:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345181",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f9666a22d0d290f4b3504bc1d4b61a4dcf7c455">7f9666a</a></td><td><code>Fixed recursion when non-match at toplevel.</code></td></tr></table>




---

archive/issue_comments_345182.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nPasses `ptestlong` with the same (unrelated) failures as before +one transient timeout :\n\n```\nsage -t --long src/sage/modular/modform/find_generators.py \n```\nwhich passes when run standalone.\n\n==>`needs_review` again.",
    "created_at": "2017-05-09T16:44:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345182",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:6'>Comment 6:</a>
Passes `ptestlong` with the same (unrelated) failures as before +one transient timeout :

```
sage -t --long src/sage/modular/modform/find_generators.py 
```
which passes when run standalone.

==>`needs_review` again.



---

archive/issue_events_291085.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-09T16:44:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291085"
}
```



---

archive/issue_events_291086.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-09T16:44:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291086"
}
```



---

archive/issue_events_291087.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-11T13:30:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291087"
}
```



---

archive/issue_events_291088.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-11T13:30:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291088"
}
```



---

archive/issue_comments_345183.json:
```json
{
    "body": "Dependencies: **17505**",
    "created_at": "2017-05-11T13:30:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345183",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Dependencies: **17505**



---

archive/issue_comments_345184.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nPlanning to implement the multiplicative case allowed by #17505.",
    "created_at": "2017-05-11T13:30:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345184",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:7'>Comment 7:</a>
Planning to implement the multiplicative case allowed by #17505.



---

archive/issue_comments_345185.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nMinor comment: Instead of using `map`, you can do, e.g.,\n\n```diff\nmap(lambda t:treat_term(op, t, la), aa)\ntreat_term(op, t, la) for t in aa\n```\n(with wrapping it as a list comprehension `[treat_term(op, t, la) for t in aa]` when you need a list).\n\nAddendum - I feel this is cleaner and IIRC, it is faster.",
    "created_at": "2017-05-11T13:53:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345185",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'>Comment 8:</a>
Minor comment: Instead of using `map`, you can do, e.g.,

```diff
map(lambda t:treat_term(op, t, la), aa)
treat_term(op, t, la) for t in aa
```
(with wrapping it as a list comprehension `[treat_term(op, t, la) for t in aa]` when you need a list).

Addendum - I feel this is cleaner and IIRC, it is faster.



---

archive/issue_comments_345186.json:
```json
{
    "body": "Changed dependencies from **17505** to **#17505**",
    "created_at": "2017-05-11T13:53:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345186",
    "user": "https://github.com/tscrim"
}
```

Changed dependencies from **17505** to **#17505**



---

archive/issue_comments_345187.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nReplying to [@tscrim](#comment%3A8):\n> Minor comment: Instead of using `map`, you can do, e.g.,\n> \n> ```diff\n> map(lambda t:treat_term(op, t, la), aa)\n> treat_term(op, t, la) for t in aa\n> ```\n> (with wrapping it as a list comprehension `[treat_term(op, t, la) for t in aa]` when you need a list).\n\nIndeed (my Lisp roots (and my age...) are showing).\n\n> Addendum - I feel this is cleaner and IIRC, it is faster.\n\nI'll check that. But I'll submit first the \"map\" version (which works...), and re-submit the \"comprehension\" version afterwards if it makes a serious difference.\n\nBTW : other enhancements are possible. For example create a local (static) dictionary of distributable operators, whose values are functions processing the corresponding case of distribution (with possible generalizations/factorizations). I didn't feel the four special cases we treat in SR so fare were worth it, but if you have other ideas, you're welcome...\n\nCommit forthcoming. Review request after `ptestlong` (sually a couple of hours...).",
    "created_at": "2017-05-11T14:15:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345187",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:9'>Comment 9:</a>
Replying to [@tscrim](#comment%3A8):
> Minor comment: Instead of using `map`, you can do, e.g.,
> 
> ```diff
> map(lambda t:treat_term(op, t, la), aa)
> treat_term(op, t, la) for t in aa
> ```
> (with wrapping it as a list comprehension `[treat_term(op, t, la) for t in aa]` when you need a list).

Indeed (my Lisp roots (and my age...) are showing).

> Addendum - I feel this is cleaner and IIRC, it is faster.

I'll check that. But I'll submit first the "map" version (which works...), and re-submit the "comprehension" version afterwards if it makes a serious difference.

BTW : other enhancements are possible. For example create a local (static) dictionary of distributable operators, whose values are functions processing the corresponding case of distribution (with possible generalizations/factorizations). I didn't feel the four special cases we treat in SR so fare were worth it, but if you have other ideas, you're welcome...

Commit forthcoming. Review request after `ptestlong` (sually a couple of hours...).



---

archive/issue_comments_345188.json:
```json
{
    "body": "Changed commit from **[7f9666a](https://github.com/sagemath/sagetrac-mirror/commit/7f9666a22d0d290f4b3504bc1d4b61a4dcf7c455)** to **[c67f957](https://github.com/sagemath/sagetrac-mirror/commit/c67f95735d1f816c0255dad81985a8c98aa49757)**",
    "created_at": "2017-05-11T14:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345188",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7f9666a](https://github.com/sagemath/sagetrac-mirror/commit/7f9666a22d0d290f4b3504bc1d4b61a4dcf7c455)** to **[c67f957](https://github.com/sagemath/sagetrac-mirror/commit/c67f95735d1f816c0255dad81985a8c98aa49757)**



---

archive/issue_comments_345189.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/647ff396cc17c8acb59043dad905ab882834017b\">647ff39</a></td><td><code>17505: unevaluated symbolic product</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4769b5524ae5629db4189d06684646b22781efb\">e4769b5</a></td><td><code>17505: symbolic product</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/58119b0df21bcfbb89fc58e108493fde90ac733f\">58119b0</a></td><td><code>17505: fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a56004ca73a73e04b0b6a7bdbe6b528c0358bb3\">7a56004</a></td><td><code>17505: address reviewer's suggestions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a01803082bb76d1326b8dc21ab77858f2fe96d49\">a018030</a></td><td><code>Merge branch 'u/rws/implement_symbolic_product' of trac.sagemath.org:sage into distribute</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c67f95735d1f816c0255dad81985a8c98aa49757\">c67f957</a></td><td><code>Implement distribute() in the multiplicative case.</code></td></tr></table>\n",
    "created_at": "2017-05-11T14:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345189",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>Comment 10:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/647ff396cc17c8acb59043dad905ab882834017b">647ff39</a></td><td><code>17505: unevaluated symbolic product</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4769b5524ae5629db4189d06684646b22781efb">e4769b5</a></td><td><code>17505: symbolic product</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/58119b0df21bcfbb89fc58e108493fde90ac733f">58119b0</a></td><td><code>17505: fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a56004ca73a73e04b0b6a7bdbe6b528c0358bb3">7a56004</a></td><td><code>17505: address reviewer's suggestions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a01803082bb76d1326b8dc21ab77858f2fe96d49">a018030</a></td><td><code>Merge branch 'u/rws/implement_symbolic_product' of trac.sagemath.org:sage into distribute</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c67f95735d1f816c0255dad81985a8c98aa49757">c67f957</a></td><td><code>Implement distribute() in the multiplicative case.</code></td></tr></table>




---

archive/issue_comments_345190.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nIt's about 3x slower to use `map`:\n\n```\nsage: %timeit [i for i in range(10000)]\n1000 loops, best of 3: 265 \u00b5s per loop\nsage: %timeit map(lambda i: i, range(10000))\n1000 loops, best of 3: 897 \u00b5s per loop\n```\nAlso in Python2, `map` returns a list, which takes extra time and memory to create. Whereas for the `sum`, you only need a generator object.\n\nI cannot comment so much about the operators as it is a little beyond my expertise.",
    "created_at": "2017-05-11T14:26:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345190",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'>Comment 11:</a>
It's about 3x slower to use `map`:

```
sage: %timeit [i for i in range(10000)]
1000 loops, best of 3: 265 µs per loop
sage: %timeit map(lambda i: i, range(10000))
1000 loops, best of 3: 897 µs per loop
```
Also in Python2, `map` returns a list, which takes extra time and memory to create. Whereas for the `sum`, you only need a generator object.

I cannot comment so much about the operators as it is a little beyond my expertise.



---

archive/issue_comments_345191.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nThis version passes `ptestlong` with the same three failure (deemed unrelated).\n\nI'll try Travis' version before marking the better version for review.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/647ff396cc17c8acb59043dad905ab882834017b\">647ff39</a></td><td><code>17505: unevaluated symbolic product</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4769b5524ae5629db4189d06684646b22781efb\">e4769b5</a></td><td><code>17505: symbolic product</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/58119b0df21bcfbb89fc58e108493fde90ac733f\">58119b0</a></td><td><code>17505: fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a56004ca73a73e04b0b6a7bdbe6b528c0358bb3\">7a56004</a></td><td><code>17505: address reviewer's suggestions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a01803082bb76d1326b8dc21ab77858f2fe96d49\">a018030</a></td><td><code>Merge branch 'u/rws/implement_symbolic_product' of trac.sagemath.org:sage into distribute</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c67f95735d1f816c0255dad81985a8c98aa49757\">c67f957</a></td><td><code>Implement distribute() in the multiplicative case.</code></td></tr></table>\n",
    "created_at": "2017-05-11T15:35:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345191",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:12'>Comment 12:</a>
This version passes `ptestlong` with the same three failure (deemed unrelated).

I'll try Travis' version before marking the better version for review.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/647ff396cc17c8acb59043dad905ab882834017b">647ff39</a></td><td><code>17505: unevaluated symbolic product</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4769b5524ae5629db4189d06684646b22781efb">e4769b5</a></td><td><code>17505: symbolic product</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/58119b0df21bcfbb89fc58e108493fde90ac733f">58119b0</a></td><td><code>17505: fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a56004ca73a73e04b0b6a7bdbe6b528c0358bb3">7a56004</a></td><td><code>17505: address reviewer's suggestions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a01803082bb76d1326b8dc21ab77858f2fe96d49">a018030</a></td><td><code>Merge branch 'u/rws/implement_symbolic_product' of trac.sagemath.org:sage into distribute</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c67f95735d1f816c0255dad81985a8c98aa49757">c67f957</a></td><td><code>Implement distribute() in the multiplicative case.</code></td></tr></table>




---

archive/issue_comments_345192.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/687cc8ea8b0a225d81309bcfffcb3aa948afd31b\">687cc8e</a></td><td><code>Distribute : implement Travis Scrimshaw's suggestion for iterations.</code></td></tr></table>\n",
    "created_at": "2017-05-11T16:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345192",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>Comment 13:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/687cc8ea8b0a225d81309bcfffcb3aa948afd31b">687cc8e</a></td><td><code>Distribute : implement Travis Scrimshaw's suggestion for iterations.</code></td></tr></table>




---

archive/issue_comments_345193.json:
```json
{
    "body": "Changed commit from **[c67f957](https://github.com/sagemath/sagetrac-mirror/commit/c67f95735d1f816c0255dad81985a8c98aa49757)** to **[687cc8e](https://github.com/sagemath/sagetrac-mirror/commit/687cc8ea8b0a225d81309bcfffcb3aa948afd31b)**",
    "created_at": "2017-05-11T16:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345193",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c67f957](https://github.com/sagemath/sagetrac-mirror/commit/c67f95735d1f816c0255dad81985a8c98aa49757)** to **[687cc8e](https://github.com/sagemath/sagetrac-mirror/commit/687cc8ea8b0a225d81309bcfffcb3aa948afd31b)**



---

archive/issue_comments_345194.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nWith Travis' suggestion, passes `ptestlong` with the same result as before ==> `needs_review`\n\nDo you think that this enhancement should be passed to Maxima ? The algorithm seems simple to port in Maxima or Lisp.",
    "created_at": "2017-05-11T19:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345194",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:14'>Comment 14:</a>
With Travis' suggestion, passes `ptestlong` with the same result as before ==> `needs_review`

Do you think that this enhancement should be passed to Maxima ? The algorithm seems simple to port in Maxima or Lisp.



---

archive/issue_comments_345195.json:
```json
{
    "body": "Author: **Emmanuel Charpentier, Ralf Stephan, Travis Scrimshaw**",
    "created_at": "2017-05-11T19:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345195",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Author: **Emmanuel Charpentier, Ralf Stephan, Travis Scrimshaw**



---

archive/issue_comments_345196.json:
```json
{
    "body": "Upstream: **None of the above - read trac for reasoning.**",
    "created_at": "2017-05-11T19:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345196",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Upstream: **None of the above - read trac for reasoning.**



---

archive/issue_events_291089.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-11T19:54:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291089"
}
```



---

archive/issue_events_291090.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-05-11T19:54:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291090"
}
```



---

archive/issue_comments_345197.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d420ec4ab00a322f97bd05326741ec7de3e3d65a\">d420ec4</a></td><td><code>17505: fix latex, cosmetics</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b784a2c01f9655f1c462257dca28e003600b1f65\">b784a2c</a></td><td><code>Merge branch 'u/rws/implement_symbolic_product' of trac.sagemath.org:sage into distribute</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5779423aac340d1d7dc415da287b9af5e0e1f381\">5779423</a></td><td><code>17505: fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4b6e71b471ac6747defcc0784208baea42f1da20\">4b6e71b</a></td><td><code>Merge branch 'u/rws/implement_symbolic_product' of trac.sagemath.org:sage into distribute</code></td></tr></table>\n",
    "created_at": "2017-05-12T14:04:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345197",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>Comment 15:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d420ec4ab00a322f97bd05326741ec7de3e3d65a">d420ec4</a></td><td><code>17505: fix latex, cosmetics</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b784a2c01f9655f1c462257dca28e003600b1f65">b784a2c</a></td><td><code>Merge branch 'u/rws/implement_symbolic_product' of trac.sagemath.org:sage into distribute</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5779423aac340d1d7dc415da287b9af5e0e1f381">5779423</a></td><td><code>17505: fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4b6e71b471ac6747defcc0784208baea42f1da20">4b6e71b</a></td><td><code>Merge branch 'u/rws/implement_symbolic_product' of trac.sagemath.org:sage into distribute</code></td></tr></table>




---

archive/issue_comments_345198.json:
```json
{
    "body": "Changed commit from **[687cc8e](https://github.com/sagemath/sagetrac-mirror/commit/687cc8ea8b0a225d81309bcfffcb3aa948afd31b)** to **[4b6e71b](https://github.com/sagemath/sagetrac-mirror/commit/4b6e71b471ac6747defcc0784208baea42f1da20)**",
    "created_at": "2017-05-12T14:04:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345198",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[687cc8e](https://github.com/sagemath/sagetrac-mirror/commit/687cc8ea8b0a225d81309bcfffcb3aa948afd31b)** to **[4b6e71b](https://github.com/sagemath/sagetrac-mirror/commit/4b6e71b471ac6747defcc0784208baea42f1da20)**



---

archive/issue_comments_345199.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nMerged #17505 again. Should be reviewable.",
    "created_at": "2017-05-12T14:07:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345199",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:16'>Comment 16:</a>
Merged #17505 again. Should be reviewable.



---

archive/issue_comments_345200.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nIn general, it is always better to pass things to upstream. Although for now, we should do things on our side.\n\nSome other small comments:\n- There is a typo:\n\n  ```\n  _ Symbolic product of a product ==> product of symbolic products.\n  ```\n- `self` is not considered as an input.\n- Small change to your `INPUT:`:\n\n  ```\n        - ``recursive`` -- (default: ``True``) the distribution proceeds\n          along the subtrees of the expression\n  ```",
    "created_at": "2017-05-12T14:19:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345200",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'>Comment 17:</a>
In general, it is always better to pass things to upstream. Although for now, we should do things on our side.

Some other small comments:
- There is a typo:

  ```
  _ Symbolic product of a product ==> product of symbolic products.
  ```
- `self` is not considered as an input.
- Small change to your `INPUT:`:

  ```
        - ``recursive`` -- (default: ``True``) the distribution proceeds
          along the subtrees of the expression
  ```



---

archive/issue_comments_345201.json:
```json
{
    "body": "Changed author from **Emmanuel Charpentier, Ralf Stephan, Travis Scrimshaw** to **Emmanuel Charpentier, Ralf Stephan**",
    "created_at": "2017-05-12T14:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345201",
    "user": "https://github.com/tscrim"
}
```

Changed author from **Emmanuel Charpentier, Ralf Stephan, Travis Scrimshaw** to **Emmanuel Charpentier, Ralf Stephan**



---

archive/issue_comments_345202.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2017-05-12T14:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345202",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_345203.json:
```json
{
    "body": "Changed commit from **[4b6e71b](https://github.com/sagemath/sagetrac-mirror/commit/4b6e71b471ac6747defcc0784208baea42f1da20)** to **[2412f7a](https://github.com/sagemath/sagetrac-mirror/commit/2412f7a387cf0dec3a764a52a8e644d545cef5f8)**",
    "created_at": "2017-05-12T14:38:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345203",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[4b6e71b](https://github.com/sagemath/sagetrac-mirror/commit/4b6e71b471ac6747defcc0784208baea42f1da20)** to **[2412f7a](https://github.com/sagemath/sagetrac-mirror/commit/2412f7a387cf0dec3a764a52a8e644d545cef5f8)**



---

archive/issue_comments_345204.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2412f7a387cf0dec3a764a52a8e644d545cef5f8\">2412f7a</a></td><td><code>Distribute : cosmetics on documentation.</code></td></tr></table>\n",
    "created_at": "2017-05-12T14:38:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345204",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2412f7a387cf0dec3a764a52a8e644d545cef5f8">2412f7a</a></td><td><code>Distribute : cosmetics on documentation.</code></td></tr></table>




---

archive/issue_comments_345205.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nCosmetic (but important) changes to the documentation. Thank you, Travis.\n\n`sage -t --long src/sage/symbolic/expression.pyx` passes without failure. Would you mind reviewing it (I probably can't `ptestlong` right now...).",
    "created_at": "2017-05-12T14:41:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345205",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:20'>Comment 20:</a>
Cosmetic (but important) changes to the documentation. Thank you, Travis.

`sage -t --long src/sage/symbolic/expression.pyx` passes without failure. Would you mind reviewing it (I probably can't `ptestlong` right now...).



---

archive/issue_comments_345206.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [@tscrim](#comment%3A18):\n\nYou are still listed as an author in the docstring (credit where credit is due...).",
    "created_at": "2017-05-12T14:41:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345206",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [@tscrim](#comment%3A18):

You are still listed as an author in the docstring (credit where credit is due...).



---

archive/issue_comments_345207.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nI shouldn't be because I just did some simple review changes (so please remove me). But thank you. :)\n\nEverything else looks good.",
    "created_at": "2017-05-12T14:46:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345207",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'>Comment 22:</a>
I shouldn't be because I just did some simple review changes (so please remove me). But thank you. :)

Everything else looks good.



---

archive/issue_comments_345208.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nis the word \"indiced\" correct or it is \"indexed\"? (i'm not native english speaker though..)",
    "created_at": "2017-05-12T14:56:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345208",
    "user": "https://github.com/mforets"
}
```

<a id='comment:23'>Comment 23:</a>
is the word "indiced" correct or it is "indexed"? (i'm not native english speaker though..)



---

archive/issue_comments_345209.json:
```json
{
    "body": "Changed commit from **[2412f7a](https://github.com/sagemath/sagetrac-mirror/commit/2412f7a387cf0dec3a764a52a8e644d545cef5f8)** to **[c28097a](https://github.com/sagemath/sagetrac-mirror/commit/c28097a513f90c7d4e738d6f97c1036d897b4d62)**",
    "created_at": "2017-05-12T14:58:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345209",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2412f7a](https://github.com/sagemath/sagetrac-mirror/commit/2412f7a387cf0dec3a764a52a8e644d545cef5f8)** to **[c28097a](https://github.com/sagemath/sagetrac-mirror/commit/c28097a513f90c7d4e738d6f97c1036d897b4d62)**



---

archive/issue_comments_345210.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c28097a513f90c7d4e738d6f97c1036d897b4d62\">c28097a</a></td><td><code>Distribute : at his request, Travis Crimshaw removed from Author's list.</code></td></tr></table>\n",
    "created_at": "2017-05-12T14:58:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345210",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:24'>Comment 24:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c28097a513f90c7d4e738d6f97c1036d897b4d62">c28097a</a></td><td><code>Distribute : at his request, Travis Crimshaw removed from Author's list.</code></td></tr></table>




---

archive/issue_comments_345211.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\n`indexed` is correct adjective.",
    "created_at": "2017-05-12T14:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345211",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'>Comment 25:</a>
`indexed` is correct adjective.



---

archive/issue_comments_345212.json:
```json
{
    "body": "Changed commit from **[c28097a](https://github.com/sagemath/sagetrac-mirror/commit/c28097a513f90c7d4e738d6f97c1036d897b4d62)** to **[7aee739](https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f)**",
    "created_at": "2017-05-12T15:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345212",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c28097a](https://github.com/sagemath/sagetrac-mirror/commit/c28097a513f90c7d4e738d6f97c1036d897b4d62)** to **[7aee739](https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f)**



---

archive/issue_comments_345213.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f\">7aee739</a></td><td><code>Distribute : one last typo (I hope...).</code></td></tr></table>\n",
    "created_at": "2017-05-12T15:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345213",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>Comment 26:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f">7aee739</a></td><td><code>Distribute : one last typo (I hope...).</code></td></tr></table>




---

archive/issue_comments_345214.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nRReplying to [@tscrim](#comment%3A22):\n> I shouldn't be because I just did some simple review changes\n\nYour suggestion to do without map() was a good one (and teached me something I tend to oversee : Python is not Lisp...).\n\n> (so please remove me).\n\nIf you insist...\n\n> But thank you. :)\n> \n> Everything else looks good.\n\nSo this last update (including indiced --> indexed) should be reviewed...\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f\">7aee739</a></td><td><code>Distribute : one last typo (I hope...).</code></td></tr></table>\n",
    "created_at": "2017-05-12T15:04:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345214",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:27'>Comment 27:</a>
RReplying to [@tscrim](#comment%3A22):
> I shouldn't be because I just did some simple review changes

Your suggestion to do without map() was a good one (and teached me something I tend to oversee : Python is not Lisp...).

> (so please remove me).

If you insist...

> But thank you. :)
> 
> Everything else looks good.

So this last update (including indiced --> indexed) should be reviewed...

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f">7aee739</a></td><td><code>Distribute : one last typo (I hope...).</code></td></tr></table>




---

archive/issue_events_291091.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-05-12T15:11:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291091"
}
```



---

archive/issue_events_291092.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-05-12T15:11:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291092"
}
```



---

archive/issue_comments_345215.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nReplying to [@EmmanuelCharpentier](#comment%3A27):\n> RReplying to [@tscrim](#comment%3A22):\n> > I shouldn't be because I just did some simple review changes\n\n> \n> Your suggestion to do without map() was a good one (and teached me something I tend to oversee : Python is not Lisp...).\n\nI am always learning things from my reviewers too.\n\n> > (so please remove me).\n\n> \n> If you insist...\n\nThank you. I didn't really author code other than give suggestions, so I don't think I should be listed as an author. :)\n\nYou will need to add a doctest in the dependency, but you don't have to merge it into this ticket explicitly (because it is a dependency and will be done by Volker in the develop branch).",
    "created_at": "2017-05-12T15:11:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345215",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'>Comment 28:</a>
Replying to [@EmmanuelCharpentier](#comment%3A27):
> RReplying to [@tscrim](#comment%3A22):
> > I shouldn't be because I just did some simple review changes

> 
> Your suggestion to do without map() was a good one (and teached me something I tend to oversee : Python is not Lisp...).

I am always learning things from my reviewers too.

> > (so please remove me).

> 
> If you insist...

Thank you. I didn't really author code other than give suggestions, so I don't think I should be listed as an author. :)

You will need to add a doctest in the dependency, but you don't have to merge it into this ticket explicitly (because it is a dependency and will be done by Volker in the develop branch).



---

archive/issue_comments_345216.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nReplying to [@tscrim](#comment%3A28):\n\n[ Snip ... ]\n\n> You will need to add a doctest in the dependency, but you don't have to merge it into this ticket explicitly (because it is a dependency and will be done by Volker in the develop branch).\n\nThis should wait Ralf's implementation of the externally-visible `product` method and function (currently, we have to either import an internal function or cast to Sage a Maxima contraption...) : that will be cleaner an probably more useful to users.",
    "created_at": "2017-05-12T15:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345216",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:29'>Comment 29:</a>
Replying to [@tscrim](#comment%3A28):

[ Snip ... ]

> You will need to add a doctest in the dependency, but you don't have to merge it into this ticket explicitly (because it is a dependency and will be done by Volker in the develop branch).

This should wait Ralf's implementation of the externally-visible `product` method and function (currently, we have to either import an internal function or cast to Sage a Maxima contraption...) : that will be cleaner an probably more useful to users.



---

archive/issue_comments_345217.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nInteresting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.",
    "created_at": "2017-05-13T13:05:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345217",
    "user": "https://github.com/rwst"
}
```

<a id='comment:30'>Comment 30:</a>
Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.



---

archive/issue_comments_345218.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nReplying to [@rwst](#comment%3A30):\n> Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.\n\nAh that should have gone to #22989.",
    "created_at": "2017-05-13T13:10:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345218",
    "user": "https://github.com/rwst"
}
```

<a id='comment:31'>Comment 31:</a>
Replying to [@rwst](#comment%3A30):
> Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.

Ah that should have gone to #22989.



---

archive/issue_comments_345219.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nReplying to [@rwst](#comment%3A31):\n> Replying to [@rwst](#comment%3A30):\n> > Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.\n\n> \n> Ah that should have gone to #22989.\n\nGo ahead. Do you need me to do anything ?",
    "created_at": "2017-05-13T13:23:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345219",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:32'>Comment 32:</a>
Replying to [@rwst](#comment%3A31):
> Replying to [@rwst](#comment%3A30):
> > Interesting. Both branches apply but mine has a hunk that fuses two hunks into one; yours has the first of the two so my hunk cannot be applied. I'll upload a branch where the two are separated.

> 
> Ah that should have gone to #22989.

Go ahead. Do you need me to do anything ?



---

archive/issue_comments_345220.json:
```json
{
    "body": "Changed branch from **[u/charpent/distribute](https://github.com/sagemath/sagetrac-mirror/tree/u/charpent/distribute)** to **[7aee739](https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f)**",
    "created_at": "2017-05-14T08:19:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345220",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/charpent/distribute](https://github.com/sagemath/sagetrac-mirror/tree/u/charpent/distribute)** to **[7aee739](https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f)**



---

archive/issue_events_291093.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-14T08:19:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291093"
}
```



---

archive/issue_events_291094.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bcd6b7fa8c5b553be140af8f7b941663debba7c3",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-05-14T08:19:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22937#event-291094"
}
```



---

archive/issue_comments_345221.json:
```json
{
    "body": "Changed commit from **[7aee739](https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f)** to none",
    "created_at": "2017-05-19T11:39:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345221",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[7aee739](https://github.com/sagemath/sagetrac-mirror/commit/7aee739cceff13c596c12e93130250f1ea1fae3f)** to none



---

archive/issue_comments_345222.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\n**WARNING**\n\nYou have used here \"apply()\" which is not python3-compatible. Please correct this ASAP in another ticket.\n\nReference: www.diveintopython3.net/porting-code-to-python-3-with-2to3.html\n\nThe Python 2 builtin apply() has been removed in Python 3",
    "created_at": "2017-05-19T11:39:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345222",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:34'>Comment 34:</a>
**WARNING**

You have used here "apply()" which is not python3-compatible. Please correct this ASAP in another ticket.

Reference: www.diveintopython3.net/porting-code-to-python-3-with-2to3.html

The Python 2 builtin apply() has been removed in Python 3



---

archive/issue_comments_345223.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nReplying to [@fchapoton](#comment%3A34):\n> **WARNING**\n> \n> You have used here \"apply()\" which is not python3-compatible. Please correct this ASAP in another ticket.\n\nWill do that, maybe over the coming week-end, but have to think about it I'm not much of a Python coder...).\n\n> Reference: www.diveintopython3.net/porting-code-to-python-3-with-2to3.html\n\nThanks for the suggestion.\n\n> The Python 2 builtin apply() has been removed in Python 3\n\nH... right.",
    "created_at": "2017-05-19T11:48:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345223",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:35'>Comment 35:</a>
Replying to [@fchapoton](#comment%3A34):
> **WARNING**
> 
> You have used here "apply()" which is not python3-compatible. Please correct this ASAP in another ticket.

Will do that, maybe over the coming week-end, but have to think about it I'm not much of a Python coder...).

> Reference: www.diveintopython3.net/porting-code-to-python-3-with-2to3.html

Thanks for the suggestion.

> The Python 2 builtin apply() has been removed in Python 3

H... right.



---

archive/issue_comments_345224.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nDo you want me to take care of that, and then be a reviewer ? Maybe this will be faster.",
    "created_at": "2017-05-19T12:06:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345224",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:36'>Comment 36:</a>
Do you want me to take care of that, and then be a reviewer ? Maybe this will be faster.



---

archive/issue_comments_345225.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nI created #23030",
    "created_at": "2017-05-19T12:10:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22937",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22937#issuecomment-345225",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:37'>Comment 37:</a>
I created #23030
