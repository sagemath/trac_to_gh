# Issue 22608: Remove PYTHONPATH environment variable from sage

archive/issues_022371.json:
```json
{
    "assignees": [],
    "body": "Following sage-devel PYTHONPATH breaks Python3[https://groups.google.com/forum/#!topic/sage-devel/ITtF1vWIxIk](https://groups.google.com/forum/#!topic/sage-devel/ITtF1vWIxIk)\n\nHaving PYTHONPATH sets as an environment variable is reported to be incompatible with the installation of both Python2 and Python3 and with the use of gdb to debug.\n\nWe should remove the setting of the PYTHONPATH environment variable\n\nAssignee: **@vinklein**\n\nCC:  @videlec @embray\n\nKeywords: **PYTHONPATH**\n\nBranch: **[3b9cad2](https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Vincent Klein, Volker Braun**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22608_\n\n",
    "closed_at": "2017-04-05T19:37:46Z",
    "created_at": "2017-03-15T17:58:05Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Remove PYTHONPATH environment variable from sage",
    "type": "issue",
    "updated_at": "2017-08-11T19:30:55Z",
    "url": "https://github.com/sagemath/sage/issues/22608",
    "user": "https://github.com/vinklein"
}
```
Following sage-devel PYTHONPATH breaks Python3[https://groups.google.com/forum/#!topic/sage-devel/ITtF1vWIxIk](https://groups.google.com/forum/#!topic/sage-devel/ITtF1vWIxIk)

Having PYTHONPATH sets as an environment variable is reported to be incompatible with the installation of both Python2 and Python3 and with the use of gdb to debug.

We should remove the setting of the PYTHONPATH environment variable

Assignee: **@vinklein**

CC:  @videlec @embray

Keywords: **PYTHONPATH**

Branch: **[3b9cad2](https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a)**

Reviewer: **Vincent Delecroix**

Author: **Vincent Klein, Volker Braun**

_Issue created by migration from https://trac.sagemath.org/ticket/22608_





---

archive/issue_events_297849.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-03-15T17:58:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297849"
}
```



---

archive/issue_events_297850.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-03-15T17:58:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297850"
}
```



---

archive/issue_events_297851.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-03-15T17:58:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297851"
}
```



---

archive/issue_comments_337856.json:
```json
{
    "body": "Assignee: **@vinklein**",
    "created_at": "2017-03-15T18:58:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337856",
    "user": "https://github.com/vinklein"
}
```

Assignee: **@vinklein**



---

archive/issue_comments_337857.json:
```json
{
    "body": "Changed author from **vklein** to **Vincent Klein**",
    "created_at": "2017-03-15T19:03:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337857",
    "user": "https://github.com/vinklein"
}
```

Changed author from **vklein** to **Vincent Klein**



---

archive/issue_comments_337858.json:
```json
{
    "body": "Branch: **[u/vklein/remove_pythonpath_environment_variable_from_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/remove_pythonpath_environment_variable_from_sage)**",
    "created_at": "2017-03-16T22:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337858",
    "user": "https://github.com/vinklein"
}
```

Branch: **[u/vklein/remove_pythonpath_environment_variable_from_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/remove_pythonpath_environment_variable_from_sage)**



---

archive/issue_events_297852.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-03-16T22:39:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297852"
}
```



---

archive/issue_comments_337859.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nNote to reviewer : the doctest in all.py has been modified. I choose to modify allowed.append(os.path.join(\"lib\", \"python\", \"multiprocessing\")) into allowed.append(os.path.join(\"multiprocessing\")) rather than allowed.append(os.path.join(\"lib\", \"python2.7\", \"multiprocessing\")) in order to stay compatible with future python version. \n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/22e470c2d6941875908f35ff3657843f1fe83f21\">22e470c</a></td><td><code>Remove PYTHONPATH env variable and adapt doctest in all.py</code></td></tr></table>\n",
    "created_at": "2017-03-16T22:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337859",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:5'>Comment 5:</a>
Note to reviewer : the doctest in all.py has been modified. I choose to modify allowed.append(os.path.join("lib", "python", "multiprocessing")) into allowed.append(os.path.join("multiprocessing")) rather than allowed.append(os.path.join("lib", "python2.7", "multiprocessing")) in order to stay compatible with future python version. 

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/22e470c2d6941875908f35ff3657843f1fe83f21">22e470c</a></td><td><code>Remove PYTHONPATH env variable and adapt doctest in all.py</code></td></tr></table>




---

archive/issue_comments_337860.json:
```json
{
    "body": "Commit: **[22e470c](https://github.com/sagemath/sagetrac-mirror/commit/22e470c2d6941875908f35ff3657843f1fe83f21)**",
    "created_at": "2017-03-16T22:39:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337860",
    "user": "https://github.com/vinklein"
}
```

Commit: **[22e470c](https://github.com/sagemath/sagetrac-mirror/commit/22e470c2d6941875908f35ff3657843f1fe83f21)**



---

archive/issue_comments_337861.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nI don't fully understand the impact of this patch or why sage-env was setting `PYTHONPATH` in the first place, so I'm not sure I'm the best to give a review.  But I definitely support this.",
    "created_at": "2017-03-16T23:23:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337861",
    "user": "https://github.com/embray"
}
```

<a id='comment:6'>Comment 6:</a>
I don't fully understand the impact of this patch or why sage-env was setting `PYTHONPATH` in the first place, so I'm not sure I'm the best to give a review.  But I definitely support this.



---

archive/issue_comments_337862.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nI don't understand your changes to `all.py`:\n\n1) What is the reason of this modification? Were the tests failing without it? If not, I would prefer to not touch anything there. You said to \"stay compatible with future Python version\" but did you actually checked this?\n\n2) The aim of `os.path.join` is precisely to *join* several directories and files into a path like\n\n```python\n>>> import os\n>>> os.path.join('my', 'path', 'to', 'my_file.py')\n'my/path/to/my_file.py'\n```\n   if the path would only be one string there is no need to use join\n\n3) If you start touching this, why not modifying at the same time\n\n```\nwallowed = [os.path.join(\"lib\",\"python\",\"threading.py\")]\n```",
    "created_at": "2017-03-17T07:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337862",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'>Comment 7:</a>
I don't understand your changes to `all.py`:

1) What is the reason of this modification? Were the tests failing without it? If not, I would prefer to not touch anything there. You said to "stay compatible with future Python version" but did you actually checked this?

2) The aim of `os.path.join` is precisely to *join* several directories and files into a path like

```python
>>> import os
>>> os.path.join('my', 'path', 'to', 'my_file.py')
'my/path/to/my_file.py'
```
   if the path would only be one string there is no need to use join

3) If you start touching this, why not modifying at the same time

```
wallowed = [os.path.join("lib","python","threading.py")]
```



---

archive/issue_events_297853.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-03-17T07:49:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297853"
}
```



---

archive/issue_events_297854.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-03-17T07:49:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297854"
}
```



---

archive/issue_comments_337863.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\n1) Yes the all.py doctest fail without the modification. If PYTHONPATH is set you get the frames\n\\\\\n<sage_path>/local/lib/python/multiprocessing/process.py\\\\\n\n<sage_path>/local/lib/python/multiprocessing/forking.py\\\\\n\n<sage_path>/local/lib/python/multiprocessing/process.py.\\\\\n\nIf PYTHONPATH is not set you get \\\\\n\n<sage_path>/local/lib/python2.7/multiprocessing/process.py\\\\\n\n<sage_path>/local/lib/python2.7/multiprocessing/forking.py\\\\\n\n<sage_path>/local/lib/python2.7/multiprocessing/process.py instead and the old doctest failed.\n\n2) Ok.\n\n3) Basically because i didn't get a matching frame during my tests but that's the case for several other item's of the allowed list. Should we rewrite this doctest with this ticket ?",
    "created_at": "2017-03-17T09:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337863",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:8'>Comment 8:</a>
1) Yes the all.py doctest fail without the modification. If PYTHONPATH is set you get the frames
\\
<sage_path>/local/lib/python/multiprocessing/process.py\\

<sage_path>/local/lib/python/multiprocessing/forking.py\\

<sage_path>/local/lib/python/multiprocessing/process.py.\\

If PYTHONPATH is not set you get \\

<sage_path>/local/lib/python2.7/multiprocessing/process.py\\

<sage_path>/local/lib/python2.7/multiprocessing/forking.py\\

<sage_path>/local/lib/python2.7/multiprocessing/process.py instead and the old doctest failed.

2) Ok.

3) Basically because i didn't get a matching frame during my tests but that's the case for several other item's of the allowed list. Should we rewrite this doctest with this ticket ?



---

archive/issue_comments_337864.json:
```json
{
    "body": "Changed commit from **[22e470c](https://github.com/sagemath/sagetrac-mirror/commit/22e470c2d6941875908f35ff3657843f1fe83f21)** to **[0834fa0](https://github.com/sagemath/sagetrac-mirror/commit/0834fa019fe89bca422760a565b467070b406b3a)**",
    "created_at": "2017-03-17T10:47:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337864",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[22e470c](https://github.com/sagemath/sagetrac-mirror/commit/22e470c2d6941875908f35ff3657843f1fe83f21)** to **[0834fa0](https://github.com/sagemath/sagetrac-mirror/commit/0834fa019fe89bca422760a565b467070b406b3a)**



---

archive/issue_comments_337865.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0834fa019fe89bca422760a565b467070b406b3a\">0834fa0</a></td><td><code>#all.py allowed.append(os.path.join(\"multiprocessing\")) => allowed.append(\"multiprocessing\")</code></td></tr></table>\n",
    "created_at": "2017-03-17T10:47:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337865",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>Comment 9:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0834fa019fe89bca422760a565b467070b406b3a">0834fa0</a></td><td><code>#all.py allowed.append(os.path.join("multiprocessing")) => allowed.append("multiprocessing")</code></td></tr></table>




---

archive/issue_comments_337866.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nReplying to [@vinklein](#comment%3A8):\n> 1) Yes the all.py doctest fail without the modification. If PYTHONPATH is set you get the frames\n> \n> [...]\n\nThen you would better say it in the ticket description!\n\n> 2) Ok.\n> \n> 3) Basically because i didn't get a matching frame during my tests but that's the case for several other item's of the allowed list. Should we rewrite this doctest with this ticket ?\n\nDefinitely!",
    "created_at": "2017-03-17T11:50:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337866",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'>Comment 10:</a>
Replying to [@vinklein](#comment%3A8):
> 1) Yes the all.py doctest fail without the modification. If PYTHONPATH is set you get the frames
> 
> [...]

Then you would better say it in the ticket description!

> 2) Ok.
> 
> 3) Basically because i didn't get a matching frame during my tests but that's the case for several other item's of the allowed list. Should we rewrite this doctest with this ticket ?

Definitely!



---

archive/issue_comments_337867.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nThere are a handful of other hardcoded local/lib/python/ paths instead of local/lib/pythonx.y/ in the Sage sources; They don't hurt us yet but will sooner or later. Its always good to get rid of it and make no assumptions about where a particular python module resides.",
    "created_at": "2017-03-18T15:42:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337867",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'>Comment 11:</a>
There are a handful of other hardcoded local/lib/python/ paths instead of local/lib/pythonx.y/ in the Sage sources; They don't hurt us yet but will sooner or later. Its always good to get rid of it and make no assumptions about where a particular python module resides.



---

archive/issue_comments_337868.json:
```json
{
    "body": "Changed branch from **[u/vklein/remove_pythonpath_environment_variable_from_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/remove_pythonpath_environment_variable_from_sage)** to **[u/vbraun/remove_pythonpath_environment_variable_from_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/remove_pythonpath_environment_variable_from_sage)**",
    "created_at": "2017-03-18T17:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337868",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vklein/remove_pythonpath_environment_variable_from_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/remove_pythonpath_environment_variable_from_sage)** to **[u/vbraun/remove_pythonpath_environment_variable_from_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/remove_pythonpath_environment_variable_from_sage)**



---

archive/issue_events_297855.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-18T17:19:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297855"
}
```



---

archive/issue_events_297856.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-18T17:19:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297856"
}
```



---

archive/issue_comments_337869.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2d0636df6f7466c12159e235a95f8e6a1f9aa58\">b2d0636</a></td><td><code>Better check for the startup stack frames</code></td></tr></table>\n",
    "created_at": "2017-03-18T17:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337869",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:13'>Comment 13:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2d0636df6f7466c12159e235a95f8e6a1f9aa58">b2d0636</a></td><td><code>Better check for the startup stack frames</code></td></tr></table>




---

archive/issue_comments_337870.json:
```json
{
    "body": "Changed commit from **[0834fa0](https://github.com/sagemath/sagetrac-mirror/commit/0834fa019fe89bca422760a565b467070b406b3a)** to **[b2d0636](https://github.com/sagemath/sagetrac-mirror/commit/b2d0636df6f7466c12159e235a95f8e6a1f9aa58)**",
    "created_at": "2017-03-18T17:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337870",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[0834fa0](https://github.com/sagemath/sagetrac-mirror/commit/0834fa019fe89bca422760a565b467070b406b3a)** to **[b2d0636](https://github.com/sagemath/sagetrac-mirror/commit/b2d0636df6f7466c12159e235a95f8e6a1f9aa58)**



---

archive/issue_comments_337871.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI don't like the ellipsis there. It does not catch the fact that only `generating_series` is there. Only that it is first. For example the following is a perfectly valid doctest\n\n```\n    sage: print \"<mod1 hello>, <mod2 hello>, <mod3 hello>\"\n    <mod1 ...>\n```\nYou should also check the length of `[inspect.getmodule(f) for f in frames if is_not_allowed(f)]`.\n\nBTW, do you know why is this module listed there!?",
    "created_at": "2017-03-18T21:53:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337871",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'>Comment 14:</a>
I don't like the ellipsis there. It does not catch the fact that only `generating_series` is there. Only that it is first. For example the following is a perfectly valid doctest

```
    sage: print "<mod1 hello>, <mod2 hello>, <mod3 hello>"
    <mod1 ...>
```
You should also check the length of `[inspect.getmodule(f) for f in frames if is_not_allowed(f)]`.

BTW, do you know why is this module listed there!?



---

archive/issue_comments_337872.json:
```json
{
    "body": "Changed commit from **[b2d0636](https://github.com/sagemath/sagetrac-mirror/commit/b2d0636df6f7466c12159e235a95f8e6a1f9aa58)** to **[ec259b6](https://github.com/sagemath/sagetrac-mirror/commit/ec259b66d9f6ac91b6190c7640ea347d96630410)**",
    "created_at": "2017-03-18T22:33:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337872",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b2d0636](https://github.com/sagemath/sagetrac-mirror/commit/b2d0636df6f7466c12159e235a95f8e6a1f9aa58)** to **[ec259b6](https://github.com/sagemath/sagetrac-mirror/commit/ec259b66d9f6ac91b6190c7640ea347d96630410)**



---

archive/issue_comments_337873.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec259b66d9f6ac91b6190c7640ea347d96630410\">ec259b6</a></td><td><code>Get rid of ellipsis in test</code></td></tr></table>\n",
    "created_at": "2017-03-18T22:33:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337873",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:15'>Comment 15:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec259b66d9f6ac91b6190c7640ea347d96630410">ec259b6</a></td><td><code>Get rid of ellipsis in test</code></td></tr></table>




---

archive/issue_comments_337874.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nI don't know why generating_series is there, clearly it shouldn't. But thats not the point of this ticket.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec259b66d9f6ac91b6190c7640ea347d96630410\">ec259b6</a></td><td><code>Get rid of ellipsis in test</code></td></tr></table>\n",
    "created_at": "2017-03-18T22:34:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337874",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'>Comment 16:</a>
I don't know why generating_series is there, clearly it shouldn't. But thats not the point of this ticket.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec259b66d9f6ac91b6190c7640ea347d96630410">ec259b6</a></td><td><code>Get rid of ellipsis in test</code></td></tr></table>




---

archive/issue_comments_337875.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nI opened #22647 to track the bad apple...",
    "created_at": "2017-03-19T08:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337875",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'>Comment 17:</a>
I opened #22647 to track the bad apple...



---

archive/issue_comments_337876.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nCode looks good to me, but I feel very weakly qualified, and have no time to test.",
    "created_at": "2017-03-21T20:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337876",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'>Comment 18:</a>
Code looks good to me, but I feel very weakly qualified, and have no time to test.



---

archive/issue_events_297857.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-03-27T16:20:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297857"
}
```



---

archive/issue_events_297858.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-03-27T16:20:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297858"
}
```



---

archive/issue_comments_337877.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2017-03-27T16:20:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337877",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_297859.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-03-27T16:20:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297859"
}
```



---

archive/issue_events_297860.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-03-27T16:20:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297860"
}
```



---

archive/issue_comments_337878.json:
```json
{
    "body": "Changed author from **Vincent Klein** to **Vincent Klein, Volker Braun**",
    "created_at": "2017-03-27T16:20:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337878",
    "user": "https://github.com/videlec"
}
```

Changed author from **Vincent Klein** to **Vincent Klein, Volker Braun**



---

archive/issue_comments_337879.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nBreaks on OSX:\n\n```\nmake -j8 base\nmake[2]: warning: -jN forced in submake: disabling jobserver mode.\nsage-logger -p 'sage-spkg patch-2.7.5' '/Users/buildslave-sage/slave/sage_git/build/logs/pkgs/patch-2.7.5.log'\n[patch-2.7.5] Found local metadata for patch-2.7.5\n[patch-2.7.5] ImportError: No module named site\n[patch-2.7.5] ************************************************************************\n[patch-2.7.5] Error downloading patch-2.7.5.tar.gz\n[patch-2.7.5] ************************************************************************\n[patch-2.7.5] Please email sage-devel (http://groups.google.com/group/sage-devel)\n[patch-2.7.5] explaining the problem and including the log file\n[patch-2.7.5]   /Users/buildslave-sage/slave/sage_git/build/logs/pkgs/patch-2.7.5.log\n[patch-2.7.5] Describe your computer, operating system, etc.\n[patch-2.7.5] ************************************************************************\n```\nShorter test\n\n```\n./sage -p patch\nFound local metadata for patch-2.7.5\nImportError: No module named site\n************************************************************************\nError downloading patch-2.7.5.tar.gz\n************************************************************************\n```",
    "created_at": "2017-04-02T12:12:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337879",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:20'>Comment 20:</a>
Breaks on OSX:

```
make -j8 base
make[2]: warning: -jN forced in submake: disabling jobserver mode.
sage-logger -p 'sage-spkg patch-2.7.5' '/Users/buildslave-sage/slave/sage_git/build/logs/pkgs/patch-2.7.5.log'
[patch-2.7.5] Found local metadata for patch-2.7.5
[patch-2.7.5] ImportError: No module named site
[patch-2.7.5] ************************************************************************
[patch-2.7.5] Error downloading patch-2.7.5.tar.gz
[patch-2.7.5] ************************************************************************
[patch-2.7.5] Please email sage-devel (http://groups.google.com/group/sage-devel)
[patch-2.7.5] explaining the problem and including the log file
[patch-2.7.5]   /Users/buildslave-sage/slave/sage_git/build/logs/pkgs/patch-2.7.5.log
[patch-2.7.5] Describe your computer, operating system, etc.
[patch-2.7.5] ************************************************************************
```
Shorter test

```
./sage -p patch
Found local metadata for patch-2.7.5
ImportError: No module named site
************************************************************************
Error downloading patch-2.7.5.tar.gz
************************************************************************
```



---

archive/issue_events_297861.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-02T12:12:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297861"
}
```



---

archive/issue_events_297862.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-02T12:12:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297862"
}
```



---

archive/issue_comments_337880.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nIn fact its nothing to do with OSX, this kills our ability to call the system python as soon as SAGE_LOCAL is created (which is way sooner in the build process than when we install our own python):\n\n```\nif [ -d \"$SAGE_LOCAL\" ]; then\n    PYTHONHOME=\"$SAGE_LOCAL\"\n    export PYTHONHOME\nfi\n```\nresulting in \n\n```\n$ PYTHONHOME=/foo/bar python\nImportError: No module named site\n```\nIMHO we should just unset PYTHONHOME/PYTHONPATH if they are set (and print a warning that this can't work); Then python will just default to whichever directory is compiled in. The whole PYTHONHOME/PYTHONPATH thing is probably a holdover from the past where we did not clean up paths compiled into binaries.",
    "created_at": "2017-04-02T12:47:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337880",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'>Comment 21:</a>
In fact its nothing to do with OSX, this kills our ability to call the system python as soon as SAGE_LOCAL is created (which is way sooner in the build process than when we install our own python):

```
if [ -d "$SAGE_LOCAL" ]; then
    PYTHONHOME="$SAGE_LOCAL"
    export PYTHONHOME
fi
```
resulting in 

```
$ PYTHONHOME=/foo/bar python
ImportError: No module named site
```
IMHO we should just unset PYTHONHOME/PYTHONPATH if they are set (and print a warning that this can't work); Then python will just default to whichever directory is compiled in. The whole PYTHONHOME/PYTHONPATH thing is probably a holdover from the past where we did not clean up paths compiled into binaries.



---

archive/issue_comments_337881.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a\">3b9cad2</a></td><td><code>Remove PYTHONHOME, too</code></td></tr></table>\n",
    "created_at": "2017-04-02T13:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337881",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:22'>Comment 22:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a">3b9cad2</a></td><td><code>Remove PYTHONHOME, too</code></td></tr></table>




---

archive/issue_comments_337882.json:
```json
{
    "body": "Changed commit from **[ec259b6](https://github.com/sagemath/sagetrac-mirror/commit/ec259b66d9f6ac91b6190c7640ea347d96630410)** to **[3b9cad2](https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a)**",
    "created_at": "2017-04-02T13:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337882",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ec259b6](https://github.com/sagemath/sagetrac-mirror/commit/ec259b66d9f6ac91b6190c7640ea347d96630410)** to **[3b9cad2](https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a)**



---

archive/issue_events_297863.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-02T13:12:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297863"
}
```



---

archive/issue_events_297864.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-02T13:12:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297864"
}
```



---

archive/issue_events_297865.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-04-03T07:03:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297865"
}
```



---

archive/issue_events_297866.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-04-03T07:03:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297866"
}
```



---

archive/issue_comments_337883.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nFine be me.",
    "created_at": "2017-04-03T07:03:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337883",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'>Comment 24:</a>
Fine be me.



---

archive/issue_events_297867.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-05T19:37:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297867"
}
```



---

archive/issue_events_297868.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6281da03a276c1a4826be5f11e89b8c0a7d568fd",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-04-05T19:37:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22608#event-297868"
}
```



---

archive/issue_comments_337884.json:
```json
{
    "body": "Changed branch from **[u/vbraun/remove_pythonpath_environment_variable_from_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/remove_pythonpath_environment_variable_from_sage)** to **[3b9cad2](https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a)**",
    "created_at": "2017-04-05T19:37:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337884",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vbraun/remove_pythonpath_environment_variable_from_sage](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/remove_pythonpath_environment_variable_from_sage)** to **[3b9cad2](https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a)**



---

archive/issue_comments_337885.json:
```json
{
    "body": "Changed commit from **[3b9cad2](https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a)** to none",
    "created_at": "2017-08-11T19:30:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337885",
    "user": "https://github.com/koffie"
}
```

Changed commit from **[3b9cad2](https://github.com/sagemath/sagetrac-mirror/commit/3b9cad2e2459aafd6adbab55b2028efbebda8e7a)** to none



---

archive/issue_comments_337886.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nAfter this ticket the use of `$SAGE_PATH` broke which is still documented so I created the follow up ticket #23614",
    "created_at": "2017-08-11T19:30:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22608",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22608#issuecomment-337886",
    "user": "https://github.com/koffie"
}
```

<a id='comment:26'>Comment 26:</a>
After this ticket the use of `$SAGE_PATH` broke which is still documented so I created the follow up ticket #23614
