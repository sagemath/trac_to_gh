# Issue 22950: combinat/posets/posets.py fails when the optional package dot2tex is installed

archive/issues_022713.json:
```json
{
    "body": "As reported at https://groups.google.com/d/msg/sage-release/UdllnAJFufA/-e8ArqwFBAAJ there is often a failure when\ntesting `combinat/posets/posets.py`\n\n```\nsage -t --long src/sage/combinat/posets/posets.py\n**********************************************************************\nFile \"src/sage/combinat/posets/posets.py\", line 1742, in sage.combinat.posets.posets.FinitePoset.?\nFailed example:\n    L.plot(figsize=12, border=True, element_shape='s',\n           element_size=400, element_color='white',\n           element_colors={'blue': F, 'green': L.double_irreducibles()},\n           cover_color='lightgray', cover_colors={'black': F_internal},\n           title='The Frattini\\nsublattice in blue', fontsize=10)\nException raised:\n\n    Traceback (most recent call last):\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.posets.posets.FinitePoset.?[12]>\", line 5, in <module>\n        title='The Frattini\\nsublattice in blue', fontsize=Integer(10))\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py\", line 1834, in plot\n        **kwds)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 564, in wrapper\n        return func(*args, **options)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18733, in plot\n        return self.graphplot(**options).plot()\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18384, in graphplot\n        return GraphPlot(graph=self, options=options)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py\", line 262, in __init__\n        self.set_pos()\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py\", line 346, in set_pos\n        self._pos = self._graph.layout(**self._options)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 17847, in layout\n        pos = getattr(self, \"layout_%s\"%layout)(dim = dim, **options)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/digraph.py\", line 2915, in layout_acyclic\n        return self.layout_graphviz(rankdir=rankdir, **options)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18315, in layout_graphviz\n        positions = dot2tex.dot2tex(self.graphviz_string(**options), format = \"positions\", prog = prog)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 564, in wrapper\n        return func(*args, **options)\n      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 19532, in graphviz_string\n        \"%s is not a valid format for edge\"%(edge)\n    AssertionError: [0, 4] is not a valid format for edge\n```\nThe failure occurs because `graphviz_string` does not allow edges to be given as lists (exposed by #18545).\n\nCC:  @fchapoton @jm58660 @kevindilks @tscrim\n\nBranch/Commit: 12dc47d5c9f58264e9c3f02dcc108bf7758e0dd8\n\nReviewer: Jori M\u00e4ntysalo\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22950\n\n",
    "closed_at": "2017-05-08T21:18:34Z",
    "created_at": "2017-05-05T02:30:21Z",
    "labels": [
        "component: graphics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "combinat/posets/posets.py fails when the optional package dot2tex is installed",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22950",
    "user": "https://github.com/strogdon"
}
```
As reported at https://groups.google.com/d/msg/sage-release/UdllnAJFufA/-e8ArqwFBAAJ there is often a failure when
testing `combinat/posets/posets.py`

```
sage -t --long src/sage/combinat/posets/posets.py
**********************************************************************
File "src/sage/combinat/posets/posets.py", line 1742, in sage.combinat.posets.posets.FinitePoset.?
Failed example:
    L.plot(figsize=12, border=True, element_shape='s',
           element_size=400, element_color='white',
           element_colors={'blue': F, 'green': L.double_irreducibles()},
           cover_color='lightgray', cover_colors={'black': F_internal},
           title='The Frattini\nsublattice in blue', fontsize=10)
Exception raised:

    Traceback (most recent call last):
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.posets.posets.FinitePoset.?[12]>", line 5, in <module>
        title='The Frattini\nsublattice in blue', fontsize=Integer(10))
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1834, in plot
        **kwds)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 564, in wrapper
        return func(*args, **options)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18733, in plot
        return self.graphplot(**options).plot()
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18384, in graphplot
        return GraphPlot(graph=self, options=options)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py", line 262, in __init__
        self.set_pos()
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py", line 346, in set_pos
        self._pos = self._graph.layout(**self._options)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 17847, in layout
        pos = getattr(self, "layout_%s"%layout)(dim = dim, **options)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/digraph.py", line 2915, in layout_acyclic
        return self.layout_graphviz(rankdir=rankdir, **options)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18315, in layout_graphviz
        positions = dot2tex.dot2tex(self.graphviz_string(**options), format = "positions", prog = prog)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 564, in wrapper
        return func(*args, **options)
      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19532, in graphviz_string
        "%s is not a valid format for edge"%(edge)
    AssertionError: [0, 4] is not a valid format for edge
```
The failure occurs because `graphviz_string` does not allow edges to be given as lists (exposed by #18545).

CC:  @fchapoton @jm58660 @kevindilks @tscrim

Branch/Commit: 12dc47d5c9f58264e9c3f02dcc108bf7758e0dd8

Reviewer: Jori MÃ¤ntysalo

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22950





---

archive/issue_comments_337627.json:
```json
{
    "body": "<a id='comment:1'></a>This was not *caused* by #18545 but instead simply *exposed*.",
    "created_at": "2017-05-05T02:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337627",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>This was not *caused* by #18545 but instead simply *exposed*.



---

archive/issue_comments_337628.json:
```json
{
    "body": "<a id='comment:2'></a>Replying to [comment:1 tscrim]:\n> This was not *caused* by #18545 but instead simply *exposed*.\n\nYes, you are correct.",
    "created_at": "2017-05-05T02:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337628",
    "user": "https://github.com/strogdon"
}
```

<a id='comment:2'></a>Replying to [comment:1 tscrim]:
> This was not *caused* by #18545 but instead simply *exposed*.

Yes, you are correct.



---

archive/issue_comments_337629.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -44,7 +44,7 @@\n         \"%s is not a valid format for edge\"%(edge)\n     AssertionError: [0, 4] is not a valid format for edge\n ```\n-The failure occurs when `dot2tex` has been installed and was probably the result of #18545.\n+The failure occurs when `dot2tex` has been installed and was exposed by #18545.\n \n Comment: 1\n \n```\n",
    "created_at": "2017-05-05T02:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337629",
    "user": "https://github.com/strogdon"
}
```

Description changed:
```diff
--- 
+++ 
@@ -44,7 +44,7 @@
         "%s is not a valid format for edge"%(edge)
     AssertionError: [0, 4] is not a valid format for edge
 ```
-The failure occurs when `dot2tex` has been installed and was probably the result of #18545.
+The failure occurs when `dot2tex` has been installed and was exposed by #18545.
 
 Comment: 1
 
```




---

archive/issue_comments_337630.json:
```json
{
    "body": "<a id='comment:4'></a>That portion of the `L.plot(...)` call that appears to be the problem is `cover_colors={'black': F_internal}`. If it is removed then the `posets.py` test passes even with `dot2tex` installed.",
    "created_at": "2017-05-05T02:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337630",
    "user": "https://github.com/strogdon"
}
```

<a id='comment:4'></a>That portion of the `L.plot(...)` call that appears to be the problem is `cover_colors={'black': F_internal}`. If it is removed then the `posets.py` test passes even with `dot2tex` installed.



---

archive/issue_comments_337631.json:
```json
{
    "body": "<a id='comment:5'></a>Okay, it might not be as simple as exposing a bug but bad input. If I use\n\n```\nF_internal = [(c[0],c[1],None) for c in F.cover_relations() if c in L.cover_relations()]\n```\nthen I can see the plot.",
    "created_at": "2017-05-05T02:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337631",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>Okay, it might not be as simple as exposing a bug but bad input. If I use

```
F_internal = [(c[0],c[1],None) for c in F.cover_relations() if c in L.cover_relations()]
```
then I can see the plot.



---

archive/issue_comments_337632.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,50 @@\n+As reported at https://groups.google.com/d/msg/sage-release/UdllnAJFufA/-e8ArqwFBAAJ there is often a failure when\n+testing `combinat/posets/posets.py`\n \n+```\n+sage -t --long src/sage/combinat/posets/posets.py\n+**********************************************************************\n+File \"src/sage/combinat/posets/posets.py\", line 1742, in sage.combinat.posets.posets.FinitePoset.?\n+Failed example:\n+    L.plot(figsize=12, border=True, element_shape='s',\n+           element_size=400, element_color='white',\n+           element_colors={'blue': F, 'green': L.double_irreducibles()},\n+           cover_color='lightgray', cover_colors={'black': F_internal},\n+           title='The Frattini\\nsublattice in blue', fontsize=10)\n+Exception raised:\n+\n+    Traceback (most recent call last):\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.combinat.posets.posets.FinitePoset.?[12]>\", line 5, in <module>\n+        title='The Frattini\\nsublattice in blue', fontsize=Integer(10))\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py\", line 1834, in plot\n+        **kwds)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 564, in wrapper\n+        return func(*args, **options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18733, in plot\n+        return self.graphplot(**options).plot()\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18384, in graphplot\n+        return GraphPlot(graph=self, options=options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py\", line 262, in __init__\n+        self.set_pos()\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py\", line 346, in set_pos\n+        self._pos = self._graph.layout(**self._options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 17847, in layout\n+        pos = getattr(self, \"layout_%s\"%layout)(dim = dim, **options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/digraph.py\", line 2915, in layout_acyclic\n+        return self.layout_graphviz(rankdir=rankdir, **options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18315, in layout_graphviz\n+        positions = dot2tex.dot2tex(self.graphviz_string(**options), format = \"positions\", prog = prog)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 564, in wrapper\n+        return func(*args, **options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 19532, in graphviz_string\n+        \"%s is not a valid format for edge\"%(edge)\n+    AssertionError: [0, 4] is not a valid format for edge\n+```\n+The failure occurs when `dot2tex` has been installed and was probably the result of #18545.\n \n Comment: 1\n \n```\n",
    "created_at": "2017-05-05T02:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337632",
    "user": "https://github.com/tscrim"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,50 @@
+As reported at https://groups.google.com/d/msg/sage-release/UdllnAJFufA/-e8ArqwFBAAJ there is often a failure when
+testing `combinat/posets/posets.py`
 
+```
+sage -t --long src/sage/combinat/posets/posets.py
+**********************************************************************
+File "src/sage/combinat/posets/posets.py", line 1742, in sage.combinat.posets.posets.FinitePoset.?
+Failed example:
+    L.plot(figsize=12, border=True, element_shape='s',
+           element_size=400, element_color='white',
+           element_colors={'blue': F, 'green': L.double_irreducibles()},
+           cover_color='lightgray', cover_colors={'black': F_internal},
+           title='The Frattini\nsublattice in blue', fontsize=10)
+Exception raised:
+
+    Traceback (most recent call last):
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.combinat.posets.posets.FinitePoset.?[12]>", line 5, in <module>
+        title='The Frattini\nsublattice in blue', fontsize=Integer(10))
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1834, in plot
+        **kwds)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 564, in wrapper
+        return func(*args, **options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18733, in plot
+        return self.graphplot(**options).plot()
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18384, in graphplot
+        return GraphPlot(graph=self, options=options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py", line 262, in __init__
+        self.set_pos()
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py", line 346, in set_pos
+        self._pos = self._graph.layout(**self._options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 17847, in layout
+        pos = getattr(self, "layout_%s"%layout)(dim = dim, **options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/digraph.py", line 2915, in layout_acyclic
+        return self.layout_graphviz(rankdir=rankdir, **options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18315, in layout_graphviz
+        positions = dot2tex.dot2tex(self.graphviz_string(**options), format = "positions", prog = prog)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 564, in wrapper
+        return func(*args, **options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19532, in graphviz_string
+        "%s is not a valid format for edge"%(edge)
+    AssertionError: [0, 4] is not a valid format for edge
+```
+The failure occurs when `dot2tex` has been installed and was probably the result of #18545.
 
 Comment: 1
 
```




---

archive/issue_comments_337633.json:
```json
{
    "body": "<a id='comment:6'></a><self-hatred>It's amazing how useful error messages are...</self-hatred>",
    "created_at": "2017-05-05T02:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337633",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a><self-hatred>It's amazing how useful error messages are...</self-hatred>



---

archive/issue_comments_337634.json:
```json
{
    "body": "<a id='comment:7'></a>Actually, this even works:\n\n```\nsage: F_internal = [tuple(c) for c in F.cover_relations() if c in L.cover_relations()]\n```\nWhich makes sense considering the assertion is checking `assert isinstance(edge, tuple)`. What I suggest is making it also allow `list`.",
    "created_at": "2017-05-05T02:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337634",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>Actually, this even works:

```
sage: F_internal = [tuple(c) for c in F.cover_relations() if c in L.cover_relations()]
```
Which makes sense considering the assertion is checking `assert isinstance(edge, tuple)`. What I suggest is making it also allow `list`.



---

archive/issue_comments_337635.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-05T02:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337635",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_337636.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,50 @@\n+As reported at https://groups.google.com/d/msg/sage-release/UdllnAJFufA/-e8ArqwFBAAJ there is often a failure when\n+testing `combinat/posets/posets.py`\n \n+```\n+sage -t --long src/sage/combinat/posets/posets.py\n+**********************************************************************\n+File \"src/sage/combinat/posets/posets.py\", line 1742, in sage.combinat.posets.posets.FinitePoset.?\n+Failed example:\n+    L.plot(figsize=12, border=True, element_shape='s',\n+           element_size=400, element_color='white',\n+           element_colors={'blue': F, 'green': L.double_irreducibles()},\n+           cover_color='lightgray', cover_colors={'black': F_internal},\n+           title='The Frattini\\nsublattice in blue', fontsize=10)\n+Exception raised:\n+\n+    Traceback (most recent call last):\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.combinat.posets.posets.FinitePoset.?[12]>\", line 5, in <module>\n+        title='The Frattini\\nsublattice in blue', fontsize=Integer(10))\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py\", line 1834, in plot\n+        **kwds)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 564, in wrapper\n+        return func(*args, **options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18733, in plot\n+        return self.graphplot(**options).plot()\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18384, in graphplot\n+        return GraphPlot(graph=self, options=options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py\", line 262, in __init__\n+        self.set_pos()\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py\", line 346, in set_pos\n+        self._pos = self._graph.layout(**self._options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 17847, in layout\n+        pos = getattr(self, \"layout_%s\"%layout)(dim = dim, **options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/digraph.py\", line 2915, in layout_acyclic\n+        return self.layout_graphviz(rankdir=rankdir, **options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 18315, in layout_graphviz\n+        positions = dot2tex.dot2tex(self.graphviz_string(**options), format = \"positions\", prog = prog)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 564, in wrapper\n+        return func(*args, **options)\n+      File \"/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 19532, in graphviz_string\n+        \"%s is not a valid format for edge\"%(edge)\n+    AssertionError: [0, 4] is not a valid format for edge\n+```\n+The failure occurs because `graphviz_string` does not allow edges to be given as lists (exposed by #18545).\n \n Comment: 1\n \n```\n",
    "created_at": "2017-05-05T02:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337636",
    "user": "https://github.com/tscrim"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,50 @@
+As reported at https://groups.google.com/d/msg/sage-release/UdllnAJFufA/-e8ArqwFBAAJ there is often a failure when
+testing `combinat/posets/posets.py`
 
+```
+sage -t --long src/sage/combinat/posets/posets.py
+**********************************************************************
+File "src/sage/combinat/posets/posets.py", line 1742, in sage.combinat.posets.posets.FinitePoset.?
+Failed example:
+    L.plot(figsize=12, border=True, element_shape='s',
+           element_size=400, element_color='white',
+           element_colors={'blue': F, 'green': L.double_irreducibles()},
+           cover_color='lightgray', cover_colors={'black': F_internal},
+           title='The Frattini\nsublattice in blue', fontsize=10)
+Exception raised:
+
+    Traceback (most recent call last):
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.combinat.posets.posets.FinitePoset.?[12]>", line 5, in <module>
+        title='The Frattini\nsublattice in blue', fontsize=Integer(10))
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1834, in plot
+        **kwds)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 564, in wrapper
+        return func(*args, **options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18733, in plot
+        return self.graphplot(**options).plot()
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18384, in graphplot
+        return GraphPlot(graph=self, options=options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py", line 262, in __init__
+        self.set_pos()
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py", line 346, in set_pos
+        self._pos = self._graph.layout(**self._options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 17847, in layout
+        pos = getattr(self, "layout_%s"%layout)(dim = dim, **options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/digraph.py", line 2915, in layout_acyclic
+        return self.layout_graphviz(rankdir=rankdir, **options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 18315, in layout_graphviz
+        positions = dot2tex.dot2tex(self.graphviz_string(**options), format = "positions", prog = prog)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 564, in wrapper
+        return func(*args, **options)
+      File "/usr/local/sage-8/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 19532, in graphviz_string
+        "%s is not a valid format for edge"%(edge)
+    AssertionError: [0, 4] is not a valid format for edge
+```
+The failure occurs because `graphviz_string` does not allow edges to be given as lists (exposed by #18545).
 
 Comment: 1
 
```




---

archive/issue_comments_337637.json:
```json
{
    "body": "<a id='comment:8'></a>Here's a branch with a MWE as a doctest.\n\n---\nNew commits:",
    "created_at": "2017-05-05T02:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337637",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>Here's a branch with a MWE as a doctest.

---
New commits:



---

archive/issue_comments_337638.json:
```json
{
    "body": "<a id='comment:9'></a>I can check this.",
    "created_at": "2017-05-05T04:07:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337638",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:9'></a>I can check this.



---

archive/issue_comments_337639.json:
```json
{
    "body": "<a id='comment:10'></a>Works. Thanks!",
    "created_at": "2017-05-05T04:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337639",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:10'></a>Works. Thanks!



---

archive/issue_comments_337640.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-05T04:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337640",
    "user": "https://github.com/jm58660"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_337641.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-08T21:18:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22950#issuecomment-337641",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_059507.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-08T21:18:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22950",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22950#event-59507"
}
```
