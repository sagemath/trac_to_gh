# Issue 22493: upgrade to MPIR-3.0.0

archive/issues_022256.json:
```json
{
    "body": "New upstream version\n\n    http://mpir.org/mpir-3.0.0.tar.bz2\n\nThis new version requires [yasm](http://yasm.tortall.net/) for assembler code.\n\nDepends on #22748\n\n**CC:**  @mkoeppe @jdemeyer @vbraun @kiwifb\n\n**Keywords:** days84\n\n**Branch:** [01c90970e9fe648a9374cd02be24c3d6d8da3dab](https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab)\n\n**Reviewer:** Fran\u00e7ois Bissey, Dima Pasechnik\n\n**Author:** Vincent Delecroix, Jean-Pierre Flori\n\nIssue created by migration from https://trac.sagemath.org/ticket/22493\n\n",
    "closed_at": "2017-05-26T21:28:05Z",
    "created_at": "2017-03-02T15:48:58Z",
    "labels": [
        "component: packages: standard",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.6",
    "title": "upgrade to MPIR-3.0.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/22493",
    "user": "https://github.com/videlec"
}
```
New upstream version

    http://mpir.org/mpir-3.0.0.tar.bz2

This new version requires [yasm](http://yasm.tortall.net/) for assembler code.

Depends on #22748

**CC:**  @mkoeppe @jdemeyer @vbraun @kiwifb

**Keywords:** days84

**Branch:** [01c90970e9fe648a9374cd02be24c3d6d8da3dab](https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab)

**Reviewer:** François Bissey, Dima Pasechnik

**Author:** Vincent Delecroix, Jean-Pierre Flori

Issue created by migration from https://trac.sagemath.org/ticket/22493





---

archive/issue_comments_335518.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n New upstream version\n \n     http://mpir.org/mpir-3.0.0.tar.bz2\n+\n+This new version requires [yasm](http://yasm.tortall.net/) for assembler code.\n``````\n",
    "created_at": "2017-03-02T15:55:17Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335518",
    "user": "https://github.com/videlec"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 New upstream version
 
     http://mpir.org/mpir-3.0.0.tar.bz2
+
+This new version requires [yasm](http://yasm.tortall.net/) for assembler code.
``````




---

archive/issue_comments_335519.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739\">f68bc8e</a></td><td><code>upgrade mpir to 3-0-0</code></td></tr></table>\n",
    "created_at": "2017-03-02T15:57:15Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335519",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739">f68bc8e</a></td><td><code>upgrade mpir to 3-0-0</code></td></tr></table>




---

archive/issue_comments_335520.json:
```json
{
    "body": "**Branch:** [public/22493](https://github.com/sagemath/sagetrac-mirror/tree/public/22493)",
    "created_at": "2017-03-02T15:57:15Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335520",
    "user": "https://github.com/videlec"
}
```

**Branch:** [public/22493](https://github.com/sagemath/sagetrac-mirror/tree/public/22493)



---

archive/issue_comments_335521.json:
```json
{
    "body": "**Commit:** [f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739](https://github.com/sagemath/sagetrac-mirror/commit/f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739)",
    "created_at": "2017-03-02T15:57:15Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335521",
    "user": "https://github.com/videlec"
}
```

**Commit:** [f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739](https://github.com/sagemath/sagetrac-mirror/commit/f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739)



---

archive/issue_comments_335522.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"days84\".",
    "created_at": "2017-03-02T15:57:47Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335522",
    "user": "https://github.com/videlec"
}
```

**Changing keywords** from "" to "days84".



---

archive/issue_comments_335523.json:
```json
{
    "body": "<a id='comment:4'></a>\nI suppose the documentation should mention dependence on yasm.\n(The version on the yasm's website appears to be 1.3, same as on a couple of Linux\nmachines I checked, so that's matter of doing `apt-get install yasm` or something like this. Although on `arando` buildbot it's 1.2, not 1.3, and so something would have to be done to such older systems).",
    "created_at": "2017-03-03T10:21:54Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335523",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
I suppose the documentation should mention dependence on yasm.
(The version on the yasm's website appears to be 1.3, same as on a couple of Linux
machines I checked, so that's matter of doing `apt-get install yasm` or something like this. Although on `arando` buildbot it's 1.2, not 1.3, and so something would have to be done to such older systems).



---

archive/issue_comments_335524.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [@dimpase](#comment%3A4):\n> I suppose the documentation should mention dependence on yasm.\n> (The version on the yasm's website appears to be 1.3, same as on a couple of Linux\n> machines I checked, so that's matter of doing `apt-get install yasm` or something like this. Although on `arando` buildbot it's 1.2, not 1.3, and so something would have to be done to such older systems).\n\nDima, do we need yasm 1.3 to compile MPIR 3.0.0? Building MPIR on arando would fail?",
    "created_at": "2017-03-03T11:56:44Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335524",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
Replying to [@dimpase](#comment%3A4):
> I suppose the documentation should mention dependence on yasm.
> (The version on the yasm's website appears to be 1.3, same as on a couple of Linux
> machines I checked, so that's matter of doing `apt-get install yasm` or something like this. Although on `arando` buildbot it's 1.2, not 1.3, and so something would have to be done to such older systems).

Dima, do we need yasm 1.3 to compile MPIR 3.0.0? Building MPIR on arando would fail?



---

archive/issue_comments_335525.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [@videlec](#comment%3A5):\n> do we need yasm 1.3 to compile MPIR 3.0.0? Building MPIR on arando would fail?\n\nBull writes in no uncertain terms that you need the latest version of yasm.\nAs 1.2 is almost 6 years old, I imagine that on new CPUs there could be problems, as the  code for the CPU won't compile.\n\narando has old CPU, more that 6 years old in fact, and I just checked that there MPIR compiles and passes all its checks (with system's gcc 6.2 and yasm 1.2).",
    "created_at": "2017-03-03T12:23:20Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335525",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
Replying to [@videlec](#comment%3A5):
> do we need yasm 1.3 to compile MPIR 3.0.0? Building MPIR on arando would fail?

Bull writes in no uncertain terms that you need the latest version of yasm.
As 1.2 is almost 6 years old, I imagine that on new CPUs there could be problems, as the  code for the CPU won't compile.

arando has old CPU, more that 6 years old in fact, and I just checked that there MPIR compiles and passes all its checks (with system's gcc 6.2 and yasm 1.2).



---

archive/issue_comments_335526.json:
```json
{
    "body": "<a id='comment:7'></a>\nWe decided to remove the inlcuded yasm form mpir sources.\nThat was the only sane thing to do... so Sage needs to ship it separately or we make it a build dependency.",
    "created_at": "2017-03-14T13:06:05Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335526",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:7'></a>
We decided to remove the inlcuded yasm form mpir sources.
That was the only sane thing to do... so Sage needs to ship it separately or we make it a build dependency.



---

archive/issue_comments_335527.json:
```json
{
    "body": "<a id='comment:8'></a>\n`@`vincent: do you plan on modifying this ticket to include yasm?",
    "created_at": "2017-04-03T11:42:43Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335527",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:8'></a>
`@`vincent: do you plan on modifying this ticket to include yasm?



---

archive/issue_comments_335528.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [jpflori](#comment%3A8):\n> `@`vincent: do you plan on modifying this ticket to include yasm?\n\nNope. Would better be a dependency ticket.",
    "created_at": "2017-04-03T11:44:58Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335528",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>
Replying to [jpflori](#comment%3A8):
> `@`vincent: do you plan on modifying this ticket to include yasm?

Nope. Would better be a dependency ticket.



---

archive/issue_comments_335529.json:
```json
{
    "body": "<a id='comment:10'></a>\nSee #22748 for yasm",
    "created_at": "2017-04-03T11:46:01Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335529",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>
See #22748 for yasm



---

archive/issue_comments_335530.json:
```json
{
    "body": "**Dependencies:** #22748",
    "created_at": "2017-04-03T11:46:01Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335530",
    "user": "https://github.com/videlec"
}
```

**Dependencies:** #22748



---

archive/issue_comments_335531.json:
```json
{
    "body": "**Changing commit** from \"[f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739](https://github.com/sagemath/sagetrac-mirror/commit/f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739)\" to \"[16058efed507d1c8137c8500f87730b0c56d9fee](https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee)\".",
    "created_at": "2017-04-25T16:47:48Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335531",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739](https://github.com/sagemath/sagetrac-mirror/commit/f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739)" to "[16058efed507d1c8137c8500f87730b0c56d9fee](https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee)".



---

archive/issue_comments_335532.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d16afb5a818876936c1b22bc80edf4b0275088b\">8d16afb</a></td><td><code>Merge remote-tracking branch 'trac/develop' into mpir300</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d723dcf5455ff95d40bfc24a11779efd69589aa\">4d723dc</a></td><td><code>Add yasm as a standard package.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f365fcfb9b89eeb43d0b0982d9c8ae48ba98f00\">0f365fc</a></td><td><code>Merge branch 'yasm130' into mpir300</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee\">16058ef</a></td><td><code>Add build time yasm dependency to mpir.</code></td></tr></table>\n",
    "created_at": "2017-04-25T16:47:48Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335532",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d16afb5a818876936c1b22bc80edf4b0275088b">8d16afb</a></td><td><code>Merge remote-tracking branch 'trac/develop' into mpir300</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d723dcf5455ff95d40bfc24a11779efd69589aa">4d723dc</a></td><td><code>Add yasm as a standard package.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f365fcfb9b89eeb43d0b0982d9c8ae48ba98f00">0f365fc</a></td><td><code>Merge branch 'yasm130' into mpir300</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee">16058ef</a></td><td><code>Add build time yasm dependency to mpir.</code></td></tr></table>




---

archive/issue_events_200801.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-04-25T16:48:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200801"
}
```



---

archive/issue_comments_335533.json:
```json
{
    "body": "**Changing author** from \"Vincent Delecroix\" to \"Vincent Delecroix, Jean-Pierre Flori\".",
    "created_at": "2017-04-25T16:48:23Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335533",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

**Changing author** from "Vincent Delecroix" to "Vincent Delecroix, Jean-Pierre Flori".



---

archive/issue_comments_335534.json:
```json
{
    "body": "<a id='comment:12'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d16afb5a818876936c1b22bc80edf4b0275088b\">8d16afb</a></td><td><code>Merge remote-tracking branch 'trac/develop' into mpir300</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d723dcf5455ff95d40bfc24a11779efd69589aa\">4d723dc</a></td><td><code>Add yasm as a standard package.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f365fcfb9b89eeb43d0b0982d9c8ae48ba98f00\">0f365fc</a></td><td><code>Merge branch 'yasm130' into mpir300</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee\">16058ef</a></td><td><code>Add build time yasm dependency to mpir.</code></td></tr></table>\n",
    "created_at": "2017-04-25T16:48:23Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335534",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:12'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d16afb5a818876936c1b22bc80edf4b0275088b">8d16afb</a></td><td><code>Merge remote-tracking branch 'trac/develop' into mpir300</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d723dcf5455ff95d40bfc24a11779efd69589aa">4d723dc</a></td><td><code>Add yasm as a standard package.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f365fcfb9b89eeb43d0b0982d9c8ae48ba98f00">0f365fc</a></td><td><code>Merge branch 'yasm130' into mpir300</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee">16058ef</a></td><td><code>Add build time yasm dependency to mpir.</code></td></tr></table>




---

archive/issue_comments_335535.json:
```json
{
    "body": "<a id='comment:13'></a>\nSeems to work fine for me.",
    "created_at": "2017-04-26T12:58:13Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335535",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:13'></a>
Seems to work fine for me.



---

archive/issue_comments_335536.json:
```json
{
    "body": "<a id='comment:14'></a>\nthis and #22748 seem to work on clang/FreeBSD.",
    "created_at": "2017-04-27T00:04:33Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335536",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>
this and #22748 seem to work on clang/FreeBSD.



---

archive/issue_comments_335537.json:
```json
{
    "body": "<a id='comment:15'></a>\nGood to go in?",
    "created_at": "2017-04-28T07:25:00Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335537",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:15'></a>
Good to go in?



---

archive/issue_comments_335538.json:
```json
{
    "body": "<a id='comment:16'></a>\nYes.",
    "created_at": "2017-04-28T07:30:54Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335538",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:16'></a>
Yes.



---

archive/issue_comments_335539.json:
```json
{
    "body": "<a id='comment:17'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3057c797a3230875c26cf2dc4117e61cdd07ecda\">3057c79</a></td><td><code>Add configure check for yasm</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6377eaeea02655d3238b1ab389fd236d9d42e988\">6377eae</a></td><td><code>upgrade mpir to 3-0-0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c39a193b70b7d0e32f690b307dcccf3c123374d1\">c39a193</a></td><td><code>Add build time yasm dependency to mpir.</code></td></tr></table>\n",
    "created_at": "2017-04-28T12:17:19Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335539",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3057c797a3230875c26cf2dc4117e61cdd07ecda">3057c79</a></td><td><code>Add configure check for yasm</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6377eaeea02655d3238b1ab389fd236d9d42e988">6377eae</a></td><td><code>upgrade mpir to 3-0-0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c39a193b70b7d0e32f690b307dcccf3c123374d1">c39a193</a></td><td><code>Add build time yasm dependency to mpir.</code></td></tr></table>




---

archive/issue_comments_335540.json:
```json
{
    "body": "**Changing commit** from \"[16058efed507d1c8137c8500f87730b0c56d9fee](https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee)\" to \"[c39a193b70b7d0e32f690b307dcccf3c123374d1](https://github.com/sagemath/sagetrac-mirror/commit/c39a193b70b7d0e32f690b307dcccf3c123374d1)\".",
    "created_at": "2017-04-28T12:17:19Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335540",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[16058efed507d1c8137c8500f87730b0c56d9fee](https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee)" to "[c39a193b70b7d0e32f690b307dcccf3c123374d1](https://github.com/sagemath/sagetrac-mirror/commit/c39a193b70b7d0e32f690b307dcccf3c123374d1)".



---

archive/issue_comments_335541.json:
```json
{
    "body": "<a id='comment:18'></a>\nIs that a positive review?",
    "created_at": "2017-05-04T07:43:28Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335541",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>
Is that a positive review?



---

archive/issue_comments_335542.json:
```json
{
    "body": "<a id='comment:19'></a>\nI would say so!",
    "created_at": "2017-05-04T08:53:47Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335542",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:19'></a>
I would say so!



---

archive/issue_comments_335543.json:
```json
{
    "body": "**Reviewer:** Fran\u00e7ois Bissey",
    "created_at": "2017-05-04T09:52:31Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335543",
    "user": "https://github.com/kiwifb"
}
```

**Reviewer:** François Bissey



---

archive/issue_comments_335544.json:
```json
{
    "body": "<a id='comment:20'></a>\nAnd of we go....",
    "created_at": "2017-05-04T09:52:31Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335544",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:20'></a>
And of we go....



---

archive/issue_events_200802.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-05-04T09:52:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200802"
}
```



---

archive/issue_events_200803.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-05-04T09:52:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200803"
}
```



---

archive/issue_comments_335545.json:
```json
{
    "body": "<a id='comment:21'></a>\nOn Debian 7 64-bit: http://build.sagedev.org/#/builders/80/builds/1/steps/5/logs/stdio\n\n```\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c nextprime.c  -fPIC -DPIC -o .libs/nextprime.o\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c nextprime.c -o nextprime.o >/dev/null 2>&1\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c primesieve.c -o primesieve.o >/dev/null 2>&1\n[mpir-3.0.0] /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -D__GMP_WITHIN_GMP   -m64 -O2 -march=corei7-avx -mtune=corei7-avx  -g  -c -o version.lo version.c\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c version.c  -fPIC -DPIC -o .libs/version.o\n[mpir-3.0.0] /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -D__GMP_WITHIN_GMP   -m64 -O2 -march=corei7-avx -mtune=corei7-avx  -g  -c -o tal-reent.lo tal-reent.c\n[mpir-3.0.0] make[6]: *** No rule to make target `mpn/addmul_1.lo', needed by `libmpir.la'.\n[mpir-3.0.0] make[6]: *** No rule to make target `mpn/mul_basecase.lo', needed by `libmpir.la'.\n[mpir-3.0.0] make[6]: *** No rule to make target `mpn/sqr_basecase.lo', needed by `libmpir.la'.\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c version.c -o version.o >/dev/null 2>&1\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c tal-reent.c  -fPIC -DPIC -o .libs/tal-reent.o\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c tal-reent.c -o tal-reent.o >/dev/null 2>&1\n[mpir-3.0.0] /bin/bash ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.  -D__GMP_WITHIN_GMP   -m64 -O2 -march=corei7-avx -mtune=corei7-avx  -g  -c -o cxx/dummy.lo cxx/dummy.cc\n[mpir-3.0.0] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c cxx/dummy.cc  -fPIC -DPIC -o cxx/.libs/dummy.o\n[mpir-3.0.0] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c cxx/dummy.cc -o cxx/dummy.o >/dev/null 2>&1\n[mpir-3.0.0] make[6]: Target `all-am' not remade because of errors.\n[mpir-3.0.0] make[6]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'\n[mpir-3.0.0] make[5]: *** [all-recursive] Error 1\n[mpir-3.0.0] make[5]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'\n[mpir-3.0.0] make[4]: *** [all] Error 2\n[mpir-3.0.0] make[4]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'\n[mpir-3.0.0] Error building MPIR.\n```",
    "created_at": "2017-05-06T21:43:16Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335545",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'></a>
On Debian 7 64-bit: http://build.sagedev.org/#/builders/80/builds/1/steps/5/logs/stdio

```
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c nextprime.c  -fPIC -DPIC -o .libs/nextprime.o
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c nextprime.c -o nextprime.o >/dev/null 2>&1
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c primesieve.c -o primesieve.o >/dev/null 2>&1
[mpir-3.0.0] /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -D__GMP_WITHIN_GMP   -m64 -O2 -march=corei7-avx -mtune=corei7-avx  -g  -c -o version.lo version.c
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c version.c  -fPIC -DPIC -o .libs/version.o
[mpir-3.0.0] /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.  -D__GMP_WITHIN_GMP   -m64 -O2 -march=corei7-avx -mtune=corei7-avx  -g  -c -o tal-reent.lo tal-reent.c
[mpir-3.0.0] make[6]: *** No rule to make target `mpn/addmul_1.lo', needed by `libmpir.la'.
[mpir-3.0.0] make[6]: *** No rule to make target `mpn/mul_basecase.lo', needed by `libmpir.la'.
[mpir-3.0.0] make[6]: *** No rule to make target `mpn/sqr_basecase.lo', needed by `libmpir.la'.
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c version.c -o version.o >/dev/null 2>&1
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c tal-reent.c  -fPIC -DPIC -o .libs/tal-reent.o
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c tal-reent.c -o tal-reent.o >/dev/null 2>&1
[mpir-3.0.0] /bin/bash ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.  -D__GMP_WITHIN_GMP   -m64 -O2 -march=corei7-avx -mtune=corei7-avx  -g  -c -o cxx/dummy.lo cxx/dummy.cc
[mpir-3.0.0] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c cxx/dummy.cc  -fPIC -DPIC -o cxx/.libs/dummy.o
[mpir-3.0.0] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c cxx/dummy.cc -o cxx/dummy.o >/dev/null 2>&1
[mpir-3.0.0] make[6]: Target `all-am' not remade because of errors.
[mpir-3.0.0] make[6]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'
[mpir-3.0.0] make[5]: *** [all-recursive] Error 1
[mpir-3.0.0] make[5]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'
[mpir-3.0.0] make[4]: *** [all] Error 2
[mpir-3.0.0] make[4]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'
[mpir-3.0.0] Error building MPIR.
```



---

archive/issue_events_200804.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-06T21:43:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200804"
}
```



---

archive/issue_events_200805.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-06T21:43:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200805"
}
```



---

archive/issue_comments_335546.json:
```json
{
    "body": "<a id='comment:23'></a>\nHum\n\n```\n[mpir-3.0.0] libtool: compile:  ../mpn/m4-ccas --m4=m4 gcc -c -DHAVE_CONFIG_H -D__GMP_WITHIN_GMP -I.. -DOPERATION_addmul_1 -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -I. -I.. addmul_1.asm  -fPIC -DPIC -o .libs/addmul_1.o\n[mpir-3.0.0] m4  -DHAVE_CONFIG_H -D__GMP_WITHIN_GMP -DOPERATION_addmul_1 -DPIC addmul_1.asm >tmp-addmul_1.s\n[mpir-3.0.0]  gcc -c -DHAVE_CONFIG_H -D__GMP_WITHIN_GMP -I.. -DOPERATION_addmul_1 -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -I. -I.. tmp-addmul_1.s -fPIC -DPIC -o .libs/addmul_1.o\n[mpir-3.0.0] libtool: compile:  ../strip_fPIC.sh /home/buildbot/slave/sage_git/build/local/bin/yasm -I .. -f elf64 submul_1.as  -fPIC -DPIC -o .libs/submul_1.o\n[mpir-3.0.0] /home/buildbot/slave/sage_git/build/local/bin/yasm -I .. -f elf64 submul_1.as -D PIC -o .libs/submul_1.o\n[mpir-3.0.0] libtool: compile:  ../strip_fPIC.sh /home/buildbot/slave/sage_git/build/local/bin/yasm -I .. -f elf64 submul_1.as -o submul_1.o >/dev/null 2>&1\n[mpir-3.0.0] tmp-addmul_1.s: Assembler messages:\n[mpir-3.0.0] tmp-addmul_1.s:152: Error: no such instruction: `adox (%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:154: Error: no such instruction: `adox %rcx,%rax'\n[mpir-3.0.0] tmp-addmul_1.s:166: Error: no such instruction: `adox -8(%rdi),%r10'\n[mpir-3.0.0] tmp-addmul_1.s:167: Error: no such instruction: `adcx %r8,%r9'\n[mpir-3.0.0] tmp-addmul_1.s:171: Error: no such instruction: `adox (%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:174: Error: no such instruction: `adcx %rax,%r10'\n[mpir-3.0.0] tmp-addmul_1.s:176: Error: no such instruction: `adcx %r8,%r9'\n[mpir-3.0.0] tmp-addmul_1.s:177: Error: no such instruction: `adox 8(%rdi),%r10'\n[mpir-3.0.0] tmp-addmul_1.s:181: Error: no such instruction: `adcx %rax,%r10'\n[mpir-3.0.0] tmp-addmul_1.s:182: Error: no such instruction: `adox 16(%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:185: Error: no such instruction: `adox 24(%rdi),%r10'\n[mpir-3.0.0] tmp-addmul_1.s:186: Error: no such instruction: `adcx %r8,%r9'\n[mpir-3.0.0] tmp-addmul_1.s:189: Error: no such instruction: `adcx %rax,%r10'\n[mpir-3.0.0] tmp-addmul_1.s:190: Error: no such instruction: `adox 32(%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:193: Error: no such instruction: `adox 40(%rdi),%r10'\n[mpir-3.0.0] tmp-addmul_1.s:194: Error: no such instruction: `adcx %r8,%r9'\n[mpir-3.0.0] tmp-addmul_1.s:196: Error: no such instruction: `adox 48(%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:200: Error: no such instruction: `adcx %rax,%r10'\n[mpir-3.0.0] make[6]: *** [addmul_1.lo] Error 1\n```",
    "created_at": "2017-05-06T21:51:12Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335546",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'></a>
Hum

```
[mpir-3.0.0] libtool: compile:  ../mpn/m4-ccas --m4=m4 gcc -c -DHAVE_CONFIG_H -D__GMP_WITHIN_GMP -I.. -DOPERATION_addmul_1 -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -I. -I.. addmul_1.asm  -fPIC -DPIC -o .libs/addmul_1.o
[mpir-3.0.0] m4  -DHAVE_CONFIG_H -D__GMP_WITHIN_GMP -DOPERATION_addmul_1 -DPIC addmul_1.asm >tmp-addmul_1.s
[mpir-3.0.0]  gcc -c -DHAVE_CONFIG_H -D__GMP_WITHIN_GMP -I.. -DOPERATION_addmul_1 -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -I. -I.. tmp-addmul_1.s -fPIC -DPIC -o .libs/addmul_1.o
[mpir-3.0.0] libtool: compile:  ../strip_fPIC.sh /home/buildbot/slave/sage_git/build/local/bin/yasm -I .. -f elf64 submul_1.as  -fPIC -DPIC -o .libs/submul_1.o
[mpir-3.0.0] /home/buildbot/slave/sage_git/build/local/bin/yasm -I .. -f elf64 submul_1.as -D PIC -o .libs/submul_1.o
[mpir-3.0.0] libtool: compile:  ../strip_fPIC.sh /home/buildbot/slave/sage_git/build/local/bin/yasm -I .. -f elf64 submul_1.as -o submul_1.o >/dev/null 2>&1
[mpir-3.0.0] tmp-addmul_1.s: Assembler messages:
[mpir-3.0.0] tmp-addmul_1.s:152: Error: no such instruction: `adox (%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:154: Error: no such instruction: `adox %rcx,%rax'
[mpir-3.0.0] tmp-addmul_1.s:166: Error: no such instruction: `adox -8(%rdi),%r10'
[mpir-3.0.0] tmp-addmul_1.s:167: Error: no such instruction: `adcx %r8,%r9'
[mpir-3.0.0] tmp-addmul_1.s:171: Error: no such instruction: `adox (%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:174: Error: no such instruction: `adcx %rax,%r10'
[mpir-3.0.0] tmp-addmul_1.s:176: Error: no such instruction: `adcx %r8,%r9'
[mpir-3.0.0] tmp-addmul_1.s:177: Error: no such instruction: `adox 8(%rdi),%r10'
[mpir-3.0.0] tmp-addmul_1.s:181: Error: no such instruction: `adcx %rax,%r10'
[mpir-3.0.0] tmp-addmul_1.s:182: Error: no such instruction: `adox 16(%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:185: Error: no such instruction: `adox 24(%rdi),%r10'
[mpir-3.0.0] tmp-addmul_1.s:186: Error: no such instruction: `adcx %r8,%r9'
[mpir-3.0.0] tmp-addmul_1.s:189: Error: no such instruction: `adcx %rax,%r10'
[mpir-3.0.0] tmp-addmul_1.s:190: Error: no such instruction: `adox 32(%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:193: Error: no such instruction: `adox 40(%rdi),%r10'
[mpir-3.0.0] tmp-addmul_1.s:194: Error: no such instruction: `adcx %r8,%r9'
[mpir-3.0.0] tmp-addmul_1.s:196: Error: no such instruction: `adox 48(%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:200: Error: no such instruction: `adcx %rax,%r10'
[mpir-3.0.0] make[6]: *** [addmul_1.lo] Error 1
```



---

archive/issue_comments_335547.json:
```json
{
    "body": "<a id='comment:24'></a>\nhttp://stackoverflow.com/questions/29747508/what-is-the-difference-between-the-adc-and-adcx-instructions-on-ia32-ia64 \nI'd say we have a misdetection of the hardware or the assmebler used by gcc doesn't support those instructions.",
    "created_at": "2017-05-06T23:36:10Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335547",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:24'></a>
http://stackoverflow.com/questions/29747508/what-is-the-difference-between-the-adc-and-adcx-instructions-on-ia32-ia64 
I'd say we have a misdetection of the hardware or the assmebler used by gcc doesn't support those instructions.



---

archive/issue_comments_335548.json:
```json
{
    "body": "<a id='comment:25'></a>\nI'd say the assembler is yasm.",
    "created_at": "2017-05-10T13:26:19Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335548",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:25'></a>
I'd say the assembler is yasm.



---

archive/issue_comments_335549.json:
```json
{
    "body": "<a id='comment:26'></a>\nCan't seem to get any info from the (terrible) buildbot pages...\nSeems like a wrong arch choice by MPIR configure script.",
    "created_at": "2017-05-10T13:45:24Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335549",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:26'></a>
Can't seem to get any info from the (terrible) buildbot pages...
Seems like a wrong arch choice by MPIR configure script.



---

archive/issue_events_200806.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-05-10T14:03:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200806"
}
```



---

archive/issue_events_200807.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-05-10T14:03:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200807"
}
```



---

archive/issue_comments_335550.json:
```json
{
    "body": "<a id='comment:28'></a>\nThe error message is from as, not yasm:\n\n```\n$ strings local/bin/yasm  | grep such\n$ strings /usr/bin/as  | grep such\nno such architecture modifier: `%s'\nbroadcast is needed for operand of such type\nno such architecture: `%s'\nno such instruction: `%s'\n```\nUnless yasm calls as somewhere under the hood, though I don't think thats the case...",
    "created_at": "2017-05-14T08:43:31Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335550",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:28'></a>
The error message is from as, not yasm:

```
$ strings local/bin/yasm  | grep such
$ strings /usr/bin/as  | grep such
no such architecture modifier: `%s'
broadcast is needed for operand of such type
no such architecture: `%s'
no such instruction: `%s'
```
Unless yasm calls as somewhere under the hood, though I don't think thats the case...



---

archive/issue_comments_335551.json:
```json
{
    "body": "<a id='comment:29'></a>\nI.e. the error comes from \n\n```\ngcc -c -DHAVE_CONFIG_H -D__GMP_WITHIN_GMP -I.. -DOPERATION_addmul_1 -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -I. -I.. tmp-addmul_1.s -fPIC -DPIC -o .libs/addmul_1.o\n```\nwhich does not use yasm.",
    "created_at": "2017-05-14T08:46:02Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335551",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:29'></a>
I.e. the error comes from 

```
gcc -c -DHAVE_CONFIG_H -D__GMP_WITHIN_GMP -I.. -DOPERATION_addmul_1 -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -I. -I.. tmp-addmul_1.s -fPIC -DPIC -o .libs/addmul_1.o
```
which does not use yasm.



---

archive/issue_comments_335552.json:
```json
{
    "body": "<a id='comment:30'></a>\nOk, that's right.\nMPIR uses yasm or not based on the file extension.\n\nMaybe the error is just because as on debian 7 is just too old?",
    "created_at": "2017-05-14T19:38:32Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335552",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:30'></a>
Ok, that's right.
MPIR uses yasm or not based on the file extension.

Maybe the error is just because as on debian 7 is just too old?



---

archive/issue_comments_335553.json:
```json
{
    "body": "<a id='comment:31'></a>\nCannot reproduce this on an unstable debian with the exact same command lines.",
    "created_at": "2017-05-15T12:45:38Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335553",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:31'></a>
Cannot reproduce this on an unstable debian with the exact same command lines.



---

archive/issue_comments_335554.json:
```json
{
    "body": "<a id='comment:32'></a>\nI would say as is indeed too old.\nThe problematic file is:\n* https://github.com/wbhart/mpir/blob/master/mpn/x86_64/skylake/avx/addmul_1.asm\nusing adcx/adox instructions.\nThese were added in a post july 2012 as release:\n* https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;a=commit;h=e2e1fcde622f2f6cedfd7fb6615aa6e136f21dec\nAnd debian wheezy ships binutils 2.22 which is pre-2012:\n* https://ftp.gnu.org/gnu/binutils/\n\nSo can we ignore this very outdated OS?\nIt's a Debian old stable, so quite very old...",
    "created_at": "2017-05-15T12:55:41Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335554",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:32'></a>
I would say as is indeed too old.
The problematic file is:
* https://github.com/wbhart/mpir/blob/master/mpn/x86_64/skylake/avx/addmul_1.asm
using adcx/adox instructions.
These were added in a post july 2012 as release:
* https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;a=commit;h=e2e1fcde622f2f6cedfd7fb6615aa6e136f21dec
And debian wheezy ships binutils 2.22 which is pre-2012:
* https://ftp.gnu.org/gnu/binutils/

So can we ignore this very outdated OS?
It's a Debian old stable, so quite very old...



---

archive/issue_comments_335555.json:
```json
{
    "body": "<a id='comment:33'></a>\nOne could argue that wheezy has LTS till may 2018:\n* https://www.debian.org/releases/wheezy/",
    "created_at": "2017-05-15T12:58:23Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335555",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:33'></a>
One could argue that wheezy has LTS till may 2018:
* https://www.debian.org/releases/wheezy/



---

archive/issue_comments_335556.json:
```json
{
    "body": "<a id='comment:34'></a>\nHow would the version of binutils matter? Isn't the asm code meant to be compiled with an up to date yasm installed by Sage?",
    "created_at": "2017-05-15T13:23:06Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335556",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>
How would the version of binutils matter? Isn't the asm code meant to be compiled with an up to date yasm installed by Sage?



---

archive/issue_comments_335557.json:
```json
{
    "body": "<a id='comment:35'></a>\nNope, some assembly files are compiled with yasm, others with as...",
    "created_at": "2017-05-15T13:25:44Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335557",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:35'></a>
Nope, some assembly files are compiled with yasm, others with as...



---

archive/issue_comments_335558.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [jpflori](#comment%3A35):\n> Nope, some assembly files are compiled with yasm, others with as...\n\nOK, so we either have to tell the users to upgrade binutils to something meaningful, or ship our own `gas`...",
    "created_at": "2017-05-15T13:28:41Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335558",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:36'></a>
Replying to [jpflori](#comment%3A35):
> Nope, some assembly files are compiled with yasm, others with as...

OK, so we either have to tell the users to upgrade binutils to something meaningful, or ship our own `gas`...



---

archive/issue_comments_335559.json:
```json
{
    "body": "<a id='comment:37'></a>\nNot so many users whould use a pre-2012 `gas`...\nWe can also forbid the use of assembly when `gas` is too old.\nThat's the best solution I have in mind to please the patchbot running Debian 7.",
    "created_at": "2017-05-15T13:34:36Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335559",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:37'></a>
Not so many users whould use a pre-2012 `gas`...
We can also forbid the use of assembly when `gas` is too old.
That's the best solution I have in mind to please the patchbot running Debian 7.



---

archive/issue_comments_335560.json:
```json
{
    "body": "**Changing commit** from \"[c39a193b70b7d0e32f690b307dcccf3c123374d1](https://github.com/sagemath/sagetrac-mirror/commit/c39a193b70b7d0e32f690b307dcccf3c123374d1)\" to \"[9573e155b79a719db84d0ea2d2842abb7885d84e](https://github.com/sagemath/sagetrac-mirror/commit/9573e155b79a719db84d0ea2d2842abb7885d84e)\".",
    "created_at": "2017-05-15T15:34:18Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335560",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c39a193b70b7d0e32f690b307dcccf3c123374d1](https://github.com/sagemath/sagetrac-mirror/commit/c39a193b70b7d0e32f690b307dcccf3c123374d1)" to "[9573e155b79a719db84d0ea2d2842abb7885d84e](https://github.com/sagemath/sagetrac-mirror/commit/9573e155b79a719db84d0ea2d2842abb7885d84e)".



---

archive/issue_comments_335561.json:
```json
{
    "body": "<a id='comment:38'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739\">f68bc8e</a></td><td><code>upgrade mpir to 3-0-0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8d16afb5a818876936c1b22bc80edf4b0275088b\">8d16afb</a></td><td><code>Merge remote-tracking branch 'trac/develop' into mpir300</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f365fcfb9b89eeb43d0b0982d9c8ae48ba98f00\">0f365fc</a></td><td><code>Merge branch 'yasm130' into mpir300</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee\">16058ef</a></td><td><code>Add build time yasm dependency to mpir.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/357103ac48fc1e10d55e1fae2c5a07c43858a2de\">357103a</a></td><td><code>Merge branch 'public/22493' of git://trac.sagemath.org/sage into mpir300</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ddc2f11aa9af630b0e5873bb93bceb3c0e571c2\">8ddc2f1</a></td><td><code>MPIR 3.0.0 does not build yasm anymore.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8205366bd4bfe78b25781533622d7633e8376454\">8205366</a></td><td><code>But MPIR always looks for it even on archs where it is not used.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9573e155b79a719db84d0ea2d2842abb7885d84e\">9573e15</a></td><td><code>Check GNU as version when building MPIR.</code></td></tr></table>\n",
    "created_at": "2017-05-15T15:34:18Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335561",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f68bc8ea0bcfc6d9ed6c72bbeb94e08aff527739">f68bc8e</a></td><td><code>upgrade mpir to 3-0-0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8d16afb5a818876936c1b22bc80edf4b0275088b">8d16afb</a></td><td><code>Merge remote-tracking branch 'trac/develop' into mpir300</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f365fcfb9b89eeb43d0b0982d9c8ae48ba98f00">0f365fc</a></td><td><code>Merge branch 'yasm130' into mpir300</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16058efed507d1c8137c8500f87730b0c56d9fee">16058ef</a></td><td><code>Add build time yasm dependency to mpir.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/357103ac48fc1e10d55e1fae2c5a07c43858a2de">357103a</a></td><td><code>Merge branch 'public/22493' of git://trac.sagemath.org/sage into mpir300</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ddc2f11aa9af630b0e5873bb93bceb3c0e571c2">8ddc2f1</a></td><td><code>MPIR 3.0.0 does not build yasm anymore.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8205366bd4bfe78b25781533622d7633e8376454">8205366</a></td><td><code>But MPIR always looks for it even on archs where it is not used.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9573e155b79a719db84d0ea2d2842abb7885d84e">9573e15</a></td><td><code>Check GNU as version when building MPIR.</code></td></tr></table>




---

archive/issue_events_200808.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-05-15T15:35:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200808"
}
```



---

archive/issue_events_200809.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-05-15T15:35:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200809"
}
```



---

archive/issue_comments_335562.json:
```json
{
    "body": "**Changing commit** from \"[9573e155b79a719db84d0ea2d2842abb7885d84e](https://github.com/sagemath/sagetrac-mirror/commit/9573e155b79a719db84d0ea2d2842abb7885d84e)\" to \"[cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf](https://github.com/sagemath/sagetrac-mirror/commit/cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf)\".",
    "created_at": "2017-05-15T15:39:10Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335562",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9573e155b79a719db84d0ea2d2842abb7885d84e](https://github.com/sagemath/sagetrac-mirror/commit/9573e155b79a719db84d0ea2d2842abb7885d84e)" to "[cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf](https://github.com/sagemath/sagetrac-mirror/commit/cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf)".



---

archive/issue_comments_335563.json:
```json
{
    "body": "<a id='comment:40'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf\">cb8a3f7</a></td><td><code>Echo comment when skipping yasm check.</code></td></tr></table>\n",
    "created_at": "2017-05-15T15:39:10Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335563",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf">cb8a3f7</a></td><td><code>Echo comment when skipping yasm check.</code></td></tr></table>




---

archive/issue_comments_335564.json:
```json
{
    "body": "**Changing commit** from \"[cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf](https://github.com/sagemath/sagetrac-mirror/commit/cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf)\" to \"[aa0b222388e27db40c9da7e5a91da4f08401c854](https://github.com/sagemath/sagetrac-mirror/commit/aa0b222388e27db40c9da7e5a91da4f08401c854)\".",
    "created_at": "2017-05-15T15:41:25Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335564",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf](https://github.com/sagemath/sagetrac-mirror/commit/cb8a3f7beeb1fd57d9a7ce3180bffad7f78867cf)" to "[aa0b222388e27db40c9da7e5a91da4f08401c854](https://github.com/sagemath/sagetrac-mirror/commit/aa0b222388e27db40c9da7e5a91da4f08401c854)".



---

archive/issue_comments_335565.json:
```json
{
    "body": "<a id='comment:41'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa0b222388e27db40c9da7e5a91da4f08401c854\">aa0b222</a></td><td><code>This should work and be useful on non-linux systems.</code></td></tr></table>\n",
    "created_at": "2017-05-15T15:41:25Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335565",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa0b222388e27db40c9da7e5a91da4f08401c854">aa0b222</a></td><td><code>This should work and be useful on non-linux systems.</code></td></tr></table>




---

archive/issue_comments_335566.json:
```json
{
    "body": "<a id='comment:42'></a>\nIt would be nice to get this into Sage 8.0.",
    "created_at": "2017-05-16T08:48:19Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335566",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:42'></a>
It would be nice to get this into Sage 8.0.



---

archive/issue_events_200810.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-05-16T09:11:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200810"
}
```



---

archive/issue_events_200811.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-05-16T09:11:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200811"
}
```



---

archive/issue_comments_335567.json:
```json
{
    "body": "<a id='comment:43'></a>\nOK, sorry for the delay. It looks OK to me. It will work on all the systems we officially support.\n\nFor the records if you are in that kind of trivia `uname -m` is not portable (but is OK across the platform we support so no need to change). For bonus points, can you tell me what kind of system I am testing here\n\n```\n[xcat1-c][/]> uname -m\n00F6B2734C00\n```",
    "created_at": "2017-05-16T09:11:41Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335567",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:43'></a>
OK, sorry for the delay. It looks OK to me. It will work on all the systems we officially support.

For the records if you are in that kind of trivia `uname -m` is not portable (but is OK across the platform we support so no need to change). For bonus points, can you tell me what kind of system I am testing here

```
[xcat1-c][/]> uname -m
00F6B2734C00
```



---

archive/issue_comments_335568.json:
```json
{
    "body": "<a id='comment:44'></a>\n\n```\n-bash-4.3$ uname -m\n00F84C0C4C00\n```",
    "created_at": "2017-05-16T09:47:30Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335568",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:44'></a>

```
-bash-4.3$ uname -m
00F84C0C4C00
```



---

archive/issue_comments_335569.json:
```json
{
    "body": "<a id='comment:45'></a>\nShould have known you'd have access to one of those too.",
    "created_at": "2017-05-16T09:49:11Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335569",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:45'></a>
Should have known you'd have access to one of those too.



---

archive/issue_comments_335570.json:
```json
{
    "body": "<a id='comment:46'></a>\nOn FreeBSD with clang this does not work, as it misidentifies the compiler as gcc and then trips over itself. Does it work with clang on OSX?",
    "created_at": "2017-05-16T20:11:53Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335570",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:46'></a>
On FreeBSD with clang this does not work, as it misidentifies the compiler as gcc and then trips over itself. Does it work with clang on OSX?



---

archive/issue_comments_335571.json:
```json
{
    "body": "<a id='comment:47'></a>\nI haven't tried yet I must say. Can you post a log so I can see how it trips itself? It'll probably be quicker for me to try on linux+clang actually.",
    "created_at": "2017-05-16T21:09:14Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335571",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:47'></a>
I haven't tried yet I must say. Can you post a log so I can see how it trips itself? It'll probably be quicker for me to try on linux+clang actually.



---

archive/issue_comments_335572.json:
```json
{
    "body": "<a id='comment:48'></a>\nReplying to [@kiwifb](#comment%3A47):\n> I haven't tried yet I must say. Can you post a log so I can see how it trips itself? It'll probably be quicker for me to try on linux+clang actually.\n\nit actually works on FreeBSD/clang, sorry for noise. I used wrong C++ compiler, with `clang++-devel` it works like a charm.",
    "created_at": "2017-05-16T21:36:11Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335572",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:48'></a>
Replying to [@kiwifb](#comment%3A47):
> I haven't tried yet I must say. Can you post a log so I can see how it trips itself? It'll probably be quicker for me to try on linux+clang actually.

it actually works on FreeBSD/clang, sorry for noise. I used wrong C++ compiler, with `clang++-devel` it works like a charm.



---

archive/issue_comments_335573.json:
```json
{
    "body": "<a id='comment:49'></a>\nI just finished building `mpir` on linux+clang without a hitch either.",
    "created_at": "2017-05-16T21:37:55Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335573",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:49'></a>
I just finished building `mpir` on linux+clang without a hitch either.



---

archive/issue_events_200812.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-17T19:38:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200812"
}
```



---

archive/issue_events_200813.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-17T19:38:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200813"
}
```



---

archive/issue_comments_335574.json:
```json
{
    "body": "<a id='comment:50'></a>\nnow fails with\n\n```\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c version.c  -fPIC -DPIC -o .libs/version.o\n[mpir-3.0.0] make[6]: *** No rule to make target `mpn/addmul_1.lo', needed by `libmpir.la'.\n[mpir-3.0.0] make[6]: *** No rule to make target `mpn/mul_basecase.lo', needed by `libmpir.la'.\n[mpir-3.0.0] make[6]: *** No rule to make target `mpn/sqr_basecase.lo', needed by `libmpir.la'.\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c tal-reent.c  -fPIC -DPIC -o .libs/tal-reent.o\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c version.c -o version.o >/dev/null 2>&1\n[mpir-3.0.0] /bin/bash ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.  -D__GMP_WITHIN_GMP   -m64 -O2 -march=corei7-avx -mtune=corei7-avx  -g  -c -o cxx/dummy.lo cxx/dummy.cc\n[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c tal-reent.c -o tal-reent.o >/dev/null 2>&1\n[mpir-3.0.0] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c cxx/dummy.cc  -fPIC -DPIC -o cxx/.libs/dummy.o\n[mpir-3.0.0] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c cxx/dummy.cc -o cxx/dummy.o >/dev/null 2>&1\n[mpir-3.0.0] make[6]: Target `all-am' not remade because of errors.\n[mpir-3.0.0] make[6]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'\n[mpir-3.0.0] make[5]: *** [all-recursive] Error 1\n[mpir-3.0.0] make[5]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'\n[mpir-3.0.0] make[4]: *** [all] Error 2\n[mpir-3.0.0] make[4]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'\n[mpir-3.0.0] Error building MPIR.\n```\non Debian 7.\nhttp://build.sagedev.org/#/builders/80/builds/5/steps/5/logs/stdio",
    "created_at": "2017-05-17T19:38:03Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335574",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:50'></a>
now fails with

```
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c version.c  -fPIC -DPIC -o .libs/version.o
[mpir-3.0.0] make[6]: *** No rule to make target `mpn/addmul_1.lo', needed by `libmpir.la'.
[mpir-3.0.0] make[6]: *** No rule to make target `mpn/mul_basecase.lo', needed by `libmpir.la'.
[mpir-3.0.0] make[6]: *** No rule to make target `mpn/sqr_basecase.lo', needed by `libmpir.la'.
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c tal-reent.c  -fPIC -DPIC -o .libs/tal-reent.o
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c version.c -o version.o >/dev/null 2>&1
[mpir-3.0.0] /bin/bash ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I.  -D__GMP_WITHIN_GMP   -m64 -O2 -march=corei7-avx -mtune=corei7-avx  -g  -c -o cxx/dummy.lo cxx/dummy.cc
[mpir-3.0.0] libtool: compile:  gcc -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c tal-reent.c -o tal-reent.o >/dev/null 2>&1
[mpir-3.0.0] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c cxx/dummy.cc  -fPIC -DPIC -o cxx/.libs/dummy.o
[mpir-3.0.0] libtool: compile:  g++ -DHAVE_CONFIG_H -I. -D__GMP_WITHIN_GMP -m64 -O2 -march=corei7-avx -mtune=corei7-avx -g -c cxx/dummy.cc -o cxx/dummy.o >/dev/null 2>&1
[mpir-3.0.0] make[6]: Target `all-am' not remade because of errors.
[mpir-3.0.0] make[6]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'
[mpir-3.0.0] make[5]: *** [all-recursive] Error 1
[mpir-3.0.0] make[5]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'
[mpir-3.0.0] make[4]: *** [all] Error 2
[mpir-3.0.0] make[4]: Leaving directory `/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/mpir-3.0.0/src'
[mpir-3.0.0] Error building MPIR.
```
on Debian 7.
http://build.sagedev.org/#/builders/80/builds/5/steps/5/logs/stdio



---

archive/issue_comments_335575.json:
```json
{
    "body": "<a id='comment:51'></a>\nDebian 7 again :/",
    "created_at": "2017-05-17T21:47:47Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335575",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:51'></a>
Debian 7 again :/



---

archive/issue_comments_335576.json:
```json
{
    "body": "<a id='comment:52'></a>\nLooks like the fix didn't work\n\n```\n[mpir-3.0.0] tmp-addmul_1.s: Assembler messages:\n[mpir-3.0.0] tmp-addmul_1.s:152: Error: no such instruction: `adox (%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:154: Error: no such instruction: `adox %rcx,%rax'\n[mpir-3.0.0] tmp-addmul_1.s:166: Error: no such instruction: `adox -8(%rdi),%r10'\n[mpir-3.0.0] tmp-addmul_1.s:167: Error: no such instruction: `adcx %r8,%r9'\n[mpir-3.0.0] tmp-addmul_1.s:171: Error: no such instruction: `adox (%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:174: Error: no such instruction: `adcx %rax,%r10'\n[mpir-3.0.0] tmp-addmul_1.s:176: Error: no such instruction: `adcx %r8,%r9'\n[mpir-3.0.0] tmp-addmul_1.s:177: Error: no such instruction: `adox 8(%rdi),%r10'\n[mpir-3.0.0] tmp-addmul_1.s:181: Error: no such instruction: `adcx %rax,%r10'\n[mpir-3.0.0] tmp-addmul_1.s:182: Error: no such instruction: `adox 16(%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:185: Error: no such instruction: `adox 24(%rdi),%r10'\n[mpir-3.0.0] tmp-addmul_1.s:186: Error: no such instruction: `adcx %r8,%r9'\n[mpir-3.0.0] tmp-addmul_1.s:189: Error: no such instruction: `adcx %rax,%r10'\n[mpir-3.0.0] tmp-addmul_1.s:190: Error: no such instruction: `adox 32(%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:193: Error: no such instruction: `adox 40(%rdi),%r10'\n[mpir-3.0.0] tmp-addmul_1.s:194: Error: no such instruction: `adcx %r8,%r9'\n[mpir-3.0.0] tmp-addmul_1.s:196: Error: no such instruction: `adox 48(%rdi),%r9'\n[mpir-3.0.0] tmp-addmul_1.s:200: Error: no such instruction: `adcx %rax,%r10'\n[mpir-3.0.0] /bin/bash ../libtool --mode=compile --tag=CC ../strip_fPIC.sh /home/buildbot/slave/sage_git/build/local/bin/yasm -I .. -f elf64  -o lshift.lo `test -f 'lshift.as' || echo './'`lshift.as\n[mpir-3.0.0] make[6]: *** [addmul_1.lo] Error 1\n```\nback to the drawing board.",
    "created_at": "2017-05-17T21:51:43Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335576",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:52'></a>
Looks like the fix didn't work

```
[mpir-3.0.0] tmp-addmul_1.s: Assembler messages:
[mpir-3.0.0] tmp-addmul_1.s:152: Error: no such instruction: `adox (%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:154: Error: no such instruction: `adox %rcx,%rax'
[mpir-3.0.0] tmp-addmul_1.s:166: Error: no such instruction: `adox -8(%rdi),%r10'
[mpir-3.0.0] tmp-addmul_1.s:167: Error: no such instruction: `adcx %r8,%r9'
[mpir-3.0.0] tmp-addmul_1.s:171: Error: no such instruction: `adox (%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:174: Error: no such instruction: `adcx %rax,%r10'
[mpir-3.0.0] tmp-addmul_1.s:176: Error: no such instruction: `adcx %r8,%r9'
[mpir-3.0.0] tmp-addmul_1.s:177: Error: no such instruction: `adox 8(%rdi),%r10'
[mpir-3.0.0] tmp-addmul_1.s:181: Error: no such instruction: `adcx %rax,%r10'
[mpir-3.0.0] tmp-addmul_1.s:182: Error: no such instruction: `adox 16(%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:185: Error: no such instruction: `adox 24(%rdi),%r10'
[mpir-3.0.0] tmp-addmul_1.s:186: Error: no such instruction: `adcx %r8,%r9'
[mpir-3.0.0] tmp-addmul_1.s:189: Error: no such instruction: `adcx %rax,%r10'
[mpir-3.0.0] tmp-addmul_1.s:190: Error: no such instruction: `adox 32(%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:193: Error: no such instruction: `adox 40(%rdi),%r10'
[mpir-3.0.0] tmp-addmul_1.s:194: Error: no such instruction: `adcx %r8,%r9'
[mpir-3.0.0] tmp-addmul_1.s:196: Error: no such instruction: `adox 48(%rdi),%r9'
[mpir-3.0.0] tmp-addmul_1.s:200: Error: no such instruction: `adcx %rax,%r10'
[mpir-3.0.0] /bin/bash ../libtool --mode=compile --tag=CC ../strip_fPIC.sh /home/buildbot/slave/sage_git/build/local/bin/yasm -I .. -f elf64  -o lshift.lo `test -f 'lshift.as' || echo './'`lshift.as
[mpir-3.0.0] make[6]: *** [addmul_1.lo] Error 1
```
back to the drawing board.



---

archive/issue_comments_335577.json:
```json
{
    "body": "<a id='comment:53'></a>\nHum, I did not actually test on a debian 7 seven, I just looked at what GNU as version is provided there and thought I ound the issue.\nSo several possibilities:\n* I'm stupid,\n* the check for as version I implemented is wrong,\n* the issue is somewhere else.\n\nThe easiest way to solve this would be to get access to the machine...\nI downloaded a bunch of qemu debian 7 images but the pc I mostly work on does not have internet access and these images come wihtout gnu as :/",
    "created_at": "2017-05-17T21:55:27Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335577",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:53'></a>
Hum, I did not actually test on a debian 7 seven, I just looked at what GNU as version is provided there and thought I ound the issue.
So several possibilities:
* I'm stupid,
* the check for as version I implemented is wrong,
* the issue is somewhere else.

The easiest way to solve this would be to get access to the machine...
I downloaded a bunch of qemu debian 7 images but the pc I mostly work on does not have internet access and these images come wihtout gnu as :/



---

archive/issue_comments_335578.json:
```json
{
    "body": "<a id='comment:54'></a>\nI think the as version check is correct but `\"$CC\" = GCC` is always false unless you really go out of your way to rename gcc...",
    "created_at": "2017-05-17T22:21:35Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335578",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:54'></a>
I think the as version check is correct but `"$CC" = GCC` is always false unless you really go out of your way to rename gcc...



---

archive/issue_comments_335579.json:
```json
{
    "body": "<a id='comment:55'></a>\nPS:\n\n```\nbuildbot@sagebd07_64s02:~$ as --version | head -1 | awk 'NF>1{print $NF}'\n2.22\n```",
    "created_at": "2017-05-17T22:22:04Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335579",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:55'></a>
PS:

```
buildbot@sagebd07_64s02:~$ as --version | head -1 | awk 'NF>1{print $NF}'
2.22
```



---

archive/issue_comments_335580.json:
```json
{
    "body": "<a id='comment:56'></a>\nReplying to [@vbraun](#comment%3A54):\n> I think the as version check is correct but `\"$CC\" = GCC` is always false unless you really go out of your way to rename gcc...\n\nYou are probably right. It is not a correct way to ascertain that `CC` is `gcc`, you'd have to look at `$CC -v` or similar. Considering the only other possibility is `clang`  during toolchain building on OS X and that\n\n```\nMirage:~ fbissey$ as --version | head -1 | awk 'NF>1{print $NF}'\n(clang-802.0.42)\n```\nwon't be caught by your `case` statement, I think we can just scrap the `$CC=GCC` bit.",
    "created_at": "2017-05-17T22:35:52Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335580",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:56'></a>
Replying to [@vbraun](#comment%3A54):
> I think the as version check is correct but `"$CC" = GCC` is always false unless you really go out of your way to rename gcc...

You are probably right. It is not a correct way to ascertain that `CC` is `gcc`, you'd have to look at `$CC -v` or similar. Considering the only other possibility is `clang`  during toolchain building on OS X and that

```
Mirage:~ fbissey$ as --version | head -1 | awk 'NF>1{print $NF}'
(clang-802.0.42)
```
won't be caught by your `case` statement, I think we can just scrap the `$CC=GCC` bit.



---

archive/issue_comments_335581.json:
```json
{
    "body": "<a id='comment:57'></a>\nArgh, Now I see why I had started a bit of my answer differently. If you are worried about using clang on linux, which is in the future so far, we'll do it when it become possible. Using an output from configure preferably (I currently output a variable `IS_CLANG` in `sage-env-config` and that's much more reliable).",
    "created_at": "2017-05-17T22:40:47Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335581",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:57'></a>
Argh, Now I see why I had started a bit of my answer differently. If you are worried about using clang on linux, which is in the future so far, we'll do it when it become possible. Using an output from configure preferably (I currently output a variable `IS_CLANG` in `sage-env-config` and that's much more reliable).



---

archive/issue_comments_335582.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [jpflori](#comment%3A35):\n> Nope, some assembly files are compiled with yasm, others with as...\n\nAre we sure that this is an upstream *feature*? It seems strange to me...",
    "created_at": "2017-05-18T08:09:56Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335582",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:58'></a>
Replying to [jpflori](#comment%3A35):
> Nope, some assembly files are compiled with yasm, others with as...

Are we sure that this is an upstream *feature*? It seems strange to me...



---

archive/issue_comments_335583.json:
```json
{
    "body": "<a id='comment:59'></a>\nYes it is.\nOne of the former developer prefered ATT syntax over intel (or the other way around) and that was not very well supported by gas at that time, don't know the current situation.\nMoreover yasm provides better windows support with stack dark magic unwinding feature.\n\nFiles are treated by yasm or gas depending on their extension (as or asm).",
    "created_at": "2017-05-18T08:14:22Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335583",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:59'></a>
Yes it is.
One of the former developer prefered ATT syntax over intel (or the other way around) and that was not very well supported by gas at that time, don't know the current situation.
Moreover yasm provides better windows support with stack dark magic unwinding feature.

Files are treated by yasm or gas depending on their extension (as or asm).



---

archive/issue_comments_335584.json:
```json
{
    "body": "<a id='comment:60'></a>\nReplying to [@vbraun](#comment%3A54):\n> I think the as version check is correct but `\"$CC\" = GCC` is always false unless you really go out of your way to rename gcc...\n\nOops!",
    "created_at": "2017-05-18T08:17:56Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335584",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:60'></a>
Replying to [@vbraun](#comment%3A54):
> I think the as version check is correct but `"$CC" = GCC` is always false unless you really go out of your way to rename gcc...

Oops!



---

archive/issue_comments_335585.json:
```json
{
    "body": "**Changing commit** from \"[aa0b222388e27db40c9da7e5a91da4f08401c854](https://github.com/sagemath/sagetrac-mirror/commit/aa0b222388e27db40c9da7e5a91da4f08401c854)\" to \"[fea0baea54a96d7ae74193295f3fb8620cf0d83e](https://github.com/sagemath/sagetrac-mirror/commit/fea0baea54a96d7ae74193295f3fb8620cf0d83e)\".",
    "created_at": "2017-05-18T08:21:39Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335585",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[aa0b222388e27db40c9da7e5a91da4f08401c854](https://github.com/sagemath/sagetrac-mirror/commit/aa0b222388e27db40c9da7e5a91da4f08401c854)" to "[fea0baea54a96d7ae74193295f3fb8620cf0d83e](https://github.com/sagemath/sagetrac-mirror/commit/fea0baea54a96d7ae74193295f3fb8620cf0d83e)".



---

archive/issue_comments_335586.json:
```json
{
    "body": "<a id='comment:61'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7467913b56d7ac5deefb7bd3abc0b9ed62265b6d\">7467913</a></td><td><code>Upgrade to libpng-1.6.28</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61ff9185f4c44732e9a3063b812406e00dd02a6a\">61ff918</a></td><td><code>Merge remote-tracking branch 'trac/u/jdemeyer/upgrade_to_latest_libpng' into libpng1629</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa28f4cba1d7589b5b3bd970311981c5fb9bf04d\">aa28f4c</a></td><td><code>Bump to libpng 1.6.29.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be90134ceefadee47a54bb070afb386642e78cbc\">be90134</a></td><td><code>Merge remote-tracking branch 'trac/public/22493' into mpir300</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fea0baea54a96d7ae74193295f3fb8620cf0d83e\">fea0bae</a></td><td><code>Remove useless gcc check when looking for old as.</code></td></tr></table>\n",
    "created_at": "2017-05-18T08:21:39Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335586",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:61'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7467913b56d7ac5deefb7bd3abc0b9ed62265b6d">7467913</a></td><td><code>Upgrade to libpng-1.6.28</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61ff9185f4c44732e9a3063b812406e00dd02a6a">61ff918</a></td><td><code>Merge remote-tracking branch 'trac/u/jdemeyer/upgrade_to_latest_libpng' into libpng1629</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa28f4cba1d7589b5b3bd970311981c5fb9bf04d">aa28f4c</a></td><td><code>Bump to libpng 1.6.29.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be90134ceefadee47a54bb070afb386642e78cbc">be90134</a></td><td><code>Merge remote-tracking branch 'trac/public/22493' into mpir300</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fea0baea54a96d7ae74193295f3fb8620cf0d83e">fea0bae</a></td><td><code>Remove useless gcc check when looking for old as.</code></td></tr></table>




---

archive/issue_comments_335587.json:
```json
{
    "body": "<a id='comment:62'></a>\nArgh, I merged unrelated stuff.",
    "created_at": "2017-05-18T08:22:13Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335587",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:62'></a>
Argh, I merged unrelated stuff.



---

archive/issue_comments_335588.json:
```json
{
    "body": "**Changing commit** from \"[fea0baea54a96d7ae74193295f3fb8620cf0d83e](https://github.com/sagemath/sagetrac-mirror/commit/fea0baea54a96d7ae74193295f3fb8620cf0d83e)\" to \"[c9eaefcc84a3f4473b30d93d697d684135d69d6c](https://github.com/sagemath/sagetrac-mirror/commit/c9eaefcc84a3f4473b30d93d697d684135d69d6c)\".",
    "created_at": "2017-05-18T08:24:21Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335588",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fea0baea54a96d7ae74193295f3fb8620cf0d83e](https://github.com/sagemath/sagetrac-mirror/commit/fea0baea54a96d7ae74193295f3fb8620cf0d83e)" to "[c9eaefcc84a3f4473b30d93d697d684135d69d6c](https://github.com/sagemath/sagetrac-mirror/commit/c9eaefcc84a3f4473b30d93d697d684135d69d6c)".



---

archive/issue_comments_335589.json:
```json
{
    "body": "<a id='comment:63'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c9eaefcc84a3f4473b30d93d697d684135d69d6c\">c9eaefc</a></td><td><code>Remove useless gcc check when looking for old as.</code></td></tr></table>\n",
    "created_at": "2017-05-18T08:24:21Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335589",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:63'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c9eaefcc84a3f4473b30d93d697d684135d69d6c">c9eaefc</a></td><td><code>Remove useless gcc check when looking for old as.</code></td></tr></table>




---

archive/issue_events_200814.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-05-18T08:25:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200814"
}
```



---

archive/issue_events_200815.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-05-18T08:25:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200815"
}
```



---

archive/issue_events_200816.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-05-18T08:51:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200816"
}
```



---

archive/issue_events_200817.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-05-18T08:51:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200817"
}
```



---

archive/issue_comments_335590.json:
```json
{
    "body": "<a id='comment:65'></a>\nOnce again to the bots.",
    "created_at": "2017-05-18T08:51:36Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335590",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:65'></a>
Once again to the bots.



---

archive/issue_events_200818.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-19T22:09:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200818"
}
```



---

archive/issue_events_200819.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-19T22:09:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200819"
}
```



---

archive/issue_comments_335591.json:
```json
{
    "body": "<a id='comment:66'></a>\n\n```\n[mpir-3.0.0] ./spkg-install: line 168: as_version: command not found\n```\nIn bash you can't have a space before the equal sign in assignment...",
    "created_at": "2017-05-19T22:09:54Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335591",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:66'></a>

```
[mpir-3.0.0] ./spkg-install: line 168: as_version: command not found
```
In bash you can't have a space before the equal sign in assignment...



---

archive/issue_comments_335592.json:
```json
{
    "body": "**Changing commit** from \"[c9eaefcc84a3f4473b30d93d697d684135d69d6c](https://github.com/sagemath/sagetrac-mirror/commit/c9eaefcc84a3f4473b30d93d697d684135d69d6c)\" to \"[01c90970e9fe648a9374cd02be24c3d6d8da3dab](https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab)\".",
    "created_at": "2017-05-22T11:48:28Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335592",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c9eaefcc84a3f4473b30d93d697d684135d69d6c](https://github.com/sagemath/sagetrac-mirror/commit/c9eaefcc84a3f4473b30d93d697d684135d69d6c)" to "[01c90970e9fe648a9374cd02be24c3d6d8da3dab](https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab)".



---

archive/issue_comments_335593.json:
```json
{
    "body": "<a id='comment:67'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab\">01c9097</a></td><td><code>Remove broken spaces.</code></td></tr></table>\n",
    "created_at": "2017-05-22T11:48:28Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335593",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:67'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab">01c9097</a></td><td><code>Remove broken spaces.</code></td></tr></table>




---

archive/issue_events_200820.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-05-22T11:49:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200820"
}
```



---

archive/issue_events_200821.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/jpflori",
    "created_at": "2017-05-22T11:49:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200821"
}
```



---

archive/issue_comments_335594.json:
```json
{
    "body": "<a id='comment:69'></a>\n`@`francois: push the button again?",
    "created_at": "2017-05-24T13:40:27Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335594",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:69'></a>
`@`francois: push the button again?



---

archive/issue_events_200822.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-05-24T13:43:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200822"
}
```



---

archive/issue_events_200823.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-05-24T13:43:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200823"
}
```



---

archive/issue_comments_335595.json:
```json
{
    "body": "**Changing reviewer** from \"Fran\u00e7ois Bissey\" to \"Fran\u00e7ois Bissey, Dima Pasechnik\".",
    "created_at": "2017-05-24T13:43:27Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335595",
    "user": "https://github.com/dimpase"
}
```

**Changing reviewer** from "François Bissey" to "François Bissey, Dima Pasechnik".



---

archive/issue_comments_335596.json:
```json
{
    "body": "**Changing branch** from \"[public/22493](https://github.com/sagemath/sagetrac-mirror/tree/public/22493)\" to \"[01c90970e9fe648a9374cd02be24c3d6d8da3dab](https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab)\".",
    "created_at": "2017-05-26T21:28:05Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335596",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/22493](https://github.com/sagemath/sagetrac-mirror/tree/public/22493)" to "[01c90970e9fe648a9374cd02be24c3d6d8da3dab](https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab)".



---

archive/issue_events_200824.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-26T21:28:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200824"
}
```



---

archive/issue_events_200825.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "646f124ccd1f8f62972dea19b9b6ab79d54c9f8d",
    "created_at": "2017-05-26T21:28:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22493#event-200825"
}
```



---

archive/issue_comments_335597.json:
```json
{
    "body": "**Changing commit** from \"[01c90970e9fe648a9374cd02be24c3d6d8da3dab](https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab)\" to \"\".",
    "created_at": "2017-06-10T12:18:02Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335597",
    "user": "https://github.com/mezzarobba"
}
```

**Changing commit** from "[01c90970e9fe648a9374cd02be24c3d6d8da3dab](https://github.com/sagemath/sagetrac-mirror/commit/01c90970e9fe648a9374cd02be24c3d6d8da3dab)" to "".



---

archive/issue_comments_335598.json:
```json
{
    "body": "<a id='comment:72'></a>\n\n```\n+# Workaround old GNU as version by disabling assembly use.\n+if [ \"$UNAME\" = Linux ] && [ \"$CC\" = GCC ]; then\n+    as_version = `$AS --version | head -1 | awk 'NF>1{print $NF}'`\n+    case \"$as_version\" in\n+        1.*|2.1*|2.[0-2]*)\n                  ^^^^^^^\n+        echo \"Disable use of assembly because of GNU as < 2.23.\"\n+        export MPN_PATH=generic\n+        ;;\n+    esac\n+fi\n```\n\nShouldn't that be `2.2[0-2]*`? In other words, aren't you disabling assembly for everyone on Linux/gcc here?\n\nSage has become significantly slower on my system (judging from a few quick experiments, perhaps 10-15% slower on average, with integer operations 1.5\u00d7 to 2\u00d7 slower) somewhere between 7.6.rc2 and 8.0.beta9, and I'm wondering if this isn't the cause of the regression...",
    "created_at": "2017-06-10T12:18:02Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335598",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:72'></a>

```
+# Workaround old GNU as version by disabling assembly use.
+if [ "$UNAME" = Linux ] && [ "$CC" = GCC ]; then
+    as_version = `$AS --version | head -1 | awk 'NF>1{print $NF}'`
+    case "$as_version" in
+        1.*|2.1*|2.[0-2]*)
                  ^^^^^^^
+        echo "Disable use of assembly because of GNU as < 2.23."
+        export MPN_PATH=generic
+        ;;
+    esac
+fi
```

Shouldn't that be `2.2[0-2]*`? In other words, aren't you disabling assembly for everyone on Linux/gcc here?

Sage has become significantly slower on my system (judging from a few quick experiments, perhaps 10-15% slower on average, with integer operations 1.5× to 2× slower) somewhere between 7.6.rc2 and 8.0.beta9, and I'm wondering if this isn't the cause of the regression...



---

archive/issue_comments_335599.json:
```json
{
    "body": "<a id='comment:73'></a>\nReplying to [myself](#comment%3A72): Indeed, changing `2.[0-2]` to `2.2[0-2]` solves the issue. Follow-up at #23209.",
    "created_at": "2017-06-10T12:56:07Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335599",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:73'></a>
Replying to [myself](#comment%3A72): Indeed, changing `2.[0-2]` to `2.2[0-2]` solves the issue. Follow-up at #23209.



---

archive/issue_comments_335600.json:
```json
{
    "body": "<a id='comment:74'></a>\nThis ticket caused a significant performance regression: #23327",
    "created_at": "2017-06-27T10:39:56Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335600",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:74'></a>
This ticket caused a significant performance regression: #23327



---

archive/issue_comments_335601.json:
```json
{
    "body": "<a id='comment:75'></a>\nReplying to [@jdemeyer](#comment%3A74):\n> This ticket caused a significant performance regression: #23327\n\nThis is not fixed by #23146?",
    "created_at": "2017-06-27T13:26:16Z",
    "issue": "https://github.com/sagemath/sage/issues/22493",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22493#issuecomment-335601",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:75'></a>
Replying to [@jdemeyer](#comment%3A74):
> This ticket caused a significant performance regression: #23327

This is not fixed by #23146?
