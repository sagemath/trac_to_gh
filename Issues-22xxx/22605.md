# Issue 22605: Better error handling of the polyhedron constructor for non-embedded NumberField and floats.

archive/issues_022368.json:
```json
{
    "assignees": [],
    "body": "These error messages are not really informative of what the problem really is:\n\n```\n\nsage: K = NumberField(x^2-2,'s')\nsage: s = K.0\nsage: L = NumberField(x^3-2,'t')\nsage: t = L.0\nsage: P = Polyhedron(vertices = [[0,s],[t,0]])\nTraceback (most recent call last):\n...\nAttributeError: 'Objects_with_category' object has no attribute 'is_exact'\n\n```\n\nsimilar problem with `floats`:\n\n```\n\nsage: f = float(1.1)\nsage: f\n1.1\nsage: Polyhedron(vertices=[[f]])\nTraceback (most recent call last):\n...\nAttributeError: type object 'float' has no attribute 'is_exact'\n\n```\n\nThe constructor could try to detect the problem and return an informative message.\n\nOnce this is fixed, ticket #22552 is a follow-up ticket that should be fixed easily from the present resolution.\n\nDepends on #23345\n\nCC:  @mo271 @mkoeppe @videlec @novoselt @sagetrac-tmonteil @tscrim\n\nKeywords: **polyhedron, base ring**\n\nBranch/Commit: **[`af03de8`](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Jean-Philippe Labb\u00e9, Vincent Delecroix, Marcelo Forets**\n\nComponent: **geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22605_\n\n",
    "closed_at": "2017-07-29T15:30:57Z",
    "created_at": "2017-03-15T12:58:51Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Better error handling of the polyhedron constructor for non-embedded NumberField and floats.",
    "type": "issue",
    "updated_at": "2017-07-29T15:30:57Z",
    "url": "https://github.com/sagemath/sage/issues/22605",
    "user": "https://github.com/jplab"
}
```
These error messages are not really informative of what the problem really is:

```

sage: K = NumberField(x^2-2,'s')
sage: s = K.0
sage: L = NumberField(x^3-2,'t')
sage: t = L.0
sage: P = Polyhedron(vertices = [[0,s],[t,0]])
Traceback (most recent call last):
...
AttributeError: 'Objects_with_category' object has no attribute 'is_exact'

```

similar problem with `floats`:

```

sage: f = float(1.1)
sage: f
1.1
sage: Polyhedron(vertices=[[f]])
Traceback (most recent call last):
...
AttributeError: type object 'float' has no attribute 'is_exact'

```

The constructor could try to detect the problem and return an informative message.

Once this is fixed, ticket #22552 is a follow-up ticket that should be fixed easily from the present resolution.

Depends on #23345

CC:  @mo271 @mkoeppe @videlec @novoselt @sagetrac-tmonteil @tscrim

Keywords: **polyhedron, base ring**

Branch/Commit: **[`af03de8`](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)**

Reviewer: **Vincent Delecroix**

Author: **Jean-Philippe Labbé, Vincent Delecroix, Marcelo Forets**

Component: **geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/22605_





---

archive/issue_events_315771.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-03-15T12:58:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315771"
}
```



---

archive/issue_events_315772.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-03-15T12:58:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315772"
}
```



---

archive/issue_events_315773.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-03-15T12:58:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315773"
}
```



---

archive/issue_events_315774.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-03-15T12:58:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315774"
}
```



---

archive/issue_comments_335169.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,34 +21,10 @@\n sage: f\n 1.1\n sage: Polyhedron(vertices=[[f]])\n----------------------------------------------------------------------------\n-AttributeError                            Traceback (most recent call last)\n-<ipython-input-55-aea1b8b1f057> in <module>()\n-----> 1 Polyhedron(vertices=[[f]])\n-\n-/Users/jplab/sage/sage2/src/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__call__ (/Users/jplab/sage/sage2/src/build/cythonized/sage/misc/lazy_import.c:4007)()\n-    387             True\n-    388         \"\"\"\n---> 389         return self._get_object()(*args, **kwds)\n-    390 \n-    391     def __repr__(self):\n-\n-/Users/jplab/sage/sage2/local/lib/python2.7/site-packages/sage/geometry/polyhedron/constructor.pyc in Polyhedron(vertices, rays, lines, ieqs, eqns, ambient_dim, base_ring, minimize, verbose, backend)\n-    490     # Specific backends can override the base_ring\n-    491     from sage.geometry.polyhedron.parent import Polyhedra\n---> 492     parent = Polyhedra(base_ring, ambient_dim, backend=backend)\n-    493     base_ring = parent.base_ring()\n-    494 \n-\n-/Users/jplab/sage/sage2/local/lib/python2.7/site-packages/sage/geometry/polyhedron/parent.pyc in Polyhedra(base_ring, ambient_dim, backend)\n-     89         elif base_ring is RDF:\n-     90             backend = 'cdd'\n----> 91         elif base_ring.is_exact():\n-     92             backend = 'field'\n-     93         else:\n-\n+Traceback (most recent call last):\n+...\n AttributeError: type object 'float' has no attribute 'is_exact'\n \n ```\n \n-\n+The constructor could try to detect the problem and return an informative message.\n``````\n",
    "created_at": "2017-03-15T12:59:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335169",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,34 +21,10 @@
 sage: f
 1.1
 sage: Polyhedron(vertices=[[f]])
----------------------------------------------------------------------------
-AttributeError                            Traceback (most recent call last)
-<ipython-input-55-aea1b8b1f057> in <module>()
-----> 1 Polyhedron(vertices=[[f]])
-
-/Users/jplab/sage/sage2/src/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__call__ (/Users/jplab/sage/sage2/src/build/cythonized/sage/misc/lazy_import.c:4007)()
-    387             True
-    388         """
---> 389         return self._get_object()(*args, **kwds)
-    390 
-    391     def __repr__(self):
-
-/Users/jplab/sage/sage2/local/lib/python2.7/site-packages/sage/geometry/polyhedron/constructor.pyc in Polyhedron(vertices, rays, lines, ieqs, eqns, ambient_dim, base_ring, minimize, verbose, backend)
-    490     # Specific backends can override the base_ring
-    491     from sage.geometry.polyhedron.parent import Polyhedra
---> 492     parent = Polyhedra(base_ring, ambient_dim, backend=backend)
-    493     base_ring = parent.base_ring()
-    494 
-
-/Users/jplab/sage/sage2/local/lib/python2.7/site-packages/sage/geometry/polyhedron/parent.pyc in Polyhedra(base_ring, ambient_dim, backend)
-     89         elif base_ring is RDF:
-     90             backend = 'cdd'
----> 91         elif base_ring.is_exact():
-     92             backend = 'field'
-     93         else:
-
+Traceback (most recent call last):
+...
 AttributeError: type object 'float' has no attribute 'is_exact'
 
 ```
 
-
+The constructor could try to detect the problem and return an informative message.
``````




---

archive/issue_comments_335170.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nIndeed. Do we want to convert `float -> RDF` these two are fully compatible?",
    "created_at": "2017-03-15T13:41:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335170",
    "user": "https://github.com/videlec"
}
```

<div id="comment:3" align="right">comment:3</div>

Indeed. Do we want to convert `float -> RDF` these two are fully compatible?



---

archive/issue_comments_335171.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIf this:\n\n```\nsage: RDF.has_coerce_map_from(float)\nTrue\n```\n\nis all we need, I guess so... It would do a similar trick as for RR with 53 bits of precision...",
    "created_at": "2017-03-15T13:49:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335171",
    "user": "https://github.com/jplab"
}
```

<div id="comment:4" align="right">comment:4</div>

If this:

```
sage: RDF.has_coerce_map_from(float)
True
```

is all we need, I guess so... It would do a similar trick as for RR with 53 bits of precision...



---

archive/issue_comments_335172.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nIt is not: coercion has nothing to do with embedding\n\n```\nsage: Zmod(5).has_coerce_map_from(ZZ)\nTrue\nsage: RealField(5).has_coerce_map_from(RealField(256))\nTrue\n```",
    "created_at": "2017-03-15T13:55:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335172",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

It is not: coercion has nothing to do with embedding

```
sage: Zmod(5).has_coerce_map_from(ZZ)
True
sage: RealField(5).has_coerce_map_from(RealField(256))
True
```



---

archive/issue_comments_335173.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSo how to check for the embedding? Simply wrap?",
    "created_at": "2017-03-17T13:30:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335173",
    "user": "https://github.com/jplab"
}
```

<div id="comment:6" align="right">comment:6</div>

So how to check for the embedding? Simply wrap?



---

archive/issue_comments_335174.json:
```json
{
    "body": "Branch: **[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)**",
    "created_at": "2017-03-17T14:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335174",
    "user": "https://github.com/jplab"
}
```

Branch: **[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)**



---

archive/issue_comments_335175.json:
```json
{
    "body": "Commit: **[`8678e17`](https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da)**",
    "created_at": "2017-03-17T14:37:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335175",
    "user": "https://github.com/jplab"
}
```

Commit: **[`8678e17`](https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da)**



---

archive/issue_comments_335176.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI added a way to catch the float and set the base ring to `RDF`. Now, I'm wondering how we could handle the algebraic numbers in an efficient way. Indeed, it seems that they are automatically converted while they might not need it. \n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da\"><code>8678e17</code></a></td><td><code>Made support for floats</code></td></tr></table>\n",
    "created_at": "2017-03-17T14:37:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335176",
    "user": "https://github.com/jplab"
}
```

<div id="comment:8" align="right">comment:8</div>

I added a way to catch the float and set the base ring to `RDF`. Now, I'm wondering how we could handle the algebraic numbers in an efficient way. Indeed, it seems that they are automatically converted while they might not need it. 

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da"><code>8678e17</code></a></td><td><code>Made support for floats</code></td></tr></table>




---

archive/issue_comments_335177.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1235ae45abaef92c46f857a183205f6465ea3e3e\"><code>1235ae4</code></a></td><td><code>Merge branch 'u/jipilab/22605' of git://trac.sagemath.org/sage into 22605</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc\"><code>47d9425</code></a></td><td><code>Added handling of not embedded NumberFields and tests</code></td></tr></table>\n",
    "created_at": "2017-04-04T14:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335177",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1235ae45abaef92c46f857a183205f6465ea3e3e"><code>1235ae4</code></a></td><td><code>Merge branch 'u/jipilab/22605' of git://trac.sagemath.org/sage into 22605</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc"><code>47d9425</code></a></td><td><code>Added handling of not embedded NumberFields and tests</code></td></tr></table>




---

archive/issue_comments_335178.json:
```json
{
    "body": "Changed commit from **[`8678e17`](https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da)** to **[`47d9425`](https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc)**",
    "created_at": "2017-04-04T14:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335178",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8678e17`](https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da)** to **[`47d9425`](https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc)**



---

archive/issue_events_315775.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-04-04T14:28:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315775"
}
```



---

archive/issue_comments_335179.json:
```json
{
    "body": "Changed commit from **[`47d9425`](https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc)** to **[`9567999`](https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6)**",
    "created_at": "2017-04-04T14:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335179",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`47d9425`](https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc)** to **[`9567999`](https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6)**



---

archive/issue_comments_335180.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6\"><code>9567999</code></a></td><td><code>pep8 and fix a typo</code></td></tr></table>\n",
    "created_at": "2017-04-04T14:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335180",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6"><code>9567999</code></a></td><td><code>pep8 and fix a typo</code></td></tr></table>




---

archive/issue_comments_335181.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nA polyhedron with **one** non embedded number field should already gives an error. Could you add an example involving only `L`?",
    "created_at": "2017-04-04T16:02:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335181",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">comment:12</div>

A polyhedron with **one** non embedded number field should already gives an error. Could you add an example involving only `L`?



---

archive/issue_comments_335182.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nInstead of the manual `float -> RDF` you should use `py_scalar_parent` from `sage.structure.coercion`. By the way, where the conversion `Python int -> ZZ` is happening? This should be done at the same time.",
    "created_at": "2017-04-04T16:04:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335182",
    "user": "https://github.com/videlec"
}
```

<div id="comment:13" align="right">comment:13</div>

Instead of the manual `float -> RDF` you should use `py_scalar_parent` from `sage.structure.coercion`. By the way, where the conversion `Python int -> ZZ` is happening? This should be done at the same time.



---

archive/issue_comments_335183.json:
```json
{
    "body": "Changed commit from **[`9567999`](https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6)** to **[`97694dd`](https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841)**",
    "created_at": "2017-04-04T19:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335183",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[`9567999`](https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6)** to **[`97694dd`](https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841)**



---

archive/issue_comments_335184.json:
```json
{
    "body": "Changed branch from **[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)** to **[u/vdelecroix/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22605)**",
    "created_at": "2017-04-04T19:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335184",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)** to **[u/vdelecroix/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22605)**



---

archive/issue_comments_335185.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nMuch more resaonable code path in my branch. Though the error message could still be elaborated.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841\"><code>97694dd</code></a></td><td><code>22605: simpler constructor for Polyhedron</code></td></tr></table>\n",
    "created_at": "2017-04-04T19:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335185",
    "user": "https://github.com/videlec"
}
```

<div id="comment:14" align="right">comment:14</div>

Much more resaonable code path in my branch. Though the error message could still be elaborated.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841"><code>97694dd</code></a></td><td><code>22605: simpler constructor for Polyhedron</code></td></tr></table>




---

archive/issue_comments_335186.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nBTW, I think that the following would better be handled by `Polyhedra` (constructor of the parent)\n\n```\n# TODO: find a more robust way of checking that the coefficients are indeed\n# real numbers\nif base_ring not in Rings() or not RDF.has_coerce_map_from(base_ring):\n    raise ValueError(\"invalid base ring\")\n```",
    "created_at": "2017-04-04T19:48:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335186",
    "user": "https://github.com/videlec"
}
```

<div id="comment:15" align="right">comment:15</div>

BTW, I think that the following would better be handled by `Polyhedra` (constructor of the parent)

```
# TODO: find a more robust way of checking that the coefficients are indeed
# real numbers
if base_ring not in Rings() or not RDF.has_coerce_map_from(base_ring):
    raise ValueError("invalid base ring")
```



---

archive/issue_comments_335187.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI was also hesitating about where to put the handling of the error... But since there was not proper `base_ring` to pass to the parent, I thought it is better to stop there... But then, looking up at the documentation on top of the constructor... there is not much...\n\nI then looked at the output of `Polyhedron?` and it is there... So I guess it is a good idea to put it in the constructor?\n\nI will have a deeper look at your commit asap. I would be happy to have a cleaner and clearer constructor...",
    "created_at": "2017-04-04T20:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335187",
    "user": "https://github.com/jplab"
}
```

<div id="comment:16" align="right">comment:16</div>

I was also hesitating about where to put the handling of the error... But since there was not proper `base_ring` to pass to the parent, I thought it is better to stop there... But then, looking up at the documentation on top of the constructor... there is not much...

I then looked at the output of `Polyhedron?` and it is there... So I guess it is a good idea to put it in the constructor?

I will have a deeper look at your commit asap. I would be happy to have a cleaner and clearer constructor...



---

archive/issue_events_315776.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-04-05T07:33:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315776"
}
```



---

archive/issue_events_315777.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-04-05T07:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315777"
}
```



---

archive/issue_comments_335188.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...\n\nIf you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?\n\nI have #22754 in mind as an example.\n\nI'll try to put some time on this, but I will look at the trac only sporadically in the next 2 weeks.",
    "created_at": "2017-04-05T07:33:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335188",
    "user": "https://github.com/jplab"
}
```

<div id="comment:17" align="right">comment:17</div>

I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...

If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?

I have #22754 in mind as an example.

I'll try to put some time on this, but I will look at the trac only sporadically in the next 2 weeks.



---

archive/issue_comments_335189.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOverall I think the distinction of `base_ring=QQ` and `base_ring=ZZ` is completely unnecessary. The constructor could just unconditionally replace the given base ring by its fraction field.",
    "created_at": "2017-04-06T18:02:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335189",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">comment:18</div>

Overall I think the distinction of `base_ring=QQ` and `base_ring=ZZ` is completely unnecessary. The constructor could just unconditionally replace the given base ring by its fraction field.



---

archive/issue_comments_335190.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@mkoeppe](#comment:18):\n> Overall I think the distinction of `base_ring=QQ` and `base_ring=ZZ` is completely unnecessary. The constructor could just unconditionally replace the given base ring by its fraction field.\n\nBut this distinction is used in order to pick the proper parent isn't it? So what about the distinction of the two parent classes `_QQ` and `_ZZ`? It is true that a rational polytope has an Ehrhart quasipolynomial which is not necessarily a polynomial... Well, well...\n\nIt is true that this distinction makes life more difficult in some cases...",
    "created_at": "2017-04-06T20:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335190",
    "user": "https://github.com/jplab"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@mkoeppe](#comment:18):
> Overall I think the distinction of `base_ring=QQ` and `base_ring=ZZ` is completely unnecessary. The constructor could just unconditionally replace the given base ring by its fraction field.

But this distinction is used in order to pick the proper parent isn't it? So what about the distinction of the two parent classes `_QQ` and `_ZZ`? It is true that a rational polytope has an Ehrhart quasipolynomial which is not necessarily a polynomial... Well, well...

It is true that this distinction makes life more difficult in some cases...



---

archive/issue_comments_335191.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nYes, that's what I mean; there is no need to distinguish the parents for QQ and ZZ. \n\nThe method for computing an ehrhart polynomial should also be available for rational polytopes; being a lattice polytope is merely a sufficient condition for getting an ehrhart polynomial. If the user asks for the ehrhart polynomial but the counting function is a quasipolynomial (with a true period), then an exception should be raised by the method.",
    "created_at": "2017-04-06T21:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335191",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Yes, that's what I mean; there is no need to distinguish the parents for QQ and ZZ. 

The method for computing an ehrhart polynomial should also be available for rational polytopes; being a lattice polytope is merely a sufficient condition for getting an ehrhart polynomial. If the user asks for the ehrhart polynomial but the counting function is a quasipolynomial (with a true period), then an exception should be raised by the method.



---

archive/issue_comments_335192.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@mkoeppe](#comment:20):\n> Yes, that's what I mean; there is no need to distinguish the parents for QQ and ZZ. \n> \n> The method for computing an ehrhart polynomial should also be available for rational polytopes; being a lattice polytope is merely a sufficient condition for getting an ehrhart polynomial. If the user asks for the ehrhart polynomial but the counting function is a quasipolynomial (with a true period), then an exception should be raised by the method. \n\nAs far as I understand, what you propose is way beyond the scope of this ticket. The simplification I wrote keep the ancient behavior (up to the fact that rationals are now treated as rationals).",
    "created_at": "2017-04-07T06:54:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335192",
    "user": "https://github.com/videlec"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@mkoeppe](#comment:20):
> Yes, that's what I mean; there is no need to distinguish the parents for QQ and ZZ. 
> 
> The method for computing an ehrhart polynomial should also be available for rational polytopes; being a lattice polytope is merely a sufficient condition for getting an ehrhart polynomial. If the user asks for the ehrhart polynomial but the counting function is a quasipolynomial (with a true period), then an exception should be raised by the method. 

As far as I understand, what you propose is way beyond the scope of this ticket. The simplification I wrote keep the ancient behavior (up to the fact that rationals are now treated as rationals).



---

archive/issue_comments_335193.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@jplab](#comment:17):\n> I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...\n> \n> If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?\n\nTrue! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.",
    "created_at": "2017-04-07T06:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335193",
    "user": "https://github.com/videlec"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@jplab](#comment:17):
> I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...
> 
> If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?

True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.



---

archive/issue_comments_335194.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@videlec](#comment:22):\n> Replying to [@jplab](#comment:17):\n> > I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...\n> > \n> > If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?\n\n> \n> True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.\n\nWhere is this happening!? I don't see the code path that you are mentioning...",
    "created_at": "2017-04-07T06:57:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335194",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@videlec](#comment:22):
> Replying to [@jplab](#comment:17):
> > I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...
> > 
> > If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?

> 
> True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.

Where is this happening!? I don't see the code path that you are mentioning...



---

archive/issue_events_315778.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-04-07T06:58:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315778"
}
```



---

archive/issue_events_315779.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-04-07T06:58:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315779"
}
```



---

archive/issue_comments_335195.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@videlec](#comment:23):\n> Replying to [@videlec](#comment:22):\n> > Replying to [@jplab](#comment:17):\n> > > I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...\n> > > \n> > > If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?\n\n> > \n> > True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.\n\n> \n> Where is this happening!? I don't see the code path that you are mentioning...\n\nSorry, got confused in reading the code and running an example in my head. If the user specified a `base_ring` it won't go where I thought it would because of the if, elif, else clause... So nevermind... my bad!",
    "created_at": "2017-04-07T11:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335195",
    "user": "https://github.com/jplab"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@videlec](#comment:23):
> Replying to [@videlec](#comment:22):
> > Replying to [@jplab](#comment:17):
> > > I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...
> > > 
> > > If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?

> > 
> > True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.

> 
> Where is this happening!? I don't see the code path that you are mentioning...

Sorry, got confused in reading the code and running an example in my head. If the user specified a `base_ring` it won't go where I thought it would because of the if, elif, else clause... So nevermind... my bad!



---

archive/issue_comments_335196.json:
```json
{
    "body": "Author: **Jean-Philippe Labb\u00e9, Vincent Delecroix**",
    "created_at": "2017-05-04T07:06:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335196",
    "user": "https://github.com/videlec"
}
```

Author: **Jean-Philippe Labbé, Vincent Delecroix**



---

archive/issue_comments_335197.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22605)** to **[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)**",
    "created_at": "2017-05-04T10:06:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335197",
    "user": "https://github.com/jplab"
}
```

Changed branch from **[u/vdelecroix/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22605)** to **[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)**



---

archive/issue_comments_335198.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nOops, sorry. Didn't want to change the branch to do the rebase. My bad...\n\nI'll change it back.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440\"><code>dc0e524</code></a></td><td><code>Rebased on Sage-8.0.beta3</code></td></tr></table>\n",
    "created_at": "2017-05-04T10:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335198",
    "user": "https://github.com/jplab"
}
```

<div id="comment:28" align="right">comment:28</div>

Oops, sorry. Didn't want to change the branch to do the rebase. My bad...

I'll change it back.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440"><code>dc0e524</code></a></td><td><code>Rebased on Sage-8.0.beta3</code></td></tr></table>




---

archive/issue_comments_335199.json:
```json
{
    "body": "Changed commit from **[`97694dd`](https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841)** to **[`dc0e524`](https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440)**",
    "created_at": "2017-05-04T10:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335199",
    "user": "https://github.com/jplab"
}
```

Changed commit from **[`97694dd`](https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841)** to **[`dc0e524`](https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440)**



---

archive/issue_comments_335200.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841\"><code>97694dd</code></a></td><td><code>22605: simpler constructor for Polyhedron</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733\"><code>fc5089d</code></a></td><td><code>Merge branch 'u/vdelecroix/22605' into 22605</code></td></tr></table>\n",
    "created_at": "2017-05-04T10:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335200",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841"><code>97694dd</code></a></td><td><code>22605: simpler constructor for Polyhedron</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733"><code>fc5089d</code></a></td><td><code>Merge branch 'u/vdelecroix/22605' into 22605</code></td></tr></table>




---

archive/issue_comments_335201.json:
```json
{
    "body": "Changed commit from **[`dc0e524`](https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440)** to **[`fc5089d`](https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733)**",
    "created_at": "2017-05-04T10:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335201",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dc0e524`](https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440)** to **[`fc5089d`](https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733)**



---

archive/issue_comments_335202.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nTests passed on base.py and constructor.py with Sage-8.0.beta3.\n\nThe bots didn't have a look at this yet?!",
    "created_at": "2017-05-04T10:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335202",
    "user": "https://github.com/jplab"
}
```

<div id="comment:30" align="right">comment:30</div>

Tests passed on base.py and constructor.py with Sage-8.0.beta3.

The bots didn't have a look at this yet?!



---

archive/issue_comments_335203.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThe bots are not testing many things see https://github.com/sagemath/sage-patchbot/issues/76",
    "created_at": "2017-05-04T10:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335203",
    "user": "https://github.com/videlec"
}
```

<div id="comment:31" align="right">comment:31</div>

The bots are not testing many things see https://github.com/sagemath/sage-patchbot/issues/76



---

archive/issue_comments_335204.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\n(I just launched mine manually)",
    "created_at": "2017-05-04T10:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335204",
    "user": "https://github.com/videlec"
}
```

<div id="comment:32" align="right">comment:32</div>

(I just launched mine manually)



---

archive/issue_comments_335205.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,3 +28,5 @@\n ```\n \n The constructor could try to detect the problem and return an informative message.\n+\n+Once this is fixed, ticket #22552 is a follow-up ticket that should be fixed easily from the present resolution.\n``````\n",
    "created_at": "2017-05-04T10:52:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335205",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,3 +28,5 @@
 ```
 
 The constructor could try to detect the problem and return an informative message.
+
+Once this is fixed, ticket #22552 is a follow-up ticket that should be fixed easily from the present resolution.
``````




---

archive/issue_comments_335206.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\n`.. TESTS:` should be `TESTS:` (no `.. `)",
    "created_at": "2017-05-04T11:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335206",
    "user": "https://github.com/videlec"
}
```

<div id="comment:34" align="right">comment:34</div>

`.. TESTS:` should be `TESTS:` (no `.. `)



---

archive/issue_comments_335207.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nAnd in the doctest for float it would actually be good to also test `int` and `Fraction` (from the Python module fractions).",
    "created_at": "2017-05-04T11:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335207",
    "user": "https://github.com/videlec"
}
```

<div id="comment:35" align="right">comment:35</div>

And in the doctest for float it would actually be good to also test `int` and `Fraction` (from the Python module fractions).



---

archive/issue_events_315780.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-05-10T15:41:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315780"
}
```



---

archive/issue_events_315781.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-05-10T15:41:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315781"
}
```



---

archive/issue_comments_335208.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nSome MIP's tests are broken by the code. I will look into this and correct the docstring too.",
    "created_at": "2017-05-10T15:41:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335208",
    "user": "https://github.com/jplab"
}
```

<div id="comment:36" align="right">comment:36</div>

Some MIP's tests are broken by the code. I will look into this and correct the docstring too.



---

archive/issue_events_315782.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-06-30T09:22:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315782"
}
```



---

archive/issue_events_315783.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-06-30T09:22:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315783"
}
```



---

archive/issue_comments_335209.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nhi, \n\ni've adjusted the doctests in MIP and added the `int` construction test to JP's branch.\n\ni had trouble with Python's `Fraction` though:\n\n```\nsage:\u00a0from\u00a0fractions\u00a0import\u00a0Fraction\nsage:\u00a0Polyhedron(vertices=[[Fraction(int(8),\u00a0int(6))]])\n---------------------------------------------------------------------------\nValueError\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Traceback\u00a0(most\u00a0recent\u00a0call\u00a0last)\n<ipython-input-27-199a9229f10f>\u00a0in\u00a0<module>()\n---->\u00a01\u00a0Polyhedron(vertices=[[Fraction(int(Integer(8)),\u00a0int(Integer(6)))]])\n\n\u00a0\n/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/constructor.pyc\u00a0in\u00a0Polyhedron(vertices,\u00a0rays,\u00a0lines,\u00a0ieqs,\u00a0eqns,\u00a0ambient_dim,\u00a0base_ring,\u00a0minimi\nze,\u00a0verbose,\u00a0backend)\n\u00a0\u00a0\u00a0\u00a0497\u00a0\u00a0\u00a0\u00a0\u00a0#\u00a0real\u00a0numbers\n\u00a0\u00a0\u00a0\u00a0498\u00a0\u00a0\u00a0\u00a0\u00a0if\u00a0base_ring\u00a0not\u00a0in\u00a0Rings()\u00a0or\u00a0not\u00a0RDF.has_coerce_map_from(base_ring):\n-->\u00a0499\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0raise\u00a0ValueError(\"invalid\u00a0base\u00a0ring\")\n\u00a0\u00a0\u00a0\u00a0500\n\u00a0\u00a0\u00a0\u00a0501\u00a0\u00a0\u00a0\u00a0\u00a0#\u00a0TODO:\u00a0remove\u00a0this\u00a0hack\n\u00a0\nValueError:\u00a0invalid\u00a0base\u00a0ring\n```\n\nany ideas? \n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17325931132aecd0e0f9f5e4b10717d04abcc4f1\"><code>1732593</code></a></td><td><code>Merge branch 'develop' into t/22605/22605</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06bb9ca7f8ae0ad4019a217dc72c613b2b8bd514\"><code>06bb9ca</code></a></td><td><code>Merge branch 'develop' into t/22605/22605</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95\"><code>c58f8b2</code></a></td><td><code>fix docstring, test int, add QQ example</code></td></tr></table>\n",
    "created_at": "2017-06-30T09:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335209",
    "user": "https://github.com/mforets"
}
```

<div id="comment:37" align="right">comment:37</div>

hi, 

i've adjusted the doctests in MIP and added the `int` construction test to JP's branch.

i had trouble with Python's `Fraction` though:

```
sage: from fractions import Fraction
sage: Polyhedron(vertices=[[Fraction(int(8), int(6))]])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-27-199a9229f10f> in <module>()
----> 1 Polyhedron(vertices=[[Fraction(int(Integer(8)), int(Integer(6)))]])

 
/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/constructor.pyc in Polyhedron(vertices, rays, lines, ieqs, eqns, ambient_dim, base_ring, minimi
ze, verbose, backend)
    497     # real numbers
    498     if base_ring not in Rings() or not RDF.has_coerce_map_from(base_ring):
--> 499         raise ValueError("invalid base ring")
    500
    501     # TODO: remove this hack
 
ValueError: invalid base ring
```

any ideas? 

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17325931132aecd0e0f9f5e4b10717d04abcc4f1"><code>1732593</code></a></td><td><code>Merge branch 'develop' into t/22605/22605</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06bb9ca7f8ae0ad4019a217dc72c613b2b8bd514"><code>06bb9ca</code></a></td><td><code>Merge branch 'develop' into t/22605/22605</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95"><code>c58f8b2</code></a></td><td><code>fix docstring, test int, add QQ example</code></td></tr></table>




---

archive/issue_comments_335210.json:
```json
{
    "body": "Changed commit from **[`fc5089d`](https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733)** to **[`c58f8b2`](https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95)**",
    "created_at": "2017-06-30T09:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335210",
    "user": "https://github.com/mforets"
}
```

Changed commit from **[`fc5089d`](https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733)** to **[`c58f8b2`](https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95)**



---

archive/issue_comments_335211.json:
```json
{
    "body": "Changed branch from **[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)** to **[u/mforets/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/mforets/22605)**",
    "created_at": "2017-06-30T09:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335211",
    "user": "https://github.com/mforets"
}
```

Changed branch from **[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)** to **[u/mforets/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/mforets/22605)**



---

archive/issue_comments_335212.json:
```json
{
    "body": "Changed author from **Jean-Philippe Labb\u00e9, Vincent Delecroix** to **Jean-Philippe Labb\u00e9, Vincent Delecroix, Marcelo Forets**",
    "created_at": "2017-06-30T09:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335212",
    "user": "https://github.com/mforets"
}
```

Changed author from **Jean-Philippe Labbé, Vincent Delecroix** to **Jean-Philippe Labbé, Vincent Delecroix, Marcelo Forets**



---

archive/issue_events_315784.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-06-30T09:22:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315784"
}
```



---

archive/issue_events_315785.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-06-30T09:22:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315785"
}
```



---

archive/issue_comments_335213.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI think that those two functions should be fixed to work with `Fraction`\n\n```\nsage: from sage.structure.coerce import py_scalar_to_element, py_scalar_parent\nsage: f = fractions.Fraction(2r, 3r)\nsage: py_scalar_parent(type(f))    # should be QQ\nsage: py_scalar_to_element(f)      # should be Rational\nFraction(2, 3)\n```\n(could be a dependency ticket)",
    "created_at": "2017-06-30T10:37:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335213",
    "user": "https://github.com/videlec"
}
```

<div id="comment:38" align="right">comment:38</div>

I think that those two functions should be fixed to work with `Fraction`

```
sage: from sage.structure.coerce import py_scalar_to_element, py_scalar_parent
sage: f = fractions.Fraction(2r, 3r)
sage: py_scalar_parent(type(f))    # should be QQ
sage: py_scalar_to_element(f)      # should be Rational
Fraction(2, 3)
```
(could be a dependency ticket)



---

archive/issue_comments_335214.json:
```json
{
    "body": "Dependencies: **#23345**",
    "created_at": "2017-06-30T14:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335214",
    "user": "https://github.com/videlec"
}
```

Dependencies: **#23345**



---

archive/issue_comments_335215.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nsee #23345",
    "created_at": "2017-06-30T14:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335215",
    "user": "https://github.com/videlec"
}
```

<div id="comment:39" align="right">comment:39</div>

see #23345



---

archive/issue_comments_335216.json:
```json
{
    "body": "Changed commit from **[`c58f8b2`](https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95)** to **[`5952854`](https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c)**",
    "created_at": "2017-07-08T11:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335216",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c58f8b2`](https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95)** to **[`5952854`](https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c)**



---

archive/issue_comments_335217.json:
```json
{
    "body": "<div id=\"comment:40\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c\"><code>5952854</code></a></td><td><code>add fraction example</code></td></tr></table>\n",
    "created_at": "2017-07-08T11:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335217",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c"><code>5952854</code></a></td><td><code>add fraction example</code></td></tr></table>




---

archive/issue_events_315786.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-07-12T08:51:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315786"
}
```



---

archive/issue_events_315787.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-07-12T08:51:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315787"
}
```



---

archive/issue_comments_335218.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nHi all,\n\nI believe that the last issues have been addressed by Marcelo, so I set this to \"needs review\".\n\nWhat is the error given by the bot? A time-out? Yet again, some unknown behavior to me.",
    "created_at": "2017-07-12T08:51:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335218",
    "user": "https://github.com/jplab"
}
```

<div id="comment:41" align="right">comment:41</div>

Hi all,

I believe that the last issues have been addressed by Marcelo, so I set this to "needs review".

What is the error given by the bot? A time-out? Yet again, some unknown behavior to me.



---

archive/issue_comments_335219.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nTwo problems from the doctest need to be fixed\n\n```\n$ sage -t geometry/polyhedron/constructor.py\nRunning doctests with ID 2017-07-13-19-29-08-cb0892b4.\nGit branch: 22605-8.0.rc1\nUsing --optional=bliss,lrslib,mpir,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage\nDoctesting 1 file.\nsage -t --warn-long 75.0 geometry/polyhedron/constructor.py\n**********************************************************************\nFile \"geometry/polyhedron/constructor.py\", line 443, in sage.geometry.polyhedron.constructor.?\nFailed example:\n    Polyhedron(vertices=[[f]])\nException raised:\n    Traceback (most recent call last):\n    ...\n    ValueError: invalid base ring\n**********************************************************************\n1 item had failures:\n   1 of  27 in sage.geometry.polyhedron.constructor.?\n    [59 tests, 1 failure, 0.55 s]\n----------------------------------------------------------------------\nsage -t --warn-long 75.0 geometry/polyhedron/constructor.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\n```\n$ sage -t categories/finite_coxeter_groups.py\nRunning doctests with ID 2017-07-13-19-30-14-e608e41e.\nGit branch: 22605-8.0.rc1\nUsing --optional=bliss,lrslib,mpir,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage\nDoctesting 1 file.\nsage -t --warn-long 75.0 categories/finite_coxeter_groups.py\n**********************************************************************\nFile \"categories/finite_coxeter_groups.py\", line 720, in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron\nFailed example:\n    W.permutahedron()\nException raised:\n    Traceback (most recent call last):\n    ...\n    ValueError: invalid base ring\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron\n    [151 tests, 1 failure, 5.21 s]\n----------------------------------------------------------------------\nsage -t --warn-long 75.0 categories/finite_coxeter_groups.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2017-07-13T17:32:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335219",
    "user": "https://github.com/videlec"
}
```

<div id="comment:42" align="right">comment:42</div>

Two problems from the doctest need to be fixed

```
$ sage -t geometry/polyhedron/constructor.py
Running doctests with ID 2017-07-13-19-29-08-cb0892b4.
Git branch: 22605-8.0.rc1
Using --optional=bliss,lrslib,mpir,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage
Doctesting 1 file.
sage -t --warn-long 75.0 geometry/polyhedron/constructor.py
**********************************************************************
File "geometry/polyhedron/constructor.py", line 443, in sage.geometry.polyhedron.constructor.?
Failed example:
    Polyhedron(vertices=[[f]])
Exception raised:
    Traceback (most recent call last):
    ...
    ValueError: invalid base ring
**********************************************************************
1 item had failures:
   1 of  27 in sage.geometry.polyhedron.constructor.?
    [59 tests, 1 failure, 0.55 s]
----------------------------------------------------------------------
sage -t --warn-long 75.0 geometry/polyhedron/constructor.py  # 1 doctest failed
----------------------------------------------------------------------
```

```
$ sage -t categories/finite_coxeter_groups.py
Running doctests with ID 2017-07-13-19-30-14-e608e41e.
Git branch: 22605-8.0.rc1
Using --optional=bliss,lrslib,mpir,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage
Doctesting 1 file.
sage -t --warn-long 75.0 categories/finite_coxeter_groups.py
**********************************************************************
File "categories/finite_coxeter_groups.py", line 720, in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron
Failed example:
    W.permutahedron()
Exception raised:
    Traceback (most recent call last):
    ...
    ValueError: invalid base ring
**********************************************************************
1 item had failures:
   1 of   6 in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron
    [151 tests, 1 failure, 5.21 s]
----------------------------------------------------------------------
sage -t --warn-long 75.0 categories/finite_coxeter_groups.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_315788.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-13T17:32:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315788"
}
```



---

archive/issue_events_315789.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-13T17:32:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315789"
}
```



---

archive/issue_comments_335220.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nThe following comment in the test block <code>Check that giving \\`\\`float\\`\\` and \\`\\`int\\`\\` input gets converted to \\`\\RDF\\`</code> should be modified since int are converted to elements of ZZ and not RDF. Furthermore, replace <code>\\`\\RDF\\`</code> by <code>\\`\\`RDF\\`\\`</code>.",
    "created_at": "2017-07-13T17:40:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335220",
    "user": "https://github.com/videlec"
}
```

<div id="comment:43" align="right">comment:43</div>

The following comment in the test block <code>Check that giving \`\`float\`\` and \`\`int\`\` input gets converted to \`\RDF\`</code> should be modified since int are converted to elements of ZZ and not RDF. Furthermore, replace <code>\`\RDF\`</code> by <code>\`\`RDF\`\`</code>.



---

archive/issue_comments_335221.json:
```json
{
    "body": "<div id=\"comment:44\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83bf93242d9ffb791034daea87d91701b57eeaae\"><code>83bf932</code></a></td><td><code>23345: conversions from Fraction to Rational</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce7fb25dceab06ce630824ff071ce840b439bd38\"><code>ce7fb25</code></a></td><td><code>23345: make it faster</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e238c9e321d5f2c46c5553ac75555e9a6f09aef7\"><code>e238c9e</code></a></td><td><code>address reviewer's comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e80700a40a406a17df24f95ebf51cdcab1279864\"><code>e80700a</code></a></td><td><code>Merge branch 't/23345/23345' into t/22605/22605</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec\"><code>6be64b1</code></a></td><td><code>fix docstring for int</code></td></tr></table>\n",
    "created_at": "2017-07-23T19:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335221",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:44"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83bf93242d9ffb791034daea87d91701b57eeaae"><code>83bf932</code></a></td><td><code>23345: conversions from Fraction to Rational</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce7fb25dceab06ce630824ff071ce840b439bd38"><code>ce7fb25</code></a></td><td><code>23345: make it faster</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e238c9e321d5f2c46c5553ac75555e9a6f09aef7"><code>e238c9e</code></a></td><td><code>address reviewer's comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e80700a40a406a17df24f95ebf51cdcab1279864"><code>e80700a</code></a></td><td><code>Merge branch 't/23345/23345' into t/22605/22605</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec"><code>6be64b1</code></a></td><td><code>fix docstring for int</code></td></tr></table>




---

archive/issue_comments_335222.json:
```json
{
    "body": "Changed commit from **[`5952854`](https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c)** to **[`6be64b1`](https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec)**",
    "created_at": "2017-07-23T19:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335222",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5952854`](https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c)** to **[`6be64b1`](https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec)**



---

archive/issue_comments_335223.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\n- [comment:42](#comment:42), doctest in `constructor.py`, done (upon merging with #23345)\n- [comment:42](#comment:42), doctest in `finite_coxeter_groups.py` : i'm confused. the UniversalCyclotomicField should still be supported in the constructor, right? in this case:\n\n    - the base ring is `UniversalCyclotomicField()`, and `base_ring not in Rings()` is False\n    - `RDF.has_coerce_map_from(UniversalCyclotomicField())` is also False\n- [comment:43](#comment:43), done",
    "created_at": "2017-07-23T19:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335223",
    "user": "https://github.com/mforets"
}
```

<div id="comment:45" align="right">comment:45</div>

- [comment:42](#comment:42), doctest in `constructor.py`, done (upon merging with #23345)
- [comment:42](#comment:42), doctest in `finite_coxeter_groups.py` : i'm confused. the UniversalCyclotomicField should still be supported in the constructor, right? in this case:

    - the base ring is `UniversalCyclotomicField()`, and `base_ring not in Rings()` is False
    - `RDF.has_coerce_map_from(UniversalCyclotomicField())` is also False
- [comment:43](#comment:43), done



---

archive/issue_comments_335224.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nThe universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?",
    "created_at": "2017-07-23T21:08:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335224",
    "user": "https://github.com/videlec"
}
```

<div id="comment:46" align="right">comment:46</div>

The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?



---

archive/issue_comments_335225.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@videlec](#comment:46):\n> The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?\n\nOk, thanks for the clarification. i look forward to suggestions on that choice (since i don't have one).",
    "created_at": "2017-07-25T14:38:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335225",
    "user": "https://github.com/mforets"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@videlec](#comment:46):
> The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?

Ok, thanks for the clarification. i look forward to suggestions on that choice (since i don't have one).



---

archive/issue_comments_335226.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@mforets](#comment:47):\n> Replying to [@videlec](#comment:46):\n> > The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?\n\n> \n> Ok, thanks for the clarification. i look forward to suggestions on that choice (since i don't have one).\n\nI think an error is safer. The code in Coxeter group that constructs the polytope should call `Polyhedron` with an appropriate base ring (like `AA` or `QQ[cos(pi/q)]`).",
    "created_at": "2017-07-25T14:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335226",
    "user": "https://github.com/videlec"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@mforets](#comment:47):
> Replying to [@videlec](#comment:46):
> > The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?

> 
> Ok, thanks for the clarification. i look forward to suggestions on that choice (since i don't have one).

I think an error is safer. The code in Coxeter group that constructs the polytope should call `Polyhedron` with an appropriate base ring (like `AA` or `QQ[cos(pi/q)]`).



---

archive/issue_comments_335227.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nThe following does work\n\n```\nsage: W = CoxeterGroup(['I',7])\nsage: n = W.one().canonical_matrix().rank()\nsage: weights = W.fundamental_weights()\nsage: point = [ZZ.one()] * n\nsage: v = sum(point[i-1] * weights[i] for i in weights.keys())\nsage: vertices = [(v*w).change_ring(AA) for w in W]\nsage: Polyhedron(vertices)\n```\nIt is perhaps not optimal, but fixes the issue with Coxeter groups.",
    "created_at": "2017-07-25T14:50:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335227",
    "user": "https://github.com/videlec"
}
```

<div id="comment:49" align="right">comment:49</div>

The following does work

```
sage: W = CoxeterGroup(['I',7])
sage: n = W.one().canonical_matrix().rank()
sage: weights = W.fundamental_weights()
sage: point = [ZZ.one()] * n
sage: v = sum(point[i-1] * weights[i] for i in weights.keys())
sage: vertices = [(v*w).change_ring(AA) for w in W]
sage: Polyhedron(vertices)
```
It is perhaps not optimal, but fixes the issue with Coxeter groups.



---

archive/issue_comments_335228.json:
```json
{
    "body": "<div id=\"comment:50\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5\"><code>128235e</code></a></td><td><code>convert UCF and QQbar to AA in permutahedron</code></td></tr></table>\n",
    "created_at": "2017-07-25T16:48:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335228",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:50"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5"><code>128235e</code></a></td><td><code>convert UCF and QQbar to AA in permutahedron</code></td></tr></table>




---

archive/issue_comments_335229.json:
```json
{
    "body": "Changed commit from **[`6be64b1`](https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec)** to **[`128235e`](https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5)**",
    "created_at": "2017-07-25T16:48:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335229",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6be64b1`](https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec)** to **[`128235e`](https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5)**



---

archive/issue_events_315790.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-07-25T16:49:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315790"
}
```



---

archive/issue_events_315791.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-07-25T16:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315791"
}
```



---

archive/issue_comments_335230.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\ndisclaimer: i didn't run those tests which require the optional GAP3 package 'chevie'. if someone has it installed already, could you try it please?",
    "created_at": "2017-07-25T16:55:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335230",
    "user": "https://github.com/mforets"
}
```

<div id="comment:52" align="right">comment:52</div>

disclaimer: i didn't run those tests which require the optional GAP3 package 'chevie'. if someone has it installed already, could you try it please?



---

archive/issue_comments_335231.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@mforets](#comment:52):\n> disclaimer: i didn't run those tests which require the optional GAP3 package 'chevie'. if someone has it installed already, could you try it please? \n\nTravis: After this ticket, it will be forbidden to use `UCF` and `QQbar` as ground fields for polytopes. I believe that you have GAP3 installed. Could you check that we do not break anything for generating the polyhedra related to Coxeter groups?",
    "created_at": "2017-07-26T07:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335231",
    "user": "https://github.com/videlec"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@mforets](#comment:52):
> disclaimer: i didn't run those tests which require the optional GAP3 package 'chevie'. if someone has it installed already, could you try it please? 

Travis: After this ticket, it will be forbidden to use `UCF` and `QQbar` as ground fields for polytopes. I believe that you have GAP3 installed. Could you check that we do not break anything for generating the polyhedra related to Coxeter groups?



---

archive/issue_comments_335232.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\ni was getting:\n\n```\nsage: W = ReflectionGroup(['A',3])\n...\nImportError: the GAP3 package 'chevie' is needed to work with (complex) reflection groups\nsage: is_package_installed(\"gap3\")\nFalse\n```\n\nand got scared with the message below.. but installing turned out to be very fast!\n\n```\n===========================\u00a0WARNING\u00a0===========================\nYou\u00a0are\u00a0about\u00a0to\u00a0download\u00a0and\u00a0install\u00a0the\u00a0experimental\u00a0package\ngap3-01may17.\u00a0\u00a0This\u00a0probably\u00a0won't\u00a0work\u00a0at\u00a0all\u00a0for\u00a0you!\u00a0There\nis\u00a0no\u00a0guarantee\u00a0that\u00a0it\u00a0will\u00a0build\u00a0correctly,\u00a0or\u00a0behave\u00a0as\nexpected.\u00a0Use\u00a0at\u00a0your\u00a0own\u00a0risk!\n===============================================================\n...\n```\n\nanyway, testing with `--optional=gap3` flag i do find problems. those tests with the `ReflectionGroup` and integer base ring were failing. \n\nin the new commit, i'm 'hardcoding' the base ring that is passed to the constructor to be QQ in those cases (before, this was guessed from the vertices). what do you think?",
    "created_at": "2017-07-26T08:59:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335232",
    "user": "https://github.com/mforets"
}
```

<div id="comment:54" align="right">comment:54</div>

i was getting:

```
sage: W = ReflectionGroup(['A',3])
...
ImportError: the GAP3 package 'chevie' is needed to work with (complex) reflection groups
sage: is_package_installed("gap3")
False
```

and got scared with the message below.. but installing turned out to be very fast!

```
=========================== WARNING ===========================
You are about to download and install the experimental package
gap3-01may17.  This probably won't work at all for you! There
is no guarantee that it will build correctly, or behave as
expected. Use at your own risk!
===============================================================
...
```

anyway, testing with `--optional=gap3` flag i do find problems. those tests with the `ReflectionGroup` and integer base ring were failing. 

in the new commit, i'm 'hardcoding' the base ring that is passed to the constructor to be QQ in those cases (before, this was guessed from the vertices). what do you think?



---

archive/issue_comments_335233.json:
```json
{
    "body": "<div id=\"comment:55\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6\"><code>579e33f</code></a></td><td><code>transform to QQ ring for reflection groups</code></td></tr></table>\n",
    "created_at": "2017-07-26T09:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335233",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:55"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6"><code>579e33f</code></a></td><td><code>transform to QQ ring for reflection groups</code></td></tr></table>




---

archive/issue_comments_335234.json:
```json
{
    "body": "Changed commit from **[`128235e`](https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5)** to **[`579e33f`](https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6)**",
    "created_at": "2017-07-26T09:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335234",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`128235e`](https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5)** to **[`579e33f`](https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6)**



---

archive/issue_comments_335235.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nwith respect to the tests, it also works to infer the base ring from the sum over weights v, that is:\n\n```\nif base_ring is None:\n    base_ring = v.base_ring()\n```\n\ninstead of\n\n```\nif base_ring is None:\n    base_ring = self.base_ring()\n    if base_ring is ZZ:\n        base_ring = QQ\n```",
    "created_at": "2017-07-26T09:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335235",
    "user": "https://github.com/mforets"
}
```

<div id="comment:56" align="right">comment:56</div>

with respect to the tests, it also works to infer the base ring from the sum over weights v, that is:

```
if base_ring is None:
    base_ring = v.base_ring()
```

instead of

```
if base_ring is None:
    base_ring = self.base_ring()
    if base_ring is ZZ:
        base_ring = QQ
```



---

archive/issue_events_315792.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-26T12:54:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315792"
}
```



---

archive/issue_events_315793.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-26T12:54:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315793"
}
```



---

archive/issue_comments_335236.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\n`@`Marcelo: this beahvior is bad\n\n```\nsage: W = CoxeterGroup(['I',7])\nsage: W.permutahedron(base_ring=QQbar).base_ring() is QQbar\nFalse\n```\nIf the user supplies explicitely a `base_ring` in the method `permutahedron()` then it should be used. The above example should be an error (that would be raised by the polyhedron constructor). The automatic conversion `QQbar -> AA` and `UCF -> AA` should only be done when the user calls `permutahedron()` without specifying the base ring.",
    "created_at": "2017-07-26T12:54:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335236",
    "user": "https://github.com/videlec"
}
```

<div id="comment:57" align="right">comment:57</div>

`@`Marcelo: this beahvior is bad

```
sage: W = CoxeterGroup(['I',7])
sage: W.permutahedron(base_ring=QQbar).base_ring() is QQbar
False
```
If the user supplies explicitely a `base_ring` in the method `permutahedron()` then it should be used. The above example should be an error (that would be raised by the polyhedron constructor). The automatic conversion `QQbar -> AA` and `UCF -> AA` should only be done when the user calls `permutahedron()` without specifying the base ring.



---

archive/issue_comments_335237.json:
```json
{
    "body": "<div id=\"comment:58\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33\"><code>6f6d0f3</code></a></td><td><code>fix behaviour with QQbar and simplify it</code></td></tr></table>\n",
    "created_at": "2017-07-26T18:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335237",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:58"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33"><code>6f6d0f3</code></a></td><td><code>fix behaviour with QQbar and simplify it</code></td></tr></table>




---

archive/issue_comments_335238.json:
```json
{
    "body": "Changed commit from **[`579e33f`](https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6)** to **[`6f6d0f3`](https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33)**",
    "created_at": "2017-07-26T18:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335238",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`579e33f`](https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6)** to **[`6f6d0f3`](https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33)**



---

archive/issue_events_315794.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-07-26T18:22:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315794"
}
```



---

archive/issue_events_315795.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-07-26T18:22:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315795"
}
```



---

archive/issue_comments_335239.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nHere\n\n```\n+            if base_ring is None and v.base_ring() in [UniversalCyclotomicField(), QQbar]:\n+                    vertices = [(v*w).change_ring(AA) for w in self]\n```\nyou have an identation with 8 spaces!",
    "created_at": "2017-07-27T10:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335239",
    "user": "https://github.com/videlec"
}
```

<div id="comment:60" align="right">comment:60</div>

Here

```
+            if base_ring is None and v.base_ring() in [UniversalCyclotomicField(), QQbar]:
+                    vertices = [(v*w).change_ring(AA) for w in self]
```
you have an identation with 8 spaces!



---

archive/issue_comments_335240.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nAnd concerning the same piece of code, it would be simpler to do\n\n```\nvertices = [v*w for w in self]\nif base_ring is None and v.base_ring() in [UniversalCyclotomicField(), QQbar]:\n    vertices = [v.change_ring(AA) for v in vertices]\n    base_ring = AA\n```",
    "created_at": "2017-07-27T10:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335240",
    "user": "https://github.com/videlec"
}
```

<div id="comment:61" align="right">comment:61</div>

And concerning the same piece of code, it would be simpler to do

```
vertices = [v*w for w in self]
if base_ring is None and v.base_ring() in [UniversalCyclotomicField(), QQbar]:
    vertices = [v.change_ring(AA) for v in vertices]
    base_ring = AA
```



---

archive/issue_comments_335241.json:
```json
{
    "body": "Changed commit from **[`6f6d0f3`](https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33)** to **[`af03de8`](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)**",
    "created_at": "2017-07-27T11:09:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335241",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6f6d0f3`](https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33)** to **[`af03de8`](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)**



---

archive/issue_comments_335242.json:
```json
{
    "body": "<div id=\"comment:62\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981\"><code>af03de8</code></a></td><td><code>fix indentation issue, and simplify</code></td></tr></table>\n",
    "created_at": "2017-07-27T11:09:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335242",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:62"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981"><code>af03de8</code></a></td><td><code>fix indentation issue, and simplify</code></td></tr></table>




---

archive/issue_comments_335243.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@sagetrac-git](#comment:62):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981\"><code>af03de8</code></a></td><td><code>fix indentation issue, and simplify</code></td></tr></table>\n\n`@`vdelec: you're right, thanks.",
    "created_at": "2017-07-27T11:13:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335243",
    "user": "https://github.com/mforets"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@sagetrac-git](#comment:62):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981"><code>af03de8</code></a></td><td><code>fix indentation issue, and simplify</code></td></tr></table>

`@`vdelec: you're right, thanks.



---

archive/issue_comments_335244.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2017-07-27T13:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335244",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_comments_335245.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nThis is a great improvement! Thank you!",
    "created_at": "2017-07-27T13:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335245",
    "user": "https://github.com/videlec"
}
```

<div id="comment:64" align="right">comment:64</div>

This is a great improvement! Thank you!



---

archive/issue_events_315796.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-27T13:19:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315796"
}
```



---

archive/issue_events_315797.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-27T13:19:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315797"
}
```



---

archive/issue_comments_335246.json:
```json
{
    "body": "Changed branch from **[u/mforets/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/mforets/22605)** to **[`af03de8`](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)**",
    "created_at": "2017-07-29T15:30:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-335246",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mforets/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/mforets/22605)** to **[`af03de8`](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)**



---

archive/issue_events_315798.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-07-29T15:30:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315798"
}
```



---

archive/issue_events_315799.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "84f4bec421e11342d43d74290ed0fb5399b64a11",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-07-29T15:30:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-315799"
}
```
