# Issue 22605: Better error handling of the polyhedron constructor for non-embedded NumberField and floats.

archive/issues_022368.json:
```json
{
    "assignees": [],
    "body": "These error messages are not really informative of what the problem really is:\n\n```\n\nsage: K = NumberField(x^2-2,'s')\nsage: s = K.0\nsage: L = NumberField(x^3-2,'t')\nsage: t = L.0\nsage: P = Polyhedron(vertices = [[0,s],[t,0]])\nTraceback (most recent call last):\n...\nAttributeError: 'Objects_with_category' object has no attribute 'is_exact'\n\n```\n\nsimilar problem with `floats`:\n\n```\n\nsage: f = float(1.1)\nsage: f\n1.1\nsage: Polyhedron(vertices=[[f]])\nTraceback (most recent call last):\n...\nAttributeError: type object 'float' has no attribute 'is_exact'\n\n```\n\nThe constructor could try to detect the problem and return an informative message.\n\nOnce this is fixed, ticket #22552 is a follow-up ticket that should be fixed easily from the present resolution.\n\nDepends on #23345\n\n**CC:**  @mo271 @mkoeppe @videlec @novoselt tmonteil @tscrim\n\n**Keywords:** polyhedron, base ring\n\n**Branch/Commit:** [af03de82ed07686322db70895a0ab34973888981](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)\n\n**Reviewer:** Vincent Delecroix\n\n**Author:** Jean-Philippe Labb\u00e9, Vincent Delecroix, Marcelo Forets\n\nIssue created by migration from https://trac.sagemath.org/ticket/22605\n\n",
    "closed_at": "2017-07-29T15:30:57Z",
    "created_at": "2017-03-15T12:58:51Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20geometry",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Better error handling of the polyhedron constructor for non-embedded NumberField and floats.",
    "type": "issue",
    "updated_at": "2017-07-29T15:30:57Z",
    "url": "https://github.com/sagemath/sage/issues/22605",
    "user": "https://github.com/jplab"
}
```
These error messages are not really informative of what the problem really is:

```

sage: K = NumberField(x^2-2,'s')
sage: s = K.0
sage: L = NumberField(x^3-2,'t')
sage: t = L.0
sage: P = Polyhedron(vertices = [[0,s],[t,0]])
Traceback (most recent call last):
...
AttributeError: 'Objects_with_category' object has no attribute 'is_exact'

```

similar problem with `floats`:

```

sage: f = float(1.1)
sage: f
1.1
sage: Polyhedron(vertices=[[f]])
Traceback (most recent call last):
...
AttributeError: type object 'float' has no attribute 'is_exact'

```

The constructor could try to detect the problem and return an informative message.

Once this is fixed, ticket #22552 is a follow-up ticket that should be fixed easily from the present resolution.

Depends on #23345

**CC:**  @mo271 @mkoeppe @videlec @novoselt tmonteil @tscrim

**Keywords:** polyhedron, base ring

**Branch/Commit:** [af03de82ed07686322db70895a0ab34973888981](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)

**Reviewer:** Vincent Delecroix

**Author:** Jean-Philippe Labbé, Vincent Delecroix, Marcelo Forets

Issue created by migration from https://trac.sagemath.org/ticket/22605





---

archive/issue_comments_337657.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -21,34 +21,10 @@\n sage: f\n 1.1\n sage: Polyhedron(vertices=[[f]])\n----------------------------------------------------------------------------\n-AttributeError                            Traceback (most recent call last)\n-<ipython-input-55-aea1b8b1f057> in <module>()\n-----> 1 Polyhedron(vertices=[[f]])\n-\n-/Users/jplab/sage/sage2/src/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__call__ (/Users/jplab/sage/sage2/src/build/cythonized/sage/misc/lazy_import.c:4007)()\n-    387             True\n-    388         \"\"\"\n---> 389         return self._get_object()(*args, **kwds)\n-    390 \n-    391     def __repr__(self):\n-\n-/Users/jplab/sage/sage2/local/lib/python2.7/site-packages/sage/geometry/polyhedron/constructor.pyc in Polyhedron(vertices, rays, lines, ieqs, eqns, ambient_dim, base_ring, minimize, verbose, backend)\n-    490     # Specific backends can override the base_ring\n-    491     from sage.geometry.polyhedron.parent import Polyhedra\n---> 492     parent = Polyhedra(base_ring, ambient_dim, backend=backend)\n-    493     base_ring = parent.base_ring()\n-    494 \n-\n-/Users/jplab/sage/sage2/local/lib/python2.7/site-packages/sage/geometry/polyhedron/parent.pyc in Polyhedra(base_ring, ambient_dim, backend)\n-     89         elif base_ring is RDF:\n-     90             backend = 'cdd'\n----> 91         elif base_ring.is_exact():\n-     92             backend = 'field'\n-     93         else:\n-\n+Traceback (most recent call last):\n+...\n AttributeError: type object 'float' has no attribute 'is_exact'\n \n ```\n \n-\n+The constructor could try to detect the problem and return an informative message.\n``````\n",
    "created_at": "2017-03-15T12:59:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337657",
    "user": "https://github.com/jplab"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -21,34 +21,10 @@
 sage: f
 1.1
 sage: Polyhedron(vertices=[[f]])
----------------------------------------------------------------------------
-AttributeError                            Traceback (most recent call last)
-<ipython-input-55-aea1b8b1f057> in <module>()
-----> 1 Polyhedron(vertices=[[f]])
-
-/Users/jplab/sage/sage2/src/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__call__ (/Users/jplab/sage/sage2/src/build/cythonized/sage/misc/lazy_import.c:4007)()
-    387             True
-    388         """
---> 389         return self._get_object()(*args, **kwds)
-    390 
-    391     def __repr__(self):
-
-/Users/jplab/sage/sage2/local/lib/python2.7/site-packages/sage/geometry/polyhedron/constructor.pyc in Polyhedron(vertices, rays, lines, ieqs, eqns, ambient_dim, base_ring, minimize, verbose, backend)
-    490     # Specific backends can override the base_ring
-    491     from sage.geometry.polyhedron.parent import Polyhedra
---> 492     parent = Polyhedra(base_ring, ambient_dim, backend=backend)
-    493     base_ring = parent.base_ring()
-    494 
-
-/Users/jplab/sage/sage2/local/lib/python2.7/site-packages/sage/geometry/polyhedron/parent.pyc in Polyhedra(base_ring, ambient_dim, backend)
-     89         elif base_ring is RDF:
-     90             backend = 'cdd'
----> 91         elif base_ring.is_exact():
-     92             backend = 'field'
-     93         else:
-
+Traceback (most recent call last):
+...
 AttributeError: type object 'float' has no attribute 'is_exact'
 
 ```
 
-
+The constructor could try to detect the problem and return an informative message.
``````




---

archive/issue_comments_337658.json:
```json
{
    "body": "<a id='comment:3'></a>\nIndeed. Do we want to convert `float -> RDF` these two are fully compatible?",
    "created_at": "2017-03-15T13:41:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337658",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>
Indeed. Do we want to convert `float -> RDF` these two are fully compatible?



---

archive/issue_comments_337659.json:
```json
{
    "body": "<a id='comment:4'></a>\nIf this:\n\n```\nsage: RDF.has_coerce_map_from(float)\nTrue\n```\n\nis all we need, I guess so... It would do a similar trick as for RR with 53 bits of precision...",
    "created_at": "2017-03-15T13:49:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337659",
    "user": "https://github.com/jplab"
}
```

<a id='comment:4'></a>
If this:

```
sage: RDF.has_coerce_map_from(float)
True
```

is all we need, I guess so... It would do a similar trick as for RR with 53 bits of precision...



---

archive/issue_comments_337660.json:
```json
{
    "body": "<a id='comment:5'></a>\nIt is not: coercion has nothing to do with embedding\n\n```\nsage: Zmod(5).has_coerce_map_from(ZZ)\nTrue\nsage: RealField(5).has_coerce_map_from(RealField(256))\nTrue\n```",
    "created_at": "2017-03-15T13:55:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337660",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
It is not: coercion has nothing to do with embedding

```
sage: Zmod(5).has_coerce_map_from(ZZ)
True
sage: RealField(5).has_coerce_map_from(RealField(256))
True
```



---

archive/issue_comments_337661.json:
```json
{
    "body": "<a id='comment:6'></a>\nSo how to check for the embedding? Simply wrap?",
    "created_at": "2017-03-17T13:30:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337661",
    "user": "https://github.com/jplab"
}
```

<a id='comment:6'></a>
So how to check for the embedding? Simply wrap?



---

archive/issue_comments_337662.json:
```json
{
    "body": "**Branch:** [u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)",
    "created_at": "2017-03-17T14:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337662",
    "user": "https://github.com/jplab"
}
```

**Branch:** [u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)



---

archive/issue_comments_337663.json:
```json
{
    "body": "**Commit:** [8678e1784b9bd7bbce8baa84e8846ab8d96649da](https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da)",
    "created_at": "2017-03-17T14:37:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337663",
    "user": "https://github.com/jplab"
}
```

**Commit:** [8678e1784b9bd7bbce8baa84e8846ab8d96649da](https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da)



---

archive/issue_comments_337664.json:
```json
{
    "body": "<a id='comment:8'></a>\nI added a way to catch the float and set the base ring to `RDF`. Now, I'm wondering how we could handle the algebraic numbers in an efficient way. Indeed, it seems that they are automatically converted while they might not need it. \n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da\">8678e17</a></td><td><code>Made support for floats</code></td></tr></table>\n",
    "created_at": "2017-03-17T14:37:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337664",
    "user": "https://github.com/jplab"
}
```

<a id='comment:8'></a>
I added a way to catch the float and set the base ring to `RDF`. Now, I'm wondering how we could handle the algebraic numbers in an efficient way. Indeed, it seems that they are automatically converted while they might not need it. 

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da">8678e17</a></td><td><code>Made support for floats</code></td></tr></table>




---

archive/issue_comments_337665.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1235ae45abaef92c46f857a183205f6465ea3e3e\">1235ae4</a></td><td><code>Merge branch 'u/jipilab/22605' of git://trac.sagemath.org/sage into 22605</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc\">47d9425</a></td><td><code>Added handling of not embedded NumberFields and tests</code></td></tr></table>\n",
    "created_at": "2017-04-04T14:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337665",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1235ae45abaef92c46f857a183205f6465ea3e3e">1235ae4</a></td><td><code>Merge branch 'u/jipilab/22605' of git://trac.sagemath.org/sage into 22605</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc">47d9425</a></td><td><code>Added handling of not embedded NumberFields and tests</code></td></tr></table>




---

archive/issue_comments_337666.json:
```json
{
    "body": "**Changing commit** from \"[8678e1784b9bd7bbce8baa84e8846ab8d96649da](https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da)\" to \"[47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc](https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc)\".",
    "created_at": "2017-04-04T14:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337666",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[8678e1784b9bd7bbce8baa84e8846ab8d96649da](https://github.com/sagemath/sagetrac-mirror/commit/8678e1784b9bd7bbce8baa84e8846ab8d96649da)" to "[47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc](https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc)".



---

archive/issue_events_201726.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-04-04T14:28:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201726"
}
```



---

archive/issue_comments_337667.json:
```json
{
    "body": "**Changing commit** from \"[47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc](https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc)\" to \"[9567999c707cc3defd2d416cfadcae6f148937a6](https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6)\".",
    "created_at": "2017-04-04T14:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337667",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc](https://github.com/sagemath/sagetrac-mirror/commit/47d9425ef1283708b7a4ce0a7e34a93c2d16b2dc)" to "[9567999c707cc3defd2d416cfadcae6f148937a6](https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6)".



---

archive/issue_comments_337668.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6\">9567999</a></td><td><code>pep8 and fix a typo</code></td></tr></table>\n",
    "created_at": "2017-04-04T14:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337668",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6">9567999</a></td><td><code>pep8 and fix a typo</code></td></tr></table>




---

archive/issue_comments_337669.json:
```json
{
    "body": "<a id='comment:12'></a>\nA polyhedron with **one** non embedded number field should already gives an error. Could you add an example involving only `L`?",
    "created_at": "2017-04-04T16:02:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337669",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>
A polyhedron with **one** non embedded number field should already gives an error. Could you add an example involving only `L`?



---

archive/issue_comments_337670.json:
```json
{
    "body": "<a id='comment:13'></a>\nInstead of the manual `float -> RDF` you should use `py_scalar_parent` from `sage.structure.coercion`. By the way, where the conversion `Python int -> ZZ` is happening? This should be done at the same time.",
    "created_at": "2017-04-04T16:04:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337670",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>
Instead of the manual `float -> RDF` you should use `py_scalar_parent` from `sage.structure.coercion`. By the way, where the conversion `Python int -> ZZ` is happening? This should be done at the same time.



---

archive/issue_comments_337671.json:
```json
{
    "body": "**Changing commit** from \"[9567999c707cc3defd2d416cfadcae6f148937a6](https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6)\" to \"[97694dd9bda1746e617b8c9d2ce3f9cf0433a841](https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841)\".",
    "created_at": "2017-04-04T19:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337671",
    "user": "https://github.com/videlec"
}
```

**Changing commit** from "[9567999c707cc3defd2d416cfadcae6f148937a6](https://github.com/sagemath/sagetrac-mirror/commit/9567999c707cc3defd2d416cfadcae6f148937a6)" to "[97694dd9bda1746e617b8c9d2ce3f9cf0433a841](https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841)".



---

archive/issue_comments_337672.json:
```json
{
    "body": "**Changing branch** from \"[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)\" to \"[u/vdelecroix/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22605)\".",
    "created_at": "2017-04-04T19:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337672",
    "user": "https://github.com/videlec"
}
```

**Changing branch** from "[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)" to "[u/vdelecroix/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22605)".



---

archive/issue_comments_337673.json:
```json
{
    "body": "<a id='comment:14'></a>\nMuch more resaonable code path in my branch. Though the error message could still be elaborated.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841\">97694dd</a></td><td><code>22605: simpler constructor for Polyhedron</code></td></tr></table>\n",
    "created_at": "2017-04-04T19:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337673",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>
Much more resaonable code path in my branch. Though the error message could still be elaborated.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841">97694dd</a></td><td><code>22605: simpler constructor for Polyhedron</code></td></tr></table>




---

archive/issue_comments_337674.json:
```json
{
    "body": "<a id='comment:15'></a>\nBTW, I think that the following would better be handled by `Polyhedra` (constructor of the parent)\n\n```\n# TODO: find a more robust way of checking that the coefficients are indeed\n# real numbers\nif base_ring not in Rings() or not RDF.has_coerce_map_from(base_ring):\n    raise ValueError(\"invalid base ring\")\n```",
    "created_at": "2017-04-04T19:48:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337674",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>
BTW, I think that the following would better be handled by `Polyhedra` (constructor of the parent)

```
# TODO: find a more robust way of checking that the coefficients are indeed
# real numbers
if base_ring not in Rings() or not RDF.has_coerce_map_from(base_ring):
    raise ValueError("invalid base ring")
```



---

archive/issue_comments_337675.json:
```json
{
    "body": "<a id='comment:16'></a>\nI was also hesitating about where to put the handling of the error... But since there was not proper `base_ring` to pass to the parent, I thought it is better to stop there... But then, looking up at the documentation on top of the constructor... there is not much...\n\nI then looked at the output of `Polyhedron?` and it is there... So I guess it is a good idea to put it in the constructor?\n\nI will have a deeper look at your commit asap. I would be happy to have a cleaner and clearer constructor...",
    "created_at": "2017-04-04T20:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337675",
    "user": "https://github.com/jplab"
}
```

<a id='comment:16'></a>
I was also hesitating about where to put the handling of the error... But since there was not proper `base_ring` to pass to the parent, I thought it is better to stop there... But then, looking up at the documentation on top of the constructor... there is not much...

I then looked at the output of `Polyhedron?` and it is there... So I guess it is a good idea to put it in the constructor?

I will have a deeper look at your commit asap. I would be happy to have a cleaner and clearer constructor...



---

archive/issue_events_201727.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-04-05T07:33:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201727"
}
```



---

archive/issue_events_201728.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-04-05T07:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201728"
}
```



---

archive/issue_comments_337676.json:
```json
{
    "body": "<a id='comment:17'></a>\nI'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...\n\nIf you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?\n\nI have #22754 in mind as an example.\n\nI'll try to put some time on this, but I will look at the trac only sporadically in the next 2 weeks.",
    "created_at": "2017-04-05T07:33:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337676",
    "user": "https://github.com/jplab"
}
```

<a id='comment:17'></a>
I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...

If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?

I have #22754 in mind as an example.

I'll try to put some time on this, but I will look at the trac only sporadically in the next 2 weeks.



---

archive/issue_comments_337677.json:
```json
{
    "body": "<a id='comment:18'></a>\nOverall I think the distinction of `base_ring=QQ` and `base_ring=ZZ` is completely unnecessary. The constructor could just unconditionally replace the given base ring by its fraction field.",
    "created_at": "2017-04-06T18:02:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337677",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
Overall I think the distinction of `base_ring=QQ` and `base_ring=ZZ` is completely unnecessary. The constructor could just unconditionally replace the given base ring by its fraction field.



---

archive/issue_comments_337678.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [@mkoeppe](#comment%3A18):\n> Overall I think the distinction of `base_ring=QQ` and `base_ring=ZZ` is completely unnecessary. The constructor could just unconditionally replace the given base ring by its fraction field.\n\nBut this distinction is used in order to pick the proper parent isn't it? So what about the distinction of the two parent classes `_QQ` and `_ZZ`? It is true that a rational polytope has an Ehrhart quasipolynomial which is not necessarily a polynomial... Well, well...\n\nIt is true that this distinction makes life more difficult in some cases...",
    "created_at": "2017-04-06T20:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337678",
    "user": "https://github.com/jplab"
}
```

<a id='comment:19'></a>
Replying to [@mkoeppe](#comment%3A18):
> Overall I think the distinction of `base_ring=QQ` and `base_ring=ZZ` is completely unnecessary. The constructor could just unconditionally replace the given base ring by its fraction field.

But this distinction is used in order to pick the proper parent isn't it? So what about the distinction of the two parent classes `_QQ` and `_ZZ`? It is true that a rational polytope has an Ehrhart quasipolynomial which is not necessarily a polynomial... Well, well...

It is true that this distinction makes life more difficult in some cases...



---

archive/issue_comments_337679.json:
```json
{
    "body": "<a id='comment:20'></a>\nYes, that's what I mean; there is no need to distinguish the parents for QQ and ZZ. \n\nThe method for computing an ehrhart polynomial should also be available for rational polytopes; being a lattice polytope is merely a sufficient condition for getting an ehrhart polynomial. If the user asks for the ehrhart polynomial but the counting function is a quasipolynomial (with a true period), then an exception should be raised by the method.",
    "created_at": "2017-04-06T21:27:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337679",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>
Yes, that's what I mean; there is no need to distinguish the parents for QQ and ZZ. 

The method for computing an ehrhart polynomial should also be available for rational polytopes; being a lattice polytope is merely a sufficient condition for getting an ehrhart polynomial. If the user asks for the ehrhart polynomial but the counting function is a quasipolynomial (with a true period), then an exception should be raised by the method.



---

archive/issue_comments_337680.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [@mkoeppe](#comment%3A20):\n> Yes, that's what I mean; there is no need to distinguish the parents for QQ and ZZ. \n> \n> The method for computing an ehrhart polynomial should also be available for rational polytopes; being a lattice polytope is merely a sufficient condition for getting an ehrhart polynomial. If the user asks for the ehrhart polynomial but the counting function is a quasipolynomial (with a true period), then an exception should be raised by the method. \n\nAs far as I understand, what you propose is way beyond the scope of this ticket. The simplification I wrote keep the ancient behavior (up to the fact that rationals are now treated as rationals).",
    "created_at": "2017-04-07T06:54:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337680",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>
Replying to [@mkoeppe](#comment%3A20):
> Yes, that's what I mean; there is no need to distinguish the parents for QQ and ZZ. 
> 
> The method for computing an ehrhart polynomial should also be available for rational polytopes; being a lattice polytope is merely a sufficient condition for getting an ehrhart polynomial. If the user asks for the ehrhart polynomial but the counting function is a quasipolynomial (with a true period), then an exception should be raised by the method. 

As far as I understand, what you propose is way beyond the scope of this ticket. The simplification I wrote keep the ancient behavior (up to the fact that rationals are now treated as rationals).



---

archive/issue_comments_337681.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [@jplab](#comment%3A17):\n> I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...\n> \n> If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?\n\nTrue! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.",
    "created_at": "2017-04-07T06:55:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337681",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>
Replying to [@jplab](#comment%3A17):
> I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...
> 
> If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?

True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.



---

archive/issue_comments_337682.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [@videlec](#comment%3A22):\n> Replying to [@jplab](#comment%3A17):\n> > I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...\n> > \n> > If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?\n\n> \n> True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.\n\nWhere is this happening!? I don't see the code path that you are mentioning...",
    "created_at": "2017-04-07T06:57:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337682",
    "user": "https://github.com/videlec"
}
```

<a id='comment:23'></a>
Replying to [@videlec](#comment%3A22):
> Replying to [@jplab](#comment%3A17):
> > I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...
> > 
> > If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?

> 
> True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.

Where is this happening!? I don't see the code path that you are mentioning...



---

archive/issue_events_201729.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-04-07T06:58:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201729"
}
```



---

archive/issue_events_201730.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-04-07T06:58:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201730"
}
```



---

archive/issue_comments_337683.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [@videlec](#comment%3A23):\n> Replying to [@videlec](#comment%3A22):\n> > Replying to [@jplab](#comment%3A17):\n> > > I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...\n> > > \n> > > If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?\n\n> > \n> > True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.\n\n> \n> Where is this happening!? I don't see the code path that you are mentioning...\n\nSorry, got confused in reading the code and running an example in my head. If the user specified a `base_ring` it won't go where I thought it would because of the if, elif, else clause... So nevermind... my bad!",
    "created_at": "2017-04-07T11:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337683",
    "user": "https://github.com/jplab"
}
```

<a id='comment:25'></a>
Replying to [@videlec](#comment%3A23):
> Replying to [@videlec](#comment%3A22):
> > Replying to [@jplab](#comment%3A17):
> > > I'm looking at the last commit and at line 488 of the constructor, I got puzzled a bit...
> > > 
> > > If you give a polyhedron with an `H`-representation and specified the `base_ring=ZZ`, then it would convert it automatically to `QQ`? What if the user is clever and knows that the `H`-representation that is given really describes a lattice polytope and would like to specify its parent to be Polyhedron_ZZ. So forcing the `base_ring` should be possible?

> > 
> > True! The constructor should not overwrite `base_ring` if it was set by the user. I will add a commit.

> 
> Where is this happening!? I don't see the code path that you are mentioning...

Sorry, got confused in reading the code and running an example in my head. If the user specified a `base_ring` it won't go where I thought it would because of the if, elif, else clause... So nevermind... my bad!



---

archive/issue_comments_337684.json:
```json
{
    "body": "**Author:** Jean-Philippe Labb\u00e9, Vincent Delecroix",
    "created_at": "2017-05-04T07:06:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337684",
    "user": "https://github.com/videlec"
}
```

**Author:** Jean-Philippe Labbé, Vincent Delecroix



---

archive/issue_comments_337685.json:
```json
{
    "body": "**Changing branch** from \"[u/vdelecroix/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22605)\" to \"[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)\".",
    "created_at": "2017-05-04T10:06:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337685",
    "user": "https://github.com/jplab"
}
```

**Changing branch** from "[u/vdelecroix/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22605)" to "[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)".



---

archive/issue_comments_337686.json:
```json
{
    "body": "<a id='comment:28'></a>\nOops, sorry. Didn't want to change the branch to do the rebase. My bad...\n\nI'll change it back.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440\">dc0e524</a></td><td><code>Rebased on Sage-8.0.beta3</code></td></tr></table>\n",
    "created_at": "2017-05-04T10:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337686",
    "user": "https://github.com/jplab"
}
```

<a id='comment:28'></a>
Oops, sorry. Didn't want to change the branch to do the rebase. My bad...

I'll change it back.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440">dc0e524</a></td><td><code>Rebased on Sage-8.0.beta3</code></td></tr></table>




---

archive/issue_comments_337687.json:
```json
{
    "body": "**Changing commit** from \"[97694dd9bda1746e617b8c9d2ce3f9cf0433a841](https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841)\" to \"[dc0e5244f046105e39281c6af82f60aeb3a94440](https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440)\".",
    "created_at": "2017-05-04T10:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337687",
    "user": "https://github.com/jplab"
}
```

**Changing commit** from "[97694dd9bda1746e617b8c9d2ce3f9cf0433a841](https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841)" to "[dc0e5244f046105e39281c6af82f60aeb3a94440](https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440)".



---

archive/issue_comments_337688.json:
```json
{
    "body": "<a id='comment:29'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841\">97694dd</a></td><td><code>22605: simpler constructor for Polyhedron</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733\">fc5089d</a></td><td><code>Merge branch 'u/vdelecroix/22605' into 22605</code></td></tr></table>\n",
    "created_at": "2017-05-04T10:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337688",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:29'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97694dd9bda1746e617b8c9d2ce3f9cf0433a841">97694dd</a></td><td><code>22605: simpler constructor for Polyhedron</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733">fc5089d</a></td><td><code>Merge branch 'u/vdelecroix/22605' into 22605</code></td></tr></table>




---

archive/issue_comments_337689.json:
```json
{
    "body": "**Changing commit** from \"[dc0e5244f046105e39281c6af82f60aeb3a94440](https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440)\" to \"[fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733](https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733)\".",
    "created_at": "2017-05-04T10:16:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337689",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[dc0e5244f046105e39281c6af82f60aeb3a94440](https://github.com/sagemath/sagetrac-mirror/commit/dc0e5244f046105e39281c6af82f60aeb3a94440)" to "[fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733](https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733)".



---

archive/issue_comments_337690.json:
```json
{
    "body": "<a id='comment:30'></a>\nTests passed on base.py and constructor.py with Sage-8.0.beta3.\n\nThe bots didn't have a look at this yet?!",
    "created_at": "2017-05-04T10:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337690",
    "user": "https://github.com/jplab"
}
```

<a id='comment:30'></a>
Tests passed on base.py and constructor.py with Sage-8.0.beta3.

The bots didn't have a look at this yet?!



---

archive/issue_comments_337691.json:
```json
{
    "body": "<a id='comment:31'></a>\nThe bots are not testing many things see https://github.com/sagemath/sage-patchbot/issues/76",
    "created_at": "2017-05-04T10:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337691",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'></a>
The bots are not testing many things see https://github.com/sagemath/sage-patchbot/issues/76



---

archive/issue_comments_337692.json:
```json
{
    "body": "<a id='comment:32'></a>\n(I just launched mine manually)",
    "created_at": "2017-05-04T10:35:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337692",
    "user": "https://github.com/videlec"
}
```

<a id='comment:32'></a>
(I just launched mine manually)



---

archive/issue_comments_337693.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -28,3 +28,5 @@\n ```\n \n The constructor could try to detect the problem and return an informative message.\n+\n+Once this is fixed, ticket #22552 is a follow-up ticket that should be fixed easily from the present resolution.\n``````\n",
    "created_at": "2017-05-04T10:52:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337693",
    "user": "https://github.com/jplab"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -28,3 +28,5 @@
 ```
 
 The constructor could try to detect the problem and return an informative message.
+
+Once this is fixed, ticket #22552 is a follow-up ticket that should be fixed easily from the present resolution.
``````




---

archive/issue_comments_337694.json:
```json
{
    "body": "<a id='comment:34'></a>\n`.. TESTS:` should be `TESTS:` (no `.. `)",
    "created_at": "2017-05-04T11:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337694",
    "user": "https://github.com/videlec"
}
```

<a id='comment:34'></a>
`.. TESTS:` should be `TESTS:` (no `.. `)



---

archive/issue_comments_337695.json:
```json
{
    "body": "<a id='comment:35'></a>\nAnd in the doctest for float it would actually be good to also test `int` and `Fraction` (from the Python module fractions).",
    "created_at": "2017-05-04T11:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337695",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>
And in the doctest for float it would actually be good to also test `int` and `Fraction` (from the Python module fractions).



---

archive/issue_events_201731.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-05-10T15:41:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201731"
}
```



---

archive/issue_events_201732.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-05-10T15:41:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201732"
}
```



---

archive/issue_comments_337696.json:
```json
{
    "body": "<a id='comment:36'></a>\nSome MIP's tests are broken by the code. I will look into this and correct the docstring too.",
    "created_at": "2017-05-10T15:41:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337696",
    "user": "https://github.com/jplab"
}
```

<a id='comment:36'></a>
Some MIP's tests are broken by the code. I will look into this and correct the docstring too.



---

archive/issue_events_201733.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-06-30T09:22:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201733"
}
```



---

archive/issue_events_201734.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-06-30T09:22:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201734"
}
```



---

archive/issue_comments_337697.json:
```json
{
    "body": "<a id='comment:37'></a>\nhi, \n\ni've adjusted the doctests in MIP and added the `int` construction test to JP's branch.\n\ni had trouble with Python's `Fraction` though:\n\n```\nsage:\u00a0from\u00a0fractions\u00a0import\u00a0Fraction\nsage:\u00a0Polyhedron(vertices=[[Fraction(int(8),\u00a0int(6))]])\n---------------------------------------------------------------------------\nValueError\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Traceback\u00a0(most\u00a0recent\u00a0call\u00a0last)\n<ipython-input-27-199a9229f10f>\u00a0in\u00a0<module>()\n---->\u00a01\u00a0Polyhedron(vertices=[[Fraction(int(Integer(8)),\u00a0int(Integer(6)))]])\n\n\u00a0\n/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/constructor.pyc\u00a0in\u00a0Polyhedron(vertices,\u00a0rays,\u00a0lines,\u00a0ieqs,\u00a0eqns,\u00a0ambient_dim,\u00a0base_ring,\u00a0minimi\nze,\u00a0verbose,\u00a0backend)\n\u00a0\u00a0\u00a0\u00a0497\u00a0\u00a0\u00a0\u00a0\u00a0#\u00a0real\u00a0numbers\n\u00a0\u00a0\u00a0\u00a0498\u00a0\u00a0\u00a0\u00a0\u00a0if\u00a0base_ring\u00a0not\u00a0in\u00a0Rings()\u00a0or\u00a0not\u00a0RDF.has_coerce_map_from(base_ring):\n-->\u00a0499\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0raise\u00a0ValueError(\"invalid\u00a0base\u00a0ring\")\n\u00a0\u00a0\u00a0\u00a0500\n\u00a0\u00a0\u00a0\u00a0501\u00a0\u00a0\u00a0\u00a0\u00a0#\u00a0TODO:\u00a0remove\u00a0this\u00a0hack\n\u00a0\nValueError:\u00a0invalid\u00a0base\u00a0ring\n```\n\nany ideas? \n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17325931132aecd0e0f9f5e4b10717d04abcc4f1\">1732593</a></td><td><code>Merge branch 'develop' into t/22605/22605</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06bb9ca7f8ae0ad4019a217dc72c613b2b8bd514\">06bb9ca</a></td><td><code>Merge branch 'develop' into t/22605/22605</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95\">c58f8b2</a></td><td><code>fix docstring, test int, add QQ example</code></td></tr></table>\n",
    "created_at": "2017-06-30T09:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337697",
    "user": "https://github.com/mforets"
}
```

<a id='comment:37'></a>
hi, 

i've adjusted the doctests in MIP and added the `int` construction test to JP's branch.

i had trouble with Python's `Fraction` though:

```
sage: from fractions import Fraction
sage: Polyhedron(vertices=[[Fraction(int(8), int(6))]])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-27-199a9229f10f> in <module>()
----> 1 Polyhedron(vertices=[[Fraction(int(Integer(8)), int(Integer(6)))]])

 
/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/constructor.pyc in Polyhedron(vertices, rays, lines, ieqs, eqns, ambient_dim, base_ring, minimi
ze, verbose, backend)
    497     # real numbers
    498     if base_ring not in Rings() or not RDF.has_coerce_map_from(base_ring):
--> 499         raise ValueError("invalid base ring")
    500
    501     # TODO: remove this hack
 
ValueError: invalid base ring
```

any ideas? 

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17325931132aecd0e0f9f5e4b10717d04abcc4f1">1732593</a></td><td><code>Merge branch 'develop' into t/22605/22605</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06bb9ca7f8ae0ad4019a217dc72c613b2b8bd514">06bb9ca</a></td><td><code>Merge branch 'develop' into t/22605/22605</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95">c58f8b2</a></td><td><code>fix docstring, test int, add QQ example</code></td></tr></table>




---

archive/issue_comments_337698.json:
```json
{
    "body": "**Changing commit** from \"[fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733](https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733)\" to \"[c58f8b2b1c097d7885cd2547f61692b2428d0a95](https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95)\".",
    "created_at": "2017-06-30T09:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337698",
    "user": "https://github.com/mforets"
}
```

**Changing commit** from "[fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733](https://github.com/sagemath/sagetrac-mirror/commit/fc5089dcb4d33ca2e7b0595a57d8cbc4dccdd733)" to "[c58f8b2b1c097d7885cd2547f61692b2428d0a95](https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95)".



---

archive/issue_comments_337699.json:
```json
{
    "body": "**Changing branch** from \"[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)\" to \"[u/mforets/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/mforets/22605)\".",
    "created_at": "2017-06-30T09:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337699",
    "user": "https://github.com/mforets"
}
```

**Changing branch** from "[u/jipilab/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/jipilab/22605)" to "[u/mforets/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/mforets/22605)".



---

archive/issue_comments_337700.json:
```json
{
    "body": "**Changing author** from \"Jean-Philippe Labb\u00e9, Vincent Delecroix\" to \"Jean-Philippe Labb\u00e9, Vincent Delecroix, Marcelo Forets\".",
    "created_at": "2017-06-30T09:22:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337700",
    "user": "https://github.com/mforets"
}
```

**Changing author** from "Jean-Philippe Labbé, Vincent Delecroix" to "Jean-Philippe Labbé, Vincent Delecroix, Marcelo Forets".



---

archive/issue_events_201735.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-06-30T09:22:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201735"
}
```



---

archive/issue_events_201736.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-06-30T09:22:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201736"
}
```



---

archive/issue_comments_337701.json:
```json
{
    "body": "<a id='comment:38'></a>\nI think that those two functions should be fixed to work with `Fraction`\n\n```\nsage: from sage.structure.coerce import py_scalar_to_element, py_scalar_parent\nsage: f = fractions.Fraction(2r, 3r)\nsage: py_scalar_parent(type(f))    # should be QQ\nsage: py_scalar_to_element(f)      # should be Rational\nFraction(2, 3)\n```\n(could be a dependency ticket)",
    "created_at": "2017-06-30T10:37:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337701",
    "user": "https://github.com/videlec"
}
```

<a id='comment:38'></a>
I think that those two functions should be fixed to work with `Fraction`

```
sage: from sage.structure.coerce import py_scalar_to_element, py_scalar_parent
sage: f = fractions.Fraction(2r, 3r)
sage: py_scalar_parent(type(f))    # should be QQ
sage: py_scalar_to_element(f)      # should be Rational
Fraction(2, 3)
```
(could be a dependency ticket)



---

archive/issue_comments_337702.json:
```json
{
    "body": "**Dependencies:** #23345",
    "created_at": "2017-06-30T14:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337702",
    "user": "https://github.com/videlec"
}
```

**Dependencies:** #23345



---

archive/issue_comments_337703.json:
```json
{
    "body": "<a id='comment:39'></a>\nsee #23345",
    "created_at": "2017-06-30T14:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337703",
    "user": "https://github.com/videlec"
}
```

<a id='comment:39'></a>
see #23345



---

archive/issue_comments_337704.json:
```json
{
    "body": "**Changing commit** from \"[c58f8b2b1c097d7885cd2547f61692b2428d0a95](https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95)\" to \"[59528547d173d803f732b2f1cd8315ac09ceb50c](https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c)\".",
    "created_at": "2017-07-08T11:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337704",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[c58f8b2b1c097d7885cd2547f61692b2428d0a95](https://github.com/sagemath/sagetrac-mirror/commit/c58f8b2b1c097d7885cd2547f61692b2428d0a95)" to "[59528547d173d803f732b2f1cd8315ac09ceb50c](https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c)".



---

archive/issue_comments_337705.json:
```json
{
    "body": "<a id='comment:40'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c\">5952854</a></td><td><code>add fraction example</code></td></tr></table>\n",
    "created_at": "2017-07-08T11:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337705",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:40'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c">5952854</a></td><td><code>add fraction example</code></td></tr></table>




---

archive/issue_events_201737.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-07-12T08:51:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201737"
}
```



---

archive/issue_events_201738.json:
```json
{
    "actor": "https://github.com/jplab",
    "created_at": "2017-07-12T08:51:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201738"
}
```



---

archive/issue_comments_337706.json:
```json
{
    "body": "<a id='comment:41'></a>\nHi all,\n\nI believe that the last issues have been addressed by Marcelo, so I set this to \"needs review\".\n\nWhat is the error given by the bot? A time-out? Yet again, some unknown behavior to me.",
    "created_at": "2017-07-12T08:51:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337706",
    "user": "https://github.com/jplab"
}
```

<a id='comment:41'></a>
Hi all,

I believe that the last issues have been addressed by Marcelo, so I set this to "needs review".

What is the error given by the bot? A time-out? Yet again, some unknown behavior to me.



---

archive/issue_comments_337707.json:
```json
{
    "body": "<a id='comment:42'></a>\nTwo problems from the doctest need to be fixed\n\n```\n$ sage -t geometry/polyhedron/constructor.py\nRunning doctests with ID 2017-07-13-19-29-08-cb0892b4.\nGit branch: 22605-8.0.rc1\nUsing --optional=bliss,lrslib,mpir,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage\nDoctesting 1 file.\nsage -t --warn-long 75.0 geometry/polyhedron/constructor.py\n**********************************************************************\nFile \"geometry/polyhedron/constructor.py\", line 443, in sage.geometry.polyhedron.constructor.?\nFailed example:\n    Polyhedron(vertices=[[f]])\nException raised:\n    Traceback (most recent call last):\n    ...\n    ValueError: invalid base ring\n**********************************************************************\n1 item had failures:\n   1 of  27 in sage.geometry.polyhedron.constructor.?\n    [59 tests, 1 failure, 0.55 s]\n----------------------------------------------------------------------\nsage -t --warn-long 75.0 geometry/polyhedron/constructor.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\n```\n$ sage -t categories/finite_coxeter_groups.py\nRunning doctests with ID 2017-07-13-19-30-14-e608e41e.\nGit branch: 22605-8.0.rc1\nUsing --optional=bliss,lrslib,mpir,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage\nDoctesting 1 file.\nsage -t --warn-long 75.0 categories/finite_coxeter_groups.py\n**********************************************************************\nFile \"categories/finite_coxeter_groups.py\", line 720, in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron\nFailed example:\n    W.permutahedron()\nException raised:\n    Traceback (most recent call last):\n    ...\n    ValueError: invalid base ring\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron\n    [151 tests, 1 failure, 5.21 s]\n----------------------------------------------------------------------\nsage -t --warn-long 75.0 categories/finite_coxeter_groups.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2017-07-13T17:32:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337707",
    "user": "https://github.com/videlec"
}
```

<a id='comment:42'></a>
Two problems from the doctest need to be fixed

```
$ sage -t geometry/polyhedron/constructor.py
Running doctests with ID 2017-07-13-19-29-08-cb0892b4.
Git branch: 22605-8.0.rc1
Using --optional=bliss,lrslib,mpir,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage
Doctesting 1 file.
sage -t --warn-long 75.0 geometry/polyhedron/constructor.py
**********************************************************************
File "geometry/polyhedron/constructor.py", line 443, in sage.geometry.polyhedron.constructor.?
Failed example:
    Polyhedron(vertices=[[f]])
Exception raised:
    Traceback (most recent call last):
    ...
    ValueError: invalid base ring
**********************************************************************
1 item had failures:
   1 of  27 in sage.geometry.polyhedron.constructor.?
    [59 tests, 1 failure, 0.55 s]
----------------------------------------------------------------------
sage -t --warn-long 75.0 geometry/polyhedron/constructor.py  # 1 doctest failed
----------------------------------------------------------------------
```

```
$ sage -t categories/finite_coxeter_groups.py
Running doctests with ID 2017-07-13-19-30-14-e608e41e.
Git branch: 22605-8.0.rc1
Using --optional=bliss,lrslib,mpir,pandoc_attributes,pandocfilters,python2,rst2ipynb,sage
Doctesting 1 file.
sage -t --warn-long 75.0 categories/finite_coxeter_groups.py
**********************************************************************
File "categories/finite_coxeter_groups.py", line 720, in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron
Failed example:
    W.permutahedron()
Exception raised:
    Traceback (most recent call last):
    ...
    ValueError: invalid base ring
**********************************************************************
1 item had failures:
   1 of   6 in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron
    [151 tests, 1 failure, 5.21 s]
----------------------------------------------------------------------
sage -t --warn-long 75.0 categories/finite_coxeter_groups.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_201739.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-13T17:32:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201739"
}
```



---

archive/issue_events_201740.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-13T17:32:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201740"
}
```



---

archive/issue_comments_337708.json:
```json
{
    "body": "<a id='comment:43'></a>\nThe following comment in the test block <code>Check that giving \\`\\`float\\`\\` and \\`\\`int\\`\\` input gets converted to \\`\\RDF\\`</code> should be modified since int are converted to elements of ZZ and not RDF. Furthermore, replace <code>\\`\\RDF\\`</code> by <code>\\`\\`RDF\\`\\`</code>.",
    "created_at": "2017-07-13T17:40:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337708",
    "user": "https://github.com/videlec"
}
```

<a id='comment:43'></a>
The following comment in the test block <code>Check that giving \`\`float\`\` and \`\`int\`\` input gets converted to \`\RDF\`</code> should be modified since int are converted to elements of ZZ and not RDF. Furthermore, replace <code>\`\RDF\`</code> by <code>\`\`RDF\`\`</code>.



---

archive/issue_comments_337709.json:
```json
{
    "body": "<a id='comment:44'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83bf93242d9ffb791034daea87d91701b57eeaae\">83bf932</a></td><td><code>23345: conversions from Fraction to Rational</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce7fb25dceab06ce630824ff071ce840b439bd38\">ce7fb25</a></td><td><code>23345: make it faster</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e238c9e321d5f2c46c5553ac75555e9a6f09aef7\">e238c9e</a></td><td><code>address reviewer's comments</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e80700a40a406a17df24f95ebf51cdcab1279864\">e80700a</a></td><td><code>Merge branch 't/23345/23345' into t/22605/22605</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec\">6be64b1</a></td><td><code>fix docstring for int</code></td></tr></table>\n",
    "created_at": "2017-07-23T19:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337709",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:44'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83bf93242d9ffb791034daea87d91701b57eeaae">83bf932</a></td><td><code>23345: conversions from Fraction to Rational</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce7fb25dceab06ce630824ff071ce840b439bd38">ce7fb25</a></td><td><code>23345: make it faster</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e238c9e321d5f2c46c5553ac75555e9a6f09aef7">e238c9e</a></td><td><code>address reviewer's comments</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e80700a40a406a17df24f95ebf51cdcab1279864">e80700a</a></td><td><code>Merge branch 't/23345/23345' into t/22605/22605</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec">6be64b1</a></td><td><code>fix docstring for int</code></td></tr></table>




---

archive/issue_comments_337710.json:
```json
{
    "body": "**Changing commit** from \"[59528547d173d803f732b2f1cd8315ac09ceb50c](https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c)\" to \"[6be64b1450da31f2cc955ba74d7203ebe2ce3bec](https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec)\".",
    "created_at": "2017-07-23T19:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337710",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[59528547d173d803f732b2f1cd8315ac09ceb50c](https://github.com/sagemath/sagetrac-mirror/commit/59528547d173d803f732b2f1cd8315ac09ceb50c)" to "[6be64b1450da31f2cc955ba74d7203ebe2ce3bec](https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec)".



---

archive/issue_comments_337711.json:
```json
{
    "body": "<a id='comment:45'></a>\n- [comment:42](#comment%3A42), doctest in `constructor.py`, done (upon merging with #23345)\n- [comment:42](#comment%3A42), doctest in `finite_coxeter_groups.py` : i'm confused. the UniversalCyclotomicField should still be supported in the constructor, right? in this case:\n\n    - the base ring is `UniversalCyclotomicField()`, and `base_ring not in Rings()` is False\n    - `RDF.has_coerce_map_from(UniversalCyclotomicField())` is also False\n- [comment:43](#comment%3A43), done",
    "created_at": "2017-07-23T19:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337711",
    "user": "https://github.com/mforets"
}
```

<a id='comment:45'></a>
- [comment:42](#comment%3A42), doctest in `constructor.py`, done (upon merging with #23345)
- [comment:42](#comment%3A42), doctest in `finite_coxeter_groups.py` : i'm confused. the UniversalCyclotomicField should still be supported in the constructor, right? in this case:

    - the base ring is `UniversalCyclotomicField()`, and `base_ring not in Rings()` is False
    - `RDF.has_coerce_map_from(UniversalCyclotomicField())` is also False
- [comment:43](#comment%3A43), done



---

archive/issue_comments_337712.json:
```json
{
    "body": "<a id='comment:46'></a>\nThe universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?",
    "created_at": "2017-07-23T21:08:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337712",
    "user": "https://github.com/videlec"
}
```

<a id='comment:46'></a>
The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?



---

archive/issue_comments_337713.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [@videlec](#comment%3A46):\n> The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?\n\nOk, thanks for the clarification. i look forward to suggestions on that choice (since i don't have one).",
    "created_at": "2017-07-25T14:38:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337713",
    "user": "https://github.com/mforets"
}
```

<a id='comment:47'></a>
Replying to [@videlec](#comment%3A46):
> The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?

Ok, thanks for the clarification. i look forward to suggestions on that choice (since i don't have one).



---

archive/issue_comments_337714.json:
```json
{
    "body": "<a id='comment:48'></a>\nReplying to [@mforets](#comment%3A47):\n> Replying to [@videlec](#comment%3A46):\n> > The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?\n\n> \n> Ok, thanks for the clarification. i look forward to suggestions on that choice (since i don't have one).\n\nI think an error is safer. The code in Coxeter group that constructs the polytope should call `Polyhedron` with an appropriate base ring (like `AA` or `QQ[cos(pi/q)]`).",
    "created_at": "2017-07-25T14:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337714",
    "user": "https://github.com/videlec"
}
```

<a id='comment:48'></a>
Replying to [@mforets](#comment%3A47):
> Replying to [@videlec](#comment%3A46):
> > The universal cyclotomic field is the **complex** field generated by all roots of unity! We don't want to deal with that in polyhedron constructor (as we don't for `QQbar`). For both `QQbar` and `UCF` we can either try conversion to `AA` or raise an error. Which one do you prefer?

> 
> Ok, thanks for the clarification. i look forward to suggestions on that choice (since i don't have one).

I think an error is safer. The code in Coxeter group that constructs the polytope should call `Polyhedron` with an appropriate base ring (like `AA` or `QQ[cos(pi/q)]`).



---

archive/issue_comments_337715.json:
```json
{
    "body": "<a id='comment:49'></a>\nThe following does work\n\n```\nsage: W = CoxeterGroup(['I',7])\nsage: n = W.one().canonical_matrix().rank()\nsage: weights = W.fundamental_weights()\nsage: point = [ZZ.one()] * n\nsage: v = sum(point[i-1] * weights[i] for i in weights.keys())\nsage: vertices = [(v*w).change_ring(AA) for w in W]\nsage: Polyhedron(vertices)\n```\nIt is perhaps not optimal, but fixes the issue with Coxeter groups.",
    "created_at": "2017-07-25T14:50:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337715",
    "user": "https://github.com/videlec"
}
```

<a id='comment:49'></a>
The following does work

```
sage: W = CoxeterGroup(['I',7])
sage: n = W.one().canonical_matrix().rank()
sage: weights = W.fundamental_weights()
sage: point = [ZZ.one()] * n
sage: v = sum(point[i-1] * weights[i] for i in weights.keys())
sage: vertices = [(v*w).change_ring(AA) for w in W]
sage: Polyhedron(vertices)
```
It is perhaps not optimal, but fixes the issue with Coxeter groups.



---

archive/issue_comments_337716.json:
```json
{
    "body": "<a id='comment:50'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5\">128235e</a></td><td><code>convert UCF and QQbar to AA in permutahedron</code></td></tr></table>\n",
    "created_at": "2017-07-25T16:48:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337716",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:50'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5">128235e</a></td><td><code>convert UCF and QQbar to AA in permutahedron</code></td></tr></table>




---

archive/issue_comments_337717.json:
```json
{
    "body": "**Changing commit** from \"[6be64b1450da31f2cc955ba74d7203ebe2ce3bec](https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec)\" to \"[128235e58c243925a51dfc5d07b18c24d2894eb5](https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5)\".",
    "created_at": "2017-07-25T16:48:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337717",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[6be64b1450da31f2cc955ba74d7203ebe2ce3bec](https://github.com/sagemath/sagetrac-mirror/commit/6be64b1450da31f2cc955ba74d7203ebe2ce3bec)" to "[128235e58c243925a51dfc5d07b18c24d2894eb5](https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5)".



---

archive/issue_events_201741.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-07-25T16:49:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201741"
}
```



---

archive/issue_events_201742.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-07-25T16:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201742"
}
```



---

archive/issue_comments_337718.json:
```json
{
    "body": "<a id='comment:52'></a>\ndisclaimer: i didn't run those tests which require the optional GAP3 package 'chevie'. if someone has it installed already, could you try it please?",
    "created_at": "2017-07-25T16:55:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337718",
    "user": "https://github.com/mforets"
}
```

<a id='comment:52'></a>
disclaimer: i didn't run those tests which require the optional GAP3 package 'chevie'. if someone has it installed already, could you try it please?



---

archive/issue_comments_337719.json:
```json
{
    "body": "<a id='comment:53'></a>\nReplying to [@mforets](#comment%3A52):\n> disclaimer: i didn't run those tests which require the optional GAP3 package 'chevie'. if someone has it installed already, could you try it please? \n\nTravis: After this ticket, it will be forbidden to use `UCF` and `QQbar` as ground fields for polytopes. I believe that you have GAP3 installed. Could you check that we do not break anything for generating the polyhedra related to Coxeter groups?",
    "created_at": "2017-07-26T07:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337719",
    "user": "https://github.com/videlec"
}
```

<a id='comment:53'></a>
Replying to [@mforets](#comment%3A52):
> disclaimer: i didn't run those tests which require the optional GAP3 package 'chevie'. if someone has it installed already, could you try it please? 

Travis: After this ticket, it will be forbidden to use `UCF` and `QQbar` as ground fields for polytopes. I believe that you have GAP3 installed. Could you check that we do not break anything for generating the polyhedra related to Coxeter groups?



---

archive/issue_comments_337720.json:
```json
{
    "body": "<a id='comment:54'></a>\ni was getting:\n\n```\nsage: W = ReflectionGroup(['A',3])\n...\nImportError: the GAP3 package 'chevie' is needed to work with (complex) reflection groups\nsage: is_package_installed(\"gap3\")\nFalse\n```\n\nand got scared with the message below.. but installing turned out to be very fast!\n\n```\n===========================\u00a0WARNING\u00a0===========================\nYou\u00a0are\u00a0about\u00a0to\u00a0download\u00a0and\u00a0install\u00a0the\u00a0experimental\u00a0package\ngap3-01may17.\u00a0\u00a0This\u00a0probably\u00a0won't\u00a0work\u00a0at\u00a0all\u00a0for\u00a0you!\u00a0There\nis\u00a0no\u00a0guarantee\u00a0that\u00a0it\u00a0will\u00a0build\u00a0correctly,\u00a0or\u00a0behave\u00a0as\nexpected.\u00a0Use\u00a0at\u00a0your\u00a0own\u00a0risk!\n===============================================================\n...\n```\n\nanyway, testing with `--optional=gap3` flag i do find problems. those tests with the `ReflectionGroup` and integer base ring were failing. \n\nin the new commit, i'm 'hardcoding' the base ring that is passed to the constructor to be QQ in those cases (before, this was guessed from the vertices). what do you think?",
    "created_at": "2017-07-26T08:59:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337720",
    "user": "https://github.com/mforets"
}
```

<a id='comment:54'></a>
i was getting:

```
sage: W = ReflectionGroup(['A',3])
...
ImportError: the GAP3 package 'chevie' is needed to work with (complex) reflection groups
sage: is_package_installed("gap3")
False
```

and got scared with the message below.. but installing turned out to be very fast!

```
=========================== WARNING ===========================
You are about to download and install the experimental package
gap3-01may17.  This probably won't work at all for you! There
is no guarantee that it will build correctly, or behave as
expected. Use at your own risk!
===============================================================
...
```

anyway, testing with `--optional=gap3` flag i do find problems. those tests with the `ReflectionGroup` and integer base ring were failing. 

in the new commit, i'm 'hardcoding' the base ring that is passed to the constructor to be QQ in those cases (before, this was guessed from the vertices). what do you think?



---

archive/issue_comments_337721.json:
```json
{
    "body": "<a id='comment:55'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6\">579e33f</a></td><td><code>transform to QQ ring for reflection groups</code></td></tr></table>\n",
    "created_at": "2017-07-26T09:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337721",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:55'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6">579e33f</a></td><td><code>transform to QQ ring for reflection groups</code></td></tr></table>




---

archive/issue_comments_337722.json:
```json
{
    "body": "**Changing commit** from \"[128235e58c243925a51dfc5d07b18c24d2894eb5](https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5)\" to \"[579e33f22d5a5674b6196ba6fc3da53dae5b9aa6](https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6)\".",
    "created_at": "2017-07-26T09:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337722",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[128235e58c243925a51dfc5d07b18c24d2894eb5](https://github.com/sagemath/sagetrac-mirror/commit/128235e58c243925a51dfc5d07b18c24d2894eb5)" to "[579e33f22d5a5674b6196ba6fc3da53dae5b9aa6](https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6)".



---

archive/issue_comments_337723.json:
```json
{
    "body": "<a id='comment:56'></a>\nwith respect to the tests, it also works to infer the base ring from the sum over weights v, that is:\n\n```\nif base_ring is None:\n    base_ring = v.base_ring()\n```\n\ninstead of\n\n```\nif base_ring is None:\n    base_ring = self.base_ring()\n    if base_ring is ZZ:\n        base_ring = QQ\n```",
    "created_at": "2017-07-26T09:31:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337723",
    "user": "https://github.com/mforets"
}
```

<a id='comment:56'></a>
with respect to the tests, it also works to infer the base ring from the sum over weights v, that is:

```
if base_ring is None:
    base_ring = v.base_ring()
```

instead of

```
if base_ring is None:
    base_ring = self.base_ring()
    if base_ring is ZZ:
        base_ring = QQ
```



---

archive/issue_events_201743.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-26T12:54:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201743"
}
```



---

archive/issue_events_201744.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-26T12:54:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201744"
}
```



---

archive/issue_comments_337724.json:
```json
{
    "body": "<a id='comment:57'></a>\n`@`Marcelo: this beahvior is bad\n\n```\nsage: W = CoxeterGroup(['I',7])\nsage: W.permutahedron(base_ring=QQbar).base_ring() is QQbar\nFalse\n```\nIf the user supplies explicitely a `base_ring` in the method `permutahedron()` then it should be used. The above example should be an error (that would be raised by the polyhedron constructor). The automatic conversion `QQbar -> AA` and `UCF -> AA` should only be done when the user calls `permutahedron()` without specifying the base ring.",
    "created_at": "2017-07-26T12:54:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337724",
    "user": "https://github.com/videlec"
}
```

<a id='comment:57'></a>
`@`Marcelo: this beahvior is bad

```
sage: W = CoxeterGroup(['I',7])
sage: W.permutahedron(base_ring=QQbar).base_ring() is QQbar
False
```
If the user supplies explicitely a `base_ring` in the method `permutahedron()` then it should be used. The above example should be an error (that would be raised by the polyhedron constructor). The automatic conversion `QQbar -> AA` and `UCF -> AA` should only be done when the user calls `permutahedron()` without specifying the base ring.



---

archive/issue_comments_337725.json:
```json
{
    "body": "<a id='comment:58'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33\">6f6d0f3</a></td><td><code>fix behaviour with QQbar and simplify it</code></td></tr></table>\n",
    "created_at": "2017-07-26T18:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337725",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:58'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33">6f6d0f3</a></td><td><code>fix behaviour with QQbar and simplify it</code></td></tr></table>




---

archive/issue_comments_337726.json:
```json
{
    "body": "**Changing commit** from \"[579e33f22d5a5674b6196ba6fc3da53dae5b9aa6](https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6)\" to \"[6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33](https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33)\".",
    "created_at": "2017-07-26T18:22:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337726",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[579e33f22d5a5674b6196ba6fc3da53dae5b9aa6](https://github.com/sagemath/sagetrac-mirror/commit/579e33f22d5a5674b6196ba6fc3da53dae5b9aa6)" to "[6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33](https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33)".



---

archive/issue_events_201745.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-07-26T18:22:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201745"
}
```



---

archive/issue_events_201746.json:
```json
{
    "actor": "https://github.com/mforets",
    "created_at": "2017-07-26T18:22:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201746"
}
```



---

archive/issue_comments_337727.json:
```json
{
    "body": "<a id='comment:60'></a>\nHere\n\n```\n+            if base_ring is None and v.base_ring() in [UniversalCyclotomicField(), QQbar]:\n+                    vertices = [(v*w).change_ring(AA) for w in self]\n```\nyou have an identation with 8 spaces!",
    "created_at": "2017-07-27T10:10:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337727",
    "user": "https://github.com/videlec"
}
```

<a id='comment:60'></a>
Here

```
+            if base_ring is None and v.base_ring() in [UniversalCyclotomicField(), QQbar]:
+                    vertices = [(v*w).change_ring(AA) for w in self]
```
you have an identation with 8 spaces!



---

archive/issue_comments_337728.json:
```json
{
    "body": "<a id='comment:61'></a>\nAnd concerning the same piece of code, it would be simpler to do\n\n```\nvertices = [v*w for w in self]\nif base_ring is None and v.base_ring() in [UniversalCyclotomicField(), QQbar]:\n    vertices = [v.change_ring(AA) for v in vertices]\n    base_ring = AA\n```",
    "created_at": "2017-07-27T10:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337728",
    "user": "https://github.com/videlec"
}
```

<a id='comment:61'></a>
And concerning the same piece of code, it would be simpler to do

```
vertices = [v*w for w in self]
if base_ring is None and v.base_ring() in [UniversalCyclotomicField(), QQbar]:
    vertices = [v.change_ring(AA) for v in vertices]
    base_ring = AA
```



---

archive/issue_comments_337729.json:
```json
{
    "body": "**Changing commit** from \"[6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33](https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33)\" to \"[af03de82ed07686322db70895a0ab34973888981](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)\".",
    "created_at": "2017-07-27T11:09:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337729",
    "user": "https://github.com/sagetrac-git"
}
```

**Changing commit** from "[6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33](https://github.com/sagemath/sagetrac-mirror/commit/6f6d0f35bd8fda02e538e3ead1a8dd5e3ec5ef33)" to "[af03de82ed07686322db70895a0ab34973888981](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)".



---

archive/issue_comments_337730.json:
```json
{
    "body": "<a id='comment:62'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981\">af03de8</a></td><td><code>fix indentation issue, and simplify</code></td></tr></table>\n",
    "created_at": "2017-07-27T11:09:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337730",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:62'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981">af03de8</a></td><td><code>fix indentation issue, and simplify</code></td></tr></table>




---

archive/issue_comments_337731.json:
```json
{
    "body": "<a id='comment:63'></a>\nReplying to [git](#comment%3A62):\n> Branch pushed to git repo; I updated commit sha1. **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981\">af03de8</a></td><td><code>fix indentation issue, and simplify</code></td></tr></table>\n\n`@`vdelec: you're right, thanks.",
    "created_at": "2017-07-27T11:13:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337731",
    "user": "https://github.com/mforets"
}
```

<a id='comment:63'></a>
Replying to [git](#comment%3A62):
> Branch pushed to git repo; I updated commit sha1. **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981">af03de8</a></td><td><code>fix indentation issue, and simplify</code></td></tr></table>

`@`vdelec: you're right, thanks.



---

archive/issue_comments_337732.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2017-07-27T13:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337732",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_337733.json:
```json
{
    "body": "<a id='comment:64'></a>\nThis is a great improvement! Thank you!",
    "created_at": "2017-07-27T13:19:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337733",
    "user": "https://github.com/videlec"
}
```

<a id='comment:64'></a>
This is a great improvement! Thank you!



---

archive/issue_events_201747.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-27T13:19:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201747"
}
```



---

archive/issue_events_201748.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-07-27T13:19:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201748"
}
```



---

archive/issue_comments_337734.json:
```json
{
    "body": "**Changing branch** from \"[u/mforets/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/mforets/22605)\" to \"[af03de82ed07686322db70895a0ab34973888981](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)\".",
    "created_at": "2017-07-29T15:30:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22605#issuecomment-337734",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mforets/22605](https://github.com/sagemath/sagetrac-mirror/tree/u/mforets/22605)" to "[af03de82ed07686322db70895a0ab34973888981](https://github.com/sagemath/sagetrac-mirror/commit/af03de82ed07686322db70895a0ab34973888981)".



---

archive/issue_events_201749.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-07-29T15:30:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201749"
}
```



---

archive/issue_events_201750.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "84f4bec421e11342d43d74290ed0fb5399b64a11",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-07-29T15:30:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22605",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22605#event-201750"
}
```
