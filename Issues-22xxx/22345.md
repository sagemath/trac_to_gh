# Issue 22345: Elliptic curve isogenies over number fields II: implement Billerey's algorithm for reducible primes

archive/issues_022108.json:
```json
{
    "body": "This follows in from #22343 which is a dependency.  We implement Billerey's algorithm for finding the set of reducible primes for an elliptic curve without CM over a number field.  This is based on an implementation by Ciaran Schembri for a masters' project at Warwick.\n\n**CC:**  @adeines @kedlaya\n\n**Keywords:** elliptic curves, isogenies, number fields\n\n**Branch/Commit:** [2423f7aa9cd4523bc82a4627513acbcf13b786ae](https://github.com/sagemath/sagetrac-mirror/commit/2423f7aa9cd4523bc82a4627513acbcf13b786ae)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** John Cremona\n\nIssue created by migration from https://trac.sagemath.org/ticket/22345\n\n",
    "closed_at": "2018-08-11T16:55:06Z",
    "created_at": "2017-02-10T14:41:12Z",
    "labels": [
        "component: elliptic curves",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Elliptic curve isogenies over number fields II: implement Billerey's algorithm for reducible primes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22345",
    "user": "https://github.com/JohnCremona"
}
```
This follows in from #22343 which is a dependency.  We implement Billerey's algorithm for finding the set of reducible primes for an elliptic curve without CM over a number field.  This is based on an implementation by Ciaran Schembri for a masters' project at Warwick.

**CC:**  @adeines @kedlaya

**Keywords:** elliptic curves, isogenies, number fields

**Branch/Commit:** [2423f7aa9cd4523bc82a4627513acbcf13b786ae](https://github.com/sagemath/sagetrac-mirror/commit/2423f7aa9cd4523bc82a4627513acbcf13b786ae)

**Reviewer:** Frédéric Chapoton

**Author:** John Cremona

Issue created by migration from https://trac.sagemath.org/ticket/22345





---

archive/issue_comments_396020.json:
```json
{
    "body": "**Branch:** [u/aly.deines/elliptic_curve_isogenies_over_number_fields_ii__implement_billeray_s_algorithm_for_reducible_primes](https://github.com/sagemath/sagetrac-mirror/tree/u/aly.deines/elliptic_curve_isogenies_over_number_fields_ii__implement_billeray_s_algorithm_for_reducible_primes)",
    "created_at": "2017-07-22T16:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396020",
    "user": "https://github.com/adeines"
}
```

**Branch:** [u/aly.deines/elliptic_curve_isogenies_over_number_fields_ii__implement_billeray_s_algorithm_for_reducible_primes](https://github.com/sagemath/sagetrac-mirror/tree/u/aly.deines/elliptic_curve_isogenies_over_number_fields_ii__implement_billeray_s_algorithm_for_reducible_primes)



---

archive/issue_comments_396021.json:
```json
{
    "body": "**Commit:** [bfe5ca4f9bdd21e47a9e87560b516f158cd9a58a](https://github.com/sagemath/sagetrac-mirror/commit/bfe5ca4f9bdd21e47a9e87560b516f158cd9a58a)",
    "created_at": "2017-07-22T16:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396021",
    "user": "https://github.com/adeines"
}
```

**Commit:** [bfe5ca4f9bdd21e47a9e87560b516f158cd9a58a](https://github.com/sagemath/sagetrac-mirror/commit/bfe5ca4f9bdd21e47a9e87560b516f158cd9a58a)



---

archive/issue_comments_396022.json:
```json
{
    "body": "<a id='comment:2'></a>\nI started putting Cremona's code for Billerey's algorithm into appropriate places in Sage.  I cleaned it up a bit and addes some documentations.  \n\nThings left to do or fix:\n* add documentation\n* only works if the curve has integral discriminant\n* incorporate into isogeny finding for EC's over number fields\n* more examples, especially over larger fields\n* timings against other methods\n* probably more . . .",
    "created_at": "2017-07-22T16:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396022",
    "user": "https://github.com/adeines"
}
```

<a id='comment:2'></a>
I started putting Cremona's code for Billerey's algorithm into appropriate places in Sage.  I cleaned it up a bit and addes some documentations.  

Things left to do or fix:
* add documentation
* only works if the curve has integral discriminant
* incorporate into isogeny finding for EC's over number fields
* more examples, especially over larger fields
* timings against other methods
* probably more . . .



---

archive/issue_comments_396023.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"elliptic curves, isogenies, number fields\".",
    "created_at": "2017-07-22T16:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396023",
    "user": "https://github.com/adeines"
}
```

**Changing keywords** from "" to "elliptic curves, isogenies, number fields".



---

archive/issue_events_066846.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2017-07-22T17:00:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22345#event-66846"
}
```



---

archive/issue_comments_396024.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks for the work so far.  I'm working on this again now and will go through your to-do list.",
    "created_at": "2017-08-01T10:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396024",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:5'></a>
Thanks for the work so far.  I'm working on this again now and will go through your to-do list.



---

archive/issue_comments_396025.json:
```json
{
    "body": "<a id='comment:6'></a>\nI have rearranged the code quite a bit.  The technical parts of Billerey I though were better kept separate and not as methods of the elliptic curve class itself, so I put them in gal_reps_number_field.py.  (Alternatives were a new file, or on isogeny_class.py.)   In isogeny_class.py I also refactored the code to produce a finite set of primes, separating out the cm case, and allowing the user a choice of 3 algorithms, Billerey, Larson or 'heuristic', the latter being non-rigorous, just testing all primes up a to a given bound to see if they passthe necessary local conditions.  This is never the default and the docstring makes it clear that the output is not guaranteed complete.\n\nThis leaves a much simplified method reducible_primes() in the elliptic curves class itself, while the isogeny class code uses the new function to find the reducible primes, with Billerey the default algorithm.\n\nI could put in more examples if desired.  I have not done systematic timing tests, but note that until the work done on another ticket Larson's method could not handle fields of degree 5 and up at all.\n\nWhile writing this I realised that I have not yet provided the possibility for E.isogeny_class() to use a non-default algorithm, and will add that, but I'll leave the ticket at \"needs review\" so that patchbots get working on it.",
    "created_at": "2017-08-02T14:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396025",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:6'></a>
I have rearranged the code quite a bit.  The technical parts of Billerey I though were better kept separate and not as methods of the elliptic curve class itself, so I put them in gal_reps_number_field.py.  (Alternatives were a new file, or on isogeny_class.py.)   In isogeny_class.py I also refactored the code to produce a finite set of primes, separating out the cm case, and allowing the user a choice of 3 algorithms, Billerey, Larson or 'heuristic', the latter being non-rigorous, just testing all primes up a to a given bound to see if they passthe necessary local conditions.  This is never the default and the docstring makes it clear that the output is not guaranteed complete.

This leaves a much simplified method reducible_primes() in the elliptic curves class itself, while the isogeny class code uses the new function to find the reducible primes, with Billerey the default algorithm.

I could put in more examples if desired.  I have not done systematic timing tests, but note that until the work done on another ticket Larson's method could not handle fields of degree 5 and up at all.

While writing this I realised that I have not yet provided the possibility for E.isogeny_class() to use a non-default algorithm, and will add that, but I'll leave the ticket at "needs review" so that patchbots get working on it.



---

archive/issue_comments_396026.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2017-08-02T14:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396026",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_396027.json:
```json
{
    "body": "**Changing branch** from \"[u/aly.deines/elliptic_curve_isogenies_over_number_fields_ii__implement_billeray_s_algorithm_for_reducible_primes](https://github.com/sagemath/sagetrac-mirror/tree/u/aly.deines/elliptic_curve_isogenies_over_number_fields_ii__implement_billeray_s_algorithm_for_reducible_primes)\" to \"[u/cremona/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/22345)\".",
    "created_at": "2017-08-02T14:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396027",
    "user": "https://github.com/JohnCremona"
}
```

**Changing branch** from "[u/aly.deines/elliptic_curve_isogenies_over_number_fields_ii__implement_billeray_s_algorithm_for_reducible_primes](https://github.com/sagemath/sagetrac-mirror/tree/u/aly.deines/elliptic_curve_isogenies_over_number_fields_ii__implement_billeray_s_algorithm_for_reducible_primes)" to "[u/cremona/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/22345)".



---

archive/issue_comments_396028.json:
```json
{
    "body": "**Changing commit** from \"[bfe5ca4f9bdd21e47a9e87560b516f158cd9a58a](https://github.com/sagemath/sagetrac-mirror/commit/bfe5ca4f9bdd21e47a9e87560b516f158cd9a58a)\" to \"[1a1e7a6b6cda1c22de1e6711bb4c320ac0506047](https://github.com/sagemath/sagetrac-mirror/commit/1a1e7a6b6cda1c22de1e6711bb4c320ac0506047)\".",
    "created_at": "2017-08-02T14:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396028",
    "user": "https://github.com/JohnCremona"
}
```

**Changing commit** from "[bfe5ca4f9bdd21e47a9e87560b516f158cd9a58a](https://github.com/sagemath/sagetrac-mirror/commit/bfe5ca4f9bdd21e47a9e87560b516f158cd9a58a)" to "[1a1e7a6b6cda1c22de1e6711bb4c320ac0506047](https://github.com/sagemath/sagetrac-mirror/commit/1a1e7a6b6cda1c22de1e6711bb4c320ac0506047)".



---

archive/issue_comments_396029.json:
```json
{
    "body": "<a id='comment:7'></a>\nSome timings: with z=zeta_101 and E=[0,1,0,z,z], reducible_primes_naive(E) with default parameters (max_l=1000, num_P=100) returns [2, 607] in 2m, while reducible_primes_naive(E, max_l=2000, num_P=200) returns [2] in about the same time (starting from scratch; if you do the second right after the first it is faster since some previous work is cached).\nWorking on this example revealed something stupid only indirectly relevant to this ticket:  computing the 2-isogeny takes for ever!  The stupid reason is that after computing the isogenous curve it tries to compute its global_minimal model.  Which involves computing the class group of K.....\nThat needs fixing somehow but on a different ticket.",
    "created_at": "2017-08-02T16:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396029",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>
Some timings: with z=zeta_101 and E=[0,1,0,z,z], reducible_primes_naive(E) with default parameters (max_l=1000, num_P=100) returns [2, 607] in 2m, while reducible_primes_naive(E, max_l=2000, num_P=200) returns [2] in about the same time (starting from scratch; if you do the second right after the first it is faster since some previous work is cached).
Working on this example revealed something stupid only indirectly relevant to this ticket:  computing the 2-isogeny takes for ever!  The stupid reason is that after computing the isogenous curve it tries to compute its global_minimal model.  Which involves computing the class group of K.....
That needs fixing somehow but on a different ticket.



---

archive/issue_comments_396030.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05\">d3643b5</a></td><td><code>#22345 improved e.c. isogenies over number fields</code></td></tr></table>\n",
    "created_at": "2017-08-04T14:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396030",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05">d3643b5</a></td><td><code>#22345 improved e.c. isogenies over number fields</code></td></tr></table>




---

archive/issue_comments_396031.json:
```json
{
    "body": "**Changing commit** from \"[1a1e7a6b6cda1c22de1e6711bb4c320ac0506047](https://github.com/sagemath/sagetrac-mirror/commit/1a1e7a6b6cda1c22de1e6711bb4c320ac0506047)\" to \"[d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05](https://github.com/sagemath/sagetrac-mirror/commit/d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05)\".",
    "created_at": "2017-08-04T14:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396031",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1a1e7a6b6cda1c22de1e6711bb4c320ac0506047](https://github.com/sagemath/sagetrac-mirror/commit/1a1e7a6b6cda1c22de1e6711bb4c320ac0506047)" to "[d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05](https://github.com/sagemath/sagetrac-mirror/commit/d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05)".



---

archive/issue_comments_396032.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe last commit makes several improvements after more testing.  In Billerey's algorithm itself the improvement is to only use B. to find reducible primes greater than some lower bound (default 200) which never occur in practice, using the local test for smaller primes.  Secondly, after noticing that some \"easy\" examples were taking forever on account of class group computations (which in turn are triggered by the conversion to global minimal models) I added a minimal_models flag which defaults to True to give the old behaviour but which can be set to False.  New doctest to illustrate this are added.  This flag had to be put into dozens of places from the top-level E.isogeny_class() down through various layers to the underlying isogeny code.\n\nI am currently checking that all the additional docstrings compile OK...",
    "created_at": "2017-08-04T14:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396032",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:9'></a>
The last commit makes several improvements after more testing.  In Billerey's algorithm itself the improvement is to only use B. to find reducible primes greater than some lower bound (default 200) which never occur in practice, using the local test for smaller primes.  Secondly, after noticing that some "easy" examples were taking forever on account of class group computations (which in turn are triggered by the conversion to global minimal models) I added a minimal_models flag which defaults to True to give the old behaviour but which can be set to False.  New doctest to illustrate this are added.  This flag had to be put into dozens of places from the top-level E.isogeny_class() down through various layers to the underlying isogeny code.

I am currently checking that all the additional docstrings compile OK...



---

archive/issue_comments_396033.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2017-08-04T14:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396033",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_396034.json:
```json
{
    "body": "**Changing commit** from \"[d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05](https://github.com/sagemath/sagetrac-mirror/commit/d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05)\" to \"[252f04856bc6c61a11ebf3cc85dd86b656771bdd](https://github.com/sagemath/sagetrac-mirror/commit/252f04856bc6c61a11ebf3cc85dd86b656771bdd)\".",
    "created_at": "2017-08-04T15:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396034",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05](https://github.com/sagemath/sagetrac-mirror/commit/d3643b5fa076eb17231a1b4ca7d3a2a9e9bb5e05)" to "[252f04856bc6c61a11ebf3cc85dd86b656771bdd](https://github.com/sagemath/sagetrac-mirror/commit/252f04856bc6c61a11ebf3cc85dd86b656771bdd)".



---

archive/issue_comments_396035.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/252f04856bc6c61a11ebf3cc85dd86b656771bdd\">252f048</a></td><td><code>#22345 fixed some bad docstrings</code></td></tr></table>\n",
    "created_at": "2017-08-04T15:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396035",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/252f04856bc6c61a11ebf3cc85dd86b656771bdd">252f048</a></td><td><code>#22345 fixed some bad docstrings</code></td></tr></table>




---

archive/issue_comments_396036.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2017-08-04T15:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396036",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_events_066847.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "rename": {
        "from": "Elliptic curve isogenies over number fields II: implement Billeray's algorithm for reducible primes",
        "to": "Elliptic curve isogenies over number fields II: implement Billerey's algorithm for reducible primes"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22345#event-66847"
}
```



---

archive/issue_comments_396037.json:
```json
{
    "body": "<a id='comment:14'></a>\nLooks like this need rebasing, or is it only trac's git which is not smart enough?",
    "created_at": "2017-08-21T16:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396037",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:14'></a>
Looks like this need rebasing, or is it only trac's git which is not smart enough?



---

archive/issue_comments_396038.json:
```json
{
    "body": "<a id='comment:15'></a>\nI'll rebase. I thought it was based on a recent version but maybe not",
    "created_at": "2017-08-21T18:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396038",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:15'></a>
I'll rebase. I thought it was based on a recent version but maybe not



---

archive/issue_comments_396039.json:
```json
{
    "body": "**Changing commit** from \"[252f04856bc6c61a11ebf3cc85dd86b656771bdd](https://github.com/sagemath/sagetrac-mirror/commit/252f04856bc6c61a11ebf3cc85dd86b656771bdd)\" to \"[645c6b7c2904204b1c2e1bedff6264c99abed4ef](https://github.com/sagemath/sagetrac-mirror/commit/645c6b7c2904204b1c2e1bedff6264c99abed4ef)\".",
    "created_at": "2017-08-22T07:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396039",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[252f04856bc6c61a11ebf3cc85dd86b656771bdd](https://github.com/sagemath/sagetrac-mirror/commit/252f04856bc6c61a11ebf3cc85dd86b656771bdd)" to "[645c6b7c2904204b1c2e1bedff6264c99abed4ef](https://github.com/sagemath/sagetrac-mirror/commit/645c6b7c2904204b1c2e1bedff6264c99abed4ef)".



---

archive/issue_comments_396040.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70b8f12e61587bcbec409a6e3a5bb8e3996f56fa\">70b8f12</a></td><td><code>Merge branch 'develop' into 22345</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/645c6b7c2904204b1c2e1bedff6264c99abed4ef\">645c6b7</a></td><td><code>#22345 rebase + small speedup</code></td></tr></table>\n",
    "created_at": "2017-08-22T07:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396040",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70b8f12e61587bcbec409a6e3a5bb8e3996f56fa">70b8f12</a></td><td><code>Merge branch 'develop' into 22345</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/645c6b7c2904204b1c2e1bedff6264c99abed4ef">645c6b7</a></td><td><code>#22345 rebase + small speedup</code></td></tr></table>




---

archive/issue_comments_396041.json:
```json
{
    "body": "<a id='comment:17'></a>\nThat took longer than expected.  The rebase was easy but when I tested all of schemes/elliptic_curves there was a long time warning coming from a test in kraus.py, relating to an earlier fix for #20737, marked as 15s but taking a minute (in semi_global_minimal_model()).  I am not sure where the regression came from (not at all to do with this ticket, which in fact makes it possible for semi_global_minimal_model() not to be called when computing isogenies, precisely for the reason that it can take too long when the class group is large).   I did two things which help: first, use prime_range() instead of primes() in the primes_of_bounded_norm methods for number fields, and secondly to use a larger bound when searching for a prime in an ideal class -- since if it fails it doubles the bound, which is of course wasteful since the small ones are re-tested.  If the resulting time (25s for me for this test) is deemed too long we can mark it 'not tested', but it is there precisely because this case is a hard one.",
    "created_at": "2017-08-22T07:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396041",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:17'></a>
That took longer than expected.  The rebase was easy but when I tested all of schemes/elliptic_curves there was a long time warning coming from a test in kraus.py, relating to an earlier fix for #20737, marked as 15s but taking a minute (in semi_global_minimal_model()).  I am not sure where the regression came from (not at all to do with this ticket, which in fact makes it possible for semi_global_minimal_model() not to be called when computing isogenies, precisely for the reason that it can take too long when the class group is large).   I did two things which help: first, use prime_range() instead of primes() in the primes_of_bounded_norm methods for number fields, and secondly to use a larger bound when searching for a prime in an ideal class -- since if it fails it doubles the bound, which is of course wasteful since the small ones are re-tested.  If the resulting time (25s for me for this test) is deemed too long we can mark it 'not tested', but it is there precisely because this case is a hard one.



---

archive/issue_comments_396042.json:
```json
{
    "body": "**Changing branch** from \"[u/cremona/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/22345)\" to \"[u/aly.deines/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/aly.deines/22345)\".",
    "created_at": "2017-08-24T23:22:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396042",
    "user": "https://github.com/adeines"
}
```

**Changing branch** from "[u/cremona/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/22345)" to "[u/aly.deines/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/aly.deines/22345)".



---

archive/issue_comments_396043.json:
```json
{
    "body": "**Changing commit** from \"[645c6b7c2904204b1c2e1bedff6264c99abed4ef](https://github.com/sagemath/sagetrac-mirror/commit/645c6b7c2904204b1c2e1bedff6264c99abed4ef)\" to \"[51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e](https://github.com/sagemath/sagetrac-mirror/commit/51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e)\".",
    "created_at": "2017-10-05T18:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396043",
    "user": "https://github.com/JohnCremona"
}
```

**Changing commit** from "[645c6b7c2904204b1c2e1bedff6264c99abed4ef](https://github.com/sagemath/sagetrac-mirror/commit/645c6b7c2904204b1c2e1bedff6264c99abed4ef)" to "[51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e](https://github.com/sagemath/sagetrac-mirror/commit/51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e)".



---

archive/issue_comments_396044.json:
```json
{
    "body": "<a id='comment:20'></a>\nAly can you explain the branch change you made on Aug 24 which I only just noticed?  I cannot read your branch (it shows on trac but not as a link) so I don't know what you changed.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e\">51c21c3</a></td><td><code>Merge branch 'u/cremona/22345' of git://trac.sagemath.org/sage into t/22345/22345</code></td></tr></table>\n",
    "created_at": "2017-10-05T18:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396044",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:20'></a>
Aly can you explain the branch change you made on Aug 24 which I only just noticed?  I cannot read your branch (it shows on trac but not as a link) so I don't know what you changed.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e">51c21c3</a></td><td><code>Merge branch 'u/cremona/22345' of git://trac.sagemath.org/sage into t/22345/22345</code></td></tr></table>




---

archive/issue_comments_396045.json:
```json
{
    "body": "<a id='comment:21'></a>\nbranch does not apply",
    "created_at": "2017-12-07T15:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396045",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>
branch does not apply



---

archive/issue_comments_396046.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2017-12-07T15:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396046",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_396047.json:
```json
{
    "body": "<a id='comment:22'></a>\nI have merged in 8.3.rc0, fixed conflicts and checked that all tests pass.  I hope I will not have to do this again a year from now!\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94f711426d546c9d28503f3ff82e85d7257e3ce7\">94f7114</a></td><td><code>Merge branch 'develop' into 22345</code></td></tr></table>\n",
    "created_at": "2018-07-10T08:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396047",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:22'></a>
I have merged in 8.3.rc0, fixed conflicts and checked that all tests pass.  I hope I will not have to do this again a year from now!

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94f711426d546c9d28503f3ff82e85d7257e3ce7">94f7114</a></td><td><code>Merge branch 'develop' into 22345</code></td></tr></table>




---

archive/issue_comments_396048.json:
```json
{
    "body": "**Changing branch** from \"[u/aly.deines/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/aly.deines/22345)\" to \"[u/cremona/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/22345)\".",
    "created_at": "2018-07-10T08:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396048",
    "user": "https://github.com/JohnCremona"
}
```

**Changing branch** from "[u/aly.deines/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/aly.deines/22345)" to "[u/cremona/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/22345)".



---

archive/issue_comments_396049.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2018-07-10T08:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396049",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_396050.json:
```json
{
    "body": "**Changing commit** from \"[51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e](https://github.com/sagemath/sagetrac-mirror/commit/51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e)\" to \"[94f711426d546c9d28503f3ff82e85d7257e3ce7](https://github.com/sagemath/sagetrac-mirror/commit/94f711426d546c9d28503f3ff82e85d7257e3ce7)\".",
    "created_at": "2018-07-10T08:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396050",
    "user": "https://github.com/JohnCremona"
}
```

**Changing commit** from "[51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e](https://github.com/sagemath/sagetrac-mirror/commit/51c21c3b4ca9c55e5d8f7d8d9a924e7627fc766e)" to "[94f711426d546c9d28503f3ff82e85d7257e3ce7](https://github.com/sagemath/sagetrac-mirror/commit/94f711426d546c9d28503f3ff82e85d7257e3ce7)".



---

archive/issue_comments_396051.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This follows in from #22343 which is a dependency.  We implement Billeray's algorithm for finding the set of reducible primes for an elliptic curve without CM over a number field.  This is based on an implementation by Ciaran Schembri for a masters' project at Warwick.\n+This follows in from #22343 which is a dependency.  We implement Billerey's algorithm for finding the set of reducible primes for an elliptic curve without CM over a number field.  This is based on an implementation by Ciaran Schembri for a masters' project at Warwick.\n``````\n",
    "created_at": "2018-07-10T18:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396051",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-This follows in from #22343 which is a dependency.  We implement Billeray's algorithm for finding the set of reducible primes for an elliptic curve without CM over a number field.  This is based on an implementation by Ciaran Schembri for a masters' project at Warwick.
+This follows in from #22343 which is a dependency.  We implement Billerey's algorithm for finding the set of reducible primes for an elliptic curve without CM over a number field.  This is based on an implementation by Ciaran Schembri for a masters' project at Warwick.
``````




---

archive/issue_comments_396052.json:
```json
{
    "body": "**Changing branch** from \"[u/cremona/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/22345)\" to \"[public/ticket/22345](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/22345)\".",
    "created_at": "2018-07-10T18:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396052",
    "user": "https://github.com/fchapoton"
}
```

**Changing branch** from "[u/cremona/22345](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/22345)" to "[public/ticket/22345](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/22345)".



---

archive/issue_comments_396053.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2018-07-10T18:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396053",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_396054.json:
```json
{
    "body": "<a id='comment:23'></a>\nPlease look at my commit, fixing some details about py3:\n\n* using `r\"\"\"` for documentation containing latex operators\n\n* do not use `.next`\n\nIf you agree with my changes, you can set to positive.. But I do not claim anything about checking the math, so you may want to wait for an expert's opinion.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2423f7aa9cd4523bc82a4627513acbcf13b786ae\">2423f7a</a></td><td><code>trac 22345 some details (py3 compatibility, please)</code></td></tr></table>\n",
    "created_at": "2018-07-10T18:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396054",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>
Please look at my commit, fixing some details about py3:

* using `r"""` for documentation containing latex operators

* do not use `.next`

If you agree with my changes, you can set to positive.. But I do not claim anything about checking the math, so you may want to wait for an expert's opinion.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2423f7aa9cd4523bc82a4627513acbcf13b786ae">2423f7a</a></td><td><code>trac 22345 some details (py3 compatibility, please)</code></td></tr></table>




---

archive/issue_comments_396055.json:
```json
{
    "body": "**Changing commit** from \"[94f711426d546c9d28503f3ff82e85d7257e3ce7](https://github.com/sagemath/sagetrac-mirror/commit/94f711426d546c9d28503f3ff82e85d7257e3ce7)\" to \"[2423f7aa9cd4523bc82a4627513acbcf13b786ae](https://github.com/sagemath/sagetrac-mirror/commit/2423f7aa9cd4523bc82a4627513acbcf13b786ae)\".",
    "created_at": "2018-07-10T18:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396055",
    "user": "https://github.com/fchapoton"
}
```

**Changing commit** from "[94f711426d546c9d28503f3ff82e85d7257e3ce7](https://github.com/sagemath/sagetrac-mirror/commit/94f711426d546c9d28503f3ff82e85d7257e3ce7)" to "[2423f7aa9cd4523bc82a4627513acbcf13b786ae](https://github.com/sagemath/sagetrac-mirror/commit/2423f7aa9cd4523bc82a4627513acbcf13b786ae)".



---

archive/issue_comments_396056.json:
```json
{
    "body": "<a id='comment:24'></a>\nI am happy with your changes.  Thanks. I have discussed the ideas here with people who have not actually looked at the code in detail.  I think the only reasonable thing to do is to get it merged so that it gets used (if there is anyone out there interested).  I have used this a lot in computing isogeny classes of curves for the LMFDB, which is how I found out that the old code in Sage was completely useless over number fields of degree >4.",
    "created_at": "2018-07-10T19:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396056",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:24'></a>
I am happy with your changes.  Thanks. I have discussed the ideas here with people who have not actually looked at the code in detail.  I think the only reasonable thing to do is to get it merged so that it gets used (if there is anyone out there interested).  I have used this a lot in computing isogeny classes of curves for the LMFDB, which is how I found out that the old code in Sage was completely useless over number fields of degree >4.



---

archive/issue_comments_396057.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2018-07-10T19:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396057",
    "user": "https://github.com/JohnCremona"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_066848.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-07-11T18:50:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22345#event-66848"
}
```



---

archive/issue_events_066849.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-07-11T18:50:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "milestone": "sage-8.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22345#event-66849"
}
```



---

archive/issue_events_066850.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-11T16:55:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22345#event-66850"
}
```



---

archive/issue_comments_396058.json:
```json
{
    "body": "**Changing branch** from \"[public/ticket/22345](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/22345)\" to \"[2423f7aa9cd4523bc82a4627513acbcf13b786ae](https://github.com/sagemath/sagetrac-mirror/commit/2423f7aa9cd4523bc82a4627513acbcf13b786ae)\".",
    "created_at": "2018-08-11T16:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22345",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22345#issuecomment-396058",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/ticket/22345](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/22345)" to "[2423f7aa9cd4523bc82a4627513acbcf13b786ae](https://github.com/sagemath/sagetrac-mirror/commit/2423f7aa9cd4523bc82a4627513acbcf13b786ae)".
