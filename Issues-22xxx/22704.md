# Issue 22704: Fix error in Sage's rich output display formatter

archive/issues_022704.json:
```json
{
    "body": "CC:  @dimpase @vbraun\n\nFollow up to an issue raised on [sage-devel](https://groups.google.com/d/msg/sage-devel/uyerGH7gEEc/XtXZ1BS6CQAJ): running `vars()` or `locals()` leads to an error. Here is a fix.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22941\n\n",
    "closed_at": "2017-05-15T22:51:17Z",
    "created_at": "2017-05-03T19:39:30Z",
    "labels": [
        "component: refactoring",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Fix error in Sage's rich output display formatter",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22704",
    "user": "https://github.com/jhpalmieri"
}
```
CC:  @dimpase @vbraun

Follow up to an issue raised on [sage-devel](https://groups.google.com/d/msg/sage-devel/uyerGH7gEEc/XtXZ1BS6CQAJ): running `vars()` or `locals()` leads to an error. Here is a fix.


Issue created by migration from https://trac.sagemath.org/ticket/22941





---

archive/issue_comments_316568.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-05-03T19:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316568",
    "user": "https://github.com/jhpalmieri"
}
```

New commits:



---

archive/issue_comments_316569.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-03T19:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316569",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_316570.json:
```json
{
    "body": "does it depend on #22933 ?",
    "created_at": "2017-05-03T20:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316570",
    "user": "https://github.com/dimpase"
}
```

does it depend on #22933 ?



---

archive/issue_comments_316571.json:
```json
{
    "body": "one way or another, `vars()` works now.",
    "created_at": "2017-05-03T21:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316571",
    "user": "https://github.com/dimpase"
}
```

one way or another, `vars()` works now.



---

archive/issue_comments_316572.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-03T21:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316572",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_316573.json:
```json
{
    "body": "It doesn't depend on #22933, by the way. Volker, I think you were responsible for this file originally, so please let us know if you have any objections.",
    "created_at": "2017-05-03T22:06:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316573",
    "user": "https://github.com/jhpalmieri"
}
```

It doesn't depend on #22933, by the way. Volker, I think you were responsible for this file originally, so please let us know if you have any objections.



---

archive/issue_comments_316574.json:
```json
{
    "body": "Perhaps the question is whether `displayhook` can be `None`, or this is a bug.",
    "created_at": "2017-05-03T22:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316574",
    "user": "https://github.com/dimpase"
}
```

Perhaps the question is whether `displayhook` can be `None`, or this is a bug.



---

archive/issue_comments_316575.json:
```json
{
    "body": "The `displayhook` method starts with\n\n```\n        if obj is None:\n            return\n```\nSo then the question is whether it is a bug if `obj is None`. (Well, `obj` can be `None`, certainly, but should that occur when you call `vars()` or `locals()`?)",
    "created_at": "2017-05-04T02:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316575",
    "user": "https://github.com/jhpalmieri"
}
```

The `displayhook` method starts with

```
        if obj is None:
            return
```
So then the question is whether it is a bug if `obj is None`. (Well, `obj` can be `None`, certainly, but should that occur when you call `vars()` or `locals()`?)



---

archive/issue_comments_316576.json:
```json
{
    "body": "I don't think the patch fixes the underlying issue. What really goes wrong is that `__repr__` of vars() somewhere activates SageNB support:\n\n```\nsage: get_display_manager()\nThe Sage display manager using the IPython command line backend\nsage: vars()\n[...]\nsage: get_display_manager()\nThe Sage display manager using the SageNB backend\n[errors]\n```\nAnd having the SageNB backend with the IPython terminal frontend just isn't going to work well....",
    "created_at": "2017-05-04T19:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316576",
    "user": "https://github.com/vbraun"
}
```

I don't think the patch fixes the underlying issue. What really goes wrong is that `__repr__` of vars() somewhere activates SageNB support:

```
sage: get_display_manager()
The Sage display manager using the IPython command line backend
sage: vars()
[...]
sage: get_display_manager()
The Sage display manager using the SageNB backend
[errors]
```
And having the SageNB backend with the IPython terminal frontend just isn't going to work well....



---

archive/issue_comments_316577.json:
```json
{
    "body": "We need to fix `repr(vars()['notebook'])` (surprise, surprise...) by some kind of \"guarding\" it, or perhaps by removing it from global namespace...\n\n\nIndeed, try running the following:\n\n```\nsage: v=vars()\nsage: f=open('/dev/null','w')\nsage: for k in v.keys():\n....:     if k!='v':   # to avoid recursion\n....:         f.write(repr(v[k]))\n....:         if 'NB' in str(get_display_manager()):\n....:            print(\"Achtung!!! \"+str(k))\n....:            break\n```\nYou will get some deprecation warnings and then\n\n```\n...\nAchtung!!! notebook\n```\nSo swithcing to SageNB backend is triggered by `repr(vars()['notebook'])`.\n\nIndeed\n\n```\nsage: get_display_manager()\nThe Sage display manager using the IPython command line backend\nsage: vars()['notebook']\n<sagenb.notebook.notebook_object.NotebookObject instance at 0x7fe63d83ae18>\n<sagenb.notebook.notebook_object.NotebookObject instance at 0x7fe63d83ae18>\nsage: get_display_manager()\nThe Sage display manager using the SageNB backend\nThe Sage display manager using the SageNB backend\n```\n\n(doubling of lines is caused by unsuitability of SageNB backend for the terminal.)",
    "created_at": "2017-05-04T20:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316577",
    "user": "https://github.com/dimpase"
}
```

We need to fix `repr(vars()['notebook'])` (surprise, surprise...) by some kind of "guarding" it, or perhaps by removing it from global namespace...


Indeed, try running the following:

```
sage: v=vars()
sage: f=open('/dev/null','w')
sage: for k in v.keys():
....:     if k!='v':   # to avoid recursion
....:         f.write(repr(v[k]))
....:         if 'NB' in str(get_display_manager()):
....:            print("Achtung!!! "+str(k))
....:            break
```
You will get some deprecation warnings and then

```
...
Achtung!!! notebook
```
So swithcing to SageNB backend is triggered by `repr(vars()['notebook'])`.

Indeed

```
sage: get_display_manager()
The Sage display manager using the IPython command line backend
sage: vars()['notebook']
<sagenb.notebook.notebook_object.NotebookObject instance at 0x7fe63d83ae18>
<sagenb.notebook.notebook_object.NotebookObject instance at 0x7fe63d83ae18>
sage: get_display_manager()
The Sage display manager using the SageNB backend
The Sage display manager using the SageNB backend
```

(doubling of lines is caused by unsuitability of SageNB backend for the terminal.)



---

archive/issue_comments_316578.json:
```json
{
    "body": "Just resolving the notebook lazy import, e.g. by `notebook?`, is also sufficient. The easiest solution is probably to duplicate the sagenb notebook functions and docstrings in a proxy module that doesn't drag in the remaining SagenB machinery.",
    "created_at": "2017-05-04T22:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316578",
    "user": "https://github.com/vbraun"
}
```

Just resolving the notebook lazy import, e.g. by `notebook?`, is also sufficient. The easiest solution is probably to duplicate the sagenb notebook functions and docstrings in a proxy module that doesn't drag in the remaining SagenB machinery.



---

archive/issue_comments_316579.json:
```json
{
    "body": "This patch to SageNB fixes the problem for me. The point is to not import sagenb.misc.support at the top-level, since that file changes the displayhook.\n\n```diff\ndiff --git a/sagenb/notebook/worksheet.py b/sagenb/notebook/worksheet.py\nindex f5b7c26..e41b28a 100644\n--- a/sagenb/notebook/worksheet.py\n+++ b/sagenb/notebook/worksheet.py\n@@ -52,7 +52,6 @@ from sagenb.interfaces import (WorksheetProcess_ExpectImplementation,\n                                WorksheetProcess_ReferenceImplementation,\n                                WorksheetProcess_RemoteExpectImplementation)\n \n-import sagenb.misc.support  as support\n from sagenb.misc.format import relocate_future_imports\n \n # Imports specifically relevant to the sage notebook\n@@ -3812,7 +3811,8 @@ except (KeyError, IOError):\n         return out\n \n     def _get_last_identifier(self, s):\n-        return support.get_rightmost_identifier(s)\n+        import sagenb.misc.support\n+        return sagenb.misc.support.get_rightmost_identifier(s)\n \n     def preparse(self, s):\n         \"\"\"\n```",
    "created_at": "2017-05-04T22:31:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316579",
    "user": "https://github.com/jhpalmieri"
}
```

This patch to SageNB fixes the problem for me. The point is to not import sagenb.misc.support at the top-level, since that file changes the displayhook.

```diff
diff --git a/sagenb/notebook/worksheet.py b/sagenb/notebook/worksheet.py
index f5b7c26..e41b28a 100644
--- a/sagenb/notebook/worksheet.py
+++ b/sagenb/notebook/worksheet.py
@@ -52,7 +52,6 @@ from sagenb.interfaces import (WorksheetProcess_ExpectImplementation,
                                WorksheetProcess_ReferenceImplementation,
                                WorksheetProcess_RemoteExpectImplementation)
 
-import sagenb.misc.support  as support
 from sagenb.misc.format import relocate_future_imports
 
 # Imports specifically relevant to the sage notebook
@@ -3812,7 +3811,8 @@ except (KeyError, IOError):
         return out
 
     def _get_last_identifier(self, s):
-        return support.get_rightmost_identifier(s)
+        import sagenb.misc.support
+        return sagenb.misc.support.get_rightmost_identifier(s)
 
     def preparse(self, s):
         """
```



---

archive/issue_comments_316580.json:
```json
{
    "body": "Actually, both Volker's and my suggestion fix `vars()['notebook']`, but they don't fix the problem in general:\n\n```\nsage: notebook?\n...\nsage: get_display_manager()\nThe Sage display manager using the IPython command line backend\nsage: vars()['notebook']\n<sagenb.notebook.notebook_object.NotebookObject instance at 0x1bc7f57e8>\nsage: get_display_manager()\nThe Sage display manager using the IPython command line backend\nsage: vars()\n...\nsage: get_display_manager()\nThe Sage display manager using the SageNB backend\nThe Sage display manager using the SageNB backend\n```",
    "created_at": "2017-05-04T22:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316580",
    "user": "https://github.com/jhpalmieri"
}
```

Actually, both Volker's and my suggestion fix `vars()['notebook']`, but they don't fix the problem in general:

```
sage: notebook?
...
sage: get_display_manager()
The Sage display manager using the IPython command line backend
sage: vars()['notebook']
<sagenb.notebook.notebook_object.NotebookObject instance at 0x1bc7f57e8>
sage: get_display_manager()
The Sage display manager using the IPython command line backend
sage: vars()
...
sage: get_display_manager()
The Sage display manager using the SageNB backend
The Sage display manager using the SageNB backend
```



---

archive/issue_comments_316581.json:
```json
{
    "body": "After making my change to SageNB, running Dima's code from comment:9 gives\n\n```\nAchtung!!! v\n```\n(which strikes me as odd since we already have `if k != v:` there).",
    "created_at": "2017-05-04T22:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316581",
    "user": "https://github.com/jhpalmieri"
}
```

After making my change to SageNB, running Dima's code from comment:9 gives

```
Achtung!!! v
```
(which strikes me as odd since we already have `if k != v:` there).



---

archive/issue_comments_316582.json:
```json
{
    "body": "it seems to be more self-referential than I thought...",
    "created_at": "2017-05-05T13:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316582",
    "user": "https://github.com/dimpase"
}
```

it seems to be more self-referential than I thought...



---

archive/issue_comments_316583.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-05-05T20:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316583",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_316584.json:
```json
{
    "body": "`notebook` isn't the only thing tho, there is also `inotebook` and others ...",
    "created_at": "2017-05-05T20:36:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316584",
    "user": "https://github.com/vbraun"
}
```

`notebook` isn't the only thing tho, there is also `inotebook` and others ...



---

archive/issue_comments_316585.json:
```json
{
    "body": "Yes, but I don't understand why my proposed change to SageNB doesn't seem to fix all of them.",
    "created_at": "2017-05-05T20:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316585",
    "user": "https://github.com/jhpalmieri"
}
```

Yes, but I don't understand why my proposed change to SageNB doesn't seem to fix all of them.



---

archive/issue_comments_316586.json:
```json
{
    "body": "anyhow I will add the sagenb patch to sagenb repo now.",
    "created_at": "2017-05-10T11:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316586",
    "user": "https://github.com/dimpase"
}
```

anyhow I will add the sagenb patch to sagenb repo now.



---

archive/issue_comments_316587.json:
```json
{
    "body": "could it be that also `import sagenb.misc.support as _support_` in the string in\n`initialize_sage()` in the same file is a problem?",
    "created_at": "2017-05-10T11:40:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316587",
    "user": "https://github.com/dimpase"
}
```

could it be that also `import sagenb.misc.support as _support_` in the string in
`initialize_sage()` in the same file is a problem?



---

archive/issue_comments_316588.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-05-10T20:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316588",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_316589.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-10T20:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316589",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_316590.json:
```json
{
    "body": "I think I've found the problem. This branch gets rid of the only place in the Sage library that imports sagenb.misc.support. Together with the SageNB patch, this allows `vars()` to work for me without changing the display manager. When I was testing it, I also put in a print statement in sagenb.misc.support:\n\n```diff\n--- misc/support.py~\t2017-05-10 13:51:18.000000000 -0700\n+++ misc/support.py\t2017-05-10 13:55:00.000000000 -0700\n@@ -41,6 +41,7 @@\n         return False\n \n try:\n+    print ('Warning: changing the display hook!!!')\n     from sage.misc.displayhook import DisplayHook\n     sys.displayhook = DisplayHook()\n except ImportError as msg:\n```\nand with this branch and the modification to SageNB, the warning is not printed when I evaluate `vars()`.",
    "created_at": "2017-05-10T20:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316590",
    "user": "https://github.com/jhpalmieri"
}
```

I think I've found the problem. This branch gets rid of the only place in the Sage library that imports sagenb.misc.support. Together with the SageNB patch, this allows `vars()` to work for me without changing the display manager. When I was testing it, I also put in a print statement in sagenb.misc.support:

```diff
--- misc/support.py~	2017-05-10 13:51:18.000000000 -0700
+++ misc/support.py	2017-05-10 13:55:00.000000000 -0700
@@ -41,6 +41,7 @@
         return False
 
 try:
+    print ('Warning: changing the display hook!!!')
     from sage.misc.displayhook import DisplayHook
     sys.displayhook = DisplayHook()
 except ImportError as msg:
```
and with this branch and the modification to SageNB, the warning is not printed when I evaluate `vars()`.



---

archive/issue_comments_316591.json:
```json
{
    "body": "Replying to [comment:18 dimpase]:\n> could it be that also `import sagenb.misc.support as _support_` in the string in\n> `initialize_sage()` in the same file is a problem?\n\n\nBy the way, I tested this, and it does not cause the problem. (I deleted that line and the problem remained.)",
    "created_at": "2017-05-10T21:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316591",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:18 dimpase]:
> could it be that also `import sagenb.misc.support as _support_` in the string in
> `initialize_sage()` in the same file is a problem?


By the way, I tested this, and it does not cause the problem. (I deleted that line and the problem remained.)



---

archive/issue_comments_316592.json:
```json
{
    "body": "We could also add a doctest if you want, but I'm not sure where to put it. sage/graphs/all.py? sage/graphs/graph_editor.py? I don't really want it to appear in the reference manual, so maybe the former.\n\n```\n\n\"\"\"\nTESTS:\n\nTest that sagenb.misc.support is not imported (see :trac:`22941`)::\n\n    sage: import sage.graphs.graph_editor\n    sage: 'sagenb.misc.support' in sys.modules\n    False\n\"\"\"\n```",
    "created_at": "2017-05-10T21:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316592",
    "user": "https://github.com/jhpalmieri"
}
```

We could also add a doctest if you want, but I'm not sure where to put it. sage/graphs/all.py? sage/graphs/graph_editor.py? I don't really want it to appear in the reference manual, so maybe the former.

```

"""
TESTS:

Test that sagenb.misc.support is not imported (see :trac:`22941`)::

    sage: import sage.graphs.graph_editor
    sage: 'sagenb.misc.support' in sys.modules
    False
"""
```



---

archive/issue_comments_316593.json:
```json
{
    "body": "Good catch. Regarding the doctest, yes, we can have it where you suggest.\n\nPerhaps Sage also needs a module called `customs` to control the imports properly :-)",
    "created_at": "2017-05-10T22:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316593",
    "user": "https://github.com/dimpase"
}
```

Good catch. Regarding the doctest, yes, we can have it where you suggest.

Perhaps Sage also needs a module called `customs` to control the imports properly :-)



---

archive/issue_comments_316594.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-10T22:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316594",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316595.json:
```json
{
    "body": "Replying to [comment:23 dimpase]:\n> Good catch. Regarding the doctest, yes, we can have it where you suggest.\n> \n> Perhaps Sage also needs a module called `customs` to control the imports properly :-)\n\n\nHeh. See #21636 for a start. Make Sage Great Again.",
    "created_at": "2017-05-10T22:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316595",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:23 dimpase]:
> Good catch. Regarding the doctest, yes, we can have it where you suggest.
> 
> Perhaps Sage also needs a module called `customs` to control the imports properly :-)


Heh. See #21636 for a start. Make Sage Great Again.



---

archive/issue_comments_316596.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-10T23:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316596",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_316597.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to refactoring.",
    "created_at": "2017-05-10T23:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316597",
    "user": "https://github.com/dimpase"
}
```

Changing component from PLEASE CHANGE to refactoring.



---

archive/issue_events_059491.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-15T22:51:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22704#event-59491"
}
```



---

archive/issue_comments_316598.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-15T22:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22704",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22704#issuecomment-316598",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
