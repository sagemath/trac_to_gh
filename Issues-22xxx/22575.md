# Issue 22575: Fix Polyhedron.base_extend so it does not ignore the backend parameter

archive/issues_022338.json:
```json
{
    "body": "Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and the `base_extend` method is supposed to allow to transform between backends, but the parameter is simply ignored (in (`Polyhedra_base.base_extend`).\n\n\n\nPossible follow-up: Also a new method `change_backend` could be implemented as an alias. (Once done, add it to tutorial, too.)\n\n\nCC:  @mkoeppe @jplab @tscrim\n\nKeywords: days84, polytope\n\nBranch/Commit: 9f61dac34e2f4a755fbb8659bb2f7c6ab3130b5c\n\nReviewer: Travis Scrimshaw\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22575\n\n",
    "closed_at": "2018-10-01T22:35:49Z",
    "created_at": "2017-03-10T15:21:14Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Fix Polyhedron.base_extend so it does not ignore the backend parameter",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22575",
    "user": "https://github.com/mforets"
}
```
Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and the `base_extend` method is supposed to allow to transform between backends, but the parameter is simply ignored (in (`Polyhedra_base.base_extend`).



Possible follow-up: Also a new method `change_backend` could be implemented as an alias. (Once done, add it to tutorial, too.)


CC:  @mkoeppe @jplab @tscrim

Keywords: days84, polytope

Branch/Commit: 9f61dac34e2f4a755fbb8659bb2f7c6ab3130b5c

Reviewer: Travis Scrimshaw

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22575





---

archive/issue_comments_419549.json:
```json
{
    "body": "<a id='comment:1'></a>`base_extend` should do the job. But actually... the optional parameter to change the backend is simply not used at all!?!?!?!\n\n```\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P\nA 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray\nsage: P_cdd = P.base_extend(base_ring=ZZ,backend='cdd')\nsage: type(P_cdd)\n<class 'sage.geometry.polyhedron.backend_ppl.Polyhedra_ZZ_ppl_with_category.element_class'>\n```\n\nThis is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...\n\n```\nsage: par = P.parent()\nsage: par.base_extend??     # this is worth looking at...\n```\n\nI guess one could simply correct that...\n\nNow the question is whether there is a smart way to go from one to another?",
    "created_at": "2017-03-15T15:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419549",
    "user": "https://github.com/jplab"
}
```

<a id='comment:1'></a>`base_extend` should do the job. But actually... the optional parameter to change the backend is simply not used at all!?!?!?!

```
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ);  P
A 2-dimensional polyhedron in ZZ^2 defined as the convex hull of 2 vertices and 1 ray
sage: P_cdd = P.base_extend(base_ring=ZZ,backend='cdd')
sage: type(P_cdd)
<class 'sage.geometry.polyhedron.backend_ppl.Polyhedra_ZZ_ppl_with_category.element_class'>
```

This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...

```
sage: par = P.parent()
sage: par.base_extend??     # this is worth looking at...
```

I guess one could simply correct that...

Now the question is whether there is a smart way to go from one to another?



---

archive/issue_comments_419550.json:
```json
{
    "body": "<a id='comment:2'></a>See also #22701.",
    "created_at": "2017-03-28T18:26:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419550",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>See also #22701.



---

archive/issue_comments_419551.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:1 jipilab]:\n> ...\n> This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...\n> \n> \n> ```\n> sage: par = P.parent()\n> sage: par.base_extend??     # this is worth looking at...\n> ```\n> \n\n\ngood finding, maybe this was a feature that didn't get in at the time. \n\nalso, i didn't find a command to get the backend as a string, like `P.backend()`, or `P.get_backend()`. it seems that there is no object (list) of `available_backends` either. \n\n> I guess one could simply correct that...\n> \n> Now the question is whether there is a smart way to go from one to another?\n\n\ni suggest to just start with the naive way and see how it behaves.",
    "created_at": "2017-04-11T15:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419551",
    "user": "https://github.com/mforets"
}
```

<a id='comment:3'></a>Replying to [comment:1 jipilab]:
> ...
> This is because in the parent class, the method `.base_extend()` of `parent` does not even use the optional parameter `backend`...
> 
> 
> ```
> sage: par = P.parent()
> sage: par.base_extend??     # this is worth looking at...
> ```
> 


good finding, maybe this was a feature that didn't get in at the time. 

also, i didn't find a command to get the backend as a string, like `P.backend()`, or `P.get_backend()`. it seems that there is no object (list) of `available_backends` either. 

> I guess one could simply correct that...
> 
> Now the question is whether there is a smart way to go from one to another?


i suggest to just start with the naive way and see how it behaves.



---

archive/issue_comments_419552.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and this method allows to transform between backends.\n+\n+TODO:\n+\n+- once done, add it to tutorial.\n``````\n",
    "created_at": "2018-02-26T12:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419552",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
 Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and this method allows to transform between backends.
+
+TODO:
+
+- once done, add it to tutorial.
``````




---

archive/issue_comments_419553.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,6 @@\n-Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and this method allows to transform between backends.\n+Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and the `base_extend` method is supposed to allow to transform between backends, but the parameter is simply ignored (in (`Polyhedra_base.base_extend`).\n \n-TODO:\n+(Once done, add it to tutorial, too.)\n \n-- once done, add it to tutorial.\n+Also a new method `change_backend` could be implemented as an alias.\n+\n``````\n",
    "created_at": "2018-09-29T22:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419553",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,6 @@
-Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and this method allows to transform between backends.
+Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and the `base_extend` method is supposed to allow to transform between backends, but the parameter is simply ignored (in (`Polyhedra_base.base_extend`).
 
-TODO:
+(Once done, add it to tutorial, too.)
 
-- once done, add it to tutorial.
+Also a new method `change_backend` could be implemented as an alias.
+
``````




---

archive/issue_events_058943.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2018-09-29T22:11:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22575#event-58943"
}
```



---

archive/issue_comments_419554.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/fix_polyhedron_base_extend_so_it_does_not_ignore_the_backend_parameter\"",
    "created_at": "2018-09-30T06:13:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419554",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/fix_polyhedron_base_extend_so_it_does_not_ignore_the_backend_parameter"



---

archive/issue_comments_419555.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419555",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_419556.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and the `base_extend` method is supposed to allow to transform between backends, but the parameter is simply ignored (in (`Polyhedra_base.base_extend`).\n \n-(Once done, add it to tutorial, too.)\n \n-Also a new method `change_backend` could be implemented as an alias.\n \n+Possible follow-up: Also a new method `change_backend` could be implemented as an alias. (Once done, add it to tutorial, too.)\n+\n``````\n",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419556",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Polyhedra can be instantiated with different backends (CDD, PPL, normaliz, ...), and the `base_extend` method is supposed to allow to transform between backends, but the parameter is simply ignored (in (`Polyhedra_base.base_extend`).
 
-(Once done, add it to tutorial, too.)
 
-Also a new method `change_backend` could be implemented as an alias.
 
+Possible follow-up: Also a new method `change_backend` could be implemented as an alias. (Once done, add it to tutorial, too.)
+
``````




---

archive/issue_comments_419557.json:
```json
{
    "body": "Changing commit from \"\" to \"260739db6ac8ee46b50db4d1489d11b0621c1c36\"",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419557",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "260739db6ac8ee46b50db4d1489d11b0621c1c36"



---

archive/issue_comments_419558.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419558",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_419559.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2018-09-30T06:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419559",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_419560.json:
```json
{
    "body": "<a id='comment:8'></a>So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:\n\n```\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=QQ)\nsage: P.backend()\n'ppl'\nsage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ, backend='normaliz')\nsage: P.backend()\n'normaliz'\nsage: P.base_extend(QQ).backend()\n'ppl'\n```\nSo if you think this is the behavior that it should have, then you should put a `.. WARNING::` explaining that the backend is given by the default if not specified.",
    "created_at": "2018-09-30T07:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419560",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:

```
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=QQ)
sage: P.backend()
'ppl'
sage: P = Polyhedron(vertices=[(1,0), (0,1)], rays=[(1,1)], base_ring=ZZ, backend='normaliz')
sage: P.backend()
'normaliz'
sage: P.base_extend(QQ).backend()
'ppl'
```
So if you think this is the behavior that it should have, then you should put a `.. WARNING::` explaining that the backend is given by the default if not specified.



---

archive/issue_comments_419561.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 tscrim]:\n> So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:\n\n\nOne might expect that, but the backend may simply not be suitable. Consider base_extend of a PPL polytope to AA - only the 'field' backend is suitable. \n\nI'll add some documentation.",
    "created_at": "2018-09-30T08:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419561",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Replying to [comment:8 tscrim]:
> So my only quip is that this defaults to the automatic backend choice when the backend is not specified. I would expect that the backend be the same backend as what I am currently working with:


One might expect that, but the backend may simply not be suitable. Consider base_extend of a PPL polytope to AA - only the 'field' backend is suitable. 

I'll add some documentation.



---

archive/issue_comments_419562.json:
```json
{
    "body": "Changing commit from \"260739db6ac8ee46b50db4d1489d11b0621c1c36\" to \"9f61dac34e2f4a755fbb8659bb2f7c6ab3130b5c\"",
    "created_at": "2018-09-30T08:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419562",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "260739db6ac8ee46b50db4d1489d11b0621c1c36" to "9f61dac34e2f4a755fbb8659bb2f7c6ab3130b5c"



---

archive/issue_comments_419563.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-30T08:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419563",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_419564.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-30T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419564",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_419565.json:
```json
{
    "body": "<a id='comment:11'></a>Thanks. LGTM.",
    "created_at": "2018-09-30T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419565",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>Thanks. LGTM.



---

archive/issue_comments_419566.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2018-09-30T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419566",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_419567.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/fix_polyhedron_base_extend_so_it_does_not_ignore_the_backend_parameter\" to \"9f61dac34e2f4a755fbb8659bb2f7c6ab3130b5c\"",
    "created_at": "2018-10-01T22:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419567",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/fix_polyhedron_base_extend_so_it_does_not_ignore_the_backend_parameter" to "9f61dac34e2f4a755fbb8659bb2f7c6ab3130b5c"



---

archive/issue_comments_419568.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-10-01T22:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22575#issuecomment-419568",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_058944.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-10-01T22:35:49Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22575",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22575#event-58944"
}
```
