# Issue 22042: Three.js: reduce CPU load for static scenes

archive/issues_021805.json:
```json
{
    "assignees": [],
    "body": "This addresses https://groups.google.com/d/msg/sage-devel/pGLZrwfdQB8/6OsQzr8fBgAJ\n\nCC:  @sagetrac-tdumont @dimpase @vbraun\n\nKeywords: **threejs**\n\nBranch/Commit: **[a1e206c](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Paul Masson**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22042_\n\n",
    "closed_at": "2016-12-24T19:47:29Z",
    "created_at": "2016-12-10T01:35:09Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Three.js: reduce CPU load for static scenes",
    "type": "issue",
    "updated_at": "2016-12-24T19:47:29Z",
    "url": "https://github.com/sagemath/sage/issues/22042",
    "user": "https://github.com/paulmasson"
}
```
This addresses https://groups.google.com/d/msg/sage-devel/pGLZrwfdQB8/6OsQzr8fBgAJ

CC:  @sagetrac-tdumont @dimpase @vbraun

Keywords: **threejs**

Branch/Commit: **[a1e206c](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)**

Reviewer: **Dima Pasechnik**

Author: **Paul Masson**

_Issue created by migration from https://trac.sagemath.org/ticket/22042_





---

archive/issue_events_290744.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-12-10T01:35:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "milestone_number": null,
    "milestone_title": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290744"
}
```



---

archive/issue_events_290745.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-12-10T01:35:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "component: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290745"
}
```



---

archive/issue_events_290746.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-12-10T01:35:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290746"
}
```



---

archive/issue_events_290747.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-12-10T01:35:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290747"
}
```



---

archive/issue_comments_327466.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+This addresses https://groups.google.com/d/msg/sage-devel/pGLZrwfdQB8/6OsQzr8fBgAJ\n``````\n",
    "created_at": "2016-12-10T03:18:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327466",
    "user": "https://github.com/paulmasson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+This addresses https://groups.google.com/d/msg/sage-devel/pGLZrwfdQB8/6OsQzr8fBgAJ
``````




---

archive/issue_comments_327467.json:
```json
{
    "body": "Branch: **[u/paulmasson/22042](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/22042)**",
    "created_at": "2016-12-10T03:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327467",
    "user": "https://github.com/paulmasson"
}
```

Branch: **[u/paulmasson/22042](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/22042)**



---

archive/issue_comments_327468.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b007e2a766ab2e165f0f13e3d7fecb3e811597ec\">b007e2a</a></td><td><code>Reduce CPU load for static scenes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7\">48bd38d</a></td><td><code>Update documentation examples</code></td></tr></table>\n",
    "created_at": "2016-12-10T03:56:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327468",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:3" align="right">Comment 3</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b007e2a766ab2e165f0f13e3d7fecb3e811597ec">b007e2a</a></td><td><code>Reduce CPU load for static scenes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7">48bd38d</a></td><td><code>Update documentation examples</code></td></tr></table>




---

archive/issue_comments_327469.json:
```json
{
    "body": "Commit: **[48bd38d](https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7)**",
    "created_at": "2016-12-10T03:56:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327469",
    "user": "https://github.com/paulmasson"
}
```

Commit: **[48bd38d](https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7)**



---

archive/issue_events_290748.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-12-10T03:56:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290748"
}
```



---

archive/issue_comments_327470.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nDoes this change just disable the animation? \nI'd have expected something on the Python end of it too.",
    "created_at": "2016-12-10T08:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327470",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">Comment 4</div>

Does this change just disable the animation? 
I'd have expected something on the Python end of it too.



---

archive/issue_comments_327471.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nReplying to [@dimpase](#comment%3A4):\n> I'd have expected something on the Python end of it too.\n\nSince all of the rendering happens in JavaScript, there is no need to alter any Python for this ticket. With these changes the scene is rendered only upon user interaction.",
    "created_at": "2016-12-10T20:33:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327471",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:5" align="right">Comment 5</div>

Replying to [@dimpase](#comment%3A4):
> I'd have expected something on the Python end of it too.

Since all of the rendering happens in JavaScript, there is no need to alter any Python for this ticket. With these changes the scene is rendered only upon user interaction.



---

archive/issue_comments_327472.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nReplying to [@paulmasson](#comment%3A5):\n> Replying to [@dimpase](#comment%3A4):\n> > I'd have expected something on the Python end of it too.\n\n> Since all of the rendering happens in JavaScript, there is no need to alter any Python for this ticket. With these changes the scene is rendered only upon user interaction.\n\nI mean, `animate` is set to `false` and remains so, and several pieces in the code\nare conditional on its value. I'd imagine that it ought to be under the user control whether to animate or not. What is the point, can't you just remove these that are only executed for `animate==true`, and make the rest unconditional? \n\nI also really do not understand how the examples touched by this change are relevant for Sage. OK, these are examples how to render something in javascript. So?",
    "created_at": "2016-12-10T21:17:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327472",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">Comment 6</div>

Replying to [@paulmasson](#comment%3A5):
> Replying to [@dimpase](#comment%3A4):
> > I'd have expected something on the Python end of it too.

> Since all of the rendering happens in JavaScript, there is no need to alter any Python for this ticket. With these changes the scene is rendered only upon user interaction.

I mean, `animate` is set to `false` and remains so, and several pieces in the code
are conditional on its value. I'd imagine that it ought to be under the user control whether to animate or not. What is the point, can't you just remove these that are only executed for `animate==true`, and make the rest unconditional? 

I also really do not understand how the examples touched by this change are relevant for Sage. OK, these are examples how to render something in javascript. So?



---

archive/issue_comments_327473.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nReplying to [@dimpase](#comment%3A6):\n> Replying to [@paulmasson](#comment%3A5):\n> > Replying to [@dimpase](#comment%3A4):\n\n> I mean, `animate` is set to `false` and remains so, and several pieces in the code\n> are conditional on its value. I'd imagine that it ought to be under the user control whether to animate or not. What is the point, can't you just remove these that are only executed for `animate==true`, and make the rest unconditional? \n\nAnimation is not currently supported by this viewer but will be, at which point there will be a keyword option `animate` that will set the JavaScript variable. The conditionals will be necessary at some point in the near future and are included in preparation for additional functionality.\n> I also really do not understand how the examples touched by this change are relevant for Sage. OK, these are examples how to render something in javascript. So?\n\nThe examples are embedded in the documentation for this viewer. If you build the documentation, you'll see them in the file `threejs.html` in `reference/plot3d`.",
    "created_at": "2016-12-10T22:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327473",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:7" align="right">Comment 7</div>

Replying to [@dimpase](#comment%3A6):
> Replying to [@paulmasson](#comment%3A5):
> > Replying to [@dimpase](#comment%3A4):

> I mean, `animate` is set to `false` and remains so, and several pieces in the code
> are conditional on its value. I'd imagine that it ought to be under the user control whether to animate or not. What is the point, can't you just remove these that are only executed for `animate==true`, and make the rest unconditional? 

Animation is not currently supported by this viewer but will be, at which point there will be a keyword option `animate` that will set the JavaScript variable. The conditionals will be necessary at some point in the near future and are included in preparation for additional functionality.
> I also really do not understand how the examples touched by this change are relevant for Sage. OK, these are examples how to render something in javascript. So?

The examples are embedded in the documentation for this viewer. If you build the documentation, you'll see them in the file `threejs.html` in `reference/plot3d`.



---

archive/issue_comments_327474.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nI'd like to see a comment in the code explaining the change, as it's\nquite counter-intuitive.",
    "created_at": "2016-12-11T22:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327474",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">Comment 8</div>

I'd like to see a comment in the code explaining the change, as it's
quite counter-intuitive.



---

archive/issue_comments_327475.json:
```json
{
    "body": "Changed commit from **[48bd38d](https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7)** to **[a1e206c](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)**",
    "created_at": "2016-12-11T23:55:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327475",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[48bd38d](https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7)** to **[a1e206c](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)**



---

archive/issue_comments_327476.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2\">a1e206c</a></td><td><code>Add explanatory comment</code></td></tr></table>\n",
    "created_at": "2016-12-11T23:55:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327476",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9" align="right">Comment 9</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2">a1e206c</a></td><td><code>Add explanatory comment</code></td></tr></table>




---

archive/issue_comments_327477.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@dimpase](#comment%3A8):\n> I'd like to see a comment in the code explaining the change, as it's\n> quite counter-intuitive.  \n\nDone.",
    "created_at": "2016-12-11T23:57:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327477",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@dimpase](#comment%3A8):
> I'd like to see a comment in the code explaining the change, as it's
> quite counter-intuitive.  

Done.



---

archive/issue_comments_327478.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nlooks good to me, thanks!",
    "created_at": "2016-12-14T23:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327478",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">Comment 11</div>

looks good to me, thanks!



---

archive/issue_comments_327479.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2016-12-14T23:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327479",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_290749.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-12-14T23:20:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290749"
}
```



---

archive/issue_events_290750.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-12-14T23:20:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290750"
}
```



---

archive/issue_comments_327480.json:
```json
{
    "body": "Changed branch from **[u/paulmasson/22042](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/22042)** to **[a1e206c](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)**",
    "created_at": "2016-12-24T19:47:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327480",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/paulmasson/22042](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/22042)** to **[a1e206c](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)**



---

archive/issue_events_290751.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-12-24T19:47:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290751"
}
```



---

archive/issue_events_290752.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bb399086c47a7cc6c208ddc7f5671963f4f28a86",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-12-24T19:47:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-290752"
}
```
