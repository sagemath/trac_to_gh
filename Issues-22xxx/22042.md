# Issue 22042: Three.js: reduce CPU load for static scenes

archive/issues_021805.json:
```json
{
    "body": "This addresses https://groups.google.com/d/msg/sage-devel/pGLZrwfdQB8/6OsQzr8fBgAJ\n\n**CC:**  tdumont @dimpase @vbraun\n\n**Keywords:** threejs\n\n**Branch/Commit:** [a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Paul Masson\n\nIssue created by migration from https://trac.sagemath.org/ticket/22042\n\n",
    "closed_at": "2016-12-24T19:47:29Z",
    "created_at": "2016-12-10T01:35:09Z",
    "labels": [
        "component: graphics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.5",
    "title": "Three.js: reduce CPU load for static scenes",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/22042",
    "user": "https://github.com/paulmasson"
}
```
This addresses https://groups.google.com/d/msg/sage-devel/pGLZrwfdQB8/6OsQzr8fBgAJ

**CC:**  tdumont @dimpase @vbraun

**Keywords:** threejs

**Branch/Commit:** [a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)

**Reviewer:** Dima Pasechnik

**Author:** Paul Masson

Issue created by migration from https://trac.sagemath.org/ticket/22042





---

archive/issue_comments_327364.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+This addresses https://groups.google.com/d/msg/sage-devel/pGLZrwfdQB8/6OsQzr8fBgAJ\n``````\n",
    "created_at": "2016-12-10T03:18:47Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327364",
    "user": "https://github.com/paulmasson"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+This addresses https://groups.google.com/d/msg/sage-devel/pGLZrwfdQB8/6OsQzr8fBgAJ
``````




---

archive/issue_comments_327365.json:
```json
{
    "body": "**Branch:** [u/paulmasson/22042](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/22042)",
    "created_at": "2016-12-10T03:55:47Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327365",
    "user": "https://github.com/paulmasson"
}
```

**Branch:** [u/paulmasson/22042](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/22042)



---

archive/issue_comments_327366.json:
```json
{
    "body": "<a id='comment:3'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b007e2a766ab2e165f0f13e3d7fecb3e811597ec\">b007e2a</a></td><td><code>Reduce CPU load for static scenes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7\">48bd38d</a></td><td><code>Update documentation examples</code></td></tr></table>\n",
    "created_at": "2016-12-10T03:56:52Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327366",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:3'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b007e2a766ab2e165f0f13e3d7fecb3e811597ec">b007e2a</a></td><td><code>Reduce CPU load for static scenes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7">48bd38d</a></td><td><code>Update documentation examples</code></td></tr></table>




---

archive/issue_comments_327367.json:
```json
{
    "body": "**Commit:** [48bd38d20a0f03d9f283203d6243578719e92cb7](https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7)",
    "created_at": "2016-12-10T03:56:52Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327367",
    "user": "https://github.com/paulmasson"
}
```

**Commit:** [48bd38d20a0f03d9f283203d6243578719e92cb7](https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7)



---

archive/issue_events_197009.json:
```json
{
    "actor": "https://github.com/paulmasson",
    "created_at": "2016-12-10T03:56:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-197009"
}
```



---

archive/issue_comments_327368.json:
```json
{
    "body": "<a id='comment:4'></a>\nDoes this change just disable the animation? \nI'd have expected something on the Python end of it too.",
    "created_at": "2016-12-10T08:44:13Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327368",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
Does this change just disable the animation? 
I'd have expected something on the Python end of it too.



---

archive/issue_comments_327369.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [@dimpase](#comment%3A4):\n> I'd have expected something on the Python end of it too.\n\nSince all of the rendering happens in JavaScript, there is no need to alter any Python for this ticket. With these changes the scene is rendered only upon user interaction.",
    "created_at": "2016-12-10T20:33:55Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327369",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:5'></a>
Replying to [@dimpase](#comment%3A4):
> I'd have expected something on the Python end of it too.

Since all of the rendering happens in JavaScript, there is no need to alter any Python for this ticket. With these changes the scene is rendered only upon user interaction.



---

archive/issue_comments_327370.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [@paulmasson](#comment%3A5):\n> Replying to [@dimpase](#comment%3A4):\n> > I'd have expected something on the Python end of it too.\n\n> Since all of the rendering happens in JavaScript, there is no need to alter any Python for this ticket. With these changes the scene is rendered only upon user interaction.\n\nI mean, `animate` is set to `false` and remains so, and several pieces in the code\nare conditional on its value. I'd imagine that it ought to be under the user control whether to animate or not. What is the point, can't you just remove these that are only executed for `animate==true`, and make the rest unconditional? \n\nI also really do not understand how the examples touched by this change are relevant for Sage. OK, these are examples how to render something in javascript. So?",
    "created_at": "2016-12-10T21:17:01Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327370",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
Replying to [@paulmasson](#comment%3A5):
> Replying to [@dimpase](#comment%3A4):
> > I'd have expected something on the Python end of it too.

> Since all of the rendering happens in JavaScript, there is no need to alter any Python for this ticket. With these changes the scene is rendered only upon user interaction.

I mean, `animate` is set to `false` and remains so, and several pieces in the code
are conditional on its value. I'd imagine that it ought to be under the user control whether to animate or not. What is the point, can't you just remove these that are only executed for `animate==true`, and make the rest unconditional? 

I also really do not understand how the examples touched by this change are relevant for Sage. OK, these are examples how to render something in javascript. So?



---

archive/issue_comments_327371.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [@dimpase](#comment%3A6):\n> Replying to [@paulmasson](#comment%3A5):\n> > Replying to [@dimpase](#comment%3A4):\n\n> I mean, `animate` is set to `false` and remains so, and several pieces in the code\n> are conditional on its value. I'd imagine that it ought to be under the user control whether to animate or not. What is the point, can't you just remove these that are only executed for `animate==true`, and make the rest unconditional? \n\nAnimation is not currently supported by this viewer but will be, at which point there will be a keyword option `animate` that will set the JavaScript variable. The conditionals will be necessary at some point in the near future and are included in preparation for additional functionality.\n> I also really do not understand how the examples touched by this change are relevant for Sage. OK, these are examples how to render something in javascript. So?\n\nThe examples are embedded in the documentation for this viewer. If you build the documentation, you'll see them in the file `threejs.html` in `reference/plot3d`.",
    "created_at": "2016-12-10T22:15:27Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327371",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:7'></a>
Replying to [@dimpase](#comment%3A6):
> Replying to [@paulmasson](#comment%3A5):
> > Replying to [@dimpase](#comment%3A4):

> I mean, `animate` is set to `false` and remains so, and several pieces in the code
> are conditional on its value. I'd imagine that it ought to be under the user control whether to animate or not. What is the point, can't you just remove these that are only executed for `animate==true`, and make the rest unconditional? 

Animation is not currently supported by this viewer but will be, at which point there will be a keyword option `animate` that will set the JavaScript variable. The conditionals will be necessary at some point in the near future and are included in preparation for additional functionality.
> I also really do not understand how the examples touched by this change are relevant for Sage. OK, these are examples how to render something in javascript. So?

The examples are embedded in the documentation for this viewer. If you build the documentation, you'll see them in the file `threejs.html` in `reference/plot3d`.



---

archive/issue_comments_327372.json:
```json
{
    "body": "<a id='comment:8'></a>\nI'd like to see a comment in the code explaining the change, as it's\nquite counter-intuitive.",
    "created_at": "2016-12-11T22:15:14Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327372",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>
I'd like to see a comment in the code explaining the change, as it's
quite counter-intuitive.



---

archive/issue_comments_327373.json:
```json
{
    "body": "**Changing commit** from \"[48bd38d20a0f03d9f283203d6243578719e92cb7](https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7)\" to \"[a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)\".",
    "created_at": "2016-12-11T23:55:05Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327373",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[48bd38d20a0f03d9f283203d6243578719e92cb7](https://github.com/sagemath/sagetrac-mirror/commit/48bd38d20a0f03d9f283203d6243578719e92cb7)" to "[a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)".



---

archive/issue_comments_327374.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2\">a1e206c</a></td><td><code>Add explanatory comment</code></td></tr></table>\n",
    "created_at": "2016-12-11T23:55:05Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2">a1e206c</a></td><td><code>Add explanatory comment</code></td></tr></table>




---

archive/issue_comments_327375.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [@dimpase](#comment%3A8):\n> I'd like to see a comment in the code explaining the change, as it's\n> quite counter-intuitive.  \n\nDone.",
    "created_at": "2016-12-11T23:57:05Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327375",
    "user": "https://github.com/paulmasson"
}
```

<a id='comment:10'></a>
Replying to [@dimpase](#comment%3A8):
> I'd like to see a comment in the code explaining the change, as it's
> quite counter-intuitive.  

Done.



---

archive/issue_comments_327376.json:
```json
{
    "body": "<a id='comment:11'></a>\nlooks good to me, thanks!",
    "created_at": "2016-12-14T23:20:11Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327376",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
looks good to me, thanks!



---

archive/issue_comments_327377.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2016-12-14T23:20:11Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327377",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_events_197010.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-12-14T23:20:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-197010"
}
```



---

archive/issue_events_197011.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-12-14T23:20:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-197011"
}
```



---

archive/issue_comments_327378.json:
```json
{
    "body": "**Changing branch** from \"[u/paulmasson/22042](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/22042)\" to \"[a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)\".",
    "created_at": "2016-12-24T19:47:29Z",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22042#issuecomment-327378",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/paulmasson/22042](https://github.com/sagemath/sagetrac-mirror/tree/u/paulmasson/22042)" to "[a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2](https://github.com/sagemath/sagetrac-mirror/commit/a1e206c71a4ab1acfa5969c70e3ec45ed542d3a2)".



---

archive/issue_events_197012.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-12-24T19:47:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-197012"
}
```



---

archive/issue_events_197013.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bb399086c47a7cc6c208ddc7f5671963f4f28a86",
    "created_at": "2016-12-24T19:47:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22042",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22042#event-197013"
}
```
