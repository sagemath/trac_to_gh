# Issue 22322: allow sympy algorithm in solve

archive/issues_022085.json:
```json
{
    "assignees": [],
    "body": "What it says.  See e.g. [this post](https://ask.sagemath.org/question/36469/understanding-solve/) for why.\n\nDepends on #23990\nDepends on #24104\nDepends on #24062\n\nCC:  @rwst @mforets @sagetrac-tmonteil @EmmanuelCharpentier\n\nBranch/Commit: **[8e1e240](https://github.com/sagemath/sagetrac-mirror/commit/8e1e240bb9b8d735251847e67deec1fdb32eccba)**\n\nReviewer: **Emmanuel Charpentier**\n\nAuthor: **Ralf Stephan**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22322_\n\n",
    "closed_at": "2017-12-13T17:38:46Z",
    "created_at": "2017-02-07T16:30:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "allow sympy algorithm in solve",
    "type": "issue",
    "updated_at": "2017-12-13T17:38:46Z",
    "url": "https://github.com/sagemath/sage/issues/22322",
    "user": "https://github.com/kcrisman"
}
```
What it says.  See e.g. [this post](https://ask.sagemath.org/question/36469/understanding-solve/) for why.

Depends on #23990
Depends on #24104
Depends on #24062

CC:  @rwst @mforets @sagetrac-tmonteil @EmmanuelCharpentier

Branch/Commit: **[8e1e240](https://github.com/sagemath/sagetrac-mirror/commit/8e1e240bb9b8d735251847e67deec1fdb32eccba)**

Reviewer: **Emmanuel Charpentier**

Author: **Ralf Stephan**

_Issue created by migration from https://trac.sagemath.org/ticket/22322_





---

archive/issue_events_294326.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2017-02-07T16:30:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294326"
}
```



---

archive/issue_events_294327.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2017-02-07T16:30:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "component: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294327"
}
```



---

archive/issue_events_294328.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2017-02-07T16:30:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294328"
}
```



---

archive/issue_events_294329.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2017-02-07T16:30:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294329"
}
```



---

archive/issue_comments_332571.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nAFAIK, also useful for equations where the unkown appears as an exponent, cf. [solve(4.94 * 1.062^x == 15, x)](https://ask.sagemath.org/question/37640/solving-returns-x/)",
    "created_at": "2017-05-20T09:51:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332571",
    "user": "https://github.com/mforets"
}
```

<div id="comment:1" align="right">Comment 1</div>

AFAIK, also useful for equations where the unkown appears as an exponent, cf. [solve(4.94 * 1.062^x == 15, x)](https://ask.sagemath.org/question/37640/solving-returns-x/)



---

archive/issue_comments_332572.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\n`solve` (from `expression.pyx`) passes a relational expression to Maxima's solve, but this doesn't seem to be available in sympy:\n\n```\nsage: (x==1)._maxima_()\n_SAGE_VAR_x=1\nsage: (x==1)._sympy_()\nTraceback (most recent call last)\n...\nNotImplementedError: relation\n```\n\ndo you have some idea on how to tackle this? otherwise, what about passing `ex.lhs()-ex.rhs()` to sympy's solve.",
    "created_at": "2017-06-04T13:05:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332572",
    "user": "https://github.com/mforets"
}
```

<div id="comment:3" align="right">Comment 3</div>

`solve` (from `expression.pyx`) passes a relational expression to Maxima's solve, but this doesn't seem to be available in sympy:

```
sage: (x==1)._maxima_()
_SAGE_VAR_x=1
sage: (x==1)._sympy_()
Traceback (most recent call last)
...
NotImplementedError: relation
```

do you have some idea on how to tackle this? otherwise, what about passing `ex.lhs()-ex.rhs()` to sympy's solve.



---

archive/issue_comments_332573.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nReplying to [@mforets](#comment%3A3):\n> `solve` (from `expression.pyx`) passes a relational expression to Maxima's solve, but this doesn't seem to be available in sympy:\n> ...\n> do you have some idea on how to tackle this? otherwise, what about passing `ex.lhs()-ex.rhs()` to sympy's solve.\n\nYes, that would be it for the equalities. For inequalities `SympyConverter.relation()` is needed (atm the superclass's `relation` is called).",
    "created_at": "2017-06-05T05:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332573",
    "user": "https://github.com/rwst"
}
```

<div id="comment:4" align="right">Comment 4</div>

Replying to [@mforets](#comment%3A3):
> `solve` (from `expression.pyx`) passes a relational expression to Maxima's solve, but this doesn't seem to be available in sympy:
> ...
> do you have some idea on how to tackle this? otherwise, what about passing `ex.lhs()-ex.rhs()` to sympy's solve.

Yes, that would be it for the equalities. For inequalities `SympyConverter.relation()` is needed (atm the superclass's `relation` is called).



---

archive/issue_comments_332574.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nCorrection, doing `ex.lhs()-ex.rhs()` is not needed if the `SympyConverter` is fixed.",
    "created_at": "2017-06-05T05:38:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332574",
    "user": "https://github.com/rwst"
}
```

<div id="comment:5" align="right">Comment 5</div>

Correction, doing `ex.lhs()-ex.rhs()` is not needed if the `SympyConverter` is fixed.



---

archive/issue_comments_332575.json:
```json
{
    "body": "Dependencies: **#23990**",
    "created_at": "2017-10-08T14:21:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332575",
    "user": "https://github.com/rwst"
}
```

Dependencies: **#23990**



---

archive/issue_comments_332576.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nHmmm...\n\n```\nsage: var(\"a,b\")\n(a, b)\nsage: sympy.sympify(a==b)._sage_()\na == b\nsage: sympy.sympify(a==b).sage()\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-14-25de6a4c8f0a> in <module>()\n----> 1 sympy.sympify(a==b).sage()\n\nAttributeError: 'Equality' object has no attribute 'sage'\n```\n\nIs that the expected behaviour ? Or do you plan to enhance the `.sage()` method for various objects ?\n\nIt is not obvious to me why (e. g.) mathematica objets can (sometimes...) be converted back to sage via the `.sage()` (exposed) method, whereas Sympy objects have to use the `._sage_()` (unexposed method.",
    "created_at": "2017-10-10T11:17:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332576",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:8" align="right">Comment 8</div>

Hmmm...

```
sage: var("a,b")
(a, b)
sage: sympy.sympify(a==b)._sage_()
a == b
sage: sympy.sympify(a==b).sage()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-14-25de6a4c8f0a> in <module>()
----> 1 sympy.sympify(a==b).sage()

AttributeError: 'Equality' object has no attribute 'sage'
```

Is that the expected behaviour ? Or do you plan to enhance the `.sage()` method for various objects ?

It is not obvious to me why (e. g.) mathematica objets can (sometimes...) be converted back to sage via the `.sage()` (exposed) method, whereas Sympy objects have to use the `._sage_()` (unexposed method.



---

archive/issue_events_294330.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-10-10T11:17:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294330"
}
```



---

archive/issue_comments_332577.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nAs I explained in #23990 that is the SymPy convention.",
    "created_at": "2017-10-10T13:28:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332577",
    "user": "https://github.com/rwst"
}
```

<div id="comment:9" align="right">Comment 9</div>

As I explained in #23990 that is the SymPy convention.



---

archive/issue_comments_332578.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@rwst](#comment%3A9):\n> As I explained in #23990 that is the SymPy convention.\n\nWups, ~~bad~~ wrong ticket. I *thought* that my comment was cancelled ; it was not.\n\nApologies...",
    "created_at": "2017-10-10T13:56:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332578",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@rwst](#comment%3A9):
> As I explained in #23990 that is the SymPy convention.

Wups, ~~bad~~ wrong ticket. I *thought* that my comment was cancelled ; it was not.

Apologies...



---

archive/issue_comments_332579.json:
```json
{
    "body": "Changed dependencies from **#23990** to **#23990, #24078**",
    "created_at": "2017-10-20T13:06:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332579",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#23990** to **#23990, #24078**



---

archive/issue_events_294331.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-10-20T13:06:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294331"
}
```



---

archive/issue_events_294332.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-10-20T13:06:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294332"
}
```



---

archive/issue_comments_332580.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nNow that (with #23990) relations are translated from/to SymPy there are still things needed. For example we need to translate any assumptions on variables (and maybe anon. functions?) that were made using `assume` and `var('x', domain=...)`. This is not only relevant for this ticket, any SymPy operation may access the SymPy knowledge base any time. So I think this should be handled the same way as with Maxima, i.e. at the time the `assume`/`var` calls are made. This is #24078.",
    "created_at": "2017-10-20T13:06:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332580",
    "user": "https://github.com/rwst"
}
```

<div id="comment:11" align="right">Comment 11</div>

Now that (with #23990) relations are translated from/to SymPy there are still things needed. For example we need to translate any assumptions on variables (and maybe anon. functions?) that were made using `assume` and `var('x', domain=...)`. This is not only relevant for this ticket, any SymPy operation may access the SymPy knowledge base any time. So I think this should be handled the same way as with Maxima, i.e. at the time the `assume`/`var` calls are made. This is #24078.



---

archive/issue_comments_332581.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nNote that SymPy's solve does not respect the global assumptions database:\n\n```\nIn [12]: global_assumptions\nOut[12]: AssumptionsContext([Q.is_true(x > 2), Q.positive(x)])\n\nIn [13]: solve(x<3)\nOut[13]: -\u221e < x \u2227 x < 3\n\nIn [15]: solve((x>2,x<3))\nOut[15]: 2 < x \u2227 x < 3\n```\nSo the dependency is irrelevant (at the moment).",
    "created_at": "2017-10-20T13:33:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332581",
    "user": "https://github.com/rwst"
}
```

<div id="comment:12" align="right">Comment 12</div>

Note that SymPy's solve does not respect the global assumptions database:

```
In [12]: global_assumptions
Out[12]: AssumptionsContext([Q.is_true(x > 2), Q.positive(x)])

In [13]: solve(x<3)
Out[13]: -∞ < x ∧ x < 3

In [15]: solve((x>2,x<3))
Out[15]: 2 < x ∧ x < 3
```
So the dependency is irrelevant (at the moment).



---

archive/issue_comments_332582.json:
```json
{
    "body": "Changed dependencies from **#23990, #24078** to **#23990**",
    "created_at": "2017-10-20T13:33:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332582",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#23990, #24078** to **#23990**



---

archive/issue_comments_332583.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nOur solve doesn't either, so it all is localized in the solve arguments:\n\n```\nsage: assume(x>2)\nsage: solve(x<3,x)\n[[x < 3]]\nsage: solve((x>2,x<3),x)\n[[2 < x, x < 3]]\n```",
    "created_at": "2017-10-20T13:51:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332583",
    "user": "https://github.com/rwst"
}
```

<div id="comment:13" align="right">Comment 13</div>

Our solve doesn't either, so it all is localized in the solve arguments:

```
sage: assume(x>2)
sage: solve(x<3,x)
[[x < 3]]
sage: solve((x>2,x<3),x)
[[2 < x, x < 3]]
```



---

archive/issue_comments_332584.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nOur solve's output is quite opaque IMHO:\n\n```\nsage: solve((x^2<1),x)\n[[x > -1, x < 1]]\nsage: solve((x^2>1),x)\n[[x < -1], [x > 1]]\n```\nFrom a glance, which is AND, which is OR? So I would like to use `And(...)` and `Or(...)` as in SymPy but:\n\n```\nsage: Or = function('Or')\nsage: ex = Or(x<0, x>1)\nsage: ex\nOr(x < 0, x > 1)\nsage: ex.args()\n(x,)\nsage: ex.operands()\n[x < 0, x > 1]\n\nsage: ex[0]\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-8-c8fc37b12ad9> in <module>()\n----> 1 ex[Integer(0)]\n\nTypeError: 'sage.symbolic.expression.Expression' object does not support indexing\n```\nSo people would need to know that `operands()` gets the solutions. Or we support indexing as alias to `operands()`.",
    "created_at": "2017-10-20T14:47:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332584",
    "user": "https://github.com/rwst"
}
```

<div id="comment:14" align="right">Comment 14</div>

Our solve's output is quite opaque IMHO:

```
sage: solve((x^2<1),x)
[[x > -1, x < 1]]
sage: solve((x^2>1),x)
[[x < -1], [x > 1]]
```
From a glance, which is AND, which is OR? So I would like to use `And(...)` and `Or(...)` as in SymPy but:

```
sage: Or = function('Or')
sage: ex = Or(x<0, x>1)
sage: ex
Or(x < 0, x > 1)
sage: ex.args()
(x,)
sage: ex.operands()
[x < 0, x > 1]

sage: ex[0]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-8-c8fc37b12ad9> in <module>()
----> 1 ex[Integer(0)]

TypeError: 'sage.symbolic.expression.Expression' object does not support indexing
```
So people would need to know that `operands()` gets the solutions. Or we support indexing as alias to `operands()`.



---

archive/issue_comments_332585.json:
```json
{
    "body": "Changed dependencies from **#23990** to **#23990, #24080**",
    "created_at": "2017-10-20T15:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332585",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#23990** to **#23990, #24080**



---

archive/issue_comments_332586.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@rwst](#comment%3A14):\n> So people would need to know that `operands()` gets the solutions. Or we support indexing as alias to `operands()`.\n\nSupporting expression indexing seems tricky. Also this is an interface change. Better move it to a future ticket.",
    "created_at": "2017-10-24T14:35:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332586",
    "user": "https://github.com/rwst"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@rwst](#comment%3A14):
> So people would need to know that `operands()` gets the solutions. Or we support indexing as alias to `operands()`.

Supporting expression indexing seems tricky. Also this is an interface change. Better move it to a future ticket.



---

archive/issue_comments_332587.json:
```json
{
    "body": "Changed dependencies from **#23990, #24080** to **#23990**",
    "created_at": "2017-10-24T14:35:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332587",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#23990, #24080** to **#23990**



---

archive/issue_comments_332588.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nI cannot believe devs maintained two different versions of `solve` in `symbolic/expression.pyx` and `symbolic/relation.py`. `expression.pyx` should only be an interface to a function elsewhere, preferably in `solve.py`.",
    "created_at": "2017-10-25T07:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332588",
    "user": "https://github.com/rwst"
}
```

<div id="comment:17" align="right">Comment 17</div>

I cannot believe devs maintained two different versions of `solve` in `symbolic/expression.pyx` and `symbolic/relation.py`. `expression.pyx` should only be an interface to a function elsewhere, preferably in `solve.py`.



---

archive/issue_comments_332589.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\n>  Note that SymPy's solve does not respect the global assumptions database: \n\nshall we consider interfacing with SymPy's [solveset](http://docs.sympy.org/latest/modules/solvers/solveset.html)? it is said to supersede [solve](http://docs.sympy.org/latest/modules/solvers/solvers.html) sooner or later.\n\ni find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions? (or to fallback into the global assumptions if the domain is not provided.)",
    "created_at": "2017-10-25T09:49:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332589",
    "user": "https://github.com/mforets"
}
```

<div id="comment:18" align="right">Comment 18</div>

>  Note that SymPy's solve does not respect the global assumptions database: 

shall we consider interfacing with SymPy's [solveset](http://docs.sympy.org/latest/modules/solvers/solveset.html)? it is said to supersede [solve](http://docs.sympy.org/latest/modules/solvers/solvers.html) sooner or later.

i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions? (or to fallback into the global assumptions if the domain is not provided.)



---

archive/issue_comments_332590.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nReplying to [@mforets](#comment%3A18):\n> >  Note that SymPy's solve does not respect the global assumptions database: \n\n> \n> shall we consider interfacing with SymPy's [solveset](http://docs.sympy.org/latest/modules/solvers/solveset.html)? it is said to supersede [solve](http://docs.sympy.org/latest/modules/solvers/solvers.html) sooner or later.\n\nFly in the ointment : `solve` can solve **systems** of equations, whereas `solveset` (which is, indeed, cleaner on more than one aspect), solves only equations.\n\nIn order to solve system, we would have to map `solveset` to all the equations in the system (each for one variable (which one ?)), and return the intersection of the results, which is currently problematic.\n\n\n> i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions? (or to fallback into the global assumptions if the domain is not provided.)\n\nThe domain is only a part of the possible assumptions : e. g., maxima often asks if some expression is positive, if such variable is integer, etc... We need to maintain a \"knowledge base\" about outr variables as least as rich as our current (= Maxima's) facts base.\n\nA few remarks :\n\n1) I note that Sympy's knowledge base is richer than ours, BTW.\n\n2) We might use profitably something analogous to Mathematica's `Assuming` statement, which does something (roughly )equivalent to :\n\n```\ndef assuming(condset, statement):\n    try:\n        OldAssumptions=assumptions()\n        Assumptions=OldAssumptions.copy()\n        Assumptions.extend(condset)\n        forget(assumptions())\n        assume(Assumptions)\n        result=<do statement, somehow>\n    finally:\n        forget(assumptions())\n        assume(OldAssumptions)\n```\nThe wasp in the ointment is of course that `statement` is evaluated before being passed to Assuming : Python has no macroes...\n\nI *think* that `assuming` could be implemented somehow as a decorator, but I'm still to understand *that*.",
    "created_at": "2017-10-25T10:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332590",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:19" align="right">Comment 19</div>

Replying to [@mforets](#comment%3A18):
> >  Note that SymPy's solve does not respect the global assumptions database: 

> 
> shall we consider interfacing with SymPy's [solveset](http://docs.sympy.org/latest/modules/solvers/solveset.html)? it is said to supersede [solve](http://docs.sympy.org/latest/modules/solvers/solvers.html) sooner or later.

Fly in the ointment : `solve` can solve **systems** of equations, whereas `solveset` (which is, indeed, cleaner on more than one aspect), solves only equations.

In order to solve system, we would have to map `solveset` to all the equations in the system (each for one variable (which one ?)), and return the intersection of the results, which is currently problematic.


> i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions? (or to fallback into the global assumptions if the domain is not provided.)

The domain is only a part of the possible assumptions : e. g., maxima often asks if some expression is positive, if such variable is integer, etc... We need to maintain a "knowledge base" about outr variables as least as rich as our current (= Maxima's) facts base.

A few remarks :

1) I note that Sympy's knowledge base is richer than ours, BTW.

2) We might use profitably something analogous to Mathematica's `Assuming` statement, which does something (roughly )equivalent to :

```
def assuming(condset, statement):
    try:
        OldAssumptions=assumptions()
        Assumptions=OldAssumptions.copy()
        Assumptions.extend(condset)
        forget(assumptions())
        assume(Assumptions)
        result=<do statement, somehow>
    finally:
        forget(assumptions())
        assume(OldAssumptions)
```
The wasp in the ointment is of course that `statement` is evaluated before being passed to Assuming : Python has no macroes...

I *think* that `assuming` could be implemented somehow as a decorator, but I'm still to understand *that*.



---

archive/issue_comments_332591.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nReplying to [@mforets](#comment%3A18):\n> i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions?\n\nI have abandoned the idea of respecting assumptions after I saw that SymPy doesn't either. We don't have to reproduce Maxima results so we're good.\n\n> solve can solve systems of equations, whereas solveset (which is, indeed, cleaner on more than one aspect), solves only equations.\n\nIf they replace it will be unified. And I think Sage's `ex.solve()` and `solve(ex)` should be unified too, if for no other reason than for better maintenance. \n\n> In order to solve system, we would have to map solveset to all the equations in the system (each for one variable (which one ?)), and return the intersection of the results, which is currently problematic.\n\nIt's always problematic because you need to decide ordering of expressions without variables, and that can take time because of the possible need to increase precision. The question is, should we support SymPy's solve or immediately use solveset exclusively?\n\n> We might use profitably something analogous to Mathematica's Assuming\n\nPlease review #10035.\n\n> We need to maintain a \"knowledge base\" about outr variables as least as rich as our current (= Maxima's) facts base.\n\nIsn't that the same as a local context?",
    "created_at": "2017-10-25T13:01:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332591",
    "user": "https://github.com/rwst"
}
```

<div id="comment:20" align="right">Comment 20</div>

Replying to [@mforets](#comment%3A18):
> i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions?

I have abandoned the idea of respecting assumptions after I saw that SymPy doesn't either. We don't have to reproduce Maxima results so we're good.

> solve can solve systems of equations, whereas solveset (which is, indeed, cleaner on more than one aspect), solves only equations.

If they replace it will be unified. And I think Sage's `ex.solve()` and `solve(ex)` should be unified too, if for no other reason than for better maintenance. 

> In order to solve system, we would have to map solveset to all the equations in the system (each for one variable (which one ?)), and return the intersection of the results, which is currently problematic.

It's always problematic because you need to decide ordering of expressions without variables, and that can take time because of the possible need to increase precision. The question is, should we support SymPy's solve or immediately use solveset exclusively?

> We might use profitably something analogous to Mathematica's Assuming

Please review #10035.

> We need to maintain a "knowledge base" about outr variables as least as rich as our current (= Maxima's) facts base.

Isn't that the same as a local context?



---

archive/issue_comments_332592.json:
```json
{
    "body": "Changed dependencies from **#23990** to **#23990, #24104**",
    "created_at": "2017-10-25T13:32:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332592",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#23990** to **#23990, #24104**



---

archive/issue_comments_332593.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@rwst](#comment%3A20):\n> Replying to [@mforets](#comment%3A18):\n\nAnd me, it seems...\n> > i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions?\n\n> \n> I have abandoned the idea of respecting assumptions after I saw that SymPy doesn't either. We don't have to reproduce Maxima results so we're good.\n\nThat's pushing the can down the road : in order to get the solutions, we're bound to solve a system comprising the solutions obtained without the assumptions and the assumptions themselves, which might be unsolvable (e. g. cubic equation with a solution in *casus irreducibilis* + constraints showing that the roots are real)...\n> \n> > solve can solve systems of equations, whereas solveset (which is, indeed, cleaner on more than one aspect), solves only equations.\n\n> \n> If they replace it will be unified. And I think Sage's `ex.solve()` and `solve(ex)` should be unified too, if for no other reason than for better maintenance. \n\nIndeed. If...\n> \n> > In order to solve system, we would have to map solveset to all the equations in the system (each for one variable (which one ?)), and return the intersection of the results, which is currently problematic.\n\n> \n> It's always problematic because you need to decide ordering of expressions without variables, and that can take time because of the possible need to increase precision. The question is, should we support SymPy's solve or immediately use solveset exclusively?\n\nIMHO, both. But that might be a lot of work.. Depends on your prognosis on the time necessary for the Sympy team to coax `solveset` in solving systems...\n> \n> > We might use profitably something analogous to Mathematica's Assuming\n\n> \n> Please review #10035.\n\nDone (positively). But that is a possible solution only for function calls supporting `hold`. `solve` isn't one of them.\n> > We need to maintain a \"knowledge base\" about outr variables as least as rich as our current (= Maxima's) facts base.\n\n> \n> Isn't that the same as a local context?\n\nI do not understand that (yet). Care to amplify ?\n\nAnd, BTW, thank you for the huge work you are doing on Sympy, which might turn out very important for Sage.",
    "created_at": "2017-10-25T20:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332593",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@rwst](#comment%3A20):
> Replying to [@mforets](#comment%3A18):

And me, it seems...
> > i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions?

> 
> I have abandoned the idea of respecting assumptions after I saw that SymPy doesn't either. We don't have to reproduce Maxima results so we're good.

That's pushing the can down the road : in order to get the solutions, we're bound to solve a system comprising the solutions obtained without the assumptions and the assumptions themselves, which might be unsolvable (e. g. cubic equation with a solution in *casus irreducibilis* + constraints showing that the roots are real)...
> 
> > solve can solve systems of equations, whereas solveset (which is, indeed, cleaner on more than one aspect), solves only equations.

> 
> If they replace it will be unified. And I think Sage's `ex.solve()` and `solve(ex)` should be unified too, if for no other reason than for better maintenance. 

Indeed. If...
> 
> > In order to solve system, we would have to map solveset to all the equations in the system (each for one variable (which one ?)), and return the intersection of the results, which is currently problematic.

> 
> It's always problematic because you need to decide ordering of expressions without variables, and that can take time because of the possible need to increase precision. The question is, should we support SymPy's solve or immediately use solveset exclusively?

IMHO, both. But that might be a lot of work.. Depends on your prognosis on the time necessary for the Sympy team to coax `solveset` in solving systems...
> 
> > We might use profitably something analogous to Mathematica's Assuming

> 
> Please review #10035.

Done (positively). But that is a possible solution only for function calls supporting `hold`. `solve` isn't one of them.
> > We need to maintain a "knowledge base" about outr variables as least as rich as our current (= Maxima's) facts base.

> 
> Isn't that the same as a local context?

I do not understand that (yet). Care to amplify ?

And, BTW, thank you for the huge work you are doing on Sympy, which might turn out very important for Sage.



---

archive/issue_comments_332594.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A22):\n> > Replying to [@mforets](#comment%3A18):\n> > Please review #10035.\n\n> Done (positively). But that is a possible solution only for function calls supporting `hold`. `solve` isn't one of them.\n\nIt motivates me to create a context infrastructure where you can say:\n\n```\nsage: mycontext = context(x>0, hold)\nsage: with mycontext:\nsage:     solve(...)\n```\nor\n\n```\nsage: mycontext.start()\nsage: ...\nsage: solve(...)\nsage: mycontext.stop()\n```\n\n> > > We need to maintain a \"knowledge base\" about outr variables as least as rich as our current (= Maxima's) facts base.\n\n> > \n> > Isn't that the same as a local context?\n\n> I do not understand that (yet). Care to amplify ?\n\nI gave the first answer in order to give an idea.\n\n> And, BTW, thank you for the huge work you are doing on Sympy, which might turn out very important for Sage.\n\nI remember reading in devel that previous developers hoped so too, also because at that time development on Pynac stopped and practically no one worked on symbolics in Sage. While that's no longer the case, solvers and integration need much help from SymPy, Fricas, and Giac.",
    "created_at": "2017-10-26T06:42:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332594",
    "user": "https://github.com/rwst"
}
```

<div id="comment:23" align="right">Comment 23</div>

Replying to [@EmmanuelCharpentier](#comment%3A22):
> > Replying to [@mforets](#comment%3A18):
> > Please review #10035.

> Done (positively). But that is a possible solution only for function calls supporting `hold`. `solve` isn't one of them.

It motivates me to create a context infrastructure where you can say:

```
sage: mycontext = context(x>0, hold)
sage: with mycontext:
sage:     solve(...)
```
or

```
sage: mycontext.start()
sage: ...
sage: solve(...)
sage: mycontext.stop()
```

> > > We need to maintain a "knowledge base" about outr variables as least as rich as our current (= Maxima's) facts base.

> > 
> > Isn't that the same as a local context?

> I do not understand that (yet). Care to amplify ?

I gave the first answer in order to give an idea.

> And, BTW, thank you for the huge work you are doing on Sympy, which might turn out very important for Sage.

I remember reading in devel that previous developers hoped so too, also because at that time development on Pynac stopped and practically no one worked on symbolics in Sage. While that's no longer the case, solvers and integration need much help from SymPy, Fricas, and Giac.



---

archive/issue_comments_332595.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A19):\n> In order to solve system, we would have to map `solveset` to all the equations in the system (each for one variable (which one ?)), and return the intersection of the results, which is currently problematic.\n\nMaybe we should not worry about doing intersections, convert to `RealSet`, intersect, convert back. `RealSet` uses `RealInterval` for comparison and I guess the problems have been thought about by its developers. But what to convert the `RealSet` to in the end? For starters the output of `solve` at the moment, i.e., lists of lists. The conversion `RealSet`-->lists might be of broader interest.",
    "created_at": "2017-10-26T13:41:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332595",
    "user": "https://github.com/rwst"
}
```

<div id="comment:24" align="right">Comment 24</div>

Replying to [@EmmanuelCharpentier](#comment%3A19):
> In order to solve system, we would have to map `solveset` to all the equations in the system (each for one variable (which one ?)), and return the intersection of the results, which is currently problematic.

Maybe we should not worry about doing intersections, convert to `RealSet`, intersect, convert back. `RealSet` uses `RealInterval` for comparison and I guess the problems have been thought about by its developers. But what to convert the `RealSet` to in the end? For starters the output of `solve` at the moment, i.e., lists of lists. The conversion `RealSet`-->lists might be of broader interest.



---

archive/issue_comments_332596.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nCaveat of using `RealSet`:\n\n```\nsage: pi.n(30) in RealSet.point(pi)\nFalse\nsage: pi.n(50) in RealSet.point(pi)\nTrue\n```",
    "created_at": "2017-10-26T13:56:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332596",
    "user": "https://github.com/rwst"
}
```

<div id="comment:25" align="right">Comment 25</div>

Caveat of using `RealSet`:

```
sage: pi.n(30) in RealSet.point(pi)
False
sage: pi.n(50) in RealSet.point(pi)
True
```



---

archive/issue_comments_332597.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nReplying to [@mforets](#comment%3A18):\n> i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions? (or to fallback into the global assumptions if the domain is not provided.)\n\nIt is. Propagating the `solveset` interface to our solve would mean at least supporting the option `domain='real'` with complex the default.",
    "created_at": "2017-10-26T14:40:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332597",
    "user": "https://github.com/rwst"
}
```

<div id="comment:26" align="right">Comment 26</div>

Replying to [@mforets](#comment%3A18):
> i find that the interface `(equation, variable, domain)` is very clear. isn't it preferable than relying on global assumptions? (or to fallback into the global assumptions if the domain is not provided.)

It is. Propagating the `solveset` interface to our solve would mean at least supporting the option `domain='real'` with complex the default.



---

archive/issue_comments_332598.json:
```json
{
    "body": "Changed dependencies from **#23990, #24104** to **#23990, #24104, #24062**",
    "created_at": "2017-10-26T15:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332598",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#23990, #24104** to **#23990, #24104, #24062**



---

archive/issue_comments_332599.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nSymPy seems to make a clear distinction between the operators in `x>0` and `Gt(x,0)`. I think it's wrong that `(x>0)._sympy_()` returns `x>0`.",
    "created_at": "2017-10-27T13:52:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332599",
    "user": "https://github.com/rwst"
}
```

<div id="comment:28" align="right">Comment 28</div>

SymPy seems to make a clear distinction between the operators in `x>0` and `Gt(x,0)`. I think it's wrong that `(x>0)._sympy_()` returns `x>0`.



---

archive/issue_comments_332600.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nAh no, I'm wrong. We do the right translation.",
    "created_at": "2017-10-27T13:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332600",
    "user": "https://github.com/rwst"
}
```

<div id="comment:29" align="right">Comment 29</div>

Ah no, I'm wrong. We do the right translation.



---

archive/issue_comments_332601.json:
```json
{
    "body": "Branch: **[u/rws/22322](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/22322)**",
    "created_at": "2017-10-27T14:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332601",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/22322](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/22322)**



---

archive/issue_comments_332602.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nThis branch works quite well and can be used and reviewed. It lacks doctests and documentation, which I'll add next. But please experiment with it. We use `solveset` with single-expression univariate tasks, `solve` for the rest. The output is unified to Sage's list \"format\".\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7899ea992d19f75e38e7db5526bb5c311d09d79a\">7899ea9</a></td><td><code>20204: convert SymPy abstract functions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b261ec3e671179d04d1922d15d9116e4f6e1d47f\">b261ec3</a></td><td><code>23923: fix doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5010acf00b2811420ba1a725deb2351f77eb0c01\">5010acf</a></td><td><code>Merge branch 'u/rws/23923' of git://trac.sagemath.org/sage into t/20204/20204</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14b1c523c468bfb304191edfe6e85a5c94e916f5\">14b1c52</a></td><td><code>20204: more doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c4119a3feda956846bd1fa78256830aef4739f8\">9c4119a</a></td><td><code>16801: Conversion of psi(x,y) to/from SymPy</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5c60e3418468f8b5325f06997646fb4f9bf6ced\">d5c60e3</a></td><td><code>24062: pkg version/chksum</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cbc23e8c18d4d93a19c225bf79cc85e3f37fd01\">1cbc23e</a></td><td><code>24062: remove obsolote patches; adapt remaining</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94f359f5a48696e2b98c346e3f120e9481d89a7c\">94f359f</a></td><td><code>24062: doctest fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf5c81a21f403d11a68c8c2827e771d3ed433df5\">cf5c81a</a></td><td><code>Merge branch 'u/rws/24062' of git://trac.sagemath.org/sage into t22322</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3073840e81e526524eea0ce89cb28bc83723c7d5\">3073840</a></td><td><code>22322: sympy algorithm in solve</code></td></tr></table>\n",
    "created_at": "2017-10-27T14:50:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332602",
    "user": "https://github.com/rwst"
}
```

<div id="comment:31" align="right">Comment 31</div>

This branch works quite well and can be used and reviewed. It lacks doctests and documentation, which I'll add next. But please experiment with it. We use `solveset` with single-expression univariate tasks, `solve` for the rest. The output is unified to Sage's list "format".

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7899ea992d19f75e38e7db5526bb5c311d09d79a">7899ea9</a></td><td><code>20204: convert SymPy abstract functions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b261ec3e671179d04d1922d15d9116e4f6e1d47f">b261ec3</a></td><td><code>23923: fix doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5010acf00b2811420ba1a725deb2351f77eb0c01">5010acf</a></td><td><code>Merge branch 'u/rws/23923' of git://trac.sagemath.org/sage into t/20204/20204</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14b1c523c468bfb304191edfe6e85a5c94e916f5">14b1c52</a></td><td><code>20204: more doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c4119a3feda956846bd1fa78256830aef4739f8">9c4119a</a></td><td><code>16801: Conversion of psi(x,y) to/from SymPy</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5c60e3418468f8b5325f06997646fb4f9bf6ced">d5c60e3</a></td><td><code>24062: pkg version/chksum</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cbc23e8c18d4d93a19c225bf79cc85e3f37fd01">1cbc23e</a></td><td><code>24062: remove obsolote patches; adapt remaining</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94f359f5a48696e2b98c346e3f120e9481d89a7c">94f359f</a></td><td><code>24062: doctest fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf5c81a21f403d11a68c8c2827e771d3ed433df5">cf5c81a</a></td><td><code>Merge branch 'u/rws/24062' of git://trac.sagemath.org/sage into t22322</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3073840e81e526524eea0ce89cb28bc83723c7d5">3073840</a></td><td><code>22322: sympy algorithm in solve</code></td></tr></table>




---

archive/issue_comments_332603.json:
```json
{
    "body": "Commit: **[3073840](https://github.com/sagemath/sagetrac-mirror/commit/3073840e81e526524eea0ce89cb28bc83723c7d5)**",
    "created_at": "2017-10-27T14:50:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332603",
    "user": "https://github.com/rwst"
}
```

Commit: **[3073840](https://github.com/sagemath/sagetrac-mirror/commit/3073840e81e526524eea0ce89cb28bc83723c7d5)**



---

archive/issue_comments_332604.json:
```json
{
    "body": "Author: **Ralf Stephan**",
    "created_at": "2017-10-27T14:50:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332604",
    "user": "https://github.com/rwst"
}
```

Author: **Ralf Stephan**



---

archive/issue_comments_332605.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nAnd `domain='real'` is recognized too.",
    "created_at": "2017-10-27T14:52:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332605",
    "user": "https://github.com/rwst"
}
```

<div id="comment:32" align="right">Comment 32</div>

And `domain='real'` is recognized too.



---

archive/issue_comments_332606.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nAh, multivariate doesn't work at the moment.",
    "created_at": "2017-10-27T15:36:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332606",
    "user": "https://github.com/rwst"
}
```

<div id="comment:33" align="right">Comment 33</div>

Ah, multivariate doesn't work at the moment.



---

archive/issue_comments_332607.json:
```json
{
    "body": "Changed commit from **[3073840](https://github.com/sagemath/sagetrac-mirror/commit/3073840e81e526524eea0ce89cb28bc83723c7d5)** to **[eac5f8b](https://github.com/sagemath/sagetrac-mirror/commit/eac5f8bf8a12da0373bed819bcd060673a2f7aa4)**",
    "created_at": "2017-10-28T06:07:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332607",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3073840](https://github.com/sagemath/sagetrac-mirror/commit/3073840e81e526524eea0ce89cb28bc83723c7d5)** to **[eac5f8b](https://github.com/sagemath/sagetrac-mirror/commit/eac5f8bf8a12da0373bed819bcd060673a2f7aa4)**



---

archive/issue_comments_332608.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eac5f8bf8a12da0373bed819bcd060673a2f7aa4\">eac5f8b</a></td><td><code>22322: fixes</code></td></tr></table>\n",
    "created_at": "2017-10-28T06:07:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332608",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34" align="right">Comment 34</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eac5f8bf8a12da0373bed819bcd060673a2f7aa4">eac5f8b</a></td><td><code>22322: fixes</code></td></tr></table>




---

archive/issue_comments_332609.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nReplying to [@rwst](#comment%3A23):\n\n[Snip ... ]\n\n> It motivates me to create a context infrastructure where you can say:\n> \n> ```\n> sage: mycontext = context(x>0, hold)\n> sage: with mycontext:\n> sage:     solve(...)\n> ```\n> or\n> \n> ```\n> sage: mycontext.start()\n> sage: ...\n> sage: solve(...)\n> sage: mycontext.stop()\n> ```\n\nMaybe #24119 might be relevant ? It doesn't medles with evaluation (or not) of the body of the `with`, it just brackets this body with temporary updates to the facts database. Not the problem you are trying to solve, but might be handy...\n\n[ Re-snip ... ]\n\n> I remember reading in devel that previous developers hoped so too, also because at that time development on Pynac stopped and practically no one worked on symbolics in Sage. While that's no longer the case, solvers and integration need much help from SymPy, Fricas, and Giac.\n\nIn my (limited) experience, the ability od Sage to call \"at will\"  SymPy, fricas, giac (and even maple and  mathematica, but shhh...) is *extremely* useful for practical work. Add `Sage\\TeX` to the mixture (the notebook is nice for prottyping, but I'm sold on \"literate programming\" for any serious publication work...), and you get a tool whose usefulness surpasses those of any of its components.\n\nIMHO, Sage needs a lot of development in the \"engineering/scientific/undergrad maths\" department, which is not, to say the least, the core interest of its core developers. I see the work in this direction as an *investment* : if we make a tool useful to those non-professional-mathematician users,I would be quite surprised that none of them would dive in Sage development in these departments, thus relieving the algebraists, geometers and number theorist who *are* the core  developers of Sage of the infrastructure and maintenance work.",
    "created_at": "2017-10-28T22:11:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332609",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:35" align="right">Comment 35</div>

Replying to [@rwst](#comment%3A23):

[Snip ... ]

> It motivates me to create a context infrastructure where you can say:
> 
> ```
> sage: mycontext = context(x>0, hold)
> sage: with mycontext:
> sage:     solve(...)
> ```
> or
> 
> ```
> sage: mycontext.start()
> sage: ...
> sage: solve(...)
> sage: mycontext.stop()
> ```

Maybe #24119 might be relevant ? It doesn't medles with evaluation (or not) of the body of the `with`, it just brackets this body with temporary updates to the facts database. Not the problem you are trying to solve, but might be handy...

[ Re-snip ... ]

> I remember reading in devel that previous developers hoped so too, also because at that time development on Pynac stopped and practically no one worked on symbolics in Sage. While that's no longer the case, solvers and integration need much help from SymPy, Fricas, and Giac.

In my (limited) experience, the ability od Sage to call "at will"  SymPy, fricas, giac (and even maple and  mathematica, but shhh...) is *extremely* useful for practical work. Add `Sage\TeX` to the mixture (the notebook is nice for prottyping, but I'm sold on "literate programming" for any serious publication work...), and you get a tool whose usefulness surpasses those of any of its components.

IMHO, Sage needs a lot of development in the "engineering/scientific/undergrad maths" department, which is not, to say the least, the core interest of its core developers. I see the work in this direction as an *investment* : if we make a tool useful to those non-professional-mathematician users,I would be quite surprised that none of them would dive in Sage development in these departments, thus relieving the algebraists, geometers and number theorist who *are* the core  developers of Sage of the infrastructure and maintenance work.



---

archive/issue_comments_332610.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nStefan,\n\nI'm a bit lost about your various tickets. I suggest that you make a meta-ticket (say, \"Work in progress on SymPy\") in which you merge the various pieces you want tested (with their dependencies) : that would ease the retrieval. Reverting no-longer-useful parts should be also possible.",
    "created_at": "2017-10-28T22:15:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332610",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:36" align="right">Comment 36</div>

Stefan,

I'm a bit lost about your various tickets. I suggest that you make a meta-ticket (say, "Work in progress on SymPy") in which you merge the various pieces you want tested (with their dependencies) : that would ease the retrieval. Reverting no-longer-useful parts should be also possible.



---

archive/issue_comments_332611.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A36):\n> Stefan,\n> \n> I'm a bit lost about your various tickets. I suggest that you make a meta-ticket (say, \"Work in progress on SymPy\") in which you merge the various pieces you want tested (with their dependencies) : that would ease the retrieval.\n\nWhy? Just check out the branch. It contains everything.\n\n> Reverting no-longer-useful parts should be also possible.\n\nCan you explain what you are trying to do? We don't need to use the ticket for this, that's also what zulip.sagemath.org is for, just message me please.",
    "created_at": "2017-10-29T14:50:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332611",
    "user": "https://github.com/rwst"
}
```

<div id="comment:37" align="right">Comment 37</div>

Replying to [@EmmanuelCharpentier](#comment%3A36):
> Stefan,
> 
> I'm a bit lost about your various tickets. I suggest that you make a meta-ticket (say, "Work in progress on SymPy") in which you merge the various pieces you want tested (with their dependencies) : that would ease the retrieval.

Why? Just check out the branch. It contains everything.

> Reverting no-longer-useful parts should be also possible.

Can you explain what you are trying to do? We don't need to use the ticket for this, that's also what zulip.sagemath.org is for, just message me please.



---

archive/issue_comments_332612.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nReplying to [@rwst](#comment%3A37):\n[ Snip ... ]\n> Why? Just check out the branch. It contains everything.\n\nAha ! I didn't understand that you had merged the necessary tickets.\n\nAnyway : on top of 8.1.beta9 + #23980+2#4026+#24119, passes ptestlong with no errors whatsoever.\n\nIt needs doc, however. And some options do not seem to work on multivariate systems :\n\n```\nsage: solve(x^3+1==0,x,domain=\"real\") ## domain=\"real\" does not work in Maxima's solver...\n[x == 1/2*I*sqrt(3)*(-1)^(1/3) - 1/2*(-1)^(1/3), x == -1/2*I*sqrt(3)*(-1)^(1/3) - 1/2*(-1)^(1/3), x == (-1)^(1/3)]\nsage: solve(x^3+1==0,x,algorithm=\"sympy\",domain=\"real\") # ...but works with Sympys's solver ...\n[x == -1]\nsage: solve([x^2+y^2 == 1, y^2 == x^3 + x + 1], [x, y],algorithm=\"sympy\",domain=\n....: \"real\") ### ... but not for systems.\n\n[{y: -1, x: 0},\n {y: 1, x: 0},\n {y: -sqrt(-1/2*I*sqrt(3) + 3/2), x: -1/2*I*sqrt(3) - 1/2},\n {y: sqrt(-1/2*I*sqrt(3) + 3/2), x: -1/2*I*sqrt(3) - 1/2},\n {y: -sqrt(1/2*I*sqrt(3) + 3/2), x: 1/2*I*sqrt(3) - 1/2},\n {y: sqrt(1/2*I*sqrt(3) + 3/2), x: 1/2*I*sqrt(3) - 1/2}]\n```\n\nNotwithstandig that, `positive_review`.",
    "created_at": "2017-10-30T21:19:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332612",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:38" align="right">Comment 38</div>

Replying to [@rwst](#comment%3A37):
[ Snip ... ]
> Why? Just check out the branch. It contains everything.

Aha ! I didn't understand that you had merged the necessary tickets.

Anyway : on top of 8.1.beta9 + #23980+2#4026+#24119, passes ptestlong with no errors whatsoever.

It needs doc, however. And some options do not seem to work on multivariate systems :

```
sage: solve(x^3+1==0,x,domain="real") ## domain="real" does not work in Maxima's solver...
[x == 1/2*I*sqrt(3)*(-1)^(1/3) - 1/2*(-1)^(1/3), x == -1/2*I*sqrt(3)*(-1)^(1/3) - 1/2*(-1)^(1/3), x == (-1)^(1/3)]
sage: solve(x^3+1==0,x,algorithm="sympy",domain="real") # ...but works with Sympys's solver ...
[x == -1]
sage: solve([x^2+y^2 == 1, y^2 == x^3 + x + 1], [x, y],algorithm="sympy",domain=
....: "real") ### ... but not for systems.

[{y: -1, x: 0},
 {y: 1, x: 0},
 {y: -sqrt(-1/2*I*sqrt(3) + 3/2), x: -1/2*I*sqrt(3) - 1/2},
 {y: sqrt(-1/2*I*sqrt(3) + 3/2), x: -1/2*I*sqrt(3) - 1/2},
 {y: -sqrt(1/2*I*sqrt(3) + 3/2), x: 1/2*I*sqrt(3) - 1/2},
 {y: sqrt(1/2*I*sqrt(3) + 3/2), x: 1/2*I*sqrt(3) - 1/2}]
```

Notwithstandig that, `positive_review`.



---

archive/issue_events_294333.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-10-30T21:19:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294333"
}
```



---

archive/issue_events_294334.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-10-30T21:19:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294334"
}
```



---

archive/issue_comments_332613.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nJust a thought : I see that the patchbots fail to build the package, for lack of source tarball. It could be useful to add a pointer to it in the ticket description (ISTR that thos worked for #24026...).",
    "created_at": "2017-10-30T21:24:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332613",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:39" align="right">Comment 39</div>

Just a thought : I see that the patchbots fail to build the package, for lack of source tarball. It could be useful to add a pointer to it in the ticket description (ISTR that thos worked for #24026...).



---

archive/issue_comments_332614.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nThanks. I have to do more Work, at least the merge of #24104 changes and necessary documentation. The tarball will be no longer necessary with the next release because the SymPy upgrade is in there.",
    "created_at": "2017-10-31T04:21:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332614",
    "user": "https://github.com/rwst"
}
```

<div id="comment:40" align="right">Comment 40</div>

Thanks. I have to do more Work, at least the merge of #24104 changes and necessary documentation. The tarball will be no longer necessary with the next release because the SymPy upgrade is in there.



---

archive/issue_events_294335.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-10-31T04:21:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294335"
}
```



---

archive/issue_events_294336.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-10-31T04:21:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294336"
}
```



---

archive/issue_comments_332615.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nWe'll need to work on #22024 next because `solve(x^5 + 3*x^3 + 7, x, algorithm='sympy')` will fail. But not for this ticket.",
    "created_at": "2017-10-31T16:00:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332615",
    "user": "https://github.com/rwst"
}
```

<div id="comment:41" align="right">Comment 41</div>

We'll need to work on #22024 next because `solve(x^5 + 3*x^3 + 7, x, algorithm='sympy')` will fail. But not for this ticket.



---

archive/issue_comments_332616.json:
```json
{
    "body": "Changed branch from **[u/rws/22322](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/22322)** to **[u/rws/22322-1](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/22322-1)**",
    "created_at": "2017-10-31T17:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332616",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/rws/22322](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/22322)** to **[u/rws/22322-1](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/22322-1)**



---

archive/issue_comments_332617.json:
```json
{
    "body": "Changed commit from **[eac5f8b](https://github.com/sagemath/sagetrac-mirror/commit/eac5f8bf8a12da0373bed819bcd060673a2f7aa4)** to **[963cc0e](https://github.com/sagemath/sagetrac-mirror/commit/963cc0e6cb2ea5441422f73beb961b882dfec420)**",
    "created_at": "2017-10-31T17:31:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332617",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[eac5f8b](https://github.com/sagemath/sagetrac-mirror/commit/eac5f8bf8a12da0373bed819bcd060673a2f7aa4)** to **[963cc0e](https://github.com/sagemath/sagetrac-mirror/commit/963cc0e6cb2ea5441422f73beb961b882dfec420)**



---

archive/issue_comments_332618.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nThis is a new branch because of differences in the dependencies. I also added the missing translation of `LambertW`. Another problem is that SymPy's `solveset` is not always better than its `solve` esp. with nonlinear equations, compare e.g. `x+2**x==0`. This needs more work later.\n\nPlease review, these should be the last big changes.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/269c2de8d1e5396da594b8f1679ff71603f40765\">269c2de</a></td><td><code>Merge branch 'develop' into 22322-1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86e9c201a75408816f76bde25208d46f9d73e692\">86e9c20</a></td><td><code>24104: move doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91cb91f846ebfbea538fbaacad7780c1867d19f9\">91cb91f</a></td><td><code>24104: solve no longer calls itself</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f6e8265f9ebc448d4aa4004ef0c6b504560b6ff\">0f6e826</a></td><td><code>Move the single expression solver into stand-alone function for granularity plus some mild cleanup.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4048e2553f264d37fc65de4e1b6dad6f4e24b1e7\">4048e25</a></td><td><code>Merge branch 'public/symbolcs/merge_solves-24104' of git://trac.sagemath.org/sage into 22322-1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/963cc0e6cb2ea5441422f73beb961b882dfec420\">963cc0e</a></td><td><code>22322: allow sympy algorithm in solve</code></td></tr></table>\n",
    "created_at": "2017-10-31T17:31:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332618",
    "user": "https://github.com/rwst"
}
```

<div id="comment:43" align="right">Comment 43</div>

This is a new branch because of differences in the dependencies. I also added the missing translation of `LambertW`. Another problem is that SymPy's `solveset` is not always better than its `solve` esp. with nonlinear equations, compare e.g. `x+2**x==0`. This needs more work later.

Please review, these should be the last big changes.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/269c2de8d1e5396da594b8f1679ff71603f40765">269c2de</a></td><td><code>Merge branch 'develop' into 22322-1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86e9c201a75408816f76bde25208d46f9d73e692">86e9c20</a></td><td><code>24104: move doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91cb91f846ebfbea538fbaacad7780c1867d19f9">91cb91f</a></td><td><code>24104: solve no longer calls itself</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f6e8265f9ebc448d4aa4004ef0c6b504560b6ff">0f6e826</a></td><td><code>Move the single expression solver into stand-alone function for granularity plus some mild cleanup.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4048e2553f264d37fc65de4e1b6dad6f4e24b1e7">4048e25</a></td><td><code>Merge branch 'public/symbolcs/merge_solves-24104' of git://trac.sagemath.org/sage into 22322-1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/963cc0e6cb2ea5441422f73beb961b882dfec420">963cc0e</a></td><td><code>22322: allow sympy algorithm in solve</code></td></tr></table>




---

archive/issue_events_294337.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-10-31T17:31:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294337"
}
```



---

archive/issue_events_294338.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-10-31T17:31:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294338"
}
```



---

archive/issue_events_294339.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-11-01T05:37:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294339"
}
```



---

archive/issue_events_294340.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-11-01T05:37:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294340"
}
```



---

archive/issue_comments_332619.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nOn top of 8.1.beta9 + #23980+2#4026+#24119, passes ptestlong with no errors whatsoever.",
    "created_at": "2017-11-01T05:37:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332619",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:44" align="right">Comment 44</div>

On top of 8.1.beta9 + #23980+2#4026+#24119, passes ptestlong with no errors whatsoever.



---

archive/issue_comments_332620.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nReviewer name.",
    "created_at": "2017-11-01T06:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332620",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:45" align="right">Comment 45</div>

Reviewer name.



---

archive/issue_events_294341.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-11-02T14:50:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294341"
}
```



---

archive/issue_events_294342.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-11-02T14:50:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294342"
}
```



---

archive/issue_comments_332621.json:
```json
{
    "body": "Reviewer: **Emmanuel Charpentier**",
    "created_at": "2017-11-02T14:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332621",
    "user": "https://github.com/rwst"
}
```

Reviewer: **Emmanuel Charpentier**



---

archive/issue_comments_332622.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\n@EmmanuelCharpentier I hope you don't mind me adding your name.",
    "created_at": "2017-11-02T14:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332622",
    "user": "https://github.com/rwst"
}
```

<div id="comment:47" align="right">Comment 47</div>

@EmmanuelCharpentier I hope you don't mind me adding your name.



---

archive/issue_events_294343.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-02T14:54:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294343"
}
```



---

archive/issue_events_294344.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-11-02T14:54:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294344"
}
```



---

archive/issue_comments_332623.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nOn OSX:\n\n```\n**********************************************************************\nFile \"src/sage/symbolic/relation.py\", line 894, in sage.symbolic.relation.solve\nFailed example:\n    solve([x^2 - y^2/exp(x), y-1], x, y, algorithm='sympy')\nExpected:\n    [{y: 1, x: 2*lambert_w(1/2)}]\nGot:\n    [{x: 2*lambert_w(1/2), y: 1}]\n**********************************************************************\nFile \"src/sage/symbolic/relation.py\", line 902, in sage.symbolic.relation.solve\nFailed example:\n    solve([x + y + z + t, -z - t], x, y, z, t, algorithm='sympy')\nExpected:\n    [{z: -t, x: -y}]\nGot:\n    [{x: -y, z: -t}]\n**********************************************************************\nFile \"src/sage/symbolic/relation.py\", line 904, in sage.symbolic.relation.solve\nFailed example:\n    solve([x^2+y+z, y+x^2+z, x+y+z^2], x, y,z, algorithm='sympy')\nExpected:\n    [{y: -(z + 1)*z, x: z}, {y: -z^2 + z - 1, x: -z + 1}]\nGot:\n    [{x: z, y: -(z + 1)*z}, {x: -z + 1, y: -z^2 + z - 1}]\n**********************************************************************\n1 item had failures:\n   3 of 112 in sage.symbolic.relation.solve\n    [377 tests, 3 failures, 185.81 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/symbolic/relation.py  # 3 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2017-12-10T09:26:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332623",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:49" align="right">Comment 49</div>

On OSX:

```
**********************************************************************
File "src/sage/symbolic/relation.py", line 894, in sage.symbolic.relation.solve
Failed example:
    solve([x^2 - y^2/exp(x), y-1], x, y, algorithm='sympy')
Expected:
    [{y: 1, x: 2*lambert_w(1/2)}]
Got:
    [{x: 2*lambert_w(1/2), y: 1}]
**********************************************************************
File "src/sage/symbolic/relation.py", line 902, in sage.symbolic.relation.solve
Failed example:
    solve([x + y + z + t, -z - t], x, y, z, t, algorithm='sympy')
Expected:
    [{z: -t, x: -y}]
Got:
    [{x: -y, z: -t}]
**********************************************************************
File "src/sage/symbolic/relation.py", line 904, in sage.symbolic.relation.solve
Failed example:
    solve([x^2+y+z, y+x^2+z, x+y+z^2], x, y,z, algorithm='sympy')
Expected:
    [{y: -(z + 1)*z, x: z}, {y: -z^2 + z - 1, x: -z + 1}]
Got:
    [{x: z, y: -(z + 1)*z}, {x: -z + 1, y: -z^2 + z - 1}]
**********************************************************************
1 item had failures:
   3 of 112 in sage.symbolic.relation.solve
    [377 tests, 3 failures, 185.81 s]
----------------------------------------------------------------------
sage -t --long src/sage/symbolic/relation.py  # 3 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_events_294345.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-10T09:26:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294345"
}
```



---

archive/issue_events_294346.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-10T09:26:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294346"
}
```



---

archive/issue_comments_332624.json:
```json
{
    "body": "Changed commit from **[963cc0e](https://github.com/sagemath/sagetrac-mirror/commit/963cc0e6cb2ea5441422f73beb961b882dfec420)** to **[8e1e240](https://github.com/sagemath/sagetrac-mirror/commit/8e1e240bb9b8d735251847e67deec1fdb32eccba)**",
    "created_at": "2017-12-10T14:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332624",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[963cc0e](https://github.com/sagemath/sagetrac-mirror/commit/963cc0e6cb2ea5441422f73beb961b882dfec420)** to **[8e1e240](https://github.com/sagemath/sagetrac-mirror/commit/8e1e240bb9b8d735251847e67deec1fdb32eccba)**



---

archive/issue_comments_332625.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e1e240bb9b8d735251847e67deec1fdb32eccba\">8e1e240</a></td><td><code>22322: dict order-independent doctests</code></td></tr></table>\n",
    "created_at": "2017-12-10T14:05:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332625",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:50" align="right">Comment 50</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e1e240bb9b8d735251847e67deec1fdb32eccba">8e1e240</a></td><td><code>22322: dict order-independent doctests</code></td></tr></table>




---

archive/issue_events_294347.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-10T14:06:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294347"
}
```



---

archive/issue_events_294348.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-10T14:06:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294348"
}
```



---

archive/issue_comments_332626.json:
```json
{
    "body": "Changed branch from **[u/rws/22322-1](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/22322-1)** to **[8e1e240](https://github.com/sagemath/sagetrac-mirror/commit/8e1e240bb9b8d735251847e67deec1fdb32eccba)**",
    "created_at": "2017-12-13T17:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22322#issuecomment-332626",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/rws/22322-1](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/22322-1)** to **[8e1e240](https://github.com/sagemath/sagetrac-mirror/commit/8e1e240bb9b8d735251847e67deec1fdb32eccba)**



---

archive/issue_events_294349.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-13T17:38:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294349"
}
```



---

archive/issue_events_294350.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3a516c1f09cfc5ef12a96a934e24c8da8fdb2e1c",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-12-13T17:38:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22322",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22322#event-294350"
}
```
