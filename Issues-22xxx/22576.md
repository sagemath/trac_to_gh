# Issue 22576: Fix timeout in TransitiveGroups TestSuite

archive/issues_022339.json:
```json
{
    "body": "The test suite of `src/sage/groups/perm_gps/permgroup_named.py` takes an infinite amount of time. \n\nThe responsible doctest is\n\n```\n(line 1924):    TestSuite(TransitiveGroups()).run()\n```\nAnd it is blocked because of\n\n```\nsage: T = TransitiveGroups()\nsage: elt = T.an_element()\nsage: T(elt)     # hangs\n```\nThis comes from #22382.\n\nCC:  @embray @slel\n\nKeywords: bug, doctest, days84\n\nBranch/Commit: 1b99249885a74fa775effb900b514d41f33c9ccc\n\nReviewer: Dima Pasechnik\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22576\n\n",
    "closed_at": "2021-07-18T22:53:47Z",
    "created_at": "2017-03-10T15:44:41Z",
    "labels": [
        "component: group theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Fix timeout in TransitiveGroups TestSuite",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22576",
    "user": "https://github.com/videlec"
}
```
The test suite of `src/sage/groups/perm_gps/permgroup_named.py` takes an infinite amount of time. 

The responsible doctest is

```
(line 1924):    TestSuite(TransitiveGroups()).run()
```
And it is blocked because of

```
sage: T = TransitiveGroups()
sage: elt = T.an_element()
sage: T(elt)     # hangs
```
This comes from #22382.

CC:  @embray @slel

Keywords: bug, doctest, days84

Branch/Commit: 1b99249885a74fa775effb900b514d41f33c9ccc

Reviewer: Dima Pasechnik

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22576





---

archive/issue_comments_419569.json:
```json
{
    "body": "<a id='comment:1'></a>`T.an_element()` works. What doesn't work is creating an element of T from an element of T.\n\nThe traceback after <Ctrl-c> pointed me to these lines:\n\n```\n/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/sets/disjoint_union_enumerated_sets.py in _element_constructor_facade(self, el)\n    575             return el\n    576 \n--> 577         for P in self._family:\n    578             try:\n    579                 return P(el)\n```\nsage: T._family\nLazy family (<lambda>(i))_{i in Non negative integers}\n}}}\n\nIt is an infinite family - of course it hangs.\n\nObvious solution: First check whether the parent of the given element belongs to the family.  But alas, the element of T has no reasonable parent at all. I get the following rather strange sequence of lines:\n\n```\nsage: t = T.an_element()\nsage: t.parent() in T._family\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-14-7530d2cfb513> in <module>()\n----> 1 t.parent() in T._family\n\n/home/king/Sage/git/sage/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__contains__ (/home/king/Sage/git/sage/src/build/cythonized/sage/structure/parent.c:10458)()\n   1140             False\n   1141         \"\"\"\n-> 1142         P = parent(x)\n   1143         if P is self or P == self:\n   1144             return True\n\n/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/structure/element.pxd in sage.structure.element.parent (/home/king/Sage/git/sage/src/build/cythonized/sage/structure/parent.c:28336)()\n     71         return type(x)\n     72     else:\n---> 73         return p()\n     74 \n     75 \n\nTypeError: descriptor 'parent' of 'sage.structure.sage_object.SageObject' object needs an argument\nsage: t\nTransitive group number 1 of degree 0\nsage: t.parent()\n<class 'sage.groups.perm_gps.permgroup_named.TransitiveGroup_with_category'>\n```\n\nNo idea how to fix that, though.",
    "created_at": "2017-03-10T16:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419569",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>`T.an_element()` works. What doesn't work is creating an element of T from an element of T.

The traceback after <Ctrl-c> pointed me to these lines:

```
/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/sets/disjoint_union_enumerated_sets.py in _element_constructor_facade(self, el)
    575             return el
    576 
--> 577         for P in self._family:
    578             try:
    579                 return P(el)
```
sage: T._family
Lazy family (<lambda>(i))_{i in Non negative integers}
}}}

It is an infinite family - of course it hangs.

Obvious solution: First check whether the parent of the given element belongs to the family.  But alas, the element of T has no reasonable parent at all. I get the following rather strange sequence of lines:

```
sage: t = T.an_element()
sage: t.parent() in T._family
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-14-7530d2cfb513> in <module>()
----> 1 t.parent() in T._family

/home/king/Sage/git/sage/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__contains__ (/home/king/Sage/git/sage/src/build/cythonized/sage/structure/parent.c:10458)()
   1140             False
   1141         """
-> 1142         P = parent(x)
   1143         if P is self or P == self:
   1144             return True

/home/king/Sage/git/sage/local/lib/python2.7/site-packages/sage/structure/element.pxd in sage.structure.element.parent (/home/king/Sage/git/sage/src/build/cythonized/sage/structure/parent.c:28336)()
     71         return type(x)
     72     else:
---> 73         return p()
     74 
     75 

TypeError: descriptor 'parent' of 'sage.structure.sage_object.SageObject' object needs an argument
sage: t
Transitive group number 1 of degree 0
sage: t.parent()
<class 'sage.groups.perm_gps.permgroup_named.TransitiveGroup_with_category'>
```

No idea how to fix that, though.



---

archive/issue_comments_419570.json:
```json
{
    "body": "<a id='comment:2'></a>I don't know what exactly `family` means in this context, and perhaps I talk nonsense, but shouldn't iteration through such things be handled by an `iterator` (and `yield`)?",
    "created_at": "2017-03-10T16:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419570",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>I don't know what exactly `family` means in this context, and perhaps I talk nonsense, but shouldn't iteration through such things be handled by an `iterator` (and `yield`)?



---

archive/issue_comments_419571.json:
```json
{
    "body": "<a id='comment:3'></a>So this comes from #22382, where we actually are now doing some validity checks. So when the family of sets in the union is infinite, we get the hanging behavior when an element is not in the set. We can reverse this behavior for this case, but that is a somewhat separate issue as in this case, the actual parent of the element in question is broken.",
    "created_at": "2017-03-11T03:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419571",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>So this comes from #22382, where we actually are now doing some validity checks. So when the family of sets in the union is infinite, we get the hanging behavior when an element is not in the set. We can reverse this behavior for this case, but that is a somewhat separate issue as in this case, the actual parent of the element in question is broken.



---

archive/issue_comments_419572.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,8 +7,10 @@\n \n ```\n sage: T = TransitiveGroups()\n-sage: T(T.an_element())     # hangs\n+sage: elt = T.an_element()\n+sage: T(elt)     # hangs\n ```\n+This comes from #22382.\n \n Comment: 1\n \n``````\n",
    "created_at": "2017-03-11T08:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419572",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,8 +7,10 @@
 
 ```
 sage: T = TransitiveGroups()
-sage: T(T.an_element())     # hangs
+sage: elt = T.an_element()
+sage: T(elt)     # hangs
 ```
+This comes from #22382.
 
 Comment: 1
 
``````




---

archive/issue_comments_419573.json:
```json
{
    "body": "Changing commit from \"\" to \"6236b0ddf2f4f7df58dcaac270fb496c7ab9d255\"",
    "created_at": "2017-03-11T09:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419573",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "6236b0ddf2f4f7df58dcaac270fb496c7ab9d255"



---

archive/issue_comments_419574.json:
```json
{
    "body": "Changing branch from \"\" to \"public/22576\"",
    "created_at": "2017-03-11T09:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419574",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "public/22576"



---

archive/issue_comments_419575.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2017-03-11T09:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419575",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_419576.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-03-11T09:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419576",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_419577.json:
```json
{
    "body": "Changing commit from \"6236b0ddf2f4f7df58dcaac270fb496c7ab9d255\" to \"287dfb6d16d36e53dcacd844ce877adbefb7ba2a\"",
    "created_at": "2017-03-11T09:01:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419577",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6236b0ddf2f4f7df58dcaac270fb496c7ab9d255" to "287dfb6d16d36e53dcacd844ce877adbefb7ba2a"



---

archive/issue_comments_419578.json:
```json
{
    "body": "<a id='comment:7'></a>After disabling two tests I am able to run the doctests. However, `database_gap` seems to be broken (at least on my computer)\n\n```\n$ sage -f database_gap\n$ sage -c \"PrimitiveGroups(12).cardinality()\"\nverbose 0 (2474: permgroup_named.py, cardinality) Warning: PrimitiveGroups requires the GAP database package. Please install it with ``sage -i database_gap``.\n```",
    "created_at": "2017-03-11T09:03:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419578",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>After disabling two tests I am able to run the doctests. However, `database_gap` seems to be broken (at least on my computer)

```
$ sage -f database_gap
$ sage -c "PrimitiveGroups(12).cardinality()"
verbose 0 (2474: permgroup_named.py, cardinality) Warning: PrimitiveGroups requires the GAP database package. Please install it with ``sage -i database_gap``.
```



---

archive/issue_comments_419579.json:
```json
{
    "body": "<a id='comment:8'></a>this is caused by a stale GAP workspace. Do\n\n```\nsage -c \"gap_reset_workspace()\"\n```\n\nI suppose this will be fixed good and proper in #22570.",
    "created_at": "2017-03-11T09:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419579",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'></a>this is caused by a stale GAP workspace. Do

```
sage -c "gap_reset_workspace()"
```

I suppose this will be fixed good and proper in #22570.



---

archive/issue_comments_419580.json:
```json
{
    "body": "Changing author from \"\" to \"Vincent Delecroix\"",
    "created_at": "2017-03-11T09:20:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419580",
    "user": "https://github.com/videlec"
}
```

Changing author from "" to "Vincent Delecroix"



---

archive/issue_comments_419581.json:
```json
{
    "body": "<a id='comment:9'></a>Indeed\n\n```\n$ sage -t --long --optional=sage,database_gap permgroup_named.py \ntoo few successful tests, not using stored timings\nRunning doctests with ID 2017-03-11-10-19-11-a1e57781.\nGit branch: develop\nUsing --optional=database_gap,sage\nDoctesting 1 file.\nsage -t --long permgroup_named.py\n    [445 tests, 3.90 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 4.0 seconds\n    cpu time: 3.2 seconds\n    cumulative wall time: 3.9 seconds\n```",
    "created_at": "2017-03-11T09:20:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419581",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>Indeed

```
$ sage -t --long --optional=sage,database_gap permgroup_named.py 
too few successful tests, not using stored timings
Running doctests with ID 2017-03-11-10-19-11-a1e57781.
Git branch: develop
Using --optional=database_gap,sage
Doctesting 1 file.
sage -t --long permgroup_named.py
    [445 tests, 3.90 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 4.0 seconds
    cpu time: 3.2 seconds
    cumulative wall time: 3.9 seconds
```



---

archive/issue_comments_419582.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-11T09:20:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419582",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_419583.json:
```json
{
    "body": "<a id='comment:10'></a>Don't we have `# known bug` tag for such broken doctests?",
    "created_at": "2017-03-11T09:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419583",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>Don't we have `# known bug` tag for such broken doctests?



---

archive/issue_comments_419584.json:
```json
{
    "body": "Changing commit from \"287dfb6d16d36e53dcacd844ce877adbefb7ba2a\" to \"304355cbf5b8b71ddacd6b188f1549cafb49c9af\"",
    "created_at": "2017-03-11T09:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419584",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "287dfb6d16d36e53dcacd844ce877adbefb7ba2a" to "304355cbf5b8b71ddacd6b188f1549cafb49c9af"



---

archive/issue_comments_419585.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-03-11T09:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419585",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_419586.json:
```json
{
    "body": "<a id='comment:12'></a>We do",
    "created_at": "2017-03-11T09:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419586",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>We do



---

archive/issue_comments_419587.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-11T09:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419587",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_419588.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2017-03-11T09:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419588",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_419589.json:
```json
{
    "body": "<a id='comment:14'></a>Thanks! I will reactivate `database_gap` on my patchbot as soon as it is merged.",
    "created_at": "2017-03-11T09:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419589",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>Thanks! I will reactivate `database_gap` on my patchbot as soon as it is merged.



---

archive/issue_comments_419590.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-03-11T12:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419590",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_419591.json:
```json
{
    "body": "<a id='comment:15'></a>I think the proper way to deal with `# known bug` is to open a new ticket to add `# known bug` and keep this ticket open for the real issue.",
    "created_at": "2017-03-11T12:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419591",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>I think the proper way to deal with `# known bug` is to open a new ticket to add `# known bug` and keep this ticket open for the real issue.



---

archive/issue_comments_419592.json:
```json
{
    "body": "<a id='comment:16'></a>Besides, I'm not really following. Do I understand you correctly that the proper fix is simply to run `gap_reset_workspace()` whenever `database_gap` is installed? So it's unrelated to #22382 after all?",
    "created_at": "2017-03-11T13:01:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419592",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>Besides, I'm not really following. Do I understand you correctly that the proper fix is simply to run `gap_reset_workspace()` whenever `database_gap` is installed? So it's unrelated to #22382 after all?



---

archive/issue_comments_419593.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:15 jdemeyer]:\n> I think the proper way to deal with `# known bug` is to open a new ticket to add `# known bug` and keep this ticket open for the real issue.\n\n\n#22583",
    "created_at": "2017-03-11T15:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419593",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>Replying to [comment:15 jdemeyer]:
> I think the proper way to deal with `# known bug` is to open a new ticket to add `# known bug` and keep this ticket open for the real issue.


#22583



---

archive/issue_comments_419594.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:16 jdemeyer]:\n> Besides, I'm not really following. Do I understand you correctly that the proper fix is simply to run `gap_reset_workspace()` whenever `database_gap` is installed? So it's unrelated to #22382 after all?\n\n\nYou are not really understanding. This bug of this ticket is disjoint from the `gap_reset_workspace()` which has to do with [comment:7].",
    "created_at": "2017-03-11T15:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419594",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>Replying to [comment:16 jdemeyer]:
> Besides, I'm not really following. Do I understand you correctly that the proper fix is simply to run `gap_reset_workspace()` whenever `database_gap` is installed? So it's unrelated to #22382 after all?


You are not really understanding. This bug of this ticket is disjoint from the `gap_reset_workspace()` which has to do with [comment:7].



---

archive/issue_comments_419595.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-03-11T15:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419595",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_419596.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,18 @@\n+The test suite of `src/sage/groups/perm_gps/permgroup_named.py` takes an infinite amount of time when the package `database_gap` is installed. Namely, the responsible doctest is\n \n+```\n+(line 1924):    TestSuite(TransitiveGroups()).run()\n+```\n+And it is blocked because of\n+\n+```\n+sage: T = TransitiveGroups()\n+sage: elt = T.an_element()\n+sage: T(elt)     # hangs\n+```\n+This comes from #22382.\n+\n+This ticket marks this tests as `# known bug` and will be dealt with #22583.\n \n Comment: 1\n \n``````\n",
    "created_at": "2017-03-11T15:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419596",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,18 @@
+The test suite of `src/sage/groups/perm_gps/permgroup_named.py` takes an infinite amount of time when the package `database_gap` is installed. Namely, the responsible doctest is
 
+```
+(line 1924):    TestSuite(TransitiveGroups()).run()
+```
+And it is blocked because of
+
+```
+sage: T = TransitiveGroups()
+sage: elt = T.an_element()
+sage: T(elt)     # hangs
+```
+This comes from #22382.
+
+This ticket marks this tests as `# known bug` and will be dealt with #22583.
 
 Comment: 1
 
``````




---

archive/issue_comments_419597.json:
```json
{
    "body": "Changing branch from \"public/22576\" to \"\"",
    "created_at": "2017-03-11T15:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419597",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "public/22576" to ""



---

archive/issue_comments_419598.json:
```json
{
    "body": "Changing author from \"Vincent Delecroix\" to \"\"",
    "created_at": "2017-03-11T15:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419598",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "Vincent Delecroix" to ""



---

archive/issue_comments_419599.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-03-11T15:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419599",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_419600.json:
```json
{
    "body": "Changing commit from \"304355cbf5b8b71ddacd6b188f1549cafb49c9af\" to \"\"",
    "created_at": "2017-03-11T15:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419600",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "304355cbf5b8b71ddacd6b188f1549cafb49c9af" to ""



---

archive/issue_comments_419601.json:
```json
{
    "body": "Changing reviewer from \"Dima Pasechnik\" to \"\"",
    "created_at": "2017-03-11T15:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419601",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Dima Pasechnik" to ""



---

archive/issue_comments_419602.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:17 vdelecroix]:\n> Replying to [comment:15 jdemeyer]:\n> > I think the proper way to deal with `# known bug` is to open a new ticket to add `# known bug` and keep this ticket open for the real issue.\n\n> \n> #22583\n\n\nBetter do it the other way around because all the discussion is happening here.",
    "created_at": "2017-03-11T15:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419602",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>Replying to [comment:17 vdelecroix]:
> Replying to [comment:15 jdemeyer]:
> > I think the proper way to deal with `# known bug` is to open a new ticket to add `# known bug` and keep this ticket open for the real issue.

> 
> #22583


Better do it the other way around because all the discussion is happening here.



---

archive/issue_comments_419603.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:18 vdelecroix]:\n> You are not really understanding.\n\n\nWell, the comments were not clear either. It was not obvious to me that the \"this\" from [comment:8] was referring not the bug on this ticket.",
    "created_at": "2017-03-11T15:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419603",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>Replying to [comment:18 vdelecroix]:
> You are not really understanding.


Well, the comments were not clear either. It was not obvious to me that the "this" from [comment:8] was referring not the bug on this ticket.



---

archive/issue_comments_419604.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,16 @@\n+The test suite of `src/sage/groups/perm_gps/permgroup_named.py` takes an infinite amount of time when the package `database_gap` is installed. Namely, the responsible doctest is\n \n+```\n+(line 1924):    TestSuite(TransitiveGroups()).run()\n+```\n+And it is blocked because of\n+\n+```\n+sage: T = TransitiveGroups()\n+sage: elt = T.an_element()\n+sage: T(elt)     # hangs\n+```\n+This comes from #22382.\n \n Comment: 1\n \n``````\n",
    "created_at": "2017-03-11T16:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419604",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,16 @@
+The test suite of `src/sage/groups/perm_gps/permgroup_named.py` takes an infinite amount of time when the package `database_gap` is installed. Namely, the responsible doctest is
 
+```
+(line 1924):    TestSuite(TransitiveGroups()).run()
+```
+And it is blocked because of
+
+```
+sage: T = TransitiveGroups()
+sage: elt = T.an_element()
+sage: T(elt)     # hangs
+```
+This comes from #22382.
 
 Comment: 1
 
``````




---

archive/issue_comments_419605.json:
```json
{
    "body": "Changing stopgaps from \"\" to \"#22583\"",
    "created_at": "2017-03-11T16:14:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419605",
    "user": "https://github.com/jdemeyer"
}
```

Changing stopgaps from "" to "#22583"



---

archive/issue_comments_419606.json:
```json
{
    "body": "<a id='comment:26'></a>OK, so we need to deal with `sage -c \"gap_reset_workspace()\"` issue. As Jeroen rightly says on #22570, this cannot be done by `spkg-install`, as it updates user-specific\nstuff in `~/.sage/gap/`. \n\nWhat else can be done? I only see an option of `sage` checking\non startup whether  `sage -c \"gap_reset_workspace()\"` must be run.\nCan we get away with only triggering it if a new Sage package was installed?\n(otherwise this looks like a time-consuming check).\n\nDocs on how to install GAP packages manually should also\nindicate the need to run `sage -c \"gap_reset_workspace()\"` after\na GAP package is installed or removed.",
    "created_at": "2017-03-12T22:21:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419606",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:26'></a>OK, so we need to deal with `sage -c "gap_reset_workspace()"` issue. As Jeroen rightly says on #22570, this cannot be done by `spkg-install`, as it updates user-specific
stuff in `~/.sage/gap/`. 

What else can be done? I only see an option of `sage` checking
on startup whether  `sage -c "gap_reset_workspace()"` must be run.
Can we get away with only triggering it if a new Sage package was installed?
(otherwise this looks like a time-consuming check).

Docs on how to install GAP packages manually should also
indicate the need to run `sage -c "gap_reset_workspace()"` after
a GAP package is installed or removed.



---

archive/issue_comments_419607.json:
```json
{
    "body": "<a id='comment:27'></a>Is this still a bug after `database_gap` has been merged partly into the `gap` and partly into the `gap_packages`  packages?",
    "created_at": "2019-07-01T01:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419607",
    "user": "https://github.com/slel"
}
```

<a id='comment:27'></a>Is this still a bug after `database_gap` has been merged partly into the `gap` and partly into the `gap_packages`  packages?



---

archive/issue_events_058945.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-07-06T13:38:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22576#event-58945"
}
```



---

archive/issue_comments_419608.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 slelievre]:\n> Is this still a bug after `database_gap` has been merged partly\n> into the `gap` and partly into the `gap_packages` packages?\n\n\nAnswering my own question: yes, the following still hangs:\n\n```\nsage: T = TransitiveGroups()\nsage: t = T.an_element()\nsage: T(t)\n```",
    "created_at": "2021-07-06T13:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419608",
    "user": "https://github.com/slel"
}
```

<a id='comment:28'></a>Replying to [comment:27 slelievre]:
> Is this still a bug after `database_gap` has been merged partly
> into the `gap` and partly into the `gap_packages` packages?


Answering my own question: yes, the following still hangs:

```
sage: T = TransitiveGroups()
sage: t = T.an_element()
sage: T(t)
```



---

archive/issue_comments_419609.json:
```json
{
    "body": "Changing component from packages: optional to packages: standard.",
    "created_at": "2021-07-06T13:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419609",
    "user": "https://github.com/slel"
}
```

Changing component from packages: optional to packages: standard.



---

archive/issue_comments_419610.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,18 @@\n+The test suite of `src/sage/groups/perm_gps/permgroup_named.py` takes an infinite amount of time. \n \n+The responsible doctest is\n+\n+```\n+(line 1924):    TestSuite(TransitiveGroups()).run()\n+```\n+And it is blocked because of\n+\n+```\n+sage: T = TransitiveGroups()\n+sage: elt = T.an_element()\n+sage: T(elt)     # hangs\n+```\n+This comes from #22382.\n \n Comment: 1\n \n``````\n",
    "created_at": "2021-07-06T13:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419610",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,18 @@
+The test suite of `src/sage/groups/perm_gps/permgroup_named.py` takes an infinite amount of time. 
 
+The responsible doctest is
+
+```
+(line 1924):    TestSuite(TransitiveGroups()).run()
+```
+And it is blocked because of
+
+```
+sage: T = TransitiveGroups()
+sage: elt = T.an_element()
+sage: T(elt)     # hangs
+```
+This comes from #22382.
 
 Comment: 1
 
``````




---

archive/issue_comments_419611.json:
```json
{
    "body": "Changing author from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2021-07-07T01:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419611",
    "user": "https://github.com/tscrim"
}
```

Changing author from "" to "Travis Scrimshaw"



---

archive/issue_comments_419612.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-07-07T01:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419612",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_419613.json:
```json
{
    "body": "Changing branch from \"\" to \"public/groups/fix_transitive_groups_timeout-22576\"",
    "created_at": "2021-07-07T01:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419613",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/groups/fix_transitive_groups_timeout-22576"



---

archive/issue_events_058946.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-07-07T01:35:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22576#event-58946"
}
```



---

archive/issue_events_058947.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-07-07T01:35:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22576#event-58947"
}
```



---

archive/issue_comments_419614.json:
```json
{
    "body": "Changing commit from \"\" to \"1b99249885a74fa775effb900b514d41f33c9ccc\"",
    "created_at": "2021-07-07T01:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419614",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "1b99249885a74fa775effb900b514d41f33c9ccc"



---

archive/issue_comments_419615.json:
```json
{
    "body": "Changing stopgaps from \"#22583\" to \"\"",
    "created_at": "2021-07-07T01:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419615",
    "user": "https://github.com/tscrim"
}
```

Changing stopgaps from "#22583" to ""



---

archive/issue_comments_419616.json:
```json
{
    "body": "<a id='comment:29'></a>Here is a fix. The issue is that `TransitiveGroups` claims to be a `Parent`, but it is not as it doesn't have proper elements. I just hacked around that by directly implementing a `__call__`. It has nothing to do with the GAP package.\n\n---\nNew commits:",
    "created_at": "2021-07-07T01:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419616",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:29'></a>Here is a fix. The issue is that `TransitiveGroups` claims to be a `Parent`, but it is not as it doesn't have proper elements. I just hacked around that by directly implementing a `__call__`. It has nothing to do with the GAP package.

---
New commits:



---

archive/issue_comments_419617.json:
```json
{
    "body": "Changing component from packages: standard to group theory.",
    "created_at": "2021-07-07T01:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419617",
    "user": "https://github.com/tscrim"
}
```

Changing component from packages: standard to group theory.



---

archive/issue_comments_419618.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2021-07-07T08:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419618",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_419619.json:
```json
{
    "body": "<a id='comment:30'></a>LGTM, thanks!",
    "created_at": "2021-07-07T08:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419619",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:30'></a>LGTM, thanks!



---

archive/issue_comments_419620.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-07-07T08:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419620",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_058948.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-18T22:53:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22576#event-58948"
}
```



---

archive/issue_comments_419621.json:
```json
{
    "body": "Changing branch from \"public/groups/fix_transitive_groups_timeout-22576\" to \"1b99249885a74fa775effb900b514d41f33c9ccc\"",
    "created_at": "2021-07-18T22:53:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419621",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/groups/fix_transitive_groups_timeout-22576" to "1b99249885a74fa775effb900b514d41f33c9ccc"



---

archive/issue_comments_419622.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-18T22:53:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22576",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22576#issuecomment-419622",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
