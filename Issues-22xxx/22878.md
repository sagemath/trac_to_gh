# Issue 22878: Add gmp to libraries for libs/ecl and rings/bernmm

archive/issues_022641.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nNeeded to build on Cygwin. Likely now needed from changes from #22728.\n\nCC:  @embray @jpflori @sagetrac-gouezel @jdemeyer\n\nComponent: **porting: Cygwin**\n\nAuthor: **Travis Scrimshaw**\n\nBranch/Commit: **[`9fb2e3f`](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**\n\nReviewer: **Erik Bray**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22878_\n\n",
    "closed_at": "2017-04-28T23:54:34Z",
    "created_at": "2017-04-26T15:36:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20cygwin",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add gmp to libraries for libs/ecl and rings/bernmm",
    "type": "issue",
    "updated_at": "2017-04-28T23:54:34Z",
    "url": "https://github.com/sagemath/sage/issues/22878",
    "user": "https://github.com/tscrim"
}
```
<div id="comment:0"></div>

Needed to build on Cygwin. Likely now needed from changes from #22728.

CC:  @embray @jpflori @sagetrac-gouezel @jdemeyer

Component: **porting: Cygwin**

Author: **Travis Scrimshaw**

Branch/Commit: **[`9fb2e3f`](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**

Reviewer: **Erik Bray**

_Issue created by migration from https://trac.sagemath.org/ticket/22878_





---

archive/issue_events_316380.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:36:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316380"
}
```



---

archive/issue_events_316381.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:36:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20cygwin",
    "label_color": "0000b0",
    "label_name": "c: porting: cygwin",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316381"
}
```



---

archive/issue_events_316382.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:36:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316382"
}
```



---

archive/issue_events_316383.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:36:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316383"
}
```



---

archive/issue_comments_341197.json:
```json
{
    "body": "Commit: **[`8475812`](https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c)**",
    "created_at": "2017-04-26T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341197",
    "user": "https://github.com/tscrim"
}
```

Commit: **[`8475812`](https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c)**



---

archive/issue_comments_341198.json:
```json
{
    "body": "Branch: **[u/tscrim/linking_gmp-22878](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/linking_gmp-22878)**",
    "created_at": "2017-04-26T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341198",
    "user": "https://github.com/tscrim"
}
```

Branch: **[u/tscrim/linking_gmp-22878](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/linking_gmp-22878)**



---

archive/issue_events_316384.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316384"
}
```



---

archive/issue_comments_341199.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c\"><code>8475812</code></a></td><td><code>Adding more links to gmp for cgwin.</code></td></tr></table>\n",
    "created_at": "2017-04-26T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341199",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c"><code>8475812</code></a></td><td><code>Adding more links to gmp for cgwin.</code></td></tr></table>




---

archive/issue_comments_341200.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nWouldn't it be better to modify the corresponding pxd files?\n\nThen we could remove the libraries lines from module.py.",
    "created_at": "2017-04-26T15:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341200",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:2" align="right">comment:2</div>

Wouldn't it be better to modify the corresponding pxd files?

Then we could remove the libraries lines from module.py.



---

archive/issue_comments_341201.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nDo you mean adding `# distutils: libraries = gmp` (well, with what is needed) to the .pyx files?",
    "created_at": "2017-04-26T15:53:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341201",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

Do you mean adding `# distutils: libraries = gmp` (well, with what is needed) to the .pyx files?



---

archive/issue_comments_341202.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAdding:\n`# distutils: libraries = ecl gmp` to ecl.pxd.\n\nFor fes.pyx, there is no pxd file so...",
    "created_at": "2017-04-26T15:56:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341202",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:4" align="right">comment:4</div>

Adding:
`# distutils: libraries = ecl gmp` to ecl.pxd.

For fes.pyx, there is no pxd file so...



---

archive/issue_comments_341203.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nBut it should also work in the pyx file.",
    "created_at": "2017-04-26T16:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341203",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:5" align="right">comment:5</div>

But it should also work in the pyx file.



---

archive/issue_comments_341204.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481\"><code>9fb2e3f</code></a></td><td><code>Move libraries to ecl.pxd.</code></td></tr></table>\n",
    "created_at": "2017-04-26T16:14:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341204",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481"><code>9fb2e3f</code></a></td><td><code>Move libraries to ecl.pxd.</code></td></tr></table>




---

archive/issue_comments_341205.json:
```json
{
    "body": "Changed commit from **[`8475812`](https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c)** to **[`9fb2e3f`](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**",
    "created_at": "2017-04-26T16:14:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341205",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8475812`](https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c)** to **[`9fb2e3f`](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**



---

archive/issue_comments_341206.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIt's probably better to do it in the .pxd (I had only seen it done in .pyx before).",
    "created_at": "2017-04-26T16:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341206",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:7" align="right">comment:7</div>

It's probably better to do it in the .pxd (I had only seen it done in .pyx before).



---

archive/issue_comments_341207.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n@jdemeyer: what do you think?",
    "created_at": "2017-04-26T16:17:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341207",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:8" align="right">comment:8</div>

@jdemeyer: what do you think?



---

archive/issue_comments_341208.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nOops, don't know why I was speaking of fes.pyx...\n\nFor bernmm, I agree that module.py is the right place to do it.\nIn fact we should definitely split back bernmm into a separate package.",
    "created_at": "2017-04-26T16:18:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341208",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:9" align="right">comment:9</div>

Oops, don't know why I was speaking of fes.pyx...

For bernmm, I agree that module.py is the right place to do it.
In fact we should definitely split back bernmm into a separate package.



---

archive/issue_comments_341209.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nNo worries; probably because it is there in the neighboring diff.",
    "created_at": "2017-04-26T16:19:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341209",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

No worries; probably because it is there in the neighboring diff.



---

archive/issue_events_316385.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-04-26T17:44:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316385"
}
```



---

archive/issue_events_316386.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-04-26T17:44:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316386"
}
```



---

archive/issue_comments_341210.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI tried reverting #22728 but that didn't seem fix the problem, so I guess that wasn't it after all, at least not on its own.  Somehow this broke just between 8.0.beta2 and 8.0.beta3 and I don't know why, which is disconcerting.  \n\nBut I think this is fine as a workaround, and is not the first time I've had to do this...",
    "created_at": "2017-04-26T17:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341210",
    "user": "https://github.com/embray"
}
```

<div id="comment:11" align="right">comment:11</div>

I tried reverting #22728 but that didn't seem fix the problem, so I guess that wasn't it after all, at least not on its own.  Somehow this broke just between 8.0.beta2 and 8.0.beta3 and I don't know why, which is disconcerting.  

But I think this is fine as a workaround, and is not the first time I've had to do this...



---

archive/issue_comments_341211.json:
```json
{
    "body": "Reviewer: **Erik Bray**",
    "created_at": "2017-04-26T17:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341211",
    "user": "https://github.com/embray"
}
```

Reviewer: **Erik Bray**



---

archive/issue_comments_341212.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nIt could be also be related to #22805 or #22806. *shrugs* Well, if we fix all of the symptoms, then we've likely fixed the problem...",
    "created_at": "2017-04-26T17:47:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341212",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

It could be also be related to #22805 or #22806. *shrugs* Well, if we fix all of the symptoms, then we've likely fixed the problem...



---

archive/issue_comments_341213.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@jpflori](#comment%3A8):\n> @jdemeyer: what do you think?\n\nI think it should be added in the place which causes the dependency. For example, ECL depends on GMP, so it makes sense that every module which uses `ecl.pxd` should link against `gmp`.\n\nI would *not* add to `module_list.py`. Ideally, `module_list.py` should not exist in the first place. It's much cleaner to add the `# distutils` declarations in the Cython source file.",
    "created_at": "2017-04-26T17:50:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341213",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@jpflori](#comment%3A8):
> @jdemeyer: what do you think?

I think it should be added in the place which causes the dependency. For example, ECL depends on GMP, so it makes sense that every module which uses `ecl.pxd` should link against `gmp`.

I would *not* add to `module_list.py`. Ideally, `module_list.py` should not exist in the first place. It's much cleaner to add the `# distutils` declarations in the Cython source file.



---

archive/issue_comments_341214.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nYes, it must have been #22806.  That's fine.  And yes, it used a `# distutils` declaration in this case.",
    "created_at": "2017-04-26T17:56:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341214",
    "user": "https://github.com/embray"
}
```

<div id="comment:14" align="right">comment:14</div>

Yes, it must have been #22806.  That's fine.  And yes, it used a `# distutils` declaration in this case.



---

archive/issue_events_316387.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-28T23:54:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316387"
}
```



---

archive/issue_events_316388.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b399883e4901bab691ac7a4e537bb03b46d35ab2",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-04-28T23:54:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-316388"
}
```



---

archive/issue_comments_341215.json:
```json
{
    "body": "Changed branch from **[u/tscrim/linking_gmp-22878](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/linking_gmp-22878)** to **[`9fb2e3f`](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**",
    "created_at": "2017-04-28T23:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-341215",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/tscrim/linking_gmp-22878](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/linking_gmp-22878)** to **[`9fb2e3f`](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**
