# Issue 22878: Add gmp to libraries for libs/ecl and rings/bernmm

archive/issues_022641.json:
```json
{
    "assignees": [],
    "body": "Needed to build on Cygwin. Likely now needed from changes from #22728.\n\nCC:  @embray jpflori gouezel @jdemeyer\n\nBranch/Commit: **[9fb2e3f](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**\n\nReviewer: **Erik Bray**\n\nAuthor: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22878_\n\n",
    "closed_at": "2017-04-28T23:54:34Z",
    "created_at": "2017-04-26T15:36:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20porting%3A%20cygwin",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add gmp to libraries for libs/ecl and rings/bernmm",
    "type": "issue",
    "updated_at": "2017-04-28T23:54:34Z",
    "url": "https://github.com/sagemath/sage/issues/22878",
    "user": "https://github.com/tscrim"
}
```
Needed to build on Cygwin. Likely now needed from changes from #22728.

CC:  @embray jpflori gouezel @jdemeyer

Branch/Commit: **[9fb2e3f](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**

Reviewer: **Erik Bray**

Author: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/22878_





---

archive/issue_events_290379.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:36:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290379"
}
```



---

archive/issue_events_290380.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:36:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20porting%3A%20cygwin",
    "label_color": "000080",
    "label_name": "component: porting: cygwin",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290380"
}
```



---

archive/issue_events_290381.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:36:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290381"
}
```



---

archive/issue_events_290382.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:36:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290382"
}
```



---

archive/issue_comments_343909.json:
```json
{
    "body": "Commit: **[8475812](https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c)**",
    "created_at": "2017-04-26T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343909",
    "user": "https://github.com/tscrim"
}
```

Commit: **[8475812](https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c)**



---

archive/issue_comments_343910.json:
```json
{
    "body": "Branch: **[u/tscrim/linking_gmp-22878](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/linking_gmp-22878)**",
    "created_at": "2017-04-26T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343910",
    "user": "https://github.com/tscrim"
}
```

Branch: **[u/tscrim/linking_gmp-22878](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/linking_gmp-22878)**



---

archive/issue_events_290383.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-04-26T15:40:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290383"
}
```



---

archive/issue_comments_343911.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c\">8475812</a></td><td><code>Adding more links to gmp for cgwin.</code></td></tr></table>\n",
    "created_at": "2017-04-26T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343911",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'>Comment 1:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c">8475812</a></td><td><code>Adding more links to gmp for cgwin.</code></td></tr></table>




---

archive/issue_comments_343912.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nWouldn't it be better to modify the corresponding pxd files?\n\nThen we could remove the libraries lines from module.py.",
    "created_at": "2017-04-26T15:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343912",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<a id='comment:2'>Comment 2:</a>
Wouldn't it be better to modify the corresponding pxd files?

Then we could remove the libraries lines from module.py.



---

archive/issue_comments_343913.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nDo you mean adding `# distutils: libraries = gmp` (well, with what is needed) to the .pyx files?",
    "created_at": "2017-04-26T15:53:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343913",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'>Comment 3:</a>
Do you mean adding `# distutils: libraries = gmp` (well, with what is needed) to the .pyx files?



---

archive/issue_comments_343914.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nAdding:\n`# distutils: libraries = ecl gmp` to ecl.pxd.\n\nFor fes.pyx, there is no pxd file so...",
    "created_at": "2017-04-26T15:56:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343914",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<a id='comment:4'>Comment 4:</a>
Adding:
`# distutils: libraries = ecl gmp` to ecl.pxd.

For fes.pyx, there is no pxd file so...



---

archive/issue_comments_343915.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBut it should also work in the pyx file.",
    "created_at": "2017-04-26T16:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343915",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<a id='comment:5'>Comment 5:</a>
But it should also work in the pyx file.



---

archive/issue_comments_343916.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481\">9fb2e3f</a></td><td><code>Move libraries to ecl.pxd.</code></td></tr></table>\n",
    "created_at": "2017-04-26T16:14:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343916",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481">9fb2e3f</a></td><td><code>Move libraries to ecl.pxd.</code></td></tr></table>




---

archive/issue_comments_343917.json:
```json
{
    "body": "Changed commit from **[8475812](https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c)** to **[9fb2e3f](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**",
    "created_at": "2017-04-26T16:14:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343917",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8475812](https://github.com/sagemath/sagetrac-mirror/commit/847581286860b2f7abbcc12ba8e305f963d7f60c)** to **[9fb2e3f](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**



---

archive/issue_comments_343918.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nIt's probably better to do it in the .pxd (I had only seen it done in .pyx before).",
    "created_at": "2017-04-26T16:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343918",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'>Comment 7:</a>
It's probably better to do it in the .pxd (I had only seen it done in .pyx before).



---

archive/issue_comments_343919.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\n`@`jeroen: what do you think?",
    "created_at": "2017-04-26T16:17:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343919",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<a id='comment:8'>Comment 8:</a>
`@`jeroen: what do you think?



---

archive/issue_comments_343920.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nOops, don't know why I was speaking of fes.pyx...\n\nFor bernmm, I agree that module.py is the right place to do it.\nIn fact we should definitely split back bernmm into a separate package.",
    "created_at": "2017-04-26T16:18:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343920",
    "user": "https://github.com/sagetrac-jpflori"
}
```

<a id='comment:9'>Comment 9:</a>
Oops, don't know why I was speaking of fes.pyx...

For bernmm, I agree that module.py is the right place to do it.
In fact we should definitely split back bernmm into a separate package.



---

archive/issue_comments_343921.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nNo worries; probably because it is there in the neighboring diff.",
    "created_at": "2017-04-26T16:19:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343921",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'>Comment 10:</a>
No worries; probably because it is there in the neighboring diff.



---

archive/issue_events_290384.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-04-26T17:44:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290384"
}
```



---

archive/issue_events_290385.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-04-26T17:44:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290385"
}
```



---

archive/issue_comments_343922.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nI tried reverting #22728 but that didn't seem fix the problem, so I guess that wasn't it after all, at least not on its own.  Somehow this broke just between 8.0.beta2 and 8.0.beta3 and I don't know why, which is disconcerting.  \n\nBut I think this is fine as a workaround, and is not the first time I've had to do this...",
    "created_at": "2017-04-26T17:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343922",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'>Comment 11:</a>
I tried reverting #22728 but that didn't seem fix the problem, so I guess that wasn't it after all, at least not on its own.  Somehow this broke just between 8.0.beta2 and 8.0.beta3 and I don't know why, which is disconcerting.  

But I think this is fine as a workaround, and is not the first time I've had to do this...



---

archive/issue_comments_343923.json:
```json
{
    "body": "Reviewer: **Erik Bray**",
    "created_at": "2017-04-26T17:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343923",
    "user": "https://github.com/embray"
}
```

Reviewer: **Erik Bray**



---

archive/issue_comments_343924.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nIt could be also be related to #22805 or #22806. *shrugs* Well, if we fix all of the symptoms, then we've likely fixed the problem...",
    "created_at": "2017-04-26T17:47:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343924",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'>Comment 12:</a>
It could be also be related to #22805 or #22806. *shrugs* Well, if we fix all of the symptoms, then we've likely fixed the problem...



---

archive/issue_comments_343925.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [jpflori](#comment%3A8):\n> `@`jeroen: what do you think?\n\nI think it should be added in the place which causes the dependency. For example, ECL depends on GMP, so it makes sense that every module which uses `ecl.pxd` should link against `gmp`.\n\nI would *not* add to `module_list.py`. Ideally, `module_list.py` should not exist in the first place. It's much cleaner to add the `# distutils` declarations in the Cython source file.",
    "created_at": "2017-04-26T17:50:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343925",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [jpflori](#comment%3A8):
> `@`jeroen: what do you think?

I think it should be added in the place which causes the dependency. For example, ECL depends on GMP, so it makes sense that every module which uses `ecl.pxd` should link against `gmp`.

I would *not* add to `module_list.py`. Ideally, `module_list.py` should not exist in the first place. It's much cleaner to add the `# distutils` declarations in the Cython source file.



---

archive/issue_comments_343926.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nYes, it must have been #22806.  That's fine.  And yes, it used a `# distutils` declaration in this case.",
    "created_at": "2017-04-26T17:56:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343926",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'>Comment 14:</a>
Yes, it must have been #22806.  That's fine.  And yes, it used a `# distutils` declaration in this case.



---

archive/issue_events_290386.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-28T23:54:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290386"
}
```



---

archive/issue_events_290387.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b399883e4901bab691ac7a4e537bb03b46d35ab2",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-04-28T23:54:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22878#event-290387"
}
```



---

archive/issue_comments_343927.json:
```json
{
    "body": "Changed branch from **[u/tscrim/linking_gmp-22878](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/linking_gmp-22878)** to **[9fb2e3f](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**",
    "created_at": "2017-04-28T23:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22878#issuecomment-343927",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/tscrim/linking_gmp-22878](https://github.com/sagemath/sagetrac-mirror/tree/u/tscrim/linking_gmp-22878)** to **[9fb2e3f](https://github.com/sagemath/sagetrac-mirror/commit/9fb2e3f2b03353f25f6e11373fca080a7af12481)**
