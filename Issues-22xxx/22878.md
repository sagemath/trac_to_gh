# Issue 22878: Add gmp to libraries for libs/ecl and rings/bernmm

archive/issues_022641.json:
```json
{
    "body": "Needed to build on Cygwin. Likely now needed from changes from #22728.\n\nCC:  @embray jpflori gouezel @jdemeyer\n\nBranch/Commit: 9fb2e3f2b03353f25f6e11373fca080a7af12481\n\nReviewer: Erik Bray\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22878\n\n",
    "closed_at": "2017-04-28T23:54:34Z",
    "created_at": "2017-04-26T15:36:36Z",
    "labels": [
        "component: porting: cygwin",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Add gmp to libraries for libs/ecl and rings/bernmm",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22878",
    "user": "https://github.com/tscrim"
}
```
Needed to build on Cygwin. Likely now needed from changes from #22728.

CC:  @embray jpflori gouezel @jdemeyer

Branch/Commit: 9fb2e3f2b03353f25f6e11373fca080a7af12481

Reviewer: Erik Bray

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22878





---

archive/issue_comments_427406.json:
```json
{
    "body": "Changing commit from \"\" to \"847581286860b2f7abbcc12ba8e305f963d7f60c\"",
    "created_at": "2017-04-26T15:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427406",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "847581286860b2f7abbcc12ba8e305f963d7f60c"



---

archive/issue_comments_427407.json:
```json
{
    "body": "Changing branch from \"\" to \"u/tscrim/linking_gmp-22878\"",
    "created_at": "2017-04-26T15:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427407",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "u/tscrim/linking_gmp-22878"



---

archive/issue_comments_427408.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-26T15:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427408",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_427409.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2017-04-26T15:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427409",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_427410.json:
```json
{
    "body": "<a id='comment:2'></a>Wouldn't it be better to modify the corresponding pxd files?\n\nThen we could remove the libraries lines from module.py.",
    "created_at": "2017-04-26T15:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427410",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:2'></a>Wouldn't it be better to modify the corresponding pxd files?

Then we could remove the libraries lines from module.py.



---

archive/issue_comments_427411.json:
```json
{
    "body": "<a id='comment:3'></a>Do you mean adding `# distutils: libraries = gmp` (well, with what is needed) to the .pyx files?",
    "created_at": "2017-04-26T15:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427411",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>Do you mean adding `# distutils: libraries = gmp` (well, with what is needed) to the .pyx files?



---

archive/issue_comments_427412.json:
```json
{
    "body": "<a id='comment:4'></a>Adding:\n`# distutils: libraries = ecl gmp` to ecl.pxd.\n\nFor fes.pyx, there is no pxd file so...",
    "created_at": "2017-04-26T15:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427412",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:4'></a>Adding:
`# distutils: libraries = ecl gmp` to ecl.pxd.

For fes.pyx, there is no pxd file so...



---

archive/issue_comments_427413.json:
```json
{
    "body": "<a id='comment:5'></a>But it should also work in the pyx file.",
    "created_at": "2017-04-26T16:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427413",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:5'></a>But it should also work in the pyx file.



---

archive/issue_comments_427414.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-26T16:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427414",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_427415.json:
```json
{
    "body": "Changing commit from \"847581286860b2f7abbcc12ba8e305f963d7f60c\" to \"9fb2e3f2b03353f25f6e11373fca080a7af12481\"",
    "created_at": "2017-04-26T16:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427415",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "847581286860b2f7abbcc12ba8e305f963d7f60c" to "9fb2e3f2b03353f25f6e11373fca080a7af12481"



---

archive/issue_comments_427416.json:
```json
{
    "body": "<a id='comment:7'></a>It's probably better to do it in the .pxd (I had only seen it done in .pyx before).",
    "created_at": "2017-04-26T16:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427416",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>It's probably better to do it in the .pxd (I had only seen it done in .pyx before).



---

archive/issue_comments_427417.json:
```json
{
    "body": "<a id='comment:8'></a>`@`jeroen: what do you think?",
    "created_at": "2017-04-26T16:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427417",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:8'></a>`@`jeroen: what do you think?



---

archive/issue_comments_427418.json:
```json
{
    "body": "<a id='comment:9'></a>Oops, don't know why I was speaking of fes.pyx...\n\nFor bernmm, I agree that module.py is the right place to do it.\nIn fact we should definitely split back bernmm into a separate package.",
    "created_at": "2017-04-26T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427418",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:9'></a>Oops, don't know why I was speaking of fes.pyx...

For bernmm, I agree that module.py is the right place to do it.
In fact we should definitely split back bernmm into a separate package.



---

archive/issue_comments_427419.json:
```json
{
    "body": "<a id='comment:10'></a>No worries; probably because it is there in the neighboring diff.",
    "created_at": "2017-04-26T16:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427419",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>No worries; probably because it is there in the neighboring diff.



---

archive/issue_comments_427420.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-26T17:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427420",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_427421.json:
```json
{
    "body": "<a id='comment:11'></a>I tried reverting #22728 but that didn't seem fix the problem, so I guess that wasn't it after all, at least not on its own.  Somehow this broke just between 8.0.beta2 and 8.0.beta3 and I don't know why, which is disconcerting.  \n\nBut I think this is fine as a workaround, and is not the first time I've had to do this...",
    "created_at": "2017-04-26T17:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427421",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>I tried reverting #22728 but that didn't seem fix the problem, so I guess that wasn't it after all, at least not on its own.  Somehow this broke just between 8.0.beta2 and 8.0.beta3 and I don't know why, which is disconcerting.  

But I think this is fine as a workaround, and is not the first time I've had to do this...



---

archive/issue_comments_427422.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Erik Bray\"",
    "created_at": "2017-04-26T17:44:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427422",
    "user": "https://github.com/embray"
}
```

Changing reviewer from "" to "Erik Bray"



---

archive/issue_comments_427423.json:
```json
{
    "body": "<a id='comment:12'></a>It could be also be related to #22805 or #22806. *shrugs* Well, if we fix all of the symptoms, then we've likely fixed the problem...",
    "created_at": "2017-04-26T17:47:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427423",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>It could be also be related to #22805 or #22806. *shrugs* Well, if we fix all of the symptoms, then we've likely fixed the problem...



---

archive/issue_comments_427424.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:8 jpflori]:\n> `@`jeroen: what do you think?\n\n\nI think it should be added in the place which causes the dependency. For example, ECL depends on GMP, so it makes sense that every module which uses `ecl.pxd` should link against `gmp`.\n\nI would *not* add to `module_list.py`. Ideally, `module_list.py` should not exist in the first place. It's much cleaner to add the `# distutils` declarations in the Cython source file.",
    "created_at": "2017-04-26T17:50:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427424",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>Replying to [comment:8 jpflori]:
> `@`jeroen: what do you think?


I think it should be added in the place which causes the dependency. For example, ECL depends on GMP, so it makes sense that every module which uses `ecl.pxd` should link against `gmp`.

I would *not* add to `module_list.py`. Ideally, `module_list.py` should not exist in the first place. It's much cleaner to add the `# distutils` declarations in the Cython source file.



---

archive/issue_comments_427425.json:
```json
{
    "body": "<a id='comment:14'></a>Yes, it must have been #22806.  That's fine.  And yes, it used a `# distutils` declaration in this case.",
    "created_at": "2017-04-26T17:56:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427425",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>Yes, it must have been #22806.  That's fine.  And yes, it used a `# distutils` declaration in this case.



---

archive/issue_events_059420.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-28T23:54:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22878#event-59420"
}
```



---

archive/issue_comments_427426.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-28T23:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427426",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_427427.json:
```json
{
    "body": "Changing branch from \"u/tscrim/linking_gmp-22878\" to \"9fb2e3f2b03353f25f6e11373fca080a7af12481\"",
    "created_at": "2017-04-28T23:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22878",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22878#issuecomment-427427",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/tscrim/linking_gmp-22878" to "9fb2e3f2b03353f25f6e11373fca080a7af12481"
