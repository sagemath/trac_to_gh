# Issue 22571: weird memory error while approximating sin

archive/issues_022334.json:
```json
{
    "body": "Reported at [this ask.sagemath question](https://ask.sagemath.org/question/36618/memory-error-mixing-exact-numbers-and-decimal-ones/):\n\n```\nsage: bool(sin(pi*RR(\"0.7000000000000002\")) > 0)\n---------------------------------------------------------------------------\nMemoryError                               Traceback (most recent call last)\n<ipython-input-19-4f7b466aff9f> in <module>()\n----> 1 bool(sin(Integer(2)*pi*(RealNumber('1.75')-RealNumber('1.4'))) > Integer(0))\n\n/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__nonzero__ (build/cythonized/sage/symbolic/expression.cpp:17971)()\n   2608                 if pynac_result == relational_notimplemented and self.operator()==operator.ne:\n   2609                     return not (self.lhs()-self.rhs()).is_trivial_zero()\n-> 2610                 res = self.test_relation()\n   2611                 if res is True:\n   2612                     return True\n\n/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.test_relation (build/cythonized/sage/symbolic/expression.cpp:18615)()\n   2717         if domain is None:\n   2718             is_interval = True\n-> 2719             if self.lhs().is_algebraic() and self.rhs().is_algebraic():\n   2720                 if op == equal or op == not_equal:\n   2721                     domain = QQbar\n\n/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.is_algebraic (build/cythonized/sage/symbolic/expression.cpp:14911)()\n   1953         \"\"\"\n   1954         try:\n-> 1955             ex = sage.rings.all.QQbar(self)\n   1956         except (TypeError, ValueError, NotImplementedError):\n   1957             return False\n\n/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9844)()\n    953         if mor is not None:\n    954             if no_extra_args:\n--> 955                 return mor._call_(x)\n    956             else:\n    957                 return mor._call_with_args(x, args, kwds)\n\n/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4890)()\n    108                 print(type(C), C)\n    109                 print(type(C._element_constructor), C._element_constructor)\n--> 110             raise\n    111 \n    112     cpdef Element _call_with_args(self, x, args=(), kwds={}):\n\n/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4757)()\n    103         cdef Parent C = self._codomain\n    104         try:\n--> 105             return C._element_constructor(x)\n    106         except Exception:\n    107             if print_warnings:\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.pyc in _element_constructor_(self, x)\n   1126             return AlgebraicNumber(x._descr)\n   1127         elif hasattr(x, '_algebraic_'):\n-> 1128             return x._algebraic_(QQbar)\n   1129         return AlgebraicNumber(x)\n   1130 \n\n/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()\n   1475         \"\"\"\n   1476         from sage.symbolic.expression_conversions import algebraic\n-> 1477         return algebraic(self, field)\n   1478 \n   1479     def __hash__(self):\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)\n    956         0\n    957     \"\"\"\n--> 958     return AlgebraicConverter(field)(ex)\n    959 \n    960 ##############\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)\n    224             return self.tuple(ex)\n    225         else:\n--> 226             return self.composition(ex, operator)\n    227 \n    228     def get_fake_div(self, ex):\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)\n    889             res = mag * QQbar.zeta(rat_arg.denom())**rat_arg.numer()\n    890         elif func_name in ['sin', 'cos', 'tan']:\n--> 891             exp_ia = exp(SR(-1).sqrt()*operand)._algebraic_(QQbar)\n    892             if func_name == 'sin':\n    893                 res = (exp_ia - ~exp_ia)/(2*QQbar.zeta(4))\n\n/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()\n   1475         \"\"\"\n   1476         from sage.symbolic.expression_conversions import algebraic\n-> 1477         return algebraic(self, field)\n   1478 \n   1479     def __hash__(self):\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)\n    956         0\n    957     \"\"\"\n--> 958     return AlgebraicConverter(field)(ex)\n    959 \n    960 ##############\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)\n    224             return self.tuple(ex)\n    225         else:\n--> 226             return self.composition(ex, operator)\n    227 \n    228     def get_fake_div(self, ex):\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)\n    887             else:\n    888                 mag = 1\n--> 889             res = mag * QQbar.zeta(rat_arg.denom())**rat_arg.numer()\n    890         elif func_name in ['sin', 'cos', 'tan']:\n    891             exp_ia = exp(SR(-1).sqrt()*operand)._algebraic_(QQbar)\n\n/usr/local/src/sage-config/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10792)()\n   2036                 return cache[k]\n   2037         except KeyError:\n-> 2038             w = self._instance_call(*args, **kwds)\n   2039             cache[k] = w\n   2040             return w\n\n/usr/local/src/sage-config/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:10238)()\n   1912             True\n   1913         \"\"\"\n-> 1914         return self.f(self._instance, *args, **kwds)\n   1915 \n   1916     cdef fix_args_kwds(self, tuple args, dict kwds):\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.pyc in zeta(self, n)\n   1314             return self.gen()\n   1315         else:\n-> 1316             nf = CyclotomicField(n)\n   1317             p = nf.polynomial()\n   1318             root = ANRoot(p, ComplexIntervalField(64).zeta(n))\n\n/usr/local/src/sage-config/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.__call__ (build/cythonized/sage/structure/factory.c:1938)()\n    362         key, kwds = self.create_key_and_extra_args(*args, **kwds)\n    363         version = self.get_version(sage_version)\n--> 364         return self.get_object(version, key, kwds)\n    365 \n    366     cpdef get_object(self, version, key, extra_args):\n\n/usr/local/src/sage-config/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.get_object (build/cythonized/sage/structure/factory.c:2320)()\n    405         except KeyError:\n    406             pass\n--> 407         obj = self.create_object(version, key, **extra_args)\n    408         self._cache[version, cache_key] = obj\n    409         try:\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in create_object(self, version, key, **extra_args)\n   1123             return UniversalCyclotomicField()\n   1124         else:\n-> 1125             return NumberField_cyclotomic(n, names, embedding=embedding)\n   1126 \n   1127 CyclotomicField = CyclotomicFieldFactory(\"sage.rings.number_field.number_field.CyclotomicField\")\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in __init__(self, n, names, embedding, assume_disc_small, maximize_at_primes)\n   8923             <type 'sage.rings.number_field.number_field_element.NumberFieldElement_absolute'>\n   8924         \"\"\"\n-> 8925         f = QQ['x'].cyclotomic_polynomial(n)\n   8926         if names[0].startswith('zeta'):\n   8927             latex_name = \"\\\\zeta_{%s}\"%n\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring.pyc in cyclotomic_polynomial(self, n)\n   1020             return self.gen() - 1\n   1021         else:\n-> 1022             return self(cyclotomic.cyclotomic_coeffs(n), check=True)\n   1023 \n   1024     def gen(self, n=0):\n\n/usr/local/src/sage-config/src/sage/rings/polynomial/cyclotomic.pyx in sage.rings.polynomial.cyclotomic.cyclotomic_coeffs (build/cythonized/sage/rings/polynomial/cyclotomic.c:4932)()\n    153     cdef long* coeffs = <long*>sig_malloc(sizeof(long) * (max_deg+1))\n    154     if coeffs == NULL:\n--> 155         raise MemoryError(\"Not enough memory to calculate cyclotomic polynomial of %s\" % n)\n    156     memset(coeffs, 0, sizeof(long) * (max_deg+1))\n    157     coeffs[0] = 1\n\nMemoryError: Not enough memory to calculate cyclotomic polynomial of 428914250225777\n```\n\nCC:  @rwst\n\nBranch/Commit: e2fac195237f10bb39da40c489a1cba3ecaeff00\n\nReviewer: Ralf Stephan\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22571\n\n",
    "closed_at": "2017-03-12T17:16:28Z",
    "created_at": "2017-03-10T14:07:12Z",
    "labels": [
        "component: basic arithmetic",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "weird memory error while approximating sin",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22571",
    "user": "https://github.com/kcrisman"
}
```
Reported at [this ask.sagemath question](https://ask.sagemath.org/question/36618/memory-error-mixing-exact-numbers-and-decimal-ones/):

```
sage: bool(sin(pi*RR("0.7000000000000002")) > 0)
---------------------------------------------------------------------------
MemoryError                               Traceback (most recent call last)
<ipython-input-19-4f7b466aff9f> in <module>()
----> 1 bool(sin(Integer(2)*pi*(RealNumber('1.75')-RealNumber('1.4'))) > Integer(0))

/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__nonzero__ (build/cythonized/sage/symbolic/expression.cpp:17971)()
   2608                 if pynac_result == relational_notimplemented and self.operator()==operator.ne:
   2609                     return not (self.lhs()-self.rhs()).is_trivial_zero()
-> 2610                 res = self.test_relation()
   2611                 if res is True:
   2612                     return True

/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.test_relation (build/cythonized/sage/symbolic/expression.cpp:18615)()
   2717         if domain is None:
   2718             is_interval = True
-> 2719             if self.lhs().is_algebraic() and self.rhs().is_algebraic():
   2720                 if op == equal or op == not_equal:
   2721                     domain = QQbar

/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.is_algebraic (build/cythonized/sage/symbolic/expression.cpp:14911)()
   1953         """
   1954         try:
-> 1955             ex = sage.rings.all.QQbar(self)
   1956         except (TypeError, ValueError, NotImplementedError):
   1957             return False

/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9844)()
    953         if mor is not None:
    954             if no_extra_args:
--> 955                 return mor._call_(x)
    956             else:
    957                 return mor._call_with_args(x, args, kwds)

/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4890)()
    108                 print(type(C), C)
    109                 print(type(C._element_constructor), C._element_constructor)
--> 110             raise
    111 
    112     cpdef Element _call_with_args(self, x, args=(), kwds={}):

/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4757)()
    103         cdef Parent C = self._codomain
    104         try:
--> 105             return C._element_constructor(x)
    106         except Exception:
    107             if print_warnings:

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.pyc in _element_constructor_(self, x)
   1126             return AlgebraicNumber(x._descr)
   1127         elif hasattr(x, '_algebraic_'):
-> 1128             return x._algebraic_(QQbar)
   1129         return AlgebraicNumber(x)
   1130 

/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()
   1475         """
   1476         from sage.symbolic.expression_conversions import algebraic
-> 1477         return algebraic(self, field)
   1478 
   1479     def __hash__(self):

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)
    956         0
    957     """
--> 958     return AlgebraicConverter(field)(ex)
    959 
    960 ##############

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)
    224             return self.tuple(ex)
    225         else:
--> 226             return self.composition(ex, operator)
    227 
    228     def get_fake_div(self, ex):

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)
    889             res = mag * QQbar.zeta(rat_arg.denom())**rat_arg.numer()
    890         elif func_name in ['sin', 'cos', 'tan']:
--> 891             exp_ia = exp(SR(-1).sqrt()*operand)._algebraic_(QQbar)
    892             if func_name == 'sin':
    893                 res = (exp_ia - ~exp_ia)/(2*QQbar.zeta(4))

/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()
   1475         """
   1476         from sage.symbolic.expression_conversions import algebraic
-> 1477         return algebraic(self, field)
   1478 
   1479     def __hash__(self):

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)
    956         0
    957     """
--> 958     return AlgebraicConverter(field)(ex)
    959 
    960 ##############

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)
    224             return self.tuple(ex)
    225         else:
--> 226             return self.composition(ex, operator)
    227 
    228     def get_fake_div(self, ex):

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)
    887             else:
    888                 mag = 1
--> 889             res = mag * QQbar.zeta(rat_arg.denom())**rat_arg.numer()
    890         elif func_name in ['sin', 'cos', 'tan']:
    891             exp_ia = exp(SR(-1).sqrt()*operand)._algebraic_(QQbar)

/usr/local/src/sage-config/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10792)()
   2036                 return cache[k]
   2037         except KeyError:
-> 2038             w = self._instance_call(*args, **kwds)
   2039             cache[k] = w
   2040             return w

/usr/local/src/sage-config/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:10238)()
   1912             True
   1913         """
-> 1914         return self.f(self._instance, *args, **kwds)
   1915 
   1916     cdef fix_args_kwds(self, tuple args, dict kwds):

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.pyc in zeta(self, n)
   1314             return self.gen()
   1315         else:
-> 1316             nf = CyclotomicField(n)
   1317             p = nf.polynomial()
   1318             root = ANRoot(p, ComplexIntervalField(64).zeta(n))

/usr/local/src/sage-config/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.__call__ (build/cythonized/sage/structure/factory.c:1938)()
    362         key, kwds = self.create_key_and_extra_args(*args, **kwds)
    363         version = self.get_version(sage_version)
--> 364         return self.get_object(version, key, kwds)
    365 
    366     cpdef get_object(self, version, key, extra_args):

/usr/local/src/sage-config/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.get_object (build/cythonized/sage/structure/factory.c:2320)()
    405         except KeyError:
    406             pass
--> 407         obj = self.create_object(version, key, **extra_args)
    408         self._cache[version, cache_key] = obj
    409         try:

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in create_object(self, version, key, **extra_args)
   1123             return UniversalCyclotomicField()
   1124         else:
-> 1125             return NumberField_cyclotomic(n, names, embedding=embedding)
   1126 
   1127 CyclotomicField = CyclotomicFieldFactory("sage.rings.number_field.number_field.CyclotomicField")

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in __init__(self, n, names, embedding, assume_disc_small, maximize_at_primes)
   8923             <type 'sage.rings.number_field.number_field_element.NumberFieldElement_absolute'>
   8924         """
-> 8925         f = QQ['x'].cyclotomic_polynomial(n)
   8926         if names[0].startswith('zeta'):
   8927             latex_name = "\\zeta_{%s}"%n

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring.pyc in cyclotomic_polynomial(self, n)
   1020             return self.gen() - 1
   1021         else:
-> 1022             return self(cyclotomic.cyclotomic_coeffs(n), check=True)
   1023 
   1024     def gen(self, n=0):

/usr/local/src/sage-config/src/sage/rings/polynomial/cyclotomic.pyx in sage.rings.polynomial.cyclotomic.cyclotomic_coeffs (build/cythonized/sage/rings/polynomial/cyclotomic.c:4932)()
    153     cdef long* coeffs = <long*>sig_malloc(sizeof(long) * (max_deg+1))
    154     if coeffs == NULL:
--> 155         raise MemoryError("Not enough memory to calculate cyclotomic polynomial of %s" % n)
    156     memset(coeffs, 0, sizeof(long) * (max_deg+1))
    157     coeffs[0] = 1

MemoryError: Not enough memory to calculate cyclotomic polynomial of 428914250225777
```

CC:  @rwst

Branch/Commit: e2fac195237f10bb39da40c489a1cba3ecaeff00

Reviewer: Ralf Stephan

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22571





---

archive/issue_comments_422065.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,217 @@\n Reported at [this ask.sagemath question](https://ask.sagemath.org/question/36618/memory-error-mixing-exact-numbers-and-decimal-ones/):\n \n ```\n-f(x)=3*sin(2*pi*(1.75-2*x))\n-if abs(f(0.7)) < 1e-12:\n-     print 1\n+sage: f(x)=3*sin(2*pi*(1.75-2*x))\n+sage: bool(abs(f(0.7)) < 1e-12)\n+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__nonzero__ (build/cythonized/sage/symbolic/expression.cpp:17971)()\n+   2608                 if pynac_result == relational_notimplemented and self.operator()==operator.ne:\n+   2609                     return not (self.lhs()-self.rhs()).is_trivial_zero()\n+-> 2610                 res = self.test_relation()\n+   2611                 if res is True:\n+   2612                     return True\n+\n+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.test_relation (build/cythonized/sage/symbolic/expression.cpp:18615)()\n+   2717         if domain is None:\n+   2718             is_interval = True\n+-> 2719             if self.lhs().is_algebraic() and self.rhs().is_algebraic():\n+   2720                 if op == equal or op == not_equal:\n+   2721                     domain = QQbar\n+\n+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.is_algebraic (build/cythonized/sage/symbolic/expression.cpp:14911)()\n+   1953         \"\"\"\n+   1954         try:\n+-> 1955             ex = sage.rings.all.QQbar(self)\n+   1956         except (TypeError, ValueError, NotImplementedError):\n+   1957             return False\n+\n+/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9844)()\n+    953         if mor is not None:\n+    954             if no_extra_args:\n+--> 955                 return mor._call_(x)\n+    956             else:\n+    957                 return mor._call_with_args(x, args, kwds)\n+\n+/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4890)()\n+    108                 print(type(C), C)\n+    109                 print(type(C._element_constructor), C._element_constructor)\n+--> 110             raise\n+    111 \n+    112     cpdef Element _call_with_args(self, x, args=(), kwds={}):\n+\n+/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4757)()\n+    103         cdef Parent C = self._codomain\n+    104         try:\n+--> 105             return C._element_constructor(x)\n+    106         except Exception:\n+    107             if print_warnings:\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.pyc in _element_constructor_(self, x)\n+   1126             return AlgebraicNumber(x._descr)\n+   1127         elif hasattr(x, '_algebraic_'):\n+-> 1128             return x._algebraic_(QQbar)\n+   1129         return AlgebraicNumber(x)\n+   1130 \n+\n+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()\n+   1475         \"\"\"\n+   1476         from sage.symbolic.expression_conversions import algebraic\n+-> 1477         return algebraic(self, field)\n+   1478 \n+   1479     def __hash__(self):\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)\n+    956         0\n+    957     \"\"\"\n+--> 958     return AlgebraicConverter(field)(ex)\n+    959 \n+    960 ##############\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)\n+    216                 div = self.get_fake_div(ex)\n+    217                 return self.arithmetic(div, div.operator())\n+--> 218             return self.arithmetic(ex, operator)\n+    219         elif operator in relation_operators:\n+    220             return self.relation(ex, operator)\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in arithmetic(self, ex, operator)\n+    839                 elif operator is mul_vararg:\n+    840                     operator = _operator.mul\n+--> 841                 return reduce(operator, map(self, ex.operands()))\n+    842         except TypeError:\n+    843             pass\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)\n+    224             return self.tuple(ex)\n+    225         else:\n+--> 226             return self.composition(ex, operator)\n+    227 \n+    228     def get_fake_div(self, ex):\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)\n+    907             res = ~self.reciprocal_trig_functions[func_name](operand)._algebraic_(QQbar)\n+    908         else:\n+--> 909             res = func(operand._algebraic_(self.field))\n+    910             #We have to handle the case where we get the same symbolic\n+    911             #expression back.  For example, QQbar(zeta(7)).  See\n+\n+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()\n+   1475         \"\"\"\n+   1476         from sage.symbolic.expression_conversions import algebraic\n+-> 1477         return algebraic(self, field)\n+   1478 \n+   1479     def __hash__(self):\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)\n+    956         0\n+    957     \"\"\"\n+--> 958     return AlgebraicConverter(field)(ex)\n+    959 \n+    960 ##############\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)\n+    224             return self.tuple(ex)\n+    225         else:\n+--> 226             return self.composition(ex, operator)\n+    227 \n+    228     def get_fake_div(self, ex):\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)\n+    889             res = mag * QQbar.zeta(rat_arg.denom())**rat_arg.numer()\n+    890         elif func_name in ['sin', 'cos', 'tan']:\n+--> 891             exp_ia = exp(SR(-1).sqrt()*operand)._algebraic_(QQbar)\n+    892             if func_name == 'sin':\n+    893                 res = (exp_ia - ~exp_ia)/(2*QQbar.zeta(4))\n+\n+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()\n+   1475         \"\"\"\n+   1476         from sage.symbolic.expression_conversions import algebraic\n+-> 1477         return algebraic(self, field)\n+   1478 \n+   1479     def __hash__(self):\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)\n+    956         0\n+    957     \"\"\"\n+--> 958     return AlgebraicConverter(field)(ex)\n+    959 \n+    960 ##############\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)\n+    224             return self.tuple(ex)\n+    225         else:\n+--> 226             return self.composition(ex, operator)\n+    227 \n+    228     def get_fake_div(self, ex):\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)\n+    887             else:\n+    888                 mag = 1\n+--> 889             res = mag * QQbar.zeta(rat_arg.denom())**rat_arg.numer()\n+    890         elif func_name in ['sin', 'cos', 'tan']:\n+    891             exp_ia = exp(SR(-1).sqrt()*operand)._algebraic_(QQbar)\n+\n+/usr/local/src/sage-config/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10792)()\n+   2036                 return cache[k]\n+   2037         except KeyError:\n+-> 2038             w = self._instance_call(*args, **kwds)\n+   2039             cache[k] = w\n+   2040             return w\n+\n+/usr/local/src/sage-config/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:10238)()\n+   1912             True\n+   1913         \"\"\"\n+-> 1914         return self.f(self._instance, *args, **kwds)\n+   1915 \n+   1916     cdef fix_args_kwds(self, tuple args, dict kwds):\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.pyc in zeta(self, n)\n+   1314             return self.gen()\n+   1315         else:\n+-> 1316             nf = CyclotomicField(n)\n+   1317             p = nf.polynomial()\n+   1318             root = ANRoot(p, ComplexIntervalField(64).zeta(n))\n+\n+/usr/local/src/sage-config/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.__call__ (build/cythonized/sage/structure/factory.c:1938)()\n+    362         key, kwds = self.create_key_and_extra_args(*args, **kwds)\n+    363         version = self.get_version(sage_version)\n+--> 364         return self.get_object(version, key, kwds)\n+    365 \n+    366     cpdef get_object(self, version, key, extra_args):\n+\n+/usr/local/src/sage-config/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.get_object (build/cythonized/sage/structure/factory.c:2320)()\n+    405         except KeyError:\n+    406             pass\n+--> 407         obj = self.create_object(version, key, **extra_args)\n+    408         self._cache[version, cache_key] = obj\n+    409         try:\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in create_object(self, version, key, **extra_args)\n+   1123             return UniversalCyclotomicField()\n+   1124         else:\n+-> 1125             return NumberField_cyclotomic(n, names, embedding=embedding)\n+   1126 \n+   1127 CyclotomicField = CyclotomicFieldFactory(\"sage.rings.number_field.number_field.CyclotomicField\")\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in __init__(self, n, names, embedding, assume_disc_small, maximize_at_primes)\n+   8923             <type 'sage.rings.number_field.number_field_element.NumberFieldElement_absolute'>\n+   8924         \"\"\"\n+-> 8925         f = QQ['x'].cyclotomic_polynomial(n)\n+   8926         if names[0].startswith('zeta'):\n+   8927             latex_name = \"\\\\zeta_{%s}\"%n\n+\n+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring.pyc in cyclotomic_polynomial(self, n)\n+   1020             return self.gen() - 1\n+   1021         else:\n+-> 1022             return self(cyclotomic.cyclotomic_coeffs(n), check=True)\n+   1023 \n+   1024     def gen(self, n=0):\n+\n+/usr/local/src/sage-config/src/sage/rings/polynomial/cyclotomic.pyx in sage.rings.polynomial.cyclotomic.cyclotomic_coeffs (build/cythonized/sage/rings/polynomial/cyclotomic.c:4932)()\n+    153     cdef long* coeffs = <long*>sig_malloc(sizeof(long) * (max_deg+1))\n+    154     if coeffs == NULL:\n+--> 155         raise MemoryError(\"Not enough memory to calculate cyclotomic polynomial of %s\" % n)\n+    156     memset(coeffs, 0, sizeof(long) * (max_deg+1))\n+    157     coeffs[0] = 1\n \n MemoryError: Not enough memory to calculate cyclotomic polynomial of 428914250225777\n ```\n``````\n",
    "created_at": "2017-03-10T15:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422065",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,217 @@
 Reported at [this ask.sagemath question](https://ask.sagemath.org/question/36618/memory-error-mixing-exact-numbers-and-decimal-ones/):
 
 ```
-f(x)=3*sin(2*pi*(1.75-2*x))
-if abs(f(0.7)) < 1e-12:
-     print 1
+sage: f(x)=3*sin(2*pi*(1.75-2*x))
+sage: bool(abs(f(0.7)) < 1e-12)
+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__nonzero__ (build/cythonized/sage/symbolic/expression.cpp:17971)()
+   2608                 if pynac_result == relational_notimplemented and self.operator()==operator.ne:
+   2609                     return not (self.lhs()-self.rhs()).is_trivial_zero()
+-> 2610                 res = self.test_relation()
+   2611                 if res is True:
+   2612                     return True
+
+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.test_relation (build/cythonized/sage/symbolic/expression.cpp:18615)()
+   2717         if domain is None:
+   2718             is_interval = True
+-> 2719             if self.lhs().is_algebraic() and self.rhs().is_algebraic():
+   2720                 if op == equal or op == not_equal:
+   2721                     domain = QQbar
+
+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.is_algebraic (build/cythonized/sage/symbolic/expression.cpp:14911)()
+   1953         """
+   1954         try:
+-> 1955             ex = sage.rings.all.QQbar(self)
+   1956         except (TypeError, ValueError, NotImplementedError):
+   1957             return False
+
+/usr/local/src/sage-config/src/sage/structure/parent.pyx in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9844)()
+    953         if mor is not None:
+    954             if no_extra_args:
+--> 955                 return mor._call_(x)
+    956             else:
+    957                 return mor._call_with_args(x, args, kwds)
+
+/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4890)()
+    108                 print(type(C), C)
+    109                 print(type(C._element_constructor), C._element_constructor)
+--> 110             raise
+    111 
+    112     cpdef Element _call_with_args(self, x, args=(), kwds={}):
+
+/usr/local/src/sage-config/src/sage/structure/coerce_maps.pyx in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4757)()
+    103         cdef Parent C = self._codomain
+    104         try:
+--> 105             return C._element_constructor(x)
+    106         except Exception:
+    107             if print_warnings:
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.pyc in _element_constructor_(self, x)
+   1126             return AlgebraicNumber(x._descr)
+   1127         elif hasattr(x, '_algebraic_'):
+-> 1128             return x._algebraic_(QQbar)
+   1129         return AlgebraicNumber(x)
+   1130 
+
+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()
+   1475         """
+   1476         from sage.symbolic.expression_conversions import algebraic
+-> 1477         return algebraic(self, field)
+   1478 
+   1479     def __hash__(self):
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)
+    956         0
+    957     """
+--> 958     return AlgebraicConverter(field)(ex)
+    959 
+    960 ##############
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)
+    216                 div = self.get_fake_div(ex)
+    217                 return self.arithmetic(div, div.operator())
+--> 218             return self.arithmetic(ex, operator)
+    219         elif operator in relation_operators:
+    220             return self.relation(ex, operator)
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in arithmetic(self, ex, operator)
+    839                 elif operator is mul_vararg:
+    840                     operator = _operator.mul
+--> 841                 return reduce(operator, map(self, ex.operands()))
+    842         except TypeError:
+    843             pass
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)
+    224             return self.tuple(ex)
+    225         else:
+--> 226             return self.composition(ex, operator)
+    227 
+    228     def get_fake_div(self, ex):
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)
+    907             res = ~self.reciprocal_trig_functions[func_name](operand)._algebraic_(QQbar)
+    908         else:
+--> 909             res = func(operand._algebraic_(self.field))
+    910             #We have to handle the case where we get the same symbolic
+    911             #expression back.  For example, QQbar(zeta(7)).  See
+
+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()
+   1475         """
+   1476         from sage.symbolic.expression_conversions import algebraic
+-> 1477         return algebraic(self, field)
+   1478 
+   1479     def __hash__(self):
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)
+    956         0
+    957     """
+--> 958     return AlgebraicConverter(field)(ex)
+    959 
+    960 ##############
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)
+    224             return self.tuple(ex)
+    225         else:
+--> 226             return self.composition(ex, operator)
+    227 
+    228     def get_fake_div(self, ex):
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)
+    889             res = mag * QQbar.zeta(rat_arg.denom())**rat_arg.numer()
+    890         elif func_name in ['sin', 'cos', 'tan']:
+--> 891             exp_ia = exp(SR(-1).sqrt()*operand)._algebraic_(QQbar)
+    892             if func_name == 'sin':
+    893                 res = (exp_ia - ~exp_ia)/(2*QQbar.zeta(4))
+
+/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()
+   1475         """
+   1476         from sage.symbolic.expression_conversions import algebraic
+-> 1477         return algebraic(self, field)
+   1478 
+   1479     def __hash__(self):
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)
+    956         0
+    957     """
+--> 958     return AlgebraicConverter(field)(ex)
+    959 
+    960 ##############
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)
+    224             return self.tuple(ex)
+    225         else:
+--> 226             return self.composition(ex, operator)
+    227 
+    228     def get_fake_div(self, ex):
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)
+    887             else:
+    888                 mag = 1
+--> 889             res = mag * QQbar.zeta(rat_arg.denom())**rat_arg.numer()
+    890         elif func_name in ['sin', 'cos', 'tan']:
+    891             exp_ia = exp(SR(-1).sqrt()*operand)._algebraic_(QQbar)
+
+/usr/local/src/sage-config/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedMethodCaller.__call__ (build/cythonized/sage/misc/cachefunc.c:10792)()
+   2036                 return cache[k]
+   2037         except KeyError:
+-> 2038             w = self._instance_call(*args, **kwds)
+   2039             cache[k] = w
+   2040             return w
+
+/usr/local/src/sage-config/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedMethodCaller._instance_call (build/cythonized/sage/misc/cachefunc.c:10238)()
+   1912             True
+   1913         """
+-> 1914         return self.f(self._instance, *args, **kwds)
+   1915 
+   1916     cdef fix_args_kwds(self, tuple args, dict kwds):
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/qqbar.pyc in zeta(self, n)
+   1314             return self.gen()
+   1315         else:
+-> 1316             nf = CyclotomicField(n)
+   1317             p = nf.polynomial()
+   1318             root = ANRoot(p, ComplexIntervalField(64).zeta(n))
+
+/usr/local/src/sage-config/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.__call__ (build/cythonized/sage/structure/factory.c:1938)()
+    362         key, kwds = self.create_key_and_extra_args(*args, **kwds)
+    363         version = self.get_version(sage_version)
+--> 364         return self.get_object(version, key, kwds)
+    365 
+    366     cpdef get_object(self, version, key, extra_args):
+
+/usr/local/src/sage-config/src/sage/structure/factory.pyx in sage.structure.factory.UniqueFactory.get_object (build/cythonized/sage/structure/factory.c:2320)()
+    405         except KeyError:
+    406             pass
+--> 407         obj = self.create_object(version, key, **extra_args)
+    408         self._cache[version, cache_key] = obj
+    409         try:
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in create_object(self, version, key, **extra_args)
+   1123             return UniversalCyclotomicField()
+   1124         else:
+-> 1125             return NumberField_cyclotomic(n, names, embedding=embedding)
+   1126 
+   1127 CyclotomicField = CyclotomicFieldFactory("sage.rings.number_field.number_field.CyclotomicField")
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.pyc in __init__(self, n, names, embedding, assume_disc_small, maximize_at_primes)
+   8923             <type 'sage.rings.number_field.number_field_element.NumberFieldElement_absolute'>
+   8924         """
+-> 8925         f = QQ['x'].cyclotomic_polynomial(n)
+   8926         if names[0].startswith('zeta'):
+   8927             latex_name = "\\zeta_{%s}"%n
+
+/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring.pyc in cyclotomic_polynomial(self, n)
+   1020             return self.gen() - 1
+   1021         else:
+-> 1022             return self(cyclotomic.cyclotomic_coeffs(n), check=True)
+   1023 
+   1024     def gen(self, n=0):
+
+/usr/local/src/sage-config/src/sage/rings/polynomial/cyclotomic.pyx in sage.rings.polynomial.cyclotomic.cyclotomic_coeffs (build/cythonized/sage/rings/polynomial/cyclotomic.c:4932)()
+    153     cdef long* coeffs = <long*>sig_malloc(sizeof(long) * (max_deg+1))
+    154     if coeffs == NULL:
+--> 155         raise MemoryError("Not enough memory to calculate cyclotomic polynomial of %s" % n)
+    156     memset(coeffs, 0, sizeof(long) * (max_deg+1))
+    157     coeffs[0] = 1
 
 MemoryError: Not enough memory to calculate cyclotomic polynomial of 428914250225777
 ```
``````




---

archive/issue_comments_422066.json:
```json
{
    "body": "<a id='comment:1'></a>\nNever omit the traceback on Trac tickets, they usually contain very useful information!",
    "created_at": "2017-03-10T15:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422066",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>
Never omit the traceback on Trac tickets, they usually contain very useful information!



---

archive/issue_comments_422067.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,13 @@\n Reported at [this ask.sagemath question](https://ask.sagemath.org/question/36618/memory-error-mixing-exact-numbers-and-decimal-ones/):\n \n ```\n-sage: f(x)=3*sin(2*pi*(1.75-2*x))\n-sage: bool(abs(f(0.7)) < 1e-12)\n+sage: bool(sin(2*pi*(1.75-1.4)) > 0)\n+sage: bool(sin(2*pi*(1.75-1.4)) > 0)\n+---------------------------------------------------------------------------\n+MemoryError                               Traceback (most recent call last)\n+<ipython-input-19-4f7b466aff9f> in <module>()\n+----> 1 bool(sin(Integer(2)*pi*(RealNumber('1.75')-RealNumber('1.4'))) > Integer(0))\n+\n /usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__nonzero__ (build/cythonized/sage/symbolic/expression.cpp:17971)()\n    2608                 if pynac_result == relational_notimplemented and self.operator()==operator.ne:\n    2609                     return not (self.lhs()-self.rhs()).is_trivial_zero()\n@@ -51,48 +56,6 @@\n -> 1128             return x._algebraic_(QQbar)\n    1129         return AlgebraicNumber(x)\n    1130 \n-\n-/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()\n-   1475         \"\"\"\n-   1476         from sage.symbolic.expression_conversions import algebraic\n--> 1477         return algebraic(self, field)\n-   1478 \n-   1479     def __hash__(self):\n-\n-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)\n-    956         0\n-    957     \"\"\"\n---> 958     return AlgebraicConverter(field)(ex)\n-    959 \n-    960 ##############\n-\n-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)\n-    216                 div = self.get_fake_div(ex)\n-    217                 return self.arithmetic(div, div.operator())\n---> 218             return self.arithmetic(ex, operator)\n-    219         elif operator in relation_operators:\n-    220             return self.relation(ex, operator)\n-\n-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in arithmetic(self, ex, operator)\n-    839                 elif operator is mul_vararg:\n-    840                     operator = _operator.mul\n---> 841                 return reduce(operator, map(self, ex.operands()))\n-    842         except TypeError:\n-    843             pass\n-\n-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)\n-    224             return self.tuple(ex)\n-    225         else:\n---> 226             return self.composition(ex, operator)\n-    227 \n-    228     def get_fake_div(self, ex):\n-\n-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)\n-    907             res = ~self.reciprocal_trig_functions[func_name](operand)._algebraic_(QQbar)\n-    908         else:\n---> 909             res = func(operand._algebraic_(self.field))\n-    910             #We have to handle the case where we get the same symbolic\n-    911             #expression back.  For example, QQbar(zeta(7)).  See\n \n /usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()\n    1475         \"\"\"\n``````\n",
    "created_at": "2017-03-10T15:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422067",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,13 @@
 Reported at [this ask.sagemath question](https://ask.sagemath.org/question/36618/memory-error-mixing-exact-numbers-and-decimal-ones/):
 
 ```
-sage: f(x)=3*sin(2*pi*(1.75-2*x))
-sage: bool(abs(f(0.7)) < 1e-12)
+sage: bool(sin(2*pi*(1.75-1.4)) > 0)
+sage: bool(sin(2*pi*(1.75-1.4)) > 0)
+---------------------------------------------------------------------------
+MemoryError                               Traceback (most recent call last)
+<ipython-input-19-4f7b466aff9f> in <module>()
+----> 1 bool(sin(Integer(2)*pi*(RealNumber('1.75')-RealNumber('1.4'))) > Integer(0))
+
 /usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__nonzero__ (build/cythonized/sage/symbolic/expression.cpp:17971)()
    2608                 if pynac_result == relational_notimplemented and self.operator()==operator.ne:
    2609                     return not (self.lhs()-self.rhs()).is_trivial_zero()
@@ -51,48 +56,6 @@
 -> 1128             return x._algebraic_(QQbar)
    1129         return AlgebraicNumber(x)
    1130 
-
-/usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()
-   1475         """
-   1476         from sage.symbolic.expression_conversions import algebraic
--> 1477         return algebraic(self, field)
-   1478 
-   1479     def __hash__(self):
-
-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in algebraic(ex, field)
-    956         0
-    957     """
---> 958     return AlgebraicConverter(field)(ex)
-    959 
-    960 ##############
-
-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)
-    216                 div = self.get_fake_div(ex)
-    217                 return self.arithmetic(div, div.operator())
---> 218             return self.arithmetic(ex, operator)
-    219         elif operator in relation_operators:
-    220             return self.relation(ex, operator)
-
-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in arithmetic(self, ex, operator)
-    839                 elif operator is mul_vararg:
-    840                     operator = _operator.mul
---> 841                 return reduce(operator, map(self, ex.operands()))
-    842         except TypeError:
-    843             pass
-
-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in __call__(self, ex)
-    224             return self.tuple(ex)
-    225         else:
---> 226             return self.composition(ex, operator)
-    227 
-    228     def get_fake_div(self, ex):
-
-/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)
-    907             res = ~self.reciprocal_trig_functions[func_name](operand)._algebraic_(QQbar)
-    908         else:
---> 909             res = func(operand._algebraic_(self.field))
-    910             #We have to handle the case where we get the same symbolic
-    911             #expression back.  For example, QQbar(zeta(7)).  See
 
 /usr/local/src/sage-config/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression._algebraic_ (build/cythonized/sage/symbolic/expression.cpp:11720)()
    1475         """
``````




---

archive/issue_comments_422068.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,7 @@\n Reported at [this ask.sagemath question](https://ask.sagemath.org/question/36618/memory-error-mixing-exact-numbers-and-decimal-ones/):\n \n ```\n-sage: bool(sin(2*pi*(1.75-1.4)) > 0)\n-sage: bool(sin(2*pi*(1.75-1.4)) > 0)\n+sage: bool(sin(pi*RR(\"0.7000000000000002\")) > 0)\n ---------------------------------------------------------------------------\n MemoryError                               Traceback (most recent call last)\n <ipython-input-19-4f7b466aff9f> in <module>()\n``````\n",
    "created_at": "2017-03-10T15:18:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422068",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,7 @@
 Reported at [this ask.sagemath question](https://ask.sagemath.org/question/36618/memory-error-mixing-exact-numbers-and-decimal-ones/):
 
 ```
-sage: bool(sin(2*pi*(1.75-1.4)) > 0)
-sage: bool(sin(2*pi*(1.75-1.4)) > 0)
+sage: bool(sin(pi*RR("0.7000000000000002")) > 0)
 ---------------------------------------------------------------------------
 MemoryError                               Traceback (most recent call last)
 <ipython-input-19-4f7b466aff9f> in <module>()
``````




---

archive/issue_comments_422069.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2017-03-10T15:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422069",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_422070.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/weird_memory_error_while_approximating_sin\"",
    "created_at": "2017-03-10T15:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422070",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/weird_memory_error_while_approximating_sin"



---

archive/issue_comments_422071.json:
```json
{
    "body": "Changing commit from \"\" to \"e2fac195237f10bb39da40c489a1cba3ecaeff00\"",
    "created_at": "2017-03-10T15:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422071",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "e2fac195237f10bb39da40c489a1cba3ecaeff00"



---

archive/issue_comments_422072.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-10T15:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422072",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_422073.json:
```json
{
    "body": "<a id='comment:6'></a>\nNew commits:\n|                                                                                                                                          |                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[e2fac19](https://github.com/sagemath/sagetrac-mirror/commit/e2fac195237f10bb39da40c489a1cba3ecaeff00)|`Coerce (not convert) argument of exp() to rational`|",
    "created_at": "2017-03-10T15:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422073",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
New commits:
|                                                                                                                                          |                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[e2fac19](https://github.com/sagemath/sagetrac-mirror/commit/e2fac195237f10bb39da40c489a1cba3ecaeff00)|`Coerce (not convert) argument of exp() to rational`|



---

archive/issue_comments_422074.json:
```json
{
    "body": "<a id='comment:7'></a>\n> Never omit the traceback on Trac tickets, they usually contain very useful information!\n\n\nHaha!  Ordinarily I wouldn't, but in this case I didn't have time to do more than simply open the ticket with verbatim from the question so that there was a ticket at all.  Sorry!  Glad you could clear it up.",
    "created_at": "2017-03-10T16:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422074",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>
> Never omit the traceback on Trac tickets, they usually contain very useful information!


Haha!  Ordinarily I wouldn't, but in this case I didn't have time to do more than simply open the ticket with verbatim from the question so that there was a ticket at all.  Sorry!  Glad you could clear it up.



---

archive/issue_comments_422075.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ralf Stephan\"",
    "created_at": "2017-03-11T08:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422075",
    "user": "https://github.com/rwst"
}
```

Changing reviewer from "" to "Ralf Stephan"



---

archive/issue_comments_422076.json:
```json
{
    "body": "<a id='comment:8'></a>\nLooking good. Patchbot says fine.",
    "created_at": "2017-03-11T08:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422076",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>
Looking good. Patchbot says fine.



---

archive/issue_comments_422077.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-11T08:43:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422077",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_067015.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-12T17:16:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22571#event-67015"
}
```



---

archive/issue_comments_422078.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-12T17:16:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422078",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_422079.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/weird_memory_error_while_approximating_sin\" to \"e2fac195237f10bb39da40c489a1cba3ecaeff00\"",
    "created_at": "2017-03-12T17:16:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22571",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22571#issuecomment-422079",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/weird_memory_error_while_approximating_sin" to "e2fac195237f10bb39da40c489a1cba3ecaeff00"
