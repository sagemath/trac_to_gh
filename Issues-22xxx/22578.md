# Issue 22578: Polyhedron.bounding_box: New keyword argument integral_hull, use it in .integral_points

archive/issues_022341.json:
```json
{
    "body": "An amazing insight is that if one wants to know to bounding box of the integer points, rather than of all points, then one can round down upper bounds and round up lower bounds.\n\nThis can make a huge difference for integer points enumeration.\n\n\nCC:  @videlec @jplab @tscrim\n\nKeywords: days84, days85\n\nReviewer: Travis Scrimshaw\n\nAuthor: Matthias Koeppe\n\nBranch: 18e7a748198e1c3abc175b703a24d1010b8ee8cf\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22578\n\n",
    "closed_at": "2017-03-27T20:41:44Z",
    "created_at": "2017-03-10T16:41:22Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Polyhedron.bounding_box: New keyword argument integral_hull, use it in .integral_points",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22578",
    "user": "https://github.com/mkoeppe"
}
```
An amazing insight is that if one wants to know to bounding box of the integer points, rather than of all points, then one can round down upper bounds and round up lower bounds.

This can make a huge difference for integer points enumeration.


CC:  @videlec @jplab @tscrim

Keywords: days84, days85

Reviewer: Travis Scrimshaw

Author: Matthias Koeppe

Branch: 18e7a748198e1c3abc175b703a24d1010b8ee8cf

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22578





---

archive/issue_comments_419635.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/polyhedron_bounding_box__new_keyword_argument_integral_hull__use_it_it__integral_points\"",
    "created_at": "2017-03-10T16:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419635",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/polyhedron_bounding_box__new_keyword_argument_integral_hull__use_it_it__integral_points"



---

archive/issue_comments_419636.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                                                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|\n|[b82ac33](https://git.sagemath.org/sage.git/commit?id=b82ac33abb8e7db2340db42af4e9047834d3132f)|`22578: Polyhedron.bounding_box: New keyword argument integral_hull, use it it .integral_points`|",
    "created_at": "2017-03-10T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419636",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                                                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
|[b82ac33](https://git.sagemath.org/sage.git/commit?id=b82ac33abb8e7db2340db42af4e9047834d3132f)|`22578: Polyhedron.bounding_box: New keyword argument integral_hull, use it it .integral_points`|



---

archive/issue_comments_419637.json:
```json
{
    "body": "Changing commit from \"\" to \"b82ac33abb8e7db2340db42af4e9047834d3132f\"",
    "created_at": "2017-03-10T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419637",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "b82ac33abb8e7db2340db42af4e9047834d3132f"



---

archive/issue_comments_419638.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-10T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419638",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_419639.json:
```json
{
    "body": "Changing keywords from \"\" to \"days84\".",
    "created_at": "2017-03-10T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419639",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "days84".



---

archive/issue_comments_419640.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis causes doctest failures in sandpiles. My guess is something is now returning a `None` that is fed to a `zip`.",
    "created_at": "2017-03-14T19:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419640",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
This causes doctest failures in sandpiles. My guess is something is now returning a `None` that is fed to a `zip`.



---

archive/issue_comments_419641.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-14T19:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419641",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_419642.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks for catching this. I'm preparing a fix.",
    "created_at": "2017-03-14T20:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419642",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Thanks for catching this. I'm preparing a fix.



---

archive/issue_comments_419643.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                                                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|\n|[d08356c](https://git.sagemath.org/sage.git/commit/?id=d08356c2d40c486ada7099df864f965775f03778)|`22578: Polyhedron.bounding_box: New keyword argument integral_hull, use it it .integral_points`|\n|[486204f](https://git.sagemath.org/sage.git/commit/?id=486204f7e7a5ac5f14573e006f3d6464584ef6bd)|`Polyhedron.bounding_box: Handle empty bounding box`|",
    "created_at": "2017-03-14T23:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                                                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
|[d08356c](https://git.sagemath.org/sage.git/commit/?id=d08356c2d40c486ada7099df864f965775f03778)|`22578: Polyhedron.bounding_box: New keyword argument integral_hull, use it it .integral_points`|
|[486204f](https://git.sagemath.org/sage.git/commit/?id=486204f7e7a5ac5f14573e006f3d6464584ef6bd)|`Polyhedron.bounding_box: Handle empty bounding box`|



---

archive/issue_comments_419644.json:
```json
{
    "body": "Changing commit from \"b82ac33abb8e7db2340db42af4e9047834d3132f\" to \"486204f7e7a5ac5f14573e006f3d6464584ef6bd\"",
    "created_at": "2017-03-14T23:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419644",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b82ac33abb8e7db2340db42af4e9047834d3132f" to "486204f7e7a5ac5f14573e006f3d6464584ef6bd"



---

archive/issue_comments_419645.json:
```json
{
    "body": "<a id='comment:8'></a>\nFixed the failures that resulted from empty bounding boxes; \nbut there remain failures that result from different sorting orders of `integral_points`. \nShould I change all these doctests so that they become independent of the sorting order?",
    "created_at": "2017-03-14T23:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419645",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Fixed the failures that resulted from empty bounding boxes; 
but there remain failures that result from different sorting orders of `integral_points`. 
Should I change all these doctests so that they become independent of the sorting order?



---

archive/issue_comments_419646.json:
```json
{
    "body": "<a id='comment:9'></a>\nIf the output of `integral_points` is not subject to location in memory, then you don't have to. I'm prepared to set a positive review once addressed.",
    "created_at": "2017-03-14T23:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419646",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
If the output of `integral_points` is not subject to location in memory, then you don't have to. I'm prepared to set a positive review once addressed.



---

archive/issue_comments_419647.json:
```json
{
    "body": "Changing keywords from \"days84\" to \"days84, days85\".",
    "created_at": "2017-03-14T23:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419647",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "days84" to "days84, days85".



---

archive/issue_comments_419648.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2017-03-14T23:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419648",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_419649.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-15T02:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419649",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_419650.json:
```json
{
    "body": "<a id='comment:11'></a>\nIt looks like the order of some doctests in sandpiles have either changes or does depend on the machine/memory location (which is the case if they pass on your machine). I do agree that they are all trivial failures and can be easily fixed, but I just need an answer to which of the above cases we are in.",
    "created_at": "2017-03-15T22:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419650",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>
It looks like the order of some doctests in sandpiles have either changes or does depend on the machine/memory location (which is the case if they pass on your machine). I do agree that they are all trivial failures and can be easily fixed, but I just need an answer to which of the above cases we are in.



---

archive/issue_comments_419651.json:
```json
{
    "body": "<a id='comment:12'></a>\nI think the order has changed because a different enumeration strategy is selected. I don't think it's machine or address specific.\nIn my opinion, doctests should not rely on the order of lists whose ordering is unspecified by documentation; they should be rewritten using `sort` or `set`.",
    "created_at": "2017-03-15T22:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419651",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
I think the order has changed because a different enumeration strategy is selected. I don't think it's machine or address specific.
In my opinion, doctests should not rely on the order of lists whose ordering is unspecified by documentation; they should be rewritten using `sort` or `set`.



---

archive/issue_comments_419652.json:
```json
{
    "body": "<a id='comment:13'></a>\nIf you want to change the tests so that the order is sorted, go ahead. I would avoid using `set` since (unfortunately) the output may not be in a specific order. However, we can just change the output for now too. I can also make these changes if you want me to.",
    "created_at": "2017-03-16T21:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419652",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>
If you want to change the tests so that the order is sorted, go ahead. I would avoid using `set` since (unfortunately) the output may not be in a specific order. However, we can just change the output for now too. I can also make these changes if you want me to.



---

archive/issue_comments_419653.json:
```json
{
    "body": "<a id='comment:14'></a>\nI would strongly suggest to adjust the tests to use `sort` then; because it is very likely that future changes to the lattice point enumeration code (such as automatic selection of the normaliz backend if it is available) will change the order again. If you'd like to go ahead with this change, that would be great...",
    "created_at": "2017-03-16T21:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419653",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
I would strongly suggest to adjust the tests to use `sort` then; because it is very likely that future changes to the lattice point enumeration code (such as automatic selection of the normaliz backend if it is available) will change the order again. If you'd like to go ahead with this change, that would be great...



---

archive/issue_comments_419654.json:
```json
{
    "body": "<a id='comment:15'></a>\nI will do so now.",
    "created_at": "2017-03-16T21:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419654",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>
I will do so now.



---

archive/issue_comments_419655.json:
```json
{
    "body": "<a id='comment:16'></a>\nAll tests now pass, and they are now checked by sorting the output. If my changes look good to you, then you can set a positive review.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|\n|[18e7a74](https://git.sagemath.org/sage.git/commit?id=18e7a748198e1c3abc175b703a24d1010b8ee8cf)|`Fixing doctests and doing it so the order doesn't change in the future.`|",
    "created_at": "2017-03-16T22:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419655",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'></a>
All tests now pass, and they are now checked by sorting the output. If my changes look good to you, then you can set a positive review.

---
New commits:
|                                                                                                                                          |                                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
|[18e7a74](https://git.sagemath.org/sage.git/commit?id=18e7a748198e1c3abc175b703a24d1010b8ee8cf)|`Fixing doctests and doing it so the order doesn't change in the future.`|



---

archive/issue_comments_419656.json:
```json
{
    "body": "Changing commit from \"486204f7e7a5ac5f14573e006f3d6464584ef6bd\" to \"18e7a748198e1c3abc175b703a24d1010b8ee8cf\"",
    "created_at": "2017-03-16T22:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419656",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "486204f7e7a5ac5f14573e006f3d6464584ef6bd" to "18e7a748198e1c3abc175b703a24d1010b8ee8cf"



---

archive/issue_comments_419657.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/polyhedron_bounding_box__new_keyword_argument_integral_hull__use_it_it__integral_points\" to \"public/geometry/polyhedron_bounding_box_integer_hull-22578\"",
    "created_at": "2017-03-16T22:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419657",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "u/mkoeppe/polyhedron_bounding_box__new_keyword_argument_integral_hull__use_it_it__integral_points" to "public/geometry/polyhedron_bounding_box_integer_hull-22578"



---

archive/issue_comments_419658.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-16T22:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419658",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_419659.json:
```json
{
    "body": "<a id='comment:17'></a>\nLooks good. Thanks very much!",
    "created_at": "2017-03-16T22:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419659",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>
Looks good. Thanks very much!



---

archive/issue_comments_419660.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-27T20:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419660",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_419661.json:
```json
{
    "body": "Changing branch from \"public/geometry/polyhedron_bounding_box_integer_hull-22578\" to \"18e7a748198e1c3abc175b703a24d1010b8ee8cf\"",
    "created_at": "2017-03-27T20:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419661",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/geometry/polyhedron_bounding_box_integer_hull-22578" to "18e7a748198e1c3abc175b703a24d1010b8ee8cf"



---

archive/issue_events_058950.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-27T20:41:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22578#event-58950"
}
```



---

archive/issue_comments_419662.json:
```json
{
    "body": "Changing branch from \"18e7a748198e1c3abc175b703a24d1010b8ee8cf\" to \"u/jmantysalo/18e7a748198e1c3abc175b703a24d1010b8ee8cf\"",
    "created_at": "2017-04-05T05:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419662",
    "user": "https://github.com/jm58660"
}
```

Changing branch from "18e7a748198e1c3abc175b703a24d1010b8ee8cf" to "u/jmantysalo/18e7a748198e1c3abc175b703a24d1010b8ee8cf"



---

archive/issue_comments_419663.json:
```json
{
    "body": "Changing commit from \"18e7a748198e1c3abc175b703a24d1010b8ee8cf\" to \"\"",
    "created_at": "2017-04-05T05:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419663",
    "user": "https://github.com/jm58660"
}
```

Changing commit from "18e7a748198e1c3abc175b703a24d1010b8ee8cf" to ""



---

archive/issue_comments_419664.json:
```json
{
    "body": "Changing branch from \"u/jmantysalo/18e7a748198e1c3abc175b703a24d1010b8ee8cf\" to \"18e7a748198e1c3abc175b703a24d1010b8ee8cf\"",
    "created_at": "2017-04-05T05:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419664",
    "user": "https://github.com/jm58660"
}
```

Changing branch from "u/jmantysalo/18e7a748198e1c3abc175b703a24d1010b8ee8cf" to "18e7a748198e1c3abc175b703a24d1010b8ee8cf"



---

archive/issue_comments_419665.json:
```json
{
    "body": "<a id='comment:20'></a>\nSorry, my typo in a ticket number.",
    "created_at": "2017-04-05T05:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22578",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22578#issuecomment-419665",
    "user": "https://github.com/jm58660"
}
```

<a id='comment:20'></a>
Sorry, my typo in a ticket number.
