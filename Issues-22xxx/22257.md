# Issue 22257: py3: no cmp() in real lazy

archive/issues_022020.json:
```json
{
    "body": "as another step tp py3\n\nCC:  @tscrim @a-andre @jdemeyer @saraedum\n\nKeywords: days85\n\nBranch/Commit: [cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b](https://github.com/sagemath/sagetrac-mirror/commit/cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b)\n\nReviewer: Julian R\u00fcth, Dima Pasechnik, Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22257\n\n",
    "closed_at": "2017-04-11T22:22:53Z",
    "created_at": "2017-01-25T14:25:55Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "py3: no cmp() in real lazy",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22257",
    "user": "https://github.com/fchapoton"
}
```
as another step tp py3

CC:  @tscrim @a-andre @jdemeyer @saraedum

Keywords: days85

Branch/Commit: [cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b](https://github.com/sagemath/sagetrac-mirror/commit/cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b)

Reviewer: Julian Rüth, Dima Pasechnik, Travis Scrimshaw

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22257





---

archive/issue_comments_415304.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[6a919fa](https://github.com/sagemath/sagetrac-mirror/commit/6a919fa0cb113b648fd79001cd4ef1afbf30a40b)|`py3 : removal of cmp() in real_lazy`|",
    "created_at": "2017-01-25T14:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415304",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[6a919fa](https://github.com/sagemath/sagetrac-mirror/commit/6a919fa0cb113b648fd79001cd4ef1afbf30a40b)|`py3 : removal of cmp() in real_lazy`|



---

archive/issue_comments_415305.json:
```json
{
    "body": "Branch: [u/chapoton/22257](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257)",
    "created_at": "2017-01-25T14:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415305",
    "user": "https://github.com/fchapoton"
}
```

Branch: [u/chapoton/22257](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257)



---

archive/issue_comments_415306.json:
```json
{
    "body": "Commit: [6a919fa0cb113b648fd79001cd4ef1afbf30a40b](https://github.com/sagemath/sagetrac-mirror/commit/6a919fa0cb113b648fd79001cd4ef1afbf30a40b)",
    "created_at": "2017-01-25T14:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415306",
    "user": "https://github.com/fchapoton"
}
```

Commit: [6a919fa0cb113b648fd79001cd4ef1afbf30a40b](https://github.com/sagemath/sagetrac-mirror/commit/6a919fa0cb113b648fd79001cd4ef1afbf30a40b)



---

archive/issue_comments_415307.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-01-25T20:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415307",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_415308.json:
```json
{
    "body": "<a id='comment:2'></a>\nwaiting for the bots",
    "created_at": "2017-01-25T20:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415308",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
waiting for the bots



---

archive/issue_comments_415309.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-27T08:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415309",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_415310.json:
```json
{
    "body": "<a id='comment:4'></a>\nooch, this one is going to be more complicated than expected..",
    "created_at": "2017-01-27T12:42:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415310",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>
ooch, this one is going to be more complicated than expected..



---

archive/issue_comments_415311.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-01T08:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415311",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_415312.json:
```json
{
    "body": "<a id='comment:5'></a>\nhere is another try ; let us wait for the bots\n\n---\nNew commits:\n|                                                                                                                                          |                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[ec2ca43](https://github.com/sagemath/sagetrac-mirror/commit/ec2ca43788b988b3234a90ed64100540d9254c49)|`trac 22257 get rid of cmp(), second tentative`|",
    "created_at": "2017-02-01T08:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415312",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
here is another try ; let us wait for the bots

---
New commits:
|                                                                                                                                          |                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[ec2ca43](https://github.com/sagemath/sagetrac-mirror/commit/ec2ca43788b988b3234a90ed64100540d9254c49)|`trac 22257 get rid of cmp(), second tentative`|



---

archive/issue_comments_415313.json:
```json
{
    "body": "Changing branch from \"[u/chapoton/22257](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257)\" to \"[u/chapoton/22257v2](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v2)\"",
    "created_at": "2017-02-01T08:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415313",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "[u/chapoton/22257](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257)" to "[u/chapoton/22257v2](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v2)"



---

archive/issue_comments_415314.json:
```json
{
    "body": "Changing commit from \"[6a919fa0cb113b648fd79001cd4ef1afbf30a40b](https://github.com/sagemath/sagetrac-mirror/commit/6a919fa0cb113b648fd79001cd4ef1afbf30a40b)\" to \"[ec2ca43788b988b3234a90ed64100540d9254c49](https://github.com/sagemath/sagetrac-mirror/commit/ec2ca43788b988b3234a90ed64100540d9254c49)\"",
    "created_at": "2017-02-01T08:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415314",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "[6a919fa0cb113b648fd79001cd4ef1afbf30a40b](https://github.com/sagemath/sagetrac-mirror/commit/6a919fa0cb113b648fd79001cd4ef1afbf30a40b)" to "[ec2ca43788b988b3234a90ed64100540d9254c49](https://github.com/sagemath/sagetrac-mirror/commit/ec2ca43788b988b3234a90ed64100540d9254c49)"



---

archive/issue_comments_415315.json:
```json
{
    "body": "<a id='comment:6'></a>\nOooch, again. This is going to be *really* more complicated than expected.",
    "created_at": "2017-02-01T12:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415315",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
Oooch, again. This is going to be *really* more complicated than expected.



---

archive/issue_comments_415316.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-02-01T12:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415316",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_415317.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis triggers that:\n\n```\nsage: z4 = CyclotomicField(4).gen()\nsage: CDF(z4)\n0.0\n```\nI have not been able to understand why.",
    "created_at": "2017-02-23T13:22:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415317",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
This triggers that:

```
sage: z4 = CyclotomicField(4).gen()
sage: CDF(z4)
0.0
```
I have not been able to understand why.



---

archive/issue_comments_415318.json:
```json
{
    "body": "Changing commit from \"[ec2ca43788b988b3234a90ed64100540d9254c49](https://github.com/sagemath/sagetrac-mirror/commit/ec2ca43788b988b3234a90ed64100540d9254c49)\" to \"[efa77ed34e7c6dd33701b2d378db556e7fa27b82](https://github.com/sagemath/sagetrac-mirror/commit/efa77ed34e7c6dd33701b2d378db556e7fa27b82)\"",
    "created_at": "2017-03-08T16:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415318",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "[ec2ca43788b988b3234a90ed64100540d9254c49](https://github.com/sagemath/sagetrac-mirror/commit/ec2ca43788b988b3234a90ed64100540d9254c49)" to "[efa77ed34e7c6dd33701b2d378db556e7fa27b82](https://github.com/sagemath/sagetrac-mirror/commit/efa77ed34e7c6dd33701b2d378db556e7fa27b82)"



---

archive/issue_comments_415319.json:
```json
{
    "body": "Changing branch from \"[u/chapoton/22257v2](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v2)\" to \"[u/chapoton/22257v3](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v3)\"",
    "created_at": "2017-03-08T16:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415319",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "[u/chapoton/22257v2](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v2)" to "[u/chapoton/22257v3](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v3)"



---

archive/issue_comments_415320.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-08T16:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415320",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_415321.json:
```json
{
    "body": "<a id='comment:9'></a>\nanother try, let us wait for the patchbots\n\n---\nNew commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[6a919fa](https://github.com/sagemath/sagetrac-mirror/commit/6a919fa0cb113b648fd79001cd4ef1afbf30a40b)|`py3 : removal of cmp() in real_lazy`|\n|[9eb46b5](https://github.com/sagemath/sagetrac-mirror/commit/9eb46b53cec5934c49f3a9f0a0b71cce7a52eb4f)|`Merge branch 'u/chapoton/22257' in 7.6.b6`|\n|[efa77ed](https://github.com/sagemath/sagetrac-mirror/commit/efa77ed34e7c6dd33701b2d378db556e7fa27b82)|`trac 22257 fixing doctests`|",
    "created_at": "2017-03-08T16:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415321",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
another try, let us wait for the patchbots

---
New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[6a919fa](https://github.com/sagemath/sagetrac-mirror/commit/6a919fa0cb113b648fd79001cd4ef1afbf30a40b)|`py3 : removal of cmp() in real_lazy`|
|[9eb46b5](https://github.com/sagemath/sagetrac-mirror/commit/9eb46b53cec5934c49f3a9f0a0b71cce7a52eb4f)|`Merge branch 'u/chapoton/22257' in 7.6.b6`|
|[efa77ed](https://github.com/sagemath/sagetrac-mirror/commit/efa77ed34e7c6dd33701b2d378db556e7fa27b82)|`trac 22257 fixing doctests`|



---

archive/issue_comments_415322.json:
```json
{
    "body": "<a id='comment:10'></a>\nok, this almost works, apparently.\n\nCould some number-theorist please tell me if the failing doctest is really a failure ?",
    "created_at": "2017-03-08T19:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415322",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>
ok, this almost works, apparently.

Could some number-theorist please tell me if the failing doctest is really a failure ?



---

archive/issue_comments_415323.json:
```json
{
    "body": "<a id='comment:11'></a>\nWould this work instead:\n\n```\nreturn richcmp(left.endpoints(), right.endpoints(), op)\n```",
    "created_at": "2017-03-08T20:34:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415323",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
Would this work instead:

```
return richcmp(left.endpoints(), right.endpoints(), op)
```



---

archive/issue_comments_415324.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [chapoton](#comment%3A10):\n> ok, this almost works, apparently.\n> \n> Could some number-theorist please tell me if the failing doctest is really a failure ?\n\nCould you post here what the test is and what fails?  To save time.",
    "created_at": "2017-03-08T20:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415324",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:12'></a>
Replying to [chapoton](#comment%3A10):
> ok, this almost works, apparently.
> 
> Could some number-theorist please tell me if the failing doctest is really a failure ?

Could you post here what the test is and what fails?  To save time.



---

archive/issue_comments_415325.json:
```json
{
    "body": "<a id='comment:13'></a>\nYes, sure. Here is the existing doctest\n\n```\nsage: f = x^8 - 3*x^7 + 61/3*x^6 - 9*x^5 + 298*x^4 + 458*x^3 + 1875*x^2 + 4293*x + 3099\nsage: F1 = NumberField(f, 'z', embedding=-1.18126721294295 + 3.02858651117832j)\nsage: F2 = NumberField(f, 'z', embedding=-1.18126721294295 - 3.02858651117832j)\nsage: (F, map1, map2, k) = F1.composite_fields(F2, both_maps=True)[0]\nsage: F.degree()\n32\nsage: F.gen() == map2(F2.gen()) + k*map1(F1.gen())\nTrue\n```\nIt fails by answering instead that F has degree 8 (just as F1, F2), with 2 identity maps as  morphisms.",
    "created_at": "2017-03-08T20:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415325",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
Yes, sure. Here is the existing doctest

```
sage: f = x^8 - 3*x^7 + 61/3*x^6 - 9*x^5 + 298*x^4 + 458*x^3 + 1875*x^2 + 4293*x + 3099
sage: F1 = NumberField(f, 'z', embedding=-1.18126721294295 + 3.02858651117832j)
sage: F2 = NumberField(f, 'z', embedding=-1.18126721294295 - 3.02858651117832j)
sage: (F, map1, map2, k) = F1.composite_fields(F2, both_maps=True)[0]
sage: F.degree()
32
sage: F.gen() == map2(F2.gen()) + k*map1(F1.gen())
True
```
It fails by answering instead that F has degree 8 (just as F1, F2), with 2 identity maps as  morphisms.



---

archive/issue_comments_415326.json:
```json
{
    "body": "<a id='comment:14'></a>\nBut wait, it seems that this number theoretical doctest failure disappears with the latest change suggested by Jeroen.",
    "created_at": "2017-03-08T20:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415326",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>
But wait, it seems that this number theoretical doctest failure disappears with the latest change suggested by Jeroen.



---

archive/issue_comments_415327.json:
```json
{
    "body": "Changing commit from \"[efa77ed34e7c6dd33701b2d378db556e7fa27b82](https://github.com/sagemath/sagetrac-mirror/commit/efa77ed34e7c6dd33701b2d378db556e7fa27b82)\" to \"[e1f07ca74416008e8280700152ec90e6e6f6329e](https://github.com/sagemath/sagetrac-mirror/commit/e1f07ca74416008e8280700152ec90e6e6f6329e)\"",
    "created_at": "2017-03-08T20:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415327",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "[efa77ed34e7c6dd33701b2d378db556e7fa27b82](https://github.com/sagemath/sagetrac-mirror/commit/efa77ed34e7c6dd33701b2d378db556e7fa27b82)" to "[e1f07ca74416008e8280700152ec90e6e6f6329e](https://github.com/sagemath/sagetrac-mirror/commit/e1f07ca74416008e8280700152ec90e6e6f6329e)"



---

archive/issue_comments_415328.json:
```json
{
    "body": "<a id='comment:15'></a>\nlet me launch my patchbot on this new version\n\n---\nNew commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[e1f07ca](https://github.com/sagemath/sagetrac-mirror/commit/e1f07ca74416008e8280700152ec90e6e6f6329e)|`trac 22257  fixing back doctests`|",
    "created_at": "2017-03-08T20:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415328",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>
let me launch my patchbot on this new version

---
New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[e1f07ca](https://github.com/sagemath/sagetrac-mirror/commit/e1f07ca74416008e8280700152ec90e6e6f6329e)|`trac 22257  fixing back doctests`|



---

archive/issue_comments_415329.json:
```json
{
    "body": "Changing branch from \"[u/chapoton/22257v3](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v3)\" to \"[u/chapoton/22257v4](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v4)\"",
    "created_at": "2017-03-08T20:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415329",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "[u/chapoton/22257v3](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v3)" to "[u/chapoton/22257v4](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v4)"



---

archive/issue_comments_415330.json:
```json
{
    "body": "<a id='comment:16'></a>\nDegree 4 is certainly wrong since F1 contains only one root of f.  Over F1, f factors into degrees 1, 3, 4.  If the conjugate root is a root of the degree 4 factor then the degree of the composite would indeed be 8*4=32.  I did not check whether the conjugate is a root of the degree 3 factor; if it was, the composite would have degree 24.",
    "created_at": "2017-03-08T22:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415330",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:16'></a>
Degree 4 is certainly wrong since F1 contains only one root of f.  Over F1, f factors into degrees 1, 3, 4.  If the conjugate root is a root of the degree 4 factor then the degree of the composite would indeed be 8*4=32.  I did not check whether the conjugate is a root of the degree 3 factor; if it was, the composite would have degree 24.



---

archive/issue_comments_415331.json:
```json
{
    "body": "<a id='comment:17'></a>\nThank you, John and Jeroen.\n\nBot is now green, so please review. Turns out to be not so complicated, in the end.",
    "created_at": "2017-03-09T07:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415331",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>
Thank you, John and Jeroen.

Bot is now green, so please review. Turns out to be not so complicated, in the end.



---

archive/issue_comments_415332.json:
```json
{
    "body": "<a id='comment:18'></a>\nJust to confirm, I checked that after adjoining the first root, the second is a root of the degree 4 factor, so the compositum does have degree 8*4=32.",
    "created_at": "2017-03-09T09:30:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415332",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:18'></a>
Just to confirm, I checked that after adjoining the first root, the second is a root of the degree 4 factor, so the compositum does have degree 8*4=32.



---

archive/issue_comments_415333.json:
```json
{
    "body": "<a id='comment:19'></a>\nWhy do you need to add those `bool()` calls to various doctests?",
    "created_at": "2017-03-09T14:52:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415333",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
Why do you need to add those `bool()` calls to various doctests?



---

archive/issue_comments_415334.json:
```json
{
    "body": "<a id='comment:20'></a>\nYou don't need this:\n\n```\nfrom cpython.object cimport Py_EQ\n```",
    "created_at": "2017-03-09T14:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415334",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
You don't need this:

```
from cpython.object cimport Py_EQ
```



---

archive/issue_comments_415335.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-09T14:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415335",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_415336.json:
```json
{
    "body": "<a id='comment:21'></a>\nWhy this convoluted code\n\n```diff\n+        sage: x, y = xyz.xy()\n+        sage: max(abs(x - 6), abs(y + 15)) < 1e-14\n+        True\n```\ninstead of `abs_tol`?",
    "created_at": "2017-03-09T14:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415336",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Why this convoluted code

```diff
+        sage: x, y = xyz.xy()
+        sage: max(abs(x - 6), abs(y + 15)) < 1e-14
+        True
```
instead of `abs_tol`?



---

archive/issue_comments_415337.json:
```json
{
    "body": "Changing commit from \"[e1f07ca74416008e8280700152ec90e6e6f6329e](https://github.com/sagemath/sagetrac-mirror/commit/e1f07ca74416008e8280700152ec90e6e6f6329e)\" to \"[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)\"",
    "created_at": "2017-03-09T16:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415337",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[e1f07ca74416008e8280700152ec90e6e6f6329e](https://github.com/sagemath/sagetrac-mirror/commit/e1f07ca74416008e8280700152ec90e6e6f6329e)" to "[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)"



---

archive/issue_comments_415338.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|\n|[a93ded9](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)|`trac 22257 details`|",
    "created_at": "2017-03-09T16:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415338",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------|
|[a93ded9](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)|`trac 22257 details`|



---

archive/issue_comments_415339.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-09T16:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415339",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_415340.json:
```json
{
    "body": "<a id='comment:23'></a>\ndone.\n\nFor the added bool, they are necessary because otherwise one gets a symbolic equality. This is probably caused by a difference of behavior between cmp and richcmp in the symbolic ring (that we will have to handle at some point, for sure).",
    "created_at": "2017-03-09T16:06:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415340",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>
done.

For the added bool, they are necessary because otherwise one gets a symbolic equality. This is probably caused by a difference of behavior between cmp and richcmp in the symbolic ring (that we will have to handle at some point, for sure).



---

archive/issue_comments_415341.json:
```json
{
    "body": "<a id='comment:24'></a>\ngreen bot, please review",
    "created_at": "2017-03-10T07:37:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415341",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:24'></a>
green bot, please review



---

archive/issue_comments_415342.json:
```json
{
    "body": "<a id='comment:25'></a>\nping ?",
    "created_at": "2017-03-12T17:51:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415342",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:25'></a>
ping ?



---

archive/issue_comments_415343.json:
```json
{
    "body": "Reviewer: Julian R\u00fcth",
    "created_at": "2017-03-14T16:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415343",
    "user": "https://github.com/saraedum"
}
```

Reviewer: Julian Rüth



---

archive/issue_comments_415344.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2017-03-14T16:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415344",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_415345.json:
```json
{
    "body": "Changing keywords from \"\" to \"days85\".",
    "created_at": "2017-03-14T16:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415345",
    "user": "https://github.com/saraedum"
}
```

Changing keywords from "" to "days85".



---

archive/issue_comments_415346.json:
```json
{
    "body": "<a id='comment:26'></a>\nThis looks good. I don't really understand the `bool()` though. If we keep it like this, then code that compares elements of `RLF` is going to break, right?",
    "created_at": "2017-03-14T16:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415346",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:26'></a>
This looks good. I don't really understand the `bool()` though. If we keep it like this, then code that compares elements of `RLF` is going to break, right?



---

archive/issue_comments_415347.json:
```json
{
    "body": "<a id='comment:27'></a>\nno, because the bool will be called by the \"if\" or \"while\" or whatever uses it as a test. Only bare equalities will stay unevaluated.",
    "created_at": "2017-03-14T16:18:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415347",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:27'></a>
no, because the bool will be called by the "if" or "while" or whatever uses it as a test. Only bare equalities will stay unevaluated.



---

archive/issue_comments_415348.json:
```json
{
    "body": "<a id='comment:28'></a>\nWouldn't it be better to add the `bool` in `_richcmp_`?",
    "created_at": "2017-03-14T16:27:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415348",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
Wouldn't it be better to add the `bool` in `_richcmp_`?



---

archive/issue_comments_415349.json:
```json
{
    "body": "<a id='comment:29'></a>\nWell, this is only needed for lazy_numbers initialized from the Symbolic Ring.\n\nI would prefer to keep the bool where it is. This is really just a very tiny shadow of the fact that the symbolic ring has two different uses for cmp and richcmp. We will need to get rid of one of these at some point, but this is not the place to do so.",
    "created_at": "2017-03-14T16:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415349",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:29'></a>
Well, this is only needed for lazy_numbers initialized from the Symbolic Ring.

I would prefer to keep the bool where it is. This is really just a very tiny shadow of the fact that the symbolic ring has two different uses for cmp and richcmp. We will need to get rid of one of these at some point, but this is not the place to do so.



---

archive/issue_comments_415350.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [chapoton](#comment%3A29):\n> Well, this is only needed for lazy_numbers initialized from the Symbolic Ring.\n> \n> This is really just a very tiny shadow of the fact that the symbolic ring has two different uses for cmp and richcmp. We will need to get rid of one of these at some point, but this is not the place to do so.\n\n\nI agree with all of the above. Still, I don't like the fact that you are breaking `RLF(1) < RLF(sqrt(2))`.",
    "created_at": "2017-03-14T17:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415350",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Replying to [chapoton](#comment%3A29):
> Well, this is only needed for lazy_numbers initialized from the Symbolic Ring.
> 
> This is really just a very tiny shadow of the fact that the symbolic ring has two different uses for cmp and richcmp. We will need to get rid of one of these at some point, but this is not the place to do so.


I agree with all of the above. Still, I don't like the fact that you are breaking `RLF(1) < RLF(sqrt(2))`.



---

archive/issue_comments_415351.json:
```json
{
    "body": "<a id='comment:31'></a>\nOk, I see now. I think this is fine then. jdemeyer, please set this back to needs_work if you think that something needs to be done about the comparisons.",
    "created_at": "2017-03-14T19:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415351",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:31'></a>
Ok, I see now. I think this is fine then. jdemeyer, please set this back to needs_work if you think that something needs to be done about the comparisons.



---

archive/issue_comments_415352.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2017-03-14T19:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415352",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_415353.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [saraedum](#comment%3A31):\n> Ok, I see now. I think this is fine then. jdemeyer, please set this back to needs_work if you think that something needs to be done about the comparisons.\n\n\nWell, I *do* think that there is something to be fixed here. But I don't feel strongly enough about it to set the ticket back to needs_work.",
    "created_at": "2017-03-14T19:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415353",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>
Replying to [saraedum](#comment%3A31):
> Ok, I see now. I think this is fine then. jdemeyer, please set this back to needs_work if you think that something needs to be done about the comparisons.


Well, I *do* think that there is something to be fixed here. But I don't feel strongly enough about it to set the ticket back to needs_work.



---

archive/issue_comments_415354.json:
```json
{
    "body": "Changing branch from \"[u/chapoton/22257v4](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v4)\" to \"[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)\"",
    "created_at": "2017-03-27T20:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415354",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/chapoton/22257v4](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v4)" to "[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)"



---

archive/issue_comments_415355.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-27T20:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415355",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066450.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-03-27T20:42:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22257#event-66450"
}
```



---

archive/issue_comments_415356.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2017-03-27T22:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415356",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_415357.json:
```json
{
    "body": "<a id='comment:34'></a>\nOn OSX:\n\n```\nsage -t --long --warn-long 126.9 src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 3537, in sage.symbolic.expression.Expression._cmp_\nFailed example:\n    RealSet((0, pi),[pi, pi],(pi,4))\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.expression.Expression._cmp_[40]>\", line 1, in <module>\n        RealSet((Integer(0), pi),[pi, pi],(pi,Integer(4)))\n      File \"sage/misc/lazy_import.pyx\", line 389, in sage.misc.lazy_import.LazyImport.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/lazy_import.c:4007)\n        return self._get_object()(*args, **kwds)\n      File \"sage/misc/classcall_metaclass.pyx\", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1410)\n        return cls.classcall(cls, *args, **kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/sets/real_set.py\", line 644, in __classcall__\n        intervals.append(InternalRealInterval(lower, True, upper, True))\n      File \"sage/misc/classcall_metaclass.pyx\", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1410)\n        return cls.classcall(cls, *args, **kwds)\n      File \"sage/misc/cachefunc.pyx\", line 1059, in sage.misc.cachefunc.CachedFunction.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/cachefunc.c:6077)\n        w = self.f(*args, **kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/structure/unique_representation.py\", line 1022, in __classcall__\n        instance = typecall(cls, *args, **options)\n      File \"sage/misc/classcall_metaclass.pyx\", line 497, in sage.misc.classcall_metaclass.typecall (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1859)\n        return (<PyTypeObject*>type).tp_call(cls, args, kwds)\n      File \"/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/sets/real_set.py\", line 123, in __init__\n        raise ValueError('lower/upper bounds are not sorted')\n    ValueError: lower/upper bounds are not sorted\n**********************************************************************\n```",
    "created_at": "2017-03-27T22:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415357",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'></a>
On OSX:

```
sage -t --long --warn-long 126.9 src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 3537, in sage.symbolic.expression.Expression._cmp_
Failed example:
    RealSet((0, pi),[pi, pi],(pi,4))
Exception raised:
    Traceback (most recent call last):
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.expression.Expression._cmp_[40]>", line 1, in <module>
        RealSet((Integer(0), pi),[pi, pi],(pi,Integer(4)))
      File "sage/misc/lazy_import.pyx", line 389, in sage.misc.lazy_import.LazyImport.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/lazy_import.c:4007)
        return self._get_object()(*args, **kwds)
      File "sage/misc/classcall_metaclass.pyx", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1410)
        return cls.classcall(cls, *args, **kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/sets/real_set.py", line 644, in __classcall__
        intervals.append(InternalRealInterval(lower, True, upper, True))
      File "sage/misc/classcall_metaclass.pyx", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1410)
        return cls.classcall(cls, *args, **kwds)
      File "sage/misc/cachefunc.pyx", line 1059, in sage.misc.cachefunc.CachedFunction.__call__ (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/cachefunc.c:6077)
        w = self.f(*args, **kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/structure/unique_representation.py", line 1022, in __classcall__
        instance = typecall(cls, *args, **options)
      File "sage/misc/classcall_metaclass.pyx", line 497, in sage.misc.classcall_metaclass.typecall (/Users/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/misc/classcall_metaclass.c:1859)
        return (<PyTypeObject*>type).tp_call(cls, args, kwds)
      File "/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/sets/real_set.py", line 123, in __init__
        raise ValueError('lower/upper bounds are not sorted')
    ValueError: lower/upper bounds are not sorted
**********************************************************************
```



---

archive/issue_comments_415358.json:
```json
{
    "body": "Changing commit from \"[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)\" to \"\"",
    "created_at": "2017-03-27T22:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415358",
    "user": "https://github.com/vbraun"
}
```

Changing commit from "[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)" to ""



---

archive/issue_comments_415359.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2017-03-27T22:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415359",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_comments_415360.json:
```json
{
    "body": "<a id='comment:35'></a>\nhell ! I have no apple on which to debug that..",
    "created_at": "2017-03-28T15:58:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415360",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:35'></a>
hell ! I have no apple on which to debug that..



---

archive/issue_events_066451.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-28T16:02:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22257#event-66451"
}
```



---

archive/issue_comments_415361.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-30T11:57:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415361",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_415362.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-30T11:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415362",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_415363.json:
```json
{
    "body": "<a id='comment:39'></a>\nmay be related to #16035 ?",
    "created_at": "2017-03-30T20:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415363",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:39'></a>
may be related to #16035 ?



---

archive/issue_comments_415364.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [chapoton](#comment%3A35):\n> hell ! I have no apple on which to debug that..\n\n\nthis is perfectly reproducible on FreeBSD 11.0 with clang 3.8, as described in #22679\nFreeBSD 11 is some kind of approximation of OSX.\n\nI took the current branch there and merged your `u/chapoton/22257v4`.",
    "created_at": "2017-03-31T20:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415364",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:40'></a>
Replying to [chapoton](#comment%3A35):
> hell ! I have no apple on which to debug that..


this is perfectly reproducible on FreeBSD 11.0 with clang 3.8, as described in #22679
FreeBSD 11 is some kind of approximation of OSX.

I took the current branch there and merged your `u/chapoton/22257v4`.



---

archive/issue_comments_415365.json:
```json
{
    "body": "Changing branch from \"[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)\" to \"[u/chapoton/22257v4](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v4)\"",
    "created_at": "2017-03-31T20:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415365",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)" to "[u/chapoton/22257v4](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v4)"



---

archive/issue_comments_415366.json:
```json
{
    "body": "Commit: [a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)",
    "created_at": "2017-03-31T20:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415366",
    "user": "https://github.com/fchapoton"
}
```

Commit: [a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)



---

archive/issue_comments_415367.json:
```json
{
    "body": "<a id='comment:42'></a>\nI made a branch u/chapoton/22257v5 where the richcmp are wrapped with bool",
    "created_at": "2017-04-01T12:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415367",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:42'></a>
I made a branch u/chapoton/22257v5 where the richcmp are wrapped with bool



---

archive/issue_comments_415368.json:
```json
{
    "body": "<a id='comment:43'></a>\nThis really needs somebody with either osx or freebsd to do the debugging. Please help !",
    "created_at": "2017-04-04T19:17:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415368",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:43'></a>
This really needs somebody with either osx or freebsd to do the debugging. Please help !



---

archive/issue_comments_415369.json:
```json
{
    "body": "<a id='comment:44'></a>\nCould please at least someone with either a Mac or FreeBSD give me the result of the failing doctest above with the branch\n\nu/chapoton/22257_testing\n\napplied ?",
    "created_at": "2017-04-05T12:43:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415369",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:44'></a>
Could please at least someone with either a Mac or FreeBSD give me the result of the failing doctest above with the branch

u/chapoton/22257_testing

applied ?



---

archive/issue_comments_415370.json:
```json
{
    "body": "<a id='comment:45'></a>\nhere is FreeBSD with u/chapoton/22257_testing\n\n```\nsage -t --long --warn-long 41.0 src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 3537, in sage.symbolic.expression.Expression._cmp_\nFailed example:\n    RealSet((0, pi),[pi, pi],(pi,4))\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.expression.Expression._cmp_[40]>\", line 1, in <module>\n        RealSet((Integer(0), pi),[pi, pi],(pi,Integer(4)))\n      File \"sage/misc/lazy_import.pyx\", line 389, in sage.misc.lazy_import.LazyImport.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/lazy_import.c:4016)\n        return self._get_object()(*args, **kwds)\n      File \"sage/misc/classcall_metaclass.pyx\", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)\n        return cls.classcall(cls, *args, **kwds)\n      File \"/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/sets/real_set.py\", line 645, in __classcall__\n        intervals.append(InternalRealInterval(lower, True, upper, True))\n      File \"sage/misc/classcall_metaclass.pyx\", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)\n        return cls.classcall(cls, *args, **kwds)\n      File \"sage/misc/cachefunc.pyx\", line 1059, in sage.misc.cachefunc.CachedFunction.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/cachefunc.c:6086)\n        w = self.f(*args, **kwds)\n      File \"/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/structure/unique_representation.py\", line 1022, in __classcall__\n        instance = typecall(cls, *args, **options)\n      File \"sage/misc/classcall_metaclass.pyx\", line 497, in sage.misc.classcall_metaclass.typecall (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1864)\n        return (<PyTypeObject*>type).tp_call(cls, args, kwds)\n      File \"/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/sets/real_set.py\", line 124, in __init__\n        raise ValueError(msg.format(lower, upper))\n    ValueError: lower/upper bounds (3.141592653589794?/3.141592653589794?) are not sorted\n**********************************************************************\n1 item had failures:\n   1 of  44 in sage.symbolic.expression.Expression._cmp_\n    [2673 tests, 1 failure, 25.49 s]\n```",
    "created_at": "2017-04-05T19:15:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415370",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:45'></a>
here is FreeBSD with u/chapoton/22257_testing

```
sage -t --long --warn-long 41.0 src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 3537, in sage.symbolic.expression.Expression._cmp_
Failed example:
    RealSet((0, pi),[pi, pi],(pi,4))
Exception raised:
    Traceback (most recent call last):
      File "/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.expression.Expression._cmp_[40]>", line 1, in <module>
        RealSet((Integer(0), pi),[pi, pi],(pi,Integer(4)))
      File "sage/misc/lazy_import.pyx", line 389, in sage.misc.lazy_import.LazyImport.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/lazy_import.c:4016)
        return self._get_object()(*args, **kwds)
      File "sage/misc/classcall_metaclass.pyx", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)
        return cls.classcall(cls, *args, **kwds)
      File "/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/sets/real_set.py", line 645, in __classcall__
        intervals.append(InternalRealInterval(lower, True, upper, True))
      File "sage/misc/classcall_metaclass.pyx", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)
        return cls.classcall(cls, *args, **kwds)
      File "sage/misc/cachefunc.pyx", line 1059, in sage.misc.cachefunc.CachedFunction.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/cachefunc.c:6086)
        w = self.f(*args, **kwds)
      File "/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/structure/unique_representation.py", line 1022, in __classcall__
        instance = typecall(cls, *args, **options)
      File "sage/misc/classcall_metaclass.pyx", line 497, in sage.misc.classcall_metaclass.typecall (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1864)
        return (<PyTypeObject*>type).tp_call(cls, args, kwds)
      File "/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/sets/real_set.py", line 124, in __init__
        raise ValueError(msg.format(lower, upper))
    ValueError: lower/upper bounds (3.141592653589794?/3.141592653589794?) are not sorted
**********************************************************************
1 item had failures:
   1 of  44 in sage.symbolic.expression.Expression._cmp_
    [2673 tests, 1 failure, 25.49 s]
```



---

archive/issue_comments_415371.json:
```json
{
    "body": "<a id='comment:46'></a>\nThanks a lot, Dima ! So the problem is not coming from where Volker thought it could come..\n\nCould you just try `RealSet([pi, pi])` and `pi == pi` please ?",
    "created_at": "2017-04-05T19:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415371",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:46'></a>
Thanks a lot, Dima ! So the problem is not coming from where Volker thought it could come..

Could you just try `RealSet([pi, pi])` and `pi == pi` please ?



---

archive/issue_comments_415372.json:
```json
{
    "body": "<a id='comment:47'></a>\nAnd, just in case, that's what I have at the prompt with this branch applied:\n\n```\nsage: bool(pi-pi == 0)\nTrue\nsage: bool(pi-pi < 0)\nFalse\nsage: bool(pi-pi > 0)\nFalse\nsage: pi<pi\npi < pi\nsage: bool(pi<pi)\nTrue\nsage: bool(pi==pi)\nTrue\nsage: bool(pi>pi)\nTrue\nsage: bool(pi<4)\nTrue\nsage: bool(pi>4)\nFalse\n```\nfrom the point of view of numerical analysis, this all makes sense.\nOne cannot reliably compare floating point numbers for equality, and `pi` is just\na floating point number in disguise. So you compare two \"equal\" floating point numbers for equality, this won't fly...\n\nBut the following seems to make sense:\n\n```\nsage: bool(pi-pi == 0)\nTrue\nsage: bool(pi-pi < 0)\nFalse\nsage: bool(pi-pi > 0)\nFalse\n```\n(what happens is I suppose that pi-pi gets properly simplified to 0...)",
    "created_at": "2017-04-05T19:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415372",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:47'></a>
And, just in case, that's what I have at the prompt with this branch applied:

```
sage: bool(pi-pi == 0)
True
sage: bool(pi-pi < 0)
False
sage: bool(pi-pi > 0)
False
sage: pi<pi
pi < pi
sage: bool(pi<pi)
True
sage: bool(pi==pi)
True
sage: bool(pi>pi)
True
sage: bool(pi<4)
True
sage: bool(pi>4)
False
```
from the point of view of numerical analysis, this all makes sense.
One cannot reliably compare floating point numbers for equality, and `pi` is just
a floating point number in disguise. So you compare two "equal" floating point numbers for equality, this won't fly...

But the following seems to make sense:

```
sage: bool(pi-pi == 0)
True
sage: bool(pi-pi < 0)
False
sage: bool(pi-pi > 0)
False
```
(what happens is I suppose that pi-pi gets properly simplified to 0...)



---

archive/issue_comments_415373.json:
```json
{
    "body": "<a id='comment:48'></a>\n\n```\nsage: RealSet([pi, pi])\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-15-46f200bbe718> in <module>()\n----> 1 RealSet([pi, pi])\n\n/usr/home/dima/Sage/sage/src/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/lazy_import.c:4016)()\n    387             True\n    388         \"\"\"\n--> 389         return self._get_object()(*args, **kwds)\n    390 \n    391     def __repr__(self):\n\n/usr/home/dima/Sage/sage/src/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)()\n    328         \"\"\"\n    329         if cls.classcall is not None:\n--> 330             return cls.classcall(cls, *args, **kwds)\n    331         else:\n    332             # Fast version of type.__call__(cls, *args, **kwds)\n\n/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/sets/real_set.pyc in __classcall__(cls, *args)\n    643             elif isinstance(arg, list):\n    644                 lower, upper = RealSet._prep(*arg)\n--> 645                 intervals.append(InternalRealInterval(lower, True, upper, True))\n    646             elif isinstance(arg, InternalRealInterval):\n    647                 intervals.append(arg)\n\n/usr/home/dima/Sage/sage/src/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)()\n    328         \"\"\"\n    329         if cls.classcall is not None:\n--> 330             return cls.classcall(cls, *args, **kwds)\n    331         else:\n    332             # Fast version of type.__call__(cls, *args, **kwds)\n\n/usr/home/dima/Sage/sage/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedFunction.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/cachefunc.c:6086)()\n   1057                 return self.cache[k]\n   1058         except KeyError:\n-> 1059             w = self.f(*args, **kwds)\n   1060             self.cache[k] = w\n   1061             return w\n\n/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/structure/unique_representation.pyc in __classcall__(cls, *args, **options)\n   1020             True\n   1021         \"\"\"\n-> 1022         instance = typecall(cls, *args, **options)\n   1023         assert isinstance( instance, cls )\n   1024         if instance.__class__.__reduce__ == CachedRepresentation.__reduce__:\n\n/usr/home/dima/Sage/sage/src/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.typecall (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1864)()\n    495             TypeError: Argument 'cls' has incorrect type (expected type, got classobj)\n    496     \"\"\"\n--> 497     return (<PyTypeObject*>type).tp_call(cls, args, kwds)\n    498 \n    499 # Class for timing::\n\n/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/sets/real_set.pyc in __init__(self, lower, lower_closed, upper, upper_closed, check)\n    122             if not(lower is minus_infinity or upper is infinity) and lower > upper:\n    123                 msg = 'lower/upper bounds ({}/{}) are not sorted'\n--> 124                 raise ValueError(msg.format(lower, upper))\n    125             if (lower_closed and lower == minus_infinity):\n    126                 raise ValueError('interval cannot be closed at -oo')\n\nValueError: lower/upper bounds (3.141592653589794?/3.141592653589794?) are not sorted\n```",
    "created_at": "2017-04-05T19:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415373",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:48'></a>

```
sage: RealSet([pi, pi])
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-15-46f200bbe718> in <module>()
----> 1 RealSet([pi, pi])

/usr/home/dima/Sage/sage/src/sage/misc/lazy_import.pyx in sage.misc.lazy_import.LazyImport.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/lazy_import.c:4016)()
    387             True
    388         """
--> 389         return self._get_object()(*args, **kwds)
    390 
    391     def __repr__(self):

/usr/home/dima/Sage/sage/src/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)()
    328         """
    329         if cls.classcall is not None:
--> 330             return cls.classcall(cls, *args, **kwds)
    331         else:
    332             # Fast version of type.__call__(cls, *args, **kwds)

/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/sets/real_set.pyc in __classcall__(cls, *args)
    643             elif isinstance(arg, list):
    644                 lower, upper = RealSet._prep(*arg)
--> 645                 intervals.append(InternalRealInterval(lower, True, upper, True))
    646             elif isinstance(arg, InternalRealInterval):
    647                 intervals.append(arg)

/usr/home/dima/Sage/sage/src/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)()
    328         """
    329         if cls.classcall is not None:
--> 330             return cls.classcall(cls, *args, **kwds)
    331         else:
    332             # Fast version of type.__call__(cls, *args, **kwds)

/usr/home/dima/Sage/sage/src/sage/misc/cachefunc.pyx in sage.misc.cachefunc.CachedFunction.__call__ (/home/dima/Sage/sage/src/build/cythonized/sage/misc/cachefunc.c:6086)()
   1057                 return self.cache[k]
   1058         except KeyError:
-> 1059             w = self.f(*args, **kwds)
   1060             self.cache[k] = w
   1061             return w

/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/structure/unique_representation.pyc in __classcall__(cls, *args, **options)
   1020             True
   1021         """
-> 1022         instance = typecall(cls, *args, **options)
   1023         assert isinstance( instance, cls )
   1024         if instance.__class__.__reduce__ == CachedRepresentation.__reduce__:

/usr/home/dima/Sage/sage/src/sage/misc/classcall_metaclass.pyx in sage.misc.classcall_metaclass.typecall (/home/dima/Sage/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1864)()
    495             TypeError: Argument 'cls' has incorrect type (expected type, got classobj)
    496     """
--> 497     return (<PyTypeObject*>type).tp_call(cls, args, kwds)
    498 
    499 # Class for timing::

/usr/home/dima/Sage/sage/local/lib/python2.7/site-packages/sage/sets/real_set.pyc in __init__(self, lower, lower_closed, upper, upper_closed, check)
    122             if not(lower is minus_infinity or upper is infinity) and lower > upper:
    123                 msg = 'lower/upper bounds ({}/{}) are not sorted'
--> 124                 raise ValueError(msg.format(lower, upper))
    125             if (lower_closed and lower == minus_infinity):
    126                 raise ValueError('interval cannot be closed at -oo')

ValueError: lower/upper bounds (3.141592653589794?/3.141592653589794?) are not sorted
```



---

archive/issue_comments_415374.json:
```json
{
    "body": "<a id='comment:49'></a>\nok, so the problem is here:\n\n```\nsage: bool(pi>pi)\nTrue\n```\nwhich is not the normal behaviour. I get `False` with the same branch.\n\nOne possible solution (not solving the real issue) would be to replace the test \u0300`lower > upper` by `lower - upper > 0`.",
    "created_at": "2017-04-05T19:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415374",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:49'></a>
ok, so the problem is here:

```
sage: bool(pi>pi)
True
```
which is not the normal behaviour. I get `False` with the same branch.

One possible solution (not solving the real issue) would be to replace the test ̀`lower > upper` by `lower - upper > 0`.



---

archive/issue_comments_415375.json:
```json
{
    "body": "<a id='comment:50'></a>\nBy the way, Dima, could you please check the status of #16035 and report there ?",
    "created_at": "2017-04-05T19:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415375",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:50'></a>
By the way, Dima, could you please check the status of #16035 and report there ?



---

archive/issue_comments_415376.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [chapoton](#comment%3A50):\n> By the way, Dima, could you please check the status of #16035 and report there ?\n\n\njust did; no problem in my setup.",
    "created_at": "2017-04-05T19:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415376",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:51'></a>
Replying to [chapoton](#comment%3A50):
> By the way, Dima, could you please check the status of #16035 and report there ?


just did; no problem in my setup.



---

archive/issue_comments_415377.json:
```json
{
    "body": "<a id='comment:52'></a>\nThanks. Could you please tell me what happens with\n\n```\nbool(e < e)\n```\nand\n\n```\nbool(sqrt(2) < sqrt(2))\n```\nJust to be sure we really have located the problem..",
    "created_at": "2017-04-05T19:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415377",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:52'></a>
Thanks. Could you please tell me what happens with

```
bool(e < e)
```
and

```
bool(sqrt(2) < sqrt(2))
```
Just to be sure we really have located the problem..



---

archive/issue_comments_415378.json:
```json
{
    "body": "<a id='comment:53'></a>\n\n```\nsage: e<e\ne < e\nsage: bool(e<e)\nFalse\nsage: bool(e>e)\nFalse\nsage: bool(e==e)\nTrue\nsage: type(e)\n<type 'sage.symbolic.constants_c.E'>\nsage: type(pi)\n<type 'sage.symbolic.expression.Expression'>\nsage: type(sqrt(2))\n<type 'sage.symbolic.expression.Expression'>\nsage: sqrt(2)==sqrt(2)\nsqrt(2) == sqrt(2)\nsage: sqrt(2)<sqrt(2)\nsqrt(2) < sqrt(2)\nsage: bool(sqrt(2)<sqrt(2))\nFalse\nsage: bool(sqrt(2)==sqrt(2))\nTrue\nsage: bool(sqrt(2)>sqrt(2))\nFalse\n```\n\nI wonder why `pi` is not of type `sage.symbolic.constants_c.E`, while `e` is.\nThe latter explains why these comparison tests work.\n\nWith `pi` vs `sqrt(2)`, apparently simplification works better with algebraic numbers than with transcendentals.",
    "created_at": "2017-04-05T20:12:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415378",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:53'></a>

```
sage: e<e
e < e
sage: bool(e<e)
False
sage: bool(e>e)
False
sage: bool(e==e)
True
sage: type(e)
<type 'sage.symbolic.constants_c.E'>
sage: type(pi)
<type 'sage.symbolic.expression.Expression'>
sage: type(sqrt(2))
<type 'sage.symbolic.expression.Expression'>
sage: sqrt(2)==sqrt(2)
sqrt(2) == sqrt(2)
sage: sqrt(2)<sqrt(2)
sqrt(2) < sqrt(2)
sage: bool(sqrt(2)<sqrt(2))
False
sage: bool(sqrt(2)==sqrt(2))
True
sage: bool(sqrt(2)>sqrt(2))
False
```

I wonder why `pi` is not of type `sage.symbolic.constants_c.E`, while `e` is.
The latter explains why these comparison tests work.

With `pi` vs `sqrt(2)`, apparently simplification works better with algebraic numbers than with transcendentals.



---

archive/issue_comments_415379.json:
```json
{
    "body": "<a id='comment:54'></a>\ngood. So the problem is specific to pi and other similar constants.\nCould you please try\n\n```\nsage: from sage.symbolic.constants import Pi\nsage: mypi = Pi()\nsage: mypi.__lt__(pi)\npi > 3.141592653589793\nsage: bool(_)\nFalse\n```\nand\n\n```\nsage: bool(euler_gamma < euler_gamma)\nFalse\n```",
    "created_at": "2017-04-05T20:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415379",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:54'></a>
good. So the problem is specific to pi and other similar constants.
Could you please try

```
sage: from sage.symbolic.constants import Pi
sage: mypi = Pi()
sage: mypi.__lt__(pi)
pi > 3.141592653589793
sage: bool(_)
False
```
and

```
sage: bool(euler_gamma < euler_gamma)
False
```



---

archive/issue_comments_415380.json:
```json
{
    "body": "<a id='comment:55'></a>\nReplying to [chapoton](#comment%3A54):\n> good. So the problem is specific to pi and other similar constants.\n> Could you please try\n> \n> ```\n> sage: from sage.symbolic.constants import Pi\n> sage: mypi = Pi()\n> sage: mypi.__lt__(pi)\n> pi > 3.141592653589793\n> sage: bool(_)\n> False\n> ```\n\nthis is OK.\n\n> and\n> \n> ```\n> sage: bool(euler_gamma < euler_gamma)\n> False\n> ```\n\nno, this is not\n\n```\nsage: bool(euler_gamma < euler_gamma)\nTrue\nsage: bool(euler_gamma > euler_gamma)\nTrue\nsage: bool(euler_gamma == euler_gamma)\nTrue\nsage: type(euler_gamma)\n<type 'sage.symbolic.expression.Expression'>\n```\nso `euler_gamma` is as bad as `pi` here.",
    "created_at": "2017-04-05T20:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415380",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:55'></a>
Replying to [chapoton](#comment%3A54):
> good. So the problem is specific to pi and other similar constants.
> Could you please try
> 
> ```
> sage: from sage.symbolic.constants import Pi
> sage: mypi = Pi()
> sage: mypi.__lt__(pi)
> pi > 3.141592653589793
> sage: bool(_)
> False
> ```

this is OK.

> and
> 
> ```
> sage: bool(euler_gamma < euler_gamma)
> False
> ```

no, this is not

```
sage: bool(euler_gamma < euler_gamma)
True
sage: bool(euler_gamma > euler_gamma)
True
sage: bool(euler_gamma == euler_gamma)
True
sage: type(euler_gamma)
<type 'sage.symbolic.expression.Expression'>
```
so `euler_gamma` is as bad as `pi` here.



---

archive/issue_comments_415381.json:
```json
{
    "body": "<a id='comment:56'></a>\nHere is a new tentative. Dima, when you can, could you try with this branch (u/chapoton/22257v6), please ?\n\n---\nNew commits:\n|                                                                                                                                          |                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[00fc3f1](https://github.com/sagemath/sagetrac-mirror/commit/00fc3f19e71fe4f832e6fd310b21dd1ddde057e5)|`Merge branch 'u/chapoton/22257v4' in 8.0.b0`|\n|[cec557e](https://github.com/sagemath/sagetrac-mirror/commit/cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b)|`trac 22257 trying to fix comparison pi < pi issue on osx`|",
    "created_at": "2017-04-06T07:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415381",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:56'></a>
Here is a new tentative. Dima, when you can, could you try with this branch (u/chapoton/22257v6), please ?

---
New commits:
|                                                                                                                                          |                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[00fc3f1](https://github.com/sagemath/sagetrac-mirror/commit/00fc3f19e71fe4f832e6fd310b21dd1ddde057e5)|`Merge branch 'u/chapoton/22257v4' in 8.0.b0`|
|[cec557e](https://github.com/sagemath/sagetrac-mirror/commit/cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b)|`trac 22257 trying to fix comparison pi < pi issue on osx`|



---

archive/issue_comments_415382.json:
```json
{
    "body": "Changing commit from \"[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)\" to \"[cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b](https://github.com/sagemath/sagetrac-mirror/commit/cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b)\"",
    "created_at": "2017-04-06T07:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415382",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "[a93ded97cb0210c094a361f671b315f9c8cc7615](https://github.com/sagemath/sagetrac-mirror/commit/a93ded97cb0210c094a361f671b315f9c8cc7615)" to "[cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b](https://github.com/sagemath/sagetrac-mirror/commit/cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b)"



---

archive/issue_comments_415383.json:
```json
{
    "body": "Changing branch from \"[u/chapoton/22257v4](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v4)\" to \"[u/chapoton/22257v6](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v6)\"",
    "created_at": "2017-04-06T07:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415383",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "[u/chapoton/22257v4](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v4)" to "[u/chapoton/22257v6](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v6)"



---

archive/issue_comments_415384.json:
```json
{
    "body": "<a id='comment:57'></a>\nok, at least the patchbot is still green on linux.",
    "created_at": "2017-04-06T09:50:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415384",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:57'></a>
ok, at least the patchbot is still green on linux.



---

archive/issue_comments_415385.json:
```json
{
    "body": "<a id='comment:58'></a>\nOK, `u/chapoton/22257v6` passes the long tests in `src/sage/symbolic/expression.pyx`.\nAnd the following also looks sane:\n\n```\nsage: pi<pi\npi < pi\nsage: bool(pi<pi)\nFalse\nsage: bool(pi>pi)\nFalse\nsage: bool(pi==pi)\nTrue\n```",
    "created_at": "2017-04-06T21:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415385",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:58'></a>
OK, `u/chapoton/22257v6` passes the long tests in `src/sage/symbolic/expression.pyx`.
And the following also looks sane:

```
sage: pi<pi
pi < pi
sage: bool(pi<pi)
False
sage: bool(pi>pi)
False
sage: bool(pi==pi)
True
```



---

archive/issue_comments_415386.json:
```json
{
    "body": "<a id='comment:59'></a>\nok, then let me ask again for a review",
    "created_at": "2017-04-07T06:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415386",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:59'></a>
ok, then let me ask again for a review



---

archive/issue_comments_415387.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-04-07T06:36:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415387",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_415388.json:
```json
{
    "body": "<a id='comment:60'></a>\nGreen bot on linux and should be ok also on macosx.\n\nThe only change compared to the previously \"positive-reviewed\" branch is the removal of the method `__lt__` in the class `Constant` inside the file `constants.py`. Some doctests have also been added in expressions.pyx.\n\nThis means that comparison with pi and similar constants will be handled (in a better way) by the general comparison of expressions.\n\nOnce again, this is currently the point where python3 compilation fails. And this is needed to go forward, with next step being 22297.\n\nPlease review!",
    "created_at": "2017-04-07T11:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415388",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:60'></a>
Green bot on linux and should be ok also on macosx.

The only change compared to the previously "positive-reviewed" branch is the removal of the method `__lt__` in the class `Constant` inside the file `constants.py`. Some doctests have also been added in expressions.pyx.

This means that comparison with pi and similar constants will be handled (in a better way) by the general comparison of expressions.

Once again, this is currently the point where python3 compilation fails. And this is needed to go forward, with next step being 22297.

Please review!



---

archive/issue_comments_415389.json:
```json
{
    "body": "<a id='comment:61'></a>\n**ping** ?",
    "created_at": "2017-04-09T06:30:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415389",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:61'></a>
**ping** ?



---

archive/issue_comments_415390.json:
```json
{
    "body": "Changing reviewer from \"Julian R\u00fcth\" to \"Julian R\u00fcth, Dima Pasechnik, Travis Scrimshaw\"",
    "created_at": "2017-04-09T15:34:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415390",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "Julian Rüth" to "Julian Rüth, Dima Pasechnik, Travis Scrimshaw"



---

archive/issue_comments_415391.json:
```json
{
    "body": "<a id='comment:62'></a>\nI'm good sending this back to the buildbots.",
    "created_at": "2017-04-09T15:34:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415391",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:62'></a>
I'm good sending this back to the buildbots.



---

archive/issue_comments_415392.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-09T15:34:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415392",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_415393.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-11T22:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415393",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066452.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-11T22:22:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22257#event-66452"
}
```



---

archive/issue_comments_415394.json:
```json
{
    "body": "Changing branch from \"[u/chapoton/22257v6](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v6)\" to \"[cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b](https://github.com/sagemath/sagetrac-mirror/commit/cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b)\"",
    "created_at": "2017-04-11T22:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22257",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22257#issuecomment-415394",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/chapoton/22257v6](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22257v6)" to "[cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b](https://github.com/sagemath/sagetrac-mirror/commit/cec557e14b81b1e0b08c32eb77ac471ecbf9fb2b)"
