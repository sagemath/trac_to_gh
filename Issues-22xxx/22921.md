# Issue 22921: Implementation of shifted tableaux

archive/issues_022684.json:
```json
{
    "body": "This ticket implements a new class for shifted primed tableaux, and an A-type crystal for those objects.\n\n\nAssignee: kbparamonov\n\nCC:  @tscrim kbparamonov hawkes @anneschilling @mantepse @AndrewAtLarge\n\nKeywords: shifted primed tableaux, crystals\n\nBranch/Commit: bf7e707c6764952aeca7f2b81331cb6b6eed1738\n\nReviewer: Anne Schilling, Travis Scrimshaw, Martin Rubey\n\nAuthor: Kirill Paramonov\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22921\n\n",
    "closed_at": "2018-02-03T17:50:13Z",
    "created_at": "2017-05-01T19:38:43Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Implementation of shifted tableaux",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22921",
    "user": "https://github.com/anneschilling"
}
```
This ticket implements a new class for shifted primed tableaux, and an A-type crystal for those objects.


Assignee: kbparamonov

CC:  @tscrim kbparamonov hawkes @anneschilling @mantepse @AndrewAtLarge

Keywords: shifted primed tableaux, crystals

Branch/Commit: bf7e707c6764952aeca7f2b81331cb6b6eed1738

Reviewer: Anne Schilling, Travis Scrimshaw, Martin Rubey

Author: Kirill Paramonov

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22921





---

archive/issue_comments_315985.json:
```json
{
    "body": "<a id='comment:1'></a>See #20041.",
    "created_at": "2017-05-01T20:26:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315985",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>See #20041.



---

archive/issue_comments_315986.json:
```json
{
    "body": "Set assignee to kbparamonov.",
    "created_at": "2017-05-04T18:55:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315986",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

Set assignee to kbparamonov.



---

archive/issue_comments_315987.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-20T18:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315988.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-28T00:51:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315988",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315989.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-28T02:39:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315989",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315990.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-05T03:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315991.json:
```json
{
    "body": "<a id='comment:11'></a>Looking at the code, I do not think it is necessary to implement a new class for StrictPartitions. You can access those using the already existing Partitions code:\n\n```\nsage: Partitions(7, max_slope=-1).list()\n[[7], [6, 1], [5, 2], [4, 3], [4, 2, 1]]\n```\nPlease also make sure that you stick to the Sage coding conventions described here\n\u200bhttp://doc.sagemath.org/html/en/developer/coding_basics.html",
    "created_at": "2017-06-10T00:55:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315991",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:11'></a>Looking at the code, I do not think it is necessary to implement a new class for StrictPartitions. You can access those using the already existing Partitions code:

```
sage: Partitions(7, max_slope=-1).list()
[[7], [6, 1], [5, 2], [4, 3], [4, 2, 1]]
```
Please also make sure that you stick to the Sage coding conventions described here
​http://doc.sagemath.org/html/en/developer/coding_basics.html



---

archive/issue_comments_315992.json:
```json
{
    "body": "<a id='comment:12'></a>I still get many doctest failures (here are two, but there are many more):\n\n```\nsage -t tableau_shifted_primed.py\n**********************************************************************\nFile \"tableau_shifted_primed.py\", line 43, in sage.combinat.tableau_shifted_primed.ShiftedPrimedTableau\nFailed example:\n    T([[1,\"2'\",\"3'\",3],[2,\"3'\"]])[1]\nException raised:\n    Traceback (most recent call last):\n      File \"/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.tableau_shifted_primed.ShiftedPrimedTableau[1]>\", line 1, in <module>\n        T([[Integer(1),\"2'\",\"3'\",Integer(3)],[Integer(2),\"3'\"]])[Integer(1)]\n      File \"sage/structure/parent.pyx\", line 941, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9839)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:4895)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:4762)\n        return C._element_constructor(x)\n      File \"/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/tableau_shifted_primed.py\", line 904, in _element_constructor_\n        raise ValueError(\"{} is not an element of {}\".format(t, self))\n    ValueError: [[1, \"2'\", \"3'\", 3], [2, \"3'\"]] is not an element of Shifted Primed tableaux of shape [4, 2]\n**********************************************************************\nFile \"tableau_shifted_primed.py\", line 45, in sage.combinat.tableau_shifted_primed.ShiftedPrimedTableau\nFailed example:\n    t = ShiftedPrimedTableau([[1,\"2p\",2.5,3],[0,2,2.5]])\nException raised:\n    Traceback (most recent call last):\n      File \"/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.combinat.tableau_shifted_primed.ShiftedPrimedTableau[2]>\", line 1, in <module>\n        t = ShiftedPrimedTableau([[Integer(1),\"2p\",RealNumber('2.5'),Integer(3)],[Integer(0),Integer(2),RealNumber('2.5')]])\n      File \"sage/misc/lazy_import.pyx\", line 389, in sage.misc.lazy_import.LazyImport.__call__ (/Applications/sage/src/build/cythonized/sage/misc/lazy_import.c:4016)\n        return self._get_object()(*args, **kwds)\n      File \"sage/misc/classcall_metaclass.pyx\", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/Applications/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)\n        return cls.classcall(cls, *args, **kwds)\n      File \"/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/tableau_shifted_primed.py\", line 86, in __classcall_private__\n        return ShiftedPrimedTableaux(shape = shape, weight = weight)(T)\n      File \"sage/structure/parent.pyx\", line 941, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9839)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:4895)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:4762)\n        return C._element_constructor(x)\n      File \"/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/tableau_shifted_primed.py\", line 1004, in _element_constructor_\n        raise ValueError(\"{} is not an element of {}\".format(t, self))\n    ValueError: [[1, '2p', 2.50000000000000, 3], [0, 2, 2.50000000000000]] is not an element of Shifted Primed Tableaux of weight (1, 4, 1) and shape [4, 2]\n```",
    "created_at": "2017-06-13T03:44:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315992",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:12'></a>I still get many doctest failures (here are two, but there are many more):

```
sage -t tableau_shifted_primed.py
**********************************************************************
File "tableau_shifted_primed.py", line 43, in sage.combinat.tableau_shifted_primed.ShiftedPrimedTableau
Failed example:
    T([[1,"2'","3'",3],[2,"3'"]])[1]
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.tableau_shifted_primed.ShiftedPrimedTableau[1]>", line 1, in <module>
        T([[Integer(1),"2'","3'",Integer(3)],[Integer(2),"3'"]])[Integer(1)]
      File "sage/structure/parent.pyx", line 941, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9839)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:4895)
        raise
      File "sage/structure/coerce_maps.pyx", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:4762)
        return C._element_constructor(x)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/tableau_shifted_primed.py", line 904, in _element_constructor_
        raise ValueError("{} is not an element of {}".format(t, self))
    ValueError: [[1, "2'", "3'", 3], [2, "3'"]] is not an element of Shifted Primed tableaux of shape [4, 2]
**********************************************************************
File "tableau_shifted_primed.py", line 45, in sage.combinat.tableau_shifted_primed.ShiftedPrimedTableau
Failed example:
    t = ShiftedPrimedTableau([[1,"2p",2.5,3],[0,2,2.5]])
Exception raised:
    Traceback (most recent call last):
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.tableau_shifted_primed.ShiftedPrimedTableau[2]>", line 1, in <module>
        t = ShiftedPrimedTableau([[Integer(1),"2p",RealNumber('2.5'),Integer(3)],[Integer(0),Integer(2),RealNumber('2.5')]])
      File "sage/misc/lazy_import.pyx", line 389, in sage.misc.lazy_import.LazyImport.__call__ (/Applications/sage/src/build/cythonized/sage/misc/lazy_import.c:4016)
        return self._get_object()(*args, **kwds)
      File "sage/misc/classcall_metaclass.pyx", line 330, in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (/Applications/sage/src/build/cythonized/sage/misc/classcall_metaclass.c:1415)
        return cls.classcall(cls, *args, **kwds)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/tableau_shifted_primed.py", line 86, in __classcall_private__
        return ShiftedPrimedTableaux(shape = shape, weight = weight)(T)
      File "sage/structure/parent.pyx", line 941, in sage.structure.parent.Parent.__call__ (/Applications/sage/src/build/cythonized/sage/structure/parent.c:9839)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 110, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:4895)
        raise
      File "sage/structure/coerce_maps.pyx", line 105, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (/Applications/sage/src/build/cythonized/sage/structure/coerce_maps.c:4762)
        return C._element_constructor(x)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/combinat/tableau_shifted_primed.py", line 1004, in _element_constructor_
        raise ValueError("{} is not an element of {}".format(t, self))
    ValueError: [[1, '2p', 2.50000000000000, 3], [0, 2, 2.50000000000000]] is not an element of Shifted Primed Tableaux of weight (1, 4, 1) and shape [4, 2]
```



---

archive/issue_comments_315993.json:
```json
{
    "body": "<a id='comment:13'></a>Here are some more trivial comments:\n\n- you need a blank line before and after EXAMPLES::\n\n- Returnes -> Return (several times)\n\n- you need a blank line after the one-line description of a given method\n\n- you need a 4-space indent of the code for each EXAMPLES::\n  This indent is sometimes missing.\n\n- EXAMPE: -> EXAMPLES::\n\n- There is still some documentation missing for some of the methods",
    "created_at": "2017-06-13T03:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315993",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:13'></a>Here are some more trivial comments:

- you need a blank line before and after EXAMPLES::

- Returnes -> Return (several times)

- you need a blank line after the one-line description of a given method

- you need a 4-space indent of the code for each EXAMPLES::
  This indent is sometimes missing.

- EXAMPE: -> EXAMPLES::

- There is still some documentation missing for some of the methods



---

archive/issue_comments_315994.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-20T00:11:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315994",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315995.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-24T06:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315995",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315996.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-24T07:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315996",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315997.json:
```json
{
    "body": "<a id='comment:17'></a>In #23319 I have just implemented a growth diagram version of the insertion algorithm...",
    "created_at": "2017-06-25T13:39:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315997",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:17'></a>In #23319 I have just implemented a growth diagram version of the insertion algorithm...



---

archive/issue_comments_315998.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-09T21:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315998",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_315999.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-19T21:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-315999",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316000.json:
```json
{
    "body": "<a id='comment:20'></a>It would be nice to get this in, so we can have the following from #23896\n\n```\nsage: G = GrowthDiagramShiftedShapes([5, 10, 8, 7, 4, 1, 2, 9, 3, 6])\nsage: G.P_symbol().pp()\n 1   2   3   6   9\n     4   5   7\n         8   10\n\nsage: G.Q_symbol().pp()\n1   2   4'  5'  6'\n    3   7'  8\n        9   10\n```",
    "created_at": "2017-09-19T21:52:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316000",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:20'></a>It would be nice to get this in, so we can have the following from #23896

```
sage: G = GrowthDiagramShiftedShapes([5, 10, 8, 7, 4, 1, 2, 9, 3, 6])
sage: G.P_symbol().pp()
 1   2   3   6   9
     4   5   7
         8   10

sage: G.Q_symbol().pp()
1   2   4'  5'  6'
    3   7'  8
        9   10
```



---

archive/issue_comments_316001.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-09-19T22:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316001",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_316002.json:
```json
{
    "body": "<a id='comment:22'></a>Oh dear, help needed.  All the commits after \n> \u200b84093c4\tfix minor formatting issues\n\n\nshould go away!",
    "created_at": "2017-09-19T22:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316002",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:22'></a>Oh dear, help needed.  All the commits after 
> ​84093c4	fix minor formatting issues


should go away!



---

archive/issue_comments_316003.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-09-20T05:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316003",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_316004.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-20T05:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316004",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316005.json:
```json
{
    "body": "<a id='comment:25'></a>I just realised that we should have a skew version, too.",
    "created_at": "2017-09-24T23:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316005",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:25'></a>I just realised that we should have a skew version, too.



---

archive/issue_comments_316006.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-02T19:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316006",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316007.json:
```json
{
    "body": "<a id='comment:27'></a>Thanks for the minor fixes! Let me know if you have further feedback.\nI'd rather do a semistandard version of Haiman insertion here, after the base class is implemented. \n\nReplying to [comment:20 mantepse]:\n> It would be nice to get this in, so we can have the following from #23896\n> \n> ```\n> sage: G = GrowthDiagramShiftedShapes([5, 10, 8, 7, 4, 1, 2, 9, 3, 6])\n> sage: G.P_symbol().pp()\n>  1   2   3   6   9\n>      4   5   7\n>          8   10\n> \n> sage: G.Q_symbol().pp()\n> 1   2   4'  5'  6'\n>     3   7'  8\n>         9   10\n> ```",
    "created_at": "2017-10-02T19:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316007",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:27'></a>Thanks for the minor fixes! Let me know if you have further feedback.
I'd rather do a semistandard version of Haiman insertion here, after the base class is implemented. 

Replying to [comment:20 mantepse]:
> It would be nice to get this in, so we can have the following from #23896
> 
> ```
> sage: G = GrowthDiagramShiftedShapes([5, 10, 8, 7, 4, 1, 2, 9, 3, 6])
> sage: G.P_symbol().pp()
>  1   2   3   6   9
>      4   5   7
>          8   10
> 
> sage: G.Q_symbol().pp()
> 1   2   4'  5'  6'
>     3   7'  8
>         9   10
> ```



---

archive/issue_comments_316008.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:27 kbparamonov]:\n> Thanks for the minor fixes! Let me know if you have further feedback.\n\n\nWell, the most important thing for me would be support for the skew version, and support for `_ascii_art_`.  (In principle I think that there should be generic support for all sorts of fillings of shapes, but that's certainly not in the scope of this ticket.)\n\nImportant question: why do you use `ClonableArray` instead of `ClonableList`, as `Tableau` does?\n\n> I'd rather do a semistandard version of Haiman insertion here, after the base class is implemented. \n\n\nAs you like - maybe you could also do the skew version?  You can use the growth diagram version for cross-checking the standard case - the ticket is already closed, so it will be in 8.1.beta7.  The syntax has changed slightly, it is now\n\n```\nGrowthDiagram.rules.ShiftedShapes()([5,10,8,7,4,1,2,9,3,6])\n```\n\nI am too lazy to implement the semistandard version of the local rules, and I think they should be done generically anyway, via standardization and destandardization of the growth diagram.",
    "created_at": "2017-10-02T20:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316008",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:29'></a>Replying to [comment:27 kbparamonov]:
> Thanks for the minor fixes! Let me know if you have further feedback.


Well, the most important thing for me would be support for the skew version, and support for `_ascii_art_`.  (In principle I think that there should be generic support for all sorts of fillings of shapes, but that's certainly not in the scope of this ticket.)

Important question: why do you use `ClonableArray` instead of `ClonableList`, as `Tableau` does?

> I'd rather do a semistandard version of Haiman insertion here, after the base class is implemented. 


As you like - maybe you could also do the skew version?  You can use the growth diagram version for cross-checking the standard case - the ticket is already closed, so it will be in 8.1.beta7.  The syntax has changed slightly, it is now

```
GrowthDiagram.rules.ShiftedShapes()([5,10,8,7,4,1,2,9,3,6])
```

I am too lazy to implement the semistandard version of the local rules, and I think they should be done generically anyway, via standardization and destandardization of the growth diagram.



---

archive/issue_comments_316009.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:29 mantepse]:\n\n> Well, the most important thing for me would be support for the skew version, and support for `_ascii_art_`.  (In principle I think that there should be generic support for all sorts of fillings of shapes, but that's certainly not in the scope of this ticket.)\n\nGot it\n\n> Important question: why do you use `ClonableArray` instead of `ClonableList`, as `Tableau` does?\n\nGood point, `ClonableList` is more consistent.",
    "created_at": "2017-10-02T21:05:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316009",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:30'></a>Replying to [comment:29 mantepse]:

> Well, the most important thing for me would be support for the skew version, and support for `_ascii_art_`.  (In principle I think that there should be generic support for all sorts of fillings of shapes, but that's certainly not in the scope of this ticket.)

Got it

> Important question: why do you use `ClonableArray` instead of `ClonableList`, as `Tableau` does?

Good point, `ClonableList` is more consistent.



---

archive/issue_comments_316010.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-03T01:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316010",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316011.json:
```json
{
    "body": "<a id='comment:32'></a>`Tableau` probably should be using `ClonableArray` instead of `ClonableList` because it (should have) a fixed size. From the doc of `structure/list_clone.pyx`:\n\n```\n- :class:`ClonableArray` for arrays (lists of fixed length) of objects;\n- :class:`ClonableList` for (resizable) lists of objects;\n```",
    "created_at": "2017-10-03T15:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316011",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:32'></a>`Tableau` probably should be using `ClonableArray` instead of `ClonableList` because it (should have) a fixed size. From the doc of `structure/list_clone.pyx`:

```
- :class:`ClonableArray` for arrays (lists of fixed length) of objects;
- :class:`ClonableList` for (resizable) lists of objects;
```



---

archive/issue_comments_316012.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:32 tscrim]:\n> `Tableau` probably should be using `ClonableArray` instead of `ClonableList` because it (should have) a fixed size.\n\n\nOK, I misunderstood: apparently, *size* is the number of rows.  So, a tableau really should be a `ClonableArray` of lists, right?  Or should it be a `ClonableArray` of `ClonableArray`s?",
    "created_at": "2017-10-03T17:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316012",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:33'></a>Replying to [comment:32 tscrim]:
> `Tableau` probably should be using `ClonableArray` instead of `ClonableList` because it (should have) a fixed size.


OK, I misunderstood: apparently, *size* is the number of rows.  So, a tableau really should be a `ClonableArray` of lists, right?  Or should it be a `ClonableArray` of `ClonableArray`s?



---

archive/issue_comments_316013.json:
```json
{
    "body": "<a id='comment:34'></a>`ClonableArray` of tuples is best so the rows cannot be modified via `T[0]` (a la #15862).",
    "created_at": "2017-10-03T17:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316013",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'></a>`ClonableArray` of tuples is best so the rows cannot be modified via `T[0]` (a la #15862).



---

archive/issue_comments_316014.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-04T01:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316014",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316015.json:
```json
{
    "body": "<a id='comment:36'></a>Great!  One further comment (apart from the skew thing): it might be nice to have, similar to what's provided by `SkewTableau`, an argument `chain` that takes a sequence of shapes and creates a shifted (skew) tableau.  This is already implemented in #23896 (methods `P_symbol` and `Q_symbol`) for the standard case, but should be straightforward also for the (skew) semistandard case.  You can simply take the code from there, I would then replace those with a call to `ShiftedPrimedTableau(chain=Q_chain)`.\n\nI admit that I'm not completely sure about how to do it right: in the shifted case, a chain is a sequence of strict partitions, alternating with a colour:\n\n* colour 1 (black) - add a box on the diagonal\n* colour 2 (blue) - add an ordinary box\n* colour 3 (red) - add a primed box\n\nOf course, black is redundant, so maybe you just want to have two colours...",
    "created_at": "2017-10-04T05:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316015",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:36'></a>Great!  One further comment (apart from the skew thing): it might be nice to have, similar to what's provided by `SkewTableau`, an argument `chain` that takes a sequence of shapes and creates a shifted (skew) tableau.  This is already implemented in #23896 (methods `P_symbol` and `Q_symbol`) for the standard case, but should be straightforward also for the (skew) semistandard case.  You can simply take the code from there, I would then replace those with a call to `ShiftedPrimedTableau(chain=Q_chain)`.

I admit that I'm not completely sure about how to do it right: in the shifted case, a chain is a sequence of strict partitions, alternating with a colour:

* colour 1 (black) - add a box on the diagonal
* colour 2 (blue) - add an ordinary box
* colour 3 (red) - add a primed box

Of course, black is redundant, so maybe you just want to have two colours...



---

archive/issue_comments_316016.json:
```json
{
    "body": "<a id='comment:37'></a>Hi Kirill,\n\nNot all methods seems to have documentation, see\n\n```\nsage -coverage tableau_shifted_primed.py \n------------------------------------------------------------------------\nSCORE tableau_shifted_primed.py: 86.8% (46 of 53)\n\nMissing documentation:\n     * line 1630: def __classcall_private__(cls, *args, **kwargs)\n     * line 1660: def __init__(self, shape=[4, 2], n=2)\n     * line 1669: def _repr_(self)\n     * line 1678: def add_strip(sub_tab, full_tab, length)\n     * line 1736: def preprocessing(T)\n\nMissing doctests:\n     * line 1243: def __init__(self, shape, max_elt)\n     * line 1510: def __init__(self, weight, shape)\n------------------------------------------------------------------------\n```",
    "created_at": "2017-10-06T16:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316016",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:37'></a>Hi Kirill,

Not all methods seems to have documentation, see

```
sage -coverage tableau_shifted_primed.py 
------------------------------------------------------------------------
SCORE tableau_shifted_primed.py: 86.8% (46 of 53)

Missing documentation:
     * line 1630: def __classcall_private__(cls, *args, **kwargs)
     * line 1660: def __init__(self, shape=[4, 2], n=2)
     * line 1669: def _repr_(self)
     * line 1678: def add_strip(sub_tab, full_tab, length)
     * line 1736: def preprocessing(T)

Missing doctests:
     * line 1243: def __init__(self, shape, max_elt)
     * line 1510: def __init__(self, weight, shape)
------------------------------------------------------------------------
```



---

archive/issue_comments_316017.json:
```json
{
    "body": "<a id='comment:38'></a>How do you actually make the crystal of shifted primed tableaux? There is no documentation given for this. Also, you want to include the crystal in the catalogue of crystals, so that it will be accessible as `crystals.shifted_primed_tableaux(shape)`. Currently, this does not seem to be implemented.",
    "created_at": "2017-10-06T17:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316017",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:38'></a>How do you actually make the crystal of shifted primed tableaux? There is no documentation given for this. Also, you want to include the crystal in the catalogue of crystals, so that it will be accessible as `crystals.shifted_primed_tableaux(shape)`. Currently, this does not seem to be implemented.



---

archive/issue_comments_316018.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-10-06T18:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316018",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_316019.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-06T21:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316019",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316020.json:
```json
{
    "body": "<a id='comment:41'></a>Is there a good reason to have `shape=(4,2)` and `n=2` as defaults?",
    "created_at": "2017-10-06T21:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316020",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:41'></a>Is there a good reason to have `shape=(4,2)` and `n=2` as defaults?



---

archive/issue_comments_316021.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:41 mantepse]:\n> Is there a good reason to have `shape=(4,2)` and `n=2` as defaults? \n\n\nNo, those should be removed! Examples should be given with these values, but there should not be defaults!",
    "created_at": "2017-10-06T22:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316021",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:42'></a>Replying to [comment:41 mantepse]:
> Is there a good reason to have `shape=(4,2)` and `n=2` as defaults? 


No, those should be removed! Examples should be given with these values, but there should not be defaults!



---

archive/issue_comments_316022.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-06T22:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316022",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316023.json:
```json
{
    "body": "<a id='comment:44'></a>* There are leftover default values in line 1740.\n\n* I think `list_highest_weight` is redundant.  What I'm not sure about: shouldn't some of the methods, in particular `list_decreasing_weight`, be methods of the crystal class?\n\n```\nsage: %timeit crystals.ShiftedPrimedTableaux(shape=[4,3,2,1]).highest_weight_vectors()\n1 loop, best of 3: 24.9 s per loop\nsage: %timeit ShiftedPrimedTableaux(shape=[4,3,2,1]).list_highest_weight()\n1 loop, best of 3: 24.3 s per loop\n```\n\n* The documentation in line 1648 is not clear to me, isn't it just constructed applying the lowering operators (you could link to those using `:meth:...`) to the highest weights?\n\n* I think that `to_matrix` should be a private method - suppose that the internal representation changes, then it possibly doesn't make much sense anymore.\n\n* I'm a bit unsure about `reading_word_with_positions`, possibly that should be private, too.\n\n* any chance for the skew version?",
    "created_at": "2017-10-07T07:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316023",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:44'></a>* There are leftover default values in line 1740.

* I think `list_highest_weight` is redundant.  What I'm not sure about: shouldn't some of the methods, in particular `list_decreasing_weight`, be methods of the crystal class?

```
sage: %timeit crystals.ShiftedPrimedTableaux(shape=[4,3,2,1]).highest_weight_vectors()
1 loop, best of 3: 24.9 s per loop
sage: %timeit ShiftedPrimedTableaux(shape=[4,3,2,1]).list_highest_weight()
1 loop, best of 3: 24.3 s per loop
```

* The documentation in line 1648 is not clear to me, isn't it just constructed applying the lowering operators (you could link to those using `:meth:...`) to the highest weights?

* I think that `to_matrix` should be a private method - suppose that the internal representation changes, then it possibly doesn't make much sense anymore.

* I'm a bit unsure about `reading_word_with_positions`, possibly that should be private, too.

* any chance for the skew version?



---

archive/issue_comments_316024.json:
```json
{
    "body": "<a id='comment:45'></a>Replying to [comment:44 mantepse]:\n> * There are leftover default values in line 1740.\n \nThose are for factory class `ShiftedPrimedTableauxCrystal`, which is not supposed to be called directly, so default values are only for internal use. I'll change it to raise error if arguments are not passed.\n\n> * I think `list_highest_weight` is redundant.  What I'm not sure about: shouldn't some of the methods, in particular `list_decreasing_weight`, be methods of the crystal class?\n> \n> ```\n> sage: %timeit crystals.ShiftedPrimedTableaux(shape=[4,3,2,1]).highest_weight_vectors()\n> 1 loop, best of 3: 24.9 s per loop\n> sage: %timeit ShiftedPrimedTableaux(shape=[4,3,2,1]).list_highest_weight()\n> 1 loop, best of 3: 24.3 s per loop\n> ```\n\n`list_highest_weight` is interesting in terms of the paper we've been working on, the length of that list would be related to a certain Schur decomposition.\n\n> * The documentation in line 1648 is not clear to me, isn't it just constructed applying the lowering operators (you could link to those using `:meth:...`) to the highest weights?\n \nI'll include better explanation.\n\n> * I think that `to_matrix` should be a private method - suppose that the internal representation changes, then it possibly doesn't make much sense anymore.\n \nAgree.\n\n> * I'm a bit unsure about `reading_word_with_positions`, possibly that should be private, too.\n \nAgree.\n\n> * any chance for the skew version?\n \nI'll be modifying the functions for the skew version. Expect it next week.",
    "created_at": "2017-10-07T18:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316024",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:45'></a>Replying to [comment:44 mantepse]:
> * There are leftover default values in line 1740.
 
Those are for factory class `ShiftedPrimedTableauxCrystal`, which is not supposed to be called directly, so default values are only for internal use. I'll change it to raise error if arguments are not passed.

> * I think `list_highest_weight` is redundant.  What I'm not sure about: shouldn't some of the methods, in particular `list_decreasing_weight`, be methods of the crystal class?
> 
> ```
> sage: %timeit crystals.ShiftedPrimedTableaux(shape=[4,3,2,1]).highest_weight_vectors()
> 1 loop, best of 3: 24.9 s per loop
> sage: %timeit ShiftedPrimedTableaux(shape=[4,3,2,1]).list_highest_weight()
> 1 loop, best of 3: 24.3 s per loop
> ```

`list_highest_weight` is interesting in terms of the paper we've been working on, the length of that list would be related to a certain Schur decomposition.

> * The documentation in line 1648 is not clear to me, isn't it just constructed applying the lowering operators (you could link to those using `:meth:...`) to the highest weights?
 
I'll include better explanation.

> * I think that `to_matrix` should be a private method - suppose that the internal representation changes, then it possibly doesn't make much sense anymore.
 
Agree.

> * I'm a bit unsure about `reading_word_with_positions`, possibly that should be private, too.
 
Agree.

> * any chance for the skew version?
 
I'll be modifying the functions for the skew version. Expect it next week.



---

archive/issue_comments_316025.json:
```json
{
    "body": "<a id='comment:46'></a>Please clarify: isn't `list_highest_weight` the same as `crystals.ShiftedPrimedTableaux(shape=[4,3,2,1]).highest_weight_vectors()`?",
    "created_at": "2017-10-07T18:51:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316025",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:46'></a>Please clarify: isn't `list_highest_weight` the same as `crystals.ShiftedPrimedTableaux(shape=[4,3,2,1]).highest_weight_vectors()`?



---

archive/issue_comments_316026.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:44 mantepse]:\n\n> * any chance for the skew version?\n\n\nThe skew version should be in a new ticket. Let us first get the crystal into Sage. Then you can add code to deal with the skew cases.",
    "created_at": "2017-10-07T19:02:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316026",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:47'></a>Replying to [comment:44 mantepse]:

> * any chance for the skew version?


The skew version should be in a new ticket. Let us first get the crystal into Sage. Then you can add code to deal with the skew cases.



---

archive/issue_comments_316027.json:
```json
{
    "body": "<a id='comment:48'></a>OK, sounds reasonable!",
    "created_at": "2017-10-07T19:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316027",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:48'></a>OK, sounds reasonable!



---

archive/issue_comments_316028.json:
```json
{
    "body": "<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-07T21:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316028",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316029.json:
```json
{
    "body": "<a id='comment:50'></a>Hi Kirill,\n\nYou changed the name of the crystal class as we discussed, but you did not change the tests. Now there are a lot of failing tests!",
    "created_at": "2017-10-07T22:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316029",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:50'></a>Hi Kirill,

You changed the name of the crystal class as we discussed, but you did not change the tests. Now there are a lot of failing tests!



---

archive/issue_comments_316030.json:
```json
{
    "body": "<a id='comment:51'></a>There are still missing doctests:\n\n```\nMissing doctests:\n     * line 1172: def __init__(self, shape, max_elt)\n     * line 1439: def __init__(self, weight, shape)\n     * line 1710: def add_strip(sub_tab, full_tab, length)\n```",
    "created_at": "2017-10-07T22:06:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316030",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:51'></a>There are still missing doctests:

```
Missing doctests:
     * line 1172: def __init__(self, shape, max_elt)
     * line 1439: def __init__(self, weight, shape)
     * line 1710: def add_strip(sub_tab, full_tab, length)
```



---

archive/issue_comments_316031.json:
```json
{
    "body": "<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-09T17:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316031",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:52'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316032.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-09T18:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316032",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316033.json:
```json
{
    "body": "<a id='comment:54'></a>Hi Kirill,\n\nI still get a lot of doctest failures when running the tests on 'tableau_shifted_primed.py'\n\n```\nsage -t tableau_shifted_primed.py  # 171 doctests failed\n```\nCan you please fix them?\n\nThanks,\n\nAnne",
    "created_at": "2017-10-16T03:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316033",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:54'></a>Hi Kirill,

I still get a lot of doctest failures when running the tests on 'tableau_shifted_primed.py'

```
sage -t tableau_shifted_primed.py  # 171 doctests failed
```
Can you please fix them?

Thanks,

Anne



---

archive/issue_comments_316034.json:
```json
{
    "body": "<a id='comment:55'></a>Hi Anne,\n\nI don't know why that happened, it passed all the tests for me.\n\nReplying to [comment:54 aschilling]:\n> Hi Kirill,\n> \n> I still get a lot of doctest failures when running the tests on 'tableau_shifted_primed.py'\n> \n> ```\n> sage -t tableau_shifted_primed.py  # 171 doctests failed\n> ```\n> Can you please fix them?\n> \n> Thanks,\n> \n> Anne",
    "created_at": "2017-10-16T03:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316034",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:55'></a>Hi Anne,

I don't know why that happened, it passed all the tests for me.

Replying to [comment:54 aschilling]:
> Hi Kirill,
> 
> I still get a lot of doctest failures when running the tests on 'tableau_shifted_primed.py'
> 
> ```
> sage -t tableau_shifted_primed.py  # 171 doctests failed
> ```
> Can you please fix them?
> 
> Thanks,
> 
> Anne



---

archive/issue_comments_316035.json:
```json
{
    "body": "<a id='comment:56'></a>I get the following \n\n```\nsage: B = crystals.ShiftedPrimedTableaux([3,2],2)\nsage: TestSuite(B).run(verbose=True)\nrunning ._test_an_element() . . . pass\nrunning ._test_cardinality() . . . pass\nrunning ._test_category() . . . pass\nrunning ._test_elements() . . .\n  Running the test suite of self.an_element()\n  running ._test_category() . . . pass\n  running ._test_eq() . . . pass\n  running ._test_new() . . . pass\n  running ._test_not_implemented_methods() . . . pass\n  running ._test_pickling() . . . pass\n  pass\nrunning ._test_elements_eq_reflexive() . . . pass\nrunning ._test_elements_eq_symmetric() . . . pass\nrunning ._test_elements_eq_transitive() . . . pass\nrunning ._test_elements_neq() . . . pass\nrunning ._test_enumerated_set_contains() . . . pass\nrunning ._test_enumerated_set_iter_cardinality() . . . pass\nrunning ._test_enumerated_set_iter_list() . . . pass\nrunning ._test_eq() . . . pass\nrunning ._test_fast_iter() . . . pass\nrunning ._test_new() . . . pass\nrunning ._test_not_implemented_methods() . . . pass\nrunning ._test_pickling() . . . pass\nrunning ._test_some_elements() . . . pass\nrunning ._test_stembridge_local_axioms() . . . fail\nTraceback (most recent call last):\n  File \"/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 294, in run\n    test_method(tester = tester)\n  File \"/Applications/sage/local/lib/python2.7/site-packages/sage/categories/regular_crystals.py\", line 313, in _test_stembridge_local_axioms\n    goodness = x._test_stembridge_local_axioms(index_set, verbose)\n  File \"sage/structure/element.pyx\", line 484, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4368)\n    return self.getattr_from_category(name)\n  File \"sage/structure/element.pyx\", line 497, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4477)\n    return getattr_from_other_class(self, cls, name)\n  File \"sage/cpython/getattr.pyx\", line 249, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:1830)\n    raise dummy_attribute_error\nAttributeError: 'ShiftedPrimedTableaux_all_with_category.element_class' object has no attribute '_test_stembridge_local_axioms'\n------------------------------------------------------------\nThe following tests failed: _test_stembridge_local_axioms\n```",
    "created_at": "2017-10-16T04:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316035",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:56'></a>I get the following 

```
sage: B = crystals.ShiftedPrimedTableaux([3,2],2)
sage: TestSuite(B).run(verbose=True)
running ._test_an_element() . . . pass
running ._test_cardinality() . . . pass
running ._test_category() . . . pass
running ._test_elements() . . .
  Running the test suite of self.an_element()
  running ._test_category() . . . pass
  running ._test_eq() . . . pass
  running ._test_new() . . . pass
  running ._test_not_implemented_methods() . . . pass
  running ._test_pickling() . . . pass
  pass
running ._test_elements_eq_reflexive() . . . pass
running ._test_elements_eq_symmetric() . . . pass
running ._test_elements_eq_transitive() . . . pass
running ._test_elements_neq() . . . pass
running ._test_enumerated_set_contains() . . . pass
running ._test_enumerated_set_iter_cardinality() . . . pass
running ._test_enumerated_set_iter_list() . . . pass
running ._test_eq() . . . pass
running ._test_fast_iter() . . . pass
running ._test_new() . . . pass
running ._test_not_implemented_methods() . . . pass
running ._test_pickling() . . . pass
running ._test_some_elements() . . . pass
running ._test_stembridge_local_axioms() . . . fail
Traceback (most recent call last):
  File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 294, in run
    test_method(tester = tester)
  File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/regular_crystals.py", line 313, in _test_stembridge_local_axioms
    goodness = x._test_stembridge_local_axioms(index_set, verbose)
  File "sage/structure/element.pyx", line 484, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4368)
    return self.getattr_from_category(name)
  File "sage/structure/element.pyx", line 497, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4477)
    return getattr_from_other_class(self, cls, name)
  File "sage/cpython/getattr.pyx", line 249, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:1830)
    raise dummy_attribute_error
AttributeError: 'ShiftedPrimedTableaux_all_with_category.element_class' object has no attribute '_test_stembridge_local_axioms'
------------------------------------------------------------
The following tests failed: _test_stembridge_local_axioms
```



---

archive/issue_comments_316036.json:
```json
{
    "body": "<a id='comment:57'></a>It looks like the tableau class doesn't inherit method `_test_stembridge_local_axioms`.\nDo you know why this happens?\n\nReplying to [comment:56 aschilling]:\n> I get the following \n> \n> ```\n> sage: B = crystals.ShiftedPrimedTableaux([3,2],2)\n> sage: TestSuite(B).run(verbose=True)\n> running ._test_an_element() . . . pass\n> running ._test_cardinality() . . . pass\n> running ._test_category() . . . pass\n> running ._test_elements() . . .\n>   Running the test suite of self.an_element()\n>   running ._test_category() . . . pass\n>   running ._test_eq() . . . pass\n>   running ._test_new() . . . pass\n>   running ._test_not_implemented_methods() . . . pass\n>   running ._test_pickling() . . . pass\n>   pass\n> running ._test_elements_eq_reflexive() . . . pass\n> running ._test_elements_eq_symmetric() . . . pass\n> running ._test_elements_eq_transitive() . . . pass\n> running ._test_elements_neq() . . . pass\n> running ._test_enumerated_set_contains() . . . pass\n> running ._test_enumerated_set_iter_cardinality() . . . pass\n> running ._test_enumerated_set_iter_list() . . . pass\n> running ._test_eq() . . . pass\n> running ._test_fast_iter() . . . pass\n> running ._test_new() . . . pass\n> running ._test_not_implemented_methods() . . . pass\n> running ._test_pickling() . . . pass\n> running ._test_some_elements() . . . pass\n> running ._test_stembridge_local_axioms() . . . fail\n> Traceback (most recent call last):\n>   File \"/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 294, in run\n>     test_method(tester = tester)\n>   File \"/Applications/sage/local/lib/python2.7/site-packages/sage/categories/regular_crystals.py\", line 313, in _test_stembridge_local_axioms\n>     goodness = x._test_stembridge_local_axioms(index_set, verbose)\n>   File \"sage/structure/element.pyx\", line 484, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4368)\n>     return self.getattr_from_category(name)\n>   File \"sage/structure/element.pyx\", line 497, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4477)\n>     return getattr_from_other_class(self, cls, name)\n>   File \"sage/cpython/getattr.pyx\", line 249, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:1830)\n>     raise dummy_attribute_error\n> AttributeError: 'ShiftedPrimedTableaux_all_with_category.element_class' object has no attribute '_test_stembridge_local_axioms'\n> ------------------------------------------------------------\n> The following tests failed: _test_stembridge_local_axioms\n> ```",
    "created_at": "2017-10-16T16:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316036",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:57'></a>It looks like the tableau class doesn't inherit method `_test_stembridge_local_axioms`.
Do you know why this happens?

Replying to [comment:56 aschilling]:
> I get the following 
> 
> ```
> sage: B = crystals.ShiftedPrimedTableaux([3,2],2)
> sage: TestSuite(B).run(verbose=True)
> running ._test_an_element() . . . pass
> running ._test_cardinality() . . . pass
> running ._test_category() . . . pass
> running ._test_elements() . . .
>   Running the test suite of self.an_element()
>   running ._test_category() . . . pass
>   running ._test_eq() . . . pass
>   running ._test_new() . . . pass
>   running ._test_not_implemented_methods() . . . pass
>   running ._test_pickling() . . . pass
>   pass
> running ._test_elements_eq_reflexive() . . . pass
> running ._test_elements_eq_symmetric() . . . pass
> running ._test_elements_eq_transitive() . . . pass
> running ._test_elements_neq() . . . pass
> running ._test_enumerated_set_contains() . . . pass
> running ._test_enumerated_set_iter_cardinality() . . . pass
> running ._test_enumerated_set_iter_list() . . . pass
> running ._test_eq() . . . pass
> running ._test_fast_iter() . . . pass
> running ._test_new() . . . pass
> running ._test_not_implemented_methods() . . . pass
> running ._test_pickling() . . . pass
> running ._test_some_elements() . . . pass
> running ._test_stembridge_local_axioms() . . . fail
> Traceback (most recent call last):
>   File "/Applications/sage/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 294, in run
>     test_method(tester = tester)
>   File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/regular_crystals.py", line 313, in _test_stembridge_local_axioms
>     goodness = x._test_stembridge_local_axioms(index_set, verbose)
>   File "sage/structure/element.pyx", line 484, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4368)
>     return self.getattr_from_category(name)
>   File "sage/structure/element.pyx", line 497, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4477)
>     return getattr_from_other_class(self, cls, name)
>   File "sage/cpython/getattr.pyx", line 249, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:1830)
>     raise dummy_attribute_error
> AttributeError: 'ShiftedPrimedTableaux_all_with_category.element_class' object has no attribute '_test_stembridge_local_axioms'
> ------------------------------------------------------------
> The following tests failed: _test_stembridge_local_axioms
> ```



---

archive/issue_comments_316037.json:
```json
{
    "body": "<a id='comment:58'></a>Replying to [comment:57 kbparamonov]:\n> It looks like the tableau class doesn't inherit method `_test_stembridge_local_axioms`.\n> Do you know why this happens?\n\n\nHere is the problem:\n\n```\nsage: SPTC = crystals.ShiftedPrimedTableaux([4,2], 2)\nsage: SPTC.an_element()\n[(1.0, 1.0, 1.0, 1.0), (2.0, 2.0)]\nsage: type(_)\n<class 'sage.combinat.tableau_shifted_primed.ShiftedPrimedTableaux_all_with_category.element_class'>\nsage: type(SPTC)\n<class 'sage.combinat.tableau_shifted_primed.SPTCrystal_with_category'>\nsage: SPTC.element_class\n<class 'sage.combinat.tableau_shifted_primed.SPTCrystal_with_category.element_class'>\n```\nThe elements of `SPTC` are not subclasses of `SPTC.element_class`. Hence, they belong to the wrong category.\n\n```\nsage: SPTC.an_element().category()\nCategory of elements of Shifted Primed Tableaux\n```\n\nI also do not see why you have `ShiftedPrimedTableauxCrystal` and the subclass `SPTCrystal`. It seems like the SPT crystals really should be the same as the SPT with a fixed shape and max element, but I've only quickly looked at it.\n\nI am pushing a few simple tweaks. We can work on this more tomorrow.",
    "created_at": "2017-10-18T04:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316037",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:58'></a>Replying to [comment:57 kbparamonov]:
> It looks like the tableau class doesn't inherit method `_test_stembridge_local_axioms`.
> Do you know why this happens?


Here is the problem:

```
sage: SPTC = crystals.ShiftedPrimedTableaux([4,2], 2)
sage: SPTC.an_element()
[(1.0, 1.0, 1.0, 1.0), (2.0, 2.0)]
sage: type(_)
<class 'sage.combinat.tableau_shifted_primed.ShiftedPrimedTableaux_all_with_category.element_class'>
sage: type(SPTC)
<class 'sage.combinat.tableau_shifted_primed.SPTCrystal_with_category'>
sage: SPTC.element_class
<class 'sage.combinat.tableau_shifted_primed.SPTCrystal_with_category.element_class'>
```
The elements of `SPTC` are not subclasses of `SPTC.element_class`. Hence, they belong to the wrong category.

```
sage: SPTC.an_element().category()
Category of elements of Shifted Primed Tableaux
```

I also do not see why you have `ShiftedPrimedTableauxCrystal` and the subclass `SPTCrystal`. It seems like the SPT crystals really should be the same as the SPT with a fixed shape and max element, but I've only quickly looked at it.

I am pushing a few simple tweaks. We can work on this more tomorrow.



---

archive/issue_comments_316038.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-18T04:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316038",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316039.json:
```json
{
    "body": "<a id='comment:60'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-18T18:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316039",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:60'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316040.json:
```json
{
    "body": "<a id='comment:61'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-18T21:27:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316040",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:61'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316041.json:
```json
{
    "body": "<a id='comment:62'></a>Can you please add a reference to the literature to the documentation for shifted primed tableaux? I'm actually really curious to see a reference, independent of the code, because in my work \"shifted shaded tableaux\" come up and I wonder if they are the same objects. From a cursory look at the documentation they seem quite close.",
    "created_at": "2017-10-22T19:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316041",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:62'></a>Can you please add a reference to the literature to the documentation for shifted primed tableaux? I'm actually really curious to see a reference, independent of the code, because in my work "shifted shaded tableaux" come up and I wonder if they are the same objects. From a cursory look at the documentation they seem quite close.



---

archive/issue_comments_316042.json:
```json
{
    "body": "<a id='comment:65'></a>Graham, Kirill, or Anne can probably answer better than I can, but a good starting point would be their paper:\n\n```\n.. [HPS2017] Graham Hawkes, Kirill Paramonov, and Anne Schilling.\n             *Crystal analysis of type* `C` *Stanley symmetric functions*.\n             Preprint, :arxiv:`1704.00889`.\n```",
    "created_at": "2017-10-23T03:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316042",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:65'></a>Graham, Kirill, or Anne can probably answer better than I can, but a good starting point would be their paper:

```
.. [HPS2017] Graham Hawkes, Kirill Paramonov, and Anne Schilling.
             *Crystal analysis of type* `C` *Stanley symmetric functions*.
             Preprint, :arxiv:`1704.00889`.
```



---

archive/issue_comments_316043.json:
```json
{
    "body": "<a id='comment:66'></a>I believe those tableaux were first introduced by Haiman here: http://www.sciencedirect.com/science/article/pii/0097316589900150\nand recently were developed by Serrano here: https://arxiv.org/abs/0811.2057\n\nReplying to [comment:62 andrew.mathas]:\n> Can you please add a reference to the literature to the documentation for shifted primed tableaux? I'm actually really curious to see a reference, independent of the code, because in my work \"shifted shaded tableaux\" come up and I wonder if they are the same objects. From a cursory look at the documentation they seem quite close.",
    "created_at": "2017-10-23T06:32:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316043",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:66'></a>I believe those tableaux were first introduced by Haiman here: http://www.sciencedirect.com/science/article/pii/0097316589900150
and recently were developed by Serrano here: https://arxiv.org/abs/0811.2057

Replying to [comment:62 andrew.mathas]:
> Can you please add a reference to the literature to the documentation for shifted primed tableaux? I'm actually really curious to see a reference, independent of the code, because in my work "shifted shaded tableaux" come up and I wonder if they are the same objects. From a cursory look at the documentation they seem quite close.



---

archive/issue_comments_316044.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:66 kbparamonov]:\n> I believe those tableaux were first introduced by Haiman here: http://www.sciencedirect.com/science/article/pii/0097316589900150\n> and recently were developed by Serrano here: https://arxiv.org/abs/0811.2057\n\n\nKirill, could you please add those references to the code? Also, did you fix the Stembridge axiom issues?",
    "created_at": "2017-10-23T16:32:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316044",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:67'></a>Replying to [comment:66 kbparamonov]:
> I believe those tableaux were first introduced by Haiman here: http://www.sciencedirect.com/science/article/pii/0097316589900150
> and recently were developed by Serrano here: https://arxiv.org/abs/0811.2057


Kirill, could you please add those references to the code? Also, did you fix the Stembridge axiom issues?



---

archive/issue_comments_316045.json:
```json
{
    "body": "<a id='comment:68'></a>Sounds good. Travis fixed the Stembridge axioms issues last week.\n\nReplying to [comment:67 aschilling]:\n> Replying to [comment:66 kbparamonov]:\n> > I believe those tableaux were first introduced by Haiman here: http://www.sciencedirect.com/science/article/pii/0097316589900150\n> > and recently were developed by Serrano here: https://arxiv.org/abs/0811.2057\n\n> \n> Kirill, could you please add those references to the code? Also, did you fix the Stembridge axiom issues?",
    "created_at": "2017-10-23T16:40:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316045",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:68'></a>Sounds good. Travis fixed the Stembridge axioms issues last week.

Replying to [comment:67 aschilling]:
> Replying to [comment:66 kbparamonov]:
> > I believe those tableaux were first introduced by Haiman here: http://www.sciencedirect.com/science/article/pii/0097316589900150
> > and recently were developed by Serrano here: https://arxiv.org/abs/0811.2057

> 
> Kirill, could you please add those references to the code? Also, did you fix the Stembridge axiom issues?



---

archive/issue_comments_316046.json:
```json
{
    "body": "<a id='comment:69'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-12-28T01:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316046",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:69'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316047.json:
```json
{
    "body": "<a id='comment:70'></a>Hi Kirill,\n\nOk, let us try to get this ticket into Sage! I have tested the code extensively and the crystals seem to be correct. I rebased the code on the latest development version and also fixed some small typos. \n\nThere are still some small issues with the coverage:\n\n```\nsage -coverage tableau_shifted_primed.py \n------------------------------------------------------------------------\nSCORE tableau_shifted_primed.py: 95.9% (47 of 49)\n\nMissing documentation:\n     * line 1305: def __classcall_private__(cls, shape, max_elt=None, skew=None)\n\nMissing doctests:\n     * line 1416: def module_generators(self)\n\nPossibly wrong (function name doesn't occur in doctests):\n     * line 1755: def add_strip(sub_tab, full_tab, length)\n------------------------------------------------------------------------\n```\nCould you please fix those?\n\nAlso, the ticket description mentions that this code is based on #20041. Can this be removed now? It also mentions various insertion algorithms, but I think they are not implemented in this ticket. Could you please update the description?\n\nThank you!\n\nAnne",
    "created_at": "2017-12-28T01:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316047",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:70'></a>Hi Kirill,

Ok, let us try to get this ticket into Sage! I have tested the code extensively and the crystals seem to be correct. I rebased the code on the latest development version and also fixed some small typos. 

There are still some small issues with the coverage:

```
sage -coverage tableau_shifted_primed.py 
------------------------------------------------------------------------
SCORE tableau_shifted_primed.py: 95.9% (47 of 49)

Missing documentation:
     * line 1305: def __classcall_private__(cls, shape, max_elt=None, skew=None)

Missing doctests:
     * line 1416: def module_generators(self)

Possibly wrong (function name doesn't occur in doctests):
     * line 1755: def add_strip(sub_tab, full_tab, length)
------------------------------------------------------------------------
```
Could you please fix those?

Also, the ticket description mentions that this code is based on #20041. Can this be removed now? It also mentions various insertion algorithms, but I think they are not implemented in this ticket. Could you please update the description?

Thank you!

Anne



---

archive/issue_comments_316048.json:
```json
{
    "body": "<a id='comment:71'></a>That would be great!\n\nTHe insertion algorithms are available via #23896, which could be reviewed as soon as this is done! (Hint :-)",
    "created_at": "2017-12-28T08:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316048",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:71'></a>That would be great!

THe insertion algorithms are available via #23896, which could be reviewed as soon as this is done! (Hint :-)



---

archive/issue_comments_316049.json:
```json
{
    "body": "<a id='comment:72'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-12-29T18:16:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316049",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:72'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316050.json:
```json
{
    "body": "Changing keywords from \"shifted tableaux, insertion algorithms\" to \"shifted primed tableaux, crystals\".",
    "created_at": "2017-12-29T18:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316050",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

Changing keywords from "shifted tableaux, insertion algorithms" to "shifted primed tableaux, crystals".



---

archive/issue_comments_316051.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-12-29T18:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316051",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_316052.json:
```json
{
    "body": "<a id='comment:74'></a>Hi Anne,\n\nI've removed the use of numpy in the code, could you check if everything still works?\nOther issues have been fixed.\n\nReplying to [comment:70 aschilling]:\n> Hi Kirill,\n> \n> Ok, let us try to get this ticket into Sage! I have tested the code extensively and the crystals seem to be correct. I rebased the code on the latest development version and also fixed some small typos. \n> \n> There are still some small issues with the coverage:\n> \n> ```\n> sage -coverage tableau_shifted_primed.py \n> ------------------------------------------------------------------------\n> SCORE tableau_shifted_primed.py: 95.9% (47 of 49)\n> \n> Missing documentation:\n>      * line 1305: def __classcall_private__(cls, shape, max_elt=None, skew=None)\n> \n> Missing doctests:\n>      * line 1416: def module_generators(self)\n> \n> Possibly wrong (function name doesn't occur in doctests):\n>      * line 1755: def add_strip(sub_tab, full_tab, length)\n> ------------------------------------------------------------------------\n> ```\n> Could you please fix those?\n> \n> Also, the ticket description mentions that this code is based on #20041. Can this be removed now? It also mentions various insertion algorithms, but I think they are not implemented in this ticket. Could you please update the description?\n> \n> Thank you!\n> \n> Anne",
    "created_at": "2017-12-29T18:25:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316052",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:74'></a>Hi Anne,

I've removed the use of numpy in the code, could you check if everything still works?
Other issues have been fixed.

Replying to [comment:70 aschilling]:
> Hi Kirill,
> 
> Ok, let us try to get this ticket into Sage! I have tested the code extensively and the crystals seem to be correct. I rebased the code on the latest development version and also fixed some small typos. 
> 
> There are still some small issues with the coverage:
> 
> ```
> sage -coverage tableau_shifted_primed.py 
> ------------------------------------------------------------------------
> SCORE tableau_shifted_primed.py: 95.9% (47 of 49)
> 
> Missing documentation:
>      * line 1305: def __classcall_private__(cls, shape, max_elt=None, skew=None)
> 
> Missing doctests:
>      * line 1416: def module_generators(self)
> 
> Possibly wrong (function name doesn't occur in doctests):
>      * line 1755: def add_strip(sub_tab, full_tab, length)
> ------------------------------------------------------------------------
> ```
> Could you please fix those?
> 
> Also, the ticket description mentions that this code is based on #20041. Can this be removed now? It also mentions various insertion algorithms, but I think they are not implemented in this ticket. Could you please update the description?
> 
> Thank you!
> 
> Anne



---

archive/issue_comments_316053.json:
```json
{
    "body": "<a id='comment:75'></a>Hi Kirill,\n\nThanks for the fixes. There seems to be some problem with the documentation:\n\n```\n[dochtml] [combinat ] /Applications/sage/local/lib/python2.7/site-packages/sage/combinat/tableau_shifted_primed.py:docstring of sage.combinat.tableau_shifted_primed.ShiftedPrimedTableaux_shape:9: WARNING: citation not found: HPS17\n```\n\nAnne",
    "created_at": "2017-12-30T06:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316053",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:75'></a>Hi Kirill,

Thanks for the fixes. There seems to be some problem with the documentation:

```
[dochtml] [combinat ] /Applications/sage/local/lib/python2.7/site-packages/sage/combinat/tableau_shifted_primed.py:docstring of sage.combinat.tableau_shifted_primed.ShiftedPrimedTableaux_shape:9: WARNING: citation not found: HPS17
```

Anne



---

archive/issue_comments_316054.json:
```json
{
    "body": "<a id='comment:76'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-01T09:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316054",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:76'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316055.json:
```json
{
    "body": "<a id='comment:77'></a>Alright, should be fixed.\n\nReplying to [comment:76 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                              |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n> |[b1d7d2e](https://git.sagemath.org/sage.git/commit/?id=b1d7d2e55e04a298a3a611c041dfa6bfa74adf2c)|`Fixed reference to the paper`|",
    "created_at": "2018-01-01T09:37:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316055",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:77'></a>Alright, should be fixed.

Replying to [comment:76 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                              |
> |-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
> |[b1d7d2e](https://git.sagemath.org/sage.git/commit/?id=b1d7d2e55e04a298a3a611c041dfa6bfa74adf2c)|`Fixed reference to the paper`|



---

archive/issue_comments_316056.json:
```json
{
    "body": "<a id='comment:78'></a>I think that `shape` should return a skew partition, when necessary, and a partition otherwise.  Currently it returns lists.  For example:\n\n```\n        if self._skew is None:\n            return Partition([len(_) for _ in self])\n        return SkewPartition(([len(self[i])+self._skew[i]\n                               for i in range(len(self._skew))] +\n                              [len(self[i])\n                               for i in range(len(self._skew), len(self))],\n                              self._skew))\n\n```\n(doctests would have to be adapted)",
    "created_at": "2018-01-01T16:27:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316056",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:78'></a>I think that `shape` should return a skew partition, when necessary, and a partition otherwise.  Currently it returns lists.  For example:

```
        if self._skew is None:
            return Partition([len(_) for _ in self])
        return SkewPartition(([len(self[i])+self._skew[i]
                               for i in range(len(self._skew))] +
                              [len(self[i])
                               for i in range(len(self._skew), len(self))],
                              self._skew))

```
(doctests would have to be adapted)



---

archive/issue_comments_316057.json:
```json
{
    "body": "<a id='comment:79'></a>I am not sure whether implementing `__call__` for shifted tableaux is a good idea.  In any case, it is not quite clear to me what it does:\n\n```\nsage: s = ShiftedPrimedTableau([[\"2p\",3,4],[2]],skew=[2,1])\nsage: s.pp()\n .  .  2' 3  4 \n    .  2 \nsage: s(0,0)\n3.0\nsage: s(0,1)\n4.0\nsage: s(0,2)\n1.5\nsage: s(0,3)\n3.0\nsage: s(0,4)\n4.0\nsage: s(0,5)\nIndexError: invalid cell\nsage: s(1,0)\n2.0\nsage: s(1,1)\n2.0\nsage: s(1,2)\nIndexError: invalid cell\nsage: s(2,0)\nIndexError: invalid cell\n```",
    "created_at": "2018-01-01T18:24:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316057",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:79'></a>I am not sure whether implementing `__call__` for shifted tableaux is a good idea.  In any case, it is not quite clear to me what it does:

```
sage: s = ShiftedPrimedTableau([["2p",3,4],[2]],skew=[2,1])
sage: s.pp()
 .  .  2' 3  4 
    .  2 
sage: s(0,0)
3.0
sage: s(0,1)
4.0
sage: s(0,2)
1.5
sage: s(0,3)
3.0
sage: s(0,4)
4.0
sage: s(0,5)
IndexError: invalid cell
sage: s(1,0)
2.0
sage: s(1,1)
2.0
sage: s(1,2)
IndexError: invalid cell
sage: s(2,0)
IndexError: invalid cell
```



---

archive/issue_comments_316058.json:
```json
{
    "body": "<a id='comment:80'></a>Replying to [comment:78 mantepse]:\n> I think that `shape` should return a skew partition, when necessary, and a partition otherwise.  Currently it returns lists.  For example:\n> \n> ```\n>         if self._skew is None:\n>             return Partition([len(_) for _ in self])\n>         return SkewPartition(([len(self[i])+self._skew[i]\n>                                for i in range(len(self._skew))] +\n>                               [len(self[i])\n>                                for i in range(len(self._skew), len(self))],\n>                               self._skew))\n> \n> ```\n> (doctests would have to be adapted)\n\n\nHi Kirill,\n\nThank you for your changes. I agree with Martin that the shape should be in `Partitions` or `SkewPartitions`. In fact, the same is true for the weight of a crystal element (cf. with the weight of a tableaux crystal element):\n\n```\nsage: B = crystals.ShiftedPrimedTableaux([4,3,1], 5)\nsage: b = B.an_element()\nsage: type(b.weight())\n<type 'tuple'>\nsage: B = crystals.Tableaux(['A',2],shape=[2,1])\nsage: b = B.an_element()\nsage: type(b.weight())\n<class 'sage.combinat.root_system.type_A.AmbientSpace_with_category.element_class'>\n```\n\nAnne",
    "created_at": "2018-01-01T23:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316058",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:80'></a>Replying to [comment:78 mantepse]:
> I think that `shape` should return a skew partition, when necessary, and a partition otherwise.  Currently it returns lists.  For example:
> 
> ```
>         if self._skew is None:
>             return Partition([len(_) for _ in self])
>         return SkewPartition(([len(self[i])+self._skew[i]
>                                for i in range(len(self._skew))] +
>                               [len(self[i])
>                                for i in range(len(self._skew), len(self))],
>                               self._skew))
> 
> ```
> (doctests would have to be adapted)


Hi Kirill,

Thank you for your changes. I agree with Martin that the shape should be in `Partitions` or `SkewPartitions`. In fact, the same is true for the weight of a crystal element (cf. with the weight of a tableaux crystal element):

```
sage: B = crystals.ShiftedPrimedTableaux([4,3,1], 5)
sage: b = B.an_element()
sage: type(b.weight())
<type 'tuple'>
sage: B = crystals.Tableaux(['A',2],shape=[2,1])
sage: b = B.an_element()
sage: type(b.weight())
<class 'sage.combinat.root_system.type_A.AmbientSpace_with_category.element_class'>
```

Anne



---

archive/issue_comments_316059.json:
```json
{
    "body": "<a id='comment:81'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-02T01:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316059",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:81'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316060.json:
```json
{
    "body": "<a id='comment:82'></a>Hi Kirill,\n\nI merged in the latest development branch and also fixed some documentation. Please use this version when you fix the shape and weight to be of the correct type.\n\nThank you,\n\nAnne",
    "created_at": "2018-01-02T01:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316060",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:82'></a>Hi Kirill,

I merged in the latest development branch and also fixed some documentation. Please use this version when you fix the shape and weight to be of the correct type.

Thank you,

Anne



---

archive/issue_comments_316061.json:
```json
{
    "body": "<a id='comment:83'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-02T07:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316061",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:83'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316062.json:
```json
{
    "body": "<a id='comment:84'></a>Good point, thank you!\n\nReplying to [comment:78 mantepse]:\n> I think that `shape` should return a skew partition, when necessary, and a partition otherwise.  Currently it returns lists.  For example:\n> \n> ```\n>         if self._skew is None:\n>             return Partition([len(_) for _ in self])\n>         return SkewPartition(([len(self[i])+self._skew[i]\n>                                for i in range(len(self._skew))] +\n>                               [len(self[i])\n>                                for i in range(len(self._skew), len(self))],\n>                               self._skew))\n> \n> ```\n> (doctests would have to be adapted)",
    "created_at": "2018-01-02T07:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316062",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:84'></a>Good point, thank you!

Replying to [comment:78 mantepse]:
> I think that `shape` should return a skew partition, when necessary, and a partition otherwise.  Currently it returns lists.  For example:
> 
> ```
>         if self._skew is None:
>             return Partition([len(_) for _ in self])
>         return SkewPartition(([len(self[i])+self._skew[i]
>                                for i in range(len(self._skew))] +
>                               [len(self[i])
>                                for i in range(len(self._skew), len(self))],
>                               self._skew))
> 
> ```
> (doctests would have to be adapted)



---

archive/issue_comments_316063.json:
```json
{
    "body": "<a id='comment:85'></a>That makes sense.\nHow do I change type of the weight of crystal elements?\n\nReplying to [comment:80 aschilling]:\n> Replying to [comment:78 mantepse]:\n> > I think that `shape` should return a skew partition, when necessary, and a partition otherwise.  Currently it returns lists.  For example:\n> > \n> > ```\n> >         if self._skew is None:\n> >             return Partition([len(_) for _ in self])\n> >         return SkewPartition(([len(self[i])+self._skew[i]\n> >                                for i in range(len(self._skew))] +\n> >                               [len(self[i])\n> >                                for i in range(len(self._skew), len(self))],\n> >                               self._skew))\n> > \n> > ```\n> > (doctests would have to be adapted)\n\n> \n> Hi Kirill,\n> \n> Thank you for your changes. I agree with Martin that the shape should be in `Partitions` or `SkewPartitions`. In fact, the same is true for the weight of a crystal element (cf. with the weight of a tableaux crystal element):\n> \n> ```\n> sage: B = crystals.ShiftedPrimedTableaux([4,3,1], 5)\n> sage: b = B.an_element()\n> sage: type(b.weight())\n> <type 'tuple'>\n> sage: B = crystals.Tableaux(['A',2],shape=[2,1])\n> sage: b = B.an_element()\n> sage: type(b.weight())\n> <class 'sage.combinat.root_system.type_A.AmbientSpace_with_category.element_class'>\n> ```\n> \n> Anne",
    "created_at": "2018-01-02T07:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316063",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:85'></a>That makes sense.
How do I change type of the weight of crystal elements?

Replying to [comment:80 aschilling]:
> Replying to [comment:78 mantepse]:
> > I think that `shape` should return a skew partition, when necessary, and a partition otherwise.  Currently it returns lists.  For example:
> > 
> > ```
> >         if self._skew is None:
> >             return Partition([len(_) for _ in self])
> >         return SkewPartition(([len(self[i])+self._skew[i]
> >                                for i in range(len(self._skew))] +
> >                               [len(self[i])
> >                                for i in range(len(self._skew), len(self))],
> >                               self._skew))
> > 
> > ```
> > (doctests would have to be adapted)

> 
> Hi Kirill,
> 
> Thank you for your changes. I agree with Martin that the shape should be in `Partitions` or `SkewPartitions`. In fact, the same is true for the weight of a crystal element (cf. with the weight of a tableaux crystal element):
> 
> ```
> sage: B = crystals.ShiftedPrimedTableaux([4,3,1], 5)
> sage: b = B.an_element()
> sage: type(b.weight())
> <type 'tuple'>
> sage: B = crystals.Tableaux(['A',2],shape=[2,1])
> sage: b = B.an_element()
> sage: type(b.weight())
> <class 'sage.combinat.root_system.type_A.AmbientSpace_with_category.element_class'>
> ```
> 
> Anne



---

archive/issue_comments_316064.json:
```json
{
    "body": "<a id='comment:86'></a>Replying to [comment:85 kbparamonov]:\n> That makes sense.\n> How do I change type of the weight of crystal elements?\n\n\nYou can do\n\n```\nsage: B = crystals.ShiftedPrimedTableaux([4,3,1], 5)\nsage: b = B.an_element()\nsage: b\n[(1.0, 1.0, 1.0, 1.0), (2.0, 2.0, 2.0), (3.0,)]\nsage: B.weight_lattice_realization()(b.weight())\n(4, 3, 1, 0, 0)\n```",
    "created_at": "2018-01-02T22:24:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316064",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:86'></a>Replying to [comment:85 kbparamonov]:
> That makes sense.
> How do I change type of the weight of crystal elements?


You can do

```
sage: B = crystals.ShiftedPrimedTableaux([4,3,1], 5)
sage: b = B.an_element()
sage: b
[(1.0, 1.0, 1.0, 1.0), (2.0, 2.0, 2.0), (3.0,)]
sage: B.weight_lattice_realization()(b.weight())
(4, 3, 1, 0, 0)
```



---

archive/issue_comments_316065.json:
```json
{
    "body": "<a id='comment:87'></a>I'm still not sure how to implement this.\n\nReplying to [comment:86 aschilling]:\n> Replying to [comment:85 kbparamonov]:\n> > That makes sense.\n> > How do I change type of the weight of crystal elements?\n\n> \n> You can do\n> \n> ```\n> sage: B = crystals.ShiftedPrimedTableaux([4,3,1], 5)\n> sage: b = B.an_element()\n> sage: b\n> [(1.0, 1.0, 1.0, 1.0), (2.0, 2.0, 2.0), (3.0,)]\n> sage: B.weight_lattice_realization()(b.weight())\n> (4, 3, 1, 0, 0)\n> ```",
    "created_at": "2018-01-04T22:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316065",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:87'></a>I'm still not sure how to implement this.

Replying to [comment:86 aschilling]:
> Replying to [comment:85 kbparamonov]:
> > That makes sense.
> > How do I change type of the weight of crystal elements?

> 
> You can do
> 
> ```
> sage: B = crystals.ShiftedPrimedTableaux([4,3,1], 5)
> sage: b = B.an_element()
> sage: b
> [(1.0, 1.0, 1.0, 1.0), (2.0, 2.0, 2.0), (3.0,)]
> sage: B.weight_lattice_realization()(b.weight())
> (4, 3, 1, 0, 0)
> ```



---

archive/issue_comments_316066.json:
```json
{
    "body": "<a id='comment:88'></a>\n```\n        weight = tuple([flat.count(i+1) for i in range(max_ind)])\n        if self._skew is None:\n            P = ShiftedPrimedTableaux(self.shape(), max_element=max_ind)\n            return P.weight_lattice_realization()(weight)\n        return weight\n```\n\n(needs more doctesting)",
    "created_at": "2018-01-05T05:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316066",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:88'></a>
```
        weight = tuple([flat.count(i+1) for i in range(max_ind)])
        if self._skew is None:
            P = ShiftedPrimedTableaux(self.shape(), max_element=max_ind)
            return P.weight_lattice_realization()(weight)
        return weight
```

(needs more doctesting)



---

archive/issue_comments_316067.json:
```json
{
    "body": "<a id='comment:89'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-05T22:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316067",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:89'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316068.json:
```json
{
    "body": "<a id='comment:90'></a>Thanks for help!\n\nReplying to [comment:88 mantepse]:\n> {{{\n>         weight = tuple([flat.count(i+1) for i in range(max_ind)])\n>         if self._skew is None:\n>             P = ShiftedPrimedTableaux(self.shape(), max_element=max_ind)\n>             return P.weight_lattice_realization()(weight)\n>         return weight\n> }}}\n> \n> (needs more doctesting)",
    "created_at": "2018-01-05T22:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316068",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:90'></a>Thanks for help!

Replying to [comment:88 mantepse]:
> {{{
>         weight = tuple([flat.count(i+1) for i in range(max_ind)])
>         if self._skew is None:
>             P = ShiftedPrimedTableaux(self.shape(), max_element=max_ind)
>             return P.weight_lattice_realization()(weight)
>         return weight
> }}}
> 
> (needs more doctesting)



---

archive/issue_comments_316069.json:
```json
{
    "body": "<a id='comment:91'></a>Are you sure that you want to test only the following?\n\n```\nif isinstance(self.parent(), ShiftedPrimedTableaux_shape):\n```\nI don't know - should `weight` only return an element of the `AmbientSpace` when the tableau is initialised with a specific shape?",
    "created_at": "2018-01-05T23:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316069",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:91'></a>Are you sure that you want to test only the following?

```
if isinstance(self.parent(), ShiftedPrimedTableaux_shape):
```
I don't know - should `weight` only return an element of the `AmbientSpace` when the tableau is initialised with a specific shape?



---

archive/issue_comments_316070.json:
```json
{
    "body": "<a id='comment:92'></a>Finally, I am not yet convinced that `list_highest_weight` and possibly also `list_decreasing_weight` should be there, see comment:44 above.",
    "created_at": "2018-01-05T23:31:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316070",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:92'></a>Finally, I am not yet convinced that `list_highest_weight` and possibly also `list_decreasing_weight` should be there, see comment:44 above.



---

archive/issue_comments_316071.json:
```json
{
    "body": "<a id='comment:93'></a>I need\n\n```\n    return self.parent().weight_lattice_realization()(weight)\n```\nfor the fixed-shape tableaux to get the crystal right, which doesn't work for other parents.\nI didn't add that for other parents because we need to change the weight type only for crystal elements.\nIt's not hard to fix this though.\n\nReplying to [comment:91 mantepse]:\n> Are you sure that you want to test only the following?\n> \n> ```\n> if isinstance(self.parent(), ShiftedPrimedTableaux_shape):\n> ```\n> I don't know - should `weight` only return an element of the `AmbientSpace` when the tableau is initialised with a specific shape?\n\n>",
    "created_at": "2018-01-05T23:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316071",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:93'></a>I need

```
    return self.parent().weight_lattice_realization()(weight)
```
for the fixed-shape tableaux to get the crystal right, which doesn't work for other parents.
I didn't add that for other parents because we need to change the weight type only for crystal elements.
It's not hard to fix this though.

Replying to [comment:91 mantepse]:
> Are you sure that you want to test only the following?
> 
> ```
> if isinstance(self.parent(), ShiftedPrimedTableaux_shape):
> ```
> I don't know - should `weight` only return an element of the `AmbientSpace` when the tableau is initialised with a specific shape?

>



---

archive/issue_comments_316072.json:
```json
{
    "body": "<a id='comment:94'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-05T23:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316072",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:94'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316073.json:
```json
{
    "body": "<a id='comment:95'></a>I think `list_decreasing_weight` is useful to get module generators for the crystal.\n\nReplying to [comment:92 mantepse]:\n> Finally, I am not yet convinced that `list_highest_weight` and possibly also `list_decreasing_weight` should be there, see comment:44 above.  \n\n>",
    "created_at": "2018-01-05T23:50:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316073",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:95'></a>I think `list_decreasing_weight` is useful to get module generators for the crystal.

Replying to [comment:92 mantepse]:
> Finally, I am not yet convinced that `list_highest_weight` and possibly also `list_decreasing_weight` should be there, see comment:44 above.  

>



---

archive/issue_comments_316074.json:
```json
{
    "body": "<a id='comment:96'></a>Replying to [comment:95 kbparamonov]:\n> I think `list_decreasing_weight` is useful to get module generators for the crystal.\n> \n> Replying to [comment:92 mantepse]:\n> > Finally, I am not yet convinced that `list_highest_weight` and possibly also `list_decreasing_weight` should be there, see comment:44 above.  \n> > \n\n\nYou could just move that code into `module_generators` as `list_decreasing_weight` is not used elsewhere.",
    "created_at": "2018-01-06T00:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316074",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:96'></a>Replying to [comment:95 kbparamonov]:
> I think `list_decreasing_weight` is useful to get module generators for the crystal.
> 
> Replying to [comment:92 mantepse]:
> > Finally, I am not yet convinced that `list_highest_weight` and possibly also `list_decreasing_weight` should be there, see comment:44 above.  
> > 


You could just move that code into `module_generators` as `list_decreasing_weight` is not used elsewhere.



---

archive/issue_comments_316075.json:
```json
{
    "body": "<a id='comment:97'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-06T01:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316075",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:97'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316076.json:
```json
{
    "body": "<a id='comment:98'></a>I'm afraid I have some more requests, please excuse me.\n\n* for all other varieties of tableaux (eg. `CompositionTableaux`, `SemiStandardTableaux`) the maximal entry is \n\n```\n    - ``size`` -- the size of the composition tableaux\n    - ``shape`` -- the shape of the composition tableaux\n    - ``max_entry`` -- the maximum entry for the composition tableaux\n```\n    so I propose to rename both the parameter and the method from `max_element` to `max_entry`. Also, the alias `max_elt` should be removed.\n\n* the alias `_is_a` should be removed\n\n* this is more a question: should the method `is_highest_weight` really be included?  It would be the only instance of a separately defined `is_highest_weight`, all other crystals use the definition in `categories/crystals.py`.\n\n* currently, modules concerning tableaux follow the naming scheme `adjective_tableau.py`:\n\n```\ncomposition_tableau.py\nk_tableau.py\nlr_tableau.py\nribbon_shaped_tableau.py\nribbon_tableau.py\nskew_tableau.py\n```\n    so I propose to rename the module to `shifted_primed_tableau.py`.\n\n* The docstring of `weight` should be\n\n```\n        Return the weight of ``self``.\n```\n\n* The docstring of `pp` should be\n\n```\n        Pretty print ``self``.\n```\n\n* the doctest of `add_strip` (should this have a leading underscore?) should have an `# indirect doctest` flag:\n\n```\n\n    TESTS::\n\n        sage: list(ShiftedPrimedTableaux([3,1],(2,2)))                # indirect doctest\n        [[(1.0, 1.0, 2.0), (2.0,)], [(1.0, 1.0, 1.5), (2.0,)]]\n\n```\n\nAfter this, and if Anne and Travis agree, I'd say the ticked is done!  Many many thanks!  I will then update #23896 so we have the insertion algorithms, too.",
    "created_at": "2018-01-06T08:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316076",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:98'></a>I'm afraid I have some more requests, please excuse me.

* for all other varieties of tableaux (eg. `CompositionTableaux`, `SemiStandardTableaux`) the maximal entry is 

```
    - ``size`` -- the size of the composition tableaux
    - ``shape`` -- the shape of the composition tableaux
    - ``max_entry`` -- the maximum entry for the composition tableaux
```
    so I propose to rename both the parameter and the method from `max_element` to `max_entry`. Also, the alias `max_elt` should be removed.

* the alias `_is_a` should be removed

* this is more a question: should the method `is_highest_weight` really be included?  It would be the only instance of a separately defined `is_highest_weight`, all other crystals use the definition in `categories/crystals.py`.

* currently, modules concerning tableaux follow the naming scheme `adjective_tableau.py`:

```
composition_tableau.py
k_tableau.py
lr_tableau.py
ribbon_shaped_tableau.py
ribbon_tableau.py
skew_tableau.py
```
    so I propose to rename the module to `shifted_primed_tableau.py`.

* The docstring of `weight` should be

```
        Return the weight of ``self``.
```

* The docstring of `pp` should be

```
        Pretty print ``self``.
```

* the doctest of `add_strip` (should this have a leading underscore?) should have an `# indirect doctest` flag:

```

    TESTS::

        sage: list(ShiftedPrimedTableaux([3,1],(2,2)))                # indirect doctest
        [[(1.0, 1.0, 2.0), (2.0,)], [(1.0, 1.0, 1.5), (2.0,)]]

```

After this, and if Anne and Travis agree, I'd say the ticked is done!  Many many thanks!  I will then update #23896 so we have the insertion algorithms, too.



---

archive/issue_comments_316077.json:
```json
{
    "body": "<a id='comment:99'></a>I agree with Martin's comments! `is_highest_weight` should only be implemented if the explicit implementation is faster than the default one.",
    "created_at": "2018-01-06T16:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316077",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:99'></a>I agree with Martin's comments! `is_highest_weight` should only be implemented if the explicit implementation is faster than the default one.



---

archive/issue_comments_316078.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-06T18:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316078",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316079.json:
```json
{
    "body": "<a id='comment:102'></a>Thank you for your suggestions! \nI agree with everything, except for `is_highest_weight` comment: my implementation checks whether the reading word is Yamanouchi, which is a bit fast than checking each operator `e(i)` directly.\n\nReplying to [comment:98 mantepse]:\n> I'm afraid I have some more requests, please excuse me.\n> \n> * for all other varieties of tableaux (eg. `CompositionTableaux`, `SemiStandardTableaux`) the maximal entry is \n> \n> ```\n>     - ``size`` -- the size of the composition tableaux\n>     - ``shape`` -- the shape of the composition tableaux\n>     - ``max_entry`` -- the maximum entry for the composition tableaux\n> ```\n>     so I propose to rename both the parameter and the method from `max_element` to `max_entry`. Also, the alias `max_elt` should be removed.\n> \n> * the alias `_is_a` should be removed\n> \n> * this is more a question: should the method `is_highest_weight` really be included?  It would be the only instance of a separately defined `is_highest_weight`, all other crystals use the definition in `categories/crystals.py`.\n> \n> * currently, modules concerning tableaux follow the naming scheme `adjective_tableau.py`:\n> \n> ```\n> composition_tableau.py\n> k_tableau.py\n> lr_tableau.py\n> ribbon_shaped_tableau.py\n> ribbon_tableau.py\n> skew_tableau.py\n> ```\n>     so I propose to rename the module to `shifted_primed_tableau.py`.\n> \n> * The docstring of `weight` should be\n> \n> ```\n>         Return the weight of ``self``.\n> ```\n> \n> * The docstring of `pp` should be\n> \n> ```\n>         Pretty print ``self``.\n> ```\n> \n> * the doctest of `add_strip` (should this have a leading underscore?) should have an `# indirect doctest` flag:\n> \n> ```\n> \n>     TESTS::\n> \n>         sage: list(ShiftedPrimedTableaux([3,1],(2,2)))                # indirect doctest\n>         [[(1.0, 1.0, 2.0), (2.0,)], [(1.0, 1.0, 1.5), (2.0,)]]\n> \n> ```\n> \n> After this, and if Anne and Travis agree, I'd say the ticked is done!  Many many thanks!  I will then update #23896 so we have the insertion algorithms, too.",
    "created_at": "2018-01-06T18:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316079",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:102'></a>Thank you for your suggestions! 
I agree with everything, except for `is_highest_weight` comment: my implementation checks whether the reading word is Yamanouchi, which is a bit fast than checking each operator `e(i)` directly.

Replying to [comment:98 mantepse]:
> I'm afraid I have some more requests, please excuse me.
> 
> * for all other varieties of tableaux (eg. `CompositionTableaux`, `SemiStandardTableaux`) the maximal entry is 
> 
> ```
>     - ``size`` -- the size of the composition tableaux
>     - ``shape`` -- the shape of the composition tableaux
>     - ``max_entry`` -- the maximum entry for the composition tableaux
> ```
>     so I propose to rename both the parameter and the method from `max_element` to `max_entry`. Also, the alias `max_elt` should be removed.
> 
> * the alias `_is_a` should be removed
> 
> * this is more a question: should the method `is_highest_weight` really be included?  It would be the only instance of a separately defined `is_highest_weight`, all other crystals use the definition in `categories/crystals.py`.
> 
> * currently, modules concerning tableaux follow the naming scheme `adjective_tableau.py`:
> 
> ```
> composition_tableau.py
> k_tableau.py
> lr_tableau.py
> ribbon_shaped_tableau.py
> ribbon_tableau.py
> skew_tableau.py
> ```
>     so I propose to rename the module to `shifted_primed_tableau.py`.
> 
> * The docstring of `weight` should be
> 
> ```
>         Return the weight of ``self``.
> ```
> 
> * The docstring of `pp` should be
> 
> ```
>         Pretty print ``self``.
> ```
> 
> * the doctest of `add_strip` (should this have a leading underscore?) should have an `# indirect doctest` flag:
> 
> ```
> 
>     TESTS::
> 
>         sage: list(ShiftedPrimedTableaux([3,1],(2,2)))                # indirect doctest
>         [[(1.0, 1.0, 2.0), (2.0,)], [(1.0, 1.0, 1.5), (2.0,)]]
> 
> ```
> 
> After this, and if Anne and Travis agree, I'd say the ticked is done!  Many many thanks!  I will then update #23896 so we have the insertion algorithms, too.



---

archive/issue_comments_316080.json:
```json
{
    "body": "<a id='comment:103'></a>Replying to [comment:102 kbparamonov]:\n> Thank you for your suggestions! \n> I agree with everything, except for `is_highest_weight` comment: my implementation checks whether the reading word is Yamanouchi, which is a bit fast than checking each operator `e(i)` directly.\n\n\nPlease post your timings. Also, to be consistent with the crystal implementation of `is_highest_weight`, it must support an optional `index_set` argument.",
    "created_at": "2018-01-06T18:27:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316080",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:103'></a>Replying to [comment:102 kbparamonov]:
> Thank you for your suggestions! 
> I agree with everything, except for `is_highest_weight` comment: my implementation checks whether the reading word is Yamanouchi, which is a bit fast than checking each operator `e(i)` directly.


Please post your timings. Also, to be consistent with the crystal implementation of `is_highest_weight`, it must support an optional `index_set` argument.



---

archive/issue_comments_316081.json:
```json
{
    "body": "<a id='comment:4'></a>I actually do get better performance.  Kirill's version:\n\n```\nsage: %timeit [a for a in ShiftedPrimedTableaux(shape=[5,3,2], max_entry=4) if a.is_highest_weight()]\n1 loop, best of 3: 5.12 s per loop\nsage: L = [a for a in ShiftedPrimedTableaux(shape=[5,3,2], max_entry=4)]\nsage: len(L)\n960\nsage: %timeit [a for a in L if a.is_highest_weight()]\n10 loops, best of 3: 187 ms per loop\n```\nGeneric version:\n\n```\nsage: %timeit [a for a in ShiftedPrimedTableaux(shape=[5,3,2], max_entry=4) if a.is_highest_weight()]\n1 loop, best of 3: 5.66 s per loop\nsage: L = [a for a in ShiftedPrimedTableaux(shape=[5,3,2], max_entry=4)]\nsage: len(L)\n960\nsage: %timeit [a for a in L if a.is_highest_weight()]\n1 loop, best of 3: 825 ms per loop\n```",
    "created_at": "2018-01-06T19:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316081",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>I actually do get better performance.  Kirill's version:

```
sage: %timeit [a for a in ShiftedPrimedTableaux(shape=[5,3,2], max_entry=4) if a.is_highest_weight()]
1 loop, best of 3: 5.12 s per loop
sage: L = [a for a in ShiftedPrimedTableaux(shape=[5,3,2], max_entry=4)]
sage: len(L)
960
sage: %timeit [a for a in L if a.is_highest_weight()]
10 loops, best of 3: 187 ms per loop
```
Generic version:

```
sage: %timeit [a for a in ShiftedPrimedTableaux(shape=[5,3,2], max_entry=4) if a.is_highest_weight()]
1 loop, best of 3: 5.66 s per loop
sage: L = [a for a in ShiftedPrimedTableaux(shape=[5,3,2], max_entry=4)]
sage: len(L)
960
sage: %timeit [a for a in L if a.is_highest_weight()]
1 loop, best of 3: 825 ms per loop
```



---

archive/issue_comments_316082.json:
```json
{
    "body": "<a id='comment:105'></a>Kirill, I think you forgot to rename the file in the documentation links:\n\n```\n[dochtml] OSError: [combinat ] WARNING: /Applications/sage/src/doc/en/reference/combinat/sage/combinat/tableau_shifted_primed.rst:11: (WARNING/2) autodoc: failed to import module u'sage.combinat.tableau_shifted_primed'; the following exception was raised:\n```",
    "created_at": "2018-01-06T22:21:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316082",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:105'></a>Kirill, I think you forgot to rename the file in the documentation links:

```
[dochtml] OSError: [combinat ] WARNING: /Applications/sage/src/doc/en/reference/combinat/sage/combinat/tableau_shifted_primed.rst:11: (WARNING/2) autodoc: failed to import module u'sage.combinat.tableau_shifted_primed'; the following exception was raised:
```



---

archive/issue_comments_316083.json:
```json
{
    "body": "<a id='comment:106'></a>What file is responsible for generating the documentation? \n\nReplying to [comment:105 aschilling]:\n> Kirill, I think you forgot to rename the file in the documentation links:\n> \n> ```\n> [dochtml] OSError: [combinat ] WARNING: /Applications/sage/src/doc/en/reference/combinat/sage/combinat/tableau_shifted_primed.rst:11: (WARNING/2) autodoc: failed to import module u'sage.combinat.tableau_shifted_primed'; the following exception was raised:\n> ```",
    "created_at": "2018-01-06T22:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316083",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:106'></a>What file is responsible for generating the documentation? 

Replying to [comment:105 aschilling]:
> Kirill, I think you forgot to rename the file in the documentation links:
> 
> ```
> [dochtml] OSError: [combinat ] WARNING: /Applications/sage/src/doc/en/reference/combinat/sage/combinat/tableau_shifted_primed.rst:11: (WARNING/2) autodoc: failed to import module u'sage.combinat.tableau_shifted_primed'; the following exception was raised:
> ```



---

archive/issue_comments_316084.json:
```json
{
    "body": "<a id='comment:107'></a>Replying to [comment:106 kbparamonov]:\n> What file is responsible for generating the documentation? \n\n\n`src/doc/en/reference/combinat/module_list.rst`\n\nAddendum: you also need to change `src/sage/combinat/catalog_partitions.py`.",
    "created_at": "2018-01-06T23:06:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316084",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:107'></a>Replying to [comment:106 kbparamonov]:
> What file is responsible for generating the documentation? 


`src/doc/en/reference/combinat/module_list.rst`

Addendum: you also need to change `src/sage/combinat/catalog_partitions.py`.



---

archive/issue_comments_316085.json:
```json
{
    "body": "<a id='comment:8'></a>I know its somewhat far into this, but I don't like using floating points for the half integers. They are inexact and have a bad representation (e.g., when you raise an error on an invalid object). I think you should have a class that represents the letters in your alphabet. You will have the logic more localized and can better handle input and gives you better control over your letter's behavior. It's more work, but I think it will result in cleaner and easier to maintain code. Internally, you can do half integers (which I would also represent with elements in `QQ`).\n\nHere are some additional comments:\n\n- Revert the changes in `combinat/partition.py` as they are not substantive and could create unnecessary merge conflicts.\n- Your `ShiftedPrimedTableau.__init__` should have a `check` argument that passes it off to `ClonableArray.__init__`.\n- It is good practice to not use `_` as an iterating variable, e.g., `t = [tuple(_) for _ in t]` (normally it is done this way when it is a dummy variable).\n- You need to also implement a `__ne__`:\n  {{{\nsage: t = ShiftedPrimedTableau([This is the Trac macro *1,\"2p\"* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,\"2p\"-macro))\nsage: t != ShiftedPrimedTableaux([2])([1,1.5])\nTrue\n  }}}\n- I think the checking that the shape is a partition should not be done within `check` but in `_element_constructor_`.\n- For the `_repr_`, you should link to the global options of `Tableaux` and mimic that.\n- The fact that you use `max_entry`, which is rounded up, leads to an extra space in the repr for a max entry of `9'`.\n- Is the `_to_matrix()` suppose to only handle non-skew shapes? In particular, I am worried about the `m = self.shape()[0]`.\n- You should put latex format docstring, such as ``i`` in `weight`.\n- Your indentation of numbered lists is 1 too many (it should be at the same level as the rest of the documentation).\n- In `f` and `e`, `self` should never be `None`.\n- Instead of `self.parent()(T)`, you should use `type(self)(self.parent(), T)`.\n- (As previously mentioned) `is_highest_weight` needs to take an `index_set` argument.\n- Classes do not have an `OUTPUT`. Also, I prefer to have `INPUT` after the descriptive text of a class (and methods) doc.\n- Anytime you have latex in a doc, you should make the string a raw string by doing `r\"\"\"`.\n- `None of the Shifted Primed Tableaux classes can be iterated over.` is not true.\n- Capitalization of `Shifted Primed Tableaux` should follow usual English capitalization (it is not a proper noun) in the documentation (not for the `_repr_`).\n- `ShiftedPrimedTableaux` is not a factory class, so the `__classcall_private__` is wrong. For that doc, I would just say \"Normalize and process input to return the correct parent and ensure a unique representation.\"\n- Be explicit about your arguments in `__classcall_private__` instead of having to do extra processing.\n- Do not be afraid to break the 80 char/line in code. For example, I would not do a line break here:\n  {{{\n                        raise ValueError(\n                            'invalid argument for weight or shape')\n  }}}\n- The `ShiftedPrimedTableaux.__contains__` looks effectively like the default one from `Parent`, so I think it could be removed.\n- Similarly for `ShiftedPrimedTableaux_all._element_constructor_`, which looses a more specific error message by the extra handling.\n- I do not understand what you mean by `nonincreasing weight`.\n- Actually, now that I've gotten through more of the code, I think you should implement your check by checking `T in self.parent()` and implementing all the actual checks in the `__contains__`.\n- For the crystals, you can use the iterator from the category.\n- Infinite sets are not a reason you cannot iterate.\n- For the `__contains__` and `_element_constructor_`, use `super` calls.\n- For the `__iter__`, it is not standard practice to return a generator object.\n- You do not need to repeatedly do `Element = ShiftedPrimedTableau`.\n- You should have a subclass of `ShiftedPrimedTableau` specifically for the case when it is a crystal.\n- You have a blank `yield` in `ShiftedPrimedTableaux_weight_shape.__iter__`, and `yield` is not a function.\n- In here `Partition(sorted(list(self._weight), key=int, reverse=True))):`, I don't understand why you need the `key=int` or why you need or should sort `self._weight`.",
    "created_at": "2018-01-07T00:30:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316085",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>I know its somewhat far into this, but I don't like using floating points for the half integers. They are inexact and have a bad representation (e.g., when you raise an error on an invalid object). I think you should have a class that represents the letters in your alphabet. You will have the logic more localized and can better handle input and gives you better control over your letter's behavior. It's more work, but I think it will result in cleaner and easier to maintain code. Internally, you can do half integers (which I would also represent with elements in `QQ`).

Here are some additional comments:

- Revert the changes in `combinat/partition.py` as they are not substantive and could create unnecessary merge conflicts.
- Your `ShiftedPrimedTableau.__init__` should have a `check` argument that passes it off to `ClonableArray.__init__`.
- It is good practice to not use `_` as an iterating variable, e.g., `t = [tuple(_) for _ in t]` (normally it is done this way when it is a dummy variable).
- You need to also implement a `__ne__`:
  {{{
sage: t = ShiftedPrimedTableau([This is the Trac macro *1,"2p"* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,"2p"-macro))
sage: t != ShiftedPrimedTableaux([2])([1,1.5])
True
  }}}
- I think the checking that the shape is a partition should not be done within `check` but in `_element_constructor_`.
- For the `_repr_`, you should link to the global options of `Tableaux` and mimic that.
- The fact that you use `max_entry`, which is rounded up, leads to an extra space in the repr for a max entry of `9'`.
- Is the `_to_matrix()` suppose to only handle non-skew shapes? In particular, I am worried about the `m = self.shape()[0]`.
- You should put latex format docstring, such as ``i`` in `weight`.
- Your indentation of numbered lists is 1 too many (it should be at the same level as the rest of the documentation).
- In `f` and `e`, `self` should never be `None`.
- Instead of `self.parent()(T)`, you should use `type(self)(self.parent(), T)`.
- (As previously mentioned) `is_highest_weight` needs to take an `index_set` argument.
- Classes do not have an `OUTPUT`. Also, I prefer to have `INPUT` after the descriptive text of a class (and methods) doc.
- Anytime you have latex in a doc, you should make the string a raw string by doing `r"""`.
- `None of the Shifted Primed Tableaux classes can be iterated over.` is not true.
- Capitalization of `Shifted Primed Tableaux` should follow usual English capitalization (it is not a proper noun) in the documentation (not for the `_repr_`).
- `ShiftedPrimedTableaux` is not a factory class, so the `__classcall_private__` is wrong. For that doc, I would just say "Normalize and process input to return the correct parent and ensure a unique representation."
- Be explicit about your arguments in `__classcall_private__` instead of having to do extra processing.
- Do not be afraid to break the 80 char/line in code. For example, I would not do a line break here:
  {{{
                        raise ValueError(
                            'invalid argument for weight or shape')
  }}}
- The `ShiftedPrimedTableaux.__contains__` looks effectively like the default one from `Parent`, so I think it could be removed.
- Similarly for `ShiftedPrimedTableaux_all._element_constructor_`, which looses a more specific error message by the extra handling.
- I do not understand what you mean by `nonincreasing weight`.
- Actually, now that I've gotten through more of the code, I think you should implement your check by checking `T in self.parent()` and implementing all the actual checks in the `__contains__`.
- For the crystals, you can use the iterator from the category.
- Infinite sets are not a reason you cannot iterate.
- For the `__contains__` and `_element_constructor_`, use `super` calls.
- For the `__iter__`, it is not standard practice to return a generator object.
- You do not need to repeatedly do `Element = ShiftedPrimedTableau`.
- You should have a subclass of `ShiftedPrimedTableau` specifically for the case when it is a crystal.
- You have a blank `yield` in `ShiftedPrimedTableaux_weight_shape.__iter__`, and `yield` is not a function.
- In here `Partition(sorted(list(self._weight), key=int, reverse=True))):`, I don't understand why you need the `key=int` or why you need or should sort `self._weight`.



---

archive/issue_comments_316086.json:
```json
{
    "body": "<a id='comment:109'></a>Alright, I'll be working on your comments.\n\nReplying to [comment:108 tscrim]:\n> I know its somewhat far into this, but I don't like using floating points for the half integers. They are inexact and have a bad representation (e.g., when you raise an error on an invalid object). I think you should have a class that represents the letters in your alphabet. You will have the logic more localized and can better handle input and gives you better control over your letter's behavior. It's more work, but I think it will result in cleaner and easier to maintain code. Internally, you can do half integers (which I would also represent with elements in `QQ`).\n> \n> Here are some additional comments:\n> \n> - Revert the changes in `combinat/partition.py` as they are not substantive and could create unnecessary merge conflicts.\n> - Your `ShiftedPrimedTableau.__init__` should have a `check` argument that passes it off to `ClonableArray.__init__`.\n> - It is good practice to not use `_` as an iterating variable, e.g., `t = [tuple(_) for _ in t]` (normally it is done this way when it is a dummy variable).\n> - You need to also implement a `__ne__`:\n>   {{{\n> sage: t = ShiftedPrimedTableau([This is the Trac macro *1,\"2p\"* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,\"2p\"-macro))\n> sage: t != ShiftedPrimedTableaux([2])([1,1.5])\n> True\n>   }}}\n> - I think the checking that the shape is a partition should not be done within `check` but in `_element_constructor_`.\n> - For the `_repr_`, you should link to the global options of `Tableaux` and mimic that.\n> - The fact that you use `max_entry`, which is rounded up, leads to an extra space in the repr for a max entry of `9'`.\n> - Is the `_to_matrix()` suppose to only handle non-skew shapes? In particular, I am worried about the `m = self.shape()[0]`.\n> - You should put latex format docstring, such as ``i`` in `weight`.\n> - Your indentation of numbered lists is 1 too many (it should be at the same level as the rest of the documentation).\n> - In `f` and `e`, `self` should never be `None`.\n> - Instead of `self.parent()(T)`, you should use `type(self)(self.parent(), T)`.\n> - (As previously mentioned) `is_highest_weight` needs to take an `index_set` argument.\n> - Classes do not have an `OUTPUT`. Also, I prefer to have `INPUT` after the descriptive text of a class (and methods) doc.\n> - Anytime you have latex in a doc, you should make the string a raw string by doing `r\"\"\"`.\n> - `None of the Shifted Primed Tableaux classes can be iterated over.` is not true.\n> - Capitalization of `Shifted Primed Tableaux` should follow usual English capitalization (it is not a proper noun) in the documentation (not for the `_repr_`).\n> - `ShiftedPrimedTableaux` is not a factory class, so the `__classcall_private__` is wrong. For that doc, I would just say \"Normalize and process input to return the correct parent and ensure a unique representation.\"\n> - Be explicit about your arguments in `__classcall_private__` instead of having to do extra processing.\n> - Do not be afraid to break the 80 char/line in code. For example, I would not do a line break here:\n>   {{{\n>                         raise ValueError(\n>                             'invalid argument for weight or shape')\n>   }}}\n> - The `ShiftedPrimedTableaux.__contains__` looks effectively like the default one from `Parent`, so I think it could be removed.\n> - Similarly for `ShiftedPrimedTableaux_all._element_constructor_`, which looses a more specific error message by the extra handling.\n> - I do not understand what you mean by `nonincreasing weight`.\n> - Actually, now that I've gotten through more of the code, I think you should implement your check by checking `T in self.parent()` and implementing all the actual checks in the `__contains__`.\n> - For the crystals, you can use the iterator from the category.\n> - Infinite sets are not a reason you cannot iterate.\n> - For the `__contains__` and `_element_constructor_`, use `super` calls.\n> - For the `__iter__`, it is not standard practice to return a generator object.\n> - You do not need to repeatedly do `Element = ShiftedPrimedTableau`.\n> - You should have a subclass of `ShiftedPrimedTableau` specifically for the case when it is a crystal.\n> - You have a blank `yield` in `ShiftedPrimedTableaux_weight_shape.__iter__`, and `yield` is not a function.\n> - In here `Partition(sorted(list(self._weight), key=int, reverse=True))):`, I don't understand why you need the `key=int` or why you need or should sort `self._weight`.",
    "created_at": "2018-01-08T20:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316086",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:109'></a>Alright, I'll be working on your comments.

Replying to [comment:108 tscrim]:
> I know its somewhat far into this, but I don't like using floating points for the half integers. They are inexact and have a bad representation (e.g., when you raise an error on an invalid object). I think you should have a class that represents the letters in your alphabet. You will have the logic more localized and can better handle input and gives you better control over your letter's behavior. It's more work, but I think it will result in cleaner and easier to maintain code. Internally, you can do half integers (which I would also represent with elements in `QQ`).
> 
> Here are some additional comments:
> 
> - Revert the changes in `combinat/partition.py` as they are not substantive and could create unnecessary merge conflicts.
> - Your `ShiftedPrimedTableau.__init__` should have a `check` argument that passes it off to `ClonableArray.__init__`.
> - It is good practice to not use `_` as an iterating variable, e.g., `t = [tuple(_) for _ in t]` (normally it is done this way when it is a dummy variable).
> - You need to also implement a `__ne__`:
>   {{{
> sage: t = ShiftedPrimedTableau([This is the Trac macro *1,"2p"* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,"2p"-macro))
> sage: t != ShiftedPrimedTableaux([2])([1,1.5])
> True
>   }}}
> - I think the checking that the shape is a partition should not be done within `check` but in `_element_constructor_`.
> - For the `_repr_`, you should link to the global options of `Tableaux` and mimic that.
> - The fact that you use `max_entry`, which is rounded up, leads to an extra space in the repr for a max entry of `9'`.
> - Is the `_to_matrix()` suppose to only handle non-skew shapes? In particular, I am worried about the `m = self.shape()[0]`.
> - You should put latex format docstring, such as ``i`` in `weight`.
> - Your indentation of numbered lists is 1 too many (it should be at the same level as the rest of the documentation).
> - In `f` and `e`, `self` should never be `None`.
> - Instead of `self.parent()(T)`, you should use `type(self)(self.parent(), T)`.
> - (As previously mentioned) `is_highest_weight` needs to take an `index_set` argument.
> - Classes do not have an `OUTPUT`. Also, I prefer to have `INPUT` after the descriptive text of a class (and methods) doc.
> - Anytime you have latex in a doc, you should make the string a raw string by doing `r"""`.
> - `None of the Shifted Primed Tableaux classes can be iterated over.` is not true.
> - Capitalization of `Shifted Primed Tableaux` should follow usual English capitalization (it is not a proper noun) in the documentation (not for the `_repr_`).
> - `ShiftedPrimedTableaux` is not a factory class, so the `__classcall_private__` is wrong. For that doc, I would just say "Normalize and process input to return the correct parent and ensure a unique representation."
> - Be explicit about your arguments in `__classcall_private__` instead of having to do extra processing.
> - Do not be afraid to break the 80 char/line in code. For example, I would not do a line break here:
>   {{{
>                         raise ValueError(
>                             'invalid argument for weight or shape')
>   }}}
> - The `ShiftedPrimedTableaux.__contains__` looks effectively like the default one from `Parent`, so I think it could be removed.
> - Similarly for `ShiftedPrimedTableaux_all._element_constructor_`, which looses a more specific error message by the extra handling.
> - I do not understand what you mean by `nonincreasing weight`.
> - Actually, now that I've gotten through more of the code, I think you should implement your check by checking `T in self.parent()` and implementing all the actual checks in the `__contains__`.
> - For the crystals, you can use the iterator from the category.
> - Infinite sets are not a reason you cannot iterate.
> - For the `__contains__` and `_element_constructor_`, use `super` calls.
> - For the `__iter__`, it is not standard practice to return a generator object.
> - You do not need to repeatedly do `Element = ShiftedPrimedTableau`.
> - You should have a subclass of `ShiftedPrimedTableau` specifically for the case when it is a crystal.
> - You have a blank `yield` in `ShiftedPrimedTableaux_weight_shape.__iter__`, and `yield` is not a function.
> - In here `Partition(sorted(list(self._weight), key=int, reverse=True))):`, I don't understand why you need the `key=int` or why you need or should sort `self._weight`.



---

archive/issue_comments_316087.json:
```json
{
    "body": "<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-16T23:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316087",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316088.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-18T01:06:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316088",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316089.json:
```json
{
    "body": "<a id='comment:112'></a>Alright, I've addressed Travis' comments. The code is ready for another review.\n\nReplying to [comment:111 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                        |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n> |[ea347f7](https://git.sagemath.org/sage.git/commit/?id=ea347f74dd96d9955622a930f9658560e0ead65d)|`Added class of entries`|",
    "created_at": "2018-01-18T01:08:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316089",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:112'></a>Alright, I've addressed Travis' comments. The code is ready for another review.

Replying to [comment:111 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                        |
> |-------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
> |[ea347f7](https://git.sagemath.org/sage.git/commit/?id=ea347f74dd96d9955622a930f9658560e0ead65d)|`Added class of entries`|



---

archive/issue_comments_316090.json:
```json
{
    "body": "<a id='comment:3'></a>The documentation does not compile:\n\n```\n[dochtml] OSError: [combinat ] /Applications/sage/local/lib/python2.7/site-packages/sage/combinat/shifted_primed_tableau.py:docstring of sage.combinat.shifted_primed_tableau.CrystalElementShiftedPrimedTableau.reading_word:10: WARNING: Unexpected indentation.\n[dochtml] \nmake[2]: *** [doc-html] Error 1\n```",
    "created_at": "2018-01-20T16:56:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316090",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:3'></a>The documentation does not compile:

```
[dochtml] OSError: [combinat ] /Applications/sage/local/lib/python2.7/site-packages/sage/combinat/shifted_primed_tableau.py:docstring of sage.combinat.shifted_primed_tableau.CrystalElementShiftedPrimedTableau.reading_word:10: WARNING: Unexpected indentation.
[dochtml] 
make[2]: *** [doc-html] Error 1
```



---

archive/issue_comments_316091.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-20T18:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316091",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316092.json:
```json
{
    "body": "<a id='comment:5'></a>The weight of a skew shifted tableau currently fails:\n\n```\nsage: s = ShiftedPrimedTableau([(1, 3.5), (2.5,), (6,)], skew=[2,1])\nsage: s.weight()\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-194-c0897c3f66a5> in <module>()\n----> 1 s.weight()\n\n/home/martin/sage-develop/src/sage/combinat/shifted_primed_tableau.py in weight(self)\n    697            (1, 4, 1)\n    698 \n--> 699            sage: s = ShiftedPrimedTableau([(1, 3.5), (2.5,), (6,)], skew=[2,1])\n    700            sage: s.weight()\n    701         \"\"\"\n\nAttributeError: 'NoneType' object has no attribute 'unprime'\n```\nA fix would be\n\n```\n    def weight(self):\n        r\"\"\"\n        Return the weight of ``self``.\n\n        The weight of a shifted primed tableau is defined to be the vector\n        with `i`-th component equal to the number of entries i and i' in the\n        tableau.\n\n        EXAMPLES::\n\n           sage: t = ShiftedPrimedTableau([[1,'2p',2,2],[2,'3p']])\n           sage: t.weight()\n           (1, 4, 1)\n\n           sage: s = ShiftedPrimedTableau([(1, 3.5), (2.5,), (6,)], skew=[2,1])\n           sage: s.weight()\n           (1, 0, 1, 1, 0, 1)\n        \"\"\"\n        flat = [entry.unprime() for row in self for entry in row if entry is not None]\n        if flat == []:\n            max_ind = 0\n        else:\n            max_ind = max(flat)\n        weight = tuple([flat.count(i+1) for i in range(max_ind)])\n        return weight\n```\n\nIt might be good to test a skew tableau in all methods.",
    "created_at": "2018-01-21T13:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316092",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:5'></a>The weight of a skew shifted tableau currently fails:

```
sage: s = ShiftedPrimedTableau([(1, 3.5), (2.5,), (6,)], skew=[2,1])
sage: s.weight()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-194-c0897c3f66a5> in <module>()
----> 1 s.weight()

/home/martin/sage-develop/src/sage/combinat/shifted_primed_tableau.py in weight(self)
    697            (1, 4, 1)
    698 
--> 699            sage: s = ShiftedPrimedTableau([(1, 3.5), (2.5,), (6,)], skew=[2,1])
    700            sage: s.weight()
    701         """

AttributeError: 'NoneType' object has no attribute 'unprime'
```
A fix would be

```
    def weight(self):
        r"""
        Return the weight of ``self``.

        The weight of a shifted primed tableau is defined to be the vector
        with `i`-th component equal to the number of entries i and i' in the
        tableau.

        EXAMPLES::

           sage: t = ShiftedPrimedTableau([[1,'2p',2,2],[2,'3p']])
           sage: t.weight()
           (1, 4, 1)

           sage: s = ShiftedPrimedTableau([(1, 3.5), (2.5,), (6,)], skew=[2,1])
           sage: s.weight()
           (1, 0, 1, 1, 0, 1)
        """
        flat = [entry.unprime() for row in self for entry in row if entry is not None]
        if flat == []:
            max_ind = 0
        else:
            max_ind = max(flat)
        weight = tuple([flat.count(i+1) for i in range(max_ind)])
        return weight
```

It might be good to test a skew tableau in all methods.



---

archive/issue_comments_316093.json:
```json
{
    "body": "<a id='comment:6'></a>I am not completely sure, but it might be that there is also a speed regression:\n\n```\nmartin@Martin-Laptop:~/sage-develop$ sage -t src/sage/combinat/shifted_primed_tableau.py \ntoo many failed tests, not using stored timings\nRunning doctests with ID 2018-01-21-14-48-10-0647444a.\nGit branch: HEAD\nUsing --optional=atlas,database_gap,dot2tex,fricas,gap_packages,mpir,ore_algebra,python2,sage\nDoctesting 1 file.\nsage -t src/sage/combinat/shifted_primed_tableau.py\n    [218 tests, 48.25 s]\n```\n\nI think it was much faster before, but I did not take notes :-(",
    "created_at": "2018-01-21T13:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316093",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'></a>I am not completely sure, but it might be that there is also a speed regression:

```
martin@Martin-Laptop:~/sage-develop$ sage -t src/sage/combinat/shifted_primed_tableau.py 
too many failed tests, not using stored timings
Running doctests with ID 2018-01-21-14-48-10-0647444a.
Git branch: HEAD
Using --optional=atlas,database_gap,dot2tex,fricas,gap_packages,mpir,ore_algebra,python2,sage
Doctesting 1 file.
sage -t src/sage/combinat/shifted_primed_tableau.py
    [218 tests, 48.25 s]
```

I think it was much faster before, but I did not take notes :-(



---

archive/issue_comments_316094.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-21T17:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316094",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316095.json:
```json
{
    "body": "<a id='comment:118'></a>Thanks for comments, Martin! I had a speedup on my computer actually.\n\n```\nsage -t shifted_primed_tableau.py\n    [199 tests, 11.27 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 11.4 seconds\n    cpu time: 11.0 seconds\n    cumulative wall time: 11.3 seconds\n```\n\n\nReplying to [comment:116 mantepse]:\n> I am not completely sure, but it might be that there is also a speed regression:\n> \n> ```\n> martin@Martin-Laptop:~/sage-develop$ sage -t src/sage/combinat/shifted_primed_tableau.py \n> too many failed tests, not using stored timings\n> Running doctests with ID 2018-01-21-14-48-10-0647444a.\n> Git branch: HEAD\n> Using --optional=atlas,database_gap,dot2tex,fricas,gap_packages,mpir,ore_algebra,python2,sage\n> Doctesting 1 file.\n> sage -t src/sage/combinat/shifted_primed_tableau.py\n>     [218 tests, 48.25 s]\n> ```\n> \n> I think it was much faster before, but I did not take notes :-(",
    "created_at": "2018-01-21T17:31:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316095",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:118'></a>Thanks for comments, Martin! I had a speedup on my computer actually.

```
sage -t shifted_primed_tableau.py
    [199 tests, 11.27 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 11.4 seconds
    cpu time: 11.0 seconds
    cumulative wall time: 11.3 seconds
```


Replying to [comment:116 mantepse]:
> I am not completely sure, but it might be that there is also a speed regression:
> 
> ```
> martin@Martin-Laptop:~/sage-develop$ sage -t src/sage/combinat/shifted_primed_tableau.py 
> too many failed tests, not using stored timings
> Running doctests with ID 2018-01-21-14-48-10-0647444a.
> Git branch: HEAD
> Using --optional=atlas,database_gap,dot2tex,fricas,gap_packages,mpir,ore_algebra,python2,sage
> Doctesting 1 file.
> sage -t src/sage/combinat/shifted_primed_tableau.py
>     [218 tests, 48.25 s]
> ```
> 
> I think it was much faster before, but I did not take notes :-(



---

archive/issue_comments_316096.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-21T17:46:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316096",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316097.json:
```json
{
    "body": "<a id='comment:0'></a>For me the tests on `shifted_primed_tableau` also only take about 9 seconds. There are still a couple of methods without proper tests:\n\n```\nsage -coverage shifted_primed_tableau.py \n------------------------------------------------------------------------\nSCORE shifted_primed_tableau.py: 93.2% (55 of 59)\n\nMissing doctests:\n     * line 140: def _preprocess_(T, skew=None)\n     * line 1128: def __init__(self, skew=None)\n     * line 1134: def _element_constructor_(self, T)\n     * line 1153: def _contains_tableau_(self, T)\n\nPossibly wrong (function name doesn't occur in doctests):\n     * line 241: def _repr_list(self)\n------------------------------------------------------------------------\n```\nAfter that I am happy to set a positive review unless other issues arise!",
    "created_at": "2018-01-21T18:00:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316097",
    "user": "https://github.com/anneschilling"
}
```

<a id='comment:0'></a>For me the tests on `shifted_primed_tableau` also only take about 9 seconds. There are still a couple of methods without proper tests:

```
sage -coverage shifted_primed_tableau.py 
------------------------------------------------------------------------
SCORE shifted_primed_tableau.py: 93.2% (55 of 59)

Missing doctests:
     * line 140: def _preprocess_(T, skew=None)
     * line 1128: def __init__(self, skew=None)
     * line 1134: def _element_constructor_(self, T)
     * line 1153: def _contains_tableau_(self, T)

Possibly wrong (function name doesn't occur in doctests):
     * line 241: def _repr_list(self)
------------------------------------------------------------------------
```
After that I am happy to set a positive review unless other issues arise!



---

archive/issue_comments_316098.json:
```json
{
    "body": "<a id='comment:1'></a>I checked, on my office computer tests also take only about 8 seconds.  On my laptop, there is precisely one test which takes more than one second:\n\n```\nTrying (line 1502):    TestSuite(ShiftedPrimedTableaux([4,2,1], max_entry=4)).run()\nExpecting nothing\nok [44.84 s]\n```",
    "created_at": "2018-01-21T18:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316098",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'></a>I checked, on my office computer tests also take only about 8 seconds.  On my laptop, there is precisely one test which takes more than one second:

```
Trying (line 1502):    TestSuite(ShiftedPrimedTableaux([4,2,1], max_entry=4)).run()
Expecting nothing
ok [44.84 s]
```



---

archive/issue_comments_316099.json:
```json
{
    "body": "<a id='comment:2'></a>The following change makes quite a difference.  After the change, most of the time is spent in `QQ(entry)`.\n\n```\ndiff --git a/src/sage/combinat/shifted_primed_tableau.py b/src/sage/combinat/shifted_primed_tableau.py\nindex 266e556..8057497 100644\n--- a/src/sage/combinat/shifted_primed_tableau.py\n+++ b/src/sage/combinat/shifted_primed_tableau.py\n@@ -884,15 +884,14 @@ class ShiftedPrimedTableauEntry(Rational):\n             sage: ShiftedPrimedTableau([[1,1.5]])[0][1]\n             2'\n         \"\"\"\n+        half = Integer(1)/Integer(2)\n         if isinstance(entry, str):\n             if (entry[-1] == \"'\" or entry[-1] == \"p\") and entry[:-1].isdigit() is True:\n                 # Check if an element has \"'\" or \"p\" at the end\n-                entry = QQ(entry[:-1]) - .5\n+                entry = QQ(entry[:-1]) - half\n         try:\n-            if (QQ(entry)+.5 in ZZ) or (QQ(entry) in ZZ):\n-                # Check if an element is a half-integer\n-                entry = QQ(entry)\n-            else:\n+            entry = QQ(entry)\n+            if (entry not in ZZ) and ((entry + half) not in ZZ):\n                 raise ValueError(\"all numbers must be half-integers\")\n         except (TypeError, ValueError):\n             raise ValueError(\"primed elements have wrong format\")\n```",
    "created_at": "2018-01-21T19:01:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316099",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>The following change makes quite a difference.  After the change, most of the time is spent in `QQ(entry)`.

```
diff --git a/src/sage/combinat/shifted_primed_tableau.py b/src/sage/combinat/shifted_primed_tableau.py
index 266e556..8057497 100644
--- a/src/sage/combinat/shifted_primed_tableau.py
+++ b/src/sage/combinat/shifted_primed_tableau.py
@@ -884,15 +884,14 @@ class ShiftedPrimedTableauEntry(Rational):
             sage: ShiftedPrimedTableau([[1,1.5]])[0][1]
             2'
         """
+        half = Integer(1)/Integer(2)
         if isinstance(entry, str):
             if (entry[-1] == "'" or entry[-1] == "p") and entry[:-1].isdigit() is True:
                 # Check if an element has "'" or "p" at the end
-                entry = QQ(entry[:-1]) - .5
+                entry = QQ(entry[:-1]) - half
         try:
-            if (QQ(entry)+.5 in ZZ) or (QQ(entry) in ZZ):
-                # Check if an element is a half-integer
-                entry = QQ(entry)
-            else:
+            entry = QQ(entry)
+            if (entry not in ZZ) and ((entry + half) not in ZZ):
                 raise ValueError("all numbers must be half-integers")
         except (TypeError, ValueError):
             raise ValueError("primed elements have wrong format")
```



---

archive/issue_comments_316100.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-21T19:42:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316100",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316101.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-21T19:59:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316101",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316102.json:
```json
{
    "body": "<a id='comment:125'></a>Try it now, it should work faster.\n\nReplying to [comment:122 mantepse]:\n> The following change makes quite a difference.  After the change, most of the time is spent in `QQ(entry)`.\n> \n> ```\n> diff --git a/src/sage/combinat/shifted_primed_tableau.py b/src/sage/combinat/shifted_primed_tableau.py\n> index 266e556..8057497 100644\n> --- a/src/sage/combinat/shifted_primed_tableau.py\n> +++ b/src/sage/combinat/shifted_primed_tableau.py\n> @@ -884,15 +884,14 @@ class ShiftedPrimedTableauEntry(Rational):\n>              sage: ShiftedPrimedTableau([[1,1.5]])[0][1]\n>              2'\n>          \"\"\"\n> +        half = Integer(1)/Integer(2)\n>          if isinstance(entry, str):\n>              if (entry[-1] == \"'\" or entry[-1] == \"p\") and entry[:-1].isdigit() is True:\n>                  # Check if an element has \"'\" or \"p\" at the end\n> -                entry = QQ(entry[:-1]) - .5\n> +                entry = QQ(entry[:-1]) - half\n>          try:\n> -            if (QQ(entry)+.5 in ZZ) or (QQ(entry) in ZZ):\n> -                # Check if an element is a half-integer\n> -                entry = QQ(entry)\n> -            else:\n> +            entry = QQ(entry)\n> +            if (entry not in ZZ) and ((entry + half) not in ZZ):\n>                  raise ValueError(\"all numbers must be half-integers\")\n>          except (TypeError, ValueError):\n>              raise ValueError(\"primed elements have wrong format\")\n> ```",
    "created_at": "2018-01-21T20:01:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316102",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:125'></a>Try it now, it should work faster.

Replying to [comment:122 mantepse]:
> The following change makes quite a difference.  After the change, most of the time is spent in `QQ(entry)`.
> 
> ```
> diff --git a/src/sage/combinat/shifted_primed_tableau.py b/src/sage/combinat/shifted_primed_tableau.py
> index 266e556..8057497 100644
> --- a/src/sage/combinat/shifted_primed_tableau.py
> +++ b/src/sage/combinat/shifted_primed_tableau.py
> @@ -884,15 +884,14 @@ class ShiftedPrimedTableauEntry(Rational):
>              sage: ShiftedPrimedTableau([[1,1.5]])[0][1]
>              2'
>          """
> +        half = Integer(1)/Integer(2)
>          if isinstance(entry, str):
>              if (entry[-1] == "'" or entry[-1] == "p") and entry[:-1].isdigit() is True:
>                  # Check if an element has "'" or "p" at the end
> -                entry = QQ(entry[:-1]) - .5
> +                entry = QQ(entry[:-1]) - half
>          try:
> -            if (QQ(entry)+.5 in ZZ) or (QQ(entry) in ZZ):
> -                # Check if an element is a half-integer
> -                entry = QQ(entry)
> -            else:
> +            entry = QQ(entry)
> +            if (entry not in ZZ) and ((entry + half) not in ZZ):
>                  raise ValueError("all numbers must be half-integers")
>          except (TypeError, ValueError):
>              raise ValueError("primed elements have wrong format")
> ```



---

archive/issue_comments_316103.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-21T20:05:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316104.json:
```json
{
    "body": "<a id='comment:7'></a>Indeed, it is faster now.  However, I now realise that I do not understand the logic of `ShiftedPrimedTableauEntry.__init__`:\n\n* removing the call to `float` in `ShiftedPrimedTableauEntry.__add__` makes `__init__` break - why?\n\n* the check for half-integer could also be done using `entry.denominator() in (1, 2)`.",
    "created_at": "2018-01-21T21:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316104",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:7'></a>Indeed, it is faster now.  However, I now realise that I do not understand the logic of `ShiftedPrimedTableauEntry.__init__`:

* removing the call to `float` in `ShiftedPrimedTableauEntry.__add__` makes `__init__` break - why?

* the check for half-integer could also be done using `entry.denominator() in (1, 2)`.



---

archive/issue_comments_316105.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-21T23:04:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316105",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316106.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-21T23:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316106",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316107.json:
```json
{
    "body": "<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-21T23:12:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316107",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:0'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316108.json:
```json
{
    "body": "<a id='comment:131'></a>Alright, I've reworked the add function, it was too janky.\n\nReplying to [comment:127 mantepse]:\n> Indeed, it is faster now.  However, I now realise that I do not understand the logic of `ShiftedPrimedTableauEntry.__init__`:\n> \n> * removing the call to `float` in `ShiftedPrimedTableauEntry.__add__` makes `__init__` break - why?\n> \n> * the check for half-integer could also be done using `entry.denominator() in (1, 2)`.",
    "created_at": "2018-01-21T23:13:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316108",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:131'></a>Alright, I've reworked the add function, it was too janky.

Replying to [comment:127 mantepse]:
> Indeed, it is faster now.  However, I now realise that I do not understand the logic of `ShiftedPrimedTableauEntry.__init__`:
> 
> * removing the call to `float` in `ShiftedPrimedTableauEntry.__add__` makes `__init__` break - why?
> 
> * the check for half-integer could also be done using `entry.denominator() in (1, 2)`.



---

archive/issue_comments_316109.json:
```json
{
    "body": "<a id='comment:2'></a>It is **much** faster now, and easier to understand!\n\nVery tiny thing: I would suggest to rename\n\n```\n    def unprime(self):\n```\nto\n\n```\n    def unprimed(self):\n```\nbecause it doesn't modify self (of course).\n\nTravis, could you please do the final check?",
    "created_at": "2018-01-22T07:26:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316109",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>It is **much** faster now, and easier to understand!

Very tiny thing: I would suggest to rename

```
    def unprime(self):
```
to

```
    def unprimed(self):
```
because it doesn't modify self (of course).

Travis, could you please do the final check?



---

archive/issue_comments_316110.json:
```json
{
    "body": "<a id='comment:3'></a>Sorry, I haven't had time the past few days and most likely will not for the next few (but I will try). However, on a quick look, I do not like the tableau entries inheriting from `Rational` because they do not behave like rationals: they do not have a parent object, they do not have \"actual\" arithmetic, and they are not rational numbers in the usual sense. In a way, you override the methods precisely why you are inheriting from `Rational`. I think you would be better wrapping a `Rational`, but I would like to Cythonize it (which I can do once I have a few minutes).",
    "created_at": "2018-01-24T05:48:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316110",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>Sorry, I haven't had time the past few days and most likely will not for the next few (but I will try). However, on a quick look, I do not like the tableau entries inheriting from `Rational` because they do not behave like rationals: they do not have a parent object, they do not have "actual" arithmetic, and they are not rational numbers in the usual sense. In a way, you override the methods precisely why you are inheriting from `Rational`. I think you would be better wrapping a `Rational`, but I would like to Cythonize it (which I can do once I have a few minutes).



---

archive/issue_comments_316111.json:
```json
{
    "body": "<a id='comment:4'></a>Travis, isn't that an implementation detail, mostly private?  A lot of time already went into this ticket, I would think it might be better to go in for now...\n\nAnyway I also thought a wrapper would be more logical.  To be precise, it should be a poset, but that's probably overkill.\n\nEDIT: corrected version.\n\n```\nclass PrimedEntry(SageObject):\n    \"\"\"\n    The class of entries in shifted primed tableaux.\n    \"\"\"\n    def __init__(self, entry=None, double=None):\n        \"\"\"\n        Normalize the entry.\n\n        TEST::\n\n            sage: ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n            2'\n            sage: ShiftedPrimedTableau([[1,\"2'\"]])[0][1]\n            2'\n            sage: ShiftedPrimedTableau([[1,1.5]])[0][1]\n            2'\n        \"\"\"\n        # store primed numbers as odd, unprimed numbers as even integers\n        if isinstance(entry, self.__class__):\n            self._entry = entry._entry\n            return\n\n        if double is not None:\n            self._entry = Integer(double)\n            return\n\n        if isinstance(entry, str):\n            if (entry[-1] == \"'\" or entry[-1] == \"p\") and entry[:-1].isdigit() is True:\n                # Check if an element has \"'\" or \"p\" at the end\n                self._entry = 2*Integer(entry[:-1]) - 1\n                return\n\n        try:\n            entry = Rational(entry)\n        except (TypeError, ValueError):\n            raise ValueError(\"primed elements have wrong format\")\n        if entry.denominator() not in (1, 2):\n            # Check if an element is a half-integer\n            raise ValueError(\"all numbers must be half-integers\")\n        self._entry = Integer(2*entry)\n\n    def __hash__(self):\n        return self._entry\n\n    def __repr__(self):\n        \"\"\"\n        Represent ``self`` as primed or unprimed integer.\n\n        TEST::\n\n            sage: ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n            2'\n        \"\"\"\n        if is_even(self._entry):\n            return str(self._entry//2)\n        else:\n            return str((self._entry+1)//2) + \"'\"\n\n    def integer(self):\n        return self._entry//2\n\n    def __eq__(self, other):\n        return self._entry == PrimedEntry(other)._entry\n\n    def __ne__(self, other):\n        return self._entry != PrimedEntry(other)._entry\n\n    def __lt__(self, other):\n        return self._entry < PrimedEntry(other)._entry\n\n    def __le__(self, other):\n        return self._entry <= PrimedEntry(other)._entry\n\n    def __gt__(self, other):\n        return self._entry > PrimedEntry(other)._entry\n\n    def __ge__(self, other):\n        return self._entry >= PrimedEntry(other)._entry\n\n    def is_unprimed(self):\n        \"\"\"\n        Checks if ``self`` is an unprimed element.\n\n        TEST::\n\n            sage: a = ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n            sage: a.is_unprimed()\n            False\n        \"\"\"\n        return is_even(self._entry)\n\n    def is_primed(self):\n        \"\"\"\n        Checks if ``self`` is a primed element.\n\n        TEST::\n\n            sage: a = ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n            sage: a.is_primed()\n            True\n        \"\"\"\n        return is_odd(self._entry)\n\n    def unprimed(self):\n        \"\"\"\n        Unprime ``self`` if it is a primed element.\n\n        TEST::\n\n            sage: a = ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n            sage: a.unprimed()\n            2\n        \"\"\"\n        if is_even(self._entry):\n            return self\n        else:\n            return PrimedEntry(double=self._entry + 1)\n\n    def primed(self):\n        \"\"\"\n        Prime ``self`` if it is an unprimed element.\n\n        TEST::\n\n            sage: a = ShiftedPrimedTableau([[1,\"2p\"]])[0][0]\n            sage: a.primed()\n            1'\n        \"\"\"\n\n        if is_even(self._entry):\n            return PrimedEntry(double=self._entry - 1)\n        else:\n            return self\n\n    def increase_half(self):\n        return PrimedEntry(double=self._entry + 1)\n\n    def decrease_half(self):\n        return PrimedEntry(double=self._entry - 1)\n\n    def increase_one(self):\n        return PrimedEntry(double=self._entry + 2)\n\n    def decrease_one(self):\n        return PrimedEntry(double=self._entry - 2)\n```",
    "created_at": "2018-01-24T06:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316111",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>Travis, isn't that an implementation detail, mostly private?  A lot of time already went into this ticket, I would think it might be better to go in for now...

Anyway I also thought a wrapper would be more logical.  To be precise, it should be a poset, but that's probably overkill.

EDIT: corrected version.

```
class PrimedEntry(SageObject):
    """
    The class of entries in shifted primed tableaux.
    """
    def __init__(self, entry=None, double=None):
        """
        Normalize the entry.

        TEST::

            sage: ShiftedPrimedTableau([[1,"2p"]])[0][1]
            2'
            sage: ShiftedPrimedTableau([[1,"2'"]])[0][1]
            2'
            sage: ShiftedPrimedTableau([[1,1.5]])[0][1]
            2'
        """
        # store primed numbers as odd, unprimed numbers as even integers
        if isinstance(entry, self.__class__):
            self._entry = entry._entry
            return

        if double is not None:
            self._entry = Integer(double)
            return

        if isinstance(entry, str):
            if (entry[-1] == "'" or entry[-1] == "p") and entry[:-1].isdigit() is True:
                # Check if an element has "'" or "p" at the end
                self._entry = 2*Integer(entry[:-1]) - 1
                return

        try:
            entry = Rational(entry)
        except (TypeError, ValueError):
            raise ValueError("primed elements have wrong format")
        if entry.denominator() not in (1, 2):
            # Check if an element is a half-integer
            raise ValueError("all numbers must be half-integers")
        self._entry = Integer(2*entry)

    def __hash__(self):
        return self._entry

    def __repr__(self):
        """
        Represent ``self`` as primed or unprimed integer.

        TEST::

            sage: ShiftedPrimedTableau([[1,"2p"]])[0][1]
            2'
        """
        if is_even(self._entry):
            return str(self._entry//2)
        else:
            return str((self._entry+1)//2) + "'"

    def integer(self):
        return self._entry//2

    def __eq__(self, other):
        return self._entry == PrimedEntry(other)._entry

    def __ne__(self, other):
        return self._entry != PrimedEntry(other)._entry

    def __lt__(self, other):
        return self._entry < PrimedEntry(other)._entry

    def __le__(self, other):
        return self._entry <= PrimedEntry(other)._entry

    def __gt__(self, other):
        return self._entry > PrimedEntry(other)._entry

    def __ge__(self, other):
        return self._entry >= PrimedEntry(other)._entry

    def is_unprimed(self):
        """
        Checks if ``self`` is an unprimed element.

        TEST::

            sage: a = ShiftedPrimedTableau([[1,"2p"]])[0][1]
            sage: a.is_unprimed()
            False
        """
        return is_even(self._entry)

    def is_primed(self):
        """
        Checks if ``self`` is a primed element.

        TEST::

            sage: a = ShiftedPrimedTableau([[1,"2p"]])[0][1]
            sage: a.is_primed()
            True
        """
        return is_odd(self._entry)

    def unprimed(self):
        """
        Unprime ``self`` if it is a primed element.

        TEST::

            sage: a = ShiftedPrimedTableau([[1,"2p"]])[0][1]
            sage: a.unprimed()
            2
        """
        if is_even(self._entry):
            return self
        else:
            return PrimedEntry(double=self._entry + 1)

    def primed(self):
        """
        Prime ``self`` if it is an unprimed element.

        TEST::

            sage: a = ShiftedPrimedTableau([[1,"2p"]])[0][0]
            sage: a.primed()
            1'
        """

        if is_even(self._entry):
            return PrimedEntry(double=self._entry - 1)
        else:
            return self

    def increase_half(self):
        return PrimedEntry(double=self._entry + 1)

    def decrease_half(self):
        return PrimedEntry(double=self._entry - 1)

    def increase_one(self):
        return PrimedEntry(double=self._entry + 2)

    def decrease_one(self):
        return PrimedEntry(double=self._entry - 2)
```



---

archive/issue_comments_316112.json:
```json
{
    "body": "<a id='comment:5'></a>Attachment [shifted_primed_tableau.py](tarball://root/attachments/some-uuid/ticket22921/shifted_primed_tableau.py) by @mantepse created at 2018-01-24 21:17:19\n\nI spent some time abstracting `PrimedEntry`, but the performance is not really good.  Moreover, this raises the question whether the elements of the reading word should be integers or `PrimedEntry`s.\n\nI attached the file in case it is of any interest.",
    "created_at": "2018-01-24T21:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316112",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:5'></a>Attachment [shifted_primed_tableau.py](tarball://root/attachments/some-uuid/ticket22921/shifted_primed_tableau.py) by @mantepse created at 2018-01-24 21:17:19

I spent some time abstracting `PrimedEntry`, but the performance is not really good.  Moreover, this raises the question whether the elements of the reading word should be integers or `PrimedEntry`s.

I attached the file in case it is of any interest.



---

archive/issue_comments_316113.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-24T23:48:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316113",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316114.json:
```json
{
    "body": "<a id='comment:137'></a>Thank you for helping me with this.\n\nReplying to [comment:134 mantepse]:\n> Travis, isn't that an implementation detail, mostly private?  A lot of time already went into this ticket, I would think it might be better to go in for now...\n> \n> Anyway I also thought a wrapper would be more logical.  To be precise, it should be a poset, but that's probably overkill.\n> \n> EDIT: corrected version.\n> \n> ```\n> class PrimedEntry(SageObject):\n>     \"\"\"\n>     The class of entries in shifted primed tableaux.\n>     \"\"\"\n>     def __init__(self, entry=None, double=None):\n>         \"\"\"\n>         Normalize the entry.\n> \n>         TEST::\n> \n>             sage: ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n>             2'\n>             sage: ShiftedPrimedTableau([[1,\"2'\"]])[0][1]\n>             2'\n>             sage: ShiftedPrimedTableau([[1,1.5]])[0][1]\n>             2'\n>         \"\"\"\n>         # store primed numbers as odd, unprimed numbers as even integers\n>         if isinstance(entry, self.__class__):\n>             self._entry = entry._entry\n>             return\n> \n>         if double is not None:\n>             self._entry = Integer(double)\n>             return\n> \n>         if isinstance(entry, str):\n>             if (entry[-1] == \"'\" or entry[-1] == \"p\") and entry[:-1].isdigit() is True:\n>                 # Check if an element has \"'\" or \"p\" at the end\n>                 self._entry = 2*Integer(entry[:-1]) - 1\n>                 return\n> \n>         try:\n>             entry = Rational(entry)\n>         except (TypeError, ValueError):\n>             raise ValueError(\"primed elements have wrong format\")\n>         if entry.denominator() not in (1, 2):\n>             # Check if an element is a half-integer\n>             raise ValueError(\"all numbers must be half-integers\")\n>         self._entry = Integer(2*entry)\n> \n>     def __hash__(self):\n>         return self._entry\n> \n>     def __repr__(self):\n>         \"\"\"\n>         Represent ``self`` as primed or unprimed integer.\n> \n>         TEST::\n> \n>             sage: ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n>             2'\n>         \"\"\"\n>         if is_even(self._entry):\n>             return str(self._entry//2)\n>         else:\n>             return str((self._entry+1)//2) + \"'\"\n> \n>     def integer(self):\n>         return self._entry//2\n> \n>     def __eq__(self, other):\n>         return self._entry == PrimedEntry(other)._entry\n> \n>     def __ne__(self, other):\n>         return self._entry != PrimedEntry(other)._entry\n> \n>     def __lt__(self, other):\n>         return self._entry < PrimedEntry(other)._entry\n> \n>     def __le__(self, other):\n>         return self._entry <= PrimedEntry(other)._entry\n> \n>     def __gt__(self, other):\n>         return self._entry > PrimedEntry(other)._entry\n> \n>     def __ge__(self, other):\n>         return self._entry >= PrimedEntry(other)._entry\n> \n>     def is_unprimed(self):\n>         \"\"\"\n>         Checks if ``self`` is an unprimed element.\n> \n>         TEST::\n> \n>             sage: a = ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n>             sage: a.is_unprimed()\n>             False\n>         \"\"\"\n>         return is_even(self._entry)\n> \n>     def is_primed(self):\n>         \"\"\"\n>         Checks if ``self`` is a primed element.\n> \n>         TEST::\n> \n>             sage: a = ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n>             sage: a.is_primed()\n>             True\n>         \"\"\"\n>         return is_odd(self._entry)\n> \n>     def unprimed(self):\n>         \"\"\"\n>         Unprime ``self`` if it is a primed element.\n> \n>         TEST::\n> \n>             sage: a = ShiftedPrimedTableau([[1,\"2p\"]])[0][1]\n>             sage: a.unprimed()\n>             2\n>         \"\"\"\n>         if is_even(self._entry):\n>             return self\n>         else:\n>             return PrimedEntry(double=self._entry + 1)\n> \n>     def primed(self):\n>         \"\"\"\n>         Prime ``self`` if it is an unprimed element.\n> \n>         TEST::\n> \n>             sage: a = ShiftedPrimedTableau([[1,\"2p\"]])[0][0]\n>             sage: a.primed()\n>             1'\n>         \"\"\"\n> \n>         if is_even(self._entry):\n>             return PrimedEntry(double=self._entry - 1)\n>         else:\n>             return self\n> \n>     def increase_half(self):\n>         return PrimedEntry(double=self._entry + 1)\n> \n>     def decrease_half(self):\n>         return PrimedEntry(double=self._entry - 1)\n> \n>     def increase_one(self):\n>         return PrimedEntry(double=self._entry + 2)\n> \n>     def decrease_one(self):\n>         return PrimedEntry(double=self._entry - 2)\n> ```",
    "created_at": "2018-01-24T23:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316114",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:137'></a>Thank you for helping me with this.

Replying to [comment:134 mantepse]:
> Travis, isn't that an implementation detail, mostly private?  A lot of time already went into this ticket, I would think it might be better to go in for now...
> 
> Anyway I also thought a wrapper would be more logical.  To be precise, it should be a poset, but that's probably overkill.
> 
> EDIT: corrected version.
> 
> ```
> class PrimedEntry(SageObject):
>     """
>     The class of entries in shifted primed tableaux.
>     """
>     def __init__(self, entry=None, double=None):
>         """
>         Normalize the entry.
> 
>         TEST::
> 
>             sage: ShiftedPrimedTableau([[1,"2p"]])[0][1]
>             2'
>             sage: ShiftedPrimedTableau([[1,"2'"]])[0][1]
>             2'
>             sage: ShiftedPrimedTableau([[1,1.5]])[0][1]
>             2'
>         """
>         # store primed numbers as odd, unprimed numbers as even integers
>         if isinstance(entry, self.__class__):
>             self._entry = entry._entry
>             return
> 
>         if double is not None:
>             self._entry = Integer(double)
>             return
> 
>         if isinstance(entry, str):
>             if (entry[-1] == "'" or entry[-1] == "p") and entry[:-1].isdigit() is True:
>                 # Check if an element has "'" or "p" at the end
>                 self._entry = 2*Integer(entry[:-1]) - 1
>                 return
> 
>         try:
>             entry = Rational(entry)
>         except (TypeError, ValueError):
>             raise ValueError("primed elements have wrong format")
>         if entry.denominator() not in (1, 2):
>             # Check if an element is a half-integer
>             raise ValueError("all numbers must be half-integers")
>         self._entry = Integer(2*entry)
> 
>     def __hash__(self):
>         return self._entry
> 
>     def __repr__(self):
>         """
>         Represent ``self`` as primed or unprimed integer.
> 
>         TEST::
> 
>             sage: ShiftedPrimedTableau([[1,"2p"]])[0][1]
>             2'
>         """
>         if is_even(self._entry):
>             return str(self._entry//2)
>         else:
>             return str((self._entry+1)//2) + "'"
> 
>     def integer(self):
>         return self._entry//2
> 
>     def __eq__(self, other):
>         return self._entry == PrimedEntry(other)._entry
> 
>     def __ne__(self, other):
>         return self._entry != PrimedEntry(other)._entry
> 
>     def __lt__(self, other):
>         return self._entry < PrimedEntry(other)._entry
> 
>     def __le__(self, other):
>         return self._entry <= PrimedEntry(other)._entry
> 
>     def __gt__(self, other):
>         return self._entry > PrimedEntry(other)._entry
> 
>     def __ge__(self, other):
>         return self._entry >= PrimedEntry(other)._entry
> 
>     def is_unprimed(self):
>         """
>         Checks if ``self`` is an unprimed element.
> 
>         TEST::
> 
>             sage: a = ShiftedPrimedTableau([[1,"2p"]])[0][1]
>             sage: a.is_unprimed()
>             False
>         """
>         return is_even(self._entry)
> 
>     def is_primed(self):
>         """
>         Checks if ``self`` is a primed element.
> 
>         TEST::
> 
>             sage: a = ShiftedPrimedTableau([[1,"2p"]])[0][1]
>             sage: a.is_primed()
>             True
>         """
>         return is_odd(self._entry)
> 
>     def unprimed(self):
>         """
>         Unprime ``self`` if it is a primed element.
> 
>         TEST::
> 
>             sage: a = ShiftedPrimedTableau([[1,"2p"]])[0][1]
>             sage: a.unprimed()
>             2
>         """
>         if is_even(self._entry):
>             return self
>         else:
>             return PrimedEntry(double=self._entry + 1)
> 
>     def primed(self):
>         """
>         Prime ``self`` if it is an unprimed element.
> 
>         TEST::
> 
>             sage: a = ShiftedPrimedTableau([[1,"2p"]])[0][0]
>             sage: a.primed()
>             1'
>         """
> 
>         if is_even(self._entry):
>             return PrimedEntry(double=self._entry - 1)
>         else:
>             return self
> 
>     def increase_half(self):
>         return PrimedEntry(double=self._entry + 1)
> 
>     def decrease_half(self):
>         return PrimedEntry(double=self._entry - 1)
> 
>     def increase_one(self):
>         return PrimedEntry(double=self._entry + 2)
> 
>     def decrease_one(self):
>         return PrimedEntry(double=self._entry - 2)
> ```



---

archive/issue_comments_316115.json:
```json
{
    "body": "<a id='comment:8'></a>Kirill, here are some more trivialities.  The first one cuts away a few seconds on my laptop.\n\nTravis, is it good enough now?\n\n```\ndiff --git a/src/sage/combinat/shifted_primed_tableau.py b/src/sage/combinat/shifted_primed_tableau.py\nindex a80a6acaae..be701a06bb 100644\n--- a/src/sage/combinat/shifted_primed_tableau.py\n+++ b/src/sage/combinat/shifted_primed_tableau.py\n@@ -599,7 +599,7 @@ class CrystalElementShiftedPrimedTableau(ShiftedPrimedTableau):\n             sage: mat\n             [[1, 2', 2, 2], [None, 2, 3', None], [None, None, 3, None]]\n         \"\"\"\n-        m = self.shape()[0]\n+        m = len(self[0])\n         return [[None]*i + list(row) + [None]*(m-i-len(row))\n                 for i, row in enumerate(self)]\n \n@@ -809,7 +809,7 @@ class CrystalElementShiftedPrimedTableau(ShiftedPrimedTableau):\n         element_to_change = None\n         count = 0\n \n-        for element in read_word[::-1]:\n+        for element in reversed(read_word):\n             if element[1] == ind:\n                 count += 1\n             elif count == 0:\n@@ -882,7 +882,7 @@ class CrystalElementShiftedPrimedTableau(ShiftedPrimedTableau):\n         count = {i: 0 for i in range(max_entry+1)}\n         if index_set is None:\n             index_set = self.parent().index_set()\n-        for l in read_w[::-1]:\n+        for l in reversed(read_w):\n             count[l] += 1\n             if (l-1 in index_set) and (l > 1) and (count[l] > count[l-1]):\n                 return False\n@@ -2041,7 +2041,7 @@ def _add_strip(sub_tab, full_tab, length):\n             if len(sub_tab) < len(full_tab) and len(sub_tab) != 0:\n                 plat_list.append(min(sub_tab[-1] + primed_strip[-2] - 1,\n                                      full_tab[len(sub_tab)]))\n-            for row in range(1, len(sub_tab))[::-1]:\n+            for row in reversed(range(1, len(sub_tab))):\n                 plat_list.append(\n                     min(sub_tab[row-1]+primed_strip[row-1]-1, full_tab[row])\n                     - sub_tab[row] - primed_strip[row])\n```",
    "created_at": "2018-01-25T07:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316115",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:8'></a>Kirill, here are some more trivialities.  The first one cuts away a few seconds on my laptop.

Travis, is it good enough now?

```
diff --git a/src/sage/combinat/shifted_primed_tableau.py b/src/sage/combinat/shifted_primed_tableau.py
index a80a6acaae..be701a06bb 100644
--- a/src/sage/combinat/shifted_primed_tableau.py
+++ b/src/sage/combinat/shifted_primed_tableau.py
@@ -599,7 +599,7 @@ class CrystalElementShiftedPrimedTableau(ShiftedPrimedTableau):
             sage: mat
             [[1, 2', 2, 2], [None, 2, 3', None], [None, None, 3, None]]
         """
-        m = self.shape()[0]
+        m = len(self[0])
         return [[None]*i + list(row) + [None]*(m-i-len(row))
                 for i, row in enumerate(self)]
 
@@ -809,7 +809,7 @@ class CrystalElementShiftedPrimedTableau(ShiftedPrimedTableau):
         element_to_change = None
         count = 0
 
-        for element in read_word[::-1]:
+        for element in reversed(read_word):
             if element[1] == ind:
                 count += 1
             elif count == 0:
@@ -882,7 +882,7 @@ class CrystalElementShiftedPrimedTableau(ShiftedPrimedTableau):
         count = {i: 0 for i in range(max_entry+1)}
         if index_set is None:
             index_set = self.parent().index_set()
-        for l in read_w[::-1]:
+        for l in reversed(read_w):
             count[l] += 1
             if (l-1 in index_set) and (l > 1) and (count[l] > count[l-1]):
                 return False
@@ -2041,7 +2041,7 @@ def _add_strip(sub_tab, full_tab, length):
             if len(sub_tab) < len(full_tab) and len(sub_tab) != 0:
                 plat_list.append(min(sub_tab[-1] + primed_strip[-2] - 1,
                                      full_tab[len(sub_tab)]))
-            for row in range(1, len(sub_tab))[::-1]:
+            for row in reversed(range(1, len(sub_tab))):
                 plat_list.append(
                     min(sub_tab[row-1]+primed_strip[row-1]-1, full_tab[row])
                     - sub_tab[row] - primed_strip[row])
```



---

archive/issue_comments_316116.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-25T18:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316116",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316117.json:
```json
{
    "body": "<a id='comment:0'></a>I've been making my way through the current code. I think it has significantly improved by having the letter class in readability. Martin and Kirill, thank you for making the changes to the `PrimeEntry` class.\n\nAs part of my review, I have made some changes on my forthcoming push. A good majority of them are trivial changes in formatting and some tricks and micro-optimizations I've learned. Here are some of my more significant changes.\n\n- I scrubbed all (unnecessary) calls to `float` and `int`.\n- I used the fast partition iterator in one place.\n- I removed some (now incorrect) documentation. (I generally do not like implementation details of top-level classes exposed to the user when they do not really \"see\" those details.)\n- I fixed a bug with weight 0 tableaux.\n- I removed the redundant `_element_constructor_`s that just made a super call and raised the same error as what the super does. I moved the doctests.\n- Made `_reading_word_with_positions` an iterator as the list output was never used.\n- I removed the iterator for the crystals because the one from the crystals category is >10x faster:\n  {{{\nsage: SPT = ShiftedPrimedTableaux([3,2], max_entry=3)\nsage: %timeit for x in SPT._old_iter(): pass\nThe slowest run took 9.45 times longer than the fastest. This could mean that an intermediate result is being cached.\n100 loops, best of 3: 19.2 ms per loop\nsage: %timeit for x in SPT: pass\nThe slowest run took 5.46 times longer than the fastest. This could mean that an intermediate result is being cached.\n1000 loops, best of 3: 1.48 ms per loop\n  }}}\n\nHowever, there are some other things that do need some additional work, but then I think that is the last of it.\n\n- `_contains_tableau_` and `_preprocess_` are not special Sage methods, and should not end with a trailing underscore. You also should directly test them as it helps isolate bugs when one gets introduced.\n- For the `PrimedEntry` class, you should import the class and directly construct the elements instead of indirectly via the tableau. Also, you might want to consider expanding the doc a little more (but not necessary).\n- I noticed that `PrimedEntry` can sometimes be passed a `None`, which I do not think should happen. IMO, this is a bug that is hacked around (before, it was handled by `Rational(None)` being `1` through what is essentially a shortcoming of how `Parent.__call__` works). However, it is a technical debt we can take on for now.\n- This is essentially a bug:\n  {{{\nsage: SPT = ShiftedPrimedTableaux(skew=[1])\nsage: SPT.category()\nCategory of infinite enumerated sets\n  }}}\n  because you cannot iterate over this object (currently). In a related issue, I added a test `TestSuite(SPT).run()` and marked as a known bug. I think you should have the correct categories in this case.",
    "created_at": "2018-01-29T18:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316117",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:0'></a>I've been making my way through the current code. I think it has significantly improved by having the letter class in readability. Martin and Kirill, thank you for making the changes to the `PrimeEntry` class.

As part of my review, I have made some changes on my forthcoming push. A good majority of them are trivial changes in formatting and some tricks and micro-optimizations I've learned. Here are some of my more significant changes.

- I scrubbed all (unnecessary) calls to `float` and `int`.
- I used the fast partition iterator in one place.
- I removed some (now incorrect) documentation. (I generally do not like implementation details of top-level classes exposed to the user when they do not really "see" those details.)
- I fixed a bug with weight 0 tableaux.
- I removed the redundant `_element_constructor_`s that just made a super call and raised the same error as what the super does. I moved the doctests.
- Made `_reading_word_with_positions` an iterator as the list output was never used.
- I removed the iterator for the crystals because the one from the crystals category is >10x faster:
  {{{
sage: SPT = ShiftedPrimedTableaux([3,2], max_entry=3)
sage: %timeit for x in SPT._old_iter(): pass
The slowest run took 9.45 times longer than the fastest. This could mean that an intermediate result is being cached.
100 loops, best of 3: 19.2 ms per loop
sage: %timeit for x in SPT: pass
The slowest run took 5.46 times longer than the fastest. This could mean that an intermediate result is being cached.
1000 loops, best of 3: 1.48 ms per loop
  }}}

However, there are some other things that do need some additional work, but then I think that is the last of it.

- `_contains_tableau_` and `_preprocess_` are not special Sage methods, and should not end with a trailing underscore. You also should directly test them as it helps isolate bugs when one gets introduced.
- For the `PrimedEntry` class, you should import the class and directly construct the elements instead of indirectly via the tableau. Also, you might want to consider expanding the doc a little more (but not necessary).
- I noticed that `PrimedEntry` can sometimes be passed a `None`, which I do not think should happen. IMO, this is a bug that is hacked around (before, it was handled by `Rational(None)` being `1` through what is essentially a shortcoming of how `Parent.__call__` works). However, it is a technical debt we can take on for now.
- This is essentially a bug:
  {{{
sage: SPT = ShiftedPrimedTableaux(skew=[1])
sage: SPT.category()
Category of infinite enumerated sets
  }}}
  because you cannot iterate over this object (currently). In a related issue, I added a test `TestSuite(SPT).run()` and marked as a known bug. I think you should have the correct categories in this case.



---

archive/issue_events_059468.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-01-29T18:50:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22921#event-59468"
}
```



---

archive/issue_comments_316118.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-29T18:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316118",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316119.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-30T20:58:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316119",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316120.json:
```json
{
    "body": "<a id='comment:143'></a>Alright, I've addressed your comments.\n\nReplying to [comment:140 tscrim]:\n> I've been making my way through the current code. I think it has significantly improved by having the letter class in readability. Martin and Kirill, thank you for making the changes to the `PrimeEntry` class.\n> \n> As part of my review, I have made some changes on my forthcoming push. A good majority of them are trivial changes in formatting and some tricks and micro-optimizations I've learned. Here are some of my more significant changes.\n> \n> - I scrubbed all (unnecessary) calls to `float` and `int`.\n> - I used the fast partition iterator in one place.\n> - I removed some (now incorrect) documentation. (I generally do not like implementation details of top-level classes exposed to the user when they do not really \"see\" those details.)\n> - I fixed a bug with weight 0 tableaux.\n> - I removed the redundant `_element_constructor_`s that just made a super call and raised the same error as what the super does. I moved the doctests.\n> - Made `_reading_word_with_positions` an iterator as the list output was never used.\n> - I removed the iterator for the crystals because the one from the crystals category is >10x faster:\n>   {{{\n> sage: SPT = ShiftedPrimedTableaux([3,2], max_entry=3)\n> sage: %timeit for x in SPT._old_iter(): pass\n> The slowest run took 9.45 times longer than the fastest. This could mean that an intermediate result is being cached.\n> 100 loops, best of 3: 19.2 ms per loop\n> sage: %timeit for x in SPT: pass\n> The slowest run took 5.46 times longer than the fastest. This could mean that an intermediate result is being cached.\n> 1000 loops, best of 3: 1.48 ms per loop\n>   }}}\n> \n> However, there are some other things that do need some additional work, but then I think that is the last of it.\n> \n> - `_contains_tableau_` and `_preprocess_` are not special Sage methods, and should not end with a trailing underscore. You also should directly test them as it helps isolate bugs when one gets introduced.\n> - For the `PrimedEntry` class, you should import the class and directly construct the elements instead of indirectly via the tableau. Also, you might want to consider expanding the doc a little more (but not necessary).\n> - I noticed that `PrimedEntry` can sometimes be passed a `None`, which I do not think should happen. IMO, this is a bug that is hacked around (before, it was handled by `Rational(None)` being `1` through what is essentially a shortcoming of how `Parent.__call__` works). However, it is a technical debt we can take on for now.\n> - This is essentially a bug:\n>   {{{\n> sage: SPT = ShiftedPrimedTableaux(skew=[1])\n> sage: SPT.category()\n> Category of infinite enumerated sets\n>   }}}\n>   because you cannot iterate over this object (currently). In a related issue, I added a test `TestSuite(SPT).run()` and marked as a known bug. I think you should have the correct categories in this case.",
    "created_at": "2018-01-30T21:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316120",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:143'></a>Alright, I've addressed your comments.

Replying to [comment:140 tscrim]:
> I've been making my way through the current code. I think it has significantly improved by having the letter class in readability. Martin and Kirill, thank you for making the changes to the `PrimeEntry` class.
> 
> As part of my review, I have made some changes on my forthcoming push. A good majority of them are trivial changes in formatting and some tricks and micro-optimizations I've learned. Here are some of my more significant changes.
> 
> - I scrubbed all (unnecessary) calls to `float` and `int`.
> - I used the fast partition iterator in one place.
> - I removed some (now incorrect) documentation. (I generally do not like implementation details of top-level classes exposed to the user when they do not really "see" those details.)
> - I fixed a bug with weight 0 tableaux.
> - I removed the redundant `_element_constructor_`s that just made a super call and raised the same error as what the super does. I moved the doctests.
> - Made `_reading_word_with_positions` an iterator as the list output was never used.
> - I removed the iterator for the crystals because the one from the crystals category is >10x faster:
>   {{{
> sage: SPT = ShiftedPrimedTableaux([3,2], max_entry=3)
> sage: %timeit for x in SPT._old_iter(): pass
> The slowest run took 9.45 times longer than the fastest. This could mean that an intermediate result is being cached.
> 100 loops, best of 3: 19.2 ms per loop
> sage: %timeit for x in SPT: pass
> The slowest run took 5.46 times longer than the fastest. This could mean that an intermediate result is being cached.
> 1000 loops, best of 3: 1.48 ms per loop
>   }}}
> 
> However, there are some other things that do need some additional work, but then I think that is the last of it.
> 
> - `_contains_tableau_` and `_preprocess_` are not special Sage methods, and should not end with a trailing underscore. You also should directly test them as it helps isolate bugs when one gets introduced.
> - For the `PrimedEntry` class, you should import the class and directly construct the elements instead of indirectly via the tableau. Also, you might want to consider expanding the doc a little more (but not necessary).
> - I noticed that `PrimedEntry` can sometimes be passed a `None`, which I do not think should happen. IMO, this is a bug that is hacked around (before, it was handled by `Rational(None)` being `1` through what is essentially a shortcoming of how `Parent.__call__` works). However, it is a technical debt we can take on for now.
> - This is essentially a bug:
>   {{{
> sage: SPT = ShiftedPrimedTableaux(skew=[1])
> sage: SPT.category()
> Category of infinite enumerated sets
>   }}}
>   because you cannot iterate over this object (currently). In a related issue, I added a test `TestSuite(SPT).run()` and marked as a known bug. I think you should have the correct categories in this case.



---

archive/issue_comments_316121.json:
```json
{
    "body": "<a id='comment:144'></a>Replying to [comment:143 kbparamonov]:\n> Alright, I've addressed your comments.\n\n\n> Replying to [comment:140 tscrim]:\n> > - `_contains_tableau_` and `_preprocess_` are not special Sage methods, and should not end with a trailing underscore. You also should directly test them as it helps isolate bugs when one gets introduced.\n\n\nThe latter part has not been adequately addressed. In particular, you should have the *direct* tests for each method testing the key points (ideally every code path).\n\n> > - I noticed that `PrimedEntry` can sometimes be passed a `None`, which I do not think should happen. IMO, this is a bug that is hacked around (before, it was handled by `Rational(None)` being `1` through what is essentially a shortcoming of how `Parent.__call__` works). However, it is a technical debt we can take on for now.\n\n\nYou should add a test showing that `PrimedEntry(None)` now raises an error.\n\nI'm also not convinced of having the `try-except` blocks in the comparisons of `PrimedEntry`. I think because of how low-level `PrimedEntry` is, you don't need the extra minor speed hit except for  `__eq__` and `__ne__` (I agree with them raising an error, but the new error message is not really useful IMO).\n\n---\n\nSorry, one additional little thing: `PrimedEntry.integer`, `PrimedEntry.decrease_*`, and `PrimedEntry.increase_*` should have at least a one line docstring explaining what they do.",
    "created_at": "2018-01-30T22:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316121",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:144'></a>Replying to [comment:143 kbparamonov]:
> Alright, I've addressed your comments.


> Replying to [comment:140 tscrim]:
> > - `_contains_tableau_` and `_preprocess_` are not special Sage methods, and should not end with a trailing underscore. You also should directly test them as it helps isolate bugs when one gets introduced.


The latter part has not been adequately addressed. In particular, you should have the *direct* tests for each method testing the key points (ideally every code path).

> > - I noticed that `PrimedEntry` can sometimes be passed a `None`, which I do not think should happen. IMO, this is a bug that is hacked around (before, it was handled by `Rational(None)` being `1` through what is essentially a shortcoming of how `Parent.__call__` works). However, it is a technical debt we can take on for now.


You should add a test showing that `PrimedEntry(None)` now raises an error.

I'm also not convinced of having the `try-except` blocks in the comparisons of `PrimedEntry`. I think because of how low-level `PrimedEntry` is, you don't need the extra minor speed hit except for  `__eq__` and `__ne__` (I agree with them raising an error, but the new error message is not really useful IMO).

---

Sorry, one additional little thing: `PrimedEntry.integer`, `PrimedEntry.decrease_*`, and `PrimedEntry.increase_*` should have at least a one line docstring explaining what they do.



---

archive/issue_comments_316122.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-30T23:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316122",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316123.json:
```json
{
    "body": "<a id='comment:146'></a>Is this what you had in mind?\n\nReplying to [comment:144 tscrim]:\n> Replying to [comment:143 kbparamonov]:\n> > Alright, I've addressed your comments.\n\n> \n> > Replying to [comment:140 tscrim]:\n> > > - `_contains_tableau_` and `_preprocess_` are not special Sage methods, and should not end with a trailing underscore. You also should directly test them as it helps isolate bugs when one gets introduced.\n \n> \n> The latter part has not been adequately addressed. In particular, you should have the *direct* tests for each method testing the key points (ideally every code path).\n> \n> > > - I noticed that `PrimedEntry` can sometimes be passed a `None`, which I do not think should happen. IMO, this is a bug that is hacked around (before, it was handled by `Rational(None)` being `1` through what is essentially a shortcoming of how `Parent.__call__` works). However, it is a technical debt we can take on for now.\n \n> \n> You should add a test showing that `PrimedEntry(None)` now raises an error.\n> \n> I'm also not convinced of having the `try-except` blocks in the comparisons of `PrimedEntry`. I think because of how low-level `PrimedEntry` is, you don't need the extra minor speed hit except for  `__eq__` and `__ne__` (I agree with them raising an error, but the new error message is not really useful IMO).\n> \n> \n> ---\n> \n> Sorry, one additional little thing: `PrimedEntry.integer`, `PrimedEntry.decrease_*`, and `PrimedEntry.increase_*` should have at least a one line docstring explaining what they do.",
    "created_at": "2018-01-30T23:35:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316123",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:146'></a>Is this what you had in mind?

Replying to [comment:144 tscrim]:
> Replying to [comment:143 kbparamonov]:
> > Alright, I've addressed your comments.

> 
> > Replying to [comment:140 tscrim]:
> > > - `_contains_tableau_` and `_preprocess_` are not special Sage methods, and should not end with a trailing underscore. You also should directly test them as it helps isolate bugs when one gets introduced.
 
> 
> The latter part has not been adequately addressed. In particular, you should have the *direct* tests for each method testing the key points (ideally every code path).
> 
> > > - I noticed that `PrimedEntry` can sometimes be passed a `None`, which I do not think should happen. IMO, this is a bug that is hacked around (before, it was handled by `Rational(None)` being `1` through what is essentially a shortcoming of how `Parent.__call__` works). However, it is a technical debt we can take on for now.
 
> 
> You should add a test showing that `PrimedEntry(None)` now raises an error.
> 
> I'm also not convinced of having the `try-except` blocks in the comparisons of `PrimedEntry`. I think because of how low-level `PrimedEntry` is, you don't need the extra minor speed hit except for  `__eq__` and `__ne__` (I agree with them raising an error, but the new error message is not really useful IMO).
> 
> 
> ---
> 
> Sorry, one additional little thing: `PrimedEntry.integer`, `PrimedEntry.decrease_*`, and `PrimedEntry.increase_*` should have at least a one line docstring explaining what they do.



---

archive/issue_comments_316124.json:
```json
{
    "body": "<a id='comment:7'></a>Yes, although there are two `_contains_tableau` that are still not directly doctested. Also, the `__ge__` test is actually testing `__le__`.",
    "created_at": "2018-01-31T01:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316124",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>Yes, although there are two `_contains_tableau` that are still not directly doctested. Also, the `__ge__` test is actually testing `__le__`.



---

archive/issue_comments_316125.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-01-31T01:52:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316125",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316126.json:
```json
{
    "body": "<a id='comment:9'></a>Thank you. I am happy and given Martin's comments, I am setting this to a positive review.",
    "created_at": "2018-01-31T02:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316126",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>Thank you. I am happy and given Martin's comments, I am setting this to a positive review.



---

archive/issue_comments_316127.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-01-31T02:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316127",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_316128.json:
```json
{
    "body": "<a id='comment:150'></a>Thank you for reviewing it!\n\nReplying to [comment:149 tscrim]:\n> Thank you. I am happy and given Martin's comments, I am setting this to a positive review.",
    "created_at": "2018-01-31T06:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316128",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:150'></a>Thank you for reviewing it!

Replying to [comment:149 tscrim]:
> Thank you. I am happy and given Martin's comments, I am setting this to a positive review.



---

archive/issue_comments_316129.json:
```json
{
    "body": "<a id='comment:1'></a>Wonderful! #23896 is then also ready for review!  (For some reason, the automerging failed, but I could checkout the ticket without trouble.)",
    "created_at": "2018-01-31T08:56:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316129",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:1'></a>Wonderful! #23896 is then also ready for review!  (For some reason, the automerging failed, but I could checkout the ticket without trouble.)



---

archive/issue_comments_316130.json:
```json
{
    "body": "<a id='comment:2'></a>The patchbot is reporting a failure I overlooked because the doctest is marked \"long time\":\n\n```\nsage: SPT = ShiftedPrimedTableaux()\nsage: TestSuite(SPT).run()\n  Failure in _test_eq:\n  Traceback (most recent call last):\n    File \"/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 294, in run                                   \n      test_method(tester = tester)\n    File \"sage/structure/element.pyx\", line 745, in sage.structure.element.Element._test_eq (build/cythonized/sage/structure/element.c:6812)          \n      tester.assertFalse(self == None,\n    File \"/home/martin/sage-develop/local/lib/python2.7/unittest/case.py\", line 416, in assertFalse                                                   \n      raise self.failureException(msg)\n  AssertionError: broken equality: [] == None                                                                                                         \n  ------------------------------------------------------------\n  The following tests failed: _test_eq\nFailure in _test_elements\nThe following tests failed: _test_elements\n```\nApparently, it fails because of the following, but I'm not sure:\n\n```\nsage: SPT = ShiftedPrimedTableaux()\nsage: SPT.an_element()\n[]\nsage: SPT.an_element() == None\nTrue\n# which is, because\nsage: ShiftedPrimedTableau(None)\n[]\n```",
    "created_at": "2018-02-01T04:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316130",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>The patchbot is reporting a failure I overlooked because the doctest is marked "long time":

```
sage: SPT = ShiftedPrimedTableaux()
sage: TestSuite(SPT).run()
  Failure in _test_eq:
  Traceback (most recent call last):
    File "/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 294, in run                                   
      test_method(tester = tester)
    File "sage/structure/element.pyx", line 745, in sage.structure.element.Element._test_eq (build/cythonized/sage/structure/element.c:6812)          
      tester.assertFalse(self == None,
    File "/home/martin/sage-develop/local/lib/python2.7/unittest/case.py", line 416, in assertFalse                                                   
      raise self.failureException(msg)
  AssertionError: broken equality: [] == None                                                                                                         
  ------------------------------------------------------------
  The following tests failed: _test_eq
Failure in _test_elements
The following tests failed: _test_elements
```
Apparently, it fails because of the following, but I'm not sure:

```
sage: SPT = ShiftedPrimedTableaux()
sage: SPT.an_element()
[]
sage: SPT.an_element() == None
True
# which is, because
sage: ShiftedPrimedTableau(None)
[]
```



---

archive/issue_comments_316131.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-02-01T04:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316131",
    "user": "https://github.com/mantepse"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_316132.json:
```json
{
    "body": "<a id='comment:3'></a>That might be my fault and something I introduced trying to keep the code clean. I am about ready to board a flight to Australia, so I cannot look at it for ~19 hours.",
    "created_at": "2018-02-01T04:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316132",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>That might be my fault and something I introduced trying to keep the code clean. I am about ready to board a flight to Australia, so I cannot look at it for ~19 hours.



---

archive/issue_comments_316133.json:
```json
{
    "body": "<a id='comment:4'></a>Quick reply:\n\n```\n    def __classcall_private__(cls, T, skew=None):\n...\n      if isinstance(T, ShiftedPrimedTableau) and T._skew == skew:\n            return T\n      if not T or T == [[]]:\n            return ShiftedPrimedTableaux(skew=skew)([])\n```\nshould be \n\n```\n      if T == [] or T == [[]]:\n            return ShiftedPrimedTableaux(skew=skew)([])\n\n```\n\nBut the bigger question is: why is `not T` preferred over `T == []` by some people.\n\nThe former is impossible to grep for, but still widely used.",
    "created_at": "2018-02-01T04:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316133",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>Quick reply:

```
    def __classcall_private__(cls, T, skew=None):
...
      if isinstance(T, ShiftedPrimedTableau) and T._skew == skew:
            return T
      if not T or T == [[]]:
            return ShiftedPrimedTableaux(skew=skew)([])
```
should be 

```
      if T == [] or T == [[]]:
            return ShiftedPrimedTableaux(skew=skew)([])

```

But the bigger question is: why is `not T` preferred over `T == []` by some people.

The former is impossible to grep for, but still widely used.



---

archive/issue_comments_316134.json:
```json
{
    "body": "<a id='comment:5'></a>Please remind me: should the input checking be done in `__classcall_private__` and via `contains`?\n\nFor example, I think we should not allow\n\n```\nsage: ShiftedPrimedTableau([[None, None, \"1p\",None, 2]])\n[(None, None, None, 1', 2)]                                                                                                                           \n```\nOn the other hand:\n\n```\nsage: ShiftedPrimedTableau([tuple([])])\n```\nshould work, shouldn't it?",
    "created_at": "2018-02-01T05:06:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316134",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:5'></a>Please remind me: should the input checking be done in `__classcall_private__` and via `contains`?

For example, I think we should not allow

```
sage: ShiftedPrimedTableau([[None, None, "1p",None, 2]])
[(None, None, None, 1', 2)]                                                                                                                           
```
On the other hand:

```
sage: ShiftedPrimedTableau([tuple([])])
```
should work, shouldn't it?



---

archive/issue_comments_316135.json:
```json
{
    "body": "<a id='comment:6'></a>Another corner case:\n\n```\nsage: ShiftedPrimedTableau([[None]]).pp()\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-2-d20e95e0a9ff> in <module>()\n----> 1 ShiftedPrimedTableau([[None]]).pp()\n\n/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/combinat/shifted_primed_tableau.pyc in pp(self)\n    494                 .  2'                                                                                                                         \n    495         \"\"\"                                                                                                                                   \n--> 496         print(self._repr_diagram())\n    497\n    498     def _latex_(self):\n\n/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/combinat/shifted_primed_tableau.pyc in _repr_diagram(self)\n    324                 .  2'                                                                                                                         \n    325         \"\"\"                                                                                                                                   \n--> 326         max_len = len(str(self.max_entry()))+2\n    327         return \"\\n\".join([\" \"*max_len*i + \"\".join(val)                                                                                        \n    328                           for i, val in enumerate(self._repr_tab())])\n\n/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/combinat/shifted_primed_tableau.pyc in max_entry(self)\n    528             return 0\n    529\n--> 530         return max(entry.unprimed() for row in self\n    531                    for entry in row if entry is not None)\n    532\n\nValueError: max() arg is an empty sequence\nsage: ShiftedPrimedTableau([[None]])\n[(None,)]\n```",
    "created_at": "2018-02-01T07:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316135",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'></a>Another corner case:

```
sage: ShiftedPrimedTableau([[None]]).pp()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-2-d20e95e0a9ff> in <module>()
----> 1 ShiftedPrimedTableau([[None]]).pp()

/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/combinat/shifted_primed_tableau.pyc in pp(self)
    494                 .  2'                                                                                                                         
    495         """                                                                                                                                   
--> 496         print(self._repr_diagram())
    497
    498     def _latex_(self):

/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/combinat/shifted_primed_tableau.pyc in _repr_diagram(self)
    324                 .  2'                                                                                                                         
    325         """                                                                                                                                   
--> 326         max_len = len(str(self.max_entry()))+2
    327         return "\n".join([" "*max_len*i + "".join(val)                                                                                        
    328                           for i, val in enumerate(self._repr_tab())])

/home/martin/sage-develop/local/lib/python2.7/site-packages/sage/combinat/shifted_primed_tableau.pyc in max_entry(self)
    528             return 0
    529
--> 530         return max(entry.unprimed() for row in self
    531                    for entry in row if entry is not None)
    532

ValueError: max() arg is an empty sequence
sage: ShiftedPrimedTableau([[None]])
[(None,)]
```



---

archive/issue_comments_316136.json:
```json
{
    "body": "<a id='comment:7'></a>Here is a proposal:\n\n```\ndiff --git a/src/sage/combinat/shifted_primed_tableau.py b/src/sage/combinat/shifted_primed_tableau.py\nindex 5fd0c09..be6f46d 100644\n--- a/src/sage/combinat/shifted_primed_tableau.py\n+++ b/src/sage/combinat/shifted_primed_tableau.py\n@@ -108,21 +108,11 @@ class ShiftedPrimedTableau(ClonableArray):\n         \"\"\"\n         if isinstance(T, ShiftedPrimedTableau) and T._skew == skew:\n             return T\n-        if not T or T == [[]]:\n-            return ShiftedPrimedTableaux(skew=skew)([])\n-        try:\n-            entry = T[0][0]\n-        except TypeError:\n-            raise ValueError(\"input tableau must be a list of lists\")\n-\n-        if entry is None:\n-            skew_ = [row.count(None) for row in T if row[0] is None]\n-            if skew is not None:\n-                if skew != skew_:\n-                    raise ValueError(\"skew shape does not agree with None entries\")\n-            else:\n-                skew = skew_\n-\n+        skew_ = Partition([row.count(None) for row in T])\n+        if skew_:\n+            if skew and Partition(skew) != skew_:\n+                raise ValueError(\"skew shape does not agree with None entries\")\n+            skew = skew_\n         return ShiftedPrimedTableaux(skew=skew)(T)\n \n     def __init__(self, parent, T, skew=None, check=True, preprocessed=False):\n@@ -163,26 +153,56 @@ class ShiftedPrimedTableau(ClonableArray):\n         \"\"\"\n         Preprocessing list ``T`` to initialize the tableau.\n \n+        The output is a list of rows as tuples, with explicit\n+        ``None``'s to indicate the skew shape, and entries being\n+        ``PrimedEntry``s.\n+\n+        Trailing empty rows are removed.\n+\n         TESTS::\n \n-            sage: ShiftedPrimedTableau._preprocess([[\"2'\", \"3p\", 3.5]],\n-            ....: skew=[1])\n+            sage: ShiftedPrimedTableau._preprocess([[\"2'\", \"3p\", 3.5]], skew=[1])\n             [(None, 2', 3', 4')]\n+\n+            sage: ShiftedPrimedTableau._preprocess([[None, \"2'\", \"3p\", 3.5]])\n+            [(None, 2', 3', 4')]\n+\n+            sage: ShiftedPrimedTableau._preprocess([[None]])\n+            [(None,)]\n+\n+            sage: ShiftedPrimedTableau._preprocess([], skew=[2,1])\n+            [(None, None), (None,)]\n+\n+            sage: ShiftedPrimedTableau._preprocess([], skew=[])\n+            []\n         \"\"\"\n         if isinstance(T, ShiftedPrimedTableau):\n             return T\n \n-        # Preprocessing list t for primes and other symbols\n-        T = [[PrimedEntry(entry) for entry in row if entry is not None]\n-             for row in T]\n-\n-        if skew is not None:\n-            T = ([(None,)*skew[i] + tuple(T[i])\n-                  for i in range(len(skew))]\n-                 + [tuple(T[i]) for i in range(len(skew), len(T))])\n-        else:\n-            T = [tuple(row) for row in T]\n-        return T\n+        skew_ = Partition([row.count(None) for row in T])\n+        if skew_: # None's are explicit\n+            if skew:\n+                if Partition(skew) != skew_:\n+                    raise ValueError(\"skew shape does not agree with None entries\")\n+            T.extend([[]]*(len(skew_)-len(T))) # Warning: these are identical lists\n+            for i, s in enumerate(skew_):\n+                T[i] = (None,)*s + tuple(PrimedEntry(e) for e in T[i][s:])\n+            i += 1\n+            T[i:] = [tuple(PrimedEntry(e) for e in row) for row in T[i:]]\n+        else: # there are no None's\n+            if skew:\n+                T.extend([[]]*(len(skew)-len(T))) # Warning: these are identical lists\n+                for i, s in enumerate(skew):\n+                    T[i] = (None,)*s + tuple(PrimedEntry(e) for e in T[i])\n+                i += 1\n+                T[i:] = [tuple(PrimedEntry(e) for e in row) for row in T[i:]]\n+            else:\n+                T = [tuple(PrimedEntry(e) for e in row) for row in T]\n+        # remove empty trailing rows\n+        for i, row in enumerate(reversed(T)):\n+            if row:\n+                return T[:-i or None]\n+        return []\n \n     def check(self):\n         \"\"\"\n@@ -354,6 +374,12 @@ class ShiftedPrimedTableau(ClonableArray):\n             sage: ascii_art(ShiftedPrimedTableau([]))\n             ++\n             ++\n+\n+            sage: ascii_art(ShiftedPrimedTableau([], skew=[1]))\n+            +---+\n+            | . |\n+            +---+\n+\n         \"\"\"\n         from sage.typeset.ascii_art import AsciiArt\n         return AsciiArt(self._ascii_art_table(unicode=False).splitlines())\n@@ -383,6 +409,10 @@ class ShiftedPrimedTableau(ClonableArray):\n             sage: unicode_art(ShiftedPrimedTableau([]))\n             \u250c\u2510\n             \u2514\u2518\n+            sage: unicode_art(ShiftedPrimedTableau([], skew=[1]))\n+            \u250c\u2500\u2500\u2500\u2510\n+            \u2502 . \u2502\n+            \u2514\u2500\u2500\u2500\u2518\n         \"\"\"\n         from sage.typeset.unicode_art import UnicodeArt\n         return UnicodeArt(self._ascii_art_table(unicode=True).splitlines())\n@@ -492,6 +522,14 @@ class ShiftedPrimedTableau(ClonableArray):\n             sage: s.pp()\n              .  .  2' 2  3\n                 .  2'\n+\n+        TESTS::\n+\n+            sage: ShiftedPrimedTableau([],skew=[1]).pp()\n+            .\n+\n+            sage: ShiftedPrimedTableau([]).pp()\n+            <BLANKLINE>\n         \"\"\"\n         print(self._repr_diagram())\n \n@@ -523,12 +561,19 @@ class ShiftedPrimedTableau(ClonableArray):\n             sage: Tab = ShiftedPrimedTableau([(1,1,'2p','3p'),(2,2)])\n             sage: Tab.max_entry()\n             3\n-        \"\"\"\n-        if not self:\n-            return 0\n \n-        return max(entry.unprimed() for row in self\n-                   for entry in row if entry is not None)\n+        TESTS::\n+\n+            sage: Tab = ShiftedPrimedTableau([], skew=[2,1])\n+            sage: Tab.max_entry()\n+            0\n+\n+            sage: Tab = ShiftedPrimedTableau([[\"1p\"]], skew=[2,1])\n+            sage: Tab.max_entry()\n+            1\n+        \"\"\"\n+        return max([entry.unprimed() for row in self\n+                    for entry in row if entry is not None] + [0])\n \n     def shape(self):\n         r\"\"\"\n@@ -2019,4 +2064,3 @@ def _add_strip(sub_tab, full_tab, length):\n                                                    k=len(plat_list),\n                                                    outer=plat_list):\n                 yield list(primed_strip) + list(non_primed_strip)\n-\n```",
    "created_at": "2018-02-01T08:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316136",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:7'></a>Here is a proposal:

```
diff --git a/src/sage/combinat/shifted_primed_tableau.py b/src/sage/combinat/shifted_primed_tableau.py
index 5fd0c09..be6f46d 100644
--- a/src/sage/combinat/shifted_primed_tableau.py
+++ b/src/sage/combinat/shifted_primed_tableau.py
@@ -108,21 +108,11 @@ class ShiftedPrimedTableau(ClonableArray):
         """
         if isinstance(T, ShiftedPrimedTableau) and T._skew == skew:
             return T
-        if not T or T == [[]]:
-            return ShiftedPrimedTableaux(skew=skew)([])
-        try:
-            entry = T[0][0]
-        except TypeError:
-            raise ValueError("input tableau must be a list of lists")
-
-        if entry is None:
-            skew_ = [row.count(None) for row in T if row[0] is None]
-            if skew is not None:
-                if skew != skew_:
-                    raise ValueError("skew shape does not agree with None entries")
-            else:
-                skew = skew_
-
+        skew_ = Partition([row.count(None) for row in T])
+        if skew_:
+            if skew and Partition(skew) != skew_:
+                raise ValueError("skew shape does not agree with None entries")
+            skew = skew_
         return ShiftedPrimedTableaux(skew=skew)(T)
 
     def __init__(self, parent, T, skew=None, check=True, preprocessed=False):
@@ -163,26 +153,56 @@ class ShiftedPrimedTableau(ClonableArray):
         """
         Preprocessing list ``T`` to initialize the tableau.
 
+        The output is a list of rows as tuples, with explicit
+        ``None``'s to indicate the skew shape, and entries being
+        ``PrimedEntry``s.
+
+        Trailing empty rows are removed.
+
         TESTS::
 
-            sage: ShiftedPrimedTableau._preprocess([["2'", "3p", 3.5]],
-            ....: skew=[1])
+            sage: ShiftedPrimedTableau._preprocess([["2'", "3p", 3.5]], skew=[1])
             [(None, 2', 3', 4')]
+
+            sage: ShiftedPrimedTableau._preprocess([[None, "2'", "3p", 3.5]])
+            [(None, 2', 3', 4')]
+
+            sage: ShiftedPrimedTableau._preprocess([[None]])
+            [(None,)]
+
+            sage: ShiftedPrimedTableau._preprocess([], skew=[2,1])
+            [(None, None), (None,)]
+
+            sage: ShiftedPrimedTableau._preprocess([], skew=[])
+            []
         """
         if isinstance(T, ShiftedPrimedTableau):
             return T
 
-        # Preprocessing list t for primes and other symbols
-        T = [[PrimedEntry(entry) for entry in row if entry is not None]
-             for row in T]
-
-        if skew is not None:
-            T = ([(None,)*skew[i] + tuple(T[i])
-                  for i in range(len(skew))]
-                 + [tuple(T[i]) for i in range(len(skew), len(T))])
-        else:
-            T = [tuple(row) for row in T]
-        return T
+        skew_ = Partition([row.count(None) for row in T])
+        if skew_: # None's are explicit
+            if skew:
+                if Partition(skew) != skew_:
+                    raise ValueError("skew shape does not agree with None entries")
+            T.extend([[]]*(len(skew_)-len(T))) # Warning: these are identical lists
+            for i, s in enumerate(skew_):
+                T[i] = (None,)*s + tuple(PrimedEntry(e) for e in T[i][s:])
+            i += 1
+            T[i:] = [tuple(PrimedEntry(e) for e in row) for row in T[i:]]
+        else: # there are no None's
+            if skew:
+                T.extend([[]]*(len(skew)-len(T))) # Warning: these are identical lists
+                for i, s in enumerate(skew):
+                    T[i] = (None,)*s + tuple(PrimedEntry(e) for e in T[i])
+                i += 1
+                T[i:] = [tuple(PrimedEntry(e) for e in row) for row in T[i:]]
+            else:
+                T = [tuple(PrimedEntry(e) for e in row) for row in T]
+        # remove empty trailing rows
+        for i, row in enumerate(reversed(T)):
+            if row:
+                return T[:-i or None]
+        return []
 
     def check(self):
         """
@@ -354,6 +374,12 @@ class ShiftedPrimedTableau(ClonableArray):
             sage: ascii_art(ShiftedPrimedTableau([]))
             ++
             ++
+
+            sage: ascii_art(ShiftedPrimedTableau([], skew=[1]))
+            +---+
+            | . |
+            +---+
+
         """
         from sage.typeset.ascii_art import AsciiArt
         return AsciiArt(self._ascii_art_table(unicode=False).splitlines())
@@ -383,6 +409,10 @@ class ShiftedPrimedTableau(ClonableArray):
             sage: unicode_art(ShiftedPrimedTableau([]))
             ┌┐
             └┘
+            sage: unicode_art(ShiftedPrimedTableau([], skew=[1]))
+            ┌───┐
+            │ . │
+            └───┘
         """
         from sage.typeset.unicode_art import UnicodeArt
         return UnicodeArt(self._ascii_art_table(unicode=True).splitlines())
@@ -492,6 +522,14 @@ class ShiftedPrimedTableau(ClonableArray):
             sage: s.pp()
              .  .  2' 2  3
                 .  2'
+
+        TESTS::
+
+            sage: ShiftedPrimedTableau([],skew=[1]).pp()
+            .
+
+            sage: ShiftedPrimedTableau([]).pp()
+            <BLANKLINE>
         """
         print(self._repr_diagram())
 
@@ -523,12 +561,19 @@ class ShiftedPrimedTableau(ClonableArray):
             sage: Tab = ShiftedPrimedTableau([(1,1,'2p','3p'),(2,2)])
             sage: Tab.max_entry()
             3
-        """
-        if not self:
-            return 0
 
-        return max(entry.unprimed() for row in self
-                   for entry in row if entry is not None)
+        TESTS::
+
+            sage: Tab = ShiftedPrimedTableau([], skew=[2,1])
+            sage: Tab.max_entry()
+            0
+
+            sage: Tab = ShiftedPrimedTableau([["1p"]], skew=[2,1])
+            sage: Tab.max_entry()
+            1
+        """
+        return max([entry.unprimed() for row in self
+                    for entry in row if entry is not None] + [0])
 
     def shape(self):
         r"""
@@ -2019,4 +2064,3 @@ def _add_strip(sub_tab, full_tab, length):
                                                    k=len(plat_list),
                                                    outer=plat_list):
                 yield list(primed_strip) + list(non_primed_strip)
-
```



---

archive/issue_comments_316137.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-01T19:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316137",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316138.json:
```json
{
    "body": "<a id='comment:159'></a>I agree with the arguments here, though `ShiftedPrimedTableau(None)` should not work in my opinion.\nI fixed the `_preprocess` to deal with empty input tableaux.\n\nReplying to [comment:157 mantepse]:\n> Here is a proposal:\n> \n> ```\n> +            sage: ShiftedPrimedTableau._preprocess([[None, \"2'\", \"3p\", 3.5]])\n> +            [(None, 2', 3', 4')]\n> +\n> +            sage: ShiftedPrimedTableau._preprocess([[None]])\n> +            [(None,)]\n\n>}}}\n\nI don't agree with this test. Since `_preprocess` is a private function, we can assume all `None`'s in the tableau that get to this point are garbage, and the skew information is passed by `skew` argument.",
    "created_at": "2018-02-01T19:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316138",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:159'></a>I agree with the arguments here, though `ShiftedPrimedTableau(None)` should not work in my opinion.
I fixed the `_preprocess` to deal with empty input tableaux.

Replying to [comment:157 mantepse]:
> Here is a proposal:
> 
> ```
> +            sage: ShiftedPrimedTableau._preprocess([[None, "2'", "3p", 3.5]])
> +            [(None, 2', 3', 4')]
> +
> +            sage: ShiftedPrimedTableau._preprocess([[None]])
> +            [(None,)]

>}}}

I don't agree with this test. Since `_preprocess` is a private function, we can assume all `None`'s in the tableau that get to this point are garbage, and the skew information is passed by `skew` argument.



---

archive/issue_comments_316139.json:
```json
{
    "body": "<a id='comment:0'></a>I don't mind - I was only guessing what the responsibilities of `_preprocess` are.  It would be good if you'd clarify by saying what the expected input is.\n\nHowever, I think that treating `[]` and `[[]]` specially, as follows:\n\n```\n        if T == [] or T == [[]]:\n             return ShiftedPrimedTableaux(skew=skew)([])\n```\nis a **very** bad idea.  For example, it is now unclear whether passing tuples or other iterables would also work - I think they should.",
    "created_at": "2018-02-01T19:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316139",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:0'></a>I don't mind - I was only guessing what the responsibilities of `_preprocess` are.  It would be good if you'd clarify by saying what the expected input is.

However, I think that treating `[]` and `[[]]` specially, as follows:

```
        if T == [] or T == [[]]:
             return ShiftedPrimedTableaux(skew=skew)([])
```
is a **very** bad idea.  For example, it is now unclear whether passing tuples or other iterables would also work - I think they should.



---

archive/issue_comments_316140.json:
```json
{
    "body": "<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-01T20:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316140",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:1'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316141.json:
```json
{
    "body": "<a id='comment:162'></a>Fair enough. Let me know if this works.\n\nReplying to [comment:160 mantepse]:\n> I don't mind - I was only guessing what the responsibilities of `_preprocess` are.  It would be good if you'd clarify by saying what the expected input is.\n> \n> However, I think that treating `[]` and `[[]]` specially, as follows:\n> \n> ```\n>         if T == [] or T == [[]]:\n>              return ShiftedPrimedTableaux(skew=skew)([])\n> ```\n> is a **very** bad idea.  For example, it is now unclear whether passing tuples or other iterables would also work - I think they should.",
    "created_at": "2018-02-01T20:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316141",
    "user": "https://trac.sagemath.org/admin/accounts/users/kbparamonov"
}
```

<a id='comment:162'></a>Fair enough. Let me know if this works.

Replying to [comment:160 mantepse]:
> I don't mind - I was only guessing what the responsibilities of `_preprocess` are.  It would be good if you'd clarify by saying what the expected input is.
> 
> However, I think that treating `[]` and `[[]]` specially, as follows:
> 
> ```
>         if T == [] or T == [[]]:
>              return ShiftedPrimedTableaux(skew=skew)([])
> ```
> is a **very** bad idea.  For example, it is now unclear whether passing tuples or other iterables would also work - I think they should.



---

archive/issue_comments_316142.json:
```json
{
    "body": "<a id='comment:3'></a>Sorry, I don't understand.  In my proposal, I simply omitted this special case and it worked.  Why do you want to treat it specially?",
    "created_at": "2018-02-01T20:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316142",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:3'></a>Sorry, I don't understand.  In my proposal, I simply omitted this special case and it worked.  Why do you want to treat it specially?



---

archive/issue_comments_316143.json:
```json
{
    "body": "<a id='comment:164'></a>Replying to [comment:154 mantepse]:\n> But the bigger question is: why is `not T` preferred over `T == []` by some people.\n\n\nBecause it is both faster and covers a much broader range of inputs uniformly, such as tuples. Although in this case it is a bit too permissive. It probably is better to restrict to lists and tuples. Either that or have an explicit cast to a list/tuple.\n\n> The former is impossible to grep for, but still widely used.\n\n\nIf you are greping for it, then you are looking at something far too localized or disregarding the traceback information.",
    "created_at": "2018-02-01T21:15:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316143",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:164'></a>Replying to [comment:154 mantepse]:
> But the bigger question is: why is `not T` preferred over `T == []` by some people.


Because it is both faster and covers a much broader range of inputs uniformly, such as tuples. Although in this case it is a bit too permissive. It probably is better to restrict to lists and tuples. Either that or have an explicit cast to a list/tuple.

> The former is impossible to grep for, but still widely used.


If you are greping for it, then you are looking at something far too localized or disregarding the traceback information.



---

archive/issue_comments_316144.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-01T21:43:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316144",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316145.json:
```json
{
    "body": "<a id='comment:6'></a>Works for me!  Thanks!",
    "created_at": "2018-02-01T21:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316145",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'></a>Works for me!  Thanks!



---

archive/issue_comments_316146.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-02-01T22:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316146",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_316147.json:
```json
{
    "body": "<a id='comment:8'></a>Since there is a test for these corner cases via the `_element_constructor_` and the patchbot are green, back to positive review.",
    "created_at": "2018-02-02T10:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316147",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>Since there is a test for these corner cases via the `_element_constructor_` and the patchbot are green, back to positive review.



---

archive/issue_comments_316148.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-02T10:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316148",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_059469.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-02-03T17:50:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22921#event-59469"
}
```



---

archive/issue_comments_316149.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-02-03T17:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22921",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22921#issuecomment-316149",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
