# Issue 22679: port Sage to FreeBSD 11

archive/issues_022442.json:
```json
{
    "assignees": [],
    "body": "Please see #26249 for the followup (for FreeBSD 12).\n\nFreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. \n\n\n## preparing tools:\n\n* install gcc6 and create fake gfortran by making a link to gfortran6\n* make sure `as` is new enough: `pkg install binutils` will install `as` version 2.28, and you need it to come first in `PATH` (i.e. make sure that `/usr/local/bin` comes before `/usr/bin`).\n* remove stale `/lib/libgcc_s.so.1` and point it to the right one in `/usr/local/lib/gcc6/` (perhaps there is a better way...)\n* install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n* make sure `/bin/sh` is actually bash\n* install pkgconf (FreeBSD's replacement of pkg-config)\n* install wget (needed for `AtlasRep` GAP package).\n* install icu (needed for R)\n\n## building Sage itself\n\nstarting from a clean git repo:\n\n```\nexport CFLAGS=\"-fPIC\"\nexport CXXFLAGS=\"-fPIC\"\nexport LDFLAGS=\"-L/usr/local/lib -Wl,--add-needed -lm\"\n./configure CC=cc CXX=c++  #(this is clang 3.8.0 a.t.m.)\nMAKE=\"make -j7\" make build\nMAKE=\"make -j4\" make # building docs is very memory-hungry\n``` \n\n\n\n## HISTORICAL: Sage itself:\n\n* hack configure.ac to make freebsd allowed platform\n* deal with cephes' complex.h conflicting with numpy - #22786 \n* gf2x: only builds with SAGE_FAT_BINARY on\n* upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)\n* flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n* libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed)) - see #22784\n* but gap cannot be built with CC=\"cc -fPIC -pipe\", as it does something weird in ./configure, setting BASECC to be cc, and generating broken Makefile (with -fPIC and -pipe on two separate lines); so build gap with CC=cc \n* giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h` and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n* either provide /bin/bash or fix this properly (#22689)\n* Sage builds and runs, modulo linking issues with flint and arb, which can be fixed ad hoc by hand.\n* deal with cephes' libm not pulling system's libm, unless some arcane linker flags are used (see comments below)\n* old freebsd workaround for libgd removed in #22785\n* ...\n\nDepends on #12426\nDepends on #23700\n\nCC:  @sagetrac-stephen @kiwifb @jdemeyer @jpflori\n\nBranch/Commit: **[u/dimpase/fbsd-support](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/fbsd-support) @ [`4aaeeb4`](https://github.com/sagemath/sagetrac-mirror/commit/4aaeeb491635abea35e2804eeee7c93a80af38ea)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Dima Pasechnik**\n\nComponent: **porting: BSD**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22679_\n\n",
    "closed_at": "2018-09-13T10:45:25Z",
    "created_at": "2017-03-24T07:36:15Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20bsd",
        "https://github.com/sagemath/sage/labels/wontfix"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "port Sage to FreeBSD 11",
    "type": "issue",
    "updated_at": "2019-07-18T13:38:10Z",
    "url": "https://github.com/sagemath/sage/issues/22679",
    "user": "https://github.com/dimpase"
}
```
Please see #26249 for the followup (for FreeBSD 12).

FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. 


## preparing tools:

* install gcc6 and create fake gfortran by making a link to gfortran6
* make sure `as` is new enough: `pkg install binutils` will install `as` version 2.28, and you need it to come first in `PATH` (i.e. make sure that `/usr/local/bin` comes before `/usr/bin`).
* remove stale `/lib/libgcc_s.so.1` and point it to the right one in `/usr/local/lib/gcc6/` (perhaps there is a better way...)
* install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
* make sure `/bin/sh` is actually bash
* install pkgconf (FreeBSD's replacement of pkg-config)
* install wget (needed for `AtlasRep` GAP package).
* install icu (needed for R)

## building Sage itself

starting from a clean git repo:

```
export CFLAGS="-fPIC"
export CXXFLAGS="-fPIC"
export LDFLAGS="-L/usr/local/lib -Wl,--add-needed -lm"
./configure CC=cc CXX=c++  #(this is clang 3.8.0 a.t.m.)
MAKE="make -j7" make build
MAKE="make -j4" make # building docs is very memory-hungry
``` 



## HISTORICAL: Sage itself:

* hack configure.ac to make freebsd allowed platform
* deal with cephes' complex.h conflicting with numpy - #22786 
* gf2x: only builds with SAGE_FAT_BINARY on
* upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)
* flint: remove "-ascii -pedantic" flags from CFLAGS in configure
* libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed)) - see #22784
* but gap cannot be built with CC="cc -fPIC -pipe", as it does something weird in ./configure, setting BASECC to be cc, and generating broken Makefile (with -fPIC and -pipe on two separate lines); so build gap with CC=cc 
* giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h` and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
* either provide /bin/bash or fix this properly (#22689)
* Sage builds and runs, modulo linking issues with flint and arb, which can be fixed ad hoc by hand.
* deal with cephes' libm not pulling system's libm, unless some arcane linker flags are used (see comments below)
* old freebsd workaround for libgd removed in #22785
* ...

Depends on #12426
Depends on #23700

CC:  @sagetrac-stephen @kiwifb @jdemeyer @jpflori

Branch/Commit: **[u/dimpase/fbsd-support](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/fbsd-support) @ [`4aaeeb4`](https://github.com/sagemath/sagetrac-mirror/commit/4aaeeb491635abea35e2804eeee7c93a80af38ea)**

Reviewer: **Dima Pasechnik**

Author: **Dima Pasechnik**

Component: **porting: BSD**

_Issue created by migration from https://trac.sagemath.org/ticket/22679_





---

archive/issue_events_318193.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-03-24T07:36:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318193"
}
```



---

archive/issue_events_318194.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-03-24T07:36:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20porting%3A%20bsd",
    "label_color": "000080",
    "label_name": "c: porting: bsd",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318194"
}
```



---

archive/issue_events_318195.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-03-24T07:36:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318195"
}
```



---

archive/issue_events_318196.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-03-24T07:36:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318196"
}
```



---

archive/issue_comments_337064.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n * install gcc6 and create fake gfortran by making a link to gcc6\n * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n * make sure /bin/sh is actually bash\n-* hack configure.ac to make freebsd applowed platform\n+* hack configure.ac to make freebsd allowed platform\n * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway\n * figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, \n * gf2x only builds with SAGE_FAT_BINARY on\n``````\n",
    "created_at": "2017-03-24T07:38:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337064",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 * install gcc6 and create fake gfortran by making a link to gcc6
 * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
 * make sure /bin/sh is actually bash
-* hack configure.ac to make freebsd applowed platform
+* hack configure.ac to make freebsd allowed platform
 * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway
 * figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, 
 * gf2x only builds with SAGE_FAT_BINARY on
``````




---

archive/issue_comments_337065.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,4 +9,5 @@\n * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway\n * figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, \n * gf2x only builds with SAGE_FAT_BINARY on\n+* upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline\n * ...\n``````\n",
    "created_at": "2017-03-24T07:43:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337065",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,4 +9,5 @@
 * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway
 * figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, 
 * gf2x only builds with SAGE_FAT_BINARY on
+* upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline
 * ...
``````




---

archive/issue_comments_337066.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,9 +5,13 @@\n * install gcc6 and create fake gfortran by making a link to gcc6\n * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n * make sure /bin/sh is actually bash\n+* install pkgconf (FreeBSD's replacement of pkg-config)\n * hack configure.ac to make freebsd allowed platform\n * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway\n * figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, \n-* gf2x only builds with SAGE_FAT_BINARY on\n+* gf2x: only builds with SAGE_FAT_BINARY on\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline\n+* flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n+* libgap: needs -fPIC for CFLAGS\n * ...\n+ \n``````\n",
    "created_at": "2017-03-24T10:40:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337066",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,9 +5,13 @@
 * install gcc6 and create fake gfortran by making a link to gcc6
 * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
 * make sure /bin/sh is actually bash
+* install pkgconf (FreeBSD's replacement of pkg-config)
 * hack configure.ac to make freebsd allowed platform
 * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway
 * figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, 
-* gf2x only builds with SAGE_FAT_BINARY on
+* gf2x: only builds with SAGE_FAT_BINARY on
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline
+* flint: remove "-ascii -pedantic" flags from CFLAGS in configure
+* libgap: needs -fPIC for CFLAGS
 * ...
+ 
``````




---

archive/issue_comments_337067.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,14 +1,19 @@\n FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. \n \n Few details I figured out.\n+\n+\\# preparing tools:\n \n * install gcc6 and create fake gfortran by making a link to gcc6\n * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n * make sure /bin/sh is actually bash\n * install pkgconf (FreeBSD's replacement of pkg-config)\n+\n+\\# Sage itself:\n+\n * hack configure.ac to make freebsd allowed platform\n * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway\n-* figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, \n+* figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, system versions are perfectly good) \n * gf2x: only builds with SAGE_FAT_BINARY on\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n``````\n",
    "created_at": "2017-03-24T10:42:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337067",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,14 +1,19 @@
 FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. 
 
 Few details I figured out.
+
+\# preparing tools:
 
 * install gcc6 and create fake gfortran by making a link to gcc6
 * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
 * make sure /bin/sh is actually bash
 * install pkgconf (FreeBSD's replacement of pkg-config)
+
+\# Sage itself:
+
 * hack configure.ac to make freebsd allowed platform
 * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway
-* figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, 
+* figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, system versions are perfectly good) 
 * gf2x: only builds with SAGE_FAT_BINARY on
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
``````




---

archive/issue_events_318197.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-03-24T10:42:34Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "title_is": "port Sage to FreeBSD 11",
    "title_was": "port Sage to FreeBSD 11.",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318197"
}
```



---

archive/issue_comments_337068.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,14 +2,15 @@\n \n Few details I figured out.\n \n-\\# preparing tools:\n+\n+## preparing tools:\n \n * install gcc6 and create fake gfortran by making a link to gcc6\n * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n * make sure /bin/sh is actually bash\n * install pkgconf (FreeBSD's replacement of pkg-config)\n \n-\\# Sage itself:\n+## Sage itself:\n \n * hack configure.ac to make freebsd allowed platform\n * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway\n@@ -17,6 +18,6 @@\n * gf2x: only builds with SAGE_FAT_BINARY on\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n-* libgap: needs -fPIC for CFLAGS\n+* libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed))\n * ...\n  \n``````\n",
    "created_at": "2017-03-24T10:54:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337068",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,14 +2,15 @@
 
 Few details I figured out.
 
-\# preparing tools:
+
+## preparing tools:
 
 * install gcc6 and create fake gfortran by making a link to gcc6
 * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
 * make sure /bin/sh is actually bash
 * install pkgconf (FreeBSD's replacement of pkg-config)
 
-\# Sage itself:
+## Sage itself:
 
 * hack configure.ac to make freebsd allowed platform
 * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway
@@ -17,6 +18,6 @@
 * gf2x: only builds with SAGE_FAT_BINARY on
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
-* libgap: needs -fPIC for CFLAGS
+* libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed))
 * ...
  
``````




---

archive/issue_comments_337069.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\ncf my comments at\nhttps://github.com/numpy/numpy/issues/8530\n\nfor the need for /lib/libgcc_s.so.1 to be replaced.\n\nBasically, gcc/gfortran and clang's toolchains are slightly incompatible; while workarounds are in place for OSX,\nlinking on freebsd makes it more or less mandatory.",
    "created_at": "2017-03-24T13:12:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337069",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

cf my comments at
https://github.com/numpy/numpy/issues/8530

for the need for /lib/libgcc_s.so.1 to be replaced.

Basically, gcc/gfortran and clang's toolchains are slightly incompatible; while workarounds are in place for OSX,
linking on freebsd makes it more or less mandatory.



---

archive/issue_comments_337070.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,8 @@\n \n ## preparing tools:\n \n-* install gcc6 and create fake gfortran by making a link to gcc6\n+* install gcc6 and create fake gfortran by making a link to gfortran6\n+* remove stale /lib/libgcc_s.so.1 and point it to the right one in /usr/local/lib/gcc6/\n * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n * make sure /bin/sh is actually bash\n * install pkgconf (FreeBSD's replacement of pkg-config)\n``````\n",
    "created_at": "2017-03-26T07:05:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337070",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,8 @@
 
 ## preparing tools:
 
-* install gcc6 and create fake gfortran by making a link to gcc6
+* install gcc6 and create fake gfortran by making a link to gfortran6
+* remove stale /lib/libgcc_s.so.1 and point it to the right one in /usr/local/lib/gcc6/
 * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
 * make sure /bin/sh is actually bash
 * install pkgconf (FreeBSD's replacement of pkg-config)
``````




---

archive/issue_comments_337071.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,5 +20,6 @@\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed))\n+* giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h`.\n * ...\n  \n``````\n",
    "created_at": "2017-03-26T08:37:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337071",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,5 +20,6 @@
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
 * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed))
+* giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h`.
 * ...
  
``````




---

archive/issue_comments_337072.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\none of internal giac tests fail (harmlessly, I hope):\n\n```\n< -sqrt(6)*I*sqrt(sqrt(13)+3),sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,\n---\n> sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,\nFAIL: chk_fhan16\n```",
    "created_at": "2017-03-26T09:15:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337072",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

one of internal giac tests fail (harmlessly, I hope):

```
< -sqrt(6)*I*sqrt(sqrt(13)+3),sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,
---
> sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*I*sqrt(sqrt(13)+3),-sqrt(6)*sqrt(sqrt(13)-3),sqrt(6)*sqrt(sqrt(13)-3),0,
FAIL: chk_fhan16
```



---

archive/issue_comments_337073.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,6 +20,7 @@\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed))\n-* giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h`.\n+* giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h`\n+and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n * ...\n  \n``````\n",
    "created_at": "2017-03-26T09:15:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337073",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,6 +20,7 @@
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
 * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed))
-* giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h`.
+* giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h`
+and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
 * ...
  
``````




---

archive/issue_comments_337074.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,10 +17,9 @@\n * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway\n * figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, system versions are perfectly good) \n * gf2x: only builds with SAGE_FAT_BINARY on\n-* upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline\n+* upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed))\n-* giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h`\n-and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n+* giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h` and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n * ...\n  \n``````\n",
    "created_at": "2017-03-27T00:05:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337074",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,10 +17,9 @@
 * get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway
 * figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, system versions are perfectly good) 
 * gf2x: only builds with SAGE_FAT_BINARY on
-* upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline
+* upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
 * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed))
-* giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h`
-and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
+* giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h` and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
 * ...
  
``````




---

archive/issue_comments_337075.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2017-03-27T08:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337075",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_comments_337076.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -21,5 +21,6 @@\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed))\n * giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h` and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n+* either provide /bin/bash or fix this properly (#22689)\n * ...\n  \n``````\n",
    "created_at": "2017-03-27T08:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337076",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -21,5 +21,6 @@
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
 * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed))
 * giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h` and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
+* either provide /bin/bash or fix this properly (#22689)
 * ...
  
``````




---

archive/issue_comments_337077.json:
```json
{
    "body": "Dependencies: **#22687**",
    "created_at": "2017-03-27T08:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337077",
    "user": "https://github.com/dimpase"
}
```

Dependencies: **#22687**



---

archive/issue_comments_337078.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a44a934ebb984c57af8e8a5e1ec86d6a0b889953\"><code>a44a934</code></a></td><td><code>updating sqlite to version 3.17</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a32b0c7ced6e21930dad895a4e587dcc487d2c57\"><code>a32b0c7</code></a></td><td><code>let Sage accept freebsd</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3178fbc4c0a77b1ed59e938ad4fb733223217165\"><code>3178fbc</code></a></td><td><code>remove -ascii -pedantic flags from configure</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4691d92fb4f5112076fa9c59af4d414c2d0e8b32\"><code>4691d92</code></a></td><td><code>allow clang++ and libc++ combo on freebsd</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/90234a3bb7502f31b625d7315a94d6737579e2c0\"><code>90234a3</code></a></td><td><code>using libintl from /usr/local/</code></td></tr></table>\n",
    "created_at": "2017-03-27T08:47:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337078",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a44a934ebb984c57af8e8a5e1ec86d6a0b889953"><code>a44a934</code></a></td><td><code>updating sqlite to version 3.17</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a32b0c7ced6e21930dad895a4e587dcc487d2c57"><code>a32b0c7</code></a></td><td><code>let Sage accept freebsd</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3178fbc4c0a77b1ed59e938ad4fb733223217165"><code>3178fbc</code></a></td><td><code>remove -ascii -pedantic flags from configure</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4691d92fb4f5112076fa9c59af4d414c2d0e8b32"><code>4691d92</code></a></td><td><code>allow clang++ and libc++ combo on freebsd</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/90234a3bb7502f31b625d7315a94d6737579e2c0"><code>90234a3</code></a></td><td><code>using libintl from /usr/local/</code></td></tr></table>




---

archive/issue_comments_337079.json:
```json
{
    "body": "Commit: **[`90234a3`](https://github.com/sagemath/sagetrac-mirror/commit/90234a3bb7502f31b625d7315a94d6737579e2c0)**",
    "created_at": "2017-03-27T08:47:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337079",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`90234a3`](https://github.com/sagemath/sagetrac-mirror/commit/90234a3bb7502f31b625d7315a94d6737579e2c0)**



---

archive/issue_comments_337080.json:
```json
{
    "body": "Branch: **[u/dimpase/freebsd_experimental](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/freebsd_experimental)**",
    "created_at": "2017-03-27T08:47:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337080",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/freebsd_experimental](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/freebsd_experimental)**



---

archive/issue_comments_337081.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df76ac248d308d0d51a76f43018ed9f714b7bf13\"><code>df76ac2</code></a></td><td><code>temporary fix to mke building on freebsd work</code></td></tr></table>\n",
    "created_at": "2017-03-27T09:13:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337081",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df76ac248d308d0d51a76f43018ed9f714b7bf13"><code>df76ac2</code></a></td><td><code>temporary fix to mke building on freebsd work</code></td></tr></table>




---

archive/issue_comments_337082.json:
```json
{
    "body": "Changed commit from **[`90234a3`](https://github.com/sagemath/sagetrac-mirror/commit/90234a3bb7502f31b625d7315a94d6737579e2c0)** to **[`df76ac2`](https://github.com/sagemath/sagetrac-mirror/commit/df76ac248d308d0d51a76f43018ed9f714b7bf13)**",
    "created_at": "2017-03-27T09:13:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337082",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`90234a3`](https://github.com/sagemath/sagetrac-mirror/commit/90234a3bb7502f31b625d7315a94d6737579e2c0)** to **[`df76ac2`](https://github.com/sagemath/sagetrac-mirror/commit/df76ac248d308d0d51a76f43018ed9f714b7bf13)**



---

archive/issue_comments_337083.json:
```json
{
    "body": "Changed commit from **[`df76ac2`](https://github.com/sagemath/sagetrac-mirror/commit/df76ac248d308d0d51a76f43018ed9f714b7bf13)** to **[`f5a9b80`](https://github.com/sagemath/sagetrac-mirror/commit/f5a9b80bef908a59ae04c4f4090ac9293d6f2bc6)**",
    "created_at": "2017-03-27T09:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337083",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`df76ac2`](https://github.com/sagemath/sagetrac-mirror/commit/df76ac248d308d0d51a76f43018ed9f714b7bf13)** to **[`f5a9b80`](https://github.com/sagemath/sagetrac-mirror/commit/f5a9b80bef908a59ae04c4f4090ac9293d6f2bc6)**



---

archive/issue_comments_337084.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5a9b80bef908a59ae04c4f4090ac9293d6f2bc6\"><code>f5a9b80</code></a></td><td><code>disable cephes installation on freebsd version >= 10</code></td></tr></table>\n",
    "created_at": "2017-03-27T09:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337084",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5a9b80bef908a59ae04c4f4090ac9293d6f2bc6"><code>f5a9b80</code></a></td><td><code>disable cephes installation on freebsd version >= 10</code></td></tr></table>




---

archive/issue_comments_337085.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,6 +20,10 @@\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed))\n+* but gap cannot be built with CC=\"cc -fPIC -pipe\", as it\n+does something weird in ./configure, setting BASECC to be cc,\n+and generating broken Makefile (with -fPIC and -pipe on two\n+separate lines); so build gap with CC=cc \n * giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h` and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n * either provide /bin/bash or fix this properly (#22689)\n * ...\n``````\n",
    "created_at": "2017-03-27T10:24:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337085",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,6 +20,10 @@
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
 * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed))
+* but gap cannot be built with CC="cc -fPIC -pipe", as it
+does something weird in ./configure, setting BASECC to be cc,
+and generating broken Makefile (with -fPIC and -pipe on two
+separate lines); so build gap with CC=cc 
 * giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h` and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
 * either provide /bin/bash or fix this properly (#22689)
 * ...
``````




---

archive/issue_comments_337086.json:
```json
{
    "body": "Changed commit from **[`f5a9b80`](https://github.com/sagemath/sagetrac-mirror/commit/f5a9b80bef908a59ae04c4f4090ac9293d6f2bc6)** to **[`9b622a8`](https://github.com/sagemath/sagetrac-mirror/commit/9b622a862a8476e9394c4e25aa2863f96de07ef5)**",
    "created_at": "2017-03-27T13:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337086",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f5a9b80`](https://github.com/sagemath/sagetrac-mirror/commit/f5a9b80bef908a59ae04c4f4090ac9293d6f2bc6)** to **[`9b622a8`](https://github.com/sagemath/sagetrac-mirror/commit/9b622a862a8476e9394c4e25aa2863f96de07ef5)**



---

archive/issue_comments_337087.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/516f0291f093af9415003b6b99c7d0ecb1ee8ac8\"><code>516f029</code></a></td><td><code>Upgraded to R 3.3.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbe9134ad7aaf1b490ea424164ba1991d8440696\"><code>cbe9134</code></a></td><td><code>Merge branch 'public/r311' of git://trac.sagemath.org/sage into finalr</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f029f66bbf131eb7cdd4f8bfbe42d5c560baea1c\"><code>f029f66</code></a></td><td><code>This simple patch removes an overkill check in R's configure.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8a0b1b4f3e89b9630e4996a6362491ffa6e6e04\"><code>c8a0b1b</code></a></td><td><code>Merge branch 'public/r311' of trac.sagemath.org:sage into sqliteupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d0d5ca778cf897f2b1c9742f9d0b9966625d591e\"><code>d0d5ca7</code></a></td><td><code>update fplll/fpylll to 5.1.0/0.2.4dev</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f702f30e7bfdded49a0a93311f33fff022ab163\"><code>9f702f3</code></a></td><td><code>Merge branch 'u/malb/22643-fplll-upgrade' of trac.sagemath.org:sage into sqliteupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1201132859bd8f9d32ea0d5c2a4583f5f3510c30\"><code>1201132</code></a></td><td><code>LONG_LONG_MAX is an obsolete gnu-ism</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/276e658234149e14ce20f87f729b89e462b77a30\"><code>276e658</code></a></td><td><code>R on freebsd needs this for libcurl</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c0c6034c220f2658cf8b6b1512e11720d956c1e\"><code>0c0c603</code></a></td><td><code>Write custom create_extension() for Cython</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b622a862a8476e9394c4e25aa2863f96de07ef5\"><code>9b622a8</code></a></td><td><code>Merge branch 'u/jdemeyer/use_create_extension___from_cython' of trac.sagemath.org:sage into sqliteupdate</code></td></tr></table>\n",
    "created_at": "2017-03-27T13:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337087",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/516f0291f093af9415003b6b99c7d0ecb1ee8ac8"><code>516f029</code></a></td><td><code>Upgraded to R 3.3.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbe9134ad7aaf1b490ea424164ba1991d8440696"><code>cbe9134</code></a></td><td><code>Merge branch 'public/r311' of git://trac.sagemath.org/sage into finalr</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f029f66bbf131eb7cdd4f8bfbe42d5c560baea1c"><code>f029f66</code></a></td><td><code>This simple patch removes an overkill check in R's configure.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8a0b1b4f3e89b9630e4996a6362491ffa6e6e04"><code>c8a0b1b</code></a></td><td><code>Merge branch 'public/r311' of trac.sagemath.org:sage into sqliteupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d0d5ca778cf897f2b1c9742f9d0b9966625d591e"><code>d0d5ca7</code></a></td><td><code>update fplll/fpylll to 5.1.0/0.2.4dev</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f702f30e7bfdded49a0a93311f33fff022ab163"><code>9f702f3</code></a></td><td><code>Merge branch 'u/malb/22643-fplll-upgrade' of trac.sagemath.org:sage into sqliteupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1201132859bd8f9d32ea0d5c2a4583f5f3510c30"><code>1201132</code></a></td><td><code>LONG_LONG_MAX is an obsolete gnu-ism</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/276e658234149e14ce20f87f729b89e462b77a30"><code>276e658</code></a></td><td><code>R on freebsd needs this for libcurl</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c0c6034c220f2658cf8b6b1512e11720d956c1e"><code>0c0c603</code></a></td><td><code>Write custom create_extension() for Cython</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b622a862a8476e9394c4e25aa2863f96de07ef5"><code>9b622a8</code></a></td><td><code>Merge branch 'u/jdemeyer/use_create_extension___from_cython' of trac.sagemath.org:sage into sqliteupdate</code></td></tr></table>




---

archive/issue_comments_337088.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -26,5 +26,6 @@\n separate lines); so build gap with CC=cc \n * giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h` and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n * either provide /bin/bash or fix this properly (#22689)\n-* ...\n+* Sage builds and runs, modulo linking issues with flint and arb,\n+which can be fixed ad hoc by hand.\n  \n``````\n",
    "created_at": "2017-03-27T14:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337088",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -26,5 +26,6 @@
 separate lines); so build gap with CC=cc 
 * giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h` and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
 * either provide /bin/bash or fix this properly (#22689)
-* ...
+* Sage builds and runs, modulo linking issues with flint and arb,
+which can be fixed ad hoc by hand.
  
``````




---

archive/issue_comments_337089.json:
```json
{
    "body": "Changed dependencies from **#22687** to **#22687, #22643, #22554**",
    "created_at": "2017-03-27T14:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337089",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22687** to **#22687, #22643, #22554**



---

archive/issue_comments_337090.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nbuilds and runs, modulo ad hoc fixing arb and flint linking issue:\n\n```\n$ ln -sf $SAGE_LOCAL/lib/libarb.so.1.1.1 $SAGE_LOCAL/lib/libarb.so.1\n$ ln -sf $SAGE_LOCAL/lib/libflint.so.13.5.2 $SAGE_LOCAL/lib/libflint.so.13\n```",
    "created_at": "2017-03-27T14:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337090",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

builds and runs, modulo ad hoc fixing arb and flint linking issue:

```
$ ln -sf $SAGE_LOCAL/lib/libarb.so.1.1.1 $SAGE_LOCAL/lib/libarb.so.1
$ ln -sf $SAGE_LOCAL/lib/libflint.so.13.5.2 $SAGE_LOCAL/lib/libflint.so.13
```



---

archive/issue_comments_337091.json:
```json
{
    "body": "Changed commit from **[`9b622a8`](https://github.com/sagemath/sagetrac-mirror/commit/9b622a862a8476e9394c4e25aa2863f96de07ef5)** to **[`a391ad6`](https://github.com/sagemath/sagetrac-mirror/commit/a391ad68175a75057647230aedd758e8a648f03b)**",
    "created_at": "2017-03-27T14:42:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337091",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9b622a8`](https://github.com/sagemath/sagetrac-mirror/commit/9b622a862a8476e9394c4e25aa2863f96de07ef5)** to **[`a391ad6`](https://github.com/sagemath/sagetrac-mirror/commit/a391ad68175a75057647230aedd758e8a648f03b)**



---

archive/issue_comments_337092.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a391ad68175a75057647230aedd758e8a648f03b\"><code>a391ad6</code></a></td><td><code>cephes still is needed for cpow/clog</code></td></tr></table>\n",
    "created_at": "2017-03-27T14:42:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337092",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a391ad68175a75057647230aedd758e8a648f03b"><code>a391ad6</code></a></td><td><code>cephes still is needed for cpow/clog</code></td></tr></table>




---

archive/issue_comments_337093.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nwithout cephes, missing `cpow()` (shows up during building docs). \nAnd this is how things are on [official FreeBSD](https://www.freebsd.org/cgi/man.cgi?query=complex&sektion=3&manpath=FreeBSD+11.0-RELEASE+and+Ports#end).\n\nThus reverting `f5a9b80`. After thus, make completes.\n\nRunning tests now.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a391ad68175a75057647230aedd758e8a648f03b\"><code>a391ad6</code></a></td><td><code>cephes still is needed for cpow/clog</code></td></tr></table>\n",
    "created_at": "2017-03-27T14:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337093",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">comment:19</div>

without cephes, missing `cpow()` (shows up during building docs). 
And this is how things are on [official FreeBSD](https://www.freebsd.org/cgi/man.cgi?query=complex&sektion=3&manpath=FreeBSD+11.0-RELEASE+and+Ports#end).

Thus reverting `f5a9b80`. After thus, make completes.

Running tests now.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a391ad68175a75057647230aedd758e8a648f03b"><code>a391ad6</code></a></td><td><code>cephes still is needed for cpow/clog</code></td></tr></table>




---

archive/issue_comments_337094.json:
```json
{
    "body": "Changed dependencies from **#22687, #22643, #22554** to **#22687, #22643, #22554, #22692**",
    "created_at": "2017-03-27T21:21:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337094",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22687, #22643, #22554** to **#22687, #22643, #22554, #22692**



---

archive/issue_comments_337095.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nQuestion to linking experts:\n\nI am not sure whether letting cephes create `libm.so` rather than something like `libm_complex.so` is a good idea. At least I do not see how one can in such a configuration link an executable that needs things from the \"normal\" `libm` as well as from cephes---in particular as Sage has moved away from using things like `LD_LIBRARY_PATH` to using `-rpath` to link. E.g. consider\n\n```\n#include <math.h>\n#include <complex.h>\n#include <stdio.h>\nint main()\n{\n        double e=exp2(2.0);\n        double complex c=clog(2.0);\n        printf(\"\\n e=%f\\n\", e);\n        printf(\"\\n c=%f + i%f\\n\", creal(c), cimag(c));\n        return 0;\n}\n```\nWith two different `libm`'s, I don't see a way to create a working executable (with clang). However if I rename\ncephes' `libm` to `libm_complex` then (from SAGE_ROOT) the result of \n\n```\ncc -I./local/include t.c -lm -L./local/lib -lm_complex -Wl,-rpath=./local/lib\n``` \nworks just fine.",
    "created_at": "2017-03-28T08:38:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337095",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

Question to linking experts:

I am not sure whether letting cephes create `libm.so` rather than something like `libm_complex.so` is a good idea. At least I do not see how one can in such a configuration link an executable that needs things from the "normal" `libm` as well as from cephes---in particular as Sage has moved away from using things like `LD_LIBRARY_PATH` to using `-rpath` to link. E.g. consider

```
#include <math.h>
#include <complex.h>
#include <stdio.h>
int main()
{
        double e=exp2(2.0);
        double complex c=clog(2.0);
        printf("\n e=%f\n", e);
        printf("\n c=%f + i%f\n", creal(c), cimag(c));
        return 0;
}
```
With two different `libm`'s, I don't see a way to create a working executable (with clang). However if I rename
cephes' `libm` to `libm_complex` then (from SAGE_ROOT) the result of 

```
cc -I./local/include t.c -lm -L./local/lib -lm_complex -Wl,-rpath=./local/lib
``` 
works just fine.



---

archive/issue_comments_337096.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@dimpase](#comment:22):\n> Question to linking experts:\n> \n> I am not sure whether letting cephes create `libm.so` rather than something like `libm_complex.so` is a good idea. At least I do not see how one can in such a configuration link an executable that needs things from the \"normal\" `libm` as well as from cephes---in particular as Sage has moved away from using things like `LD_LIBRARY_PATH` to using `-rpath` to link. E.g. consider\n> \n> ```\n> #include <math.h>\n> #include <complex.h>\n> #include <stdio.h>\n> int main()\n> {\n>         double e=exp2(2.0);\n>         double complex c=clog(2.0);\n>         printf(\"\\n e=%f\\n\", e);\n>         printf(\"\\n c=%f + i%f\\n\", creal(c), cimag(c));\n>         return 0;\n> }\n> ```\n> With two different `libm`'s, I don't see a way to create a working executable (with clang). However if I rename\n> cephes' `libm` to `libm_complex` then (from SAGE_ROOT) the result of \n> \n> ```\n> cc -I./local/include t.c -lm -L./local/lib -lm_complex -Wl,-rpath=./local/lib\n> ``` \n> works just fine.\n\nI am not entirely sure because I think freeBSD doesn't use sonames. But linking with two shared libraries of the same name is at best awkward. The linker can take `-lm` several times and several paths with `-L`, not a problem. The problem is at runtime. Let's see an elf shared object on linux, say openblas:\n\n```\nfbissey@moonloop ~ $ readelf -d /usr/lib64/libopenblas_threads_haswellp-r0.2.15.so\n\nDynamic section at offset 0x3e3b60 contains 27 entries:\n  Tag        Type                         Name/Value\n 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]\n 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]\n 0x000000000000000e (SONAME)             Library soname: [libopenblas_threads.so.0]\n 0x000000000000000c (INIT)               0x2ab38\n....\n```\nThe linker effectively create a table of libraries to be loaded at runtime. It also can include runtime path to search first before the normal order from `ld.so.conf`. But you see that if two libraries have strictly the same name the first one to be found will be the only one used.\n\nIf you link a library the linker may not complain if it cannot resolve some symbols because it cannot combine the two `libm.so`. Undefined symbols are legal in a library. It is not in an executable. I am not quite sure in that case if the linker can even see the two different set of symbols at the same time. In any case you will still have the problem at run time.\n\nApart from different name the only way out is to have one of the two being static instead of dynamic and then you pass it to the linker as an object with its full path (not just `-L$path -lm` but `$path/libm.a`).",
    "created_at": "2017-03-28T09:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337096",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@dimpase](#comment:22):
> Question to linking experts:
> 
> I am not sure whether letting cephes create `libm.so` rather than something like `libm_complex.so` is a good idea. At least I do not see how one can in such a configuration link an executable that needs things from the "normal" `libm` as well as from cephes---in particular as Sage has moved away from using things like `LD_LIBRARY_PATH` to using `-rpath` to link. E.g. consider
> 
> ```
> #include <math.h>
> #include <complex.h>
> #include <stdio.h>
> int main()
> {
>         double e=exp2(2.0);
>         double complex c=clog(2.0);
>         printf("\n e=%f\n", e);
>         printf("\n c=%f + i%f\n", creal(c), cimag(c));
>         return 0;
> }
> ```
> With two different `libm`'s, I don't see a way to create a working executable (with clang). However if I rename
> cephes' `libm` to `libm_complex` then (from SAGE_ROOT) the result of 
> 
> ```
> cc -I./local/include t.c -lm -L./local/lib -lm_complex -Wl,-rpath=./local/lib
> ``` 
> works just fine.

I am not entirely sure because I think freeBSD doesn't use sonames. But linking with two shared libraries of the same name is at best awkward. The linker can take `-lm` several times and several paths with `-L`, not a problem. The problem is at runtime. Let's see an elf shared object on linux, say openblas:

```
fbissey@moonloop ~ $ readelf -d /usr/lib64/libopenblas_threads_haswellp-r0.2.15.so

Dynamic section at offset 0x3e3b60 contains 27 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000e (SONAME)             Library soname: [libopenblas_threads.so.0]
 0x000000000000000c (INIT)               0x2ab38
....
```
The linker effectively create a table of libraries to be loaded at runtime. It also can include runtime path to search first before the normal order from `ld.so.conf`. But you see that if two libraries have strictly the same name the first one to be found will be the only one used.

If you link a library the linker may not complain if it cannot resolve some symbols because it cannot combine the two `libm.so`. Undefined symbols are legal in a library. It is not in an executable. I am not quite sure in that case if the linker can even see the two different set of symbols at the same time. In any case you will still have the problem at run time.

Apart from different name the only way out is to have one of the two being static instead of dynamic and then you pass it to the linker as an object with its full path (not just `-L$path -lm` but `$path/libm.a`).



---

archive/issue_comments_337097.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@kiwifb](#comment:23):\n> If you link a library the linker may not complain if it cannot resolve some symbols because it cannot combine the two `libm.so`. Undefined symbols are legal in a library. It is not in an executable. I am not quite sure in that case if the linker can even see the two different set of symbols at the same time. In any case you will still have the problem at run time.\n\nThere is no `/lib/libm.so`, only `/lib/libm.so.5`.\n\nI think the idea at the time of old Sage port to FreeBSD (#9543) was that `$SAGE_LOCAL/lib/libm.so` serves as a replacement for system's `libm`.\nBut it seems that even though the former (renamed) is linked to the latter, \n\n```\n$ ldd local/lib/libm_complex.so \nlocal/lib/libm_complex.so:\n        libc.so.7 => /lib/libc.so.7 (0x800823000)\n        libm.so.5 => /lib/libm.so.5 (0x80120c000)\n\n```\nthis still leads to\nugly linker errors complaining about absent `exp2`. More specifically, if I remove `-lm` from the invocation above I get\n\n```\n$ cc -I./local/include t.c -L./local/lib -lm_complex -Wl,-rpath=./local/lib\n\n/usr/bin/ld: undefined reference to symbol `exp2@@FBSD_1.0' (try adding -lm)\n//lib/libm.so.5: could not read symbols: Bad value\n```\n(the latter is puzzling - it knows where to look for `exp2`, but bails out...)\n\n\n \n> \n> Apart from different name the only way out is to have one of the two being static instead of dynamic and then you pass it to the linker as an object with its full path (not just `-L$path -lm` but `$path/libm.a`).\n\nthis is not really better than creating a separate dynamic library, IMHO.",
    "created_at": "2017-03-28T10:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337097",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@kiwifb](#comment:23):
> If you link a library the linker may not complain if it cannot resolve some symbols because it cannot combine the two `libm.so`. Undefined symbols are legal in a library. It is not in an executable. I am not quite sure in that case if the linker can even see the two different set of symbols at the same time. In any case you will still have the problem at run time.

There is no `/lib/libm.so`, only `/lib/libm.so.5`.

I think the idea at the time of old Sage port to FreeBSD (#9543) was that `$SAGE_LOCAL/lib/libm.so` serves as a replacement for system's `libm`.
But it seems that even though the former (renamed) is linked to the latter, 

```
$ ldd local/lib/libm_complex.so 
local/lib/libm_complex.so:
        libc.so.7 => /lib/libc.so.7 (0x800823000)
        libm.so.5 => /lib/libm.so.5 (0x80120c000)

```
this still leads to
ugly linker errors complaining about absent `exp2`. More specifically, if I remove `-lm` from the invocation above I get

```
$ cc -I./local/include t.c -L./local/lib -lm_complex -Wl,-rpath=./local/lib

/usr/bin/ld: undefined reference to symbol `exp2@@FBSD_1.0' (try adding -lm)
//lib/libm.so.5: could not read symbols: Bad value
```
(the latter is puzzling - it knows where to look for `exp2`, but bails out...)


 
> 
> Apart from different name the only way out is to have one of the two being static instead of dynamic and then you pass it to the linker as an object with its full path (not just `-L$path -lm` but `$path/libm.a`).

this is not really better than creating a separate dynamic library, IMHO.



---

archive/issue_comments_337098.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nIs `/lib/libm.so.5` a real library? What does running `file` on it says?",
    "created_at": "2017-03-28T10:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337098",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

Is `/lib/libm.so.5` a real library? What does running `file` on it says?



---

archive/issue_comments_337099.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@kiwifb](#comment:25):\n> Is `/lib/libm.so.5` a real library? What does running `file` on it says?\n\n\n```\n$ file /lib/libm.so.5 \n/lib/libm.so.5: ELF 64-bit LSB shared object, x86-64, version 1 (FreeBSD), dynamically linked, stripped\n```",
    "created_at": "2017-03-28T10:41:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337099",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@kiwifb](#comment:25):
> Is `/lib/libm.so.5` a real library? What does running `file` on it says?


```
$ file /lib/libm.so.5 
/lib/libm.so.5: ELF 64-bit LSB shared object, x86-64, version 1 (FreeBSD), dynamically linked, stripped
```



---

archive/issue_comments_337100.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nOK that leaves us with the next stupid question: are you compiling in 32bits? Finally can you move `-lm` after `-lm_complex`?",
    "created_at": "2017-03-28T11:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337100",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:27" align="right">comment:27</div>

OK that leaves us with the next stupid question: are you compiling in 32bits? Finally can you move `-lm` after `-lm_complex`?



---

archive/issue_comments_337101.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@kiwifb](#comment:27):\n> OK that leaves us with the next stupid question: are you compiling in 32bits? Finally can you move `-lm` after `-lm_complex`?\n\nit's 64-bit, and yes, I can build and run the result of\n\n```\n$ cc -I./local/include t.c -L./local/lib -lm_complex -lm -Wl,-rpath=./local/lib\n```\njust fine.\n\nCertainly, having a new library to add, instead of providing a replacement for libm, is a pain, although a limited to few packages one.",
    "created_at": "2017-03-28T11:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337101",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@kiwifb](#comment:27):
> OK that leaves us with the next stupid question: are you compiling in 32bits? Finally can you move `-lm` after `-lm_complex`?

it's 64-bit, and yes, I can build and run the result of

```
$ cc -I./local/include t.c -L./local/lib -lm_complex -lm -Wl,-rpath=./local/lib
```
just fine.

Certainly, having a new library to add, instead of providing a replacement for libm, is a pain, although a limited to few packages one.



---

archive/issue_comments_337102.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\n`--as-needed` is probably your default behavior which means order is important. I suspect you are using the \"gold\" linker instead of the \"bfd\" (classic) one [don't remember how to check for that]. Short of passing `-Wl,--no-as-needed` I don't know how to make the order irrelevant.",
    "created_at": "2017-03-28T11:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337102",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:29" align="right">comment:29</div>

`--as-needed` is probably your default behavior which means order is important. I suspect you are using the "gold" linker instead of the "bfd" (classic) one [don't remember how to check for that]. Short of passing `-Wl,--no-as-needed` I don't know how to make the order irrelevant.



---

archive/issue_comments_337103.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nJust a reminder that https://svnweb.freebsd.org/ports/head/math/sage/ used to be maintained.\nMaybe some stuff can be pulled from there.",
    "created_at": "2017-03-28T11:52:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337103",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:30" align="right">comment:30</div>

Just a reminder that https://svnweb.freebsd.org/ports/head/math/sage/ used to be maintained.
Maybe some stuff can be pulled from there.



---

archive/issue_comments_337104.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nSee also #12858, #14651, #14392 and in general [this report](https://trac.sagemath.org/query?status=!closed&component=porting%3A+BSD).  I'm sure username stephen would be happy to help but we didn't really take much stuff in terms of patches lately so perhaps that is why it was no longer maintained.",
    "created_at": "2017-03-28T13:47:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337104",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:31" align="right">comment:31</div>

See also #12858, #14651, #14392 and in general [this report](https://trac.sagemath.org/query?status=!closed&component=porting%3A+BSD).  I'm sure username stephen would be happy to help but we didn't really take much stuff in terms of patches lately so perhaps that is why it was no longer maintained.



---

archive/issue_comments_337105.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@jpflori](#comment:30):\n> Just a reminder that https://svnweb.freebsd.org/ports/head/math/sage/ used to be maintained.\n> Maybe some stuff can be pulled from there.\n\nthey have there (as well as in #14491) an `ld` wrapper that uses `--copy-dt-needed-entries` option to\nrecursively search libraries. And indeed the following (with the \"classical\" GNU buntils ld) gives working `a.out`.\n\n```\n$ cc -c -I./local/include t.c\n$ /usr/local/bin/ld --eh-frame-hdr -dynamic-linker /libexec/ld-elf.so.1 -L./local/lib --copy-dt-needed-entries -rpath=./local/lib /usr/lib/crt1.o /usr/lib/crti.o t.o -lc -lm_complex /usr/lib/crtn.o\n```\n\nBut this option has a different name with the default linker, as far as testing and manuals say.\n\n```\n/usr/bin/ld: unrecognized option '--copy-dt-needed-entries'\n```\nThe reason is that the default linker used by clang is\n\n```\n$ /usr/bin/ld -v\nGNU ld 2.17.50 [FreeBSD] 2007-07-03\n```\n\nThe corresponding option is called `--add-needed`. (It's possible to find this by calling `/usr/bin/ld --help`.) So the right command (giving working `a.out`) to pull system's `libm` with the custom (renamed to `libm_complex`) `libm` is\n\n```\ncc -I./local/include -L./local/lib -Wl,--add-needed -Wl,-rpath=./local/lib -lm_complex t.c\n```",
    "created_at": "2017-03-28T13:49:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337105",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@jpflori](#comment:30):
> Just a reminder that https://svnweb.freebsd.org/ports/head/math/sage/ used to be maintained.
> Maybe some stuff can be pulled from there.

they have there (as well as in #14491) an `ld` wrapper that uses `--copy-dt-needed-entries` option to
recursively search libraries. And indeed the following (with the "classical" GNU buntils ld) gives working `a.out`.

```
$ cc -c -I./local/include t.c
$ /usr/local/bin/ld --eh-frame-hdr -dynamic-linker /libexec/ld-elf.so.1 -L./local/lib --copy-dt-needed-entries -rpath=./local/lib /usr/lib/crt1.o /usr/lib/crti.o t.o -lc -lm_complex /usr/lib/crtn.o
```

But this option has a different name with the default linker, as far as testing and manuals say.

```
/usr/bin/ld: unrecognized option '--copy-dt-needed-entries'
```
The reason is that the default linker used by clang is

```
$ /usr/bin/ld -v
GNU ld 2.17.50 [FreeBSD] 2007-07-03
```

The corresponding option is called `--add-needed`. (It's possible to find this by calling `/usr/bin/ld --help`.) So the right command (giving working `a.out`) to pull system's `libm` with the custom (renamed to `libm_complex`) `libm` is

```
cc -I./local/include -L./local/lib -Wl,--add-needed -Wl,-rpath=./local/lib -lm_complex t.c
```



---

archive/issue_comments_337106.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@kiwifb](#comment:29):\n> `--as-needed` is probably your default behavior which means order is important. I suspect you are using the \"gold\" linker instead of the \"bfd\" (classic) one [don't remember how to check for that]. Short of passing `-Wl,--no-as-needed` I don't know how to make the order irrelevant.\n\nHave a look at `library_order_list` in `src/module_list.py` to deal with ordering of libraries.",
    "created_at": "2017-03-28T13:57:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337106",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@kiwifb](#comment:29):
> `--as-needed` is probably your default behavior which means order is important. I suspect you are using the "gold" linker instead of the "bfd" (classic) one [don't remember how to check for that]. Short of passing `-Wl,--no-as-needed` I don't know how to make the order irrelevant.

Have a look at `library_order_list` in `src/module_list.py` to deal with ordering of libraries.



---

archive/issue_comments_337107.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,8 +14,7 @@\n ## Sage itself:\n \n * hack configure.ac to make freebsd allowed platform\n-* get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway\n-* figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, system versions are perfectly good) \n+* deal with cephes' complex.h comflicting with numpy\n * gf2x: only builds with SAGE_FAT_BINARY on\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n@@ -28,4 +27,5 @@\n * either provide /bin/bash or fix this properly (#22689)\n * Sage builds and runs, modulo linking issues with flint and arb,\n which can be fixed ad hoc by hand.\n- \n+* deal with cephes' libm not pulling system's libm, unless some arcane linker flags are used (see comments below)\n+* ...\n``````\n",
    "created_at": "2017-03-28T14:24:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337107",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,8 +14,7 @@
 ## Sage itself:
 
 * hack configure.ac to make freebsd allowed platform
-* get rid of cephes - it causes linking problems with libm, and is probably not needs any more anyway
-* figure out what to do with Sage's libz and libbz - they cause linking problems (needless to say, system versions are perfectly good) 
+* deal with cephes' complex.h comflicting with numpy
 * gf2x: only builds with SAGE_FAT_BINARY on
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
@@ -28,4 +27,5 @@
 * either provide /bin/bash or fix this properly (#22689)
 * Sage builds and runs, modulo linking issues with flint and arb,
 which can be fixed ad hoc by hand.
- 
+* deal with cephes' libm not pulling system's libm, unless some arcane linker flags are used (see comments below)
+* ...
``````




---

archive/issue_comments_337108.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nSomewhat ironically, `numpy` now conflics with cephes (via `<complex.h>` header), as it adapted some FreeBSD code by `stephen` for its use in complex arithmetic. :-)\nFortunately, it appears to be only the header-level conflict.",
    "created_at": "2017-03-28T14:24:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337108",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">comment:34</div>

Somewhat ironically, `numpy` now conflics with cephes (via `<complex.h>` header), as it adapted some FreeBSD code by `stephen` for its use in complex arithmetic. :-)
Fortunately, it appears to be only the header-level conflict.



---

archive/issue_comments_337109.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nrunning make as follows\n\n```\nLDFLAGS=\"-L./local/lib -Wl,--add-needed -lm\" $MAKE build\n```\nallows the build do finish, and pass many tests. Some of docbuilding crashes with rather puzzling (most probably related to multi-processing/threading) errors like\n\n```\n[dochtml] [hyperboli] loading pickled environment... not yet created\n[dochtml] \n[dochtml] Internal or unrecoverable error in:\n[dochtml] Got signal before environment was installed on our thread\n[dochtml]   [2: No such file or directory]\n[dochtml] \n[dochtml] ;;; ECL C Backtrace\n[dochtml] ;;;    0 ecl_internal_error (0x89a790705) \n[dochtml] ;;;    1 init_unixint (0x89a7b6b70) \n[dochtml] ;;;    2 init_unixint (0x89a7b6912) \n[dochtml] ;;;    3 pthread_sigmask (0x80105779d) \n[dochtml] ;;;    4 pthread_getspecific (0x801056d6f) \n[dochtml] ;;;    5 unknown (0x7ffffffff193) \n[dochtml] ;;;    6 GC_push_all_stacks (0x89ab1b7aa) \n[dochtml] ;;;    7 GC_mark_some (0x89ab10a93) \n[dochtml] ;;;    8 GC_stopped_mark (0x89ab08b3a) \n[dochtml] ;;;    9 GC_try_to_collect_inner (0x89ab08a31) \n[dochtml] ;;;   10 GC_init (0x89ab14593) \n[dochtml] ;;;   11 init_alloc (0x89a7ca9f9) \n[dochtml] ;;;   12 cl_boot (0x89a694a4b) \n[dochtml] ;;;   13 initecl (0x89a218bc0) \n[dochtml] ;;;   14 initecl (0x89a20a9f5) \n[dochtml] ;;;   15 initecl (0x89a208678) \n[dochtml] ;;;   16 _PyImport_LoadDynamicModule (0x8009334fc) \n[dochtml] ;;;   17 PyImport_AppendInittab (0x800931eff) \n[dochtml] ;;;   18 PyImport_AppendInittab (0x8009319b4) \n[dochtml] ;;;   19 PyImport_ImportModuleLevel (0x800930abe) \n[dochtml] ;;;   20 _PyBuiltin_Init (0x80090b187) \n[dochtml] ;;;   21 PyObject_Call (0x800871454) \n[dochtml] ;;;   22 PyEval_EvalFrameEx (0x800915f47) \n[dochtml] ;;;   23 PyEval_EvalCodeEx (0x800910505) \n[dochtml] ;;;   24 PyEval_EvalCode (0x80090fcd6) \n[dochtml] ;;;   25 PyImport_ExecCodeModuleEx (0x80092f521) \n[dochtml] ;;;   26 PyImport_AppendInittab (0x800932598) \n[dochtml] ;;;   27 PyImport_AppendInittab (0x800931eff) \n[dochtml] ;;;   28 PyImport_AppendInittab (0x8009319b4) \n[dochtml] ;;;   29 PyImport_ImportModuleLevel (0x800930abe) \n[dochtml] ;;;   30 _PyBuiltin_Init (0x80090b187) \n[dochtml] ;;;   31 PyEval_EvalFrameEx (0x800917ab0) \n```\n\nbuilding docs with make -j1 works. Running tests now.",
    "created_at": "2017-03-28T15:38:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337109",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:35" align="right">comment:35</div>

running make as follows

```
LDFLAGS="-L./local/lib -Wl,--add-needed -lm" $MAKE build
```
allows the build do finish, and pass many tests. Some of docbuilding crashes with rather puzzling (most probably related to multi-processing/threading) errors like

```
[dochtml] [hyperboli] loading pickled environment... not yet created
[dochtml] 
[dochtml] Internal or unrecoverable error in:
[dochtml] Got signal before environment was installed on our thread
[dochtml]   [2: No such file or directory]
[dochtml] 
[dochtml] ;;; ECL C Backtrace
[dochtml] ;;;    0 ecl_internal_error (0x89a790705) 
[dochtml] ;;;    1 init_unixint (0x89a7b6b70) 
[dochtml] ;;;    2 init_unixint (0x89a7b6912) 
[dochtml] ;;;    3 pthread_sigmask (0x80105779d) 
[dochtml] ;;;    4 pthread_getspecific (0x801056d6f) 
[dochtml] ;;;    5 unknown (0x7ffffffff193) 
[dochtml] ;;;    6 GC_push_all_stacks (0x89ab1b7aa) 
[dochtml] ;;;    7 GC_mark_some (0x89ab10a93) 
[dochtml] ;;;    8 GC_stopped_mark (0x89ab08b3a) 
[dochtml] ;;;    9 GC_try_to_collect_inner (0x89ab08a31) 
[dochtml] ;;;   10 GC_init (0x89ab14593) 
[dochtml] ;;;   11 init_alloc (0x89a7ca9f9) 
[dochtml] ;;;   12 cl_boot (0x89a694a4b) 
[dochtml] ;;;   13 initecl (0x89a218bc0) 
[dochtml] ;;;   14 initecl (0x89a20a9f5) 
[dochtml] ;;;   15 initecl (0x89a208678) 
[dochtml] ;;;   16 _PyImport_LoadDynamicModule (0x8009334fc) 
[dochtml] ;;;   17 PyImport_AppendInittab (0x800931eff) 
[dochtml] ;;;   18 PyImport_AppendInittab (0x8009319b4) 
[dochtml] ;;;   19 PyImport_ImportModuleLevel (0x800930abe) 
[dochtml] ;;;   20 _PyBuiltin_Init (0x80090b187) 
[dochtml] ;;;   21 PyObject_Call (0x800871454) 
[dochtml] ;;;   22 PyEval_EvalFrameEx (0x800915f47) 
[dochtml] ;;;   23 PyEval_EvalCodeEx (0x800910505) 
[dochtml] ;;;   24 PyEval_EvalCode (0x80090fcd6) 
[dochtml] ;;;   25 PyImport_ExecCodeModuleEx (0x80092f521) 
[dochtml] ;;;   26 PyImport_AppendInittab (0x800932598) 
[dochtml] ;;;   27 PyImport_AppendInittab (0x800931eff) 
[dochtml] ;;;   28 PyImport_AppendInittab (0x8009319b4) 
[dochtml] ;;;   29 PyImport_ImportModuleLevel (0x800930abe) 
[dochtml] ;;;   30 _PyBuiltin_Init (0x80090b187) 
[dochtml] ;;;   31 PyEval_EvalFrameEx (0x800917ab0) 
```

building docs with make -j1 works. Running tests now.



---

archive/issue_comments_337110.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\n\"interesting\" error message: 10 such errors, leading to segfaults in total in testlong, all related to\n(un)picklings and libpng. What the meaning of \"Application\" in these messages? And what is the reason? Missing or wrong `-I` option for the compiler?\n\n```\nsage -t --long src/sage/coding/binary_code.pyx\n    Killed due to segmentation fault\n...\nsage: from sage.coding.binary_code import * ## line 824 ##\nsage: M = Matrix(GF(2), [[1,1,1,1]]) ## line 825 ##\nsage: B = BinaryCode(M) ## line 826 ##\nsage: loads(dumps(B)) == B ## line 827 ##\nlibpng warning: Application was compiled with png.h from libpng-1.6.27+apng\nlibpng warning: Application  is  running with png.c from libpng-1.2.51\nGD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library\n```\n\nThe rest---for the early days like this---looks not too bad, apart from code related to elliptic curves (probably another well-localised bug, only not quite clear where):\n\n```\nsage/coding/binary_code.pyx  # Killed due to segmentation fault\nsage/coding/linear_code.py  # Killed due to segmentation fault\nsage/crypto/mq/sr.py  # Killed due to segmentation fault\nsage/graphs/generic_graph.py  # Killed due to segmentation fault\nsage/graphs/base/graph_backends.pyx  # Killed due to segmentation fault\nsage/homology/chain_complex.py  # Killed due to illegal instruction\nsage/interfaces/mwrank.py  # 5 doctests failed\nsage/interfaces/singular.py  # 2 doctests failed\nsage/interfaces/tests.py  # 1 doctest failed\nsage/lfunctions/sympow.py  # 4 doctests failed\nsage/libs/eclib/interface.py  # 34 doctests failed\nsage/libs/eclib/mwrank.pyx  # 3 doctests failed\nsage/matrix/matrix_gf2e_dense.pyx  # Killed due to segmentation fault\nsage/matrix/matrix_mod2_dense.pyx  # Killed due to segmentation fault\nsage/misc/benchmark.py  # 3 doctests failed\nsage/numerical/sdp.pyx  # 1 doctest failed\nsage/plot/graphics.py  # 1 doctest failed\nsage/plot/plot.py  # 1 doctest failed\nsage/rings/complex_double.pyx  # 2 doctests failed\nsage/rings/padics/CR_template.pxi  # 2 doctests failed\nsage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault\nsage/rings/polynomial/pbori.pyx  # Killed due to abort\nsage/rings/polynomial/polydict.pyx  # 1 doctest failed\nsage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\nsage/schemes/elliptic_curves/BSD.py  # 23 doctests failed\nsage/schemes/elliptic_curves/constructor.py  # 11 doctests failed\nsage/schemes/elliptic_curves/ell_egros.py  # 9 doctests failed\nsage/schemes/elliptic_curves/ell_generic.py  # 14 doctests failed\nsage/schemes/elliptic_curves/ell_number_field.py  # 16 doctests failed\nsage/schemes/elliptic_curves/ell_point.py  # 13 doctests failed\nsage/schemes/elliptic_curves/ell_rational_field.py  # Timed out\nsage/schemes/elliptic_curves/ell_tate_curve.py  # 4 doctests failed\nsage/schemes/elliptic_curves/heegner.py  # 48 doctests failed\nsage/schemes/elliptic_curves/height.py  # 2 doctests failed\nsage/schemes/elliptic_curves/lseries_ell.py  # 2 doctests failed\nsage/schemes/elliptic_curves/padic_lseries.py  # 2 doctests failed\nsage/schemes/elliptic_curves/padics.py  # 34 doctests failed \nsage/schemes/elliptic_curves/sha_tate.py  # Killed due to segmentation fault\nsage/structure/coerce.pyx  # 1 doctest failed\nsage/structure/element.pyx  # 1 doctest failed\nsage/structure/sage_object.pyx  # Killed due to bus error\nsage/tests/benchmark.py  # 1 doctest failed\nsage/tests/book_stein_ent.py  # 3 doctests failed\nsage/tests/cmdline.py  # 3 doctests failed\ndoc/en/constructions/algebraic_geometry.rst  # 1 doctest failed\ndoc/en/developer/coding_basics.rst  # 1 doctest failed\ndoc/en/developer/coding_in_other.rst  # 1 doctest failed\ndoc/en/prep/Calculus.rst  # 1 doctest failed\ndoc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 11 doctests failed\n```",
    "created_at": "2017-03-28T19:44:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337110",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:36" align="right">comment:36</div>

"interesting" error message: 10 such errors, leading to segfaults in total in testlong, all related to
(un)picklings and libpng. What the meaning of "Application" in these messages? And what is the reason? Missing or wrong `-I` option for the compiler?

```
sage -t --long src/sage/coding/binary_code.pyx
    Killed due to segmentation fault
...
sage: from sage.coding.binary_code import * ## line 824 ##
sage: M = Matrix(GF(2), [[1,1,1,1]]) ## line 825 ##
sage: B = BinaryCode(M) ## line 826 ##
sage: loads(dumps(B)) == B ## line 827 ##
libpng warning: Application was compiled with png.h from libpng-1.6.27+apng
libpng warning: Application  is  running with png.c from libpng-1.2.51
GD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library
```

The rest---for the early days like this---looks not too bad, apart from code related to elliptic curves (probably another well-localised bug, only not quite clear where):

```
sage/coding/binary_code.pyx  # Killed due to segmentation fault
sage/coding/linear_code.py  # Killed due to segmentation fault
sage/crypto/mq/sr.py  # Killed due to segmentation fault
sage/graphs/generic_graph.py  # Killed due to segmentation fault
sage/graphs/base/graph_backends.pyx  # Killed due to segmentation fault
sage/homology/chain_complex.py  # Killed due to illegal instruction
sage/interfaces/mwrank.py  # 5 doctests failed
sage/interfaces/singular.py  # 2 doctests failed
sage/interfaces/tests.py  # 1 doctest failed
sage/lfunctions/sympow.py  # 4 doctests failed
sage/libs/eclib/interface.py  # 34 doctests failed
sage/libs/eclib/mwrank.pyx  # 3 doctests failed
sage/matrix/matrix_gf2e_dense.pyx  # Killed due to segmentation fault
sage/matrix/matrix_mod2_dense.pyx  # Killed due to segmentation fault
sage/misc/benchmark.py  # 3 doctests failed
sage/numerical/sdp.pyx  # 1 doctest failed
sage/plot/graphics.py  # 1 doctest failed
sage/plot/plot.py  # 1 doctest failed
sage/rings/complex_double.pyx  # 2 doctests failed
sage/rings/padics/CR_template.pxi  # 2 doctests failed
sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault
sage/rings/polynomial/pbori.pyx  # Killed due to abort
sage/rings/polynomial/polydict.pyx  # 1 doctest failed
sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
sage/schemes/elliptic_curves/BSD.py  # 23 doctests failed
sage/schemes/elliptic_curves/constructor.py  # 11 doctests failed
sage/schemes/elliptic_curves/ell_egros.py  # 9 doctests failed
sage/schemes/elliptic_curves/ell_generic.py  # 14 doctests failed
sage/schemes/elliptic_curves/ell_number_field.py  # 16 doctests failed
sage/schemes/elliptic_curves/ell_point.py  # 13 doctests failed
sage/schemes/elliptic_curves/ell_rational_field.py  # Timed out
sage/schemes/elliptic_curves/ell_tate_curve.py  # 4 doctests failed
sage/schemes/elliptic_curves/heegner.py  # 48 doctests failed
sage/schemes/elliptic_curves/height.py  # 2 doctests failed
sage/schemes/elliptic_curves/lseries_ell.py  # 2 doctests failed
sage/schemes/elliptic_curves/padic_lseries.py  # 2 doctests failed
sage/schemes/elliptic_curves/padics.py  # 34 doctests failed 
sage/schemes/elliptic_curves/sha_tate.py  # Killed due to segmentation fault
sage/structure/coerce.pyx  # 1 doctest failed
sage/structure/element.pyx  # 1 doctest failed
sage/structure/sage_object.pyx  # Killed due to bus error
sage/tests/benchmark.py  # 1 doctest failed
sage/tests/book_stein_ent.py  # 3 doctests failed
sage/tests/cmdline.py  # 3 doctests failed
doc/en/constructions/algebraic_geometry.rst  # 1 doctest failed
doc/en/developer/coding_basics.rst  # 1 doctest failed
doc/en/developer/coding_in_other.rst  # 1 doctest failed
doc/en/prep/Calculus.rst  # 1 doctest failed
doc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 11 doctests failed
```



---

archive/issue_comments_337111.json:
```json
{
    "body": "Changed dependencies from **#22687, #22643, #22554, #22692** to **#22687, #22643, #22554, #22692, #22159**",
    "created_at": "2017-03-28T23:31:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337111",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22687, #22643, #22554, #22692** to **#22687, #22643, #22554, #22692, #22159**



---

archive/issue_comments_337112.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nlibpng-related segfaults are \"cured\" by #22159 ; this is of course fixing the symptom, not the root cause---as #22159 happens to carry the same version of libpng as the system-wide version.",
    "created_at": "2017-03-28T23:31:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337112",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">comment:37</div>

libpng-related segfaults are "cured" by #22159 ; this is of course fixing the symptom, not the root cause---as #22159 happens to carry the same version of libpng as the system-wide version.



---

archive/issue_comments_337113.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nIt is strange I would have expected runpath to cover you for that. If runpath don't allow to load a library other than the one in the system default location, what's the point? \"Application\" looks like it is coming from inside libpng itself, so that's an helpful message from png devs.\n\nDo you have `readelf` available? If so could we have a look at `readelf -d local/lib/python/site-packages/sage/coding/binary_code.so` when it is in a failing state?",
    "created_at": "2017-03-28T23:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337113",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:38" align="right">comment:38</div>

It is strange I would have expected runpath to cover you for that. If runpath don't allow to load a library other than the one in the system default location, what's the point? "Application" looks like it is coming from inside libpng itself, so that's an helpful message from png devs.

Do you have `readelf` available? If so could we have a look at `readelf -d local/lib/python/site-packages/sage/coding/binary_code.so` when it is in a failing state?



---

archive/issue_comments_337114.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nafter applying #22159 branch, I got\n\n```\nsage/crypto/mq/sr.py  # 7 doctests failed\nsage/interfaces/mwrank.py  # 5 doctests failed\nsage/interfaces/singular.py  # 2 doctests failed\nsage/interfaces/tests.py  # 1 doctest failed\nsage/lfunctions/sympow.py  # 4 doctests failed\nsage/libs/eclib/interface.py  # 34 doctests failed\nsage/libs/eclib/mwrank.pyx  # 3 doctests failed \nsage/misc/benchmark.py  # 3 doctests failed  \nsage/numerical/sdp.pyx  # 1 doctest failed\nsage/plot/graphics.py  # 1 doctest failed\nsage/plot/plot.py  # 1 doctest failed\nsage/rings/complex_double.pyx  # 2 doctests failed\nsage/rings/padics/CR_template.pxi  # 2 doctests failed \nsage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault\nsage/rings/polynomial/pbori.pyx  # Killed due to abort\nsage/rings/polynomial/polydict.pyx  # 1 doctest failed\nsage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\nsage/schemes/elliptic_curves/BSD.py  # 23 doctests failed\nsage/schemes/elliptic_curves/constructor.py  # 11 doctests failed\nsage/schemes/elliptic_curves/ell_egros.py  # 9 doctests failed\nsage/schemes/elliptic_curves/ell_generic.py  # 14 doctests failed\nsage/schemes/elliptic_curves/ell_number_field.py  # 16 doctests failed\nsage/schemes/elliptic_curves/ell_point.py  # 13 doctests failed \nsage/schemes/elliptic_curves/ell_rational_field.py  # 61 doctests failed\nsage/schemes/elliptic_curves/ell_tate_curve.py  # 4 doctests failed\nsage/schemes/elliptic_curves/heegner.py  # 48 doctests failed\nsage/schemes/elliptic_curves/height.py  # 2 doctests failed\nsage/schemes/elliptic_curves/lseries_ell.py  # 2 doctests failed\nsage/schemes/elliptic_curves/padic_lseries.py  # 2 doctests failed \nsage/schemes/elliptic_curves/padics.py  # 34 doctests failed\nsage/schemes/elliptic_curves/sha_tate.py  # Killed due to segmentation fault\nsage/structure/coerce.pyx  # 1 doctest failed\nsage/structure/element.pyx  # 1 doctest failed\nsage/structure/sage_object.pyx  # Killed due to abort\nsage/tests/benchmark.py  # 1 doctest failed\nsage/tests/book_stein_ent.py  # 3 doctests failed \nsage/tests/cmdline.py  # 3 doctests failed\ndoc/en/constructions/algebraic_geometry.rst  # 1 doctest failed\ndoc/en/developer/coding_basics.rst  # 1 doctest failed\ndoc/en/prep/Calculus.rst  # 1 doctest failed\ndoc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 11 doctests failed\n```",
    "created_at": "2017-03-29T07:26:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337114",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:39" align="right">comment:39</div>

after applying #22159 branch, I got

```
sage/crypto/mq/sr.py  # 7 doctests failed
sage/interfaces/mwrank.py  # 5 doctests failed
sage/interfaces/singular.py  # 2 doctests failed
sage/interfaces/tests.py  # 1 doctest failed
sage/lfunctions/sympow.py  # 4 doctests failed
sage/libs/eclib/interface.py  # 34 doctests failed
sage/libs/eclib/mwrank.pyx  # 3 doctests failed 
sage/misc/benchmark.py  # 3 doctests failed  
sage/numerical/sdp.pyx  # 1 doctest failed
sage/plot/graphics.py  # 1 doctest failed
sage/plot/plot.py  # 1 doctest failed
sage/rings/complex_double.pyx  # 2 doctests failed
sage/rings/padics/CR_template.pxi  # 2 doctests failed 
sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault
sage/rings/polynomial/pbori.pyx  # Killed due to abort
sage/rings/polynomial/polydict.pyx  # 1 doctest failed
sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
sage/schemes/elliptic_curves/BSD.py  # 23 doctests failed
sage/schemes/elliptic_curves/constructor.py  # 11 doctests failed
sage/schemes/elliptic_curves/ell_egros.py  # 9 doctests failed
sage/schemes/elliptic_curves/ell_generic.py  # 14 doctests failed
sage/schemes/elliptic_curves/ell_number_field.py  # 16 doctests failed
sage/schemes/elliptic_curves/ell_point.py  # 13 doctests failed 
sage/schemes/elliptic_curves/ell_rational_field.py  # 61 doctests failed
sage/schemes/elliptic_curves/ell_tate_curve.py  # 4 doctests failed
sage/schemes/elliptic_curves/heegner.py  # 48 doctests failed
sage/schemes/elliptic_curves/height.py  # 2 doctests failed
sage/schemes/elliptic_curves/lseries_ell.py  # 2 doctests failed
sage/schemes/elliptic_curves/padic_lseries.py  # 2 doctests failed 
sage/schemes/elliptic_curves/padics.py  # 34 doctests failed
sage/schemes/elliptic_curves/sha_tate.py  # Killed due to segmentation fault
sage/structure/coerce.pyx  # 1 doctest failed
sage/structure/element.pyx  # 1 doctest failed
sage/structure/sage_object.pyx  # Killed due to abort
sage/tests/benchmark.py  # 1 doctest failed
sage/tests/book_stein_ent.py  # 3 doctests failed 
sage/tests/cmdline.py  # 3 doctests failed
doc/en/constructions/algebraic_geometry.rst  # 1 doctest failed
doc/en/developer/coding_basics.rst  # 1 doctest failed
doc/en/prep/Calculus.rst  # 1 doctest failed
doc/en/thematic_tutorials/explicit_methods_in_number_theory/elliptic_curves.rst  # 11 doctests failed
```



---

archive/issue_comments_337115.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@kiwifb](#comment:38):\n> It is strange I would have expected runpath to cover you for that. If runpath don't allow to load a library other than the one in the system default location, what's the point? \"Application\" looks like it is coming from inside libpng itself, so that's an helpful message from png devs.\n\nOK, I'll rebuild without #22159 and post the outputs of readelf and ldd. Anyway,\nwith #22159 I get\n\n```\n$ ldd local/lib/python/site-packages/sage/coding/binary_code.so\nlocal/lib/python/site-packages/sage/coding/binary_code.so:\n        libm.so => /usr/home/dima/Sage/sage/local/lib/libm.so (0x801256000)\n        libgmp.so.22 => /usr/home/dima/Sage/sage/local/lib/libgmp.so.22 (0x801462000)\n        libpython2.7.so.1 => /usr/home/dima/Sage/sage/local/lib/libpython2.7.so.1 (0x8016e6000)\n        libpari-gmp.so.5 => /usr/home/dima/Sage/sage/local/lib/libpari-gmp.so.5 (0x801c00000)\n        libthr.so.3 => /lib/libthr.so.3 (0x802678000)\n        libc.so.7 => /lib/libc.so.7 (0x800823000)\n        libm.so.5 => /lib/libm.so.5 (0x80289f000)\n        libutil.so.9 => /lib/libutil.so.9 (0x802aca000)\n\nreadelf:\n\n0x0000000000000001 (NEEDED)             Shared library: [libm.so]\n 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.22]\n 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1]\n 0x0000000000000001 (NEEDED)             Shared library: [libpari-gmp.so.5]\n 0x0000000000000001 (NEEDED)             Shared library: [libthr.so.3]\n 0x0000000000000001 (NEEDED)             Shared library: [libc.so.7]\n 0x000000000000000f (RPATH)              Library rpath: [/usr/home/dima/Sage/sage/local/lib]\n 0x000000000000001d (RUNPATH)            Library runpath: [/usr/home/dima/Sage/sage/local/lib]\n```\n\nso there is no sign of `libpng` anywhere; I looked further in Python's dynamically loaded modules in `local/lib/python2.7/lib-dynload/`, but even there I do not see `libpng`.\n\nWhat does load it, and how? Is it a sort of dynamic loading (`dlopen`?) that is not recorded by the linker?\nWould one have to resort to analysing a dump or running under gdb? Uh-oh...",
    "created_at": "2017-03-29T07:59:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337115",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@kiwifb](#comment:38):
> It is strange I would have expected runpath to cover you for that. If runpath don't allow to load a library other than the one in the system default location, what's the point? "Application" looks like it is coming from inside libpng itself, so that's an helpful message from png devs.

OK, I'll rebuild without #22159 and post the outputs of readelf and ldd. Anyway,
with #22159 I get

```
$ ldd local/lib/python/site-packages/sage/coding/binary_code.so
local/lib/python/site-packages/sage/coding/binary_code.so:
        libm.so => /usr/home/dima/Sage/sage/local/lib/libm.so (0x801256000)
        libgmp.so.22 => /usr/home/dima/Sage/sage/local/lib/libgmp.so.22 (0x801462000)
        libpython2.7.so.1 => /usr/home/dima/Sage/sage/local/lib/libpython2.7.so.1 (0x8016e6000)
        libpari-gmp.so.5 => /usr/home/dima/Sage/sage/local/lib/libpari-gmp.so.5 (0x801c00000)
        libthr.so.3 => /lib/libthr.so.3 (0x802678000)
        libc.so.7 => /lib/libc.so.7 (0x800823000)
        libm.so.5 => /lib/libm.so.5 (0x80289f000)
        libutil.so.9 => /lib/libutil.so.9 (0x802aca000)

readelf:

0x0000000000000001 (NEEDED)             Shared library: [libm.so]
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.22]
 0x0000000000000001 (NEEDED)             Shared library: [libpython2.7.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libpari-gmp.so.5]
 0x0000000000000001 (NEEDED)             Shared library: [libthr.so.3]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.7]
 0x000000000000000f (RPATH)              Library rpath: [/usr/home/dima/Sage/sage/local/lib]
 0x000000000000001d (RUNPATH)            Library runpath: [/usr/home/dima/Sage/sage/local/lib]
```

so there is no sign of `libpng` anywhere; I looked further in Python's dynamically loaded modules in `local/lib/python2.7/lib-dynload/`, but even there I do not see `libpng`.

What does load it, and how? Is it a sort of dynamic loading (`dlopen`?) that is not recorded by the linker?
Would one have to resort to analysing a dump or running under gdb? Uh-oh...



---

archive/issue_comments_337116.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\n1) note that it says `GD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library` so we are talking about something using libgd.\n\n2) the error may not be in that file but in another part of sage that is called from that file.\n\nCheck `sage/matrix/matrix_mod2_dense.so`.",
    "created_at": "2017-03-29T08:13:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337116",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:41" align="right">comment:41</div>

1) note that it says `GD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library` so we are talking about something using libgd.

2) the error may not be in that file but in another part of sage that is called from that file.

Check `sage/matrix/matrix_mod2_dense.so`.



---

archive/issue_comments_337117.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nActually there may even be a `gd-png` executable. I have the following executables installed by `gd`\n\n```\n/usr/bin/annotate\n/usr/bin/bdftogd\n/usr/bin/gd2copypal\n/usr/bin/gd2togif\n/usr/bin/gd2topng\n/usr/bin/gdcmpgif\n/usr/bin/gdlib-config\n/usr/bin/gdparttopng\n/usr/bin/gdtopng\n/usr/bin/giftogd2\n/usr/bin/pngtogd\n/usr/bin/pngtogd2\n/usr/bin/webpng\n```",
    "created_at": "2017-03-29T08:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337117",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:42" align="right">comment:42</div>

Actually there may even be a `gd-png` executable. I have the following executables installed by `gd`

```
/usr/bin/annotate
/usr/bin/bdftogd
/usr/bin/gd2copypal
/usr/bin/gd2togif
/usr/bin/gd2topng
/usr/bin/gdcmpgif
/usr/bin/gdlib-config
/usr/bin/gdparttopng
/usr/bin/gdtopng
/usr/bin/giftogd2
/usr/bin/pngtogd
/usr/bin/pngtogd2
/usr/bin/webpng
```



---

archive/issue_comments_337118.json:
```json
{
    "body": "<div id=\"comment:43\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7467913b56d7ac5deefb7bd3abc0b9ed62265b6d\"><code>7467913</code></a></td><td><code>Upgrade to libpng-1.6.28</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55fe881ae13613c0d4b8561373c785dfb37612e1\"><code>55fe881</code></a></td><td><code>Merge branch 'u/jdemeyer/upgrade_to_latest_libpng' of trac.sagemath.org:sage into sqliteupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed47d31a65374521bdf9ee09c292adca188965a4\"><code>ed47d31</code></a></td><td><code>numpy workarond to skip cephes' complex.h</code></td></tr></table>\n",
    "created_at": "2017-03-29T10:11:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337118",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:43"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7467913b56d7ac5deefb7bd3abc0b9ed62265b6d"><code>7467913</code></a></td><td><code>Upgrade to libpng-1.6.28</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55fe881ae13613c0d4b8561373c785dfb37612e1"><code>55fe881</code></a></td><td><code>Merge branch 'u/jdemeyer/upgrade_to_latest_libpng' of trac.sagemath.org:sage into sqliteupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed47d31a65374521bdf9ee09c292adca188965a4"><code>ed47d31</code></a></td><td><code>numpy workarond to skip cephes' complex.h</code></td></tr></table>




---

archive/issue_comments_337119.json:
```json
{
    "body": "Changed commit from **[`a391ad6`](https://github.com/sagemath/sagetrac-mirror/commit/a391ad68175a75057647230aedd758e8a648f03b)** to **[`ed47d31`](https://github.com/sagemath/sagetrac-mirror/commit/ed47d31a65374521bdf9ee09c292adca188965a4)**",
    "created_at": "2017-03-29T10:11:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337119",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a391ad6`](https://github.com/sagemath/sagetrac-mirror/commit/a391ad68175a75057647230aedd758e8a648f03b)** to **[`ed47d31`](https://github.com/sagemath/sagetrac-mirror/commit/ed47d31a65374521bdf9ee09c292adca188965a4)**



---

archive/issue_comments_337120.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@kiwifb](#comment:41):\n> 1) note that it says `GD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library` so we are talking about something using libgd.\n> \n> 2) the error may not be in that file but in another part of sage that is called from that file.\n> \n> Check `sage/matrix/matrix_mod2_dense.so`.\n\nOK, I've rebuilt with old (Sage's current) libpng:\n\n```\n$ ldd local/lib/python2.7/site-packages/sage/matrix/matrix_mod2_dense.so\nlocal/lib/python2.7/site-packages/sage/matrix/matrix_mod2_dense.so:\n        libm.so => /usr/home/dima/Sage/sage/local/lib/libm.so (0x801255000)\n        libgmp.so.22 => /usr/home/dima/Sage/sage/local/lib/libgmp.so.22 (0x801461000)\n        libm4ri-0.0.20140914.so => /usr/home/dima/Sage/sage/local/lib/libm4ri-0.0.20140914.so (0x8016e5000)\n        libpng12.so.0 => /usr/home/dima/Sage/sage/local/lib/libpng12.so.0 (0x801917000)\n        libz.so => /usr/home/dima/Sage/sage/local/lib/libz.so (0x801b40000)\n        libpython2.7.so.1 => /usr/home/dima/Sage/sage/local/lib/libpython2.7.so.1 (0x801d57000)\n        libpari-gmp.so.5 => /usr/home/dima/Sage/sage/local/lib/libpari-gmp.so.5 (0x802200000)\n        libthr.so.3 => /lib/libthr.so.3 (0x802c78000)\n        libc.so.7 => /lib/libc.so.7 (0x800823000)\n        libm.so.5 => /lib/libm.so.5 (0x802e9f000)\n        libutil.so.9 => /lib/libutil.so.9 (0x8030ca000)\n```\nAnd got these errors back, too:\n\n```\nsage -t --long src/sage/matrix/matrix_mod2_dense.pyx  # Killed due to illegal instruction\n...\nsage: b*a ## line 39 ##\n[1 0 1]\n[1 0 0]\nsage: TestSuite(a).run() ## line 43 ##\nlibpng warning: Application was compiled with png.h from libpng-1.6.27+apng\nlibpng warning: Application  is  running with png.c from libpng-1.2.51\nGD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library\n```\nThat is, if we are trusting the error message, somewhere wrong headers (and a library, I suppose) were used for compilation, isn't it?",
    "created_at": "2017-03-29T11:28:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337120",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@kiwifb](#comment:41):
> 1) note that it says `GD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library` so we are talking about something using libgd.
> 
> 2) the error may not be in that file but in another part of sage that is called from that file.
> 
> Check `sage/matrix/matrix_mod2_dense.so`.

OK, I've rebuilt with old (Sage's current) libpng:

```
$ ldd local/lib/python2.7/site-packages/sage/matrix/matrix_mod2_dense.so
local/lib/python2.7/site-packages/sage/matrix/matrix_mod2_dense.so:
        libm.so => /usr/home/dima/Sage/sage/local/lib/libm.so (0x801255000)
        libgmp.so.22 => /usr/home/dima/Sage/sage/local/lib/libgmp.so.22 (0x801461000)
        libm4ri-0.0.20140914.so => /usr/home/dima/Sage/sage/local/lib/libm4ri-0.0.20140914.so (0x8016e5000)
        libpng12.so.0 => /usr/home/dima/Sage/sage/local/lib/libpng12.so.0 (0x801917000)
        libz.so => /usr/home/dima/Sage/sage/local/lib/libz.so (0x801b40000)
        libpython2.7.so.1 => /usr/home/dima/Sage/sage/local/lib/libpython2.7.so.1 (0x801d57000)
        libpari-gmp.so.5 => /usr/home/dima/Sage/sage/local/lib/libpari-gmp.so.5 (0x802200000)
        libthr.so.3 => /lib/libthr.so.3 (0x802c78000)
        libc.so.7 => /lib/libc.so.7 (0x800823000)
        libm.so.5 => /lib/libm.so.5 (0x802e9f000)
        libutil.so.9 => /lib/libutil.so.9 (0x8030ca000)
```
And got these errors back, too:

```
sage -t --long src/sage/matrix/matrix_mod2_dense.pyx  # Killed due to illegal instruction
...
sage: b*a ## line 39 ##
[1 0 1]
[1 0 0]
sage: TestSuite(a).run() ## line 43 ##
libpng warning: Application was compiled with png.h from libpng-1.6.27+apng
libpng warning: Application  is  running with png.c from libpng-1.2.51
GD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library
```
That is, if we are trusting the error message, somewhere wrong headers (and a library, I suppose) were used for compilation, isn't it?



---

archive/issue_comments_337121.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nthis is how to reproduce it at the Sage prompt, with more details (pickling is the problem):\n\n```\nsage: from sage.misc.all import loads, dumps\nsage: a=matrix(GF(2),3,range(9),sparse=False); a\n\n[0 1 0]\n[1 0 1]\n[0 1 0]\nsage: dumps(a)\nlibpng warning: Application was compiled with png.h from libpng-1.6.27+apng\n...\nSegmentation fault (core dumped)\n```\ndigging out what dumps does gives\n\n```\nsage: from six.moves import cPickle\nsage: # or just import cPickle # makes no difference\nsage: a=matrix(GF(2),3,range(9),sparse=False)\nsage: cPickle.dumps(a)\nlibpng warning: Application was compiled with png.h from libpng-1.6.27+apng\n...\n```\n\ndigging more gives:\n\n```\nsage: a=matrix(GF(2),3,range(9),sparse=False)\nsage: from sage.matrix.matrix_mod2_dense import to_png\nsage: to_png(a,\"/tmp/blah\")\nlibpng warning: Application was compiled with png.h from libpng-1.6.27+apng\nlibpng warning: Application  is  running with png.c from libpng-1.2.51\nGD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library\n```\n\n`to_png` calls `gdImage*` things from `libgd`, which in turn call `gd_png`; this uses `libpng`.\nNow one can see the cause of trouble: \n\nit's a bug in `libgd` configure, which places `-I/usr/local/include` in front of \n`-I$SAGE_LOCAL/include/...`; more precisely, there is an old FreeBSD-specific\npatch in its spkg-install, which causes this thing, 4cf1a0c642a.\n\nRemoving it fixes this problem. Duh...",
    "created_at": "2017-03-29T14:24:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337121",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:45" align="right">comment:45</div>

this is how to reproduce it at the Sage prompt, with more details (pickling is the problem):

```
sage: from sage.misc.all import loads, dumps
sage: a=matrix(GF(2),3,range(9),sparse=False); a

[0 1 0]
[1 0 1]
[0 1 0]
sage: dumps(a)
libpng warning: Application was compiled with png.h from libpng-1.6.27+apng
...
Segmentation fault (core dumped)
```
digging out what dumps does gives

```
sage: from six.moves import cPickle
sage: # or just import cPickle # makes no difference
sage: a=matrix(GF(2),3,range(9),sparse=False)
sage: cPickle.dumps(a)
libpng warning: Application was compiled with png.h from libpng-1.6.27+apng
...
```

digging more gives:

```
sage: a=matrix(GF(2),3,range(9),sparse=False)
sage: from sage.matrix.matrix_mod2_dense import to_png
sage: to_png(a,"/tmp/blah")
libpng warning: Application was compiled with png.h from libpng-1.6.27+apng
libpng warning: Application  is  running with png.c from libpng-1.2.51
GD Error: gd-png: fatal libpng error: Incompatible libpng version in application and library
```

`to_png` calls `gdImage*` things from `libgd`, which in turn call `gd_png`; this uses `libpng`.
Now one can see the cause of trouble: 

it's a bug in `libgd` configure, which places `-I/usr/local/include` in front of 
`-I$SAGE_LOCAL/include/...`; more precisely, there is an old FreeBSD-specific
patch in its spkg-install, which causes this thing, 4cf1a0c642a.

Removing it fixes this problem. Duh...



---

archive/issue_comments_337122.json:
```json
{
    "body": "<div id=\"comment:46\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b783c8c10594261d627d524732084c977f1047c\"><code>9b783c8</code></a></td><td><code>numpy workarond to skip cephes' complex.h</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82de057129d6c61a8898bcd0327e3dfb400456ff\"><code>82de057</code></a></td><td><code>not needed on FreeBSD, and causes misconfig</code></td></tr></table>\n",
    "created_at": "2017-03-29T15:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337122",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b783c8c10594261d627d524732084c977f1047c"><code>9b783c8</code></a></td><td><code>numpy workarond to skip cephes' complex.h</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82de057129d6c61a8898bcd0327e3dfb400456ff"><code>82de057</code></a></td><td><code>not needed on FreeBSD, and causes misconfig</code></td></tr></table>




---

archive/issue_comments_337123.json:
```json
{
    "body": "Changed commit from **[`ed47d31`](https://github.com/sagemath/sagetrac-mirror/commit/ed47d31a65374521bdf9ee09c292adca188965a4)** to **[`82de057`](https://github.com/sagemath/sagetrac-mirror/commit/82de057129d6c61a8898bcd0327e3dfb400456ff)**",
    "created_at": "2017-03-29T15:33:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337123",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ed47d31`](https://github.com/sagemath/sagetrac-mirror/commit/ed47d31a65374521bdf9ee09c292adca188965a4)** to **[`82de057`](https://github.com/sagemath/sagetrac-mirror/commit/82de057129d6c61a8898bcd0327e3dfb400456ff)**



---

archive/issue_comments_337124.json:
```json
{
    "body": "Changed dependencies from **#22687, #22643, #22554, #22692, #22159** to **#22687, #22643, #22554, #22692**",
    "created_at": "2017-03-29T15:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337124",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22687, #22643, #22554, #22692, #22159** to **#22687, #22643, #22554, #22692**



---

archive/issue_comments_337125.json:
```json
{
    "body": "<div id=\"comment:48\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d63b82685e0faf34afe4717a16abab9e75f84363\"><code>d63b826</code></a></td><td><code>more C++ standard conformance</code></td></tr></table>\n",
    "created_at": "2017-03-29T22:13:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337125",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:48"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d63b82685e0faf34afe4717a16abab9e75f84363"><code>d63b826</code></a></td><td><code>more C++ standard conformance</code></td></tr></table>




---

archive/issue_comments_337126.json:
```json
{
    "body": "Changed commit from **[`82de057`](https://github.com/sagemath/sagetrac-mirror/commit/82de057129d6c61a8898bcd0327e3dfb400456ff)** to **[`d63b826`](https://github.com/sagemath/sagetrac-mirror/commit/d63b82685e0faf34afe4717a16abab9e75f84363)**",
    "created_at": "2017-03-29T22:13:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337126",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`82de057`](https://github.com/sagemath/sagetrac-mirror/commit/82de057129d6c61a8898bcd0327e3dfb400456ff)** to **[`d63b826`](https://github.com/sagemath/sagetrac-mirror/commit/d63b82685e0faf34afe4717a16abab9e75f84363)**



---

archive/issue_comments_337127.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nYou should split the `libgd` commit to its own ticket. It really should be fixed. Is your `eclib` stuff in upstream already? Or in an issue on github?",
    "created_at": "2017-03-29T22:23:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337127",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:49" align="right">comment:49</div>

You should split the `libgd` commit to its own ticket. It really should be fixed. Is your `eclib` stuff in upstream already? Or in an issue on github?



---

archive/issue_comments_337128.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nfixed few ugly c++ bugs in eclib in #22711.\nThis makes clang much happier, many more doctests work.",
    "created_at": "2017-03-29T22:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337128",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:50" align="right">comment:50</div>

fixed few ugly c++ bugs in eclib in #22711.
This makes clang much happier, many more doctests work.



---

archive/issue_comments_337129.json:
```json
{
    "body": "Changed dependencies from **#22687, #22643, #22554, #22692** to **#22687, #22643, #22554, #22692, #22711**",
    "created_at": "2017-03-29T22:37:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337129",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22687, #22643, #22554, #22692** to **#22687, #22643, #22554, #22692, #22711**



---

archive/issue_comments_337130.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@kiwifb](#comment:49):\n> You should split the `libgd` commit to its own ticket. It really should be fixed.\n\nwell, it's FreeBSD-only issue, it's OK to wait until more stuff for it is ready...",
    "created_at": "2017-03-29T22:50:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337130",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@kiwifb](#comment:49):
> You should split the `libgd` commit to its own ticket. It really should be fixed.

well, it's FreeBSD-only issue, it's OK to wait until more stuff for it is ready...



---

archive/issue_comments_337131.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nNow it's down to something relatively small---mostly numerical noise:\n\n```\nsrc/sage/rings/polynomial/multi_polynomial_sequence.py  # Timed out (with segmentation fault after interrupt)\nsrc/sage/symbolic/series.pyx  # Killed due to kill signal\nsrc/sage/rings/polynomial/pbori.pyx  # Killed due to abort\nsrc/sage/plot/plot.py  # 1 doctest failed\nsrc/sage/schemes/elliptic_curves/ell_rational_field.py  # 2 doctests failed\nsrc/sage/plot/graphics.py  # 1 doctest failed\nsrc/sage/tests/cmdline.py  # 1 doctest failed\nsrc/sage/interfaces/tests.py  # Timed out\nsrc/sage/structure/element.pyx  # 1 doctest failed\nsrc/doc/en/prep/Calculus.rst  # 1 doctest failed\nsrc/sage/doctest/forker.py  # 1 doctest failed\nsrc/sage/structure/sage_object.pyx  # Timed out (with abort after interrupt)\nsrc/sage/crypto/mq/sr.py  # 7 doctests failed\nsrc/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed\nsrc/sage/interfaces/singular.py  # 2 doctests failed\nsrc/sage/lfunctions/sympow.py  # 4 doctests failed\nsrc/sage/structure/coerce.pyx  # 1 doctest failed\nsrc/doc/en/constructions/algebraic_geometry.rst  # 1 doctest failed\nsrc/sage/rings/complex_double.pyx  # 2 doctests failed\nsrc/sage/numerical/sdp.pyx  # 1 doctest failed\nsrc/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed\nsrc/sage/rings/polynomial/polydict.pyx  # 1 doctest failed\n```",
    "created_at": "2017-03-29T23:06:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337131",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:52" align="right">comment:52</div>

Now it's down to something relatively small---mostly numerical noise:

```
src/sage/rings/polynomial/multi_polynomial_sequence.py  # Timed out (with segmentation fault after interrupt)
src/sage/symbolic/series.pyx  # Killed due to kill signal
src/sage/rings/polynomial/pbori.pyx  # Killed due to abort
src/sage/plot/plot.py  # 1 doctest failed
src/sage/schemes/elliptic_curves/ell_rational_field.py  # 2 doctests failed
src/sage/plot/graphics.py  # 1 doctest failed
src/sage/tests/cmdline.py  # 1 doctest failed
src/sage/interfaces/tests.py  # Timed out
src/sage/structure/element.pyx  # 1 doctest failed
src/doc/en/prep/Calculus.rst  # 1 doctest failed
src/sage/doctest/forker.py  # 1 doctest failed
src/sage/structure/sage_object.pyx  # Timed out (with abort after interrupt)
src/sage/crypto/mq/sr.py  # 7 doctests failed
src/sage/schemes/elliptic_curves/lseries_ell.py  # 1 doctest failed
src/sage/interfaces/singular.py  # 2 doctests failed
src/sage/lfunctions/sympow.py  # 4 doctests failed
src/sage/structure/coerce.pyx  # 1 doctest failed
src/doc/en/constructions/algebraic_geometry.rst  # 1 doctest failed
src/sage/rings/complex_double.pyx  # 2 doctests failed
src/sage/numerical/sdp.pyx  # 1 doctest failed
src/sage/rings/polynomial/polynomial_real_mpfr_dense.pyx  # 1 doctest failed
src/sage/rings/polynomial/polydict.pyx  # 1 doctest failed
```



---

archive/issue_comments_337132.json:
```json
{
    "body": "Changed commit from **[`d63b826`](https://github.com/sagemath/sagetrac-mirror/commit/d63b82685e0faf34afe4717a16abab9e75f84363)** to **[`118429b`](https://github.com/sagemath/sagetrac-mirror/commit/118429ba062ede124cba25ad04e69f4a81a728bb)**",
    "created_at": "2017-03-29T23:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337132",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d63b826`](https://github.com/sagemath/sagetrac-mirror/commit/d63b82685e0faf34afe4717a16abab9e75f84363)** to **[`118429b`](https://github.com/sagemath/sagetrac-mirror/commit/118429ba062ede124cba25ad04e69f4a81a728bb)**



---

archive/issue_comments_337133.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/118429ba062ede124cba25ad04e69f4a81a728bb\"><code>118429b</code></a></td><td><code>brial updated to commit 63f747626822f5e0fa2bf975f7801fcc988eb530</code></td></tr></table>\n",
    "created_at": "2017-03-29T23:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337133",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/118429ba062ede124cba25ad04e69f4a81a728bb"><code>118429b</code></a></td><td><code>brial updated to commit 63f747626822f5e0fa2bf975f7801fcc988eb530</code></td></tr></table>




---

archive/issue_comments_337134.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nDima, how are you skipping the building of gcc? Or you don't like I do on OS X?",
    "created_at": "2017-04-03T22:46:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337134",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:54" align="right">comment:54</div>

Dima, how are you skipping the building of gcc? Or you don't like I do on OS X?



---

archive/issue_comments_337135.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@kiwifb](#comment:54):\n> Dima, how are you skipping the building of gcc? Or you don't like I do on OS X?\n\nIt's easy in this case.\nI've installed FreeBSD's package gcc6, which comes, well, with gcc-6.3, and does not install gcc or gfortran. Then I made a symbolic link pointing gfortran to gfortran6.\nAnd building with SAGE_INSTALL_GCC=no does the trick.\n\nPS. I'm on vacation for another week, replies might be slow :-)",
    "created_at": "2017-04-03T23:07:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337135",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@kiwifb](#comment:54):
> Dima, how are you skipping the building of gcc? Or you don't like I do on OS X?

It's easy in this case.
I've installed FreeBSD's package gcc6, which comes, well, with gcc-6.3, and does not install gcc or gfortran. Then I made a symbolic link pointing gfortran to gfortran6.
And building with SAGE_INSTALL_GCC=no does the trick.

PS. I'm on vacation for another week, replies might be slow :-)



---

archive/issue_comments_337136.json:
```json
{
    "body": "Changed dependencies from **#22687, #22643, #22554, #22692, #22711** to **#22687, #22643, #22554, #22692, #22711, #22677**",
    "created_at": "2017-04-04T09:00:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337136",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22687, #22643, #22554, #22692, #22711** to **#22687, #22643, #22554, #22692, #22711, #22677**



---

archive/issue_comments_337137.json:
```json
{
    "body": "<div id=\"comment:57\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ca304a8735d78d78cf90fe921ead8f90ffc61703\"><code>ca304a8</code></a></td><td><code>Merge branch 'u/fbissey/brial-0.8.6' of trac.sagemath.org:sage into testpng</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5cd7e91d17daec4eff659eac5410842bb2a82f46\"><code>5cd7e91</code></a></td><td><code>delete...</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6099ae4685a578b994f63e9cae97ca3f6460632f\"><code>6099ae4</code></a></td><td><code>update to brial 0.8.7</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4abc444013c897027b7e0ef5018b0c41940d1456\"><code>4abc444</code></a></td><td><code>Merge branch 'u/dimpase/sqliteupdate' of trac.sagemath.org:sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7677635dca6d7b39d374a0fc4889d180d0eb8d9d\"><code>7677635</code></a></td><td><code>Merge branch 'u/malb/22643-fplll-upgrade' of trac.sagemath.org:sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c6c479a0be70532c00cfa912aeb1bfefd6186a9\"><code>7c6c479</code></a></td><td><code>merging sage 8.0.beta0 and new eclib</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/382b25cc1c348d8503fdcaaf122499dc6b255c70\"><code>382b25c</code></a></td><td><code>update to brial 0.8.7</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cc8cb1c51b0df695fb4f456b14b0c4dc8989d142\"><code>cc8cb1c</code></a></td><td><code>Merge branch 'u/dimpase/brial086' of trac.sagemath.org:sage into freebsdport</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b2b060cfa1b4658628168a19b41db65a85a9253\"><code>0b2b060</code></a></td><td><code>LONG_LONG_MAX is an obsolete gnu-ism</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27e7ae2281fbac817e895e1ed9dcb76ad938ddab\"><code>27e7ae2</code></a></td><td><code>Merge branch 'u/dimpase/llongfix' of trac.sagemath.org:sage into freebsdport</code></td></tr></table>\n",
    "created_at": "2017-04-05T07:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337137",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:57"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ca304a8735d78d78cf90fe921ead8f90ffc61703"><code>ca304a8</code></a></td><td><code>Merge branch 'u/fbissey/brial-0.8.6' of trac.sagemath.org:sage into testpng</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5cd7e91d17daec4eff659eac5410842bb2a82f46"><code>5cd7e91</code></a></td><td><code>delete...</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6099ae4685a578b994f63e9cae97ca3f6460632f"><code>6099ae4</code></a></td><td><code>update to brial 0.8.7</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4abc444013c897027b7e0ef5018b0c41940d1456"><code>4abc444</code></a></td><td><code>Merge branch 'u/dimpase/sqliteupdate' of trac.sagemath.org:sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7677635dca6d7b39d374a0fc4889d180d0eb8d9d"><code>7677635</code></a></td><td><code>Merge branch 'u/malb/22643-fplll-upgrade' of trac.sagemath.org:sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c6c479a0be70532c00cfa912aeb1bfefd6186a9"><code>7c6c479</code></a></td><td><code>merging sage 8.0.beta0 and new eclib</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/382b25cc1c348d8503fdcaaf122499dc6b255c70"><code>382b25c</code></a></td><td><code>update to brial 0.8.7</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cc8cb1c51b0df695fb4f456b14b0c4dc8989d142"><code>cc8cb1c</code></a></td><td><code>Merge branch 'u/dimpase/brial086' of trac.sagemath.org:sage into freebsdport</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b2b060cfa1b4658628168a19b41db65a85a9253"><code>0b2b060</code></a></td><td><code>LONG_LONG_MAX is an obsolete gnu-ism</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27e7ae2281fbac817e895e1ed9dcb76ad938ddab"><code>27e7ae2</code></a></td><td><code>Merge branch 'u/dimpase/llongfix' of trac.sagemath.org:sage into freebsdport</code></td></tr></table>




---

archive/issue_comments_337138.json:
```json
{
    "body": "Changed commit from **[`118429b`](https://github.com/sagemath/sagetrac-mirror/commit/118429ba062ede124cba25ad04e69f4a81a728bb)** to **[`27e7ae2`](https://github.com/sagemath/sagetrac-mirror/commit/27e7ae2281fbac817e895e1ed9dcb76ad938ddab)**",
    "created_at": "2017-04-05T07:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337138",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`118429b`](https://github.com/sagemath/sagetrac-mirror/commit/118429ba062ede124cba25ad04e69f4a81a728bb)** to **[`27e7ae2`](https://github.com/sagemath/sagetrac-mirror/commit/27e7ae2281fbac817e895e1ed9dcb76ad938ddab)**



---

archive/issue_comments_337139.json:
```json
{
    "body": "Changed dependencies from **#22687, #22643, #22554, #22692, #22711, #22677** to **#22687, #22643, #22554, #22692, #22711, #22677, #22759, #22714**",
    "created_at": "2017-04-05T20:21:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337139",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22687, #22643, #22554, #22692, #22711, #22677** to **#22687, #22643, #22554, #22692, #22711, #22677, #22759, #22714**



---

archive/issue_comments_337140.json:
```json
{
    "body": "Changed dependencies from **#22687, #22643, #22554, #22692, #22711, #22677, #22759, #22714** to **#21977, #22677, #22759, #22714**",
    "created_at": "2017-04-07T09:05:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337140",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22687, #22643, #22554, #22692, #22711, #22677, #22759, #22714** to **#21977, #22677, #22759, #22714**



---

archive/issue_comments_337141.json:
```json
{
    "body": "Changed dependencies from **#21977, #22677, #22759, #22714** to **#21977, #22677, #22759, #22714, #22784**",
    "created_at": "2017-04-08T20:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337141",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#21977, #22677, #22759, #22714** to **#21977, #22677, #22759, #22714, #22784**



---

archive/issue_comments_337142.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,7 +18,7 @@\n * gf2x: only builds with SAGE_FAT_BINARY on\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n-* libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed))\n+* libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed)) - see #22784\n * but gap cannot be built with CC=\"cc -fPIC -pipe\", as it\n does something weird in ./configure, setting BASECC to be cc,\n and generating broken Makefile (with -fPIC and -pipe on two\n``````\n",
    "created_at": "2017-04-08T20:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337142",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,7 +18,7 @@
 * gf2x: only builds with SAGE_FAT_BINARY on
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
-* libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed))
+* libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed)) - see #22784
 * but gap cannot be built with CC="cc -fPIC -pipe", as it
 does something weird in ./configure, setting BASECC to be cc,
 and generating broken Makefile (with -fPIC and -pipe on two
``````




---

archive/issue_comments_337143.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,18 +14,16 @@\n ## Sage itself:\n \n * hack configure.ac to make freebsd allowed platform\n-* deal with cephes' complex.h comflicting with numpy\n+* deal with cephes' complex.h conflicting with numpy\n * gf2x: only builds with SAGE_FAT_BINARY on\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC=\"cc -fPIC -pipe\" ; (-pipe is probably not really needed)) - see #22784\n-* but gap cannot be built with CC=\"cc -fPIC -pipe\", as it\n-does something weird in ./configure, setting BASECC to be cc,\n-and generating broken Makefile (with -fPIC and -pipe on two\n-separate lines); so build gap with CC=cc \n+* but gap cannot be built with CC=\"cc -fPIC -pipe\", as it does something weird in ./configure, setting BASECC to be cc, and generating broken Makefile (with -fPIC and -pipe on two separate lines); so build gap with CC=cc \n * giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h` and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n * either provide /bin/bash or fix this properly (#22689)\n * Sage builds and runs, modulo linking issues with flint and arb,\n which can be fixed ad hoc by hand.\n * deal with cephes' libm not pulling system's libm, unless some arcane linker flags are used (see comments below)\n+* old freebsd workaround for libgd removed in #22785\n * ...\n``````\n",
    "created_at": "2017-04-08T20:33:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337143",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,18 +14,16 @@
 ## Sage itself:
 
 * hack configure.ac to make freebsd allowed platform
-* deal with cephes' complex.h comflicting with numpy
+* deal with cephes' complex.h conflicting with numpy
 * gf2x: only builds with SAGE_FAT_BINARY on
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
 * libraries (libgap, cddlib, etc) need -fPIC for CFLAGS (so we build with CC="cc -fPIC -pipe" ; (-pipe is probably not really needed)) - see #22784
-* but gap cannot be built with CC="cc -fPIC -pipe", as it
-does something weird in ./configure, setting BASECC to be cc,
-and generating broken Makefile (with -fPIC and -pipe on two
-separate lines); so build gap with CC=cc 
+* but gap cannot be built with CC="cc -fPIC -pipe", as it does something weird in ./configure, setting BASECC to be cc, and generating broken Makefile (with -fPIC and -pipe on two separate lines); so build gap with CC=cc 
 * giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h` and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
 * either provide /bin/bash or fix this properly (#22689)
 * Sage builds and runs, modulo linking issues with flint and arb,
 which can be fixed ad hoc by hand.
 * deal with cephes' libm not pulling system's libm, unless some arcane linker flags are used (see comments below)
+* old freebsd workaround for libgd removed in #22785
 * ...
``````




---

archive/issue_comments_337144.json:
```json
{
    "body": "Changed dependencies from **#21977, #22677, #22759, #22714, #22784** to **#21977, #22677, #22759, #22714, #22784, #22785**",
    "created_at": "2017-04-08T20:33:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337144",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#21977, #22677, #22759, #22714, #22784** to **#21977, #22677, #22759, #22714, #22784, #22785**



---

archive/issue_comments_337145.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nReplying to [@kiwifb](#comment:49):\n> You should split the `libgd` commit to its own ticket.  It really should be fixed.\n\nthis is #22785, ready for review.",
    "created_at": "2017-04-08T20:35:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337145",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:62" align="right">comment:62</div>

Replying to [@kiwifb](#comment:49):
> You should split the `libgd` commit to its own ticket.  It really should be fixed.

this is #22785, ready for review.



---

archive/issue_comments_337146.json:
```json
{
    "body": "Changed dependencies from **#21977, #22677, #22759, #22714, #22784, #22785** to **#21977, #22677, #22759, #22714, #22784, #22785, #22786**",
    "created_at": "2017-04-08T21:07:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337146",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#21977, #22677, #22759, #22714, #22784, #22785** to **#21977, #22677, #22759, #22714, #22784, #22785, #22786**



---

archive/issue_comments_337147.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,7 +14,7 @@\n ## Sage itself:\n \n * hack configure.ac to make freebsd allowed platform\n-* deal with cephes' complex.h conflicting with numpy\n+* deal with cephes' complex.h conflicting with numpy - #22786 \n * gf2x: only builds with SAGE_FAT_BINARY on\n * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)\n * flint: remove \"-ascii -pedantic\" flags from CFLAGS in configure\n@@ -22,8 +22,7 @@\n * but gap cannot be built with CC=\"cc -fPIC -pipe\", as it does something weird in ./configure, setting BASECC to be cc, and generating broken Makefile (with -fPIC and -pipe on two separate lines); so build gap with CC=cc \n * giac needs `CFLAGS=\"-I/usr/local/include\"` to find `libintl.h` and `LDFLAGS=\"-L/usr/local/lib -lintl\"` to link.\n * either provide /bin/bash or fix this properly (#22689)\n-* Sage builds and runs, modulo linking issues with flint and arb,\n-which can be fixed ad hoc by hand.\n+* Sage builds and runs, modulo linking issues with flint and arb, which can be fixed ad hoc by hand.\n * deal with cephes' libm not pulling system's libm, unless some arcane linker flags are used (see comments below)\n * old freebsd workaround for libgd removed in #22785\n * ...\n``````\n",
    "created_at": "2017-04-08T21:07:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337147",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,7 +14,7 @@
 ## Sage itself:
 
 * hack configure.ac to make freebsd allowed platform
-* deal with cephes' complex.h conflicting with numpy
+* deal with cephes' complex.h conflicting with numpy - #22786 
 * gf2x: only builds with SAGE_FAT_BINARY on
 * upgrade sqlite to version 3.17 - otherwise there are compiling problems with editline (see #22687)
 * flint: remove "-ascii -pedantic" flags from CFLAGS in configure
@@ -22,8 +22,7 @@
 * but gap cannot be built with CC="cc -fPIC -pipe", as it does something weird in ./configure, setting BASECC to be cc, and generating broken Makefile (with -fPIC and -pipe on two separate lines); so build gap with CC=cc 
 * giac needs `CFLAGS="-I/usr/local/include"` to find `libintl.h` and `LDFLAGS="-L/usr/local/lib -lintl"` to link.
 * either provide /bin/bash or fix this properly (#22689)
-* Sage builds and runs, modulo linking issues with flint and arb,
-which can be fixed ad hoc by hand.
+* Sage builds and runs, modulo linking issues with flint and arb, which can be fixed ad hoc by hand.
 * deal with cephes' libm not pulling system's libm, unless some arcane linker flags are used (see comments below)
 * old freebsd workaround for libgd removed in #22785
 * ...
``````




---

archive/issue_comments_337148.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nsympow tests of analytic_rank fail on curves of even rank, and works for odd rank, does not matter whether sympow is built with clang 3.8 or with gcc 6.3.\n\nUsing `clang-devel`, which is `clang-4.0.0`, makes the `sympow` tests pass. This is probably due to it using `llvm-as` rather than `as`, with is horribly old (version 2.17, dates back to 2007) on FreeBSD. \n\nLooks like we're converging to the state we have on OSX w.r.t. clang (#12426).",
    "created_at": "2017-04-12T11:51:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337148",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:64" align="right">comment:64</div>

sympow tests of analytic_rank fail on curves of even rank, and works for odd rank, does not matter whether sympow is built with clang 3.8 or with gcc 6.3.

Using `clang-devel`, which is `clang-4.0.0`, makes the `sympow` tests pass. This is probably due to it using `llvm-as` rather than `as`, with is horribly old (version 2.17, dates back to 2007) on FreeBSD. 

Looks like we're converging to the state we have on OSX w.r.t. clang (#12426).



---

archive/issue_comments_337149.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@dimpase](#comment:64):\n> Using `clang-devel`, which is `clang-4.0.0`, makes the `sympow` tests pass. This is probably due to it using `llvm-as` rather than `as`, with is horribly old (version 2.17, dates back to 2007) on FreeBSD. \n\nAlternatively, using `/usr/local/bin/as` (version 2.28) instead, makes `sympow` tests pass, too.",
    "created_at": "2017-04-12T12:02:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337149",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@dimpase](#comment:64):
> Using `clang-devel`, which is `clang-4.0.0`, makes the `sympow` tests pass. This is probably due to it using `llvm-as` rather than `as`, with is horribly old (version 2.17, dates back to 2007) on FreeBSD. 

Alternatively, using `/usr/local/bin/as` (version 2.28) instead, makes `sympow` tests pass, too.



---

archive/issue_comments_337150.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,9 +6,10 @@\n ## preparing tools:\n \n * install gcc6 and create fake gfortran by making a link to gfortran6\n-* remove stale /lib/libgcc_s.so.1 and point it to the right one in /usr/local/lib/gcc6/\n+* make sure `as` is new enough: `pkg install binutils` will install `as` version 2.28, and you need it to come first in `PATH` (i.e. make sure that `/usr/local/bin` comes before `/usr/bin`).\n+* remove stale `/lib/libgcc_s.so.1` and point it to the right one in `/usr/local/lib/gcc6/` (perhaps there is a better way...)\n * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n-* make sure /bin/sh is actually bash\n+* make sure `/bin/sh` is actually bash\n * install pkgconf (FreeBSD's replacement of pkg-config)\n \n ## Sage itself:\n``````\n",
    "created_at": "2017-04-12T13:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337150",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,9 +6,10 @@
 ## preparing tools:
 
 * install gcc6 and create fake gfortran by making a link to gfortran6
-* remove stale /lib/libgcc_s.so.1 and point it to the right one in /usr/local/lib/gcc6/
+* make sure `as` is new enough: `pkg install binutils` will install `as` version 2.28, and you need it to come first in `PATH` (i.e. make sure that `/usr/local/bin` comes before `/usr/bin`).
+* remove stale `/lib/libgcc_s.so.1` and point it to the right one in `/usr/local/lib/gcc6/` (perhaps there is a better way...)
 * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
-* make sure /bin/sh is actually bash
+* make sure `/bin/sh` is actually bash
 * install pkgconf (FreeBSD's replacement of pkg-config)
 
 ## Sage itself:
``````




---

archive/issue_comments_337151.json:
```json
{
    "body": "Changed dependencies from **#21977, #22677, #22759, #22714, #22784, #22785, #22786** to **#22759,  #22786**",
    "created_at": "2017-04-12T22:54:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337151",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#21977, #22677, #22759, #22714, #22784, #22785, #22786** to **#22759,  #22786**



---

archive/issue_comments_337152.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nccache, gfan,lcalc,tachyon need to have their LDFLAGS sorted due to `libm` linking, \nas  our special LDFLAGS must come first in the linking list of parameters.\nWorked around for the time being by adding LDFLAGS to CC and CXX, i.e.\n\n```\n$ CXX=\"$CXX $LDFLAGS\" CC=\"$CC $LDFLAGS\" make \n```\n\nhowever, it seems that passing unrecognised options to the compiler has strange side effects on `sympow` - it creates an executable that fails tests it fails if built with old `as` (sic!).",
    "created_at": "2017-04-13T08:45:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337152",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:68" align="right">comment:68</div>

ccache, gfan,lcalc,tachyon need to have their LDFLAGS sorted due to `libm` linking, 
as  our special LDFLAGS must come first in the linking list of parameters.
Worked around for the time being by adding LDFLAGS to CC and CXX, i.e.

```
$ CXX="$CXX $LDFLAGS" CC="$CC $LDFLAGS" make 
```

however, it seems that passing unrecognised options to the compiler has strange side effects on `sympow` - it creates an executable that fails tests it fails if built with old `as` (sic!).



---

archive/issue_comments_337153.json:
```json
{
    "body": "Changed commit from **[`27e7ae2`](https://github.com/sagemath/sagetrac-mirror/commit/27e7ae2281fbac817e895e1ed9dcb76ad938ddab)** to **[`73f9f7c`](https://github.com/sagemath/sagetrac-mirror/commit/73f9f7c30a016963175f0d7959e2bc938ff0cd48)**",
    "created_at": "2017-04-13T10:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337153",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`27e7ae2`](https://github.com/sagemath/sagetrac-mirror/commit/27e7ae2281fbac817e895e1ed9dcb76ad938ddab)** to **[`73f9f7c`](https://github.com/sagemath/sagetrac-mirror/commit/73f9f7c30a016963175f0d7959e2bc938ff0cd48)**



---

archive/issue_comments_337154.json:
```json
{
    "body": "<div id=\"comment:69\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7259995ed6678aa60ed422b478f16b890011daf4\"><code>7259995</code></a></td><td><code>Merge branch 'develop' of trac.sagemath.org:sage into develop</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6fb7b01eae5c9675f17f9a348df89075f22ed1b\"><code>e6fb7b0</code></a></td><td><code>Merge branch 'u/dimpase/freebsd_experimental' of trac.sagemath.org:sage into beta2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2624dcff12f84ea48d7bd30c9c12b4ec20c7dbf\"><code>d2624dc</code></a></td><td><code>workaround to skip cephes' complex.h, bump up version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7bac75f450b243da3323337be6625885717aa3c\"><code>a7bac75</code></a></td><td><code>Merge branch 'u/jdemeyer/clean_up_numpy_s_spkg_install' of trac.sagemath.org:sage into numpy_freebsd_workaround</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbdc7165a0f812041fa2c25a38becc9ce5f8ddbc\"><code>dbdc716</code></a></td><td><code>moved -D from CC to CFLAGS</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ab0707e6af44cfd3d4d65708be97bf403d57d4d\"><code>0ab0707</code></a></td><td><code>Merge branch 'u/dimpase/numpy_freebsd_workaround' of trac.sagemath.org:sage into beta2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e53c19919bd1744d0d6c98547be6e07f9d9b9408\"><code>e53c199</code></a></td><td><code>Merge branch 'u/jdemeyer/factorize_result_of_algdep__' of trac.sagemath.org:sage into dcfix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd96c0aaf7e0aa999a95b6bfe1baff54e23234cd\"><code>fd96c0a</code></a></td><td><code>fix for #22759</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8fd9de65ef431cef7622ab256137f733280d1977\"><code>8fd9de6</code></a></td><td><code>Merge branch 'u/dimpase/t22759' of trac.sagemath.org:sage into beta2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/73f9f7c30a016963175f0d7959e2bc938ff0cd48\"><code>73f9f7c</code></a></td><td><code>delete obsolete patch</code></td></tr></table>\n",
    "created_at": "2017-04-13T10:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337154",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:69"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7259995ed6678aa60ed422b478f16b890011daf4"><code>7259995</code></a></td><td><code>Merge branch 'develop' of trac.sagemath.org:sage into develop</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6fb7b01eae5c9675f17f9a348df89075f22ed1b"><code>e6fb7b0</code></a></td><td><code>Merge branch 'u/dimpase/freebsd_experimental' of trac.sagemath.org:sage into beta2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2624dcff12f84ea48d7bd30c9c12b4ec20c7dbf"><code>d2624dc</code></a></td><td><code>workaround to skip cephes' complex.h, bump up version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7bac75f450b243da3323337be6625885717aa3c"><code>a7bac75</code></a></td><td><code>Merge branch 'u/jdemeyer/clean_up_numpy_s_spkg_install' of trac.sagemath.org:sage into numpy_freebsd_workaround</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbdc7165a0f812041fa2c25a38becc9ce5f8ddbc"><code>dbdc716</code></a></td><td><code>moved -D from CC to CFLAGS</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ab0707e6af44cfd3d4d65708be97bf403d57d4d"><code>0ab0707</code></a></td><td><code>Merge branch 'u/dimpase/numpy_freebsd_workaround' of trac.sagemath.org:sage into beta2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e53c19919bd1744d0d6c98547be6e07f9d9b9408"><code>e53c199</code></a></td><td><code>Merge branch 'u/jdemeyer/factorize_result_of_algdep__' of trac.sagemath.org:sage into dcfix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd96c0aaf7e0aa999a95b6bfe1baff54e23234cd"><code>fd96c0a</code></a></td><td><code>fix for #22759</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8fd9de65ef431cef7622ab256137f733280d1977"><code>8fd9de6</code></a></td><td><code>Merge branch 'u/dimpase/t22759' of trac.sagemath.org:sage into beta2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/73f9f7c30a016963175f0d7959e2bc938ff0cd48"><code>73f9f7c</code></a></td><td><code>delete obsolete patch</code></td></tr></table>




---

archive/issue_comments_337155.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\n#22812 and #22840 deal with misplaced LDFLAGS.",
    "created_at": "2017-04-20T15:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337155",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:70" align="right">comment:70</div>

#22812 and #22840 deal with misplaced LDFLAGS.



---

archive/issue_comments_337156.json:
```json
{
    "body": "Changed dependencies from **#22759,  #22786** to **#22759,  #22786, #22812, #22840**",
    "created_at": "2017-04-20T15:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337156",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22759,  #22786** to **#22759,  #22786, #22812, #22840**



---

archive/issue_comments_337157.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nApart from #22799, which is responsible for majority of failing doctests, the only other real worry is the double unpickling crash\nafter the line ` sage.structure.sage_object.unpickle_all() ## line 1563 ##`\nin `src/sage/structure/sage_object.pyx`.",
    "created_at": "2017-04-21T14:38:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337157",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:71" align="right">comment:71</div>

Apart from #22799, which is responsible for majority of failing doctests, the only other real worry is the double unpickling crash
after the line ` sage.structure.sage_object.unpickle_all() ## line 1563 ##`
in `src/sage/structure/sage_object.pyx`.



---

archive/issue_comments_337158.json:
```json
{
    "body": "Changed dependencies from **#22759,  #22786, #22812, #22840** to **#22895**",
    "created_at": "2017-04-28T14:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337158",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22759,  #22786, #22812, #22840** to **#22895**



---

archive/issue_comments_337159.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nTODO: gf2x needs CPP and CXXCPP to be set to `\"clang-devel -E\"` if we like to run its tuning.\n\n(and probably a fresh autoreconf run)",
    "created_at": "2017-04-28T15:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337159",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:73" align="right">comment:73</div>

TODO: gf2x needs CPP and CXXCPP to be set to `"clang-devel -E"` if we like to run its tuning.

(and probably a fresh autoreconf run)



---

archive/issue_comments_337160.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\n`clang-devel`? is this a freeBSDism? No such thing on OS X. `AC_PROG_CPP` would usually test `$CC -E` (or `$CXX -E` depending on the language selected).",
    "created_at": "2017-04-28T20:02:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337160",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:74" align="right">comment:74</div>

`clang-devel`? is this a freeBSDism? No such thing on OS X. `AC_PROG_CPP` would usually test `$CC -E` (or `$CXX -E` depending on the language selected).



---

archive/issue_comments_337161.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nclang-devel == clang 4.0.0 on FreeBSD 11.0.",
    "created_at": "2017-04-28T20:29:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337161",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:75" align="right">comment:75</div>

clang-devel == clang 4.0.0 on FreeBSD 11.0.



---

archive/issue_comments_337162.json:
```json
{
    "body": "Changed dependencies from **#22895** to **#22582**",
    "created_at": "2017-04-30T10:26:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337162",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22895** to **#22582**



---

archive/issue_comments_337163.json:
```json
{
    "body": "Changed dependencies from **#22582** to **#12426**",
    "created_at": "2017-06-26T09:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337163",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22582** to **#12426**



---

archive/issue_comments_337164.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,25 @@\n * make sure `/bin/sh` is actually bash\n * install pkgconf (FreeBSD's replacement of pkg-config)\n \n-## Sage itself:\n+## building Sage itself\n+\n+starting from a clean git repo:\n+\n+* export CFLAGS=\"-fPIC\"\n+* export CXXFLAGS=\"-fPIC\"\n+* export LDFLAGS=\"-L/usr/local/lib -Wl,--add-needed -lm\"\n+* ./configure CC=clang-devel CXX=clang++-devel  (using -devel, as old clang seems to have problems in assembler on FreeBSD)\n+* MAKE=\"make -j7\" make (this will fail with a linking error in docbuild)\n+* cd local/lib\n+* ln -sf libflint.so.13.5.2 libflint.so.13\n+* ln -sf libarb.so.1.1.1 libarb.so.1\n+* cd ../..\n+* MAKE=\"make -j1\" make (with -jx with x>1 I get crashes in building plot3d docs)\n+ \n+\n+\n+\n+## HISTORICAL: Sage itself:\n \n * hack configure.ac to make freebsd allowed platform\n * deal with cephes' complex.h conflicting with numpy - #22786 \n``````\n",
    "created_at": "2017-06-26T09:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337164",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,25 @@
 * make sure `/bin/sh` is actually bash
 * install pkgconf (FreeBSD's replacement of pkg-config)
 
-## Sage itself:
+## building Sage itself
+
+starting from a clean git repo:
+
+* export CFLAGS="-fPIC"
+* export CXXFLAGS="-fPIC"
+* export LDFLAGS="-L/usr/local/lib -Wl,--add-needed -lm"
+* ./configure CC=clang-devel CXX=clang++-devel  (using -devel, as old clang seems to have problems in assembler on FreeBSD)
+* MAKE="make -j7" make (this will fail with a linking error in docbuild)
+* cd local/lib
+* ln -sf libflint.so.13.5.2 libflint.so.13
+* ln -sf libarb.so.1.1.1 libarb.so.1
+* cd ../..
+* MAKE="make -j1" make (with -jx with x>1 I get crashes in building plot3d docs)
+ 
+
+
+
+## HISTORICAL: Sage itself:
 
 * hack configure.ac to make freebsd allowed platform
 * deal with cephes' complex.h conflicting with numpy - #22786 
``````




---

archive/issue_comments_337165.json:
```json
{
    "body": "Changed commit from **[`73f9f7c`](https://github.com/sagemath/sagetrac-mirror/commit/73f9f7c30a016963175f0d7959e2bc938ff0cd48)** to **[`3debd11`](https://github.com/sagemath/sagetrac-mirror/commit/3debd116304b0c3c16624d57950418670e1c7ffd)**",
    "created_at": "2017-06-26T09:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337165",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`73f9f7c`](https://github.com/sagemath/sagetrac-mirror/commit/73f9f7c30a016963175f0d7959e2bc938ff0cd48)** to **[`3debd11`](https://github.com/sagemath/sagetrac-mirror/commit/3debd116304b0c3c16624d57950418670e1c7ffd)**



---

archive/issue_comments_337166.json:
```json
{
    "body": "Changed branch from **[u/dimpase/freebsd_experimental](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/freebsd_experimental)** to **[u/dimpase/fbsd](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/fbsd)**",
    "created_at": "2017-06-26T09:35:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337166",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/dimpase/freebsd_experimental](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/freebsd_experimental)** to **[u/dimpase/fbsd](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/fbsd)**



---

archive/issue_comments_337167.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\n`ptest` now gives\n\n```\nsage -t --warn-long 54.2 src/sage/structure/sage_object.pyx  # Killed due to abort\nsage -t --warn-long 54.2 src/sage/interfaces/tests.py  # 1 doctest failed\nsage -t --warn-long 54.2 src/sage/tests/cmdline.py  # 1 doctest failed\nsage -t --warn-long 54.2 src/sage/homology/simplicial_complex.py  # 1 doctest failed\nsage -t --warn-long 54.2 src/sage/interfaces/singular.py  # 2 doctests failed\nsage -t --warn-long 54.2 src/sage/libs/lcalc/lcalc_Lfunction.pyx  # 1 doctest failed\nsage -t --warn-long 54.2 src/doc/en/developer/coding_in_other.rst  # 1 doctest failed\nsage -t --warn-long 54.2 src/doc/en/constructions/algebraic_geometry.rst  # 1 doctest failed\nsage -t --warn-long 54.2 src/sage/numerical/sdp.pyx  # 1 doctest failed\n```\nall of this was seen before --- numerical noise or a different order of output, random weird failures, or crash at 2nd unpickle.all.",
    "created_at": "2017-06-26T10:59:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337167",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:78" align="right">comment:78</div>

`ptest` now gives

```
sage -t --warn-long 54.2 src/sage/structure/sage_object.pyx  # Killed due to abort
sage -t --warn-long 54.2 src/sage/interfaces/tests.py  # 1 doctest failed
sage -t --warn-long 54.2 src/sage/tests/cmdline.py  # 1 doctest failed
sage -t --warn-long 54.2 src/sage/homology/simplicial_complex.py  # 1 doctest failed
sage -t --warn-long 54.2 src/sage/interfaces/singular.py  # 2 doctests failed
sage -t --warn-long 54.2 src/sage/libs/lcalc/lcalc_Lfunction.pyx  # 1 doctest failed
sage -t --warn-long 54.2 src/doc/en/developer/coding_in_other.rst  # 1 doctest failed
sage -t --warn-long 54.2 src/doc/en/constructions/algebraic_geometry.rst  # 1 doctest failed
sage -t --warn-long 54.2 src/sage/numerical/sdp.pyx  # 1 doctest failed
```
all of this was seen before --- numerical noise or a different order of output, random weird failures, or crash at 2nd unpickle.all.



---

archive/issue_comments_337168.json:
```json
{
    "body": "Changed commit from **[`3debd11`](https://github.com/sagemath/sagetrac-mirror/commit/3debd116304b0c3c16624d57950418670e1c7ffd)** to **[`96e6482`](https://github.com/sagemath/sagetrac-mirror/commit/96e6482a9ff5cd637fad6f4c89414f2066115dfb)**",
    "created_at": "2017-06-26T14:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337168",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3debd11`](https://github.com/sagemath/sagetrac-mirror/commit/3debd116304b0c3c16624d57950418670e1c7ffd)** to **[`96e6482`](https://github.com/sagemath/sagetrac-mirror/commit/96e6482a9ff5cd637fad6f4c89414f2066115dfb)**



---

archive/issue_comments_337169.json:
```json
{
    "body": "<div id=\"comment:79\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/96e6482a9ff5cd637fad6f4c89414f2066115dfb\"><code>96e6482</code></a></td><td><code>fix linking of libflint and libarb on FreeBSD</code></td></tr></table>\n",
    "created_at": "2017-06-26T14:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337169",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:79"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/96e6482a9ff5cd637fad6f4c89414f2066115dfb"><code>96e6482</code></a></td><td><code>fix linking of libflint and libarb on FreeBSD</code></td></tr></table>




---

archive/issue_comments_337170.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -19,12 +19,8 @@\n * export CFLAGS=\"-fPIC\"\n * export CXXFLAGS=\"-fPIC\"\n * export LDFLAGS=\"-L/usr/local/lib -Wl,--add-needed -lm\"\n-* ./configure CC=clang-devel CXX=clang++-devel  (using -devel, as old clang seems to have problems in assembler on FreeBSD)\n-* MAKE=\"make -j7\" make (this will fail with a linking error in docbuild)\n-* cd local/lib\n-* ln -sf libflint.so.13.5.2 libflint.so.13\n-* ln -sf libarb.so.1.1.1 libarb.so.1\n-* cd ../..\n+* ./configure CC=cc CXX=c++  (this is clang 3.8.0 a.t.m.)\n+* MAKE=\"make -j7\" make build\n * MAKE=\"make -j1\" make (with -jx with x>1 I get crashes in building plot3d docs)\n  \n \n``````\n",
    "created_at": "2017-06-26T14:55:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337170",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -19,12 +19,8 @@
 * export CFLAGS="-fPIC"
 * export CXXFLAGS="-fPIC"
 * export LDFLAGS="-L/usr/local/lib -Wl,--add-needed -lm"
-* ./configure CC=clang-devel CXX=clang++-devel  (using -devel, as old clang seems to have problems in assembler on FreeBSD)
-* MAKE="make -j7" make (this will fail with a linking error in docbuild)
-* cd local/lib
-* ln -sf libflint.so.13.5.2 libflint.so.13
-* ln -sf libarb.so.1.1.1 libarb.so.1
-* cd ../..
+* ./configure CC=cc CXX=c++  (this is clang 3.8.0 a.t.m.)
+* MAKE="make -j7" make build
 * MAKE="make -j1" make (with -jx with x>1 I get crashes in building plot3d docs)
  
 
``````




---

archive/issue_comments_337171.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nwow, now `ptest` gives just this:\n\n```\nsage -t --warn-long 50.1 src/sage/interfaces/tests.py  # 1 doctest failed\nsage -t --warn-long 50.1 src/sage/tests/cmdline.py  # 1 doctest failed\nsage -t --warn-long 50.1 src/sage/homology/simplicial_complex.py  # 1 doctest failed\nsage -t --warn-long 50.1 src/sage/geometry/cone.py  # Timed out\nsage -t --warn-long 50.1 src/sage/numerical/sdp.pyx  # 1 doctest failed\n```\n(with the timed out test running fine if repeated separately)\n\nApparently it's due to flint and arb properly set up at the right moment, and not at some later moment, and/or more stable clang version.",
    "created_at": "2017-06-26T16:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337171",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:81" align="right">comment:81</div>

wow, now `ptest` gives just this:

```
sage -t --warn-long 50.1 src/sage/interfaces/tests.py  # 1 doctest failed
sage -t --warn-long 50.1 src/sage/tests/cmdline.py  # 1 doctest failed
sage -t --warn-long 50.1 src/sage/homology/simplicial_complex.py  # 1 doctest failed
sage -t --warn-long 50.1 src/sage/geometry/cone.py  # Timed out
sage -t --warn-long 50.1 src/sage/numerical/sdp.pyx  # 1 doctest failed
```
(with the timed out test running fine if repeated separately)

Apparently it's due to flint and arb properly set up at the right moment, and not at some later moment, and/or more stable clang version.



---

archive/issue_comments_337172.json:
```json
{
    "body": "Changed commit from **[`96e6482`](https://github.com/sagemath/sagetrac-mirror/commit/96e6482a9ff5cd637fad6f4c89414f2066115dfb)** to **[`057e47e`](https://github.com/sagemath/sagetrac-mirror/commit/057e47e5a4749597175521b9539f9b5fcad4d984)**",
    "created_at": "2017-07-03T17:05:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337172",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`96e6482`](https://github.com/sagemath/sagetrac-mirror/commit/96e6482a9ff5cd637fad6f4c89414f2066115dfb)** to **[`057e47e`](https://github.com/sagemath/sagetrac-mirror/commit/057e47e5a4749597175521b9539f9b5fcad4d984)**



---

archive/issue_comments_337173.json:
```json
{
    "body": "<div id=\"comment:82\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/057e47e5a4749597175521b9539f9b5fcad4d984\"><code>057e47e</code></a></td><td><code>merge of rc0</code></td></tr></table>\n",
    "created_at": "2017-07-03T17:05:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337173",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:82"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/057e47e5a4749597175521b9539f9b5fcad4d984"><code>057e47e</code></a></td><td><code>merge of rc0</code></td></tr></table>




---

archive/issue_events_318198.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-07-03T17:06:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318198"
}
```



---

archive/issue_events_318199.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-07-03T17:06:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318199"
}
```



---

archive/issue_comments_337174.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nNew branch is `u/dimpase/fbsd-support`, keeping the old one for browsing purposes a.t.m.",
    "created_at": "2017-08-04T10:14:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337174",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:84" align="right">comment:84</div>

New branch is `u/dimpase/fbsd-support`, keeping the old one for browsing purposes a.t.m.



---

archive/issue_comments_337175.json:
```json
{
    "body": "Changed dependencies from **#12426** to **#12426, #23565**",
    "created_at": "2017-08-04T10:14:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337175",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#12426** to **#12426, #23565**



---

archive/issue_comments_337176.json:
```json
{
    "body": "Changed commit from **[`057e47e`](https://github.com/sagemath/sagetrac-mirror/commit/057e47e5a4749597175521b9539f9b5fcad4d984)** to **[`94e52ea`](https://github.com/sagemath/sagetrac-mirror/commit/94e52eaa09b4a4a3ea4759630ae08151c18e4c64)**",
    "created_at": "2017-08-30T09:33:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337176",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`057e47e`](https://github.com/sagemath/sagetrac-mirror/commit/057e47e5a4749597175521b9539f9b5fcad4d984)** to **[`94e52ea`](https://github.com/sagemath/sagetrac-mirror/commit/94e52eaa09b4a4a3ea4759630ae08151c18e4c64)**



---

archive/issue_comments_337177.json:
```json
{
    "body": "Changed branch from **[u/dimpase/fbsd](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/fbsd)** to **[u/dimpase/fbsd-support](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/fbsd-support)**",
    "created_at": "2017-08-30T09:33:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337177",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/dimpase/fbsd](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/fbsd)** to **[u/dimpase/fbsd-support](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/fbsd-support)**



---

archive/issue_comments_337178.json:
```json
{
    "body": "<div id=\"comment:86\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c8c3e39a6df40b63ce038a041bcaf414fb357f9\"><code>7c8c3e3</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/277ddd77e391269febfa10a66c62f34f475b4181\"><code>277ddd7</code></a></td><td><code>libatomic_ops is a dependency</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d5bbd03ee8762042cde99740e821169c3d3a579\"><code>4d5bbd0</code></a></td><td><code>libatomic_ops 7.4.6 added as standard pkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e53f78480379ce726091927c870c0869cb115b40\"><code>e53f784</code></a></td><td><code>Merge branch 'u/dimpase/libatomic_ops' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4929b58b3fa08933078ed25794f2af430292dcc8\"><code>4929b58</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8166e2103f9a9c92cf72fd90ccc192352b859fb4\"><code>8166e21</code></a></td><td><code>libatomic_ops 7.6.4 added as standard pkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64da17f2ff0ab29ec2d2d2a80b1c49ee4f054b21\"><code>64da17f</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82eabaec2123ef6246f2a854a469c7ca3d6d7368\"><code>82eabae</code></a></td><td><code>patch for FreeBSD</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/931652aecee2bd1d775ccbd8fcc18aa5d1afb0ee\"><code>931652a</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c\"><code>d04c9f7</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>\n",
    "created_at": "2017-08-30T15:41:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337178",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:86"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c8c3e39a6df40b63ce038a041bcaf414fb357f9"><code>7c8c3e3</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/277ddd77e391269febfa10a66c62f34f475b4181"><code>277ddd7</code></a></td><td><code>libatomic_ops is a dependency</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d5bbd03ee8762042cde99740e821169c3d3a579"><code>4d5bbd0</code></a></td><td><code>libatomic_ops 7.4.6 added as standard pkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e53f78480379ce726091927c870c0869cb115b40"><code>e53f784</code></a></td><td><code>Merge branch 'u/dimpase/libatomic_ops' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4929b58b3fa08933078ed25794f2af430292dcc8"><code>4929b58</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8166e2103f9a9c92cf72fd90ccc192352b859fb4"><code>8166e21</code></a></td><td><code>libatomic_ops 7.6.4 added as standard pkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64da17f2ff0ab29ec2d2d2a80b1c49ee4f054b21"><code>64da17f</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82eabaec2123ef6246f2a854a469c7ca3d6d7368"><code>82eabae</code></a></td><td><code>patch for FreeBSD</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/931652aecee2bd1d775ccbd8fcc18aa5d1afb0ee"><code>931652a</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c"><code>d04c9f7</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>




---

archive/issue_comments_337179.json:
```json
{
    "body": "Changed commit from **[`94e52ea`](https://github.com/sagemath/sagetrac-mirror/commit/94e52eaa09b4a4a3ea4759630ae08151c18e4c64)** to **[`d04c9f7`](https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c)**",
    "created_at": "2017-08-30T15:41:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337179",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`94e52ea`](https://github.com/sagemath/sagetrac-mirror/commit/94e52eaa09b4a4a3ea4759630ae08151c18e4c64)** to **[`d04c9f7`](https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c)**



---

archive/issue_comments_337180.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nnow `MAKE=\"make -j1 make ptest` has just 3 failures:\n\n```\nsage -t --warn-long 79.3 src/sage/interfaces/tests.py  # 1 doctest failed\nsage -t --warn-long 79.3 src/sage/numerical/sdp.pyx  # 1 doctest failed\nsage -t --warn-long 79.3 src/sage/tests/cmdline.py  # 1 doctest failed\n```\nof which the 1st is something to look at:\n\n```\nFile \"src/sage/interfaces/tests.py\", line 36, in sage.interfaces.tests\nFailed example:\n    subprocess.call(\"echo syntax error | gap\", **kwds)\nExpected:\n    0\nGot:\n    136\n```\n2nd is just numerical noise, the 3rd is\n\n```\nFile \"src/sage/tests/cmdline.py\", line 534, in sage.tests.cmdline.test_executable\nFailed example:\n    out\nExpected:\n    '120\\n'\nGot:\n    '#E  Could not create interval timer. Timeouts will not be supported\\n120\\n'\n```\n\nA bigger problem is with `-jX` for `X>1`; it's not really possible to build docs, one gets weird segfaults related to ECL/Maxima. It's very likely that they are of the same nature as the following weirdness (they look very similar): start Sage, type\n\n```\nsage: from sage.interfaces.maxima_lib import \n```\nand hit Tab. This segfaults with\n\n```\nInternal or unrecoverable error in:                               \nGot signal before environment was installed on our thread         \n  [2: No such file or directory]                                  \n\n;;; ECL C Backtrace\n;;;    0 ecl_internal_error (0x87d790765) \n;;;    1 init_unixint (0x87d7b6bd0) \n;;;    2 init_unixint (0x87d7b6972) \n;;;    3 pthread_sigmask (0x80103779d) \n;;;    4 pthread_getspecific (0x801036d6f) \n;;;    5 unknown (0x7ffffffff193) \n;;;    6 GC_push_all_stacks (0x87db1ea2c) \n;;;    7 GC_mark_some (0x87db12eec) \n;;;    8 GC_stopped_mark (0x87db09baa) \n;;;    9 GC_try_to_collect_inner (0x87db09a75) \n;;;   10 GC_init (0x87db16f4f) \n;;;   11 init_alloc (0x87d7caa59) \n;;;   12 cl_boot (0x87d694a5b) \n;;;   13 initecl (0x87d218340) \n;;;   14 initecl (0x87d20a43f) \n;;;   15 initecl (0x87d207e28) \n;;;   16 _PyImport_LoadDynamicModule (0x800b3ed1c) \n;;;   17 PyImport_AppendInittab (0x800b3d71f) \n;;;   18 PyImport_AppendInittab (0x800b3d1a8) \n;;;   19 PyImport_ImportModuleLevel (0x800b3c2ce) \n;;;   20 _PyBuiltin_Init (0x800b162d7) \n;;;   21 PyObject_Call (0x800a7d3e3) \n;;;   22 PyEval_EvalFrameEx (0x800b2121c) \n;;;   23 PyEval_EvalCodeEx (0x800b1b5d4) \n;;;   24 PyEval_EvalCode (0x800b1ad96) \n;;;   25 PyImport_ExecCodeModuleEx (0x800b3ad11) \n;;;   26 PyImport_AppendInittab (0x800b3ddb8) \n;;;   27 PyImport_AppendInittab (0x800b3d71f) \n;;;   28 PyImport_AppendInittab (0x800b3d1a8) \n;;;   29 PyImport_ImportModuleLevel (0x800b3c2ce) \n;;;   30 _PyBuiltin_Init (0x800b162d7) \n;;;   31 PyEval_EvalFrameEx (0x800b22dd1) \nSegmentation fault (core dumped)\n```\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c8c3e39a6df40b63ce038a041bcaf414fb357f9\"><code>7c8c3e3</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/277ddd77e391269febfa10a66c62f34f475b4181\"><code>277ddd7</code></a></td><td><code>libatomic_ops is a dependency</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d5bbd03ee8762042cde99740e821169c3d3a579\"><code>4d5bbd0</code></a></td><td><code>libatomic_ops 7.4.6 added as standard pkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e53f78480379ce726091927c870c0869cb115b40\"><code>e53f784</code></a></td><td><code>Merge branch 'u/dimpase/libatomic_ops' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4929b58b3fa08933078ed25794f2af430292dcc8\"><code>4929b58</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8166e2103f9a9c92cf72fd90ccc192352b859fb4\"><code>8166e21</code></a></td><td><code>libatomic_ops 7.6.4 added as standard pkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64da17f2ff0ab29ec2d2d2a80b1c49ee4f054b21\"><code>64da17f</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82eabaec2123ef6246f2a854a469c7ca3d6d7368\"><code>82eabae</code></a></td><td><code>patch for FreeBSD</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/931652aecee2bd1d775ccbd8fcc18aa5d1afb0ee\"><code>931652a</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c\"><code>d04c9f7</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>\n",
    "created_at": "2017-08-30T15:51:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337180",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:87" align="right">comment:87</div>

now `MAKE="make -j1 make ptest` has just 3 failures:

```
sage -t --warn-long 79.3 src/sage/interfaces/tests.py  # 1 doctest failed
sage -t --warn-long 79.3 src/sage/numerical/sdp.pyx  # 1 doctest failed
sage -t --warn-long 79.3 src/sage/tests/cmdline.py  # 1 doctest failed
```
of which the 1st is something to look at:

```
File "src/sage/interfaces/tests.py", line 36, in sage.interfaces.tests
Failed example:
    subprocess.call("echo syntax error | gap", **kwds)
Expected:
    0
Got:
    136
```
2nd is just numerical noise, the 3rd is

```
File "src/sage/tests/cmdline.py", line 534, in sage.tests.cmdline.test_executable
Failed example:
    out
Expected:
    '120\n'
Got:
    '#E  Could not create interval timer. Timeouts will not be supported\n120\n'
```

A bigger problem is with `-jX` for `X>1`; it's not really possible to build docs, one gets weird segfaults related to ECL/Maxima. It's very likely that they are of the same nature as the following weirdness (they look very similar): start Sage, type

```
sage: from sage.interfaces.maxima_lib import 
```
and hit Tab. This segfaults with

```
Internal or unrecoverable error in:                               
Got signal before environment was installed on our thread         
  [2: No such file or directory]                                  

;;; ECL C Backtrace
;;;    0 ecl_internal_error (0x87d790765) 
;;;    1 init_unixint (0x87d7b6bd0) 
;;;    2 init_unixint (0x87d7b6972) 
;;;    3 pthread_sigmask (0x80103779d) 
;;;    4 pthread_getspecific (0x801036d6f) 
;;;    5 unknown (0x7ffffffff193) 
;;;    6 GC_push_all_stacks (0x87db1ea2c) 
;;;    7 GC_mark_some (0x87db12eec) 
;;;    8 GC_stopped_mark (0x87db09baa) 
;;;    9 GC_try_to_collect_inner (0x87db09a75) 
;;;   10 GC_init (0x87db16f4f) 
;;;   11 init_alloc (0x87d7caa59) 
;;;   12 cl_boot (0x87d694a5b) 
;;;   13 initecl (0x87d218340) 
;;;   14 initecl (0x87d20a43f) 
;;;   15 initecl (0x87d207e28) 
;;;   16 _PyImport_LoadDynamicModule (0x800b3ed1c) 
;;;   17 PyImport_AppendInittab (0x800b3d71f) 
;;;   18 PyImport_AppendInittab (0x800b3d1a8) 
;;;   19 PyImport_ImportModuleLevel (0x800b3c2ce) 
;;;   20 _PyBuiltin_Init (0x800b162d7) 
;;;   21 PyObject_Call (0x800a7d3e3) 
;;;   22 PyEval_EvalFrameEx (0x800b2121c) 
;;;   23 PyEval_EvalCodeEx (0x800b1b5d4) 
;;;   24 PyEval_EvalCode (0x800b1ad96) 
;;;   25 PyImport_ExecCodeModuleEx (0x800b3ad11) 
;;;   26 PyImport_AppendInittab (0x800b3ddb8) 
;;;   27 PyImport_AppendInittab (0x800b3d71f) 
;;;   28 PyImport_AppendInittab (0x800b3d1a8) 
;;;   29 PyImport_ImportModuleLevel (0x800b3c2ce) 
;;;   30 _PyBuiltin_Init (0x800b162d7) 
;;;   31 PyEval_EvalFrameEx (0x800b22dd1) 
Segmentation fault (core dumped)
```

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c8c3e39a6df40b63ce038a041bcaf414fb357f9"><code>7c8c3e3</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/277ddd77e391269febfa10a66c62f34f475b4181"><code>277ddd7</code></a></td><td><code>libatomic_ops is a dependency</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d5bbd03ee8762042cde99740e821169c3d3a579"><code>4d5bbd0</code></a></td><td><code>libatomic_ops 7.4.6 added as standard pkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e53f78480379ce726091927c870c0869cb115b40"><code>e53f784</code></a></td><td><code>Merge branch 'u/dimpase/libatomic_ops' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4929b58b3fa08933078ed25794f2af430292dcc8"><code>4929b58</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8166e2103f9a9c92cf72fd90ccc192352b859fb4"><code>8166e21</code></a></td><td><code>libatomic_ops 7.6.4 added as standard pkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64da17f2ff0ab29ec2d2d2a80b1c49ee4f054b21"><code>64da17f</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82eabaec2123ef6246f2a854a469c7ca3d6d7368"><code>82eabae</code></a></td><td><code>patch for FreeBSD</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/931652aecee2bd1d775ccbd8fcc18aa5d1afb0ee"><code>931652a</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c"><code>d04c9f7</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>




---

archive/issue_comments_337181.json:
```json
{
    "body": "Changed dependencies from **#12426, #23565** to **#12426, #23565, #23700**",
    "created_at": "2017-08-30T15:51:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337181",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#12426, #23565** to **#12426, #23565, #23700**



---

archive/issue_comments_337182.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c8c3e39a6df40b63ce038a041bcaf414fb357f9\"><code>7c8c3e3</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/277ddd77e391269febfa10a66c62f34f475b4181\"><code>277ddd7</code></a></td><td><code>libatomic_ops is a dependency</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4d5bbd03ee8762042cde99740e821169c3d3a579\"><code>4d5bbd0</code></a></td><td><code>libatomic_ops 7.4.6 added as standard pkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e53f78480379ce726091927c870c0869cb115b40\"><code>e53f784</code></a></td><td><code>Merge branch 'u/dimpase/libatomic_ops' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4929b58b3fa08933078ed25794f2af430292dcc8\"><code>4929b58</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8166e2103f9a9c92cf72fd90ccc192352b859fb4\"><code>8166e21</code></a></td><td><code>libatomic_ops 7.6.4 added as standard pkg</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64da17f2ff0ab29ec2d2d2a80b1c49ee4f054b21\"><code>64da17f</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82eabaec2123ef6246f2a854a469c7ca3d6d7368\"><code>82eabae</code></a></td><td><code>patch for FreeBSD</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/931652aecee2bd1d775ccbd8fcc18aa5d1afb0ee\"><code>931652a</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c\"><code>d04c9f7</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>\n",
    "created_at": "2017-08-31T08:00:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337182",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:88" align="right">comment:88</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c8c3e39a6df40b63ce038a041bcaf414fb357f9"><code>7c8c3e3</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/277ddd77e391269febfa10a66c62f34f475b4181"><code>277ddd7</code></a></td><td><code>libatomic_ops is a dependency</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4d5bbd03ee8762042cde99740e821169c3d3a579"><code>4d5bbd0</code></a></td><td><code>libatomic_ops 7.4.6 added as standard pkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e53f78480379ce726091927c870c0869cb115b40"><code>e53f784</code></a></td><td><code>Merge branch 'u/dimpase/libatomic_ops' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4929b58b3fa08933078ed25794f2af430292dcc8"><code>4929b58</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8166e2103f9a9c92cf72fd90ccc192352b859fb4"><code>8166e21</code></a></td><td><code>libatomic_ops 7.6.4 added as standard pkg</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64da17f2ff0ab29ec2d2d2a80b1c49ee4f054b21"><code>64da17f</code></a></td><td><code>Merge branch 'libatomic_ops' into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82eabaec2123ef6246f2a854a469c7ca3d6d7368"><code>82eabae</code></a></td><td><code>patch for FreeBSD</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/931652aecee2bd1d775ccbd8fcc18aa5d1afb0ee"><code>931652a</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into gcupdate</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c"><code>d04c9f7</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>




---

archive/issue_comments_337183.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,4 @@\n FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. \n-\n-Few details I figured out.\n \n \n ## preparing tools:\n@@ -11,6 +9,7 @@\n * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n * make sure `/bin/sh` is actually bash\n * install pkgconf (FreeBSD's replacement of pkg-config)\n+* install wget (needed for AtlasRep GAP package).\n \n ## building Sage itself\n \n``````\n",
    "created_at": "2017-08-31T08:00:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337183",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,4 @@
 FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. 
-
-Few details I figured out.
 
 
 ## preparing tools:
@@ -11,6 +9,7 @@
 * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
 * make sure `/bin/sh` is actually bash
 * install pkgconf (FreeBSD's replacement of pkg-config)
+* install wget (needed for AtlasRep GAP package).
 
 ## building Sage itself
 
``````




---

archive/issue_comments_337184.json:
```json
{
    "body": "Changed dependencies from **#12426, #23565, #23700** to **#12426, #23565**",
    "created_at": "2017-08-31T08:00:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337184",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#12426, #23565, #23700** to **#12426, #23565**



---

archive/issue_comments_337185.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed\n * make sure `/bin/sh` is actually bash\n * install pkgconf (FreeBSD's replacement of pkg-config)\n-* install wget (needed for AtlasRep GAP package).\n+* install wget (needed for `AtlasRep` GAP package).\n \n ## building Sage itself\n \n``````\n",
    "created_at": "2017-08-31T08:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337185",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 * install gmake, gawk, gsed, and create fake make and sed to point to gmake and gsed
 * make sure `/bin/sh` is actually bash
 * install pkgconf (FreeBSD's replacement of pkg-config)
-* install wget (needed for AtlasRep GAP package).
+* install wget (needed for `AtlasRep` GAP package).
 
 ## building Sage itself
 
``````




---

archive/issue_comments_337186.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nticket description should be edited on an updated ticket page, duh...",
    "created_at": "2017-08-31T08:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337186",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:89" align="right">comment:89</div>

ticket description should be edited on an updated ticket page, duh...



---

archive/issue_comments_337187.json:
```json
{
    "body": "Changed dependencies from **#12426, #23565** to **#12426, #23565, #23700**",
    "created_at": "2017-08-31T08:15:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337187",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#12426, #23565** to **#12426, #23565, #23700**



---

archive/issue_comments_337188.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,6 +10,7 @@\n * make sure `/bin/sh` is actually bash\n * install pkgconf (FreeBSD's replacement of pkg-config)\n * install wget (needed for `AtlasRep` GAP package).\n+* install icu (needed for R)\n \n ## building Sage itself\n \n``````\n",
    "created_at": "2017-08-31T16:24:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337188",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,6 +10,7 @@
 * make sure `/bin/sh` is actually bash
 * install pkgconf (FreeBSD's replacement of pkg-config)
 * install wget (needed for `AtlasRep` GAP package).
+* install icu (needed for R)
 
 ## building Sage itself
 
``````




---

archive/issue_comments_337189.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nThe segfault in the bottom part of comment 87 remains the same if `gc` and `libatomic_ops` are rebuilt with threads disabled.",
    "created_at": "2017-08-31T16:24:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337189",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:90" align="right">comment:90</div>

The segfault in the bottom part of comment 87 remains the same if `gc` and `libatomic_ops` are rebuilt with threads disabled.



---

archive/issue_comments_337190.json:
```json
{
    "body": "<div id=\"comment:91\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eacd3d692b6dc25b73794e8a52227550ac2291cd\"><code>eacd3d6</code></a></td><td><code>Merge branch 'develop' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6\"><code>6f17c02</code></a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e\"><code>ceb3bf5</code></a></td><td><code>conform to new packaging in place since 8.1.beta1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07bfc5a1ae18c40a01ebd8c1169443f866c452d8\"><code>07bfc5a</code></a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9\"><code>d8cb828</code></a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ec453b8977f9e3032d1bc334cce9013212a5728\"><code>0ec453b</code></a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a7bf51fc42bf738f69336029afe139397e94b57b\"><code>a7bf51f</code></a></td><td><code>Merge branch 'u/fbissey/clang-progress' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>\n",
    "created_at": "2017-09-08T11:23:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337190",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:91"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eacd3d692b6dc25b73794e8a52227550ac2291cd"><code>eacd3d6</code></a></td><td><code>Merge branch 'develop' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f17c0281d618adfe7f8a79b3091c1dd3fb18ce6"><code>6f17c02</code></a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ceb3bf5d3274fd1fa6d8b917e4fa232ef264170e"><code>ceb3bf5</code></a></td><td><code>conform to new packaging in place since 8.1.beta1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07bfc5a1ae18c40a01ebd8c1169443f866c452d8"><code>07bfc5a</code></a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8cb8282b7c9d2fbc7c41f2ce2c4f910da6412f9"><code>d8cb828</code></a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ec453b8977f9e3032d1bc334cce9013212a5728"><code>0ec453b</code></a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a7bf51fc42bf738f69336029afe139397e94b57b"><code>a7bf51f</code></a></td><td><code>Merge branch 'u/fbissey/clang-progress' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>




---

archive/issue_comments_337191.json:
```json
{
    "body": "Changed commit from **[`d04c9f7`](https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c)** to **[`a7bf51f`](https://github.com/sagemath/sagetrac-mirror/commit/a7bf51fc42bf738f69336029afe139397e94b57b)**",
    "created_at": "2017-09-08T11:23:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337191",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d04c9f7`](https://github.com/sagemath/sagetrac-mirror/commit/d04c9f7b792dc9c43f07fa4446241862d088ff2c)** to **[`a7bf51f`](https://github.com/sagemath/sagetrac-mirror/commit/a7bf51fc42bf738f69336029afe139397e94b57b)**



---

archive/issue_comments_337192.json:
```json
{
    "body": "<div id=\"comment:92\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f9ca58999ad1adb3c71a5be8ae9b14b7d8abbd02\"><code>f9ca589</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into gc76</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e365c32caf4e82cc9f6a43f066d8314313756248\"><code>e365c32</code></a></td><td><code>backported patch for FreeBSD support</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c98c98c20e12c5e74caafb34b5c90d6834957ee1\"><code>c98c98c</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/83815b207a35f66893ec7e5641b51233406f2f6a\"><code>83815b2</code></a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40d32145ccd872f5a8164cc8186f1327d2d00b9e\"><code>40d3214</code></a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6902166c40c7895cca3f461c845f8f1e127c251f\"><code>6902166</code></a></td><td><code>Simplify gfortran spkg-install a bit. Thanks to Jeroen Demeyer for the feedback on this.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/afca2b66e16e33da80a8c43fb0e8576ee08182a2\"><code>afca2b6</code></a></td><td><code>no need to be so verbose about gfortran.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/235c09e0a653aac120098c0ad45e3ac71f24babe\"><code>235c09e</code></a></td><td><code>Including upstream PR 29 to compile with xcode 9 until we have a new release.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02\"><code>48462ea</code></a></td><td><code>Merge branch 'eclib-xcode9' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4aaeeb491635abea35e2804eeee7c93a80af38ea\"><code>4aaeeb4</code></a></td><td><code>Merge branch 'u/fbissey/clang-progress' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>\n",
    "created_at": "2017-10-06T13:40:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337192",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:92"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f9ca58999ad1adb3c71a5be8ae9b14b7d8abbd02"><code>f9ca589</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into gc76</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e365c32caf4e82cc9f6a43f066d8314313756248"><code>e365c32</code></a></td><td><code>backported patch for FreeBSD support</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c98c98c20e12c5e74caafb34b5c90d6834957ee1"><code>c98c98c</code></a></td><td><code>Merge branch 'u/dimpase/gcupdate' of trac.sagemath.org:sage into fbsdon81</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/83815b207a35f66893ec7e5641b51233406f2f6a"><code>83815b2</code></a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40d32145ccd872f5a8164cc8186f1327d2d00b9e"><code>40d3214</code></a></td><td><code>Merge branch 'develop' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6902166c40c7895cca3f461c845f8f1e127c251f"><code>6902166</code></a></td><td><code>Simplify gfortran spkg-install a bit. Thanks to Jeroen Demeyer for the feedback on this.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/afca2b66e16e33da80a8c43fb0e8576ee08182a2"><code>afca2b6</code></a></td><td><code>no need to be so verbose about gfortran.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/235c09e0a653aac120098c0ad45e3ac71f24babe"><code>235c09e</code></a></td><td><code>Including upstream PR 29 to compile with xcode 9 until we have a new release.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48462ead230b0740fed7b78d2fa349c4cefe8c02"><code>48462ea</code></a></td><td><code>Merge branch 'eclib-xcode9' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4aaeeb491635abea35e2804eeee7c93a80af38ea"><code>4aaeeb4</code></a></td><td><code>Merge branch 'u/fbissey/clang-progress' of trac.sagemath.org:sage into fbsdon81</code></td></tr></table>




---

archive/issue_comments_337193.json:
```json
{
    "body": "Changed commit from **[`a7bf51f`](https://github.com/sagemath/sagetrac-mirror/commit/a7bf51fc42bf738f69336029afe139397e94b57b)** to **[`4aaeeb4`](https://github.com/sagemath/sagetrac-mirror/commit/4aaeeb491635abea35e2804eeee7c93a80af38ea)**",
    "created_at": "2017-10-06T13:40:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337193",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a7bf51f`](https://github.com/sagemath/sagetrac-mirror/commit/a7bf51fc42bf738f69336029afe139397e94b57b)** to **[`4aaeeb4`](https://github.com/sagemath/sagetrac-mirror/commit/4aaeeb491635abea35e2804eeee7c93a80af38ea)**



---

archive/issue_comments_337194.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nNew code for `RiemannSurface` uses Voronoi from scipy. But the latter is broken on FreeBSD:\n\n```\n$ ./sage --python\nPython 2.7.13 (default, Oct 11 2017, 17:41:18) \n[GCC 4.2.1 Compatible Clang 6.0.0 ] on freebsd11\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import numpy as np\n>>> points = np.array([[0, 0], [0, 1], [0, 2], [1, 0], [1, 1], [1, 2],[2, 0], [2, 1], [2, 2]])\n>>> from scipy.spatial import Voronoi\n>>> Voronoi(points)\nSegmentation fault (core dumped)\n```\n(might be due to careless use of threading...)\n\nNote that the previously used in Sage version of scipy 0.17.1, still works.",
    "created_at": "2017-10-11T17:04:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337194",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:93" align="right">comment:93</div>

New code for `RiemannSurface` uses Voronoi from scipy. But the latter is broken on FreeBSD:

```
$ ./sage --python
Python 2.7.13 (default, Oct 11 2017, 17:41:18) 
[GCC 4.2.1 Compatible Clang 6.0.0 ] on freebsd11
Type "help", "copyright", "credits" or "license" for more information.
>>> import numpy as np
>>> points = np.array([[0, 0], [0, 1], [0, 2], [1, 0], [1, 1], [1, 2],[2, 0], [2, 1], [2, 2]])
>>> from scipy.spatial import Voronoi
>>> Voronoi(points)
Segmentation fault (core dumped)
```
(might be due to careless use of threading...)

Note that the previously used in Sage version of scipy 0.17.1, still works.



---

archive/issue_comments_337195.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nit turns out that scipy's Voronoi works with the system's Python 2.7.14, but not with Sage's one (there are BSD-only Python patches; trying them now).",
    "created_at": "2017-10-20T12:23:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337195",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:94" align="right">comment:94</div>

it turns out that scipy's Voronoi works with the system's Python 2.7.14, but not with Sage's one (there are BSD-only Python patches; trying them now).



---

archive/issue_comments_337196.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,13 +16,14 @@\n \n starting from a clean git repo:\n \n-* export CFLAGS=\"-fPIC\"\n-* export CXXFLAGS=\"-fPIC\"\n-* export LDFLAGS=\"-L/usr/local/lib -Wl,--add-needed -lm\"\n-* ./configure CC=cc CXX=c++  (this is clang 3.8.0 a.t.m.)\n-* MAKE=\"make -j7\" make build\n-* MAKE=\"make -j1\" make (with -jx with x>1 I get crashes in building plot3d docs)\n- \n+```\n+export CFLAGS=\"-fPIC\"\n+export CXXFLAGS=\"-fPIC\"\n+export LDFLAGS=\"-L/usr/local/lib -Wl,--add-needed -lm\"\n+./configure CC=cc CXX=c++  #(this is clang 3.8.0 a.t.m.)\n+MAKE=\"make -j7\" make build\n+MAKE=\"make -j4\" make # building docs is very memory-hungry\n+``` \n \n \n \n``````\n",
    "created_at": "2017-10-20T12:23:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337196",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,13 +16,14 @@
 
 starting from a clean git repo:
 
-* export CFLAGS="-fPIC"
-* export CXXFLAGS="-fPIC"
-* export LDFLAGS="-L/usr/local/lib -Wl,--add-needed -lm"
-* ./configure CC=cc CXX=c++  (this is clang 3.8.0 a.t.m.)
-* MAKE="make -j7" make build
-* MAKE="make -j1" make (with -jx with x>1 I get crashes in building plot3d docs)
- 
+```
+export CFLAGS="-fPIC"
+export CXXFLAGS="-fPIC"
+export LDFLAGS="-L/usr/local/lib -Wl,--add-needed -lm"
+./configure CC=cc CXX=c++  #(this is clang 3.8.0 a.t.m.)
+MAKE="make -j7" make build
+MAKE="make -j4" make # building docs is very memory-hungry
+``` 
 
 
 
``````




---

archive/issue_comments_337197.json:
```json
{
    "body": "Changed dependencies from **#12426, #23565, #23700** to **#12426, #23700**",
    "created_at": "2017-12-29T08:36:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337197",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#12426, #23565, #23700** to **#12426, #23700**



---

archive/issue_events_318200.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-11T16:05:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318200"
}
```



---

archive/issue_comments_337198.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nPlease see #26249 for a followup, for FreeBSD version 12, where things are considerably simpler.",
    "created_at": "2018-09-11T16:05:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337198",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:96" align="right">comment:96</div>

Please see #26249 for a followup, for FreeBSD version 12, where things are considerably simpler.



---

archive/issue_events_318201.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-11T16:05:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318201"
}
```



---

archive/issue_events_318202.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-11T16:05:31Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318202"
}
```



---

archive/issue_events_318203.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-11T16:05:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318203"
}
```



---

archive/issue_events_318204.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-11T16:05:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "c6c6c6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318204"
}
```



---

archive/issue_events_318205.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-13T09:36:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318205"
}
```



---

archive/issue_events_318206.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-09-13T09:36:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318206"
}
```



---

archive/issue_comments_337199.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2018-09-13T09:36:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337199",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_318207.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-09-13T10:45:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318207"
}
```



---

archive/issue_events_318208.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-09-13T10:45:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318208"
}
```



---

archive/issue_events_318209.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-09-13T10:45:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "label": "https://github.com/sagemath/sage/labels/wontfix",
    "label_color": "c6c6c6",
    "label_name": "wontfix",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22679#event-318209"
}
```



---

archive/issue_comments_337200.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n+Please see #26249 for the followup (for FreeBSD 12).\n+\n FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. \n \n \n``````\n",
    "created_at": "2019-07-18T13:38:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22679#issuecomment-337200",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
+Please see #26249 for the followup (for FreeBSD 12).
+
 FreeBSD as of version 10 uses clang by default, and is closer to OSX in other ways too, so it would be a good free testing ground for the use of clang with Sage. 
 
 
``````

