# Issue 22080: Refactoring of sage_setup.docbuild

archive/issues_021843.json:
```json
{
    "body": "I found it possibly desirable to split up the `sage_setup.docbuild.__init__` module a bit, as it was getting a bit long and difficult to reason about.  As to exactly what was moved where, this is highly subjective and open to debate.  But I do think that overall this makes the code easier to understand.\n\nI had a couple additional motivations for this:\n\nIt is with an eye toward #6389.  I think organizing the code more clearly will make it easier to implement this--in fact I don't think there's a lot left to do except to replace every reference to `SAGE_DOC_SRC` with a reference to a source directory option.  #21732 may play a role here as well.\n\nSpeaking of #21732, I have some ideas for how to use this to further reduce runtime dependency on sage_setup.\n\nCC:  @jhpalmieri\n\nKeywords: docbuild\n\nBranch: u/jdemeyer/docbuild/refactor\n\nCommit: 652c41e26b268bbe7860184e3129b9836da734b6\n\nResolution: invalid\n\nIssue created by migration from https://trac.sagemath.org/ticket/22080\n\n",
    "closed_at": "2022-08-02T06:31:03Z",
    "created_at": "2016-12-20T14:33:48Z",
    "labels": [
        "component: documentation",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Refactoring of sage_setup.docbuild",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22080",
    "user": "https://github.com/embray"
}
```
I found it possibly desirable to split up the `sage_setup.docbuild.__init__` module a bit, as it was getting a bit long and difficult to reason about.  As to exactly what was moved where, this is highly subjective and open to debate.  But I do think that overall this makes the code easier to understand.

I had a couple additional motivations for this:

It is with an eye toward #6389.  I think organizing the code more clearly will make it easier to implement this--in fact I don't think there's a lot left to do except to replace every reference to `SAGE_DOC_SRC` with a reference to a source directory option.  #21732 may play a role here as well.

Speaking of #21732, I have some ideas for how to use this to further reduce runtime dependency on sage_setup.

CC:  @jhpalmieri

Keywords: docbuild

Branch: u/jdemeyer/docbuild/refactor

Commit: 652c41e26b268bbe7860184e3129b9836da734b6

Resolution: invalid

Issue created by migration from https://trac.sagemath.org/ticket/22080





---

archive/issue_comments_408556.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-12-20T14:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408556",
    "user": "https://github.com/embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_408557.json:
```json
{
    "body": "<a id='comment:2'></a>There are a few more changes I need to add after actually testing this for use with #21732",
    "created_at": "2016-12-20T14:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408557",
    "user": "https://github.com/embray"
}
```

<a id='comment:2'></a>There are a few more changes I need to add after actually testing this for use with #21732



---

archive/issue_comments_408558.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-12-20T14:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408558",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_408559.json:
```json
{
    "body": "Changing commit from \"00e221f31ffa0e0aabce74b43e0b7908bf7c804d\" to \"0bf054ae9f14d727d3e4e961efbb8c4d223aa0e3\"",
    "created_at": "2016-12-21T15:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408559",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "00e221f31ffa0e0aabce74b43e0b7908bf7c804d" to "0bf054ae9f14d727d3e4e961efbb8c4d223aa0e3"



---

archive/issue_comments_408560.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-12-21T15:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408560",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_408561.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-12-21T15:15:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408561",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_408562.json:
```json
{
    "body": "<a id='comment:5'></a>According to the patchbot, the documentation doesn't actually build with this patch.",
    "created_at": "2017-01-04T12:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408562",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>According to the patchbot, the documentation doesn't actually build with this patch.



---

archive/issue_comments_408563.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-04T12:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408563",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_408564.json:
```json
{
    "body": "<a id='comment:6'></a>Question: is this patch supposed to make any functional changes or is it really just a reorganisation?",
    "created_at": "2017-01-04T12:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408564",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Question: is this patch supposed to make any functional changes or is it really just a reorganisation?



---

archive/issue_comments_408565.json:
```json
{
    "body": "<a id='comment:7'></a>Hmm, the error I see in the buildbot is:\n\n```\ncd ../.. && sage-logger -p './sage --docbuild --no-pdf-links all html ' logs/dochtml.log\n[dochtml] \n[dochtml] Building reference manual, first pass.\n[dochtml] \n[dochtml] Error building the documentation.\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/home/vdelecro/sage_patchbot/local/lib/python/runpy.py\", line 174, in _run_module_as_main\n[dochtml]     \"__main__\", fname, loader, pkg_name)\n[dochtml]   File \"/home/vdelecro/sage_patchbot/local/lib/python/runpy.py\", line 72, in _run_code\n[dochtml]     exec code in run_globals\n[dochtml]   File \"/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml]     main()\n[dochtml]   File \"/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/main.py\", line 274, in main\n[dochtml]     builder()\n[dochtml]   File \"/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/builders/__init__.py\", line 115, in _wrapper\n[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)\n[dochtml]   File \"/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/builders/reference.py\", line 105, in _wrapper\n[dochtml]     build_many(self._build_ref_doc, L)\n[dochtml]   File \"/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/builders/__init__.py\", line 182, in build_many\n[dochtml]     ret = x.get(99999)\n[dochtml]   File \"/home/vdelecro/sage_patchbot/local/lib/python/multiprocessing/pool.py\", line 567, in get\n[dochtml]     raise self._value\n[dochtml] PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed\nMakefile:1121: recipe for target 'doc-html' failed\nmake[1]: *** [doc-html] Error 1\n```\n\nI don't remember ever getting anything like that in testing, but I'll have to try it again.  It's possible I made some other minor changes after testing and then forgot to re-test.  I don't remember.\n\nAnyways, to answer your question yes this is just a reorganization and does not (modulo bugs) make any changes in functionality.",
    "created_at": "2017-01-04T13:43:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408565",
    "user": "https://github.com/embray"
}
```

<a id='comment:7'></a>Hmm, the error I see in the buildbot is:

```
cd ../.. && sage-logger -p './sage --docbuild --no-pdf-links all html ' logs/dochtml.log
[dochtml] 
[dochtml] Building reference manual, first pass.
[dochtml] 
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/home/vdelecro/sage_patchbot/local/lib/python/runpy.py", line 174, in _run_module_as_main
[dochtml]     "__main__", fname, loader, pkg_name)
[dochtml]   File "/home/vdelecro/sage_patchbot/local/lib/python/runpy.py", line 72, in _run_code
[dochtml]     exec code in run_globals
[dochtml]   File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/main.py", line 274, in main
[dochtml]     builder()
[dochtml]   File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/builders/__init__.py", line 115, in _wrapper
[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)
[dochtml]   File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/builders/reference.py", line 105, in _wrapper
[dochtml]     build_many(self._build_ref_doc, L)
[dochtml]   File "/home/vdelecro/sage_patchbot/local/lib/python2.7/site-packages/sage_setup/docbuild/builders/__init__.py", line 182, in build_many
[dochtml]     ret = x.get(99999)
[dochtml]   File "/home/vdelecro/sage_patchbot/local/lib/python/multiprocessing/pool.py", line 567, in get
[dochtml]     raise self._value
[dochtml] PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed
Makefile:1121: recipe for target 'doc-html' failed
make[1]: *** [doc-html] Error 1
```

I don't remember ever getting anything like that in testing, but I'll have to try it again.  It's possible I made some other minor changes after testing and then forgot to re-test.  I don't remember.

Anyways, to answer your question yes this is just a reorganization and does not (modulo bugs) make any changes in functionality.



---

archive/issue_comments_408566.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [embray](#comment%3A7):\n> `[dochtml] PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed`\n\n\nThis is almost certainly due to docbuilding in parallel. Remember that single-process and multi-process docbuilding now take a different code path.",
    "created_at": "2017-01-05T13:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408566",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Replying to [embray](#comment%3A7):
> `[dochtml] PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed`


This is almost certainly due to docbuilding in parallel. Remember that single-process and multi-process docbuilding now take a different code path.



---

archive/issue_comments_408567.json:
```json
{
    "body": "<a id='comment:9'></a>Right, that could be why I did't get it.  Though I thought docbuilding was in parallel by default.  I was testing this on Linux too.  Oh well, no matter.  It's a simple fix.",
    "created_at": "2017-01-06T12:47:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408567",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>Right, that could be why I did't get it.  Though I thought docbuilding was in parallel by default.  I was testing this on Linux too.  Oh well, no matter.  It's a simple fix.



---

archive/issue_comments_408568.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [embray](#comment%3A9):\n> Though I thought docbuilding was in parallel by default.\n\n\nNo, it's serial by default. But the patchbots all build in parallel.",
    "created_at": "2017-01-06T13:23:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408568",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Replying to [embray](#comment%3A9):
> Though I thought docbuilding was in parallel by default.


No, it's serial by default. But the patchbots all build in parallel.



---

archive/issue_comments_408569.json:
```json
{
    "body": "<a id='comment:11'></a>Ah, okay. That explains it then.",
    "created_at": "2017-01-06T13:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408569",
    "user": "https://github.com/embray"
}
```

<a id='comment:11'></a>Ah, okay. That explains it then.



---

archive/issue_comments_408570.json:
```json
{
    "body": "Changing commit from \"0bf054ae9f14d727d3e4e961efbb8c4d223aa0e3\" to \"dfeaa78686c0c1476b7a7eafce4333c5ec02cee2\"",
    "created_at": "2017-05-19T10:35:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408570",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0bf054ae9f14d727d3e4e961efbb8c4d223aa0e3" to "dfeaa78686c0c1476b7a7eafce4333c5ec02cee2"



---

archive/issue_comments_408571.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-05-19T10:35:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408571",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_408572.json:
```json
{
    "body": "<a id='comment:14'></a>Rebased (incorporating updates to `sage_setup.docbuild` since the last version of this), and fixed the remaining issues as far as I can tell.",
    "created_at": "2017-05-19T10:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408572",
    "user": "https://github.com/embray"
}
```

<a id='comment:14'></a>Rebased (incorporating updates to `sage_setup.docbuild` since the last version of this), and fixed the remaining issues as far as I can tell.



---

archive/issue_comments_408573.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-19T10:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408573",
    "user": "https://github.com/embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_408574.json:
```json
{
    "body": "<a id='comment:16'></a>1. Why this?\n\n```\ntry:\n    from sage.interfaces.gap import set_gap_memory_pool_size\n    set_gap_memory_pool_size(80 * 1024 * 1024)\nexcept ImportError:\n    pass\n```\nIf you really want this to work without Sage, I would prefer to see\n\n```\ntry:\n    import sage\nexcept ImportError:\n    pass\nelse:\n    from sage.interfaces.gap import set_gap_memory_pool_size\n    set_gap_memory_pool_size(80 * 1024 * 1024)\n```\n\n2. All functions in `src/sage_setup/docbuild/__init__.py` lack doctests. I know that the original functions didn't have doctests either, but since you changed the implementation, I think it's valid to ask for doctests. For `get_builder()`, it would be very good to have examples for various cases: just from reading the docstring, it's not totally clear what it does.\n\n3. In `get_builder`, can you use the `traceback` module to format the exceptions?",
    "created_at": "2017-05-22T09:23:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408574",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>1. Why this?

```
try:
    from sage.interfaces.gap import set_gap_memory_pool_size
    set_gap_memory_pool_size(80 * 1024 * 1024)
except ImportError:
    pass
```
If you really want this to work without Sage, I would prefer to see

```
try:
    import sage
except ImportError:
    pass
else:
    from sage.interfaces.gap import set_gap_memory_pool_size
    set_gap_memory_pool_size(80 * 1024 * 1024)
```

2. All functions in `src/sage_setup/docbuild/__init__.py` lack doctests. I know that the original functions didn't have doctests either, but since you changed the implementation, I think it's valid to ask for doctests. For `get_builder()`, it would be very good to have examples for various cases: just from reading the docstring, it's not totally clear what it does.

3. In `get_builder`, can you use the `traceback` module to format the exceptions?



---

archive/issue_comments_408575.json:
```json
{
    "body": "<a id='comment:17'></a>For 1), it's possible `import sage` works, but it's not fully built or fully working.  The point is that this code has to be there when using Sage *for some reason* that I don't know, but this module should work fine without Sage as well.",
    "created_at": "2017-05-22T09:34:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408575",
    "user": "https://github.com/embray"
}
```

<a id='comment:17'></a>For 1), it's possible `import sage` works, but it's not fully built or fully working.  The point is that this code has to be there when using Sage *for some reason* that I don't know, but this module should work fine without Sage as well.



---

archive/issue_comments_408576.json:
```json
{
    "body": "Changing branch from \"u/embray/docbuild/refactor\" to \"u/jdemeyer/docbuild/refactor\"",
    "created_at": "2017-05-22T10:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408576",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/embray/docbuild/refactor" to "u/jdemeyer/docbuild/refactor"



---

archive/issue_comments_408577.json:
```json
{
    "body": "Changing commit from \"dfeaa78686c0c1476b7a7eafce4333c5ec02cee2\" to \"652c41e26b268bbe7860184e3129b9836da734b6\"",
    "created_at": "2017-05-22T10:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408577",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "dfeaa78686c0c1476b7a7eafce4333c5ec02cee2" to "652c41e26b268bbe7860184e3129b9836da734b6"



---

archive/issue_comments_408578.json:
```json
{
    "body": "<a id='comment:19'></a>For easier reviewing, I squashed this branch and made it into 2 commits: one which literally just moves code around and one which makes further changes.\n\n---\nNew commits:",
    "created_at": "2017-05-22T10:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408578",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>For easier reviewing, I squashed this branch and made it into 2 commits: one which literally just moves code around and one which makes further changes.

---
New commits:



---

archive/issue_comments_408579.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [embray](#comment%3A17):\n> For 1), it's possible `import sage` works, but it's not fully built or fully working.\n\n\nIf that's the case, that's a bug and we want to know about it. Hiding a bug inside an `except` statement is not good style.\n\nDo you plan to use the docbuilder outside of Sage? If not, there is no reason for the `try`/`except`.",
    "created_at": "2017-05-22T10:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408579",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>Replying to [embray](#comment%3A17):
> For 1), it's possible `import sage` works, but it's not fully built or fully working.


If that's the case, that's a bug and we want to know about it. Hiding a bug inside an `except` statement is not good style.

Do you plan to use the docbuilder outside of Sage? If not, there is no reason for the `try`/`except`.



---

archive/issue_comments_408580.json:
```json
{
    "body": "<a id='comment:21'></a>`pyflakes` complains about a few things:\n\n```\ndocbuild/main.py:267: local variable 'C' is assigned to but never used\ndocbuild/builders/docbuilder.py:111: undefined name 'logger'\ndocbuild/builders/reference.py:625: undefined name 'SAGE_SRC'\ndocbuild/builders/singlefile.py:5: 're' imported but unused\n```\nThe undefined names are surely bugs.",
    "created_at": "2017-05-22T10:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408580",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>`pyflakes` complains about a few things:

```
docbuild/main.py:267: local variable 'C' is assigned to but never used
docbuild/builders/docbuilder.py:111: undefined name 'logger'
docbuild/builders/reference.py:625: undefined name 'SAGE_SRC'
docbuild/builders/singlefile.py:5: 're' imported but unused
```
The undefined names are surely bugs.



---

archive/issue_comments_408581.json:
```json
{
    "body": "<a id='comment:22'></a>Let me say that I honestly want to move forward with this ticket. It would a pity to have this ticket stalled again. So even if I disagree with a minor thing, I might accept it anyway.",
    "created_at": "2017-05-22T10:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408581",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>Let me say that I honestly want to move forward with this ticket. It would a pity to have this ticket stalled again. So even if I disagree with a minor thing, I might accept it anyway.



---

archive/issue_comments_408582.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [jdemeyer](#comment%3A20):\n> Replying to [embray](#comment%3A17):\n> > For 1), it's possible `import sage` works, but it's not fully built or fully working.\n\n> \n> If that's the case, that's a bug and we want to know about it. Hiding a bug inside an `except` statement is not good style.\n\n\nThat depends.  It's not necessarily hiding a \"bug\" in this case.  That said, I don't remember the exact reason it was needed so changing this *might* be fine.  I just don't see why it matters.\n\n> Do you plan to use the docbuilder outside of Sage? If not, there is no reason for the `try`/`except`.\n\n\nYes, that's part of the point of this refactoring, as well as #21732.  I don't *personally* plan to use it, but it should be made more independent of Sage.",
    "created_at": "2017-05-22T12:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408582",
    "user": "https://github.com/embray"
}
```

<a id='comment:23'></a>Replying to [jdemeyer](#comment%3A20):
> Replying to [embray](#comment%3A17):
> > For 1), it's possible `import sage` works, but it's not fully built or fully working.

> 
> If that's the case, that's a bug and we want to know about it. Hiding a bug inside an `except` statement is not good style.


That depends.  It's not necessarily hiding a "bug" in this case.  That said, I don't remember the exact reason it was needed so changing this *might* be fine.  I just don't see why it matters.

> Do you plan to use the docbuilder outside of Sage? If not, there is no reason for the `try`/`except`.


Yes, that's part of the point of this refactoring, as well as #21732.  I don't *personally* plan to use it, but it should be made more independent of Sage.



---

archive/issue_comments_408583.json:
```json
{
    "body": "<a id='comment:24'></a>Replying to [jdemeyer](#comment%3A22):\n> Let me say that I honestly want to move forward with this ticket. It would a pity to have this ticket stalled again. So even if I disagree with a minor thing, I might accept it anyway.\n\n\nThat's fine, and I agree with your other comments.  I'm not sure what you want me to do now that you've switched it to your branch though.",
    "created_at": "2017-05-22T12:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408583",
    "user": "https://github.com/embray"
}
```

<a id='comment:24'></a>Replying to [jdemeyer](#comment%3A22):
> Let me say that I honestly want to move forward with this ticket. It would a pity to have this ticket stalled again. So even if I disagree with a minor thing, I might accept it anyway.


That's fine, and I agree with your other comments.  I'm not sure what you want me to do now that you've switched it to your branch though.



---

archive/issue_comments_408584.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [embray](#comment%3A24):\n> That's fine, and I agree with your other comments.  I'm not sure what you want me to do now that you've switched it to your branch though.\n\n\nPreferably, you continue your work on top of my branch.",
    "created_at": "2017-05-23T07:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408584",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>Replying to [embray](#comment%3A24):
> That's fine, and I agree with your other comments.  I'm not sure what you want me to do now that you've switched it to your branch though.


Preferably, you continue your work on top of my branch.



---

archive/issue_events_058086.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-05-27T10:39:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22080#event-58086"
}
```



---

archive/issue_comments_408585.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-05-27T10:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408585",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_058087.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-09T19:56:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22080#event-58087"
}
```



---

archive/issue_events_058088.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-09T19:56:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22080#event-58088"
}
```



---

archive/issue_comments_408586.json:
```json
{
    "body": "Changing author from \"Erik Bray\" to \"\"",
    "created_at": "2022-07-09T19:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408586",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "Erik Bray" to ""



---

archive/issue_comments_408587.json:
```json
{
    "body": "<a id='comment:27'></a>outdated, should close",
    "created_at": "2022-07-09T19:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408587",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>outdated, should close



---

archive/issue_comments_408588.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-09T19:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408588",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_408589.json:
```json
{
    "body": "<a id='comment:28'></a>Sure.",
    "created_at": "2022-07-09T22:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408589",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>Sure.



---

archive/issue_comments_408590.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-09T22:59:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408590",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_408591.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2022-08-02T06:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22080#issuecomment-408591",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid



---

archive/issue_events_058089.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-02T06:31:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22080",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22080#event-58089"
}
```
