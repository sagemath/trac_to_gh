# Issue 22723: backend_polymake: Work around polymake bug with zero inequalities over quadratic extensions

archive/issues_022486.json:
```json
{
    "body": "Following up on #22683:\n\nEasy workaround for a segfault, as discussed and suggested at\nhttps://forum.polymake.org/viewtopic.php?f=8&t=547\n\nSee also: #22710: Meta-ticket: polymake\n\nCC:  @tscrim\n\nKeywords: polymake\n\nBranch/Commit: [93af25844a4a55c5372bfb55d896784de2945db8](https://github.com/sagemath/sagetrac-mirror/commit/93af25844a4a55c5372bfb55d896784de2945db8)\n\nReviewer: Travis Scrimshaw\n\nAuthor: Matthias Koeppe\n\nDependencies: #22683\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22723\n\n",
    "closed_at": "2017-04-05T19:37:53Z",
    "created_at": "2017-03-30T17:10:10Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "backend_polymake: Work around polymake bug with zero inequalities over quadratic extensions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22723",
    "user": "https://github.com/mkoeppe"
}
```
Following up on #22683:

Easy workaround for a segfault, as discussed and suggested at
https://forum.polymake.org/viewtopic.php?f=8&t=547

See also: #22710: Meta-ticket: polymake

CC:  @tscrim

Keywords: polymake

Branch/Commit: [93af25844a4a55c5372bfb55d896784de2945db8](https://github.com/sagemath/sagetrac-mirror/commit/93af25844a4a55c5372bfb55d896784de2945db8)

Reviewer: Travis Scrimshaw

Author: Matthias Koeppe

Dependencies: #22683

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22723





---

archive/issue_comments_426180.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/backend_polymake__work_around_polymake_bug_with_zero_inequalities_over_quadratic_extensions\"",
    "created_at": "2017-03-30T17:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426180",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/backend_polymake__work_around_polymake_bug_with_zero_inequalities_over_quadratic_extensions"



---

archive/issue_comments_426181.json:
```json
{
    "body": "Changing commit from \"\" to \"4070c66b4b1bb69db38df205ec72913a0d6c3407\"",
    "created_at": "2017-03-30T17:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426181",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "4070c66b4b1bb69db38df205ec72913a0d6c3407"



---

archive/issue_comments_426182.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#22683\"",
    "created_at": "2017-03-30T17:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426182",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#22683"



---

archive/issue_comments_426183.json:
```json
{
    "body": "<a id='comment:2'></a>\nLast 10 new commits:\n|                                                                                                                                          |                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|\n|[ef23af4](https://github.com/sagemath/sagetrac-mirror/commit/ef23af4ada9587307f001690662e3c4d715fb6e6)|`Polyhedron_base._polymake_init_: Add test for RDF polyhedra`|\n|[205879f](https://github.com/sagemath/sagetrac-mirror/commit/205879fb118e1c7c3fd954e42022b7fe0c6af119)|`Matrix, MatrixSpace: Add coercion to polymake interface`|\n|[e49765e](https://github.com/sagemath/sagetrac-mirror/commit/e49765eaa94319320c1a40e820d45010b32ea94d)|`Polymake: Fix tests whose error messages changed because we do not use files`|\n|[51af468](https://github.com/sagemath/sagetrac-mirror/commit/51af46867c3e26a5c5b3aaefc94b6722f3b94dbc)|`PolymakeElement.__iter__: New`|\n|[2f0e059](https://github.com/sagemath/sagetrac-mirror/commit/2f0e0594a0ce0d0342427f0d75ea1e7e4d9e13b3)|`PolymakeElement._sage_: Implement for *Vector, *Matrix, QuadraticExtension`|\n|[218daca](https://github.com/sagemath/sagetrac-mirror/commit/218daca488ac24b80c6cea51b6e06fbf28c7874a)|`Add Polyhedron_polymake`|\n|[5ab94a2](https://github.com/sagemath/sagetrac-mirror/commit/5ab94a2172c456509036a8dd5e77dbbe692c8635)|`Merge tag '7.6' into t/22683/backend_polymake_for_polyhedron`|\n|[8fd81c7](https://github.com/sagemath/sagetrac-mirror/commit/8fd81c72dfcf1cd84e13de8f1f2740de4dbdb217)|`Polyhedron_polymake._polymake_: Add doctest`|\n|[952b860](https://github.com/sagemath/sagetrac-mirror/commit/952b8607c9a4756cf35fe358e2718e33f04bb6b7)|`PolymakeElement.__iter__: Doc fixes`|\n|[4070c66](https://github.com/sagemath/sagetrac-mirror/commit/4070c66b4b1bb69db38df205ec72913a0d6c3407)|`Polyhedron_polymake: Work around polymake bug with zero inequalities over quadratic extensions`|",
    "created_at": "2017-03-30T17:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426183",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Last 10 new commits:
|                                                                                                                                          |                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
|[ef23af4](https://github.com/sagemath/sagetrac-mirror/commit/ef23af4ada9587307f001690662e3c4d715fb6e6)|`Polyhedron_base._polymake_init_: Add test for RDF polyhedra`|
|[205879f](https://github.com/sagemath/sagetrac-mirror/commit/205879fb118e1c7c3fd954e42022b7fe0c6af119)|`Matrix, MatrixSpace: Add coercion to polymake interface`|
|[e49765e](https://github.com/sagemath/sagetrac-mirror/commit/e49765eaa94319320c1a40e820d45010b32ea94d)|`Polymake: Fix tests whose error messages changed because we do not use files`|
|[51af468](https://github.com/sagemath/sagetrac-mirror/commit/51af46867c3e26a5c5b3aaefc94b6722f3b94dbc)|`PolymakeElement.__iter__: New`|
|[2f0e059](https://github.com/sagemath/sagetrac-mirror/commit/2f0e0594a0ce0d0342427f0d75ea1e7e4d9e13b3)|`PolymakeElement._sage_: Implement for *Vector, *Matrix, QuadraticExtension`|
|[218daca](https://github.com/sagemath/sagetrac-mirror/commit/218daca488ac24b80c6cea51b6e06fbf28c7874a)|`Add Polyhedron_polymake`|
|[5ab94a2](https://github.com/sagemath/sagetrac-mirror/commit/5ab94a2172c456509036a8dd5e77dbbe692c8635)|`Merge tag '7.6' into t/22683/backend_polymake_for_polyhedron`|
|[8fd81c7](https://github.com/sagemath/sagetrac-mirror/commit/8fd81c72dfcf1cd84e13de8f1f2740de4dbdb217)|`Polyhedron_polymake._polymake_: Add doctest`|
|[952b860](https://github.com/sagemath/sagetrac-mirror/commit/952b8607c9a4756cf35fe358e2718e33f04bb6b7)|`PolymakeElement.__iter__: Doc fixes`|
|[4070c66](https://github.com/sagemath/sagetrac-mirror/commit/4070c66b4b1bb69db38df205ec72913a0d6c3407)|`Polyhedron_polymake: Work around polymake bug with zero inequalities over quadratic extensions`|



---

archive/issue_comments_426184.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+Following up on #22683:\n+\n Easy workaround for a segfault, as discussed and suggested at\n https://forum.polymake.org/viewtopic.php?f=8&t=547\n \n-\n+See also: #22710: Meta-ticket: polymake\n``````\n",
    "created_at": "2017-03-30T20:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426184",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
+Following up on #22683:
+
 Easy workaround for a segfault, as discussed and suggested at
 https://forum.polymake.org/viewtopic.php?f=8&t=547
 
-
+See also: #22710: Meta-ticket: polymake
``````




---

archive/issue_comments_426185.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-31T16:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426185",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_426186.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2017-03-31T16:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426186",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_426187.json:
```json
{
    "body": "<a id='comment:6'></a>\nYour check doesn't result in any speedup when the list passes as it has to check every element and has to double check when it fails. I think you're better off just running the filter directly:\n\n```python\nieqs = [ v for v in list if not all(self._is_zero(x) for x in v) ]\n```\nThe other option would be a more hybrid approach like this:\n\n```python\nfor i,v in enumerate(ieqs):\n    if all(self._is_zero(x) for x in v):\n        ieqs = ieqs[:i] + [v for v in ieqs[i+1:] if all(self._is_zero(x) for x in v))\n        break\n```\nAlthough I think always filtering is best because it is the simplest code-wise.",
    "created_at": "2017-04-01T19:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426187",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
Your check doesn't result in any speedup when the list passes as it has to check every element and has to double check when it fails. I think you're better off just running the filter directly:

```python
ieqs = [ v for v in list if not all(self._is_zero(x) for x in v) ]
```
The other option would be a more hybrid approach like this:

```python
for i,v in enumerate(ieqs):
    if all(self._is_zero(x) for x in v):
        ieqs = ieqs[:i] + [v for v in ieqs[i+1:] if all(self._is_zero(x) for x in v))
        break
```
Although I think always filtering is best because it is the simplest code-wise.



---

archive/issue_comments_426188.json:
```json
{
    "body": "Changing commit from \"4070c66b4b1bb69db38df205ec72913a0d6c3407\" to \"93af25844a4a55c5372bfb55d896784de2945db8\"",
    "created_at": "2017-04-01T19:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426188",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4070c66b4b1bb69db38df205ec72913a0d6c3407" to "93af25844a4a55c5372bfb55d896784de2945db8"



---

archive/issue_comments_426189.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|\n|[8812e9c](https://github.com/sagemath/sagetrac-mirror/commit/8812e9c0b5b19506fcdaeac92834938e30301707)|`Merge tag '7.6' into t/22658/polyhedron_methods_using_the_polymake_pexpect_interface`|\n|[b47f6f9](https://github.com/sagemath/sagetrac-mirror/commit/b47f6f926b549cdf167530cdb2f25e742a8d70a9)|`Polyhedron_base._polymake_init_: Add work around for empty polytopes with Polymake 3.0`|\n|[3b49a54](https://github.com/sagemath/sagetrac-mirror/commit/3b49a54dc04adec084b7f77f1c70328e608eb967)|`Polymake: Fix another test whose error message depends on whether we use files`|\n|[07a1757](https://github.com/sagemath/sagetrac-mirror/commit/07a17571db553f2aa91f87184fd96492317a4d93)|`Polyhedron_base._polymake_init_: Fix comment`|\n|[09942e7](https://github.com/sagemath/sagetrac-mirror/commit/09942e7983510e41912f04fe14cdeb52a1f0c5a9)|`coercion tutorial: Update introspection results`|\n|[19d05f1](https://github.com/sagemath/sagetrac-mirror/commit/19d05f1b1053dac87c1a21c98a4f3844e0e6a7e3)|`Add more 'optional - polymake`|\n|[cd583e2](https://github.com/sagemath/sagetrac-mirror/commit/cd583e2934e499211c8c8a6addf7dddeb36314cb)|`Remove one unneccessary 'optional - polymake`|\n|[7bcc04c](https://github.com/sagemath/sagetrac-mirror/commit/7bcc04c590a7583fb7d8d0a859fd443fa02c4d8c)|`Merge tag '8.0.beta0' into t/22658/polyhedron_methods_using_the_polymake_pexpect_interface`|\n|[d7d4234](https://github.com/sagemath/sagetrac-mirror/commit/d7d4234f660f8b154a1d3b28cc9a8d0883f9a38c)|`Add '# optional - polymake'`|\n|[93af258](https://github.com/sagemath/sagetrac-mirror/commit/93af25844a4a55c5372bfb55d896784de2945db8)|`Merge branch 't/22658/polyhedron_methods_using_the_polymake_pexpect_interface' into t/22723/backend_polymake__work_around_polymake_bug_with_zero_inequalities_over_quadratic_extensions`|",
    "created_at": "2017-04-01T19:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426189",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------|
|[8812e9c](https://github.com/sagemath/sagetrac-mirror/commit/8812e9c0b5b19506fcdaeac92834938e30301707)|`Merge tag '7.6' into t/22658/polyhedron_methods_using_the_polymake_pexpect_interface`|
|[b47f6f9](https://github.com/sagemath/sagetrac-mirror/commit/b47f6f926b549cdf167530cdb2f25e742a8d70a9)|`Polyhedron_base._polymake_init_: Add work around for empty polytopes with Polymake 3.0`|
|[3b49a54](https://github.com/sagemath/sagetrac-mirror/commit/3b49a54dc04adec084b7f77f1c70328e608eb967)|`Polymake: Fix another test whose error message depends on whether we use files`|
|[07a1757](https://github.com/sagemath/sagetrac-mirror/commit/07a17571db553f2aa91f87184fd96492317a4d93)|`Polyhedron_base._polymake_init_: Fix comment`|
|[09942e7](https://github.com/sagemath/sagetrac-mirror/commit/09942e7983510e41912f04fe14cdeb52a1f0c5a9)|`coercion tutorial: Update introspection results`|
|[19d05f1](https://github.com/sagemath/sagetrac-mirror/commit/19d05f1b1053dac87c1a21c98a4f3844e0e6a7e3)|`Add more 'optional - polymake`|
|[cd583e2](https://github.com/sagemath/sagetrac-mirror/commit/cd583e2934e499211c8c8a6addf7dddeb36314cb)|`Remove one unneccessary 'optional - polymake`|
|[7bcc04c](https://github.com/sagemath/sagetrac-mirror/commit/7bcc04c590a7583fb7d8d0a859fd443fa02c4d8c)|`Merge tag '8.0.beta0' into t/22658/polyhedron_methods_using_the_polymake_pexpect_interface`|
|[d7d4234](https://github.com/sagemath/sagetrac-mirror/commit/d7d4234f660f8b154a1d3b28cc9a8d0883f9a38c)|`Add '# optional - polymake'`|
|[93af258](https://github.com/sagemath/sagetrac-mirror/commit/93af25844a4a55c5372bfb55d896784de2945db8)|`Merge branch 't/22658/polyhedron_methods_using_the_polymake_pexpect_interface' into t/22723/backend_polymake__work_around_polymake_bug_with_zero_inequalities_over_quadratic_extensions`|



---

archive/issue_comments_426190.json:
```json
{
    "body": "<a id='comment:8'></a>\nThanks. I agree. I've simplified the code.\nAlso merged the updated #22658.",
    "created_at": "2017-04-01T19:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426190",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Thanks. I agree. I've simplified the code.
Also merged the updated #22658.



---

archive/issue_comments_426191.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-01T19:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426191",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_426192.json:
```json
{
    "body": "<a id='comment:9'></a>\nLGTM. Thanks.",
    "created_at": "2017-04-01T19:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426192",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
LGTM. Thanks.



---

archive/issue_comments_426193.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2017-04-01T19:39:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426193",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_426194.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/backend_polymake__work_around_polymake_bug_with_zero_inequalities_over_quadratic_extensions\" to \"93af25844a4a55c5372bfb55d896784de2945db8\"",
    "created_at": "2017-04-05T19:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426194",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/backend_polymake__work_around_polymake_bug_with_zero_inequalities_over_quadratic_extensions" to "93af25844a4a55c5372bfb55d896784de2945db8"



---

archive/issue_comments_426195.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-05T19:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22723#issuecomment-426195",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_067305.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-05T19:37:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22723",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22723#event-67305"
}
```
