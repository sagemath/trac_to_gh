# Issue 22924: cleaning of linbox for dense integer matrices

archive/issues_022687.json:
```json
{
    "assignees": [],
    "body": "Various cleaning to the linbox interface (`sage.libs.linbox`) and Sage dense integer matrices (`sage.matrix.matrix_integer_dense`).\n\n- implement a more direct linbox/flint interface in `sage/libs/linbox/linbox_flint_interface.pyx` (supersedes part of `linbox-sage.C` inside linbox)\n\n- remove all mpz pointers from `Matrix_integer_dense` (that is the attributes\n  `bint _initialized_mpz`, `mpz_t * _entrie` and `mpz_t ** _rows`) as\n  well as the associated constructors/destructors (`int _init_mpz(self)`, `int _init_mpz_impl(self)`, `int _init_linbox(self)`, `void _dealloc_mpz(self)`)\n\n- fix the following error\n\n```\nsage: matrix(ZZ, 2).det(algorithm='padic')\nTraceback (most recent call last):\n...\nImportError: No module named matrix_integer_dense_hnf\n```\n\n- add more examples and tests to the documentation\n\n(see #22872 for the linbox task ticket)\n\nCC:  @ClementPernet @sagetrac-dlucas\n\nKeywords: **linbox**\n\nBranch/Commit: **[`0b082c2`](https://github.com/sagemath/sagetrac-mirror/commit/0b082c2d7aac83d91253a450cd81e7accf13d76b)**\n\nReviewer: **Cl\u00e9ment Pernet**\n\nAuthor: **Vincent Delecroix**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22924_\n\n",
    "closed_at": "2017-05-14T08:20:04Z",
    "created_at": "2017-05-02T06:18:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "cleaning of linbox for dense integer matrices",
    "type": "issue",
    "updated_at": "2017-05-14T08:20:04Z",
    "url": "https://github.com/sagemath/sage/issues/22924",
    "user": "https://github.com/videlec"
}
```
Various cleaning to the linbox interface (`sage.libs.linbox`) and Sage dense integer matrices (`sage.matrix.matrix_integer_dense`).

- implement a more direct linbox/flint interface in `sage/libs/linbox/linbox_flint_interface.pyx` (supersedes part of `linbox-sage.C` inside linbox)

- remove all mpz pointers from `Matrix_integer_dense` (that is the attributes
  `bint _initialized_mpz`, `mpz_t * _entrie` and `mpz_t ** _rows`) as
  well as the associated constructors/destructors (`int _init_mpz(self)`, `int _init_mpz_impl(self)`, `int _init_linbox(self)`, `void _dealloc_mpz(self)`)

- fix the following error

```
sage: matrix(ZZ, 2).det(algorithm='padic')
Traceback (most recent call last):
...
ImportError: No module named matrix_integer_dense_hnf
```

- add more examples and tests to the documentation

(see #22872 for the linbox task ticket)

CC:  @ClementPernet @sagetrac-dlucas

Keywords: **linbox**

Branch/Commit: **[`0b082c2`](https://github.com/sagemath/sagetrac-mirror/commit/0b082c2d7aac83d91253a450cd81e7accf13d76b)**

Reviewer: **Cl√©ment Pernet**

Author: **Vincent Delecroix**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/22924_





---

archive/issue_events_319720.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-02T06:18:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319720"
}
```



---

archive/issue_events_319721.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-02T06:18:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319721"
}
```



---

archive/issue_events_319722.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-02T06:18:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319722"
}
```



---

archive/issue_comments_342132.json:
```json
{
    "body": "Branch: **[u/vdelecroix/22924](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22924)**",
    "created_at": "2017-05-02T06:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342132",
    "user": "https://github.com/videlec"
}
```

Branch: **[u/vdelecroix/22924](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22924)**



---

archive/issue_comments_342133.json:
```json
{
    "body": "Commit: **[`38d9da3`](https://github.com/sagemath/sagetrac-mirror/commit/38d9da303a72512d2cab94ef0d8219fd03de12aa)**",
    "created_at": "2017-05-02T06:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342133",
    "user": "https://github.com/videlec"
}
```

Commit: **[`38d9da3`](https://github.com/sagemath/sagetrac-mirror/commit/38d9da303a72512d2cab94ef0d8219fd03de12aa)**



---

archive/issue_comments_342134.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cca8edfcb800a6535057c9547bb2b14b7ff6a8b5\"><code>cca8edf</code></a></td><td><code>fix headers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38d9da303a72512d2cab94ef0d8219fd03de12aa\"><code>38d9da3</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr></table>\n",
    "created_at": "2017-05-02T06:20:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342134",
    "user": "https://github.com/videlec"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cca8edfcb800a6535057c9547bb2b14b7ff6a8b5"><code>cca8edf</code></a></td><td><code>fix headers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38d9da303a72512d2cab94ef0d8219fd03de12aa"><code>38d9da3</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr></table>




---

archive/issue_comments_342135.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/86d8af3dd66ed8c1847452d555953eee7a00f91c\"><code>86d8af3</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr></table>\n",
    "created_at": "2017-05-02T07:40:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342135",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/86d8af3dd66ed8c1847452d555953eee7a00f91c"><code>86d8af3</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr></table>




---

archive/issue_comments_342136.json:
```json
{
    "body": "Changed commit from **[`38d9da3`](https://github.com/sagemath/sagetrac-mirror/commit/38d9da303a72512d2cab94ef0d8219fd03de12aa)** to **[`86d8af3`](https://github.com/sagemath/sagetrac-mirror/commit/86d8af3dd66ed8c1847452d555953eee7a00f91c)**",
    "created_at": "2017-05-02T07:40:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342136",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`38d9da3`](https://github.com/sagemath/sagetrac-mirror/commit/38d9da303a72512d2cab94ef0d8219fd03de12aa)** to **[`86d8af3`](https://github.com/sagemath/sagetrac-mirror/commit/86d8af3dd66ed8c1847452d555953eee7a00f91c)**



---

archive/issue_events_319723.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-02T07:44:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319723"
}
```



---

archive/issue_comments_342137.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,3 +17,4 @@\n \n - add more examples and tests to the documentation\n \n+(see #22872 for the linbox task ticket)\n``````\n",
    "created_at": "2017-05-02T07:44:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342137",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,3 +17,4 @@
 
 - add more examples and tests to the documentation
 
+(see #22872 for the linbox task ticket)
``````




---

archive/issue_comments_342138.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Various cleaning to the linbox interface (`sage.libs.linbox`) and Sage dense integer matrices (`sage.matrix.matrix_integer_dense`).\n \n-- implement in pure Cython the interface to linbox in a new file `sage/libs/linbox/linbox_flint_interface.pyx`\n+- implement a more direct linbox/flint interface in `sage/libs/linbox/linbox_flint_interface.pyx` (supersedes part of `linbox-sage.C` inside linbox)\n \n - remove all mpz pointers from `Matrix_integer_dense` (that is the attributes\n   `bint _initialized_mpz`, `mpz_t * _entrie` and `mpz_t ** _rows`) as\n``````\n",
    "created_at": "2017-05-02T07:46:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342138",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Various cleaning to the linbox interface (`sage.libs.linbox`) and Sage dense integer matrices (`sage.matrix.matrix_integer_dense`).
 
-- implement in pure Cython the interface to linbox in a new file `sage/libs/linbox/linbox_flint_interface.pyx`
+- implement a more direct linbox/flint interface in `sage/libs/linbox/linbox_flint_interface.pyx` (supersedes part of `linbox-sage.C` inside linbox)
 
 - remove all mpz pointers from `Matrix_integer_dense` (that is the attributes
   `bint _initialized_mpz`, `mpz_t * _entrie` and `mpz_t ** _rows`) as
``````




---

archive/issue_events_319724.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-02T10:53:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319724"
}
```



---

archive/issue_comments_342139.json:
```json
{
    "body": "Changed commit from **[`86d8af3`](https://github.com/sagemath/sagetrac-mirror/commit/86d8af3dd66ed8c1847452d555953eee7a00f91c)** to **[`4cae968`](https://github.com/sagemath/sagetrac-mirror/commit/4cae968e969b661488ef07621d29303251732726)**",
    "created_at": "2017-05-03T05:59:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342139",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`86d8af3`](https://github.com/sagemath/sagetrac-mirror/commit/86d8af3dd66ed8c1847452d555953eee7a00f91c)** to **[`4cae968`](https://github.com/sagemath/sagetrac-mirror/commit/4cae968e969b661488ef07621d29303251732726)**



---

archive/issue_comments_342140.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cccbe303ef08e7feac33ea305227dd1fa3f7db6a\"><code>cccbe30</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4cae968e969b661488ef07621d29303251732726\"><code>4cae968</code></a></td><td><code>22924: remove (instead of deprecate) code from linbox.pyx</code></td></tr></table>\n",
    "created_at": "2017-05-03T05:59:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342140",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cccbe303ef08e7feac33ea305227dd1fa3f7db6a"><code>cccbe30</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4cae968e969b661488ef07621d29303251732726"><code>4cae968</code></a></td><td><code>22924: remove (instead of deprecate) code from linbox.pyx</code></td></tr></table>




---

archive/issue_comments_342141.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/09f62806bc83b5049d90ea481de8abffe61712f0\"><code>09f6280</code></a></td><td><code>22924: get rid of spies</code></td></tr></table>\n",
    "created_at": "2017-05-03T11:33:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342141",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/09f62806bc83b5049d90ea481de8abffe61712f0"><code>09f6280</code></a></td><td><code>22924: get rid of spies</code></td></tr></table>




---

archive/issue_comments_342142.json:
```json
{
    "body": "Changed commit from **[`4cae968`](https://github.com/sagemath/sagetrac-mirror/commit/4cae968e969b661488ef07621d29303251732726)** to **[`09f6280`](https://github.com/sagemath/sagetrac-mirror/commit/09f62806bc83b5049d90ea481de8abffe61712f0)**",
    "created_at": "2017-05-03T11:33:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342142",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4cae968`](https://github.com/sagemath/sagetrac-mirror/commit/4cae968e969b661488ef07621d29303251732726)** to **[`09f6280`](https://github.com/sagemath/sagetrac-mirror/commit/09f62806bc83b5049d90ea481de8abffe61712f0)**



---

archive/issue_comments_342143.json:
```json
{
    "body": "Changed commit from **[`09f6280`](https://github.com/sagemath/sagetrac-mirror/commit/09f62806bc83b5049d90ea481de8abffe61712f0)** to **[`69a140e`](https://github.com/sagemath/sagetrac-mirror/commit/69a140e1d299cc6971ad75e868dd9418083bbc0b)**",
    "created_at": "2017-05-03T12:16:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342143",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`09f6280`](https://github.com/sagemath/sagetrac-mirror/commit/09f62806bc83b5049d90ea481de8abffe61712f0)** to **[`69a140e`](https://github.com/sagemath/sagetrac-mirror/commit/69a140e1d299cc6971ad75e868dd9418083bbc0b)**



---

archive/issue_comments_342144.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48cd83bcd4fe14eafc0a208fff2566656b0a3a5b\"><code>48cd83b</code></a></td><td><code>fix headers</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3f5ec834ea85b29c473d4a37af792c19bc8450ba\"><code>3f5ec83</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef07ed5709578fb7712fc5ee6b880fd9d710dc44\"><code>ef07ed5</code></a></td><td><code>22924: remove (instead of deprecate) code from linbox.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69a140e1d299cc6971ad75e868dd9418083bbc0b\"><code>69a140e</code></a></td><td><code>22924: get rid of spies</code></td></tr></table>\n",
    "created_at": "2017-05-03T12:16:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342144",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48cd83bcd4fe14eafc0a208fff2566656b0a3a5b"><code>48cd83b</code></a></td><td><code>fix headers</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3f5ec834ea85b29c473d4a37af792c19bc8450ba"><code>3f5ec83</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef07ed5709578fb7712fc5ee6b880fd9d710dc44"><code>ef07ed5</code></a></td><td><code>22924: remove (instead of deprecate) code from linbox.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69a140e1d299cc6971ad75e868dd9418083bbc0b"><code>69a140e</code></a></td><td><code>22924: get rid of spies</code></td></tr></table>




---

archive/issue_comments_342145.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n(rebased on 8.0.b4)",
    "created_at": "2017-05-03T12:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342145",
    "user": "https://github.com/videlec"
}
```

<div id="comment:9" align="right">comment:9</div>

(rebased on 8.0.b4)



---

archive/issue_comments_342146.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nGreat.\nLet's start with a few remarks:\n1. Why do need the dependency on #22886 ? That ticket is stalled and is therefore also blocking this one.\n2. While we are changing a lot of stuff, I wouldn't mind getting rid of these ugly `poly_linbox` method, with a string parameter `typ` that determines whether to compute minpoly or charpoly. We should rather only have the 2 methods `_minpoly_linbox_` and `_charpoly_linbox_`. There is not much duplicated code between these two, especially now after this clean-up.",
    "created_at": "2017-05-04T06:03:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342146",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:10" align="right">comment:10</div>

Great.
Let's start with a few remarks:
1. Why do need the dependency on #22886 ? That ticket is stalled and is therefore also blocking this one.
2. While we are changing a lot of stuff, I wouldn't mind getting rid of these ugly `poly_linbox` method, with a string parameter `typ` that determines whether to compute minpoly or charpoly. We should rather only have the 2 methods `_minpoly_linbox_` and `_charpoly_linbox_`. There is not much duplicated code between these two, especially now after this clean-up.



---

archive/issue_comments_342147.json:
```json
{
    "body": "Reviewer: **Cl\u00e9ment Pernet**",
    "created_at": "2017-05-04T06:04:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342147",
    "user": "https://github.com/ClementPernet"
}
```

Reviewer: **Cl√©ment Pernet**



---

archive/issue_comments_342148.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@ClementPernet](#comment:10):\n> Great.\n\nThanks for having a look!\n\n> Let's start with a few remarks:\n> 1. Why do need the dependency on #22886 ? That ticket is stalled and is therefore also blocking this one.\n\nI think that Cython compilation fails otherwise (I am trying again right now on top of 8.0.beta4... will take some time since I need to recompile the whole Sage after playing with #22493).\n\n> 2. While we are changing a lot of stuff, I wouldn't mind getting rid of these ugly `poly_linbox` method, with a string parameter `typ` that determines whether to compute minpoly or charpoly. We should rather only have the 2 methods `_minpoly_linbox_` and `_charpoly_linbox_`. There is not much duplicated code between these two, especially now after this clean-up.\n\nThe ticket only intends to clean `matrix_integer_dense.pyx`. The two functions you mention are actually removed from `matrix/matrix_integer_dense.pyx` but kept in `libs/linbox/linbox_flint_interface.pyx` (but note that the argument there is an integer). I can get rid of the following function in the interface\n\n```\n# set p to the minpoly or the charpoly of A\ncdef inline void linbox_fmpz_mat_poly(fmpz_poly_t p, fmpz_mat_t A, int minpoly)\n```\nIs that what you want?",
    "created_at": "2017-05-04T06:44:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342148",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@ClementPernet](#comment:10):
> Great.

Thanks for having a look!

> Let's start with a few remarks:
> 1. Why do need the dependency on #22886 ? That ticket is stalled and is therefore also blocking this one.

I think that Cython compilation fails otherwise (I am trying again right now on top of 8.0.beta4... will take some time since I need to recompile the whole Sage after playing with #22493).

> 2. While we are changing a lot of stuff, I wouldn't mind getting rid of these ugly `poly_linbox` method, with a string parameter `typ` that determines whether to compute minpoly or charpoly. We should rather only have the 2 methods `_minpoly_linbox_` and `_charpoly_linbox_`. There is not much duplicated code between these two, especially now after this clean-up.

The ticket only intends to clean `matrix_integer_dense.pyx`. The two functions you mention are actually removed from `matrix/matrix_integer_dense.pyx` but kept in `libs/linbox/linbox_flint_interface.pyx` (but note that the argument there is an integer). I can get rid of the following function in the interface

```
# set p to the minpoly or the charpoly of A
cdef inline void linbox_fmpz_mat_poly(fmpz_poly_t p, fmpz_mat_t A, int minpoly)
```
Is that what you want?



---

archive/issue_comments_342149.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@videlec](#comment:12):\n>  I can get rid of the following function in the interface\n> \n> ```\n> # set p to the minpoly or the charpoly of A\n> cdef inline void linbox_fmpz_mat_poly(fmpz_poly_t p, fmpz_mat_t A, int minpoly)\n> ```\n> Is that what you want?\n\nOk sorry for the confusion. My remark indeed applies to the new `libs/linbox_flint_interface.pyx`.\nSure, it should definitely not be exposed through the new interface as it is an internal trick to factor out code. Then I also suggest to avoid this trick and simply write the two methods for the sake of clarity.",
    "created_at": "2017-05-04T07:09:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342149",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@videlec](#comment:12):
>  I can get rid of the following function in the interface
> 
> ```
> # set p to the minpoly or the charpoly of A
> cdef inline void linbox_fmpz_mat_poly(fmpz_poly_t p, fmpz_mat_t A, int minpoly)
> ```
> Is that what you want?

Ok sorry for the confusion. My remark indeed applies to the new `libs/linbox_flint_interface.pyx`.
Sure, it should definitely not be exposed through the new interface as it is an internal trick to factor out code. Then I also suggest to avoid this trick and simply write the two methods for the sake of clarity.



---

archive/issue_comments_342150.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55bdc0a6c1d6e24666329258df947875c7ee7d56\"><code>55bdc0a</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8b95de65ca3e430835af831040b68924d41bf3b\"><code>c8b95de</code></a></td><td><code>22924: remove (instead of deprecate) code from linbox.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fcafa60b4d7331fa832557ae1919df166d84b62c\"><code>fcafa60</code></a></td><td><code>22924: get rid of spies</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/637fd872a78a7aec0781998a281d4dbbbc0fd7af\"><code>637fd87</code></a></td><td><code>22924: cleaning in linbox_flint_interface.pyx</code></td></tr></table>\n",
    "created_at": "2017-05-04T07:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342150",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55bdc0a6c1d6e24666329258df947875c7ee7d56"><code>55bdc0a</code></a></td><td><code>Cleaning linbox interface of Matrix_integer_dense</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8b95de65ca3e430835af831040b68924d41bf3b"><code>c8b95de</code></a></td><td><code>22924: remove (instead of deprecate) code from linbox.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fcafa60b4d7331fa832557ae1919df166d84b62c"><code>fcafa60</code></a></td><td><code>22924: get rid of spies</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/637fd872a78a7aec0781998a281d4dbbbc0fd7af"><code>637fd87</code></a></td><td><code>22924: cleaning in linbox_flint_interface.pyx</code></td></tr></table>




---

archive/issue_comments_342151.json:
```json
{
    "body": "Changed commit from **[`69a140e`](https://github.com/sagemath/sagetrac-mirror/commit/69a140e1d299cc6971ad75e868dd9418083bbc0b)** to **[`637fd87`](https://github.com/sagemath/sagetrac-mirror/commit/637fd872a78a7aec0781998a281d4dbbbc0fd7af)**",
    "created_at": "2017-05-04T07:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342151",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`69a140e`](https://github.com/sagemath/sagetrac-mirror/commit/69a140e1d299cc6971ad75e868dd9418083bbc0b)** to **[`637fd87`](https://github.com/sagemath/sagetrac-mirror/commit/637fd872a78a7aec0781998a281d4dbbbc0fd7af)**



---

archive/issue_comments_342152.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nNo dependency on #22886 anymore (it is needed for cylinbox but it is fine for this ticket).\n\nI cleaned the flint interface a bit more than what you asked for.",
    "created_at": "2017-05-04T07:30:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342152",
    "user": "https://github.com/videlec"
}
```

<div id="comment:15" align="right">comment:15</div>

No dependency on #22886 anymore (it is needed for cylinbox but it is fine for this ticket).

I cleaned the flint interface a bit more than what you asked for.



---

archive/issue_comments_342153.json:
```json
{
    "body": "Changed dependencies from **#22886** to none",
    "created_at": "2017-05-04T07:30:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342153",
    "user": "https://github.com/videlec"
}
```

Changed dependencies from **#22886** to none



---

archive/issue_comments_342154.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI was wrong (and you were right). There is still `def _poly_linbox(self, typ, var='x'):` as a method of `Matrix_integer_dense`.",
    "created_at": "2017-05-04T07:39:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342154",
    "user": "https://github.com/videlec"
}
```

<div id="comment:16" align="right">comment:16</div>

I was wrong (and you were right). There is still `def _poly_linbox(self, typ, var='x'):` as a method of `Matrix_integer_dense`.



---

archive/issue_comments_342155.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nBy the way, I am adding tests and LinBox has trouble with the characteristic polynomial of the `0 x 0` matrix\n\n```\nsage: matrix([]).charpoly('y', 'linbox')\nTraceback (most recent call last):\n...\nMemoryError: failed to allocate 2305843008945258512 bytes\n```\nDoes it qualify as a bug? For now, I will add a special case in the interface LinBox/flint.\n\nEDIT: and it hangs forever for `minpoly`.",
    "created_at": "2017-05-04T08:00:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342155",
    "user": "https://github.com/videlec"
}
```

<div id="comment:17" align="right">comment:17</div>

By the way, I am adding tests and LinBox has trouble with the characteristic polynomial of the `0 x 0` matrix

```
sage: matrix([]).charpoly('y', 'linbox')
Traceback (most recent call last):
...
MemoryError: failed to allocate 2305843008945258512 bytes
```
Does it qualify as a bug? For now, I will add a special case in the interface LinBox/flint.

EDIT: and it hangs forever for `minpoly`.



---

archive/issue_comments_342156.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nFor `minpoly` it is written\n\n```\n        .. NOTE::\n\n           Linbox charpoly disabled on 64-bit machines, since it hangs\n           in many cases.\n```\nHowever, I do not see where this actually happens in the code. Do you know what this is?",
    "created_at": "2017-05-04T08:08:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342156",
    "user": "https://github.com/videlec"
}
```

<div id="comment:18" align="right">comment:18</div>

For `minpoly` it is written

```
        .. NOTE::

           Linbox charpoly disabled on 64-bit machines, since it hangs
           in many cases.
```
However, I do not see where this actually happens in the code. Do you know what this is?



---

archive/issue_comments_342157.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nUn petit timing\n\n```\nsage: m = random_matrix(ZZ, 50)\nsage: %timeit m._clear_cache(); p = m.charpoly(algorithm='linbox')\n100 loops, best of 3: 16.8 ms per loop\nsage: %timeit m._clear_cache(); p = m.charpoly(algorithm='flint')\n10 loops, best of 3: 44.2 ms per loop\nsage: %timeit m._clear_cache(); p = m.charpoly(algorithm='generic')\n10 loops, best of 3: 152 ms per loop\n```",
    "created_at": "2017-05-04T08:17:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342157",
    "user": "https://github.com/videlec"
}
```

<div id="comment:20" align="right">comment:20</div>

Un petit timing

```
sage: m = random_matrix(ZZ, 50)
sage: %timeit m._clear_cache(); p = m.charpoly(algorithm='linbox')
100 loops, best of 3: 16.8 ms per loop
sage: %timeit m._clear_cache(); p = m.charpoly(algorithm='flint')
10 loops, best of 3: 44.2 ms per loop
sage: %timeit m._clear_cache(); p = m.charpoly(algorithm='generic')
10 loops, best of 3: 152 ms per loop
```



---

archive/issue_comments_342158.json:
```json
{
    "body": "Changed commit from **[`637fd87`](https://github.com/sagemath/sagetrac-mirror/commit/637fd872a78a7aec0781998a281d4dbbbc0fd7af)** to **[`fde1353`](https://github.com/sagemath/sagetrac-mirror/commit/fde1353a5c22bd3ff3fe50c9df982264b30d505e)**",
    "created_at": "2017-05-04T08:18:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342158",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`637fd87`](https://github.com/sagemath/sagetrac-mirror/commit/637fd872a78a7aec0781998a281d4dbbbc0fd7af)** to **[`fde1353`](https://github.com/sagemath/sagetrac-mirror/commit/fde1353a5c22bd3ff3fe50c9df982264b30d505e)**



---

archive/issue_comments_342159.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fde1353a5c22bd3ff3fe50c9df982264b30d505e\"><code>fde1353</code></a></td><td><code>22924: clean minpoly/charpoly in Matrix_integer_dense</code></td></tr></table>\n",
    "created_at": "2017-05-04T08:18:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342159",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fde1353a5c22bd3ff3fe50c9df982264b30d505e"><code>fde1353</code></a></td><td><code>22924: clean minpoly/charpoly in Matrix_integer_dense</code></td></tr></table>




---

archive/issue_comments_342160.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAll right: `Matrix_integer_dense` cleaned and interface fixed on corner cases with commit `fde1353`.",
    "created_at": "2017-05-04T08:19:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342160",
    "user": "https://github.com/videlec"
}
```

<div id="comment:22" align="right">comment:22</div>

All right: `Matrix_integer_dense` cleaned and interface fixed on corner cases with commit `fde1353`.



---

archive/issue_comments_342161.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nAnd patchbot is happy (excepted some timeout I am not responsible for).",
    "created_at": "2017-05-04T09:37:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342161",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">comment:23</div>

And patchbot is happy (excepted some timeout I am not responsible for).



---

archive/issue_comments_342162.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@videlec](#comment:18):\n> For `minpoly` it is written\n> \n> ```\n>         .. NOTE::\n> \n>            Linbox charpoly disabled on 64-bit machines, since it hangs\n>            in many cases.\n> ```\n> However, I do not see where this actually happens in the code. Do you know what this is?\n\nIt's a super old comment. Some archeology on trac tickets should tell where it comes from but it's safe to remove it.",
    "created_at": "2017-05-09T14:44:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342162",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@videlec](#comment:18):
> For `minpoly` it is written
> 
> ```
>         .. NOTE::
> 
>            Linbox charpoly disabled on 64-bit machines, since it hangs
>            in many cases.
> ```
> However, I do not see where this actually happens in the code. Do you know what this is?

It's a super old comment. Some archeology on trac tickets should tell where it comes from but it's safe to remove it.



---

archive/issue_comments_342163.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThere are a couple of warnings that one could avoid:\n\n```\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:313:49: local variable 'res' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:389:46: local variable 'res' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:394:42: local variable 'res' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:398:42: local variable 'res' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:498:34: local variable 'g' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:532:32: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:534:16: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:562:30: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:564:16: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:717:33: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:736:33: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:756:35: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1110:39: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1127:39: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1150:39: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1167:39: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1184:39: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1217:35: local variable 'r' referenced before assignment\n[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1218:59: local variable 'r' referenced before assignment\n[\n```\nBasically, the variables are passed as \"out\" arguments, and cython complains that they are not initialized. It is safe to force their value to 0 at declaration (e.g. `int res = 0;`) and this would silence out the warning.",
    "created_at": "2017-05-09T14:47:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342163",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:25" align="right">comment:25</div>

There are a couple of warnings that one could avoid:

```
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:313:49: local variable 'res' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:389:46: local variable 'res' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:394:42: local variable 'res' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:398:42: local variable 'res' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:498:34: local variable 'g' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:532:32: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:534:16: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:562:30: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:564:16: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:717:33: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:736:33: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:756:35: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1110:39: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1127:39: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1150:39: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1167:39: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1184:39: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1217:35: local variable 'r' referenced before assignment
[sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:1218:59: local variable 'r' referenced before assignment
[
```
Basically, the variables are passed as "out" arguments, and cython complains that they are not initialized. It is safe to force their value to 0 at declaration (e.g. `int res = 0;`) and this would silence out the warning.



---

archive/issue_comments_342164.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@videlec](#comment:17):\n> By the way, I am adding tests and LinBox has trouble with the characteristic polynomial of the `0 x 0` matrix\n> \n> ```\n> sage: matrix([]).charpoly('y', 'linbox')\n> Traceback (most recent call last):\n> ...\n> MemoryError: failed to allocate 2305843008945258512 bytes\n> ```\n> Does it qualify as a bug? For now, I will add a special case in the interface LinBox/flint.\n> \n> EDIT: and it hangs forever for `minpoly`.\n\nThis is definitely a bug. Reported upstream: [https://github.com/linbox-team/linbox/issues/51](https://github.com/linbox-team/linbox/issues/51)",
    "created_at": "2017-05-09T14:52:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342164",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@videlec](#comment:17):
> By the way, I am adding tests and LinBox has trouble with the characteristic polynomial of the `0 x 0` matrix
> 
> ```
> sage: matrix([]).charpoly('y', 'linbox')
> Traceback (most recent call last):
> ...
> MemoryError: failed to allocate 2305843008945258512 bytes
> ```
> Does it qualify as a bug? For now, I will add a special case in the interface LinBox/flint.
> 
> EDIT: and it hangs forever for `minpoly`.

This is definitely a bug. Reported upstream: [https://github.com/linbox-team/linbox/issues/51](https://github.com/linbox-team/linbox/issues/51)



---

archive/issue_comments_342165.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nIn `linbox_flint_interface.pyx` lines 84 and 157, you seem to use the method `size` of `givvector` to get the degree of the corresponding polynomial. While this is very likely to be correct in the current code, the specification do not require that the size of the vector storing the polynomial is ajusted to its degree. One should rather use `Givaro::Poly1Dom::degree()` instead.",
    "created_at": "2017-05-09T15:36:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342165",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:27" align="right">comment:27</div>

In `linbox_flint_interface.pyx` lines 84 and 157, you seem to use the method `size` of `givvector` to get the degree of the corresponding polynomial. While this is very likely to be correct in the current code, the specification do not require that the size of the vector storing the polynomial is ajusted to its degree. One should rather use `Givaro::Poly1Dom::degree()` instead.



---

archive/issue_comments_342166.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@ClementPernet](#comment:25):\n> There are a couple of warnings that one could avoid:\n> \n> ```\n> [sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:313:49: local variable 'res' referenced before assignment\n> ...\n> ```\n> Basically, the variables are passed as \"out\" arguments, and cython complains that they are not initialized. It is safe to force their value to 0 at declaration (e.g. `int res = 0;`) and this would silence out the warning.\n\nYes, but these warnings have nothing to do with this ticket. Feel free to open another one to deal with `rings/finite_rings` (and put me in cc if you do).",
    "created_at": "2017-05-09T18:41:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342166",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@ClementPernet](#comment:25):
> There are a couple of warnings that one could avoid:
> 
> ```
> [sagelib-8.0.beta4] warning: sage/rings/finite_rings/element_givaro.pyx:313:49: local variable 'res' referenced before assignment
> ...
> ```
> Basically, the variables are passed as "out" arguments, and cython complains that they are not initialized. It is safe to force their value to 0 at declaration (e.g. `int res = 0;`) and this would silence out the warning.

Yes, but these warnings have nothing to do with this ticket. Feel free to open another one to deal with `rings/finite_rings` (and put me in cc if you do).



---

archive/issue_comments_342167.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@ClementPernet](#comment:27):\n> In `linbox_flint_interface.pyx` lines 84 and 157, you seem to use the method `size` of `givvector` to get the degree of the corresponding polynomial. While this is very likely to be correct in the current code, the specification do not require that the size of the vector storing the polynomial is ajusted to its degree. One should rather use `Givaro::Poly1Dom::degree()` instead.\n\nIn LinBox code there are two occurrences of `v.size()` in `examples/charpoly.C` for a `const Polynomial &v` (lines 47 and 57). Idem in `examples/minpoly.C` (line 36). Are these also wrong?\n\nHow am I supposed to use `degree`? I was able to do it 7 lines in Cython... it looks extremely complicated to get such elementary quantity.\n\n```\ncdef GivaroIntegerRing ZZ\ncdef GivaroDegree deg\ncdef LinBoxIntegerPolynomialRing * R\nR = new LinBoxIntegerPolynomialRing(ZZ)\nR.degree(deg, q)\ndel R\ncdef size_t length = deg.value() + 1\n```",
    "created_at": "2017-05-09T19:29:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342167",
    "user": "https://github.com/videlec"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@ClementPernet](#comment:27):
> In `linbox_flint_interface.pyx` lines 84 and 157, you seem to use the method `size` of `givvector` to get the degree of the corresponding polynomial. While this is very likely to be correct in the current code, the specification do not require that the size of the vector storing the polynomial is ajusted to its degree. One should rather use `Givaro::Poly1Dom::degree()` instead.

In LinBox code there are two occurrences of `v.size()` in `examples/charpoly.C` for a `const Polynomial &v` (lines 47 and 57). Idem in `examples/minpoly.C` (line 36). Are these also wrong?

How am I supposed to use `degree`? I was able to do it 7 lines in Cython... it looks extremely complicated to get such elementary quantity.

```
cdef GivaroIntegerRing ZZ
cdef GivaroDegree deg
cdef LinBoxIntegerPolynomialRing * R
R = new LinBoxIntegerPolynomialRing(ZZ)
R.degree(deg, q)
del R
cdef size_t length = deg.value() + 1
```



---

archive/issue_comments_342168.json:
```json
{
    "body": "Changed commit from **[`fde1353`](https://github.com/sagemath/sagetrac-mirror/commit/fde1353a5c22bd3ff3fe50c9df982264b30d505e)** to **[`6b45893`](https://github.com/sagemath/sagetrac-mirror/commit/6b45893cfec10b3bc20cc44a64233f66e0cf0d8a)**",
    "created_at": "2017-05-09T19:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342168",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fde1353`](https://github.com/sagemath/sagetrac-mirror/commit/fde1353a5c22bd3ff3fe50c9df982264b30d505e)** to **[`6b45893`](https://github.com/sagemath/sagetrac-mirror/commit/6b45893cfec10b3bc20cc44a64233f66e0cf0d8a)**



---

archive/issue_comments_342169.json:
```json
{
    "body": "<div id=\"comment:30\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a75ec910414f17772072ea13d57fb11117877c16\"><code>a75ec91</code></a></td><td><code>22924: better FIXME message</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6b45893cfec10b3bc20cc44a64233f66e0cf0d8a\"><code>6b45893</code></a></td><td><code>22924: compute length from degree</code></td></tr></table>\n",
    "created_at": "2017-05-09T19:37:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342169",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:30"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a75ec910414f17772072ea13d57fb11117877c16"><code>a75ec91</code></a></td><td><code>22924: better FIXME message</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6b45893cfec10b3bc20cc44a64233f66e0cf0d8a"><code>6b45893</code></a></td><td><code>22924: compute length from degree</code></td></tr></table>




---

archive/issue_comments_342170.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI implemented your remarks. Though, I do not think that `6b45893` is reasonable.",
    "created_at": "2017-05-09T19:38:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342170",
    "user": "https://github.com/videlec"
}
```

<div id="comment:31" align="right">comment:31</div>

I implemented your remarks. Though, I do not think that `6b45893` is reasonable.



---

archive/issue_comments_342171.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@videlec](#comment:31):\n> I implemented your remarks. Though, I do not think that `6b45893` is reasonable.\n\nOk this seems indeed quite tedious. After browsing through the current use of size() for degree in LinBox, I would say it's rather safe to assume that the vector has been resized and therefore that the `size` method would return the degree. I was probably being too pedantic, sorry. I suggest to drop `6b45893`.",
    "created_at": "2017-05-09T20:01:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342171",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@videlec](#comment:31):
> I implemented your remarks. Though, I do not think that `6b45893` is reasonable.

Ok this seems indeed quite tedious. After browsing through the current use of size() for degree in LinBox, I would say it's rather safe to assume that the vector has been resized and therefore that the `size` method would return the degree. I was probably being too pedantic, sorry. I suggest to drop `6b45893`.



---

archive/issue_comments_342172.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@videlec](#comment:28):\n> Yes, but these warnings have nothing to do with this ticket. Feel free to open another one to deal with `rings/finite_rings` (and put me in cc if you do).\n\nMy bad, I thought they were introduced in your new code. Will open a new ticket",
    "created_at": "2017-05-09T20:02:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342172",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@videlec](#comment:28):
> Yes, but these warnings have nothing to do with this ticket. Feel free to open another one to deal with `rings/finite_rings` (and put me in cc if you do).

My bad, I thought they were introduced in your new code. Will open a new ticket



---

archive/issue_comments_342173.json:
```json
{
    "body": "Changed commit from **[`6b45893`](https://github.com/sagemath/sagetrac-mirror/commit/6b45893cfec10b3bc20cc44a64233f66e0cf0d8a)** to **[`a75ec91`](https://github.com/sagemath/sagetrac-mirror/commit/a75ec910414f17772072ea13d57fb11117877c16)**",
    "created_at": "2017-05-09T20:11:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342173",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6b45893`](https://github.com/sagemath/sagetrac-mirror/commit/6b45893cfec10b3bc20cc44a64233f66e0cf0d8a)** to **[`a75ec91`](https://github.com/sagemath/sagetrac-mirror/commit/a75ec910414f17772072ea13d57fb11117877c16)**



---

archive/issue_comments_342174.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-05-09T20:11:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342174",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_342175.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nAlso, I see some new code not directly related to the subject of the ticket (e.g. in `_rational_kernel_flint`, `rational_kernel_iml`), but this is rather ok for me as it is documentation improvement on routines related to the ticket).",
    "created_at": "2017-05-09T20:12:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342175",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:35" align="right">comment:35</div>

Also, I see some new code not directly related to the subject of the ticket (e.g. in `_rational_kernel_flint`, `rational_kernel_iml`), but this is rather ok for me as it is documentation improvement on routines related to the ticket).



---

archive/issue_comments_342176.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@ClementPernet](#comment:32):\n> Replying to [@videlec](#comment:31):\n> > I implemented your remarks. Though, I do not think that `6b45893` is reasonable.\n\n> \n> Ok this seems indeed quite tedious. After browsing through the current use of size() for degree in LinBox, I would say it's rather safe to assume that the vector has been resized and therefore that the `size` method would return the degree. I was probably being too pedantic, sorry. I suggest to drop `6b45893`.\n\nI dropped it.\n\nIt would be fine for me to use `degree` however it is horribly complicated. Why is there a class `Degree` that is a trivial wrapper around a `int64_t`? Why could we not use `degree` directly as a method of a polynomial?",
    "created_at": "2017-05-09T20:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342176",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@ClementPernet](#comment:32):
> Replying to [@videlec](#comment:31):
> > I implemented your remarks. Though, I do not think that `6b45893` is reasonable.

> 
> Ok this seems indeed quite tedious. After browsing through the current use of size() for degree in LinBox, I would say it's rather safe to assume that the vector has been resized and therefore that the `size` method would return the degree. I was probably being too pedantic, sorry. I suggest to drop `6b45893`.

I dropped it.

It would be fine for me to use `degree` however it is horribly complicated. Why is there a class `Degree` that is a trivial wrapper around a `int64_t`? Why could we not use `degree` directly as a method of a polynomial?



---

archive/issue_comments_342177.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@ClementPernet](#comment:35):\n> Also, I see some new code not directly related to the subject of the ticket (e.g. in `_rational_kernel_flint`, `rational_kernel_iml`), but this is rather ok for me as it is documentation improvement on routines related to the ticket).\n\nIt is. `_rational_kernel_iml` now uses `fmpz_mat_to_mpz_array` that was introduced in the ticket.",
    "created_at": "2017-05-09T20:15:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342177",
    "user": "https://github.com/videlec"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@ClementPernet](#comment:35):
> Also, I see some new code not directly related to the subject of the ticket (e.g. in `_rational_kernel_flint`, `rational_kernel_iml`), but this is rather ok for me as it is documentation improvement on routines related to the ticket).

It is. `_rational_kernel_iml` now uses `fmpz_mat_to_mpz_array` that was introduced in the ticket.



---

archive/issue_comments_342178.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@videlec](#comment:28):\n> Feel free to open another one to deal with `rings/finite_rings` (and put me in cc if you do).\n\nDone in #22966.",
    "created_at": "2017-05-10T05:37:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342178",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@videlec](#comment:28):
> Feel free to open another one to deal with `rings/finite_rings` (and put me in cc if you do).

Done in #22966.



---

archive/issue_comments_342179.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nLet me try an explanation for this mess (which I agree should be simplified):\n\nReplying to [@videlec](#comment:36):\n> Why is there a class `Degree` that is a trivial wrapper around a `int64_t`? \n\nI would have said: so as to deal with the degree of the 0 polynomial which is -1 and not size()-1=0 \n\n> Why could we not use `degree` directly as a method of a polynomial?\n\nI assume because in Givaro (and the whole LinBox ecosystem), the container (here `givvector` does not know about the semantic). It is the domain of computation (here `GivPoly1Dom` who does).",
    "created_at": "2017-05-10T06:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342179",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:39" align="right">comment:39</div>

Let me try an explanation for this mess (which I agree should be simplified):

Replying to [@videlec](#comment:36):
> Why is there a class `Degree` that is a trivial wrapper around a `int64_t`? 

I would have said: so as to deal with the degree of the 0 polynomial which is -1 and not size()-1=0 

> Why could we not use `degree` directly as a method of a polynomial?

I assume because in Givaro (and the whole LinBox ecosystem), the container (here `givvector` does not know about the semantic). It is the domain of computation (here `GivPoly1Dom` who does).



---

archive/issue_comments_342180.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@ClementPernet](#comment:39):\n> Let me try an explanation for this mess (which I agree should be simplified):\n> \n> Replying to [@videlec](#comment:36):\n> > Why is there a class `Degree` that is a trivial wrapper around a `int64_t`? \n\n> I would have said: so as to deal with the degree of the 0 polynomial which is -1 and not size()-1=0 \n\nIn LinBox you have `size(0) = 1`!? Why would you store the zero at all?\n\n> > Why could we not use `degree` directly as a method of a polynomial?\n\n> \n> I assume because in Givaro (and the whole LinBox ecosystem), the container (here `givvector` does not know about the semantic). It is the domain of computation (here `GivPoly1Dom` who does).\n\nI see. This way is indeed more flexible.",
    "created_at": "2017-05-10T09:04:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342180",
    "user": "https://github.com/videlec"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@ClementPernet](#comment:39):
> Let me try an explanation for this mess (which I agree should be simplified):
> 
> Replying to [@videlec](#comment:36):
> > Why is there a class `Degree` that is a trivial wrapper around a `int64_t`? 

> I would have said: so as to deal with the degree of the 0 polynomial which is -1 and not size()-1=0 

In LinBox you have `size(0) = 1`!? Why would you store the zero at all?

> > Why could we not use `degree` directly as a method of a polynomial?

> 
> I assume because in Givaro (and the whole LinBox ecosystem), the container (here `givvector` does not know about the semantic). It is the domain of computation (here `GivPoly1Dom` who does).

I see. This way is indeed more flexible.



---

archive/issue_comments_342181.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nTell me if there are other improvements to be done on this ticket.",
    "created_at": "2017-05-10T09:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342181",
    "user": "https://github.com/videlec"
}
```

<div id="comment:41" align="right">comment:41</div>

Tell me if there are other improvements to be done on this ticket.



---

archive/issue_comments_342182.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@videlec](#comment:40):\n> > I would have said: so as to deal with the degree of the 0 polynomial which is -1 and not size()-1=0 \n\n> \n> In LinBox you have `size(0) = 1`!? Why would you store the zero at all?\n\nMy mistake. Givaro actually resizes the 0 polynomial to an empty vector, so `size-1` is always equal to the degree.\n\nAfter a discussion with J-G. Dumas on the topic here are a few clarifications:\n* the degree can be accessed in two ways: \n   1. either through `Poly1Dom<..>::degree which silently resize the vector when there are leading zeros.\n   2. direcrly by `P.size()-1`  when the programmer knows what she does and does not want to pay the price of a resize.\n\n So it's fine to do it with `size()-1` as in this ticket, since we know the polynomials handed by LinBox have correct size in this case.\n* The class `Degree` was meant to provide a distinct type than the int64_t returned by size, in order to avoid mixing both approaches. Still the class is not quite satisfactory for the moment (degree (0 + 0)=-2 != -1). This has been fixed upstream in [https://github.com/linbox-team/givaro/commit/756005d0be64c36513c57403b856d93fc43c8010](https://github.com/linbox-team/givaro/commit/756005d0be64c36513c57403b856d93fc43c8010)",
    "created_at": "2017-05-10T09:26:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342182",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@videlec](#comment:40):
> > I would have said: so as to deal with the degree of the 0 polynomial which is -1 and not size()-1=0 

> 
> In LinBox you have `size(0) = 1`!? Why would you store the zero at all?

My mistake. Givaro actually resizes the 0 polynomial to an empty vector, so `size-1` is always equal to the degree.

After a discussion with J-G. Dumas on the topic here are a few clarifications:
* the degree can be accessed in two ways: 
   1. either through `Poly1Dom<..>::degree which silently resize the vector when there are leading zeros.
   2. direcrly by `P.size()-1`  when the programmer knows what she does and does not want to pay the price of a resize.

 So it's fine to do it with `size()-1` as in this ticket, since we know the polynomials handed by LinBox have correct size in this case.
* The class `Degree` was meant to provide a distinct type than the int64_t returned by size, in order to avoid mixing both approaches. Still the class is not quite satisfactory for the moment (degree (0 + 0)=-2 != -1). This has been fixed upstream in [https://github.com/linbox-team/givaro/commit/756005d0be64c36513c57403b856d93fc43c8010](https://github.com/linbox-team/givaro/commit/756005d0be64c36513c57403b856d93fc43c8010)



---

archive/issue_events_319725.json:
```json
{
    "actor": "https://github.com/ClementPernet",
    "created_at": "2017-05-10T09:33:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319725"
}
```



---

archive/issue_events_319726.json:
```json
{
    "actor": "https://github.com/ClementPernet",
    "created_at": "2017-05-10T09:33:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319726"
}
```



---

archive/issue_comments_342183.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nOk, the ticket is now fine for me. -> positive review.",
    "created_at": "2017-05-10T09:33:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342183",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:43" align="right">comment:43</div>

Ok, the ticket is now fine for me. -> positive review.



---

archive/issue_events_319727.json:
```json
{
    "actor": "https://github.com/ClementPernet",
    "created_at": "2017-05-10T12:53:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319727"
}
```



---

archive/issue_events_319728.json:
```json
{
    "actor": "https://github.com/ClementPernet",
    "created_at": "2017-05-10T12:53:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319728"
}
```



---

archive/issue_comments_342184.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nSorry, two minor documentation typos to be fixed in `src/sage/libs/linbox/linbox_flint_interface.pyx`: \n* line 10 \"linbox-Sage.C\" -> \"linbox-sage.C\"\n* line 128 \"preformed\" -> \"performed\"\nBack in needs work.",
    "created_at": "2017-05-10T12:53:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342184",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:44" align="right">comment:44</div>

Sorry, two minor documentation typos to be fixed in `src/sage/libs/linbox/linbox_flint_interface.pyx`: 
* line 10 "linbox-Sage.C" -> "linbox-sage.C"
* line 128 "preformed" -> "performed"
Back in needs work.



---

archive/issue_comments_342185.json:
```json
{
    "body": "<div id=\"comment:45\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b082c2d7aac83d91253a450cd81e7accf13d76b\"><code>0b082c2</code></a></td><td><code>22924: typos</code></td></tr></table>\n",
    "created_at": "2017-05-11T06:33:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342185",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:45"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b082c2d7aac83d91253a450cd81e7accf13d76b"><code>0b082c2</code></a></td><td><code>22924: typos</code></td></tr></table>




---

archive/issue_comments_342186.json:
```json
{
    "body": "Changed commit from **[`a75ec91`](https://github.com/sagemath/sagetrac-mirror/commit/a75ec910414f17772072ea13d57fb11117877c16)** to **[`0b082c2`](https://github.com/sagemath/sagetrac-mirror/commit/0b082c2d7aac83d91253a450cd81e7accf13d76b)**",
    "created_at": "2017-05-11T06:33:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342186",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a75ec91`](https://github.com/sagemath/sagetrac-mirror/commit/a75ec910414f17772072ea13d57fb11117877c16)** to **[`0b082c2`](https://github.com/sagemath/sagetrac-mirror/commit/0b082c2d7aac83d91253a450cd81e7accf13d76b)**



---

archive/issue_events_319729.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-11T06:34:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319729"
}
```



---

archive/issue_events_319730.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-11T06:34:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319730"
}
```



---

archive/issue_comments_342187.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nFine then, back to positive review.",
    "created_at": "2017-05-11T07:02:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342187",
    "user": "https://github.com/ClementPernet"
}
```

<div id="comment:47" align="right">comment:47</div>

Fine then, back to positive review.



---

archive/issue_events_319731.json:
```json
{
    "actor": "https://github.com/ClementPernet",
    "created_at": "2017-05-11T07:02:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319731"
}
```



---

archive/issue_events_319732.json:
```json
{
    "actor": "https://github.com/ClementPernet",
    "created_at": "2017-05-11T07:02:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319732"
}
```



---

archive/issue_comments_342188.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nThanks for the review!",
    "created_at": "2017-05-11T09:37:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342188",
    "user": "https://github.com/videlec"
}
```

<div id="comment:48" align="right">comment:48</div>

Thanks for the review!



---

archive/issue_comments_342189.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/22924](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22924)** to **[`0b082c2`](https://github.com/sagemath/sagetrac-mirror/commit/0b082c2d7aac83d91253a450cd81e7accf13d76b)**",
    "created_at": "2017-05-14T08:20:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22924#issuecomment-342189",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vdelecroix/22924](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/22924)** to **[`0b082c2`](https://github.com/sagemath/sagetrac-mirror/commit/0b082c2d7aac83d91253a450cd81e7accf13d76b)**



---

archive/issue_events_319733.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-14T08:20:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319733"
}
```



---

archive/issue_events_319734.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a4c2335a8c7640bfe831d240549118296fee254f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-05-14T08:20:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22924",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22924#event-319734"
}
```
