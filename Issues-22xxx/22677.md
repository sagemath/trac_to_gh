# Issue 22677: Polybori segfaults when built with clang on OS X

archive/issues_022440.json:
```json
{
    "body": "Split from #12426. Doctest involving `polybori` segfault when everything is built with clang\n\n```\nsage -t --long --warn-long 62.3 src/sage/rings/polynomial/multi_polynomial_sequence.py\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_sequence.py\", line 106, in sage.rings.polynomial.multi_polynomial_sequence\nFailed example:\n    C[0].groebner_basis()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.polynomial.multi_polynomial_sequence[7]>\", line 1, in <module>\n        C[Integer(0)].groebner_basis()\n      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_sequence.py\", line 518, in groebner_basis\n        return self.ideal().groebner_basis(*args, **kwargs)\n      File \"sage/rings/polynomial/pbori.pyx\", line 5080, in sage.rings.polynomial.pbori.BooleanPolynomialIdeal.groebner_basis (/Users/fbissey/build/sage-clang/src/build/cythonized/sage/rings/polynomial/pbori.cpp:42498)\n        sig_on()\n      File \"src/cysignals/signals.pyx\", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)\n    SignalError: Segmentation fault\n    Killed due to segmentation fault\n```\nBacktrace\n\n```\nsage: F.eliminate_linear_variables() # everything vanishes ## line 1147 ##\n------------------------------------------------------------------------\n0   signals.so                          0x000000010589c5d1 print_backtrace + 65\n1   signals.so                          0x000000010589fc0c sigdie + 60\n2   signals.so                          0x000000010589fb7f cysigs_signal_handler + 351\n3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26\n4   ???                                 0x00000001052a9a00 0x0 + 4381645312\n5   pbori.so                            0x000000010f0257ef _ZN8polybori8groebner11linalg_stepERNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEENS_8BooleSetES8_bbPKc + 479\n6   pbori.so                            0x000000010f0252d3 _ZN8polybori8groebner14gauss_on_polysERKNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEE + 275\n7   pbori.so                            0x000000010f024fe0 _ZL58__pyx_pw_4sage_5rings_10polynomial_5pbori_39gauss_on_polysP7_objectS0_ + 192\n8   libpython2.7.dylib                  0x000000010514cfdc PyEval_EvalFrameEx + 29500\n9   libpython2.7.dylib                  0x0000000105151e02 fast_function + 338\n```\nSimilarly `sage/rings/polynomial/pbori.pyx`\n\n```\nAssertion failed: (result != map.end()), function get, file ../../groebner/include/polybori/groebner/PolyEntryIndices.h, line 115.\n------------------------------------------------------------------------\n0   signals.so                          0x000000010bc6a5d1 print_backtrace + 65\n1   signals.so                          0x000000010bc6dc0c sigdie + 60\n2   signals.so                          0x000000010bc6db5d cysigs_signal_handler + 317\n3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26\n4   ???                                 0x00007fd399cbd6a0 0x0 + 140546795099808\n5   libsystem_c.dylib                   0x00007fffd05f0420 abort + 129\n6   libsystem_c.dylib                   0x00007fffd05b7893 basename_r + 0\n7   libbrial_groebner.0.dylib           0x0000000115658737 _ZNK8polybori8groebner16PolyEntryIndices3getINSt3__13mapINS_13BooleExponentEiNS_13MapComparatorIS5_EENS3_9allocatorINS3_4pairIKS5_iEEEEEES5_EEiRKT_RKT0_NS1_7uncheckE + 551\n8   libbrial_groebner.0.dylib           0x00000001156584ff _ZNK8polybori8groebner16PolyEntryIndices3getINS1_7uncheckEEEiRKNS_13BooleExponentET_ + 47\n9   libbrial_groebner.0.dylib           0x00000001156584bd _ZNK8polybori8groebner16PolyEntryIndicesclINS_13BooleExponentEEEiRKT_ + 29\n10  libbrial_groebner.0.dylib           0x000000011561105c _ZNK8polybori8groebner15PolyEntryVector5indexINS_13BooleExponentEEEmRKT_ + 44\n11  libbrial_groebner.0.dylib           0x00000001156609ad _ZN8polybori8groebner15PolyEntryVectorclINS_13BooleExponentEEENS0_18PolyEntryReferenceERKT_ + 61\n12  libbrial_groebner.0.dylib           0x0000000115692ea7 _ZNK8polybori8groebner20SetAssociatedMinimalINS_13BooleExponentELb0EEclERKS2_ + 39\n13  libbrial_groebner.0.dylib           0x000000011569108a _ZN8polybori8groebner17ReductionStrategy28unmarkNonMinimalLeadingTermsENS_8BooleSetE + 186\n14  libbrial_groebner.0.dylib           0x0000000115690e16 _ZN8polybori8groebner17ReductionStrategy19setupSetsForElementERKNS0_9PolyEntryE + 262\n15  pbori.so                            0x00000001153af381 _ZL76__pyx_pw_4sage_5rings_10polynomial_5pbori_17ReductionStrategy_5add_generatorP7_objectS0_ + 177\n16  pbori.so                            0x000000011533967a _ZL25__Pyx_PyObject_CallOneArgP7_objectS0_ + 154\n17  pbori.so                            0x00000001153974b1 _ZL71__pyx_pw_4sage_5rings_10polynomial_5pbori_17BooleanPolynomial_129reduceP7_objectS0_ + 2289\n18  libpython2.7.dylib                  0x000000010b51bfdc PyEval_EvalFrameEx + 29500\n19  libpython2.7.dylib                  0x000000010b514927 PyEval_EvalCodeEx + 2119\n```\nfinally the failures in \n\n```\nsage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed\n```\nare consequences of segfaults above.\n\ntarball https://github.com/BRiAl/BRiAl/releases/download/0.8.7/brial-0.8.7.tar.bz2\n\n\nBranch/Commit: 382b25cc1c348d8503fdcaaf122499dc6b255c70\n\nUpstream: Fixed upstream, in a later stable release.\n\nReviewer: Fran\u00e7ois Bissey, Dima Pasechnik\n\nAuthor: Fran\u00e7ois Bissey, Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/22677\n\n",
    "closed_at": "2017-04-07T22:24:00Z",
    "created_at": "2017-03-24T06:59:15Z",
    "labels": [
        "component: porting",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Polybori segfaults when built with clang on OS X",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22677",
    "user": "https://github.com/kiwifb"
}
```
Split from #12426. Doctest involving `polybori` segfault when everything is built with clang

```
sage -t --long --warn-long 62.3 src/sage/rings/polynomial/multi_polynomial_sequence.py
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_sequence.py", line 106, in sage.rings.polynomial.multi_polynomial_sequence
Failed example:
    C[0].groebner_basis()
Exception raised:
    Traceback (most recent call last):
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.multi_polynomial_sequence[7]>", line 1, in <module>
        C[Integer(0)].groebner_basis()
      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_sequence.py", line 518, in groebner_basis
        return self.ideal().groebner_basis(*args, **kwargs)
      File "sage/rings/polynomial/pbori.pyx", line 5080, in sage.rings.polynomial.pbori.BooleanPolynomialIdeal.groebner_basis (/Users/fbissey/build/sage-clang/src/build/cythonized/sage/rings/polynomial/pbori.cpp:42498)
        sig_on()
      File "src/cysignals/signals.pyx", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)
    SignalError: Segmentation fault
    Killed due to segmentation fault
```
Backtrace

```
sage: F.eliminate_linear_variables() # everything vanishes ## line 1147 ##
------------------------------------------------------------------------
0   signals.so                          0x000000010589c5d1 print_backtrace + 65
1   signals.so                          0x000000010589fc0c sigdie + 60
2   signals.so                          0x000000010589fb7f cysigs_signal_handler + 351
3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26
4   ???                                 0x00000001052a9a00 0x0 + 4381645312
5   pbori.so                            0x000000010f0257ef _ZN8polybori8groebner11linalg_stepERNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEENS_8BooleSetES8_bbPKc + 479
6   pbori.so                            0x000000010f0252d3 _ZN8polybori8groebner14gauss_on_polysERKNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEE + 275
7   pbori.so                            0x000000010f024fe0 _ZL58__pyx_pw_4sage_5rings_10polynomial_5pbori_39gauss_on_polysP7_objectS0_ + 192
8   libpython2.7.dylib                  0x000000010514cfdc PyEval_EvalFrameEx + 29500
9   libpython2.7.dylib                  0x0000000105151e02 fast_function + 338
```
Similarly `sage/rings/polynomial/pbori.pyx`

```
Assertion failed: (result != map.end()), function get, file ../../groebner/include/polybori/groebner/PolyEntryIndices.h, line 115.
------------------------------------------------------------------------
0   signals.so                          0x000000010bc6a5d1 print_backtrace + 65
1   signals.so                          0x000000010bc6dc0c sigdie + 60
2   signals.so                          0x000000010bc6db5d cysigs_signal_handler + 317
3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26
4   ???                                 0x00007fd399cbd6a0 0x0 + 140546795099808
5   libsystem_c.dylib                   0x00007fffd05f0420 abort + 129
6   libsystem_c.dylib                   0x00007fffd05b7893 basename_r + 0
7   libbrial_groebner.0.dylib           0x0000000115658737 _ZNK8polybori8groebner16PolyEntryIndices3getINSt3__13mapINS_13BooleExponentEiNS_13MapComparatorIS5_EENS3_9allocatorINS3_4pairIKS5_iEEEEEES5_EEiRKT_RKT0_NS1_7uncheckE + 551
8   libbrial_groebner.0.dylib           0x00000001156584ff _ZNK8polybori8groebner16PolyEntryIndices3getINS1_7uncheckEEEiRKNS_13BooleExponentET_ + 47
9   libbrial_groebner.0.dylib           0x00000001156584bd _ZNK8polybori8groebner16PolyEntryIndicesclINS_13BooleExponentEEEiRKT_ + 29
10  libbrial_groebner.0.dylib           0x000000011561105c _ZNK8polybori8groebner15PolyEntryVector5indexINS_13BooleExponentEEEmRKT_ + 44
11  libbrial_groebner.0.dylib           0x00000001156609ad _ZN8polybori8groebner15PolyEntryVectorclINS_13BooleExponentEEENS0_18PolyEntryReferenceERKT_ + 61
12  libbrial_groebner.0.dylib           0x0000000115692ea7 _ZNK8polybori8groebner20SetAssociatedMinimalINS_13BooleExponentELb0EEclERKS2_ + 39
13  libbrial_groebner.0.dylib           0x000000011569108a _ZN8polybori8groebner17ReductionStrategy28unmarkNonMinimalLeadingTermsENS_8BooleSetE + 186
14  libbrial_groebner.0.dylib           0x0000000115690e16 _ZN8polybori8groebner17ReductionStrategy19setupSetsForElementERKNS0_9PolyEntryE + 262
15  pbori.so                            0x00000001153af381 _ZL76__pyx_pw_4sage_5rings_10polynomial_5pbori_17ReductionStrategy_5add_generatorP7_objectS0_ + 177
16  pbori.so                            0x000000011533967a _ZL25__Pyx_PyObject_CallOneArgP7_objectS0_ + 154
17  pbori.so                            0x00000001153974b1 _ZL71__pyx_pw_4sage_5rings_10polynomial_5pbori_17BooleanPolynomial_129reduceP7_objectS0_ + 2289
18  libpython2.7.dylib                  0x000000010b51bfdc PyEval_EvalFrameEx + 29500
19  libpython2.7.dylib                  0x000000010b514927 PyEval_EvalCodeEx + 2119
```
finally the failures in 

```
sage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed
```
are consequences of segfaults above.

tarball https://github.com/BRiAl/BRiAl/releases/download/0.8.7/brial-0.8.7.tar.bz2


Branch/Commit: 382b25cc1c348d8503fdcaaf122499dc6b255c70

Upstream: Fixed upstream, in a later stable release.

Reviewer: François Bissey, Dima Pasechnik

Author: François Bissey, Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/22677





---

archive/issue_comments_332772.json:
```json
{
    "body": "<a id='comment:1'></a>All the above are solved by upgrading `BRiAl` to git master. I'll prepare a release of `BRiAl`.",
    "created_at": "2017-03-24T08:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332772",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>All the above are solved by upgrading `BRiAl` to git master. I'll prepare a release of `BRiAl`.



---

archive/issue_comments_332773.json:
```json
{
    "body": "<a id='comment:2'></a>I need this for #22679 :-)\n\n---\nNew commits:",
    "created_at": "2017-03-29T23:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332773",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>I need this for #22679 :-)

---
New commits:



---

archive/issue_comments_332774.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -71,6 +71,9 @@\n ```\n are consequences of segfaults above.\n \n+tarball http://users.ox.ac.uk/~coml0531/sage/brial-0.8.6.tar.bz2\n+\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/22677\n``````\n",
    "created_at": "2017-03-29T23:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332774",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -71,6 +71,9 @@
 ```
 are consequences of segfaults above.
 
+tarball http://users.ox.ac.uk/~coml0531/sage/brial-0.8.6.tar.bz2
+
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/22677
``````




---

archive/issue_comments_332775.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-29T23:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332775",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_332776.json:
```json
{
    "body": "<a id='comment:4'></a>I know, sorry I cannot seem to move my ass to make a proper release. On it now.",
    "created_at": "2017-03-30T00:16:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332776",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>I know, sorry I cannot seem to move my ass to make a proper release. On it now.



---

archive/issue_comments_332777.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-30T00:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332777",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_332778.json:
```json
{
    "body": "<a id='comment:5'></a>Need to fix the checksum to the properly released tarball. I'll put it back in review once it is done.",
    "created_at": "2017-03-30T00:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332778",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'></a>Need to fix the checksum to the properly released tarball. I'll put it back in review once it is done.



---

archive/issue_comments_332779.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,77 @@\n+Split from #12426. Doctest involving `polybori` segfault when everything is built with clang\n+\n+```\n+sage -t --long --warn-long 62.3 src/sage/rings/polynomial/multi_polynomial_sequence.py\n+**********************************************************************\n+File \"src/sage/rings/polynomial/multi_polynomial_sequence.py\", line 106, in sage.rings.polynomial.multi_polynomial_sequence\n+Failed example:\n+    C[0].groebner_basis()\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.rings.polynomial.multi_polynomial_sequence[7]>\", line 1, in <module>\n+        C[Integer(0)].groebner_basis()\n+      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_sequence.py\", line 518, in groebner_basis\n+        return self.ideal().groebner_basis(*args, **kwargs)\n+      File \"sage/rings/polynomial/pbori.pyx\", line 5080, in sage.rings.polynomial.pbori.BooleanPolynomialIdeal.groebner_basis (/Users/fbissey/build/sage-clang/src/build/cythonized/sage/rings/polynomial/pbori.cpp:42498)\n+        sig_on()\n+      File \"src/cysignals/signals.pyx\", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)\n+    SignalError: Segmentation fault\n+    Killed due to segmentation fault\n+```\n+Backtrace\n+\n+```\n+sage: F.eliminate_linear_variables() # everything vanishes ## line 1147 ##\n+------------------------------------------------------------------------\n+0   signals.so                          0x000000010589c5d1 print_backtrace + 65\n+1   signals.so                          0x000000010589fc0c sigdie + 60\n+2   signals.so                          0x000000010589fb7f cysigs_signal_handler + 351\n+3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26\n+4   ???                                 0x00000001052a9a00 0x0 + 4381645312\n+5   pbori.so                            0x000000010f0257ef _ZN8polybori8groebner11linalg_stepERNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEENS_8BooleSetES8_bbPKc + 479\n+6   pbori.so                            0x000000010f0252d3 _ZN8polybori8groebner14gauss_on_polysERKNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEE + 275\n+7   pbori.so                            0x000000010f024fe0 _ZL58__pyx_pw_4sage_5rings_10polynomial_5pbori_39gauss_on_polysP7_objectS0_ + 192\n+8   libpython2.7.dylib                  0x000000010514cfdc PyEval_EvalFrameEx + 29500\n+9   libpython2.7.dylib                  0x0000000105151e02 fast_function + 338\n+```\n+Similarly `sage/rings/polynomial/pbori.pyx`\n+\n+```\n+Assertion failed: (result != map.end()), function get, file ../../groebner/include/polybori/groebner/PolyEntryIndices.h, line 115.\n+------------------------------------------------------------------------\n+0   signals.so                          0x000000010bc6a5d1 print_backtrace + 65\n+1   signals.so                          0x000000010bc6dc0c sigdie + 60\n+2   signals.so                          0x000000010bc6db5d cysigs_signal_handler + 317\n+3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26\n+4   ???                                 0x00007fd399cbd6a0 0x0 + 140546795099808\n+5   libsystem_c.dylib                   0x00007fffd05f0420 abort + 129\n+6   libsystem_c.dylib                   0x00007fffd05b7893 basename_r + 0\n+7   libbrial_groebner.0.dylib           0x0000000115658737 _ZNK8polybori8groebner16PolyEntryIndices3getINSt3__13mapINS_13BooleExponentEiNS_13MapComparatorIS5_EENS3_9allocatorINS3_4pairIKS5_iEEEEEES5_EEiRKT_RKT0_NS1_7uncheckE + 551\n+8   libbrial_groebner.0.dylib           0x00000001156584ff _ZNK8polybori8groebner16PolyEntryIndices3getINS1_7uncheckEEEiRKNS_13BooleExponentET_ + 47\n+9   libbrial_groebner.0.dylib           0x00000001156584bd _ZNK8polybori8groebner16PolyEntryIndicesclINS_13BooleExponentEEEiRKT_ + 29\n+10  libbrial_groebner.0.dylib           0x000000011561105c _ZNK8polybori8groebner15PolyEntryVector5indexINS_13BooleExponentEEEmRKT_ + 44\n+11  libbrial_groebner.0.dylib           0x00000001156609ad _ZN8polybori8groebner15PolyEntryVectorclINS_13BooleExponentEEENS0_18PolyEntryReferenceERKT_ + 61\n+12  libbrial_groebner.0.dylib           0x0000000115692ea7 _ZNK8polybori8groebner20SetAssociatedMinimalINS_13BooleExponentELb0EEclERKS2_ + 39\n+13  libbrial_groebner.0.dylib           0x000000011569108a _ZN8polybori8groebner17ReductionStrategy28unmarkNonMinimalLeadingTermsENS_8BooleSetE + 186\n+14  libbrial_groebner.0.dylib           0x0000000115690e16 _ZN8polybori8groebner17ReductionStrategy19setupSetsForElementERKNS0_9PolyEntryE + 262\n+15  pbori.so                            0x00000001153af381 _ZL76__pyx_pw_4sage_5rings_10polynomial_5pbori_17ReductionStrategy_5add_generatorP7_objectS0_ + 177\n+16  pbori.so                            0x000000011533967a _ZL25__Pyx_PyObject_CallOneArgP7_objectS0_ + 154\n+17  pbori.so                            0x00000001153974b1 _ZL71__pyx_pw_4sage_5rings_10polynomial_5pbori_17BooleanPolynomial_129reduceP7_objectS0_ + 2289\n+18  libpython2.7.dylib                  0x000000010b51bfdc PyEval_EvalFrameEx + 29500\n+19  libpython2.7.dylib                  0x000000010b514927 PyEval_EvalCodeEx + 2119\n+```\n+finally the failures in \n+\n+```\n+sage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed\n+```\n+are consequences of segfaults above.\n+\n+tarball https://github.com/BRiAl/BRiAl/releases/download/0.8.6/brial-0.8.6.tar.bz2\n \n \n Comment: 1\n``````\n",
    "created_at": "2017-03-30T00:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332779",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,77 @@
+Split from #12426. Doctest involving `polybori` segfault when everything is built with clang
+
+```
+sage -t --long --warn-long 62.3 src/sage/rings/polynomial/multi_polynomial_sequence.py
+**********************************************************************
+File "src/sage/rings/polynomial/multi_polynomial_sequence.py", line 106, in sage.rings.polynomial.multi_polynomial_sequence
+Failed example:
+    C[0].groebner_basis()
+Exception raised:
+    Traceback (most recent call last):
+      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.rings.polynomial.multi_polynomial_sequence[7]>", line 1, in <module>
+        C[Integer(0)].groebner_basis()
+      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_sequence.py", line 518, in groebner_basis
+        return self.ideal().groebner_basis(*args, **kwargs)
+      File "sage/rings/polynomial/pbori.pyx", line 5080, in sage.rings.polynomial.pbori.BooleanPolynomialIdeal.groebner_basis (/Users/fbissey/build/sage-clang/src/build/cythonized/sage/rings/polynomial/pbori.cpp:42498)
+        sig_on()
+      File "src/cysignals/signals.pyx", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)
+    SignalError: Segmentation fault
+    Killed due to segmentation fault
+```
+Backtrace
+
+```
+sage: F.eliminate_linear_variables() # everything vanishes ## line 1147 ##
+------------------------------------------------------------------------
+0   signals.so                          0x000000010589c5d1 print_backtrace + 65
+1   signals.so                          0x000000010589fc0c sigdie + 60
+2   signals.so                          0x000000010589fb7f cysigs_signal_handler + 351
+3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26
+4   ???                                 0x00000001052a9a00 0x0 + 4381645312
+5   pbori.so                            0x000000010f0257ef _ZN8polybori8groebner11linalg_stepERNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEENS_8BooleSetES8_bbPKc + 479
+6   pbori.so                            0x000000010f0252d3 _ZN8polybori8groebner14gauss_on_polysERKNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEE + 275
+7   pbori.so                            0x000000010f024fe0 _ZL58__pyx_pw_4sage_5rings_10polynomial_5pbori_39gauss_on_polysP7_objectS0_ + 192
+8   libpython2.7.dylib                  0x000000010514cfdc PyEval_EvalFrameEx + 29500
+9   libpython2.7.dylib                  0x0000000105151e02 fast_function + 338
+```
+Similarly `sage/rings/polynomial/pbori.pyx`
+
+```
+Assertion failed: (result != map.end()), function get, file ../../groebner/include/polybori/groebner/PolyEntryIndices.h, line 115.
+------------------------------------------------------------------------
+0   signals.so                          0x000000010bc6a5d1 print_backtrace + 65
+1   signals.so                          0x000000010bc6dc0c sigdie + 60
+2   signals.so                          0x000000010bc6db5d cysigs_signal_handler + 317
+3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26
+4   ???                                 0x00007fd399cbd6a0 0x0 + 140546795099808
+5   libsystem_c.dylib                   0x00007fffd05f0420 abort + 129
+6   libsystem_c.dylib                   0x00007fffd05b7893 basename_r + 0
+7   libbrial_groebner.0.dylib           0x0000000115658737 _ZNK8polybori8groebner16PolyEntryIndices3getINSt3__13mapINS_13BooleExponentEiNS_13MapComparatorIS5_EENS3_9allocatorINS3_4pairIKS5_iEEEEEES5_EEiRKT_RKT0_NS1_7uncheckE + 551
+8   libbrial_groebner.0.dylib           0x00000001156584ff _ZNK8polybori8groebner16PolyEntryIndices3getINS1_7uncheckEEEiRKNS_13BooleExponentET_ + 47
+9   libbrial_groebner.0.dylib           0x00000001156584bd _ZNK8polybori8groebner16PolyEntryIndicesclINS_13BooleExponentEEEiRKT_ + 29
+10  libbrial_groebner.0.dylib           0x000000011561105c _ZNK8polybori8groebner15PolyEntryVector5indexINS_13BooleExponentEEEmRKT_ + 44
+11  libbrial_groebner.0.dylib           0x00000001156609ad _ZN8polybori8groebner15PolyEntryVectorclINS_13BooleExponentEEENS0_18PolyEntryReferenceERKT_ + 61
+12  libbrial_groebner.0.dylib           0x0000000115692ea7 _ZNK8polybori8groebner20SetAssociatedMinimalINS_13BooleExponentELb0EEclERKS2_ + 39
+13  libbrial_groebner.0.dylib           0x000000011569108a _ZN8polybori8groebner17ReductionStrategy28unmarkNonMinimalLeadingTermsENS_8BooleSetE + 186
+14  libbrial_groebner.0.dylib           0x0000000115690e16 _ZN8polybori8groebner17ReductionStrategy19setupSetsForElementERKNS0_9PolyEntryE + 262
+15  pbori.so                            0x00000001153af381 _ZL76__pyx_pw_4sage_5rings_10polynomial_5pbori_17ReductionStrategy_5add_generatorP7_objectS0_ + 177
+16  pbori.so                            0x000000011533967a _ZL25__Pyx_PyObject_CallOneArgP7_objectS0_ + 154
+17  pbori.so                            0x00000001153974b1 _ZL71__pyx_pw_4sage_5rings_10polynomial_5pbori_17BooleanPolynomial_129reduceP7_objectS0_ + 2289
+18  libpython2.7.dylib                  0x000000010b51bfdc PyEval_EvalFrameEx + 29500
+19  libpython2.7.dylib                  0x000000010b514927 PyEval_EvalCodeEx + 2119
+```
+finally the failures in 
+
+```
+sage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed
+```
+are consequences of segfaults above.
+
+tarball https://github.com/BRiAl/BRiAl/releases/download/0.8.6/brial-0.8.6.tar.bz2
 
 
 Comment: 1
``````




---

archive/issue_comments_332780.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-30T01:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332780",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_332781.json:
```json
{
    "body": "<a id='comment:6'></a>I'll put it in positive review but can you double check that the new tarball works for you.\n\n---\nNew commits:",
    "created_at": "2017-03-30T01:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332781",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>I'll put it in positive review but can you double check that the new tarball works for you.

---
New commits:



---

archive/issue_comments_332782.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-30T13:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332782",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_332783.json:
```json
{
    "body": "<a id='comment:7'></a>ironically, it does not work on gentoo Lunix with gcc 5.4.0.\n\n```\nsage -t --long --warn-long 118.6 src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault\n```\nand two more brial-related errors.\nWhile numerous\n\n```\nwarning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n``` \nare probably OK, \n\n```\n[sagelib-7.6] In file included from /home/dima/Sage/sage-dev/src/sage/libs/polybori/pb_wrap.h:22:0,\n from /home/dima/Sage/sage-dev/src/build/cythonized/sage/rings/polynomial/pbori.cpp:517:\n/home/dima/Sage/sage-dev/src/sage/ext/ccobject.h: In instantiation of \u2018void Delete(T*) [with T = polybori::groebner::ReductionStrategy]\u2019:\n /home/dima/Sage/sage-dev/src/build/cythonized/sage/rings/polynomial/pbori.cpp:50398:51:   required from here\n /home/dima/Sage/sage-dev/src/sage/ext/ccobject.h:77:3: warning: \ndeleting object of polymorphic class type \u2018polybori::groebner::ReductionStrategy\u2019 \nwhich has non-virtual destructor might cause undefined behaviour [-Wdelete-non-virtual-dtor]\n   delete mem;\n   ^\n```\nmight spell trouble.\nIt could also be that we must switch to gcc 6. Can you check in what Linux configuration this works for you?\n\n(meahwhile I'll do distclean and a full rebuild, just to see if this still persists)",
    "created_at": "2017-03-30T13:12:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332783",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>ironically, it does not work on gentoo Lunix with gcc 5.4.0.

```
sage -t --long --warn-long 118.6 src/sage/rings/polynomial/multi_polynomial_sequence.py  # Killed due to segmentation fault
```
and two more brial-related errors.
While numerous

```
warning: comparison between signed and unsigned integer expressions [-Wsign-compare]
``` 
are probably OK, 

```
[sagelib-7.6] In file included from /home/dima/Sage/sage-dev/src/sage/libs/polybori/pb_wrap.h:22:0,
 from /home/dima/Sage/sage-dev/src/build/cythonized/sage/rings/polynomial/pbori.cpp:517:
/home/dima/Sage/sage-dev/src/sage/ext/ccobject.h: In instantiation of ‘void Delete(T*) [with T = polybori::groebner::ReductionStrategy]’:
 /home/dima/Sage/sage-dev/src/build/cythonized/sage/rings/polynomial/pbori.cpp:50398:51:   required from here
 /home/dima/Sage/sage-dev/src/sage/ext/ccobject.h:77:3: warning: 
deleting object of polymorphic class type ‘polybori::groebner::ReductionStrategy’ 
which has non-virtual destructor might cause undefined behaviour [-Wdelete-non-virtual-dtor]
   delete mem;
   ^
```
might spell trouble.
It could also be that we must switch to gcc 6. Can you check in what Linux configuration this works for you?

(meahwhile I'll do distclean and a full rebuild, just to see if this still persists)



---

archive/issue_comments_332784.json:
```json
{
    "body": "<a id='comment:8'></a>I confirm, it breaks things here too with gcc-5.4.0. I think it may be down to https://github.com/BRiAl/BRiAl/issues/11#issuecomment-269957098 I'll have to check on that.",
    "created_at": "2017-03-30T19:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332784",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>I confirm, it breaks things here too with gcc-5.4.0. I think it may be down to https://github.com/BRiAl/BRiAl/issues/11#issuecomment-269957098 I'll have to check on that.



---

archive/issue_comments_332785.json:
```json
{
    "body": "<a id='comment:9'></a>I'll have a look at how it plays together with #22554 (which isn't in this branch yet).",
    "created_at": "2017-03-30T19:37:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332785",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>I'll have a look at how it plays together with #22554 (which isn't in this branch yet).



---

archive/issue_comments_332786.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 dimpase]:\n> I'll have a look at how it plays together with #22554 (which isn't in this branch yet).\n\n\nno, it does not help.",
    "created_at": "2017-03-31T00:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332786",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>Replying to [comment:9 dimpase]:
> I'll have a look at how it plays together with #22554 (which isn't in this branch yet).


no, it does not help.



---

archive/issue_comments_332787.json:
```json
{
    "body": "<a id='comment:11'></a>OK I have a fix. I cut a bit too much stuff. Actually adding one character would have been sufficient to fix gcc-6 compilation. It is still worth cleaning some stuff that wouldn't work anyway. I am not sure when I will have time to push the fix, I am rather busy this week end.",
    "created_at": "2017-03-31T11:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332787",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>OK I have a fix. I cut a bit too much stuff. Actually adding one character would have been sufficient to fix gcc-6 compilation. It is still worth cleaning some stuff that wouldn't work anyway. I am not sure when I will have time to push the fix, I am rather busy this week end.



---

archive/issue_comments_332788.json:
```json
{
    "body": "<a id='comment:12'></a>`brial-0.8.7` (now linked to in the ticket description) should work for all reasonably recent compilers. I am not sure about keeping `-std=c++98` in `CXXFLAGS` as it could cause problem in the near future I think. I haven't updated the branch yet, feel free to beat me to it.",
    "created_at": "2017-04-03T02:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332788",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:12'></a>`brial-0.8.7` (now linked to in the ticket description) should work for all reasonably recent compilers. I am not sure about keeping `-std=c++98` in `CXXFLAGS` as it could cause problem in the near future I think. I haven't updated the branch yet, feel free to beat me to it.



---

archive/issue_comments_332789.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,77 @@\n+Split from #12426. Doctest involving `polybori` segfault when everything is built with clang\n+\n+```\n+sage -t --long --warn-long 62.3 src/sage/rings/polynomial/multi_polynomial_sequence.py\n+**********************************************************************\n+File \"src/sage/rings/polynomial/multi_polynomial_sequence.py\", line 106, in sage.rings.polynomial.multi_polynomial_sequence\n+Failed example:\n+    C[0].groebner_basis()\n+Exception raised:\n+    Traceback (most recent call last):\n+      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n+        self.compile_and_execute(example, compiler, test.globs)\n+      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n+        exec(compiled, globs)\n+      File \"<doctest sage.rings.polynomial.multi_polynomial_sequence[7]>\", line 1, in <module>\n+        C[Integer(0)].groebner_basis()\n+      File \"/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_sequence.py\", line 518, in groebner_basis\n+        return self.ideal().groebner_basis(*args, **kwargs)\n+      File \"sage/rings/polynomial/pbori.pyx\", line 5080, in sage.rings.polynomial.pbori.BooleanPolynomialIdeal.groebner_basis (/Users/fbissey/build/sage-clang/src/build/cythonized/sage/rings/polynomial/pbori.cpp:42498)\n+        sig_on()\n+      File \"src/cysignals/signals.pyx\", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)\n+    SignalError: Segmentation fault\n+    Killed due to segmentation fault\n+```\n+Backtrace\n+\n+```\n+sage: F.eliminate_linear_variables() # everything vanishes ## line 1147 ##\n+------------------------------------------------------------------------\n+0   signals.so                          0x000000010589c5d1 print_backtrace + 65\n+1   signals.so                          0x000000010589fc0c sigdie + 60\n+2   signals.so                          0x000000010589fb7f cysigs_signal_handler + 351\n+3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26\n+4   ???                                 0x00000001052a9a00 0x0 + 4381645312\n+5   pbori.so                            0x000000010f0257ef _ZN8polybori8groebner11linalg_stepERNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEENS_8BooleSetES8_bbPKc + 479\n+6   pbori.so                            0x000000010f0252d3 _ZN8polybori8groebner14gauss_on_polysERKNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEE + 275\n+7   pbori.so                            0x000000010f024fe0 _ZL58__pyx_pw_4sage_5rings_10polynomial_5pbori_39gauss_on_polysP7_objectS0_ + 192\n+8   libpython2.7.dylib                  0x000000010514cfdc PyEval_EvalFrameEx + 29500\n+9   libpython2.7.dylib                  0x0000000105151e02 fast_function + 338\n+```\n+Similarly `sage/rings/polynomial/pbori.pyx`\n+\n+```\n+Assertion failed: (result != map.end()), function get, file ../../groebner/include/polybori/groebner/PolyEntryIndices.h, line 115.\n+------------------------------------------------------------------------\n+0   signals.so                          0x000000010bc6a5d1 print_backtrace + 65\n+1   signals.so                          0x000000010bc6dc0c sigdie + 60\n+2   signals.so                          0x000000010bc6db5d cysigs_signal_handler + 317\n+3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26\n+4   ???                                 0x00007fd399cbd6a0 0x0 + 140546795099808\n+5   libsystem_c.dylib                   0x00007fffd05f0420 abort + 129\n+6   libsystem_c.dylib                   0x00007fffd05b7893 basename_r + 0\n+7   libbrial_groebner.0.dylib           0x0000000115658737 _ZNK8polybori8groebner16PolyEntryIndices3getINSt3__13mapINS_13BooleExponentEiNS_13MapComparatorIS5_EENS3_9allocatorINS3_4pairIKS5_iEEEEEES5_EEiRKT_RKT0_NS1_7uncheckE + 551\n+8   libbrial_groebner.0.dylib           0x00000001156584ff _ZNK8polybori8groebner16PolyEntryIndices3getINS1_7uncheckEEEiRKNS_13BooleExponentET_ + 47\n+9   libbrial_groebner.0.dylib           0x00000001156584bd _ZNK8polybori8groebner16PolyEntryIndicesclINS_13BooleExponentEEEiRKT_ + 29\n+10  libbrial_groebner.0.dylib           0x000000011561105c _ZNK8polybori8groebner15PolyEntryVector5indexINS_13BooleExponentEEEmRKT_ + 44\n+11  libbrial_groebner.0.dylib           0x00000001156609ad _ZN8polybori8groebner15PolyEntryVectorclINS_13BooleExponentEEENS0_18PolyEntryReferenceERKT_ + 61\n+12  libbrial_groebner.0.dylib           0x0000000115692ea7 _ZNK8polybori8groebner20SetAssociatedMinimalINS_13BooleExponentELb0EEclERKS2_ + 39\n+13  libbrial_groebner.0.dylib           0x000000011569108a _ZN8polybori8groebner17ReductionStrategy28unmarkNonMinimalLeadingTermsENS_8BooleSetE + 186\n+14  libbrial_groebner.0.dylib           0x0000000115690e16 _ZN8polybori8groebner17ReductionStrategy19setupSetsForElementERKNS0_9PolyEntryE + 262\n+15  pbori.so                            0x00000001153af381 _ZL76__pyx_pw_4sage_5rings_10polynomial_5pbori_17ReductionStrategy_5add_generatorP7_objectS0_ + 177\n+16  pbori.so                            0x000000011533967a _ZL25__Pyx_PyObject_CallOneArgP7_objectS0_ + 154\n+17  pbori.so                            0x00000001153974b1 _ZL71__pyx_pw_4sage_5rings_10polynomial_5pbori_17BooleanPolynomial_129reduceP7_objectS0_ + 2289\n+18  libpython2.7.dylib                  0x000000010b51bfdc PyEval_EvalFrameEx + 29500\n+19  libpython2.7.dylib                  0x000000010b514927 PyEval_EvalCodeEx + 2119\n+```\n+finally the failures in \n+\n+```\n+sage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed\n+```\n+are consequences of segfaults above.\n+\n+tarball https://github.com/BRiAl/BRiAl/releases/download/0.8.7/brial-0.8.7.tar.bz2\n \n \n Comment: 1\n``````\n",
    "created_at": "2017-04-03T02:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332789",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,77 @@
+Split from #12426. Doctest involving `polybori` segfault when everything is built with clang
+
+```
+sage -t --long --warn-long 62.3 src/sage/rings/polynomial/multi_polynomial_sequence.py
+**********************************************************************
+File "src/sage/rings/polynomial/multi_polynomial_sequence.py", line 106, in sage.rings.polynomial.multi_polynomial_sequence
+Failed example:
+    C[0].groebner_basis()
+Exception raised:
+    Traceback (most recent call last):
+      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
+        self.compile_and_execute(example, compiler, test.globs)
+      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
+        exec(compiled, globs)
+      File "<doctest sage.rings.polynomial.multi_polynomial_sequence[7]>", line 1, in <module>
+        C[Integer(0)].groebner_basis()
+      File "/Users/fbissey/build/sage-clang/local/lib/python2.7/site-packages/sage/rings/polynomial/multi_polynomial_sequence.py", line 518, in groebner_basis
+        return self.ideal().groebner_basis(*args, **kwargs)
+      File "sage/rings/polynomial/pbori.pyx", line 5080, in sage.rings.polynomial.pbori.BooleanPolynomialIdeal.groebner_basis (/Users/fbissey/build/sage-clang/src/build/cythonized/sage/rings/polynomial/pbori.cpp:42498)
+        sig_on()
+      File "src/cysignals/signals.pyx", line 109, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1695)
+    SignalError: Segmentation fault
+    Killed due to segmentation fault
+```
+Backtrace
+
+```
+sage: F.eliminate_linear_variables() # everything vanishes ## line 1147 ##
+------------------------------------------------------------------------
+0   signals.so                          0x000000010589c5d1 print_backtrace + 65
+1   signals.so                          0x000000010589fc0c sigdie + 60
+2   signals.so                          0x000000010589fb7f cysigs_signal_handler + 351
+3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26
+4   ???                                 0x00000001052a9a00 0x0 + 4381645312
+5   pbori.so                            0x000000010f0257ef _ZN8polybori8groebner11linalg_stepERNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEENS_8BooleSetES8_bbPKc + 479
+6   pbori.so                            0x000000010f0252d3 _ZN8polybori8groebner14gauss_on_polysERKNSt3__16vectorINS_15BoolePolynomialENS1_9allocatorIS3_EEEE + 275
+7   pbori.so                            0x000000010f024fe0 _ZL58__pyx_pw_4sage_5rings_10polynomial_5pbori_39gauss_on_polysP7_objectS0_ + 192
+8   libpython2.7.dylib                  0x000000010514cfdc PyEval_EvalFrameEx + 29500
+9   libpython2.7.dylib                  0x0000000105151e02 fast_function + 338
+```
+Similarly `sage/rings/polynomial/pbori.pyx`
+
+```
+Assertion failed: (result != map.end()), function get, file ../../groebner/include/polybori/groebner/PolyEntryIndices.h, line 115.
+------------------------------------------------------------------------
+0   signals.so                          0x000000010bc6a5d1 print_backtrace + 65
+1   signals.so                          0x000000010bc6dc0c sigdie + 60
+2   signals.so                          0x000000010bc6db5d cysigs_signal_handler + 317
+3   libsystem_platform.dylib            0x00007fffd0769bba _sigtramp + 26
+4   ???                                 0x00007fd399cbd6a0 0x0 + 140546795099808
+5   libsystem_c.dylib                   0x00007fffd05f0420 abort + 129
+6   libsystem_c.dylib                   0x00007fffd05b7893 basename_r + 0
+7   libbrial_groebner.0.dylib           0x0000000115658737 _ZNK8polybori8groebner16PolyEntryIndices3getINSt3__13mapINS_13BooleExponentEiNS_13MapComparatorIS5_EENS3_9allocatorINS3_4pairIKS5_iEEEEEES5_EEiRKT_RKT0_NS1_7uncheckE + 551
+8   libbrial_groebner.0.dylib           0x00000001156584ff _ZNK8polybori8groebner16PolyEntryIndices3getINS1_7uncheckEEEiRKNS_13BooleExponentET_ + 47
+9   libbrial_groebner.0.dylib           0x00000001156584bd _ZNK8polybori8groebner16PolyEntryIndicesclINS_13BooleExponentEEEiRKT_ + 29
+10  libbrial_groebner.0.dylib           0x000000011561105c _ZNK8polybori8groebner15PolyEntryVector5indexINS_13BooleExponentEEEmRKT_ + 44
+11  libbrial_groebner.0.dylib           0x00000001156609ad _ZN8polybori8groebner15PolyEntryVectorclINS_13BooleExponentEEENS0_18PolyEntryReferenceERKT_ + 61
+12  libbrial_groebner.0.dylib           0x0000000115692ea7 _ZNK8polybori8groebner20SetAssociatedMinimalINS_13BooleExponentELb0EEclERKS2_ + 39
+13  libbrial_groebner.0.dylib           0x000000011569108a _ZN8polybori8groebner17ReductionStrategy28unmarkNonMinimalLeadingTermsENS_8BooleSetE + 186
+14  libbrial_groebner.0.dylib           0x0000000115690e16 _ZN8polybori8groebner17ReductionStrategy19setupSetsForElementERKNS0_9PolyEntryE + 262
+15  pbori.so                            0x00000001153af381 _ZL76__pyx_pw_4sage_5rings_10polynomial_5pbori_17ReductionStrategy_5add_generatorP7_objectS0_ + 177
+16  pbori.so                            0x000000011533967a _ZL25__Pyx_PyObject_CallOneArgP7_objectS0_ + 154
+17  pbori.so                            0x00000001153974b1 _ZL71__pyx_pw_4sage_5rings_10polynomial_5pbori_17BooleanPolynomial_129reduceP7_objectS0_ + 2289
+18  libpython2.7.dylib                  0x000000010b51bfdc PyEval_EvalFrameEx + 29500
+19  libpython2.7.dylib                  0x000000010b514927 PyEval_EvalCodeEx + 2119
+```
+finally the failures in 
+
+```
+sage -t --long src/sage/crypto/mq/sr.py  # 7 doctests failed
+```
+are consequences of segfaults above.
+
+tarball https://github.com/BRiAl/BRiAl/releases/download/0.8.7/brial-0.8.7.tar.bz2
 
 
 Comment: 1
``````




---

archive/issue_comments_332790.json:
```json
{
    "body": "<a id='comment:13'></a>0.8.7 works well on FreeBSD+clang. I'm happy to give it positive review once we have a branch...",
    "created_at": "2017-04-04T08:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332790",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'></a>0.8.7 works well on FreeBSD+clang. I'm happy to give it positive review once we have a branch...



---

archive/issue_comments_332791.json:
```json
{
    "body": "<a id='comment:14'></a>Did you try on gentoo as well? Since 0.8.6 was working on FreeBSD+clang but not on Gentoo+gcc?",
    "created_at": "2017-04-04T09:01:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332791",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'></a>Did you try on gentoo as well? Since 0.8.6 was working on FreeBSD+clang but not on Gentoo+gcc?



---

archive/issue_comments_332792.json:
```json
{
    "body": "<a id='comment:15'></a>checking now on Linux. Will take a while---doing a clean rebuild of sage 8.0.beta...",
    "created_at": "2017-04-04T09:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332792",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'></a>checking now on Linux. Will take a while---doing a clean rebuild of sage 8.0.beta...



---

archive/issue_comments_332793.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-04-04T09:17:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332793",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_332794.json:
```json
{
    "body": "<a id='comment:16'></a>OK, it works on Linux too.\nNo idea why the branch is red though.",
    "created_at": "2017-04-04T16:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332794",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>OK, it works on Linux too.
No idea why the branch is red though.



---

archive/issue_comments_332795.json:
```json
{
    "body": "<a id='comment:17'></a>Interesting message: \"branch doesn't exist\".",
    "created_at": "2017-04-04T19:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332795",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>Interesting message: "branch doesn't exist".



---

archive/issue_comments_332796.json:
```json
{
    "body": "<a id='comment:18'></a>oops...",
    "created_at": "2017-04-04T20:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332796",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>oops...



---

archive/issue_comments_332797.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-04T21:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332797",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_332798.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-07T22:24:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22677#issuecomment-332798",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_059109.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-07T22:24:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22677",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22677#event-59109"
}
```
