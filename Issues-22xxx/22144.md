# Issue 22144: simplify the Graphics3d object of polyhedra

archive/issues_021907.json:
```json
{
    "assignees": [],
    "body": "Currently, every face is in its own IndexFaceSet.\n\nOne can use one IndexFaceSet for all the faces together.\n\nAlso enhance the STL ouput by cutting no-triangular faces into triangles.\n\nand make sure that all faces are oriented outwards.\n\nThis may also help simplify further the PLY export later.\n\nCC:  @ohanar @kcrisman @nilesjohnson @VivianePons ams\n\nKeywords: **days82**\n\nBranch/Commit: **[ed1815a](https://github.com/sagemath/sagetrac-mirror/commit/ed1815abd41de4c68c04a3224647099f9e02d8fe)**\n\nReviewer: **Alba M\u00e1laga**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/22144_\n\n",
    "closed_at": "2017-01-21T21:21:38Z",
    "created_at": "2017-01-06T14:17:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.5",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "simplify the Graphics3d object of polyhedra",
    "type": "issue",
    "updated_at": "2017-01-21T21:21:38Z",
    "url": "https://github.com/sagemath/sage/issues/22144",
    "user": "https://github.com/fchapoton"
}
```
Currently, every face is in its own IndexFaceSet.

One can use one IndexFaceSet for all the faces together.

Also enhance the STL ouput by cutting no-triangular faces into triangles.

and make sure that all faces are oriented outwards.

This may also help simplify further the PLY export later.

CC:  @ohanar @kcrisman @nilesjohnson @VivianePons ams

Keywords: **days82**

Branch/Commit: **[ed1815a](https://github.com/sagemath/sagetrac-mirror/commit/ed1815abd41de4c68c04a3224647099f9e02d8fe)**

Reviewer: **Alba Málaga**

Author: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/22144_





---

archive/issue_events_292069.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-01-06T14:17:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "milestone_number": null,
    "milestone_title": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292069"
}
```



---

archive/issue_events_292070.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-01-06T14:17:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "component: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292070"
}
```



---

archive/issue_events_292071.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-01-06T14:17:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292071"
}
```



---

archive/issue_events_292072.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-01-06T14:17:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292072"
}
```



---

archive/issue_comments_329232.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c54142cffa2e7fd61bff6edac32b3ee277bb44d\">6c54142</a></td><td><code>simplify slightly the Graphics3d object of polyhedra</code></td></tr></table>\n",
    "created_at": "2017-01-06T14:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329232",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'>Comment 1:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c54142cffa2e7fd61bff6edac32b3ee277bb44d">6c54142</a></td><td><code>simplify slightly the Graphics3d object of polyhedra</code></td></tr></table>




---

archive/issue_events_292073.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-01-06T14:18:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292073"
}
```



---

archive/issue_comments_329233.json:
```json
{
    "body": "Branch: **[u/chapoton/22144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22144)**",
    "created_at": "2017-01-06T14:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329233",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/22144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22144)**



---

archive/issue_comments_329234.json:
```json
{
    "body": "Commit: **[6c54142](https://github.com/sagemath/sagetrac-mirror/commit/6c54142cffa2e7fd61bff6edac32b3ee277bb44d)**",
    "created_at": "2017-01-06T14:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329234",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[6c54142](https://github.com/sagemath/sagetrac-mirror/commit/6c54142cffa2e7fd61bff6edac32b3ee277bb44d)**



---

archive/issue_comments_329235.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/740b0a75791503690f4236530847dc2cb10dad98\">740b0a7</a></td><td><code>trac 22144 correct one doctest</code></td></tr></table>\n",
    "created_at": "2017-01-06T16:41:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329235",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>Comment 2:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/740b0a75791503690f4236530847dc2cb10dad98">740b0a7</a></td><td><code>trac 22144 correct one doctest</code></td></tr></table>




---

archive/issue_comments_329236.json:
```json
{
    "body": "Changed commit from **[6c54142](https://github.com/sagemath/sagetrac-mirror/commit/6c54142cffa2e7fd61bff6edac32b3ee277bb44d)** to **[740b0a7](https://github.com/sagemath/sagetrac-mirror/commit/740b0a75791503690f4236530847dc2cb10dad98)**",
    "created_at": "2017-01-06T16:41:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329236",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6c54142](https://github.com/sagemath/sagetrac-mirror/commit/6c54142cffa2e7fd61bff6edac32b3ee277bb44d)** to **[740b0a7](https://github.com/sagemath/sagetrac-mirror/commit/740b0a75791503690f4236530847dc2cb10dad98)**



---

archive/issue_comments_329237.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/443559cfc01c639ba280bb132f5f32606a90a2d4\">443559c</a></td><td><code>simplify slightly the Graphics3d object of polyhedra</code></td></tr></table>\n",
    "created_at": "2017-01-06T16:59:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329237",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'>Comment 3:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/443559cfc01c639ba280bb132f5f32606a90a2d4">443559c</a></td><td><code>simplify slightly the Graphics3d object of polyhedra</code></td></tr></table>




---

archive/issue_comments_329238.json:
```json
{
    "body": "Changed commit from **[740b0a7](https://github.com/sagemath/sagetrac-mirror/commit/740b0a75791503690f4236530847dc2cb10dad98)** to **[443559c](https://github.com/sagemath/sagetrac-mirror/commit/443559cfc01c639ba280bb132f5f32606a90a2d4)**",
    "created_at": "2017-01-06T16:59:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329238",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[740b0a7](https://github.com/sagemath/sagetrac-mirror/commit/740b0a75791503690f4236530847dc2cb10dad98)** to **[443559c](https://github.com/sagemath/sagetrac-mirror/commit/443559cfc01c639ba280bb132f5f32606a90a2d4)**



---

archive/issue_comments_329239.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/976fd8eaa5bd9815f71e0cfaf18811a8c6fce1dc\">976fd8e</a></td><td><code>simplify slightly the Graphics3d object of polyhedra</code></td></tr></table>\n",
    "created_at": "2017-01-07T08:18:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329239",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>Comment 4:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/976fd8eaa5bd9815f71e0cfaf18811a8c6fce1dc">976fd8e</a></td><td><code>simplify slightly the Graphics3d object of polyhedra</code></td></tr></table>




---

archive/issue_comments_329240.json:
```json
{
    "body": "Changed commit from **[443559c](https://github.com/sagemath/sagetrac-mirror/commit/443559cfc01c639ba280bb132f5f32606a90a2d4)** to **[976fd8e](https://github.com/sagemath/sagetrac-mirror/commit/976fd8eaa5bd9815f71e0cfaf18811a8c6fce1dc)**",
    "created_at": "2017-01-07T08:18:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329240",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[443559c](https://github.com/sagemath/sagetrac-mirror/commit/443559cfc01c639ba280bb132f5f32606a90a2d4)** to **[976fd8e](https://github.com/sagemath/sagetrac-mirror/commit/976fd8eaa5bd9815f71e0cfaf18811a8c6fce1dc)**



---

archive/issue_comments_329241.json:
```json
{
    "body": "Changed commit from **[976fd8e](https://github.com/sagemath/sagetrac-mirror/commit/976fd8eaa5bd9815f71e0cfaf18811a8c6fce1dc)** to **[5f16820](https://github.com/sagemath/sagetrac-mirror/commit/5f16820fa2dfb05e78674028bd097ec4ca0d55ec)**",
    "created_at": "2017-01-10T12:33:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329241",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[976fd8e](https://github.com/sagemath/sagetrac-mirror/commit/976fd8eaa5bd9815f71e0cfaf18811a8c6fce1dc)** to **[5f16820](https://github.com/sagemath/sagetrac-mirror/commit/5f16820fa2dfb05e78674028bd097ec4ca0d55ec)**



---

archive/issue_comments_329242.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/443559cfc01c639ba280bb132f5f32606a90a2d4\">443559c</a></td><td><code>simplify slightly the Graphics3d object of polyhedra</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/088e974c355530177ce8e363f792815492d3acaa\">088e974</a></td><td><code>trac 22144 enhance stl ouput (for polyhedra in particular)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f16820fa2dfb05e78674028bd097ec4ca0d55ec\">5f16820</a></td><td><code>Merge branch 'u/chapoton/22144' in alternative branch</code></td></tr></table>\n",
    "created_at": "2017-01-10T12:33:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329242",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/443559cfc01c639ba280bb132f5f32606a90a2d4">443559c</a></td><td><code>simplify slightly the Graphics3d object of polyhedra</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/088e974c355530177ce8e363f792815492d3acaa">088e974</a></td><td><code>trac 22144 enhance stl ouput (for polyhedra in particular)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f16820fa2dfb05e78674028bd097ec4ca0d55ec">5f16820</a></td><td><code>Merge branch 'u/chapoton/22144' in alternative branch</code></td></tr></table>




---

archive/issue_comments_329243.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n \n One can use one IndexFaceSet for all the faces together.\n \n-This may help simplify the STL or PLY export later.\n+Also enhance the STL ouput by cutting no-triangular faces into triangles.\n+\n+This may also help simplify further the PLY export later.\n``````\n",
    "created_at": "2017-01-10T12:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329243",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 
 One can use one IndexFaceSet for all the faces together.
 
-This may help simplify the STL or PLY export later.
+Also enhance the STL ouput by cutting no-triangular faces into triangles.
+
+This may also help simplify further the PLY export later.
``````




---

archive/issue_comments_329244.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\ncould you please try\n\n```\nsage: P = polytopes.truncated_octahedron()\nsage: Q = P.plot().all[-1]\nsage: Q.save('machin.stl')\n```\nit works for me. The second line isolate the IndexFaceSet from other bells and whistles (plot of edges and vertices)\n\nuseful: https://threejs.org/editor/",
    "created_at": "2017-01-10T20:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329244",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'>Comment 9:</a>
could you please try

```
sage: P = polytopes.truncated_octahedron()
sage: Q = P.plot().all[-1]
sage: Q.save('machin.stl')
```
it works for me. The second line isolate the IndexFaceSet from other bells and whistles (plot of edges and vertices)

useful: https://threejs.org/editor/



---

archive/issue_comments_329245.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI tried your example.  \n\nFor me, the second line still was a `Graphics3DGroup` so no `face_list` attribute that `save(...stl)` uses at this point in its code. So `Q.save('machin.stl')` fails with the error message `'Graphics3dGroup' object has no attribute 'face_list'`.  \n\nHowever, `P.plot().all[-1].all[i]` will give a `Graphics3D Object` for every appropriate `i` ( here there are 14 faces, so `i in range(14)`). Then we can recover the full list of faces by putting all faces together. \n\n```\nsage: P = polytopes.truncated_octahedron()\nsage: Q = P.plot().all[-1].all[:-1]\nsage: my_face_list = [face for face_as_IFS in Q for face in face_as_IFS.face_list()] \n```\n\nAnd then, I can call the `save(....stl')` method on an IndexFaceSet built out from this list.\n\n```\nsage: from sage.plot.plot3d.index_face_set import IndexFaceSet\nsage: polytope_as_IFS = IndexFaceSet(my_face_list)\nsage: polytope_as_IFS.save('machin.stl')\n```\n\nIt will again fail, but for a different reason - the faces are not triangles. \n\n[Edit] By the way, I was testing on the develop branch checked out from the github repository.",
    "created_at": "2017-01-11T08:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329245",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:10'>Comment 10:</a>
I tried your example.  

For me, the second line still was a `Graphics3DGroup` so no `face_list` attribute that `save(...stl)` uses at this point in its code. So `Q.save('machin.stl')` fails with the error message `'Graphics3dGroup' object has no attribute 'face_list'`.  

However, `P.plot().all[-1].all[i]` will give a `Graphics3D Object` for every appropriate `i` ( here there are 14 faces, so `i in range(14)`). Then we can recover the full list of faces by putting all faces together. 

```
sage: P = polytopes.truncated_octahedron()
sage: Q = P.plot().all[-1].all[:-1]
sage: my_face_list = [face for face_as_IFS in Q for face in face_as_IFS.face_list()] 
```

And then, I can call the `save(....stl')` method on an IndexFaceSet built out from this list.

```
sage: from sage.plot.plot3d.index_face_set import IndexFaceSet
sage: polytope_as_IFS = IndexFaceSet(my_face_list)
sage: polytope_as_IFS.save('machin.stl')
```

It will again fail, but for a different reason - the faces are not triangles. 

[Edit] By the way, I was testing on the develop branch checked out from the github repository.



---

archive/issue_comments_329246.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nwell, of course (but I should have said that), I meant \"try with the branch applied\"",
    "created_at": "2017-01-11T09:01:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329246",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'>Comment 11:</a>
well, of course (but I should have said that), I meant "try with the branch applied"



---

archive/issue_comments_329247.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@fchapoton](#comment%3A11):\n> well, of course (but I should have said that), I meant \"try with the branch applied\"\n\nOh, my fault.  \n\nOK, after switching branches it did worked. Coool!!!  \n\nThe text file looks fine and I verified that after import to Blender that there were not duplicated vertices and the normals are consistent.",
    "created_at": "2017-01-11T09:21:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329247",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@fchapoton](#comment%3A11):
> well, of course (but I should have said that), I meant "try with the branch applied"

Oh, my fault.  

OK, after switching branches it did worked. Coool!!!  

The text file looks fine and I verified that after import to Blender that there were not duplicated vertices and the normals are consistent.



---

archive/issue_comments_329248.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nPlease, can you explain at what point the truncated octahedron faces are triangulated in this example?   \n\nIt seems to me that you do it very early in the workflow, somewhere inside the `plot` call (anyway `P` has not method `triangulate`). But you don't need the triangulated faces for all 3D file formats exports. I agree you need triangular faces for `stl`, and `3ds`, however triangular faces are not required for `obj`.",
    "created_at": "2017-01-11T09:43:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329248",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:13'>Comment 13:</a>
Please, can you explain at what point the truncated octahedron faces are triangulated in this example?   

It seems to me that you do it very early in the workflow, somewhere inside the `plot` call (anyway `P` has not method `triangulate`). But you don't need the triangulated faces for all 3D file formats exports. I agree you need triangular faces for `stl`, and `3ds`, however triangular faces are not required for `obj`.



---

archive/issue_comments_329249.json:
```json
{
    "body": "Blender screenshot showing inconsistent normals on the exported stl.",
    "created_at": "2017-01-11T10:04:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329249",
    "user": "https://github.com/sagetrac-ams"
}
```

Blender screenshot showing inconsistent normals on the exported stl.



---

archive/issue_comments_329250.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nAttachment: **[blender_wrong_normals.png.gz](https://github.com/sagemath/sage/files/ticket22144/blender_wrong_normals.png.gz)**\n\nSorry, it seems I overlooked some inconsistently oriented normals on the first test. ![](blender_wrong_normals.png)\n\nYou can see after importing the `machin.stl` file generated with your example into Blender that part of the normals is pointing inwards and part is pointing outwards. Of course, it is possible to correct it afterwards, after exporting, but it would be nice to have normals of polyhedrons already consistent when saved to `stl` format.",
    "created_at": "2017-01-11T10:08:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329250",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:14'>Comment 14:</a>
Attachment: **[blender_wrong_normals.png.gz](https://github.com/sagemath/sage/files/ticket22144/blender_wrong_normals.png.gz)**

Sorry, it seems I overlooked some inconsistently oriented normals on the first test. ![](blender_wrong_normals.png)

You can see after importing the `machin.stl` file generated with your example into Blender that part of the normals is pointing inwards and part is pointing outwards. Of course, it is possible to correct it afterwards, after exporting, but it would be nice to have normals of polyhedrons already consistent when saved to `stl` format.



---

archive/issue_comments_329251.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nsorry, I was not available this morning, I should be there after lunch\n\nyes, there is an issue about orientation of faces, that needs to be investigated.",
    "created_at": "2017-01-11T11:04:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329251",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'>Comment 15:</a>
sorry, I was not available this morning, I should be there after lunch

yes, there is an issue about orientation of faces, that needs to be investigated.



---

archive/issue_comments_329252.json:
```json
{
    "body": "Changed commit from **[5f16820](https://github.com/sagemath/sagetrac-mirror/commit/5f16820fa2dfb05e78674028bd097ec4ca0d55ec)** to **[f71dba9](https://github.com/sagemath/sagetrac-mirror/commit/f71dba9c48b8dc477d00a6a76397fb3a95bc7619)**",
    "created_at": "2017-01-11T12:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329252",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5f16820](https://github.com/sagemath/sagetrac-mirror/commit/5f16820fa2dfb05e78674028bd097ec4ca0d55ec)** to **[f71dba9](https://github.com/sagemath/sagetrac-mirror/commit/f71dba9c48b8dc477d00a6a76397fb3a95bc7619)**



---

archive/issue_comments_329253.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5715c6d44bffd8e655f8c9aa591568a4c74a33d6\">5715c6d</a></td><td><code>Merge branch 'u/chapoton/22144' in 7.5.rc3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f71dba9c48b8dc477d00a6a76397fb3a95bc7619\">f71dba9</a></td><td><code>trac 22144 trying to have normal vectors going outwards</code></td></tr></table>\n",
    "created_at": "2017-01-11T12:55:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329253",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:16'>Comment 16:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5715c6d44bffd8e655f8c9aa591568a4c74a33d6">5715c6d</a></td><td><code>Merge branch 'u/chapoton/22144' in 7.5.rc3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f71dba9c48b8dc477d00a6a76397fb3a95bc7619">f71dba9</a></td><td><code>trac 22144 trying to have normal vectors going outwards</code></td></tr></table>




---

archive/issue_comments_329254.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\ncould you please try again with the new branch ?",
    "created_at": "2017-01-11T12:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329254",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'>Comment 17:</a>
could you please try again with the new branch ?



---

archive/issue_comments_329255.json:
```json
{
    "body": "Blender screenshot showing that normals are not yet consistently pointing outwards.",
    "created_at": "2017-01-11T13:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329255",
    "user": "https://github.com/sagetrac-ams"
}
```

Blender screenshot showing that normals are not yet consistently pointing outwards.



---

archive/issue_comments_329256.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nAttachment: **[blender-still-wrong-normals.png.gz](https://github.com/sagemath/sage/files/ticket22144/blender-still-wrong-normals.png.gz)**\n\nThe export to `stl` still works but the normals are not yet consistent and pointing outwards.\n\n![](blender-still-wrong-normals.png)",
    "created_at": "2017-01-11T13:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329256",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:18'>Comment 18:</a>
Attachment: **[blender-still-wrong-normals.png.gz](https://github.com/sagemath/sage/files/ticket22144/blender-still-wrong-normals.png.gz)**

The export to `stl` still works but the normals are not yet consistent and pointing outwards.

![](blender-still-wrong-normals.png)



---

archive/issue_comments_329257.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nreally ? ...surprising. Did you rebuild sage ? using \"sage -br\"\n\nWhen I try this using https://threejs.org/editor/\nit seems that all facets are correctly oriented..",
    "created_at": "2017-01-11T13:59:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329257",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'>Comment 19:</a>
really ? ...surprising. Did you rebuild sage ? using "sage -br"

When I try this using https://threejs.org/editor/
it seems that all facets are correctly oriented..



---

archive/issue_comments_329258.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nYes, I did rebuild. I will try uploading my model into the website you listed.  \n\nCan you explain how do you test using https://threejs.org/editor/ ? Where do you upload the stl, or do you use directly the faces as lists of vertices ?",
    "created_at": "2017-01-11T14:00:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329258",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:20'>Comment 20:</a>
Yes, I did rebuild. I will try uploading my model into the website you listed.  

Can you explain how do you test using https://threejs.org/editor/ ? Where do you upload the stl, or do you use directly the faces as lists of vertices ?



---

archive/issue_comments_329259.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nWait, wait, what does it mean to rebuild using `sage -br` ? The way I did the rebuild was\n\n```\n$ git pull trac u/chapoton/22144\n$ make\n``` \n\nShould I pass a parameter to `make`, like `--force-something` or `--sage-br` in order to ensure that it recompiles the interesting function ?",
    "created_at": "2017-01-11T14:10:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329259",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:21'>Comment 21:</a>
Wait, wait, what does it mean to rebuild using `sage -br` ? The way I did the rebuild was

```
$ git pull trac u/chapoton/22144
$ make
``` 

Should I pass a parameter to `make`, like `--force-something` or `--sage-br` in order to ensure that it recompiles the interesting function ?



---

archive/issue_comments_329260.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nI upload the stl (using the file menu / import). When facets were wrong, some of them did no appear until one ask (in the geometry panel) to show every triangle with both sides.",
    "created_at": "2017-01-11T14:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329260",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:22'>Comment 22:</a>
I upload the stl (using the file menu / import). When facets were wrong, some of them did no appear until one ask (in the geometry panel) to show every triangle with both sides.



---

archive/issue_comments_329261.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\n\"sage -br\" should be equivalent to \"make\" here. It does not care about building the doc, which is faster in general. In some sense \"sage -br\" is like a small-scale \"make\", that is sufficient very often when you do not switch branch",
    "created_at": "2017-01-11T14:13:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329261",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'>Comment 23:</a>
"sage -br" should be equivalent to "make" here. It does not care about building the doc, which is faster in general. In some sense "sage -br" is like a small-scale "make", that is sufficient very often when you do not switch branch



---

archive/issue_comments_329262.json:
```json
{
    "body": "Blender screenshot of consistent normals pointing outwards.",
    "created_at": "2017-01-11T14:20:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329262",
    "user": "https://github.com/sagetrac-ams"
}
```

Blender screenshot of consistent normals pointing outwards.



---

archive/issue_comments_329263.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nAttachment: **[blender-consistent-normals.png.gz](https://github.com/sagemath/sage/files/ticket22144/blender-consistent-normals.png.gz)**\n\nOk, I see now that I was not looking at the good file. I looked at the old version of the `stl`, sorry.  \n\nThe version generated with the new code has consistent normals pointing outwards. \n\n![](blender-consistent-normals.png)\n\ncongrats, so how did you got it ?",
    "created_at": "2017-01-11T14:21:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329263",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:24'>Comment 24:</a>
Attachment: **[blender-consistent-normals.png.gz](https://github.com/sagemath/sage/files/ticket22144/blender-consistent-normals.png.gz)**

Ok, I see now that I was not looking at the good file. I looked at the old version of the `stl`, sorry.  

The version generated with the new code has consistent normals pointing outwards. 

![](blender-consistent-normals.png)

congrats, so how did you got it ?



---

archive/issue_comments_329264.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nok, good.\n\nI just reversed the list the vertices when needed. You can look at my latest commit by clicking on the link \"commits\" besides the name of the branch near the top of this page",
    "created_at": "2017-01-11T14:22:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329264",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:25'>Comment 25:</a>
ok, good.

I just reversed the list the vertices when needed. You can look at my latest commit by clicking on the link "commits" besides the name of the branch near the top of this page



---

archive/issue_comments_329265.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,6 @@\n \n Also enhance the STL ouput by cutting no-triangular faces into triangles.\n \n+and make sure that all faces are oriented outwards.\n+\n This may also help simplify further the PLY export later.\n``````\n",
    "created_at": "2017-01-11T14:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329265",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,6 @@
 
 Also enhance the STL ouput by cutting no-triangular faces into triangles.
 
+and make sure that all faces are oriented outwards.
+
 This may also help simplify further the PLY export later.
``````




---

archive/issue_comments_329266.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nOh, thank you ! Actually, the link (commits) disappear when the site auto-updates with new inputs to the ticket's discussion (at least on this computer). Updating the site in the browser solves this issue.",
    "created_at": "2017-01-11T14:30:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329266",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:27'>Comment 27:</a>
Oh, thank you ! Actually, the link (commits) disappear when the site auto-updates with new inputs to the ticket's discussion (at least on this computer). Updating the site in the browser solves this issue.



---

archive/issue_comments_329267.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nHow do you know that the `facet_equation.A()` is already pointing outwards ? \n\n(cf. `_init_solid_3d(self, polyhedron)` in the commit f71dba9c48b8dc477d00a6a76397fb3a95bc7619)",
    "created_at": "2017-01-11T14:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329267",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:28'>Comment 28:</a>
How do you know that the `facet_equation.A()` is already pointing outwards ? 

(cf. `_init_solid_3d(self, polyhedron)` in the commit f71dba9c48b8dc477d00a6a76397fb3a95bc7619)



---

archive/issue_comments_329268.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nWell, I assumed that the facet_equations are coming from the defining inequations of the polytope, so must be all coherent.\n\nIt was either everybody inwards or everybody outwards, so I tried < 0 and it works.",
    "created_at": "2017-01-11T14:41:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329268",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:29'>Comment 29:</a>
Well, I assumed that the facet_equations are coming from the defining inequations of the polytope, so must be all coherent.

It was either everybody inwards or everybody outwards, so I tried < 0 and it works.



---

archive/issue_comments_329269.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nSo you think it will be *always* everybody outwards ? \n\nI was also thinking that this method will not translate easily to polyhedra that are not convex polytopes. But I am not even sure whether you can define those in Sage... and anyway, if it is possible to have, let say, a genus 1 polyhedron, it would be a different question and a different ticket.",
    "created_at": "2017-01-11T14:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329269",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:30'>Comment 30:</a>
So you think it will be *always* everybody outwards ? 

I was also thinking that this method will not translate easily to polyhedra that are not convex polytopes. But I am not even sure whether you can define those in Sage... and anyway, if it is possible to have, let say, a genus 1 polyhedron, it would be a different question and a different ticket.



---

archive/issue_comments_329270.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nWell, I have not checked this, really, I admit. The idea is that inequalities are always stored as \"vector . (?,?,?) + scalar >= 0\". So taking the vector part of a facet should give the same normal in a coherent way, unless somebody somewhere has decided to change signs for some strange reason.\n\nI have launched my patchbot to check that no doctest is broken anywhere else in sage.\n\nMaybe you should check that some of the examples in Polyhedron? still plot as expected. In particular for open polyhedra, cones, etc. A priori, there should be no problem, but it's better to check a little bit.",
    "created_at": "2017-01-11T14:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329270",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:31'>Comment 31:</a>
Well, I have not checked this, really, I admit. The idea is that inequalities are always stored as "vector . (?,?,?) + scalar >= 0". So taking the vector part of a facet should give the same normal in a coherent way, unless somebody somewhere has decided to change signs for some strange reason.

I have launched my patchbot to check that no doctest is broken anywhere else in sage.

Maybe you should check that some of the examples in Polyhedron? still plot as expected. In particular for open polyhedra, cones, etc. A priori, there should be no problem, but it's better to check a little bit.



---

archive/issue_comments_329271.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nOk, I'll do that. \n\nI have one more question, I cannot figure out in the code where do you actually triangulate the polyhedron's faces. I am worried about it because I am interested in both `stl` and `obj` formats for export and in `obj` I prefer to use *quadri*s rather than *tri*s.",
    "created_at": "2017-01-11T15:05:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329271",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:32'>Comment 32:</a>
Ok, I'll do that. 

I have one more question, I cannot figure out in the code where do you actually triangulate the polyhedron's faces. I am worried about it because I am interested in both `stl` and `obj` formats for export and in `obj` I prefer to use *quadri*s rather than *tri*s.



---

archive/issue_comments_329272.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nthe chopping into triangles is done in the commit\n\ntrac 22144 enhance stl ouput (for polyhedra in particular)\n\nand happens inside the stl string method, so will not affect other file format exports.\n\nyou can see the context by clicking on the commit and then enlarging the value of \"context\" in the little menu \"diff options\" on the right",
    "created_at": "2017-01-11T15:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329272",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:33'>Comment 33:</a>
the chopping into triangles is done in the commit

trac 22144 enhance stl ouput (for polyhedra in particular)

and happens inside the stl string method, so will not affect other file format exports.

you can see the context by clicking on the commit and then enlarging the value of "context" in the little menu "diff options" on the right



---

archive/issue_comments_329273.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nby the way, the better normals for facets should also have enhanced the obj output..",
    "created_at": "2017-01-11T15:10:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329273",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:34'>Comment 34:</a>
by the way, the better normals for facets should also have enhanced the obj output..



---

archive/issue_comments_329274.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d201dfbbf5f4dc6d95f21b978ddcc7744f70ac56\">d201dfb</a></td><td><code>trac 22144 adding a doctest for STL of many-sided faces</code></td></tr></table>\n",
    "created_at": "2017-01-11T15:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329274",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:35'>Comment 35:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d201dfbbf5f4dc6d95f21b978ddcc7744f70ac56">d201dfb</a></td><td><code>trac 22144 adding a doctest for STL of many-sided faces</code></td></tr></table>




---

archive/issue_comments_329275.json:
```json
{
    "body": "Changed commit from **[f71dba9](https://github.com/sagemath/sagetrac-mirror/commit/f71dba9c48b8dc477d00a6a76397fb3a95bc7619)** to **[d201dfb](https://github.com/sagemath/sagetrac-mirror/commit/d201dfbbf5f4dc6d95f21b978ddcc7744f70ac56)**",
    "created_at": "2017-01-11T15:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329275",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f71dba9](https://github.com/sagemath/sagetrac-mirror/commit/f71dba9c48b8dc477d00a6a76397fb3a95bc7619)** to **[d201dfb](https://github.com/sagemath/sagetrac-mirror/commit/d201dfbbf5f4dc6d95f21b978ddcc7744f70ac56)**



---

archive/issue_comments_329276.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nI went trough all of the examples in `plot3d?` The plot looked reasonably good. But did you wanted to test the on-screen image or the `stl` export ? \n\nNone of those examples could export to `stl` before (I mean in Sage 7.4), but now, some of them manage to actually export : \n  \n\n```\nsage: plot3d(lambda x, y: x^2 + y^2, (-2,2), (-2,2)).save('rho2.stl')\n```\n\n```\nsage: plot3d(sin(x*y), (x, -pi, pi), (y, -pi, pi)).save('sinxy.stl')\n```\n\nand many others.\n\nThose who do not work, have options added (other than `plot_points` or `mesh` or `transformation`), like for example:\n\n```\nsage: x,y = var('x,y')\nsage: P = plot3d(x+y+sin(x*y), (x,-10,10),(y,-10,10), opacity=0.87, color='blue')\nsage: Q = plot3d(x-2*y-cos(x*y),(x,-10,10),(y,-10,10),opacity=0.3,color='red')\nsage: (P+Q).save('twoplanes.stl')\n```",
    "created_at": "2017-01-11T16:12:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329276",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:36'>Comment 36:</a>
I went trough all of the examples in `plot3d?` The plot looked reasonably good. But did you wanted to test the on-screen image or the `stl` export ? 

None of those examples could export to `stl` before (I mean in Sage 7.4), but now, some of them manage to actually export : 
  

```
sage: plot3d(lambda x, y: x^2 + y^2, (-2,2), (-2,2)).save('rho2.stl')
```

```
sage: plot3d(sin(x*y), (x, -pi, pi), (y, -pi, pi)).save('sinxy.stl')
```

and many others.

Those who do not work, have options added (other than `plot_points` or `mesh` or `transformation`), like for example:

```
sage: x,y = var('x,y')
sage: P = plot3d(x+y+sin(x*y), (x,-10,10),(y,-10,10), opacity=0.87, color='blue')
sage: Q = plot3d(x-2*y-cos(x*y),(x,-10,10),(y,-10,10),opacity=0.3,color='red')
sage: (P+Q).save('twoplanes.stl')
```



---

archive/issue_comments_329277.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nNo, I was just meaning to check the displayed plots. Thanks for doing that.\n\nYour job as a reviewer, if you accept it:\n\n- check that all doctests pass (wait for the bot, and run the tests yourself on the modified files)\n- check that the doc is good and correctly formatted (should be ok, but you can think of improvements)\n- be sure that this is an improvement over the existing situation\n- ideally, be sure that there is no better solution to do the same thing (should not apply here)\n\nThis should be an easy review, I think. If you have more questions or suggestions, I am all ears. Once you are satisfied, set to positive review and put your name in the reviewer field at top of the page.\n\nI also think one could keep further enhancements to later tickets.",
    "created_at": "2017-01-11T16:18:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329277",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:37'>Comment 37:</a>
No, I was just meaning to check the displayed plots. Thanks for doing that.

Your job as a reviewer, if you accept it:

- check that all doctests pass (wait for the bot, and run the tests yourself on the modified files)
- check that the doc is good and correctly formatted (should be ok, but you can think of improvements)
- be sure that this is an improvement over the existing situation
- ideally, be sure that there is no better solution to do the same thing (should not apply here)

This should be an easy review, I think. If you have more questions or suggestions, I am all ears. Once you are satisfied, set to positive review and put your name in the reviewer field at top of the page.

I also think one could keep further enhancements to later tickets.



---

archive/issue_comments_329278.json:
```json
{
    "body": "Changed keywords from **** to **days82**",
    "created_at": "2017-01-11T17:52:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329278",
    "user": "https://github.com/VivianePons"
}
```

Changed keywords from **** to **days82**



---

archive/issue_comments_329279.json:
```json
{
    "body": "Changed commit from **[d201dfb](https://github.com/sagemath/sagetrac-mirror/commit/d201dfbbf5f4dc6d95f21b978ddcc7744f70ac56)** to **[ed1815a](https://github.com/sagemath/sagetrac-mirror/commit/ed1815abd41de4c68c04a3224647099f9e02d8fe)**",
    "created_at": "2017-01-11T18:15:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329279",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d201dfb](https://github.com/sagemath/sagetrac-mirror/commit/d201dfbbf5f4dc6d95f21b978ddcc7744f70ac56)** to **[ed1815a](https://github.com/sagemath/sagetrac-mirror/commit/ed1815abd41de4c68c04a3224647099f9e02d8fe)**



---

archive/issue_comments_329280.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed1815abd41de4c68c04a3224647099f9e02d8fe\">ed1815a</a></td><td><code>trac 22144 fixing one doctest</code></td></tr></table>\n",
    "created_at": "2017-01-11T18:15:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329280",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:39'>Comment 39:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed1815abd41de4c68c04a3224647099f9e02d8fe">ed1815a</a></td><td><code>trac 22144 fixing one doctest</code></td></tr></table>




---

archive/issue_comments_329281.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nThere is one test \n\n`$ sage -t src/sage/geometry/polyhedron/plot.py`  \n\nthat fails.\n\n```\nFailed example:\n    proj.polygons\nExpected:\n    [[2, 0, 1], [3, 0, 1], [3, 0, 2], [3, 1, 2]]\nGot:\n    [[1, 0, 2], [3, 0, 1], [2, 0, 3], [3, 1, 2]]\n```\n\nI looked through the example, and exported the stl in this precise example. It works, and normal are consistent, so maybe you should change the expected result accordingly in the doc.",
    "created_at": "2017-01-11T23:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329281",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:40'>Comment 40:</a>
There is one test 

`$ sage -t src/sage/geometry/polyhedron/plot.py`  

that fails.

```
Failed example:
    proj.polygons
Expected:
    [[2, 0, 1], [3, 0, 1], [3, 0, 2], [3, 1, 2]]
Got:
    [[1, 0, 2], [3, 0, 1], [2, 0, 3], [3, 1, 2]]
```

I looked through the example, and exported the stl in this precise example. It works, and normal are consistent, so maybe you should change the expected result accordingly in the doc.



---

archive/issue_comments_329282.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nyes, done already",
    "created_at": "2017-01-12T07:33:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329282",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:41'>Comment 41:</a>
yes, done already



---

archive/issue_events_292074.json:
```json
{
    "actor": "https://github.com/sagetrac-ams",
    "created_at": "2017-01-12T09:34:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292074"
}
```



---

archive/issue_events_292075.json:
```json
{
    "actor": "https://github.com/sagetrac-ams",
    "created_at": "2017-01-12T09:34:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292075"
}
```



---

archive/issue_comments_329283.json:
```json
{
    "body": "Reviewer: **Alba M\u00e1laga**",
    "created_at": "2017-01-12T09:34:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329283",
    "user": "https://github.com/sagetrac-ams"
}
```

Reviewer: **Alba Málaga**



---

archive/issue_comments_329284.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nGood job! All tests passed on my computer and the documentation looks good.",
    "created_at": "2017-01-12T09:34:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329284",
    "user": "https://github.com/sagetrac-ams"
}
```

<a id='comment:42'>Comment 42:</a>
Good job! All tests passed on my computer and the documentation looks good.



---

archive/issue_comments_329285.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\na sequel in #22196, to use the much more efficient binary STL format instead",
    "created_at": "2017-01-17T16:38:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329285",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:43'>Comment 43:</a>
a sequel in #22196, to use the much more efficient binary STL format instead



---

archive/issue_comments_329286.json:
```json
{
    "body": "Changed branch from **[u/chapoton/22144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22144)** to **[ed1815a](https://github.com/sagemath/sagetrac-mirror/commit/ed1815abd41de4c68c04a3224647099f9e02d8fe)**",
    "created_at": "2017-01-21T21:21:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/22144#issuecomment-329286",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/22144](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/22144)** to **[ed1815a](https://github.com/sagemath/sagetrac-mirror/commit/ed1815abd41de4c68c04a3224647099f9e02d8fe)**



---

archive/issue_events_292076.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-21T21:21:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292076"
}
```



---

archive/issue_events_292077.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "7ac3b20f97f959d6891f173308b99d7428afb575",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-01-21T21:21:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/22144",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/22144#event-292077"
}
```
