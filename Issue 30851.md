# Issue 30851: GH Actions: WSL workflow: No space left on device

Issue created by migration from https://trac.sagemath.org/ticket/31088

Original creator: mkoeppe

Original creation time: 2020-12-20 03:54:44

CC:  @tobiasdiez

https://github.com/mkoeppe/sage/runs/1583193282

```
  [jupyter_jsmol-0.2.4]   writing requirements to jupyter_jsmol.egg-info/requires.txt
  [jupyter_jsmol-0.2.4]   writing top-level names to jupyter_jsmol.egg-info/top_level.txt
  [jupyter_jsmol-0.2.4]   writing manifest file 'jupyter_jsmol.egg-info/SOURCES.txt'
  [jupyter_jsmol-0.2.4]   reading manifest file 'jupyter_jsmol.egg-info/SOURCES.txt'
  [jupyter_jsmol-0.2.4]   writing manifest file 'jupyter_jsmol.egg-info/SOURCES.txt'
  [jupyter_jsmol-0.2.4]   error: [Errno 28] No space left on device
  [jupyter_jsmol-0.2.4]   
```



---

Comment by mkoeppe created at 2021-03-06 21:39:49

Tobias, when you have a chance, could you try to fix up the WSL workflow please? It's been failing consistently for months now


---

Comment by @tobiasdiez created at 2021-03-07 09:11:25

Sorry, I don't have time for this in the foreseeable future.


---

Comment by mkoeppe created at 2021-03-07 19:18:37

Thanks for letting us know, and thanks for all your work in the past months.


---

Comment by @tobiasdiez created at 2021-10-17 12:58:42

It now fails during the installation of flint

```
Attempting to download package flint-2.7.1.tar.gz from mirrors
Downloading the Sage mirror list
Searching fastest mirror
  295ms: http://ftp.leg.uct.ac.za/pub/packages/sage/
  578ms: http://ftp.ntua.gr/pub/sagemath/
  180ms: http://ftp.rediris.es/mirror/sagemath/
  200ms: http://ftp.riken.jp/sagemath/
  327ms: http://ftp.sun.ac.za/ftp/pub/mirrors/www.sagemath.org/
  420ms: http://ftp.yz.yamagata-u.ac.jp/pub/math/sage/
  376ms: http://linorg.usp.br/sage/
  479ms: http://mirror.aarnet.edu.au/pub/sage/
  942ms: http://mirror.ufs.ac.za/sagemath/
  346ms: http://mirror.yandex.ru/mirrors/sage.math.washington.edu/
   80ms: http://mirrors.mit.edu/sage/
  395ms: http://mirrors.tuna.tsinghua.edu.cn/sagemath/
  621ms: http://mirrors.ustc.edu.cn/sagemath/
   26ms: http://mirrors.xmission.com/sage/
  697ms: http://sage.mirror.garr.it/mirrors/sage/
  784ms: http://sagemath.c3sl.ufpr.br/
  600ms: http://sagemath.mirror.ac.za/
  589ms: http://www-ftp.lip6.fr/pub/math/sagemath/
  430ms: http://www.mirrorservice.org/sites/www.sagemath.org/
  357ms: https://mirror-hk.koddos.net/sagemath/
  124ms: https://mirror.csclub.uwaterloo.ca/sage/
  491ms: https://mirror.dogado.de/sage/
WARNING [mirror_list|_rank_mirrors:136]: [Errno 111] Connection refused: https://mirror.koddos.net/sagemath/
  227ms: https://mirror.lyrahosting.com/sagemath/
  797ms: https://mirror.marwan.ma/sage/
   51ms: https://mirror.rcg.sfu.ca/mirror/sage/
WARNING [mirror_list|_rank_mirrors:136]: [Errno 111] Connection refused: https://mirrors.nju.edu.cn/sagemath/
  641ms: https://mirrors.up.pt/pub/sage/
Fastest mirror: http://mirrors.xmission.com/sage/
http://mirrors.xmission.com/sage/spkg/upstream/flint/flint-2.7.1.tar.gz
[......................................................................]
flint-2.7.1
====================================================
Setting up build directory for flint-2.7.1
Finished extraction
No patch files found in ../patches
****************************************************
Host system:
Linux fv-az159-516 4.4.0-17763-Microsoft #2183-Microsoft Sat Sep 11 15:52:00 PST 2021 x86_64 x86_64 x86_64 GNU/Linux
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/9/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none:hsa
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 9.3.0-17ubuntu1~20.04' --with-bugurl=file:///usr/share/doc/gcc-9/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++,gm2 --prefix=/usr --with-gcc-major-version-only --program-suffix=-9 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib=auto --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none=/build/gcc-9-HskZEa/gcc-9-9.3.0/debian/tmp-nvptx/usr,hsa --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04) 
****************************************************
Package 'flint' is currently not installed
No legacy uninstaller found for 'flint'; nothing to do
Configuring FLINT.
Configuring...x86_64-Linux
Testing __builtin_popcountl...yes
Testing native popcount...yes
Testing __thread...yes
Testing fenv...yes
Testing cpu_set_t...yes
FLINT was successfully configured.
Building flint-2.7.1
make AT= QUIET_CC= QUIET_CXX= QUIET_AR=
sed "s/ /,/g;s/.*/&,/g" qadic/CPimport.txt > build/CPimport.h
if [ "1" -eq "1" ]; then \
	make shared; \
fi
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c printf.c -o build/printf.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c fprintf.c -o build/fprintf.lo;
In file included from /usr/include/stdio.h:39,
                 from fprintf.c:13:
/usr/include/x86_64-linux-gnu/bits/types/__fpos_t.h:5:10: fatal error: /mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include/bits/types/__mbstate_t.h: Invalid argument
    5 | #include <bits/types/__mbstate_t.h>
      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~
compilation terminated.
make[7]: *** [Makefile:265: build/fprintf.lo] Error 1
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c sprintf.c -o build/sprintf.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c scanf.c -o build/scanf.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c fscanf.c -o build/fscanf.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c sscanf.c -o build/sscanf.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c clz_tab.c -o build/clz_tab.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c memory_manager.c -o build/memory_manager.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c version.c -o build/version.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c profiler.c -o build/profiler.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c thread_support.c -o build/thread_support.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c exception.c -o build/exception.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c hashmap.c -o build/hashmap.lo;
gcc -fPIC -O2 -g -march=native -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1/src/build -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -I/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/include -c inlines.c -o build/inlines.lo;
mkdir -p build/interfaces
make[7]: Target 'shared' not remade because of errors.
make[6]: *** [Makefile:176: library] Error 2
make[6]: Target 'all' not remade because of errors.
make[5]: *** [Makefile:103: verbose] Error 2
********************************************************************************
Error building flint-2.7.1
********************************************************************************

real	0m4.011s
user	0m1.594s
sys	0m2.219s
************************************************************************
Error installing package flint-2.7.1
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the log files
  /mnt/d/a/sage/sage/logs/pkgs/flint-2.7.1.log
and
  /mnt/d/a/sage/sage/config.log
Describe your computer, operating system, etc.
If you want to try to fix the problem yourself, *don't* just cd to
/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1 and type 'make' or whatever is appropriate.
Instead, the following commands setup all environment variables
correctly and load a subshell for you to debug the error:
  (cd '/mnt/d/a/sage/sage/.tox/local-sudo-ubuntu-standard/local/var/tmp/sage/build/flint-2.7.1' && '/mnt/d/a/sage/sage/sage' --buildsh)
When you are done debugging, you can type "exit" to leave the subshell.
************************************************************************

```

Seems to be a version mismatch between flint and bits.
I cannot reproduce it locally.


---

Comment by mkoeppe created at 2021-10-17 18:25:40

Looks to me like a failed system call when accessing this header file. Is this appearing in more than one run?


---

Comment by @tobiasdiez created at 2021-10-17 20:26:13

Yes, flint fails since 9.4.beta6 see https://github.com/sagemath/sage/actions/workflows/ci-wsl.yml


---

Comment by mkoeppe created at 2021-10-17 20:28:26

Is this using WSL 1 or 2? Should we test both?


---

Comment by @tobiasdiez created at 2021-10-17 20:33:23

WSL 1 is the only supported version (WSL 2 would require a self-hosted runner).


---

Comment by chapoton created at 2022-01-29 08:58:50

bump to 9.6


---

Comment by mkoeppe created at 2022-02-17 16:55:02

Changing priority from major to critical.


---

Comment by mkoeppe created at 2022-02-17 16:55:02

This ticket needs some care so that we can update our instructions for WSL to something that actually works.
