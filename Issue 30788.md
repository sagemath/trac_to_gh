# Issue 30788: FPLLL 5.4.0 and FPyLLL 0.5.3.dev0

archive/issues_030788.json:
```json
{
    "body": "CC:  @kiwifb\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31025\n\n",
    "created_at": "2020-12-07T11:16:36Z",
    "labels": [],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "FPLLL 5.4.0 and FPyLLL 0.5.3.dev0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30788",
    "user": "https://github.com/malb"
}
```
CC:  @kiwifb



Issue created by migration from https://trac.sagemath.org/ticket/31025





---

archive/issue_comments_439627.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-07T11:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439627",
    "user": "https://github.com/malb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_439628.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-12-07T11:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439628",
    "user": "https://github.com/malb"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_439629.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2020-12-07T11:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439629",
    "user": "https://github.com/malb"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_439630.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-12-07T11:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439630",
    "user": "https://github.com/malb"
}
```

New commits:



---

archive/issue_comments_439631.json:
```json
{
    "body": "`build/pkgs/fpylll/checksums.ini` needs `upstream_url` - see other python packages for the preferred URL format",
    "created_at": "2020-12-08T01:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439631",
    "user": "https://github.com/mkoeppe"
}
```

`build/pkgs/fpylll/checksums.ini` needs `upstream_url` - see other python packages for the preferred URL format



---

archive/issue_comments_439632.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-08T10:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439632",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439633.json:
```json
{
    "body": "Ta. Fixed.",
    "created_at": "2020-12-08T10:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439633",
    "user": "https://github.com/malb"
}
```

Ta. Fixed.



---

archive/issue_comments_439634.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd111\".",
    "created_at": "2020-12-10T18:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439634",
    "user": "https://github.com/mkoeppe"
}
```

Changing keywords from "" to "sd111".



---

archive/issue_comments_439635.json:
```json
{
    "body": "On `local-conda-forge-ubuntu-standard` (https://github.com/mkoeppe/sage/runs/1533944840)\n\n```\n  build/src/fpylll/fplll/enumeration.cpp: In function 'PyObject* __pyx_pf_6fpylll_5fplll_11enumeration_11Enumeration_6get_nodes(__pyx_obj_6fpylll_5fplll_11enumeration_Enumeration*, PyObject*)':\n  build/src/fpylll/fplll/enumeration.cpp:7430:99: error: no matching function for call to 'fplll::Enumeration<fplll::Z_NR<__mpz_struct [1]>, fplll::FP_NR<double> >::get_nodes(int&)'\n       __pyx_t_3 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->_core.mpz_d->get_nodes(__pyx_v__level)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 576, __pyx_L1_error)\n                                                                                                     \n```\n",
    "created_at": "2020-12-11T06:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439635",
    "user": "https://github.com/mkoeppe"
}
```

On `local-conda-forge-ubuntu-standard` (https://github.com/mkoeppe/sage/runs/1533944840)

```
  build/src/fpylll/fplll/enumeration.cpp: In function 'PyObject* __pyx_pf_6fpylll_5fplll_11enumeration_11Enumeration_6get_nodes(__pyx_obj_6fpylll_5fplll_11enumeration_Enumeration*, PyObject*)':
  build/src/fpylll/fplll/enumeration.cpp:7430:99: error: no matching function for call to 'fplll::Enumeration<fplll::Z_NR<__mpz_struct [1]>, fplll::FP_NR<double> >::get_nodes(int&)'
       __pyx_t_3 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->_core.mpz_d->get_nodes(__pyx_v__level)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 576, __pyx_L1_error)
                                                                                                     
```




---

archive/issue_comments_439636.json:
```json
{
    "body": "Works fine in Gentoo. I must I never know where to find the appropriate logs in your runs. Sometimes it is easy and sometimes I just get lost. I found the good stuff in the raw logs.\n\n```\n2020-12-11T03:40:06.7154190Z   building 'fpylll.fplll.enumeration' extension\n2020-12-11T03:40:06.7164990Z   /home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -Wstrict-prototypes -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/include -fPIC -Isrc/fpylll/fplll -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/local/lib/python3.8/site-packages/cysignals -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/local/include -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/local/lib/python3.8/site-packages/numpy/core/include -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/local/include -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/include/python3.8 -c build/src/fpylll/fplll/enumeration.cpp -o build/temp.linux-x86_64-3.8/build/src/fpylll/fplll/enumeration.o -std=c++11 -fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/include\n2020-12-11T03:40:06.7174509Z   cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++\n2020-12-11T03:40:06.7176260Z   build/src/fpylll/fplll/enumeration.cpp: In function 'PyObject* __pyx_pf_6fpylll_5fplll_11enumeration_11Enumeration_6get_nodes(__pyx_obj_6fpylll_5fplll_11enumeration_Enumeration*, PyObject*)':\n2020-12-11T03:40:06.7178575Z   build/src/fpylll/fplll/enumeration.cpp:7430:99: error: no matching function for call to 'fplll::Enumeration<fplll::Z_NR<__mpz_struct [1]>, fplll::FP_NR<double> >::get_nodes(int&)'\n2020-12-11T03:40:06.7180107Z        __pyx_t_3 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->_core.mpz_d->get_nodes(__pyx_v__level)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 576, __pyx_L1_error)\n```\n\n\nI have a feeling `-std=c++17` is responsible for this, I compile with c++11 in Gentoo (probably a default somewhere).",
    "created_at": "2020-12-11T06:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439636",
    "user": "https://github.com/kiwifb"
}
```

Works fine in Gentoo. I must I never know where to find the appropriate logs in your runs. Sometimes it is easy and sometimes I just get lost. I found the good stuff in the raw logs.

```
2020-12-11T03:40:06.7154190Z   building 'fpylll.fplll.enumeration' extension
2020-12-11T03:40:06.7164990Z   /home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/bin/x86_64-conda-linux-gnu-cc -Wno-unused-result -Wsign-compare -DNDEBUG -fwrapv -O2 -Wall -Wstrict-prototypes -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -pipe -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/include -DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/include -fPIC -Isrc/fpylll/fplll -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/local/lib/python3.8/site-packages/cysignals -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/local/include -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/local/lib/python3.8/site-packages/numpy/core/include -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/local/include -I/home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/include/python3.8 -c build/src/fpylll/fplll/enumeration.cpp -o build/temp.linux-x86_64-3.8/build/src/fpylll/fplll/enumeration.o -std=c++11 -fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/runner/work/sage/sage/.tox/local-conda-forge-ubuntu-standard/conda/include
2020-12-11T03:40:06.7174509Z   cc1plus: warning: command line option '-Wstrict-prototypes' is valid for C/ObjC but not for C++
2020-12-11T03:40:06.7176260Z   build/src/fpylll/fplll/enumeration.cpp: In function 'PyObject* __pyx_pf_6fpylll_5fplll_11enumeration_11Enumeration_6get_nodes(__pyx_obj_6fpylll_5fplll_11enumeration_Enumeration*, PyObject*)':
2020-12-11T03:40:06.7178575Z   build/src/fpylll/fplll/enumeration.cpp:7430:99: error: no matching function for call to 'fplll::Enumeration<fplll::Z_NR<__mpz_struct [1]>, fplll::FP_NR<double> >::get_nodes(int&)'
2020-12-11T03:40:06.7180107Z        __pyx_t_3 = __Pyx_PyInt_From_unsigned_long(__pyx_v_self->_core.mpz_d->get_nodes(__pyx_v__level)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 576, __pyx_L1_error)
```


I have a feeling `-std=c++17` is responsible for this, I compile with c++11 in Gentoo (probably a default somewhere).



---

archive/issue_comments_439637.json:
```json
{
    "body": "Is there perhaps a race condition that FPyLLL is built before the new FPLLL?",
    "created_at": "2020-12-11T09:03:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439637",
    "user": "https://github.com/malb"
}
```

Is there perhaps a race condition that FPyLLL is built before the new FPLLL?



---

archive/issue_comments_439638.json:
```json
{
    "body": "Replying to [comment:13 malb]:\n> Is there perhaps a race condition that FPyLLL is built before the new FPLLL?\n\nLooking at the log again, I'd say it looks like it!",
    "created_at": "2020-12-11T09:06:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439638",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:13 malb]:
> Is there perhaps a race condition that FPyLLL is built before the new FPLLL?

Looking at the log again, I'd say it looks like it!



---

archive/issue_comments_439639.json:
```json
{
    "body": "This build is accepting a system package\n\n```\nChecking whether SageMath should install SPKG fplll...\nchecking whether any of mpfr is installed as or will be installed as SPKG... no\nchecking for fplll >= 5.3... yes\nconfigure: will use system package and not install SPKG fplll\n```\n\nIf the new `fpylll` has other version requirements, `build/pkgs/fplll/spkg-configure.m4` needs to be changed",
    "created_at": "2020-12-11T16:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439639",
    "user": "https://github.com/mkoeppe"
}
```

This build is accepting a system package

```
Checking whether SageMath should install SPKG fplll...
checking whether any of mpfr is installed as or will be installed as SPKG... no
checking for fplll >= 5.3... yes
configure: will use system package and not install SPKG fplll
```

If the new `fpylll` has other version requirements, `build/pkgs/fplll/spkg-configure.m4` needs to be changed



---

archive/issue_comments_439640.json:
```json
{
    "body": "Same failure also on `fedora-32-standard` https://github.com/mkoeppe/sage/runs/1533944016 and other builds",
    "created_at": "2020-12-11T16:24:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439640",
    "user": "https://github.com/mkoeppe"
}
```

Same failure also on `fedora-32-standard` https://github.com/mkoeppe/sage/runs/1533944016 and other builds



---

archive/issue_comments_439641.json:
```json
{
    "body": "If practical at all, I would suggest to upstream to allow the Python bindings to accept a range of fplll versions...",
    "created_at": "2020-12-11T16:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439641",
    "user": "https://github.com/mkoeppe"
}
```

If practical at all, I would suggest to upstream to allow the Python bindings to accept a range of fplll versions...



---

archive/issue_comments_439642.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-11T17:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439642",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439643.json:
```json
{
    "body": "Updated accordingly, I don't think we can commit to supporting a range of FPLLL versions in FPyLLL",
    "created_at": "2020-12-11T17:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439643",
    "user": "https://github.com/malb"
}
```

Updated accordingly, I don't think we can commit to supporting a range of FPLLL versions in FPyLLL



---

archive/issue_comments_439644.json:
```json
{
    "body": "Perhaps then an upper bound for the version needs to be set as well?",
    "created_at": "2020-12-11T18:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439644",
    "user": "https://github.com/mkoeppe"
}
```

Perhaps then an upper bound for the version needs to be set as well?



---

archive/issue_comments_439645.json:
```json
{
    "body": "Likewise, should we set a range of acceptable `fpylll` versions (in the `install-requires` of sagelib)?",
    "created_at": "2020-12-14T17:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439645",
    "user": "https://github.com/mkoeppe"
}
```

Likewise, should we set a range of acceptable `fpylll` versions (in the `install-requires` of sagelib)?



---

archive/issue_comments_439646.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2020-12-14T17:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439646",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_439647.json:
```json
{
    "body": "Replying to [comment:20 mkoeppe]:\n> Perhaps then an upper bound for the version needs to be set as well?\n\nI think an upper bound is unclear, we could enforce a specific version, e.g. 5.4.0?",
    "created_at": "2020-12-14T18:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439647",
    "user": "https://github.com/malb"
}
```

Replying to [comment:20 mkoeppe]:
> Perhaps then an upper bound for the version needs to be set as well?

I think an upper bound is unclear, we could enforce a specific version, e.g. 5.4.0?



---

archive/issue_comments_439648.json:
```json
{
    "body": "Replying to [comment:21 mkoeppe]:\n> Likewise, should we set a range of acceptable `fpylll` versions (in the `install-requires` of sagelib)? \n\nFor now, Sage only makes very high-level use of FPyLLL, i.e. it should work with many versions.",
    "created_at": "2020-12-14T18:55:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439648",
    "user": "https://github.com/malb"
}
```

Replying to [comment:21 mkoeppe]:
> Likewise, should we set a range of acceptable `fpylll` versions (in the `install-requires` of sagelib)? 

For now, Sage only makes very high-level use of FPyLLL, i.e. it should work with many versions.



---

archive/issue_comments_439649.json:
```json
{
    "body": "Replying to [comment:22 malb]:\n> Replying to [comment:20 mkoeppe]:\n> > Perhaps then an upper bound for the version needs to be set as well?\n> \n> I think an upper bound is unclear, we could enforce a specific version, e.g. 5.4.0?\n\nSo there is no expectation that FPyLLL 0.5.3.dev0 can work with any FPLLL 5.4.x?",
    "created_at": "2020-12-14T18:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439649",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:22 malb]:
> Replying to [comment:20 mkoeppe]:
> > Perhaps then an upper bound for the version needs to be set as well?
> 
> I think an upper bound is unclear, we could enforce a specific version, e.g. 5.4.0?

So there is no expectation that FPyLLL 0.5.3.dev0 can work with any FPLLL 5.4.x?



---

archive/issue_comments_439650.json:
```json
{
    "body": "Replying to [comment:23 malb]:\n> Replying to [comment:21 mkoeppe]:\n> > Likewise, should we set a range of acceptable `fpylll` versions (in the `install-requires` of sagelib)? \n> \n> For now, Sage only makes very high-level use of FPyLLL, i.e. it should work with many versions.\n\nTo clarify my question, the Sage distribution ships a specific version of FPLLL (5.4.0 with this ticket); but if fpylll comes from PyPI, what future versions should we expect to support this version of FPLLL?\n\nIf FPLLL/FPyLLL do not have a policy regarding version compatibility, it would probably pay off to set one...",
    "created_at": "2020-12-14T19:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439650",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:23 malb]:
> Replying to [comment:21 mkoeppe]:
> > Likewise, should we set a range of acceptable `fpylll` versions (in the `install-requires` of sagelib)? 
> 
> For now, Sage only makes very high-level use of FPyLLL, i.e. it should work with many versions.

To clarify my question, the Sage distribution ships a specific version of FPLLL (5.4.0 with this ticket); but if fpylll comes from PyPI, what future versions should we expect to support this version of FPLLL?

If FPLLL/FPyLLL do not have a policy regarding version compatibility, it would probably pay off to set one...



---

archive/issue_comments_439651.json:
```json
{
    "body": "Replying to [comment:24 mkoeppe]:\n> So there is no expectation that FPyLLL 0.5.3.dev0 can work with any FPLLL 5.4.x? \n\nNo expectation at all.",
    "created_at": "2020-12-14T19:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439651",
    "user": "https://github.com/malb"
}
```

Replying to [comment:24 mkoeppe]:
> So there is no expectation that FPyLLL 0.5.3.dev0 can work with any FPLLL 5.4.x? 

No expectation at all.



---

archive/issue_comments_439652.json:
```json
{
    "body": "Replying to [comment:25 mkoeppe]:\n> To clarify my question, the Sage distribution ships a specific version of FPLLL (5.4.0 with this ticket); but if fpylll comes from PyPI, what future versions should we expect to support this version of FPLLL?\n> \n> If FPLLL/FPyLLL do not have a policy regarding version compatibility, it would probably pay off to set one...\n\nRealistically the only viable policy is: whatever versions were released at the same time should work together. So I think it makes sense to enforce a tuple: FPLLL=X,FPyLLL=Y",
    "created_at": "2020-12-14T19:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439652",
    "user": "https://github.com/malb"
}
```

Replying to [comment:25 mkoeppe]:
> To clarify my question, the Sage distribution ships a specific version of FPLLL (5.4.0 with this ticket); but if fpylll comes from PyPI, what future versions should we expect to support this version of FPLLL?
> 
> If FPLLL/FPyLLL do not have a policy regarding version compatibility, it would probably pay off to set one...

Realistically the only viable policy is: whatever versions were released at the same time should work together. So I think it makes sense to enforce a tuple: FPLLL=X,FPyLLL=Y



---

archive/issue_comments_439653.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-15T12:12:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439653",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439654.json:
```json
{
    "body": "Based on your explanations, I think fpylll's `install-requires.txt` should also fix the version.",
    "created_at": "2020-12-15T21:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439654",
    "user": "https://github.com/mkoeppe"
}
```

Based on your explanations, I think fpylll's `install-requires.txt` should also fix the version.



---

archive/issue_comments_439655.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2020-12-16T22:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439655",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_439656.json:
```json
{
    "body": "This doesn't look like an FPLLL issue: https://github.com/mkoeppe/sage/runs/1566871595?check_suite_focus=true#step:7:65",
    "created_at": "2020-12-17T09:06:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439656",
    "user": "https://github.com/malb"
}
```

This doesn't look like an FPLLL issue: https://github.com/mkoeppe/sage/runs/1566871595?check_suite_focus=true#step:7:65



---

archive/issue_comments_439657.json:
```json
{
    "body": "No, that's not related to this ticket",
    "created_at": "2020-12-17T17:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439657",
    "user": "https://github.com/mkoeppe"
}
```

No, that's not related to this ticket



---

archive/issue_comments_439658.json:
```json
{
    "body": "Replying to [comment:30 mkoeppe]:\n> Based on your explanations, I think fpylll's `install-requires.txt` should also fix the version.\nAs in:\n\n```\ndiff --git a/build/pkgs/fpylll/install-requires.txt b/build/pkgs/fpylll/install-requires.txt\nindex 6e7d17221c..df75cd9fa7 100644\n--- a/build/pkgs/fpylll/install-requires.txt\n+++ b/build/pkgs/fpylll/install-requires.txt\n@@ -1 +1 @@\n-fpylll >=0.5.4\n+fpylll ==0.5.4\n```\n",
    "created_at": "2020-12-17T17:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439658",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:30 mkoeppe]:
> Based on your explanations, I think fpylll's `install-requires.txt` should also fix the version.
As in:

```
diff --git a/build/pkgs/fpylll/install-requires.txt b/build/pkgs/fpylll/install-requires.txt
index 6e7d17221c..df75cd9fa7 100644
--- a/build/pkgs/fpylll/install-requires.txt
+++ b/build/pkgs/fpylll/install-requires.txt
@@ -1 +1 @@
-fpylll >=0.5.4
+fpylll ==0.5.4
```




---

archive/issue_comments_439659.json:
```json
{
    "body": "I would also suggest to add some comments:\n\n```\ndiff --git a/build/pkgs/fplll/spkg-configure.m4 b/build/pkgs/fplll/spkg-configure.m4\nindex 6da0045fe0..b98a71938e 100644\n--- a/build/pkgs/fplll/spkg-configure.m4\n+++ b/build/pkgs/fplll/spkg-configure.m4\n@@ -4,6 +4,9 @@ SAGE_SPKG_CONFIGURE([fplll], [\n     dnl if there's a usable system copy of fplll. Unless there's\n     dnl a system that ships fplll without fplll.pc file, falling\n     dnl back to a manual header/library search is pointless.\n+    dnl\n+    dnl Trac #31025: FPLLL/FPyLLL make no guarantee regarding compatibility\n+    dnl other than \"whatever versions were released at the same time should work together\"\n     PKG_CHECK_MODULES([FPLLL],\n                       [fplll == 5.4],\n                       [sage_spkg_install_fplll=no],\ndiff --git a/build/pkgs/fpylll/install-requires.txt b/build/pkgs/fpylll/install-requires.txt\nindex 6e7d17221c..4b425c186e 100644\n--- a/build/pkgs/fpylll/install-requires.txt\n+++ b/build/pkgs/fpylll/install-requires.txt\n@@ -1 +1,3 @@\n-fpylll >=0.5.4\n+# Trac #31025: FPLLL/FPyLLL make no guarantee regarding compatibility\n+# other than \"whatever versions were released at the same time should work together\"\n+fpylll ==0.5.4\n```\n",
    "created_at": "2020-12-17T17:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439659",
    "user": "https://github.com/mkoeppe"
}
```

I would also suggest to add some comments:

```
diff --git a/build/pkgs/fplll/spkg-configure.m4 b/build/pkgs/fplll/spkg-configure.m4
index 6da0045fe0..b98a71938e 100644
--- a/build/pkgs/fplll/spkg-configure.m4
+++ b/build/pkgs/fplll/spkg-configure.m4
@@ -4,6 +4,9 @@ SAGE_SPKG_CONFIGURE([fplll], [
     dnl if there's a usable system copy of fplll. Unless there's
     dnl a system that ships fplll without fplll.pc file, falling
     dnl back to a manual header/library search is pointless.
+    dnl
+    dnl Trac #31025: FPLLL/FPyLLL make no guarantee regarding compatibility
+    dnl other than "whatever versions were released at the same time should work together"
     PKG_CHECK_MODULES([FPLLL],
                       [fplll == 5.4],
                       [sage_spkg_install_fplll=no],
diff --git a/build/pkgs/fpylll/install-requires.txt b/build/pkgs/fpylll/install-requires.txt
index 6e7d17221c..4b425c186e 100644
--- a/build/pkgs/fpylll/install-requires.txt
+++ b/build/pkgs/fpylll/install-requires.txt
@@ -1 +1,3 @@
-fpylll >=0.5.4
+# Trac #31025: FPLLL/FPyLLL make no guarantee regarding compatibility
+# other than "whatever versions were released at the same time should work together"
+fpylll ==0.5.4
```




---

archive/issue_comments_439660.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-22T15:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439660",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439661.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-22T15:34:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439661",
    "user": "https://github.com/malb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439662.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-22T15:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439662",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_439663.json:
```json
{
    "body": "Marking it as critical because some rolling distributions are already picking up 5.4.0",
    "created_at": "2020-12-22T15:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439663",
    "user": "https://github.com/mkoeppe"
}
```

Marking it as critical because some rolling distributions are already picking up 5.4.0



---

archive/issue_comments_439664.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2020-12-22T15:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439664",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_events_081036.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-27T23:25:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30788#event-81036"
}
```



---

archive/issue_comments_439665.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-27T23:25:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439665",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_439666.json:
```json
{
    "body": "For some reason, even after make distclean, configure is unable to find homebrew install of fplll 5.4.0 (on macOS). Then, the compilation fails on `fpylll` (may be a mix of fplll installations).\n\nAfter modifying `spkg-configure.m4` to change `fplll == 5.4.0` to `fplll >= 5.4.0` and adding file `distros/homebrew.txt` with `fplll`, configure finds the local install and everything goes well.\n\nShould we open a ticket for that ?",
    "created_at": "2020-12-28T20:14:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439666",
    "user": "https://github.com/dcoudert"
}
```

For some reason, even after make distclean, configure is unable to find homebrew install of fplll 5.4.0 (on macOS). Then, the compilation fails on `fpylll` (may be a mix of fplll installations).

After modifying `spkg-configure.m4` to change `fplll == 5.4.0` to `fplll >= 5.4.0` and adding file `distros/homebrew.txt` with `fplll`, configure finds the local install and everything goes well.

Should we open a ticket for that ?



---

archive/issue_comments_439667.json:
```json
{
    "body": "Replying to [comment:41 dcoudert]:\n> Should we open a ticket for that ?\nYes please. What version of fplll does pkg-config report?",
    "created_at": "2020-12-28T21:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439667",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:41 dcoudert]:
> Should we open a ticket for that ?
Yes please. What version of fplll does pkg-config report?



---

archive/issue_comments_439668.json:
```json
{
    "body": "not sure how to get that, but inside config.log, I see:\n\n```\n## ------------------------------------------------------ ##\n## Checking whether SageMath should install SPKG fplll... ##\n## ------------------------------------------------------ ##\nconfigure:19538: checking whether any of mpfr is installed as or will be installed as SPKG\nconfigure:19547: result: no\nconfigure:19552: checking for fplll >= 5.4\nconfigure:19559: $PKG_CONFIG --exists --print-errors \"fplll >= 5.4\"\nconfigure:19562: $? = 0\nconfigure:19576: $PKG_CONFIG --exists --print-errors \"fplll >= 5.4\"\nconfigure:19579: $? = 0\nconfigure:19617: result: yes\nconfigure:19629: will use system package and not install SPKG fplll\n```\n\nand I have fplll 5.4.0 installed by homebrew.\n\nFollow-up on #31127",
    "created_at": "2020-12-29T00:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439668",
    "user": "https://github.com/dcoudert"
}
```

not sure how to get that, but inside config.log, I see:

```
## ------------------------------------------------------ ##
## Checking whether SageMath should install SPKG fplll... ##
## ------------------------------------------------------ ##
configure:19538: checking whether any of mpfr is installed as or will be installed as SPKG
configure:19547: result: no
configure:19552: checking for fplll >= 5.4
configure:19559: $PKG_CONFIG --exists --print-errors "fplll >= 5.4"
configure:19562: $? = 0
configure:19576: $PKG_CONFIG --exists --print-errors "fplll >= 5.4"
configure:19579: $? = 0
configure:19617: result: yes
configure:19629: will use system package and not install SPKG fplll
```

and I have fplll 5.4.0 installed by homebrew.

Follow-up on #31127



---

archive/issue_comments_439669.json:
```json
{
    "body": "Another follow up in #31146: `cygwin-standard`: `fpylll` build fails",
    "created_at": "2021-01-01T21:55:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30788",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30788#issuecomment-439669",
    "user": "https://github.com/mkoeppe"
}
```

Another follow up in #31146: `cygwin-standard`: `fpylll` build fails
