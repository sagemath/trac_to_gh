# Issue 26622: Intersphinx: include python.inv files for Python 2 and 3

Issue created by migration from Trac.

Original creator: jhpalmieri

Original creation time: 2018-12-08 23:26:56

CC:  chapoton strogdon jdemeyer

The file `src/doc/common/python.inv` is specific to Python 2. We should include an inventory file for Python 3, to prepare for docbuilding with Python 3.



---

Comment by jhpalmieri created at 2018-12-08 23:29:23

New commits:


---

Comment by jhpalmieri created at 2018-12-08 23:29:23

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2018-12-08 23:31:48

Note that the script `update-python-inv.sh` should not need to be run often, but it should still be compatible with OS X. OS X does not include `wget` as standard, but it does include `curl`, so the script will use either one. Also, the old script used `cut` in a non-posix standard way. Please test this script on linux.


---

Comment by dimpase created at 2018-12-08 23:39:53

these *.inv-files, these are some binary blobs. Is there a reason for this, could they be replaced by something which can be used to generate them?


---

Comment by jhpalmieri created at 2018-12-08 23:41:24

Replying to [comment:4 dimpase]:
> these *.inv-files, these are some binary blobs. Is there a reason for this, could they be replaced by something which can be used to generate them? 

Not without internet access. If we want to maintain the ability to build Sage and its documentation without internet access, we need to have these files. (With internet access, we could replace the files with links to the on-line versions.)


---

Comment by dimpase created at 2018-12-08 23:46:10

Hmm, I don't get it - these files, they must be generated somehow... It's not some binary-only firmware, is it?


---

Comment by jhpalmieri created at 2018-12-08 23:53:43

They come from python.org (e.g., https://docs.python.org/3/objects.inv), and they contain links to python.org. I'm sure the Python people have some autogeneration for them, but I don't know how we would do that. 

See http://www.sphinx-doc.org/en/master/usage/extensions/intersphinx.html#confval-intersphinx_mapping for how we could use the links if we assumed internet access. (I think being able to build without internet access is valuable and I am not suggesting changing that – I am including this link if you want to figure out what is in the files and if there is any way we could generate them ourselves.) As noted on that Sphinx page, you can also run

```
./sage --python -msphinx.ext.intersphinx src/doc/common/python.inv
```

to see the intersphinx mapping provided by that file.


---

Comment by jhpalmieri created at 2018-12-08 23:57:33

I just found [this](https://sphobjinv.readthedocs.io/en/latest/index.html), which lets you create your own `object.inv` files. Maybe we could use that. I am not that interested in spending time on it: the binary files are not that big, and I don't mind just distributing them with Sage.


---

Comment by dimpase created at 2018-12-09 00:03:07

The whole issue would not have arisen if these files were generated...

Perhaps Jeroen could comment on the ease of having this done properly.


---

Comment by jhpalmieri created at 2018-12-09 00:08:37

"Done properly". Thanks very much.  ;)


---

Comment by jhpalmieri created at 2018-12-09 00:17:19

I would say, by the way, that if you want to change how these files are produced, if it is feasible and especially if it will take a while, it belongs on a separate ticket.


---

Comment by dimpase created at 2018-12-09 00:30:27

Replying to [comment:10 jhpalmieri]:
> "Done properly". Thanks very much.  ;)

yes, sometimes I wish we could do anonymous refereeing of tickets :)


---

Comment by embray created at 2018-12-10 12:33:47

Changing status from needs_review to positive_review.


---

Comment by embray created at 2018-12-10 12:33:47

I believe for the `.inv` files the usual approach is for them to be generated and distributed by the relevant projects' maintainers.  So for the ones from Python the correct approach is to download them and include our own copies of them if necessary.

I think this approach looks good for now.


---

Comment by dimpase created at 2018-12-11 10:31:51

Sage does generate plenty of `.inv` files while building its docs. Why would one not generate all the `.inv` files then, relying instead on selective manual downloads of stuff? This looks flaky to me...


---

Comment by embray created at 2018-12-11 11:10:29

That would require building the docs for Python, for matplotlib, etc. (or at the very least their inventories).  Flaky or not (I don't think it is) it's pretty normal.  The inventories are just databases of keywords--it's the same reason you would download any pre-computed database of maths results.


---

Comment by vbraun created at 2018-12-23 23:40:18

Resolution: fixed


---

Comment by embray created at 2018-12-28 14:06:38

This tickets were closed as fixed after the Sage 8.5 release.
