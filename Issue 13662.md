# Issue 13662: Experimental gdb spkg

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2012-12-26 19:26:34

Assignee: tbd

CC:  jpflori

I made a quick gdb spkg. If you used `SAGE_DEBUG=yes` to build a debug python, then the host python will most likely be unhappy: debug and normal python have a different ABI, and new gdb's link against libpython since they have significant knowledge about python internals.

http://www.stp.dias.ie/~vbraun/Sage/spkg/gdb-7.5.1.spkg



---

Comment by vbraun created at 2012-12-26 19:27:08

Usable but still need to fill out `SPKG.txt`


---

Comment by SimonKing created at 2012-12-28 17:57:08

What does one need to do in order to use it? With the current SAGE_DEBUG version of sage-5.6.b1 as discussed on #13864, when I simply install the gdb package, running `./sage -gdb` results in

```
/home/simon/SAGE/debug/sage-5.6.beta1/local/bin/sage-ipython
GNU gdb (GDB) 7.5.1
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-unknown-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /home/simon/SAGE/debug/sage-5.6.beta1/local/bin/python...done.
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib64/libthread_db.so.1".
Python 2.7.3 (default, Dec 28 2012, 14:58:54) 
[GCC 4.6.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)

/home/simon/SAGE/debug/sage-5.6.beta1/local/lib/python2.7/site-packages/IPython/ipmaker.py in force_import(modname, force_reload)
     61         reload(sys.modules[modname])
     62     else:
---> 63         __import__(modname)
     64         
     65 

ImportError: No module named ipy_profile_sage
Error importing ipy_profile_sage - perhaps you should run %upgrade?
WARNING: Loading of ipy_profile_sage failed.
```


Hence, do I need to re-install something? ./sage -ba even?


---

Comment by vbraun created at 2012-12-28 18:17:32

You just need the fix from #13669 which I posted ages ago but nobody wants to review a one-liner so until then `sage -gdb` stays broken no matter what version of gdb you have.


---

Comment by vbraun created at 2013-01-13 11:08:44

I've filled in the SPKG.txt so this is ready to become an experimental spkg


---

Comment by vbraun created at 2013-01-13 11:08:44

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2013-01-14 10:49:37

Nitpicks: remove `spkg-install~` and probably you should remove the corresponding entry from `.hgignore.

Are you sure that gmp, mpfr, mpc and ppl are dependencies of `gdb`?  I don't really find any evidence of that.  I agree that PPL is checked for, but it doesn't seem required:

```
checking for version 0.11 (revision 0 or later) of PPL... no
```



---

Comment by vbraun created at 2013-01-14 12:12:31

I removed the backup~ file. 

I don't know what gdb uses gmp, mpfr, mpc, ppl for, but the configure script lets you specify them. GDB doesn't link against these libraries but perhaps it picks bitwidths from headers? In  any case since we do ship with all of them I thought it best to add them to configure.


---

Comment by jdemeyer created at 2013-01-14 12:19:27

Replying to [comment:7 vbraun]:
> I don't know what gdb uses gmp, mpfr, mpc, ppl for, but the configure script lets you specify them.
Yes, that's weird.  It looks like they copy/pasted the GCC configure script.  I agree that it doesn't hurt.


---

Comment by vbraun created at 2013-01-15 12:10:04

For the record, this spkg can't work on OSX because of Apple braindamage:

```
(sage-sh) vbraun`@`bsd:sage-5.4.rc1$ gdb python
GNU gdb (GDB) 7.5.1
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-apple-darwin10.8.0".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /Users/vbraun/sage-5.4.rc1/local/bin/python...
warning: `/Users/vbraun/sage-5.4.rc1/spkg/build/python-2.7.3.p0/src/Modules/python.o': can't open to read symbols: No such file or directory.
(no debugging symbols found)...done.
(gdb) run
Starting program: /Users/vbraun/sage-5.4.rc1/local/bin/python 
Unable to find Mach task port for process-id 27416: (os/kern) failure (0x5).
 (please check gdb is codesigned - see taskgated(8))
```



---

Comment by jdemeyer created at 2013-01-17 10:41:24

Changing status from needs_review to positive_review.


---

Comment by schilly created at 2013-01-17 11:18:24

spkg has been mirrored.


---

Comment by jdemeyer created at 2013-01-18 07:41:13

Resolution: fixed
