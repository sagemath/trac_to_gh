# Issue 14180: Support version number literals.

Issue created by migration from Trac.

Original creator: robertwb

Original creation time: 2013-03-30 00:17:42

Assignee: jason

CC:  roed

This can be done as we already have preparser hacks for real literals and numeric attributes. 

https://github.com/robertwb/sage/commits/versions


---

Comment by robertwb created at 2013-03-30 05:19:10

Changing status from new to needs_review.


---

Comment by kini created at 2013-03-31 05:46:42

Here is a doctest you can use:


```
"""
    sage: 3 - 1 - 6
    -4
    sage: 3-1-6
    3-1-6
"""
```


Anyone who writes subtraction without spaces is a barbarian so this shouldn't cause any ambiguity.


---

Comment by kcrisman created at 2013-04-02 17:23:18

> {{{
> """
>     sage: 3 - 1 - 6
>     -4
>     sage: 3-1-6
>     3-1-6
> """
> }}}
> 
> Anyone who writes subtraction without spaces is a barbarian so this shouldn't cause any ambiguity.
I hope this is a joke at Leif's expense intended to point out that Singular's scheme would be hard to support... but the internet is not a subtle medium :(


---

Comment by kini created at 2013-04-02 17:36:42

Well, it was certainly a joke, but I wouldn't say it was at Leif's expense since he was joking too :) (We were talking about this ticket on the IRC channel.) In fact, if I hadn't been in the room when Robert wrote his patch, I would have thought Robert was joking as well! :P


---

Comment by leif created at 2013-04-02 17:43:06


```
<_leif> btw, it's not April 1st yet -- not even down under
<kini> david roe is probably waiting for april 1 before setting it to positive review :P
<_leif> Changes (by leif):
   * work_issues:  => Support Singular's versioning scheme as well
 (I didn't set it to "needs work" though.)
 Another enhancement:
 sage: #14323 in 5.9.beta2
 True
```



---

Comment by roed created at 2013-04-02 19:45:34

Changing status from needs_review to positive_review.


---

Comment by roed created at 2013-04-02 19:45:34

Looks good to me.  I can't think of a good way to support Singular's system, so let's hold off on that for another ticket.


---

Comment by jason created at 2013-04-02 20:27:48

We should probably only support Singular's system on April 1, so maybe we need to add a date check to the code? ;)

(just kidding!)


---

Comment by jdemeyer created at 2013-04-03 08:33:48

So we're seriously going to do this?

Some comments:
 1. Move `class VersionNumber` somewhere else (probably `sage/misc/versionnumber.py` for lack of a better place)
 2. How can I get the raw patch for this commit from github?
 3. Error messages are going to be very confusing, try

```
sage: x = 4.5
sage: x.denominator()
```



---

Comment by jdemeyer created at 2013-04-03 08:33:48

Changing status from positive_review to needs_work.


---

Comment by leif created at 2013-04-03 10:50:20

I have to admit I was actually thinking this whole ticket was a joke until Keshav clarified. B)

(I really liked the type `sage.rings.real_mpfr.VersionNumber`. ;-) )


---

Comment by jason created at 2013-04-03 12:46:13

I thought the whole ticket was a joke too.  What's the rationale for doing this, other than "we can"?  I don't see a compelling reason for having version number literals.


---

Comment by kcrisman created at 2013-04-03 12:53:52

> I thought the whole ticket was a joke too. What's the rationale for doing this, other than "we can"? 
Thank the Lord.


---

Comment by kcrisman created at 2013-04-03 12:53:52

Changing status from needs_work to positive_review.


---

Comment by jason created at 2013-04-03 13:46:25

Wait, now I'm really confused.  Does that conclusively settle it?


---

Comment by kini created at 2013-04-03 17:43:33

Apparently you have a rather authoritative-sounding voice, Jason :P

As for the rationale for doing this, well, I can recall approximately the conversation which led to this patch:

>Should we tag our releases as just bare numbers like 5.9 or should we put a v in front like v5.9?

>Well, I think it should be just 5.9 since I'm going to type stuff like `vanilla(5.9)` into the Sage prompt and expect it to just work.

>Is it that much trouble to write `vanilla('v5.9')`... wait, you're going to call `vanilla` with a _float_?

>Yes! Why not?

>Well then what about 4.7.2? That isn't a float...

>True. But it could be an MPFR real! *hack hack*

>!?

>Behold, the first git-based trac ticket!

By the way, Jeroen, I noticed you semi-recently (8 months ago) merged a ticket by pulling a branch rather than applying a patch: #418. So while this might be the first git-based ticket, it's not the first pull request to the modern Sage codebase. Does this mean we could already be using a pull-request based model right now, for the Sage library at least? :)


---

Comment by jdemeyer created at 2013-04-03 18:06:16

Replying to [comment:14 kini]:
> Does this mean we could already be using a pull-request based model right now, for the Sage library at least? :)
Yes, but not using github :-)


---

Comment by roed created at 2013-04-03 18:44:55

Changing status from positive_review to needs_work.


---

Comment by roed created at 2013-04-03 18:44:55

I don't think we should mark it as won't-fix yet.  Let's see what Robert says about Jeroen's suggestions first.


---

Comment by leif created at 2013-04-03 19:16:36

Replying to [comment:16 roed]:
> I don't think we should mark it as won't-fix yet.  Let's see what Robert says about Jeroen's suggestions first.

I don't think it makes sense to support software version numbers (i.e., literals of that type) as a "native" type in a CAS;  nobody will mind adding a _class_ for versions, its constructor(s) taking a string (or probably also a float) argument, but this ticket is (currently) about the former.

Prepending a "v" could perhaps be a compromise, avoiding trouble (i.e., ambiguities) with floating-point literals, but I personally wouldn't like it either.


---

Comment by jason created at 2013-04-03 21:33:18

I have to say I got a little confused seeing something associated with mpfr that had alphabet characters in it too.

Personally, I think it's not worth the cost (confusion, yet another incompatibility, etc.) to introduce these to the preparser.


---

Comment by kini created at 2013-04-03 21:59:13

As much as I hate to be a spoilsport, I have to agree :)

However, the modifications to preparser.py fix a bug and are worthwhile.


---

Comment by robertwb created at 2013-04-06 05:23:53

It started out as a joke, but then we realized we had enough hooks in the preparser to actually do such a crazy thing without bending the langauge. `x.denominator()` can be fixed, but I understand if this is too weird to go in. Otherwise, I'll move `VersionNumber` to misc and make a patch.


---

Comment by jason created at 2013-04-06 12:32:56

Okay, here's my vote:

-1 to going into standard Sage

+1 to going into "cool hacks you can do in Sage"

+1 to going into the Sage April Fools collection


---

Comment by kcrisman created at 2013-04-06 14:48:59

> -1 to going into standard Sage
Yes.
> +1 to going into "cool hacks you can do in Sage"
If we ever move the useful constructions into the reference manual and get rid of the constructions thing, we could replace it with "cool Sage hacks".
> +1 to going into the Sage April Fools collection
Oh, like the move to Lisp...


---

Comment by roed created at 2013-04-06 21:05:44

Replying to [comment:22 kcrisman]:
> > -1 to going into standard Sage

I'm +1 for going into standard Sage, but I don't feel strongly enough about it to argue.

> > +1 to going into "cool hacks you can do in Sage"
> If we ever move the useful constructions into the reference manual and get rid of the constructions thing, we could replace it with "cool Sage hacks".

Sure.

> > +1 to going into the Sage April Fools collection
> Oh, like the move to Lisp...

I don't think this works as well as an April Fools e-mail, since it's not actually a very major change.  And we'd have to wait almost a year anyway.  ;-)
