# Issue 30169: Allow pull requests from Github

Issue created by migration from https://trac.sagemath.org/ticket/30406

Original creator: @tobiasdiez

Original creation time: 2020-08-20 13:53:17

CC:  embray mkoeppe robertwb slelievre was

I've heard that once upon a time there was a bot that created trac issues based on github PRs. Apparently the bot was lost.

I found https://github.com/trac-hacks/trac-github which has the feature to "update the local git mirror used by Trac after each push to [GitHub](GitHub), and notify the new changesets to Trac;". Sounds like this is exactly what would be needed to allow PRs from github.
I couldn't find anything on how to install trac plugins here on sage.


---

Comment by DavidLowry created at 2020-08-21 17:36:22

Is this functionality that we want? There are several warnings about how the sage github repo doesn't accept PRs and to instead use trac.


---

Comment by DavidLowry created at 2020-08-21 17:39:10

Ah, only now do I see that this is morally a continuation of the commentary occuring in #30363


---

Comment by @tobiasdiez created at 2020-08-21 17:42:16

Thanks for the link, I had forgotten where I read about the lost bot.


---

Comment by embray created at 2020-08-31 14:11:10

We are accepting merge requests through GitLab: https://gitlab.com/sagemath/sage

The GitHub page should link to that.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by slelievre created at 2021-03-27 21:35:22

The bot to turn pull requests to the SageMath repo at GitHub
into Trac tickets once existed.

In a [2014-08 sage-devel discussion](https://groups.google.com/g/sage-devel/c/5d9NfgZJDmw/m/mrchAwmwB-0J), Robert described:

> All pull requests on github turn into tickets, so this easy web
> interface flow works now.

The bot stopped working around mid 2015.

In a [2016-07 sage-devel discussion](https://groups.google.com/g/sage-devel/c/wcqMjrCZHHQ/m/jKOygA-sAgAJ), Paul wrote:

> [...] there are a couple pull requests from the middle of 2015 that never became
> Trac tickets. The bot appears to have stopped creating tickets before then.
>
> There are open pull requests from the end of 2014 that became part of Sage 6.4.
> The bot does not appear to close pull requests on [GitHub](GitHub).

and Robert wrote:

> I was running a small script on trac.sagemath.org:12000 that was
> listening for github pull requests and comments (via github webhooks)
> and publishing them to trac (via the trac scripts shipped with Sage).
> Nothing too fancy, but I can't find the code for it at the moment (but
> it's probably still sitting in that image unless it's been redone
> since then). I don't remember if I ever pushed anything back to github
> (which would require write access) but pull requests should get closed
> when their associated changes get merged into master.

In a 2018-02 discussion on the sagemath-admins mailing list, Robert wrote:

> Sorry, I have no idea where the source to that is. However, the whole
> thing was like 100 lines or so. It just listened for github hooks and
> posted the information to a new/existing ticket on trac, and vice
> versa (maybe was invoked via patchbot when something changed, I don't
> remember how the hooks went the other direction).
>
> At this point, probably less effort to re-implement than track it
> down. Huge +1 to tighter github integration; using trac to push
> changes at the very least is a huge barrier for casual development.
> (I'm very happy with migrating Cython completely over to Github,
> modulo I don't keep track of the jenkins server that used to regularly
> build and test Sage with Cython head).


---

Comment by slelievre created at 2021-03-27 22:12:59

Christopher Swenson pointed me to this:

https://github.com/swenson/sage-workflow/blob/master/sagedev/pr_export.py


---

Comment by embray created at 2021-03-29 07:47:53

If you really want to do this I would recommend looking at the gitlab hook in the Trac plugin (ironically still hosted on GH though I would prefer to move it): https://github.com/sagemath/sage_trac_plugin/blob/master/sage_trac/gitlab.py

Most of this could be refactored to abstract out the [GitLab](GitLab) and [GitHub](GitHub) API differences.  Personally I am not motivated to do it though.


---

Comment by klee created at 2022-09-11 03:39:04

Though we migrate to github, trac may function as a secondary issue tracker or at least archiver if this ticket is achieved. Or would we close trac completely after the migration?


---

Comment by mkoeppe created at 2022-09-11 03:49:23

I would think we would probably keep Trac around in read-only mode for a little while, just so that people can easily see that nothing has been lost in the conversion. But definitely not more than that. Definitely not a converter from GH to Trac.


---

Comment by mkoeppe created at 2022-09-11 04:09:35

Changing status from new to needs_review.


---

Comment by was created at 2022-09-11 05:38:18

We would not want to break links to trac somehow.  Eg we could host all of trac.sagemath.org in static readonly mode (e.g via github pages) forever to preserve the links.


---

Comment by mkoeppe created at 2022-09-11 16:16:07

Or set up http redirects to the Issues? The plan is to map them 1:1


---

Comment by mkoeppe created at 2022-09-11 17:46:07

I've added these ideas to #30363, let's take the discussion there.


---

Comment by @tobiasdiez created at 2022-10-15 23:33:21

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-11-14 19:36:43

Resolution: invalid
