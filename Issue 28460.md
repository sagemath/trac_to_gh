# Issue 28460: missing latte optional tag in three doctests

Issue created by migration from https://trac.sagemath.org/ticket/28697

Original creator: slabbe

Original creation time: 2019-11-05 20:07:26

With pynormalize installed but without latte installed, the command


```
sage -t --long src/sage/geometry/polyhedron/base_QQ.py
```


gives


```
**********************************************************************
File "src/sage/geometry/polyhedron/base_QQ.py", line 483, in sage.geometry.polyhedron.base_QQ.Polyhedron_QQ.?
Failed example:
    ts.integral_points_count()                # optional - pynormaliz
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.polyhedron.base_QQ.Polyhedron_QQ.?[13]>", line 1, in <module>
        ts.integral_points_count()                # optional - pynormaliz
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base_QQ.py", line 218, in integral_points_count
        **kwds)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/interfaces/latte.py", line 116, in count
        Latte().require()
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/features/__init__.py", line 158, in require
        raise FeatureNotPresentError(self, presence.reason, presence.resolution)
    FeatureNotPresentError: LattE is not available.
    Executable 'count' not found on PATH.
    To install count you can try to run 'sage -i latte_int'.
    Further installation instructions might be available at https://www.math.ucdavis.edu/~latte/software.php.
**********************************************************************
File "src/sage/geometry/polyhedron/base_QQ.py", line 515, in sage.geometry.polyhedron.base_QQ.Polyhedron_QQ.?
Failed example:
    simplex.ehrhart_polynomial()                                                            # optional - pynormaliz
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.polyhedron.base_QQ.Polyhedron_QQ.?[24]>", line 1, in <module>
        simplex.ehrhart_polynomial()                                                            # optional - pynormaliz
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base_QQ.py", line 363, in ehrhart_polynomial
        **kwds)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base_QQ.py", line 761, in _ehrhart_polynomial_latte
        return count(ine, cdd=True, ehrhart_polynomial=True, verbose=verbose, **kwds)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/interfaces/latte.py", line 116, in count
        Latte().require()
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/features/__init__.py", line 158, in require
        raise FeatureNotPresentError(self, presence.reason, presence.resolution)
    FeatureNotPresentError: LattE is not available.
    Executable 'count' not found on PATH.
    To install count you can try to run 'sage -i latte_int'.
    Further installation instructions might be available at https://www.math.ucdavis.edu/~latte/software.php.
**********************************************************************
File "src/sage/geometry/polyhedron/base_QQ.py", line 581, in sage.geometry.polyhedron.base_QQ.Polyhedron_QQ._ehrhart_quasipolynomial_normaliz
Failed example:
    ts.integral_points_count()                        # optional - pynormaliz
Exception raised:
    Traceback (most recent call last):
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.polyhedron.base_QQ.Polyhedron_QQ._ehrhart_quasipolynomial_normaliz[8]>", line 1, in <module>
        ts.integral_points_count()                        # optional - pynormaliz
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base_QQ.py", line 218, in integral_points_count
        **kwds)
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/interfaces/latte.py", line 116, in count
        Latte().require()
      File "/home/slabbe/GitBox/sage/local/lib/python2.7/site-packages/sage/features/__init__.py", line 158, in require
        raise FeatureNotPresentError(self, presence.reason, presence.resolution)
    FeatureNotPresentError: LattE is not available.
    Executable 'count' not found on PATH.
    To install count you can try to run 'sage -i latte_int'.
    Further installation instructions might be available at https://www.math.ucdavis.edu/~latte/software.php.
**********************************************************************
2 items had failures:
   2 of  59 in sage.geometry.polyhedron.base_QQ.Polyhedron_QQ.?
   1 of  14 in sage.geometry.polyhedron.base_QQ.Polyhedron_QQ._ehrhart_quasipolynomial_normaliz
    30 latte_int tests not run
    0 tests not run because we ran out of time
    [79 tests, 3 failures, 0.11 s]
sage -t --long src/sage/symbolic/integration/external.py
    8 fricas tests not run
    0 tests not run because we ran out of time
    [36 tests, 20.85 s]
```



---

Comment by jipilab created at 2019-11-07 16:09:24

Damn, I missed this ticket when I opened #28700. Sorry for the duplication. There is already a proposed fix over there.


---

Comment by tscrim created at 2019-11-08 02:05:09

Changing status from new to needs_review.


---

Comment by tscrim created at 2019-11-08 02:06:37

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2019-11-08 21:09:05

Resolution: duplicate
