# Issue 24470: fpylll ignores --stdlib directive

Issue created by migration from https://trac.sagemath.org/ticket/24707

Original creator: rws

Original creation time: 2018-02-11 08:18:47

CC:  malb

If "`--stdlib=libc++`" is given in the CXX environment var, fpylll will add it only with C compilations not C++. This leads to libstdc++ being linked and import errors with fpylll.


---

Comment by fbissey created at 2018-02-11 08:38:49

Can you provide a build log please.


---

Comment by SimonKing created at 2018-02-11 08:45:01

Is it fplll-5.2.0.p1.log? In other words, is fpylll a typo, or a different package?

Anyway, I posted a fplll log resulting from building Sage with clange [here](http://users.minet.uni-jena.de/cohomology/logs/fplll-5.2.0.p1.log).


---

Attachment


---

Comment by dimpase created at 2018-02-11 10:03:04

reported upstream: https://github.com/fplll/fpylll/issues/115


---

Comment by SimonKing created at 2018-02-11 10:37:16

While fpylll seems to build (on my machine, with `CC=clang CXX="clang++ -I/usr/include/libcxxabi/ --stdlib=libc++" make`), I got a build error in ratpoints and opened #24708 for it.


---

Comment by malb created at 2018-02-11 12:02:56

Shouldn't those parameters be passed as `CXXFLAGS`/`LDFLAGS`?


---

Comment by rws created at 2018-02-11 13:48:16

Replying to [comment:8 malb]:
> Shouldn't those parameters be passed as `CXXFLAGS`/`LDFLAGS`?

I think so, yes. At least that is their usage, as I see it now---`stdlib=libc++` as compile flag to get the right include files, and `-lc++ --stdlib=libc++` to get the file to link and prevent libstdc++ from being linked.


---

Comment by rws created at 2018-02-11 14:04:05

However CXX may need to be set to `clang++ --stdlib=libc++` as well. I see a lot of compile commands in the logs ignoring CXXFLAGS (ppl, gfan...)


---

Comment by malb created at 2018-02-11 15:14:55

Thanks, does fpylll also fail to pass through `CXXFLAGS` and `LDFLAGS`?


---

Comment by rws created at 2018-02-11 15:18:53

See also #24710. We need `--stdlib=libc++` in the CXXFLAGS but this makes gfortran fail.


---

Comment by rws created at 2018-02-11 15:20:45

Correction, we need it in LDFLAGS. I'm a bit frustrated.


---

Comment by rws created at 2018-02-11 16:47:41

Replying to [comment:6 dimpase]:
> reported upstream: https://github.com/fplll/fpylll/issues/115

Thanks. I explained there that there is now a solution, i.e. to put the string in LDFLAGS.


---

Comment by rws created at 2018-02-11 16:47:41

Changing status from new to needs_review.


---

Comment by rws created at 2018-02-11 16:48:09

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2018-02-12 09:27:23

Resolution: invalid
