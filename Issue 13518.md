# Issue 13518: regression in determinant of certain dense matrices

archive/issues_013518.json:
```json
{
    "body": "Assignee: jason, was\n\nKeywords: regression, determinant\n\nSee [this sage-support thread](https://groups.google.com/forum/?fromgroups#!topic/sage-support/jpRxVAQb1G8). Essentially, there is a huge (1000x) slowdown in computing the determinant of certain dense matrices. The slowdown happened sometime in between sage-4.7.2 and sage-4.8.\n\n\n```\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nsage: attach det.sage\n  K = 30 , result = -9\n  Sage Version 4.7.2, Release Date: 2011-10-29\n  sparse=  True\n  time  =  0.260323047638\n| Sage Version 4.7.2, Release Date: 2011-10-29                       |\n| Type notebook() for the GUI, and license() for information.        |\n  K = 30 , result = -9\n  Sage Version 4.7.2, Release Date: 2011-10-29\n  sparse=  False\n  time  =  0.026487827301\nsage:\nExiting Sage (CPU time 0m1.77s, Wall time 0m29.31s).\nExiting spawned Gap process.\n\n\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nsage: attach det.sage\n  K = 30 , result = -9\n  Sage Version 4.8, Release Date: 2012-01-20\n  sparse=  True\n  time  =  0.011904001236\n| Sage Version 4.8, Release Date: 2012-01-20                         |\n| Type notebook() for the GUI, and license() for information.        |\n  K = 30 , result = -9\n  Sage Version 4.8, Release Date: 2012-01-20\n  sparse=  False\n  time  =  122.02807498 \n```\n\n\n`det.sage` contains the following code:\n\n```python\nimport time\n\ndef test(K, SP):\n  n=100\n  f=taylor(prod((1-x**i) for i in range(1,n)),x,0,n)\n  A=[f.coefficient(x,i) for i in range(n)]\n  cf= [[A[i+j] for i in range(K)] for j in range(K)]\n  m= matrix(ZZ, cf, sparse=SP)\n  #\n  t0=time.time()\n  print \"  K =\", K, \", result =\", m.det()\n  t_det= time.time()-t0\n  print \" \",version()\n  print \"  sparse= \", SP\n  print \"  time  = \", t_det\n  \nKK=30\ntest(KK, True)\nprint\ntest(KK, False)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/13722\n\n",
    "created_at": "2012-11-19T06:30:54Z",
    "labels": [
        "linear algebra",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "regression in determinant of certain dense matrices",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13518",
    "user": "@ppurka"
}
```
Assignee: jason, was

Keywords: regression, determinant

See [this sage-support thread](https://groups.google.com/forum/?fromgroups#!topic/sage-support/jpRxVAQb1G8). Essentially, there is a huge (1000x) slowdown in computing the determinant of certain dense matrices. The slowdown happened sometime in between sage-4.7.2 and sage-4.8.


```
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: attach det.sage
  K = 30 , result = -9
  Sage Version 4.7.2, Release Date: 2011-10-29
  sparse=  True
  time  =  0.260323047638
| Sage Version 4.7.2, Release Date: 2011-10-29                       |
| Type notebook() for the GUI, and license() for information.        |
  K = 30 , result = -9
  Sage Version 4.7.2, Release Date: 2011-10-29
  sparse=  False
  time  =  0.026487827301
sage:
Exiting Sage (CPU time 0m1.77s, Wall time 0m29.31s).
Exiting spawned Gap process.


----------------------------------------------------------------------
----------------------------------------------------------------------
sage: attach det.sage
  K = 30 , result = -9
  Sage Version 4.8, Release Date: 2012-01-20
  sparse=  True
  time  =  0.011904001236
| Sage Version 4.8, Release Date: 2012-01-20                         |
| Type notebook() for the GUI, and license() for information.        |
  K = 30 , result = -9
  Sage Version 4.8, Release Date: 2012-01-20
  sparse=  False
  time  =  122.02807498 
```


`det.sage` contains the following code:

```python
import time

def test(K, SP):
  n=100
  f=taylor(prod((1-x**i) for i in range(1,n)),x,0,n)
  A=[f.coefficient(x,i) for i in range(n)]
  cf= [[A[i+j] for i in range(K)] for j in range(K)]
  m= matrix(ZZ, cf, sparse=SP)
  #
  t0=time.time()
  print "  K =", K, ", result =", m.det()
  t_det= time.time()-t0
  print " ",version()
  print "  sparse= ", SP
  print "  time  = ", t_det
  
KK=30
test(KK, True)
print
test(KK, False)
```


Issue created by migration from https://trac.sagemath.org/ticket/13722





---

archive/issue_comments_166913.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-09T15:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13518#issuecomment-166913",
    "user": "@mezzarobba"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_166914.json:
```json
{
    "body": "Looks like this has been fixed. (We might want to add a regression test, but I don't see anything really relevant.)\n\n```\n~/tmp$ sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Sage Version 6.2.beta3, Release Date: 2014-03-03                   \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: %attach det.sage\n  K = 30 , result = -9\n  Sage Version 6.2.beta3, Release Date: 2014-03-03\n  sparse=  True\n  time  =  0.00115394592285\n\n  K = 30 , result = -9\n  Sage Version 6.2.beta3, Release Date: 2014-03-03\n  sparse=  False\n  time  =  0.000802993774414\n```\n",
    "created_at": "2014-03-09T15:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13518#issuecomment-166914",
    "user": "@mezzarobba"
}
```

Looks like this has been fixed. (We might want to add a regression test, but I don't see anything really relevant.)

```
~/tmp$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 6.2.beta3, Release Date: 2014-03-03                   │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach det.sage
  K = 30 , result = -9
  Sage Version 6.2.beta3, Release Date: 2014-03-03
  sparse=  True
  time  =  0.00115394592285

  K = 30 , result = -9
  Sage Version 6.2.beta3, Release Date: 2014-03-03
  sparse=  False
  time  =  0.000802993774414
```




---

archive/issue_comments_166915.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-09T22:09:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13518#issuecomment-166915",
    "user": "@a-andre"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_166916.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-03-11T14:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13518#issuecomment-166916",
    "user": "@vbraun"
}
```

Resolution: fixed
