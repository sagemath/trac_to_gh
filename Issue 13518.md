# Issue 13518: regression in determinant of certain dense matrices

Issue created by migration from Trac.

Original creator: ppurka

Original creation time: 2012-11-19 06:30:54

Assignee: jason, was

Keywords: regression, determinant

See [this sage-support thread](https://groups.google.com/forum/?fromgroups#!topic/sage-support/jpRxVAQb1G8). Essentially, there is a huge (1000x) slowdown in computing the determinant of certain dense matrices. The slowdown happened sometime in between sage-4.7.2 and sage-4.8.


```
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: attach det.sage
  K = 30 , result = -9
  Sage Version 4.7.2, Release Date: 2011-10-29
  sparse=  True
  time  =  0.260323047638
| Sage Version 4.7.2, Release Date: 2011-10-29                       |
| Type notebook() for the GUI, and license() for information.        |
  K = 30 , result = -9
  Sage Version 4.7.2, Release Date: 2011-10-29
  sparse=  False
  time  =  0.026487827301
sage:
Exiting Sage (CPU time 0m1.77s, Wall time 0m29.31s).
Exiting spawned Gap process.


----------------------------------------------------------------------
----------------------------------------------------------------------
sage: attach det.sage
  K = 30 , result = -9
  Sage Version 4.8, Release Date: 2012-01-20
  sparse=  True
  time  =  0.011904001236
| Sage Version 4.8, Release Date: 2012-01-20                         |
| Type notebook() for the GUI, and license() for information.        |
  K = 30 , result = -9
  Sage Version 4.8, Release Date: 2012-01-20
  sparse=  False
  time  =  122.02807498 
```


`det.sage` contains the following code:

```python
import time

def test(K, SP):
  n=100
  f=taylor(prod((1-x**i) for i in range(1,n)),x,0,n)
  A=[f.coefficient(x,i) for i in range(n)]
  cf= [[A[i+j] for i in range(K)] for j in range(K)]
  m= matrix(ZZ, cf, sparse=SP)
  #
  t0=time.time()
  print "  K =", K, ", result =", m.det()
  t_det= time.time()-t0
  print " ",version()
  print "  sparse= ", SP
  print "  time  = ", t_det
  
KK=30
test(KK, True)
print
test(KK, False)
```



---

Comment by mmezzarobba created at 2014-03-09 15:43:17

Changing status from new to needs_review.


---

Comment by mmezzarobba created at 2014-03-09 15:43:17

Looks like this has been fixed. (We might want to add a regression test, but I don't see anything really relevant.)

```
~/tmp$ sage
┌────────────────────────────────────────────────────────────────────┐
│ Sage Version 6.2.beta3, Release Date: 2014-03-03                   │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: %attach det.sage
  K = 30 , result = -9
  Sage Version 6.2.beta3, Release Date: 2014-03-03
  sparse=  True
  time  =  0.00115394592285

  K = 30 , result = -9
  Sage Version 6.2.beta3, Release Date: 2014-03-03
  sparse=  False
  time  =  0.000802993774414
```



---

Comment by aapitzsch created at 2014-03-09 22:09:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-03-11 14:07:12

Resolution: fixed
