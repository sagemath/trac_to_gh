# Issue 29415: Implement polynomial subresultants

Issue created by migration from https://trac.sagemath.org/ticket/29652

Original creator: mmarco

Original creation time: 2020-05-05 16:43:36

CC:  soehms tscrim

Keywords: subresultants

This ticket implements the computation of the nonzero polynomial subresultants, following [1]

[1] http://www-math.univ-poitiers.fr/~ducos/Travaux/sous-resultants.pdf


---

Comment by mmarco created at 2020-05-05 16:49:29

Changing status from new to needs_review.


---

Comment by mmarco created at 2020-05-05 16:49:29

New commits:


---

Comment by tscrim created at 2020-05-05 22:27:55

Changing type from PLEASE CHANGE to enhancement.


---

Comment by tscrim created at 2020-05-05 22:27:55

Minor points for PEP8:

```diff
-delta = d-e
+delta = d - e
```


```diff
-                            a = a/2
-                            c = c**2/y
+                            a /= 2
+                            c = c**2 / y
                             if n >= a:
-                                c = c*x/y
+                                c = c * x / y
                                 n = n - a
-                        C = c*S[0]/y
                 else:
-                    C = B.leading_coefficient()**(delta-1) * B / s**(delta-1)
                 S = [ring(C)] + S
             else:
                 C = B
             if e == 0:
                 return S
-            B = A.pseudo_quo_rem(-B)[1]/(s**delta*A.leading_coefficient())
+            B = A.pseudo_quo_rem(-B)[1] / (s**delta * A.leading_coefficient())
```

Also could you remove a few of the blanklines after the `subresultants` before `composed_op` just to make it a bit more standardized?

Once these are done/ignored, you can set a positive review.


---

Comment by git created at 2020-05-06 14:21:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2020-05-06 14:21:53

Thanks for the review!


---

Comment by mmarco created at 2020-05-06 14:21:53

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2020-05-23 04:04:13

Documentation doesn't build because of an indentation error.

```
OSError: /dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/build/lib/sage/rings/polynomial/multi_polynomial_element.py:docstring of sage.rings.polynomial.multi_polynomial_element.MPolynomial_polydict.subresultants:14: WARNING: Unexpected indentation.
```

Which I think means there is one leading space too many on this line

```
             -x^3 - x^2*y + 6*x^2 + 5*x*y - 11*x - 6*y + 6]
```

and most likely in other continued lines in various docstrings of this ticket.


---

Comment by fbissey created at 2020-05-23 04:39:06

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2020-05-23 08:55:16

Replying to [comment:6 fbissey]:
> Documentation doesn't build because of an indentation error.
> {{{
> OSError: /dev/shm/portage/sci-mathematics/sage-9999/work/sage-9999/src-python3_7/build/lib/sage/rings/polynomial/multi_polynomial_element.py:docstring of sage.rings.polynomial.multi_polynomial_element.MPolynomial_polydict.subresultants:14: WARNING: Unexpected indentation.
> }}}
> Which I think means there is one leading space too many on this line
> {{{
>              -x^3 - x^2*y + 6*x^2 + 5*x*y - 11*x - 6*y + 6]
> }}}
> and most likely in other continued lines in various docstrings of this ticket.

No, that isn't the problem (this is done in many places in Sage, plus I like the space to differentiate it from other output and to match what Sage does). Actually it comes from:

```
multi_polynomial_element.subresultants
```

missing an `EXAMPLES::`.

Also, one other trivial change in 2 files:

```diff
-subresultants(self, other, variable= None):
+subresultants(self, other, variable=None):
```



---

Comment by fbissey created at 2020-05-23 08:59:58

I thought it was curious. Your explanation makes much more sense, I obviously don't write enough sage documentation.


---

Comment by tscrim created at 2020-05-23 21:44:42

Replying to [comment:9 fbissey]:
> I thought it was curious. Your explanation makes much more sense, I obviously don't write enough sage documentation.

You do quite a lot of more important things for Sage. `;P`


---

Comment by git created at 2020-05-23 22:53:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-05-24 00:48:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2020-05-24 00:48:57

Thanks for catching that up.


---

Comment by mmarco created at 2020-05-24 00:48:57

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2020-05-24 03:13:58

Thank you both.


---

Comment by tscrim created at 2020-05-24 03:13:58

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-06-03 22:32:26

Resolution: fixed
