# Issue 29936: ECL 20.4.24: More trouble with makeinfo

Issue created by migration from https://trac.sagemath.org/ticket/30173

Original creator: mkoeppe

Original creation time: 2020-07-19 02:08:39

CC:  dimpase @spaghettisalat @mwageringel

https://groups.google.com/d/msg/sage-devel/2zjlIEsKETU/PkM3_eh1CAAJ




---

Comment by dimpase created at 2020-07-19 07:40:21

this looks like a locale issue - makeinfo is found, but

```
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LC_ALL = "C.UTF-8",
	LANG = "en_US.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
user-guide/embedding.txi:14: warning: unreferenced node `Starting and Stopping'
user-guide/embedding.txi:14: warning: node `Catching Errors and Managing Interrupts' is next for `Starting and Stopping' in sectioning but not in menu
user-guide/embedding.txi:14: warning: node `Embedding ECL - Embedding Reference' is up for `Starting and Stopping' in sectioning but not in menu
user-guide/embedding.txi:11: node `Embedding ECL - Embedding Reference' lacks menu item for `Starting and Stopping' despite being its Up target
user-guide/embedding.txi:127: warning: unreferenced node `Catching Errors and Managing Interrupts'
user-guide/embedding.txi:127: warning: node `Starting and Stopping' is prev for `Catching Errors and Managing Interrupts' in sectioning but not in menu
user-guide/embedding.txi:127: warning: node `Embedding ECL - Embedding Reference' is up for `Catching Errors and Managing Interrupts' in sectioning but not in menu
user-guide/embedding.txi:11: node `Embedding ECL - Embedding Reference' lacks menu item for `Catching Errors and Managing Interrupts' despite being its Up target
make[7]: *** [ecl.info.gz] Error 1
make[6]: *** [info] Error 2
make[5]: *** [doc] Error 2
make[4]: *** [all] Error 2
```



---

Comment by dimpase created at 2020-07-19 07:42:07

or, perhaps, a very old version of makeinfo (however, it's in /usr/local/bin on a Mac,
so a special effort was needed to get an old one...)


---

Comment by @spaghettisalat created at 2020-07-19 09:47:50

How about just not building the manual at all by passing `--disable-manual` to the configure script? Running sagemath doesn't require the manual to be there anyway.


---

Comment by mkoeppe created at 2020-07-19 13:56:54

Replying to [comment:3 gh-spaghettisalat]:
> How about just not building the manual at all by passing `--disable-manual` to the configure script? Running sagemath doesn't require the manual to be there anyway.

Yes, that's what we should do on this ticket


---

Comment by mkoeppe created at 2020-07-19 14:41:16

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-07-19 14:41:16

New commits:


---

Comment by mkoeppe created at 2020-07-19 14:41:16

Changing priority from critical to major.


---

Comment by dimpase created at 2020-07-19 17:51:27

disabling this due to a possibly broken tool is a bit lame. Tools are meant to be either working or not installed.


---

Comment by dimpase created at 2020-07-19 23:15:25

a correct way would be to test makeinfo version in ECL itself.

Anyhow, the old makeinfo on macOS which creates problems can be tested for by

```
makeinfo -c foo 2>&1 | grep invalid
```


this returns something nonempty on makeinfo 4.8, and will be empty on a modern makeinfo - or when there is no makeinfo available.

I suggest that this test is used in spkg-install to test whether the flag `--disable-manual` should be used, or not.


---

Comment by dimpase created at 2020-07-20 08:51:54

I've submitted https://gitlab.com/embeddable-common-lisp/ecl/-/merge_requests/221 upstream, to fix this properly.


---

Comment by mkoeppe created at 2020-07-20 21:08:47

Great. We could still suppress building the manual if `"$SAGE_SPKG_INSTALL_DOCS" != yes` like on the maxima upgrade ticket (#30063).


---

Comment by git created at 2020-07-20 21:16:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-07-20 21:20:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2020-07-26 22:38:35

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-07-26 22:38:35

lgtm


---

Comment by vbraun created at 2020-08-02 08:20:33

Resolution: fixed
