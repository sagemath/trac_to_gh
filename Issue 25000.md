# Issue 25000: normlize_coordinates for projective morphism not fully normalized

Issue created by migration from Trac.

Original creator: bhutz

Original creation time: 2018-04-24 13:21:22

normalize coordinate should remove the gcd from the coefficients when it is possible to do so. However, it does not always remove enough:


```
sage: K.<w> = QuadraticField(5)
sage: P.<x,y> = ProjectiveSpace(K, 1)
sage: f = DynamicalSystem([w*x^2 + (1/5*w)*y^2, w*y^2])
sage: f.normalize_coordinates();f
```

fails to have the common 'w' removed. Part of the issue appear to be the gcd for maximal orders are returned as number field elements instead of maximal order elements

```
sage: K.<a> = NumberField(x^3 - 7)
sage: R = K.maximal_order()
sage: R(a).gcd(R(2*a)).parent()
```




---

Comment by bhutz created at 2018-04-24 13:49:53

Changing status from new to needs_review.


---

Comment by bhutz created at 2018-04-24 13:49:53

New commits:


---

Comment by @fifipomme created at 2019-06-27 13:20:38

We found 2 minor errors (see below) where the output of the example differs by a minus sign. Otherwise everything else looked great!


```
sage: P.<x,y> = QQ[]
sage: f = DynamicalSystem([-4*y^2, 9*x^2 - 12*x*y])
sage: f.reduced_form()
```



```
sage: K.<w> = QuadraticField(5)
sage: P.<x,y> = ProjectiveSpace(K, 1)
sage: f = DynamicalSystem([w*x^2 + (1/5*w)*y^2, w*y^2])
sage: f.normalize_coordinates();f
```



---

Comment by @fifipomme created at 2019-06-27 13:20:38

Changing status from needs_review to needs_work.


---

Comment by bhutz created at 2019-06-27 14:03:42

ok, thanks. I'll take a look at those examples. since the branch is so old, I'm merging in beta8.rc1 and rebuilding so I can take a look at this. I'll push a new branch when that is done.


---

Comment by git created at 2019-06-27 16:09:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bhutz created at 2019-06-27 16:10:17

Changing status from needs_work to needs_review.


---

Comment by @jasminecamero created at 2019-07-18 13:48:29

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-07-23 21:03:53

Resolution: fixed


---

Comment by bhutz created at 2019-08-13 17:53:52

Changing keywords from "" to "SI2019".
