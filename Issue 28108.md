# Issue 28108: Bug with NumberField.abs_val

archive/issues_028108.json:
```json
{
    "body": "CC:  @slel @JohnCremona @roed314 @jhpalmieri\n\nThe following code fail:\n\n\n```\nsage: K.<xi> = NumberField(x^3-3)\nsage: v_fin = tuple(K.primes_above(3))[0]\nsage: abs_val(K, v_fin, K(0))\n```\n\n\nIt should return 0.\nSee also ticket #28241\n\nIssue created by migration from https://trac.sagemath.org/ticket/28345\n\n",
    "created_at": "2019-08-12T13:09:37Z",
    "labels": [
        "number fields",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Bug with NumberField.abs_val",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28108",
    "user": "mercatp"
}
```
CC:  @slel @JohnCremona @roed314 @jhpalmieri

The following code fail:


```
sage: K.<xi> = NumberField(x^3-3)
sage: v_fin = tuple(K.primes_above(3))[0]
sage: abs_val(K, v_fin, K(0))
```


It should return 0.
See also ticket #28241

Issue created by migration from https://trac.sagemath.org/ticket/28345





---

archive/issue_comments_397106.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-08-12T13:42:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397106",
    "user": "mercatp"
}
```

New commits:



---

archive/issue_comments_397107.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-09-05T12:07:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397107",
    "user": "@alexjbest"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_397108.json:
```json
{
    "body": "I set this to needs review as it seems it is done, so the patchbots can check it.\n\nThe other way to do this would be to ensure that `p^(-Infinity)` returns 0 in some way, but I don't suppose that really matters.",
    "created_at": "2019-09-05T12:07:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397108",
    "user": "@alexjbest"
}
```

I set this to needs review as it seems it is done, so the patchbots can check it.

The other way to do this would be to ensure that `p^(-Infinity)` returns 0 in some way, but I don't suppose that really matters.



---

archive/issue_comments_397109.json:
```json
{
    "body": "Returning `0` gives an `int` which is of the wrong type, so please change it to `return R.zero()` instead. Moreover, a blank line is needed after `TESTS::` and please remove the trailing whitespace in the line above that. Also enter your full name in the authors field.\n\nI am not too familiar with the theory, so it would be good if someone can confirm this is mathematically correct.",
    "created_at": "2019-12-01T19:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397109",
    "user": "@mwageringel"
}
```

Returning `0` gives an `int` which is of the wrong type, so please change it to `return R.zero()` instead. Moreover, a blank line is needed after `TESTS::` and please remove the trailing whitespace in the line above that. Also enter your full name in the authors field.

I am not too familiar with the theory, so it would be good if someone can confirm this is mathematically correct.



---

archive/issue_comments_397110.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-12-01T19:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397110",
    "user": "@mwageringel"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_397111.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397111",
    "user": "@embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_397112.json:
```json
{
    "body": "Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397112",
    "user": "@mkoeppe"
}
```

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_comments_397113.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397113",
    "user": "@mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_397114.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-08-01T07:41:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397114",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_397115.json:
```json
{
    "body": "here is a brand new branch, please review\n----\nNew commits:",
    "created_at": "2021-08-01T07:41:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397115",
    "user": "@fchapoton"
}
```

here is a brand new branch, please review
----
New commits:



---

archive/issue_comments_397116.json:
```json
{
    "body": "green bot, please review this very simple ticket",
    "created_at": "2021-08-01T12:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397116",
    "user": "@fchapoton"
}
```

green bot, please review this very simple ticket



---

archive/issue_comments_397117.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-08-01T13:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397117",
    "user": "@slel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_397118.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-08-29T09:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28108",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28108#issuecomment-397118",
    "user": "@vbraun"
}
```

Resolution: fixed
