# Issue 30710: src/doc/bootstrap: Simplify by using new options of "sage -package list"

Issue created by migration from https://trac.sagemath.org/ticket/30947

Original creator: mkoeppe

Original creation time: 2020-11-22 20:31:51

CC:  slabbe slelievre




---

Comment by mkoeppe created at 2020-11-24 01:31:34

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-11-24 01:31:34

Last 10 new commits:


---

Comment by slabbe created at 2020-11-24 08:58:52

I assume the only commit to be reviewed here is this one: https://git.sagemath.org/sage.git/commit/?h=5ad29d5e5686a403f51d6b09d5ba0ea02face4e9

I see that it simplifies the code by removing two `if ... fi` clauses twice.

Do you accept to add a commit which unindent twice the content of the two for loops?


---

Comment by slabbe created at 2020-11-24 10:59:22

Running `make ptestlong` with the current branch finished with no error (except the unrelated `sage -t --long --warn-long 55.7 --random-seed=0 src/sage/interfaces/singular.py  # Killed due to segmentation fault`).

You can change the status to positive review on my behalf once the unindentation is done.


---

Comment by mkoeppe created at 2020-11-24 17:30:28

Replying to [comment:4 slabbe]:
> Do you accept to add a commit which unindent twice the content of the two for loops?

I'd rather not on this ticket because there are several tickets out there that touch the same code.


---

Comment by slabbe created at 2020-11-24 19:27:39

Changing status from needs_review to positive_review.


---

Comment by slabbe created at 2020-11-24 19:28:08

ok, then unindentation can wait.


---

Comment by mkoeppe created at 2020-11-24 19:46:27

Thank you!


---

Comment by slabbe created at 2020-11-25 09:57:45

Changing status from positive_review to needs_work.


---

Comment by slabbe created at 2020-11-25 09:58:45

(Oups, since the description of the ticket is empty, I end up writing my comment in that box...)

The branch has now a merge conflict on top of 9.3.beta2.


---

Comment by git created at 2020-11-25 22:16:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-11-25 22:17:05

Changing status from needs_work to positive_review.


---

Comment by mkoeppe created at 2020-11-25 22:17:05

Merged cleanly


---

Comment by slabbe created at 2020-12-09 09:26:47

The color of the branch name is red again. Is there a merge conflict with beta3 ?


---

Comment by slabbe created at 2020-12-09 09:33:51

I just tested on my machine and it merges cleanly on 9.3.beta3. So I don't know what is hapenning with the red color here.


---

Comment by slabbe created at 2020-12-09 10:17:20

While reviewing #29124, I see an issue, but it seems related to this ticket instead.

When I run `tox -e docker-archlinux-minimal -- config.status`, the command finishes with
` docker-archlinux-minimal: commands succeeded congratulations :)`, but some red lines showing `sage: command not found` related to file `src/doc/bootstrap` are printed in the process:


```
...
+ ./bootstrap
rm -rf config configure build/make/Makefile-auto.in
rm -f src/doc/en/installation/*.txt
rm -rf src/doc/en/reference/spkg/*.rst
rm -f src/doc/en/reference/repl/*.txt
rm -f environment.yml
rm -f src/environment.yml
rm -f environment-optional.yml
rm -f src/environment-optional.yml
src/doc/bootstrap: line 34: sage: command not found
src/doc/bootstrap:92: installing src/doc/en/installation/arch.txt and src/doc/en/installation/arch-optional.txt
src/doc/bootstrap: line 34: sage: command not found
src/doc/bootstrap:92: installing src/doc/en/installation/debian.txt and src/doc/en/installation/debian-optional.txt
src/doc/bootstrap: line 34: sage: command not found
src/doc/bootstrap:92: installing src/doc/en/installation/fedora.txt and src/doc/en/installation/fedora-optional.txt
src/doc/bootstrap: line 34: sage: command not found
src/doc/bootstrap:92: installing src/doc/en/installation/cygwin.txt and src/doc/en/installation/cygwin-optional.txt
src/doc/bootstrap: line 34: sage: command not found
src/doc/bootstrap:92: installing src/doc/en/installation/homebrew.txt and src/doc/en/installation/homebrew-optional.txt
src/doc/bootstrap: line 34: sage: command not found
src/doc/bootstrap:66: installing environment.yml, environment-optional.yml, src/environment.yml and src/environment-optional.yml
src/doc/bootstrap:103: installing src/doc/en/reference/spkg/*.rst
src/doc/bootstrap: line 115: sage: command not found
src/doc/bootstrap:131: installing src/doc/en/reference/repl/options.txt
bootstrap:73: installing 'config/config.rpath'
configure.ac:305: installing 'config/compile'
configure.ac:89: installing 'config/config.guess'
configure.ac:89: installing 'config/config.sub'
configure.ac:43: installing 'config/install-sh'
configure.ac:43: installing 'config/missing'
...
```


Below is the same part of the log on top of 9.3.beta3 which do not have the `sage command not found` issue:


```
...
+ ./bootstrap
rm -rf config configure build/make/Makefile-auto.in
rm -f src/doc/en/installation/*.txt
rm -rf src/doc/en/reference/spkg/*.rst
rm -f src/doc/en/reference/repl/*.txt
rm -f environment.yml
rm -f src/environment.yml
rm -f environment-optional.yml
rm -f src/environment-optional.yml
src/doc/bootstrap:100: installing src/doc/en/installation/arch.txt and src/doc/en/installation/arch-optional.txt
src/doc/bootstrap:100: installing src/doc/en/installation/debian.txt and src/doc/en/installation/debian-optional.txt
src/doc/bootstrap:100: installing src/doc/en/installation/fedora.txt and src/doc/en/installation/fedora-optional.txt
src/doc/bootstrap:100: installing src/doc/en/installation/cygwin.txt and src/doc/en/installation/cygwin-optional.txt
src/doc/bootstrap:100: installing src/doc/en/installation/homebrew.txt and src/doc/en/installation/homebrew-optional.txt
src/doc/bootstrap:74: installing environment.yml, environment-optional.yml, src/environment.yml and src/environment-optional.yml
src/doc/bootstrap:111: installing src/doc/en/reference/spkg/*.rst
src/doc/bootstrap:143: installing src/doc/en/reference/repl/options.txt
bootstrap:73: installing 'config/config.rpath'
configure.ac:305: installing 'config/compile'
configure.ac:89: installing 'config/config.guess'
configure.ac:89: installing 'config/config.sub'
configure.ac:43: installing 'config/install-sh'
configure.ac:43: installing 'config/missing'
```



---

Comment by slabbe created at 2020-12-09 10:17:20

Changing status from positive_review to needs_info.


---

Comment by slabbe created at 2020-12-09 10:22:22

Changing status from needs_info to needs_work.


---

Comment by git created at 2020-12-10 04:56:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-12-10 04:57:22

Replying to [comment:15 slabbe]:
> I just tested on my machine and it merges cleanly on 9.3.beta3. So I don't know what is hapenning with the red color here.
The trac merger is configured to be a bit pickier than default git, it seems. 
I've merged the beta and pushed it to the ticket.


---

Comment by git created at 2020-12-10 05:08:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-12-10 05:34:35

Replying to [comment:16 slabbe]:
> When I run `tox -e docker-archlinux-minimal -- config.status`, the command finishes with
> ` docker-archlinux-minimal: commands succeeded congratulations :)`, but some red lines showing `sage: command not found` related to file `src/doc/bootstrap` are printed in the process:
> 
> {{{
> src/doc/bootstrap: line 34: sage: command not found
> }}}

Thanks for catching this! Fixed.


---

Comment by mkoeppe created at 2020-12-10 05:34:43

Changing status from needs_work to needs_review.


---

Comment by slabbe created at 2020-12-10 08:39:04

I confirm the issue is fixed.


---

Comment by slabbe created at 2020-12-10 08:39:04

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-12-10 16:29:05

Thank you!


---

Comment by mkoeppe created at 2020-12-10 16:29:05

Changing keywords from "" to "sd111".


---

Comment by vbraun created at 2020-12-14 23:52:49

Resolution: fixed
