# Issue 17334: Method tracing fixture

Issue created by migration from Trac.

Original creator: gagern

Original creation time: 2014-12-30 19:43:17

CC:  niles

This is a spin-off from #16571.

I'd like to introduce a helper method for doctests which will trace a given method of an object, printing its interaction with its surroundings: method entry and exit, arguments and return value, as well as access to other members and methods of this object. For details see the docstring of the branch I'll attach.


---

Comment by gagern created at 2015-01-02 21:52:27

Changing status from new to needs_review.


---

Comment by gagern created at 2015-01-02 21:52:27

Replying to [comment:26:ticket:16571 niles]:
> * The function `traceMethod` should be `trace_method` to fit the standard naming convention.  Was there a strong reason for the name you gave it?  If not, please change.

Done.

> * `PropertyAccessTracerProxy.__init__` and `PropertyAccessTracerProxy.fmt` need docstrings

Moved class docstring to init method, which is explicitely allowed by the dev manual you mentioned.

> * An author block and a copyright block are necessary at the top of the file.  See [here](http://www.sagemath.org/doc/developer/coding_basics.html#headings-of-sage-library-code-files).

Done that, thanks!

> * While you're at it, why not expand the documentation?  This could be useful much more generally, and a very short description at the top of the document would help explain what it does.

I wrote some text at the beginning of the file to indicate what kind of code I'd eventually expect to be contained in this module. I think that my tracing code might not remain the only fixture, therefore limiting the documentation to just that seems like a bad restriction. I did however extend the documentation of the relevant classes as well, so they might now be easier to use on their own.

> * It doesn't make sense to leave `fixtures.py` out of the reference manual.  I think you add it by adding a line in `src/doc/en/reference/doctest/index.rst`, but I may be misremembering.

Worked fine, thanks!

> * There are two tests in `doctest/control.py` that need to be updated because of the new fixtures file. Otherwise all tests pass.

Oh! I hadn't thought to run doctests in what I considered unrelated files, thanks for doing that! Fixed now.
----
New commits:


---

Comment by git created at 2015-01-02 21:58:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by niles created at 2015-01-05 17:40:29

I'm confused about the docstring for `reproducible_repr` saying "All types which require special handling are covered by the examples below".  Aren't dicts an obvious case that also would require special handling?


---

Comment by git created at 2015-01-05 22:19:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by gagern created at 2015-01-05 22:22:58

Replying to [comment:5 niles]:
> I'm confused about the docstring for `reproducible_repr` saying "All types which require special handling are covered by the examples below".  Aren't dicts an obvious case that also would require special handling?

You are right, the documentation was misleading. The section was more about types for which I _have_ special handling. There might be more types (e.g. `dict` at the time you read the code) which would _require_ such handling but didn't receive it. I've clarified things now, and also added handling for `dict` and `list`.


---

Comment by niles created at 2015-01-06 13:24:03

ok, looks good!


---

Comment by niles created at 2015-01-06 13:24:03

Changing status from needs_review to positive_review.


---

Comment by gagern created at 2015-01-06 17:32:51

Thanks for the review.


---

Comment by vbraun created at 2015-01-12 18:11:31

Resolution: fixed
