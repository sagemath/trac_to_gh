# Issue 21634: Test if a graph is apx

archive/issues_021634.json:
```json
{
    "body": "A graph is apex if it can be made planar by the removal of a single vertex. See [`the wikipedia article on Apex graph`](https://en.wikipedia.org/wiki/Apex_graph) for more details.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21871\n\n",
    "created_at": "2016-11-13T11:43:04Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "title": "Test if a graph is apx",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21634",
    "user": "dcoudert"
}
```
A graph is apex if it can be made planar by the removal of a single vertex. See [`the wikipedia article on Apex graph`](https://en.wikipedia.org/wiki/Apex_graph) for more details.

Issue created by migration from https://trac.sagemath.org/ticket/21871





---

archive/issue_comments_300523.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-11-13T12:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300523",
    "user": "dcoudert"
}
```

New commits:



---

archive/issue_comments_300524.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-11-13T12:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300524",
    "user": "dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_300525.json:
```json
{
    "body": "Ready to be reviewed.",
    "created_at": "2016-11-13T12:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300525",
    "user": "dcoudert"
}
```

Ready to be reviewed.



---

archive/issue_comments_300526.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-13T12:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300526",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_300527.json:
```json
{
    "body": "I think that just `if certificate:` would be good. It is how many certificate-options are currently done, i.e. for example `P.dimension(certificate=[])` works a poset `P`. It is \"pythonic\" way to code.\n\nI am not sure about the design where `certificate` kind of returns list of all possible \"certificates\". I would make two functions, other to be `apex_vertices()` or something like that. But maybe others can comment this too.",
    "created_at": "2016-11-13T14:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300527",
    "user": "jmantysalo"
}
```

I think that just `if certificate:` would be good. It is how many certificate-options are currently done, i.e. for example `P.dimension(certificate=[])` works a poset `P`. It is "pythonic" way to code.

I am not sure about the design where `certificate` kind of returns list of all possible "certificates". I would make two functions, other to be `apex_vertices()` or something like that. But maybe others can comment this too.



---

archive/issue_comments_300528.json:
```json
{
    "body": "Fails for immutable graphs --> *needs_work*.",
    "created_at": "2016-11-13T14:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300528",
    "user": "jmantysalo"
}
```

Fails for immutable graphs --> *needs_work*.



---

archive/issue_comments_300529.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-11-13T14:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300529",
    "user": "jmantysalo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_300530.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-13T15:50:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300530",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_300531.json:
```json
{
    "body": "So far I fixed the issue with immutable graphs, and I also added the feature to `graph_classes`. So we can write:\n\n```\nsage: G = graphs.PetersenGraph()\nsage: G in graph_classes.Apex\nFalse\nsage: G = graphs.Grid2dGraph(5,5)\nsage: G in graph_classes.Apex\nTrue\nsage: G = graphs.RandomBarabasiAlbert(100,2)\nsage: G = G.copy(immutable=True)\nsage: G.is_immutable()\nTrue\nsage: G in graph_classes.Apex\nFalse\nsage: G.is_apex()\nFalse\nsage: G = graphs.Grid2dGraph(5,5)\nsage: G.add_path([(1,1),'x',(3,3)])\nsage: G = G.copy(immutable=True)\nsage: G in graph_classes.Apex\nTrue\n```\n\n\nNow, concerning the behavior of `certificate`. You are right that it is too complex. What I could do is either to return the list of apex vertices when set to True, or to remove that parameter from method `is_apex` and add a method `apex_vertices`.\nLet me know what you prefer.\n\nDavid.",
    "created_at": "2016-11-13T16:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300531",
    "user": "dcoudert"
}
```

So far I fixed the issue with immutable graphs, and I also added the feature to `graph_classes`. So we can write:

```
sage: G = graphs.PetersenGraph()
sage: G in graph_classes.Apex
False
sage: G = graphs.Grid2dGraph(5,5)
sage: G in graph_classes.Apex
True
sage: G = graphs.RandomBarabasiAlbert(100,2)
sage: G = G.copy(immutable=True)
sage: G.is_immutable()
True
sage: G in graph_classes.Apex
False
sage: G.is_apex()
False
sage: G = graphs.Grid2dGraph(5,5)
sage: G.add_path([(1,1),'x',(3,3)])
sage: G = G.copy(immutable=True)
sage: G in graph_classes.Apex
True
```


Now, concerning the behavior of `certificate`. You are right that it is too complex. What I could do is either to return the list of apex vertices when set to True, or to remove that parameter from method `is_apex` and add a method `apex_vertices`.
Let me know what you prefer.

David.



---

archive/issue_comments_300532.json:
```json
{
    "body": "I would prefer adding `apex_vertices()`. (With SEEALSO-crosslinks in docstrings of course. I would also crosslink `is_planar` <-> `is_apex`.)",
    "created_at": "2016-11-13T16:28:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300532",
    "user": "jmantysalo"
}
```

I would prefer adding `apex_vertices()`. (With SEEALSO-crosslinks in docstrings of course. I would also crosslink `is_planar` <-> `is_apex`.)



---

archive/issue_comments_300533.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-13T18:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300533",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_300534.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-11-13T18:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300534",
    "user": "dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_300535.json:
```json
{
    "body": "I have added method `apex_vertices` with a parameter to limit the number of returned apex vertices. This is mostly useful for the `is_apex` method which only ask for one apex vertex.\n\nI have also added the see also sections.",
    "created_at": "2016-11-13T18:06:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300535",
    "user": "dcoudert"
}
```

I have added method `apex_vertices` with a parameter to limit the number of returned apex vertices. This is mostly useful for the `is_apex` method which only ask for one apex vertex.

I have also added the see also sections.



---

archive/issue_comments_300536.json:
```json
{
    "body": "OK, this works. One note about code and some bikeshedding:\n\nWhy\n\n\n```\nH = Graph([e for e in self.edge_iterator(labels=0)], immutable=False)\n```\n\n\nand not just `H = self.to_simple()`?\n\n- Exception string should start with lowercase and not end to a dot. I don't like it, but this was discussed in sage-devel, and this is how plain Python does.\n- Example \"A 2D grid is apex, and it remains apex when adding a universal vertex\" is odd at `is_apex()`, when you do not add the apex vertex. Maybe that example could be removed, and left only to `apex_vertices()`.\n- `len(apex)>=k` should be `len(apex) >= k`. This is some PEP whose number I don't remember.\n- Input parameter \"k: when\" should be \"k -- when\", copy the format from some existing function.",
    "created_at": "2016-11-13T20:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300536",
    "user": "jmantysalo"
}
```

OK, this works. One note about code and some bikeshedding:

Why


```
H = Graph([e for e in self.edge_iterator(labels=0)], immutable=False)
```


and not just `H = self.to_simple()`?

- Exception string should start with lowercase and not end to a dot. I don't like it, but this was discussed in sage-devel, and this is how plain Python does.
- Example "A 2D grid is apex, and it remains apex when adding a universal vertex" is odd at `is_apex()`, when you do not add the apex vertex. Maybe that example could be removed, and left only to `apex_vertices()`.
- `len(apex)>=k` should be `len(apex) >= k`. This is some PEP whose number I don't remember.
- Input parameter "k: when" should be "k -- when", copy the format from some existing function.



---

archive/issue_comments_300537.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-11-13T20:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300537",
    "user": "jmantysalo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_300538.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-13T22:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300538",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_300539.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-13T22:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300539",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_300540.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-11-13T22:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300540",
    "user": "dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_300541.json:
```json
{
    "body": "Replying to [comment:12 jmantysalo]:\n> OK, this works. One note about code and some bikeshedding:\n> \n> Why\n> \n> {{{\n> H = Graph([e for e in self.edge_iterator(labels=0)], immutable=False)\n> }}}\n> \n> and not just `H = self.to_simple()`?\n\nI could use `self.to_simple(immutable=False)`. However, here we don't care of labels and the `to_simple` method only proposes to keep all, min or max labels. No clear option is proposed to remove labels. So I prefers to use `H = Graph(self.edges(labels=0), immutable=False, loops=False, multiedges=False)` to get a clean and light copy.\n\n\n> - Exception string should start with lowercase and not end to a dot. I don't like it, but this was discussed in sage-devel, and this is how plain Python does.\n\nok.\n\n> - Example \"A 2D grid is apex, and it remains apex when adding a universal vertex\" is odd at `is_apex()`, when you do not add the apex vertex. Maybe that example could be removed, and left only to `apex_vertices()`.\n\ndone\n\n> - `len(apex)>=k` should be `len(apex) >= k`. This is some PEP whose number I don't remember.\n\nWell, it would be weird to remember all these numbers ;)\n\n> - Input parameter \"k: when\" should be \"k -- when\", copy the format from some existing function.\nRight, I forgot.\n\nThanks for the comments.",
    "created_at": "2016-11-13T22:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300541",
    "user": "dcoudert"
}
```

Replying to [comment:12 jmantysalo]:
> OK, this works. One note about code and some bikeshedding:
> 
> Why
> 
> {{{
> H = Graph([e for e in self.edge_iterator(labels=0)], immutable=False)
> }}}
> 
> and not just `H = self.to_simple()`?

I could use `self.to_simple(immutable=False)`. However, here we don't care of labels and the `to_simple` method only proposes to keep all, min or max labels. No clear option is proposed to remove labels. So I prefers to use `H = Graph(self.edges(labels=0), immutable=False, loops=False, multiedges=False)` to get a clean and light copy.


> - Exception string should start with lowercase and not end to a dot. I don't like it, but this was discussed in sage-devel, and this is how plain Python does.

ok.

> - Example "A 2D grid is apex, and it remains apex when adding a universal vertex" is odd at `is_apex()`, when you do not add the apex vertex. Maybe that example could be removed, and left only to `apex_vertices()`.

done

> - `len(apex)>=k` should be `len(apex) >= k`. This is some PEP whose number I don't remember.

Well, it would be weird to remember all these numbers ;)

> - Input parameter "k: when" should be "k -- when", copy the format from some existing function.
Right, I forgot.

Thanks for the comments.



---

archive/issue_comments_300542.json:
```json
{
    "body": "Thanks. No more comments.\n\nReplying to [comment:15 dcoudert]:\n\n> the `to_simple` method only proposes to keep all, min or max labels. No clear option is proposed to remove labels.\n\nAh, OK. I guess it should have an option for that, but that's a place for another ticket.",
    "created_at": "2016-11-14T05:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300542",
    "user": "jmantysalo"
}
```

Thanks. No more comments.

Replying to [comment:15 dcoudert]:

> the `to_simple` method only proposes to keep all, min or max labels. No clear option is proposed to remove labels.

Ah, OK. I guess it should have an option for that, but that's a place for another ticket.



---

archive/issue_comments_300543.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-11-14T05:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300543",
    "user": "jmantysalo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_300544.json:
```json
{
    "body": "Thank you for the review.",
    "created_at": "2016-11-14T08:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300544",
    "user": "dcoudert"
}
```

Thank you for the review.



---

archive/issue_comments_300545.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-11-17T18:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21634",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21634#issuecomment-300545",
    "user": "vbraun"
}
```

Resolution: fixed
