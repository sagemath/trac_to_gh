# Issue 21634: Test if a graph is apx

Issue created by migration from https://trac.sagemath.org/ticket/21871

Original creator: dcoudert

Original creation time: 2016-11-13 11:43:04

A graph is apex if it can be made planar by the removal of a single vertex. See [`the wikipedia article on Apex graph`](https://en.wikipedia.org/wiki/Apex_graph) for more details.


---

Comment by dcoudert created at 2016-11-13 12:15:09

New commits:


---

Comment by dcoudert created at 2016-11-13 12:19:42

Changing status from new to needs_review.


---

Comment by dcoudert created at 2016-11-13 12:19:42

Ready to be reviewed.


---

Comment by git created at 2016-11-13 12:42:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-11-13 14:36:39

I think that just `if certificate:` would be good. It is how many certificate-options are currently done, i.e. for example `P.dimension(certificate=[])` works a poset `P`. It is "pythonic" way to code.

I am not sure about the design where `certificate` kind of returns list of all possible "certificates". I would make two functions, other to be `apex_vertices()` or something like that. But maybe others can comment this too.


---

Comment by jmantysalo created at 2016-11-13 14:44:18

Fails for immutable graphs --> _needs_work_.


---

Comment by jmantysalo created at 2016-11-13 14:44:18

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-11-13 15:50:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2016-11-13 16:01:20

So far I fixed the issue with immutable graphs, and I also added the feature to `graph_classes`. So we can write:

```
sage: G = graphs.PetersenGraph()
sage: G in graph_classes.Apex
False
sage: G = graphs.Grid2dGraph(5,5)
sage: G in graph_classes.Apex
True
sage: G = graphs.RandomBarabasiAlbert(100,2)
sage: G = G.copy(immutable=True)
sage: G.is_immutable()
True
sage: G in graph_classes.Apex
False
sage: G.is_apex()
False
sage: G = graphs.Grid2dGraph(5,5)
sage: G.add_path([(1,1),'x',(3,3)])
sage: G = G.copy(immutable=True)
sage: G in graph_classes.Apex
True
```


Now, concerning the behavior of `certificate`. You are right that it is too complex. What I could do is either to return the list of apex vertices when set to True, or to remove that parameter from method `is_apex` and add a method `apex_vertices`.
Let me know what you prefer.

David.


---

Comment by jmantysalo created at 2016-11-13 16:28:54

I would prefer adding `apex_vertices()`. (With SEEALSO-crosslinks in docstrings of course. I would also crosslink `is_planar` <-> `is_apex`.)


---

Comment by git created at 2016-11-13 18:02:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2016-11-13 18:06:48

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2016-11-13 18:06:48

I have added method `apex_vertices` with a parameter to limit the number of returned apex vertices. This is mostly useful for the `is_apex` method which only ask for one apex vertex.

I have also added the see also sections.


---

Comment by jmantysalo created at 2016-11-13 20:16:07

OK, this works. One note about code and some bikeshedding:

Why


```
H = Graph([e for e in self.edge_iterator(labels=0)], immutable=False)
```


and not just `H = self.to_simple()`?

- Exception string should start with lowercase and not end to a dot. I don't like it, but this was discussed in sage-devel, and this is how plain Python does.
- Example "A 2D grid is apex, and it remains apex when adding a universal vertex" is odd at `is_apex()`, when you do not add the apex vertex. Maybe that example could be removed, and left only to `apex_vertices()`.
- `len(apex)>=k` should be `len(apex) >= k`. This is some PEP whose number I don't remember.
- Input parameter "k: when" should be "k -- when", copy the format from some existing function.


---

Comment by jmantysalo created at 2016-11-13 20:16:07

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-11-13 22:23:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-11-13 22:41:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2016-11-13 22:49:58

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2016-11-13 22:49:58

Replying to [comment:12 jmantysalo]:
> OK, this works. One note about code and some bikeshedding:
> 
> Why
> 
> {{{
> H = Graph([e for e in self.edge_iterator(labels=0)], immutable=False)
> }}}
> 
> and not just `H = self.to_simple()`?

I could use `self.to_simple(immutable=False)`. However, here we don't care of labels and the `to_simple` method only proposes to keep all, min or max labels. No clear option is proposed to remove labels. So I prefers to use `H = Graph(self.edges(labels=0), immutable=False, loops=False, multiedges=False)` to get a clean and light copy.


> - Exception string should start with lowercase and not end to a dot. I don't like it, but this was discussed in sage-devel, and this is how plain Python does.

ok.

> - Example "A 2D grid is apex, and it remains apex when adding a universal vertex" is odd at `is_apex()`, when you do not add the apex vertex. Maybe that example could be removed, and left only to `apex_vertices()`.

done

> - `len(apex)>=k` should be `len(apex) >= k`. This is some PEP whose number I don't remember.

Well, it would be weird to remember all these numbers ;)

> - Input parameter "k: when" should be "k -- when", copy the format from some existing function.
Right, I forgot.

Thanks for the comments.


---

Comment by jmantysalo created at 2016-11-14 05:04:23

Thanks. No more comments.

Replying to [comment:15 dcoudert]:

> the `to_simple` method only proposes to keep all, min or max labels. No clear option is proposed to remove labels.

Ah, OK. I guess it should have an option for that, but that's a place for another ticket.


---

Comment by jmantysalo created at 2016-11-14 05:04:23

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2016-11-14 08:04:08

Thank you for the review.


---

Comment by vbraun created at 2016-11-17 18:01:45

Resolution: fixed
