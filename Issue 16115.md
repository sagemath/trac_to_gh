# Issue 16115: TransitiveIdeal -> RecursivelyEnumeratedSet in the sage library

archive/issues_016115.json:
```json
{
    "body": "CC:  @anneschilling @tscrim\n\n`TransitiveIdeal` and `TransitiveIealGraded` are used in the code of `sage/combinat`, `sage/categories` and `sage/groups` at least. These should be replaced by `RecursivelyEnumeratedSet` for speed improvements and also to avoid issues explained in #6637.\n\nThis is a follow up of #6637 where `TransitiveIdeal` and `TransitiveIealGraded` have been deprecated.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16352\n\n",
    "created_at": "2014-05-13T20:02:35Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "TransitiveIdeal -> RecursivelyEnumeratedSet in the sage library",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16115",
    "user": "https://github.com/seblabbe"
}
```
CC:  @anneschilling @tscrim

`TransitiveIdeal` and `TransitiveIealGraded` are used in the code of `sage/combinat`, `sage/categories` and `sage/groups` at least. These should be replaced by `RecursivelyEnumeratedSet` for speed improvements and also to avoid issues explained in #6637.

This is a follow up of #6637 where `TransitiveIdeal` and `TransitiveIealGraded` have been deprecated.

Issue created by migration from https://trac.sagemath.org/ticket/16352





---

archive/issue_events_048182.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16115#event-48182"
}
```



---

archive/issue_comments_209988.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-04-03T14:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209988",
    "user": "https://github.com/seblabbe"
}
```

New commits:



---

archive/issue_comments_209989.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd66\".",
    "created_at": "2015-04-03T14:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209989",
    "user": "https://github.com/seblabbe"
}
```

Changing keywords from "" to "sd66".



---

archive/issue_comments_209990.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-03T14:40:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_209991.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-03T14:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209991",
    "user": "https://github.com/seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_209992.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-10T18:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209992",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_209993.json:
```json
{
    "body": "Salut S\u00e9bastien,\n\nYour branch is based on sage-6.5!! Would you mind rebasing on sage-6.6.rc2?\n\nYour iterator for infinite conjugacy classes is wrong\n\n```\nsage: a = matrix(ZZ,2,[1,1,0,1])\nsage: b = matrix(ZZ,2,[1,0,1,1])\nsage: G = MatrixGroup([a,b])\nsage: a = G(a)\nsage: b = G(b)\nsage: C = ConjugacyClass(G, a)\nsage: m1 = b * a * ~b\nsage: m2 = ~b * a * b\nsage: any(x == m1 for x in C)\nTrue\nsage: any(x == m2 for x in C)\n... can wait forever ...\n```\n\nI think that adding also inverses of generators would work. I.e. just replace `self._parent.gens()` with `self._parent.semigroup_generators()`. And please add the above test in the documentation.\n\nBest,\nVincent",
    "created_at": "2015-04-10T18:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209993",
    "user": "https://github.com/videlec"
}
```

Salut SÃ©bastien,

Your branch is based on sage-6.5!! Would you mind rebasing on sage-6.6.rc2?

Your iterator for infinite conjugacy classes is wrong

```
sage: a = matrix(ZZ,2,[1,1,0,1])
sage: b = matrix(ZZ,2,[1,0,1,1])
sage: G = MatrixGroup([a,b])
sage: a = G(a)
sage: b = G(b)
sage: C = ConjugacyClass(G, a)
sage: m1 = b * a * ~b
sage: m2 = ~b * a * b
sage: any(x == m1 for x in C)
True
sage: any(x == m2 for x in C)
... can wait forever ...
```

I think that adding also inverses of generators would work. I.e. just replace `self._parent.gens()` with `self._parent.semigroup_generators()`. And please add the above test in the documentation.

Best,
Vincent



---

archive/issue_comments_209994.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-12T13:51:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209994",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_209995.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-12T13:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209995",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_209996.json:
```json
{
    "body": "I used `monoid_generators` instead of `semigroup_generators` since it does not contain the identity. It is good because when the group is finite, it just returns the gens without their inverses.\n\nNeeds review again!",
    "created_at": "2015-04-12T13:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209996",
    "user": "https://github.com/seblabbe"
}
```

I used `monoid_generators` instead of `semigroup_generators` since it does not contain the identity. It is good because when the group is finite, it just returns the gens without their inverses.

Needs review again!



---

archive/issue_comments_209997.json:
```json
{
    "body": "Shouldn't you remove the second `todo` in `combinat/backtrack.py`?",
    "created_at": "2015-04-12T15:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209997",
    "user": "https://github.com/videlec"
}
```

Shouldn't you remove the second `todo` in `combinat/backtrack.py`?



---

archive/issue_comments_209998.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-12T16:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209998",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_209999.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-12T21:28:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-209999",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_048183.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-12T21:28:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16115#event-48183"
}
```



---

archive/issue_events_048184.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-12T21:28:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16115#event-48184"
}
```



---

archive/issue_comments_210000.json:
```json
{
    "body": "Merge conflict, try with 6.7.beta0 when its out",
    "created_at": "2015-04-14T20:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210000",
    "user": "https://github.com/vbraun"
}
```

Merge conflict, try with 6.7.beta0 when its out



---

archive/issue_comments_210001.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-04-14T20:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210001",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_210002.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T12:00:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210002",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210003.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-16T12:03:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210003",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_210004.json:
```json
{
    "body": "(the code using `TransitiveIdeal` in the file `finite_semigroups.py` was deleted in 6.7.beta0, that was the reason for the conflict)",
    "created_at": "2015-04-16T12:03:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210004",
    "user": "https://github.com/seblabbe"
}
```

(the code using `TransitiveIdeal` in the file `finite_semigroups.py` was deleted in 6.7.beta0, that was the reason for the conflict)



---

archive/issue_comments_210005.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-16T16:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210005",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_210006.json:
```json
{
    "body": "got\n\n```\nsage -t --long src/sage/combinat/dyck_word.py\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 3501, in sage.combinat.dyck_word.DyckWords_size.__init__\nFailed example:\n    TestSuite(DyckWords(4,2)).run()\nExpected nothing\n--\n    The following tests failed: _test_enumerated_set_iter_cardinality\n**********************************************************************\n```\n",
    "created_at": "2015-04-16T16:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210006",
    "user": "https://github.com/videlec"
}
```

got

```
sage -t --long src/sage/combinat/dyck_word.py
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 3501, in sage.combinat.dyck_word.DyckWords_size.__init__
Failed example:
    TestSuite(DyckWords(4,2)).run()
Expected nothing
--
    The following tests failed: _test_enumerated_set_iter_cardinality
**********************************************************************
```




---

archive/issue_comments_210007.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-17T15:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210007",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_210008.json:
```json
{
    "body": "Replying to [comment:18 vdelecroix]:\n> got\n> {{{\n> sage -t --long src/sage/combinat/dyck_word.py\n> ...\n> }}}\n\nSorry, seems to be a problem on my computer.\n\nVincent",
    "created_at": "2015-04-17T15:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210008",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:18 vdelecroix]:
> got
> {{{
> sage -t --long src/sage/combinat/dyck_word.py
> ...
> }}}

Sorry, seems to be a problem on my computer.

Vincent



---

archive/issue_comments_210009.json:
```json
{
    "body": "I think that it is necessary to keep the \"graded\" keyword whenever `TransitiveIdealGraded` was used.\nOtherwise, you are losing information, that may never come back.\n\nSo I propose to try putting \"graded\" wherever it already was, and see what happens.",
    "created_at": "2015-04-21T19:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210009",
    "user": "https://github.com/fchapoton"
}
```

I think that it is necessary to keep the "graded" keyword whenever `TransitiveIdealGraded` was used.
Otherwise, you are losing information, that may never come back.

So I propose to try putting "graded" wherever it already was, and see what happens.



---

archive/issue_comments_210010.json:
```json
{
    "body": "Ok, I agree, let's have this discussion. I first tried to replace every occurences of `TransitiveIdealGraded` by `RecursivelyEnumeratedSet(..., structure='graded')`, but then I got infinite loops.\n\nThe reason is that if a structure is graded, the enumeration currently done in `RecursivelyEnumeratedSet` saves in memory only two grades (the current one and the precedent one). If the structure is not graded and we use the graded argument for `RecursivelyEnumeratedSet`, then we may get infinite loops and elements that are genereated twice or infinitely often.\n\nI won't have access to my machine until Tuesday for redoing those tests and tell you exactly where were the infinite loops happening...\n\nMeanwhile, I would like to know for each occurences of `TransitiveIdealGraded` in the sage library weather the structure was really graded. I recall that `TransitiveIdealGraded` was not using the graded hypothesis at all since it was saving *all* of the generated elements.\n\nA) There were three files where `TransitiveIdealGraded` was used:\n\nFile `src/sage/categories/crystals.py`\n\n```python\nclass Crystals(Category_singleton):\n    class ParentMethods:\n        def __iter__(self, index_set=None, max_depth=float('inf')):\n            from sage.combinat.backtrack import TransitiveIdealGraded\n            from sage.combinat.backtrack import TransitiveIdeal\n            # was using both ???\n\n        def subcrystal(self, index_set=None, generators=None, max_depth=float(\"inf\"),\n            from sage.combinat.backtrack import TransitiveIdealGraded\n```\n\n\nFile `src/sage/categories/highest_weight_crystals.py`\n\n```python\nclass HighestWeightCrystals(Category_singleton):\n    class ParentMethods:\n        def __iter__(self, index_set=None, max_depth = float(\"inf\")):\n            from sage.combinat.backtrack import TransitiveIdealGraded\n```\n\n\n\nFile `src/sage/combinat/root_system/root_lattice_realizations.py`\n\n```python\nfrom sage.combinat.backtrack import TransitiveIdeal, TransitiveIdealGraded\nclass RootLatticeRealizations(Category_over_base_ring):\n    class ParentMethods:\n        @cached_method\n        def positive_roots(self, index_set=None):\n            return TransitiveIdealGraded(attrcall('pred', index_set=index_set),\n                                         [self.simple_root(i) for i in index_set])\n        def positive_real_roots(self):\n            if self.cartan_type().is_finite():\n                return tuple(TransitiveIdealGraded(attrcall('pred'), self.simple_roots()))\n\n        @cached_method\n        def positive_roots_parabolic(self, index_set = None):\n            return TransitiveIdealGraded(parabolic_covers, generators)\n\n    class ElementMethods:\n        def orbit(self):\n            return [x for x in TransitiveIdealGraded(attrcall('simple_reflections'), [self])]\n\n        def greater(self):\n            return [x for x in TransitiveIdeal(attrcall('succ'), [self])]\n\n        def smaller(self):\n            return [x for x in TransitiveIdeal(attrcall('pred'), [self])]\n```\n\n\nB) For reference, below are the files where only `TransitiveIdeal` was used.\n\nFile `src/sage/groups/conjugacy_classes.py`\n\n```python\nclass ConjugacyClass(Parent):\n    @cached_method\n    def set(self):\n        from sage.combinat.backtrack import TransitiveIdeal\n```\n\n\nFile `src/sage/combinat/rigged_configurations/kr_tableaux.py`\n\n```python\nclass KirillovReshetikhinTableaux(CrystalOfWords):\n    def __iter__(self):\n        from sage.combinat.backtrack import TransitiveIdeal\n```\n\n\nFile `src/sage/combinat/rigged_configurations/rigged_configurations.py`\n\n```python\nclass RiggedConfigurations(Parent, UniqueRepresentation):\n    def __iter__(self):\n        from sage.combinat.backtrack import TransitiveIdeal\n```\n\n\nFile `src/sage/combinat/rigged_configurations/tensor_product_kr_tableaux.py`\n\n```python\nclass TensorProductOfKirillovReshetikhinTableaux(FullTensorProductOfRegularCrystals):\n    def __iter__(self):\n        from sage.combinat.backtrack import TransitiveIdeal\n```\n\n\nFile `src/sage/combinat/root_system/pieri_factors.py`\n\n```python\nfrom sage.combinat.backtrack import TransitiveIdeal\nclass PieriFactors(UniqueRepresentation, Parent):\n    @cached_method\n    def elements(self):\n        return TransitiveIdeal(attrcall('bruhat_lower_covers'), self.maximal_elements())\n```\n",
    "created_at": "2015-04-22T08:35:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210010",
    "user": "https://github.com/seblabbe"
}
```

Ok, I agree, let's have this discussion. I first tried to replace every occurences of `TransitiveIdealGraded` by `RecursivelyEnumeratedSet(..., structure='graded')`, but then I got infinite loops.

The reason is that if a structure is graded, the enumeration currently done in `RecursivelyEnumeratedSet` saves in memory only two grades (the current one and the precedent one). If the structure is not graded and we use the graded argument for `RecursivelyEnumeratedSet`, then we may get infinite loops and elements that are genereated twice or infinitely often.

I won't have access to my machine until Tuesday for redoing those tests and tell you exactly where were the infinite loops happening...

Meanwhile, I would like to know for each occurences of `TransitiveIdealGraded` in the sage library weather the structure was really graded. I recall that `TransitiveIdealGraded` was not using the graded hypothesis at all since it was saving *all* of the generated elements.

A) There were three files where `TransitiveIdealGraded` was used:

File `src/sage/categories/crystals.py`

```python
class Crystals(Category_singleton):
    class ParentMethods:
        def __iter__(self, index_set=None, max_depth=float('inf')):
            from sage.combinat.backtrack import TransitiveIdealGraded
            from sage.combinat.backtrack import TransitiveIdeal
            # was using both ???

        def subcrystal(self, index_set=None, generators=None, max_depth=float("inf"),
            from sage.combinat.backtrack import TransitiveIdealGraded
```


File `src/sage/categories/highest_weight_crystals.py`

```python
class HighestWeightCrystals(Category_singleton):
    class ParentMethods:
        def __iter__(self, index_set=None, max_depth = float("inf")):
            from sage.combinat.backtrack import TransitiveIdealGraded
```



File `src/sage/combinat/root_system/root_lattice_realizations.py`

```python
from sage.combinat.backtrack import TransitiveIdeal, TransitiveIdealGraded
class RootLatticeRealizations(Category_over_base_ring):
    class ParentMethods:
        @cached_method
        def positive_roots(self, index_set=None):
            return TransitiveIdealGraded(attrcall('pred', index_set=index_set),
                                         [self.simple_root(i) for i in index_set])
        def positive_real_roots(self):
            if self.cartan_type().is_finite():
                return tuple(TransitiveIdealGraded(attrcall('pred'), self.simple_roots()))

        @cached_method
        def positive_roots_parabolic(self, index_set = None):
            return TransitiveIdealGraded(parabolic_covers, generators)

    class ElementMethods:
        def orbit(self):
            return [x for x in TransitiveIdealGraded(attrcall('simple_reflections'), [self])]

        def greater(self):
            return [x for x in TransitiveIdeal(attrcall('succ'), [self])]

        def smaller(self):
            return [x for x in TransitiveIdeal(attrcall('pred'), [self])]
```


B) For reference, below are the files where only `TransitiveIdeal` was used.

File `src/sage/groups/conjugacy_classes.py`

```python
class ConjugacyClass(Parent):
    @cached_method
    def set(self):
        from sage.combinat.backtrack import TransitiveIdeal
```


File `src/sage/combinat/rigged_configurations/kr_tableaux.py`

```python
class KirillovReshetikhinTableaux(CrystalOfWords):
    def __iter__(self):
        from sage.combinat.backtrack import TransitiveIdeal
```


File `src/sage/combinat/rigged_configurations/rigged_configurations.py`

```python
class RiggedConfigurations(Parent, UniqueRepresentation):
    def __iter__(self):
        from sage.combinat.backtrack import TransitiveIdeal
```


File `src/sage/combinat/rigged_configurations/tensor_product_kr_tableaux.py`

```python
class TensorProductOfKirillovReshetikhinTableaux(FullTensorProductOfRegularCrystals):
    def __iter__(self):
        from sage.combinat.backtrack import TransitiveIdeal
```


File `src/sage/combinat/root_system/pieri_factors.py`

```python
from sage.combinat.backtrack import TransitiveIdeal
class PieriFactors(UniqueRepresentation, Parent):
    @cached_method
    def elements(self):
        return TransitiveIdeal(attrcall('bruhat_lower_covers'), self.maximal_elements())
```




---

archive/issue_comments_210011.json:
```json
{
    "body": "I would say that crystal things are usually graded, but it would be better if crystal people can opt in and say their word about the matter. Travis ? Anne ?",
    "created_at": "2015-04-22T08:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210011",
    "user": "https://github.com/fchapoton"
}
```

I would say that crystal things are usually graded, but it would be better if crystal people can opt in and say their word about the matter. Travis ? Anne ?



---

archive/issue_comments_210012.json:
```json
{
    "body": "I have tried putting 'graded' in src/sage/categories/highest_weight_crystals.py\nand it worked fine. I tested the file itself and the combinat/crystals folder.\n\nI have tried putting 'graded' in src/sage/combinat/root_system/root_lattice_realizations.py and it worked fine. I tested the src/sage/combinat/root_system folder. Seems to be quicker by the way.\n\nLet us see if the bot founds a problem with these two changes.\n----\nNew commits:",
    "created_at": "2015-04-22T14:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210012",
    "user": "https://github.com/fchapoton"
}
```

I have tried putting 'graded' in src/sage/categories/highest_weight_crystals.py
and it worked fine. I tested the file itself and the combinat/crystals folder.

I have tried putting 'graded' in src/sage/combinat/root_system/root_lattice_realizations.py and it worked fine. I tested the src/sage/combinat/root_system folder. Seems to be quicker by the way.

Let us see if the bot founds a problem with these two changes.
----
New commits:



---

archive/issue_comments_210013.json:
```json
{
    "body": "ok, no problem so far, the bot is happy.\n\nThere remains only the case of src/sage/categories/crystals.py\n\nAnne, Travis ? What about affine crystals for example ? can we used \"graded\" ?",
    "created_at": "2015-04-22T16:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210013",
    "user": "https://github.com/fchapoton"
}
```

ok, no problem so far, the bot is happy.

There remains only the case of src/sage/categories/crystals.py

Anne, Travis ? What about affine crystals for example ? can we used "graded" ?



---

archive/issue_comments_210014.json:
```json
{
    "body": "I can now confirm that the each of the two remaining instances runs into infinite loops\nwhen given the 'graded' argument.\n\nTherefore this ticket is good to go.\n\nIf you agree, set this to positive review.",
    "created_at": "2015-04-22T18:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210014",
    "user": "https://github.com/fchapoton"
}
```

I can now confirm that the each of the two remaining instances runs into infinite loops
when given the 'graded' argument.

Therefore this ticket is good to go.

If you agree, set this to positive review.



---

archive/issue_comments_210015.json:
```json
{
    "body": "Replying to [comment:24 chapoton]:\n> ok, no problem so far, the bot is happy.\n> \n> There remains only the case of src/sage/categories/crystals.py\n> \n> Anne, Travis ? What about affine crystals for example ? can we used \"graded\" ?\n\nAffine crystals are not necessarily graded. They can be cyclic.",
    "created_at": "2015-04-22T18:49:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210015",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:24 chapoton]:
> ok, no problem so far, the bot is happy.
> 
> There remains only the case of src/sage/categories/crystals.py
> 
> Anne, Travis ? What about affine crystals for example ? can we used "graded" ?

Affine crystals are not necessarily graded. They can be cyclic.



---

archive/issue_comments_210016.json:
```json
{
    "body": "Thanks !\n\nAnd are we safe with using 'graded' for highest weight crystals, as it seems ?\n\nBy the way, Anne, have you seen my Fulbright call on sage-combinat-devel ?",
    "created_at": "2015-04-22T19:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210016",
    "user": "https://github.com/fchapoton"
}
```

Thanks !

And are we safe with using 'graded' for highest weight crystals, as it seems ?

By the way, Anne, have you seen my Fulbright call on sage-combinat-devel ?



---

archive/issue_comments_210017.json:
```json
{
    "body": "Replying to [comment:27 chapoton]:\n> Thanks !\n> \n> And are we safe with using 'graded' for highest weight crystals, as it seems ?\n\nYes.\n\n> By the way, Anne, have you seen my Fulbright call on sage-combinat-devel ?\n\nI am not sure. For postdocs with a permanent position?",
    "created_at": "2015-04-22T20:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210017",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:27 chapoton]:
> Thanks !
> 
> And are we safe with using 'graded' for highest weight crystals, as it seems ?

Yes.

> By the way, Anne, have you seen my Fulbright call on sage-combinat-devel ?

I am not sure. For postdocs with a permanent position?



---

archive/issue_comments_210018.json:
```json
{
    "body": "> > By the way, Anne, have you seen my Fulbright call on sage-combinat-devel ?\n> \n> I am not sure. For postdocs with a permanent position?\n\nYes, hum. I am afraid that it is like looking for an element in the empty set. But maybe you could have somebody in mind.. Young, with a position, willing to spend time in Lyon, likes algebraic combinatorics. Not so easy to find, indeed.",
    "created_at": "2015-04-22T20:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210018",
    "user": "https://github.com/fchapoton"
}
```

> > By the way, Anne, have you seen my Fulbright call on sage-combinat-devel ?
> 
> I am not sure. For postdocs with a permanent position?

Yes, hum. I am afraid that it is like looking for an element in the empty set. But maybe you could have somebody in mind.. Young, with a position, willing to spend time in Lyon, likes algebraic combinatorics. Not so easy to find, indeed.



---

archive/issue_comments_210019.json:
```json
{
    "body": "> There remains only the case of src/sage/categories/crystals.py\n\nThere was four occurences of `TransitiveIdealGraded` in the file `src/sage/combinat/root_system/root_lattice_realizations.py` but you set `structure='graded'` in only one of them. Can you also check (mathematically + doctests) whether we can add the graded hypothesis for the three others also?",
    "created_at": "2015-04-22T20:48:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210019",
    "user": "https://github.com/seblabbe"
}
```

> There remains only the case of src/sage/categories/crystals.py

There was four occurences of `TransitiveIdealGraded` in the file `src/sage/combinat/root_system/root_lattice_realizations.py` but you set `structure='graded'` in only one of them. Can you also check (mathematically + doctests) whether we can add the graded hypothesis for the three others also?



---

archive/issue_comments_210020.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-23T06:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210020",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_210021.json:
```json
{
    "body": "It seems to be ok for two of them, but not for the third one, which is an orbit.\n\nBut, damn, tests for this file are so long ...",
    "created_at": "2015-04-23T06:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210021",
    "user": "https://github.com/fchapoton"
}
```

It seems to be ok for two of them, but not for the third one, which is an orbit.

But, damn, tests for this file are so long ...



---

archive/issue_comments_210022.json:
```json
{
    "body": "It seems that tests take slightly longer in `root_lattice_realizations.py` with this branch..",
    "created_at": "2015-04-23T11:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210022",
    "user": "https://github.com/fchapoton"
}
```

It seems that tests take slightly longer in `root_lattice_realizations.py` with this branch..



---

archive/issue_events_048185.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-04-23T11:45:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16115#event-48185"
}
```



---

archive/issue_events_048186.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-04-23T11:45:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16115#event-48186"
}
```



---

archive/issue_comments_210023.json:
```json
{
    "body": "Replying to [comment:33 chapoton]:\n> It seems that tests take slightly longer in `root_lattice_realizations.py` with this branch..\n\nOkay, I will take a look at this.",
    "created_at": "2015-04-28T11:39:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210023",
    "user": "https://github.com/seblabbe"
}
```

Replying to [comment:33 chapoton]:
> It seems that tests take slightly longer in `root_lattice_realizations.py` with this branch..

Okay, I will take a look at this.



---

archive/issue_comments_210024.json:
```json
{
    "body": "Replying to [comment:33 chapoton]:\n> It seems that tests take slightly longer in `root_lattice_realizations.py` with this branch..\n\nRunning `sage -t src/sage/combinat/root_system/root_lattice_realizations.py` three times on 6.7.beta3, I get:\n\n\n```\n[575 tests, 10.62 s]\n[575 tests, 10.62 s]\n[575 tests, 10.70 s]\n```\n\n\nRunning the same command three times on the same file with this branch, I get:\n\n\n```\n[575 tests, 10.62 s]\n[575 tests, 10.59 s]\n[575 tests, 10.59 s]\n```\n\n\nSo I can't confirm that tests take any longer with this ticket. Needs review!",
    "created_at": "2015-04-29T15:03:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210024",
    "user": "https://github.com/seblabbe"
}
```

Replying to [comment:33 chapoton]:
> It seems that tests take slightly longer in `root_lattice_realizations.py` with this branch..

Running `sage -t src/sage/combinat/root_system/root_lattice_realizations.py` three times on 6.7.beta3, I get:


```
[575 tests, 10.62 s]
[575 tests, 10.62 s]
[575 tests, 10.70 s]
```


Running the same command three times on the same file with this branch, I get:


```
[575 tests, 10.62 s]
[575 tests, 10.59 s]
[575 tests, 10.59 s]
```


So I can't confirm that tests take any longer with this ticket. Needs review!



---

archive/issue_comments_210025.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-29T18:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210025",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_210026.json:
```json
{
    "body": "ok, avanti !",
    "created_at": "2015-04-29T18:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210026",
    "user": "https://github.com/fchapoton"
}
```

ok, avanti !



---

archive/issue_comments_210027.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-05-01T18:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16115#issuecomment-210027",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048187.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-01T18:46:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16115",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16115#event-48187"
}
```
