# Issue 30098: openblas: clear out .pc symlinks before installation

Issue created by migration from https://trac.sagemath.org/ticket/30335

Original creator: mkoeppe

Original creation time: 2020-08-11 15:29:19

CC:  yzh jhpalmieri dimpase embray

When switching from system BLAS to SPKG openblas, the following errors have been reported:

```
Copying package files from temporary location /Users/yzh/sagecopies/sage/worktree-2020/local/var/tmp/sage/build/openblas-0.3.9/inst to /Users/yzh/sagecopies/sage/worktree-2020/local
cp: /Users/yzh/sagecopies/sage/worktree-2020/local/./lib/pkgconfig/cblas.pc: Permission denied
cp: /Users/yzh/sagecopies/sage/worktree-2020/local/./lib/pkgconfig/blas.pc: Permission denied
cp: /Users/yzh/sagecopies/sage/worktree-2020/local/./lib/pkgconfig/lapack.pc: Permission denied
************************************************************************
Error copying files for openblas-0.3.9.
```


The correct fix is described in #29585#comment:9
and #29387 + #29386


This ticket is a quick workaround for Sage 9.2.




---

Comment by mkoeppe created at 2020-08-11 16:00:12

New commits:


---

Comment by mkoeppe created at 2020-08-11 16:00:12

Changing status from new to needs_review.


---

Comment by dimpase created at 2020-08-11 16:14:01

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-08-11 16:14:01

lgtm


---

Comment by mkoeppe created at 2020-08-11 17:11:39

Thanks!


---

Comment by vbraun created at 2020-08-14 22:23:50

Resolution: fixed


---

Comment by embray created at 2020-08-31 15:46:35

Ah, no, spkg-install scripts should **not** make changes to `$SAGE_LOCAL`.  If it's absolutely necessary to you can do that in an `spkg-preinst` script.


---

Comment by mkoeppe created at 2020-08-31 16:31:04

Follow-up: #30480
