# Issue 11554: Failure to coerce 1/q into its own LaurentPolynomialRing

Issue created by migration from https://trac.sagemath.org/ticket/11726

Original creator: boothby

Original creation time: 2011-08-24 01:10:26

Assignee: malb

CC:  andrew.mathas rws

Consider:


```
sage: P.<q> = LaurentPolynomialRing(QQ)
sage: q in P
True
sage: P(q)
q
sage: q^(-1) in P
True
sage: 1/q in P
False
sage: P(q^(-1))
```


The last statement raises an exception.

(this is not a duplicate of #7839)


---

Comment by boothby created at 2011-08-25 04:06:29

Changing assignee from malb to boothby.


---

Comment by boothby created at 2011-08-25 04:06:29

Changing keywords from "" to "days32".


---

Comment by boothby created at 2011-08-25 05:28:13

Changing keywords from "days32" to "sd32".


---

Comment by boothby created at 2011-08-25 05:44:20

Changing status from new to needs_review.


---

Attachment


---

Comment by davidloeffler created at 2012-03-11 14:37:21

This doesn't pass doctests on any recent version of Sage (see patchbot logs)


---

Comment by davidloeffler created at 2012-03-11 14:37:21

Changing status from needs_review to needs_work.


---

Attachment


---

Comment by tscrim created at 2013-09-19 14:57:19

Here's a new version of the patch which applies on sage-5.12.beta5 and depends on #14261 (which is currently being reviewed). This also fixes many things that annoy me with when working with Laurent polynomials, it particular division and simplification in the fraction field.

For patchbot:

Apply: trac_11726-univariate_Laurent_polynomials-ts.patchâ€‹


---

Comment by tscrim created at 2013-09-19 14:57:29

Changing status from needs_work to needs_review.


---

Comment by darij created at 2014-02-15 17:09:39

What is the state of this? How much of this has been done in #15345?


---

Comment by tscrim created at 2014-02-16 20:54:04

I've converted the patch to a git branch and made some more fixes to the coercions and doctests. Not much of this was done in #15345, but there are some changes there I merged in to avoid conflicts.
----
Last 10 new commits:


---

Comment by chapoton created at 2014-03-04 09:08:07

Changing keywords from "sd32" to "sd32, Laurent polynomials".


---

Comment by tscrim created at 2014-03-04 17:22:50

Some extra methods for Laurent polynomials in these tickets.


---

Comment by chapoton created at 2014-03-12 20:45:13

I have rebased on 6.2.beta4. I have changed the branch here. Maybe I should have merged ?
----
New commits:


---

Comment by tscrim created at 2014-03-14 03:10:10

The new branch is fine (although I prefer the merge because I don't see any harm in merge commits).


---

Comment by rws created at 2014-03-31 15:23:49

Docs build. Long tests are fine in rings/. I would give positive but I'm not sure if you are finished yet.


---

Comment by tscrim created at 2014-04-02 01:44:49

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2014-04-02 01:44:49

Nope, I'm finished with this.


---

Comment by vbraun created at 2014-04-04 16:49:05

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2014-04-04 16:49:05

Fails doctests

```
sage -t src/doc/en/thematic_tutorials/lie/kazhdan_lusztig_polynomials.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/lie/kazhdan_lusztig_polynomials.rst", line 17, in doc.en.thematic_tutorials.lie.kazhdan_lusztig_polynomials
Failed example:
    KL.R(s2, s2*s1*s3*s2)
Expected:
    q^3 - 3*q^2 + 3*q - 1
Got:
    -1 + 3*q - 3*q^2 + q^3
```



---

Comment by git created at 2014-04-04 19:33:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-04-04 19:34:50

I have corrected the doctest.


---

Comment by chapoton created at 2014-04-04 19:34:50

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2014-04-04 19:37:17

I think there was more than one, please test.


---

Comment by git created at 2014-04-04 19:53:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2014-04-05 07:23:01

Confirm all tutorial tests pass. Oh well, good catch...


---

Comment by rws created at 2014-04-05 07:23:01

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-04-06 17:34:51


```
sage -t --long src/sage/algebras/hall_algebra.py  # 13 doctests failed
sage -t --long src/sage/groups/braid.py  # 8 doctests failed
```



---

Comment by vbraun created at 2014-04-06 17:34:51

Changing status from positive_review to needs_work.


---

Comment by git created at 2014-04-08 12:14:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-04-08 12:20:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-04-08 12:21:40

I have implemented a `__floordiv__` method for Laurent polynomials in one variable, and corrected the doctests. Needs review.


---

Comment by chapoton created at 2014-04-08 12:21:40

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2014-04-08 16:15:57

You seem to have this uncanny ability to do things the night (well for me at least) before I'm going to do them.


---

Comment by tscrim created at 2014-04-08 16:15:57

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-04-09 09:39:32

Resolution: fixed
