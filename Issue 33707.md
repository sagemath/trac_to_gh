# Issue 33707: saving a tikzpicture to a local folder is now broken

Issue created by migration from https://trac.sagemath.org/ticket/33944

Original creator: slabbe

Original creation time: 2022-06-01 19:52:32

Now that temporary files are created in the `/tmp` folder (after #33797), the following is now broken:


```
sage: from sage.misc.latex_standalone import Standalone
sage: s = Standalone('Hello World')
sage: s.pdf('a.pdf')
---------------------------------------------------------------------------
OSError                                   Traceback (most recent call last)
<ipython-input-3-61662d74848f> in <module>
----> 1 s.pdf('a.pdf')

~/GitBox/sage/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/sage/misc/latex_standalone.py in pdf(self, filename, view, program)
    729         if filename:
    730             filename = os.path.abspath(filename)
--> 731             os.rename(temp_filename_pdf, filename)
    732             return filename
    733 

OSError: [Errno 18] Invalid cross-device link: '/tmp/tmpwfvogvku/tikz_15rndaqh.pdf' -> '/home/.../a.pdf'
```


This went unnoticed because everywhere in the doctests the files are created in the temporary folder.


---

Comment by slabbe created at 2022-06-01 19:55:34

A [solution](https://stackoverflow.com/questions/42392600/oserror-errno-18-invalid-cross-device-link) seems to be to use `shutil.move` instead.


---

Comment by slabbe created at 2022-06-01 20:02:06

New commits:


---

Comment by slabbe created at 2022-06-01 20:02:06

Changing status from new to needs_review.


---

Comment by mjo created at 2022-06-01 20:43:48

Changing status from needs_review to positive_review.


---

Comment by mjo created at 2022-06-01 20:43:48

I think this would have been broken already when saving to a filesystem other than the one that `SAGE_TMP` lives on. The fix looks correct, thanks.


---

Comment by vbraun created at 2022-06-12 12:16:52

Resolution: fixed
