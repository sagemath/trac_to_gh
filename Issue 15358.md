# Issue 15358: Shuffle Product

Issue created by migration from Trac.

Original creator: elixyre

Original creation time: 2013-12-27 11:55:16

CC:  nthiery mathzeta2

Shuffle product can be define on any iterable object so I propose to define a new class that implement an efficient shuffle product on iterables.

Currently one has two shuffle product in Sage, one is defined on words and one is defined on permutations.

The first one is slow and don't allow to compute shuffle of two list and the second is fast but only defined for Permutations.

Some benchmarks:

My Shuffle:

Time if *ShuffleProduct* inherits just of *SageObject*


```
sage: from sage.combinat.shuffle import ShuffleProduct
sage: a = Word("abcdefghij")
sage: b = Word("klmnopqrst")
sage: %time _ = list(ShuffleProduct(a, b, Word))
CPU times: user 25.88 s, sys: 1.39 s, total: 27.26 s
Wall time: 27.23 s
```


Time if *ShuffleProduct* inherits of the evil class *Parent*:


```
sage: from sage.combinat.shuffle import ShuffleProduct
sage: a = Word("abcdefghij")
sage: b = Word("klmnopqrst")
sage: %time _ = list(ShuffleProduct(a, b, Word))
CPU times: user 56.23 s, sys: 4.10 s, total: 60.33 s
Wall time: 60.58 s
```


Comparaison with *ShuffleProduct_w1w2*:


```
sage: from sage.combinat.words.shuffle_product import ShuffleProduct_w1w2 as Shuffle
sage: %time _ = list(Shuffle(a, b))
CPU times: user 59.66 s, sys: 0.29 s, total: 59.94 s
Wall time: 59.90 s
```



---

Comment by git created at 2013-12-27 12:19:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2013-12-27 12:47:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2013-12-27 13:34:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-03-27 21:39:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by elixyre created at 2014-03-27 21:48:57

Changing status from new to needs_review.


---

Comment by MatthieuDien created at 2014-04-08 09:17:25

Changing keywords from "" to "days57".


---

Comment by MatthieuDien created at 2014-04-09 00:03:15

New commits:


---

Comment by git created at 2014-04-10 16:07:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-04-10 16:20:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mathzeta2 created at 2014-04-10 18:35:13

I have added a "See also" comment to `sage.combinat.words.shuffle_product.py` that suggests to use the new implementation. We should open a ticket to replace and deprecated `ShuffleProduct_w1w2`.


---

Comment by rws created at 2014-05-13 06:18:43

Changing status from needs_review to needs_work.


---

Comment by rws created at 2014-05-13 06:18:43

patchbot:

```
+++ b/src/sage/combinat/shuffle.py

`@``@` -0,0 +1,438 `@``@`

+    a_0 \cdot \left((a_n)_{n \geqslant 1} \Cup (b_m)_{mÂ \geqslant 0}\right)
+    + b_0 \cdot \left((a_n)_{n \geqslant 0} \Cup (b_m)_{mÂ \geqslant 1}\right)
--- a/src/sage/combinat/words/shuffle_product.py

+++ b/src/sage/combinat/words/shuffle_product.py

`@``@` -1,5 +1,9 `@``@`

Non-ascii characters inserted on 2 non-empty lines
plugins.non_ascii -- 0 seconds
========== end plugins.non_ascii ==========
```



---

Comment by MatthieuDien created at 2014-06-03 10:55:07

I removed the non-ascii characters and pushed it
----
New commits:


---

Comment by MatthieuDien created at 2014-06-03 10:55:50

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-06-04 08:53:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mathzeta2 created at 2014-06-04 18:29:20

Now the tests in the file pass. Positive review!

The work never ends. From comment [comment:18]:
> We should open a ticket to replace and deprecated `ShuffleProduct_w1w2`.
and have shuffle of variable number of iterables, and check if the Parent/Element system can be used efficiently and many other things...


---

Comment by mathzeta2 created at 2014-06-04 18:29:20

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-06-04 22:02:17

Resolution: fixed
