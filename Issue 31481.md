# Issue 31481: ManifoldSubset, Manifold: Change some methods to generators

Issue created by migration from https://trac.sagemath.org/ticket/31718

Original creator: mkoeppe

Original creation time: 2021-04-22 20:45:20

CC:  @mjungmath egourgoulhon tscrim

This ticket proposes to change some methods that currently return lists to generators - like the method `open_supersets` added in #31677. This is in line with the changes in the Python standard library when we moved from Python 2 to 3.

`ManifoldSubset`:
- `open_covers()` currently returns a list of lists
  - change to generator of `FiniteManifoldSubsetFamily` instances 

- `subsets()` currently returns a `frozenset`
  - change to generator of `ManifoldSubset` instances

`Manifold`:
 - `top_charts()` currently returns a list
   - change to generator of charts
 - `coord_changes()` currently returns a copy
   - change to generator of pairs `((from, to), map)` ... so that `dict(M.coord_changes())` will create the copy


---

Comment by mkoeppe created at 2021-04-23 16:52:15

New commits:


---

Comment by git created at 2021-04-23 17:02:46

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by mkoeppe created at 2021-04-23 17:06:01

Changing status from new to needs_review.


---

Comment by git created at 2021-04-23 17:34:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2021-04-25 08:28:46

LGTM. Thanks!


---

Comment by egourgoulhon created at 2021-04-25 08:28:46

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-04-25 10:27:18

Thanks for reviewing!


---

Comment by @mjungmath created at 2021-04-26 21:18:58

I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets? Because all the examples you provide are still with subsets.


---

Comment by @mjungmath created at 2021-04-26 21:27:05

I can imagine this can be useful for frames whose domains cover the manifold? Perhaps this is a more suitable example for the non-subset case to show the difference?

Some time ago I provided a helper function `_get_min_covering` (can be found in `manifolds/manifold.py`) to obtain a minimal amount of manifold objects necessary to cover the manifold. It looks like this method is more suited within the family class you just provided.

Another example in the field I could imagine is for orientations. An orientation is given by a family of charts/frames, too, but yet not implemented as such.


---

Comment by mkoeppe created at 2021-04-26 23:01:09

Replying to [comment:10 gh-mjungmath]:
> I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets?

Yes, in #31732 I use `ManifoldObjectFiniteFamily` directly for the family of open covers. Its elements are `ManifoldSubsetFiniteFamily` instances.

I agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.


---

Comment by @mjungmath created at 2021-04-27 09:14:15

Replying to [comment:12 mkoeppe]:
> Replying to [comment:10 gh-mjungmath]:
> > I assume it has a purpose, but just out of curiosity: why do you make a difference between families of manifold objects and families of manifold subsets? Do you have a further usage in mind other than just subsets?
> 
> Yes, in #31732 I use `ManifoldObjectFiniteFamily` directly for the family of open covers. Its elements are `ManifoldSubsetFiniteFamily` instances.

Alright, that makes sense. Just a personal taste: I think its better to add some distinct examples to `ManifoldObjectFiniteFamily` to clarify the difference to `ManifoldSubsetFiniteFamily`.

> I agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.

Right. But don't you think it should rather be a new common parent class both inherit from?

In any case, this is something definitely need, indeed!


---

Comment by mkoeppe created at 2021-04-27 17:43:42

Replying to [comment:13 gh-mjungmath]:
> I think its better to add some distinct examples to `ManifoldObjectFiniteFamily` to clarify the difference to `ManifoldSubsetFiniteFamily`.

Sure, let's do that when we introduce some more applications to families.

> Replying to [comment:12 mkoeppe]:
> > I agree that charts/frames are likely to benefit from becoming finite families too. This will also need a separate subclass because they are indexed not by names but by coordinate tuples.
> 
> Right. But don't you think it should rather be a new common parent class both inherit from?

Sure, that makes sense.

> In any case, this is something definitely need, indeed!

Let's take this discussion to #31720 (Manifold: Change some methods to generators), which introduces generators for charts. Families could be introduced in the same ticket -- but I will need some guidance there what the keys should be.


---

Comment by vbraun created at 2021-06-21 21:17:33

Resolution: fixed
