# Issue 10348: Implementation of mutations for matrices

Issue created by migration from Trac.

Original creator: stumpc5

Original creation time: 2010-11-27 23:13:35

Assignee: tbd

CC:  hthomas@unb.ca

Keywords: matrix mutation

This patch implements a method to mutate matrices. This method is needed for the cluster algebra and quiver package, see Ticket #10298.


---

Comment by stumpc5 created at 2011-02-08 16:16:04

Changing status from new to needs_review.


---

Comment by stumpc5 created at 2011-02-08 16:16:04

Changing component from PLEASE CHANGE to combinatorics.


---

Comment by stumpc5 created at 2011-02-24 17:49:11

For the buildbot:

Depends on #10347.


---

Comment by stumpc5 created at 2011-06-10 14:25:59

Remove assignee tbd.


---

Comment by hthomas created at 2011-06-12 09:45:28

Hi Christian--

What do you think about the idea of checking that 0 <= k < min(ncols,nrows)?  Your code is very nicely written to be safe even if someone tries to mutate a 2x2 matrix at row 15, but they shouldn't be doing that.  More importantly, they shouldn't be trying to mutate a 2n x n matrix at row j for n<= j < 2n -- for such a parameter, mutation is *undefined*.  Returning what looks like meaningful output in such a case is potentially deceptive.  (That's my view, at any rate, though if you disagree, I could be convinced otherwise.)  

It's also true that the principal part of B should be skew-symmetrizable, but I don't think it's necessary to check that -- though maybe it would be good to mention this in the documentation?  (The legit range of k values should also go in the documentation, I guess.)

And, Zelevinsky :)

Otherwise, though, it looks good.

cheers,

Hugh


---

Comment by hthomas created at 2011-06-12 09:45:28

Changing status from needs_review to needs_work.


---

Comment by hthomas created at 2011-06-12 09:52:02

Oh, one more comment, in the doc-string, you have "b-matrix"; I'd prefer "B-matrix".    

cheers

Hugh


---

Comment by stumpc5 created at 2011-06-12 12:33:31

Dear Hugh,

I added the changes you suggested -- thanks a lot for looking at it!

Christian


---

Comment by stumpc5 created at 2011-06-15 13:30:43

Changing status from needs_work to needs_review.


---

Comment by stumpc5 created at 2012-02-15 08:05:50

Replying to [comment:8 stumpc5]:

I just pushed a new version which should be compatible with the #10347, if you also wanna have a look here...

Best, Christian


---

Comment by hthomas created at 2012-02-15 12:38:27

I'll take a look.

cheers,

Hugh


---

Comment by hthomas created at 2012-02-18 14:03:39

Hi Christian--

What's the point of declaring k to be of type Py_ssize_t?  I thought the point was that this would allow k to be huge, but in that case, it seems that you would get overflows when you run into the fact that i and j are declared to be integers.  

cheers,

Hugh


---

Comment by hthomas created at 2012-02-18 14:47:14

Otherwise, I am happy.  The patchbot was happy with this patch before, right?  So I assume that its present unhappiness (?) is unrelated to the patch itself, so I guess all that's left is the question in my previous comment.


---

Comment by stumpc5 created at 2012-02-18 15:57:29

Replying to [comment:13 hthomas]:
> Hi Christian--
> 
> What's the point of declaring k to be of type Py_ssize_t?  I thought the point was that this would allow k to be huge, but in that case, it seems that you would get overflows when you run into the fact that i and j are declared to be integers.  

Hi Hugh,

`Py_ssize_t` is the recommended integer type for cython, see http://www.python.org/dev/peps/pep-0353/. In fact, in our current situation there is no advantage of using this type over using `int`. It is used all over in the code for matrices, see for example the method `get_unsafe` - that's why I also used it.


---

Comment by hthomas created at 2012-02-18 21:08:33

Replying to [comment:16 stumpc5]:

Then why not declare i,j,_ also to be the same type?  It seems to me that if it's ever useful to have chosen that type, you would also have needed i,j,_ to have been of that type.


---

Attachment

contains matrix method mutate


---

Comment by stumpc5 created at 2012-02-19 13:53:10

Replying to [comment:17 hthomas]:
> Replying to [comment:16 stumpc5]:
> 
> Then why not declare i,j,_ also to be the same type?  It seems to me that if it's ever useful to have chosen that type, you would also have needed i,j,_ to have been of that type.  

Done!


---

Comment by hthomas created at 2012-02-22 01:42:02

Changing status from needs_review to positive_review.


---

Comment by hthomas created at 2012-02-22 01:42:02

Okay, then, I think it's ready.  

cheers,

Hugh


---

Comment by jdemeyer created at 2012-02-27 11:20:13

Resolution: fixed


---

Comment by nthiery created at 2012-03-06 08:36:26

Hi!

This patch is merged in, and we want the cluster algebra material to get in. So this comment is for the future.

The functionality implemented in this ticket is rather specific to the context of cluster algebras. The average matrix user will have no clue what this is about, and might get confused with the unrelated concept of mutability (as in set_immutable). So I would recommend, in a later ticket, to:

- Rename this method to something more specific like cluster_algebra_mutate
  Maybe even move it into the cluster algebra library
- Add a minimal description of what the method actually does
- Add links to the cluster algebra library / tutorial (when it exists)
- Add link to the _check_symmetrizability
