# Issue 28993: Creation of the sigma function (sum of divisors) applicable to Gaussian integers

archive/issues_028993.json:
```json
{
    "body": "CC:  @zimmermann6\n\nKeywords: gaussian integers, sigma function, first quadrant\n\nThis is my first contribution !\nPlease forgive my possible clumsiness !\n\nI would like to propose a new function for Sage called \"sigma_gauss\".\nThis function would be an extension of the sigma function in number theory, which calculates the sum of the divisors of integers.\nThe sigma_gauss function would apply to a Gaussian integer.\n\nHere is the code I propose:\n\n\n\n```python\n#Calculation program sigma(z), z Gaussian integer.\n#Calculates the sum of the complex divisors of z.\n#The Gaussian integer prime factors must be taken in the first quadrant.\n#Observation: equivalent to the Mathematica's function DivisorSigma [1, z, GaussianIntegers -> True]\n#References http://mathworld.wolfram.com/DivisorFunction.html\n#References https://www.jstor.org/stable/2312472?seq=1\n#References https://encompass.eku.edu/etd/158/\n\nR = GaussianIntegers()\n\ndef sigma_gauss_aux (l):\n   s = 1\n   e=0\n   while e<len(l):\n      p = l[e][0]\n      k = l[e][1]\n      s = s * (p^(k+1)-1) / (p-1)\n      e+=1\n   return R(s)\n\ndef sigma_gauss(z):\n   ll=list(R(z).factor())\n   l=[]\n   i=0\n\n#Gaussian prime factors must be selected in the first quadrant.\n#To understand why, refer to the references cited at the beginning of the program.\n\n   while i<len(ll):\n      nz=ll[i][0]\n      if real(nz)<0 and imag(nz)<0:\n         nz=-nz\n      if real(nz)<0 and imag(nz)>=0:\n         nz=-I*nz\n      if real(nz)>=0 and imag(nz)<0:\n         nz=I*nz\n      assert real(nz)>=0 and imag(nz)>=0\n      lz=[nz,ll[i][1]]\n      l.append(lz)\n      i+=1\n   r=0\n\n#Be careful not to have the same factor twice in the list of factors after their selection in the first quadrant and before applying the \"sigma_gauss_aux\" function.\n\n   while r<len(l)-1:\n      t=r+1\n      while t<len(l):\n         if l[r][0]==l[t][0]:\n            l[r][1]=l[r][1]+l[t][1]\n            del l[t]\n            t-=1\n         t+=1\n      r+=1\n   for x,e in l:\n      assert e != 0\n   return sigma_gauss_aux(l)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/29230\n\n",
    "created_at": "2020-02-21T10:29:27Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Creation of the sigma function (sum of divisors) applicable to Gaussian integers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28993",
    "user": "https://github.com/garambois"
}
```
CC:  @zimmermann6

Keywords: gaussian integers, sigma function, first quadrant

This is my first contribution !
Please forgive my possible clumsiness !

I would like to propose a new function for Sage called "sigma_gauss".
This function would be an extension of the sigma function in number theory, which calculates the sum of the divisors of integers.
The sigma_gauss function would apply to a Gaussian integer.

Here is the code I propose:



```python
#Calculation program sigma(z), z Gaussian integer.
#Calculates the sum of the complex divisors of z.
#The Gaussian integer prime factors must be taken in the first quadrant.
#Observation: equivalent to the Mathematica's function DivisorSigma [1, z, GaussianIntegers -> True]
#References http://mathworld.wolfram.com/DivisorFunction.html
#References https://www.jstor.org/stable/2312472?seq=1
#References https://encompass.eku.edu/etd/158/

R = GaussianIntegers()

def sigma_gauss_aux (l):
   s = 1
   e=0
   while e<len(l):
      p = l[e][0]
      k = l[e][1]
      s = s * (p^(k+1)-1) / (p-1)
      e+=1
   return R(s)

def sigma_gauss(z):
   ll=list(R(z).factor())
   l=[]
   i=0

#Gaussian prime factors must be selected in the first quadrant.
#To understand why, refer to the references cited at the beginning of the program.

   while i<len(ll):
      nz=ll[i][0]
      if real(nz)<0 and imag(nz)<0:
         nz=-nz
      if real(nz)<0 and imag(nz)>=0:
         nz=-I*nz
      if real(nz)>=0 and imag(nz)<0:
         nz=I*nz
      assert real(nz)>=0 and imag(nz)>=0
      lz=[nz,ll[i][1]]
      l.append(lz)
      i+=1
   r=0

#Be careful not to have the same factor twice in the list of factors after their selection in the first quadrant and before applying the "sigma_gauss_aux" function.

   while r<len(l)-1:
      t=r+1
      while t<len(l):
         if l[r][0]==l[t][0]:
            l[r][1]=l[r][1]+l[t][1]
            del l[t]
            t-=1
         t+=1
      r+=1
   for x,e in l:
      assert e != 0
   return sigma_gauss_aux(l)
```


Issue created by migration from https://trac.sagemath.org/ticket/29230





---

archive/issue_comments_409969.json:
```json
{
    "body": "Attachment [sigma_gauss_function.sage](tarball://root/attachments/some-uuid/ticket29230/sigma_gauss_function.sage) by @garambois created at 2020-02-21 10:30:23",
    "created_at": "2020-02-21T10:30:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28993#issuecomment-409969",
    "user": "https://github.com/garambois"
}
```

Attachment [sigma_gauss_function.sage](tarball://root/attachments/some-uuid/ticket29230/sigma_gauss_function.sage) by @garambois created at 2020-02-21 10:30:23



---

archive/issue_comments_409970.json:
```json
{
    "body": "Zeroth step, read the developer guide : https://doc.sagemath.org/html/en/developer/#writing-code-for-sage\n\nFirst step, make it work for you in a \".py\" file and not a \".sage\" file.\n\nYou will need to add some \"import\" lines, that you can find using \"import_statements\" command in sage. In particular\n\n```\nsage: import_statements(GaussianIntegers,real,imag)\n# ** Warning **: several names for that object: real, real_part\n# ** Warning **: several names for that object: imag, imag_part, imaginary\nfrom sage.functions.other import real, imag\nfrom sage.rings.number_field.order import GaussianIntegers\n```\n",
    "created_at": "2020-02-21T17:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28993#issuecomment-409970",
    "user": "https://github.com/fchapoton"
}
```

Zeroth step, read the developer guide : https://doc.sagemath.org/html/en/developer/#writing-code-for-sage

First step, make it work for you in a ".py" file and not a ".sage" file.

You will need to add some "import" lines, that you can find using "import_statements" command in sage. In particular

```
sage: import_statements(GaussianIntegers,real,imag)
# ** Warning **: several names for that object: real, real_part
# ** Warning **: several names for that object: imag, imag_part, imaginary
from sage.functions.other import real, imag
from sage.rings.number_field.order import GaussianIntegers
```




---

archive/issue_comments_409971.json:
```json
{
    "body": "Attachment [sigma_gauss_function.py](tarball://root/attachments/some-uuid/ticket29230/sigma_gauss_function.py) by @garambois created at 2020-02-22 11:34:44",
    "created_at": "2020-02-22T11:34:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28993#issuecomment-409971",
    "user": "https://github.com/garambois"
}
```

Attachment [sigma_gauss_function.py](tarball://root/attachments/some-uuid/ticket29230/sigma_gauss_function.py) by @garambois created at 2020-02-22 11:34:44



---

archive/issue_comments_409972.json:
```json
{
    "body": "Attachment [sigma_gauss_function.2.py](tarball://root/attachments/some-uuid/ticket29230/sigma_gauss_function.2.py) by @garambois created at 2020-02-22 11:48:40\n\nThank you very much chapoton.\n\nI have tried to follow your advice and also the advice given in the link you sent me.\n\nSo I modified the Ticket with the new code.\nAnd I enclose a modified \"sigma_gauss_function.py\" file.\nSorry, I attached the .py file twice, it's useless, but I couldn't remove the second one.\n\nTo switch from sage code to python code, I also had to make some other changes.",
    "created_at": "2020-02-22T11:48:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28993#issuecomment-409972",
    "user": "https://github.com/garambois"
}
```

Attachment [sigma_gauss_function.2.py](tarball://root/attachments/some-uuid/ticket29230/sigma_gauss_function.2.py) by @garambois created at 2020-02-22 11:48:40

Thank you very much chapoton.

I have tried to follow your advice and also the advice given in the link you sent me.

So I modified the Ticket with the new code.
And I enclose a modified "sigma_gauss_function.py" file.
Sorry, I attached the .py file twice, it's useless, but I couldn't remove the second one.

To switch from sage code to python code, I also had to make some other changes.



---

archive/issue_comments_409973.json:
```json
{
    "body": "Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28993#issuecomment-409973",
    "user": "https://github.com/mkoeppe"
}
```

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_comments_409974.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-08-29T15:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28993#issuecomment-409974",
    "user": "https://github.com/mkoeppe"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_409975.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28993#issuecomment-409975",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.
