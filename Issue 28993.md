# Issue 28993: Creation of the sigma function (sum of divisors) applicable to Gaussian integers

Issue created by migration from https://trac.sagemath.org/ticket/29230

Original creator: @garambois

Original creation time: 2020-02-21 10:29:27

CC:  zimmerma

Keywords: gaussian integers, sigma function, first quadrant

This is my first contribution !
Please forgive my possible clumsiness !

I would like to propose a new function for Sage called "sigma_gauss".
This function would be an extension of the sigma function in number theory, which calculates the sum of the divisors of integers.
The sigma_gauss function would apply to a Gaussian integer.

Here is the code I propose:



```python
#Calculation program sigma(z), z Gaussian integer.
#Calculates the sum of the complex divisors of z.
#The Gaussian integer prime factors must be taken in the first quadrant.
#Observation: equivalent to the Mathematica's function DivisorSigma [1, z, GaussianIntegers -> True]
#References http://mathworld.wolfram.com/DivisorFunction.html
#References https://www.jstor.org/stable/2312472?seq=1
#References https://encompass.eku.edu/etd/158/

R = GaussianIntegers()

def sigma_gauss_aux (l):
   s = 1
   e=0
   while e<len(l):
      p = l[e][0]
      k = l[e][1]
      s = s * (p^(k+1)-1) / (p-1)
      e+=1
   return R(s)

def sigma_gauss(z):
   ll=list(R(z).factor())
   l=[]
   i=0

#Gaussian prime factors must be selected in the first quadrant.
#To understand why, refer to the references cited at the beginning of the program.

   while i<len(ll):
      nz=ll[i][0]
      if real(nz)<0 and imag(nz)<0:
         nz=-nz
      if real(nz)<0 and imag(nz)>=0:
         nz=-I*nz
      if real(nz)>=0 and imag(nz)<0:
         nz=I*nz
      assert real(nz)>=0 and imag(nz)>=0
      lz=[nz,ll[i][1]]
      l.append(lz)
      i+=1
   r=0

#Be careful not to have the same factor twice in the list of factors after their selection in the first quadrant and before applying the "sigma_gauss_aux" function.

   while r<len(l)-1:
      t=r+1
      while t<len(l):
         if l[r][0]==l[t][0]:
            l[r][1]=l[r][1]+l[t][1]
            del l[t]
            t-=1
         t+=1
      r+=1
   for x,e in l:
      assert e != 0
   return sigma_gauss_aux(l)
```



---

Attachment


---

Comment by chapoton created at 2020-02-21 17:00:03

Zeroth step, read the developer guide : https://doc.sagemath.org/html/en/developer/#writing-code-for-sage

First step, make it work for you in a ".py" file and not a ".sage" file.

You will need to add some "import" lines, that you can find using "import_statements" command in sage. In particular

```
sage: import_statements(GaussianIntegers,real,imag)
# ** Warning **: several names for that object: real, real_part
# ** Warning **: several names for that object: imag, imag_part, imaginary
from sage.functions.other import real, imag
from sage.rings.number_field.order import GaussianIntegers
```



---

Attachment


---

Attachment

Thank you very much chapoton.

I have tried to follow your advice and also the advice given in the link you sent me.

So I modified the Ticket with the new code.
And I enclose a modified "sigma_gauss_function.py" file.
Sorry, I attached the .py file twice, it's useless, but I couldn't remove the second one.

To switch from sage code to python code, I also had to make some other changes.


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by mkoeppe created at 2020-08-29 15:57:24

Changing type from PLEASE CHANGE to enhancement.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.
