# Issue 33054: SAGE icon links on PDF reference documents index webpage are broken from the jupyter notebook

Issue created by migration from https://trac.sagemath.org/ticket/33291

Original creator: strogdon

Original creation time: 2022-02-05 05:26:16

CC:  klee

The SAGE icons are located on the left at the top and bottom of the PDF reference documents index webpage. The webpage from the jupyter notebook is

[http://localhost:8888/kernelspecs/sagemath/doc/pdf/en/reference/index.html](http://localhost:8888/kernelspecs/sagemath/doc/pdf/en/reference/index.html)

The icon links point to

```
grep 'en/index.html' local/share/doc/sage/pdf/en/reference/index.html
    <a href="/local/sage-git/sage/local/share/doc/sage/html/en/index.html"><img src="_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    <a href="/local/sage-git/sage/local/share/doc/sage/html/en/index.html"><img src="_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
```

which cannot be accessed from the jupyter notebook.





---

Comment by strogdon created at 2022-02-05 05:48:39

One solution is to use relative links. The following will do this

```
diff --git a/src/sage_docbuild/__init__.py b/src/sage_docbuild/__init__.py
index 9160119baa..d33ae91239 100644
--- a/src/sage_docbuild/__init__.py
+++ b/src/sage_docbuild/__init__.py
@@ -630,8 +630,10 @@ class ReferenceTopBuilder(DocBuilder):
         with open(os.path.join(website_dir, 'index.html')) as f:
             html = f.read().replace('Documentation', 'Reference')
         html_output_dir = os.path.dirname(website_dir)
+        pdf_output_dir = os.path.join(SAGE_DOC, 'html', 'en', 'pdf', 'en', 'reference')
+        relpath=os.path.relpath(html_output_dir, pdf_output_dir)
         html = html.replace('http://www.sagemath.org',
-                            os.path.join(html_output_dir, 'index.html'))
+                            os.path.join(relpath, 'index.html'))
         # From index.html, we want the preamble and the tail.
         html_end_preamble = html.find('<h1>Sage Reference')
         html_bottom = html.rfind('</table>') + len('</table>')
```


A disadvantage of this approach in that if the `index.html` file

```
local/share/doc/sage/pdf/en/reference/index.html
```

is accessed directly (locate file in a browser) then the icon links are broken. If accessed through

```
local/share/doc/sage/html/en/pdf/en/reference/index.html
```

then the icon links work. I'm not sure what best practices are in this case. Or if there is some other way to resolve the issue.


---

Comment by klee created at 2022-02-07 08:56:39

#33309 perhaps fixes this.


---

Comment by strogdon created at 2022-02-07 16:42:43

This appears to be addressed on #33309.


---

Comment by strogdon created at 2022-02-07 16:42:43

Changing status from new to needs_review.


---

Comment by strogdon created at 2022-02-07 21:43:15

Changing status from needs_review to positive_review.


---

Comment by klee created at 2022-02-07 22:42:14

Reviewer should be a different person.


---

Comment by mkoeppe created at 2022-02-12 18:02:50

Resolution: invalid
