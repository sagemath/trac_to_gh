# Issue 24523: convert cluster interact to jupyter notebook

archive/issues_024523.json:
```json
{
    "body": "CC:  sage-combinat stumpc5 @jasongrout @etn40ff\n\nto avoid importing sagenb\n\nIssue created by migration from https://trac.sagemath.org/ticket/24760\n\n",
    "created_at": "2018-02-16T16:51:08Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "convert cluster interact to jupyter notebook",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24523",
    "user": "@fchapoton"
}
```
CC:  sage-combinat stumpc5 @jasongrout @etn40ff

to avoid importing sagenb

Issue created by migration from https://trac.sagemath.org/ticket/24760





---

archive/issue_comments_344094.json:
```json
{
    "body": "What is the \"cluster interact\"?",
    "created_at": "2018-02-16T16:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344094",
    "user": "@jdemeyer"
}
```

What is the "cluster interact"?



---

archive/issue_comments_344095.json:
```json
{
    "body": "one second, branch coming",
    "created_at": "2018-02-16T17:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344095",
    "user": "@fchapoton"
}
```

one second, branch coming



---

archive/issue_comments_344096.json:
```json
{
    "body": "and help would be welcome..\n----\nNew commits:",
    "created_at": "2018-02-16T17:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344096",
    "user": "@fchapoton"
}
```

and help would be welcome..
----
New commits:



---

archive/issue_comments_344097.json:
```json
{
    "body": "I failed to make it work. This is related to #24595",
    "created_at": "2018-02-16T17:01:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344097",
    "user": "@fchapoton"
}
```

I failed to make it work. This is related to #24595



---

archive/issue_comments_344098.json:
```json
{
    "body": "Just a few comments:\n\n1. Ideally, you would return the interact instead of displaying it. This means replacing ``@`interact` by ``@`interact.widget` and then returning `player`.\n\n2. I wouldn't bother checking for Jupyter. In the worst case, you get a warning like\n\n```\n[SageTerminalApp] WARNING | Widget Javascript not detected.  It may not be installed or enabled properly.\nWidget Javascript not detected.  It may not be installed or enabled properly.\n```\n",
    "created_at": "2018-02-16T19:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344098",
    "user": "@jdemeyer"
}
```

Just a few comments:

1. Ideally, you would return the interact instead of displaying it. This means replacing ``@`interact` by ``@`interact.widget` and then returning `player`.

2. I wouldn't bother checking for Jupyter. In the worst case, you get a warning like

```
[SageTerminalApp] WARNING | Widget Javascript not detected.  It may not be installed or enabled properly.
Widget Javascript not detected.  It may not be installed or enabled properly.
```




---

archive/issue_comments_344099.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-16T19:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344099",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344100.json:
```json
{
    "body": "Thanks for the hints. I have changed the code accordingly.\n\nBut alas, this is still not doing what it should. Namely, I would like to use a global variable, but of course this does not make much sense..\n\nThe problem is that it must distinguish between clicks on the numbers at top (first parameter k) that means 'doing a mutation at vertex k\" (changing the displayed graph) to clicks on the other checkboxes, that just mean display or not a few additional fixes, but do not perform any mutation.",
    "created_at": "2018-02-16T19:32:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344100",
    "user": "@fchapoton"
}
```

Thanks for the hints. I have changed the code accordingly.

But alas, this is still not doing what it should. Namely, I would like to use a global variable, but of course this does not make much sense..

The problem is that it must distinguish between clicks on the numbers at top (first parameter k) that means 'doing a mutation at vertex k" (changing the displayed graph) to clicks on the other checkboxes, that just mean display or not a few additional fixes, but do not perform any mutation.



---

archive/issue_comments_344101.json:
```json
{
    "body": "Pro tip: if you are thinking about using ipywidgets interacts non-trivially, you shouldn't be using interacts.\n\nThere is a difference in philosophy between sagenb interact and ipywidgets interacts: with sagenb, the only way to do anything with widgets is to use ``@`interact`. This leads to ugly solutions such as the old code for the cluster interact (did you see how it abuses the lists `sft, sss, ssv ssm, ssl`?)\n\nWith ipywidgets on the other hand, the widgets are the basic building blocks. There is a lot of stuff you can do with widgets without using ``@`interact`. They do provide an interact function for convenience, but it's really just a wrapper over the underlying widgets. You might as well wrap the widgets yourself.\n\nIn more detail: when you add ``@`interact` to a function, it gets an attribute `.widget` which is an instance of `ipywidgets.widgets.interaction.interactive`:\n\n```\nsage: from ipywidgets import interact\nsage: @interact\n....: def f(x=0, y=True, z=range(4)): pass\n[SageTerminalApp] WARNING | Widget Javascript not detected.  It may not be installed or enabled properly.\nWidget Javascript not detected.  It may not be installed or enabled properly.\nsage: widget = f.widget\nsage: type(widget)\n<class 'ipywidgets.widgets.interaction.interactive'>\n```\n\nThis widget is really just a special vertical box of widgets:\n\n```\nsage: type(f.widget).__bases__\n(<class 'ipywidgets.widgets.widget_box.VBox'>,)\nsage: f.widget.children\n(IntSlider(value=0, min=0, max=1, step=1, description=u'x'),\n Checkbox(value=True, description=u'y'),\n Dropdown(value=0, options=[0, 1, 2, 3], description=u'z'),\n Output())\n```\n\nIf you would manually construct a `VBox` of those 4 widgets, you would already get the interact but without the callbacks to make it interactive and to display the output.",
    "created_at": "2018-02-16T19:51:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344101",
    "user": "@jdemeyer"
}
```

Pro tip: if you are thinking about using ipywidgets interacts non-trivially, you shouldn't be using interacts.

There is a difference in philosophy between sagenb interact and ipywidgets interacts: with sagenb, the only way to do anything with widgets is to use ``@`interact`. This leads to ugly solutions such as the old code for the cluster interact (did you see how it abuses the lists `sft, sss, ssv ssm, ssl`?)

With ipywidgets on the other hand, the widgets are the basic building blocks. There is a lot of stuff you can do with widgets without using ``@`interact`. They do provide an interact function for convenience, but it's really just a wrapper over the underlying widgets. You might as well wrap the widgets yourself.

In more detail: when you add ``@`interact` to a function, it gets an attribute `.widget` which is an instance of `ipywidgets.widgets.interaction.interactive`:

```
sage: from ipywidgets import interact
sage: @interact
....: def f(x=0, y=True, z=range(4)): pass
[SageTerminalApp] WARNING | Widget Javascript not detected.  It may not be installed or enabled properly.
Widget Javascript not detected.  It may not be installed or enabled properly.
sage: widget = f.widget
sage: type(widget)
<class 'ipywidgets.widgets.interaction.interactive'>
```

This widget is really just a special vertical box of widgets:

```
sage: type(f.widget).__bases__
(<class 'ipywidgets.widgets.widget_box.VBox'>,)
sage: f.widget.children
(IntSlider(value=0, min=0, max=1, step=1, description=u'x'),
 Checkbox(value=True, description=u'y'),
 Dropdown(value=0, options=[0, 1, 2, 3], description=u'z'),
 Output())
```

If you would manually construct a `VBox` of those 4 widgets, you would already get the interact but without the callbacks to make it interactive and to display the output.



---

archive/issue_comments_344102.json:
```json
{
    "body": "Hmm. I understand, sort of. But I am going to have a hard time if I ever try to do something like that. I guess it will require widgets-communication somewhere.",
    "created_at": "2018-02-16T20:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344102",
    "user": "@fchapoton"
}
```

Hmm. I understand, sort of. But I am going to have a hard time if I ever try to do something like that. I guess it will require widgets-communication somewhere.



---

archive/issue_comments_344103.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-16T20:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344103",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344104.json:
```json
{
    "body": "ok, I made a tentative use of widgets. But this is not quite working.",
    "created_at": "2018-02-16T20:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344104",
    "user": "@fchapoton"
}
```

ok, I made a tentative use of widgets. But this is not quite working.



---

archive/issue_comments_344105.json:
```json
{
    "body": "I meant not using `interact` at all.",
    "created_at": "2018-02-17T09:11:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344105",
    "user": "@jdemeyer"
}
```

I meant not using `interact` at all.



---

archive/issue_comments_344106.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-17T09:13:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344106",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344107.json:
```json
{
    "body": "Here is my latest try..",
    "created_at": "2018-02-17T09:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344107",
    "user": "@fchapoton"
}
```

Here is my latest try..



---

archive/issue_comments_344108.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-17T13:59:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344108",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344109.json:
```json
{
    "body": "Damn. This sort of works, but the output accumulates instead of being replaced..",
    "created_at": "2018-02-17T14:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344109",
    "user": "@fchapoton"
}
```

Damn. This sort of works, but the output accumulates instead of being replaced..



---

archive/issue_comments_344110.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-02-18T07:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344110",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_344111.json:
```json
{
    "body": "now works quite well, except that one cannot perform the same action twice (related to #24595)",
    "created_at": "2018-02-18T08:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344111",
    "user": "@fchapoton"
}
```

now works quite well, except that one cannot perform the same action twice (related to #24595)



---

archive/issue_comments_344112.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-19T13:20:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344112",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344113.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-02-19T13:21:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344113",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_344114.json:
```json
{
    "body": "now looks good. Except that it is very easy to have repeated clicks without wanting them.",
    "created_at": "2018-02-19T13:21:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344114",
    "user": "@fchapoton"
}
```

now looks good. Except that it is very easy to have repeated clicks without wanting them.



---

archive/issue_comments_344115.json:
```json
{
    "body": "Great, thanks for making this work again! -- everything seems to work as expected.\n\nConcerning the usage, I have two issues that I believe had worked better before:\n\n1. currently nothing is shown when initially running `S.interact()`. The quiver and the additional info only show after the first mutation.\n\n2. the \"window\" showing the buttons and the info seems to be of a fixed height, so I have to do a mutation and then scroll down inside this window as shown in https://screenshots.firefox.com/nTDuxI5z46neAILs/localhost\n\nI cannot review the code whatsoever, but the usage is fine (and the two issues are only worth solving if they are easily fixed).",
    "created_at": "2018-02-20T11:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344115",
    "user": "stumpc5"
}
```

Great, thanks for making this work again! -- everything seems to work as expected.

Concerning the usage, I have two issues that I believe had worked better before:

1. currently nothing is shown when initially running `S.interact()`. The quiver and the additional info only show after the first mutation.

2. the "window" showing the buttons and the info seems to be of a fixed height, so I have to do a mutation and then scroll down inside this window as shown in https://screenshots.firefox.com/nTDuxI5z46neAILs/localhost

I cannot review the code whatsoever, but the usage is fine (and the two issues are only worth solving if they are easily fixed).



---

archive/issue_comments_344116.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-20T13:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344116",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344117.json:
```json
{
    "body": "This is not yet working as expected...",
    "created_at": "2018-02-20T13:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344117",
    "user": "@fchapoton"
}
```

This is not yet working as expected...



---

archive/issue_comments_344118.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-02-20T14:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344118",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344119.json:
```json
{
    "body": "Regarding\n\n```\n        # not clear how to get the right behaviour here\n        # doing both has some side effects (one click : two mutations)\n        mut_buttons.on_msg(do_mutation)\n        mut_buttons.observe(do_mutation, 'value')\n```\n\nis it not sufficient to keep only the `on_msg()` call?",
    "created_at": "2018-02-20T14:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344119",
    "user": "@jdemeyer"
}
```

Regarding

```
        # not clear how to get the right behaviour here
        # doing both has some side effects (one click : two mutations)
        mut_buttons.on_msg(do_mutation)
        mut_buttons.observe(do_mutation, 'value')
```

is it not sufficient to keep only the `on_msg()` call?



---

archive/issue_comments_344120.json:
```json
{
    "body": "With on_msg only, the button 0 seems to be always on (darker), and triggers a mutation at the previous vertex which is not 0. Like if the button 0 does not change the value, but triggers a msg.. I see really strange effects..",
    "created_at": "2018-02-20T14:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344120",
    "user": "@fchapoton"
}
```

With on_msg only, the button 0 seems to be always on (darker), and triggers a mutation at the previous vertex which is not 0. Like if the button 0 does not change the value, but triggers a msg.. I see really strange effects..



---

archive/issue_comments_344121.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-20T14:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344121",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344122.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-20T16:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344122",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344123.json:
```json
{
    "body": "Is the `ToggleButtons` widget broken or what ? When trying\n\n```\nn=5\nwidgets.ToggleButtons(options=list(range(n)),\n                                            button_style='',\n                                            description='Mutate at: ')\n```\n\nin my notebook (using chrome) the selection always remains on 0.\n\nEDIT: same wrong behaviour with python2 kernel.",
    "created_at": "2018-02-21T13:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344123",
    "user": "@fchapoton"
}
```

Is the `ToggleButtons` widget broken or what ? When trying

```
n=5
widgets.ToggleButtons(options=list(range(n)),
                                            button_style='',
                                            description='Mutate at: ')
```

in my notebook (using chrome) the selection always remains on 0.

EDIT: same wrong behaviour with python2 kernel.



---

archive/issue_comments_344124.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-28T15:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344124",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344125.json:
```json
{
    "body": "I have opened an issue: https://github.com/jupyter-widgets/ipywidgets/issues/1987",
    "created_at": "2018-02-28T15:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344125",
    "user": "@fchapoton"
}
```

I have opened an issue: https://github.com/jupyter-widgets/ipywidgets/issues/1987



---

archive/issue_comments_344126.json:
```json
{
    "body": "Changing keywords from \"\" to \"cluster\".",
    "created_at": "2018-02-28T18:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344126",
    "user": "@fchapoton"
}
```

Changing keywords from "" to "cluster".



---

archive/issue_comments_344127.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-02T09:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344127",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344128.json:
```json
{
    "body": "Jason, may you please help with the ipywidgets upstream issue ?",
    "created_at": "2018-03-02T09:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344128",
    "user": "@fchapoton"
}
```

Jason, may you please help with the ipywidgets upstream issue ?



---

archive/issue_comments_344129.json:
```json
{
    "body": "This will have to wait for ipywidgets 7.1.3, probably.",
    "created_at": "2018-03-05T10:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344129",
    "user": "@fchapoton"
}
```

This will have to wait for ipywidgets 7.1.3, probably.



---

archive/issue_comments_344130.json:
```json
{
    "body": "Now this is fully ready, but will not work perfectly until ipywidgets is updated to a version including the upstream changes.\n\nShould we wait, give that the actual interact is currently fully broken ?",
    "created_at": "2018-03-08T19:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344130",
    "user": "@fchapoton"
}
```

Now this is fully ready, but will not work perfectly until ipywidgets is updated to a version including the upstream changes.

Should we wait, give that the actual interact is currently fully broken ?



---

archive/issue_comments_344131.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-08T19:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344131",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344132.json:
```json
{
    "body": "doctest does not pass.. sigh...",
    "created_at": "2018-03-09T08:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344132",
    "user": "@fchapoton"
}
```

doctest does not pass.. sigh...



---

archive/issue_comments_344133.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-09T08:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344133",
    "user": "@fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344134.json:
```json
{
    "body": "fyi: when clicking the \"0\" button, it still gets mutated at vertex \"1\", this might be part of the bug in the widget though.",
    "created_at": "2018-03-12T10:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344134",
    "user": "stumpc5"
}
```

fyi: when clicking the "0" button, it still gets mutated at vertex "1", this might be part of the bug in the widget though.



---

archive/issue_comments_344135.json:
```json
{
    "body": "For future work reference: this seems to work only for `ClusterQuiver` but not for `ClusterSeed` (I get an error that it works only in the notebook when doing\n\n```\nsage: Q = ClusterQuiver(['A',3])\nsage: Q.interact()\n```\n\nand I also get an error if the vertex labels are \"a\",\"b\",\"c\":\n\n```\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n/home/stumpc5/Programs/sage/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/cluster_seed.pyc in refresh(w)\n   1111                 clear_output(wait=True)\n   1112                 if show_lastmutation.value:\n-> 1113                     self.show(fig_size=fig_size, circular=circular, mark=k)\n   1114                 else:\n   1115                     self.show(fig_size=fig_size, circular=circular)\n\n/home/stumpc5/Programs/sage/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/cluster_seed.pyc in show(self, fig_size, circular, mark, save_pos, force_c, with_greens, add_labels)\n   1043             quiver = self.quiver()\n   1044 \n-> 1045         quiver.show(fig_size=fig_size, circular=circular,mark=mark,save_pos=save_pos, greens=greens)\n   1046 \n   1047     def interact(self, fig_size=1, circular=True):\n\n/home/stumpc5/Programs/sage/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/quiver.pyc in show(self, fig_size, circular, directed, mark, save_pos, greens)\n    671         \"\"\"\n    672         n, m = self._n, self._m\n--> 673         plot = self.plot( circular=circular, directed=directed, mark=mark, save_pos=save_pos, greens=greens)\n    674         if circular:\n    675             plot.show( figsize=[fig_size*3*(n+m)/4+1,fig_size*3*(n+m)/4+1] )\n\n/home/stumpc5/Programs/sage/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/quiver.pyc in plot(self, circular, center, directed, mark, save_pos, greens)\n    611                 partition = (nlist, mlist, [mark])\n    612             else:\n--> 613                 raise ValueError(\"The given mark is not a vertex of self.\")\n    614         else:\n    615 \n\nValueError: The given mark is not a vertex of self.\n```\n",
    "created_at": "2018-03-12T10:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344135",
    "user": "stumpc5"
}
```

For future work reference: this seems to work only for `ClusterQuiver` but not for `ClusterSeed` (I get an error that it works only in the notebook when doing

```
sage: Q = ClusterQuiver(['A',3])
sage: Q.interact()
```

and I also get an error if the vertex labels are "a","b","c":

```
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
/home/stumpc5/Programs/sage/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/cluster_seed.pyc in refresh(w)
   1111                 clear_output(wait=True)
   1112                 if show_lastmutation.value:
-> 1113                     self.show(fig_size=fig_size, circular=circular, mark=k)
   1114                 else:
   1115                     self.show(fig_size=fig_size, circular=circular)

/home/stumpc5/Programs/sage/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/cluster_seed.pyc in show(self, fig_size, circular, mark, save_pos, force_c, with_greens, add_labels)
   1043             quiver = self.quiver()
   1044 
-> 1045         quiver.show(fig_size=fig_size, circular=circular,mark=mark,save_pos=save_pos, greens=greens)
   1046 
   1047     def interact(self, fig_size=1, circular=True):

/home/stumpc5/Programs/sage/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/quiver.pyc in show(self, fig_size, circular, directed, mark, save_pos, greens)
    671         """
    672         n, m = self._n, self._m
--> 673         plot = self.plot( circular=circular, directed=directed, mark=mark, save_pos=save_pos, greens=greens)
    674         if circular:
    675             plot.show( figsize=[fig_size*3*(n+m)/4+1,fig_size*3*(n+m)/4+1] )

/home/stumpc5/Programs/sage/local/lib/python2.7/site-packages/sage/combinat/cluster_algebra_quiver/quiver.pyc in plot(self, circular, center, directed, mark, save_pos, greens)
    611                 partition = (nlist, mlist, [mark])
    612             else:
--> 613                 raise ValueError("The given mark is not a vertex of self.")
    614         else:
    615 

ValueError: The given mark is not a vertex of self.
```




---

archive/issue_comments_344136.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-16T07:57:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344136",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344137.json:
```json
{
    "body": "I have done a copy-paste for the `ClusterQuiver` interact, but removing the variables.\n\nClicking on 0 will work when ipywidgets is updated.\n\nFor labels, maybe this can wait. I propose to keep more enhancements for a later ticket. The really important task done here is to get rid of the import of sagenb, to move towards python3. \n\nEDIT: bot is morally green",
    "created_at": "2018-03-16T13:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344137",
    "user": "@fchapoton"
}
```

I have done a copy-paste for the `ClusterQuiver` interact, but removing the variables.

Clicking on 0 will work when ipywidgets is updated.

For labels, maybe this can wait. I propose to keep more enhancements for a later ticket. The really important task done here is to get rid of the import of sagenb, to move towards python3. 

EDIT: bot is morally green



---

archive/issue_comments_344138.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-17T15:02:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344138",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344139.json:
```json
{
    "body": "Replying to [comment:42 chapoton]:\n> I have done a copy-paste for the `ClusterQuiver` interact, but removing the variables.\n\nIf you need to copy/paste code, you're doing it wrong.\n\nWhy not factor this out into a subclass or separate function?\n\n> Clicking on 0 will work when ipywidgets is updated.\n\nCould we not backport the upstream patch?",
    "created_at": "2018-03-19T20:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344139",
    "user": "@jdemeyer"
}
```

Replying to [comment:42 chapoton]:
> I have done a copy-paste for the `ClusterQuiver` interact, but removing the variables.

If you need to copy/paste code, you're doing it wrong.

Why not factor this out into a subclass or separate function?

> Clicking on 0 will work when ipywidgets is updated.

Could we not backport the upstream patch?



---

archive/issue_comments_344140.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-19T20:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344140",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_344141.json:
```json
{
    "body": "Changing component from combinatorics to notebook.",
    "created_at": "2018-03-19T20:19:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344141",
    "user": "@jdemeyer"
}
```

Changing component from combinatorics to notebook.



---

archive/issue_comments_344142.json:
```json
{
    "body": "Replying to [comment:44 jdemeyer]:\n> Could we not backport the upstream patch?\n\nAnswering my own question... It's using typescript, which needs to be compiled at packaging-time (I guess), so that is not so trivial.",
    "created_at": "2018-03-19T20:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344142",
    "user": "@jdemeyer"
}
```

Replying to [comment:44 jdemeyer]:
> Could we not backport the upstream patch?

Answering my own question... It's using typescript, which needs to be compiled at packaging-time (I guess), so that is not so trivial.



---

archive/issue_comments_344143.json:
```json
{
    "body": "I'm going through ipywidgets issues today in preparation for our next release. There are a few issues I want to address, and hope to have a new release (or at least an RC) out today or tomorrow.",
    "created_at": "2018-03-19T21:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344143",
    "user": "@jasongrout"
}
```

I'm going through ipywidgets issues today in preparation for our next release. There are a few issues I want to address, and hope to have a new release (or at least an RC) out today or tomorrow.



---

archive/issue_comments_344144.json:
```json
{
    "body": "(Next time, feel free to ping me on an ipywidgets issue, as I see those more often than trac notifications)",
    "created_at": "2018-03-19T21:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344144",
    "user": "@jasongrout"
}
```

(Next time, feel free to ping me on an ipywidgets issue, as I see those more often than trac notifications)



---

archive/issue_comments_344145.json:
```json
{
    "body": "Replying to [comment:47 jason]:\n> There are a few issues I want to address, and hope to have a new release (or at least an RC) out today or tomorrow.\n\nIn this case, I would rather wait with this ticket until the new release.",
    "created_at": "2018-03-20T07:04:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344145",
    "user": "@jdemeyer"
}
```

Replying to [comment:47 jason]:
> There are a few issues I want to address, and hope to have a new release (or at least an RC) out today or tomorrow.

In this case, I would rather wait with this ticket until the new release.



---

archive/issue_comments_344146.json:
```json
{
    "body": "I've created a milestone for the release: https://github.com/jupyter-widgets/ipywidgets/milestone/25\n\nGiven the number of issues to review from the work today, it may be a few more days before a release, but hopefully by the end of the week.",
    "created_at": "2018-03-20T07:22:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344146",
    "user": "@jasongrout"
}
```

I've created a milestone for the release: https://github.com/jupyter-widgets/ipywidgets/milestone/25

Given the number of issues to review from the work today, it may be a few more days before a release, but hopefully by the end of the week.



---

archive/issue_comments_344147.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-21T16:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344147",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344148.json:
```json
{
    "body": "I just recompiled your newest version and get\n\n```\nAttributeError: 'ClusterQuiver' object has no attribute 'cluster_variable'\n```\n\nso the `ClusterQuiver` interact still hopes for variables to exist...",
    "created_at": "2018-03-22T17:37:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344148",
    "user": "stumpc5"
}
```

I just recompiled your newest version and get

```
AttributeError: 'ClusterQuiver' object has no attribute 'cluster_variable'
```

so the `ClusterQuiver` interact still hopes for variables to exist...



---

archive/issue_comments_344149.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-23T08:44:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344149",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_344150.json:
```json
{
    "body": "thanks for taking care of this!",
    "created_at": "2018-03-23T10:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344150",
    "user": "stumpc5"
}
```

thanks for taking care of this!



---

archive/issue_comments_344151.json:
```json
{
    "body": "I opened #25074 for the necessary upgrade of ipywidgets.",
    "created_at": "2018-04-01T07:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344151",
    "user": "@fchapoton"
}
```

I opened #25074 for the necessary upgrade of ipywidgets.



---

archive/issue_comments_344152.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-04-01T07:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344152",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_344153.json:
```json
{
    "body": "ipywidgets has been updated in the latest beta 8.3.b1\n\nCan someone please re-check that this is ready to go ?",
    "created_at": "2018-05-15T15:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344153",
    "user": "@fchapoton"
}
```

ipywidgets has been updated in the latest beta 8.3.b1

Can someone please re-check that this is ready to go ?



---

archive/issue_comments_344154.json:
```json
{
    "body": "This now works fine for me, both for seeds and quivers. Please confirm.",
    "created_at": "2018-05-16T09:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344154",
    "user": "@fchapoton"
}
```

This now works fine for me, both for seeds and quivers. Please confirm.



---

archive/issue_comments_344155.json:
```json
{
    "body": "I will only be able to test on Tuesday next week, but if it works for you feel free to give it set it to positive!",
    "created_at": "2018-05-16T10:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344155",
    "user": "stumpc5"
}
```

I will only be able to test on Tuesday next week, but if it works for you feel free to give it set it to positive!



---

archive/issue_comments_344156.json:
```json
{
    "body": "ok. I am setting to positive now.",
    "created_at": "2018-05-17T06:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344156",
    "user": "@fchapoton"
}
```

ok. I am setting to positive now.



---

archive/issue_comments_344157.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-17T06:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344157",
    "user": "@fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_344158.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-18T17:50:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24523",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24523#issuecomment-344158",
    "user": "@vbraun"
}
```

Resolution: fixed
