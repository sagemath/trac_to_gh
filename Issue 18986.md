# Issue 18986: Graphs: missing error check for depth_first_search(..., distance=0)

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2015-09-16 13:00:58

CC:  ncohen


```
G = Graph({1:[2]})
list(G.depth_first_search('junk', distance=0))
```


outputs `['junk']`, but it should raise an exception. With `distance=1` it works. Same happens with `breadth_first_search()`.

Also `distance` is not checked and `G.depth_first_search(1, distance='junk')` works like `distance=None`.


---

Comment by jmantysalo created at 2015-09-16 15:40:38

Nathann: Can you check `c_graph.pyx` just to make sure I did nothing stupid? I added a check to surface level, and so I had to change one test in the deeper level.
----
New commits:


---

Comment by ncohen created at 2015-09-16 15:55:04

Hello Jori,

What you did is not exactly wrong, but we should really find something better than adding 30 lines of code to deal with a rather stupid corner-case. Though I admit that I do not see one at the moment.

Technically (though that is not the biggest problem here) try to only wrap the smallest amount of line in a try/except. When you write too much in a try/except, you run the risk of catching exceptions raised legitimately by other functions.

Nathann


---

Comment by ncohen created at 2015-09-16 15:56:45

'Another way' may be to do this kind of replacement:


```diff
-queue=[(v,0) for v in reversed(start)]
+queue=[(v,0) for v in reversed(start) if v in self]
```


The behaviour is a bit different, but well... What do you think?

Nathann


---

Comment by jmantysalo created at 2015-09-17 04:22:03

Fix might collide with #19227, so let's hold this one after much more important bug is corrected.


---

Comment by jmantysalo created at 2015-09-25 15:58:36

Replying to [comment:4 ncohen]:
> 'Another way' may be to do this kind of replacement:
> 
> {{{
> #!diff
> -queue=[(v,0) for v in reversed(start)]
> +queue=[(v,0) for v in reversed(start) if v in self]
> }}}
> 
> The behaviour is a bit different, but well... What do you think?

For every case, also to those with `distance != 0`? Sounds kind of dangerous.

> we should really find something better than adding 30 lines of code to deal with a rather stupid corner-case

Simple. We should have global internal functions for this. Like `_check_integer_all()`, `_check_integer_nonnegative()` and `_check_integer_positive()`. Then also error messages would be consistent.

A topic for sage-devel?


---

Comment by ncohen created at 2015-09-26 13:20:51

> Simple. We should have global internal functions for this. Like `_check_integer_all()`, `_check_integer_nonnegative()` and `_check_integer_positive()`. Then also error messages would be consistent.
> 
> A topic for sage-devel?

Yep. A module somewhere with (fast) functions to check the type of a couple of things would be cool indeed.

Nathann


---

Comment by git created at 2015-09-28 07:49:32

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jmantysalo created at 2015-09-28 07:51:37

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2015-09-28 07:51:37

As #19227 deprecated `distance` on dfs, this only changes bfs. Now there is one more point to detect errors.


---

Comment by ncohen created at 2015-09-28 08:13:42

Add a 'a' before 'nonnegative integer' and it can go.


---

Comment by git created at 2015-09-28 09:02:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2015-09-28 09:09:12

Replying to [comment:10 ncohen]:
> Add a 'a' before 'nonnegative integer' and it can go.

This corrected, tests passed -> positive review.

Thanks!


---

Comment by jmantysalo created at 2015-09-28 09:09:12

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-10-14 17:09:50

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2015-10-14 17:09:50

Reviewer name


---

Comment by ncohen created at 2015-10-14 17:13:54

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2015-10-16 18:42:38

Resolution: fixed
