# Issue 19720: Asymptotic ring: list plot comparing values

Issue created by migration from https://trac.sagemath.org/ticket/19957

Original creator: cheuberg

Original creation time: 2016-01-25 06:43:48

CC:  dkrenn behackl

Implement a new helper method for plausibility check of asymptotic expansions.


---

Comment by cheuberg created at 2016-01-25 07:27:38

New commits:


---

Comment by git created at 2016-01-25 07:37:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-01-25 07:47:51

Changing status from new to needs_review.


---

Comment by behackl created at 2016-01-25 08:00:50

Hi! I really like the idea of this ticket; graphic comparison is quite useful. Quick remarks:

- should there be a keyword `scaled=True` with which the division by the error term can be controlled?
- would it make sense to be able to compare against expansions without error term?
- what do you think of a `PLOTS::`-section for the documentation?


---

Comment by behackl created at 2016-01-25 08:01:12

Changing status from needs_review to needs_info.


---

Comment by cheuberg created at 2016-01-25 08:15:08

Replying to [comment:5 behackl]:
> Hi! I really like the idea of this ticket; graphic comparison is quite useful. Quick remarks:
> 
> - should there be a keyword `scaled=True` with which the division by the error term can be controlled?

what would `scaled=True` and `scaled=False` do?

> - would it make sense to be able to compare against expansions without error term?

if there is no error term, then there is no need to rescale nor plot,
`all( ... for ...)` should do the trick in that case.

> - what do you think of a `PLOTS::`-section for the documentation?

Within a finite amount of time, I could not get it to work. In any case, this is distinct from doctesting; thus one would have to repeat all commands to generate the plot. Sage preparsing apparently does not work here. Then I got a strange error message.

For doctests, I rather think that we might want to output the list itself instead of the list plot, perhaps already piped through `RIF` or something like that. That would make useful doctests (and could be used throughout the modules during review phases). Thus there could be a flag `return_list=True` or something like that (or a separate method computing the list which could be used in this method here ...).


---

Comment by behackl created at 2016-01-25 23:50:54

Changing status from needs_info to needs_review.


---

Comment by behackl created at 2016-01-25 23:50:54

Replying to [comment:7 cheuberg]:
> > - should there be a keyword `scaled=True` with which the division by the error term can be controlled?
> 
> what would `scaled=True` and `scaled=False` do?

Plot the relative and the absolute error, respectively. Sometimes I like to look at both.

> 
> > - what do you think of a `PLOTS::`-section for the documentation?
> 
> Within a finite amount of time, I could not get it to work. In any case, this is distinct from doctesting; thus one would have to repeat all commands to generate the plot. Sage preparsing apparently does not work here. Then I got a strange error message.
> 

I couldn't get it to work either: some strange error regarding coercion of a function to `SR` occurrs...

> For doctests, I rather think that we might want to output the list itself instead of the list plot, perhaps already piped through `RIF` or something like that. That would make useful doctests (and could be used throughout the modules during review phases). Thus there could be a flag `return_list=True` or something like that (or a separate method computing the list which could be used in this method here ...).

I've implemented parts of this: there are now two methods; one for computing the list of differences and one for actually plotting. Also, for the sake of convenience, I've added the option to input a symbolic expression containing at most one variable.

Regarding the output: while I'd really like to have RIFs in the output of the difference method, unfortunately this causes problems for `list_plot`, e.g. try

```
sage: list_plot([(k, RIF(sqrt(k))) for k in srange(10)])
```

If the difference should lie in a RIF, the list would have to be processed again before plotting.

Opinions?
----
New commits:


---

Comment by dkrenn created at 2016-01-26 07:29:18

Replying to [comment:8 behackl]:
> Regarding the output: while I'd really like to have RIFs in the output of the difference method, unfortunately this causes problems for `list_plot`, e.g. try
> {{{
> sage: list_plot([(k, RIF(sqrt(k))) for k in srange(10)])
> }}}
> If the difference should lie in a RIF, the list would have to be processed again before plotting.

#15011.


---

Comment by cheuberg created at 2016-01-26 12:08:50

Changing status from needs_review to needs_work.


---

Comment by cheuberg created at 2016-01-26 12:08:50

1. `compare_with_value` should have a parameter `ring=RIF` and results should be converted into ring
2. Examples section should still contain an example with a function
3. `see also` block from `compare_with_value` to `plot_comparison`
4. why `*kwargs` in the call of `list_plot` instead of `**kwargs`?
5. Example with non-trivial arguments, i.e. setting a color.
6. `plot_comparison` will then need conversion from RIF to RR; this could also check whether there is still precision left (relative error of 1% seems to be tolerable for a plot) and raise an error otherwise.
7. `plot_comparison` should also accept a `ring`; it should be documented and treated to be a `RealIntervalField`.


---

Comment by behackl created at 2016-01-26 19:44:37

Thanks for looking over my adaptions!

Replying to [comment:10 cheuberg]:
> 1. `compare_with_value` should have a parameter `ring=RIF` and results should be converted into ring

Done.

> 2. Examples section should still contain an example with a function

Done.

> 3. `see also` block from `compare_with_value` to `plot_comparison`

Done.

> 4. why `*kwargs` in the call of `list_plot` instead of `**kwargs`?

Typo. Fixed.

> 5. Example with non-trivial arguments, i.e. setting a color.

I've added a more sophisticated doctest.

> 6. `plot_comparison` will then need conversion from RIF to RR; this could also check whether there is still precision left (relative error of 1% seems to be tolerable for a plot) and raise an error otherwise.

Done. The check currently is for a relative diameter of less than `0.025`, which seems like a somewhat practical choice (the example with the harmonic numbers then works up to `n \approx 500`).

> 7. `plot_comparison` should also accept a `ring`; it should be documented and treated to be a `RealIntervalField`.

Done.

Back to `needs_review`.
----
New commits:


---

Comment by behackl created at 2016-01-26 19:44:37

Changing status from needs_work to needs_review.


---

Comment by dkrenn created at 2016-01-27 09:29:16

I've added a couple of small commits during review. Please check.

Two comments:

- I find the naming of a variable `e` confusing...maybe using `expansion` would be better?

- In the plot the hard-coded `0.025` should be adjustable by a parameter.
----
New commits:


---

Comment by cheuberg created at 2016-01-27 09:51:31

I reviewed your changes and added a couple of commits. Please cross-review.

Replying to [comment:14 dkrenn]:
> Two comments:
> 
> - I find the naming of a variable `e` confusing...maybe using `expansion` would be better?

Done.

> - In the plot the hard-coded `0.025` should be adjustable by a parameter.

Done.
----
Last 10 new commits:


---

Comment by dkrenn created at 2016-01-27 10:06:48

Replying to [comment:16 cheuberg]:
> I reviewed your changes and added a couple of commits. Please cross-review.

Look good.

> Replying to [comment:14 dkrenn]:
> > Two comments:
> > 
> > - I find the naming of a variable `e` confusing...maybe using `expansion` would be better?
> 
> Done.
> 
> > - In the plot the hard-coded `0.025` should be adjustable by a parameter.
> 
> Done.

Reviewed and good.


---

Comment by dkrenn created at 2016-01-27 10:06:48

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-01-28 20:09:05

Resolution: fixed
