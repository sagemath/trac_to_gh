# Issue 27917: SciPy: patch for missing coding lines in some source files

Issue created by migration from https://trac.sagemath.org/ticket/28154

Original creator: embray

Original creation time: 2019-07-10 10:16:23

Keywords: scipy

As originally reported at https://github.com/scipy/scipy/issues/9606 there are a few .py modules in scipy that contain unicode characters in docstrings without supplying a required "coding" line, resulting in a `SyntaxError` when you try to compile them.

Normally this is not a problem, because when you build scipy with its `setup.py` it just compiles all `.pyc` while assuming utf-8 encoding for the source files.  If you already have the `.pyc` file, then, nothing goes wrong because the `SyntaxError` only arises when the Python compiler tries to read the original source file at runtime.

But if for some reason your files' mtimes get messed up (as apparently happened to me at some point; not sure how) and the .pyc has to be regenerated then you'll get a `SyntaxError` at import time for these modules.

For now it should suffice to include the following patch:

https://github.com/scipy/scipy/commit/4a8a35f2c27be9f209cfc6f347e7a57a4a62e693.patch


---

Comment by embray created at 2019-07-10 10:18:12

Changing status from new to needs_review.


---

Comment by embray created at 2019-07-10 10:18:12

New commits:


---

Comment by vklein created at 2019-07-12 11:55:45

I guess a package version update is missing : `1.2.0 => 1.2.0.p0`.


---

Comment by vklein created at 2019-07-12 12:13:55

Apart from that the patch is working and fixes the problem.


---

Comment by embray created at 2019-08-29 14:11:21

This patch is really only relevant if you're installing scipy from scratch in the first place.  If it's already built this affects nothing at runtime so it's not necessary to increase the patch level and force needless reinstalls of scipy.


---

Comment by vklein created at 2019-08-29 14:16:27

Changing status from needs_review to positive_review.


---

Comment by vklein created at 2019-08-29 14:16:27

Ok then.


---

Comment by vbraun created at 2019-09-02 21:40:52

Resolution: fixed
