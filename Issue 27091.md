# Issue 27091: caching of Groebner basis not always done

Issue created by migration from https://trac.sagemath.org/ticket/27328

Original creator: dkrenn

Original creation time: 2019-02-20 15:59:52


```
            sage: R.<a,b> = QQ[]
            sage: I = R.ideal([a^2-a, b^2-b, a+b])
            sage: GB1 = I.groebner_basis(algorithm='libsingular:slimgb')
            sage: GB2 = I.groebner_basis()
            sage: GB1 is GB2
```

returns `False`, the Gröbner basis is recomputed. This is problematic, as a lot of methods (e.g. `.variety`) simply call `.groebner_basis()` and a precomputed Gröbner basis (maybe with a different algorithm than the default) is not used.


---

Comment by dkrenn created at 2019-02-20 16:03:10

New commits:


---

Comment by dkrenn created at 2019-02-20 16:03:10

Changing status from new to needs_review.


---

Comment by dkrenn created at 2019-02-20 16:07:39

The proposed solution is now that if there is no algorithm given but something is cached, then this is taken.


---

Comment by nbruin created at 2019-02-20 16:23:39

The building of the cache is still reliant on `cached_method`. For instance, that means that if `I.groebner_basis()` is called and then `I.groebner_basis(algorithm=<whatever the default is>)`, then the algorithm gets executed twice.


---

Comment by dkrenn created at 2019-02-20 16:34:39

Replying to [comment:4 nbruin]:
> The building of the cache is still reliant on `cached_method`. For instance, that means that if `I.groebner_basis()` is called and then `I.groebner_basis(algorithm=<whatever the default is>)`, then the algorithm gets executed twice.

Yes, this is indeed true. The problem is that `I.groebner_basis()` does not simply translate to `I.groebner_basis(algorithm=<somealgorithmname>)` at the beginning, but tries a couple of things which might lead to a result. Any ideas how this can be taken care of?


---

Comment by tscrim created at 2019-02-20 21:21:00

Replying to [comment:5 dkrenn]:
> Replying to [comment:4 nbruin]:
> > The building of the cache is still reliant on `cached_method`. For instance, that means that if `I.groebner_basis()` is called and then `I.groebner_basis(algorithm=<whatever the default is>)`, then the algorithm gets executed twice.
> 
> Yes, this is indeed true. The problem is that `I.groebner_basis()` does not simply translate to `I.groebner_basis(algorithm=<somealgorithmname>)` at the beginning, but tries a couple of things which might lead to a result. Any ideas how this can be taken care of?

The generic way around that is to instead have the default call `self.groebner_basis(algorithm=<algorithmname>)` with the chosen algorithm. The other thing you could do, and which might be better, is to explicitly set the cache in those cases.


---

Comment by embray created at 2019-03-25 10:56:15

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)


---

Comment by dkrenn created at 2019-03-28 09:15:17

Replying to [comment:6 tscrim]:
> > [...] The problem is that `I.groebner_basis()` does not simply translate to `I.groebner_basis(algorithm=<somealgorithmname>)` at the beginning, but tries a couple of things which might lead to a result. Any ideas how this can be taken care of?
> 
> The generic way around that is to instead have the default call `self.groebner_basis(algorithm=<algorithmname>)` with the chosen algorithm.

This is not what we want: We do want that `algorithm=''` tries a couple of things until it succeeds (or fails after all).

> The other thing you could do, and which might be better, is to explicitly set the cache in those cases.

You mean setting the cache for `algorithm=''` to be the same as for `algorithm='chosen'`. This could work ;)


---

Comment by git created at 2019-03-28 10:50:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2019-03-28 10:51:38

Replying to [comment:8 dkrenn]:
> You mean setting the cache for `algorithm=''` to be the same as for `algorithm='chosen'`. This could work ;)

Works indeed; see current implementation.


---

Comment by dkrenn created at 2019-03-28 10:52:00

Replying to [comment:4 nbruin]:
> The building of the cache is still reliant on `cached_method`. For instance, that means that if `I.groebner_basis()` is called and then `I.groebner_basis(algorithm=<whatever the default is>)`, then the algorithm gets executed twice.

This is now fixed as well.


---

Comment by dkrenn created at 2019-03-28 10:53:53

I've changed the code so that all issues are solved.

Moreover, I've simplifed the way arguments are processed and handled, and cleaned up of what seems to be historically grown (and sometimes not even used or incompatible or even ignored).

Please review :)


---

Comment by git created at 2019-04-01 08:06:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2019-04-01 08:06:45

Forgot push; now updated :)


---

Comment by embray created at 2019-07-03 11:37:56

Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by kedlaya created at 2020-09-07 18:41:24

It's been long enough that I'm getting a merge failure. Rebase?


---

Comment by kedlaya created at 2020-09-07 18:41:24

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.
