# Issue 17976: A lot of polytopes constructor are broken

archive/issues_017976.json:
```json
{
    "body": "CC:  @nathanncohen\n\nA lot of polytopes constructors in `sage.geometry.polyhedron.library`.\n\n1. The Rhombicuboctahedron does not return what it should (as Python division was thought as Sage integer divisions). There is in the code\n\n```\nverts = [ [-3/2, -1/2, -1/2], [-3/2, -1/2, 1/2], [-3/2, 1/2, -1/2],\n...\n```\n\n\n2. The `great_rhombicuboctahedron` is defined over `QQ` but it should be defined over `QQ[sqrt(2)]`!! There are in two places rough approximation of sqrt(2) in the code\n\n```\nv1 = QQ(131739771357/54568400000)   # ~ sqrt(2) + 1\nv2 = QQ(104455571357/27284200000)   # ~ 2 sqrt(2)\n```\n\n  Now that Sage supports Polyhedron over number fields, we should use them!\n\nIssue created by migration from https://trac.sagemath.org/ticket/18213\n\n",
    "created_at": "2015-04-15T21:42:33Z",
    "labels": [
        "geometry",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "A lot of polytopes constructor are broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17976",
    "user": "@videlec"
}
```
CC:  @nathanncohen

A lot of polytopes constructors in `sage.geometry.polyhedron.library`.

1. The Rhombicuboctahedron does not return what it should (as Python division was thought as Sage integer divisions). There is in the code

```
verts = [ [-3/2, -1/2, -1/2], [-3/2, -1/2, 1/2], [-3/2, 1/2, -1/2],
...
```


2. The `great_rhombicuboctahedron` is defined over `QQ` but it should be defined over `QQ[sqrt(2)]`!! There are in two places rough approximation of sqrt(2) in the code

```
v1 = QQ(131739771357/54568400000)   # ~ sqrt(2) + 1
v2 = QQ(104455571357/27284200000)   # ~ 2 sqrt(2)
```

  Now that Sage supports Polyhedron over number fields, we should use them!

Issue created by migration from https://trac.sagemath.org/ticket/18213





---

archive/issue_comments_241615.json:
```json
{
    "body": "I have a big commit to push in few minutes...",
    "created_at": "2015-04-16T09:13:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241615",
    "user": "@videlec"
}
```

I have a big commit to push in few minutes...



---

archive/issue_comments_241616.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-04-16T14:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241616",
    "user": "@videlec"
}
```

New commits:



---

archive/issue_comments_241617.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-16T14:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241617",
    "user": "@videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_241618.json:
```json
{
    "body": "Depends on #18211?",
    "created_at": "2015-04-16T14:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241618",
    "user": "@nathanncohen"
}
```

Depends on #18211?



---

archive/issue_comments_241619.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n> Depends on #18211?\n\nYes\n----\nNew commits:",
    "created_at": "2015-04-16T14:35:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241619",
    "user": "@videlec"
}
```

Replying to [comment:5 ncohen]:
> Depends on #18211?

Yes
----
New commits:



---

archive/issue_comments_241620.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-16T15:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241620",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_241621.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-16T17:15:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241621",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_241622.json:
```json
{
    "body": "The `golden_ratio()` can obviously be defined in terms of `sqrt(5)`, so I don't see the need for that. I'm also really wondering whether you need the custom `sqrt()` function, doesn't `QuadraticField(n)` work?",
    "created_at": "2015-04-16T20:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241622",
    "user": "@jdemeyer"
}
```

The `golden_ratio()` can obviously be defined in terms of `sqrt(5)`, so I don't see the need for that. I'm also really wondering whether you need the custom `sqrt()` function, doesn't `QuadraticField(n)` work?



---

archive/issue_comments_241623.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-16T22:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241623",
    "user": "@videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_241624.json:
```json
{
    "body": "Replying to [comment:11 jdemeyer]:\n> The `golden_ratio()` can obviously be defined in terms of `sqrt(5)`, so I don't see the need for that. I'm also really wondering whether you need the custom `sqrt()` function, doesn't `QuadraticField(n)` work?\n\nRight. The problem of embedding should be done elsewhere (my version embedds in `QQbar` whereas the generic `QuadraticField(n)` embedds into `RLF`).",
    "created_at": "2015-04-16T22:13:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241624",
    "user": "@videlec"
}
```

Replying to [comment:11 jdemeyer]:
> The `golden_ratio()` can obviously be defined in terms of `sqrt(5)`, so I don't see the need for that. I'm also really wondering whether you need the custom `sqrt()` function, doesn't `QuadraticField(n)` work?

Right. The problem of embedding should be done elsewhere (my version embedds in `QQbar` whereas the generic `QuadraticField(n)` embedds into `RLF`).



---

archive/issue_comments_241625.json:
```json
{
    "body": "Replying to [comment:12 vdelecroix]:\n> Replying to [comment:11 jdemeyer]:\n> > The `golden_ratio()` can obviously be defined in terms of `sqrt(5)`, so I don't see the need for that. I'm also really wondering whether you need the custom `sqrt()` function, doesn't `QuadraticField(n)` work?\n> \n> Right. The problem of embedding should be done elsewhere (my version embedds in `QQbar` whereas the generic `QuadraticField(n)` embedds into `RLF`).\n\nHere is one reason. The generator name of `QuadraticField(2)` is `a` and it better be `sqrt2` in this case. For the golden ratio, the advantage is that its get printed as `phi`. In particular you have\n\n```\nsage: polytopes.icosahedron().volume()\n5/6*phi + 5/6\n```\n\nThe answer `5/6*a + 5/6` would have been terrible here. I have nothing against using `phi = (sqrt5+1)/2`. So I will at least remove this one. For the quadratic fields, one option is to globally make this change in another ticket. What do you think?",
    "created_at": "2015-04-16T22:40:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241625",
    "user": "@videlec"
}
```

Replying to [comment:12 vdelecroix]:
> Replying to [comment:11 jdemeyer]:
> > The `golden_ratio()` can obviously be defined in terms of `sqrt(5)`, so I don't see the need for that. I'm also really wondering whether you need the custom `sqrt()` function, doesn't `QuadraticField(n)` work?
> 
> Right. The problem of embedding should be done elsewhere (my version embedds in `QQbar` whereas the generic `QuadraticField(n)` embedds into `RLF`).

Here is one reason. The generator name of `QuadraticField(2)` is `a` and it better be `sqrt2` in this case. For the golden ratio, the advantage is that its get printed as `phi`. In particular you have

```
sage: polytopes.icosahedron().volume()
5/6*phi + 5/6
```

The answer `5/6*a + 5/6` would have been terrible here. I have nothing against using `phi = (sqrt5+1)/2`. So I will at least remove this one. For the quadratic fields, one option is to globally make this change in another ticket. What do you think?



---

archive/issue_comments_241626.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T07:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241626",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_241627.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-17T07:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241627",
    "user": "@videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_241628.json:
```json
{
    "body": "All right. I removed the `sqrt` and `golden_ratio` function. Needs review!\n\nVincent",
    "created_at": "2015-04-17T07:15:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241628",
    "user": "@videlec"
}
```

All right. I removed the `sqrt` and `golden_ratio` function. Needs review!

Vincent



---

archive/issue_comments_241629.json:
```json
{
    "body": "Vincent: the diff of your main commit is very, very very hard to read. Could you split in order to make it easier to understand?",
    "created_at": "2015-04-17T07:20:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241629",
    "user": "@nathanncohen"
}
```

Vincent: the diff of your main commit is very, very very hard to read. Could you split in order to make it easier to understand?



---

archive/issue_comments_241630.json:
```json
{
    "body": "Replying to [comment:16 ncohen]:\n> Vincent: the diff of your main commit is very, very very hard to read. Could you split in order to make it easier to understand?\n\nNot sure. It is basically a complete rewrite. I added a ton of documentation, and modify many functions to fit with the actual definition!",
    "created_at": "2015-04-17T07:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241630",
    "user": "@videlec"
}
```

Replying to [comment:16 ncohen]:
> Vincent: the diff of your main commit is very, very very hard to read. Could you split in order to make it easier to understand?

Not sure. It is basically a complete rewrite. I added a ton of documentation, and modify many functions to fit with the actual definition!



---

archive/issue_comments_241631.json:
```json
{
    "body": "Okay. Then could you at least change the description of this ticket to explain all changes that you made? (you apparently reated new functions, for example.. Why?)",
    "created_at": "2015-04-17T07:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241631",
    "user": "@nathanncohen"
}
```

Okay. Then could you at least change the description of this ticket to explain all changes that you made? (you apparently reated new functions, for example.. Why?)



---

archive/issue_comments_241632.json:
```json
{
    "body": "Replying to [comment:18 ncohen]:\n> Okay. Then could you at least change the description of this ticket to explain all changes that you made? (you apparently reated new functions, for example.. Why?)\n\ndone in the ticket description.",
    "created_at": "2015-04-17T07:34:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241632",
    "user": "@videlec"
}
```

Replying to [comment:18 ncohen]:
> Okay. Then could you at least change the description of this ticket to explain all changes that you made? (you apparently reated new functions, for example.. Why?)

done in the ticket description.



---

archive/issue_comments_241633.json:
```json
{
    "body": "About `golden_ratio` and `sqrt`: shouldn't they be in `number_field_element_quadratic` instead ?\n\nAbout `zero_sum_projection` what about having it in `matrix.<tab>` ?\n\nNathann",
    "created_at": "2015-04-17T08:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241633",
    "user": "@nathanncohen"
}
```

About `golden_ratio` and `sqrt`: shouldn't they be in `number_field_element_quadratic` instead ?

About `zero_sum_projection` what about having it in `matrix.<tab>` ?

Nathann



---

archive/issue_comments_241634.json:
```json
{
    "body": "Replying to [comment:20 ncohen]:\n> About `golden_ratio` and `sqrt`: shouldn't they be in `number_field_element_quadratic` instead ?\n\nRemoved in \u200bc1804d5.\n\n> About `zero_sum_projection` what about having it in `matrix.<tab>` ?\n\nIt is very specific. I am not sure how I would call it in `matrix.<tab>`.",
    "created_at": "2015-04-17T11:39:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241634",
    "user": "@videlec"
}
```

Replying to [comment:20 ncohen]:
> About `golden_ratio` and `sqrt`: shouldn't they be in `number_field_element_quadratic` instead ?

Removed in ​c1804d5.

> About `zero_sum_projection` what about having it in `matrix.<tab>` ?

It is very specific. I am not sure how I would call it in `matrix.<tab>`.



---

archive/issue_comments_241635.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2015-04-17T11:57:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241635",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_241636.json:
```json
{
    "body": "`O_o`",
    "created_at": "2015-04-17T11:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241636",
    "user": "@nathanncohen"
}
```

`O_o`



---

archive/issue_comments_241637.json:
```json
{
    "body": "Cleaner version based on sage-6.7.beta1 and the complete #18211.",
    "created_at": "2015-04-17T11:59:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241637",
    "user": "@videlec"
}
```

Cleaner version based on sage-6.7.beta1 and the complete #18211.



---

archive/issue_comments_241638.json:
```json
{
    "body": "Here are some comments. Please understand that doing everything at once makes things *MUCH* harder to understand for the reviewer.\n\nImproving the implementation and improving the doc could have been two separate commits. The work that you do on each function could have been a separate commit. Removing deprecations could have been a separate commit. There are also things that anybody can review (only code) and things for which you need to be used to the tools you deal with.\n\n- The projection is not the orthogona projection I expected:\n  {{{\n  sage: sage: zero_sum_projection(3)*vector([1,0,0])\n  (0.7071067811865475, 0.4082482904638631)\n  }}}\n  You can either change the matrix or emphasize in the docstring that the\n  projection is not unique. Something like \"returns a (d-1)xd matrix of rank d\n  whose kernel contain (1,...,1). At first sight, I expected the function to\n  return a matrix of dimensions `d\\times d`. I updated the docstring on this\n  matter.\n\n- I do not understand the paragraph in the doc of `project_points` but that's\n  probably because I don't know the maths behind.\n\n- Compatible?\n  {{{\n  This projection is the only one compatible with the restriction to the\n  first coordinates\n  }}}\n\n- You should probably add a `# tol`\n  after this\n  {{{\n  Its volume is `\\sqrt{d+1} / d!`\n  }}}\n  Or even better, check that the difference between the two is 0\n  (still, with some tolerance)\n\n- At this point I still do not know if it is very wise to use this definition of\n  the projection, but it would be cool if every function which uses this\n  projection (like !Simplex) could redirect toward the matrix function. This way\n  people would have a chance to learn what exactly they get as a result.\n\n- What about this error?\n\n  {{{\n  sage: polytopes.icosahedron(base_ring=QQ)\n  ...\n  TypeError: unable to convert 1/4*sqrt(5) + 1/4 to a rational\n  }}}\n\nI added a small commit at public/18213\n\nNathann",
    "created_at": "2015-04-17T14:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241638",
    "user": "@nathanncohen"
}
```

Here are some comments. Please understand that doing everything at once makes things *MUCH* harder to understand for the reviewer.

Improving the implementation and improving the doc could have been two separate commits. The work that you do on each function could have been a separate commit. Removing deprecations could have been a separate commit. There are also things that anybody can review (only code) and things for which you need to be used to the tools you deal with.

- The projection is not the orthogona projection I expected:
  {{{
  sage: sage: zero_sum_projection(3)*vector([1,0,0])
  (0.7071067811865475, 0.4082482904638631)
  }}}
  You can either change the matrix or emphasize in the docstring that the
  projection is not unique. Something like "returns a (d-1)xd matrix of rank d
  whose kernel contain (1,...,1). At first sight, I expected the function to
  return a matrix of dimensions `d\times d`. I updated the docstring on this
  matter.

- I do not understand the paragraph in the doc of `project_points` but that's
  probably because I don't know the maths behind.

- Compatible?
  {{{
  This projection is the only one compatible with the restriction to the
  first coordinates
  }}}

- You should probably add a `# tol`
  after this
  {{{
  Its volume is `\sqrt{d+1} / d!`
  }}}
  Or even better, check that the difference between the two is 0
  (still, with some tolerance)

- At this point I still do not know if it is very wise to use this definition of
  the projection, but it would be cool if every function which uses this
  projection (like !Simplex) could redirect toward the matrix function. This way
  people would have a chance to learn what exactly they get as a result.

- What about this error?

  {{{
  sage: polytopes.icosahedron(base_ring=QQ)
  ...
  TypeError: unable to convert 1/4*sqrt(5) + 1/4 to a rational
  }}}

I added a small commit at public/18213

Nathann



---

archive/issue_comments_241639.json:
```json
{
    "body": "Replying to [comment:25 ncohen]:\n> Here are some comments. Please understand that doing everything at once makes things *MUCH* harder to understand for the reviewer.\n\nI am very sorry.\n \n> - The projection is not the orthogona projection I expected:\n\nWhich one did you expected? I improved the documentation.\n\n> - At this point I still do not know if it is very wise to use this definition of\n>   the projection, but it would be cool if every function which uses this\n>   projection (like !Simplex) could redirect toward the matrix function. This way\n>   people would have a chance to learn what exactly they get as a result.\n\nI see. But I am really not confortable in moving this to `matrix.<tab>` as well. One possibility is to move it back to `polytopes.<tab>`. What do you think?\n\n> - What about this error?\n> \n>   {{{\n>   sage: polytopes.icosahedron(base_ring=QQ)\n>   ...\n>   TypeError: unable to convert 1/4*sqrt(5) + 1/4 to a rational\n>   }}}\n\nIs it not clear enough? The coordinates of the icosahedron need to be defined in `QQ[sqrt(5)]`, hence the error. The following is ok (but very slow, ~3secs on my computer)\n\n```\nsage: I = polytopes.icosahedron(base_ring=AA)\n```\n\nApart adding your example to the documentation, I do not see much what I can do (see the last commit). A deprecation?\n\nVincent",
    "created_at": "2015-04-17T15:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241639",
    "user": "@videlec"
}
```

Replying to [comment:25 ncohen]:
> Here are some comments. Please understand that doing everything at once makes things *MUCH* harder to understand for the reviewer.

I am very sorry.
 
> - The projection is not the orthogona projection I expected:

Which one did you expected? I improved the documentation.

> - At this point I still do not know if it is very wise to use this definition of
>   the projection, but it would be cool if every function which uses this
>   projection (like !Simplex) could redirect toward the matrix function. This way
>   people would have a chance to learn what exactly they get as a result.

I see. But I am really not confortable in moving this to `matrix.<tab>` as well. One possibility is to move it back to `polytopes.<tab>`. What do you think?

> - What about this error?
> 
>   {{{
>   sage: polytopes.icosahedron(base_ring=QQ)
>   ...
>   TypeError: unable to convert 1/4*sqrt(5) + 1/4 to a rational
>   }}}

Is it not clear enough? The coordinates of the icosahedron need to be defined in `QQ[sqrt(5)]`, hence the error. The following is ok (but very slow, ~3secs on my computer)

```
sage: I = polytopes.icosahedron(base_ring=AA)
```

Apart adding your example to the documentation, I do not see much what I can do (see the last commit). A deprecation?

Vincent



---

archive/issue_comments_241640.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T15:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241640",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_241641.json:
```json
{
    "body": "Hello,\n\n> Which one did you expected? I improved the documentation.\n\nWell, I expected an orthogonal projection on this hyperplane. And I probably expected the base of the hyperplane to be the projection of d-1 vectors of the base from the original space I guess.\n\n> > - At this point I still do not know if it is very wise to use this definition of\n> >   the projection, but it would be cool if every function which uses this\n> >   projection (like !Simplex) could redirect toward the matrix function. This way\n> >   people would have a chance to learn what exactly they get as a result.\n> \n> I see. But I am really not confortable in moving this to `matrix.<tab>` as well. One possibility is to move it back to `polytopes.<tab>`. What do you think?\n\nAll I was suggesting in the message above was to add a link in the doc. The message you added in `project_points` is perfect\n\n```\nThe projection used is the matrix given by :func:`zero_sum_projection`.\n```\n\n\nTo me it should appear whenever there is a 'project' argument in the function.\n\n> Is it not clear enough? The coordinates of the icosahedron need to be defined in `QQ[sqrt(5)]`, hence the error.\n\nPrecisely: Could you add somewhere in the doc that the field must contain `QQ(sqrt(5))`?\n\nNathann",
    "created_at": "2015-04-17T21:08:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241641",
    "user": "@nathanncohen"
}
```

Hello,

> Which one did you expected? I improved the documentation.

Well, I expected an orthogonal projection on this hyperplane. And I probably expected the base of the hyperplane to be the projection of d-1 vectors of the base from the original space I guess.

> > - At this point I still do not know if it is very wise to use this definition of
> >   the projection, but it would be cool if every function which uses this
> >   projection (like !Simplex) could redirect toward the matrix function. This way
> >   people would have a chance to learn what exactly they get as a result.
> 
> I see. But I am really not confortable in moving this to `matrix.<tab>` as well. One possibility is to move it back to `polytopes.<tab>`. What do you think?

All I was suggesting in the message above was to add a link in the doc. The message you added in `project_points` is perfect

```
The projection used is the matrix given by :func:`zero_sum_projection`.
```


To me it should appear whenever there is a 'project' argument in the function.

> Is it not clear enough? The coordinates of the icosahedron need to be defined in `QQ[sqrt(5)]`, hence the error.

Precisely: Could you add somewhere in the doc that the field must contain `QQ(sqrt(5))`?

Nathann



---

archive/issue_comments_241642.json:
```json
{
    "body": "the function dodecahedron does nothing with its `base_ring` argument. Also, why should the projection function return 'None' instead of '[]' when it is called with no argument?\n\nNathann",
    "created_at": "2015-04-17T21:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241642",
    "user": "@nathanncohen"
}
```

the function dodecahedron does nothing with its `base_ring` argument. Also, why should the projection function return 'None' instead of '[]' when it is called with no argument?

Nathann



---

archive/issue_comments_241643.json:
```json
{
    "body": "Replying to [comment:29 ncohen]:\n> the function dodecahedron does nothing with its `base_ring` argument. Also, why should the projection function return 'None' instead of '[]' when it is called with no argument?\n\nYou corrected it in 7eb2326",
    "created_at": "2015-04-17T21:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241643",
    "user": "@videlec"
}
```

Replying to [comment:29 ncohen]:
> the function dodecahedron does nothing with its `base_ring` argument. Also, why should the projection function return 'None' instead of '[]' when it is called with no argument?

You corrected it in 7eb2326



---

archive/issue_comments_241644.json:
```json
{
    "body": "Replying to [comment:28 ncohen]:\n> Hello,\n> \n> > Which one did you expected? I improved the documentation.\n> \n> Well, I expected an orthogonal projection on this hyperplane. And I probably expected the base of the hyperplane to be the projection of d-1 vectors of the base from the original space I guess.\n\nThe description is explicit in the doc (commit \u200bfac3cff)\n\n> > > - At this point I still do not know if it is very wise to use this definition of\n> > >   the projection, but it would be cool if every function which uses this\n> > >   projection (like !Simplex) could redirect toward the matrix function. This way\n> > >   people would have a chance to learn what exactly they get as a result.\n> > \n> > I see. But I am really not confortable in moving this to `matrix.<tab>` as well. One possibility is to move it back to `polytopes.<tab>`. What do you think?\n> \n> All I was suggesting in the message above was to add a link in the doc. The message you added in `project_points` is perfect\n> {{{\n> The projection used is the matrix given by :func:`zero_sum_projection`.\n> }}}\n> \n> To me it should appear whenever there is a 'project' argument in the function.\n\nWill do!\n\n> > Is it not clear enough? The coordinates of the icosahedron need to be defined in `QQ[sqrt(5)]`, hence the error.\n> \n> Precisely: Could you add somewhere in the doc that the field must contain `QQ(sqrt(5))`?\n\nThere is one example at the end of the doc (from fac3cff)",
    "created_at": "2015-04-17T21:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241644",
    "user": "@videlec"
}
```

Replying to [comment:28 ncohen]:
> Hello,
> 
> > Which one did you expected? I improved the documentation.
> 
> Well, I expected an orthogonal projection on this hyperplane. And I probably expected the base of the hyperplane to be the projection of d-1 vectors of the base from the original space I guess.

The description is explicit in the doc (commit ​fac3cff)

> > > - At this point I still do not know if it is very wise to use this definition of
> > >   the projection, but it would be cool if every function which uses this
> > >   projection (like !Simplex) could redirect toward the matrix function. This way
> > >   people would have a chance to learn what exactly they get as a result.
> > 
> > I see. But I am really not confortable in moving this to `matrix.<tab>` as well. One possibility is to move it back to `polytopes.<tab>`. What do you think?
> 
> All I was suggesting in the message above was to add a link in the doc. The message you added in `project_points` is perfect
> {{{
> The projection used is the matrix given by :func:`zero_sum_projection`.
> }}}
> 
> To me it should appear whenever there is a 'project' argument in the function.

Will do!

> > Is it not clear enough? The coordinates of the icosahedron need to be defined in `QQ[sqrt(5)]`, hence the error.
> 
> Precisely: Could you add somewhere in the doc that the field must contain `QQ(sqrt(5))`?

There is one example at the end of the doc (from fac3cff)



---

archive/issue_comments_241645.json:
```json
{
    "body": "> You corrected it in 7eb2326\n\nArggggg... I was looking at the original commit again. I was wondering why it has been removed `>_<`\n\n> The description is explicit in the doc (commit \u200bfac3cff)\n\nYes yes now it's good!\n\n> There is one example at the end of the doc (from fac3cff)\n\nIt happens several times though. Could you add it in the doc of `base_ring`? You already talk about this field there. It could be something like \"If set to None then it will be `QQ[\\phi]`, otherwise it must be a field that contains it\".\n\nNathann",
    "created_at": "2015-04-17T21:34:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241645",
    "user": "@nathanncohen"
}
```

> You corrected it in 7eb2326

Arggggg... I was looking at the original commit again. I was wondering why it has been removed `>_<`

> The description is explicit in the doc (commit ​fac3cff)

Yes yes now it's good!

> There is one example at the end of the doc (from fac3cff)

It happens several times though. Could you add it in the doc of `base_ring`? You already talk about this field there. It could be something like "If set to None then it will be `QQ[\phi]`, otherwise it must be a field that contains it".

Nathann



---

archive/issue_comments_241646.json:
```json
{
    "body": "The 600-cell code would look a bit better if you were building all points at once instead of interrupting the flow to decide which ring you should work with.",
    "created_at": "2015-04-17T21:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241646",
    "user": "@nathanncohen"
}
```

The 600-cell code would look a bit better if you were building all points at once instead of interrupting the flow to decide which ring you should work with.



---

archive/issue_comments_241647.json:
```json
{
    "body": "Funny. There is no `automorphism_group` function for polytopes `O_o`",
    "created_at": "2015-04-17T21:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241647",
    "user": "@nathanncohen"
}
```

Funny. There is no `automorphism_group` function for polytopes `O_o`



---

archive/issue_comments_241648.json:
```json
{
    "body": "\n```                                                                                                                                                                         \n        OUTPUT: \n\n        EXAMPLES::\n```\n",
    "created_at": "2015-04-17T21:46:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241648",
    "user": "@nathanncohen"
}
```


```                                                                                                                                                                         
        OUTPUT: 

        EXAMPLES::
```




---

archive/issue_comments_241649.json:
```json
{
    "body": "Replying to [comment:34 ncohen]:\n> Funny. There is no `automorphism_group` function for polytopes `O_o`\n\nYes! This is very sad... But you have to be careful about what it means. There is the combinatorial automorphism group and the isometry group. I have no idea how to implement the latter efficiently.",
    "created_at": "2015-04-17T21:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241649",
    "user": "@videlec"
}
```

Replying to [comment:34 ncohen]:
> Funny. There is no `automorphism_group` function for polytopes `O_o`

Yes! This is very sad... But you have to be careful about what it means. There is the combinatorial automorphism group and the isometry group. I have no idea how to implement the latter efficiently.



---

archive/issue_comments_241650.json:
```json
{
    "body": "Most probably the ugliest thing I ever saw\n\n```\nsage: Sequence([Graph()]).universe()\n<class 'sage.graphs.graph.Graph'>\nsage: Sequence([Graph(),1]).universe()\nCategory of objects\nsage: Sequence([1]).universe()\nInteger Ring\n```\n",
    "created_at": "2015-04-17T21:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241650",
    "user": "@nathanncohen"
}
```

Most probably the ugliest thing I ever saw

```
sage: Sequence([Graph()]).universe()
<class 'sage.graphs.graph.Graph'>
sage: Sequence([Graph(),1]).universe()
Category of objects
sage: Sequence([1]).universe()
Integer Ring
```




---

archive/issue_comments_241651.json:
```json
{
    "body": "HMmmmmmmm... I don't exactly know what the isometry group is, but let's try anyway: what about defining a complete graph on your points, in which each edge has a color associated to its length. Wouldn't the automorphism group of that be what you want?",
    "created_at": "2015-04-17T21:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241651",
    "user": "@nathanncohen"
}
```

HMmmmmmmm... I don't exactly know what the isometry group is, but let's try anyway: what about defining a complete graph on your points, in which each edge has a color associated to its length. Wouldn't the automorphism group of that be what you want?



---

archive/issue_comments_241652.json:
```json
{
    "body": "Okayyyyyyyyyyyyyy. End of the review. Nothing else to add `;-)`\n\nVery good job. This code needed to be cleaned, and it is much better now.\n\nBut please, next time: smaller patches. You waste your reviewers' health `:-P`\n\nNathann",
    "created_at": "2015-04-17T21:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241652",
    "user": "@nathanncohen"
}
```

Okayyyyyyyyyyyyyy. End of the review. Nothing else to add `;-)`

Very good job. This code needed to be cleaned, and it is much better now.

But please, next time: smaller patches. You waste your reviewers' health `:-P`

Nathann



---

archive/issue_comments_241653.json:
```json
{
    "body": "Replying to [comment:38 ncohen]:\n> HMmmmmmmm... I don't exactly know what the isometry group is, but let's try anyway: what about defining a complete graph on your points, in which each edge has a color associated to its length. Wouldn't the automorphism group of that be what you want?\n\nThat is a valid definition. But the standard one is the set of orthogonal matrices that preserve the polyhedron. And it would be nice for `isometry_group` to be a finite matrix group (and not permutations)!",
    "created_at": "2015-04-17T21:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241653",
    "user": "@videlec"
}
```

Replying to [comment:38 ncohen]:
> HMmmmmmmm... I don't exactly know what the isometry group is, but let's try anyway: what about defining a complete graph on your points, in which each edge has a color associated to its length. Wouldn't the automorphism group of that be what you want?

That is a valid definition. But the standard one is the set of orthogonal matrices that preserve the polyhedron. And it would be nice for `isometry_group` to be a finite matrix group (and not permutations)!



---

archive/issue_comments_241654.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T22:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241654",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_241655.json:
```json
{
    "body": "Patchbot should be happy after that.",
    "created_at": "2015-04-17T22:21:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241655",
    "user": "@videlec"
}
```

Patchbot should be happy after that.



---

archive/issue_comments_241656.json:
```json
{
    "body": "Some broken doctests in the patchbot's report. Also, can you be sure that the `sqrt(6.) / factorial(5)` are not subject to numerical noise? There is no `#tol` on them right now.\n\nNathann",
    "created_at": "2015-04-18T06:50:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241656",
    "user": "@nathanncohen"
}
```

Some broken doctests in the patchbot's report. Also, can you be sure that the `sqrt(6.) / factorial(5)` are not subject to numerical noise? There is no `#tol` on them right now.

Nathann



---

archive/issue_comments_241657.json:
```json
{
    "body": "Hmmmmmm.. I can't seem to find on google an implementation of an isometry group function anywhere `O_o`",
    "created_at": "2015-04-18T07:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241657",
    "user": "@nathanncohen"
}
```

Hmmmmmm.. I can't seem to find on google an implementation of an isometry group function anywhere `O_o`



---

archive/issue_comments_241658.json:
```json
{
    "body": "Hi Vincent and Nathann\n\nJust a quick comment, as I'm not sure how useful this will be for general polyhedra: There is a method for lattice polytopes:\n`LatticePolytope_PPL` (in `sage.geometry.polyhedron.ppl_lattice_polytope`) has a method `lattice_automorphism_group()`\n\nCheers,\nJan",
    "created_at": "2015-04-18T08:41:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241658",
    "user": "jkeitel"
}
```

Hi Vincent and Nathann

Just a quick comment, as I'm not sure how useful this will be for general polyhedra: There is a method for lattice polytopes:
`LatticePolytope_PPL` (in `sage.geometry.polyhedron.ppl_lattice_polytope`) has a method `lattice_automorphism_group()`

Cheers,
Jan



---

archive/issue_comments_241659.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-18T09:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241659",
    "user": "@nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_241660.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-18T09:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241660",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_241661.json:
```json
{
    "body": "Replying to [comment:43 ncohen]:\n> Some broken doctests in the patchbot's report. Also, can you be sure that the `sqrt(6.) / factorial(5)` are not subject to numerical noise? There is no `#tol` on them right now.\n\nI don't know... Patchbot did not complain about this.",
    "created_at": "2015-04-18T09:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241661",
    "user": "@videlec"
}
```

Replying to [comment:43 ncohen]:
> Some broken doctests in the patchbot's report. Also, can you be sure that the `sqrt(6.) / factorial(5)` are not subject to numerical noise? There is no `#tol` on them right now.

I don't know... Patchbot did not complain about this.



---

archive/issue_comments_241662.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-18T09:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241662",
    "user": "@videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_241663.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-18T10:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241663",
    "user": "@nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_241664.json:
```json
{
    "body": "Okayyyyyyy. Then `positive_review`!\n\nNathann",
    "created_at": "2015-04-18T10:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241664",
    "user": "@nathanncohen"
}
```

Okayyyyyyy. Then `positive_review`!

Nathann



---

archive/issue_comments_241665.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-19T01:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17976",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17976#issuecomment-241665",
    "user": "@vbraun"
}
```

Resolution: fixed
