# Issue 31042: Add package argon2-cffi

Issue created by migration from https://trac.sagemath.org/ticket/31279

Original creator: mkoeppe

Original creation time: 2021-01-22 03:44:16

CC:  @jcamp0x2a slelievre kcrisman dimpase jhpalmieri @tobiasdiez

This is an `install-requires` of `notebook`.

In #26919 we did not add it, but if we let Python dependencies play out, it gets pulled in by sagelib via ipywidgets (#31278)


---

Comment by mkoeppe created at 2021-01-22 04:04:16

New commits:


---

Comment by mkoeppe created at 2021-01-22 04:04:16

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-01-22 04:04:16

Changing priority from minor to major.


---

Comment by mkoeppe created at 2021-02-02 19:32:54

Changing priority from major to critical.


---

Comment by jhpalmieri created at 2021-02-02 19:58:32

I don't understand this ticket. If I build Sage and run the notebook, `argon-cffi` is not installed anywhere, as far as I can tell. What am I missing?


---

Comment by mkoeppe created at 2021-02-08 02:13:42

We install all packages using `pip install --no-deps` (see `build/bin/sage-pip-install`), so dependencies that the package declares as `install-requires` are not automatically installed. As a result, I assume some feature of the Jupyter notebook must be unavailable; but I do not know what exactly.


---

Comment by jhpalmieri created at 2021-02-08 17:35:25

`argon2-cffi` does something with password hashing, and I don't know if it's really necessary. I don't know enough about the security of the Jupyter notebook, or how `argon2-cffi` would help, to make a decision.


---

Comment by mkoeppe created at 2021-02-08 17:37:17

used here: https://github.com/jupyter/notebook/blob/bc28d6123117c3c733697e27e9d4bd71d7f0c46b/notebook/auth/security.py


---

Comment by @kliem created at 2021-02-11 08:15:25

We need to set `ARGON2_CFFI_USE_SSE2` to `0` in case of `SAGE_FAT_BINARY`.

https://argon2-cffi.readthedocs.io/en/stable/installation.html


---

Comment by mkoeppe created at 2021-02-11 17:07:29

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-02-11 17:38:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-02-11 17:39:06

Changing status from needs_work to needs_review.


---

Comment by @kliem created at 2021-02-11 18:09:36

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2021-02-11 18:09:36

LGTM.


---

Comment by mkoeppe created at 2021-02-11 18:45:57

Thank you!


---

Comment by vbraun created at 2021-03-01 00:21:20

Resolution: fixed


---

Comment by mkoeppe created at 2021-03-01 00:25:46

Follow up in #31441
