# Issue 24860: Algebraic polyhedra with QNormaliz / e-antic

archive/issues_024860.json:
```json
{
    "body": "CC:  winfried vdelecroix jipilab @sebasguts tmonteil moritz\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/25097\n\n",
    "created_at": "2018-04-03T23:31:05Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "title": "Algebraic polyhedra with QNormaliz / e-antic",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24860",
    "user": "mkoeppe"
}
```
CC:  winfried vdelecroix jipilab @sebasguts tmonteil moritz



Issue created by migration from https://trac.sagemath.org/ticket/25097





---

archive/issue_comments_349259.json:
```json
{
    "body": "prerequisite: package [antic](https://github.com/wbhart/antic) (that has no release yet).",
    "created_at": "2018-04-04T08:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349259",
    "user": "vdelecroix"
}
```

prerequisite: package [antic](https://github.com/wbhart/antic) (that has no release yet).



---

archive/issue_comments_349260.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2018-04-04T19:33:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349260",
    "user": "mkoeppe"
}
```

Last 10 new commits:



---

archive/issue_comments_349261.json:
```json
{
    "body": "Could someone who has worked on / has opinions on the Polyhedron constructor code help here?\n\nWhat should we do for polyhedra over AA such as the following:\n\n```\nsage: P = polytopes.regular_polygon(3)\nsage: P.base_ring()\nAlgebraic Real Field\n```\n\nIf `backend=normaliz` is requested, should we cast to the appropriate number field via #20181? Or should it be an error?",
    "created_at": "2018-04-04T20:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349261",
    "user": "mkoeppe"
}
```

Could someone who has worked on / has opinions on the Polyhedron constructor code help here?

What should we do for polyhedra over AA such as the following:

```
sage: P = polytopes.regular_polygon(3)
sage: P.base_ring()
Algebraic Real Field
```

If `backend=normaliz` is requested, should we cast to the appropriate number field via #20181? Or should it be an error?



---

archive/issue_comments_349262.json:
```json
{
    "body": "> What should we do for polyhedra over AA such as the following:\n> {{{\n> sage: P = polytopes.regular_polygon(3)\n> sage: P.base_ring()\n> Algebraic Real Field\n> }}}\n> If `backend=normaliz` is requested, should we cast to the appropriate number field via #20181? Or should it be an error?\n> \n\nI would say the cleanest thing to do once #20181 is done will be to use it! This probably will also simplify the constructor for `field`.",
    "created_at": "2018-04-05T23:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349262",
    "user": "jipilab"
}
```

> What should we do for polyhedra over AA such as the following:
> {{{
> sage: P = polytopes.regular_polygon(3)
> sage: P.base_ring()
> Algebraic Real Field
> }}}
> If `backend=normaliz` is requested, should we cast to the appropriate number field via #20181? Or should it be an error?
> 

I would say the cleanest thing to do once #20181 is done will be to use it! This probably will also simplify the constructor for `field`.



---

archive/issue_comments_349263.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-06T21:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349263",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349264.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-06T21:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349264",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349265.json:
```json
{
    "body": "I put some preliminary code in to do the coercion to number fields inside the `Polyhedron_normaliz` implementation, using `number_field_elements_from_algebraics`.",
    "created_at": "2018-04-08T18:10:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349265",
    "user": "mkoeppe"
}
```

I put some preliminary code in to do the coercion to number fields inside the `Polyhedron_normaliz` implementation, using `number_field_elements_from_algebraics`.



---

archive/issue_comments_349266.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-08T18:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349266",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349267.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-08T22:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349267",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349268.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-09T03:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349268",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349269.json:
```json
{
    "body": "Changing keywords from \"\" to \"IMA-PolyGeom\".",
    "created_at": "2018-04-09T03:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349269",
    "user": "mkoeppe"
}
```

Changing keywords from "" to "IMA-PolyGeom".



---

archive/issue_comments_349270.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-09T15:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349270",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349271.json:
```json
{
    "body": "A note: I am trying out the method in the ticket description and I get a `ImportError: No module named PyQNormaliz_cpp` when I try with an example.\n\nWhat should I do?",
    "created_at": "2018-04-09T20:31:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349271",
    "user": "jipilab"
}
```

A note: I am trying out the method in the ticket description and I get a `ImportError: No module named PyQNormaliz_cpp` when I try with an example.

What should I do?



---

archive/issue_comments_349272.json:
```json
{
    "body": "Replying to [comment:26 jipilab]:\n> A note: I am trying out the method in the ticket description and I get a `ImportError: No module named PyQNormaliz_cpp` when I try with an example.\n> \n> What should I do?\n\nComing from the installation of normaliz through sage:\n\n\n```\n[normaliz] Installing ARB...\n[normaliz] curl: (1) Protocol \"https\" not supported or disabled in libcurl\nMakefile:2080: recipe for target 'normaliz' failed\nmake[1]: *** [normaliz] Error 1\nmake[1]: Leaving directory '/home/jplabbe/sage/build/make'\n```\n",
    "created_at": "2018-04-09T20:39:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349272",
    "user": "jipilab"
}
```

Replying to [comment:26 jipilab]:
> A note: I am trying out the method in the ticket description and I get a `ImportError: No module named PyQNormaliz_cpp` when I try with an example.
> 
> What should I do?

Coming from the installation of normaliz through sage:


```
[normaliz] Installing ARB...
[normaliz] curl: (1) Protocol "https" not supported or disabled in libcurl
Makefile:2080: recipe for target 'normaliz' failed
make[1]: *** [normaliz] Error 1
make[1]: Leaving directory '/home/jplabbe/sage/build/make'
```




---

archive/issue_comments_349273.json:
```json
{
    "body": "Replying to [comment:27 jipilab]:\n> Replying to [comment:26 jipilab]:\n> > A note: I am trying out the method in the ticket description and I get a `ImportError: No module named PyQNormaliz_cpp` when I try with an example.\n> > \n> > What should I do?\n> \n> Coming from the installation of normaliz through sage:\n> \n> {{{\n> [normaliz] Installing ARB...\n> [normaliz] curl: (1) Protocol \"https\" not supported or disabled in libcurl\n> Makefile:2080: recipe for target 'normaliz' failed\n> make[1]: *** [normaliz] Error 1\n> make[1]: Leaving directory '/home/jplabbe/sage/build/make'\n> }}}\n\nTo fix this, I had to force install `curl` inside a sage shell. On a debian-sid distribution, it seems that it was not necessary.",
    "created_at": "2018-04-09T21:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349273",
    "user": "jipilab"
}
```

Replying to [comment:27 jipilab]:
> Replying to [comment:26 jipilab]:
> > A note: I am trying out the method in the ticket description and I get a `ImportError: No module named PyQNormaliz_cpp` when I try with an example.
> > 
> > What should I do?
> 
> Coming from the installation of normaliz through sage:
> 
> {{{
> [normaliz] Installing ARB...
> [normaliz] curl: (1) Protocol "https" not supported or disabled in libcurl
> Makefile:2080: recipe for target 'normaliz' failed
> make[1]: *** [normaliz] Error 1
> make[1]: Leaving directory '/home/jplabbe/sage/build/make'
> }}}

To fix this, I had to force install `curl` inside a sage shell. On a debian-sid distribution, it seems that it was not necessary.



---

archive/issue_comments_349274.json:
```json
{
    "body": "After installing `autotools` and `automake` I get the following error message:\n\n\n```\n[normaliz] Installing E-ANTIC...\n[normaliz] From https://github.com/mkoeppe/e-antic\n[normaliz]  * branch            winfried   -> FETCH_HEAD\n[normaliz] HEAD is now at 9de1e6f... renf_elem_class.get_den: New\n[normaliz] aclocal: warning: couldn't open directory 'm4': No such file or directory\n[normaliz] configure.ac:9: error: possibly undefined macro: AC_PROG_LIBTOOL\n[normaliz]       If this token and others are legitimate, please use m4_pattern_allow.\n[normaliz]       See the Autoconf documentation.\n[normaliz] autoreconf: /usr/bin/autoconf failed with exit status: 1\nMakefile:2080: recipe for target 'normaliz' failed\nmake[1]: *** [normaliz] Error 1\nmake[1]: Leaving directory '/home/jplabbe/sage/build/make'\n```\n\n\nThen, after installing `libtool` (sage should complain about that not installed?!) then I get:\n\n\n```\n[normaliz] make[2]: Leaving directory '/home/jplabbe/sage/local/enfnormaliz/E-ANTIC_source/e-antic'\n[normaliz] configure: error: cannot find install-sh, install.sh, or shtool in \".\" \"./..\" \"./../..\"\nMakefile:2080: recipe for target 'normaliz' failed\nmake[1]: *** [normaliz] Error 1\nmake[1]: Leaving directory '/home/jplabbe/sage/build/make'\n```\n",
    "created_at": "2018-04-09T22:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349274",
    "user": "jipilab"
}
```

After installing `autotools` and `automake` I get the following error message:


```
[normaliz] Installing E-ANTIC...
[normaliz] From https://github.com/mkoeppe/e-antic
[normaliz]  * branch            winfried   -> FETCH_HEAD
[normaliz] HEAD is now at 9de1e6f... renf_elem_class.get_den: New
[normaliz] aclocal: warning: couldn't open directory 'm4': No such file or directory
[normaliz] configure.ac:9: error: possibly undefined macro: AC_PROG_LIBTOOL
[normaliz]       If this token and others are legitimate, please use m4_pattern_allow.
[normaliz]       See the Autoconf documentation.
[normaliz] autoreconf: /usr/bin/autoconf failed with exit status: 1
Makefile:2080: recipe for target 'normaliz' failed
make[1]: *** [normaliz] Error 1
make[1]: Leaving directory '/home/jplabbe/sage/build/make'
```


Then, after installing `libtool` (sage should complain about that not installed?!) then I get:


```
[normaliz] make[2]: Leaving directory '/home/jplabbe/sage/local/enfnormaliz/E-ANTIC_source/e-antic'
[normaliz] configure: error: cannot find install-sh, install.sh, or shtool in "." "./.." "./../.."
Makefile:2080: recipe for target 'normaliz' failed
make[1]: *** [normaliz] Error 1
make[1]: Leaving directory '/home/jplabbe/sage/build/make'
```




---

archive/issue_comments_349275.json:
```json
{
    "body": "... Problem solved by gh-sebasguts: there was an old config file lying around. Deleting it solved the issue.",
    "created_at": "2018-04-09T23:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349275",
    "user": "jipilab"
}
```

... Problem solved by gh-sebasguts: there was an old config file lying around. Deleting it solved the issue.



---

archive/issue_comments_349276.json:
```json
{
    "body": "works flawlessly for me!",
    "created_at": "2018-04-09T23:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349276",
    "user": "moritz"
}
```

works flawlessly for me!



---

archive/issue_comments_349277.json:
```json
{
    "body": "Replying to [comment:28 jipilab]:\n> Replying to [comment:27 jipilab]:\n> > Replying to [comment:26 jipilab]:\n> > > A note: I am trying out the method in the ticket description and I get a `ImportError: No module named PyQNormaliz_cpp` when I try with an example.\n> > > \n> > > What should I do?\n> > \n> > Coming from the installation of normaliz through sage:\n> > \n> > {{{\n> > [normaliz] Installing ARB...\n> > [normaliz] curl: (1) Protocol \"https\" not supported or disabled in libcurl\n> > Makefile:2080: recipe for target 'normaliz' failed\n> > make[1]: *** [normaliz] Error 1\n> > make[1]: Leaving directory '/home/jplabbe/sage/build/make'\n> > }}}\n> \n> To fix this, I had to force install `curl` inside a sage shell. On a debian-sid distribution, it seems that it was not necessary.\n\nSame issue in Ubuntu 16.04LTS, doing `sage -f curl` in a sage shell does not work. Purging curl and reinstalling also didn't work. In order to enable ssl for curl, used the command `sudo apt-get install libssl-dev`. After that I no longer have the error `curl: (1) Protocol \"https\" not supported...`",
    "created_at": "2018-04-10T15:21:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349277",
    "user": "@TimmyChan"
}
```

Replying to [comment:28 jipilab]:
> Replying to [comment:27 jipilab]:
> > Replying to [comment:26 jipilab]:
> > > A note: I am trying out the method in the ticket description and I get a `ImportError: No module named PyQNormaliz_cpp` when I try with an example.
> > > 
> > > What should I do?
> > 
> > Coming from the installation of normaliz through sage:
> > 
> > {{{
> > [normaliz] Installing ARB...
> > [normaliz] curl: (1) Protocol "https" not supported or disabled in libcurl
> > Makefile:2080: recipe for target 'normaliz' failed
> > make[1]: *** [normaliz] Error 1
> > make[1]: Leaving directory '/home/jplabbe/sage/build/make'
> > }}}
> 
> To fix this, I had to force install `curl` inside a sage shell. On a debian-sid distribution, it seems that it was not necessary.

Same issue in Ubuntu 16.04LTS, doing `sage -f curl` in a sage shell does not work. Purging curl and reinstalling also didn't work. In order to enable ssl for curl, used the command `sudo apt-get install libssl-dev`. After that I no longer have the error `curl: (1) Protocol "https" not supported...`



---

archive/issue_comments_349278.json:
```json
{
    "body": "Replying to [comment:31 jipilab]:\n> After installing `autotools` and `automake` I get the following error message:\n> \n> {{{\n> [normaliz] Installing E-ANTIC...\n> [normaliz] From https://github.com/mkoeppe/e-antic\n> [normaliz]  * branch            winfried   -> FETCH_HEAD\n> [normaliz] HEAD is now at 9de1e6f... renf_elem_class.get_den: New\n> [normaliz] aclocal: warning: couldn't open directory 'm4': No such file or directory\n> [normaliz] configure.ac:9: error: possibly undefined macro: AC_PROG_LIBTOOL\n> [normaliz]       If this token and others are legitimate, please use m4_pattern_allow.\n> [normaliz]       See the Autoconf documentation.\n> [normaliz] autoreconf: /usr/bin/autoconf failed with exit status: 1\n> Makefile:2080: recipe for target 'normaliz' failed\n> make[1]: *** [normaliz] Error 1\n> make[1]: Leaving directory '/home/jplabbe/sage/build/make'\n> }}}\n> \n> Then, after installing `libtool` (sage should complain about that not installed?!) then I get:\n> \n> {{{\n> [normaliz] make[2]: Leaving directory '/home/jplabbe/sage/local/enfnormaliz/E-ANTIC_source/e-antic'\n> [normaliz] configure: error: cannot find install-sh, install.sh, or shtool in \".\" \"./..\" \"./../..\"\n> Makefile:2080: recipe for target 'normaliz' failed\n> make[1]: *** [normaliz] Error 1\n> make[1]: Leaving directory '/home/jplabbe/sage/build/make'\n> }}}\n\n\nInstalled `autotools-dev` and `automake` and `libtool` and installation completed on Ubuntu 16.04LTS.",
    "created_at": "2018-04-10T15:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349278",
    "user": "@TimmyChan"
}
```

Replying to [comment:31 jipilab]:
> After installing `autotools` and `automake` I get the following error message:
> 
> {{{
> [normaliz] Installing E-ANTIC...
> [normaliz] From https://github.com/mkoeppe/e-antic
> [normaliz]  * branch            winfried   -> FETCH_HEAD
> [normaliz] HEAD is now at 9de1e6f... renf_elem_class.get_den: New
> [normaliz] aclocal: warning: couldn't open directory 'm4': No such file or directory
> [normaliz] configure.ac:9: error: possibly undefined macro: AC_PROG_LIBTOOL
> [normaliz]       If this token and others are legitimate, please use m4_pattern_allow.
> [normaliz]       See the Autoconf documentation.
> [normaliz] autoreconf: /usr/bin/autoconf failed with exit status: 1
> Makefile:2080: recipe for target 'normaliz' failed
> make[1]: *** [normaliz] Error 1
> make[1]: Leaving directory '/home/jplabbe/sage/build/make'
> }}}
> 
> Then, after installing `libtool` (sage should complain about that not installed?!) then I get:
> 
> {{{
> [normaliz] make[2]: Leaving directory '/home/jplabbe/sage/local/enfnormaliz/E-ANTIC_source/e-antic'
> [normaliz] configure: error: cannot find install-sh, install.sh, or shtool in "." "./.." "./../.."
> Makefile:2080: recipe for target 'normaliz' failed
> make[1]: *** [normaliz] Error 1
> make[1]: Leaving directory '/home/jplabbe/sage/build/make'
> }}}


Installed `autotools-dev` and `automake` and `libtool` and installation completed on Ubuntu 16.04LTS.



---

archive/issue_comments_349279.json:
```json
{
    "body": "There is a link error in my installation:\n\n\n```\nsage: import PyQNormaliz_cpp\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n<ipython-input-10-4c34a88d49d7> in <module>()\n----> 1 import PyQNormaliz_cpp\n\nImportError: /home/jplabbe/sage/local/enfnormaliz/lib/libantic.so.0: undefined symbol: _fmpq_poly_resultant_div\n```\n\n\nThis can be solved by typing\n\n\n```\nexport LD_LIBRARY_PATH=your_sage_path/local/enfnormaliz/lib/:$LD_LIBRARY_PATH\n```\n\n\nbefore starting sage in the terminal...",
    "created_at": "2018-04-10T15:54:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349279",
    "user": "jipilab"
}
```

There is a link error in my installation:


```
sage: import PyQNormaliz_cpp
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-10-4c34a88d49d7> in <module>()
----> 1 import PyQNormaliz_cpp

ImportError: /home/jplabbe/sage/local/enfnormaliz/lib/libantic.so.0: undefined symbol: _fmpq_poly_resultant_div
```


This can be solved by typing


```
export LD_LIBRARY_PATH=your_sage_path/local/enfnormaliz/lib/:$LD_LIBRARY_PATH
```


before starting sage in the terminal...



---

archive/issue_comments_349280.json:
```json
{
    "body": "While this solution works for jipilab, it does not for gh-TimmyChan. Apparently his Ubuntu 16.04 honors the `-rpath` setting from the PyQNormaliz install script.\n\nThe problem is that the `-rpath` will be set by python itself, and it is not possible to insert anything before that path.",
    "created_at": "2018-04-10T17:06:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349280",
    "user": "@sebasguts"
}
```

While this solution works for jipilab, it does not for gh-TimmyChan. Apparently his Ubuntu 16.04 honors the `-rpath` setting from the PyQNormaliz install script.

The problem is that the `-rpath` will be set by python itself, and it is not possible to insert anything before that path.



---

archive/issue_comments_349281.json:
```json
{
    "body": "Replying to [comment:37 gh-sebasguts]:\n> While this solution works for jipilab, it does not for gh-TimmyChan. Apparently his Ubuntu 16.04 honors the `-rpath` setting from the PyQNormaliz install script.\n> \n> The problem is that the `-rpath` will be set by python itself, and it is not possible to insert anything before that path.\n\nTemporarily, `import PyQNormaliz_cpp` can work by removing 'libflint.so.13` from `~/sage/local/lib/` to some other directory.",
    "created_at": "2018-04-10T17:20:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349281",
    "user": "@TimmyChan"
}
```

Replying to [comment:37 gh-sebasguts]:
> While this solution works for jipilab, it does not for gh-TimmyChan. Apparently his Ubuntu 16.04 honors the `-rpath` setting from the PyQNormaliz install script.
> 
> The problem is that the `-rpath` will be set by python itself, and it is not possible to insert anything before that path.

Temporarily, `import PyQNormaliz_cpp` can work by removing 'libflint.so.13` from `~/sage/local/lib/` to some other directory.



---

archive/issue_comments_349282.json:
```json
{
    "body": "Since version 3.6.0 QNormaliz and PyQNormaliz are included in the Normaliz distribution.",
    "created_at": "2018-07-05T09:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349282",
    "user": "Winfried"
}
```

Since version 3.6.0 QNormaliz and PyQNormaliz are included in the Normaliz distribution.



---

archive/issue_comments_349283.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-18T17:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349283",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349284.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2018-09-18T21:27:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349284",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_349285.json:
```json
{
    "body": "Updated this branch to use the current released versions of Normaliz from #25090 and PyQNormaliz from pypi.",
    "created_at": "2018-09-18T21:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349285",
    "user": "mkoeppe"
}
```

Updated this branch to use the current released versions of Normaliz from #25090 and PyQNormaliz from pypi.



---

archive/issue_comments_349286.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-19T03:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349286",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349287.json:
```json
{
    "body": "Far from \"needs review\", but needs testing / debugging.\n(I'm currently getting a segfault when running the testsuite for backend_normaliz.py.)",
    "created_at": "2018-09-19T03:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349287",
    "user": "mkoeppe"
}
```

Far from "needs review", but needs testing / debugging.
(I'm currently getting a segfault when running the testsuite for backend_normaliz.py.)



---

archive/issue_comments_349288.json:
```json
{
    "body": "Could you give more specific information?",
    "created_at": "2018-09-19T07:02:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349288",
    "user": "Winfried"
}
```

Could you give more specific information?



---

archive/issue_comments_349289.json:
```json
{
    "body": "\n```\nsage: x = polygen(ZZ); P = Polyhedron(vertices=[[sqrt(2)], [AA.polynomial_root(x^3-2, RIF(0,3))]], backend='normaliz', ver\n....: bose=True)\n# ----8<---- Equivalent QNormaliz input file ---8<----\namb_space 1\nsubspace 0\nvertices 2\n (a^3) 1\n (a^2) 1\nnumber_field min_poly (a^6 - 2) embedding [1.122462048309373 +/- 5.38e-16]\ncone 0\n# ----8<-------------------8<-------------------8<----\n# Calling PyQNormaliz_cpp.NmzCone(**{'subspace': [], 'vertices': [[[[0L, 1L], [0L, 1L], [0L, 1L], [1L, 1L], [0L, 1L], [0L, 1L]], 1L], [[[0L, 1L], [0L, 1L], [1L, 1L], [0L, 1L], [0L, 1L], [0L, 1L]], 1L]], 'number_field': 'min_poly (a^6 - 2) embedding [1.122462048309373 +/- 5.38e-16]', 'cone': []})\n------------------------------------------------------------------------\n(no backtrace available)\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n------------------------------------------------------------------------\nSegmentation fault: 11\n```\n",
    "created_at": "2018-09-19T12:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349289",
    "user": "mkoeppe"
}
```


```
sage: x = polygen(ZZ); P = Polyhedron(vertices=[[sqrt(2)], [AA.polynomial_root(x^3-2, RIF(0,3))]], backend='normaliz', ver
....: bose=True)
# ----8<---- Equivalent QNormaliz input file ---8<----
amb_space 1
subspace 0
vertices 2
 (a^3) 1
 (a^2) 1
number_field min_poly (a^6 - 2) embedding [1.122462048309373 +/- 5.38e-16]
cone 0
# ----8<-------------------8<-------------------8<----
# Calling PyQNormaliz_cpp.NmzCone(**{'subspace': [], 'vertices': [[[[0L, 1L], [0L, 1L], [0L, 1L], [1L, 1L], [0L, 1L], [0L, 1L]], 1L], [[[0L, 1L], [0L, 1L], [1L, 1L], [0L, 1L], [0L, 1L], [0L, 1L]], 1L]], 'number_field': 'min_poly (a^6 - 2) embedding [1.122462048309373 +/- 5.38e-16]', 'cone': []})
------------------------------------------------------------------------
(no backtrace available)
------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
------------------------------------------------------------------------
Segmentation fault: 11
```




---

archive/issue_comments_349290.json:
```json
{
    "body": "Normaliz 3.6.3 (and presumably already 3.6.0) computes the polytope without any problems, provided the number_field follows immediately after amb_space. (One could think of relaxing this condition.) Output:\n\n\n\n```\nReal embedded number field:\nmin_poly (a^6 - 2) embedding [1.1225 +/- 4.57e-5]\n\n2 vertices of polyhedron\n0 extreme rays of recession cone\n2 support hyperplanes of polyhedron (homogenized)\n\nembedding dimension = 2\naffine dimension of the polyhedron = 1 (maximal)\nrank of recession cone = 0\n\ndehomogenization:\n0 1 \n\n***********************************************************************\n\n2 vertices of polyhedron:\n (a^2 ~ 1.2599) 1\n (a^3 ~ 1.4142) 1\n\n0 extreme rays of recession cone:\n\n2 support hyperplanes of polyhedron (homogenized):\n (-1/2*a^3 ~ -0.7071)  1\n   (1/2*a^4 ~ 0.7937) -1\n```\n",
    "created_at": "2018-09-19T13:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349290",
    "user": "Winfried"
}
```

Normaliz 3.6.3 (and presumably already 3.6.0) computes the polytope without any problems, provided the number_field follows immediately after amb_space. (One could think of relaxing this condition.) Output:



```
Real embedded number field:
min_poly (a^6 - 2) embedding [1.1225 +/- 4.57e-5]

2 vertices of polyhedron
0 extreme rays of recession cone
2 support hyperplanes of polyhedron (homogenized)

embedding dimension = 2
affine dimension of the polyhedron = 1 (maximal)
rank of recession cone = 0

dehomogenization:
0 1 

***********************************************************************

2 vertices of polyhedron:
 (a^2 ~ 1.2599) 1
 (a^3 ~ 1.4142) 1

0 extreme rays of recession cone:

2 support hyperplanes of polyhedron (homogenized):
 (-1/2*a^3 ~ -0.7071)  1
   (1/2*a^4 ~ 0.7937) -1
```




---

archive/issue_comments_349291.json:
```json
{
    "body": "Replying to [comment:50 Winfried]:\n> Normaliz 3.6.3 (and presumably already 3.6.0) computes the polytope without any problems,\n\nThanks for testing. Yes, I think the segfault is coming from somewhere in the interfacing.\n\n> provided the number_field follows immediately after amb_space. \n> (One could think of relaxing this condition.) \nNo, I don't think that's necessary -- I just need to fix the normaliz file writer in my sage code to know about this.",
    "created_at": "2018-09-19T13:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349291",
    "user": "mkoeppe"
}
```

Replying to [comment:50 Winfried]:
> Normaliz 3.6.3 (and presumably already 3.6.0) computes the polytope without any problems,

Thanks for testing. Yes, I think the segfault is coming from somewhere in the interfacing.

> provided the number_field follows immediately after amb_space. 
> (One could think of relaxing this condition.) 
No, I don't think that's necessary -- I just need to fix the normaliz file writer in my sage code to know about this.



---

archive/issue_comments_349292.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-21T00:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349292",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349293.json:
```json
{
    "body": "\n```\nx = polygen(ZZ); P = Polyhedron(vertices=[[sqrt(2)], [AA.polynomial_root(x^3-2, RIF(0,3))]], backend='normaliz', verbose=True); P._Hrepresentation\n.... segfault ...\n```\n\nSome memory corruption involving the gc, it seems",
    "created_at": "2018-09-21T01:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349293",
    "user": "mkoeppe"
}
```


```
x = polygen(ZZ); P = Polyhedron(vertices=[[sqrt(2)], [AA.polynomial_root(x^3-2, RIF(0,3))]], backend='normaliz', verbose=True); P._Hrepresentation
.... segfault ...
```

Some memory corruption involving the gc, it seems



---

archive/issue_comments_349294.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-21T20:05:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349294",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349295.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-21T22:11:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349295",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349296.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-22T01:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349296",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349297.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-22T18:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349297",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349298.json:
```json
{
    "body": "Replying to [comment:37 gh-sebasguts]:\n> While this solution works for jipilab, it does not for gh-TimmyChan. Apparently his Ubuntu 16.04 honors the `-rpath` setting from the PyQNormaliz install script.\n> \n> The problem is that the `-rpath` will be set by python itself, and it is not possible to insert anything before that path.\n\nWith the latest commits, I have removed the separate flint installation and this ticket should be easier to build. Please test",
    "created_at": "2018-09-22T19:07:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349298",
    "user": "mkoeppe"
}
```

Replying to [comment:37 gh-sebasguts]:
> While this solution works for jipilab, it does not for gh-TimmyChan. Apparently his Ubuntu 16.04 honors the `-rpath` setting from the PyQNormaliz install script.
> 
> The problem is that the `-rpath` will be set by python itself, and it is not possible to insert anything before that path.

With the latest commits, I have removed the separate flint installation and this ticket should be easier to build. Please test



---

archive/issue_comments_349299.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-22T20:12:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349299",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349300.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-23T03:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349300",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349301.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-23T13:28:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349301",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349302.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-09-23T13:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349302",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_349303.json:
```json
{
    "body": "PyQNormaliz 1.3 is out - https://files.pythonhosted.org/packages/f9/3a/4ffbb22390023f7f8331309c51a73063ccee465df307e898456fbcf05356/PyQNormaliz-1.3.tar.gz",
    "created_at": "2018-09-27T23:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349303",
    "user": "mkoeppe"
}
```

PyQNormaliz 1.3 is out - https://files.pythonhosted.org/packages/f9/3a/4ffbb22390023f7f8331309c51a73063ccee465df307e898456fbcf05356/PyQNormaliz-1.3.tar.gz



---

archive/issue_comments_349304.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-08T23:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349304",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349305.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-09T01:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349305",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349306.json:
```json
{
    "body": "I think we should decouple: upgrading Normaliz and interfacing Normaliz.",
    "created_at": "2019-04-16T19:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349306",
    "user": "vdelecroix"
}
```

I think we should decouple: upgrading Normaliz and interfacing Normaliz.



---

archive/issue_comments_349307.json:
```json
{
    "body": "I opened #27682",
    "created_at": "2019-04-16T19:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349307",
    "user": "vdelecroix"
}
```

I opened #27682



---

archive/issue_comments_349308.json:
```json
{
    "body": "Replying to [comment:68 vdelecroix]:\n> I think we should decouple: upgrading Normaliz and interfacing Normaliz.\n+1",
    "created_at": "2019-04-17T07:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349308",
    "user": "jipilab"
}
```

Replying to [comment:68 vdelecroix]:
> I think we should decouple: upgrading Normaliz and interfacing Normaliz.
+1



---

archive/issue_comments_349309.json:
```json
{
    "body": "I think it would be good to split this ticket into two tickets:\n1. Make `backend='normaliz'` accepts input being in a common embedded real number field. That is the following should work\n\n```\nsage: K.<a> = QuadraticField(2, embedding=AA(2)**(1/2))\nsage: Polyhedron([[0,0],[1,a],[0,2*a],[-1,-a]], base_ring=K, backend='normaliz')\n```\n\n  And we should also make it so that `backend='normaliz'` is actually automatically chosen if available\n\n```\nsage: Polyhedron([[0,0],[1,a],[0,2*a],[-1,-a]], base_ring=K)   # should use normaliz\n```\n\n  This would be enough to generate any of the regular polytope examples exactly (including the 600 cells) that could go in the SageMath database `polytopes.`.\n2. (follow-up ticket) When the input are elements in `AA`, or symbolic algebraic, etc, try to figure out how to convert stuff into an embedded number field",
    "created_at": "2019-04-18T14:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349309",
    "user": "vdelecroix"
}
```

I think it would be good to split this ticket into two tickets:
1. Make `backend='normaliz'` accepts input being in a common embedded real number field. That is the following should work

```
sage: K.<a> = QuadraticField(2, embedding=AA(2)**(1/2))
sage: Polyhedron([[0,0],[1,a],[0,2*a],[-1,-a]], base_ring=K, backend='normaliz')
```

  And we should also make it so that `backend='normaliz'` is actually automatically chosen if available

```
sage: Polyhedron([[0,0],[1,a],[0,2*a],[-1,-a]], base_ring=K)   # should use normaliz
```

  This would be enough to generate any of the regular polytope examples exactly (including the 600 cells) that could go in the SageMath database `polytopes.`.
2. (follow-up ticket) When the input are elements in `AA`, or symbolic algebraic, etc, try to figure out how to convert stuff into an embedded number field



---

archive/issue_comments_349310.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-04-18T19:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349310",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_349311.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2019-04-23T02:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349311",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_349312.json:
```json
{
    "body": "I have updated this ticket for 8.8.beta3. Still using the old Normaliz/QNormaliz/PyNormaliz/PyQNormaliz etc., \nbut merged in #20181. \n3 doctest failures.",
    "created_at": "2019-04-23T02:32:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349312",
    "user": "mkoeppe"
}
```

I have updated this ticket for 8.8.beta3. Still using the old Normaliz/QNormaliz/PyNormaliz/PyQNormaliz etc., 
but merged in #20181. 
3 doctest failures.



---

archive/issue_comments_349313.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-23T02:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349313",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349314.json:
```json
{
    "body": "Replying to [comment:76 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[7c3d64c](https://git.sagemath.org/sage.git/commit/?id=7c3d64c8a12275511f3d3875d37f48d3cb6857ec)||`Fix up for exact snub cube construction`||\n\nJust a small heads-up about #26340 that will conflict with this line.",
    "created_at": "2019-04-23T08:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349314",
    "user": "jipilab"
}
```

Replying to [comment:76 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[7c3d64c](https://git.sagemath.org/sage.git/commit/?id=7c3d64c8a12275511f3d3875d37f48d3cb6857ec)||`Fix up for exact snub cube construction`||

Just a small heads-up about #26340 that will conflict with this line.



---

archive/issue_comments_349315.json:
```json
{
    "body": "#27716 has all the backend work that does not depend on the algebraic stuff.",
    "created_at": "2019-04-23T13:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349315",
    "user": "mkoeppe"
}
```

#27716 has all the backend work that does not depend on the algebraic stuff.



---

archive/issue_comments_349316.json:
```json
{
    "body": "I will next redo this ticket on top of #27716, #26340, #27682, #20181.",
    "created_at": "2019-04-23T13:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349316",
    "user": "mkoeppe"
}
```

I will next redo this ticket on top of #27716, #26340, #27682, #20181.



---

archive/issue_comments_349317.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-04-23T15:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349317",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_349318.json:
```json
{
    "body": "Replying to [comment:79 mkoeppe]:\n> I will next redo this ticket on top of #27716, #26340, #27682, #20181.\nDone. Replaced the branch.\nMany doctests fail. Needs fixing: https://github.com/Normaliz/PyNormaliz/issues/37",
    "created_at": "2019-04-23T15:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349318",
    "user": "mkoeppe"
}
```

Replying to [comment:79 mkoeppe]:
> I will next redo this ticket on top of #27716, #26340, #27682, #20181.
Done. Replaced the branch.
Many doctests fail. Needs fixing: https://github.com/Normaliz/PyNormaliz/issues/37



---

archive/issue_comments_349319.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-23T21:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349319",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349320.json:
```json
{
    "body": "All tests work now except for one that needs a fix for this: https://github.com/Normaliz/PyNormaliz/issues/41",
    "created_at": "2019-04-23T21:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349320",
    "user": "mkoeppe"
}
```

All tests work now except for one that needs a fix for this: https://github.com/Normaliz/PyNormaliz/issues/41



---

archive/issue_comments_349321.json:
```json
{
    "body": "With Normaliz master (unreleased), all tests pass except for the broken snub cube example from #26340.",
    "created_at": "2019-04-24T15:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349321",
    "user": "mkoeppe"
}
```

With Normaliz master (unreleased), all tests pass except for the broken snub cube example from #26340.



---

archive/issue_comments_349322.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-24T18:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349322",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349323.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-25T07:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349323",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349324.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-25T14:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349324",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349325.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-25T14:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349325",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349326.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-25T14:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349326",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_349327.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-25T15:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349327",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349328.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-04-25T15:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349328",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_349329.json:
```json
{
    "body": "Ready for review. Builds and tests OK on macOS Mojave.",
    "created_at": "2019-04-25T15:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349329",
    "user": "mkoeppe"
}
```

Ready for review. Builds and tests OK on macOS Mojave.



---

archive/issue_comments_349330.json:
```json
{
    "body": "Builds on debian stretch.\n\n\n```\n$ sage -t sage/src/sage/geometry/polyhedron/*.py --optional=bliss,dochtml,gfortran,lrslib,memlimit,mpir,ninja_build,normaliz,pynormaliz,python2,sage,topcom\ntoo few successful tests, not using stored timings\nGit branch: 25097\nUsing --optional=bliss,dochtml,gfortran,lrslib,memlimit,mpir,ninja_build,normaliz,pynormaliz,python2,sage,topcom\nDoctesting 25 files.\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```\n",
    "created_at": "2019-04-25T15:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349330",
    "user": "jipilab"
}
```

Builds on debian stretch.


```
$ sage -t sage/src/sage/geometry/polyhedron/*.py --optional=bliss,dochtml,gfortran,lrslib,memlimit,mpir,ninja_build,normaliz,pynormaliz,python2,sage,topcom
too few successful tests, not using stored timings
Git branch: 25097
Using --optional=bliss,dochtml,gfortran,lrslib,memlimit,mpir,ninja_build,normaliz,pynormaliz,python2,sage,topcom
Doctesting 25 files.
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```




---

archive/issue_comments_349331.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2019-04-25T17:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349331",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_349332.json:
```json
{
    "body": "Merged #25091, works fine after minor changes.",
    "created_at": "2019-04-25T17:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349332",
    "user": "mkoeppe"
}
```

Merged #25091, works fine after minor changes.



---

archive/issue_comments_349333.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-26T12:49:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349333",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349334.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-26T14:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349334",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349335.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-27T17:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349335",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349336.json:
```json
{
    "body": "An error in convex hull?",
    "created_at": "2019-04-30T07:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349336",
    "user": "jipilab"
}
```

An error in convex hull?



---

archive/issue_comments_349337.json:
```json
{
    "body": "Attachment [error.txt](tarball://root/attachments/some-uuid/ticket25097/error.txt) by mkoeppe created at 2019-05-01 11:27:29\n\nThat error was caused by using an old PyNormaliz.",
    "created_at": "2019-05-01T11:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349337",
    "user": "mkoeppe"
}
```

Attachment [error.txt](tarball://root/attachments/some-uuid/ticket25097/error.txt) by mkoeppe created at 2019-05-01 11:27:29

That error was caused by using an old PyNormaliz.



---

archive/issue_comments_349338.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-01T11:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349338",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349339.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-01T17:53:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349339",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349340.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2019-05-02T20:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349340",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_349341.json:
```json
{
    "body": "Here is an error happening while coercing the values back into the given base ring (`UCF` in this case):\n\n\n```\nsage: W = CoxeterGroup(['I',8])\nsage: n = W.one().canonical_matrix().rank()\nsage: weights = W.fundamental_weights()\nsage: point = [ZZ.one()] * n\nsage: apex = sum(point[i-1] * weights[i] for i in weights.keys())\nsage: non_zero_index = list(apex).index(filter(lambda x: x!=0, apex)[0])\nsage: apex = (QQ(1)/apex[non_zero_index]) * apex\nsage: apex.set_immutable()\nsage: vertices = set()\nsage: br = apex.base_ring()\nsage: for w in W:\n....:     new_point = w * apex\n....:     new_point.set_immutable()\n....:     vertices.add(new_point)\n....:     \nsage: Polyhedron(vertices=vertices, backend='normaliz', base_ring=br,verbose=True)\nTraceback (most recent call last):\n...\nTypeError: -1 of type <type 'sage.rings.number_field.number_field_element.NumberFieldElement_absolute'> not valid to initialize an element of the universal cyclotomic field\n```\n",
    "created_at": "2019-05-03T10:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349341",
    "user": "jipilab"
}
```

Here is an error happening while coercing the values back into the given base ring (`UCF` in this case):


```
sage: W = CoxeterGroup(['I',8])
sage: n = W.one().canonical_matrix().rank()
sage: weights = W.fundamental_weights()
sage: point = [ZZ.one()] * n
sage: apex = sum(point[i-1] * weights[i] for i in weights.keys())
sage: non_zero_index = list(apex).index(filter(lambda x: x!=0, apex)[0])
sage: apex = (QQ(1)/apex[non_zero_index]) * apex
sage: apex.set_immutable()
sage: vertices = set()
sage: br = apex.base_ring()
sage: for w in W:
....:     new_point = w * apex
....:     new_point.set_immutable()
....:     vertices.add(new_point)
....:     
sage: Polyhedron(vertices=vertices, backend='normaliz', base_ring=br,verbose=True)
Traceback (most recent call last):
...
TypeError: -1 of type <type 'sage.rings.number_field.number_field_element.NumberFieldElement_absolute'> not valid to initialize an element of the universal cyclotomic field
```




---

archive/issue_comments_349342.json:
```json
{
    "body": "Unfortunately both of the following conversions fail:\n\n```\nUniversalCyclotomicField()(AA(-1))\nTypeError: -1 of type <class 'sage.rings.qqbar.AlgebraicReal'> not valid to initialize an element of the universal cyclotomic field\n```\n\nand\n\n```\nsage: K.<sqrt2> = QuadraticField(2)\nsage: UniversalCyclotomicField()(K(-1))\nTypeError: -1 of type <type 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'> not valid to initialize an element of the universal cyclotomic field\n```\n",
    "created_at": "2019-05-03T12:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349342",
    "user": "mkoeppe"
}
```

Unfortunately both of the following conversions fail:

```
UniversalCyclotomicField()(AA(-1))
TypeError: -1 of type <class 'sage.rings.qqbar.AlgebraicReal'> not valid to initialize an element of the universal cyclotomic field
```

and

```
sage: K.<sqrt2> = QuadraticField(2)
sage: UniversalCyclotomicField()(K(-1))
TypeError: -1 of type <type 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'> not valid to initialize an element of the universal cyclotomic field
```




---

archive/issue_comments_349343.json:
```json
{
    "body": "This should be a separate ticket",
    "created_at": "2019-05-03T13:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349343",
    "user": "mkoeppe"
}
```

This should be a separate ticket



---

archive/issue_comments_349344.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-08T19:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349344",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349345.json:
```json
{
    "body": "There are python3 issues, pyflakes conventions issues, `:::` issues, and 2 missing doctests in `backend_normaliz.py`, see patchbot for more details.\n\nFrom a recent bot, there are the following files that have failing doctests (seems like the optional hashtag is missing):\n\n\n```\nsage -t --long src/sage/geometry/polyhedron/backend_normaliz.py  # 11 doctests failed\nsage -t --long src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst  # 2 doctests failed\n```\n",
    "created_at": "2019-05-17T13:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349345",
    "user": "jipilab"
}
```

There are python3 issues, pyflakes conventions issues, `:::` issues, and 2 missing doctests in `backend_normaliz.py`, see patchbot for more details.

From a recent bot, there are the following files that have failing doctests (seems like the optional hashtag is missing):


```
sage -t --long src/sage/geometry/polyhedron/backend_normaliz.py  # 11 doctests failed
sage -t --long src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst  # 2 doctests failed
```




---

archive/issue_comments_349346.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-05-17T13:05:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349346",
    "user": "jipilab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_349347.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-17T18:59:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349347",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349348.json:
```json
{
    "body": "Merged in latest version of #25091 and current beta.",
    "created_at": "2019-05-17T19:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349348",
    "user": "mkoeppe"
}
```

Merged in latest version of #25091 and current beta.



---

archive/issue_comments_349349.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-17T21:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349349",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349350.json:
```json
{
    "body": "Setting it back to needs_review to get a fresh patchbot run.",
    "created_at": "2019-05-17T21:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349350",
    "user": "mkoeppe"
}
```

Setting it back to needs_review to get a fresh patchbot run.



---

archive/issue_comments_349351.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-05-17T21:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349351",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_349352.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-17T21:31:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349352",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349353.json:
```json
{
    "body": "Replying to [comment:104 jipilab]:\n> Here is an error happening while coercing the values back into the given base ring (`UCF` in this case):\n\nShould we actually allow a complex field such as UCF as the base ring of a polyhedron?",
    "created_at": "2019-05-18T03:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349353",
    "user": "mkoeppe"
}
```

Replying to [comment:104 jipilab]:
> Here is an error happening while coercing the values back into the given base ring (`UCF` in this case):

Should we actually allow a complex field such as UCF as the base ring of a polyhedron?



---

archive/issue_comments_349354.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-18T13:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349354",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349355.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-18T13:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349355",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349356.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-18T13:49:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349356",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349357.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-18T14:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349357",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349358.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-18T21:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349358",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349359.json:
```json
{
    "body": "Replying to [comment:115 mkoeppe]:\n> Replying to [comment:104 jipilab]:\n> > Here is an error happening while coercing the values back into the given base ring (`UCF` in this case):\n> \n> Should we actually allow a complex field such as UCF as the base ring of a polyhedron? \n\nNot sure. I remember I was not so happy about allowing real algebraic numbers that have a complex parent into polyhedron: it makes things quite intricate in designing the constructor.\n\nThe situation before this ticket was not allowing anything inside of `SymbolicRing` for example, and this would also do the same for `UCF` is the backend field was not given (or perhaps there was an effort to check if one can coerce it in `AA`)... Now, since we accept things that are in the symbolic ring if it is possible to coerce it into an embedded number field... I feel like it would be nice to accept elements of `UCF` if they are real... I remember I had to tweak #20181  so that it would manage to coerce real algebraic numbers even though they are elements of a complex ring.\n\nThat said, I would say that the answer should be 'No' (as far as I understand, complex polyhedra are not really well-defined, or are they?). So, this would be an exception to the idea \"give back a common parent to the elements given by the user and use it as base ring\". I guess the rule should be bound to ultimately \"stay real\".\n\nSo there could be a check to see if the user provided elements from a complex ring (although they are indeed real) and do the appropriate steps to give a real base ring. I do not know how hard implementing this here.",
    "created_at": "2019-05-19T09:44:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349359",
    "user": "jipilab"
}
```

Replying to [comment:115 mkoeppe]:
> Replying to [comment:104 jipilab]:
> > Here is an error happening while coercing the values back into the given base ring (`UCF` in this case):
> 
> Should we actually allow a complex field such as UCF as the base ring of a polyhedron? 

Not sure. I remember I was not so happy about allowing real algebraic numbers that have a complex parent into polyhedron: it makes things quite intricate in designing the constructor.

The situation before this ticket was not allowing anything inside of `SymbolicRing` for example, and this would also do the same for `UCF` is the backend field was not given (or perhaps there was an effort to check if one can coerce it in `AA`)... Now, since we accept things that are in the symbolic ring if it is possible to coerce it into an embedded number field... I feel like it would be nice to accept elements of `UCF` if they are real... I remember I had to tweak #20181  so that it would manage to coerce real algebraic numbers even though they are elements of a complex ring.

That said, I would say that the answer should be 'No' (as far as I understand, complex polyhedra are not really well-defined, or are they?). So, this would be an exception to the idea "give back a common parent to the elements given by the user and use it as base ring". I guess the rule should be bound to ultimately "stay real".

So there could be a check to see if the user provided elements from a complex ring (although they are indeed real) and do the appropriate steps to give a real base ring. I do not know how hard implementing this here.



---

archive/issue_comments_349360.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-05-22T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349360",
    "user": "jipilab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_349361.json:
```json
{
    "body": "There are two doctest failing in the tutorials (coming from changing an error message):\n\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed\nsage -t --long src/sage/graphs/generic_graph.py  # 1 doctest failed\nsage -t --long src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst  # 2 doctests failed\n----------------------------------------------------------------------\n```\n\n\nThe first two might be spurious errors, but maybe they come from employing polyhedra...",
    "created_at": "2019-05-22T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349361",
    "user": "jipilab"
}
```

There are two doctest failing in the tutorials (coming from changing an error message):


```
----------------------------------------------------------------------
sage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed
sage -t --long src/sage/graphs/generic_graph.py  # 1 doctest failed
sage -t --long src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst  # 2 doctests failed
----------------------------------------------------------------------
```


The first two might be spurious errors, but maybe they come from employing polyhedra...



---

archive/issue_comments_349362.json:
```json
{
    "body": "Replying to [comment:123 jipilab]:\n> There are two doctest failing in the tutorials (coming from changing an error message):\n> \n> {{{\n> ----------------------------------------------------------------------\n> sage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed\n> sage -t --long src/sage/graphs/generic_graph.py  # 1 doctest failed\n> sage -t --long src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst  # 2 doctests failed\n> ----------------------------------------------------------------------\n> }}}\n> \n> The first two might be spurious errors, but maybe they come from employing polyhedra...\n\nActually, there is some dirt in the traceback for the errors on the branch. Most probably this is the cause of the breaking doctests...",
    "created_at": "2019-05-22T16:20:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349362",
    "user": "jipilab"
}
```

Replying to [comment:123 jipilab]:
> There are two doctest failing in the tutorials (coming from changing an error message):
> 
> {{{
> ----------------------------------------------------------------------
> sage -t --long src/sage/sat/boolean_polynomials.py  # 1 doctest failed
> sage -t --long src/sage/graphs/generic_graph.py  # 1 doctest failed
> sage -t --long src/doc/en/thematic_tutorials/geometry/polyhedra_tutorial.rst  # 2 doctests failed
> ----------------------------------------------------------------------
> }}}
> 
> The first two might be spurious errors, but maybe they come from employing polyhedra...

Actually, there is some dirt in the traceback for the errors on the branch. Most probably this is the cause of the breaking doctests...



---

archive/issue_comments_349363.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-23T01:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349363",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349364.json:
```json
{
    "body": "Fixed the doctest and merged in the newest beta.",
    "created_at": "2019-05-23T01:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349364",
    "user": "mkoeppe"
}
```

Fixed the doctest and merged in the newest beta.



---

archive/issue_comments_349365.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-05-23T01:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349365",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_349366.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-06-07T19:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349366",
    "user": "jipilab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_349367.json:
```json
{
    "body": "There is 1 doctest failing because of #21161. :-/",
    "created_at": "2019-06-07T19:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349367",
    "user": "jipilab"
}
```

There is 1 doctest failing because of #21161. :-/



---

archive/issue_comments_349368.json:
```json
{
    "body": "Now with #27965, we may get a conflict in snub dodecahedron. I was not quick enough to warn about it on the ticket #27965 about the current one...",
    "created_at": "2019-06-11T19:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349368",
    "user": "jipilab"
}
```

Now with #27965, we may get a conflict in snub dodecahedron. I was not quick enough to warn about it on the ticket #27965 about the current one...



---

archive/issue_comments_349369.json:
```json
{
    "body": "#27965 should be merged into this ticket to avoid yet another conflict.\n\nThe other ticket allows to \"whitelist\" geometry for py3, probably asap for it to be in the next release.\n\n... that said, I would also like to see this ticket in the next release so that we can move on to further enrich normaliz' interfacing...",
    "created_at": "2019-06-12T07:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349369",
    "user": "jipilab"
}
```

#27965 should be merged into this ticket to avoid yet another conflict.

The other ticket allows to "whitelist" geometry for py3, probably asap for it to be in the next release.

... that said, I would also like to see this ticket in the next release so that we can move on to further enrich normaliz' interfacing...



---

archive/issue_comments_349370.json:
```json
{
    "body": "Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).",
    "created_at": "2019-06-14T14:50:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349370",
    "user": "embray"
}
```

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).



---

archive/issue_comments_349371.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-19T21:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349371",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349372.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-06-19T21:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349372",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_349373.json:
```json
{
    "body": "Looks good to me now. I would say this is ready and I would put it as positive review, with Vincent also as a reviewer too.\n\n`@`Vincent: Let us know if you agree. It would be good to know if there are last things to be aware of.",
    "created_at": "2019-06-21T09:57:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349373",
    "user": "jipilab"
}
```

Looks good to me now. I would say this is ready and I would put it as positive review, with Vincent also as a reviewer too.

`@`Vincent: Let us know if you agree. It would be good to know if there are last things to be aware of.



---

archive/issue_comments_349374.json:
```json
{
    "body": "ping!\n\nAny last comments Vincent?",
    "created_at": "2019-07-05T07:21:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349374",
    "user": "jipilab"
}
```

ping!

Any last comments Vincent?



---

archive/issue_comments_349375.json:
```json
{
    "body": "doctest failure in /library with py3",
    "created_at": "2019-07-07T09:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349375",
    "user": "chapoton"
}
```

doctest failure in /library with py3



---

archive/issue_comments_349376.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-07-07T09:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349376",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_349377.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-08T19:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349377",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_349378.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-08T19:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349378",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_349379.json:
```json
{
    "body": "The last changes looks reasonable to me.",
    "created_at": "2019-07-11T13:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349379",
    "user": "chapoton"
}
```

The last changes looks reasonable to me.



---

archive/issue_comments_349380.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-16T16:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349380",
    "user": "jipilab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_349381.json:
```json
{
    "body": "It looks good to me too. I set it to positive review.\n\nJust a FYI: if there are any other comments, next week is the Sage days in Bonn and vdelecroix and me are going to be available to work on follow-ups if need be.",
    "created_at": "2019-07-16T16:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349381",
    "user": "jipilab"
}
```

It looks good to me too. I set it to positive review.

Just a FYI: if there are any other comments, next week is the Sage days in Bonn and vdelecroix and me are going to be available to work on follow-ups if need be.



---

archive/issue_comments_349382.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-07-18T21:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24860#issuecomment-349382",
    "user": "vbraun"
}
```

Resolution: fixed
