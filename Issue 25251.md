# Issue 25251: Improved Kash interface

Issue created by migration from https://trac.sagemath.org/ticket/25488

Original creator: @BrentBaccala

Original creation time: 2018-06-01 02:31:03

Keywords: kash

The current interface to the optional `kash` package has limited utility.  No way is provided to convert Kash expressions to Sage expressions, and Kash names like `sage1` might be re-used even if there are outstanding references to subexpressions like `sage1.1` (so this is also a bug fix, in addition to an enhancement).

This patch addresses those problems by allowing a translation dictionary to be passed to a Kash object's `sage()` method, mapping Kash objects to Sage objects, allowing conversions like this:


```
    sage: kQ = kash.RationalField()
    sage: kR = kQ.PolynomialAlgebra()

    sage: R.<x> = QQ[]
    sage: ka = (x^2+x).subs({x : kR.1})
    sage541.1^2 + sage541.1
    sage: ka.sage({kR.1: x})
    x^2 + x
```



---

Comment by @BrentBaccala created at 2018-06-01 05:25:26

Changing status from new to needs_review.


---

Comment by @BrentBaccala created at 2018-06-01 05:25:26

In the course of preparing this ticket, I realized that the default `bool()` routine in `interface/interface.py` is almost certainly wrong and would always need to be overridden.

Why?  Since the default implementation of `is_zero()` (in `structure/element.pyx`) returns `not self`, almost everything needs to type-convert to a boolean `True`, except for zero, which should type-convert to `False`.

`interface.py`'s default `bool()` routine has it backwards - it tests for equality to `_true_symbol()` (and everything else returns `False`), instead of inequality to `_false_symbol()` (and everything else returns `True`).

Maybe we should open another ticket for that.  For Kash, where we have separate boolean and integer types, we need to compare to both `FALSE` and `0`, so I think we need to override the method no matter what.
----
New commits:


---

Comment by git created at 2018-06-21 03:05:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-06-22 20:38:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2018-07-10 09:25:51

We are in fact thinking about removing support for `kash` completely.
The last release of `kash` was 10 years ago, and as it's only binary releases, there are increasingly fewer computers out there capable of running it.


---

Comment by @BrentBaccala created at 2018-07-10 20:21:14

Replying to [comment:4 dimpase]:
> We are in fact thinking about removing support for `kash` completely.
> The last release of `kash` was 10 years ago, and as it's only binary releases, there are increasingly fewer computers out there capable of running it.

Removing `kash` makes a lot of sense.

The problem is that it's the only thing we've got right now to compute bases for Riemann-Roch spaces over `QQ`.

Kwankyu Lee has written some new function field code that can handle Riemann-Roch calculations over finite fields, but even that code is taking forever to move into the released code base.

Somebody (maybe me) needs to expand the function field code to handle `QQ`, and get it into `master`, before we remove `kash`.

Although, I admit that next to nobody knows how to use `kash` to do those calculations.


---

Comment by git created at 2019-01-11 22:51:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-01-18 18:53:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-03-10 10:46:44

this is missing the optional kash tag:

```
kash.function_call('ComplexToPolar', [1+I], {'Results' : 1})
```



---

Comment by chapoton created at 2019-03-10 10:46:44

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-04-10 17:00:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @BrentBaccala created at 2019-04-10 17:07:01

Changing status from needs_work to needs_review.


---

Comment by embray created at 2019-07-03 11:37:56

Moving tickets from the Sage 8.8 milestone that have been actively worked on in the last six months to the next release milestone (optimistically).


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by mkoeppe created at 2020-08-30 15:38:57

The patchbot complains about some docstring issues


---

Comment by mkoeppe created at 2020-08-30 15:38:57

Changing status from needs_review to needs_work.


---

Comment by git created at 2020-10-14 19:11:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-10-20 18:23:30

patchbot is now green


---

Comment by dimpase created at 2020-11-06 15:57:26

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2020-11-22 15:05:11

Resolution: fixed
