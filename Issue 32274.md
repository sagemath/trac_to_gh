# Issue 32274: minimize_constrained() reorders the arguments of symbolic functions

archive/issues_032274.json:
```json
{
    "body": "When the argument to `minimize_constrained()` is a symbolic function, it does...\n\n\n\n```python\nvar_list = func.variables()\n```\n\n\nbut (as documented) the `variables()` method sorts the variables alphabetically. This leads to incorrect output when the `variables()` order does not agree with the order of the arguments to your function; say if your function if `f(z,y,x)` and the minimizer is output as `(x,y,z)`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/32511\n\n",
    "created_at": "2021-09-14T11:25:54Z",
    "labels": [
        "numerical",
        "major",
        "bug"
    ],
    "title": "minimize_constrained() reorders the arguments of symbolic functions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32274",
    "user": "mjo"
}
```
When the argument to `minimize_constrained()` is a symbolic function, it does...



```python
var_list = func.variables()
```


but (as documented) the `variables()` method sorts the variables alphabetically. This leads to incorrect output when the `variables()` order does not agree with the order of the arguments to your function; say if your function if `f(z,y,x)` and the minimizer is output as `(x,y,z)`.

Issue created by migration from https://trac.sagemath.org/ticket/32511





---

archive/issue_comments_460904.json:
```json
{
    "body": "I've added a \"soft dependency\" on #32234 here to avoid a merge conflict.\n\nFWIW both symbolic functions and expressions support an `arguments()` method that does not sort its result. Fixing this may be as easy as replacing `.variables()` with `.arguments()`.",
    "created_at": "2021-09-16T12:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460904",
    "user": "mjo"
}
```

I've added a "soft dependency" on #32234 here to avoid a merge conflict.

FWIW both symbolic functions and expressions support an `arguments()` method that does not sort its result. Fixing this may be as easy as replacing `.variables()` with `.arguments()`.



---

archive/issue_comments_460905.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-11-20T13:32:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460905",
    "user": "mjo"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_460906.json:
```json
{
    "body": "However, `arguments` for non-callable symbolic expressions is proposed to be deprecated in #32227...",
    "created_at": "2021-11-20T18:32:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460906",
    "user": "mkoeppe"
}
```

However, `arguments` for non-callable symbolic expressions is proposed to be deprecated in #32227...



---

archive/issue_comments_460907.json:
```json
{
    "body": "You could use the new `is_callable` method to distinguish the two cases...",
    "created_at": "2021-11-20T18:40:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460907",
    "user": "mkoeppe"
}
```

You could use the new `is_callable` method to distinguish the two cases...



---

archive/issue_comments_460908.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-20T20:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460908",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_460909.json:
```json
{
    "body": "Replying to [comment:3 mkoeppe]:\n> However, `arguments` for non-callable symbolic expressions is proposed to be deprecated in #32227...\n\nI think this is OK. The documentation for `minimize_constrained()` says that it should take either a symbolic function, or a python function. It was our `EXAMPLES` that were misleading and that I've fixed in the latest commit.\n\nWhen `arguments()` is deprecated, anyone still trying to use expressions with `minimize_constrained()` will be warned. Then when it's removed, you won't be able to use non-callable expressions at all. And that's fine. A tuple return value is meaningless when the only way to \"call your expression\" is via a dict.",
    "created_at": "2021-11-20T20:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460909",
    "user": "mjo"
}
```

Replying to [comment:3 mkoeppe]:
> However, `arguments` for non-callable symbolic expressions is proposed to be deprecated in #32227...

I think this is OK. The documentation for `minimize_constrained()` says that it should take either a symbolic function, or a python function. It was our `EXAMPLES` that were misleading and that I've fixed in the latest commit.

When `arguments()` is deprecated, anyone still trying to use expressions with `minimize_constrained()` will be warned. Then when it's removed, you won't be able to use non-callable expressions at all. And that's fine. A tuple return value is meaningless when the only way to "call your expression" is via a dict.



---

archive/issue_comments_460910.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-11-20T20:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460910",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_460911.json:
```json
{
    "body": "OK, I agree with this. LGTM.",
    "created_at": "2021-11-20T20:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460911",
    "user": "mkoeppe"
}
```

OK, I agree with this. LGTM.



---

archive/issue_comments_460912.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-12-05T11:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32274#issuecomment-460912",
    "user": "vbraun"
}
```

Resolution: fixed
