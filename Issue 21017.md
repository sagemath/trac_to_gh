# Issue 21017: Implement cluster algebras using the Parent-Element framework

archive/issues_021017.json:
```json
{
    "body": "CC:  gmoose05 drupel stumpc5 mdpressland@bath.edu tscrim egunawan\n\nKeywords: cluster algebras, SageDays64.5\n\nThis module uses structural results from \"Cluster algebras IV\" to implement cluster algebras as a subobject of `LaurentPolynomialRing_generic`.\n\nIt provides a new class `ClusterAlgebra` and two auxiliary classes `ClusterAlgebraSeed` and `ClusterAlgebraElement`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21254\n\n",
    "created_at": "2016-08-15T21:20:38Z",
    "labels": [
        "algebra",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Implement cluster algebras using the Parent-Element framework",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21017",
    "user": "etn40ff"
}
```
CC:  gmoose05 drupel stumpc5 mdpressland@bath.edu tscrim egunawan

Keywords: cluster algebras, SageDays64.5

This module uses structural results from "Cluster algebras IV" to implement cluster algebras as a subobject of `LaurentPolynomialRing_generic`.

It provides a new class `ClusterAlgebra` and two auxiliary classes `ClusterAlgebraSeed` and `ClusterAlgebraElement`.

Issue created by migration from https://trac.sagemath.org/ticket/21254





---

archive/issue_comments_291107.json:
```json
{
    "body": "Set assignee to etn40ff.",
    "created_at": "2016-08-15T21:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291107",
    "user": "etn40ff"
}
```

Set assignee to etn40ff.



---

archive/issue_comments_291108.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-20T23:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291108",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291109.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-21T09:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291109",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291110.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-22T07:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291110",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291111.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-23T08:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291111",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291112.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-25T17:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291112",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291113.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-25T18:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291113",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291114.json:
```json
{
    "body": "I have just launched my own patchbot on the ticket.\n\nThere are some missing empty lines, for example here\n\n```\n+    EXAMPLES::\n+        sage: A = ClusterAlgebra(['B',2],principal_coefficients=True)\n```\n",
    "created_at": "2016-08-25T19:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291114",
    "user": "chapoton"
}
```

I have just launched my own patchbot on the ticket.

There are some missing empty lines, for example here

```
+    EXAMPLES::
+        sage: A = ClusterAlgebra(['B',2],principal_coefficients=True)
```




---

archive/issue_comments_291115.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-25T20:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291115",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291116.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-25T20:56:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291116",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291117.json:
```json
{
    "body": "> There are some missing empty lines, for example here\nI just fixed that; thank you for catching it. Is there any automatic way to check that the code adhere to all the conventions?\nI only know of autopep8 but this does not test docstrings. \n(By the way we have plenty of long lines so we do not really adhere to pep8\neither.)\n\n\nOn a different topic: there has been a discussion on sage-devel on the best way\nto implement the exploring iterator. The discussion migrated to #21312 where the\npossibility to use `RecursivelyEnumeratedSet` has been explored. It turns out that\nthis can be done gaining a significant slowdown. I ended up writing the\ncurrent solution. A migration to `RecursivelyEnumeratedSet` might be considered\nfor a follow-up ticket. I am just writing this here for the record.",
    "created_at": "2016-08-25T21:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291117",
    "user": "etn40ff"
}
```

> There are some missing empty lines, for example here
I just fixed that; thank you for catching it. Is there any automatic way to check that the code adhere to all the conventions?
I only know of autopep8 but this does not test docstrings. 
(By the way we have plenty of long lines so we do not really adhere to pep8
either.)


On a different topic: there has been a discussion on sage-devel on the best way
to implement the exploring iterator. The discussion migrated to #21312 where the
possibility to use `RecursivelyEnumeratedSet` has been explored. It turns out that
this can be done gaining a significant slowdown. I ended up writing the
current solution. A migration to `RecursivelyEnumeratedSet` might be considered
for a follow-up ticket. I am just writing this here for the record.



---

archive/issue_comments_291118.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-08-26T06:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291118",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291119.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-05T12:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291119",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291120.json:
```json
{
    "body": "Seems ready to go up for review",
    "created_at": "2016-09-05T13:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291120",
    "user": "etn40ff"
}
```

Seems ready to go up for review



---

archive/issue_comments_291121.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-05T13:18:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291121",
    "user": "etn40ff"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_291122.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-05T13:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291122",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291123.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-07T13:12:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291123",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291124.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2016-09-09T09:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291124",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_291125.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-21T09:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291125",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291126.json:
```json
{
    "body": "* typo: variariable\n\n* please do not use xrange, but six.moves.range (py3)\n\n* WARNING: should be .. WARNING::\n\n* please do not put a dot at the end of the text of raise *Error(\"some text\")\n\n* pep8 cleanup suggestions:\n\n```\n1       E225 missing whitespace around operator\n74      E226 missing whitespace around arithmetic operator\n9       E228 missing whitespace around modulo operator\n33      E231 missing whitespace after ','\n9       E302 expected 2 blank lines, found 1\n3       W601 .has_key() is deprecated, use 'in'\n```\n\n\nok, enough for today\n\n**EDIT** another typo : usethe\n\n**EDIT**: itareator",
    "created_at": "2016-10-18T19:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291126",
    "user": "chapoton"
}
```

* typo: variariable

* please do not use xrange, but six.moves.range (py3)

* WARNING: should be .. WARNING::

* please do not put a dot at the end of the text of raise *Error("some text")

* pep8 cleanup suggestions:

```
1       E225 missing whitespace around operator
74      E226 missing whitespace around arithmetic operator
9       E228 missing whitespace around modulo operator
33      E231 missing whitespace after ','
9       E302 expected 2 blank lines, found 1
3       W601 .has_key() is deprecated, use 'in'
```


ok, enough for today

**EDIT** another typo : usethe

**EDIT**: itareator



---

archive/issue_comments_291127.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-19T15:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291127",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291128.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-19T15:15:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291128",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291129.json:
```json
{
    "body": "thanks.\n\nsome more remarks:\n\n* pep8 is for code, not for documentation. It was not necessary to add a space after all commas in the doc. You can use \"pep8 --ignore=E501 file.py\" to check if there remains errors (and where).\n\n* you should rather just do \"from six.moves import range\" and search-and-replace xrange by range. We are on the way to remove all xrange from sage (except in cython files)\n\n* I am a bit puzzled by your strange manipulations of the doc (using `__doc__`) This is ugly code, imho.\n\n* and I have the same bad feeling about your way to add methods only in special cases.. But maybe this is because I have never seen anything like that before\n\n* a general remark on the doc is that after a single colon, you should not indent by 4, because the single colon is not defining a block. \n\n* maybe not for now, but for the user who wants index starting at one, one may like to implement something like \"index_set\" (that exists for root systems, I think)",
    "created_at": "2016-10-19T18:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291129",
    "user": "chapoton"
}
```

thanks.

some more remarks:

* pep8 is for code, not for documentation. It was not necessary to add a space after all commas in the doc. You can use "pep8 --ignore=E501 file.py" to check if there remains errors (and where).

* you should rather just do "from six.moves import range" and search-and-replace xrange by range. We are on the way to remove all xrange from sage (except in cython files)

* I am a bit puzzled by your strange manipulations of the doc (using `__doc__`) This is ugly code, imho.

* and I have the same bad feeling about your way to add methods only in special cases.. But maybe this is because I have never seen anything like that before

* a general remark on the doc is that after a single colon, you should not indent by 4, because the single colon is not defining a block. 

* maybe not for now, but for the user who wants index starting at one, one may like to implement something like "index_set" (that exists for root systems, I think)



---

archive/issue_comments_291130.json:
```json
{
    "body": "More comments:\n\n* probably .rk should be .rank (we prefer explicit names)\n\n* `+ (a1, a2) = d_vector` could be `+ a1, a2 = d_vector` (and same thing in other places)\n\n* remains at least one \"usethe\" and \"itareator\"\n\n* in \n`+        g_mon = prod([self.ambient().gen(i)**g_vector[i] for i in xrange(self.rk())])`\nyou do not need the square bracket inside the prod.\n\n* typo \"g_vetor\"",
    "created_at": "2016-10-19T19:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291130",
    "user": "chapoton"
}
```

More comments:

* probably .rk should be .rank (we prefer explicit names)

* `+ (a1, a2) = d_vector` could be `+ a1, a2 = d_vector` (and same thing in other places)

* remains at least one "usethe" and "itareator"

* in 
`+        g_mon = prod([self.ambient().gen(i)**g_vector[i] for i in xrange(self.rk())])`
you do not need the square bracket inside the prod.

* typo "g_vetor"



---

archive/issue_comments_291131.json:
```json
{
    "body": "After Frederic already started with a structural review, I finally take some time to play with the code.\n\nHere is the list of points I want to mention concerning the documentation:\n\n* The documentation start is too technical for my taste, containing many implementation details. I suggest to start with a brief description (or links) to what cluster algebras are + (even more importantly) followed by the later provided good examples. Only after, there should be a description of the algorithms used (I personally would even prefer to be pointed to the exact theorem) + the details of the implementation you give.\n\n* some example sentences start with capital letters, some with small letters\n\n* I agree with Frederic's \"I have [...] bad feeling about your way to add methods only in special cases\". Often, this is solved raising a `NotImplementedError`. On the other hand, I hate those errors and would often prefer if I rather not have a given method...",
    "created_at": "2016-10-21T11:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291131",
    "user": "stumpc5"
}
```

After Frederic already started with a structural review, I finally take some time to play with the code.

Here is the list of points I want to mention concerning the documentation:

* The documentation start is too technical for my taste, containing many implementation details. I suggest to start with a brief description (or links) to what cluster algebras are + (even more importantly) followed by the later provided good examples. Only after, there should be a description of the algorithms used (I personally would even prefer to be pointed to the exact theorem) + the details of the implementation you give.

* some example sentences start with capital letters, some with small letters

* I agree with Frederic's "I have [...] bad feeling about your way to add methods only in special cases". Often, this is solved raising a `NotImplementedError`. On the other hand, I hate those errors and would often prefer if I rather not have a given method...



---

archive/issue_comments_291132.json:
```json
{
    "body": "Concerning the usage:\n\n* If I want to use `A.F_polynomials()`, I have to first explore and then get the F-polys so far. I suggest to add `def F_polynomials()` as an iterator.\n\n* Maybe I misunderstand the objects, but shouldn't there be `A.d_vectors()` (and `A.c_vectors()` in the case of principal coefficients)?\n\nBeside that, I did play with it for a while and it really seemed to behave nicely and intuitively!",
    "created_at": "2016-10-21T11:13:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291132",
    "user": "stumpc5"
}
```

Concerning the usage:

* If I want to use `A.F_polynomials()`, I have to first explore and then get the F-polys so far. I suggest to add `def F_polynomials()` as an iterator.

* Maybe I misunderstand the objects, but shouldn't there be `A.d_vectors()` (and `A.c_vectors()` in the case of principal coefficients)?

Beside that, I did play with it for a while and it really seemed to behave nicely and intuitively!



---

archive/issue_comments_291133.json:
```json
{
    "body": "Replying to [comment:27 stumpc5]:\n> After Frederic already started with a structural review, I finally take some time to play with the code.\n> \n> Here is the list of points I want to mention concerning the documentation:\n> \n> * The documentation start is too technical for my taste, containing many implementation details. I suggest to start with a brief description (or links) to what cluster algebras are + (even more importantly) followed by the later provided good examples. Only after, there should be a description of the algorithms used (I personally would even prefer to be pointed to the exact theorem) + the details of the implementation you give.\n\nI am okay with having the module-level documentation being somewhat technical. However, I strongly think the main bulk of the documentation should be at the class-level for `ClusterAlgebra` (with the `__init__` only being a short 1-line and `TESTS::` with a (few) `TestSuite(C).run()` calls). This way the user can get it by `ClusterAlgebra?`.\n\n> * I agree with Frederic's \"I have [...] bad feeling about your way to add methods only in special cases\". Often, this is solved raising a `NotImplementedError`. On the other hand, I hate those errors and would often prefer if I rather not have a given method...\n\nI would recommend using ``@`abstract_method` (if optional to implement, you can do ``@`abstract_method(optional=True)`). While it doesn't remove the method if it is not implemented, it does prevent the user from looking at its doc (and the TestSuite` will fail if such a method is found).",
    "created_at": "2016-10-21T14:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291133",
    "user": "tscrim"
}
```

Replying to [comment:27 stumpc5]:
> After Frederic already started with a structural review, I finally take some time to play with the code.
> 
> Here is the list of points I want to mention concerning the documentation:
> 
> * The documentation start is too technical for my taste, containing many implementation details. I suggest to start with a brief description (or links) to what cluster algebras are + (even more importantly) followed by the later provided good examples. Only after, there should be a description of the algorithms used (I personally would even prefer to be pointed to the exact theorem) + the details of the implementation you give.

I am okay with having the module-level documentation being somewhat technical. However, I strongly think the main bulk of the documentation should be at the class-level for `ClusterAlgebra` (with the `__init__` only being a short 1-line and `TESTS::` with a (few) `TestSuite(C).run()` calls). This way the user can get it by `ClusterAlgebra?`.

> * I agree with Frederic's "I have [...] bad feeling about your way to add methods only in special cases". Often, this is solved raising a `NotImplementedError`. On the other hand, I hate those errors and would often prefer if I rather not have a given method...

I would recommend using ``@`abstract_method` (if optional to implement, you can do ``@`abstract_method(optional=True)`). While it doesn't remove the method if it is not implemented, it does prevent the user from looking at its doc (and the TestSuite` will fail if such a method is found).



---

archive/issue_comments_291134.json:
```json
{
    "body": "Also the `ALGORITHM:` should not be indented.",
    "created_at": "2016-10-21T14:14:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291134",
    "user": "tscrim"
}
```

Also the `ALGORITHM:` should not be indented.



---

archive/issue_comments_291135.json:
```json
{
    "body": "Replying to [comment:29 tscrim]:\n> I am okay with having the module-level documentation being somewhat technical.\n\nThe problem then is that looking at the html documentation might scare users to further look.",
    "created_at": "2016-10-21T14:29:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291135",
    "user": "stumpc5"
}
```

Replying to [comment:29 tscrim]:
> I am okay with having the module-level documentation being somewhat technical.

The problem then is that looking at the html documentation might scare users to further look.



---

archive/issue_comments_291136.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-06T18:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291136",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291137.json:
```json
{
    "body": "Thanks everybody for the in depth comments and sorry for taking so long to\nreply. \n\nI just updated the code implementing most of your suggestions. Here are some\nextra remarks:\n\n* xrange has been removed\n\n* several indentations has been fixed in the documentation\n\n* implementing index_set is probably a good idea but I might prefer to get first\n  a positive review on this. I already know how this should be implemented and\n  it will not take much.\n \n* as far as the manipulation of `__doc__` I am posting a request for comments on\n  sage-devel to see what is the general consensus on how to best implement this.\n\n* same holds for methods not always defined\n\n* brackets inside `prod()` and `dict()` has been removed\n\n* `F_polynomials` is now implemented as an iterator\n\n* I am not implementing c-vectors at this stage because, as the code is\n  structured right now, we do not keep track of them. A future patch will\n  address the issue of storing and producing exchange relations; c-vectors\n  belong to that\n\n* `d_vectors`: I did not implement it yet but it is easily doable. This raises a\n  question concerning `cluster_variables` and `F_polynomials`.\n  These, as `d_vectors` would be, are simple syntactic sugar around a `map`. For\n  example `cluster_variables` is the same as\n  {{{\n  sage: map(A.cluster_variable, A.g_vectors())\n  }}}\n  is it worth implementing such methods or should we just get rid of them?\n  Pros: less code to maintain!\n  Cons: users might be scared?\n\nNow to the more serious issue: I tried implementing Travis's suggestion about\ndocumentation and I ran into some issues with `TestSuite` that I can't wrap my\nhead around. It looks like instances of neither `ClusterAlgebraElement` nor\n`ClusterAlgebraSees` can't be dumped with `dumps`. \n\n```\nsage: A = ClusterAlgebra(['B',4])\nsage: x = A.initial_cluster_variable(0)\nsage: S = A.current_seed()\nsage: from six.moves import cPickle\nsage: cPickle.dumps(x, protocol=2)\n---------------------------------------------------------------------------\nPicklingError                             Traceback (most recent call last)\n<ipython-input-7-78bafcb24ef1> in <module>()\n----> 1 cPickle.dumps(x, protocol=Integer(2))\n\nPicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed\nsage: cPickle.dumps(S, protocol=2)\n---------------------------------------------------------------------------\nPicklingError                             Traceback (most recent call last)\n<ipython-input-8-77bd4c9405ba> in <module>()\n----> 1 cPickle.dumps(S, protocol=Integer(2))\n\nPicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed\n```\n\n\nWhere am I being stupid?",
    "created_at": "2016-11-06T18:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291137",
    "user": "etn40ff"
}
```

Thanks everybody for the in depth comments and sorry for taking so long to
reply. 

I just updated the code implementing most of your suggestions. Here are some
extra remarks:

* xrange has been removed

* several indentations has been fixed in the documentation

* implementing index_set is probably a good idea but I might prefer to get first
  a positive review on this. I already know how this should be implemented and
  it will not take much.
 
* as far as the manipulation of `__doc__` I am posting a request for comments on
  sage-devel to see what is the general consensus on how to best implement this.

* same holds for methods not always defined

* brackets inside `prod()` and `dict()` has been removed

* `F_polynomials` is now implemented as an iterator

* I am not implementing c-vectors at this stage because, as the code is
  structured right now, we do not keep track of them. A future patch will
  address the issue of storing and producing exchange relations; c-vectors
  belong to that

* `d_vectors`: I did not implement it yet but it is easily doable. This raises a
  question concerning `cluster_variables` and `F_polynomials`.
  These, as `d_vectors` would be, are simple syntactic sugar around a `map`. For
  example `cluster_variables` is the same as
  {{{
  sage: map(A.cluster_variable, A.g_vectors())
  }}}
  is it worth implementing such methods or should we just get rid of them?
  Pros: less code to maintain!
  Cons: users might be scared?

Now to the more serious issue: I tried implementing Travis's suggestion about
documentation and I ran into some issues with `TestSuite` that I can't wrap my
head around. It looks like instances of neither `ClusterAlgebraElement` nor
`ClusterAlgebraSees` can't be dumped with `dumps`. 

```
sage: A = ClusterAlgebra(['B',4])
sage: x = A.initial_cluster_variable(0)
sage: S = A.current_seed()
sage: from six.moves import cPickle
sage: cPickle.dumps(x, protocol=2)
---------------------------------------------------------------------------
PicklingError                             Traceback (most recent call last)
<ipython-input-7-78bafcb24ef1> in <module>()
----> 1 cPickle.dumps(x, protocol=Integer(2))

PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed
sage: cPickle.dumps(S, protocol=2)
---------------------------------------------------------------------------
PicklingError                             Traceback (most recent call last)
<ipython-input-8-77bd4c9405ba> in <module>()
----> 1 cPickle.dumps(S, protocol=Integer(2))

PicklingError: Can't pickle <type 'function'>: attribute lookup __builtin__.function failed
```


Where am I being stupid?



---

archive/issue_comments_291138.json:
```json
{
    "body": "You don't have a pickling protocol implemented for the parent. Actually, I don't see why you aren't using `UniqueRepresentation`. Also, instead of manually setting the methods, you should use a subclass and dynamically set the `Element` of `ClusterAlgebra`.",
    "created_at": "2016-11-06T21:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291138",
    "user": "tscrim"
}
```

You don't have a pickling protocol implemented for the parent. Actually, I don't see why you aren't using `UniqueRepresentation`. Also, instead of manually setting the methods, you should use a subclass and dynamically set the `Element` of `ClusterAlgebra`.



---

archive/issue_comments_291139.json:
```json
{
    "body": "Thanks, I will move `ClusterAlgebra` to `UniqueRepresentation` and test if there are no undesired side effects. I am not sure myself why we did not do it earlier; we might have had reasons but I can't remember them right now.\n\nWhich methods are you referring to? Isn't enough to set `Element = ClusterAlgebraElement` inside `ClusterAlgebra`?",
    "created_at": "2016-11-06T21:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291139",
    "user": "etn40ff"
}
```

Thanks, I will move `ClusterAlgebra` to `UniqueRepresentation` and test if there are no undesired side effects. I am not sure myself why we did not do it earlier; we might have had reasons but I can't remember them right now.

Which methods are you referring to? Isn't enough to set `Element = ClusterAlgebraElement` inside `ClusterAlgebra`?



---

archive/issue_comments_291140.json:
```json
{
    "body": "Replying to [comment:35 etn40ff]:\n> Which methods are you referring to? Isn't enough to set `Element = ClusterAlgebraElement` inside `ClusterAlgebra`?\n\nYou can do it in the `__init__` as long as you do it before you make the call to `Parent.__init__`.",
    "created_at": "2016-11-06T21:46:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291140",
    "user": "tscrim"
}
```

Replying to [comment:35 etn40ff]:
> Which methods are you referring to? Isn't enough to set `Element = ClusterAlgebraElement` inside `ClusterAlgebra`?

You can do it in the `__init__` as long as you do it before you make the call to `Parent.__init__`.



---

archive/issue_comments_291141.json:
```json
{
    "body": "Ok now I remember why we ended up not using `UniqueRepresentation`: in many (read \"in every one I can think of\") cases we want to be able to invoke  `ClusterAlgebra` on non hashable arguments.",
    "created_at": "2016-11-06T21:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291141",
    "user": "etn40ff"
}
```

Ok now I remember why we ended up not using `UniqueRepresentation`: in many (read "in every one I can think of") cases we want to be able to invoke  `ClusterAlgebra` on non hashable arguments.



---

archive/issue_comments_291142.json:
```json
{
    "body": "Sorry I am particularly slow with understanding tonight. \n\nAre you saying that instead of using `MethodType` in the cases when I want them\nI should define a subclass containing also the extra methods and dynamically\npick the right one in __init__? \nI am not sure this will work in both cases: I can see how it will help for the\nextra methods in `ClusterAlgebraElement` but how do you make it work for the\nextra methods in `ClusterAlgebra`?\nThe only way I see is to introduce a factory but I would really prefer to\navoid doing that.",
    "created_at": "2016-11-06T22:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291142",
    "user": "etn40ff"
}
```

Sorry I am particularly slow with understanding tonight. 

Are you saying that instead of using `MethodType` in the cases when I want them
I should define a subclass containing also the extra methods and dynamically
pick the right one in __init__? 
I am not sure this will work in both cases: I can see how it will help for the
extra methods in `ClusterAlgebraElement` but how do you make it work for the
extra methods in `ClusterAlgebra`?
The only way I see is to introduce a factory but I would really prefer to
avoid doing that.



---

archive/issue_comments_291143.json:
```json
{
    "body": "What would be an example? For matrices, we can make an immutable copy or some other equivalent (hashable) data. Same for quivers. (At least I would think `ClusterAlgebraSeed` would fulfill this role.)",
    "created_at": "2016-11-06T22:20:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291143",
    "user": "tscrim"
}
```

What would be an example? For matrices, we can make an immutable copy or some other equivalent (hashable) data. Same for quivers. (At least I would think `ClusterAlgebraSeed` would fulfill this role.)



---

archive/issue_comments_291144.json:
```json
{
    "body": "Replying to [comment:38 etn40ff]:\n> Are you saying that instead of using `MethodType` in the cases when I want them\n> I should define a subclass containing also the extra methods and dynamically\n> pick the right one in __init__? \n> I am not sure this will work in both cases: I can see how it will help for the\n> extra methods in `ClusterAlgebraElement` but how do you make it work for the\n> extra methods in `ClusterAlgebra`?\n> The only way I see is to introduce a factory but I would really prefer to\n> avoid doing that.\n\nThis approach is not very readable (subsequently harder to debug) and strongly breaks encapsulation. So I am strongly against it. Also, I believe you should be using `UniqueRepresentation`, where the `__classcall(_private)__` can be used as a factory. Although you can just add the `ClasscallMetaclass` to get the same behavior to return the subclass.",
    "created_at": "2016-11-06T22:26:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291144",
    "user": "tscrim"
}
```

Replying to [comment:38 etn40ff]:
> Are you saying that instead of using `MethodType` in the cases when I want them
> I should define a subclass containing also the extra methods and dynamically
> pick the right one in __init__? 
> I am not sure this will work in both cases: I can see how it will help for the
> extra methods in `ClusterAlgebraElement` but how do you make it work for the
> extra methods in `ClusterAlgebra`?
> The only way I see is to introduce a factory but I would really prefer to
> avoid doing that.

This approach is not very readable (subsequently harder to debug) and strongly breaks encapsulation. So I am strongly against it. Also, I believe you should be using `UniqueRepresentation`, where the `__classcall(_private)__` can be used as a factory. Although you can just add the `ClasscallMetaclass` to get the same behavior to return the subclass.



---

archive/issue_comments_291145.json:
```json
{
    "body": "OK I might have found a way to make everyone happy. What about something like\nthis?\n\n\n```\nclass MyClass(Parent):\n    \n    def __init__(self):\n    \t# do something here\n    \tpass\n    \n    if somecondition:\n    \tdef method_not_always_defines(self):\n\t    # do something else here\n\t    pass\n\n    def method_always_defined(self):\n        # do nothing\n        pass\n```\n\n\nI do not know why I did not think of something of this sort before. The only thing I haven't figured out yet is whether it is possible for somecondition to be dependent on the argument with which `MyClass` is called.",
    "created_at": "2016-11-06T23:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291145",
    "user": "etn40ff"
}
```

OK I might have found a way to make everyone happy. What about something like
this?


```
class MyClass(Parent):
    
    def __init__(self):
    	# do something here
    	pass
    
    if somecondition:
    	def method_not_always_defines(self):
	    # do something else here
	    pass

    def method_always_defined(self):
        # do nothing
        pass
```


I do not know why I did not think of something of this sort before. The only thing I haven't figured out yet is whether it is possible for somecondition to be dependent on the argument with which `MyClass` is called.



---

archive/issue_comments_291146.json:
```json
{
    "body": "When I said non hashable I meant that they are not hashable on the nose but can be made hashable. Basically one would like to feed in anything that can be already interpreted by `ClusterQuiver` that take also non hashable inputs.",
    "created_at": "2016-11-06T23:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291146",
    "user": "etn40ff"
}
```

When I said non hashable I meant that they are not hashable on the nose but can be made hashable. Basically one would like to feed in anything that can be already interpreted by `ClusterQuiver` that take also non hashable inputs.



---

archive/issue_comments_291147.json:
```json
{
    "body": "Well the data you really want is `ClusterQuiver` or `ClusterSeed`, so you really should use `UniqueRepresentation` as it solves a number of problems.\n\ncomment:41 is better, but I'm still -1. Use subclasses.",
    "created_at": "2016-11-06T23:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291147",
    "user": "tscrim"
}
```

Well the data you really want is `ClusterQuiver` or `ClusterSeed`, so you really should use `UniqueRepresentation` as it solves a number of problems.

comment:41 is better, but I'm still -1. Use subclasses.



---

archive/issue_comments_291148.json:
```json
{
    "body": "Replying to [comment:33 etn40ff]:\n> * `d_vectors`: I did not implement it yet but it is easily doable. This raises a\n>   question concerning `cluster_variables` and `F_polynomials`.\n>   These, as `d_vectors` would be, are simple syntactic sugar around a `map`. For\n>   example `cluster_variables` is the same as\n>   {{{\n>   sage: map(A.cluster_variable, A.g_vectors())\n>   }}}\n>   is it worth implementing such methods or should we just get rid of them?\n>   Pros: less code to maintain!\n>   Cons: users might be scared?\n\nI prefer to look at the usage from, well, the user's perspective. And using\n\n```\nsage: map(A.cluster_variable, A.g_vectors())\n```\n\nimplies that I have understood already how the implementation works (or, at least, that I have read through the documentation). I'd therefore prefer to have explicit methods providing all sorts of data attached to a cluster seed (independent from how you handle the seed internally).\n\nJust my 2 cents, it's your code so it's your decision what to provide how...",
    "created_at": "2016-11-07T14:42:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291148",
    "user": "stumpc5"
}
```

Replying to [comment:33 etn40ff]:
> * `d_vectors`: I did not implement it yet but it is easily doable. This raises a
>   question concerning `cluster_variables` and `F_polynomials`.
>   These, as `d_vectors` would be, are simple syntactic sugar around a `map`. For
>   example `cluster_variables` is the same as
>   {{{
>   sage: map(A.cluster_variable, A.g_vectors())
>   }}}
>   is it worth implementing such methods or should we just get rid of them?
>   Pros: less code to maintain!
>   Cons: users might be scared?

I prefer to look at the usage from, well, the user's perspective. And using

```
sage: map(A.cluster_variable, A.g_vectors())
```

implies that I have understood already how the implementation works (or, at least, that I have read through the documentation). I'd therefore prefer to have explicit methods providing all sorts of data attached to a cluster seed (independent from how you handle the seed internally).

Just my 2 cents, it's your code so it's your decision what to provide how...



---

archive/issue_comments_291149.json:
```json
{
    "body": "Replying to [comment:43 tscrim]:\n> Well the data you really want is `ClusterQuiver` or `ClusterSeed`, so you really should use `UniqueRepresentation` as it solves a number of problems.\n> \n> comment:41 is better, but I'm still -1. Use subclasses.\n\nI will give it a try with `UniqueRepresentation` and report back when I am done. \nI am unfortunately quite short on time for sage lately so this may take a while.\n\nAs for subclasses I am quite against the idea because I will, hopefully soon,\nadd more methods defined only in certain cases and I would have to make a lot of\nclasses just to mix and match all the possibilities. I posted a reply on\nsage-devel on this and I might just define the methods in any case and have them\nraise and error when they are meaningless. Unless of course someone suggests\na better idea.",
    "created_at": "2016-11-14T21:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291149",
    "user": "etn40ff"
}
```

Replying to [comment:43 tscrim]:
> Well the data you really want is `ClusterQuiver` or `ClusterSeed`, so you really should use `UniqueRepresentation` as it solves a number of problems.
> 
> comment:41 is better, but I'm still -1. Use subclasses.

I will give it a try with `UniqueRepresentation` and report back when I am done. 
I am unfortunately quite short on time for sage lately so this may take a while.

As for subclasses I am quite against the idea because I will, hopefully soon,
add more methods defined only in certain cases and I would have to make a lot of
classes just to mix and match all the possibilities. I posted a reply on
sage-devel on this and I might just define the methods in any case and have them
raise and error when they are meaningless. Unless of course someone suggests
a better idea.



---

archive/issue_comments_291150.json:
```json
{
    "body": "With the current code, you should use subclasses. In the future, for the more corner case situations, I would then raise a `TypeError` when the particular method does not apply. I should have some time next week during the Sage Days to attack things if you'd want me to.",
    "created_at": "2016-11-15T00:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291150",
    "user": "tscrim"
}
```

With the current code, you should use subclasses. In the future, for the more corner case situations, I would then raise a `TypeError` when the particular method does not apply. I should have some time next week during the Sage Days to attack things if you'd want me to.



---

archive/issue_comments_291151.json:
```json
{
    "body": "Replying to [comment:46 tscrim]:\n>I should have some time next week during the Sage Days to attack things if you'd want me to.\n\nI played a little with `UniqueRepresentation` and there are some issues arising from `mutate_initial` (and `mutate`).\nIf your offer still holds I would be happy to talk any time this week except for Thursday.",
    "created_at": "2016-11-21T17:29:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291151",
    "user": "etn40ff"
}
```

Replying to [comment:46 tscrim]:
>I should have some time next week during the Sage Days to attack things if you'd want me to.

I played a little with `UniqueRepresentation` and there are some issues arising from `mutate_initial` (and `mutate`).
If your offer still holds I would be happy to talk any time this week except for Thursday.



---

archive/issue_comments_291152.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-22T08:45:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291152",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291153.json:
```json
{
    "body": "I've used subclasses for the elements to begin with and done my pass over the documentation. ~~I'm doing the subclasses for the parents next, which should be pushed in minute.~~ Correction: That will likely depend on how the `ClusterAlgebra` class changes with `UniqueRepresentation`, which I can't really do until I understand the difference below.\n\nI don't understand why we need the `ClusterAlgebraSeed` when it seems like all of that functionality is (essentially) done by `ClusterSeed`.\n\nI would appreciate some time to Skype at some point today or tomorrow (I'm 1 hour ahead from Paris time I believe) to go over things. We can set that up over e-mail.",
    "created_at": "2016-11-22T08:50:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291153",
    "user": "tscrim"
}
```

I've used subclasses for the elements to begin with and done my pass over the documentation. ~~I'm doing the subclasses for the parents next, which should be pushed in minute.~~ Correction: That will likely depend on how the `ClusterAlgebra` class changes with `UniqueRepresentation`, which I can't really do until I understand the difference below.

I don't understand why we need the `ClusterAlgebraSeed` when it seems like all of that functionality is (essentially) done by `ClusterSeed`.

I would appreciate some time to Skype at some point today or tomorrow (I'm 1 hour ahead from Paris time I believe) to go over things. We can set that up over e-mail.



---

archive/issue_comments_291154.json:
```json
{
    "body": "Thanks for your work.\n\nReplying to [comment:49 tscrim]:\n> I would appreciate some time to Skype at some point today or tomorrow (I'm 1 hour ahead from Paris time I believe) to go over things. We can set that up over e-mail.\n\nToday would be great; I am currently queuing in some office but I should be available any time from 13 onwards (Paris time). My Skype username is etn40ff\n\nHold on for `ClusterAlgebraSeed` I'll explain on the phone.",
    "created_at": "2016-11-22T11:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291154",
    "user": "etn40ff"
}
```

Thanks for your work.

Replying to [comment:49 tscrim]:
> I would appreciate some time to Skype at some point today or tomorrow (I'm 1 hour ahead from Paris time I believe) to go over things. We can set that up over e-mail.

Today would be great; I am currently queuing in some office but I should be available any time from 13 onwards (Paris time). My Skype username is etn40ff

Hold on for `ClusterAlgebraSeed` I'll explain on the phone.



---

archive/issue_comments_291155.json:
```json
{
    "body": "Replying to [comment:50 etn40ff]:\n> hold on for `ClusterAlgebraSeed` I'll explain on the phone.\n\nplease post the transcript of the call here ;-)",
    "created_at": "2016-11-22T11:18:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291155",
    "user": "stumpc5"
}
```

Replying to [comment:50 etn40ff]:
> hold on for `ClusterAlgebraSeed` I'll explain on the phone.

please post the transcript of the call here ;-)



---

archive/issue_comments_291156.json:
```json
{
    "body": "Replying to [comment:51 stumpc5]:\n> Replying to [comment:50 etn40ff]:\n> > hold on for `ClusterAlgebraSeed` I'll explain on the phone.\n> \n> please post the transcript of the call here ;-)\n\nMight be hard, do you want to join?",
    "created_at": "2016-11-22T11:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291156",
    "user": "etn40ff"
}
```

Replying to [comment:51 stumpc5]:
> Replying to [comment:50 etn40ff]:
> > hold on for `ClusterAlgebraSeed` I'll explain on the phone.
> 
> please post the transcript of the call here ;-)

Might be hard, do you want to join?



---

archive/issue_comments_291157.json:
```json
{
    "body": "Replying to [comment:52 etn40ff]:\n> Replying to [comment:51 stumpc5]:\n> > Replying to [comment:50 etn40ff]:\n> > > hold on for `ClusterAlgebraSeed` I'll explain on the phone.\n> > \n> > please post the transcript of the call here ;-)\n> \n> Might be hard, do you want to join?\n\ni was just kidding, sorry.",
    "created_at": "2016-11-22T11:30:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291157",
    "user": "stumpc5"
}
```

Replying to [comment:52 etn40ff]:
> Replying to [comment:51 stumpc5]:
> > Replying to [comment:50 etn40ff]:
> > > hold on for `ClusterAlgebraSeed` I'll explain on the phone.
> > 
> > please post the transcript of the call here ;-)
> 
> Might be hard, do you want to join?

i was just kidding, sorry.



---

archive/issue_comments_291158.json:
```json
{
    "body": "Replying to [comment:53 stumpc5]:\n> Replying to [comment:52 etn40ff]:\n> > Replying to [comment:51 stumpc5]:\n> > > Replying to [comment:50 etn40ff]:\n> > > > hold on for `ClusterAlgebraSeed` I'll explain on the phone.\n> > > \n> > > please post the transcript of the call here ;-)\n> > \n> > Might be hard, do you want to join?\n> \n> i was just kidding, sorry.\nI was not: constructive input is always welcome :)\n\nI'll post a summary afterward",
    "created_at": "2016-11-22T11:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291158",
    "user": "etn40ff"
}
```

Replying to [comment:53 stumpc5]:
> Replying to [comment:52 etn40ff]:
> > Replying to [comment:51 stumpc5]:
> > > Replying to [comment:50 etn40ff]:
> > > > hold on for `ClusterAlgebraSeed` I'll explain on the phone.
> > > 
> > > please post the transcript of the call here ;-)
> > 
> > Might be hard, do you want to join?
> 
> i was just kidding, sorry.
I was not: constructive input is always welcome :)

I'll post a summary afterward



---

archive/issue_comments_291159.json:
```json
{
    "body": "Changing keywords from \"cluster algebras, SageDays64.5\" to \"cluster algebras, SageDays64.5, days79\".",
    "created_at": "2016-11-22T15:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291159",
    "user": "tscrim"
}
```

Changing keywords from "cluster algebras, SageDays64.5" to "cluster algebras, SageDays64.5, days79".



---

archive/issue_comments_291160.json:
```json
{
    "body": "Here is the short summary of our discussion:\n\n* We will replace `initial_mutate` by something called `change_initial_seed` (the name has not really been decided) to create a new cluster algebra using another seed `s` as initial data and copy the old data into the new cluster algebra using `s` (and its mutation sequence).\n\n* We will remove the decorator and implement the `UniqueRepresentation` behavior for `ClusterAlgebra`.\n\n* We will have the greedy element method as a method for all cluster algebras but raise a `NotImplementedError` for when it is not rank 2.",
    "created_at": "2016-11-22T15:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291160",
    "user": "tscrim"
}
```

Here is the short summary of our discussion:

* We will replace `initial_mutate` by something called `change_initial_seed` (the name has not really been decided) to create a new cluster algebra using another seed `s` as initial data and copy the old data into the new cluster algebra using `s` (and its mutation sequence).

* We will remove the decorator and implement the `UniqueRepresentation` behavior for `ClusterAlgebra`.

* We will have the greedy element method as a method for all cluster algebras but raise a `NotImplementedError` for when it is not rank 2.



---

archive/issue_comments_291161.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-23T22:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291161",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291162.json:
```json
{
    "body": "I started working on `UniqueRepresentation` and I think the prototype is ok. I did not touch `mutate_initial` yet.\n\nOne extremely weird issue: if you run\n\n```\nsage -b\nsage -t --long src/sage/algebras/cluster_algebra.py\nsage -t --long src/sage/algebras/cluster_algebra.py\n```\n\nthe first test will pass while the second will fail. It looks like the cache is not cleared in between tests. Ideas?",
    "created_at": "2016-11-23T22:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291162",
    "user": "etn40ff"
}
```

I started working on `UniqueRepresentation` and I think the prototype is ok. I did not touch `mutate_initial` yet.

One extremely weird issue: if you run

```
sage -b
sage -t --long src/sage/algebras/cluster_algebra.py
sage -t --long src/sage/algebras/cluster_algebra.py
```

the first test will pass while the second will fail. It looks like the cache is not cleared in between tests. Ideas?



---

archive/issue_comments_291163.json:
```json
{
    "body": "I cannot reproduce that behavior: I get 3 failures on every run.",
    "created_at": "2016-11-24T07:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291163",
    "user": "tscrim"
}
```

I cannot reproduce that behavior: I get 3 failures on every run.



---

archive/issue_comments_291164.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-24T11:42:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291164",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291165.json:
```json
{
    "body": "Ok `UniqueRepresentation` is now part of the code. Any comment?\n\nOne thing that bothers me is that we still can create different algebras that should be the same because the parsing of `cluster_variable_names` and symilar is done in `__init__` rather than in `__classcall__`.  Would there be drawbacks in moving these?",
    "created_at": "2016-11-24T11:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291165",
    "user": "etn40ff"
}
```

Ok `UniqueRepresentation` is now part of the code. Any comment?

One thing that bothers me is that we still can create different algebras that should be the same because the parsing of `cluster_variable_names` and symilar is done in `__init__` rather than in `__classcall__`.  Would there be drawbacks in moving these?



---

archive/issue_comments_291166.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-24T17:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291166",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291167.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-01-08T22:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291167",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291168.json:
```json
{
    "body": "I did not double check my reference to [NZ2012]. I linked it to: https://arxiv.org/abs/1101.3736",
    "created_at": "2017-01-08T23:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291168",
    "user": "egunawan"
}
```

I did not double check my reference to [NZ2012]. I linked it to: https://arxiv.org/abs/1101.3736



---

archive/issue_comments_291169.json:
```json
{
    "body": "Hi Emily,\n\nI think the fix you made for the references was not the correct one: if I am not mistaken the goal is to go towards a unified reference system. \n\nI created a new ticket to fix the duplication in `ClusterSeed` #22160 (which needs a quick review) and I will shortly update a new version of this branch to reflect the changes. \nOnce this is done this ticket will depend on #22160.",
    "created_at": "2017-01-09T17:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291169",
    "user": "etn40ff"
}
```

Hi Emily,

I think the fix you made for the references was not the correct one: if I am not mistaken the goal is to go towards a unified reference system. 

I created a new ticket to fix the duplication in `ClusterSeed` #22160 (which needs a quick review) and I will shortly update a new version of this branch to reflect the changes. 
Once this is done this ticket will depend on #22160.



---

archive/issue_comments_291170.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-01-09T17:55:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291170",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291171.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-01-09T21:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291171",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291172.json:
```json
{
    "body": "+Missing doctests in algebras/cluster_algebra.py: 74 / 75 = 98%",
    "created_at": "2017-01-13T21:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291172",
    "user": "chapoton"
}
```

+Missing doctests in algebras/cluster_algebra.py: 74 / 75 = 98%



---

archive/issue_comments_291173.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-01-14T00:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291173",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291174.json:
```json
{
    "body": "Thank you for catching this Fr\u00e9d\u00e9ric. I hope I added the test in the right place.",
    "created_at": "2017-01-14T00:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291174",
    "user": "etn40ff"
}
```

Thank you for catching this Frdric. I hope I added the test in the right place.



---

archive/issue_comments_291175.json:
```json
{
    "body": "Branch does no longer apply..\n\nThis has waited long enough..\n\nIf you rebase, I will run my bot, and give a positive review if some bot gives a green light and no other issue arise.",
    "created_at": "2017-02-14T15:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291175",
    "user": "chapoton"
}
```

Branch does no longer apply..

This has waited long enough..

If you rebase, I will run my bot, and give a positive review if some bot gives a green light and no other issue arise.



---

archive/issue_comments_291176.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2017-02-14T22:41:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291176",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_291177.json:
```json
{
    "body": "Thank you Fr\u00e9d\u00e9ric. I just rebased to the current develop and now it builds cleanly on my machine. Tests seems ok so far. I am starting my patchbot to run overnight.",
    "created_at": "2017-02-14T22:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291177",
    "user": "etn40ff"
}
```

Thank you Frdric. I just rebased to the current develop and now it builds cleanly on my machine. Tests seems ok so far. I am starting my patchbot to run overnight.



---

archive/issue_comments_291178.json:
```json
{
    "body": "ok, let it be",
    "created_at": "2017-02-15T12:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291178",
    "user": "chapoton"
}
```

ok, let it be



---

archive/issue_comments_291179.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-15T12:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291179",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_291180.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-17T22:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291180",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_291181.json:
```json
{
    "body": "On 32-bit:\n\n```\nsage -t --long src/sage/algebras/cluster_algebra.py\n1069**********************************************************************\n1070File \"src/sage/algebras/cluster_algebra.py\", line 712, in sage.algebras.cluster_algebra.ClusterAlgebraSeed.__hash__\n1071Failed example:\n1072    hash(S)\n1073Expected:\n1074    6108559638409052534\n1075Got:\n1076    1755906422\n1077**********************************************************************\n10781 item had failures:\n1079   1 of   4 in sage.algebras.cluster_algebra.ClusterAlgebraSeed.__hash__\n1080    [402 tests, 1 failure, 11.03 s]\n108\n```\n",
    "created_at": "2017-02-17T22:54:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291181",
    "user": "vbraun"
}
```

On 32-bit:

```
sage -t --long src/sage/algebras/cluster_algebra.py
1069**********************************************************************
1070File "src/sage/algebras/cluster_algebra.py", line 712, in sage.algebras.cluster_algebra.ClusterAlgebraSeed.__hash__
1071Failed example:
1072    hash(S)
1073Expected:
1074    6108559638409052534
1075Got:
1076    1755906422
1077**********************************************************************
10781 item had failures:
1079   1 of   4 in sage.algebras.cluster_algebra.ClusterAlgebraSeed.__hash__
1080    [402 tests, 1 failure, 11.03 s]
108
```




---

archive/issue_comments_291182.json:
```json
{
    "body": "On 64-bit it works. Which is the correct way to doctest hash functions\nindependently of the architecture?",
    "created_at": "2017-02-17T23:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291182",
    "user": "etn40ff"
}
```

On 64-bit it works. Which is the correct way to doctest hash functions
independently of the architecture?



---

archive/issue_comments_291183.json:
```json
{
    "body": "Copy and paste Volker's output with `# 32-bit` and `# 64-bit`. Although I prefer the softest that `hash(x) == hash(x)`.",
    "created_at": "2017-02-17T23:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291183",
    "user": "tscrim"
}
```

Copy and paste Volker's output with `# 32-bit` and `# 64-bit`. Although I prefer the softest that `hash(x) == hash(x)`.



---

archive/issue_comments_291184.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-17T23:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291184",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_291185.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-02-17T23:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291185",
    "user": "etn40ff"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_291186.json:
```json
{
    "body": "Done, thanks. I am setting this back to positive review because I do not have a 32-bit machine to test.",
    "created_at": "2017-02-17T23:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291186",
    "user": "etn40ff"
}
```

Done, thanks. I am setting this back to positive review because I do not have a 32-bit machine to test.



---

archive/issue_comments_291187.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-02-23T12:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21017",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21017#issuecomment-291187",
    "user": "vbraun"
}
```

Resolution: fixed
