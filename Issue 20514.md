# Issue 20514: Check easy invariants first for simplicial complex isomorphism

archive/issues_020514.json:
```json
{
    "body": "Assignee: @tscrim\n\nCC:  @jhpalmieri jeremy.l.martin\n\nKeywords: days74\n\nIn order to more quickly check if two simplicial complexes are not isomorphic, we should check that their (ordered) facet dimension sequences agree.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20751\n\n",
    "created_at": "2016-06-01T14:03:49Z",
    "labels": [
        "algebraic topology",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Check easy invariants first for simplicial complex isomorphism",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20514",
    "user": "@tscrim"
}
```
Assignee: @tscrim

CC:  @jhpalmieri jeremy.l.martin

Keywords: days74

In order to more quickly check if two simplicial complexes are not isomorphic, we should check that their (ordered) facet dimension sequences agree.

Issue created by migration from https://trac.sagemath.org/ticket/20751





---

archive/issue_comments_283328.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-06-01T14:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283328",
    "user": "@tscrim"
}
```

New commits:



---

archive/issue_comments_283329.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-01T14:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283329",
    "user": "@tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_283330.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-01T14:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283330",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283331.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-01T14:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283331",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283332.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-01T14:19:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283332",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283333.json:
```json
{
    "body": "I think the initial checks can slow things down. Actually, if two complexes are not isomorphic for \"obvious\" reasons, it is now much faster (by a factor of 40 on my machine) to check that they are not, but if they are actually isomorphic, it is slower (by a factor of 2) to check that. For these timings, I used the complexes `Z1`, `Z2`, `Z3` from the doctests, and ran\n\n```\n%timeit Z1.is_isomorphic(Z2)  # True\n%timeit Z1.is_isomorphic(Z3)  # False\n```\n",
    "created_at": "2016-06-09T19:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283333",
    "user": "@jhpalmieri"
}
```

I think the initial checks can slow things down. Actually, if two complexes are not isomorphic for "obvious" reasons, it is now much faster (by a factor of 40 on my machine) to check that they are not, but if they are actually isomorphic, it is slower (by a factor of 2) to check that. For these timings, I used the complexes `Z1`, `Z2`, `Z3` from the doctests, and ran

```
%timeit Z1.is_isomorphic(Z2)  # True
%timeit Z1.is_isomorphic(Z3)  # False
```




---

archive/issue_comments_283334.json:
```json
{
    "body": "It is not the initial checks that are slowing it down, it is the additional check(s) of edge labels for the graph isomorphism. The additional checks are very small (< 1%) in comparison to the isomorphism check (both with and without edge label checks), which you can see via\n\n```\n%lprun -f X.is_isomorphic X.is_isomorphic(X)\n```\n\nHowever, Jeremy found it necessary to check the edge labels, at least when we want the certificate. Yet we don't have an example where there is not an isomorphism but the graphs are isomorphic without preserving edge labels. So it might be feasible that we don't need to check the edge labels in that case...",
    "created_at": "2016-06-11T13:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283334",
    "user": "@tscrim"
}
```

It is not the initial checks that are slowing it down, it is the additional check(s) of edge labels for the graph isomorphism. The additional checks are very small (< 1%) in comparison to the isomorphism check (both with and without edge label checks), which you can see via

```
%lprun -f X.is_isomorphic X.is_isomorphic(X)
```

However, Jeremy found it necessary to check the edge labels, at least when we want the certificate. Yet we don't have an example where there is not an isomorphism but the graphs are isomorphic without preserving edge labels. So it might be feasible that we don't need to check the edge labels in that case...



---

archive/issue_comments_283335.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-13T17:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283335",
    "user": "@jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_283336.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-14T07:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283336",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_283337.json:
```json
{
    "body": "Exactly what is this doctest supposed to test?\n\n```\n        We check that :trac:`20751` is fixed::\n\n            sage: C1 = SimplicialComplex([[1,2,3], [1,2,4], [1,3,4]])\n            sage: C2 = SimplicialComplex([['j','k','l'], ['j','l','m'], ['j','k','m']])\n            sage: C1.is_isomorphic(C2, certificate=True)\n            (True, {1: 'j', 2: 'k', 3: 'l', 4: 'm'})\n```\n\n\nI am asking because the output is not unique (one can exchange vertices 2, 3 and 4).",
    "created_at": "2019-01-07T13:34:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283337",
    "user": "@jdemeyer"
}
```

Exactly what is this doctest supposed to test?

```
        We check that :trac:`20751` is fixed::

            sage: C1 = SimplicialComplex([[1,2,3], [1,2,4], [1,3,4]])
            sage: C2 = SimplicialComplex([['j','k','l'], ['j','l','m'], ['j','k','m']])
            sage: C1.is_isomorphic(C2, certificate=True)
            (True, {1: 'j', 2: 'k', 3: 'l', 4: 'm'})
```


I am asking because the output is not unique (one can exchange vertices 2, 3 and 4).



---

archive/issue_comments_283338.json:
```json
{
    "body": "I'll update that test to one with a unique output at #27027.",
    "created_at": "2019-01-07T13:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283338",
    "user": "@jdemeyer"
}
```

I'll update that test to one with a unique output at #27027.



---

archive/issue_comments_283339.json:
```json
{
    "body": "I believe the `fake_vertex` was getting added to the certificate in that test before this ticket.",
    "created_at": "2019-01-07T17:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283339",
    "user": "@tscrim"
}
```

I believe the `fake_vertex` was getting added to the certificate in that test before this ticket.



---

archive/issue_comments_283340.json:
```json
{
    "body": "Thanks for the info. So it shouldn't be a problem to replace that test with a different one.",
    "created_at": "2019-01-08T09:12:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20514",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20514#issuecomment-283340",
    "user": "@jdemeyer"
}
```

Thanks for the info. So it shouldn't be a problem to replace that test with a different one.
