# Issue 23787: Update other packages to using the sage-dist-helpers functions where applicable

Issue created by migration from Trac.

Original creator: embray

Original creation time: 2017-10-12 15:00:05

This is a meta-ticket for tickets that address updating other packages to use the helper functions in `sage-dist-helpers` where possible.  There are
a few advantages to doing this:

* In general it simplifies these scripts and reduces a lot of boilerplate.  As more functions get written even more boilerplate can be removed, but even the existing functions help a lot.
* Although this requires irritating bulk updates to packages now, it reduces the overall need for such bulk updates in the future, since many packages that have similar build and installation steps can be be updated at once by updates to the applicable helper functions.

The second bullet point is especially motivated right now by #22509.  Since it requires updates to nearly every package in Sage anyways, it makes more sense to update most packages to use the helper functions, and then add `DESTDIR` support through the helper functions.  In particular, the vast majority of Python and autotools packages can be given `DESTDIR` support en masse by this approach.

* #24014 -- Update Python packages that are installed with `pip` to use `sdh_pip_install`
* #????? -- Update "trival" autotools packages to use `sdh_configure`, `sdh_make`, and `sdh_install`.  By "trivial" I mean packages with very simple build scripts that can be mechanically updated with simple replacements.
* #????? -- Update "trickier" autotools packages that take a little extra care for some reason.  I'm not even sure if there are any like this yet.
* #????? -- Handle miscellaneous non-autotools packages.  There are some like this that may still be applicable (e.g. they don't use `configure` but they still use `make` in such a way that can be replaced with `sdh_make`).  It might also be possible to narrow down one or two other classes of packages that can be simplified with new helper functions.


---

Comment by embray created at 2017-10-12 15:00:13

Set assignee to embray.


---

Comment by embray created at 2017-10-12 15:26:31

Note that for #22509 there will have be a second round of updates to DESTDIR support for some packages that manually copy files to locations in `$SAGE_LOCAL`.  However, making these updates first still significantly reduces that number of packages that will require additional treatment.


---

Comment by embray created at 2018-02-02 14:46:59

Added classifications to several of the packages that still need to be converted over to sdh-helpers/SAGE_DESTDIR support.  Still not an exhaustive list.


---

Comment by jdemeyer created at 2018-03-19 11:35:44

cysignals should be easy... it is only unusual because it uses autoconf in a Python package but `sdh_configure` should just work anyway.


---

Comment by embray created at 2018-03-19 12:01:33

Replying to [comment:8 jdemeyer]:
> cysignals should be easy... it is only unusual because it uses autoconf in a Python package but `sdh_configure` should just work anyway.

Indeed.  Most of them _are_ easy and are already done in my old branch for this.  The only reason many of these packages were separated out from #24025 is that they required one or two more other changes.


---

Comment by embray created at 2018-03-26 11:29:34

At this point, now that DESTDIR support _is_ available, there's no reason not to handle adding DESTDIR support, at least at a basic level, at the same time as implementing use of sage-dist-helpers.


---

Comment by embray created at 2018-04-03 09:32:07

`zn_poly` is _not_ autotools.


---

Comment by embray created at 2018-12-20 14:13:57

Working on DESTDIR install for gap_packages as part of #26856.


---

Comment by embray created at 2018-12-28 14:09:23

Retargeting some of my tickets.


---

Comment by embray created at 2019-01-10 12:29:18

gdb already done in #24692


---

Comment by embray created at 2019-01-10 13:17:43

tides was done in #26021


---

Comment by embray created at 2019-01-10 13:38:04

Changing status from new to needs_review.


---

Comment by embray created at 2019-01-10 13:38:16

Changing status from needs_review to needs_work.


---

Comment by embray created at 2019-01-10 13:38:16

This should really be in needs work status.


---

Comment by embray created at 2019-06-14 14:50:27

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.
