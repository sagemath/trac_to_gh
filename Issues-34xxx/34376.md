# Issue 34376: Set_object_enumerated should be in FiniteEnumeratedSets()

archive/issues_034139.json:
```json
{
    "body": "\n```\nsage: Set([0, 1, 2, 3])\n{0, 1, 2, 3}\nsage: _.category()\nCategory of finite sets\nsage: Set([0, 1, 2, 3], category=FiniteEnumeratedSets())\nTypeError: Set() got an unexpected keyword argument 'category'\n```\n\nLikewise for the `Set_object_binary` classes (which implement lazy union, intersection, ...), the category should be computed from the categories of the inputs.\n\nAlso we add a `category` argument to the `Set` factory and the `__init__` methods of the various implementation classes.\n\nFollow ups:\n- #34398 the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified\n- #34387 `Set()` should construct facade parents\n\nCC:  @tscrim\n\nBranch/Commit: e58d2abf9490496346fb4f114d98a9c9393a2b8d\n\nReviewer: Travis Scrimshaw\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34376\n\n",
    "closed_at": "2022-08-30T19:05:14Z",
    "created_at": "2022-08-16T20:36:15Z",
    "labels": [
        "component: categories",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Set_object_enumerated should be in FiniteEnumeratedSets()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34376",
    "user": "https://github.com/mkoeppe"
}
```

```
sage: Set([0, 1, 2, 3])
{0, 1, 2, 3}
sage: _.category()
Category of finite sets
sage: Set([0, 1, 2, 3], category=FiniteEnumeratedSets())
TypeError: Set() got an unexpected keyword argument 'category'
```

Likewise for the `Set_object_binary` classes (which implement lazy union, intersection, ...), the category should be computed from the categories of the inputs.

Also we add a `category` argument to the `Set` factory and the `__init__` methods of the various implementation classes.

Follow ups:
- #34398 the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified
- #34387 `Set()` should construct facade parents

CC:  @tscrim

Branch/Commit: e58d2abf9490496346fb4f114d98a9c9393a2b8d

Reviewer: Travis Scrimshaw

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34376





---

archive/issue_comments_684581.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,3 +6,6 @@\n Category of finite sets\n ```\n \n+Likewise for the `Set_object_binary` classes (which implement lazy union, intersection, ...), the category should be computed from the categories of the inputs\n+\n+Also the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified\n``````\n",
    "created_at": "2022-08-17T00:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684581",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,3 +6,6 @@
 Category of finite sets
 ```
 
+Likewise for the `Set_object_binary` classes (which implement lazy union, intersection, ...), the category should be computed from the categories of the inputs
+
+Also the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified
``````




---

archive/issue_comments_684582.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,8 +4,12 @@\n {0, 1, 2, 3}\n sage: _.category()\n Category of finite sets\n+sage: Set([0, 1, 2, 3], category=FiniteEnumeratedSets())\n+TypeError: Set() got an unexpected keyword argument 'category'\n ```\n \n-Likewise for the `Set_object_binary` classes (which implement lazy union, intersection, ...), the category should be computed from the categories of the inputs\n+Likewise for the `Set_object_binary` classes (which implement lazy union, intersection, ...), the category should be computed from the categories of the inputs.\n+\n+Also we add a `category` argument to the `Set` factory and the `__init__` methods of the various implementation classes.\n \n Also the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified\n``````\n",
    "created_at": "2022-08-17T17:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684582",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,8 +4,12 @@
 {0, 1, 2, 3}
 sage: _.category()
 Category of finite sets
+sage: Set([0, 1, 2, 3], category=FiniteEnumeratedSets())
+TypeError: Set() got an unexpected keyword argument 'category'
 ```
 
-Likewise for the `Set_object_binary` classes (which implement lazy union, intersection, ...), the category should be computed from the categories of the inputs
+Likewise for the `Set_object_binary` classes (which implement lazy union, intersection, ...), the category should be computed from the categories of the inputs.
+
+Also we add a `category` argument to the `Set` factory and the `__init__` methods of the various implementation classes.
 
 Also the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified
``````




---

archive/issue_comments_684583.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/set_object_enumerated_should_be_in_finiteenumeratedsets__\"",
    "created_at": "2022-08-17T18:47:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684583",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/set_object_enumerated_should_be_in_finiteenumeratedsets__"



---

archive/issue_comments_684584.json:
```json
{
    "body": "Changing commit from \"\" to \"b19a1ffe144f09f01aea3134630a2a8262c41c32\"",
    "created_at": "2022-08-17T18:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684584",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "b19a1ffe144f09f01aea3134630a2a8262c41c32"



---

archive/issue_comments_684585.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2022-08-17T18:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684585",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_comments_684586.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-08-17T18:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684586",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_684587.json:
```json
{
    "body": "Changing commit from \"b19a1ffe144f09f01aea3134630a2a8262c41c32\" to \"d461411617f8bca18f3e9575daaa3adf3bed1551\"",
    "created_at": "2022-08-17T20:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684587",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b19a1ffe144f09f01aea3134630a2a8262c41c32" to "d461411617f8bca18f3e9575daaa3adf3bed1551"



---

archive/issue_comments_684588.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-17T20:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684588",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_684589.json:
```json
{
    "body": "Changing commit from \"d461411617f8bca18f3e9575daaa3adf3bed1551\" to \"df327b9d5d76bc5b9807a937b7bb04ed334b60ae\"",
    "created_at": "2022-08-18T00:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684589",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d461411617f8bca18f3e9575daaa3adf3bed1551" to "df327b9d5d76bc5b9807a937b7bb04ed334b60ae"



---

archive/issue_comments_684590.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-18T00:26:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684590",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_684591.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-18T00:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684591",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_684592.json:
```json
{
    "body": "<a id='comment:8'></a>You shouldn't need the `cardinality()` method as that should be given by the category.\n\nYou can simplify these checks:\n\n```diff\n-        if all(S in Sets().Finite() for S in (X, Y)):\n-            category = category.Finite()\n         if all(S in Sets().Enumerated() for S in (X, Y)):\n             category = category.Enumerated()\n         if any(S in Sets().Infinite() for S in (X, Y)):\n             category = category.Infinite()\n+        elif all(S in Sets().Finite() for S in (X, Y)):\n+            category = category.Finite()\n         Set_object_binary.__init__(self, X, Y, \"union\", \"\\\\cup\", category=category)\n```\n\n```diff\n-        if X in Sets().Finite():\n-            category = category.Finite()\n         if X in Sets().Enumerated():\n             category = category.Enumerated()\n+        if X in Sets().Finite():\n+            category = category.Finite()\n+        elif X in Sets().Infinite() and Y in Sets().Finite():\n-        if X in Sets().Infinite() and Y in Sets().Finite():\n             category = category.Infinite()\n         Set_object_binary.__init__(self, X, Y, \"difference\", \"-\", category=category)\n```\n\nI am also slightly worried about this change:\n\n```diff\ndiff --git a/src/sage/categories/enumerated_sets.py b/src/sage/categories/enumerated_sets.py\nindex 563a802..e1dcbd8 100644\n--- a/src/sage/categories/enumerated_sets.py\n+++ b/src/sage/categories/enumerated_sets.py\n@@ -137,7 +137,7 @@ class EnumeratedSets(CategoryWithAxiom):\n             sage: S = EnumeratedSets()(Set([1, 2, 3])); S\n             {1, 2, 3}\n             sage: S.category()\n-            Category of facade finite enumerated sets\n+            Category of finite enumerated sets\n \n         Also Python3 range are now accepted::\n \n```\nCan you explain why this happened? I can't see the reason immediately from your changes.",
    "created_at": "2022-08-18T02:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684592",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>You shouldn't need the `cardinality()` method as that should be given by the category.

You can simplify these checks:

```diff
-        if all(S in Sets().Finite() for S in (X, Y)):
-            category = category.Finite()
         if all(S in Sets().Enumerated() for S in (X, Y)):
             category = category.Enumerated()
         if any(S in Sets().Infinite() for S in (X, Y)):
             category = category.Infinite()
+        elif all(S in Sets().Finite() for S in (X, Y)):
+            category = category.Finite()
         Set_object_binary.__init__(self, X, Y, "union", "\\cup", category=category)
```

```diff
-        if X in Sets().Finite():
-            category = category.Finite()
         if X in Sets().Enumerated():
             category = category.Enumerated()
+        if X in Sets().Finite():
+            category = category.Finite()
+        elif X in Sets().Infinite() and Y in Sets().Finite():
-        if X in Sets().Infinite() and Y in Sets().Finite():
             category = category.Infinite()
         Set_object_binary.__init__(self, X, Y, "difference", "-", category=category)
```

I am also slightly worried about this change:

```diff
diff --git a/src/sage/categories/enumerated_sets.py b/src/sage/categories/enumerated_sets.py
index 563a802..e1dcbd8 100644
--- a/src/sage/categories/enumerated_sets.py
+++ b/src/sage/categories/enumerated_sets.py
@@ -137,7 +137,7 @@ class EnumeratedSets(CategoryWithAxiom):
             sage: S = EnumeratedSets()(Set([1, 2, 3])); S
             {1, 2, 3}
             sage: S.category()
-            Category of facade finite enumerated sets
+            Category of finite enumerated sets
 
         Also Python3 range are now accepted::
 
```
Can you explain why this happened? I can't see the reason immediately from your changes.



---

archive/issue_comments_684593.json:
```json
{
    "body": "<a id='comment:9'></a>Thanks! I agree with these simplifications.\n\nI'll investigate how the facade got lost",
    "created_at": "2022-08-18T03:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684593",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>Thanks! I agree with these simplifications.

I'll investigate how the facade got lost



---

archive/issue_comments_684594.json:
```json
{
    "body": "<a id='comment:10'></a>By the way, should these `Set_object` parents all become facade parents?",
    "created_at": "2022-08-18T03:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684594",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>By the way, should these `Set_object` parents all become facade parents?



---

archive/issue_comments_684595.json:
```json
{
    "body": "<a id='comment:11'></a>I think so. All of the various constructions (e.g., `__iter__`, `list`, etc.) all return objects whose parent is not the `Set`.",
    "created_at": "2022-08-18T03:11:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684595",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>I think so. All of the various constructions (e.g., `__iter__`, `list`, etc.) all return objects whose parent is not the `Set`.



---

archive/issue_comments_684596.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [tscrim](#comment%3A8):\n> I am also slightly worried about this change:\n> \n> ```diff\n> diff --git a/src/sage/categories/enumerated_sets.py b/src/sage/categories/enumerated_sets.py\n> index 563a802..e1dcbd8 100644\n> --- a/src/sage/categories/enumerated_sets.py\n> +++ b/src/sage/categories/enumerated_sets.py\n> @@ -137,7 +137,7 @@ class EnumeratedSets(CategoryWithAxiom):\n>              sage: S = EnumeratedSets()(Set([1, 2, 3])); S\n>              {1, 2, 3}\n>              sage: S.category()\n> -            Category of facade finite enumerated sets\n> +            Category of finite enumerated sets\n>  \n>          Also Python3 range are now accepted::\n>  \n> ```\n> Can you explain why this happened?\n\n\nSet([1, 2, 3]) is already in `EnumeratedSets()`, so passing `EnumeratedSets._call_` does not have to construct another wrapper.",
    "created_at": "2022-08-18T03:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684596",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Replying to [tscrim](#comment%3A8):
> I am also slightly worried about this change:
> 
> ```diff
> diff --git a/src/sage/categories/enumerated_sets.py b/src/sage/categories/enumerated_sets.py
> index 563a802..e1dcbd8 100644
> --- a/src/sage/categories/enumerated_sets.py
> +++ b/src/sage/categories/enumerated_sets.py
> @@ -137,7 +137,7 @@ class EnumeratedSets(CategoryWithAxiom):
>              sage: S = EnumeratedSets()(Set([1, 2, 3])); S
>              {1, 2, 3}
>              sage: S.category()
> -            Category of facade finite enumerated sets
> +            Category of finite enumerated sets
>  
>          Also Python3 range are now accepted::
>  
> ```
> Can you explain why this happened?


Set([1, 2, 3]) is already in `EnumeratedSets()`, so passing `EnumeratedSets._call_` does not have to construct another wrapper.



---

archive/issue_comments_684597.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-18T03:33:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684597",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_684598.json:
```json
{
    "body": "Changing commit from \"df327b9d5d76bc5b9807a937b7bb04ed334b60ae\" to \"8a304931879a0ce4292d284439c8e717540755cf\"",
    "created_at": "2022-08-18T03:33:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684598",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "df327b9d5d76bc5b9807a937b7bb04ed334b60ae" to "8a304931879a0ce4292d284439c8e717540755cf"



---

archive/issue_comments_684599.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [tscrim](#comment%3A11):\n>> should these Set_object parents all become facade parents?\n\n> I think so. All of the various constructions (e.g., `__iter__`, `list`, etc.) all return objects whose parent is not the `Set`.\n\nI'll do this in #34387",
    "created_at": "2022-08-18T03:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684599",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Replying to [tscrim](#comment%3A11):
>> should these Set_object parents all become facade parents?

> I think so. All of the various constructions (e.g., `__iter__`, `list`, etc.) all return objects whose parent is not the `Set`.

I'll do this in #34387



---

archive/issue_comments_684600.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,6 @@\n \n Also we add a `category` argument to the `Set` factory and the `__init__` methods of the various implementation classes.\n \n-Also the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified\n+Follow ups:\n+- the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified\n+- #34387 `Set()` should construct facade parents\n``````\n",
    "created_at": "2022-08-18T03:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684600",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,6 @@
 
 Also we add a `category` argument to the `Set` factory and the `__init__` methods of the various implementation classes.
 
-Also the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified
+Follow ups:
+- the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified
+- #34387 `Set()` should construct facade parents
``````




---

archive/issue_comments_684601.json:
```json
{
    "body": "Changing commit from \"8a304931879a0ce4292d284439c8e717540755cf\" to \"8aa274ef877e4c987daa7d20fa761d2e5af94567\"",
    "created_at": "2022-08-18T03:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684601",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8a304931879a0ce4292d284439c8e717540755cf" to "8aa274ef877e4c987daa7d20fa761d2e5af94567"



---

archive/issue_comments_684602.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-18T03:47:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684602",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_684603.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [tscrim](#comment%3A8):\n> You shouldn't need the `cardinality()` method as that should be given by the category.\n\n\nThe new method `Set_object_intersection.cardinality` needs to override `Set_object.cardinality`.\n\nNow why exactly `Set_object_binary` subclasses `Set_object` is another question but not one for this ticket",
    "created_at": "2022-08-18T05:08:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684603",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'></a>Replying to [tscrim](#comment%3A8):
> You shouldn't need the `cardinality()` method as that should be given by the category.


The new method `Set_object_intersection.cardinality` needs to override `Set_object.cardinality`.

Now why exactly `Set_object_binary` subclasses `Set_object` is another question but not one for this ticket



---

archive/issue_comments_684604.json:
```json
{
    "body": "Changing commit from \"8aa274ef877e4c987daa7d20fa761d2e5af94567\" to \"d711a61aeacde364b4ab76b59e55c2f01d8a90d7\"",
    "created_at": "2022-08-18T05:50:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684604",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8aa274ef877e4c987daa7d20fa761d2e5af94567" to "d711a61aeacde364b4ab76b59e55c2f01d8a90d7"



---

archive/issue_comments_684605.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-18T05:50:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684605",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_684606.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [mkoeppe](#comment%3A17):\n> Replying to [tscrim](#comment%3A8):\n> > You shouldn't need the `cardinality()` method as that should be given by the category.\n\n> \n> The new method `Set_object_intersection.cardinality` needs to override `Set_object.cardinality`.\n\n\nAh, because of `Set_object`. Then we should change things in the base class. Perhaps `Set_object.is_finite()` should also test the category?",
    "created_at": "2022-08-19T01:30:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684606",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>Replying to [mkoeppe](#comment%3A17):
> Replying to [tscrim](#comment%3A8):
> > You shouldn't need the `cardinality()` method as that should be given by the category.

> 
> The new method `Set_object_intersection.cardinality` needs to override `Set_object.cardinality`.


Ah, because of `Set_object`. Then we should change things in the base class. Perhaps `Set_object.is_finite()` should also test the category?



---

archive/issue_comments_684607.json:
```json
{
    "body": "<a id='comment:20'></a>Good idea.",
    "created_at": "2022-08-19T01:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684607",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Good idea.



---

archive/issue_comments_684608.json:
```json
{
    "body": "Changing commit from \"d711a61aeacde364b4ab76b59e55c2f01d8a90d7\" to \"e58d2abf9490496346fb4f114d98a9c9393a2b8d\"",
    "created_at": "2022-08-19T01:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684608",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d711a61aeacde364b4ab76b59e55c2f01d8a90d7" to "e58d2abf9490496346fb4f114d98a9c9393a2b8d"



---

archive/issue_comments_684609.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-19T01:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684609",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_684610.json:
```json
{
    "body": "<a id='comment:22'></a>This ended up being a good test:\n\n```\nsage: X = S.difference(T); X\nSet-theoretic difference of Set of elements of Rational Field and Set of elements of Integer Ring\nsage: X.category()\nCategory of sets\n```\nbecause `QQ` does have a (canonical) enumeration that isn't recognized by Sage:\n\n```\nsage: QQ in EnumeratedSets()\nFalse\n```\nHowever, fixing that is for another ticket.",
    "created_at": "2022-08-20T05:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684610",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>This ended up being a good test:

```
sage: X = S.difference(T); X
Set-theoretic difference of Set of elements of Rational Field and Set of elements of Integer Ring
sage: X.category()
Category of sets
```
because `QQ` does have a (canonical) enumeration that isn't recognized by Sage:

```
sage: QQ in EnumeratedSets()
False
```
However, fixing that is for another ticket.



---

archive/issue_comments_684611.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2022-08-20T05:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684611",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_684612.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-20T05:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684612",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_684613.json:
```json
{
    "body": "<a id='comment:23'></a>Yes, I was briefly surprised by this one.",
    "created_at": "2022-08-20T06:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684613",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Yes, I was briefly surprised by this one.



---

archive/issue_comments_684614.json:
```json
{
    "body": "<a id='comment:24'></a>By the way, I'm a bit annoyed by `EnumeratedSets.ParentMethods.__getitem__` (which is the same as unrank). Do you think people use that at all?",
    "created_at": "2022-08-20T06:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684614",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>By the way, I'm a bit annoyed by `EnumeratedSets.ParentMethods.__getitem__` (which is the same as unrank). Do you think people use that at all?



---

archive/issue_comments_684615.json:
```json
{
    "body": "<a id='comment:25'></a>It is quite possible that people in combinatorics use it. For example, things like\n\n```\nsage: ASM = AlternatingSignMatrices(4)\nsage: ASM[1:3]\n[\n[0 1 0 0]  [1 0 0 0]\n[1 0 0 0]  [0 0 1 0]\n[0 0 1 0]  [0 1 0 0]\n[0 0 0 1], [0 0 0 1]\n]\n```\nshould call it (the implementation does a redirect to the category).",
    "created_at": "2022-08-20T06:12:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684615",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>It is quite possible that people in combinatorics use it. For example, things like

```
sage: ASM = AlternatingSignMatrices(4)
sage: ASM[1:3]
[
[0 1 0 0]  [1 0 0 0]
[1 0 0 0]  [0 0 1 0]
[0 0 1 0]  [0 1 0 0]
[0 0 0 1], [0 0 0 1]
]
```
should call it (the implementation does a redirect to the category).



---

archive/issue_comments_684616.json:
```json
{
    "body": "<a id='comment:26'></a>There's probably a better solution for getting this kind of syntax when it's convenient, maybe using a mixin class (like the mixin classes `Set_boolean_operators` etc.). Having it in the category feels a bit misplaced. \n\nAlso one could maybe have something like an `as_sequence` method that would return a `SequenceView` (and thus give [] and slicing), see #32100\n\nBut that's for another ticket. Thanks for the review!",
    "created_at": "2022-08-20T06:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684616",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>There's probably a better solution for getting this kind of syntax when it's convenient, maybe using a mixin class (like the mixin classes `Set_boolean_operators` etc.). Having it in the category feels a bit misplaced. 

Also one could maybe have something like an `as_sequence` method that would return a `SequenceView` (and thus give [] and slicing), see #32100

But that's for another ticket. Thanks for the review!



---

archive/issue_comments_684617.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,5 +13,5 @@\n Also we add a `category` argument to the `Set` factory and the `__init__` methods of the various implementation classes.\n \n Follow ups:\n-- the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified\n+- #34398 the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified\n - #34387 `Set()` should construct facade parents\n``````\n",
    "created_at": "2022-08-20T19:05:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684617",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,5 +13,5 @@
 Also we add a `category` argument to the `Set` factory and the `__init__` methods of the various implementation classes.
 
 Follow ups:
-- the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified
+- #34398 the relation between `Set_object_enumerated` and `FiniteEnumeratedSet` (and `TrivialFamily`, `EnumeratedFamily`) should be clarified
 - #34387 `Set()` should construct facade parents
``````




---

archive/issue_comments_684618.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [mkoeppe](#comment%3A26):\n> There's probably a better solution for getting this kind of syntax when it's convenient, maybe using a mixin class (like the mixin classes `Set_boolean_operators` etc.). Having it in the category feels a bit misplaced. \n\n\nThat would negate a fair part of the category framework, it removes the fact that an enumerated set should (generally) behave like a list, and essentially every `EnumeratedSet` would have this proposed mixin class (thus being a code smell for why isn't in the category).\n\n> But that's for another ticket. Thanks for the review!\n\n\nIndeed. No problem.",
    "created_at": "2022-08-21T23:55:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684618",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>Replying to [mkoeppe](#comment%3A26):
> There's probably a better solution for getting this kind of syntax when it's convenient, maybe using a mixin class (like the mixin classes `Set_boolean_operators` etc.). Having it in the category feels a bit misplaced. 


That would negate a fair part of the category framework, it removes the fact that an enumerated set should (generally) behave like a list, and essentially every `EnumeratedSet` would have this proposed mixin class (thus being a code smell for why isn't in the category).

> But that's for another ticket. Thanks for the review!


Indeed. No problem.



---

archive/issue_comments_684619.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-30T19:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684619",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_684620.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/set_object_enumerated_should_be_in_finiteenumeratedsets__\" to \"e58d2abf9490496346fb4f114d98a9c9393a2b8d\"",
    "created_at": "2022-08-30T19:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34376#issuecomment-684620",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/set_object_enumerated_should_be_in_finiteenumeratedsets__" to "e58d2abf9490496346fb4f114d98a9c9393a2b8d"



---

archive/issue_events_089443.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-30T19:05:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34376",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34376#event-89443"
}
```
