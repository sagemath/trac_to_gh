# Issue 34260: Implement northwest diagrams

archive/issues_034023.json:
```json
{
    "body": "Implement a class for diagrams (collections of cells `(i,j)` indexed by the natural numbers), and a class for diagrams with the northwest property. A diagram has the northwest property if the fact that `(i1, j1)` and `(i2,j2)` are in the diagram implies that the cell `(min(i1,i2), min(j1,j2))` are in the diagram.\n\nAssignee: @trevorkarn\n\nCC:  @tscrim\n\nKeywords: gsoc2022 northwest-diagram\n\nBranch/Commit: 382926c5cabb572bf912de7ce1137f07d5cc42eb\n\nReviewer: Travis Scrimshaw\n\nAuthor: Trevor K. Karn\n\nDependencies: #34339 #34343 #34345\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34260\n\n",
    "closed_at": "2022-11-07T20:26:22Z",
    "created_at": "2022-08-01T19:22:04Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Implement northwest diagrams",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34260",
    "user": "https://github.com/trevorkarn"
}
```
Implement a class for diagrams (collections of cells `(i,j)` indexed by the natural numbers), and a class for diagrams with the northwest property. A diagram has the northwest property if the fact that `(i1, j1)` and `(i2,j2)` are in the diagram implies that the cell `(min(i1,i2), min(j1,j2))` are in the diagram.

Assignee: @trevorkarn

CC:  @tscrim

Keywords: gsoc2022 northwest-diagram

Branch/Commit: 382926c5cabb572bf912de7ce1137f07d5cc42eb

Reviewer: Travis Scrimshaw

Author: Trevor K. Karn

Dependencies: #34339 #34343 #34345

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34260





---

archive/issue_comments_515884.json:
```json
{
    "body": "Set assignee to @trevorkarn.",
    "created_at": "2022-08-01T20:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515884",
    "user": "https://github.com/trevorkarn"
}
```

Set assignee to @trevorkarn.



---

archive/issue_comments_515885.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2022-08-01T20:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515885",
    "user": "https://github.com/trevorkarn"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_515886.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2022-08-01T20:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515886",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_515887.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2022-08-01T20:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515887",
    "user": "https://github.com/trevorkarn"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_515888.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-02T17:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515888",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515889.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-04T03:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515889",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515890.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-04T22:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515891.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-08-05T13:07:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515891",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_515892.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-08-09T00:15:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515892",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_515893.json:
```json
{
    "body": "<a id='comment:8'></a>There is currently an issue in `._test_category`.\n\n```\nsage: from sage.combinat.diagram import Diagram\nsage: D = Diagram([(0,0), (0,3)])\nsage: D\n[(0, 0), (0, 3)]\nsage: D._test_category\n<built-in method _test_category of Diagram object at 0x16d1fc4c0>\nsage: D._test_category()\n---------------------------------------------------------------------------\nAssertionError                            Traceback (most recent call last)\nInput In [6], in <cell line: 1>()\n----> 1 D._test_category()\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:722, in sage.structure.element.Element._test_category()\n    720     # For usual Python classes, that should be done with\n    721     # standard inheritance\n--> 722     tester.assertTrue(isinstance(self, self.parent().category().element_class))\n    723 else:\n    724     # For extension types we just check that inheritance\n\nFile /usr/local/Cellar/python@3.9/3.9.13_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/unittest/case.py:688, in TestCase.assertTrue(self, expr, msg)\n    686 if not expr:\n    687     msg = self._formatMessage(msg, \"%s is not true\" % safe_repr(expr))\n--> 688     raise self.failureException(msg)\n\nAssertionError: False is not true\n```",
    "created_at": "2022-08-09T00:17:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515893",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:8'></a>There is currently an issue in `._test_category`.

```
sage: from sage.combinat.diagram import Diagram
sage: D = Diagram([(0,0), (0,3)])
sage: D
[(0, 0), (0, 3)]
sage: D._test_category
<built-in method _test_category of Diagram object at 0x16d1fc4c0>
sage: D._test_category()
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
Input In [6], in <cell line: 1>()
----> 1 D._test_category()

File ~/Applications/sage/src/sage/structure/element.pyx:722, in sage.structure.element.Element._test_category()
    720     # For usual Python classes, that should be done with
    721     # standard inheritance
--> 722     tester.assertTrue(isinstance(self, self.parent().category().element_class))
    723 else:
    724     # For extension types we just check that inheritance

File /usr/local/Cellar/python@3.9/3.9.13_1/Frameworks/Python.framework/Versions/3.9/lib/python3.9/unittest/case.py:688, in TestCase.assertTrue(self, expr, msg)
    686 if not expr:
    687     msg = self._formatMessage(msg, "%s is not true" % safe_repr(expr))
--> 688     raise self.failureException(msg)

AssertionError: False is not true
```



---

archive/issue_comments_515894.json:
```json
{
    "body": "<a id='comment:9'></a>From a quick look, you are not passing a `parent` argument, which should be the first argument to any element `__init__` method, and passing that up to `Element.__init__`. Mainly, these code blocks:\n\n```python\n        ClonableArray.__init__(self, Diagrams(), cells, check=False)\n```\n\n```python\n        Diagram.__init__(self, cells, **kwargs)\n        ClonableArray.__init__(self, NorthwestDiagrams(), cells, check=check)\n```\nI also don't like the double initialization of `ClonableArray` here. `Diagram` should properly handle everything, otherwise it is a code smell that strongly suggests they should not be subclasses (but they should be in this case; note that this is not universal).\n\nRemove also the `kwargs` and make them explicit, mainly the `check`.\n\nYou should also use `_repr_` (with 1 underscore).",
    "created_at": "2022-08-09T00:46:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515894",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>From a quick look, you are not passing a `parent` argument, which should be the first argument to any element `__init__` method, and passing that up to `Element.__init__`. Mainly, these code blocks:

```python
        ClonableArray.__init__(self, Diagrams(), cells, check=False)
```

```python
        Diagram.__init__(self, cells, **kwargs)
        ClonableArray.__init__(self, NorthwestDiagrams(), cells, check=check)
```
I also don't like the double initialization of `ClonableArray` here. `Diagram` should properly handle everything, otherwise it is a code smell that strongly suggests they should not be subclasses (but they should be in this case; note that this is not universal).

Remove also the `kwargs` and make them explicit, mainly the `check`.

You should also use `_repr_` (with 1 underscore).



---

archive/issue_comments_515895.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-09T01:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515895",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515896.json:
```json
{
    "body": "<a id='comment:11'></a>Thanks for the feedback!\n\nReplying to [comment:9 tscrim]:\n> From a quick look, you are not passing a `parent` argument, which should be the first argument to any element `__init__` method, and passing that up to `Element.__init__`. Mainly, these code blocks:\n> \n> ```python\n>         ClonableArray.__init__(self, Diagrams(), cells, check=False)\n> ```\n> \n> ```python\n>         Diagram.__init__(self, cells, **kwargs)\n>         ClonableArray.__init__(self, NorthwestDiagrams(), cells, check=check)\n> ```\n\n\nSorry, I'm confused. I thought that `Diagrams()` and `NorthwestDiagrams()` were those `parent` arguments. Am I misunderstanding what you are saying?\n\n---\nNew commits:\n|                                                                                                                                          |                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------|\n|[942f976](https://git.sagemath.org/sage.git/commit?id=942f976e638f98113fb05526379891214c115a66)|`PEP8 and example`|\n|[ddfc6be](https://git.sagemath.org/sage.git/commit?id=ddfc6be6700e75e0ecf9ba11f6b0ab8fbc72d1fc)|`Fix __init__`|\n---\nNew commits:",
    "created_at": "2022-08-09T01:49:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515896",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:11'></a>Thanks for the feedback!

Replying to [comment:9 tscrim]:
> From a quick look, you are not passing a `parent` argument, which should be the first argument to any element `__init__` method, and passing that up to `Element.__init__`. Mainly, these code blocks:
> 
> ```python
>         ClonableArray.__init__(self, Diagrams(), cells, check=False)
> ```
> 
> ```python
>         Diagram.__init__(self, cells, **kwargs)
>         ClonableArray.__init__(self, NorthwestDiagrams(), cells, check=check)
> ```


Sorry, I'm confused. I thought that `Diagrams()` and `NorthwestDiagrams()` were those `parent` arguments. Am I misunderstanding what you are saying?

---
New commits:
|                                                                                                                                          |                  |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------|
|[942f976](https://git.sagemath.org/sage.git/commit?id=942f976e638f98113fb05526379891214c115a66)|`PEP8 and example`|
|[ddfc6be](https://git.sagemath.org/sage.git/commit?id=ddfc6be6700e75e0ecf9ba11f6b0ab8fbc72d1fc)|`Fix __init__`|
---
New commits:



---

archive/issue_comments_515897.json:
```json
{
    "body": "<a id='comment:12'></a>They are, but elements should take a `parent` argument first and pass that along. Imagine once you have `NorthwestDiagrams` given by some parameter. This will also fix the double initialization issue.",
    "created_at": "2022-08-09T01:59:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515897",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>They are, but elements should take a `parent` argument first and pass that along. Imagine once you have `NorthwestDiagrams` given by some parameter. This will also fix the double initialization issue.



---

archive/issue_comments_515898.json:
```json
{
    "body": "<a id='comment:13'></a>Oh! That makes sense now. It also helps with some general confusion I had about when to use `__classcall_private__` and other `Parent`/`Element` confusion. Thanks!",
    "created_at": "2022-08-09T18:12:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515898",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:13'></a>Oh! That makes sense now. It also helps with some general confusion I had about when to use `__classcall_private__` and other `Parent`/`Element` confusion. Thanks!



---

archive/issue_comments_515899.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-09T19:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515899",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515900.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-09T19:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515900",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515901.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-09T21:48:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515901",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515902.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-09T21:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515902",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515903.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-09T21:55:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515903",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_515904.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-10T15:43:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515905.json:
```json
{
    "body": "<a id='comment:20'></a>Some minor things:\n\n* I'd prefer `number_of_xxx` over `n_xxx`, for consistency with other methods in the combinat file\n\n* since `Diagrams` are extremely important, but `NorthwestDiagrams` maybe not so much, should they possibly be in separate files?\n\n* it would be great if `ParallelogramPolyomino`, (the 2-dim case of) `Polyomino`, `Partition`, `SkewPartition` and possibly even `Composition` interacted nicely with `Diagram`.  In particular, the method names should be the same, whenever possible.  I imagine that for `Polyomino` this will not be possible, but for the others, it should be.\n\n* I'm not sure whether `number_of_cells` should be there.  If so, wouldn't `size` be more appropriate?\n\nActually, for me the most important point is the synergy with the other classes.",
    "created_at": "2022-08-10T21:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515905",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:20'></a>Some minor things:

* I'd prefer `number_of_xxx` over `n_xxx`, for consistency with other methods in the combinat file

* since `Diagrams` are extremely important, but `NorthwestDiagrams` maybe not so much, should they possibly be in separate files?

* it would be great if `ParallelogramPolyomino`, (the 2-dim case of) `Polyomino`, `Partition`, `SkewPartition` and possibly even `Composition` interacted nicely with `Diagram`.  In particular, the method names should be the same, whenever possible.  I imagine that for `Polyomino` this will not be possible, but for the others, it should be.

* I'm not sure whether `number_of_cells` should be there.  If so, wouldn't `size` be more appropriate?

Actually, for me the most important point is the synergy with the other classes.



---

archive/issue_comments_515906.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-08-11T19:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515906",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_515907.json:
```json
{
    "body": "<a id='comment:23'></a>After rebasing off of some optimizations in #34339 and #34343\n\n```\nsage: sage: from sage.combinat.diagram import RotheDiagram\n....: sage: Sym = SymmetricFunctions(QQ)\n....: sage: p = Permutations(6).from_reduced_word([1, 2, 3, 4, 2, 3, 2, 1])\n....: sage: s = Sym.s()\nsage: sage: %lprun -f RotheDiagram(p).peelable_tableaux s.sum(s[T.shape()] for T in RotheDiagram(p).peelable_tableaux())\n\nTimer unit: 1e-06 s\n\nTotal time: 0.008998 s\nFile: /Users/trevorkarn/Applications/sage/src/sage/combinat/diagram.py\nFunction: peelable_tableaux at line 671\n\nLine #      Hits         Time  Per Hit   % Time  Line Contents\n==============================================================\n   671                                               def peelable_tableaux(self):\n  ....\n   797                                                   # description without performing JDT, so we should implement that\n   798                                           \n   799                                                   # if there is a single column in the diagram then there is only\n   800                                                   # one posslbe peelable tableau.\n   801         4         15.0      3.8      0.2          if self._n_nonempty_cols == 1:\n   802         1        376.0    376.0      4.2              return {Tableau([[i+1] for i, j in self._cells])}\n   803                                           \n   804         3         17.0      5.7      0.2          first_col = min(j for i, j in self._cells)\n   805                                           \n   806                                                   # TODO: The next two lines of code could be optimized by only\n   807                                                   # looping over self._cells once (rather than two separate times)\n   808                                                   # get the diagram without the first column\n   809         3        145.0     48.3      1.6          Dhat = NorthwestDiagram([c for c in self._cells if c[1] != first_col])\n   810                                           \n   811                                                   # get the values from the first column\n   812         3         19.0      6.3      0.2          new_vals = sorted(i + 1 for i, j in self._cells if j == first_col)\n   813                                           \n   814         3          9.0      3.0      0.1          k = self.n_cells() - Dhat.n_cells()\n   815                                           \n   816         3          4.0      1.3      0.0          peelables = set()\n   817                                           \n   818         6         14.0      2.3      0.2          for Q in Dhat.peelable_tableaux():\n   819                                                       # get the vertical strips\n   820         3        143.0     47.7      1.6              mu = Q.shape()\n   821         3       2565.0    855.0     28.5              vertical_strips = mu.add_vertical_border_strip(k)\n   822        12         19.0      1.6      0.2              for s in vertical_strips:\n   823         9        663.0     73.7      7.4                  sQ = SkewTableaux()(Q)  # sQ is skew - get it?\n   824         9       1478.0    164.2     16.4                  new_cells = (s/mu).cells()\n   825                                                           # perform the jeu de taquin slides\n   826        32         58.0      1.8      0.6                  for c in new_cells:\n   827        23       2477.0    107.7     27.5                      sQ = sQ.backward_slide(c)\n   828                                                           # create the new tableau by filling the columns\n   829         9         43.0      4.8      0.5                  sQ_new = sQ.to_list()\n   830        32         50.0      1.6      0.6                  for n in range(k):\n   831        23         32.0      1.4      0.4                      sQ_new[n][0] = new_vals[n]\n   832                                           \n   833         9        180.0     20.0      2.0                  T = Tableau(sQ_new)\n   834         9        674.0     74.9      7.5                  if T.is_column_strict():\n   835         3         13.0      4.3      0.1                      peelables.add(T)\n   836                                           \n   837         3          4.0      1.3      0.0          return peelables\n```",
    "created_at": "2022-08-11T20:15:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515907",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:23'></a>After rebasing off of some optimizations in #34339 and #34343

```
sage: sage: from sage.combinat.diagram import RotheDiagram
....: sage: Sym = SymmetricFunctions(QQ)
....: sage: p = Permutations(6).from_reduced_word([1, 2, 3, 4, 2, 3, 2, 1])
....: sage: s = Sym.s()
sage: sage: %lprun -f RotheDiagram(p).peelable_tableaux s.sum(s[T.shape()] for T in RotheDiagram(p).peelable_tableaux())

Timer unit: 1e-06 s

Total time: 0.008998 s
File: /Users/trevorkarn/Applications/sage/src/sage/combinat/diagram.py
Function: peelable_tableaux at line 671

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   671                                               def peelable_tableaux(self):
  ....
   797                                                   # description without performing JDT, so we should implement that
   798                                           
   799                                                   # if there is a single column in the diagram then there is only
   800                                                   # one posslbe peelable tableau.
   801         4         15.0      3.8      0.2          if self._n_nonempty_cols == 1:
   802         1        376.0    376.0      4.2              return {Tableau([[i+1] for i, j in self._cells])}
   803                                           
   804         3         17.0      5.7      0.2          first_col = min(j for i, j in self._cells)
   805                                           
   806                                                   # TODO: The next two lines of code could be optimized by only
   807                                                   # looping over self._cells once (rather than two separate times)
   808                                                   # get the diagram without the first column
   809         3        145.0     48.3      1.6          Dhat = NorthwestDiagram([c for c in self._cells if c[1] != first_col])
   810                                           
   811                                                   # get the values from the first column
   812         3         19.0      6.3      0.2          new_vals = sorted(i + 1 for i, j in self._cells if j == first_col)
   813                                           
   814         3          9.0      3.0      0.1          k = self.n_cells() - Dhat.n_cells()
   815                                           
   816         3          4.0      1.3      0.0          peelables = set()
   817                                           
   818         6         14.0      2.3      0.2          for Q in Dhat.peelable_tableaux():
   819                                                       # get the vertical strips
   820         3        143.0     47.7      1.6              mu = Q.shape()
   821         3       2565.0    855.0     28.5              vertical_strips = mu.add_vertical_border_strip(k)
   822        12         19.0      1.6      0.2              for s in vertical_strips:
   823         9        663.0     73.7      7.4                  sQ = SkewTableaux()(Q)  # sQ is skew - get it?
   824         9       1478.0    164.2     16.4                  new_cells = (s/mu).cells()
   825                                                           # perform the jeu de taquin slides
   826        32         58.0      1.8      0.6                  for c in new_cells:
   827        23       2477.0    107.7     27.5                      sQ = sQ.backward_slide(c)
   828                                                           # create the new tableau by filling the columns
   829         9         43.0      4.8      0.5                  sQ_new = sQ.to_list()
   830        32         50.0      1.6      0.6                  for n in range(k):
   831        23         32.0      1.4      0.4                      sQ_new[n][0] = new_vals[n]
   832                                           
   833         9        180.0     20.0      2.0                  T = Tableau(sQ_new)
   834         9        674.0     74.9      7.5                  if T.is_column_strict():
   835         3         13.0      4.3      0.1                      peelables.add(T)
   836                                           
   837         3          4.0      1.3      0.0          return peelables
```



---

archive/issue_comments_515908.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-11T20:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515908",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515909.json:
```json
{
    "body": "<a id='comment:26'></a>After rebasing off of #34345\n\n```\nTotal time: 0.008072 s\nFile: /Users/trevorkarn/Applications/sage/src/sage/combinat/diagram.py\nFunction: peelable_tableaux at line 671\n\nLine #      Hits         Time  Per Hit   % Time  Line Contents\n==============================================================\n   809         3        153.0     51.0      1.9          Dhat = NorthwestDiagram([c for c in self._cells if c[1] != first_col])\n   810                                           \n   811                                                   # get the values from the first column\n   812         3         19.0      6.3      0.2          new_vals = sorted(i + 1 for i, j in self._cells if j == first_col)\n   813                                           \n   814         3         11.0      3.7      0.1          k = self.n_cells() - Dhat.n_cells()\n   815                                           \n   816         3          6.0      2.0      0.1          peelables = set()\n   817                                           \n   818         6         11.0      1.8      0.1          for Q in Dhat.peelable_tableaux():\n   819                                                       # get the vertical strips\n   820         3        261.0     87.0      3.2              mu = Q.shape()\n   821         3       2741.0    913.7     34.0              vertical_strip_cells = mu.vertical_border_strip_cells(k)\n   822        12         19.0      1.6      0.2              for s in vertical_strip_cells:\n   823         9        825.0     91.7     10.2                  sQ = SkewTableaux()(Q)  # sQ is skew - get it?\n   824                                                           # perform the jeu de taquin slides\n   825        32         56.0      1.8      0.7                  for c in s:\n   826        23       2857.0    124.2     35.4                      sQ = sQ.backward_slide(c)\n   827                                                           # create the new tableau by filling the columns\n   828         9         43.0      4.8      0.5                  sQ_new = sQ.to_list()\n   829        32         47.0      1.5      0.6                  for n in range(k):\n   830        23         34.0      1.5      0.4                      sQ_new[n][0] = new_vals[n]\n   831                                           \n   832         9        191.0     21.2      2.4                  T = Tableau(sQ_new)\n   833         9        195.0     21.7      2.4                  if T.is_column_strict():\n   834         3         13.0      4.3      0.2                      peelables.add(T)\n   835                                           \n   836         3          3.0      1.0      0.0          return peelables\n\n```",
    "created_at": "2022-08-12T00:37:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515909",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:26'></a>After rebasing off of #34345

```
Total time: 0.008072 s
File: /Users/trevorkarn/Applications/sage/src/sage/combinat/diagram.py
Function: peelable_tableaux at line 671

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   809         3        153.0     51.0      1.9          Dhat = NorthwestDiagram([c for c in self._cells if c[1] != first_col])
   810                                           
   811                                                   # get the values from the first column
   812         3         19.0      6.3      0.2          new_vals = sorted(i + 1 for i, j in self._cells if j == first_col)
   813                                           
   814         3         11.0      3.7      0.1          k = self.n_cells() - Dhat.n_cells()
   815                                           
   816         3          6.0      2.0      0.1          peelables = set()
   817                                           
   818         6         11.0      1.8      0.1          for Q in Dhat.peelable_tableaux():
   819                                                       # get the vertical strips
   820         3        261.0     87.0      3.2              mu = Q.shape()
   821         3       2741.0    913.7     34.0              vertical_strip_cells = mu.vertical_border_strip_cells(k)
   822        12         19.0      1.6      0.2              for s in vertical_strip_cells:
   823         9        825.0     91.7     10.2                  sQ = SkewTableaux()(Q)  # sQ is skew - get it?
   824                                                           # perform the jeu de taquin slides
   825        32         56.0      1.8      0.7                  for c in s:
   826        23       2857.0    124.2     35.4                      sQ = sQ.backward_slide(c)
   827                                                           # create the new tableau by filling the columns
   828         9         43.0      4.8      0.5                  sQ_new = sQ.to_list()
   829        32         47.0      1.5      0.6                  for n in range(k):
   830        23         34.0      1.5      0.4                      sQ_new[n][0] = new_vals[n]
   831                                           
   832         9        191.0     21.2      2.4                  T = Tableau(sQ_new)
   833         9        195.0     21.7      2.4                  if T.is_column_strict():
   834         3         13.0      4.3      0.2                      peelables.add(T)
   835                                           
   836         3          3.0      1.0      0.0          return peelables

```



---

archive/issue_comments_515910.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:20 mantepse]:\n> Some minor things:\n> \n> * I'd prefer `number_of_xxx` over `n_xxx`, for consistency with other methods in the combinat file\n\n\n+1 Although one could argue `nrows` and `ncols` are okay (perhaps as aliases) since they are there for matrices.\n\n> * since `Diagrams` are extremely important, but `NorthwestDiagrams` maybe not so much, should they possibly be in separate files?\n\n\n-1 They are natural to go together and it can make maintenance easier (and the documentation is also together). I don't think we should base these decisions on an \"importance\" metric.\n\n> * it would be great if `ParallelogramPolyomino`, (the 2-dim case of) `Polyomino`, `Partition`, `SkewPartition` and possibly even `Composition` interacted nicely with `Diagram`.  In particular, the method names should be the same, whenever possible.  I imagine that for `Polyomino` this will not be possible, but for the others, it should be.\n\n\nI agree with having the method names the same in general.\n\n> * I'm not sure whether `number_of_cells` should be there.  If so, wouldn't `size` be more appropriate?\n\n\nGood for an alias.",
    "created_at": "2022-08-13T02:40:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515910",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'></a>Replying to [comment:20 mantepse]:
> Some minor things:
> 
> * I'd prefer `number_of_xxx` over `n_xxx`, for consistency with other methods in the combinat file


+1 Although one could argue `nrows` and `ncols` are okay (perhaps as aliases) since they are there for matrices.

> * since `Diagrams` are extremely important, but `NorthwestDiagrams` maybe not so much, should they possibly be in separate files?


-1 They are natural to go together and it can make maintenance easier (and the documentation is also together). I don't think we should base these decisions on an "importance" metric.

> * it would be great if `ParallelogramPolyomino`, (the 2-dim case of) `Polyomino`, `Partition`, `SkewPartition` and possibly even `Composition` interacted nicely with `Diagram`.  In particular, the method names should be the same, whenever possible.  I imagine that for `Polyomino` this will not be possible, but for the others, it should be.


I agree with having the method names the same in general.

> * I'm not sure whether `number_of_cells` should be there.  If so, wouldn't `size` be more appropriate?


Good for an alias.



---

archive/issue_comments_515911.json:
```json
{
    "body": "<a id='comment:28'></a>Some additional comments:\n\n- In `check()`, it should raise `ValueError` when failing rather than an `assert`.\n- All `Diagrams` can be enumerated. You put coordinates the cells by **N** by running along the diagonals. Hence, diagrams are in bijection with all finite subsets of **N**, which are easily enumerated by the binary strings of nonnegative integers.\n- The default for `check` should always be `True`. It is only when we as developers want to avoid it that we should change it.\n- `_cells` should be a `frozenset`. You are not using it as a `dict`. This is also hashable.\n\nAlso, some of the methods don't have doctests, so I setting this to \"needs work\".",
    "created_at": "2022-08-13T02:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515911",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>Some additional comments:

- In `check()`, it should raise `ValueError` when failing rather than an `assert`.
- All `Diagrams` can be enumerated. You put coordinates the cells by **N** by running along the diagonals. Hence, diagrams are in bijection with all finite subsets of **N**, which are easily enumerated by the binary strings of nonnegative integers.
- The default for `check` should always be `True`. It is only when we as developers want to avoid it that we should change it.
- `_cells` should be a `frozenset`. You are not using it as a `dict`. This is also hashable.

Also, some of the methods don't have doctests, so I setting this to "needs work".



---

archive/issue_comments_515912.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-08-13T02:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515912",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_515913.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-08-16T17:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515913",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_515914.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-16T19:32:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515914",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515915.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:30 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> |                                                                                                                                           |                         |\n> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n> |[e973f7d](https://git.sagemath.org/sage.git/commit/?id=e973f7dcedd6378d514229348dd94c4603757ceb)|`Assertion -> ValueError`|\n> |[a57b2d0](https://git.sagemath.org/sage.git/commit/?id=a57b2d06d52ace10723505348ad5548102dd62f1)|`Add tests and remove Stanley s.f.`|\n\n\nRemoving Stanley symmetric functions because it should really be on #34335",
    "created_at": "2022-08-16T19:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515915",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:31'></a>Replying to [comment:30 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> |                                                                                                                                           |                         |
> |-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
> |[e973f7d](https://git.sagemath.org/sage.git/commit/?id=e973f7dcedd6378d514229348dd94c4603757ceb)|`Assertion -> ValueError`|
> |[a57b2d0](https://git.sagemath.org/sage.git/commit/?id=a57b2d06d52ace10723505348ad5548102dd62f1)|`Add tests and remove Stanley s.f.`|


Removing Stanley symmetric functions because it should really be on #34335



---

archive/issue_comments_515916.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-17T18:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515917.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-08-17T18:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515917",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_515918.json:
```json
{
    "body": "<a id='comment:34'></a>Merge conflict.",
    "created_at": "2022-08-31T02:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515918",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'></a>Merge conflict.



---

archive/issue_comments_515919.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-08-31T02:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515919",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_515920.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-01T22:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515920",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515921.json:
```json
{
    "body": "<a id='comment:36'></a>I rebased off of 9.7.beta8 develop, then #34339, #34343, and #34345 and then merged the changes. Then I force-pushed that branch, which I hope resolves the merge conflicts.",
    "created_at": "2022-09-01T22:29:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515921",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:36'></a>I rebased off of 9.7.beta8 develop, then #34339, #34343, and #34345 and then merged the changes. Then I force-pushed that branch, which I hope resolves the merge conflicts.



---

archive/issue_comments_515922.json:
```json
{
    "body": "<a id='comment:37'></a>It is a conflict with something in the latest beta (which was released about 2 days ago).",
    "created_at": "2022-09-01T23:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515922",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:37'></a>It is a conflict with something in the latest beta (which was released about 2 days ago).



---

archive/issue_comments_515923.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-09-06T18:30:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515923",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_515924.json:
```json
{
    "body": "<a id='comment:39'></a>Ok it is now rebased on the latest beta. Sorry for the delay in this.",
    "created_at": "2022-09-06T18:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515924",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:39'></a>Ok it is now rebased on the latest beta. Sorry for the delay in this.



---

archive/issue_comments_515925.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-09-06T18:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515925",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_515926.json:
```json
{
    "body": "<a id='comment:41'></a>Here are my current comments:\n\nI don\u2019t like putting so much information at the class-level documentation because each it is not associated with each individual class nor easily accessible by `Foo?`. I think a lot of it is better broken up into the individual (element) classes.\n\nThe first one-sentence description should be just that: one sentence. Subsequent information can go in the next paragraph (i.e., with a blank line in between).\n\nFor the `Diagram` class, it should sort the objects and store them in the list. There shouldn\u2019t be a need to override stuff. This is what `SetPartition` does. This way you are not duplicating the information and there is less code to maintain. In its `__init__()`, why not use `<=` for the comparisons? For the classcall, the default should be `check=True` since we should check user input by default.\n\nI am not really a fan of the `from_foo()` type methods. The `_element_constructor_` is the thing that should handle that, but it probably is good that the individual functions are there and publicly listed. At least, I think the `_element_constructor_` should make a check to the appropriate type and dispatch out accordingly.\n\n`peelable_tableaux()` has a number of doc issues, include incomplete, a code block after a `.` (not `::`), `ALGORITHM:` (with the block after not indented) not `.. ALOGIRHTM::`, and `Remark 25` (it is a name).\n\nIn `from_zero_one_matrix()`, the definition of `zero` and `one` are better within the `if check:`.\n\nThe `Diagram.pp()` does not respect the partition printing option for English versus French convention (but it implicitly claims it does).\n\nLastly, pyflakes; see the patchbot.",
    "created_at": "2022-09-07T03:48:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515926",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:41'></a>Here are my current comments:

I don’t like putting so much information at the class-level documentation because each it is not associated with each individual class nor easily accessible by `Foo?`. I think a lot of it is better broken up into the individual (element) classes.

The first one-sentence description should be just that: one sentence. Subsequent information can go in the next paragraph (i.e., with a blank line in between).

For the `Diagram` class, it should sort the objects and store them in the list. There shouldn’t be a need to override stuff. This is what `SetPartition` does. This way you are not duplicating the information and there is less code to maintain. In its `__init__()`, why not use `<=` for the comparisons? For the classcall, the default should be `check=True` since we should check user input by default.

I am not really a fan of the `from_foo()` type methods. The `_element_constructor_` is the thing that should handle that, but it probably is good that the individual functions are there and publicly listed. At least, I think the `_element_constructor_` should make a check to the appropriate type and dispatch out accordingly.

`peelable_tableaux()` has a number of doc issues, include incomplete, a code block after a `.` (not `::`), `ALGORITHM:` (with the block after not indented) not `.. ALOGIRHTM::`, and `Remark 25` (it is a name).

In `from_zero_one_matrix()`, the definition of `zero` and `one` are better within the `if check:`.

The `Diagram.pp()` does not respect the partition printing option for English versus French convention (but it implicitly claims it does).

Lastly, pyflakes; see the patchbot.



---

archive/issue_comments_515927.json:
```json
{
    "body": "<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-09-13T00:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515927",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:42'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_515928.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-13T00:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515928",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515929.json:
```json
{
    "body": "<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-13T00:40:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515929",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515930.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-13T15:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515930",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515931.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:41 Travis Scrimshaw]:\n\nOk - I think all of these issues are addressed.",
    "created_at": "2022-09-13T15:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515931",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:46'></a>Replying to [comment:41 Travis Scrimshaw]:

Ok - I think all of these issues are addressed.



---

archive/issue_comments_515932.json:
```json
{
    "body": "<a id='comment:47'></a>Todo: Make iterator and change category",
    "created_at": "2022-09-16T01:09:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515932",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:47'></a>Todo: Make iterator and change category



---

archive/issue_comments_515933.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-09-16T18:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515933",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_515934.json:
```json
{
    "body": "<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-17T18:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515934",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515935.json:
```json
{
    "body": "<a id='comment:50'></a>Ok, I think I made the changes we discussed.",
    "created_at": "2022-09-17T18:53:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515935",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:50'></a>Ok, I think I made the changes we discussed.



---

archive/issue_comments_515936.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-09-17T18:53:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515936",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_089301.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34260#event-89301"
}
```



---

archive/issue_comments_515937.json:
```json
{
    "body": "<a id='comment:52'></a>Why are you using `PositiveIntegers()` and subtracting one instead of `NonNegativeIntegers()`? This seems unnecessary\n\n```\nsage: X = NonNegativeIntegers()\nsage: XX = cartesian_product([X, X])\nsage: it = subsets(XX)\nsage: [next(it) for _ in range(10)]\n[[],\n [(0, 0)],\n [(1, 0)],\n [(0, 0), (1, 0)],\n [(0, 1)],\n [(0, 0), (0, 1)],\n [(1, 0), (0, 1)],\n [(0, 0), (1, 0), (0, 1)],\n [(2, 0)],\n [(0, 0), (2, 0)]]\n```\n\nI don't find this comment helpful\n\n```\n            # we want to allow cells in the index-0 row but we\n            # dont want all of them to be in the index-0 row\n```\nIn fact, I think it actually makes things confusing. This code is based on the fact that the set of all subsets is an iterator, which means every element is hit after some finite time. It is more than fair for this code to assume that behavior.",
    "created_at": "2022-09-20T06:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515937",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:52'></a>Why are you using `PositiveIntegers()` and subtracting one instead of `NonNegativeIntegers()`? This seems unnecessary

```
sage: X = NonNegativeIntegers()
sage: XX = cartesian_product([X, X])
sage: it = subsets(XX)
sage: [next(it) for _ in range(10)]
[[],
 [(0, 0)],
 [(1, 0)],
 [(0, 0), (1, 0)],
 [(0, 1)],
 [(0, 0), (0, 1)],
 [(1, 0), (0, 1)],
 [(0, 0), (1, 0), (0, 1)],
 [(2, 0)],
 [(0, 0), (2, 0)]]
```

I don't find this comment helpful

```
            # we want to allow cells in the index-0 row but we
            # dont want all of them to be in the index-0 row
```
In fact, I think it actually makes things confusing. This code is based on the fact that the set of all subsets is an iterator, which means every element is hit after some finite time. It is more than fair for this code to assume that behavior.



---

archive/issue_comments_515938.json:
```json
{
    "body": "<a id='comment:53'></a>Also, I would avoid imports from any `*.all`:\n\n```\nfrom sage.categories.cartesian_product import cartesian_product\n```",
    "created_at": "2022-09-20T06:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515938",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:53'></a>Also, I would avoid imports from any `*.all`:

```
from sage.categories.cartesian_product import cartesian_product
```



---

archive/issue_comments_515939.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:52 Travis Scrimshaw]:\n> Why are you using `PositiveIntegers()` and subtracting one instead of `NonNegativeIntegers()`? This seems unnecessary\n> \n> ```\n> sage: X = NonNegativeIntegers()\n> sage: XX = cartesian_product([X, X])\n> sage: it = subsets(XX)\n> sage: [next(it) for _ in range(10)]\n> [[],\n>  [(0, 0)],\n>  [(1, 0)],\n>  [(0, 0), (1, 0)],\n>  [(0, 1)],\n>  [(0, 0), (0, 1)],\n>  [(1, 0), (0, 1)],\n>  [(0, 0), (1, 0), (0, 1)],\n>  [(2, 0)],\n>  [(0, 0), (2, 0)]]\n> ```\n\n\nHm. I must have done something wrong when I tried using `NonNegativeIntegers()` before. Whatever I was doing I was only getting diagrams that were contained in the first row. Evidently, your change works - sorry for the confusion.\n\n> I don't find this comment helpful\n> \n> ```\n>             # we want to allow cells in the index-0 row but we\n>             # dont want all of them to be in the index-0 row\n> ```\n> In fact, I think it actually makes things confusing. This code is based on the fact that the set of all subsets is an iterator, which means every element is hit after some finite time. It is more than fair for this code to assume that behavior.\n\n\nI meant for this to clarify why I was subtracting one instead of using `NonNegativeIntegers`, but I agree it is confusing.",
    "created_at": "2022-09-20T12:40:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515939",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:54'></a>Replying to [comment:52 Travis Scrimshaw]:
> Why are you using `PositiveIntegers()` and subtracting one instead of `NonNegativeIntegers()`? This seems unnecessary
> 
> ```
> sage: X = NonNegativeIntegers()
> sage: XX = cartesian_product([X, X])
> sage: it = subsets(XX)
> sage: [next(it) for _ in range(10)]
> [[],
>  [(0, 0)],
>  [(1, 0)],
>  [(0, 0), (1, 0)],
>  [(0, 1)],
>  [(0, 0), (0, 1)],
>  [(1, 0), (0, 1)],
>  [(0, 0), (1, 0), (0, 1)],
>  [(2, 0)],
>  [(0, 0), (2, 0)]]
> ```


Hm. I must have done something wrong when I tried using `NonNegativeIntegers()` before. Whatever I was doing I was only getting diagrams that were contained in the first row. Evidently, your change works - sorry for the confusion.

> I don't find this comment helpful
> 
> ```
>             # we want to allow cells in the index-0 row but we
>             # dont want all of them to be in the index-0 row
> ```
> In fact, I think it actually makes things confusing. This code is based on the fact that the set of all subsets is an iterator, which means every element is hit after some finite time. It is more than fair for this code to assume that behavior.


I meant for this to clarify why I was subtracting one instead of using `NonNegativeIntegers`, but I agree it is confusing.



---

archive/issue_comments_515940.json:
```json
{
    "body": "<a id='comment:55'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-20T12:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515940",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:55'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515941.json:
```json
{
    "body": "<a id='comment:56'></a>Can you also separate part of `pp()` into `_ascii_art_` (and/or maybe something that also for `_unicode_art_`), where `pp()` would simply `print(self._ascii_art_())`? This would mean `ascii_art(D)` would generate the nice pictures (and could be further manipulated).\n\nIt would be good to add a `_latex_[young_diagram]()` like `SkewPartition` that does\n\n```python\n    def _latex_(self):\n        if not self._list:\n            return \"{\\\\emptyset}\"\n\n        ret = []\n        for i in range(self._n_rows):\n            row = []\n            for j in range(self._n_cols):\n                row.append(\"\\\\phantom{x}\" if (i, j) in self else None)\n            ret.append(row)\n        from sage.combinat.output import tex_from_array\n        return tex_from_array(ret)\n```\n\nThis will make it easier for people to visualize it.",
    "created_at": "2022-09-22T01:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515941",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:56'></a>Can you also separate part of `pp()` into `_ascii_art_` (and/or maybe something that also for `_unicode_art_`), where `pp()` would simply `print(self._ascii_art_())`? This would mean `ascii_art(D)` would generate the nice pictures (and could be further manipulated).

It would be good to add a `_latex_[young_diagram]()` like `SkewPartition` that does

```python
    def _latex_(self):
        if not self._list:
            return "{\\emptyset}"

        ret = []
        for i in range(self._n_rows):
            row = []
            for j in range(self._n_cols):
                row.append("\\phantom{x}" if (i, j) in self else None)
            ret.append(row)
        from sage.combinat.output import tex_from_array
        return tex_from_array(ret)
```

This will make it easier for people to visualize it.



---

archive/issue_comments_515942.json:
```json
{
    "body": "<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-23T02:52:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515943.json:
```json
{
    "body": "<a id='comment:58'></a>`_pretty_print()` should return the string, not print it. That way, e.g., `_ascii_art_` can `return ascii_art(result)`.",
    "created_at": "2022-09-23T06:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515943",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:58'></a>`_pretty_print()` should return the string, not print it. That way, e.g., `_ascii_art_` can `return ascii_art(result)`.



---

archive/issue_comments_515944.json:
```json
{
    "body": "<a id='comment:59'></a>Replying to [comment:56 Travis Scrimshaw]:\n\n> It would be good to add a `_latex_[young_diagram]()` like `SkewPartition` that does\n> \n> ```python\n>     def _latex_(self):\n>         if not self._list:\n>             return \"{\\\\emptyset}\"\n> \n>         ret = []\n>         for i in range(self._n_rows):\n>             row = []\n>             for j in range(self._n_cols):\n>                 row.append(\"\\\\phantom{x}\" if (i, j) in self else None)\n>             ret.append(row)\n>         from sage.combinat.output import tex_from_array\n>         return tex_from_array(ret)\n> ```\n> \n> This will make it easier for people to visualize it.\n\n\nThis returns     \n\n```\n{\\def\\lr#1{\\multicolumn{1}{|@{\\hspace{.6ex}}c@{\\hspace{.6ex}}|}{\\raisebox{-.3ex}{$#1$}}}\n    \\raisebox{-.6ex}{$\\begin{array}[b]{*{5}c}\\cline{6-5}\n    \\lr{\\phantom{x}}&&&\\lr{\\phantom{x}}&\\\\\n    &&&&\\\\\\cline{5-5}\n    &&\\lr{\\phantom{x}}&&\\lr{\\phantom{x}}\\\\\\cline{5-5}\n    \\end{array}$}\n    }\n```\nwhich is not quite right.\n\nAfter playing with it, I think this looks better:\n\n```\n    {\\def\\lr#1{\\multicolumn{1}{|@{\\hspace{.6ex}}c@{\\hspace{.6ex}}|}{\\raisebox{-.3ex}{$#1$}}}\n    \\raisebox{-.6ex}{$\\begin{array}[b]{*{6}{p{0.6ex}}} \\cline{1-1}\\cline{4-4}\\cline{6-5}\n    \\lr{\\phantom{x}}&&&\\lr{\\phantom{x}}&\\\\\\cline{1-1}\\cline{4-4}\n    &&&&\\\\\\cline{5-5} \\cline{3-3}\n    &&\\lr{\\phantom{x}}&&\\lr{\\phantom{x}}\\\\\\cline{5-5} \\cline{3-3}\n    \\end{array}$}\n    }\n```\n\nwhich adds lots of `\\cline`s to get the boxes and also makes each box including empty boxes a square. \n\nDoes it make sense to just do a custom tex implementation rather than using `tex_from_array`?",
    "created_at": "2022-09-23T11:53:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515944",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:59'></a>Replying to [comment:56 Travis Scrimshaw]:

> It would be good to add a `_latex_[young_diagram]()` like `SkewPartition` that does
> 
> ```python
>     def _latex_(self):
>         if not self._list:
>             return "{\\emptyset}"
> 
>         ret = []
>         for i in range(self._n_rows):
>             row = []
>             for j in range(self._n_cols):
>                 row.append("\\phantom{x}" if (i, j) in self else None)
>             ret.append(row)
>         from sage.combinat.output import tex_from_array
>         return tex_from_array(ret)
> ```
> 
> This will make it easier for people to visualize it.


This returns     

```
{\def\lr#1{\multicolumn{1}{|@{\hspace{.6ex}}c@{\hspace{.6ex}}|}{\raisebox{-.3ex}{$#1$}}}
    \raisebox{-.6ex}{$\begin{array}[b]{*{5}c}\cline{6-5}
    \lr{\phantom{x}}&&&\lr{\phantom{x}}&\\
    &&&&\\\cline{5-5}
    &&\lr{\phantom{x}}&&\lr{\phantom{x}}\\\cline{5-5}
    \end{array}$}
    }
```
which is not quite right.

After playing with it, I think this looks better:

```
    {\def\lr#1{\multicolumn{1}{|@{\hspace{.6ex}}c@{\hspace{.6ex}}|}{\raisebox{-.3ex}{$#1$}}}
    \raisebox{-.6ex}{$\begin{array}[b]{*{6}{p{0.6ex}}} \cline{1-1}\cline{4-4}\cline{6-5}
    \lr{\phantom{x}}&&&\lr{\phantom{x}}&\\\cline{1-1}\cline{4-4}
    &&&&\\\cline{5-5} \cline{3-3}
    &&\lr{\phantom{x}}&&\lr{\phantom{x}}\\\cline{5-5} \cline{3-3}
    \end{array}$}
    }
```

which adds lots of `\cline`s to get the boxes and also makes each box including empty boxes a square. 

Does it make sense to just do a custom tex implementation rather than using `tex_from_array`?



---

archive/issue_comments_515945.json:
```json
{
    "body": "<a id='comment:60'></a>So the `tex_from_array` actually makes an assumption that the rows are continuous. That is probably what is leading to the incorrect output. If you have a way to do a simple fix `tex_from_skew_array`, then do it (it doesn't need to be fast because the latex compiling is vastly slower than almost anything you will do). Of course, you are safe doing a separate `tex_from_diagram` or something like that. Your choice.",
    "created_at": "2022-09-23T12:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515945",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:60'></a>So the `tex_from_array` actually makes an assumption that the rows are continuous. That is probably what is leading to the incorrect output. If you have a way to do a simple fix `tex_from_skew_array`, then do it (it doesn't need to be fast because the latex compiling is vastly slower than almost anything you will do). Of course, you are safe doing a separate `tex_from_diagram` or something like that. Your choice.



---

archive/issue_comments_515946.json:
```json
{
    "body": "<a id='comment:61'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-23T12:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515946",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:61'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515947.json:
```json
{
    "body": "<a id='comment:62'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-23T19:09:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515947",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:62'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515948.json:
```json
{
    "body": "<a id='comment:63'></a>Ok! I think that takes care of printing/art things.",
    "created_at": "2022-09-23T19:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515948",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:63'></a>Ok! I think that takes care of printing/art things.



---

archive/issue_comments_515949.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-24T04:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515949",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_515950.json:
```json
{
    "body": "<a id='comment:64'></a>Thank you. LGTM.",
    "created_at": "2022-09-24T04:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515950",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:64'></a>Thank you. LGTM.



---

archive/issue_comments_515951.json:
```json
{
    "body": "<a id='comment:65'></a>the linter says\n\n```\nsage/combinat/diagram.py:316:96: E711 comparison to None should be 'if cond is not None:'\n18\nsage/combinat/diagram.py:318:106: E711 comparison to None should be 'if cond is not None:'\n19\nsage/combinat/diagram.py:320:105: E711 comparison to None should be 'if cond is not None:'\n20\nsage/combinat/diagram.py:321:96: E711 comparison to None should be 'if cond is not None:'\n```",
    "created_at": "2022-09-24T06:04:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515951",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:65'></a>the linter says

```
sage/combinat/diagram.py:316:96: E711 comparison to None should be 'if cond is not None:'
18
sage/combinat/diagram.py:318:106: E711 comparison to None should be 'if cond is not None:'
19
sage/combinat/diagram.py:320:105: E711 comparison to None should be 'if cond is not None:'
20
sage/combinat/diagram.py:321:96: E711 comparison to None should be 'if cond is not None:'
```



---

archive/issue_comments_515952.json:
```json
{
    "body": "<a id='comment:66'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2022-09-24T13:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515952",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:66'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_515953.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-09-24T13:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515953",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_515954.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:65 Fr\u00e9d\u00e9ric Chapoton]:\n> the linter says\n> \n> ```\n> sage/combinat/diagram.py:316:96: E711 comparison to None should be 'if cond is not None:'\n> 18\n> sage/combinat/diagram.py:318:106: E711 comparison to None should be 'if cond is not None:'\n> 19\n> sage/combinat/diagram.py:320:105: E711 comparison to None should be 'if cond is not None:'\n> 20\n> sage/combinat/diagram.py:321:96: E711 comparison to None should be 'if cond is not None:'\n> ```\n\n\nFixed!",
    "created_at": "2022-09-24T13:30:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515954",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:67'></a>Replying to [comment:65 Frédéric Chapoton]:
> the linter says
> 
> ```
> sage/combinat/diagram.py:316:96: E711 comparison to None should be 'if cond is not None:'
> 18
> sage/combinat/diagram.py:318:106: E711 comparison to None should be 'if cond is not None:'
> 19
> sage/combinat/diagram.py:320:105: E711 comparison to None should be 'if cond is not None:'
> 20
> sage/combinat/diagram.py:321:96: E711 comparison to None should be 'if cond is not None:'
> ```


Fixed!



---

archive/issue_comments_515955.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-24T15:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515955",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_515956.json:
```json
{
    "body": "<a id='comment:69'></a>Thanks. I don't know how I missed that.",
    "created_at": "2022-09-25T00:53:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515956",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:69'></a>Thanks. I don't know how I missed that.



---

archive/issue_comments_515957.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-09-25T20:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515957",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_515958.json:
```json
{
    "body": "<a id='comment:70'></a>Merge failure on top of:\n\n5d7b401269e Trac #33816: Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21, gsl to 2.7.1\n\na802d076b46 Trac #31664: Add package msolve 0.4.4 (multivariate polynomial system solver)\n\n4541564cf15 Updated [SageMath](SageMath) version to 9.8.beta0\n\n\n\nmerge was not clean: conflicts in src/sage/combinat/partition.py",
    "created_at": "2022-09-25T20:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515958",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:70'></a>Merge failure on top of:

5d7b401269e Trac #33816: Update gcc/gfortran to 12.x + Apple Silicon support, update openblas to 0.3.21, gsl to 2.7.1

a802d076b46 Trac #31664: Add package msolve 0.4.4 (multivariate polynomial system solver)

4541564cf15 Updated [SageMath](SageMath) version to 9.8.beta0



merge was not clean: conflicts in src/sage/combinat/partition.py



---

archive/issue_comments_515959.json:
```json
{
    "body": "<a id='comment:71'></a>needs to be rebased",
    "created_at": "2022-09-28T12:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515959",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:71'></a>needs to be rebased



---

archive/issue_comments_515960.json:
```json
{
    "body": "<a id='comment:72'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-10-11T23:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515960",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:72'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_515961.json:
```json
{
    "body": "<a id='comment:73'></a>Rebased, but now a test fails.",
    "created_at": "2022-10-11T23:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515961",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:73'></a>Rebased, but now a test fails.



---

archive/issue_comments_515962.json:
```json
{
    "body": "<a id='comment:74'></a>My guess is somewhere there is a multiplication convention issue:\n\n```\nsage: p = Permutation([4,5,2,3,1])\nsage: W = WeylGroup(['A',4])\nsage: W.from_reduced_word(p.reduced_word()).stanley_symmetric_function()\n56*m[1, 1, 1, 1, 1, 1, 1, 1] + 26*m[2, 1, 1, 1, 1, 1, 1] + 12*m[2, 2, 1, 1, 1, 1]\n + 5*m[2, 2, 2, 1, 1] + 2*m[2, 2, 2, 2] + 6*m[3, 1, 1, 1, 1, 1]\n + 3*m[3, 2, 1, 1, 1] + m[3, 2, 2, 1] + m[3, 3, 1, 1]\nsage: W.from_reduced_word(reversed(p.reduced_word())).stanley_symmetric_function()\n56*m[1, 1, 1, 1, 1, 1, 1, 1] + 30*m[2, 1, 1, 1, 1, 1, 1] + 16*m[2, 2, 1, 1, 1, 1]\n + 9*m[2, 2, 2, 1, 1] + 6*m[2, 2, 2, 2] + 10*m[3, 1, 1, 1, 1, 1] + 5*m[3, 2, 1, 1, 1]\n + 3*m[3, 2, 2, 1] + m[3, 3, 1, 1] + m[3, 3, 2] + 2*m[4, 1, 1, 1, 1] + m[4, 2, 1, 1] + m[4, 2, 2]\n```\nA very annoying subtlety to deal with (which we can usually just hand-wave away), but we have to deal with here. Actually, I suspect the former is the \"correct\" output doing:\n\n```\nsage: P5 = Permutations(5)\nsage: p = P5([4,5,2,3,1])\nsage: p.stanley_symmetric_function()\nRecursionError\nsage: P5.options.mult = 'r2l'\nsage: p.stanley_symmetric_function()\n56*m[1, 1, 1, 1, 1, 1, 1, 1] + 26*m[2, 1, 1, 1, 1, 1, 1] + 12*m[2, 2, 1, 1, 1, 1]\n + 5*m[2, 2, 2, 1, 1] + 2*m[2, 2, 2, 2] + 6*m[3, 1, 1, 1, 1, 1]\n + 3*m[3, 2, 1, 1, 1] + m[3, 2, 2, 1] + m[3, 3, 1, 1]\n```\nAlthough annoyingly this is different from `p.to_permutation_group_element().stanley_symmetric_function()`. It might just be a matter of documenting what convention you use as both are \"correct.\"\n\nOne extra thing I noticed, you can pull out the inverse here to not redo it so many times:\n\n```diff\n+    winv = w.inverse()\n     cells = [c for c in cartesian_product_iterator((range(N), range(N)))\n-             if c[0]+1 < w.inverse()(c[1]+1) and c[1]+1 < w(c[0]+1)]\n+             if c[0]+1 < winv(c[1]+1) and c[1]+1 < w(c[0]+1)]\n```",
    "created_at": "2022-10-12T05:12:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515962",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:74'></a>My guess is somewhere there is a multiplication convention issue:

```
sage: p = Permutation([4,5,2,3,1])
sage: W = WeylGroup(['A',4])
sage: W.from_reduced_word(p.reduced_word()).stanley_symmetric_function()
56*m[1, 1, 1, 1, 1, 1, 1, 1] + 26*m[2, 1, 1, 1, 1, 1, 1] + 12*m[2, 2, 1, 1, 1, 1]
 + 5*m[2, 2, 2, 1, 1] + 2*m[2, 2, 2, 2] + 6*m[3, 1, 1, 1, 1, 1]
 + 3*m[3, 2, 1, 1, 1] + m[3, 2, 2, 1] + m[3, 3, 1, 1]
sage: W.from_reduced_word(reversed(p.reduced_word())).stanley_symmetric_function()
56*m[1, 1, 1, 1, 1, 1, 1, 1] + 30*m[2, 1, 1, 1, 1, 1, 1] + 16*m[2, 2, 1, 1, 1, 1]
 + 9*m[2, 2, 2, 1, 1] + 6*m[2, 2, 2, 2] + 10*m[3, 1, 1, 1, 1, 1] + 5*m[3, 2, 1, 1, 1]
 + 3*m[3, 2, 2, 1] + m[3, 3, 1, 1] + m[3, 3, 2] + 2*m[4, 1, 1, 1, 1] + m[4, 2, 1, 1] + m[4, 2, 2]
```
A very annoying subtlety to deal with (which we can usually just hand-wave away), but we have to deal with here. Actually, I suspect the former is the "correct" output doing:

```
sage: P5 = Permutations(5)
sage: p = P5([4,5,2,3,1])
sage: p.stanley_symmetric_function()
RecursionError
sage: P5.options.mult = 'r2l'
sage: p.stanley_symmetric_function()
56*m[1, 1, 1, 1, 1, 1, 1, 1] + 26*m[2, 1, 1, 1, 1, 1, 1] + 12*m[2, 2, 1, 1, 1, 1]
 + 5*m[2, 2, 2, 1, 1] + 2*m[2, 2, 2, 2] + 6*m[3, 1, 1, 1, 1, 1]
 + 3*m[3, 2, 1, 1, 1] + m[3, 2, 2, 1] + m[3, 3, 1, 1]
```
Although annoyingly this is different from `p.to_permutation_group_element().stanley_symmetric_function()`. It might just be a matter of documenting what convention you use as both are "correct."

One extra thing I noticed, you can pull out the inverse here to not redo it so many times:

```diff
+    winv = w.inverse()
     cells = [c for c in cartesian_product_iterator((range(N), range(N)))
-             if c[0]+1 < w.inverse()(c[1]+1) and c[1]+1 < w(c[0]+1)]
+             if c[0]+1 < winv(c[1]+1) and c[1]+1 < w(c[0]+1)]
```



---

archive/issue_comments_515963.json:
```json
{
    "body": "<a id='comment:75'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-13T04:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515963",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:75'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_515964.json:
```json
{
    "body": "<a id='comment:76'></a>I realized that the Stanley symmetric function things should be on #34335 instead (where they have the correct multiplication convention) so I removed them from this ticket. I think this is ready.",
    "created_at": "2022-10-13T04:14:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515964",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:76'></a>I realized that the Stanley symmetric function things should be on #34335 instead (where they have the correct multiplication convention) so I removed them from this ticket. I think this is ready.



---

archive/issue_comments_515965.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-10-13T04:14:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515965",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_515966.json:
```json
{
    "body": "<a id='comment:78'></a>Tests are passing for me, but it might be good to wait for the patchbot one more time.",
    "created_at": "2022-10-13T04:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515966",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:78'></a>Tests are passing for me, but it might be good to wait for the patchbot one more time.



---

archive/issue_comments_515967.json:
```json
{
    "body": "<a id='comment:79'></a>I made some changes to the doc and the unicode output. If my changes are good, back to a positive review.\n\n---\nNew commits:",
    "created_at": "2022-10-14T07:29:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515967",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:79'></a>I made some changes to the doc and the unicode output. If my changes are good, back to a positive review.

---
New commits:



---

archive/issue_comments_515968.json:
```json
{
    "body": "<a id='comment:80'></a>It looks like pyflakes is raising some warnings about unused variables. I'm changing/testing those now, but your changes LGTM.",
    "created_at": "2022-10-15T13:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515968",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:80'></a>It looks like pyflakes is raising some warnings about unused variables. I'm changing/testing those now, but your changes LGTM.



---

archive/issue_comments_515969.json:
```json
{
    "body": "<a id='comment:81'></a>New commits:",
    "created_at": "2022-10-15T14:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515969",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:81'></a>New commits:



---

archive/issue_comments_515970.json:
```json
{
    "body": "<a id='comment:82'></a>All the tests pass on my end - I'll wait for patchbot.",
    "created_at": "2022-10-15T14:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515970",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:82'></a>All the tests pass on my end - I'll wait for patchbot.



---

archive/issue_comments_515971.json:
```json
{
    "body": "<a id='comment:83'></a>Green bot.",
    "created_at": "2022-10-16T04:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515971",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:83'></a>Green bot.



---

archive/issue_comments_515972.json:
```json
{
    "body": "<a id='comment:84'></a>so what is this now waiting for ?",
    "created_at": "2022-10-27T14:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515972",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:84'></a>so what is this now waiting for ?



---

archive/issue_comments_515973.json:
```json
{
    "body": "<a id='comment:85'></a>Nothing. Thanks Fr\u00e9d\u00e9ric",
    "created_at": "2022-10-27T15:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515973",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:85'></a>Nothing. Thanks Frédéric



---

archive/issue_comments_515974.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-10-27T15:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515974",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_515975.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-11-07T20:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34260#issuecomment-515975",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_089302.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-11-07T20:26:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34260",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34260#event-89302"
}
```
