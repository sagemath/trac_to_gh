# Issue 34681: Error with multiplication of points on elliptic curves over Integers(n)

archive/issues_034444.json:
```json
{
    "body": "\n```\nsage: E = EllipticCurve(Integers(11*19), [1,0])\nsage: P = E(93,3)\nsage: P + P\n(5 : 118 : 1)\nsage: 2 * P\n...\nAttributeError: 'EllipticCurve_generic_with_category' object has no attribute 'base_field'\n```\n\n\n**CC:**  @yyyyx4\n\n**Branch/Commit:** [9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1](https://github.com/sagemath/sagetrac-mirror/commit/9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1)\n\n**Reviewer:** Lorenz Panny\n\n**Author:** Gonzalo Tornar\u00eda\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34681\n\n",
    "closed_at": "2022-11-07T20:25:47Z",
    "created_at": "2022-10-20T20:15:48Z",
    "labels": [
        "component: number theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Error with multiplication of points on elliptic curves over Integers(n)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34681",
    "user": "https://github.com/tornaria"
}
```

```
sage: E = EllipticCurve(Integers(11*19), [1,0])
sage: P = E(93,3)
sage: P + P
(5 : 118 : 1)
sage: 2 * P
...
AttributeError: 'EllipticCurve_generic_with_category' object has no attribute 'base_field'
```


**CC:**  @yyyyx4

**Branch/Commit:** [9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1](https://github.com/sagemath/sagetrac-mirror/commit/9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1)

**Reviewer:** Lorenz Panny

**Author:** Gonzalo Tornaría

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/34681





---

archive/issue_comments_689548.json:
```json
{
    "body": "**Commit:** [6d31aad9f67f9ff414b4dbdce70444d9f0b69004](https://github.com/sagemath/sagetrac-mirror/commit/6d31aad9f67f9ff414b4dbdce70444d9f0b69004)",
    "created_at": "2022-10-20T21:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689548",
    "user": "https://github.com/tornaria"
}
```

**Commit:** [6d31aad9f67f9ff414b4dbdce70444d9f0b69004](https://github.com/sagemath/sagetrac-mirror/commit/6d31aad9f67f9ff414b4dbdce70444d9f0b69004)



---

archive/issue_comments_689549.json:
```json
{
    "body": "**Author:** Gonzalo Tornar\u00eda",
    "created_at": "2022-10-20T21:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689549",
    "user": "https://github.com/tornaria"
}
```

**Author:** Gonzalo Tornaría



---

archive/issue_comments_689550.json:
```json
{
    "body": "**Branch:** [u/tornaria/34681](https://github.com/sagemath/sagetrac-mirror/tree/u/tornaria/34681)",
    "created_at": "2022-10-20T21:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689550",
    "user": "https://github.com/tornaria"
}
```

**Branch:** [u/tornaria/34681](https://github.com/sagemath/sagetrac-mirror/tree/u/tornaria/34681)



---

archive/issue_comments_689551.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2022-10-20T21:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689551",
    "user": "https://github.com/tornaria"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_689552.json:
```json
{
    "body": "**Changing commit** from \"[6d31aad9f67f9ff414b4dbdce70444d9f0b69004](https://github.com/sagemath/sagetrac-mirror/commit/6d31aad9f67f9ff414b4dbdce70444d9f0b69004)\" to \"[9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1](https://github.com/sagemath/sagetrac-mirror/commit/9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1)\".",
    "created_at": "2022-10-20T21:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689552",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6d31aad9f67f9ff414b4dbdce70444d9f0b69004](https://github.com/sagemath/sagetrac-mirror/commit/6d31aad9f67f9ff414b4dbdce70444d9f0b69004)" to "[9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1](https://github.com/sagemath/sagetrac-mirror/commit/9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1)".



---

archive/issue_comments_689553.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb5833f39ec177f501092470abddf7a74ffc60a5\">eb5833f</a></td><td><code>#34681: fix multiplication of points over Integers(n)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1\">9bbacfe</a></td><td><code>#34681: do not redo multiplication when pari fails</code></td></tr></table>\n",
    "created_at": "2022-10-20T21:11:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689553",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb5833f39ec177f501092470abddf7a74ffc60a5">eb5833f</a></td><td><code>#34681: fix multiplication of points over Integers(n)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1">9bbacfe</a></td><td><code>#34681: do not redo multiplication when pari fails</code></td></tr></table>




---

archive/issue_comments_689554.json:
```json
{
    "body": "<a id='comment:3'></a>\nRelated: #33228",
    "created_at": "2022-10-21T03:22:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689554",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:3'></a>
Related: #33228



---

archive/issue_comments_689555.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [Lorenz Panny](#comment%3A3):\n> Related: #33228\n\n\nThanks for the info. Looks quite interesting. However, this fix here seems trivial -- can we get this in? At the very least the first commit.\n\nAlso, given that pari `ellmul` works with integer mod composite (in the sense that it either gives the right answer or gives a `Fp_inv` error) it seems a pity to fall back to a generic implementation as in #33228.\n\nSame as mentioned in #33228, this was spotted by a student trying to implement ECM. It seems an important application... If point multiplication is implemented via `ellmul` this means the students might even have a shot at getting good speed if they can figure out how to choose the parameters.",
    "created_at": "2022-10-21T13:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689555",
    "user": "https://github.com/tornaria"
}
```

<a id='comment:4'></a>
Replying to [Lorenz Panny](#comment%3A3):
> Related: #33228


Thanks for the info. Looks quite interesting. However, this fix here seems trivial -- can we get this in? At the very least the first commit.

Also, given that pari `ellmul` works with integer mod composite (in the sense that it either gives the right answer or gives a `Fp_inv` error) it seems a pity to fall back to a generic implementation as in #33228.

Same as mentioned in #33228, this was spotted by a student trying to implement ECM. It seems an important application... If point multiplication is implemented via `ellmul` this means the students might even have a shot at getting good speed if they can figure out how to choose the parameters.



---

archive/issue_comments_689556.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2022-11-03T06:06:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689556",
    "user": "https://github.com/yyyyx4"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_689557.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [Gonzalo Tornar\u00eda](#comment%3A4):\n> However, this fix here seems trivial -- can we get this in?\n\n\nIndeed, why not.",
    "created_at": "2022-11-03T06:06:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689557",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:5'></a>
Replying to [Gonzalo Tornaría](#comment%3A4):
> However, this fix here seems trivial -- can we get this in?


Indeed, why not.



---

archive/issue_comments_689558.json:
```json
{
    "body": "**Reviewer:** Lorenz Panny",
    "created_at": "2022-11-03T06:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689558",
    "user": "https://github.com/yyyyx4"
}
```

**Reviewer:** Lorenz Panny



---

archive/issue_events_101106.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-11-07T20:25:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34681#event-101106"
}
```



---

archive/issue_comments_689559.json:
```json
{
    "body": "**Changing branch** from \"[u/tornaria/34681](https://github.com/sagemath/sagetrac-mirror/tree/u/tornaria/34681)\" to \"[9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1](https://github.com/sagemath/sagetrac-mirror/commit/9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1)\".",
    "created_at": "2022-11-07T20:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689559",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/tornaria/34681](https://github.com/sagemath/sagetrac-mirror/tree/u/tornaria/34681)" to "[9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1](https://github.com/sagemath/sagetrac-mirror/commit/9bbacfe4e0232a26b2e50c93e8eed1c01c073ae1)".



---

archive/issue_comments_689560.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2022-11-07T20:25:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34681",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34681#issuecomment-689560",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed
