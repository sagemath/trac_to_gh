# Issue 34479: Polyhedron(backend='number_field')

archive/issues_034242.json:
```json
{
    "body": "(from #33752)\n\nWe lift the conversion code that sends symbolic and AA elements to a suitable embedded number field and back from the backend `normaliz` and create a new backend `number_field`, which just runs backend `field` on the converted number field elements.\n\nThis results in rather general (but slow) polyhedral code for algebraic data in pure Python.\n\n\nCC:  @yuan-zhou @kliem @jplab @videlec @tscrim\n\nBranch/Commit: c729884f9c1c4b6921fa2b6f0d6da92256f6811d\n\nReviewer: Matthias Koeppe, Travis Scrimshaw\n\nAuthor: Matthias Koeppe, Yuan Zhou\n\nDependencies: #34195\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34479\n\n",
    "closed_at": "2022-09-28T23:04:13Z",
    "created_at": "2022-09-02T02:29:55Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Polyhedron(backend='number_field')",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34479",
    "user": "https://github.com/mkoeppe"
}
```
(from #33752)

We lift the conversion code that sends symbolic and AA elements to a suitable embedded number field and back from the backend `normaliz` and create a new backend `number_field`, which just runs backend `field` on the converted number field elements.

This results in rather general (but slow) polyhedral code for algebraic data in pure Python.


CC:  @yuan-zhou @kliem @jplab @videlec @tscrim

Branch/Commit: c729884f9c1c4b6921fa2b6f0d6da92256f6811d

Reviewer: Matthias Koeppe, Travis Scrimshaw

Author: Matthias Koeppe, Yuan Zhou

Dependencies: #34195

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34479





---

archive/issue_comments_686719.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n (from #33752)\n \n We lift the conversion code that sends symbolic and AA elements to a suitable embedded number field and back from Normaliz and create a new backend `number_field`, which just runs backend `field` on the converted number field elements.\n+\n+This results in rather general (but slow) polyhedral code for algebraic data in pure Python.\n+\n``````\n",
    "created_at": "2022-09-02T02:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686719",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
 (from #33752)
 
 We lift the conversion code that sends symbolic and AA elements to a suitable embedded number field and back from Normaliz and create a new backend `number_field`, which just runs backend `field` on the converted number field elements.
+
+This results in rather general (but slow) polyhedral code for algebraic data in pure Python.
+
``````




---

archive/issue_comments_686720.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/polyhedron_backend__number_field__\"",
    "created_at": "2022-09-02T02:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686720",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/polyhedron_backend__number_field__"



---

archive/issue_comments_686721.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|\n|[7ff3df5](https://git.sagemath.org/sage.git/commit/?id=7ff3df5686e7e9a8aef1f599b8d8195040524933)|`src/sage/geometry/polyhedron/{base,backend}_number_field.py: New, move some code here from backend_normaliz`|",
    "created_at": "2022-09-02T02:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
|[7ff3df5](https://git.sagemath.org/sage.git/commit/?id=7ff3df5686e7e9a8aef1f599b8d8195040524933)|`src/sage/geometry/polyhedron/{base,backend}_number_field.py: New, move some code here from backend_normaliz`|



---

archive/issue_comments_686722.json:
```json
{
    "body": "Changing commit from \"\" to \"7ff3df5686e7e9a8aef1f599b8d8195040524933\"",
    "created_at": "2022-09-02T02:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686722",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "7ff3df5686e7e9a8aef1f599b8d8195040524933"



---

archive/issue_comments_686723.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe, ...\"",
    "created_at": "2022-09-02T02:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686723",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe, ..."



---

archive/issue_comments_686724.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n (from #33752)\n \n-We lift the conversion code that sends symbolic and AA elements to a suitable embedded number field and back from Normaliz and create a new backend `number_field`, which just runs backend `field` on the converted number field elements.\n+We lift the conversion code that sends symbolic and AA elements to a suitable embedded number field and back from the backend `normaliz` and create a new backend `number_field`, which just runs backend `field` on the converted number field elements.\n \n This results in rather general (but slow) polyhedral code for algebraic data in pure Python.\n \n``````\n",
    "created_at": "2022-09-02T02:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686724",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 (from #33752)
 
-We lift the conversion code that sends symbolic and AA elements to a suitable embedded number field and back from Normaliz and create a new backend `number_field`, which just runs backend `field` on the converted number field elements.
+We lift the conversion code that sends symbolic and AA elements to a suitable embedded number field and back from the backend `normaliz` and create a new backend `number_field`, which just runs backend `field` on the converted number field elements.
 
 This results in rather general (but slow) polyhedral code for algebraic data in pure Python.
 
``````




---

archive/issue_comments_686725.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#34195\"",
    "created_at": "2022-09-02T03:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686725",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#34195"



---

archive/issue_comments_686726.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n|[278b93f](https://git.sagemath.org/sage.git/commit/?id=278b93f390a1caf8e511409e2ee0e39697aed8c3)|`sage.geometry: More # optional - sage.rings.number_field`|\n|[0f12ac2](https://git.sagemath.org/sage.git/commit/?id=0f12ac293022f5c43c8d2497b44ea8d69a34685e)|`src/sage/geometry/polyhedron/base0.py: Restore lost imports`|\n|[74bc04b](https://git.sagemath.org/sage.git/commit/?id=74bc04b8493ec925a4cfcd33dbc73cf078d08d06)|`src/sage/geometry/polyhedron/base{3,6}.py: Muffle pyflakes warnings about unused imports`|\n|[7db47e1](https://git.sagemath.org/sage.git/commit/?id=7db47e13d73818b34da78c7f6ee05005b5206bc7)|`src/sage/geometry/polyhedron/parent.py: Muffle pyflakes warning`|\n|[6dd4f07](https://git.sagemath.org/sage.git/commit/?id=6dd4f075e8a81a28292d5badbbeab2024b0c4e26)|`src/sage/geometry/polyhedron/base.py: Remove unused import`|\n|[1ede214](https://git.sagemath.org/sage.git/commit/?id=1ede2147fc76bfb2ce9cba350f5cc579d352922a)|`src/sage/geometry/polyhedron/backend_normaliz.py: Add missing imports`|\n|[341475c](https://git.sagemath.org/sage.git/commit/?id=341475cb0bf03648c3de3d55173ba09f33cedd59)|`src/sage/geometry/polyhedron/base_ZZ.py: Replace .all import`|\n|[dd87ab9](https://git.sagemath.org/sage.git/commit/?id=dd87ab9052cc87f16f26f17d2f6aa07894945be7)|`Merge tag '9.7.rc0' into t/34195/sage_geometry_polyhedron__more___optional___sage_rings_number_field`|\n|[f12e71c](https://git.sagemath.org/sage.git/commit/?id=f12e71ca415f4f7b996e162cfe2e7fcc218fb0db)|`Merge #34195`|\n|[ffe0fda](https://git.sagemath.org/sage.git/commit/?id=ffe0fda0fdec0c4e8266eb8dbd0d33cdb73e66a9)|`Fix remaining imports`|",
    "created_at": "2022-09-02T03:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686726",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
|[278b93f](https://git.sagemath.org/sage.git/commit/?id=278b93f390a1caf8e511409e2ee0e39697aed8c3)|`sage.geometry: More # optional - sage.rings.number_field`|
|[0f12ac2](https://git.sagemath.org/sage.git/commit/?id=0f12ac293022f5c43c8d2497b44ea8d69a34685e)|`src/sage/geometry/polyhedron/base0.py: Restore lost imports`|
|[74bc04b](https://git.sagemath.org/sage.git/commit/?id=74bc04b8493ec925a4cfcd33dbc73cf078d08d06)|`src/sage/geometry/polyhedron/base{3,6}.py: Muffle pyflakes warnings about unused imports`|
|[7db47e1](https://git.sagemath.org/sage.git/commit/?id=7db47e13d73818b34da78c7f6ee05005b5206bc7)|`src/sage/geometry/polyhedron/parent.py: Muffle pyflakes warning`|
|[6dd4f07](https://git.sagemath.org/sage.git/commit/?id=6dd4f075e8a81a28292d5badbbeab2024b0c4e26)|`src/sage/geometry/polyhedron/base.py: Remove unused import`|
|[1ede214](https://git.sagemath.org/sage.git/commit/?id=1ede2147fc76bfb2ce9cba350f5cc579d352922a)|`src/sage/geometry/polyhedron/backend_normaliz.py: Add missing imports`|
|[341475c](https://git.sagemath.org/sage.git/commit/?id=341475cb0bf03648c3de3d55173ba09f33cedd59)|`src/sage/geometry/polyhedron/base_ZZ.py: Replace .all import`|
|[dd87ab9](https://git.sagemath.org/sage.git/commit/?id=dd87ab9052cc87f16f26f17d2f6aa07894945be7)|`Merge tag '9.7.rc0' into t/34195/sage_geometry_polyhedron__more___optional___sage_rings_number_field`|
|[f12e71c](https://git.sagemath.org/sage.git/commit/?id=f12e71ca415f4f7b996e162cfe2e7fcc218fb0db)|`Merge #34195`|
|[ffe0fda](https://git.sagemath.org/sage.git/commit/?id=ffe0fda0fdec0c4e8266eb8dbd0d33cdb73e66a9)|`Fix remaining imports`|



---

archive/issue_comments_686727.json:
```json
{
    "body": "Changing commit from \"7ff3df5686e7e9a8aef1f599b8d8195040524933\" to \"ffe0fda0fdec0c4e8266eb8dbd0d33cdb73e66a9\"",
    "created_at": "2022-09-02T03:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686727",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7ff3df5686e7e9a8aef1f599b8d8195040524933" to "ffe0fda0fdec0c4e8266eb8dbd0d33cdb73e66a9"



---

archive/issue_comments_686728.json:
```json
{
    "body": "Changing commit from \"ffe0fda0fdec0c4e8266eb8dbd0d33cdb73e66a9\" to \"4a84278e3baa8e005938d3501c0063b3adf2c031\"",
    "created_at": "2022-09-02T03:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686728",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ffe0fda0fdec0c4e8266eb8dbd0d33cdb73e66a9" to "4a84278e3baa8e005938d3501c0063b3adf2c031"



---

archive/issue_comments_686729.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|\n|[4a84278](https://git.sagemath.org/sage.git/commit/?id=4a84278e3baa8e005938d3501c0063b3adf2c031)|`src/sage/geometry/polyhedron/parent.py: Add Polyhedra_number_field`|",
    "created_at": "2022-09-02T03:42:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686729",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
|[4a84278](https://git.sagemath.org/sage.git/commit/?id=4a84278e3baa8e005938d3501c0063b3adf2c031)|`src/sage/geometry/polyhedron/parent.py: Add Polyhedra_number_field`|



---

archive/issue_comments_686730.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|\n|[58218d2](https://git.sagemath.org/sage.git/commit/?id=58218d22810d6fad9baec7cd1e726d4ba33e55f2)|`src/sage/geometry/polyhedron/backend_number_field.py: Add stubs for methods in which conversion needs to be called`|",
    "created_at": "2022-09-02T03:55:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686730",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|
|[58218d2](https://git.sagemath.org/sage.git/commit/?id=58218d22810d6fad9baec7cd1e726d4ba33e55f2)|`src/sage/geometry/polyhedron/backend_number_field.py: Add stubs for methods in which conversion needs to be called`|



---

archive/issue_comments_686731.json:
```json
{
    "body": "Changing commit from \"4a84278e3baa8e005938d3501c0063b3adf2c031\" to \"58218d22810d6fad9baec7cd1e726d4ba33e55f2\"",
    "created_at": "2022-09-02T03:55:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686731",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4a84278e3baa8e005938d3501c0063b3adf2c031" to "58218d22810d6fad9baec7cd1e726d4ba33e55f2"



---

archive/issue_comments_686732.json:
```json
{
    "body": "<a id='comment:10'></a>\n`assert polymake_base_field  # to muffle pyflakes` breaks polymake tests\n\nMy workaround is\n\n```diff\n     elif backend == 'polymake':\n         base_field = base_ring.fraction_field()\n         try:\n-            from sage.interfaces.polymake import polymake\n+            from sage.interfaces.polymake import polymake, PolymakeElement\n             polymake_base_field = polymake(base_field)\n+            assert isinstance(polymake_base_field, PolymakeElement)  # to muffle pyflakes\n         except TypeError:\n```",
    "created_at": "2022-09-02T12:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686732",
    "user": "https://github.com/sheerluck"
}
```

<a id='comment:10'></a>
`assert polymake_base_field  # to muffle pyflakes` breaks polymake tests

My workaround is

```diff
     elif backend == 'polymake':
         base_field = base_ring.fraction_field()
         try:
-            from sage.interfaces.polymake import polymake
+            from sage.interfaces.polymake import polymake, PolymakeElement
             polymake_base_field = polymake(base_field)
+            assert isinstance(polymake_base_field, PolymakeElement)  # to muffle pyflakes
         except TypeError:
```



---

archive/issue_comments_686733.json:
```json
{
    "body": "<a id='comment:11'></a>\nThanks for catching this. This is actually from #34195",
    "created_at": "2022-09-02T15:04:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686733",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Thanks for catching this. This is actually from #34195



---

archive/issue_comments_686734.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/polyhedron_backend__number_field__\" to \"u/yzh/polyhedron_backend__number_field__\"",
    "created_at": "2022-09-09T01:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686734",
    "user": "https://github.com/yuan-zhou"
}
```

Changing branch from "u/mkoeppe/polyhedron_backend__number_field__" to "u/yzh/polyhedron_backend__number_field__"



---

archive/issue_comments_686735.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[805b8b7](https://git.sagemath.org/sage.git/commit/?id=805b8b7f7e3555259aab93cc0c7783abd4aa6fe7)|`transform data to number field`|",
    "created_at": "2022-09-09T07:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686735",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[805b8b7](https://git.sagemath.org/sage.git/commit/?id=805b8b7f7e3555259aab93cc0c7783abd4aa6fe7)|`transform data to number field`|



---

archive/issue_comments_686736.json:
```json
{
    "body": "Changing commit from \"58218d22810d6fad9baec7cd1e726d4ba33e55f2\" to \"805b8b7f7e3555259aab93cc0c7783abd4aa6fe7\"",
    "created_at": "2022-09-09T07:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686736",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "58218d22810d6fad9baec7cd1e726d4ba33e55f2" to "805b8b7f7e3555259aab93cc0c7783abd4aa6fe7"



---

archive/issue_comments_686737.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-09T07:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686737",
    "user": "https://github.com/yuan-zhou"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_686738.json:
```json
{
    "body": "Changing author from \"Matthias Koeppe, ...\" to \"Matthias Koeppe, Yuan Zhou\"",
    "created_at": "2022-09-09T07:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686738",
    "user": "https://github.com/yuan-zhou"
}
```

Changing author from "Matthias Koeppe, ..." to "Matthias Koeppe, Yuan Zhou"



---

archive/issue_comments_686739.json:
```json
{
    "body": "<a id='comment:15'></a>\nProbably `_compute_nmz_data_lists_and_field` should be renamed",
    "created_at": "2022-09-09T14:25:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686739",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>
Probably `_compute_nmz_data_lists_and_field` should be renamed



---

archive/issue_comments_686740.json:
```json
{
    "body": "<a id='comment:16'></a>\n\n```\n     def _init_from_Vrepresentation(self, vertices, rays, lines,\n-                                   minimize=True, verbose=False):\n+                                   minimize=True, verbose=False, number_field=None):\n```\nAlso this new parameter should probably not be called `number_field` but rather `internal_base_ring` or something like this. \n\nThat we use a number field for the computation is specific to the new subclass `Polyhedron_number_field`. (Later, another subclass could be using `SymbolicValuesRing` from #30234.)",
    "created_at": "2022-09-09T15:52:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686740",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>

```
     def _init_from_Vrepresentation(self, vertices, rays, lines,
-                                   minimize=True, verbose=False):
+                                   minimize=True, verbose=False, number_field=None):
```
Also this new parameter should probably not be called `number_field` but rather `internal_base_ring` or something like this. 

That we use a number field for the computation is specific to the new subclass `Polyhedron_number_field`. (Later, another subclass could be using `SymbolicValuesRing` from #30234.)



---

archive/issue_comments_686741.json:
```json
{
    "body": "Changing branch from \"u/yzh/polyhedron_backend__number_field__\" to \"u/mkoeppe/polyhedron_backend__number_field__\"",
    "created_at": "2022-09-09T17:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686741",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "u/yzh/polyhedron_backend__number_field__" to "u/mkoeppe/polyhedron_backend__number_field__"



---

archive/issue_comments_686742.json:
```json
{
    "body": "Changing commit from \"805b8b7f7e3555259aab93cc0c7783abd4aa6fe7\" to \"ad74e4d3d3cd8e483e95a00ebb4fa120ec828008\"",
    "created_at": "2022-09-09T17:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686742",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "805b8b7f7e3555259aab93cc0c7783abd4aa6fe7" to "ad74e4d3d3cd8e483e95a00ebb4fa120ec828008"



---

archive/issue_comments_686743.json:
```json
{
    "body": "<a id='comment:18'></a>\nNew commits:\n|                                                                                                                                          |                                                                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|\n|[ad74e4d](https://git.sagemath.org/sage.git/commit?id=ad74e4d3d3cd8e483e95a00ebb4fa120ec828008)|`polyopes.generalized_polyhedron: Restructure doctests, add backend='number_field' tests`|",
    "created_at": "2022-09-09T17:19:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686743",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
New commits:
|                                                                                                                                          |                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
|[ad74e4d](https://git.sagemath.org/sage.git/commit?id=ad74e4d3d3cd8e483e95a00ebb4fa120ec828008)|`polyopes.generalized_polyhedron: Restructure doctests, add backend='number_field' tests`|



---

archive/issue_comments_686744.json:
```json
{
    "body": "<a id='comment:19'></a>\nHow about renaming it to `_compute_data_lists_and_internal_base_ring`?\nReplying to [Matthias K\u00f6ppe](#comment%3A15):\n> Probably `_compute_nmz_data_lists_and_field` should be renamed",
    "created_at": "2022-09-09T21:02:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686744",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:19'></a>
How about renaming it to `_compute_data_lists_and_internal_base_ring`?
Replying to [Matthias Köppe](#comment%3A15):
> Probably `_compute_nmz_data_lists_and_field` should be renamed



---

archive/issue_comments_686745.json:
```json
{
    "body": "<a id='comment:20'></a>\nSounds good. I notice that `backend_normaliz.py` has a similar attribute `self._normaliz_field = normaliz_field`, which is not always a field. Do we need to change that too?\n\nReplying to [Matthias K\u00f6ppe](#comment%3A16):\n> {{{\n>      def _init_from_Vrepresentation(self, vertices, rays, lines,\n> -                                   minimize=True, verbose=False):\n> +                                   minimize=True, verbose=False, number_field=None):\n> }}}\n> Also this new parameter should probably not be called `number_field` but rather `internal_base_ring` or something like this. \n> \n> That we use a number field for the computation is specific to the new subclass `Polyhedron_number_field`. (Later, another subclass could be using `SymbolicValuesRing` from #30234.)",
    "created_at": "2022-09-09T21:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686745",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:20'></a>
Sounds good. I notice that `backend_normaliz.py` has a similar attribute `self._normaliz_field = normaliz_field`, which is not always a field. Do we need to change that too?

Replying to [Matthias Köppe](#comment%3A16):
> {{{
>      def _init_from_Vrepresentation(self, vertices, rays, lines,
> -                                   minimize=True, verbose=False):
> +                                   minimize=True, verbose=False, number_field=None):
> }}}
> Also this new parameter should probably not be called `number_field` but rather `internal_base_ring` or something like this. 
> 
> That we use a number field for the computation is specific to the new subclass `Polyhedron_number_field`. (Later, another subclass could be using `SymbolicValuesRing` from #30234.)



---

archive/issue_comments_686746.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [Yuan Zhou](#comment%3A19):\n> How about renaming it to `_compute_data_lists_and_internal_base_ring`?\n\n\nSounds good",
    "created_at": "2022-09-09T21:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686746",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>
Replying to [Yuan Zhou](#comment%3A19):
> How about renaming it to `_compute_data_lists_and_internal_base_ring`?


Sounds good



---

archive/issue_comments_686747.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [Yuan Zhou](#comment%3A20):\n>  `backend_normaliz.py` has a similar attribute `self._normaliz_field = normaliz_field`, which is not always a field. Do we need to change that too?\n\n\nProbably a good idea to rename it too",
    "created_at": "2022-09-09T21:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686747",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
Replying to [Yuan Zhou](#comment%3A20):
>  `backend_normaliz.py` has a similar attribute `self._normaliz_field = normaliz_field`, which is not always a field. Do we need to change that too?


Probably a good idea to rename it too



---

archive/issue_comments_686748.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/polyhedron_backend__number_field__\" to \"u/yzh/polyhedron_backend__number_field__\"",
    "created_at": "2022-09-09T22:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686748",
    "user": "https://github.com/yuan-zhou"
}
```

Changing branch from "u/mkoeppe/polyhedron_backend__number_field__" to "u/yzh/polyhedron_backend__number_field__"



---

archive/issue_comments_686749.json:
```json
{
    "body": "Changing commit from \"ad74e4d3d3cd8e483e95a00ebb4fa120ec828008\" to \"1a9dd7052077e8afaf36cdd263d096e04c1a7b4e\"",
    "created_at": "2022-09-09T22:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686749",
    "user": "https://github.com/yuan-zhou"
}
```

Changing commit from "ad74e4d3d3cd8e483e95a00ebb4fa120ec828008" to "1a9dd7052077e8afaf36cdd263d096e04c1a7b4e"



---

archive/issue_comments_686750.json:
```json
{
    "body": "<a id='comment:24'></a>\nRenamed.\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|\n|[8380bb1](https://git.sagemath.org/sage.git/commit?id=8380bb1db74907a55b0c148415ab2321c6e0ee10)|`rename _compute_nmz_data_lists_and_field to _compute_data_lists_and_internal_base_ring`|\n|[6b661a1](https://git.sagemath.org/sage.git/commit?id=6b661a11365ed3febd9105c3a8f61beae1a87404)|`rename number_field in the output of Polyhedron_base_number_field._compute_data_lists_and_internal_base_ring to internal_base_ring`|\n|[278f6a7](https://git.sagemath.org/sage.git/commit?id=278f6a7e8cd0a54df9159d6dc73a112c533d8db2)|`rename variables inside _compute_data_lists_and_internal_base_ring`|\n|[1a9dd70](https://git.sagemath.org/sage.git/commit?id=1a9dd7052077e8afaf36cdd263d096e04c1a7b4e)|`rename normaliz_field to internal_base_ring`|",
    "created_at": "2022-09-09T22:02:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686750",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:24'></a>
Renamed.

---
New commits:
|                                                                                                                                          |                                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
|[8380bb1](https://git.sagemath.org/sage.git/commit?id=8380bb1db74907a55b0c148415ab2321c6e0ee10)|`rename _compute_nmz_data_lists_and_field to _compute_data_lists_and_internal_base_ring`|
|[6b661a1](https://git.sagemath.org/sage.git/commit?id=6b661a11365ed3febd9105c3a8f61beae1a87404)|`rename number_field in the output of Polyhedron_base_number_field._compute_data_lists_and_internal_base_ring to internal_base_ring`|
|[278f6a7](https://git.sagemath.org/sage.git/commit?id=278f6a7e8cd0a54df9159d6dc73a112c533d8db2)|`rename variables inside _compute_data_lists_and_internal_base_ring`|
|[1a9dd70](https://git.sagemath.org/sage.git/commit?id=1a9dd7052077e8afaf36cdd263d096e04c1a7b4e)|`rename normaliz_field to internal_base_ring`|



---

archive/issue_comments_686751.json:
```json
{
    "body": "Changing commit from \"1a9dd7052077e8afaf36cdd263d096e04c1a7b4e\" to \"60516e7807900e9e620375aacdf46619036dad01\"",
    "created_at": "2022-09-09T22:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686751",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1a9dd7052077e8afaf36cdd263d096e04c1a7b4e" to "60516e7807900e9e620375aacdf46619036dad01"



---

archive/issue_comments_686752.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------|\n|[60516e7](https://git.sagemath.org/sage.git/commit/?id=60516e7807900e9e620375aacdf46619036dad01)|`fix a typo`|",
    "created_at": "2022-09-09T22:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686752",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------|
|[60516e7](https://git.sagemath.org/sage.git/commit/?id=60516e7807900e9e620375aacdf46619036dad01)|`fix a typo`|



---

archive/issue_comments_686753.json:
```json
{
    "body": "Changing branch from \"u/yzh/polyhedron_backend__number_field__\" to \"u/mkoeppe/polyhedron_backend__number_field__\"",
    "created_at": "2022-09-09T23:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686753",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "u/yzh/polyhedron_backend__number_field__" to "u/mkoeppe/polyhedron_backend__number_field__"



---

archive/issue_comments_686754.json:
```json
{
    "body": "Changing commit from \"60516e7807900e9e620375aacdf46619036dad01\" to \"3eb2cc30285b367a770b14c6e2664c2826a90e33\"",
    "created_at": "2022-09-09T23:48:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686754",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "60516e7807900e9e620375aacdf46619036dad01" to "3eb2cc30285b367a770b14c6e2664c2826a90e33"



---

archive/issue_comments_686755.json:
```json
{
    "body": "<a id='comment:27'></a>\nThis works well\n\n---\nNew commits:\n|                                                                                                                                          |                                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|\n|[3eb2cc3](https://git.sagemath.org/sage.git/commit?id=3eb2cc30285b367a770b14c6e2664c2826a90e33)|`src/sage/geometry/polyhedron: Fix typos, reformat doctests`|",
    "created_at": "2022-09-09T23:48:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686755",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
This works well

---
New commits:
|                                                                                                                                          |                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
|[3eb2cc3](https://git.sagemath.org/sage.git/commit?id=3eb2cc30285b367a770b14c6e2664c2826a90e33)|`src/sage/geometry/polyhedron: Fix typos, reformat doctests`|



---

archive/issue_comments_686756.json:
```json
{
    "body": "Changing reviewer from \"\" to \"..., Matthias Koeppe\"",
    "created_at": "2022-09-09T23:48:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686756",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "..., Matthias Koeppe"



---

archive/issue_events_089583.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-09T23:51:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34479#event-89583"
}
```



---

archive/issue_comments_686757.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|\n|[bc7aba3](https://git.sagemath.org/sage.git/commit/?id=bc7aba3fcd50991bbd271b0297645b5bc534a512)|`src/doc/en/reference/discrete_geometry/index.rst: Add backend_number_field`|",
    "created_at": "2022-09-09T23:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686757",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|
|[bc7aba3](https://git.sagemath.org/sage.git/commit/?id=bc7aba3fcd50991bbd271b0297645b5bc534a512)|`src/doc/en/reference/discrete_geometry/index.rst: Add backend_number_field`|



---

archive/issue_comments_686758.json:
```json
{
    "body": "Changing commit from \"3eb2cc30285b367a770b14c6e2664c2826a90e33\" to \"bc7aba3fcd50991bbd271b0297645b5bc534a512\"",
    "created_at": "2022-09-09T23:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686758",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3eb2cc30285b367a770b14c6e2664c2826a90e33" to "bc7aba3fcd50991bbd271b0297645b5bc534a512"



---

archive/issue_comments_686759.json:
```json
{
    "body": "Changing commit from \"bc7aba3fcd50991bbd271b0297645b5bc534a512\" to \"c729884f9c1c4b6921fa2b6f0d6da92256f6811d\"",
    "created_at": "2022-09-10T00:12:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686759",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "bc7aba3fcd50991bbd271b0297645b5bc534a512" to "c729884f9c1c4b6921fa2b6f0d6da92256f6811d"



---

archive/issue_comments_686760.json:
```json
{
    "body": "<a id='comment:30'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|\n|[c729884](https://git.sagemath.org/sage.git/commit/?id=c729884f9c1c4b6921fa2b6f0d6da92256f6811d)|`src/sage/geometry/polyhedron/backend_number_field.py: Fix doc markup`|",
    "created_at": "2022-09-10T00:12:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686760",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|[c729884](https://git.sagemath.org/sage.git/commit/?id=c729884f9c1c4b6921fa2b6f0d6da92256f6811d)|`src/sage/geometry/polyhedron/backend_number_field.py: Fix doc markup`|



---

archive/issue_comments_686761.json:
```json
{
    "body": "<a id='comment:31'></a>\nI would be happy to mark it as a positive review once the patchbot comes back green. If anyone has any objections before that, please do so.",
    "created_at": "2022-09-10T05:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686761",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:31'></a>
I would be happy to mark it as a positive review once the patchbot comes back green. If anyone has any objections before that, please do so.



---

archive/issue_comments_686762.json:
```json
{
    "body": "Changing reviewer from \"..., Matthias Koeppe\" to \"Matthias Koeppe, Travis Scrimshaw\"",
    "created_at": "2022-09-10T05:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686762",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "..., Matthias Koeppe" to "Matthias Koeppe, Travis Scrimshaw"



---

archive/issue_comments_686763.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-26T00:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686763",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_686764.json:
```json
{
    "body": "<a id='comment:33'></a>\nAll green, Lint failures unrelated.",
    "created_at": "2022-09-26T00:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686764",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>
All green, Lint failures unrelated.



---

archive/issue_comments_686765.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/polyhedron_backend__number_field__\" to \"c729884f9c1c4b6921fa2b6f0d6da92256f6811d\"",
    "created_at": "2022-09-28T23:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686765",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/polyhedron_backend__number_field__" to "c729884f9c1c4b6921fa2b6f0d6da92256f6811d"



---

archive/issue_events_089584.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-28T23:04:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34479#event-89584"
}
```



---

archive/issue_comments_686766.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-28T23:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34479",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34479#issuecomment-686766",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
