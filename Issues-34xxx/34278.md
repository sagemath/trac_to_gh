# Issue 34278: RealSet: Add option cache=False

archive/issues_034041.json:
```json
{
    "body": "When receiving `cache=False`, this would use an implementation class that does not inherit from `UniqueRepresentation` to avoid persistence in memory.\n\n\nCC:  @yuan-zhou @tscrim\n\nBranch: u/mkoeppe/realset__add_option_cache_false\n\nStatus: new\n\nDependencies: #34277, #32181\n\nCommit: d25aaac8101c17c92ad22a749714787d86b48a4e\n\nIssue created by migration from https://trac.sagemath.org/ticket/34278\n\n",
    "created_at": "2022-08-04T18:56:00Z",
    "labels": [
        "component: basic arithmetic"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "RealSet: Add option cache=False",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34278",
    "user": "https://github.com/mkoeppe"
}
```
When receiving `cache=False`, this would use an implementation class that does not inherit from `UniqueRepresentation` to avoid persistence in memory.


CC:  @yuan-zhou @tscrim

Branch: u/mkoeppe/realset__add_option_cache_false

Status: new

Dependencies: #34277, #32181

Commit: d25aaac8101c17c92ad22a749714787d86b48a4e

Issue created by migration from https://trac.sagemath.org/ticket/34278





---

archive/issue_comments_482579.json:
```json
{
    "body": "<a id='comment:2'></a>here's a beginning (untested)\n\n---\nLast 10 new commits:",
    "created_at": "2022-08-05T19:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482579",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>here's a beginning (untested)

---
Last 10 new commits:



---

archive/issue_comments_482580.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-08-07T00:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482580",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_482581.json:
```json
{
    "body": "<a id='comment:4'></a>Rebased on new version of #34277",
    "created_at": "2022-08-07T00:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482581",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>Rebased on new version of #34277



---

archive/issue_comments_482582.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-07T00:33:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482582",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482583.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-07T00:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482583",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482584.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-07T00:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482584",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482585.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-07T00:56:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482585",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482586.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-07T01:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482586",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482587.json:
```json
{
    "body": "<a id='comment:10'></a>Can you give some more explanation why you want to do this? While this should not be an issue with coercion (equal-but-not-identical-parents are often a source of frustration there), it increases the overall code complexity.",
    "created_at": "2022-08-07T07:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482587",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>Can you give some more explanation why you want to do this? While this should not be an issue with coercion (equal-but-not-identical-parents are often a source of frustration there), it increases the overall code complexity.



---

archive/issue_comments_482588.json:
```json
{
    "body": "<a id='comment:11'></a>When algorithms create lots of `RealSet`s as intermediate objects, we don't want them to persist in memory for the remainder of the session",
    "created_at": "2022-08-07T18:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482588",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>When algorithms create lots of `RealSet`s as intermediate objects, we don't want them to persist in memory for the remainder of the session



---

archive/issue_comments_482589.json:
```json
{
    "body": "<a id='comment:12'></a>But now I realize the premise is wrong - `CachedRepresentation`/`UniqueRepresentation` use `WeakCachedFunction`, so it does not actually pin the objects into memory",
    "created_at": "2022-08-07T18:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482589",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>But now I realize the premise is wrong - `CachedRepresentation`/`UniqueRepresentation` use `WeakCachedFunction`, so it does not actually pin the objects into memory



---

archive/issue_comments_482590.json:
```json
{
    "body": "<a id='comment:13'></a>Indeed, it is a weak cache. However, if this needs to be done in a tight loop, the extra overhead of checking and maintaining the cache might matter. To the profiler!",
    "created_at": "2022-08-07T23:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34278#issuecomment-482590",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>Indeed, it is a weak cache. However, if this needs to be done in a tight loop, the extra overhead of checking and maintaining the cache might matter. To the profiler!



---

archive/issue_events_089325.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34278",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34278#event-89325"
}
```
