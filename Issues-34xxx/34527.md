# Issue 34527: Make `Composition`s into a `collections.abc.Sequence`

archive/issues_034290.json:
```json
{
    "assignees": [],
    "body": "Currently Sage does not understand `Composition`s as a `collections.abc.Sequence`:\n\n```\nsage: c = Composition([3,4,2,4])\nsage: from collections.abc import Sequence\nsage: isinstance(c, Sequence)\nFalse\n```\n\nThis ticket registers `Composition` as a `Sequence`.\n\nCC:  @tscrim @trevorkarn\n\nKeywords: **gsoc2022 compositions sequence**\n\nBranch/Commit: **[78f3a92](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**\n\nReviewer: **Travis Scrimshaw, Matthias K\u00f6ppe**\n\nAuthor: **Trevor K. Karn**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34527_\n\n",
    "closed_at": "2022-09-25T16:34:05Z",
    "created_at": "2022-09-13T18:02:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make `Composition`s into a `collections.abc.Sequence`",
    "type": "issue",
    "updated_at": "2022-09-25T16:34:05Z",
    "url": "https://github.com/sagemath/sage/issues/34527",
    "user": "https://github.com/trevorkarn"
}
```
Currently Sage does not understand `Composition`s as a `collections.abc.Sequence`:

```
sage: c = Composition([3,4,2,4])
sage: from collections.abc import Sequence
sage: isinstance(c, Sequence)
False
```

This ticket registers `Composition` as a `Sequence`.

CC:  @tscrim @trevorkarn

Keywords: **gsoc2022 compositions sequence**

Branch/Commit: **[78f3a92](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**

Reviewer: **Travis Scrimshaw, Matthias Köppe**

Author: **Trevor K. Karn**

_Issue created by migration from https://trac.sagemath.org/ticket/34527_





---

archive/issue_events_453000.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:02:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453000"
}
```



---

archive/issue_events_453001.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453001"
}
```



---

archive/issue_events_453002.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453002"
}
```



---

archive/issue_events_453003.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453003"
}
```



---

archive/issue_comments_560775.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nThe methods required according to the collections documentation (https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes) are present except for `__reversed__` and `count`.\n\n```\nsage: c.__getitem__\n<bound method CombinatorialObject.__getitem__ of [3, 4, 2, 4]>\nsage: c.__len__\n<bound method CombinatorialObject.__len__ of [3, 4, 2, 4]>\nsage: c.__contains__\n<bound method CombinatorialObject.__contains__ of [3, 4, 2, 4]>\nsage: c.__iter__\n<bound method CombinatorialObject.__iter__ of [3, 4, 2, 4]>\nsage: c.__reversed__\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\nInput In [30], in <cell line: 1>()\n----> 1 c.__reversed__\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:494, in sage.structure.element.Element.__getattr__()\n    492         AttributeError: 'LeftZeroSemigroup_with_category.element_class' object has no attribute 'blah_blah'\n    493     \"\"\"\n--> 494     return self.getattr_from_category(name)\n    495 \n    496 cdef getattr_from_category(self, name):\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:507, in sage.structure.element.Element.getattr_from_category()\n    505     else:\n    506         cls = P._abstract_element_class\n--> 507     return getattr_from_other_class(self, cls, name)\n    508 \n    509 def __dir__(self):\n\nFile ~/Applications/sage/src/sage/cpython/getattr.pyx:356, in sage.cpython.getattr.getattr_from_other_class()\n    354     dummy_error_message.cls = type(self)\n    355     dummy_error_message.name = name\n--> 356     raise AttributeError(dummy_error_message)\n    357 cdef PyObject* attr = instance_getattr(cls, name)\n    358 if attr is NULL:\n\nAttributeError: 'Compositions_all_with_category.element_class' object has no attribute '__reversed__'\nsage: index(c)\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\nInput In [31], in <cell line: 1>()\n----> 1 index(c)\n\nNameError: name 'index' is not defined\nsage: c.index\n<bound method CombinatorialObject.index of [3, 4, 2, 4]>\nsage: c.count\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\nInput In [33], in <cell line: 1>()\n----> 1 c.count\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:494, in sage.structure.element.Element.__getattr__()\n    492         AttributeError: 'LeftZeroSemigroup_with_category.element_class' object has no attribute 'blah_blah'\n    493     \"\"\"\n--> 494     return self.getattr_from_category(name)\n    495 \n    496 cdef getattr_from_category(self, name):\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:507, in sage.structure.element.Element.getattr_from_category()\n    505     else:\n    506         cls = P._abstract_element_class\n--> 507     return getattr_from_other_class(self, cls, name)\n    508 \n    509 def __dir__(self):\n\nFile ~/Applications/sage/src/sage/cpython/getattr.pyx:356, in sage.cpython.getattr.getattr_from_other_class()\n    354     dummy_error_message.cls = type(self)\n    355     dummy_error_message.name = name\n--> 356     raise AttributeError(dummy_error_message)\n    357 cdef PyObject* attr = instance_getattr(cls, name)\n    358 if attr is NULL:\n\nAttributeError: 'Compositions_all_with_category.element_class' object has no attribute 'count'\n```",
    "created_at": "2022-09-13T18:04:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560775",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:1'>Comment 1:</a>
The methods required according to the collections documentation (https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes) are present except for `__reversed__` and `count`.

```
sage: c.__getitem__
<bound method CombinatorialObject.__getitem__ of [3, 4, 2, 4]>
sage: c.__len__
<bound method CombinatorialObject.__len__ of [3, 4, 2, 4]>
sage: c.__contains__
<bound method CombinatorialObject.__contains__ of [3, 4, 2, 4]>
sage: c.__iter__
<bound method CombinatorialObject.__iter__ of [3, 4, 2, 4]>
sage: c.__reversed__
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Input In [30], in <cell line: 1>()
----> 1 c.__reversed__

File ~/Applications/sage/src/sage/structure/element.pyx:494, in sage.structure.element.Element.__getattr__()
    492         AttributeError: 'LeftZeroSemigroup_with_category.element_class' object has no attribute 'blah_blah'
    493     """
--> 494     return self.getattr_from_category(name)
    495 
    496 cdef getattr_from_category(self, name):

File ~/Applications/sage/src/sage/structure/element.pyx:507, in sage.structure.element.Element.getattr_from_category()
    505     else:
    506         cls = P._abstract_element_class
--> 507     return getattr_from_other_class(self, cls, name)
    508 
    509 def __dir__(self):

File ~/Applications/sage/src/sage/cpython/getattr.pyx:356, in sage.cpython.getattr.getattr_from_other_class()
    354     dummy_error_message.cls = type(self)
    355     dummy_error_message.name = name
--> 356     raise AttributeError(dummy_error_message)
    357 cdef PyObject* attr = instance_getattr(cls, name)
    358 if attr is NULL:

AttributeError: 'Compositions_all_with_category.element_class' object has no attribute '__reversed__'
sage: index(c)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
Input In [31], in <cell line: 1>()
----> 1 index(c)

NameError: name 'index' is not defined
sage: c.index
<bound method CombinatorialObject.index of [3, 4, 2, 4]>
sage: c.count
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Input In [33], in <cell line: 1>()
----> 1 c.count

File ~/Applications/sage/src/sage/structure/element.pyx:494, in sage.structure.element.Element.__getattr__()
    492         AttributeError: 'LeftZeroSemigroup_with_category.element_class' object has no attribute 'blah_blah'
    493     """
--> 494     return self.getattr_from_category(name)
    495 
    496 cdef getattr_from_category(self, name):

File ~/Applications/sage/src/sage/structure/element.pyx:507, in sage.structure.element.Element.getattr_from_category()
    505     else:
    506         cls = P._abstract_element_class
--> 507     return getattr_from_other_class(self, cls, name)
    508 
    509 def __dir__(self):

File ~/Applications/sage/src/sage/cpython/getattr.pyx:356, in sage.cpython.getattr.getattr_from_other_class()
    354     dummy_error_message.cls = type(self)
    355     dummy_error_message.name = name
--> 356     raise AttributeError(dummy_error_message)
    357 cdef PyObject* attr = instance_getattr(cls, name)
    358 if attr is NULL:

AttributeError: 'Compositions_all_with_category.element_class' object has no attribute 'count'
```



---

archive/issue_comments_560776.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094\">1463b3e</a></td><td><code>Register Composition as a sequence</code></td></tr></table>\n",
    "created_at": "2022-09-13T18:49:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560776",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:2'>Comment 2:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094">1463b3e</a></td><td><code>Register Composition as a sequence</code></td></tr></table>




---

archive/issue_comments_560777.json:
```json
{
    "body": "Commit: **[1463b3e](https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094)**",
    "created_at": "2022-09-13T18:49:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560777",
    "user": "https://github.com/trevorkarn"
}
```

Commit: **[1463b3e](https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094)**



---

archive/issue_comments_560778.json:
```json
{
    "body": "Branch: **[u/tkarn/composition-34527](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/composition-34527)**",
    "created_at": "2022-09-13T18:49:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560778",
    "user": "https://github.com/trevorkarn"
}
```

Branch: **[u/tkarn/composition-34527](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/composition-34527)**



---

archive/issue_events_453004.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:49:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453004"
}
```



---

archive/issue_comments_560779.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,4 +7,4 @@\n False\n ```\n \n-This ticket implements the methods required to fix that, namely `Composition.__reversed__` and `Composition.count`\n+This ticket registers `Composition` as a `Sequence`.\n``````\n",
    "created_at": "2022-09-13T18:50:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560779",
    "user": "https://github.com/trevorkarn"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,4 +7,4 @@
 False
 ```
 
-This ticket implements the methods required to fix that, namely `Composition.__reversed__` and `Composition.count`
+This ticket registers `Composition` as a `Sequence`.
``````




---

archive/issue_comments_560780.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nMaybe some doctests to illustrate the supported operations would be good, to help other Sage users understand the Sequence protocol?",
    "created_at": "2022-09-13T19:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560780",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'>Comment 4:</a>
Maybe some doctests to illustrate the supported operations would be good, to help other Sage users understand the Sequence protocol?



---

archive/issue_comments_560781.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nAlso in the doctest I would suggest to use the fully qualified name `collections.abc.Sequence` for clarity because there's also the unrelated global binding `Sequence` in Sage.",
    "created_at": "2022-09-13T19:03:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560781",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'>Comment 5:</a>
Also in the doctest I would suggest to use the fully qualified name `collections.abc.Sequence` for clarity because there's also the unrelated global binding `Sequence` in Sage.



---

archive/issue_comments_560782.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\n+1 to Matthias\u2019s comments; in particular the `count` method is a bit unnatural for compositions.\n\nIt might make more sense to simply inherit from `Sequence` instead of registering it and providing a `__reversed__` method (which should return a `Composition`). The default `count` should be okay.",
    "created_at": "2022-09-13T23:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560782",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'>Comment 6:</a>
+1 to Matthias’s comments; in particular the `count` method is a bit unnatural for compositions.

It might make more sense to simply inherit from `Sequence` instead of registering it and providing a `__reversed__` method (which should return a `Composition`). The default `count` should be okay.



---

archive/issue_comments_560783.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nIt looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`. As Matthias suggested, I updated the doctest. I'm not sure there is a need to actually implement the `__reversed__` or `count` methods as I had suggested earlier.",
    "created_at": "2022-09-15T03:22:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560783",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:7'>Comment 7:</a>
It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`. As Matthias suggested, I updated the doctest. I'm not sure there is a need to actually implement the `__reversed__` or `count` methods as I had suggested earlier.



---

archive/issue_comments_560784.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0\">e74e0b2</a></td><td><code>Update doctest</code></td></tr></table>\n",
    "created_at": "2022-09-15T03:23:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560784",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:8'>Comment 8:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0">e74e0b2</a></td><td><code>Update doctest</code></td></tr></table>




---

archive/issue_comments_560785.json:
```json
{
    "body": "Changed commit from **[1463b3e](https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094)** to **[e74e0b2](https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0)**",
    "created_at": "2022-09-15T03:23:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560785",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1463b3e](https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094)** to **[e74e0b2](https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0)**



---

archive/issue_comments_560786.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nReplying to [Trevor Karn](#comment%3A7):\n> It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.\n\nYes, this is equivalent to inheriting from `Sequence`.",
    "created_at": "2022-09-15T04:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560786",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'>Comment 9:</a>
Replying to [Trevor Karn](#comment%3A7):
> It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.

Yes, this is equivalent to inheriting from `Sequence`.



---

archive/issue_comments_560787.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\ncomment:4?",
    "created_at": "2022-09-15T04:14:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560787",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'>Comment 10:</a>
comment:4?



---

archive/issue_comments_560788.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A10):\n> comment:4?\n\nSorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the \"required\" methods, the general `Sequence` protocol is not really followed. Maybe this is something that should go in the developer's guide rather than a doctest here?",
    "created_at": "2022-09-15T04:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560788",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:11'>Comment 11:</a>
Replying to [Matthias Köppe](#comment%3A10):
> comment:4?

Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the "required" methods, the general `Sequence` protocol is not really followed. Maybe this is something that should go in the developer's guide rather than a doctest here?



---

archive/issue_comments_560789.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [Trevor Karn](#comment%3A7):\n> It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.\n\nDoes it also pass the `issubclass` test too?\n\n> As Matthias suggested, I updated the doctest. I'm not sure there is a need to actually implement the `__reversed__` or `count` methods as I had suggested earlier.\n\nWhat is the type of the result from applying `reversed` to the composition? Some tests would help here, a la [comment:4](#comment%3A4).",
    "created_at": "2022-09-15T04:19:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560789",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [Trevor Karn](#comment%3A7):
> It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.

Does it also pass the `issubclass` test too?

> As Matthias suggested, I updated the doctest. I'm not sure there is a need to actually implement the `__reversed__` or `count` methods as I had suggested earlier.

What is the type of the result from applying `reversed` to the composition? Some tests would help here, a la [comment:4](#comment%3A4).



---

archive/issue_comments_560790.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A9):\n> Replying to [Trevor Karn](#comment%3A7):\n> > It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.\n\n> \n> Yes, this is equivalent to inheriting from `Sequence`.\n\nI realize that I have to clarify this: It is equivalent as far as `isinstance` and `issubclass` are concerned, but you will get the mix-in methods listed in https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes (`__reversed__`, `count`, etc.) only if you inherit from `Sequence` in the class definition.",
    "created_at": "2022-09-15T04:36:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560790",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [Matthias Köppe](#comment%3A9):
> Replying to [Trevor Karn](#comment%3A7):
> > It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.

> 
> Yes, this is equivalent to inheriting from `Sequence`.

I realize that I have to clarify this: It is equivalent as far as `isinstance` and `issubclass` are concerned, but you will get the mix-in methods listed in https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes (`__reversed__`, `count`, etc.) only if you inherit from `Sequence` in the class definition.



---

archive/issue_comments_560791.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [Travis Scrimshaw](#comment%3A12):\n> Replying to [Trevor Karn](#comment%3A7):\n> > It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.\n\n> \n> Does it also pass the `issubclass` test too?\n\nYes, of course, that should be added as a test maybe:\n\n```\nsage: import collections.abc\nsage: C = Composition([3,2,3])\nsage: issubclass(C.__class__, collections.abc.Sequence)\nTrue\nsage: isinstance(C, collections.abc.Sequence)\nTrue\n```",
    "created_at": "2022-09-15T04:37:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560791",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [Travis Scrimshaw](#comment%3A12):
> Replying to [Trevor Karn](#comment%3A7):
> > It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.

> 
> Does it also pass the `issubclass` test too?

Yes, of course, that should be added as a test maybe:

```
sage: import collections.abc
sage: C = Composition([3,2,3])
sage: issubclass(C.__class__, collections.abc.Sequence)
True
sage: isinstance(C, collections.abc.Sequence)
True
```



---

archive/issue_comments_560792.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [Travis Scrimshaw](#comment%3A12):\n> What is the type of the result from applying `reversed` to the composition? \n\n\n```\nsage: reversed(C)\n<reversed object at 0x7fe2e86c4e50>\n```",
    "created_at": "2022-09-15T04:38:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560792",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [Travis Scrimshaw](#comment%3A12):
> What is the type of the result from applying `reversed` to the composition? 


```
sage: reversed(C)
<reversed object at 0x7fe2e86c4e50>
```



---

archive/issue_comments_560793.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [Trevor Karn](#comment%3A11):\n> Replying to [Matthias K\u00f6ppe](#comment%3A10):\n> > comment:4?\n\n> \n> Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the \"required\" methods, the general `Sequence` protocol is not really followed.\n\nIt is followed. The \"mixin\" methods are not part of the protocol.",
    "created_at": "2022-09-15T04:39:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560793",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [Trevor Karn](#comment%3A11):
> Replying to [Matthias Köppe](#comment%3A10):
> > comment:4?

> 
> Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the "required" methods, the general `Sequence` protocol is not really followed.

It is followed. The "mixin" methods are not part of the protocol.



---

archive/issue_comments_560794.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A16):\n> Replying to [Trevor Karn](#comment%3A11):\n> > Replying to [Matthias K\u00f6ppe](#comment%3A10):\n> > > comment:4?\n\n> > \n> > Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the \"required\" methods, the general `Sequence` protocol is not really followed.\n\n> \n> It is followed. The \"mixin\" methods are not part of the protocol.\n\nNo, sorry, my mistake. It's getting late here.\n\nYou are right, it is not allowed to register it without implementing these mixin methods.\nBut you'll get them for free by changing it to subclassing instead of registering.",
    "created_at": "2022-09-15T04:41:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560794",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [Matthias Köppe](#comment%3A16):
> Replying to [Trevor Karn](#comment%3A11):
> > Replying to [Matthias Köppe](#comment%3A10):
> > > comment:4?

> > 
> > Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the "required" methods, the general `Sequence` protocol is not really followed.

> 
> It is followed. The "mixin" methods are not part of the protocol.

No, sorry, my mistake. It's getting late here.

You are right, it is not allowed to register it without implementing these mixin methods.
But you'll get them for free by changing it to subclassing instead of registering.



---

archive/issue_comments_560795.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A15):\n> Replying to [Travis Scrimshaw](#comment%3A12):\n> > What is the type of the result from applying `reversed` to the composition? \n\n> \n> ```\n> sage: reversed(C)\n> <reversed object at 0x7fe2e86c4e50>\n> ```\n\nAh, right, duh. It is an iterator and does not return the reversed object.",
    "created_at": "2022-09-15T04:41:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560795",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'>Comment 18:</a>
Replying to [Matthias Köppe](#comment%3A15):
> Replying to [Travis Scrimshaw](#comment%3A12):
> > What is the type of the result from applying `reversed` to the composition? 

> 
> ```
> sage: reversed(C)
> <reversed object at 0x7fe2e86c4e50>
> ```

Ah, right, duh. It is an iterator and does not return the reversed object.



---

archive/issue_comments_560796.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nAfter subclassing:\n\n```\n  File \"/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py\", line 50, in <module>\n    class Composition(CombinatorialElement, Sequence):\nTypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases\n```\n\nShould this be fixed at the `CombinatorialElement` level? Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?",
    "created_at": "2022-09-15T05:14:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560796",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:19'>Comment 19:</a>
After subclassing:

```
  File "/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py", line 50, in <module>
    class Composition(CombinatorialElement, Sequence):
TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases
```

Should this be fixed at the `CombinatorialElement` level? Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?



---

archive/issue_comments_560797.json:
```json
{
    "body": "Changed commit from **[e74e0b2](https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0)** to **[27b986a](https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f)**",
    "created_at": "2022-09-15T05:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560797",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e74e0b2](https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0)** to **[27b986a](https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f)**



---

archive/issue_comments_560798.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f\">27b986a</a></td><td><code>More updates to doctest</code></td></tr></table>\n",
    "created_at": "2022-09-15T05:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560798",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:20'>Comment 20:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f">27b986a</a></td><td><code>More updates to doctest</code></td></tr></table>




---

archive/issue_comments_560799.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [Trevor Karn](#comment%3A19):\n> After subclassing:\n> \n> ```\n>   File \"/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py\", line 50, in <module>\n>     class Composition(CombinatorialElement, Sequence):\n> TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases\n> ```\n\nOuch. Python used a metaclass for their (collections) ABCs `abc.ABCMeta`. Well, I guess that settles it; we have to register it.\n\n> Should this be fixed at the `CombinatorialElement` level?\n\nNo, that is going to go away at some point.\n\n> Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?\n\nThis won't solve the problem:\n\n```\nsage: from sage.structure.list_clone import ClonableArray\nsage: ClonableArray.__class__\n<class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>\n```",
    "created_at": "2022-09-15T07:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560799",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [Trevor Karn](#comment%3A19):
> After subclassing:
> 
> ```
>   File "/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py", line 50, in <module>
>     class Composition(CombinatorialElement, Sequence):
> TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases
> ```

Ouch. Python used a metaclass for their (collections) ABCs `abc.ABCMeta`. Well, I guess that settles it; we have to register it.

> Should this be fixed at the `CombinatorialElement` level?

No, that is going to go away at some point.

> Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?

This won't solve the problem:

```
sage: from sage.structure.list_clone import ClonableArray
sage: ClonableArray.__class__
<class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>
```



---

archive/issue_comments_560800.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nReplying to [Travis Scrimshaw](#comment%3A21):\n> Replying to [Trevor Karn](#comment%3A19):\n> > After subclassing:\n> > \n> > ```\n> >   File \"/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py\", line 50, in <module>\n> >     class Composition(CombinatorialElement, Sequence):\n> > TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases\n> > ```\n\n> \n> Ouch. Python used a metaclass for their (collections) ABCs `abc.ABCMeta`. Well, I guess that settles it; we have to register it.\n\nGot it - then I think this is ready for review. I tried to inclued the doctests which were relevant to this conversation, but please let me know if I need more.\n\n> > Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?\n\n> \n> This won't solve the problem:\n> \n> ```\n> sage: from sage.structure.list_clone import ClonableArray\n> sage: ClonableArray.__class__\n> <class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>\n> ```\n\nHuh. Should `ClonableArray` be a `Sequence`?",
    "created_at": "2022-09-15T17:54:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560800",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:22'>Comment 22:</a>
Replying to [Travis Scrimshaw](#comment%3A21):
> Replying to [Trevor Karn](#comment%3A19):
> > After subclassing:
> > 
> > ```
> >   File "/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py", line 50, in <module>
> >     class Composition(CombinatorialElement, Sequence):
> > TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases
> > ```

> 
> Ouch. Python used a metaclass for their (collections) ABCs `abc.ABCMeta`. Well, I guess that settles it; we have to register it.

Got it - then I think this is ready for review. I tried to inclued the doctests which were relevant to this conversation, but please let me know if I need more.

> > Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?

> 
> This won't solve the problem:
> 
> ```
> sage: from sage.structure.list_clone import ClonableArray
> sage: ClonableArray.__class__
> <class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>
> ```

Huh. Should `ClonableArray` be a `Sequence`?



---

archive/issue_comments_560801.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nReplying to [Trevor Karn](#comment%3A22):\n> Replying to [Travis Scrimshaw](#comment%3A21):\n> > Replying to [Trevor Karn](#comment%3A19):\n> > > Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?\n\n> > \n> > This won't solve the problem:\n> > \n> > ```\n> > sage: from sage.structure.list_clone import ClonableArray\n> > sage: ClonableArray.__class__\n> > <class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>\n> > ```\n\n> Huh. Should `ClonableArray` be a `Sequence`?\n\nThis is saying it also has a metaclass.",
    "created_at": "2022-09-16T00:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560801",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:23'>Comment 23:</a>
Replying to [Trevor Karn](#comment%3A22):
> Replying to [Travis Scrimshaw](#comment%3A21):
> > Replying to [Trevor Karn](#comment%3A19):
> > > Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?

> > 
> > This won't solve the problem:
> > 
> > ```
> > sage: from sage.structure.list_clone import ClonableArray
> > sage: ClonableArray.__class__
> > <class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>
> > ```

> Huh. Should `ClonableArray` be a `Sequence`?

This is saying it also has a metaclass.



---

archive/issue_events_453005.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-16T18:37:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453005"
}
```



---

archive/issue_events_453006.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-16T18:37:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453006"
}
```



---

archive/issue_comments_560802.json:
```json
{
    "body": "Changed commit from **[27b986a](https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f)** to **[c0eb2b4](https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940)**",
    "created_at": "2022-09-17T14:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560802",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[27b986a](https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f)** to **[c0eb2b4](https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940)**



---

archive/issue_comments_560803.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940\">c0eb2b4</a></td><td><code>Add to documentation and remove reversed type-check</code></td></tr></table>\n",
    "created_at": "2022-09-17T14:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560803",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940">c0eb2b4</a></td><td><code>Add to documentation and remove reversed type-check</code></td></tr></table>




---

archive/issue_events_453007.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-17T14:07:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453007"
}
```



---

archive/issue_events_453008.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-17T14:07:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453008"
}
```



---

archive/issue_comments_560804.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nDocumentation is updated.",
    "created_at": "2022-09-17T14:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560804",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:26'>Comment 26:</a>
Documentation is updated.



---

archive/issue_comments_560805.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nThanks. I am happy with this (modulo the one change below). Matthias?\n\nSphinx treats the backtick as normal text when between alpha(numeric?) characters:\n\n```diff\n     Typically, instances of ``collections.abc.Sequence`` have a ``.count`` method.\n-    This is *not* the case for ``Composition``s::\n+    This is *not* the case for a ``Composition``::\n```",
    "created_at": "2022-09-18T00:06:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560805",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'>Comment 27:</a>
Thanks. I am happy with this (modulo the one change below). Matthias?

Sphinx treats the backtick as normal text when between alpha(numeric?) characters:

```diff
     Typically, instances of ``collections.abc.Sequence`` have a ``.count`` method.
-    This is *not* the case for ``Composition``s::
+    This is *not* the case for a ``Composition``::
```



---

archive/issue_comments_560806.json:
```json
{
    "body": "Changed commit from **[c0eb2b4](https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940)** to **[b0a87c6](https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881)**",
    "created_at": "2022-09-18T01:48:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560806",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c0eb2b4](https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940)** to **[b0a87c6](https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881)**



---

archive/issue_comments_560807.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881\">b0a87c6</a></td><td><code>Fix documentation</code></td></tr></table>\n",
    "created_at": "2022-09-18T01:48:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560807",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'>Comment 28:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881">b0a87c6</a></td><td><code>Fix documentation</code></td></tr></table>




---

archive/issue_comments_560808.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nI think in [comment:17](#comment%3A17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it",
    "created_at": "2022-09-18T05:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560808",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'>Comment 29:</a>
I think in [comment:17](#comment%3A17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it



---

archive/issue_comments_560809.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A29):\n> I think in [comment:17](#comment%3A17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it\n\nI understand [this python discussion post](https://discuss.python.org/t/mapping-abc-and-friends-are-the-mixin-methods-required-to-satisfy-the-interface/9499/2) to mean that mix-in methods are *not* required.\n\nOn the other hand it is easy enough to implement `.count()` where `.count(n)` returns the number of parts of size `n`. So I'll do that later today.",
    "created_at": "2022-09-19T19:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560809",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:30'>Comment 30:</a>
Replying to [Matthias Köppe](#comment%3A29):
> I think in [comment:17](#comment%3A17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it

I understand [this python discussion post](https://discuss.python.org/t/mapping-abc-and-friends-are-the-mixin-methods-required-to-satisfy-the-interface/9499/2) to mean that mix-in methods are *not* required.

On the other hand it is easy enough to implement `.count()` where `.count(n)` returns the number of parts of size `n`. So I'll do that later today.



---

archive/issue_comments_560810.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2\">78f3a92</a></td><td><code>Add .count</code></td></tr></table>\n",
    "created_at": "2022-09-19T22:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560810",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:31'>Comment 31:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2">78f3a92</a></td><td><code>Add .count</code></td></tr></table>




---

archive/issue_comments_560811.json:
```json
{
    "body": "Changed commit from **[b0a87c6](https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881)** to **[78f3a92](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**",
    "created_at": "2022-09-19T22:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560811",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b0a87c6](https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881)** to **[78f3a92](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**



---

archive/issue_comments_560812.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A29):\n> I think in [comment:17](#comment%3A17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it\n\nOk. I think `Sequence` things should be good to go.",
    "created_at": "2022-09-19T22:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560812",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:32'>Comment 32:</a>
Replying to [Matthias Köppe](#comment%3A29):
> I think in [comment:17](#comment%3A17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it

Ok. I think `Sequence` things should be good to go.



---

archive/issue_comments_560813.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A29):\n> I think in [comment:17](#comment%3A17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it\n\nThis is in point (2) of the main Python ABC doc in [comment:1](#comment%3A1).",
    "created_at": "2022-09-20T05:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560813",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:33'>Comment 33:</a>
Replying to [Matthias Köppe](#comment%3A29):
> I think in [comment:17](#comment%3A17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it

This is in point (2) of the main Python ABC doc in [comment:1](#comment%3A1).



---

archive/issue_comments_560814.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw, Matthias K\u00f6ppe**",
    "created_at": "2022-09-20T05:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560814",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw, Matthias Köppe**



---

archive/issue_comments_560815.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nThat takes care of all of the mixin methods. So I am good with this. Anything objections to a positive review Matthias?",
    "created_at": "2022-09-20T05:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560815",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'>Comment 34:</a>
That takes care of all of the mixin methods. So I am good with this. Anything objections to a positive review Matthias?



---

archive/issue_events_453009.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-22T03:22:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453009"
}
```



---

archive/issue_events_453010.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-22T03:22:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453010"
}
```



---

archive/issue_comments_560816.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nLGTM, thanks.",
    "created_at": "2022-09-22T03:22:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560816",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:35'>Comment 35:</a>
LGTM, thanks.



---

archive/issue_events_453011.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-25T16:34:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453011"
}
```



---

archive/issue_events_453012.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "893b376348277d4524a558d9f36d2c3d3dbc4219",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-09-25T16:34:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-453012"
}
```



---

archive/issue_comments_560817.json:
```json
{
    "body": "Changed branch from **[u/tkarn/composition-34527](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/composition-34527)** to **[78f3a92](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**",
    "created_at": "2022-09-25T16:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-560817",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/tkarn/composition-34527](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/composition-34527)** to **[78f3a92](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**
