# Issue 34527: Make `Composition`s into a `collections.abc.Sequence`

archive/issues_034290.json:
```json
{
    "assignees": [],
    "body": "Currently Sage does not understand `Composition`s as a `collections.abc.Sequence`:\n\n```\nsage: c = Composition([3,4,2,4])\nsage: from collections.abc import Sequence\nsage: isinstance(c, Sequence)\nFalse\n```\n\nThis ticket registers `Composition` as a `Sequence`.\n\nCC:  @tscrim @trevorkarn\n\nKeywords: **gsoc2022 compositions sequence**\n\nBranch/Commit: **[`78f3a92`](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**\n\nReviewer: **Travis Scrimshaw, Matthias K\u00f6ppe**\n\nAuthor: **Trevor K. Karn**\n\nComponent: **combinatorics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34527_\n\n",
    "closed_at": "2022-09-25T16:34:05Z",
    "created_at": "2022-09-13T18:02:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make `Composition`s into a `collections.abc.Sequence`",
    "type": "issue",
    "updated_at": "2022-09-25T16:34:05Z",
    "url": "https://github.com/sagemath/sage/issues/34527",
    "user": "https://github.com/trevorkarn"
}
```
Currently Sage does not understand `Composition`s as a `collections.abc.Sequence`:

```
sage: c = Composition([3,4,2,4])
sage: from collections.abc import Sequence
sage: isinstance(c, Sequence)
False
```

This ticket registers `Composition` as a `Sequence`.

CC:  @tscrim @trevorkarn

Keywords: **gsoc2022 compositions sequence**

Branch/Commit: **[`78f3a92`](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**

Reviewer: **Travis Scrimshaw, Matthias KÃ¶ppe**

Author: **Trevor K. Karn**

Component: **combinatorics**

_Issue created by migration from https://trac.sagemath.org/ticket/34527_





---

archive/issue_events_471343.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:02:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471343"
}
```



---

archive/issue_events_471344.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471344"
}
```



---

archive/issue_events_471345.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471345"
}
```



---

archive/issue_events_471346.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:02:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471346"
}
```



---

archive/issue_comments_557794.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe methods required according to the collections documentation (https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes) are present except for `__reversed__` and `count`.\n\n```\nsage: c.__getitem__\n<bound method CombinatorialObject.__getitem__ of [3, 4, 2, 4]>\nsage: c.__len__\n<bound method CombinatorialObject.__len__ of [3, 4, 2, 4]>\nsage: c.__contains__\n<bound method CombinatorialObject.__contains__ of [3, 4, 2, 4]>\nsage: c.__iter__\n<bound method CombinatorialObject.__iter__ of [3, 4, 2, 4]>\nsage: c.__reversed__\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\nInput In [30], in <cell line: 1>()\n----> 1 c.__reversed__\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:494, in sage.structure.element.Element.__getattr__()\n    492         AttributeError: 'LeftZeroSemigroup_with_category.element_class' object has no attribute 'blah_blah'\n    493     \"\"\"\n--> 494     return self.getattr_from_category(name)\n    495 \n    496 cdef getattr_from_category(self, name):\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:507, in sage.structure.element.Element.getattr_from_category()\n    505     else:\n    506         cls = P._abstract_element_class\n--> 507     return getattr_from_other_class(self, cls, name)\n    508 \n    509 def __dir__(self):\n\nFile ~/Applications/sage/src/sage/cpython/getattr.pyx:356, in sage.cpython.getattr.getattr_from_other_class()\n    354     dummy_error_message.cls = type(self)\n    355     dummy_error_message.name = name\n--> 356     raise AttributeError(dummy_error_message)\n    357 cdef PyObject* attr = instance_getattr(cls, name)\n    358 if attr is NULL:\n\nAttributeError: 'Compositions_all_with_category.element_class' object has no attribute '__reversed__'\nsage: index(c)\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\nInput In [31], in <cell line: 1>()\n----> 1 index(c)\n\nNameError: name 'index' is not defined\nsage: c.index\n<bound method CombinatorialObject.index of [3, 4, 2, 4]>\nsage: c.count\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\nInput In [33], in <cell line: 1>()\n----> 1 c.count\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:494, in sage.structure.element.Element.__getattr__()\n    492         AttributeError: 'LeftZeroSemigroup_with_category.element_class' object has no attribute 'blah_blah'\n    493     \"\"\"\n--> 494     return self.getattr_from_category(name)\n    495 \n    496 cdef getattr_from_category(self, name):\n\nFile ~/Applications/sage/src/sage/structure/element.pyx:507, in sage.structure.element.Element.getattr_from_category()\n    505     else:\n    506         cls = P._abstract_element_class\n--> 507     return getattr_from_other_class(self, cls, name)\n    508 \n    509 def __dir__(self):\n\nFile ~/Applications/sage/src/sage/cpython/getattr.pyx:356, in sage.cpython.getattr.getattr_from_other_class()\n    354     dummy_error_message.cls = type(self)\n    355     dummy_error_message.name = name\n--> 356     raise AttributeError(dummy_error_message)\n    357 cdef PyObject* attr = instance_getattr(cls, name)\n    358 if attr is NULL:\n\nAttributeError: 'Compositions_all_with_category.element_class' object has no attribute 'count'\n```",
    "created_at": "2022-09-13T18:04:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557794",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:1" align="right">comment:1</div>

The methods required according to the collections documentation (https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes) are present except for `__reversed__` and `count`.

```
sage: c.__getitem__
<bound method CombinatorialObject.__getitem__ of [3, 4, 2, 4]>
sage: c.__len__
<bound method CombinatorialObject.__len__ of [3, 4, 2, 4]>
sage: c.__contains__
<bound method CombinatorialObject.__contains__ of [3, 4, 2, 4]>
sage: c.__iter__
<bound method CombinatorialObject.__iter__ of [3, 4, 2, 4]>
sage: c.__reversed__
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Input In [30], in <cell line: 1>()
----> 1 c.__reversed__

File ~/Applications/sage/src/sage/structure/element.pyx:494, in sage.structure.element.Element.__getattr__()
    492         AttributeError: 'LeftZeroSemigroup_with_category.element_class' object has no attribute 'blah_blah'
    493     """
--> 494     return self.getattr_from_category(name)
    495 
    496 cdef getattr_from_category(self, name):

File ~/Applications/sage/src/sage/structure/element.pyx:507, in sage.structure.element.Element.getattr_from_category()
    505     else:
    506         cls = P._abstract_element_class
--> 507     return getattr_from_other_class(self, cls, name)
    508 
    509 def __dir__(self):

File ~/Applications/sage/src/sage/cpython/getattr.pyx:356, in sage.cpython.getattr.getattr_from_other_class()
    354     dummy_error_message.cls = type(self)
    355     dummy_error_message.name = name
--> 356     raise AttributeError(dummy_error_message)
    357 cdef PyObject* attr = instance_getattr(cls, name)
    358 if attr is NULL:

AttributeError: 'Compositions_all_with_category.element_class' object has no attribute '__reversed__'
sage: index(c)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
Input In [31], in <cell line: 1>()
----> 1 index(c)

NameError: name 'index' is not defined
sage: c.index
<bound method CombinatorialObject.index of [3, 4, 2, 4]>
sage: c.count
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Input In [33], in <cell line: 1>()
----> 1 c.count

File ~/Applications/sage/src/sage/structure/element.pyx:494, in sage.structure.element.Element.__getattr__()
    492         AttributeError: 'LeftZeroSemigroup_with_category.element_class' object has no attribute 'blah_blah'
    493     """
--> 494     return self.getattr_from_category(name)
    495 
    496 cdef getattr_from_category(self, name):

File ~/Applications/sage/src/sage/structure/element.pyx:507, in sage.structure.element.Element.getattr_from_category()
    505     else:
    506         cls = P._abstract_element_class
--> 507     return getattr_from_other_class(self, cls, name)
    508 
    509 def __dir__(self):

File ~/Applications/sage/src/sage/cpython/getattr.pyx:356, in sage.cpython.getattr.getattr_from_other_class()
    354     dummy_error_message.cls = type(self)
    355     dummy_error_message.name = name
--> 356     raise AttributeError(dummy_error_message)
    357 cdef PyObject* attr = instance_getattr(cls, name)
    358 if attr is NULL:

AttributeError: 'Compositions_all_with_category.element_class' object has no attribute 'count'
```



---

archive/issue_comments_557795.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094\">1463b3e</a></td><td><code>Register Composition as a sequence</code></td></tr></table>\n",
    "created_at": "2022-09-13T18:49:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557795",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094">1463b3e</a></td><td><code>Register Composition as a sequence</code></td></tr></table>




---

archive/issue_comments_557796.json:
```json
{
    "body": "Commit: **[`1463b3e`](https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094)**",
    "created_at": "2022-09-13T18:49:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557796",
    "user": "https://github.com/trevorkarn"
}
```

Commit: **[`1463b3e`](https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094)**



---

archive/issue_comments_557797.json:
```json
{
    "body": "Branch: **[u/tkarn/composition-34527](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/composition-34527)**",
    "created_at": "2022-09-13T18:49:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557797",
    "user": "https://github.com/trevorkarn"
}
```

Branch: **[u/tkarn/composition-34527](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/composition-34527)**



---

archive/issue_events_471347.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-13T18:49:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471347"
}
```



---

archive/issue_comments_557798.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,4 +7,4 @@\n False\n ```\n \n-This ticket implements the methods required to fix that, namely `Composition.__reversed__` and `Composition.count`\n+This ticket registers `Composition` as a `Sequence`.\n``````\n",
    "created_at": "2022-09-13T18:50:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557798",
    "user": "https://github.com/trevorkarn"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,4 +7,4 @@
 False
 ```
 
-This ticket implements the methods required to fix that, namely `Composition.__reversed__` and `Composition.count`
+This ticket registers `Composition` as a `Sequence`.
``````




---

archive/issue_comments_557799.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nMaybe some doctests to illustrate the supported operations would be good, to help other Sage users understand the Sequence protocol?",
    "created_at": "2022-09-13T19:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557799",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

Maybe some doctests to illustrate the supported operations would be good, to help other Sage users understand the Sequence protocol?



---

archive/issue_comments_557800.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAlso in the doctest I would suggest to use the fully qualified name `collections.abc.Sequence` for clarity because there's also the unrelated global binding `Sequence` in Sage.",
    "created_at": "2022-09-13T19:03:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557800",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">comment:5</div>

Also in the doctest I would suggest to use the fully qualified name `collections.abc.Sequence` for clarity because there's also the unrelated global binding `Sequence` in Sage.



---

archive/issue_comments_557801.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n+1 to Matthias\u2019s comments; in particular the `count` method is a bit unnatural for compositions.\n\nIt might make more sense to simply inherit from `Sequence` instead of registering it and providing a `__reversed__` method (which should return a `Composition`). The default `count` should be okay.",
    "created_at": "2022-09-13T23:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557801",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

+1 to Matthiasâs comments; in particular the `count` method is a bit unnatural for compositions.

It might make more sense to simply inherit from `Sequence` instead of registering it and providing a `__reversed__` method (which should return a `Composition`). The default `count` should be okay.



---

archive/issue_comments_557802.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIt looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`. As Matthias suggested, I updated the doctest. I'm not sure there is a need to actually implement the `__reversed__` or `count` methods as I had suggested earlier.",
    "created_at": "2022-09-15T03:22:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557802",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:7" align="right">comment:7</div>

It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`. As Matthias suggested, I updated the doctest. I'm not sure there is a need to actually implement the `__reversed__` or `count` methods as I had suggested earlier.



---

archive/issue_comments_557803.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0\">e74e0b2</a></td><td><code>Update doctest</code></td></tr></table>\n",
    "created_at": "2022-09-15T03:23:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557803",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0">e74e0b2</a></td><td><code>Update doctest</code></td></tr></table>




---

archive/issue_comments_557804.json:
```json
{
    "body": "Changed commit from **[`1463b3e`](https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094)** to **[`e74e0b2`](https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0)**",
    "created_at": "2022-09-15T03:23:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557804",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1463b3e`](https://github.com/sagemath/sagetrac-mirror/commit/1463b3ed10ef383a6fb447e405d04c1db1024094)** to **[`e74e0b2`](https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0)**



---

archive/issue_comments_557805.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [Trevor Karn](#comment:7):\n> It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.\n\nYes, this is equivalent to inheriting from `Sequence`.",
    "created_at": "2022-09-15T04:14:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557805",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [Trevor Karn](#comment:7):
> It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.

Yes, this is equivalent to inheriting from `Sequence`.



---

archive/issue_comments_557806.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\ncomment:4?",
    "created_at": "2022-09-15T04:14:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557806",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

comment:4?



---

archive/issue_comments_557807.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [Matthias K\u00f6ppe](#comment:10):\n> comment:4?\n\nSorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the \"required\" methods, the general `Sequence` protocol is not really followed. Maybe this is something that should go in the developer's guide rather than a doctest here?",
    "created_at": "2022-09-15T04:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557807",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [Matthias KÃ¶ppe](#comment:10):
> comment:4?

Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the "required" methods, the general `Sequence` protocol is not really followed. Maybe this is something that should go in the developer's guide rather than a doctest here?



---

archive/issue_comments_557808.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [Trevor Karn](#comment:7):\n> It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.\n\nDoes it also pass the `issubclass` test too?\n\n> As Matthias suggested, I updated the doctest. I'm not sure there is a need to actually implement the `__reversed__` or `count` methods as I had suggested earlier.\n\nWhat is the type of the result from applying `reversed` to the composition? Some tests would help here, a la [comment:4](#comment:4).",
    "created_at": "2022-09-15T04:19:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557808",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [Trevor Karn](#comment:7):
> It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.

Does it also pass the `issubclass` test too?

> As Matthias suggested, I updated the doctest. I'm not sure there is a need to actually implement the `__reversed__` or `count` methods as I had suggested earlier.

What is the type of the result from applying `reversed` to the composition? Some tests would help here, a la [comment:4](#comment:4).



---

archive/issue_comments_557809.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [Matthias K\u00f6ppe](#comment:9):\n> Replying to [Trevor Karn](#comment:7):\n> > It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.\n\n> \n> Yes, this is equivalent to inheriting from `Sequence`.\n\nI realize that I have to clarify this: It is equivalent as far as `isinstance` and `issubclass` are concerned, but you will get the mix-in methods listed in https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes (`__reversed__`, `count`, etc.) only if you inherit from `Sequence` in the class definition.",
    "created_at": "2022-09-15T04:36:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557809",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [Matthias KÃ¶ppe](#comment:9):
> Replying to [Trevor Karn](#comment:7):
> > It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.

> 
> Yes, this is equivalent to inheriting from `Sequence`.

I realize that I have to clarify this: It is equivalent as far as `isinstance` and `issubclass` are concerned, but you will get the mix-in methods listed in https://docs.python.org/3/library/collections.abc.html#collections-abstract-base-classes (`__reversed__`, `count`, etc.) only if you inherit from `Sequence` in the class definition.



---

archive/issue_comments_557810.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [Travis Scrimshaw](#comment:12):\n> Replying to [Trevor Karn](#comment:7):\n> > It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.\n\n> \n> Does it also pass the `issubclass` test too?\n\nYes, of course, that should be added as a test maybe:\n\n```\nsage: import collections.abc\nsage: C = Composition([3,2,3])\nsage: issubclass(C.__class__, collections.abc.Sequence)\nTrue\nsage: isinstance(C, collections.abc.Sequence)\nTrue\n```",
    "created_at": "2022-09-15T04:37:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557810",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [Travis Scrimshaw](#comment:12):
> Replying to [Trevor Karn](#comment:7):
> > It looks like things are sufficiently fixed just by calling `Sequence.register(Composition)`.

> 
> Does it also pass the `issubclass` test too?

Yes, of course, that should be added as a test maybe:

```
sage: import collections.abc
sage: C = Composition([3,2,3])
sage: issubclass(C.__class__, collections.abc.Sequence)
True
sage: isinstance(C, collections.abc.Sequence)
True
```



---

archive/issue_comments_557811.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [Travis Scrimshaw](#comment:12):\n> What is the type of the result from applying `reversed` to the composition? \n\n\n```\nsage: reversed(C)\n<reversed object at 0x7fe2e86c4e50>\n```",
    "created_at": "2022-09-15T04:38:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557811",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [Travis Scrimshaw](#comment:12):
> What is the type of the result from applying `reversed` to the composition? 


```
sage: reversed(C)
<reversed object at 0x7fe2e86c4e50>
```



---

archive/issue_comments_557812.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [Trevor Karn](#comment:11):\n> Replying to [Matthias K\u00f6ppe](#comment:10):\n> > comment:4?\n\n> \n> Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the \"required\" methods, the general `Sequence` protocol is not really followed.\n\nIt is followed. The \"mixin\" methods are not part of the protocol.",
    "created_at": "2022-09-15T04:39:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557812",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [Trevor Karn](#comment:11):
> Replying to [Matthias KÃ¶ppe](#comment:10):
> > comment:4?

> 
> Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the "required" methods, the general `Sequence` protocol is not really followed.

It is followed. The "mixin" methods are not part of the protocol.



---

archive/issue_comments_557813.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [Matthias K\u00f6ppe](#comment:16):\n> Replying to [Trevor Karn](#comment:11):\n> > Replying to [Matthias K\u00f6ppe](#comment:10):\n> > > comment:4?\n\n> > \n> > Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the \"required\" methods, the general `Sequence` protocol is not really followed.\n\n> \n> It is followed. The \"mixin\" methods are not part of the protocol.\n\nNo, sorry, my mistake. It's getting late here.\n\nYou are right, it is not allowed to register it without implementing these mixin methods.\nBut you'll get them for free by changing it to subclassing instead of registering.",
    "created_at": "2022-09-15T04:41:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557813",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [Matthias KÃ¶ppe](#comment:16):
> Replying to [Trevor Karn](#comment:11):
> > Replying to [Matthias KÃ¶ppe](#comment:10):
> > > comment:4?

> > 
> > Sorry, I think I misunderstood. Since we are registering it as a `Sequence` rather than implementing the "required" methods, the general `Sequence` protocol is not really followed.

> 
> It is followed. The "mixin" methods are not part of the protocol.

No, sorry, my mistake. It's getting late here.

You are right, it is not allowed to register it without implementing these mixin methods.
But you'll get them for free by changing it to subclassing instead of registering.



---

archive/issue_comments_557814.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [Matthias K\u00f6ppe](#comment:15):\n> Replying to [Travis Scrimshaw](#comment:12):\n> > What is the type of the result from applying `reversed` to the composition? \n\n> \n> ```\n> sage: reversed(C)\n> <reversed object at 0x7fe2e86c4e50>\n> ```\n\nAh, right, duh. It is an iterator and does not return the reversed object.",
    "created_at": "2022-09-15T04:41:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557814",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [Matthias KÃ¶ppe](#comment:15):
> Replying to [Travis Scrimshaw](#comment:12):
> > What is the type of the result from applying `reversed` to the composition? 

> 
> ```
> sage: reversed(C)
> <reversed object at 0x7fe2e86c4e50>
> ```

Ah, right, duh. It is an iterator and does not return the reversed object.



---

archive/issue_comments_557815.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nAfter subclassing:\n\n```\n  File \"/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py\", line 50, in <module>\n    class Composition(CombinatorialElement, Sequence):\nTypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases\n```\n\nShould this be fixed at the `CombinatorialElement` level? Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?",
    "created_at": "2022-09-15T05:14:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557815",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:19" align="right">comment:19</div>

After subclassing:

```
  File "/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py", line 50, in <module>
    class Composition(CombinatorialElement, Sequence):
TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases
```

Should this be fixed at the `CombinatorialElement` level? Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?



---

archive/issue_comments_557816.json:
```json
{
    "body": "Changed commit from **[`e74e0b2`](https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0)** to **[`27b986a`](https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f)**",
    "created_at": "2022-09-15T05:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557816",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e74e0b2`](https://github.com/sagemath/sagetrac-mirror/commit/e74e0b2662607ded26b38b7f64960952ddf139d0)** to **[`27b986a`](https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f)**



---

archive/issue_comments_557817.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f\">27b986a</a></td><td><code>More updates to doctest</code></td></tr></table>\n",
    "created_at": "2022-09-15T05:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557817",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f">27b986a</a></td><td><code>More updates to doctest</code></td></tr></table>




---

archive/issue_comments_557818.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [Trevor Karn](#comment:19):\n> After subclassing:\n> \n> ```\n>   File \"/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py\", line 50, in <module>\n>     class Composition(CombinatorialElement, Sequence):\n> TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases\n> ```\n\nOuch. Python used a metaclass for their (collections) ABCs `abc.ABCMeta`. Well, I guess that settles it; we have to register it.\n\n> Should this be fixed at the `CombinatorialElement` level?\n\nNo, that is going to go away at some point.\n\n> Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?\n\nThis won't solve the problem:\n\n```\nsage: from sage.structure.list_clone import ClonableArray\nsage: ClonableArray.__class__\n<class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>\n```",
    "created_at": "2022-09-15T07:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557818",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [Trevor Karn](#comment:19):
> After subclassing:
> 
> ```
>   File "/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py", line 50, in <module>
>     class Composition(CombinatorialElement, Sequence):
> TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases
> ```

Ouch. Python used a metaclass for their (collections) ABCs `abc.ABCMeta`. Well, I guess that settles it; we have to register it.

> Should this be fixed at the `CombinatorialElement` level?

No, that is going to go away at some point.

> Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?

This won't solve the problem:

```
sage: from sage.structure.list_clone import ClonableArray
sage: ClonableArray.__class__
<class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>
```



---

archive/issue_comments_557819.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [Travis Scrimshaw](#comment:21):\n> Replying to [Trevor Karn](#comment:19):\n> > After subclassing:\n> > \n> > ```\n> >   File \"/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py\", line 50, in <module>\n> >     class Composition(CombinatorialElement, Sequence):\n> > TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases\n> > ```\n\n> \n> Ouch. Python used a metaclass for their (collections) ABCs `abc.ABCMeta`. Well, I guess that settles it; we have to register it.\n\nGot it - then I think this is ready for review. I tried to inclued the doctests which were relevant to this conversation, but please let me know if I need more.\n\n> > Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?\n\n> \n> This won't solve the problem:\n> \n> ```\n> sage: from sage.structure.list_clone import ClonableArray\n> sage: ClonableArray.__class__\n> <class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>\n> ```\n\nHuh. Should `ClonableArray` be a `Sequence`?",
    "created_at": "2022-09-15T17:54:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557819",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [Travis Scrimshaw](#comment:21):
> Replying to [Trevor Karn](#comment:19):
> > After subclassing:
> > 
> > ```
> >   File "/Users/trevorkarn/Applications/sage/src/sage/combinat/composition.py", line 50, in <module>
> >     class Composition(CombinatorialElement, Sequence):
> > TypeError: metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases
> > ```

> 
> Ouch. Python used a metaclass for their (collections) ABCs `abc.ABCMeta`. Well, I guess that settles it; we have to register it.

Got it - then I think this is ready for review. I tried to inclued the doctests which were relevant to this conversation, but please let me know if I need more.

> > Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?

> 
> This won't solve the problem:
> 
> ```
> sage: from sage.structure.list_clone import ClonableArray
> sage: ClonableArray.__class__
> <class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>
> ```

Huh. Should `ClonableArray` be a `Sequence`?



---

archive/issue_comments_557820.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [Trevor Karn](#comment:22):\n> Replying to [Travis Scrimshaw](#comment:21):\n> > Replying to [Trevor Karn](#comment:19):\n> > > Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?\n\n> > \n> > This won't solve the problem:\n> > \n> > ```\n> > sage: from sage.structure.list_clone import ClonableArray\n> > sage: ClonableArray.__class__\n> > <class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>\n> > ```\n\n> Huh. Should `ClonableArray` be a `Sequence`?\n\nThis is saying it also has a metaclass.",
    "created_at": "2022-09-16T00:01:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557820",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [Trevor Karn](#comment:22):
> Replying to [Travis Scrimshaw](#comment:21):
> > Replying to [Trevor Karn](#comment:19):
> > > Or would it be better to just make `Composition` a subclass of `ClonableArray` to update it?

> > 
> > This won't solve the problem:
> > 
> > ```
> > sage: from sage.structure.list_clone import ClonableArray
> > sage: ClonableArray.__class__
> > <class 'sage.misc.inherit_comparison.InheritComparisonMetaclass'>
> > ```

> Huh. Should `ClonableArray` be a `Sequence`?

This is saying it also has a metaclass.



---

archive/issue_events_471348.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-16T18:37:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471348"
}
```



---

archive/issue_events_471349.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-16T18:37:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471349"
}
```



---

archive/issue_comments_557821.json:
```json
{
    "body": "Changed commit from **[`27b986a`](https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f)** to **[`c0eb2b4`](https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940)**",
    "created_at": "2022-09-17T14:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557821",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`27b986a`](https://github.com/sagemath/sagetrac-mirror/commit/27b986acad2252c66ec110b06b7ddd911749892f)** to **[`c0eb2b4`](https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940)**



---

archive/issue_comments_557822.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940\">c0eb2b4</a></td><td><code>Add to documentation and remove reversed type-check</code></td></tr></table>\n",
    "created_at": "2022-09-17T14:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557822",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940">c0eb2b4</a></td><td><code>Add to documentation and remove reversed type-check</code></td></tr></table>




---

archive/issue_events_471350.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-17T14:07:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471350"
}
```



---

archive/issue_events_471351.json:
```json
{
    "actor": "https://github.com/trevorkarn",
    "created_at": "2022-09-17T14:07:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471351"
}
```



---

archive/issue_comments_557823.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nDocumentation is updated.",
    "created_at": "2022-09-17T14:07:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557823",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:26" align="right">comment:26</div>

Documentation is updated.



---

archive/issue_comments_557824.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThanks. I am happy with this (modulo the one change below). Matthias?\n\nSphinx treats the backtick as normal text when between alpha(numeric?) characters:\n\n```diff\n     Typically, instances of ``collections.abc.Sequence`` have a ``.count`` method.\n-    This is *not* the case for ``Composition``s::\n+    This is *not* the case for a ``Composition``::\n```",
    "created_at": "2022-09-18T00:06:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557824",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:27" align="right">comment:27</div>

Thanks. I am happy with this (modulo the one change below). Matthias?

Sphinx treats the backtick as normal text when between alpha(numeric?) characters:

```diff
     Typically, instances of ``collections.abc.Sequence`` have a ``.count`` method.
-    This is *not* the case for ``Composition``s::
+    This is *not* the case for a ``Composition``::
```



---

archive/issue_comments_557825.json:
```json
{
    "body": "Changed commit from **[`c0eb2b4`](https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940)** to **[`b0a87c6`](https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881)**",
    "created_at": "2022-09-18T01:48:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557825",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c0eb2b4`](https://github.com/sagemath/sagetrac-mirror/commit/c0eb2b4e352cfd740d44e270d6d56261bcc46940)** to **[`b0a87c6`](https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881)**



---

archive/issue_comments_557826.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881\">b0a87c6</a></td><td><code>Fix documentation</code></td></tr></table>\n",
    "created_at": "2022-09-18T01:48:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557826",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881">b0a87c6</a></td><td><code>Fix documentation</code></td></tr></table>




---

archive/issue_comments_557827.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI think in [comment:17](#comment:17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it",
    "created_at": "2022-09-18T05:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557827",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

I think in [comment:17](#comment:17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it



---

archive/issue_comments_557828.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [Matthias K\u00f6ppe](#comment:29):\n> I think in [comment:17](#comment:17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it\n\nI understand [this python discussion post](https://discuss.python.org/t/mapping-abc-and-friends-are-the-mixin-methods-required-to-satisfy-the-interface/9499/2) to mean that mix-in methods are *not* required.\n\nOn the other hand it is easy enough to implement `.count()` where `.count(n)` returns the number of parts of size `n`. So I'll do that later today.",
    "created_at": "2022-09-19T19:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557828",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [Matthias KÃ¶ppe](#comment:29):
> I think in [comment:17](#comment:17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it

I understand [this python discussion post](https://discuss.python.org/t/mapping-abc-and-friends-are-the-mixin-methods-required-to-satisfy-the-interface/9499/2) to mean that mix-in methods are *not* required.

On the other hand it is easy enough to implement `.count()` where `.count(n)` returns the number of parts of size `n`. So I'll do that later today.



---

archive/issue_comments_557829.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2\">78f3a92</a></td><td><code>Add .count</code></td></tr></table>\n",
    "created_at": "2022-09-19T22:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557829",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2">78f3a92</a></td><td><code>Add .count</code></td></tr></table>




---

archive/issue_comments_557830.json:
```json
{
    "body": "Changed commit from **[`b0a87c6`](https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881)** to **[`78f3a92`](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**",
    "created_at": "2022-09-19T22:37:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557830",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b0a87c6`](https://github.com/sagemath/sagetrac-mirror/commit/b0a87c62f2bdb6e7982390331725d6f3654b1881)** to **[`78f3a92`](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**



---

archive/issue_comments_557831.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [Matthias K\u00f6ppe](#comment:29):\n> I think in [comment:17](#comment:17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it\n\nOk. I think `Sequence` things should be good to go.",
    "created_at": "2022-09-19T22:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557831",
    "user": "https://github.com/trevorkarn"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [Matthias KÃ¶ppe](#comment:29):
> I think in [comment:17](#comment:17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it

Ok. I think `Sequence` things should be good to go.



---

archive/issue_comments_557832.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [Matthias K\u00f6ppe](#comment:29):\n> I think in [comment:17](#comment:17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it\n\nThis is in point (2) of the main Python ABC doc in [comment:1](#comment:1).",
    "created_at": "2022-09-20T05:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557832",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [Matthias KÃ¶ppe](#comment:29):
> I think in [comment:17](#comment:17), I concluded that all mix-in methods must be provided. Too tired this evening to re-read the Python reference to confirm it

This is in point (2) of the main Python ABC doc in [comment:1](#comment:1).



---

archive/issue_comments_557833.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw, Matthias K\u00f6ppe**",
    "created_at": "2022-09-20T05:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557833",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw, Matthias KÃ¶ppe**



---

archive/issue_comments_557834.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nThat takes care of all of the mixin methods. So I am good with this. Anything objections to a positive review Matthias?",
    "created_at": "2022-09-20T05:59:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557834",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:34" align="right">comment:34</div>

That takes care of all of the mixin methods. So I am good with this. Anything objections to a positive review Matthias?



---

archive/issue_events_471352.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-22T03:22:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471352"
}
```



---

archive/issue_events_471353.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-22T03:22:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471353"
}
```



---

archive/issue_comments_557835.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nLGTM, thanks.",
    "created_at": "2022-09-22T03:22:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557835",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:35" align="right">comment:35</div>

LGTM, thanks.



---

archive/issue_events_471354.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-25T16:34:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471354"
}
```



---

archive/issue_events_471355.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "893b376348277d4524a558d9f36d2c3d3dbc4219",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-09-25T16:34:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34527#event-471355"
}
```



---

archive/issue_comments_557836.json:
```json
{
    "body": "Changed branch from **[u/tkarn/composition-34527](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/composition-34527)** to **[`78f3a92`](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**",
    "created_at": "2022-09-25T16:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34527",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34527#issuecomment-557836",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/tkarn/composition-34527](https://github.com/sagemath/sagetrac-mirror/tree/u/tkarn/composition-34527)** to **[`78f3a92`](https://github.com/sagemath/sagetrac-mirror/commit/78f3a9218b8a51f643855917280b4e97b46db0c2)**
