# Issue 34807: Add Construction of Hadamard matrices up to order 664

archive/issues_034570.json:
```json
{
    "body": "With #34690, all the Hadamard matrices of order <=288 have been added. The next task is to implement matrices of order up to 664 (668 is the first order for which no construction is known). This will require implementing https://core.ac.uk/download/pdf/82189436.pdf, as well as adding some more data for the constructions that are already present.\n\nCC:  @dimpase\n\nReviewer: Dima Pasechnik\n\nAuthor: Matteo Cati\n\nBranch: u/gh-MatteoCati/add_hadamard_matrices_up_to_664\n\nStatus: positive_review\n\nDependencies: #34690\n\nCommit: 1f624a44bcd789d9788c693a262699db4313edd8\n\nIssue created by migration from https://trac.sagemath.org/ticket/34807\n\n",
    "created_at": "2022-11-29T09:30:29Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add Construction of Hadamard matrices up to order 664",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34807",
    "user": "https://github.com/MatteoCati"
}
```
With #34690, all the Hadamard matrices of order <=288 have been added. The next task is to implement matrices of order up to 664 (668 is the first order for which no construction is known). This will require implementing https://core.ac.uk/download/pdf/82189436.pdf, as well as adding some more data for the constructions that are already present.

CC:  @dimpase

Reviewer: Dima Pasechnik

Author: Matteo Cati

Branch: u/gh-MatteoCati/add_hadamard_matrices_up_to_664

Status: positive_review

Dependencies: #34690

Commit: 1f624a44bcd789d9788c693a262699db4313edd8

Issue created by migration from https://trac.sagemath.org/ticket/34807





---

archive/issue_comments_691821.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-12-08T17:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691821",
    "user": "https://github.com/MatteoCati"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_691822.json:
```json
{
    "body": "Changing commit from \"\" to \"7e803fb32a61a13d289514263c94580814591a5d\"",
    "created_at": "2022-12-08T17:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691822",
    "user": "https://github.com/MatteoCati"
}
```

Changing commit from "" to "7e803fb32a61a13d289514263c94580814591a5d"



---

archive/issue_comments_691823.json:
```json
{
    "body": "<a id='comment:1'></a>Last 10 new commits:",
    "created_at": "2022-12-08T17:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691823",
    "user": "https://github.com/MatteoCati"
}
```

<a id='comment:1'></a>Last 10 new commits:



---

archive/issue_comments_691824.json:
```json
{
    "body": "Changing branch from \"\" to \"u/gh-MatteoCati/add_hadamard_matrices_up_to_664\"",
    "created_at": "2022-12-08T17:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691824",
    "user": "https://github.com/MatteoCati"
}
```

Changing branch from "" to "u/gh-MatteoCati/add_hadamard_matrices_up_to_664"



---

archive/issue_comments_691825.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-08T18:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691825",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_691826.json:
```json
{
    "body": "Changing commit from \"7e803fb32a61a13d289514263c94580814591a5d\" to \"cb9b0ca3fed27a9c879034d66cbbe5cb995e183f\"",
    "created_at": "2022-12-08T18:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691826",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7e803fb32a61a13d289514263c94580814591a5d" to "cb9b0ca3fed27a9c879034d66cbbe5cb995e183f"



---

archive/issue_comments_691827.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-08T19:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691827",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_691828.json:
```json
{
    "body": "Changing commit from \"cb9b0ca3fed27a9c879034d66cbbe5cb995e183f\" to \"b51cc149ad10cc8e0aaee4e8338cc6684e7445c2\"",
    "created_at": "2022-12-08T19:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691828",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cb9b0ca3fed27a9c879034d66cbbe5cb995e183f" to "b51cc149ad10cc8e0aaee4e8338cc6684e7445c2"



---

archive/issue_comments_691829.json:
```json
{
    "body": "<a id='comment:4'></a>Wow! That's impressive! Could you say a bit what's in that almost 3000 lines you add here?",
    "created_at": "2022-12-08T22:46:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691829",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>Wow! That's impressive! Could you say a bit what's in that almost 3000 lines you add here?



---

archive/issue_comments_691830.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-09T09:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691830",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_691831.json:
```json
{
    "body": "Changing commit from \"b51cc149ad10cc8e0aaee4e8338cc6684e7445c2\" to \"2cb617c7e2c9d16ca7f769899dc49b9bfa26b5d3\"",
    "created_at": "2022-12-09T09:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691831",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b51cc149ad10cc8e0aaee4e8338cc6684e7445c2" to "2cb617c7e2c9d16ca7f769899dc49b9bfa26b5d3"



---

archive/issue_comments_691832.json:
```json
{
    "body": "<a id='comment:6'></a>- I've implemented Spence construction in `hadamard_matrix.py`. This uses the supplementary difference sets created by `supplementary_difference_set` in `difference_faimilies.py`. In the same file, the relative difference sets used by Spence to construct supplementary difference sets are created by the function `relative_difference_set`.\n- In `t_sequences.py`, I've added some new T-sequences. These are constructed from base sequences using the function `T_sequences_construction_from_base_sequences` (this function was already present, but was being used only for the case when p=1). Also, base sequences are constructed from Turyn type sequences using the (new) function `base_sequences_construction` (I've also added the function `is_base_sequences_tuple`, to check that the construction is correct). Turyn type sequences are stored directly in `turyn_type_sequences_smallcases`.\n- Lastly, I've added in `difference_family.py` the function `skew_supplementary_difference_set` which creates skew SDS (as described by  Djokovic in https://ajc.maths.uq.edu.au/pdf/10/ocr-ajc-v10-p259.pdf), which are used by `GS_skew_hadamard_smallcases` in `hadamard_matrix.py` to  create new skew Hadamard matrices.\n\nAlso, note that the older commits (up until bd025a2e87389b9b7f5573049ad62cdd087e2bf0) are coming from ticket #34690.",
    "created_at": "2022-12-09T09:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691832",
    "user": "https://github.com/MatteoCati"
}
```

<a id='comment:6'></a>- I've implemented Spence construction in `hadamard_matrix.py`. This uses the supplementary difference sets created by `supplementary_difference_set` in `difference_faimilies.py`. In the same file, the relative difference sets used by Spence to construct supplementary difference sets are created by the function `relative_difference_set`.
- In `t_sequences.py`, I've added some new T-sequences. These are constructed from base sequences using the function `T_sequences_construction_from_base_sequences` (this function was already present, but was being used only for the case when p=1). Also, base sequences are constructed from Turyn type sequences using the (new) function `base_sequences_construction` (I've also added the function `is_base_sequences_tuple`, to check that the construction is correct). Turyn type sequences are stored directly in `turyn_type_sequences_smallcases`.
- Lastly, I've added in `difference_family.py` the function `skew_supplementary_difference_set` which creates skew SDS (as described by  Djokovic in https://ajc.maths.uq.edu.au/pdf/10/ocr-ajc-v10-p259.pdf), which are used by `GS_skew_hadamard_smallcases` in `hadamard_matrix.py` to  create new skew Hadamard matrices.

Also, note that the older commits (up until bd025a2e87389b9b7f5573049ad62cdd087e2bf0) are coming from ticket #34690.



---

archive/issue_comments_691833.json:
```json
{
    "body": "<a id='comment:7'></a>Does this mean that we also have new (for Sage) orders for skew Hadamard matrices?",
    "created_at": "2022-12-09T21:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691833",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Does this mean that we also have new (for Sage) orders for skew Hadamard matrices?



---

archive/issue_comments_691834.json:
```json
{
    "body": "<a id='comment:8'></a>Yes, I've added skew Hadamard matrices of order 268, 412, 452, 508, 604, 628, 652, 724, 964.",
    "created_at": "2022-12-10T08:49:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691834",
    "user": "https://github.com/MatteoCati"
}
```

<a id='comment:8'></a>Yes, I've added skew Hadamard matrices of order 268, 412, 452, 508, 604, 628, 652, 724, 964.



---

archive/issue_comments_691835.json:
```json
{
    "body": "Changing commit from \"2cb617c7e2c9d16ca7f769899dc49b9bfa26b5d3\" to \"1f624a44bcd789d9788c693a262699db4313edd8\"",
    "created_at": "2022-12-11T16:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691835",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2cb617c7e2c9d16ca7f769899dc49b9bfa26b5d3" to "1f624a44bcd789d9788c693a262699db4313edd8"



---

archive/issue_comments_691836.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-12-11T16:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691836",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_691837.json:
```json
{
    "body": "<a id='comment:10'></a>Rebased over latest beta.",
    "created_at": "2022-12-11T16:32:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691837",
    "user": "https://github.com/MatteoCati"
}
```

<a id='comment:10'></a>Rebased over latest beta.



---

archive/issue_comments_691838.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:8 Matteo Cati]:\n> Yes, I've added skew Hadamard matrices of order 268, 412, 452, 508, 604, 628, 652, 724, 964.\nnice. \n\nHow about bringing Sage up to date w.r.t. skew Hadamard matrices too?\nI actually don't know what the 1st unknown order is in this case (something that's probably mentioned in the literature, I didn't try too hard to find this),\nbut I noticed that Sage does not know about orders 76, 100, and 116, whereas examples are known, see e.g.\n\nhttps://mathscinet.ams.org/mathscinet-getitem?mr=2416980",
    "created_at": "2022-12-13T14:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691838",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>Replying to [comment:8 Matteo Cati]:
> Yes, I've added skew Hadamard matrices of order 268, 412, 452, 508, 604, 628, 652, 724, 964.
nice. 

How about bringing Sage up to date w.r.t. skew Hadamard matrices too?
I actually don't know what the 1st unknown order is in this case (something that's probably mentioned in the literature, I didn't try too hard to find this),
but I noticed that Sage does not know about orders 76, 100, and 116, whereas examples are known, see e.g.

https://mathscinet.ams.org/mathscinet-getitem?mr=2416980



---

archive/issue_comments_691839.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2022-12-13T14:11:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691839",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_691840.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-12-13T14:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691840",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_691841.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:11 Dima Pasechnik]:\n> How about bringing Sage up to date w.r.t. skew Hadamard matrices too?\n\n\nOkay, I will open a new ticket (#34848).",
    "created_at": "2022-12-14T12:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34807",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34807#issuecomment-691841",
    "user": "https://github.com/MatteoCati"
}
```

<a id='comment:14'></a>Replying to [comment:11 Dima Pasechnik]:
> How about bringing Sage up to date w.r.t. skew Hadamard matrices too?


Okay, I will open a new ticket (#34848).
