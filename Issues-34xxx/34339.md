# Issue 34339: Speedup adding horizontal and vertical border strips

archive/issues_034102.json:
```json
{
    "body": "We can be better about the number of conjugations involved.\n\nCC:  @trevorkarn @anneschilling @nthiery @darijgr @zabrocki\n\nKeywords: combinat, partition\n\nBranch/Commit: [5e528328e21c312483374adfc26967e95530063d](https://github.com/sagemath/sagetrac-mirror/commit/5e528328e21c312483374adfc26967e95530063d)\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34339\n\n",
    "closed_at": "2022-08-30T06:51:26Z",
    "created_at": "2022-08-11T01:35:29Z",
    "labels": [
        "component: performance"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Speedup adding horizontal and vertical border strips",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34339",
    "user": "https://github.com/tscrim"
}
```
We can be better about the number of conjugations involved.

CC:  @trevorkarn @anneschilling @nthiery @darijgr @zabrocki

Keywords: combinat, partition

Branch/Commit: [5e528328e21c312483374adfc26967e95530063d](https://github.com/sagemath/sagetrac-mirror/commit/5e528328e21c312483374adfc26967e95530063d)

Reviewer: Frédéric Chapoton

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34339





---

archive/issue_comments_683292.json:
```json
{
    "body": "<a id='comment:1'></a>\nWith my branch, this is now\n\n```\nsage: %timeit Partition([2,2]).add_vertical_border_strip(2)\n57.9 \u00b5s \u00b1 484 ns per loop (mean \u00b1 std. dev. of 7 runs, 10,000 loops each)\nsage: %timeit Partition([3,2,2]).add_vertical_border_strip(2)\n101 \u00b5s \u00b1 1.02 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10,000 loops each)\nsage: %timeit Partition([7,4,2,2,2,1,1]).add_vertical_border_strip(5)  # 43 partitions\n871 \u00b5s \u00b1 6.03 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1,000 loops each)\n\nsage: %timeit Partition([2,2]).add_horizontal_border_strip(2)\n54.6 \u00b5s \u00b1 388 ns per loop (mean \u00b1 std. dev. of 7 runs, 10,000 loops each)\nsage: %timeit Partition([3,2,2]).add_horizontal_border_strip(2)\n99.3 \u00b5s \u00b1 1.01 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10,000 loops each)\nsage: %timeit Partition([7,4,2,2,2,1,1]).add_horizontal_border_strip(5)  # 43 partitions\n908 \u00b5s \u00b1 3.09 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1,000 loops each)\nsage: %timeit Partition([5,4,3,2,1]).add_horizontal_border_strip(5)  # 32 partitions\n769 \u00b5s \u00b1 2.95 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1,000 loops each)\n```\nversus before:\n\n```\n109 \u00b5s \u00b1 650 ns per loop (mean \u00b1 std. dev. of 7 runs, 10,000 loops each)\n170 \u00b5s \u00b1 1.31 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10,000 loops each)\n1.32 ms \u00b1 5.69 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1,000 loops each)\n\n99.2 \u00b5s \u00b1 773 ns per loop (mean \u00b1 std. dev. of 7 runs, 10,000 loops each)\n158 \u00b5s \u00b1 559 ns per loop (mean \u00b1 std. dev. of 7 runs, 10,000 loops each)\n1.15 ms \u00b1 4.29 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1,000 loops each)\n997 \u00b5s \u00b1 4.7 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 1,000 loops each)\n```\nThe output order of the `add_horizontal_border_strip()` has changed, but this should be inconsequential.\n\n---\nNew commits:\n|                                                                                                                                          |                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n|[6ccd9e4](https://github.com/sagemath/sagetrac-mirror/commit/6ccd9e4203f2f6364f279e6d180a32da2c8a0012)|`Optimization of add_*_border_strip() and doctest update.`|",
    "created_at": "2022-08-11T02:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683292",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
With my branch, this is now

```
sage: %timeit Partition([2,2]).add_vertical_border_strip(2)
57.9 µs ± 484 ns per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
sage: %timeit Partition([3,2,2]).add_vertical_border_strip(2)
101 µs ± 1.02 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
sage: %timeit Partition([7,4,2,2,2,1,1]).add_vertical_border_strip(5)  # 43 partitions
871 µs ± 6.03 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)

sage: %timeit Partition([2,2]).add_horizontal_border_strip(2)
54.6 µs ± 388 ns per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
sage: %timeit Partition([3,2,2]).add_horizontal_border_strip(2)
99.3 µs ± 1.01 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
sage: %timeit Partition([7,4,2,2,2,1,1]).add_horizontal_border_strip(5)  # 43 partitions
908 µs ± 3.09 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
sage: %timeit Partition([5,4,3,2,1]).add_horizontal_border_strip(5)  # 32 partitions
769 µs ± 2.95 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
```
versus before:

```
109 µs ± 650 ns per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
170 µs ± 1.31 µs per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
1.32 ms ± 5.69 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)

99.2 µs ± 773 ns per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
158 µs ± 559 ns per loop (mean ± std. dev. of 7 runs, 10,000 loops each)
1.15 ms ± 4.29 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
997 µs ± 4.7 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
```
The output order of the `add_horizontal_border_strip()` has changed, but this should be inconsequential.

---
New commits:
|                                                                                                                                          |                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
|[6ccd9e4](https://github.com/sagemath/sagetrac-mirror/commit/6ccd9e4203f2f6364f279e6d180a32da2c8a0012)|`Optimization of add_*_border_strip() and doctest update.`|



---

archive/issue_comments_683293.json:
```json
{
    "body": "Commit: [6ccd9e4203f2f6364f279e6d180a32da2c8a0012](https://github.com/sagemath/sagetrac-mirror/commit/6ccd9e4203f2f6364f279e6d180a32da2c8a0012)",
    "created_at": "2022-08-11T02:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683293",
    "user": "https://github.com/tscrim"
}
```

Commit: [6ccd9e4203f2f6364f279e6d180a32da2c8a0012](https://github.com/sagemath/sagetrac-mirror/commit/6ccd9e4203f2f6364f279e6d180a32da2c8a0012)



---

archive/issue_comments_683294.json:
```json
{
    "body": "Branch: [public/combinat/speedup_adding_strips-34339](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_adding_strips-34339)",
    "created_at": "2022-08-11T02:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683294",
    "user": "https://github.com/tscrim"
}
```

Branch: [public/combinat/speedup_adding_strips-34339](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_adding_strips-34339)



---

archive/issue_comments_683295.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-11T02:38:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683295",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_683296.json:
```json
{
    "body": "<a id='comment:2'></a>\npathbot reports a failing doctest in `src/sage/tests/book_schilling_zabrocki_kschur_primer`",
    "created_at": "2022-08-11T17:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683296",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
pathbot reports a failing doctest in `src/sage/tests/book_schilling_zabrocki_kschur_primer`



---

archive/issue_comments_683297.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[5e52832](https://github.com/sagemath/sagetrac-mirror/commit/5e528328e21c312483374adfc26967e95530063d)|`Fixing order of k_atoms in k-Schur book.`|",
    "created_at": "2022-08-12T05:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683297",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[5e52832](https://github.com/sagemath/sagetrac-mirror/commit/5e528328e21c312483374adfc26967e95530063d)|`Fixing order of k_atoms in k-Schur book.`|



---

archive/issue_comments_683298.json:
```json
{
    "body": "Changing commit from \"[6ccd9e4203f2f6364f279e6d180a32da2c8a0012](https://github.com/sagemath/sagetrac-mirror/commit/6ccd9e4203f2f6364f279e6d180a32da2c8a0012)\" to \"[5e528328e21c312483374adfc26967e95530063d](https://github.com/sagemath/sagetrac-mirror/commit/5e528328e21c312483374adfc26967e95530063d)\"",
    "created_at": "2022-08-12T05:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683298",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[6ccd9e4203f2f6364f279e6d180a32da2c8a0012](https://github.com/sagemath/sagetrac-mirror/commit/6ccd9e4203f2f6364f279e6d180a32da2c8a0012)" to "[5e528328e21c312483374adfc26967e95530063d](https://github.com/sagemath/sagetrac-mirror/commit/5e528328e21c312483374adfc26967e95530063d)"



---

archive/issue_comments_683299.json:
```json
{
    "body": "<a id='comment:4'></a>\nFixed.",
    "created_at": "2022-08-12T05:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683299",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
Fixed.



---

archive/issue_comments_683300.json:
```json
{
    "body": "Reviewer: Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2022-08-12T18:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683300",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: Frédéric Chapoton



---

archive/issue_comments_683301.json:
```json
{
    "body": "<a id='comment:5'></a>\nok, let's move on",
    "created_at": "2022-08-12T18:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683301",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
ok, let's move on



---

archive/issue_comments_683302.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-12T18:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683302",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_683303.json:
```json
{
    "body": "<a id='comment:6'></a>\nThank you.",
    "created_at": "2022-08-13T02:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683303",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
Thank you.



---

archive/issue_comments_683304.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-30T06:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683304",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_100672.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-30T06:51:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34339#event-100672"
}
```



---

archive/issue_comments_683305.json:
```json
{
    "body": "Changing branch from \"[public/combinat/speedup_adding_strips-34339](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_adding_strips-34339)\" to \"[5e528328e21c312483374adfc26967e95530063d](https://github.com/sagemath/sagetrac-mirror/commit/5e528328e21c312483374adfc26967e95530063d)\"",
    "created_at": "2022-08-30T06:51:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34339#issuecomment-683305",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[public/combinat/speedup_adding_strips-34339](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/speedup_adding_strips-34339)" to "[5e528328e21c312483374adfc26967e95530063d](https://github.com/sagemath/sagetrac-mirror/commit/5e528328e21c312483374adfc26967e95530063d)"
