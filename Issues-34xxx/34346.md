# Issue 34346: New modularized distributions sagemath-{sirocco,bliss,meataxe,mcqd,coxeter3,tdlib}

archive/issues_034109.json:
```json
{
    "body": "These are the python extension modules that depend on the optional packages sirocco, bliss, ...\n- https://pypi.org/project/sagemath-meataxe\n- https://pypi.org/project/sagemath-sirocco\n- https://pypi.org/project/sagemath-bliss/\n- https://pypi.org/project/sagemath-mcqd/\n- https://pypi.org/project/sagemath-coxeter3/\n- https://pypi.org/project/sagemath-tdlib/\n\nWe also add distros/conda.txt for some of these packages.\n\nWe should add this info to https://doc.sagemath.org/html/en/installation/conda.html#installing-all-of-sagemath-from-conda-not-for-development\n\nCC:  @saraedum @mkoeppe @slel @kiwifb @antonio-rojas @tornaria @dimpase\n\nAuthor: Matthias Koeppe\n\nBranch: u/mkoeppe/document_new_conda_packages_sagemath_sirocco_and_sagemath_bliss\n\nStatus: needs_work\n\nDependencies: #32874, #34761, #34858, #34855\n\nCommit: 96864238fe7712541ec373098bb2f58d607a041c\n\nIssue created by migration from https://trac.sagemath.org/ticket/34346\n\n",
    "created_at": "2022-08-12T01:55:02Z",
    "labels": [
        "component: refactoring"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "New modularized distributions sagemath-{sirocco,bliss,meataxe,mcqd,coxeter3,tdlib}",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34346",
    "user": "https://github.com/isuruf"
}
```
These are the python extension modules that depend on the optional packages sirocco, bliss, ...
- https://pypi.org/project/sagemath-meataxe
- https://pypi.org/project/sagemath-sirocco
- https://pypi.org/project/sagemath-bliss/
- https://pypi.org/project/sagemath-mcqd/
- https://pypi.org/project/sagemath-coxeter3/
- https://pypi.org/project/sagemath-tdlib/

We also add distros/conda.txt for some of these packages.

We should add this info to https://doc.sagemath.org/html/en/installation/conda.html#installing-all-of-sagemath-from-conda-not-for-development

CC:  @saraedum @mkoeppe @slel @kiwifb @antonio-rojas @tornaria @dimpase

Author: Matthias Koeppe

Branch: u/mkoeppe/document_new_conda_packages_sagemath_sirocco_and_sagemath_bliss

Status: needs_work

Dependencies: #32874, #34761, #34858, #34855

Commit: 96864238fe7712541ec373098bb2f58d607a041c

Issue created by migration from https://trac.sagemath.org/ticket/34346





---

archive/issue_comments_517017.json:
```json
{
    "body": "<a id='comment:1'></a>the Python distribution packages should go to `pkgs/`",
    "created_at": "2022-08-12T02:09:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517017",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>the Python distribution packages should go to `pkgs/`



---

archive/issue_events_089402.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34346#event-89402"
}
```



---

archive/issue_comments_517018.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2022-10-08T21:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517018",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_comments_517019.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-10-09T05:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517019",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_517020.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-09T07:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517020",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517021.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-16T05:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517021",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517022.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-16T06:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517022",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517023.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-16T06:41:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517023",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517024.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-16T07:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517024",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517025.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-16T07:27:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517025",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517026.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-These are the two python extension modules that depend on the optional packages sirocco and bliss.\n+These are the python extension modules that depend on the optional packages sirocco, bliss, ...\n+\n+We also add distros/conda.txt for some of these packages.\n \n We should add this info to https://doc.sagemath.org/html/en/installation/conda.html#installing-all-of-sagemath-from-conda-not-for-development\n \n``````\n",
    "created_at": "2022-11-16T07:30:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517026",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-These are the two python extension modules that depend on the optional packages sirocco and bliss.
+These are the python extension modules that depend on the optional packages sirocco, bliss, ...
+
+We also add distros/conda.txt for some of these packages.
 
 We should add this info to https://doc.sagemath.org/html/en/installation/conda.html#installing-all-of-sagemath-from-conda-not-for-development
 
``````




---

archive/issue_comments_517027.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-16T08:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517027",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517028.json:
```json
{
    "body": "Changing component from documentation to refactoring.",
    "created_at": "2022-11-16T08:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517028",
    "user": "https://github.com/mkoeppe"
}
```

Changing component from documentation to refactoring.



---

archive/issue_comments_517029.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-11-16T08:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517029",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_517030.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-11-20T22:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517030",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_517031.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-11-20T23:47:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517031",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_517032.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-21T03:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517032",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517033.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-11-21T03:15:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517033",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_517034.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+These are the python extension modules that depend on the optional packages sirocco, bliss, ...\n+- https://pypi.org/project/sagemath-meataxe\n+- https://pypi.org/project/sagemath-sirocco\n+- https://pypi.org/project/sagemath-bliss/\n+- https://pypi.org/project/sagemath-mcqd/\n+- https://pypi.org/project/sagemath-coxeter3/\n \n+We also add distros/conda.txt for some of these packages.\n+\n+We should add this info to https://doc.sagemath.org/html/en/installation/conda.html#installing-all-of-sagemath-from-conda-not-for-development\n \n Comment: 1\n \n``````\n",
    "created_at": "2022-11-21T07:50:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517034",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,13 @@
+These are the python extension modules that depend on the optional packages sirocco, bliss, ...
+- https://pypi.org/project/sagemath-meataxe
+- https://pypi.org/project/sagemath-sirocco
+- https://pypi.org/project/sagemath-bliss/
+- https://pypi.org/project/sagemath-mcqd/
+- https://pypi.org/project/sagemath-coxeter3/
 
+We also add distros/conda.txt for some of these packages.
+
+We should add this info to https://doc.sagemath.org/html/en/installation/conda.html#installing-all-of-sagemath-from-conda-not-for-development
 
 Comment: 1
 
``````




---

archive/issue_comments_517035.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-21T07:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517035",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517036.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-05T01:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517036",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_517037.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+These are the python extension modules that depend on the optional packages sirocco, bliss, ...\n+- https://pypi.org/project/sagemath-meataxe\n+- https://pypi.org/project/sagemath-sirocco\n+- https://pypi.org/project/sagemath-bliss/\n+- https://pypi.org/project/sagemath-mcqd/\n+- https://pypi.org/project/sagemath-coxeter3/\n+- https://pypi.org/project/sagemath-tdlib/\n \n+We also add distros/conda.txt for some of these packages.\n+\n+We should add this info to https://doc.sagemath.org/html/en/installation/conda.html#installing-all-of-sagemath-from-conda-not-for-development\n \n Comment: 1\n \n``````\n",
    "created_at": "2022-12-05T01:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517037",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
+These are the python extension modules that depend on the optional packages sirocco, bliss, ...
+- https://pypi.org/project/sagemath-meataxe
+- https://pypi.org/project/sagemath-sirocco
+- https://pypi.org/project/sagemath-bliss/
+- https://pypi.org/project/sagemath-mcqd/
+- https://pypi.org/project/sagemath-coxeter3/
+- https://pypi.org/project/sagemath-tdlib/
 
+We also add distros/conda.txt for some of these packages.
+
+We should add this info to https://doc.sagemath.org/html/en/installation/conda.html#installing-all-of-sagemath-from-conda-not-for-development
 
 Comment: 1
 
``````




---

archive/issue_comments_517038.json:
```json
{
    "body": "<a id='comment:27'></a>No tox.ini for these distribution packages?",
    "created_at": "2022-12-08T01:29:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517038",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:27'></a>No tox.ini for these distribution packages?



---

archive/issue_comments_517039.json:
```json
{
    "body": "<a id='comment:28'></a>Good idea, I'll add them",
    "created_at": "2022-12-08T01:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517039",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'></a>Good idea, I'll add them



---

archive/issue_comments_517040.json:
```json
{
    "body": "<a id='comment:29'></a>and these lines (of `pkgs/sagemath-bliss/setup.py` for instance) are right?\n\n```sage\nif len(sys.argv) > 1 and (sys.argv[1] == \"sdist\" or sys.argv[1] == \"egg_info\"):\n    sdist = True\nelse:\n    sdist = False\n\nif sdist:\n    cmdclass = {}\nelse:\n    ...\n    lines that build source distribution ???\n    ...\n```\n\nWhen running\n\n```\n    python3 -u setup.py --no-user-cfg sdist --dist-dir \"$SAGE_DISTFILES\"\n```\nthe \"if condition\" actually fails so that the sdist is actually built, but this seems just a good luck. Am I reading something wrong?",
    "created_at": "2022-12-08T02:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517040",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:29'></a>and these lines (of `pkgs/sagemath-bliss/setup.py` for instance) are right?

```sage
if len(sys.argv) > 1 and (sys.argv[1] == "sdist" or sys.argv[1] == "egg_info"):
    sdist = True
else:
    sdist = False

if sdist:
    cmdclass = {}
else:
    ...
    lines that build source distribution ???
    ...
```

When running

```
    python3 -u setup.py --no-user-cfg sdist --dist-dir "$SAGE_DISTFILES"
```
the "if condition" actually fails so that the sdist is actually built, but this seems just a good luck. Am I reading something wrong?



---

archive/issue_comments_517041.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-12-08T04:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517041",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_517042.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:29 Kwankyu Lee]:\n> and these lines (of `pkgs/sagemath-bliss/setup.py` for instance) are right?\n> \n> ```sage\n> if len(sys.argv) > 1 and (sys.argv[1] == \"sdist\" or sys.argv[1] == \"egg_info\"):\n>     sdist = True\n> [...] \n> When running\n> {{{\n>     python3 -u setup.py --no-user-cfg sdist --dist-dir \"$SAGE_DISTFILES\"\n> }}}\n> the \"if condition\" actually fails \n\n\nNice catch, indeed this test will go wrong when there are global options.\nWe have this in many of our `setup.py` scripts. It's only an optimization - avoiding to cythonize when it is unnecessary.",
    "created_at": "2022-12-08T04:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517042",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:31'></a>Replying to [comment:29 Kwankyu Lee]:
> and these lines (of `pkgs/sagemath-bliss/setup.py` for instance) are right?
> 
> ```sage
> if len(sys.argv) > 1 and (sys.argv[1] == "sdist" or sys.argv[1] == "egg_info"):
>     sdist = True
> [...] 
> When running
> {{{
>     python3 -u setup.py --no-user-cfg sdist --dist-dir "$SAGE_DISTFILES"
> }}}
> the "if condition" actually fails 


Nice catch, indeed this test will go wrong when there are global options.
We have this in many of our `setup.py` scripts. It's only an optimization - avoiding to cythonize when it is unnecessary.



---

archive/issue_comments_517043.json:
```json
{
    "body": "<a id='comment:32'></a>I'm getting rid of this test where it was copied from in #34858.",
    "created_at": "2022-12-18T23:56:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517043",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>I'm getting rid of this test where it was copied from in #34858.



---

archive/issue_comments_517044.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-12-19T05:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517044",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_517045.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-12-19T05:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34346#issuecomment-517045",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:
