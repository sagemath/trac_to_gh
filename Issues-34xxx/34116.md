# Issue 34116: add exact division of power series by coefficient

archive/issues_033879.json:
```json
{
    "body": "as this is very useful for computations in combinatorics\n\nCC:  @tscrim @slel @kliem @kwankyu\n\nBranch/Commit: 3525f0676f688f5dbc8b505d389f1c9bb0a68c4a\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton, Jonathan Kliem\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton, Jonathan Kliem, Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34116\n\n",
    "closed_at": "2022-08-29T11:24:05Z",
    "created_at": "2022-07-05T14:52:55Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "add exact division of power series by coefficient",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34116",
    "user": "https://github.com/fchapoton"
}
```
as this is very useful for computations in combinatorics

CC:  @tscrim @slel @kliem @kwankyu

Branch/Commit: 3525f0676f688f5dbc8b505d389f1c9bb0a68c4a

Reviewer: Frédéric Chapoton, Jonathan Kliem

Author: Frédéric Chapoton, Jonathan Kliem, Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34116





---

archive/issue_comments_679466.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-05T14:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679466",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_679467.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/34116\"",
    "created_at": "2022-07-05T14:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679467",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/34116"



---

archive/issue_comments_679468.json:
```json
{
    "body": "Changing commit from \"\" to \"f8df80820dc7321dc9b18c9644c3b8315999670b\"",
    "created_at": "2022-07-05T14:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679468",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "f8df80820dc7321dc9b18c9644c3b8315999670b"



---

archive/issue_comments_679469.json:
```json
{
    "body": "Changing commit from \"f8df80820dc7321dc9b18c9644c3b8315999670b\" to \"eeb50aecc59f861d17f6e83d852b297876d9d420\"",
    "created_at": "2022-07-05T14:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f8df80820dc7321dc9b18c9644c3b8315999670b" to "eeb50aecc59f861d17f6e83d852b297876d9d420"



---

archive/issue_comments_679470.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-05T14:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679470",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_679471.json:
```json
{
    "body": "<a id='comment:3'></a>bot is morally green, so please review",
    "created_at": "2022-07-06T08:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679471",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>bot is morally green, so please review



---

archive/issue_comments_679472.json:
```json
{
    "body": "<a id='comment:5'></a>Sorry for losing track of this. I think we should error out if the RHS has degree > 0 rather than silently returning a wrong answer. The current behavior is to error out:\n\n```\nsage: R.<x> = PowerSeriesRing(QQ)\nsage: 1 + x // (1 + 2*x)\n[snip]\nTypeError: unsupported operand parent(s) for //: 'Power Series Ring in x over Rational Field' and 'Power Series Ring in x over Rational Field'\n```\n\nA \"better\" way to do this IMO would be to implement this as an action of the base ring. This is faster as it would bypass the temporary object created by the coercion and it would continue to not work for any FPS.",
    "created_at": "2022-08-02T03:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679472",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>Sorry for losing track of this. I think we should error out if the RHS has degree > 0 rather than silently returning a wrong answer. The current behavior is to error out:

```
sage: R.<x> = PowerSeriesRing(QQ)
sage: 1 + x // (1 + 2*x)
[snip]
TypeError: unsupported operand parent(s) for //: 'Power Series Ring in x over Rational Field' and 'Power Series Ring in x over Rational Field'
```

A "better" way to do this IMO would be to implement this as an action of the base ring. This is faster as it would bypass the temporary object created by the coercion and it would continue to not work for any FPS.



---

archive/issue_comments_679473.json:
```json
{
    "body": "<a id='comment:6'></a>Thanks for the feedback.\n\nAs my rough proposal goes through coercion, raising an error would require to check if the coerced element comes from the base ring, which seems very ugly..\n\nI would be happy to see any better solution. I have zero experience about actions, so it will not be easy for me to implement what you suggest. Also, does it make sense to implement a \"division\" as an action?",
    "created_at": "2022-08-08T07:20:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679473",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>Thanks for the feedback.

As my rough proposal goes through coercion, raising an error would require to check if the coerced element comes from the base ring, which seems very ugly..

I would be happy to see any better solution. I have zero experience about actions, so it will not be easy for me to implement what you suggest. Also, does it make sense to implement a "division" as an action?



---

archive/issue_comments_679474.json:
```json
{
    "body": "<a id='comment:7'></a>I do plan on getting to this, I haven't quite had the time to do it. I should be able to do it in the next few days.",
    "created_at": "2022-08-11T06:03:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679474",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>I do plan on getting to this, I haven't quite had the time to do it. I should be able to do it in the next few days.



---

archive/issue_comments_679475.json:
```json
{
    "body": "<a id='comment:8'></a>Sorry, for some reason my key is not working (and I cannot push). Here is a proposal how to modify the branch and use coercion:\n\n```diff\ndiff --git a/src/sage/rings/power_series_poly.pyx b/src/sage/rings/power_series_poly.pyx\nindex dc0c599a2c..42c4a5602c 100644\n--- a/src/sage/rings/power_series_poly.pyx\n+++ b/src/sage/rings/power_series_poly.pyx\n@@ -720,7 +720,7 @@ cdef class PowerSeries_poly(PowerSeries):\n \n         return self._parent(self.truncate().inverse_series_trunc(prec), prec=prec)\n \n-    def _floordiv_(self, c):\n+    def _floor_division_by_coefficient_(self, c):\n         \"\"\"\n         Perform the exact division of ``self`` by a coefficient ``c``.\n \n@@ -748,10 +748,14 @@ cdef class PowerSeries_poly(PowerSeries):\n         \"\"\"\n         prec = self.prec()\n         return PowerSeries_poly(self._parent,\n-                                self.__f // (<PowerSeries_poly>c).__f[0],\n+                                self.__f // c,\n                                 prec=prec,\n                                 check=False)\n \n+    cpdef _acted_upon_(self, other, bint self_on_left):\n+        if self_on_left and other in self.base_ring():\n+            return self._floor_division_by_coefficient_(other)\n+\n     def truncate(self, prec=infinity):\n         \"\"\"\n         The polynomial obtained from power series by truncation at\ndiff --git a/src/sage/rings/power_series_ring.py b/src/sage/rings/power_series_ring.py\nindex 0000a2daa3..88b60ebbe0 100644\n--- a/src/sage/rings/power_series_ring.py\n+++ b/src/sage/rings/power_series_ring.py\n@@ -1288,6 +1288,12 @@ class PowerSeriesRing_domain(PowerSeriesRing_generic, ring.IntegralDomain):\n         laurent = self.laurent_series_ring()\n         return laurent.change_ring(self.base_ring().fraction_field())\n \n+    def _get_action_(self, other, op, self_is_left):\n+        import operator\n+        from sage.structure.coerce_actions import ActedUponAction\n+        if op is operator.floordiv and self_is_left and other is self.base_ring():\n+            # Floor division by coefficient.\n+            return ActedUponAction(other, self, not self_is_left)\n \n class PowerSeriesRing_over_field(PowerSeriesRing_domain):\n     _default_category = CompleteDiscreteValuationRings()\n```\n\nIn addition one can coerce the base ring as done in `src/sage/geometry/polyhedron/parent.py` in `PolyhedronParent._get_action_` with `PrecomposedAction`.",
    "created_at": "2022-08-12T20:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679475",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>Sorry, for some reason my key is not working (and I cannot push). Here is a proposal how to modify the branch and use coercion:

```diff
diff --git a/src/sage/rings/power_series_poly.pyx b/src/sage/rings/power_series_poly.pyx
index dc0c599a2c..42c4a5602c 100644
--- a/src/sage/rings/power_series_poly.pyx
+++ b/src/sage/rings/power_series_poly.pyx
@@ -720,7 +720,7 @@ cdef class PowerSeries_poly(PowerSeries):
 
         return self._parent(self.truncate().inverse_series_trunc(prec), prec=prec)
 
-    def _floordiv_(self, c):
+    def _floor_division_by_coefficient_(self, c):
         """
         Perform the exact division of ``self`` by a coefficient ``c``.
 
@@ -748,10 +748,14 @@ cdef class PowerSeries_poly(PowerSeries):
         """
         prec = self.prec()
         return PowerSeries_poly(self._parent,
-                                self.__f // (<PowerSeries_poly>c).__f[0],
+                                self.__f // c,
                                 prec=prec,
                                 check=False)
 
+    cpdef _acted_upon_(self, other, bint self_on_left):
+        if self_on_left and other in self.base_ring():
+            return self._floor_division_by_coefficient_(other)
+
     def truncate(self, prec=infinity):
         """
         The polynomial obtained from power series by truncation at
diff --git a/src/sage/rings/power_series_ring.py b/src/sage/rings/power_series_ring.py
index 0000a2daa3..88b60ebbe0 100644
--- a/src/sage/rings/power_series_ring.py
+++ b/src/sage/rings/power_series_ring.py
@@ -1288,6 +1288,12 @@ class PowerSeriesRing_domain(PowerSeriesRing_generic, ring.IntegralDomain):
         laurent = self.laurent_series_ring()
         return laurent.change_ring(self.base_ring().fraction_field())
 
+    def _get_action_(self, other, op, self_is_left):
+        import operator
+        from sage.structure.coerce_actions import ActedUponAction
+        if op is operator.floordiv and self_is_left and other is self.base_ring():
+            # Floor division by coefficient.
+            return ActedUponAction(other, self, not self_is_left)
 
 class PowerSeriesRing_over_field(PowerSeriesRing_domain):
     _default_category = CompleteDiscreteValuationRings()
```

In addition one can coerce the base ring as done in `src/sage/geometry/polyhedron/parent.py` in `PolyhedronParent._get_action_` with `PrecomposedAction`.



---

archive/issue_comments_679476.json:
```json
{
    "body": "Changing commit from \"eeb50aecc59f861d17f6e83d852b297876d9d420\" to \"\"",
    "created_at": "2022-08-12T20:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679476",
    "user": "https://github.com/kliem"
}
```

Changing commit from "eeb50aecc59f861d17f6e83d852b297876d9d420" to ""



---

archive/issue_comments_679477.json:
```json
{
    "body": "Changing branch from \"u/chapoton/34116\" to \"u/gh-kliem/34116\"",
    "created_at": "2022-08-12T20:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679477",
    "user": "https://github.com/kliem"
}
```

Changing branch from "u/chapoton/34116" to "u/gh-kliem/34116"



---

archive/issue_comments_679478.json:
```json
{
    "body": "<a id='comment:9'></a>Using a different machine has worked. Still don't know, why pushing to trac doesn't work, but github is fine.",
    "created_at": "2022-08-12T20:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679478",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>Using a different machine has worked. Still don't know, why pushing to trac doesn't work, but github is fine.



---

archive/issue_comments_679479.json:
```json
{
    "body": "Changing commit from \"\" to \"64bb118c2fc3acac522ffec05680dbaabb4793ed\"",
    "created_at": "2022-08-12T20:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679479",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "64bb118c2fc3acac522ffec05680dbaabb4793ed"



---

archive/issue_comments_679480.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-12T20:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679480",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_679481.json:
```json
{
    "body": "<a id='comment:11'></a>Our trac machine is stuck on a version of ubuntu that does not recognize the recent versions of RSA as imposed on ubuntu 22.04..",
    "created_at": "2022-08-13T07:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679481",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>Our trac machine is stuck on a version of ubuntu that does not recognize the recent versions of RSA as imposed on ubuntu 22.04..



---

archive/issue_comments_679482.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [chapoton](#comment%3A11):\n> Our trac machine is stuck on a version of ubuntu that does not recognize the recent versions of RSA as imposed on ubuntu 22.04..\n\n\nThanks for letting me know. So at least everything is fine on my machine.\n\nWhat I don't like about this current approach is that only one action may exist. As long as their is only floor division, everything is fine, but if one wants to implement a different action with a different operator, one is stuck. (There are work arounds by first converting the base ring element to some artificial `FloorDivision` class, but that doesn't seem better).",
    "created_at": "2022-08-15T06:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679482",
    "user": "https://github.com/kliem"
}
```

<a id='comment:12'></a>Replying to [chapoton](#comment%3A11):
> Our trac machine is stuck on a version of ubuntu that does not recognize the recent versions of RSA as imposed on ubuntu 22.04..


Thanks for letting me know. So at least everything is fine on my machine.

What I don't like about this current approach is that only one action may exist. As long as their is only floor division, everything is fine, but if one wants to implement a different action with a different operator, one is stuck. (There are work arounds by first converting the base ring element to some artificial `FloorDivision` class, but that doesn't seem better).



---

archive/issue_comments_679483.json:
```json
{
    "body": "Changing author from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton, Jonathan Kliem, Travis Scrimshaw\"",
    "created_at": "2022-08-22T00:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679483",
    "user": "https://github.com/tscrim"
}
```

Changing author from "Frédéric Chapoton" to "Frédéric Chapoton, Jonathan Kliem, Travis Scrimshaw"



---

archive/issue_comments_679484.json:
```json
{
    "body": "<a id='comment:13'></a>Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.\n\n`@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.\n\n---\nNew commits:",
    "created_at": "2022-08-22T00:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679484",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.

`@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.

---
New commits:



---

archive/issue_comments_679485.json:
```json
{
    "body": "Changing branch from \"u/gh-kliem/34116\" to \"public/rings/floor_division_power_series-34116\"",
    "created_at": "2022-08-22T00:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679485",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "u/gh-kliem/34116" to "public/rings/floor_division_power_series-34116"



---

archive/issue_comments_679486.json:
```json
{
    "body": "Changing commit from \"64bb118c2fc3acac522ffec05680dbaabb4793ed\" to \"c8a57e081e4c7634af795f2248ef5efbdebcd306\"",
    "created_at": "2022-08-22T00:29:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679486",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "64bb118c2fc3acac522ffec05680dbaabb4793ed" to "c8a57e081e4c7634af795f2248ef5efbdebcd306"



---

archive/issue_comments_679487.json:
```json
{
    "body": "<a id='comment:14'></a>Thanks ! Looks great to me. If everybody agree, please set to positive.",
    "created_at": "2022-08-22T09:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679487",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>Thanks ! Looks great to me. If everybody agree, please set to positive.



---

archive/issue_comments_679488.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2022-08-22T09:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679488",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Frédéric Chapoton"



---

archive/issue_comments_679489.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [tscrim](#comment%3A13):\n> Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.\n> \n> `@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.\n\nYou have already solved the problem by the explicit action class. I wasn't aware that this exists.\n\nThe problem with `_acted_upon_` is that in only allows one action from `A` on `B`. E.g. we would have fixed that `ZZ` acts on `ZZ[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)` always be floor division (and not by any other operation). With the explicit action class one can later define a different action (I can't come up with something atm, but I hope my thoughts come across).\n> \n> ---\n> New commits:\n> |                                                                                                                                          |                               |\n> |------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n> |[d5b890b](https://git.sagemath.org/sage.git/commit?id=d5b890b947af0a6042c1ea4b9e10ee2ddc65b8e6)|`Implementing a direct action.`|\n> |[c8a57e0](https://git.sagemath.org/sage.git/commit?id=c8a57e081e4c7634af795f2248ef5efbdebcd306)|`Allowing actions from things that coercion into the base ring as well.`|",
    "created_at": "2022-08-23T10:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679489",
    "user": "https://github.com/kliem"
}
```

<a id='comment:15'></a>Replying to [tscrim](#comment%3A13):
> Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.
> 
> `@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.

You have already solved the problem by the explicit action class. I wasn't aware that this exists.

The problem with `_acted_upon_` is that in only allows one action from `A` on `B`. E.g. we would have fixed that `ZZ` acts on `ZZ[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)` always be floor division (and not by any other operation). With the explicit action class one can later define a different action (I can't come up with something atm, but I hope my thoughts come across).
> 
> ---
> New commits:
> |                                                                                                                                          |                               |
> |------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
> |[d5b890b](https://git.sagemath.org/sage.git/commit?id=d5b890b947af0a6042c1ea4b9e10ee2ddc65b8e6)|`Implementing a direct action.`|
> |[c8a57e0](https://git.sagemath.org/sage.git/commit?id=c8a57e081e4c7634af795f2248ef5efbdebcd306)|`Allowing actions from things that coercion into the base ring as well.`|



---

archive/issue_comments_679490.json:
```json
{
    "body": "Changing reviewer from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton, Jonathan Kliem\"",
    "created_at": "2022-08-23T10:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679490",
    "user": "https://github.com/kliem"
}
```

Changing reviewer from "Frédéric Chapoton" to "Frédéric Chapoton, Jonathan Kliem"



---

archive/issue_comments_679491.json:
```json
{
    "body": "<a id='comment:16'></a>As we are implementing floor division and not exact division, it would be good to have one example, where this is actually different from exact division.\n\nOtherwise lgtm.",
    "created_at": "2022-08-23T10:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679491",
    "user": "https://github.com/kliem"
}
```

<a id='comment:16'></a>As we are implementing floor division and not exact division, it would be good to have one example, where this is actually different from exact division.

Otherwise lgtm.



---

archive/issue_comments_679492.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [gh-kliem](#comment%3A16):\n> As we are implementing floor division and not exact division, it would be good to have one example, where this is actually different from exact division.\n\n\n`@`chapoton `@`gh-kliem Can one of you add the example? I am just out the door for today (I need dinner). Otherwise I will do it tomorrow morning when I get back into my office.",
    "created_at": "2022-08-23T10:27:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679492",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>Replying to [gh-kliem](#comment%3A16):
> As we are implementing floor division and not exact division, it would be good to have one example, where this is actually different from exact division.


`@`chapoton `@`gh-kliem Can one of you add the example? I am just out the door for today (I need dinner). Otherwise I will do it tomorrow morning when I get back into my office.



---

archive/issue_comments_679493.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [gh-kliem](#comment%3A15):\n> Replying to [tscrim](#comment%3A13):\n> > Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.\n> > \n> > `@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.\n\n> You have already solved the problem by the explicit action class. I wasn't aware that this exists.\n> \n> The problem with `_acted_upon_` is that in only allows one action from `A` on `B`. E.g. we would have fixed that `ZZ` acts on `ZZ[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)` always be floor division (and not by any other operation). With the explicit action class one can later define a different action (I can't come up with something atm, but I hope my thoughts come across).\n\n\nAh, I see. Thanks for explaining. Typically though, `_acted_upon_` is used for the `*` action as a replacement for the `_lmul_` and `_rmul_` in more legacy code.",
    "created_at": "2022-08-23T10:29:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679493",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>Replying to [gh-kliem](#comment%3A15):
> Replying to [tscrim](#comment%3A13):
> > Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.
> > 
> > `@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.

> You have already solved the problem by the explicit action class. I wasn't aware that this exists.
> 
> The problem with `_acted_upon_` is that in only allows one action from `A` on `B`. E.g. we would have fixed that `ZZ` acts on `ZZ[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)` always be floor division (and not by any other operation). With the explicit action class one can later define a different action (I can't come up with something atm, but I hope my thoughts come across).


Ah, I see. Thanks for explaining. Typically though, `_acted_upon_` is used for the `*` action as a replacement for the `_lmul_` and `_rmul_` in more legacy code.



---

archive/issue_comments_679494.json:
```json
{
    "body": "Changing commit from \"c8a57e081e4c7634af795f2248ef5efbdebcd306\" to \"209d54f117605e63fcefb841ae9bd8b76e7d027b\"",
    "created_at": "2022-08-23T14:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679494",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c8a57e081e4c7634af795f2248ef5efbdebcd306" to "209d54f117605e63fcefb841ae9bd8b76e7d027b"



---

archive/issue_comments_679495.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-23T14:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679495",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_679496.json:
```json
{
    "body": "<a id='comment:20'></a>I have added an illustrating example.",
    "created_at": "2022-08-23T14:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679496",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'></a>I have added an illustrating example.



---

archive/issue_comments_679497.json:
```json
{
    "body": "<a id='comment:21'></a>Thank you. Jonathan, is that sufficient for you?",
    "created_at": "2022-08-24T01:47:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679497",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>Thank you. Jonathan, is that sufficient for you?



---

archive/issue_comments_679498.json:
```json
{
    "body": "<a id='comment:22'></a>Bot is (morally) green.",
    "created_at": "2022-08-24T01:48:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679498",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>Bot is (morally) green.



---

archive/issue_comments_679499.json:
```json
{
    "body": "Changing commit from \"209d54f117605e63fcefb841ae9bd8b76e7d027b\" to \"3525f0676f688f5dbc8b505d389f1c9bb0a68c4a\"",
    "created_at": "2022-08-24T05:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679499",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "209d54f117605e63fcefb841ae9bd8b76e7d027b" to "3525f0676f688f5dbc8b505d389f1c9bb0a68c4a"



---

archive/issue_comments_679500.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-24T05:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679500",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_679501.json:
```json
{
    "body": "<a id='comment:24'></a>This is what I was referring to. If you think this is good, you can set it to positive review or modify it.",
    "created_at": "2022-08-24T05:34:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679501",
    "user": "https://github.com/kliem"
}
```

<a id='comment:24'></a>This is what I was referring to. If you think this is good, you can set it to positive review or modify it.



---

archive/issue_comments_679502.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-24T06:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679502",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_679503.json:
```json
{
    "body": "<a id='comment:25'></a>LGTM. Thanks.",
    "created_at": "2022-08-24T06:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679503",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>LGTM. Thanks.



---

archive/issue_comments_679504.json:
```json
{
    "body": "Changing branch from \"public/rings/floor_division_power_series-34116\" to \"3525f0676f688f5dbc8b505d389f1c9bb0a68c4a\"",
    "created_at": "2022-08-29T11:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679504",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/rings/floor_division_power_series-34116" to "3525f0676f688f5dbc8b505d389f1c9bb0a68c4a"



---

archive/issue_comments_679505.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-29T11:24:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34116#issuecomment-679505",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_089136.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-29T11:24:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34116",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34116#event-89136"
}
```
