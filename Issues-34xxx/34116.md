# Issue 34116: add exact division of power series by coefficient

archive/issues_033879.json:
```json
{
    "body": "as this is very useful for computations in combinatorics\n\n**CC:**  @tscrim @slel @kliem @kwankyu\n\n**Branch/Commit:** [3525f0676f688f5dbc8b505d389f1c9bb0a68c4a](https://github.com/sagemath/sagetrac-mirror/commit/3525f0676f688f5dbc8b505d389f1c9bb0a68c4a)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton, Jonathan Kliem\n\n**Author:** Fr\u00e9d\u00e9ric Chapoton, Jonathan Kliem, Travis Scrimshaw\n\nIssue created by migration from https://trac.sagemath.org/ticket/34116\n\n",
    "closed_at": "2022-08-29T11:24:05Z",
    "created_at": "2022-07-05T14:52:55Z",
    "labels": [
        "component: combinatorics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "title": "add exact division of power series by coefficient",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/34116",
    "user": "https://github.com/fchapoton"
}
```
as this is very useful for computations in combinatorics

**CC:**  @tscrim @slel @kliem @kwankyu

**Branch/Commit:** [3525f0676f688f5dbc8b505d389f1c9bb0a68c4a](https://github.com/sagemath/sagetrac-mirror/commit/3525f0676f688f5dbc8b505d389f1c9bb0a68c4a)

**Reviewer:** Frédéric Chapoton, Jonathan Kliem

**Author:** Frédéric Chapoton, Jonathan Kliem, Travis Scrimshaw

Issue created by migration from https://trac.sagemath.org/ticket/34116





---

archive/issue_events_304023.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-07-05T14:53:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34116#event-304023"
}
```



---

archive/issue_comments_553393.json:
```json
{
    "body": "**Branch:** [u/chapoton/34116](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/34116)",
    "created_at": "2022-07-05T14:53:22Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553393",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [u/chapoton/34116](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/34116)



---

archive/issue_comments_553394.json:
```json
{
    "body": "**Commit:** [f8df80820dc7321dc9b18c9644c3b8315999670b](https://github.com/sagemath/sagetrac-mirror/commit/f8df80820dc7321dc9b18c9644c3b8315999670b)",
    "created_at": "2022-07-05T14:53:22Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553394",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [f8df80820dc7321dc9b18c9644c3b8315999670b](https://github.com/sagemath/sagetrac-mirror/commit/f8df80820dc7321dc9b18c9644c3b8315999670b)



---

archive/issue_comments_553395.json:
```json
{
    "body": "**Changing commit** from \"[f8df80820dc7321dc9b18c9644c3b8315999670b](https://github.com/sagemath/sagetrac-mirror/commit/f8df80820dc7321dc9b18c9644c3b8315999670b)\" to \"[eeb50aecc59f861d17f6e83d852b297876d9d420](https://github.com/sagemath/sagetrac-mirror/commit/eeb50aecc59f861d17f6e83d852b297876d9d420)\".",
    "created_at": "2022-07-05T14:54:20Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553395",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f8df80820dc7321dc9b18c9644c3b8315999670b](https://github.com/sagemath/sagetrac-mirror/commit/f8df80820dc7321dc9b18c9644c3b8315999670b)" to "[eeb50aecc59f861d17f6e83d852b297876d9d420](https://github.com/sagemath/sagetrac-mirror/commit/eeb50aecc59f861d17f6e83d852b297876d9d420)".



---

archive/issue_comments_553396.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eeb50aecc59f861d17f6e83d852b297876d9d420\">eeb50ae</a></td><td><code>add floordiv for power series for exact division by one coefficient</code></td></tr></table>\n",
    "created_at": "2022-07-05T14:54:20Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553396",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eeb50aecc59f861d17f6e83d852b297876d9d420">eeb50ae</a></td><td><code>add floordiv for power series for exact division by one coefficient</code></td></tr></table>




---

archive/issue_comments_553397.json:
```json
{
    "body": "<a id='comment:3'></a>\nbot is morally green, so please review",
    "created_at": "2022-07-06T08:39:51Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553397",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
bot is morally green, so please review



---

archive/issue_comments_553398.json:
```json
{
    "body": "<a id='comment:5'></a>\nSorry for losing track of this. I think we should error out if the RHS has degree > 0 rather than silently returning a wrong answer. The current behavior is to error out:\n\n```\nsage: R.<x> = PowerSeriesRing(QQ)\nsage: 1 + x // (1 + 2*x)\n[snip]\nTypeError: unsupported operand parent(s) for //: 'Power Series Ring in x over Rational Field' and 'Power Series Ring in x over Rational Field'\n```\n\nA \"better\" way to do this IMO would be to implement this as an action of the base ring. This is faster as it would bypass the temporary object created by the coercion and it would continue to not work for any FPS.",
    "created_at": "2022-08-02T03:23:30Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553398",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
Sorry for losing track of this. I think we should error out if the RHS has degree > 0 rather than silently returning a wrong answer. The current behavior is to error out:

```
sage: R.<x> = PowerSeriesRing(QQ)
sage: 1 + x // (1 + 2*x)
[snip]
TypeError: unsupported operand parent(s) for //: 'Power Series Ring in x over Rational Field' and 'Power Series Ring in x over Rational Field'
```

A "better" way to do this IMO would be to implement this as an action of the base ring. This is faster as it would bypass the temporary object created by the coercion and it would continue to not work for any FPS.



---

archive/issue_comments_553399.json:
```json
{
    "body": "<a id='comment:6'></a>\nThanks for the feedback.\n\nAs my rough proposal goes through coercion, raising an error would require to check if the coerced element comes from the base ring, which seems very ugly..\n\nI would be happy to see any better solution. I have zero experience about actions, so it will not be easy for me to implement what you suggest. Also, does it make sense to implement a \"division\" as an action?",
    "created_at": "2022-08-08T07:20:49Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553399",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:6'></a>
Thanks for the feedback.

As my rough proposal goes through coercion, raising an error would require to check if the coerced element comes from the base ring, which seems very ugly..

I would be happy to see any better solution. I have zero experience about actions, so it will not be easy for me to implement what you suggest. Also, does it make sense to implement a "division" as an action?



---

archive/issue_comments_553400.json:
```json
{
    "body": "<a id='comment:7'></a>\nI do plan on getting to this, I haven't quite had the time to do it. I should be able to do it in the next few days.",
    "created_at": "2022-08-11T06:03:34Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553400",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
I do plan on getting to this, I haven't quite had the time to do it. I should be able to do it in the next few days.



---

archive/issue_comments_553401.json:
```json
{
    "body": "<a id='comment:8'></a>\nSorry, for some reason my key is not working (and I cannot push). Here is a proposal how to modify the branch and use coercion:\n\n```diff\ndiff --git a/src/sage/rings/power_series_poly.pyx b/src/sage/rings/power_series_poly.pyx\nindex dc0c599a2c..42c4a5602c 100644\n--- a/src/sage/rings/power_series_poly.pyx\n+++ b/src/sage/rings/power_series_poly.pyx\n@@ -720,7 +720,7 @@ cdef class PowerSeries_poly(PowerSeries):\n \n         return self._parent(self.truncate().inverse_series_trunc(prec), prec=prec)\n \n-    def _floordiv_(self, c):\n+    def _floor_division_by_coefficient_(self, c):\n         \"\"\"\n         Perform the exact division of ``self`` by a coefficient ``c``.\n \n@@ -748,10 +748,14 @@ cdef class PowerSeries_poly(PowerSeries):\n         \"\"\"\n         prec = self.prec()\n         return PowerSeries_poly(self._parent,\n-                                self.__f // (<PowerSeries_poly>c).__f[0],\n+                                self.__f // c,\n                                 prec=prec,\n                                 check=False)\n \n+    cpdef _acted_upon_(self, other, bint self_on_left):\n+        if self_on_left and other in self.base_ring():\n+            return self._floor_division_by_coefficient_(other)\n+\n     def truncate(self, prec=infinity):\n         \"\"\"\n         The polynomial obtained from power series by truncation at\ndiff --git a/src/sage/rings/power_series_ring.py b/src/sage/rings/power_series_ring.py\nindex 0000a2daa3..88b60ebbe0 100644\n--- a/src/sage/rings/power_series_ring.py\n+++ b/src/sage/rings/power_series_ring.py\n@@ -1288,6 +1288,12 @@ class PowerSeriesRing_domain(PowerSeriesRing_generic, ring.IntegralDomain):\n         laurent = self.laurent_series_ring()\n         return laurent.change_ring(self.base_ring().fraction_field())\n \n+    def _get_action_(self, other, op, self_is_left):\n+        import operator\n+        from sage.structure.coerce_actions import ActedUponAction\n+        if op is operator.floordiv and self_is_left and other is self.base_ring():\n+            # Floor division by coefficient.\n+            return ActedUponAction(other, self, not self_is_left)\n \n class PowerSeriesRing_over_field(PowerSeriesRing_domain):\n     _default_category = CompleteDiscreteValuationRings()\n```\n\nIn addition one can coerce the base ring as done in `src/sage/geometry/polyhedron/parent.py` in `PolyhedronParent._get_action_` with `PrecomposedAction`.",
    "created_at": "2022-08-12T20:27:13Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553401",
    "user": "https://github.com/kliem"
}
```

<a id='comment:8'></a>
Sorry, for some reason my key is not working (and I cannot push). Here is a proposal how to modify the branch and use coercion:

```diff
diff --git a/src/sage/rings/power_series_poly.pyx b/src/sage/rings/power_series_poly.pyx
index dc0c599a2c..42c4a5602c 100644
--- a/src/sage/rings/power_series_poly.pyx
+++ b/src/sage/rings/power_series_poly.pyx
@@ -720,7 +720,7 @@ cdef class PowerSeries_poly(PowerSeries):
 
         return self._parent(self.truncate().inverse_series_trunc(prec), prec=prec)
 
-    def _floordiv_(self, c):
+    def _floor_division_by_coefficient_(self, c):
         """
         Perform the exact division of ``self`` by a coefficient ``c``.
 
@@ -748,10 +748,14 @@ cdef class PowerSeries_poly(PowerSeries):
         """
         prec = self.prec()
         return PowerSeries_poly(self._parent,
-                                self.__f // (<PowerSeries_poly>c).__f[0],
+                                self.__f // c,
                                 prec=prec,
                                 check=False)
 
+    cpdef _acted_upon_(self, other, bint self_on_left):
+        if self_on_left and other in self.base_ring():
+            return self._floor_division_by_coefficient_(other)
+
     def truncate(self, prec=infinity):
         """
         The polynomial obtained from power series by truncation at
diff --git a/src/sage/rings/power_series_ring.py b/src/sage/rings/power_series_ring.py
index 0000a2daa3..88b60ebbe0 100644
--- a/src/sage/rings/power_series_ring.py
+++ b/src/sage/rings/power_series_ring.py
@@ -1288,6 +1288,12 @@ class PowerSeriesRing_domain(PowerSeriesRing_generic, ring.IntegralDomain):
         laurent = self.laurent_series_ring()
         return laurent.change_ring(self.base_ring().fraction_field())
 
+    def _get_action_(self, other, op, self_is_left):
+        import operator
+        from sage.structure.coerce_actions import ActedUponAction
+        if op is operator.floordiv and self_is_left and other is self.base_ring():
+            # Floor division by coefficient.
+            return ActedUponAction(other, self, not self_is_left)
 
 class PowerSeriesRing_over_field(PowerSeriesRing_domain):
     _default_category = CompleteDiscreteValuationRings()
```

In addition one can coerce the base ring as done in `src/sage/geometry/polyhedron/parent.py` in `PolyhedronParent._get_action_` with `PrecomposedAction`.



---

archive/issue_comments_553402.json:
```json
{
    "body": "**Changing commit** from \"[eeb50aecc59f861d17f6e83d852b297876d9d420](https://github.com/sagemath/sagetrac-mirror/commit/eeb50aecc59f861d17f6e83d852b297876d9d420)\" to \"\".",
    "created_at": "2022-08-12T20:35:42Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553402",
    "user": "https://github.com/kliem"
}
```

**Changing commit** from "[eeb50aecc59f861d17f6e83d852b297876d9d420](https://github.com/sagemath/sagetrac-mirror/commit/eeb50aecc59f861d17f6e83d852b297876d9d420)" to "".



---

archive/issue_comments_553403.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/34116](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/34116)\" to \"[u/gh-kliem/34116](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/34116)\".",
    "created_at": "2022-08-12T20:35:42Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553403",
    "user": "https://github.com/kliem"
}
```

**Changing branch** from "[u/chapoton/34116](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/34116)" to "[u/gh-kliem/34116](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/34116)".



---

archive/issue_comments_553404.json:
```json
{
    "body": "<a id='comment:9'></a>\nUsing a different machine has worked. Still don't know, why pushing to trac doesn't work, but github is fine.",
    "created_at": "2022-08-12T20:35:42Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553404",
    "user": "https://github.com/kliem"
}
```

<a id='comment:9'></a>
Using a different machine has worked. Still don't know, why pushing to trac doesn't work, but github is fine.



---

archive/issue_comments_553405.json:
```json
{
    "body": "**Commit:** [64bb118c2fc3acac522ffec05680dbaabb4793ed](https://github.com/sagemath/sagetrac-mirror/commit/64bb118c2fc3acac522ffec05680dbaabb4793ed)",
    "created_at": "2022-08-12T20:36:29Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [64bb118c2fc3acac522ffec05680dbaabb4793ed](https://github.com/sagemath/sagetrac-mirror/commit/64bb118c2fc3acac522ffec05680dbaabb4793ed)



---

archive/issue_comments_553406.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc976ec621e58c35db1edff375a71fdbb3b2bf37\">dc976ec</a></td><td><code>add floordiv for power series for exact division by one coefficient</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/64bb118c2fc3acac522ffec05680dbaabb4793ed\">64bb118</a></td><td><code>rough draft on how to use coercion for exact division of power series by coefficient</code></td></tr></table>\n",
    "created_at": "2022-08-12T20:36:29Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553406",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc976ec621e58c35db1edff375a71fdbb3b2bf37">dc976ec</a></td><td><code>add floordiv for power series for exact division by one coefficient</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/64bb118c2fc3acac522ffec05680dbaabb4793ed">64bb118</a></td><td><code>rough draft on how to use coercion for exact division of power series by coefficient</code></td></tr></table>




---

archive/issue_comments_553407.json:
```json
{
    "body": "<a id='comment:11'></a>\nOur trac machine is stuck on a version of ubuntu that does not recognize the recent versions of RSA as imposed on ubuntu 22.04..",
    "created_at": "2022-08-13T07:17:57Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553407",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
Our trac machine is stuck on a version of ubuntu that does not recognize the recent versions of RSA as imposed on ubuntu 22.04..



---

archive/issue_comments_553408.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [chapoton](#comment%3A11):\n> Our trac machine is stuck on a version of ubuntu that does not recognize the recent versions of RSA as imposed on ubuntu 22.04..\n\nThanks for letting me know. So at least everything is fine on my machine.\n\nWhat I don't like about this current approach is that only one action may exist. As long as their is only floor division, everything is fine, but if one wants to implement a different action with a different operator, one is stuck. (There are work arounds by first converting the base ring element to some artificial `FloorDivision` class, but that doesn't seem better).",
    "created_at": "2022-08-15T06:30:28Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553408",
    "user": "https://github.com/kliem"
}
```

<a id='comment:12'></a>
Replying to [chapoton](#comment%3A11):
> Our trac machine is stuck on a version of ubuntu that does not recognize the recent versions of RSA as imposed on ubuntu 22.04..

Thanks for letting me know. So at least everything is fine on my machine.

What I don't like about this current approach is that only one action may exist. As long as their is only floor division, everything is fine, but if one wants to implement a different action with a different operator, one is stuck. (There are work arounds by first converting the base ring element to some artificial `FloorDivision` class, but that doesn't seem better).



---

archive/issue_comments_553409.json:
```json
{
    "body": "**Changing author** from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton, Jonathan Kliem, Travis Scrimshaw\".",
    "created_at": "2022-08-22T00:29:10Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553409",
    "user": "https://github.com/tscrim"
}
```

**Changing author** from "Frédéric Chapoton" to "Frédéric Chapoton, Jonathan Kliem, Travis Scrimshaw".



---

archive/issue_comments_553410.json:
```json
{
    "body": "<a id='comment:13'></a>\nThank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.\n\n`@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5b890b947af0a6042c1ea4b9e10ee2ddc65b8e6\">d5b890b</a></td><td><code>Implementing a direct action.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8a57e081e4c7634af795f2248ef5efbdebcd306\">c8a57e0</a></td><td><code>Allowing actions from things that coercion into the base ring as well.</code></td></tr></table>\n",
    "created_at": "2022-08-22T00:29:10Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553410",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>
Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.

`@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5b890b947af0a6042c1ea4b9e10ee2ddc65b8e6">d5b890b</a></td><td><code>Implementing a direct action.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8a57e081e4c7634af795f2248ef5efbdebcd306">c8a57e0</a></td><td><code>Allowing actions from things that coercion into the base ring as well.</code></td></tr></table>




---

archive/issue_comments_553411.json:
```json
{
    "body": "**Changing branch** from \"[u/gh-kliem/34116](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/34116)\" to \"[public/rings/floor_division_power_series-34116](https://github.com/sagemath/sagetrac-mirror/tree/public/rings/floor_division_power_series-34116)\".",
    "created_at": "2022-08-22T00:29:10Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553411",
    "user": "https://github.com/tscrim"
}
```

**Changing branch** from "[u/gh-kliem/34116](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/34116)" to "[public/rings/floor_division_power_series-34116](https://github.com/sagemath/sagetrac-mirror/tree/public/rings/floor_division_power_series-34116)".



---

archive/issue_comments_553412.json:
```json
{
    "body": "**Changing commit** from \"[64bb118c2fc3acac522ffec05680dbaabb4793ed](https://github.com/sagemath/sagetrac-mirror/commit/64bb118c2fc3acac522ffec05680dbaabb4793ed)\" to \"[c8a57e081e4c7634af795f2248ef5efbdebcd306](https://github.com/sagemath/sagetrac-mirror/commit/c8a57e081e4c7634af795f2248ef5efbdebcd306)\".",
    "created_at": "2022-08-22T00:29:10Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553412",
    "user": "https://github.com/tscrim"
}
```

**Changing commit** from "[64bb118c2fc3acac522ffec05680dbaabb4793ed](https://github.com/sagemath/sagetrac-mirror/commit/64bb118c2fc3acac522ffec05680dbaabb4793ed)" to "[c8a57e081e4c7634af795f2248ef5efbdebcd306](https://github.com/sagemath/sagetrac-mirror/commit/c8a57e081e4c7634af795f2248ef5efbdebcd306)".



---

archive/issue_comments_553413.json:
```json
{
    "body": "<a id='comment:14'></a>\nThanks ! Looks great to me. If everybody agree, please set to positive.",
    "created_at": "2022-08-22T09:28:43Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553413",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>
Thanks ! Looks great to me. If everybody agree, please set to positive.



---

archive/issue_comments_553414.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2022-08-22T09:28:43Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553414",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_553415.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [tscrim](#comment%3A13):\n> Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.\n> \n> `@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.\n\nYou have already solved the problem by the explicit action class. I wasn't aware that this exists.\n\nThe problem with `_acted_upon_` is that in only allows one action from `A` on `B`. E.g. we would have fixed that `ZZ` acts on `ZZ[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)` always be floor division (and not by any other operation). With the explicit action class one can later define a different action (I can't come up with something atm, but I hope my thoughts come across).\n> \n> ---\n> **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5b890b947af0a6042c1ea4b9e10ee2ddc65b8e6\">d5b890b</a></td><td><code>Implementing a direct action.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8a57e081e4c7634af795f2248ef5efbdebcd306\">c8a57e0</a></td><td><code>Allowing actions from things that coercion into the base ring as well.</code></td></tr></table>\n",
    "created_at": "2022-08-23T10:09:21Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553415",
    "user": "https://github.com/kliem"
}
```

<a id='comment:15'></a>
Replying to [tscrim](#comment%3A13):
> Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.
> 
> `@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.

You have already solved the problem by the explicit action class. I wasn't aware that this exists.

The problem with `_acted_upon_` is that in only allows one action from `A` on `B`. E.g. we would have fixed that `ZZ` acts on `ZZ[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)` always be floor division (and not by any other operation). With the explicit action class one can later define a different action (I can't come up with something atm, but I hope my thoughts come across).
> 
> ---
> **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5b890b947af0a6042c1ea4b9e10ee2ddc65b8e6">d5b890b</a></td><td><code>Implementing a direct action.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8a57e081e4c7634af795f2248ef5efbdebcd306">c8a57e0</a></td><td><code>Allowing actions from things that coercion into the base ring as well.</code></td></tr></table>




---

archive/issue_comments_553416.json:
```json
{
    "body": "**Changing reviewer** from \"Fr\u00e9d\u00e9ric Chapoton\" to \"Fr\u00e9d\u00e9ric Chapoton, Jonathan Kliem\".",
    "created_at": "2022-08-23T10:25:08Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553416",
    "user": "https://github.com/kliem"
}
```

**Changing reviewer** from "Frédéric Chapoton" to "Frédéric Chapoton, Jonathan Kliem".



---

archive/issue_comments_553417.json:
```json
{
    "body": "<a id='comment:16'></a>\nAs we are implementing floor division and not exact division, it would be good to have one example, where this is actually different from exact division.\n\nOtherwise lgtm.",
    "created_at": "2022-08-23T10:25:08Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553417",
    "user": "https://github.com/kliem"
}
```

<a id='comment:16'></a>
As we are implementing floor division and not exact division, it would be good to have one example, where this is actually different from exact division.

Otherwise lgtm.



---

archive/issue_comments_553418.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [gh-kliem](#comment%3A16):\n> As we are implementing floor division and not exact division, it would be good to have one example, where this is actually different from exact division.\n\n@fchapoton `@`gh-kliem Can one of you add the example? I am just out the door for today (I need dinner). Otherwise I will do it tomorrow morning when I get back into my office.",
    "created_at": "2022-08-23T10:27:57Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553418",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
Replying to [gh-kliem](#comment%3A16):
> As we are implementing floor division and not exact division, it would be good to have one example, where this is actually different from exact division.

@fchapoton `@`gh-kliem Can one of you add the example? I am just out the door for today (I need dinner). Otherwise I will do it tomorrow morning when I get back into my office.



---

archive/issue_comments_553419.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [gh-kliem](#comment%3A15):\n> Replying to [tscrim](#comment%3A13):\n> > Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.\n> > \n> > `@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.\n\n> You have already solved the problem by the explicit action class. I wasn't aware that this exists.\n> \n> The problem with `_acted_upon_` is that in only allows one action from `A` on `B`. E.g. we would have fixed that `ZZ` acts on `ZZ[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)` always be floor division (and not by any other operation). With the explicit action class one can later define a different action (I can't come up with something atm, but I hope my thoughts come across).\n\nAh, I see. Thanks for explaining. Typically though, `_acted_upon_` is used for the `*` action as a replacement for the `_lmul_` and `_rmul_` in more legacy code.",
    "created_at": "2022-08-23T10:29:34Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553419",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>
Replying to [gh-kliem](#comment%3A15):
> Replying to [tscrim](#comment%3A13):
> > Thank you for doing this. This is roughly what I was thinking, but I have changed it into an explicit action class. I also fixed a bug where it was not allowing for things that also coerce into the base ring.
> > 
> > `@`gh-kliem I am not quite sure what you are worried about, but it sounds like you want things to magically work without having to implement them. What I mean is if you have a different ring with a different action, it will need to be implemented by someone. I think we can easily revisit this.

> You have already solved the problem by the explicit action class. I wasn't aware that this exists.
> 
> The problem with `_acted_upon_` is that in only allows one action from `A` on `B`. E.g. we would have fixed that `ZZ` acts on `ZZ[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)` always be floor division (and not by any other operation). With the explicit action class one can later define a different action (I can't come up with something atm, but I hope my thoughts come across).

Ah, I see. Thanks for explaining. Typically though, `_acted_upon_` is used for the `*` action as a replacement for the `_lmul_` and `_rmul_` in more legacy code.



---

archive/issue_comments_553420.json:
```json
{
    "body": "**Changing commit** from \"[c8a57e081e4c7634af795f2248ef5efbdebcd306](https://github.com/sagemath/sagetrac-mirror/commit/c8a57e081e4c7634af795f2248ef5efbdebcd306)\" to \"[209d54f117605e63fcefb841ae9bd8b76e7d027b](https://github.com/sagemath/sagetrac-mirror/commit/209d54f117605e63fcefb841ae9bd8b76e7d027b)\".",
    "created_at": "2022-08-23T14:07:38Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553420",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c8a57e081e4c7634af795f2248ef5efbdebcd306](https://github.com/sagemath/sagetrac-mirror/commit/c8a57e081e4c7634af795f2248ef5efbdebcd306)" to "[209d54f117605e63fcefb841ae9bd8b76e7d027b](https://github.com/sagemath/sagetrac-mirror/commit/209d54f117605e63fcefb841ae9bd8b76e7d027b)".



---

archive/issue_comments_553421.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/209d54f117605e63fcefb841ae9bd8b76e7d027b\">209d54f</a></td><td><code>adding one example in power series</code></td></tr></table>\n",
    "created_at": "2022-08-23T14:07:38Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553421",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/209d54f117605e63fcefb841ae9bd8b76e7d027b">209d54f</a></td><td><code>adding one example in power series</code></td></tr></table>




---

archive/issue_comments_553422.json:
```json
{
    "body": "<a id='comment:20'></a>\nI have added an illustrating example.",
    "created_at": "2022-08-23T14:08:14Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553422",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:20'></a>
I have added an illustrating example.



---

archive/issue_comments_553423.json:
```json
{
    "body": "<a id='comment:21'></a>\nThank you. Jonathan, is that sufficient for you?",
    "created_at": "2022-08-24T01:47:33Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553423",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>
Thank you. Jonathan, is that sufficient for you?



---

archive/issue_comments_553424.json:
```json
{
    "body": "<a id='comment:22'></a>\nBot is (morally) green.",
    "created_at": "2022-08-24T01:48:05Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553424",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>
Bot is (morally) green.



---

archive/issue_comments_553425.json:
```json
{
    "body": "**Changing commit** from \"[209d54f117605e63fcefb841ae9bd8b76e7d027b](https://github.com/sagemath/sagetrac-mirror/commit/209d54f117605e63fcefb841ae9bd8b76e7d027b)\" to \"[3525f0676f688f5dbc8b505d389f1c9bb0a68c4a](https://github.com/sagemath/sagetrac-mirror/commit/3525f0676f688f5dbc8b505d389f1c9bb0a68c4a)\".",
    "created_at": "2022-08-24T05:34:05Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553425",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[209d54f117605e63fcefb841ae9bd8b76e7d027b](https://github.com/sagemath/sagetrac-mirror/commit/209d54f117605e63fcefb841ae9bd8b76e7d027b)" to "[3525f0676f688f5dbc8b505d389f1c9bb0a68c4a](https://github.com/sagemath/sagetrac-mirror/commit/3525f0676f688f5dbc8b505d389f1c9bb0a68c4a)".



---

archive/issue_comments_553426.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3525f0676f688f5dbc8b505d389f1c9bb0a68c4a\">3525f06</a></td><td><code>add another test</code></td></tr></table>\n",
    "created_at": "2022-08-24T05:34:05Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553426",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3525f0676f688f5dbc8b505d389f1c9bb0a68c4a">3525f06</a></td><td><code>add another test</code></td></tr></table>




---

archive/issue_comments_553427.json:
```json
{
    "body": "<a id='comment:24'></a>\nThis is what I was referring to. If you think this is good, you can set it to positive review or modify it.",
    "created_at": "2022-08-24T05:34:59Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553427",
    "user": "https://github.com/kliem"
}
```

<a id='comment:24'></a>
This is what I was referring to. If you think this is good, you can set it to positive review or modify it.



---

archive/issue_events_304024.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-08-24T06:08:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34116#event-304024"
}
```



---

archive/issue_events_304025.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-08-24T06:08:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34116#event-304025"
}
```



---

archive/issue_comments_553428.json:
```json
{
    "body": "<a id='comment:25'></a>\nLGTM. Thanks.",
    "created_at": "2022-08-24T06:08:42Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553428",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>
LGTM. Thanks.



---

archive/issue_comments_553429.json:
```json
{
    "body": "**Changing branch** from \"[public/rings/floor_division_power_series-34116](https://github.com/sagemath/sagetrac-mirror/tree/public/rings/floor_division_power_series-34116)\" to \"[3525f0676f688f5dbc8b505d389f1c9bb0a68c4a](https://github.com/sagemath/sagetrac-mirror/commit/3525f0676f688f5dbc8b505d389f1c9bb0a68c4a)\".",
    "created_at": "2022-08-29T11:24:05Z",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34116#issuecomment-553429",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/rings/floor_division_power_series-34116](https://github.com/sagemath/sagetrac-mirror/tree/public/rings/floor_division_power_series-34116)" to "[3525f0676f688f5dbc8b505d389f1c9bb0a68c4a](https://github.com/sagemath/sagetrac-mirror/commit/3525f0676f688f5dbc8b505d389f1c9bb0a68c4a)".



---

archive/issue_events_304026.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-29T11:24:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34116#event-304026"
}
```



---

archive/issue_events_304027.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8a4672c14dcf7db814b308f3de8fd93bce5b90c8",
    "created_at": "2022-08-29T11:24:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34116",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34116#event-304027"
}
```
