# Issue 34490: `sage --package clean` command to remove outdated source tarballs

archive/issues_034253.json:
```json
{
    "body": "The `$SAGE_ROOT/upstream/` accumulates tarballs over the time. The proposed `sage --package clean` command cleans that directory and keeps only tarballs that are currently needed (i.e. only the versions indicated in `$SAGE_ROOT/build/pkgs/*/package-version.txt` are kept).\n\n\nBranch/Commit: 3809a6fe0dde3a90f1b22f838d301d7125288ff5\n\nReviewer: David Coudert\n\nAuthor: Thierry Monteil\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34490\n\n",
    "closed_at": "2022-09-22T22:35:16Z",
    "created_at": "2022-09-04T11:05:21Z",
    "labels": [
        "component: misc"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "`sage --package clean` command to remove outdated source tarballs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34490",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```
The `$SAGE_ROOT/upstream/` accumulates tarballs over the time. The proposed `sage --package clean` command cleans that directory and keeps only tarballs that are currently needed (i.e. only the versions indicated in `$SAGE_ROOT/build/pkgs/*/package-version.txt` are kept).


Branch/Commit: 3809a6fe0dde3a90f1b22f838d301d7125288ff5

Reviewer: David Coudert

Author: Thierry Monteil

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34490





---

archive/issue_comments_485191.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2022-09-04T11:18:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34490#issuecomment-485191",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_485192.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-04T11:18:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34490#issuecomment-485192",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_485193.json:
```json
{
    "body": "<a id='comment:3'></a>Something is not working\n\n```\nmaserati:/home/dcoudert/sage> ./sage --package clean\nusage: sage --package [-h] [--log LOG] {config,list,name,tarball,apropos,update,update-latest,download,upload,fix-checksum,create} ...\nsage --package: error: argument subcommand: invalid choice: 'clean' (choose from 'config', 'list', 'name', 'tarball', 'apropos', 'update', 'update-latest', 'download', 'upload', 'fix-checksum', 'create')\n```",
    "created_at": "2022-09-04T12:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34490#issuecomment-485193",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:3'></a>Something is not working

```
maserati:/home/dcoudert/sage> ./sage --package clean
usage: sage --package [-h] [--log LOG] {config,list,name,tarball,apropos,update,update-latest,download,upload,fix-checksum,create} ...
sage --package: error: argument subcommand: invalid choice: 'clean' (choose from 'config', 'list', 'name', 'tarball', 'apropos', 'update', 'update-latest', 'download', 'upload', 'fix-checksum', 'create')
```



---

archive/issue_comments_485194.json:
```json
{
    "body": "<a id='comment:4'></a>Oups, I did a mistake when getting the branch. I did it again and now it's working well.\n\nLGTM.",
    "created_at": "2022-09-04T13:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34490#issuecomment-485194",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:4'></a>Oups, I did a mistake when getting the branch. I did it again and now it's working well.

LGTM.



---

archive/issue_comments_485195.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-04T13:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34490#issuecomment-485195",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485196.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-22T22:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34490#issuecomment-485196",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_089594.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-22T22:35:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34490",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34490#event-89594"
}
```
