# Issue 34730: Rebase sage_autodoc to sphinx 5.3.0

archive/issues_034493.json:
```json
{
    "body": "We rebase `sage_autodoc` to Sphinx 5.3.0.\n\nThis is a step toward eventual removal of sage_autodoc in #30893, a customization of Sphinx autodoc extension for Sage objects.\n\nOther related tickets are #27578. #30884, #31309, in this regard.\n\nCC:  @kiwifb\n\nBranch/Commit: aa74d4badcbe6841833ff983ad5f756c5ac78752\n\nReviewer: Tobias Diez\n\nAuthor: Kwankyu Lee\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34730\n\n",
    "closed_at": "2022-11-15T23:42:58Z",
    "created_at": "2022-11-08T05:35:53Z",
    "labels": [
        "component: documentation"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Rebase sage_autodoc to sphinx 5.3.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34730",
    "user": "https://github.com/kwankyu"
}
```
We rebase `sage_autodoc` to Sphinx 5.3.0.

This is a step toward eventual removal of sage_autodoc in #30893, a customization of Sphinx autodoc extension for Sage objects.

Other related tickets are #27578. #30884, #31309, in this regard.

CC:  @kiwifb

Branch/Commit: aa74d4badcbe6841833ff983ad5f756c5ac78752

Reviewer: Tobias Diez

Author: Kwankyu Lee

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34730





---

archive/issue_comments_521742.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2022-11-08T05:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521742",
    "user": "https://github.com/kwankyu"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_521743.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to documentation.",
    "created_at": "2022-11-08T05:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521743",
    "user": "https://github.com/kwankyu"
}
```

Changing component from PLEASE CHANGE to documentation.



---

archive/issue_comments_521744.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-11-08T05:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521744",
    "user": "https://github.com/kwankyu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_521745.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+We again rebase `sage_autodoc` to Sphinx 5.3.0.\n \n Comment: 1\n \n```\n",
    "created_at": "2022-11-08T05:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521745",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+We again rebase `sage_autodoc` to Sphinx 5.3.0.
 
 Comment: 1
 
```




---

archive/issue_comments_521746.json:
```json
{
    "body": "<a id='comment:3'></a>Setting \"needs review\" to build the documentation for further check.",
    "created_at": "2022-11-08T05:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521746",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:3'></a>Setting "needs review" to build the documentation for further check.



---

archive/issue_comments_521747.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+We rebase `sage_autodoc` to Sphinx 5.3.0.\n \n Comment: 1\n \n```\n",
    "created_at": "2022-11-08T05:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521747",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+We rebase `sage_autodoc` to Sphinx 5.3.0.
 
 Comment: 1
 
```




---

archive/issue_comments_521748.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-11-08T11:17:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521748",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_521749.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-08T12:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521749",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_521750.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-11-08T12:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521750",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_521751.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-09T03:18:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521751",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_521752.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+We rebase `sage_autodoc` to Sphinx 5.3.0.\n \n+This is a step toward eventual removal of sage_autodoc, a customization of Sphinx autodoc extension for Sage objects.\n+\n+The next crucial step would be #27578.\n \n Comment: 1\n \n```\n",
    "created_at": "2022-11-09T03:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521752",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
+We rebase `sage_autodoc` to Sphinx 5.3.0.
 
+This is a step toward eventual removal of sage_autodoc, a customization of Sphinx autodoc extension for Sage objects.
+
+The next crucial step would be #27578.
 
 Comment: 1
 
```




---

archive/issue_comments_521753.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+We rebase `sage_autodoc` to Sphinx 5.3.0.\n \n+This is a step toward eventual removal of sage_autodoc, a customization of Sphinx autodoc extension for Sage objects.\n+\n+The next crucial step would be #27578. Other related tickets are #30884, #31309\n \n Comment: 1\n \n```\n",
    "created_at": "2022-11-09T03:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521753",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
+We rebase `sage_autodoc` to Sphinx 5.3.0.
 
+This is a step toward eventual removal of sage_autodoc, a customization of Sphinx autodoc extension for Sage objects.
+
+The next crucial step would be #27578. Other related tickets are #30884, #31309
 
 Comment: 1
 
```




---

archive/issue_comments_521754.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+We rebase `sage_autodoc` to Sphinx 5.3.0.\n \n+This is a step toward eventual removal of sage_autodoc, a customization of Sphinx autodoc extension for Sage objects.\n+\n+Other related tickets are #27578. #30884, #31309, in this regard.\n \n Comment: 1\n \n```\n",
    "created_at": "2022-11-09T03:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521754",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
+We rebase `sage_autodoc` to Sphinx 5.3.0.
 
+This is a step toward eventual removal of sage_autodoc, a customization of Sphinx autodoc extension for Sage objects.
+
+Other related tickets are #27578. #30884, #31309, in this regard.
 
 Comment: 1
 
```




---

archive/issue_comments_521755.json:
```json
{
    "body": "<a id='comment:13'></a>Do you have a ticket for sphinx 5.3.0 or is it backward compatible?",
    "created_at": "2022-11-09T21:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521755",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>Do you have a ticket for sphinx 5.3.0 or is it backward compatible?



---

archive/issue_comments_521756.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 Fran\u00e7ois Bissey]:\n> Do you have a ticket for sphinx 5.3.0 or is it backward compatible?\n\n\nThere is no difference between `autodoc`s of sphinx 5.2.3 and 5.3.0.",
    "created_at": "2022-11-09T22:07:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521756",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:14'></a>Replying to [comment:13 François Bissey]:
> Do you have a ticket for sphinx 5.3.0 or is it backward compatible?


There is no difference between `autodoc`s of sphinx 5.2.3 and 5.3.0.



---

archive/issue_comments_521757.json:
```json
{
    "body": "<a id='comment:15'></a>Moreover, as our old sage_autodoc (that is based on sphinx 1.8.x) still works with sphinx 5.2.3, autodoc extension seems pretty independent from the version of sphinx.",
    "created_at": "2022-11-09T22:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521757",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:15'></a>Moreover, as our old sage_autodoc (that is based on sphinx 1.8.x) still works with sphinx 5.2.3, autodoc extension seems pretty independent from the version of sphinx.



---

archive/issue_comments_521758.json:
```json
{
    "body": "<a id='comment:16'></a>I am fairly it has been touched here and there. But because of the ticket title I was wondering if we were doing something specific for sphinx 5.3.0. I have not checked we are compatible with sphinx 5.3.0 for example (and presumably if Antonio Rojas tested it, he didn't find/report any issues).",
    "created_at": "2022-11-09T22:20:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521758",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:16'></a>I am fairly it has been touched here and there. But because of the ticket title I was wondering if we were doing something specific for sphinx 5.3.0. I have not checked we are compatible with sphinx 5.3.0 for example (and presumably if Antonio Rojas tested it, he didn't find/report any issues).



---

archive/issue_comments_521759.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 Fran\u00e7ois Bissey]:\n> I am fairly it has been touched here and there. But because of the ticket title I was wondering if we were doing something specific for sphinx 5.3.0. \n\n\nI just used the latest from sphinx 5.x series.",
    "created_at": "2022-11-10T00:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521759",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:17'></a>Replying to [comment:16 François Bissey]:
> I am fairly it has been touched here and there. But because of the ticket title I was wondering if we were doing something specific for sphinx 5.3.0. 


I just used the latest from sphinx 5.x series.



---

archive/issue_comments_521760.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:16 Fran\u00e7ois Bissey]:\n> I have not checked we are compatible with sphinx 5.3.0 for example (and presumably if Antonio Rojas tested it, he didn't find/report any issues).\n\n\nWhen I did the rebase for sphinx 1.8.x, there were many regressions, which Jeroen Demeyer detected and reported to me. If there are none (or few) this time, that is because of the efforts made then. This time it is not that difficult. Next time, hopefully it would be even easier :)",
    "created_at": "2022-11-10T00:18:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521760",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:18'></a>Replying to [comment:16 François Bissey]:
> I have not checked we are compatible with sphinx 5.3.0 for example (and presumably if Antonio Rojas tested it, he didn't find/report any issues).


When I did the rebase for sphinx 1.8.x, there were many regressions, which Jeroen Demeyer detected and reported to me. If there are none (or few) this time, that is because of the efforts made then. This time it is not that difficult. Next time, hopefully it would be even easier :)



---

archive/issue_comments_521761.json:
```json
{
    "body": "<a id='comment:19'></a>LGTM.\n\nSince you are now familiar with the code, can you maybe list the major changes of sage's autodoc in #30893 with a proposal for how to remove the modification.",
    "created_at": "2022-11-10T10:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521761",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:19'></a>LGTM.

Since you are now familiar with the code, can you maybe list the major changes of sage's autodoc in #30893 with a proposal for how to remove the modification.



---

archive/issue_comments_521762.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-11-10T10:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521762",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_521763.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n+We rebase `sage_autodoc` to Sphinx 5.3.0.\n \n+This is a step toward eventual removal of sage_autodoc in #30893, a customization of Sphinx autodoc extension for Sage objects.\n+\n+Other related tickets are #27578. #30884, #31309, in this regard.\n \n Comment: 1\n \n```\n",
    "created_at": "2022-11-10T10:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521763",
    "user": "https://github.com/tobiasdiez"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
+We rebase `sage_autodoc` to Sphinx 5.3.0.
 
+This is a step toward eventual removal of sage_autodoc in #30893, a customization of Sphinx autodoc extension for Sage objects.
+
+Other related tickets are #27578. #30884, #31309, in this regard.
 
 Comment: 1
 
```




---

archive/issue_comments_521764.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 Tobias Diez]:\n> LGTM.\n\n\nThanks.\n\n> Since you are now familiar with the code, \n\n\nWell.., it was basically trial-and-errors with bits of understanding here and there :)\n\n> can you maybe list the major changes of sage's autodoc in #30893 with a proposal for how to remove the modification.\n\n\nI marked in the code where modifications are made. It is easy to list them:\n\n1. skipping lazy imports to avoid deprecation warnings\n2. providing argspecs for decorators (sage_wraps)\n3. dealing with nested classes\n4. dealing with cached function(methods) callers\n5. dealing with classcall metaclass  \n6. dealing with class aliases\n7. using argspecs instead of signature \n\nbut sorry no proposal for how to remove them. All looks difficult. I am not sure if the aim of eventual removal of sage_autodoc is really achievable. \n\nAfter #26254 merged, switching to signature seems the most urgent thing.",
    "created_at": "2022-11-10T14:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521764",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:20'></a>Replying to [comment:19 Tobias Diez]:
> LGTM.


Thanks.

> Since you are now familiar with the code, 


Well.., it was basically trial-and-errors with bits of understanding here and there :)

> can you maybe list the major changes of sage's autodoc in #30893 with a proposal for how to remove the modification.


I marked in the code where modifications are made. It is easy to list them:

1. skipping lazy imports to avoid deprecation warnings
2. providing argspecs for decorators (sage_wraps)
3. dealing with nested classes
4. dealing with cached function(methods) callers
5. dealing with classcall metaclass  
6. dealing with class aliases
7. using argspecs instead of signature 

but sorry no proposal for how to remove them. All looks difficult. I am not sure if the aim of eventual removal of sage_autodoc is really achievable. 

After #26254 merged, switching to signature seems the most urgent thing.



---

archive/issue_comments_521765.json:
```json
{
    "body": "<a id='comment:21'></a>Thanks for the summary, I've added it to #30893.",
    "created_at": "2022-11-10T20:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521765",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:21'></a>Thanks for the summary, I've added it to #30893.



---

archive/issue_comments_521766.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-11-15T23:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34730#issuecomment-521766",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_089783.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-11-15T23:42:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34730",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34730#event-89783"
}
```
