# Issue 34603: Fix singular spkg-configure

archive/issues_034366.json:
```json
{
    "body": "Seen on `archlinux-latest`, https://github.com/FFY00/meson-python/actions/runs/3146686714/jobs/5115498470\n\n```\nChecking whether SageMath should install SPKG singular...\nchecking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no\nchecking for Singular... /usr/sbin/Singular\nchecking for SINGULAR... yes\nchecking that Singular's help is working... grep: warning: stray \\ before white space\n./configure: line 43759: test: too many arguments\nno\nconfigure: no suitable system package found for SPKG singular\n\n```\n\n\n**CC:**  @dimpase @orlitzky\n\n**Branch/Commit:** [373bd38ae25acadf3bbedc412b61541d65a718fb](https://github.com/sagemath/sagetrac-mirror/commit/373bd38ae25acadf3bbedc412b61541d65a718fb)\n\n**Reviewer:** Matthias Koeppe\n\n**Author:** Dima Pasechnik\n\nIssue created by migration from https://trac.sagemath.org/ticket/34603\n\n",
    "closed_at": "2022-10-11T09:12:57Z",
    "created_at": "2022-09-28T20:54:53Z",
    "labels": [
        "component: build: configure",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Fix singular spkg-configure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34603",
    "user": "https://github.com/mkoeppe"
}
```
Seen on `archlinux-latest`, https://github.com/FFY00/meson-python/actions/runs/3146686714/jobs/5115498470

```
Checking whether SageMath should install SPKG singular...
checking whether any of gmp ntl flint readline mpfr cddlib is installed as or will be installed as SPKG... no
checking for Singular... /usr/sbin/Singular
checking for SINGULAR... yes
checking that Singular's help is working... grep: warning: stray \ before white space
./configure: line 43759: test: too many arguments
no
configure: no suitable system package found for SPKG singular

```


**CC:**  @dimpase @orlitzky

**Branch/Commit:** [373bd38ae25acadf3bbedc412b61541d65a718fb](https://github.com/sagemath/sagetrac-mirror/commit/373bd38ae25acadf3bbedc412b61541d65a718fb)

**Reviewer:** Matthias Koeppe

**Author:** Dima Pasechnik

Issue created by migration from https://trac.sagemath.org/ticket/34603





---

archive/issue_comments_657441.json:
```json
{
    "body": "<a id='comment:1'></a>\nDoes archlinux-latest use some sort of weird `grep` (3.8, the latest version from last month)? The error comes from\n\n```\nAS_IF([test x`printf \"system(\\\"--browser\\\", \\\"builtin\\\"); \\n help;\" | Singular 2>&1 | grep \"error\\ occurred\"` = x], [\n```\ni.e. `grep` does not understand `\"error\\ occurred\"`.",
    "created_at": "2022-10-01T10:00:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657441",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>
Does archlinux-latest use some sort of weird `grep` (3.8, the latest version from last month)? The error comes from

```
AS_IF([test x`printf "system(\"--browser\", \"builtin\"); \n help;" | Singular 2>&1 | grep "error\ occurred"` = x], [
```
i.e. `grep` does not understand `"error\ occurred"`.



---

archive/issue_comments_657442.json:
```json
{
    "body": "<a id='comment:2'></a>\nI've built grep 3.8, and indeed, I get a warning:\n\n```\n$ /tmp/bin/grep \"bla\\ baz\" t # this is grep 3.8\n/tmp/bin/grep: warning: stray \\ before white space\nbla baz\n$ cat t\nbla foo\nbla baz\n$ grep \"bla\\ baz\" t # this is grep 3.6\nbla baz\n```",
    "created_at": "2022-10-01T10:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657442",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
I've built grep 3.8, and indeed, I get a warning:

```
$ /tmp/bin/grep "bla\ baz" t # this is grep 3.8
/tmp/bin/grep: warning: stray \ before white space
bla baz
$ cat t
bla foo
bla baz
$ grep "bla\ baz" t # this is grep 3.6
bla baz
```



---

archive/issue_comments_657443.json:
```json
{
    "body": "<a id='comment:3'></a>\nwe can eiher just remove `\\` in the pattern, or send the warning to `dev/null`. Not sure what's the best, so I asked:\n\nhttps://unix.stackexchange.com/questions/719384/the-correct-way-to-deal-with-spaces-in-a-pattern-for-grep",
    "created_at": "2022-10-01T10:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657443",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:3'></a>
we can eiher just remove `\` in the pattern, or send the warning to `dev/null`. Not sure what's the best, so I asked:

https://unix.stackexchange.com/questions/719384/the-correct-way-to-deal-with-spaces-in-a-pattern-for-grep



---

archive/issue_comments_657444.json:
```json
{
    "body": "<a id='comment:4'></a>\nIt seems we can just remove that `\\`. I'll make a branch",
    "created_at": "2022-10-01T10:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657444",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
It seems we can just remove that `\`. I'll make a branch



---

archive/issue_comments_657445.json:
```json
{
    "body": "**Commit:** [373bd38ae25acadf3bbedc412b61541d65a718fb](https://github.com/sagemath/sagetrac-mirror/commit/373bd38ae25acadf3bbedc412b61541d65a718fb)",
    "created_at": "2022-10-01T11:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657445",
    "user": "https://github.com/dimpase"
}
```

**Commit:** [373bd38ae25acadf3bbedc412b61541d65a718fb](https://github.com/sagemath/sagetrac-mirror/commit/373bd38ae25acadf3bbedc412b61541d65a718fb)



---

archive/issue_comments_657446.json:
```json
{
    "body": "**Branch:** [u/dimpase/configure/nobackslash](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/configure/nobackslash)",
    "created_at": "2022-10-01T11:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657446",
    "user": "https://github.com/dimpase"
}
```

**Branch:** [u/dimpase/configure/nobackslash](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/configure/nobackslash)



---

archive/issue_comments_657447.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2022-10-01T11:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657447",
    "user": "https://github.com/dimpase"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_657448.json:
```json
{
    "body": "<a id='comment:5'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/373bd38ae25acadf3bbedc412b61541d65a718fb\">373bd38</a></td><td><code>remove harmful \\</code></td></tr></table>\n",
    "created_at": "2022-10-01T11:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657448",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/373bd38ae25acadf3bbedc412b61541d65a718fb">373bd38</a></td><td><code>remove harmful \</code></td></tr></table>




---

archive/issue_comments_657449.json:
```json
{
    "body": "**Author:** Dima Pasechnik",
    "created_at": "2022-10-01T11:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657449",
    "user": "https://github.com/dimpase"
}
```

**Author:** Dima Pasechnik



---

archive/issue_comments_657450.json:
```json
{
    "body": "**Reviewer:** Matthias Koeppe",
    "created_at": "2022-10-01T16:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657450",
    "user": "https://github.com/mkoeppe"
}
```

**Reviewer:** Matthias Koeppe



---

archive/issue_comments_657451.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2022-10-01T16:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657451",
    "user": "https://github.com/mkoeppe"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_101386.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-11T09:12:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34603#event-101386"
}
```



---

archive/issue_comments_657452.json:
```json
{
    "body": "**Changing branch** from \"[u/dimpase/configure/nobackslash](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/configure/nobackslash)\" to \"[373bd38ae25acadf3bbedc412b61541d65a718fb](https://github.com/sagemath/sagetrac-mirror/commit/373bd38ae25acadf3bbedc412b61541d65a718fb)\".",
    "created_at": "2022-10-11T09:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34603#issuecomment-657452",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/dimpase/configure/nobackslash](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/configure/nobackslash)" to "[373bd38ae25acadf3bbedc412b61541d65a718fb](https://github.com/sagemath/sagetrac-mirror/commit/373bd38ae25acadf3bbedc412b61541d65a718fb)".
