# Issue 34041: improve and document GAP and libgap memory customisation

archive/issues_033804.json:
```json
{
    "body": "it's a FAQ, how to do this. Should be fixed, and a working solution provided.\n\none can test this by exporting env.vars\n`SAGE_GAP_MEMORY` and/or `SAGE_GAP_COMMAND` (details in the branch`), before testing, e.g. \n\n```\n $ export SAGE_GAP_MEMORY=\"500m\"\n $ make test\n```\n\nCC:  @kiwifb\n\nBranch/Commit: e6ef4fe7e036aca572acc27fe95cfe6c5041bf45\n\nReviewer: Matthias Koeppe\n\nAuthor: Dima Pasechnik\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34041\n\n",
    "closed_at": "2022-07-09T22:33:09Z",
    "created_at": "2022-06-21T09:23:18Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "improve and document GAP and libgap memory customisation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34041",
    "user": "https://github.com/dimpase"
}
```
it's a FAQ, how to do this. Should be fixed, and a working solution provided.

one can test this by exporting env.vars
`SAGE_GAP_MEMORY` and/or `SAGE_GAP_COMMAND` (details in the branch`), before testing, e.g. 

```
 $ export SAGE_GAP_MEMORY="500m"
 $ make test
```

CC:  @kiwifb

Branch/Commit: e6ef4fe7e036aca572acc27fe95cfe6c5041bf45

Reviewer: Matthias Koeppe

Author: Dima Pasechnik

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34041





---

archive/issue_comments_678276.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-22T12:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678276",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_678277.json:
```json
{
    "body": "Changing author from \"\" to \"Dima Pasechnik\"",
    "created_at": "2022-06-22T12:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678277",
    "user": "https://github.com/dimpase"
}
```

Changing author from "" to "Dima Pasechnik"



---

archive/issue_comments_678278.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2022-06-22T12:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678278",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_678279.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dimpase/interfaces/gap_allow_memory_settings\"",
    "created_at": "2022-06-22T12:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678279",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "" to "u/dimpase/interfaces/gap_allow_memory_settings"



---

archive/issue_comments_678280.json:
```json
{
    "body": "Changing commit from \"\" to \"b914324e6d6b13dbc4d97fc655e2a1825ed1b433\"",
    "created_at": "2022-06-22T12:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678280",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "" to "b914324e6d6b13dbc4d97fc655e2a1825ed1b433"



---

archive/issue_comments_678281.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-22T22:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678281",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_678282.json:
```json
{
    "body": "Changing commit from \"b914324e6d6b13dbc4d97fc655e2a1825ed1b433\" to \"6a2dcc0c3981fadc530fa226e80451a6db3ed5c6\"",
    "created_at": "2022-06-22T22:24:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678282",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b914324e6d6b13dbc4d97fc655e2a1825ed1b433" to "6a2dcc0c3981fadc530fa226e80451a6db3ed5c6"



---

archive/issue_comments_678283.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n it's a FAQ, how to do this. Should be fixed, and a working solution provided.\n+\n+one can test this by exporting env.vars\n+`SAGE_GAP_MEMORY` and/or `SAGE_PEXPECT_GAP_COMMAND` (details in the branch`), before testing, e.g. \n+\n+```\n+ $ export SAGE_GAP_MEMORY=\"500m\"\n+ $ make test\n+```\n \n Comment: 1\n \n``````\n",
    "created_at": "2022-06-22T22:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678283",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
 it's a FAQ, how to do this. Should be fixed, and a working solution provided.
+
+one can test this by exporting env.vars
+`SAGE_GAP_MEMORY` and/or `SAGE_PEXPECT_GAP_COMMAND` (details in the branch`), before testing, e.g. 
+
+```
+ $ export SAGE_GAP_MEMORY="500m"
+ $ make test
+```
 
 Comment: 1
 
``````




---

archive/issue_comments_678284.json:
```json
{
    "body": "<a id='comment:4'></a>-1 on using `os.getenv` directly; this should go through `sage.env`",
    "created_at": "2022-06-25T18:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678284",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>-1 on using `os.getenv` directly; this should go through `sage.env`



---

archive/issue_comments_678285.json:
```json
{
    "body": "<a id='comment:5'></a>Also, the naming scheme used by sage.interfaces gives `SAGE_GAP_COMMAND`, not `SAGE_PEXPECT_GAP_COMMAND`, see #33405",
    "created_at": "2022-06-25T18:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678285",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Also, the naming scheme used by sage.interfaces gives `SAGE_GAP_COMMAND`, not `SAGE_PEXPECT_GAP_COMMAND`, see #33405



---

archive/issue_comments_678286.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-25T19:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678286",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_678287.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:4 mkoeppe]:\n> -1 on using `os.getenv` directly; this should go through `sage.env`\n\n\n\ndownstreams don't like sage.env, do they?",
    "created_at": "2022-06-25T21:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678287",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Replying to [comment:4 mkoeppe]:
> -1 on using `os.getenv` directly; this should go through `sage.env`



downstreams don't like sage.env, do they?



---

archive/issue_comments_678288.json:
```json
{
    "body": "<a id='comment:8'></a>The module `sage.env` is our general interface to access such variables",
    "created_at": "2022-06-25T21:46:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678288",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>The module `sage.env` is our general interface to access such variables



---

archive/issue_comments_678289.json:
```json
{
    "body": "<a id='comment:9'></a>I love `sage.env`. In fact, I had my own equivalent of `sage.env` in sage-on-gentoo before there was one in vanilla sage. Of course that doesn't mean you should put anything and everything in there.\n\nNow, I am not really against using `os.getenv` directly in code to change a behavior on the fly. But if you do, it should fall back to a sensible default or nothing if it is not defined. `sage.env` arguably serves as a single stop to collect such variables that ensure consistent use. But I wouldn't be to bothered if the branch was going as is.",
    "created_at": "2022-06-25T22:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678289",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>I love `sage.env`. In fact, I had my own equivalent of `sage.env` in sage-on-gentoo before there was one in vanilla sage. Of course that doesn't mean you should put anything and everything in there.

Now, I am not really against using `os.getenv` directly in code to change a behavior on the fly. But if you do, it should fall back to a sensible default or nothing if it is not defined. `sage.env` arguably serves as a single stop to collect such variables that ensure consistent use. But I wouldn't be to bothered if the branch was going as is.



---

archive/issue_comments_678290.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-29T21:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678290",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_678291.json:
```json
{
    "body": "Changing commit from \"6a2dcc0c3981fadc530fa226e80451a6db3ed5c6\" to \"e6ef4fe7e036aca572acc27fe95cfe6c5041bf45\"",
    "created_at": "2022-06-29T21:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678291",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6a2dcc0c3981fadc530fa226e80451a6db3ed5c6" to "e6ef4fe7e036aca572acc27fe95cfe6c5041bf45"



---

archive/issue_comments_678292.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-06-29T22:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678292",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_678293.json:
```json
{
    "body": "<a id='comment:12'></a>Thanks for making this change, LGTM",
    "created_at": "2022-06-29T22:15:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678293",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Thanks for making this change, LGTM



---

archive/issue_comments_678294.json:
```json
{
    "body": "<a id='comment:13'></a>(but I haven't tested it, so let's wait for the patchbot or the Build&test workflow)",
    "created_at": "2022-06-29T22:16:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678294",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>(but I haven't tested it, so let's wait for the patchbot or the Build&test workflow)



---

archive/issue_comments_678295.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+it's a FAQ, how to do this. Should be fixed, and a working solution provided.\n \n+one can test this by exporting env.vars\n+`SAGE_GAP_MEMORY` and/or `SAGE_GAP_COMMAND` (details in the branch`), before testing, e.g. \n+\n+```\n+ $ export SAGE_GAP_MEMORY=\"500m\"\n+ $ make test\n+```\n \n Comment: 1\n \n``````\n",
    "created_at": "2022-07-03T20:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678295",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
+it's a FAQ, how to do this. Should be fixed, and a working solution provided.
 
+one can test this by exporting env.vars
+`SAGE_GAP_MEMORY` and/or `SAGE_GAP_COMMAND` (details in the branch`), before testing, e.g. 
+
+```
+ $ export SAGE_GAP_MEMORY="500m"
+ $ make test
+```
 
 Comment: 1
 
``````




---

archive/issue_comments_678296.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-03T20:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678296",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_678297.json:
```json
{
    "body": "<a id='comment:15'></a>Tested locally, seems to work fine. I was able to provoke errors in the testsuite by setting a low memory limit",
    "created_at": "2022-07-03T20:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678297",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Tested locally, seems to work fine. I was able to provoke errors in the testsuite by setting a low memory limit



---

archive/issue_comments_678298.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-07-03T20:47:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678298",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "" to "Matthias Koeppe"



---

archive/issue_comments_678299.json:
```json
{
    "body": "Changing branch from \"u/dimpase/interfaces/gap_allow_memory_settings\" to \"e6ef4fe7e036aca572acc27fe95cfe6c5041bf45\"",
    "created_at": "2022-07-09T22:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678299",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/dimpase/interfaces/gap_allow_memory_settings" to "e6ef4fe7e036aca572acc27fe95cfe6c5041bf45"



---

archive/issue_events_089054.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-09T22:33:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34041#event-89054"
}
```



---

archive/issue_comments_678300.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-09T22:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34041#issuecomment-678300",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
