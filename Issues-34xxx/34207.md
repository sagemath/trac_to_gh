# Issue 34207: Document how to upgrade system packages without breaking Sage

archive/issues_033970.json:
```json
{
    "body": "(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)\n\nDebian:\n- separate, simultaneously installable shared library packages for different soversions, e.g., https://packages.debian.org/bullseye/libflint-2.6.3, https://packages.debian.org/sid/libflint17\n- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html\n\nFedora:\n- cannot simultaneously install library packages providing different soversions:\n\n```\n# dnf install 'libflint.so.16()(64bit)' 'libflint.so.17()(64bit)'\n\nLast metadata expiration check: 0:04:24 ago on Tue Jul 26 02:02:49 2022.\nError: \n\n Problem: cannot install both flint-2.9.0-1.fc36.x86_64 and flint-2.8.4-2.fc36.x86_64\n\n  - conflicting requests\n```\n- https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/\n\nGentoo:\n- use https://github.com/cschwan/sage-on-gentoo\n\nOpenSUSE:\n- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)\n- Just don't uninstall what Sage needs \n\nHomebrew:\n- It does not have separate shared library packages for different soversions\n- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.\n\nConda:\n- use separate environments for separate projects/tasks\n\nNix:\n- use separate environments for separate projects/tasks\n\n\nCC:  @nbruin @antonio-rojas @dimpase\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/34207\n\n",
    "created_at": "2022-07-21T18:56:05Z",
    "labels": [
        "component: documentation"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Document how to upgrade system packages without breaking Sage",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34207",
    "user": "https://github.com/mkoeppe"
}
```
(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)

Debian:
- separate, simultaneously installable shared library packages for different soversions, e.g., https://packages.debian.org/bullseye/libflint-2.6.3, https://packages.debian.org/sid/libflint17
- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html

Fedora:
- cannot simultaneously install library packages providing different soversions:

```
# dnf install 'libflint.so.16()(64bit)' 'libflint.so.17()(64bit)'

Last metadata expiration check: 0:04:24 ago on Tue Jul 26 02:02:49 2022.
Error: 

 Problem: cannot install both flint-2.9.0-1.fc36.x86_64 and flint-2.8.4-2.fc36.x86_64

  - conflicting requests
```
- https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/

Gentoo:
- use https://github.com/cschwan/sage-on-gentoo

OpenSUSE:
- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)
- Just don't uninstall what Sage needs 

Homebrew:
- It does not have separate shared library packages for different soversions
- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.

Conda:
- use separate environments for separate projects/tasks

Nix:
- use separate environments for separate projects/tasks


CC:  @nbruin @antonio-rojas @dimpase

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/34207





---

archive/issue_comments_681486.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,6 +8,10 @@\n - It does not have separate shared library packages for different soversions\n - After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.\n \n+Conda:\n+- use separate environments for separate projects/tasks\n+\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/34207\n``````\n",
    "created_at": "2022-07-21T19:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34207#issuecomment-681486",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,6 +8,10 @@
 - It does not have separate shared library packages for different soversions
 - After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.
 
+Conda:
+- use separate environments for separate projects/tasks
+
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/34207
``````




---

archive/issue_comments_681487.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,18 @@\n+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)\n+\n+Debian:\n+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html\n+\n+Fedora:\n+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)\n+- Just don't uninstall what Sage needs https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/\n+\n+Homebrew:\n+- It does not have separate shared library packages for different soversions\n+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.\n+\n+Conda:\n+- use separate environments for separate projects/tasks\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-07-21T20:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34207#issuecomment-681487",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,18 @@
+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)
+
+Debian:
+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html
+
+Fedora:
+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)
+- Just don't uninstall what Sage needs https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/
+
+Homebrew:
+- It does not have separate shared library packages for different soversions
+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.
+
+Conda:
+- use separate environments for separate projects/tasks
 
 
 Comment: 1
``````




---

archive/issue_comments_681488.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,21 @@\n+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)\n+\n+Debian:\n+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html\n+\n+Fedora:\n+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)\n+- Just don't uninstall what Sage needs https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/\n+\n+Gentoo:\n+- You are on your own.\n+\n+Homebrew:\n+- It does not have separate shared library packages for different soversions\n+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.\n+\n+Conda:\n+- use separate environments for separate projects/tasks\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-07-21T20:06:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34207#issuecomment-681488",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,21 @@
+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)
+
+Debian:
+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html
+
+Fedora:
+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)
+- Just don't uninstall what Sage needs https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/
+
+Gentoo:
+- You are on your own.
+
+Homebrew:
+- It does not have separate shared library packages for different soversions
+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.
+
+Conda:
+- use separate environments for separate projects/tasks
 
 
 Comment: 1
``````




---

archive/issue_comments_681489.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,24 @@\n+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)\n+\n+Debian:\n+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html\n+\n+Fedora:\n+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)\n+- Just don't uninstall what Sage needs https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/\n+\n+Gentoo:\n+- You are on your own.\n+\n+Homebrew:\n+- It does not have separate shared library packages for different soversions\n+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.\n+\n+Conda:\n+- use separate environments for separate projects/tasks\n+\n+Nix:\n+- use separate environments for separate projects/tasks\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-07-21T20:08:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34207#issuecomment-681489",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,24 @@
+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)
+
+Debian:
+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html
+
+Fedora:
+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)
+- Just don't uninstall what Sage needs https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/
+
+Gentoo:
+- You are on your own.
+
+Homebrew:
+- It does not have separate shared library packages for different soversions
+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.
+
+Conda:
+- use separate environments for separate projects/tasks
+
+Nix:
+- use separate environments for separate projects/tasks
 
 
 Comment: 1
``````




---

archive/issue_comments_681490.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,39 @@\n+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)\n+\n+Debian:\n+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html\n+\n+Fedora:\n+- cannot simultaneously install library packages providing different soversions:\n+\n+```\n+# dnf install 'libflint.so.16()(64bit)' 'libflint.so.17()(64bit)'\n+\n+Last metadata expiration check: 0:04:24 ago on Tue Jul 26 02:02:49 2022.\n+Error: \n+\n+ Problem: cannot install both flint-2.9.0-1.fc36.x86_64 and flint-2.8.4-2.fc36.x86_64\n+\n+  - conflicting requests\n+```\n+- https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/\n+\n+Gentoo:\n+- You are on your own.\n+\n+OpenSUSE:\n+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)\n+- Just don't uninstall what Sage needs \n+\n+Homebrew:\n+- It does not have separate shared library packages for different soversions\n+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.\n+\n+Conda:\n+- use separate environments for separate projects/tasks\n+\n+Nix:\n+- use separate environments for separate projects/tasks\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-07-26T02:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34207#issuecomment-681490",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,39 @@
+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)
+
+Debian:
+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html
+
+Fedora:
+- cannot simultaneously install library packages providing different soversions:
+
+```
+# dnf install 'libflint.so.16()(64bit)' 'libflint.so.17()(64bit)'
+
+Last metadata expiration check: 0:04:24 ago on Tue Jul 26 02:02:49 2022.
+Error: 
+
+ Problem: cannot install both flint-2.9.0-1.fc36.x86_64 and flint-2.8.4-2.fc36.x86_64
+
+  - conflicting requests
+```
+- https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/
+
+Gentoo:
+- You are on your own.
+
+OpenSUSE:
+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)
+- Just don't uninstall what Sage needs 
+
+Homebrew:
+- It does not have separate shared library packages for different soversions
+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.
+
+Conda:
+- use separate environments for separate projects/tasks
+
+Nix:
+- use separate environments for separate projects/tasks
 
 
 Comment: 1
``````




---

archive/issue_comments_681491.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,40 @@\n+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)\n+\n+Debian:\n+- separate, simultaneously installable shared library packages for different soversions, e.g., https://packages.debian.org/bullseye/libflint-2.6.3, https://packages.debian.org/sid/libflint17\n+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html\n+\n+Fedora:\n+- cannot simultaneously install library packages providing different soversions:\n+\n+```\n+# dnf install 'libflint.so.16()(64bit)' 'libflint.so.17()(64bit)'\n+\n+Last metadata expiration check: 0:04:24 ago on Tue Jul 26 02:02:49 2022.\n+Error: \n+\n+ Problem: cannot install both flint-2.9.0-1.fc36.x86_64 and flint-2.8.4-2.fc36.x86_64\n+\n+  - conflicting requests\n+```\n+- https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/\n+\n+Gentoo:\n+- You are on your own.\n+\n+OpenSUSE:\n+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)\n+- Just don't uninstall what Sage needs \n+\n+Homebrew:\n+- It does not have separate shared library packages for different soversions\n+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.\n+\n+Conda:\n+- use separate environments for separate projects/tasks\n+\n+Nix:\n+- use separate environments for separate projects/tasks\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-07-26T02:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34207#issuecomment-681491",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,40 @@
+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)
+
+Debian:
+- separate, simultaneously installable shared library packages for different soversions, e.g., https://packages.debian.org/bullseye/libflint-2.6.3, https://packages.debian.org/sid/libflint17
+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html
+
+Fedora:
+- cannot simultaneously install library packages providing different soversions:
+
+```
+# dnf install 'libflint.so.16()(64bit)' 'libflint.so.17()(64bit)'
+
+Last metadata expiration check: 0:04:24 ago on Tue Jul 26 02:02:49 2022.
+Error: 
+
+ Problem: cannot install both flint-2.9.0-1.fc36.x86_64 and flint-2.8.4-2.fc36.x86_64
+
+  - conflicting requests
+```
+- https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/
+
+Gentoo:
+- You are on your own.
+
+OpenSUSE:
+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)
+- Just don't uninstall what Sage needs 
+
+Homebrew:
+- It does not have separate shared library packages for different soversions
+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.
+
+Conda:
+- use separate environments for separate projects/tasks
+
+Nix:
+- use separate environments for separate projects/tasks
 
 
 Comment: 1
``````




---

archive/issue_comments_681492.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,40 @@\n+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)\n+\n+Debian:\n+- separate, simultaneously installable shared library packages for different soversions, e.g., https://packages.debian.org/bullseye/libflint-2.6.3, https://packages.debian.org/sid/libflint17\n+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html\n+\n+Fedora:\n+- cannot simultaneously install library packages providing different soversions:\n+\n+```\n+# dnf install 'libflint.so.16()(64bit)' 'libflint.so.17()(64bit)'\n+\n+Last metadata expiration check: 0:04:24 ago on Tue Jul 26 02:02:49 2022.\n+Error: \n+\n+ Problem: cannot install both flint-2.9.0-1.fc36.x86_64 and flint-2.8.4-2.fc36.x86_64\n+\n+  - conflicting requests\n+```\n+- https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/\n+\n+Gentoo:\n+- use https://github.com/cschwan/sage-on-gentoo\n+\n+OpenSUSE:\n+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)\n+- Just don't uninstall what Sage needs \n+\n+Homebrew:\n+- It does not have separate shared library packages for different soversions\n+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.\n+\n+Conda:\n+- use separate environments for separate projects/tasks\n+\n+Nix:\n+- use separate environments for separate projects/tasks\n \n \n Comment: 1\n``````\n",
    "created_at": "2022-08-03T06:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34207",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34207#issuecomment-681492",
    "user": "https://github.com/sheerluck"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,40 @@
+(from https://groups.google.com/g/sage-devel/c/Iz8ZsmQM3Pg/m/CPl9CbHmBgAJ)
+
+Debian:
+- separate, simultaneously installable shared library packages for different soversions, e.g., https://packages.debian.org/bullseye/libflint-2.6.3, https://packages.debian.org/sid/libflint17
+- https://manpages.ubuntu.com/manpages/bionic/man8/apt-mark.8.html
+
+Fedora:
+- cannot simultaneously install library packages providing different soversions:
+
+```
+# dnf install 'libflint.so.16()(64bit)' 'libflint.so.17()(64bit)'
+
+Last metadata expiration check: 0:04:24 ago on Tue Jul 26 02:02:49 2022.
+Error: 
+
+ Problem: cannot install both flint-2.9.0-1.fc36.x86_64 and flint-2.8.4-2.fc36.x86_64
+
+  - conflicting requests
+```
+- https://www.reddit.com/r/Fedora/comments/3pqrv9/dnf_remove_package_keep_dependencies/
+
+Gentoo:
+- use https://github.com/cschwan/sage-on-gentoo
+
+OpenSUSE:
+- separate, simultaneously installable shared library packages for different soversions, e.g. https://pkgs.org/download/libflint.so.16()(64bit), https://pkgs.org/download/libflint.so.17()(64bit)
+- Just don't uninstall what Sage needs 
+
+Homebrew:
+- It does not have separate shared library packages for different soversions
+- After upgrades, need to do a full rebuild (`make distclean`), or use `make -j list-broken-packages` from #34203.
+
+Conda:
+- use separate environments for separate projects/tasks
+
+Nix:
+- use separate environments for separate projects/tasks
 
 
 Comment: 1
``````




---

archive/issue_events_089241.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34207",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34207#event-89241"
}
```
