# Issue 34448: Put tensor modules of FiniteRankFreeModule in Modules().TensorProducts()

archive/issues_034211.json:
```json
{
    "body": "... and add the method `tensor_factors` (#34393)\n\nalso add construction functors for tensor modules, extending #30235.\n\n\nCC:  @tscrim @egourgoulhon @fchapoton\n\nBranch/Commit: e10f9cf17bd06784805914b63b7ae0adc4423c96\n\nReviewer: Eric Gourgoulhon\n\nAuthor: Matthias Koeppe\n\nDependencies: #34424, #34393, #31276, #30235, #30229, #30241, #34501\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34448\n\n",
    "closed_at": "2022-09-29T21:02:29Z",
    "created_at": "2022-08-28T23:29:22Z",
    "labels": [
        "component: categories"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Put tensor modules of FiniteRankFreeModule in Modules().TensorProducts()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34448",
    "user": "https://github.com/mkoeppe"
}
```
... and add the method `tensor_factors` (#34393)

also add construction functors for tensor modules, extending #30235.


CC:  @tscrim @egourgoulhon @fchapoton

Branch/Commit: e10f9cf17bd06784805914b63b7ae0adc4423c96

Reviewer: Eric Gourgoulhon

Author: Matthias Koeppe

Dependencies: #34424, #34393, #31276, #30235, #30229, #30241, #34501

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34448





---

archive/issue_comments_518481.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n ... and add the method `tensor_factors` (#34393)\n+\n+also add construction functors for tensor modules and submodules, extending #30235\n+\n \n Dependencies: #34424, #34393, #31276\n \n``````\n",
    "created_at": "2022-08-29T00:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518481",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,7 @@
 ... and add the method `tensor_factors` (#34393)
+
+also add construction functors for tensor modules and submodules, extending #30235
+
 
 Dependencies: #34424, #34393, #31276
 
``````




---

archive/issue_comments_518482.json:
```json
{
    "body": "<a id='comment:5'></a>Last 10 new commits:",
    "created_at": "2022-08-29T02:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518482",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>Last 10 new commits:



---

archive/issue_comments_518483.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-29T02:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518483",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_089532.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34448#event-89532"
}
```



---

archive/issue_comments_518484.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-09-02T18:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518484",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_518485.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-02T18:37:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518485",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518486.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n+... and add the method `tensor_factors` (#34393)\n+\n+also add construction functors for tensor modules, extending #30235.\n \n \n Dependencies: #34424, #34393, #31276\n``````\n",
    "created_at": "2022-09-04T19:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518486",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
+... and add the method `tensor_factors` (#34393)
+
+also add construction functors for tensor modules, extending #30235.
 
 
 Dependencies: #34424, #34393, #31276
``````




---

archive/issue_comments_518487.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-04T19:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518487",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518488.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-06T21:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518488",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518489.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-07T00:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518489",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518490.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-07T01:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518490",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518491.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-07T01:05:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518491",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_518492.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-07T18:14:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518492",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518493.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-24T21:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518493",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518494.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-25T23:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518494",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518495.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-25T23:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518495",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518496.json:
```json
{
    "body": "<a id='comment:22'></a>LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:\n\n```diff\n-    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,\n+    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,\n```\nand\n\n```diff\n+    tensor = FiniteRankFreeModule.tensor\n```\nNow, instances of `VectorFieldModule` are not free modules (those are implemented via `VectorFieldFreeModule` instead), so having `VectorFieldModule.tensor` being `FiniteRankFreeModule.tensor` looks problematic. For instance:\n\n```\nsage: M = manifolds.Sphere(2)\nsage: XM = M.vector_field_module()\nsage: XM.tensor?\n   Construct a tensor on the free module \"self\" or a tensor product\n   with other modules.\n   ...\n```\nbut `self` is not a free module. Maybe declaring `tensor = _tensor` would be preferable here. \n\nI understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket. In particular we have still `category=Modules(self._ring)` in `TensorFieldModule.__init__`.",
    "created_at": "2022-09-26T13:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518496",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:22'></a>LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:

```diff
-    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,
+    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,
```
and

```diff
+    tensor = FiniteRankFreeModule.tensor
```
Now, instances of `VectorFieldModule` are not free modules (those are implemented via `VectorFieldFreeModule` instead), so having `VectorFieldModule.tensor` being `FiniteRankFreeModule.tensor` looks problematic. For instance:

```
sage: M = manifolds.Sphere(2)
sage: XM = M.vector_field_module()
sage: XM.tensor?
   Construct a tensor on the free module "self" or a tensor product
   with other modules.
   ...
```
but `self` is not a free module. Maybe declaring `tensor = _tensor` would be preferable here. 

I understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket. In particular we have still `category=Modules(self._ring)` in `TensorFieldModule.__init__`.



---

archive/issue_comments_518497.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 Eric Gourgoulhon]:\n> I understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket.\n\n\nThe next step in this direction is #34589",
    "created_at": "2022-09-26T17:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518497",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Replying to [comment:22 Eric Gourgoulhon]:
> I understand that bringing tensor modules on `VectorFieldModule` in `Modules().TensorProducts()` is beyond the scope of this ticket.


The next step in this direction is #34589



---

archive/issue_comments_518498.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-26T17:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518498",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_518499.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:22 Eric Gourgoulhon]:\n> LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:\n> \n> ```\n> #!diff\n> -    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,\n> +    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,\n> ```\n> and\n> \n> ```\n> #!diff\n> +    tensor = FiniteRankFreeModule.tensor\n> ```\n\n\nThanks for catching this. I've reverted this change.",
    "created_at": "2022-09-26T17:22:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518499",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'></a>Replying to [comment:22 Eric Gourgoulhon]:
> LGTM for the part in `sage.tensor.modules`. Regarding the part in `sage.manifolds.differentiable`, there are the following changes in the class `VectorFieldModule`:
> 
> ```
> #!diff
> -    def tensor(self, tensor_type, name=None, latex_name=None, sym=None,
> +    def _tensor(self, tensor_type, name=None, latex_name=None, sym=None,
> ```
> and
> 
> ```
> #!diff
> +    tensor = FiniteRankFreeModule.tensor
> ```


Thanks for catching this. I've reverted this change.



---

archive/issue_comments_518500.json:
```json
{
    "body": "<a id='comment:26'></a>Thanks!",
    "created_at": "2022-09-27T09:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518500",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:26'></a>Thanks!



---

archive/issue_comments_518501.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-09-27T09:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518501",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_518502.json:
```json
{
    "body": "<a id='comment:27'></a>Thank you!",
    "created_at": "2022-09-27T17:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518502",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>Thank you!



---

archive/issue_events_089533.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-29T21:02:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34448#event-89533"
}
```



---

archive/issue_comments_518503.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-29T21:02:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34448",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34448#issuecomment-518503",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
