# Issue 34000: cleaning and enhancement to PolyDict

archive/issues_033763.json:
```json
{
    "body": "We provide some cleaning and speed up to the `PolyDict` class by always enforcing keys to be `ETuple` (some parts of the code did assume that was the case). As a consequence we deprecate the usage of the constructor arguments `force_int_exponents` and `force_etuples`.\n\nWe also simplify the design by getting rid of `PolyDict.__zero` (and hence deprecating the argument `zero` of the `PolyDict` constructor).\n\nAlong the way, we fix\n\n```\nsage: R = ZZ['x']['y,z']\nsage: y, z = R.gens()\nsage: y.integral(y)\n1/2*y^2\nsage: parent(y.integral(y))\nMultivariate Polynomial Ring in y, z over Univariate Polynomial Ring in x over Integer Ring\n```\nand\n\n```\nsage: from sage.rings.polynomial.polydict import ETuple\nsage: e = ETuple([0, 1, 0])\nsage: e.eadd_p(0, 0).nonzero_positions()\n[0, 1]\n```\n\nCC:  @xcaruso @mezzarobba @saraedum\n\nAuthor: Vincent Delecroix\n\nBranch: u/vdelecroix/34000\n\nStatus: needs_review\n\nCommit: 52c5a25197b4de018007c15bfa8fac51686c9924\n\nIssue created by migration from https://trac.sagemath.org/ticket/34000\n\n",
    "created_at": "2022-06-16T09:04:15Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "cleaning and enhancement to PolyDict",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34000",
    "user": "https://github.com/videlec"
}
```
We provide some cleaning and speed up to the `PolyDict` class by always enforcing keys to be `ETuple` (some parts of the code did assume that was the case). As a consequence we deprecate the usage of the constructor arguments `force_int_exponents` and `force_etuples`.

We also simplify the design by getting rid of `PolyDict.__zero` (and hence deprecating the argument `zero` of the `PolyDict` constructor).

Along the way, we fix

```
sage: R = ZZ['x']['y,z']
sage: y, z = R.gens()
sage: y.integral(y)
1/2*y^2
sage: parent(y.integral(y))
Multivariate Polynomial Ring in y, z over Univariate Polynomial Ring in x over Integer Ring
```
and

```
sage: from sage.rings.polynomial.polydict import ETuple
sage: e = ETuple([0, 1, 0])
sage: e.eadd_p(0, 0).nonzero_positions()
[0, 1]
```

CC:  @xcaruso @mezzarobba @saraedum

Author: Vincent Delecroix

Branch: u/vdelecroix/34000

Status: needs_review

Commit: 52c5a25197b4de018007c15bfa8fac51686c9924

Issue created by migration from https://trac.sagemath.org/ticket/34000





---

archive/issue_comments_677783.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,14 @@\n+We provide some cleaning and speed up to the `PolyDict` class by always enforcing keys to be `ETuple` (some parts of the code did assume that was the case). As a consequence we deprecate the usage of the constructor arguments `force_int_exponents` and `force_etuples`.\n \n+We also simplify the design by getting rid of `PolyDict.__zero` (and hence deprecating the argument `zero` of the `PolyDict` constructor).\n+\n+Along the way, we fix\n+\n+```\n+sage: R = ZZ['x']['y,z']\n+sage: y, z = R.gens()\n+sage: y.integral(y)\n+1/2*y^2\n+sage: parent(y.integral(y))\n+Multivariate Polynomial Ring in y, z over Univariate Polynomial Ring in x over Integer Ring\n+```\n``````\n",
    "created_at": "2022-06-16T09:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677783",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,14 @@
+We provide some cleaning and speed up to the `PolyDict` class by always enforcing keys to be `ETuple` (some parts of the code did assume that was the case). As a consequence we deprecate the usage of the constructor arguments `force_int_exponents` and `force_etuples`.
 
+We also simplify the design by getting rid of `PolyDict.__zero` (and hence deprecating the argument `zero` of the `PolyDict` constructor).
+
+Along the way, we fix
+
+```
+sage: R = ZZ['x']['y,z']
+sage: y, z = R.gens()
+sage: y.integral(y)
+1/2*y^2
+sage: parent(y.integral(y))
+Multivariate Polynomial Ring in y, z over Univariate Polynomial Ring in x over Integer Ring
+```
``````




---

archive/issue_comments_677784.json:
```json
{
    "body": "Changing commit from \"\" to \"e48d7414f7946de6f0d8ff9485326db2413645af\"",
    "created_at": "2022-06-16T16:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677784",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "e48d7414f7946de6f0d8ff9485326db2413645af"



---

archive/issue_comments_677785.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/34000\"",
    "created_at": "2022-06-16T16:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677785",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/34000"



---

archive/issue_comments_677786.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[7deaa24](https://git.sagemath.org/sage.git/commit?id=7deaa248c1782ebad19bb6723e0f8a4f6d4ddb10)|`34000: cleaning and enhancement to polydict`|\n|[e48d741](https://git.sagemath.org/sage.git/commit?id=e48d7414f7946de6f0d8ff9485326db2413645af)|`34000: remove PolyDict.__pow__`|",
    "created_at": "2022-06-16T16:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677786",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[7deaa24](https://git.sagemath.org/sage.git/commit?id=7deaa248c1782ebad19bb6723e0f8a4f6d4ddb10)|`34000: cleaning and enhancement to polydict`|
|[e48d741](https://git.sagemath.org/sage.git/commit?id=e48d7414f7946de6f0d8ff9485326db2413645af)|`34000: remove PolyDict.__pow__`|



---

archive/issue_comments_677787.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-16T16:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677787",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_677788.json:
```json
{
    "body": "<a id='comment:3'></a>\nTwo things that I did not understand while skimming through the code:\n* in `MPolynomial_polydict.integral()`, why do you have two different code paths for determining the result's parent?\n* what do the `RuntimeError`s now raised by `PolyDict` on various occasions correspond to?",
    "created_at": "2022-06-18T07:54:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677788",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:3'></a>
Two things that I did not understand while skimming through the code:
* in `MPolynomial_polydict.integral()`, why do you have two different code paths for determining the result's parent?
* what do the `RuntimeError`s now raised by `PolyDict` on various occasions correspond to?



---

archive/issue_comments_677789.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [mmezzarobba](#comment%3A3):\n> Two things that I did not understand while skimming through the code:\n\n\nThanks for having a look.\n\n> * in `MPolynomial_polydict.integral()`, why do you have two different code paths for determining the result's parent?\n\n\nI shamefully copied the code from univariate polynomials, see [polynomial_element.pyx#L3980-L3985](https://github.com/sagemath/sage/blob/develop/src/sage/rings/polynomial/polynomial_element.pyx#L3980-L3985)\n\n> * what do the `RuntimeError`s now raised by `PolyDict` on various occasions correspond to?\n\n\nOne of them is ensuring that keys are `ETuple`. All others are here because I also made uniform that no coefficient is zero. At least, it did not break any test.",
    "created_at": "2022-06-18T12:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677789",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>
Replying to [mmezzarobba](#comment%3A3):
> Two things that I did not understand while skimming through the code:


Thanks for having a look.

> * in `MPolynomial_polydict.integral()`, why do you have two different code paths for determining the result's parent?


I shamefully copied the code from univariate polynomials, see [polynomial_element.pyx#L3980-L3985](https://github.com/sagemath/sage/blob/develop/src/sage/rings/polynomial/polynomial_element.pyx#L3980-L3985)

> * what do the `RuntimeError`s now raised by `PolyDict` on various occasions correspond to?


One of them is ensuring that keys are `ETuple`. All others are here because I also made uniform that no coefficient is zero. At least, it did not break any test.



---

archive/issue_comments_677790.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [vdelecroix](#comment%3A4):\n> > * what do the `RuntimeError`s now raised by `PolyDict` on various occasions correspond to?\n \n> \n> One of them is ensuring that keys are `ETuple`. All others are here because I also made uniform that no coefficient is zero. At least, it did not break any test.\n\n\nSorry, my question was not clear. I was mostly wondering why you were raising `RuntimeError`s rather than `ValueError`s/`TypeError`s/... (if the purpose was argument checking) or using assertions (if you wanted to guard against things that should never happen).",
    "created_at": "2022-06-18T18:30:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677790",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:5'></a>
Replying to [vdelecroix](#comment%3A4):
> > * what do the `RuntimeError`s now raised by `PolyDict` on various occasions correspond to?
 
> 
> One of them is ensuring that keys are `ETuple`. All others are here because I also made uniform that no coefficient is zero. At least, it did not break any test.


Sorry, my question was not clear. I was mostly wondering why you were raising `RuntimeError`s rather than `ValueError`s/`TypeError`s/... (if the purpose was argument checking) or using assertions (if you wanted to guard against things that should never happen).



---

archive/issue_comments_677791.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[6eac6b0](https://git.sagemath.org/sage.git/commit/?id=6eac6b0e29605fae248f280de33563afce301347)|`34000: cleaner optimization in derivative/integral`|\n|[065d42e](https://git.sagemath.org/sage.git/commit/?id=065d42eac965a8b276044d2487eb82a979efca4a)|`34000: clarify RuntimeError`|\n|[48413be](https://git.sagemath.org/sage.git/commit/?id=48413bebee6c57b9adb9fe3cabda82bc28ee3d53)|`34000: two little optimizations`|",
    "created_at": "2022-06-18T19:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677791",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[6eac6b0](https://git.sagemath.org/sage.git/commit/?id=6eac6b0e29605fae248f280de33563afce301347)|`34000: cleaner optimization in derivative/integral`|
|[065d42e](https://git.sagemath.org/sage.git/commit/?id=065d42eac965a8b276044d2487eb82a979efca4a)|`34000: clarify RuntimeError`|
|[48413be](https://git.sagemath.org/sage.git/commit/?id=48413bebee6c57b9adb9fe3cabda82bc28ee3d53)|`34000: two little optimizations`|



---

archive/issue_comments_677792.json:
```json
{
    "body": "Changing commit from \"e48d7414f7946de6f0d8ff9485326db2413645af\" to \"48413bebee6c57b9adb9fe3cabda82bc28ee3d53\"",
    "created_at": "2022-06-18T19:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e48d7414f7946de6f0d8ff9485326db2413645af" to "48413bebee6c57b9adb9fe3cabda82bc28ee3d53"



---

archive/issue_comments_677793.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [mmezzarobba](#comment%3A5):\n> Replying to [vdelecroix](#comment%3A4):\n> > > * what do the `RuntimeError`s now raised by `PolyDict` on various occasions correspond to?\n \n> > \n> > One of them is ensuring that keys are `ETuple`. All others are here because I also made uniform that no coefficient is zero. At least, it did not break any test.\n\n> \n> Sorry, my question was not clear. I was mostly wondering why you were raising `RuntimeError`s rather than `ValueError`s/`TypeError`s/... (if the purpose was argument checking) or using assertions (if you wanted to guard against things that should never happen).\n\n\nIt is really a `RuntimeError` : it is assumed that keys are `ETuple` and coefficients are nonzero.",
    "created_at": "2022-06-18T19:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677793",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>
Replying to [mmezzarobba](#comment%3A5):
> Replying to [vdelecroix](#comment%3A4):
> > > * what do the `RuntimeError`s now raised by `PolyDict` on various occasions correspond to?
 
> > 
> > One of them is ensuring that keys are `ETuple`. All others are here because I also made uniform that no coefficient is zero. At least, it did not break any test.

> 
> Sorry, my question was not clear. I was mostly wondering why you were raising `RuntimeError`s rather than `ValueError`s/`TypeError`s/... (if the purpose was argument checking) or using assertions (if you wanted to guard against things that should never happen).


It is really a `RuntimeError` : it is assumed that keys are `ETuple` and coefficients are nonzero.



---

archive/issue_comments_677794.json:
```json
{
    "body": "<a id='comment:8'></a>\nI hope I clarified the code related to your comments in \u200b6eac6b0 and 065d42e.",
    "created_at": "2022-06-18T19:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677794",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>
I hope I clarified the code related to your comments in ​6eac6b0 and 065d42e.



---

archive/issue_comments_677795.json:
```json
{
    "body": "<a id='comment:9'></a>\nLet me change `RuntimeError` for assertions.",
    "created_at": "2022-06-18T19:39:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677795",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>
Let me change `RuntimeError` for assertions.



---

archive/issue_comments_677796.json:
```json
{
    "body": "Changing commit from \"48413bebee6c57b9adb9fe3cabda82bc28ee3d53\" to \"f6c689385b372a7dfb59c806808eb51033f22ddb\"",
    "created_at": "2022-06-18T19:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677796",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "48413bebee6c57b9adb9fe3cabda82bc28ee3d53" to "f6c689385b372a7dfb59c806808eb51033f22ddb"



---

archive/issue_comments_677797.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[f6c6893](https://git.sagemath.org/sage.git/commit/?id=f6c689385b372a7dfb59c806808eb51033f22ddb)|`34000: replace RuntimeError with assertion`|",
    "created_at": "2022-06-18T19:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677797",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[f6c6893](https://git.sagemath.org/sage.git/commit/?id=f6c689385b372a7dfb59c806808eb51033f22ddb)|`34000: replace RuntimeError with assertion`|



---

archive/issue_comments_677798.json:
```json
{
    "body": "Changing commit from \"f6c689385b372a7dfb59c806808eb51033f22ddb\" to \"3341a9866747e6f06445cc893f6946577427364d\"",
    "created_at": "2022-06-19T08:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677798",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f6c689385b372a7dfb59c806808eb51033f22ddb" to "3341a9866747e6f06445cc893f6946577427364d"



---

archive/issue_comments_677799.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[3341a98](https://git.sagemath.org/sage.git/commit/?id=3341a9866747e6f06445cc893f6946577427364d)|`34000: fix Polydict.homogenize and ETuple.eadd_p`|",
    "created_at": "2022-06-19T08:53:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677799",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[3341a98](https://git.sagemath.org/sage.git/commit/?id=3341a9866747e6f06445cc893f6946577427364d)|`34000: fix Polydict.homogenize and ETuple.eadd_p`|



---

archive/issue_comments_677800.json:
```json
{
    "body": "<a id='comment:12'></a>\nIn the last commit I fixed a bug in `eadd_p` and optimized `homogenize` in order to fix a bug that show up in doctests from `sage.schemes.elliptic_curve.constructor`.\n\n---\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[3341a98](https://git.sagemath.org/sage.git/commit?id=3341a9866747e6f06445cc893f6946577427364d)|`34000: fix Polydict.homogenize and ETuple.eadd_p`|",
    "created_at": "2022-06-19T08:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677800",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>
In the last commit I fixed a bug in `eadd_p` and optimized `homogenize` in order to fix a bug that show up in doctests from `sage.schemes.elliptic_curve.constructor`.

---
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[3341a98](https://git.sagemath.org/sage.git/commit?id=3341a9866747e6f06445cc893f6946577427364d)|`34000: fix Polydict.homogenize and ETuple.eadd_p`|



---

archive/issue_comments_677801.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,3 +12,11 @@\n sage: parent(y.integral(y))\n Multivariate Polynomial Ring in y, z over Univariate Polynomial Ring in x over Integer Ring\n ```\n+and\n+\n+```\n+sage: from sage.rings.polynomial.polydict import ETuple\n+sage: e = ETuple([0, 1, 0])\n+sage: e.eadd_p(0, 0).nonzero_positions()\n+[0, 1]\n+```\n``````\n",
    "created_at": "2022-06-19T08:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677801",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,3 +12,11 @@
 sage: parent(y.integral(y))
 Multivariate Polynomial Ring in y, z over Univariate Polynomial Ring in x over Integer Ring
 ```
+and
+
+```
+sage: from sage.rings.polynomial.polydict import ETuple
+sage: e = ETuple([0, 1, 0])
+sage: e.eadd_p(0, 0).nonzero_positions()
+[0, 1]
+```
``````




---

archive/issue_comments_677802.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[0b0e48c](https://git.sagemath.org/sage.git/commit/?id=0b0e48c6f62098d21aeb9b899f942062623dbec3)|`34000: fix zero coefficient in PolyDict.homogenize`|",
    "created_at": "2022-06-19T09:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677802",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[0b0e48c](https://git.sagemath.org/sage.git/commit/?id=0b0e48c6f62098d21aeb9b899f942062623dbec3)|`34000: fix zero coefficient in PolyDict.homogenize`|



---

archive/issue_comments_677803.json:
```json
{
    "body": "Changing commit from \"3341a9866747e6f06445cc893f6946577427364d\" to \"0b0e48c6f62098d21aeb9b899f942062623dbec3\"",
    "created_at": "2022-06-19T09:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3341a9866747e6f06445cc893f6946577427364d" to "0b0e48c6f62098d21aeb9b899f942062623dbec3"



---

archive/issue_comments_677804.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-19T12:32:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677804",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_677805.json:
```json
{
    "body": "<a id='comment:14'></a>\n\n```\nsage -t --long src/sage/rings/tate_algebra_element.pyx  # 5 doctests failed\nsage -t --long src/sage/rings/tate_algebra_ideal.pyx  # 3 doctests failed\nsage -t --long src/sage/rings/polynomial/multi_polynomial.pyx  # 1 doctest failed\n```",
    "created_at": "2022-06-19T12:32:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677805",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>

```
sage -t --long src/sage/rings/tate_algebra_element.pyx  # 5 doctests failed
sage -t --long src/sage/rings/tate_algebra_ideal.pyx  # 3 doctests failed
sage -t --long src/sage/rings/polynomial/multi_polynomial.pyx  # 1 doctest failed
```



---

archive/issue_comments_677806.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[fae4a25](https://git.sagemath.org/sage.git/commit/?id=fae4a257a688f9bbc731bf361e84c6f990a50c63)|`34000: make a copy of input in PolyDict.__init__`|",
    "created_at": "2022-06-19T13:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677806",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[fae4a25](https://git.sagemath.org/sage.git/commit/?id=fae4a257a688f9bbc731bf361e84c6f990a50c63)|`34000: make a copy of input in PolyDict.__init__`|



---

archive/issue_comments_677807.json:
```json
{
    "body": "Changing commit from \"0b0e48c6f62098d21aeb9b899f942062623dbec3\" to \"fae4a257a688f9bbc731bf361e84c6f990a50c63\"",
    "created_at": "2022-06-19T13:31:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0b0e48c6f62098d21aeb9b899f942062623dbec3" to "fae4a257a688f9bbc731bf361e84c6f990a50c63"



---

archive/issue_comments_677808.json:
```json
{
    "body": "<a id='comment:16'></a>\n`@`Xavier Caruso: now that I made systematic zero coefficient removal in `polydict.pyx` I have trouble with Tate algebras. Namely, it seems that you always want to keep zeros there even though there is no natural way we can make difference between exact and inexact zero in the base ring\n\n```\nsage: R = Zp(2, print_mode='digits', prec=10)\nsage: R(0, 5).is_zero()\nTrue\nsage: R(0, 5) == R(0)\nTrue\nsage: not (R(0, 5) != R(0))\nTrue\n```\nThis affects code such as\n\n```\nsage: R = Zp(2, print_mode='digits', prec=10)\nsage: A.<x,y> = TateAlgebra(R)\nsage: f = 1 + 64*x\nsage: f -= R(1, 5)\nsage: f\n...00000 + ...0000000001000000*x\n```\nwhich now returns `...0000000001000000*x`.\n\nOn the other hand, I believe that the code in Tate algebra is buggy for the following reason. The conversion `R -> A` does not commute with binary operations\n\n```\nsage: R = Zp(2, print_mode='digits', prec=10)\nsage: A.<x,y> = TateAlgebra(R)\nsage: A(R(1)) - A(R(1,5))\n...00000\nsage: A(R(1) - R(1,5))\n0\n```\nThe following is also broken\n\n```\nsage: A({(1,1): R(0,5)})\n0\n```\n(it should have been `R(0,5)*x*y` which prints as `...00000*x*y`)\n\nThe main question is : how do we test whether an element is exactly zero in `R` ? `r.precision_absolute() == infinity and r.is_zero()`? I could introduce an attribute `zero_test` in `PolyDict` to make this check consistently.",
    "created_at": "2022-06-19T13:44:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677808",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>
`@`Xavier Caruso: now that I made systematic zero coefficient removal in `polydict.pyx` I have trouble with Tate algebras. Namely, it seems that you always want to keep zeros there even though there is no natural way we can make difference between exact and inexact zero in the base ring

```
sage: R = Zp(2, print_mode='digits', prec=10)
sage: R(0, 5).is_zero()
True
sage: R(0, 5) == R(0)
True
sage: not (R(0, 5) != R(0))
True
```
This affects code such as

```
sage: R = Zp(2, print_mode='digits', prec=10)
sage: A.<x,y> = TateAlgebra(R)
sage: f = 1 + 64*x
sage: f -= R(1, 5)
sage: f
...00000 + ...0000000001000000*x
```
which now returns `...0000000001000000*x`.

On the other hand, I believe that the code in Tate algebra is buggy for the following reason. The conversion `R -> A` does not commute with binary operations

```
sage: R = Zp(2, print_mode='digits', prec=10)
sage: A.<x,y> = TateAlgebra(R)
sage: A(R(1)) - A(R(1,5))
...00000
sage: A(R(1) - R(1,5))
0
```
The following is also broken

```
sage: A({(1,1): R(0,5)})
0
```
(it should have been `R(0,5)*x*y` which prints as `...00000*x*y`)

The main question is : how do we test whether an element is exactly zero in `R` ? `r.precision_absolute() == infinity and r.is_zero()`? I could introduce an attribute `zero_test` in `PolyDict` to make this check consistently.



---

archive/issue_comments_677809.json:
```json
{
    "body": "<a id='comment:17'></a>\nFor the same reason as in [This is the Trac macro *comment:16* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:16-macro) multivariate polynomials over p-adics are similarly broken in the current sage\n\n```\nsage: R = Zp(2)\nsage: Rxy.<x,y> = R[]\nsage: Rxy(R(0,5))\n0\nsage: x - x\n0\n```",
    "created_at": "2022-06-19T18:07:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677809",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>
For the same reason as in [This is the Trac macro *comment:16* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:16-macro) multivariate polynomials over p-adics are similarly broken in the current sage

```
sage: R = Zp(2)
sage: Rxy.<x,y> = R[]
sage: Rxy(R(0,5))
0
sage: x - x
0
```



---

archive/issue_comments_677810.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [vdelecroix](#comment%3A17):\n> For the same reason as in [This is the Trac macro *comment:16* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:16-macro) multivariate polynomials over p-adics are similarly broken in the current sage\n> \n> ```\n> sage: R = Zp(2)\n> sage: Rxy.<x,y> = R[]\n> sage: Rxy(R(0,5))\n> 0\n> sage: x - x\n> 0\n> ```\n\n\nhmm as well as multivariate polynomial rings over power series\n\n```\nsage: R.<x> = PowerSeriesRing(QQ)\nsage: A.<y,z> = R[]\nsage: O(x^3) * y\n0\n```",
    "created_at": "2022-06-19T18:16:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677810",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>
Replying to [vdelecroix](#comment%3A17):
> For the same reason as in [This is the Trac macro *comment:16* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:16-macro) multivariate polynomials over p-adics are similarly broken in the current sage
> 
> ```
> sage: R = Zp(2)
> sage: Rxy.<x,y> = R[]
> sage: Rxy(R(0,5))
> 0
> sage: x - x
> 0
> ```


hmm as well as multivariate polynomial rings over power series

```
sage: R.<x> = PowerSeriesRing(QQ)
sage: A.<y,z> = R[]
sage: O(x^3) * y
0
```



---

archive/issue_comments_677811.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [vdelecroix](#comment%3A16):\n> The main question is : how do we test whether an element is exactly zero in `R` ? `r.precision_absolute() == infinity and r.is_zero()`? I could introduce an attribute `zero_test` in `PolyDict` to make this check consistently.\n\n\nI think you can use the method `_is_exact_zero` for padics.\n\nI'll have a look at the bug in coercion from base ring to Tate algebra you noticed.",
    "created_at": "2022-06-19T18:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677811",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:19'></a>
Replying to [vdelecroix](#comment%3A16):
> The main question is : how do we test whether an element is exactly zero in `R` ? `r.precision_absolute() == infinity and r.is_zero()`? I could introduce an attribute `zero_test` in `PolyDict` to make this check consistently.


I think you can use the method `_is_exact_zero` for padics.

I'll have a look at the bug in coercion from base ring to Tate algebra you noticed.



---

archive/issue_comments_677812.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [caruso](#comment%3A19):\n> Replying to [vdelecroix](#comment%3A16):\n> > The main question is : how do we test whether an element is exactly zero in `R` ? `r.precision_absolute() == infinity and r.is_zero()`? I could introduce an attribute `zero_test` in `PolyDict` to make this check consistently.\n\n> \n> I think you can use the method `_is_exact_zero` for padics.\n\n\nThanks. Though very specific to p-adics. And it does not exist for power series.\n\n> I'll have a look at the bug in coercion from base ring to Tate algebra you noticed.\n\n\nIt is not a bug in the coercion system. It is the way elements of the Tate algebra are constructed. The `PolyDict` class does a cleaning of zero coefficients in its input.",
    "created_at": "2022-06-19T18:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677812",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>
Replying to [caruso](#comment%3A19):
> Replying to [vdelecroix](#comment%3A16):
> > The main question is : how do we test whether an element is exactly zero in `R` ? `r.precision_absolute() == infinity and r.is_zero()`? I could introduce an attribute `zero_test` in `PolyDict` to make this check consistently.

> 
> I think you can use the method `_is_exact_zero` for padics.


Thanks. Though very specific to p-adics. And it does not exist for power series.

> I'll have a look at the bug in coercion from base ring to Tate algebra you noticed.


It is not a bug in the coercion system. It is the way elements of the Tate algebra are constructed. The `PolyDict` class does a cleaning of zero coefficients in its input.



---

archive/issue_comments_677813.json:
```json
{
    "body": "<a id='comment:21'></a>\nAs far as this ticket is concerned there is an easy way out : leave simplification of zero coefficients in `PolyDict` to the user (via the `PolyDict.remove_zeros` method). This will solve the construction issues with Tate algebra.\n\nI opened ticket #34024 to fix polynomials.",
    "created_at": "2022-06-19T18:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677813",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>
As far as this ticket is concerned there is an easy way out : leave simplification of zero coefficients in `PolyDict` to the user (via the `PolyDict.remove_zeros` method). This will solve the construction issues with Tate algebra.

I opened ticket #34024 to fix polynomials.



---

archive/issue_comments_677814.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[680f8e0](https://git.sagemath.org/sage.git/commit/?id=680f8e0b4671b0a877e818bcd5590da29473319c)|`34000: do not simplify zero coefficients in PolyDict`|",
    "created_at": "2022-06-19T19:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677814",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[680f8e0](https://git.sagemath.org/sage.git/commit/?id=680f8e0b4671b0a877e818bcd5590da29473319c)|`34000: do not simplify zero coefficients in PolyDict`|



---

archive/issue_comments_677815.json:
```json
{
    "body": "Changing commit from \"fae4a257a688f9bbc731bf361e84c6f990a50c63\" to \"680f8e0b4671b0a877e818bcd5590da29473319c\"",
    "created_at": "2022-06-19T19:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677815",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fae4a257a688f9bbc731bf361e84c6f990a50c63" to "680f8e0b4671b0a877e818bcd5590da29473319c"



---

archive/issue_comments_677816.json:
```json
{
    "body": "<a id='comment:23'></a>\n`@`Xavier Caruso Even with [This is the Trac macro *comment:21* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:21-macro) implemented I got the following failure\n\n```\nsage -t --random-seed=31078045756822634162710736872151007113 tate_algebra_ideal.pyx\n**********************************************************************\nFile \"tate_algebra_ideal.pyx\", line 857, in sage.rings.tate_algebra_ideal.groebner_basis_pote\nFailed example:\n    I.groebner_basis(algorithm=\"PoTe\", prec=100)  # indirect doctest\nExpected:\n    [...0000000001*x^3 + ...2222222222*y + ...000000000*x^2*y^2 + O(3^99 * <x, y>),\n     ...0000000001*x^2*y + ...01210121020 + O(3^100 * <x, y>),\n     ...0000000001*y^2 + ...01210121020*x + ...000000000*x^2*y^3 + ...0000000000*x^3*y + O(3^99 * <x, y>)]\nGot:\n    [...0000000001*x^3 + ...2222222222*y + ...000000000*x^2*y^2 + O(3^99 * <x, y>),\n     ...0000000001*x^2*y + ...01210121020 + O(3^100 * <x, y>),\n     ...0000000001*y^2 + ...01210121020*x + ...0000000000*x^3*y + O(3^99 * <x, y>)]\n**********************************************************************\nFile \"tate_algebra_ideal.pyx\", line 1104, in sage.rings.tate_algebra_ideal.groebner_basis_vapote\nFailed example:\n    I.groebner_basis(algorithm=\"VaPoTe\", prec=100)  # indirect doctest\nExpected:\n    [...0000000001*x^3 + ...2222222222*y + ...000000000*x^2*y^2 + O(3^99 * <x, y>),\n     ...0000000001*x^2*y + ...01210121020 + O(3^100 * <x, y>),\n     ...0000000001*y^2 + ...01210121020*x + ...000000000*x^2*y^3 + ...0000000000*x^3*y + O(3^99 * <x, y>)]\nGot:\n    [...0000000001*x^3 + ...2222222222*y + ...000000000*x^2*y^2 + O(3^99 * <x, y>),\n     ...0000000001*x^2*y + ...01210121020 + O(3^100 * <x, y>),\n     ...0000000001*y^2 + ...01210121020*x + ...0000000000*x^3*y + O(3^99 * <x, y>)]\n**********************************************************************\n2 items had failures:\n   1 of   9 in sage.rings.tate_algebra_ideal.groebner_basis_pote\n   1 of  10 in sage.rings.tate_algebra_ideal.groebner_basis_vapote\n    [126 tests, 2 failures, 3.46 s]\n```\n\nAlso, it did not magically fix [This is the Trac macro *comment:16* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:16-macro) since Tate algebras use multivariate polynomials over p-adic rings...",
    "created_at": "2022-06-19T19:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677816",
    "user": "https://github.com/videlec"
}
```

<a id='comment:23'></a>
`@`Xavier Caruso Even with [This is the Trac macro *comment:21* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:21-macro) implemented I got the following failure

```
sage -t --random-seed=31078045756822634162710736872151007113 tate_algebra_ideal.pyx
**********************************************************************
File "tate_algebra_ideal.pyx", line 857, in sage.rings.tate_algebra_ideal.groebner_basis_pote
Failed example:
    I.groebner_basis(algorithm="PoTe", prec=100)  # indirect doctest
Expected:
    [...0000000001*x^3 + ...2222222222*y + ...000000000*x^2*y^2 + O(3^99 * <x, y>),
     ...0000000001*x^2*y + ...01210121020 + O(3^100 * <x, y>),
     ...0000000001*y^2 + ...01210121020*x + ...000000000*x^2*y^3 + ...0000000000*x^3*y + O(3^99 * <x, y>)]
Got:
    [...0000000001*x^3 + ...2222222222*y + ...000000000*x^2*y^2 + O(3^99 * <x, y>),
     ...0000000001*x^2*y + ...01210121020 + O(3^100 * <x, y>),
     ...0000000001*y^2 + ...01210121020*x + ...0000000000*x^3*y + O(3^99 * <x, y>)]
**********************************************************************
File "tate_algebra_ideal.pyx", line 1104, in sage.rings.tate_algebra_ideal.groebner_basis_vapote
Failed example:
    I.groebner_basis(algorithm="VaPoTe", prec=100)  # indirect doctest
Expected:
    [...0000000001*x^3 + ...2222222222*y + ...000000000*x^2*y^2 + O(3^99 * <x, y>),
     ...0000000001*x^2*y + ...01210121020 + O(3^100 * <x, y>),
     ...0000000001*y^2 + ...01210121020*x + ...000000000*x^2*y^3 + ...0000000000*x^3*y + O(3^99 * <x, y>)]
Got:
    [...0000000001*x^3 + ...2222222222*y + ...000000000*x^2*y^2 + O(3^99 * <x, y>),
     ...0000000001*x^2*y + ...01210121020 + O(3^100 * <x, y>),
     ...0000000001*y^2 + ...01210121020*x + ...0000000000*x^3*y + O(3^99 * <x, y>)]
**********************************************************************
2 items had failures:
   1 of   9 in sage.rings.tate_algebra_ideal.groebner_basis_pote
   1 of  10 in sage.rings.tate_algebra_ideal.groebner_basis_vapote
    [126 tests, 2 failures, 3.46 s]
```

Also, it did not magically fix [This is the Trac macro *comment:16* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:16-macro) since Tate algebras use multivariate polynomials over p-adic rings...



---

archive/issue_comments_677817.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [vdelecroix](#comment%3A23):\n> `@`Xavier Caruso Even with [This is the Trac macro *comment:21* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:21-macro) implemented I got the following failure\n\n\nHmm. Difficult to say what is the correct answer.\nI'll try to investigate this more but maybe, the easiest fix is to change the doctest.",
    "created_at": "2022-06-20T08:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677817",
    "user": "https://github.com/xcaruso"
}
```

<a id='comment:24'></a>
Replying to [vdelecroix](#comment%3A23):
> `@`Xavier Caruso Even with [This is the Trac macro *comment:21* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#comment:21-macro) implemented I got the following failure


Hmm. Difficult to say what is the correct answer.
I'll try to investigate this more but maybe, the easiest fix is to change the doctest.



---

archive/issue_comments_677818.json:
```json
{
    "body": "Changing commit from \"680f8e0b4671b0a877e818bcd5590da29473319c\" to \"52c5a25197b4de018007c15bfa8fac51686c9924\"",
    "created_at": "2022-08-12T16:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677818",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "680f8e0b4671b0a877e818bcd5590da29473319c" to "52c5a25197b4de018007c15bfa8fac51686c9924"



---

archive/issue_comments_677819.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n|                                                                                                                                           |                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[54bacfb](https://git.sagemath.org/sage.git/commit/?id=54bacfb67874aa9264e3e8e7ee4abbd768daad49)|`34000: clarify RuntimeError`|\n|[1f08c97](https://git.sagemath.org/sage.git/commit/?id=1f08c970f15f52507b755ee3a1183f99d2c4fec5)|`34000: two little optimizations`|\n|[e597bd7](https://git.sagemath.org/sage.git/commit/?id=e597bd7a9e322a50cf3f663b2463bd659159e981)|`34000: replace RuntimeError with assertion`|\n|[b6eb9e5](https://git.sagemath.org/sage.git/commit/?id=b6eb9e54a4863a5b6c0194abc2d9abe590666967)|`34000: fix Polydict.homogenize and ETuple.eadd_p`|\n|[5966dc3](https://git.sagemath.org/sage.git/commit/?id=5966dc3250211b5ff627e14142890176819cf99a)|`34000: fix zero coefficient in PolyDict.homogenize`|\n|[0c026ec](https://git.sagemath.org/sage.git/commit/?id=0c026ec8f4016a7eb9a360acae398abd380059ad)|`34000: make a copy of input in PolyDict.__init__`|\n|[5e0aa5c](https://git.sagemath.org/sage.git/commit/?id=5e0aa5c39517624d2707f4e13369b164283b56b3)|`34000: do not simplify zero coefficients in PolyDict`|\n|[49e78f9](https://git.sagemath.org/sage.git/commit/?id=49e78f99405bea5fc75237f36749ee1024f4e0dc)|`34000: fix doctest in multi_polynomial.pyx`|\n|[a19ca7c](https://git.sagemath.org/sage.git/commit/?id=a19ca7cf2e9db5fae7aa3c85de5f5de003f65200)|`34000: change tate algebras doctests`|\n|[52c5a25](https://git.sagemath.org/sage.git/commit/?id=52c5a25197b4de018007c15bfa8fac51686c9924)|`34000: doc details`|",
    "created_at": "2022-08-12T16:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677819",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
|                                                                                                                                           |                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[54bacfb](https://git.sagemath.org/sage.git/commit/?id=54bacfb67874aa9264e3e8e7ee4abbd768daad49)|`34000: clarify RuntimeError`|
|[1f08c97](https://git.sagemath.org/sage.git/commit/?id=1f08c970f15f52507b755ee3a1183f99d2c4fec5)|`34000: two little optimizations`|
|[e597bd7](https://git.sagemath.org/sage.git/commit/?id=e597bd7a9e322a50cf3f663b2463bd659159e981)|`34000: replace RuntimeError with assertion`|
|[b6eb9e5](https://git.sagemath.org/sage.git/commit/?id=b6eb9e54a4863a5b6c0194abc2d9abe590666967)|`34000: fix Polydict.homogenize and ETuple.eadd_p`|
|[5966dc3](https://git.sagemath.org/sage.git/commit/?id=5966dc3250211b5ff627e14142890176819cf99a)|`34000: fix zero coefficient in PolyDict.homogenize`|
|[0c026ec](https://git.sagemath.org/sage.git/commit/?id=0c026ec8f4016a7eb9a360acae398abd380059ad)|`34000: make a copy of input in PolyDict.__init__`|
|[5e0aa5c](https://git.sagemath.org/sage.git/commit/?id=5e0aa5c39517624d2707f4e13369b164283b56b3)|`34000: do not simplify zero coefficients in PolyDict`|
|[49e78f9](https://git.sagemath.org/sage.git/commit/?id=49e78f99405bea5fc75237f36749ee1024f4e0dc)|`34000: fix doctest in multi_polynomial.pyx`|
|[a19ca7c](https://git.sagemath.org/sage.git/commit/?id=a19ca7cf2e9db5fae7aa3c85de5f5de003f65200)|`34000: change tate algebras doctests`|
|[52c5a25](https://git.sagemath.org/sage.git/commit/?id=52c5a25197b4de018007c15bfa8fac51686c9924)|`34000: doc details`|



---

archive/issue_comments_677820.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-08-12T16:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677820",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_677821.json:
```json
{
    "body": "<a id='comment:26'></a>\nrebased on 9.7.beta8 and failing doctests modified",
    "created_at": "2022-08-12T16:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677821",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>
rebased on 9.7.beta8 and failing doctests modified



---

archive/issue_comments_677822.json:
```json
{
    "body": "<a id='comment:27'></a>\ngreen bot",
    "created_at": "2022-08-13T06:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677822",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>
green bot



---

archive/issue_comments_677823.json:
```json
{
    "body": "<a id='comment:28'></a>\nI think some timings are needed here before a positive review to see what sort of speed regressions we incur because we no longer have the option to turn off certain features and checks.\n\nWhy is addition the only operation that gets a special in-place operation? I think it would be good to make this universal.\n\nIt is generally not a good ideal to check `if type(e) is not ETuple:`. I understand this is faster than `isinstance(e, ETuple)`, but it is less future-proof if someone subclasses `ETuple`.\n\nNaively coverage seems to have decreased; e.g., `__len__` no longer has documentation. It is a bit of a misdirect that the coverage has increased as it is just total percentage.",
    "created_at": "2022-08-16T06:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34000#issuecomment-677823",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>
I think some timings are needed here before a positive review to see what sort of speed regressions we incur because we no longer have the option to turn off certain features and checks.

Why is addition the only operation that gets a special in-place operation? I think it would be good to make this universal.

It is generally not a good ideal to check `if type(e) is not ETuple:`. I understand this is faster than `isinstance(e, ETuple)`, but it is less future-proof if someone subclasses `ETuple`.

Naively coverage seems to have decreased; e.g., `__len__` no longer has documentation. It is a bit of a misdirect that the coverage has increased as it is just total percentage.



---

archive/issue_events_089012.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34000",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34000#event-89012"
}
```
