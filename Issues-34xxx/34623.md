# Issue 34623: Fix broken gitpod

archive/issues_034386.json:
```json
{
    "body": "as reported in https://groups.google.com/g/sage-devel/c/JIiytzMsLCU\n\nHere we \n- improve error handling in the gitpod initialization scripts that eliminates the guesswork when something goes wrong \n- fix a mistake in the system package information for conda\n\n\nCC:  @soehms @dimpase @tobiasdiez\n\nBranch/Commit: 8b1063c23912dc4f6cc5b53f4c929f8f87148183\n\nReviewer: Tobias Diez\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34623\n\n",
    "closed_at": "2022-10-11T09:14:59Z",
    "created_at": "2022-10-01T16:35:08Z",
    "labels": [
        "component: build",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Fix broken gitpod",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34623",
    "user": "https://github.com/mkoeppe"
}
```
as reported in https://groups.google.com/g/sage-devel/c/JIiytzMsLCU

Here we 
- improve error handling in the gitpod initialization scripts that eliminates the guesswork when something goes wrong 
- fix a mistake in the system package information for conda


CC:  @soehms @dimpase @tobiasdiez

Branch/Commit: 8b1063c23912dc4f6cc5b53f4c929f8f87148183

Reviewer: Tobias Diez

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34623





---

archive/issue_comments_689244.json:
```json
{
    "body": "<a id='comment:1'></a>The conda environment creation fails (`mamba env create ...`, see .gitpod.yml \"init\" task)\n\n```\n(base) gitpod@sagemath-sagetracmirror-6rgcwwh5cer:/workspace/sagetrac-mirror$ mamba env create --file src/environment-dev.yml --prefix venv\nconda-forge/noarch                                   9.4MB @   3.0MB/s  3.2s\nconda-forge/linux-64                                25.7MB @   4.4MB/s  6.0s\n\n\nLooking for: ['compilers', 'make', 'm4', 'perl', 'python', 'tar', 'bc', 'pkg-config', 'appdirs', 'arb', 'boost-cpp', 'brial', 'bzip2', 'cddlib', 'cliquer', 'cmake', 'curl', 'distlib', 'ecl', 'eclib', 'ecm', 'fflas-ffpack', 'filelock', 'libflint', 'flintqs', 'fplll', 'freetype', 'bdw-gc', 'gengetopt', 'gf2x', 'gfan', 'fortran-compiler', 'giac', 'givaro', 'glpk', 'gmp', 'gsl', 'iml', 'lcalc', 'libatomic_ops', 'libbraiding', 'libffi', 'libgd', 'libhomfly', 'xz', 'libpng', 'linbox', 'lrcalc', 'm4ri', 'm4rie', 'mpc', 'mpfi', 'mpfr', 'nauty', 'ncurses', 'ninja', 'ntl', 'openblas', 'blas=2[build=openblas]', 'openssl', 'palp', 'pari=[build=*_pthread]', 'pari-elldata', 'pari-galdata', 'pari-galpol', 'pari-seadata', 'pari-galdata', 'pari-seadata-small', 'patch', 'pcre', 'pkg-config', 'planarity', 'ppl', 'primecount', 'primesieve', 'qhull', 'r', 'r-essentials', 'readline', 'rw', 'singular', 'sqlite', 'suitesparse', 'symmetrica', 'sympow', 'tachyon', 'toml', 'tox', 'virtualenv', 'xz', 'zeromq', 'zlib', 'zn_poly', 'autoconf', 'automake', 'libtool', 'alabaster', 'appnope', 'argon2-cffi', 'asttokens', 'attrs', 'babel', 'backcall', 'backports.zoneinfo', 'beautifulsoup4', 'beniget', 'bleach', 'certifi', 'cffi', 'charset-normalizer', 'sagemath-db-combinatorial-designs', 'sagemath-db-conway-polynomials', 'cppy', 'cvxopt', 'cycler', 'cypari2', 'cysignals', 'cython', 'python-dateutil', 'decorator', 'defusedxml', 'deprecation', 'docutils', 'editables', 'sagemath-db-elliptic-curves', 'entrypoints', 'executing', 'python-fastjsonschema', 'flit-core', 'fonttools', 'fpylll', 'furo', 'gap-defaults', 'gast', 'gmpy2', 'sagemath-db-graphs', 'hatchling', 'html5lib', 'idna', 'imagesize', 'importlib_metadata', 'importlib-resources', 'ipykernel', 'ipython', 'ipython_genutils', 'ipywidgets', 'jedi', 'jinja2', 'jmol', 'jsonschema', 'jupyter_client', 'jupyter_core', 'jupyter-jsmol', 'jupyter-packaging', 'jupyter_sphinx', 'jupyterlab_pygments', 'kiwisolver', 'python-lrcalc', 'markupsafe', 'mathjax', \"matplotlib[version='>=3.5.1']\", 'matplotlib-inline', 'maxima', 'memory-allocator', 'mistune', 'mpmath', 'nbclient', 'nbconvert', 'nbformat', 'nest-asyncio', 'networkx', 'notebook', 'numpy', 'packaging', 'pandocfilters', 'parso', 'pathspec', 'pexpect', 'pickleshare', 'pillow', 'pip', 'pkgconfig', 'platformdirs', 'pluggy', 'ply', 'poetry-core', 'sagemath-db-polytopes', 'pplpy', 'primecountpy', 'prometheus_client', 'prompt_toolkit', 'ptyprocess', 'pure_eval', 'py', 'pybind11', 'pycparser', 'pygments', 'pyparsing', 'pyrsistent', 'pythran', 'pytz', 'pytz-deprecation-shim', 'pyzmq', 'requests', 'rpy2', 'sagetex', 'scipy', 'send2trash', \"setuptools[version='<64']\", 'setuptools_scm', 'setuptools-scm-git-archive', 'simplegeneric', 'six', 'snowballstemmer', 'soupsieve', 'sphinx', 'sphinxcontrib-applehelp', 'sphinxcontrib-devhelp', 'sphinxcontrib-htmlhelp', 'sphinxcontrib-jsmath', 'sphinxcontrib-qthelp', 'sphinxcontrib-serializinghtml', 'sphinxcontrib-websupport', 'stack_data', 'sympy', 'terminado', 'threejs-sage=122', 'tinycss2', 'tomli', 'tomlkit', 'tornado', 'traitlets', 'typing_extensions', 'tzdata', 'tzlocal', 'urllib3', 'vcversioner', 'wcwidth', 'webencodings', 'wheel', 'widgetsnbextension', 'zipp', 'openssh', 'pycodestyle', 'esbonio', 'git']\n\n\nEncountered problems while solving:\n  - nothing provides requested setuptools-scm-git-archive\n\n```",
    "created_at": "2022-10-01T16:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689244",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>The conda environment creation fails (`mamba env create ...`, see .gitpod.yml "init" task)

```
(base) gitpod@sagemath-sagetracmirror-6rgcwwh5cer:/workspace/sagetrac-mirror$ mamba env create --file src/environment-dev.yml --prefix venv
conda-forge/noarch                                   9.4MB @   3.0MB/s  3.2s
conda-forge/linux-64                                25.7MB @   4.4MB/s  6.0s


Looking for: ['compilers', 'make', 'm4', 'perl', 'python', 'tar', 'bc', 'pkg-config', 'appdirs', 'arb', 'boost-cpp', 'brial', 'bzip2', 'cddlib', 'cliquer', 'cmake', 'curl', 'distlib', 'ecl', 'eclib', 'ecm', 'fflas-ffpack', 'filelock', 'libflint', 'flintqs', 'fplll', 'freetype', 'bdw-gc', 'gengetopt', 'gf2x', 'gfan', 'fortran-compiler', 'giac', 'givaro', 'glpk', 'gmp', 'gsl', 'iml', 'lcalc', 'libatomic_ops', 'libbraiding', 'libffi', 'libgd', 'libhomfly', 'xz', 'libpng', 'linbox', 'lrcalc', 'm4ri', 'm4rie', 'mpc', 'mpfi', 'mpfr', 'nauty', 'ncurses', 'ninja', 'ntl', 'openblas', 'blas=2[build=openblas]', 'openssl', 'palp', 'pari=[build=*_pthread]', 'pari-elldata', 'pari-galdata', 'pari-galpol', 'pari-seadata', 'pari-galdata', 'pari-seadata-small', 'patch', 'pcre', 'pkg-config', 'planarity', 'ppl', 'primecount', 'primesieve', 'qhull', 'r', 'r-essentials', 'readline', 'rw', 'singular', 'sqlite', 'suitesparse', 'symmetrica', 'sympow', 'tachyon', 'toml', 'tox', 'virtualenv', 'xz', 'zeromq', 'zlib', 'zn_poly', 'autoconf', 'automake', 'libtool', 'alabaster', 'appnope', 'argon2-cffi', 'asttokens', 'attrs', 'babel', 'backcall', 'backports.zoneinfo', 'beautifulsoup4', 'beniget', 'bleach', 'certifi', 'cffi', 'charset-normalizer', 'sagemath-db-combinatorial-designs', 'sagemath-db-conway-polynomials', 'cppy', 'cvxopt', 'cycler', 'cypari2', 'cysignals', 'cython', 'python-dateutil', 'decorator', 'defusedxml', 'deprecation', 'docutils', 'editables', 'sagemath-db-elliptic-curves', 'entrypoints', 'executing', 'python-fastjsonschema', 'flit-core', 'fonttools', 'fpylll', 'furo', 'gap-defaults', 'gast', 'gmpy2', 'sagemath-db-graphs', 'hatchling', 'html5lib', 'idna', 'imagesize', 'importlib_metadata', 'importlib-resources', 'ipykernel', 'ipython', 'ipython_genutils', 'ipywidgets', 'jedi', 'jinja2', 'jmol', 'jsonschema', 'jupyter_client', 'jupyter_core', 'jupyter-jsmol', 'jupyter-packaging', 'jupyter_sphinx', 'jupyterlab_pygments', 'kiwisolver', 'python-lrcalc', 'markupsafe', 'mathjax', "matplotlib[version='>=3.5.1']", 'matplotlib-inline', 'maxima', 'memory-allocator', 'mistune', 'mpmath', 'nbclient', 'nbconvert', 'nbformat', 'nest-asyncio', 'networkx', 'notebook', 'numpy', 'packaging', 'pandocfilters', 'parso', 'pathspec', 'pexpect', 'pickleshare', 'pillow', 'pip', 'pkgconfig', 'platformdirs', 'pluggy', 'ply', 'poetry-core', 'sagemath-db-polytopes', 'pplpy', 'primecountpy', 'prometheus_client', 'prompt_toolkit', 'ptyprocess', 'pure_eval', 'py', 'pybind11', 'pycparser', 'pygments', 'pyparsing', 'pyrsistent', 'pythran', 'pytz', 'pytz-deprecation-shim', 'pyzmq', 'requests', 'rpy2', 'sagetex', 'scipy', 'send2trash', "setuptools[version='<64']", 'setuptools_scm', 'setuptools-scm-git-archive', 'simplegeneric', 'six', 'snowballstemmer', 'soupsieve', 'sphinx', 'sphinxcontrib-applehelp', 'sphinxcontrib-devhelp', 'sphinxcontrib-htmlhelp', 'sphinxcontrib-jsmath', 'sphinxcontrib-qthelp', 'sphinxcontrib-serializinghtml', 'sphinxcontrib-websupport', 'stack_data', 'sympy', 'terminado', 'threejs-sage=122', 'tinycss2', 'tomli', 'tomlkit', 'tornado', 'traitlets', 'typing_extensions', 'tzdata', 'tzlocal', 'urllib3', 'vcversioner', 'wcwidth', 'webencodings', 'wheel', 'widgetsnbextension', 'zipp', 'openssh', 'pycodestyle', 'esbonio', 'git']


Encountered problems while solving:
  - nothing provides requested setuptools-scm-git-archive

```



---

archive/issue_comments_689245.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/fix_broken_gitpod\"",
    "created_at": "2022-10-01T17:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689245",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/fix_broken_gitpod"



---

archive/issue_comments_689246.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2022-10-01T17:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689246",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_689247.json:
```json
{
    "body": "Changing commit from \"\" to \"cc24ab15c305a6d28237e329521b8c4bbd8ba03f\"",
    "created_at": "2022-10-01T17:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689247",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "cc24ab15c305a6d28237e329521b8c4bbd8ba03f"



---

archive/issue_comments_689248.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-10-01T17:03:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689248",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_689249.json:
```json
{
    "body": "Changing commit from \"cc24ab15c305a6d28237e329521b8c4bbd8ba03f\" to \"ad3a0a7effc1acd7c5204086282ac10af95abb32\"",
    "created_at": "2022-10-01T17:03:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689249",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cc24ab15c305a6d28237e329521b8c4bbd8ba03f" to "ad3a0a7effc1acd7c5204086282ac10af95abb32"



---

archive/issue_comments_689250.json:
```json
{
    "body": "Changing commit from \"ad3a0a7effc1acd7c5204086282ac10af95abb32\" to \"5e738059d8d59774b613192c30be05aa907c1fc7\"",
    "created_at": "2022-10-01T17:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689250",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ad3a0a7effc1acd7c5204086282ac10af95abb32" to "5e738059d8d59774b613192c30be05aa907c1fc7"



---

archive/issue_comments_689251.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-10-01T17:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689251",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_689252.json:
```json
{
    "body": "Changing commit from \"5e738059d8d59774b613192c30be05aa907c1fc7\" to \"40e6f517d74e0463bbc9b6d09462f4178e9a9c47\"",
    "created_at": "2022-10-01T17:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689252",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "5e738059d8d59774b613192c30be05aa907c1fc7" to "40e6f517d74e0463bbc9b6d09462f4178e9a9c47"



---

archive/issue_comments_689253.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-10-01T17:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689253",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_689254.json:
```json
{
    "body": "Changing commit from \"40e6f517d74e0463bbc9b6d09462f4178e9a9c47\" to \"2d8fdae102dcec3fa90cae39156a6aea90931c0f\"",
    "created_at": "2022-10-01T17:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689254",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "40e6f517d74e0463bbc9b6d09462f4178e9a9c47" to "2d8fdae102dcec3fa90cae39156a6aea90931c0f"



---

archive/issue_comments_689255.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-10-01T17:11:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689255",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_689256.json:
```json
{
    "body": "Changing commit from \"2d8fdae102dcec3fa90cae39156a6aea90931c0f\" to \"d1fcd37e784141b5181b5af7ccf0778804386dbb\"",
    "created_at": "2022-10-01T17:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689256",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2d8fdae102dcec3fa90cae39156a6aea90931c0f" to "d1fcd37e784141b5181b5af7ccf0778804386dbb"



---

archive/issue_comments_689257.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-01T17:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689257",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_689258.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,6 @@\n as reported in https://groups.google.com/g/sage-devel/c/JIiytzMsLCU\n+\n+Here we \n+- improve error handling in the gitpod initialization scripts that eliminates the guesswork when something goes wrong \n+- fix a mistake in the system package information for conda\n+\n``````\n",
    "created_at": "2022-10-01T17:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689258",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,6 @@
 as reported in https://groups.google.com/g/sage-devel/c/JIiytzMsLCU
+
+Here we 
+- improve error handling in the gitpod initialization scripts that eliminates the guesswork when something goes wrong 
+- fix a mistake in the system package information for conda
+
``````




---

archive/issue_comments_689259.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-10-01T17:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689259",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_689260.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-10-01T17:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689260",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_689261.json:
```json
{
    "body": "Changing commit from \"d1fcd37e784141b5181b5af7ccf0778804386dbb\" to \"9f055b5bc739a0a66caeb6e64acbb1a9dd09fd1b\"",
    "created_at": "2022-10-01T17:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689261",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d1fcd37e784141b5181b5af7ccf0778804386dbb" to "9f055b5bc739a0a66caeb6e64acbb1a9dd09fd1b"



---

archive/issue_comments_689262.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-01T17:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_689263.json:
```json
{
    "body": "<a id='comment:12'></a>Thanks for working on this.\n\n> that eliminates the guesswork when something goes wrong \n\n\nNot sure what guesswork you mean, but the full logs can be found at https://gitpod.io/t/sagemath/sagetrac-mirror-1/prebuilds or directly in the browser if you trigger a prebuild using the magical url.\n\nThe logs (https://gitpod.io/t/sagemath/sagetrac-mirror-1/41eac415-6e5a-41a3-9175-ac2fc463d659) for this branch indicate the following error\n\n```\nThe tasks executed in the prebuild returned a non-zero exit code. headless task failed: exit status 1\n```\nbut I couldn't find which command triggered it.\n\nAnother remark: Not sure if we really want to blow up the root folder by the additional gitpod scripts. Given that they should strongly simplify once we move to github (no extra trac nor ssh treatment will be necessary), I would propose to keep them inline.",
    "created_at": "2022-10-01T17:50:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689263",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:12'></a>Thanks for working on this.

> that eliminates the guesswork when something goes wrong 


Not sure what guesswork you mean, but the full logs can be found at https://gitpod.io/t/sagemath/sagetrac-mirror-1/prebuilds or directly in the browser if you trigger a prebuild using the magical url.

The logs (https://gitpod.io/t/sagemath/sagetrac-mirror-1/41eac415-6e5a-41a3-9175-ac2fc463d659) for this branch indicate the following error

```
The tasks executed in the prebuild returned a non-zero exit code. headless task failed: exit status 1
```
but I couldn't find which command triggered it.

Another remark: Not sure if we really want to blow up the root folder by the additional gitpod scripts. Given that they should strongly simplify once we move to github (no extra trac nor ssh treatment will be necessary), I would propose to keep them inline.



---

archive/issue_comments_689264.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-10-01T17:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689264",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_689265.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [Tobias Diez](#comment%3A12):\n> Thanks for working on this.\n> \n> > that eliminates the guesswork when something goes wrong \n\n> \n> Not sure what guesswork you mean\n\n\nThe one in \u200bhttps://groups.google.com/g/sage-devel/c/JIiytzMsLCU trying to diagnose based on error messages of commands that ran even though an earlier command failed.",
    "created_at": "2022-10-01T17:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689265",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Replying to [Tobias Diez](#comment%3A12):
> Thanks for working on this.
> 
> > that eliminates the guesswork when something goes wrong 

> 
> Not sure what guesswork you mean


The one in ​https://groups.google.com/g/sage-devel/c/JIiytzMsLCU trying to diagnose based on error messages of commands that ran even though an earlier command failed.



---

archive/issue_comments_689266.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [Tobias Diez](#comment%3A12):\n> I would propose to keep them inline.\n\n\nI moved it to separate scripts so that there is proper error handling. Whatever the gitpod folks do with the scripts, normal error handling is not working.",
    "created_at": "2022-10-01T18:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689266",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>Replying to [Tobias Diez](#comment%3A12):
> I would propose to keep them inline.


I moved it to separate scripts so that there is proper error handling. Whatever the gitpod folks do with the scripts, normal error handling is not working.



---

archive/issue_comments_689267.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [Tobias Diez](#comment%3A12):\n> Given that they should strongly simplify once we move to github (no extra trac nor ssh treatment will be necessary)\n\n\nGood point. I'll move that part to a separate script and see if I can keep the other things inline.",
    "created_at": "2022-10-01T18:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689267",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Replying to [Tobias Diez](#comment%3A12):
> Given that they should strongly simplify once we move to github (no extra trac nor ssh treatment will be necessary)


Good point. I'll move that part to a separate script and see if I can keep the other things inline.



---

archive/issue_comments_689268.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-01T18:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689268",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_689269.json:
```json
{
    "body": "Changing commit from \"9f055b5bc739a0a66caeb6e64acbb1a9dd09fd1b\" to \"9b955c0965fbe2969543625e59093e7695ed9f01\"",
    "created_at": "2022-10-01T18:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689269",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9f055b5bc739a0a66caeb6e64acbb1a9dd09fd1b" to "9b955c0965fbe2969543625e59093e7695ed9f01"



---

archive/issue_comments_689270.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-10-01T18:14:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689270",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_689271.json:
```json
{
    "body": "Changing commit from \"9b955c0965fbe2969543625e59093e7695ed9f01\" to \"400b680e3f9e85aee5e79931e518e9af71483f18\"",
    "created_at": "2022-10-01T18:14:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689271",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9b955c0965fbe2969543625e59093e7695ed9f01" to "400b680e3f9e85aee5e79931e518e9af71483f18"



---

archive/issue_comments_689272.json:
```json
{
    "body": "<a id='comment:19'></a>prebuild is still running but looking good",
    "created_at": "2022-10-01T18:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689272",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>prebuild is still running but looking good



---

archive/issue_comments_689273.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-10-01T18:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689273",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_689274.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [Tobias Diez](#comment%3A12):\n> the full logs can be found at https://gitpod.io/t/sagemath/sagetrac-mirror-1/prebuilds or directly in the browser if you trigger a prebuild using the magical url.\n\n\nSure, but a problem is that when starting the gitpod, the terminal did not have enough scrollback, so one could not see the first error.",
    "created_at": "2022-10-01T18:38:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689274",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:20'></a>Replying to [Tobias Diez](#comment%3A12):
> the full logs can be found at https://gitpod.io/t/sagemath/sagetrac-mirror-1/prebuilds or directly in the browser if you trigger a prebuild using the magical url.


Sure, but a problem is that when starting the gitpod, the terminal did not have enough scrollback, so one could not see the first error.



---

archive/issue_comments_689275.json:
```json
{
    "body": "Changing commit from \"400b680e3f9e85aee5e79931e518e9af71483f18\" to \"8b1063c23912dc4f6cc5b53f4c929f8f87148183\"",
    "created_at": "2022-10-01T18:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689275",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "400b680e3f9e85aee5e79931e518e9af71483f18" to "8b1063c23912dc4f6cc5b53f4c929f8f87148183"



---

archive/issue_comments_689276.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-01T18:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689276",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_689277.json:
```json
{
    "body": "<a id='comment:22'></a>Thanks for the quick follow-up. Code looks good to me, gitpod prebuild and actual start are working now again. So good to go.\n\nCould you please open an issue at the gitpod repo with your error handling problem. That should be fixed upstream.",
    "created_at": "2022-10-01T19:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689277",
    "user": "https://github.com/tobiasdiez"
}
```

<a id='comment:22'></a>Thanks for the quick follow-up. Code looks good to me, gitpod prebuild and actual start are working now again. So good to go.

Could you please open an issue at the gitpod repo with your error handling problem. That should be fixed upstream.



---

archive/issue_comments_689278.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Tobias Diez\"",
    "created_at": "2022-10-01T19:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689278",
    "user": "https://github.com/tobiasdiez"
}
```

Changing reviewer from "" to "Tobias Diez"



---

archive/issue_comments_689279.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-10-01T19:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689279",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_689280.json:
```json
{
    "body": "<a id='comment:23'></a>Thanks!",
    "created_at": "2022-10-01T20:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689280",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>Thanks!



---

archive/issue_comments_689281.json:
```json
{
    "body": "<a id='comment:24'></a>I've opened https://github.com/gitpod-io/gitpod/issues/13508",
    "created_at": "2022-10-01T20:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689281",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>I've opened https://github.com/gitpod-io/gitpod/issues/13508



---

archive/issue_comments_689282.json:
```json
{
    "body": "<a id='comment:25'></a>Thank you for fixing this immediately!\n\nJust to understand why it worked in former versions: The error has been triggered by the presence of `build/pkgs/setuptools_scm_git_archive/distros/conda.txt` which has been introduced recently in #33613, right?",
    "created_at": "2022-10-04T06:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689282",
    "user": "https://github.com/soehms"
}
```

<a id='comment:25'></a>Thank you for fixing this immediately!

Just to understand why it worked in former versions: The error has been triggered by the presence of `build/pkgs/setuptools_scm_git_archive/distros/conda.txt` which has been introduced recently in #33613, right?



---

archive/issue_comments_689283.json:
```json
{
    "body": "<a id='comment:26'></a>Yes, that's right. It's a mistake I made in that ticket - that conda package does exist, but only in the default channel, not in the conda-forge channel.",
    "created_at": "2022-10-04T21:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689283",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>Yes, that's right. It's a mistake I made in that ticket - that conda package does exist, but only in the default channel, not in the conda-forge channel.



---

archive/issue_comments_689284.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [Matthias K\u00f6ppe](#comment%3A26):\n> Yes, that's right. It's a mistake I made in that ticket - that conda package does exist, but only in the default channel, not in the conda-forge channel. \n\nI see. Thanks!",
    "created_at": "2022-10-05T06:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689284",
    "user": "https://github.com/soehms"
}
```

<a id='comment:27'></a>Replying to [Matthias Köppe](#comment%3A26):
> Yes, that's right. It's a mistake I made in that ticket - that conda package does exist, but only in the default channel, not in the conda-forge channel. 

I see. Thanks!



---

archive/issue_events_089693.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-11T09:14:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34623#event-89693"
}
```



---

archive/issue_comments_689285.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/fix_broken_gitpod\" to \"8b1063c23912dc4f6cc5b53f4c929f8f87148183\"",
    "created_at": "2022-10-11T09:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689285",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/fix_broken_gitpod" to "8b1063c23912dc4f6cc5b53f4c929f8f87148183"



---

archive/issue_comments_689286.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-10-11T09:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34623#issuecomment-689286",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
