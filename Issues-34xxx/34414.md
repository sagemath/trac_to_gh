# Issue 34414: Add `multivariate_interpolation` for multivariate polynomial rings

archive/issues_034414.json:
```json
{
    "body": "Assignee: @jbirnick\n\nCC:  @schmittj @videlec\n\nKeywords: interpolation, polynomials\n\nWe add a method `multivariate_interpolation` to the `MPolynomialRing_base` class.\n\nGiven a bound on the degree and either point/value pairs or a function, it returns the respective interpolation polynomial.\n\nIssue created by migration from https://trac.sagemath.org/ticket/34651\n\n",
    "closed_at": "2022-11-07T20:25:50Z",
    "created_at": "2022-10-12T16:15:29Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Add `multivariate_interpolation` for multivariate polynomial rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34414",
    "user": "https://github.com/jbirnick"
}
```
Assignee: @jbirnick

CC:  @schmittj @videlec

Keywords: interpolation, polynomials

We add a method `multivariate_interpolation` to the `MPolynomialRing_base` class.

Given a bound on the degree and either point/value pairs or a function, it returns the respective interpolation polynomial.

Issue created by migration from https://trac.sagemath.org/ticket/34651





---

archive/issue_comments_486983.json:
```json
{
    "body": "Set assignee to @jbirnick.",
    "created_at": "2022-10-12T16:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486983",
    "user": "https://github.com/jbirnick"
}
```

Set assignee to @jbirnick.



---

archive/issue_comments_486984.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-10-12T16:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486984",
    "user": "https://github.com/jbirnick"
}
```

New commits:



---

archive/issue_comments_486985.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-13T10:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486985",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486986.json:
```json
{
    "body": "The ticket is now ready for review.\n\nAs this is my first ever [SageMath](SageMath) contribution, I also want to ask the following questions:\n\n1. Is my way/style of importing correct? Or should I do it differently?                                                                   \n2. I use internal functions, i.e. functions defined inside a function. Is this fine as it is or should I rename them with an underscore in front?\n3. Is my way of reporting a warning good or is there a better/\"sage-style\" way?\n\nAlso: The status badge says the linting doesn't pass... however from the log I can't really see what is going wrong.",
    "created_at": "2022-10-13T10:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486986",
    "user": "https://github.com/jbirnick"
}
```

The ticket is now ready for review.

As this is my first ever [SageMath](SageMath) contribution, I also want to ask the following questions:

1. Is my way/style of importing correct? Or should I do it differently?                                                                   
2. I use internal functions, i.e. functions defined inside a function. Is this fine as it is or should I rename them with an underscore in front?
3. Is my way of reporting a warning good or is there a better/"sage-style" way?

Also: The status badge says the linting doesn't pass... however from the log I can't really see what is going wrong.



---

archive/issue_comments_486987.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-10-13T10:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486987",
    "user": "https://github.com/jbirnick"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_486988.json:
```json
{
    "body": "Mathematically the code looks very good to me, it has extensive documentation and - from what I can see - it follows the established code conventions for [SageMath](SageMath). So I am happy to give an informal positive review, but it would be good if someone more familiar with Sage would have another look.",
    "created_at": "2022-10-18T09:21:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486988",
    "user": "https://github.com/schmittj"
}
```

Mathematically the code looks very good to me, it has extensive documentation and - from what I can see - it follows the established code conventions for [SageMath](SageMath). So I am happy to give an informal positive review, but it would be good if someone more familiar with Sage would have another look.



---

archive/issue_comments_486989.json:
```json
{
    "body": "Welcome to Sage, this looks like a great first patch!\n\nSome comments regarding the docstring formatting (according to the usual Sage conventions):\n\n- Use backticks ` instead of quotes \" around variable names inside the text. This will make the HTML documentation render it as code.\n- In general, double colons `::` are used if and only if the following block is indented; use a single colon `:` otherwise.\n- `NOTE:` \u2192 `.. NOTE::`\n- `WARNING::` \u2192 `.. WARNING::`\n- `SEEALSO:` \u2192 `.. SEEALSO::`, and insert another blank line after.\n- Do not indent the `ALGORITHM:` block.\n- No need to indent the enumerated lists either.\n- `a evaluable function` \u2192 `an evaluable function`, or maybe drop the articles \"a\" altogether in that list.\n\nI'm also wondering if the method should just be called `interpolation()`: the \"multivariate\" part follows from its class.",
    "created_at": "2022-10-19T17:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486989",
    "user": "https://github.com/yyyyx4"
}
```

Welcome to Sage, this looks like a great first patch!

Some comments regarding the docstring formatting (according to the usual Sage conventions):

- Use backticks ` instead of quotes " around variable names inside the text. This will make the HTML documentation render it as code.
- In general, double colons `::` are used if and only if the following block is indented; use a single colon `:` otherwise.
- `NOTE:` → `.. NOTE::`
- `WARNING::` → `.. WARNING::`
- `SEEALSO:` → `.. SEEALSO::`, and insert another blank line after.
- Do not indent the `ALGORITHM:` block.
- No need to indent the enumerated lists either.
- `a evaluable function` → `an evaluable function`, or maybe drop the articles "a" altogether in that list.

I'm also wondering if the method should just be called `interpolation()`: the "multivariate" part follows from its class.



---

archive/issue_comments_486990.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-19T19:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486991.json:
```json
{
    "body": "Thanks for your feedback! I have fixed the points you mentioned.\n\nConcerning the function name: `interpolation()` is certainly better for users to find the function. However I wanted to somehow make clear that the `lagrange_polynomial()` (for univariate poly rings) and `multivariate_interpolation()` (for multivariate poly rings) are different functions that also have different speed etc., and then only work for one or multiple variables, respectively.\n\nIn the end you are the Sage experts, so I'll call it whatever you all think is best, just let me know.",
    "created_at": "2022-10-19T19:05:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486991",
    "user": "https://github.com/jbirnick"
}
```

Thanks for your feedback! I have fixed the points you mentioned.

Concerning the function name: `interpolation()` is certainly better for users to find the function. However I wanted to somehow make clear that the `lagrange_polynomial()` (for univariate poly rings) and `multivariate_interpolation()` (for multivariate poly rings) are different functions that also have different speed etc., and then only work for one or multiple variables, respectively.

In the end you are the Sage experts, so I'll call it whatever you all think is best, just let me know.



---

archive/issue_comments_486992.json:
```json
{
    "body": "Sorry, I got it wrong: Single backticks are for math and double backticks are for code. There are definitely too many similar-but-different markup languages out there. So, for example:\n\n```\n        * ``function`` -- evaluable function in `n` variables, where `n` is the\n          number of variables of the polynomial ring\n```\n\nI also seem to recall that Sage has a preference for formatting exceptions in accordance with Python's own style, i.e., starting with a lowercase letter and omitting the final punctuation, but I can't find a reference for this right now.\n\nThe warning about non-uniqueness of the solution can be useful, but I think it can also be very annoying: Imagine running this in a loop and getting spammed with an endless stream of those messages. Perhaps a cleaner way would be to instead introduce an optional keyword argument to additionally return a basis of the vector space of polynomials which evaluate to zero at the interpolation points? Users who wish to ensure uniqueness can then simply check that this basis is an empty list. (If you dislike this suggestion, we should think of some other way for users to silence the warning if desired.)",
    "created_at": "2022-10-20T05:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486992",
    "user": "https://github.com/yyyyx4"
}
```

Sorry, I got it wrong: Single backticks are for math and double backticks are for code. There are definitely too many similar-but-different markup languages out there. So, for example:

```
        * ``function`` -- evaluable function in `n` variables, where `n` is the
          number of variables of the polynomial ring
```

I also seem to recall that Sage has a preference for formatting exceptions in accordance with Python's own style, i.e., starting with a lowercase letter and omitting the final punctuation, but I can't find a reference for this right now.

The warning about non-uniqueness of the solution can be useful, but I think it can also be very annoying: Imagine running this in a loop and getting spammed with an endless stream of those messages. Perhaps a cleaner way would be to instead introduce an optional keyword argument to additionally return a basis of the vector space of polynomials which evaluate to zero at the interpolation points? Users who wish to ensure uniqueness can then simply check that this basis is an empty list. (If you dislike this suggestion, we should think of some other way for users to silence the warning if desired.)



---

archive/issue_comments_486993.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-20T18:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486993",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_486994.json:
```json
{
    "body": "I have fixed the markup.\n\n**Exceptions formatting:** I have scrolled the Sage source and saw both, so I'm not sure. I personally prefer full sentences, so I kept it like that. However if there is any convention, I'll change it.\n\n**Warnings/non-uniqueness:** Isn't the point that warnings are posted via a special warnings class? So people who don't want to see them should be able to somehow supress them. At least that looks like the clean solution to me. *However*, I wanted to imitate the behavior of `M.solve_right(v)`, so I checked what this does. And it doesn't give a warning at all, so I deleted my warning completely.\n(Though personally I would prefer warnings.. maybe in a future ticket.)",
    "created_at": "2022-10-20T18:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486994",
    "user": "https://github.com/jbirnick"
}
```

I have fixed the markup.

**Exceptions formatting:** I have scrolled the Sage source and saw both, so I'm not sure. I personally prefer full sentences, so I kept it like that. However if there is any convention, I'll change it.

**Warnings/non-uniqueness:** Isn't the point that warnings are posted via a special warnings class? So people who don't want to see them should be able to somehow supress them. At least that looks like the clean solution to me. *However*, I wanted to imitate the behavior of `M.solve_right(v)`, so I checked what this does. And it doesn't give a warning at all, so I deleted my warning completely.
(Though personally I would prefer warnings.. maybe in a future ticket.)



---

archive/issue_comments_486995.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-11-03T06:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486995",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_486996.json:
```json
{
    "body": "Alright, looks good to me then. Thank you!",
    "created_at": "2022-11-03T06:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486996",
    "user": "https://github.com/yyyyx4"
}
```

Alright, looks good to me then. Thank you!



---

archive/issue_comments_486997.json:
```json
{
    "body": "Sorry for being late: wouldn't it be better to call the method just \"interpolation\", or even \"interpolate\"?\n\nThere is a single occurrence of `CALL FORMATS` in sagemath currently, but it seems to me that even there, https://doc.sagemath.org/html/en/reference/matrices/sage/matrix/special.html#sage.matrix.special.ones_matrix, the documentation looks wrong and double backticks should be used:",
    "created_at": "2022-11-03T09:13:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486997",
    "user": "https://github.com/mantepse"
}
```

Sorry for being late: wouldn't it be better to call the method just "interpolation", or even "interpolate"?

There is a single occurrence of `CALL FORMATS` in sagemath currently, but it seems to me that even there, https://doc.sagemath.org/html/en/reference/matrices/sage/matrix/special.html#sage.matrix.special.ones_matrix, the documentation looks wrong and double backticks should be used:



---

archive/issue_comments_486998.json:
```json
{
    "body": "`@`Martin concerning the name of the function, have you seen my previous comment:\n\n> Concerning the function name: interpolation() is certainly better for users to find the function. However I wanted to somehow make clear that the lagrange_polynomial() (for univariate poly rings) and multivariate_interpolation() (for multivariate poly rings) are different functions that also have different speed etc., and that only work for one or multiple variables, respectively.\n\n\nHowever if multiple experienced Sage users want me to change the name, I can do it. Just let me know.\n\nConcerning documentation I didn't get your point.. is there anything wrongly formatted that I should correct?",
    "created_at": "2022-11-03T15:01:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486998",
    "user": "https://github.com/jbirnick"
}
```

`@`Martin concerning the name of the function, have you seen my previous comment:

> Concerning the function name: interpolation() is certainly better for users to find the function. However I wanted to somehow make clear that the lagrange_polynomial() (for univariate poly rings) and multivariate_interpolation() (for multivariate poly rings) are different functions that also have different speed etc., and that only work for one or multiple variables, respectively.


However if multiple experienced Sage users want me to change the name, I can do it. Just let me know.

Concerning documentation I didn't get your point.. is there anything wrongly formatted that I should correct?



---

archive/issue_comments_486999.json:
```json
{
    "body": "I don't quite understand: doesn't this function also work in the univariate case?  I am not an expert, so it might be best to ask on sage-devel (and set the ticket to needs info in the meantime).  Or did you ask already, and I missed it?  In this case, please go ahead!",
    "created_at": "2022-11-04T07:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-486999",
    "user": "https://github.com/mantepse"
}
```

I don't quite understand: doesn't this function also work in the univariate case?  I am not an expert, so it might be best to ask on sage-devel (and set the ticket to needs info in the meantime).  Or did you ask already, and I missed it?  In this case, please go ahead!



---

archive/issue_comments_487000.json:
```json
{
    "body": "This function theoretically works for one variable, but:\n\n1. The class for univariate polynomial rings is a completely different one. I would have to copy (and simplify) the code there, which I don't because:\n2. There already is an interpolation function for one variable (`lagrange_polynomial()`) that works faster.\n\nAll in all the classes for univariate and multivariate polynomial rings are completely different, and the algorithms for interpolation are different as well.\n\nThat's why I thought the names should reflect that. I will change the name to `interpolation()` now, and hope that people will recognize that the appropriate function for one variable is `lagrange_polynomial()`. (I mentioned this function in my documentation.)",
    "created_at": "2022-11-04T19:47:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-487000",
    "user": "https://github.com/jbirnick"
}
```

This function theoretically works for one variable, but:

1. The class for univariate polynomial rings is a completely different one. I would have to copy (and simplify) the code there, which I don't because:
2. There already is an interpolation function for one variable (`lagrange_polynomial()`) that works faster.

All in all the classes for univariate and multivariate polynomial rings are completely different, and the algorithms for interpolation are different as well.

That's why I thought the names should reflect that. I will change the name to `interpolation()` now, and hope that people will recognize that the appropriate function for one variable is `lagrange_polynomial()`. (I mentioned this function in my documentation.)



---

archive/issue_comments_487001.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2022-11-04T19:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-487001",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_487002.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-11-04T19:55:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-487002",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_487003.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-11-05T13:13:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-487003",
    "user": "https://github.com/jbirnick"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_089716.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-11-07T20:25:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34414#event-89716"
}
```



---

archive/issue_comments_487004.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-11-07T20:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34414",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34414#issuecomment-487004",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
