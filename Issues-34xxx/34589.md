# Issue 34589: VectorFieldModule, TensorFieldModule, DiffFormModule: Add methods tensor_product, tensor_power, update category of TensorFieldModule

archive/issues_034352.json:
```json
{
    "body": "... as previously done for `FiniteRankFreeModule` etc.\n\nWe introduce abstract base classes `ReflexiveModule_*` to unify the implementations of `VectorFieldModule`... and `FiniteRankFreeModule`/`VectorFieldFreeModule`...\n\nFollow-up: #34621 Method `dual_pairing` for modules in `sage.tensor`\n\nCC:  @egourgoulhon @tscrim @mjungmath\n\nBranch/Commit: 74601e6a3a42413400b2718ad2fed987028a30ca\n\nReviewer: Eric Gourgoulhon\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34589\n\n",
    "closed_at": "2022-11-15T23:43:08Z",
    "created_at": "2022-09-26T17:14:15Z",
    "labels": [
        "component: manifolds"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "VectorFieldModule, TensorFieldModule, DiffFormModule: Add methods tensor_product, tensor_power, update category of TensorFieldModule",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34589",
    "user": "https://github.com/mkoeppe"
}
```
... as previously done for `FiniteRankFreeModule` etc.

We introduce abstract base classes `ReflexiveModule_*` to unify the implementations of `VectorFieldModule`... and `FiniteRankFreeModule`/`VectorFieldFreeModule`...

Follow-up: #34621 Method `dual_pairing` for modules in `sage.tensor`

CC:  @egourgoulhon @tscrim @mjungmath

Branch/Commit: 74601e6a3a42413400b2718ad2fed987028a30ca

Reviewer: Eric Gourgoulhon

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34589





---

archive/issue_comments_520350.json:
```json
{
    "body": "<a id='comment:3'></a>Probably best to create a class `VectorFieldModule_abstract`\n\n---\nLast 10 new commits:",
    "created_at": "2022-09-26T17:21:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520350",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Probably best to create a class `VectorFieldModule_abstract`

---
Last 10 new commits:



---

archive/issue_comments_520351.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-09-27T02:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520351",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_520352.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-27T21:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520353.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-28T00:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520353",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520354.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-28T00:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520354",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520355.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-28T00:51:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520355",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_520356.json:
```json
{
    "body": "<a id='comment:11'></a>This new base class is of course not very pretty\n\n```\n+class VectorFieldModule_abstract(UniqueRepresentation, Parent):\n+    r\"\"\"\n+    Abstract base class for modules of vector fields.\n+    \"\"\"\n+\n+    tensor_power = FiniteRankFreeModule_abstract.tensor_power\n+\n+    tensor_product = FiniteRankFreeModule_abstract.tensor_product\n+\n+    tensor = FiniteRankFreeModule_abstract.tensor\n```\n\nIt could be better to have a common base class for `VectorFieldModule_abstract` and `FiniteRankFreeModule_abstract`. \n\nPerhaps that could be called `ModuleWithDual_abstract`? (see also #13372)",
    "created_at": "2022-09-29T00:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520356",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>This new base class is of course not very pretty

```
+class VectorFieldModule_abstract(UniqueRepresentation, Parent):
+    r"""
+    Abstract base class for modules of vector fields.
+    """
+
+    tensor_power = FiniteRankFreeModule_abstract.tensor_power
+
+    tensor_product = FiniteRankFreeModule_abstract.tensor_product
+
+    tensor = FiniteRankFreeModule_abstract.tensor
```

It could be better to have a common base class for `VectorFieldModule_abstract` and `FiniteRankFreeModule_abstract`. 

Perhaps that could be called `ModuleWithDual_abstract`? (see also #13372)



---

archive/issue_comments_520357.json:
```json
{
    "body": "<a id='comment:12'></a>Algebra question - do we know / do we assume that a `VectorFieldModule` is reflexive?",
    "created_at": "2022-09-29T00:54:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520357",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>Algebra question - do we know / do we assume that a `VectorFieldModule` is reflexive?



---

archive/issue_comments_520358.json:
```json
{
    "body": "<a id='comment:13'></a>(in this case, we could call it `ReflexiveModule_abstract` - for such modules the pair `tensor_type` makes sense.)",
    "created_at": "2022-09-29T01:32:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520358",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:13'></a>(in this case, we could call it `ReflexiveModule_abstract` - for such modules the pair `tensor_type` makes sense.)



---

archive/issue_comments_520359.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:12 Matthias K\u00f6ppe]:\n> Algebra question - do we know / do we assume that a `VectorFieldModule` is reflexive?\n\nI would say that the vector field modules are indeed reflexive for the cases we can treat with Sage, namely those for which the manifold M can be split into a finite number of parallelizable manifolds N_i, i.e. there is a finite open cover of M, (N_i)_{1\\leq i \\leq p} (p finite), such that for each i, N_i is parallelizable. Let then consider an element f of `X(M)**`, where `X(M)` is the C<sup>oo</sup>(M)-module of vector fields on M. For a in `X(M)*`, f(a) can be reduced to f_i(a_i) on each N_i. Since N_i is parallelizable, X(N_i) is a free module of finite rank and thus reflexive. There exists then a unique v_i in X(N_i) such that f_i(a_i) = a_i(v_i). Then the vector field v in X(M) defined as being equal to v_i on each N_i obeys f(a) = a(v), which shows that the canonical map `X(M) --> X(M)**` is bijective. This is a first quick thought and this should be double checked...",
    "created_at": "2022-09-29T08:55:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520359",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:14'></a>Replying to [comment:12 Matthias Köppe]:
> Algebra question - do we know / do we assume that a `VectorFieldModule` is reflexive?

I would say that the vector field modules are indeed reflexive for the cases we can treat with Sage, namely those for which the manifold M can be split into a finite number of parallelizable manifolds N_i, i.e. there is a finite open cover of M, (N_i)_{1\leq i \leq p} (p finite), such that for each i, N_i is parallelizable. Let then consider an element f of `X(M)**`, where `X(M)` is the C<sup>oo</sup>(M)-module of vector fields on M. For a in `X(M)*`, f(a) can be reduced to f_i(a_i) on each N_i. Since N_i is parallelizable, X(N_i) is a free module of finite rank and thus reflexive. There exists then a unique v_i in X(N_i) such that f_i(a_i) = a_i(v_i). Then the vector field v in X(M) defined as being equal to v_i on each N_i obeys f(a) = a(v), which shows that the canonical map `X(M) --> X(M)**` is bijective. This is a first quick thought and this should be double checked...



---

archive/issue_comments_520360.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:13 Matthias K\u00f6ppe]:\n> (in this case, we could call it `ReflexiveModule_abstract` - for such modules the pair `tensor_type` makes sense.)\n\nIndeed, if we confirm that the vector field modules are reflexive.",
    "created_at": "2022-09-29T12:21:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520360",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:15'></a>Replying to [comment:13 Matthias Köppe]:
> (in this case, we could call it `ReflexiveModule_abstract` - for such modules the pair `tensor_type` makes sense.)

Indeed, if we confirm that the vector field modules are reflexive.



---

archive/issue_comments_520361.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:14 Eric Gourgoulhon]:\n> I would say that the vector field modules are indeed reflexive for the cases we can treat with Sage, namely those for which the manifold M can be split into a finite number of parallelizable manifolds N_i, i.e. there is a finite open cover of M, (N_i)_{1\\leq i \\leq p} (p finite), such that for each i, N_i is parallelizable.\n\n\nIs this splitting into parallelizable manifolds explicitly done somewhere in the code?\n\nI guess a subtlety is that in sage.manifolds a manifold M is thought to be immutable but new submanifolds on it can be declared imperatively. At any point, of course only finitely many submanifolds have been declared in M as a Python object, but it's not clear that M as a mathematical object is really assumed to be covered by only a finite number of parallelizable submanifolds...",
    "created_at": "2022-09-29T18:22:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520361",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>Replying to [comment:14 Eric Gourgoulhon]:
> I would say that the vector field modules are indeed reflexive for the cases we can treat with Sage, namely those for which the manifold M can be split into a finite number of parallelizable manifolds N_i, i.e. there is a finite open cover of M, (N_i)_{1\leq i \leq p} (p finite), such that for each i, N_i is parallelizable.


Is this splitting into parallelizable manifolds explicitly done somewhere in the code?

I guess a subtlety is that in sage.manifolds a manifold M is thought to be immutable but new submanifolds on it can be declared imperatively. At any point, of course only finitely many submanifolds have been declared in M as a Python object, but it's not clear that M as a mathematical object is really assumed to be covered by only a finite number of parallelizable submanifolds...



---

archive/issue_comments_520362.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 Matthias K\u00f6ppe]:\n> Replying to [comment:14 Eric Gourgoulhon]:\n> > I would say that the vector field modules are indeed reflexive for the cases we can treat with Sage, namely those for which the manifold M can be split into a finite number of parallelizable manifolds N_i, i.e. there is a finite open cover of M, (N_i)_{1\\leq i \\leq p} (p finite), such that for each i, N_i is parallelizable.\n\n> \n> Is this splitting into parallelizable manifolds explicitly done somewhere in the code?\n\n\nNot explicitly, but `DifferentiableManifold`'s have the attribute `_parrelizable_parts`; for instance:\n\n```\nsage: M = manifolds.Sphere(2, coordinates='stereographic')\nsage: M._parallelizable_parts\n{Open subset S^2-{NP,SP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3,\n Open subset S^2-{NP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3,\n Open subset S^2-{SP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3}\nsage: M._open_covers\n[[2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3],\n [Open subset S^2-{NP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3,\n  Open subset S^2-{SP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3]]\n```\nActually the parallelizable parts are declared on the fly, in the same spirit as the charts and other structures on the manifod. Even the parallelizable aspect of the manifold can appear quite late after the manifold instanciation. For example, in this [notebook about S^1](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S1.ipynb), the manifold is (implicitly) declared parallelizable only in cell no. 21, by declaring a vector frame on it. This action creates the object X(M) as a `VectorFieldFreeModule`. Previously, only the modules X(A) and X(B) had been instanciated.  However, one could imagine to add the keyword argument `parallelizable` to the manifold constructor (with default being `False`).\n> \n> I guess a subtlety is that in sage.manifolds a manifold M is thought to be immutable but new submanifolds on it can be declared imperatively. At any point, of course only finitely many submanifolds have been declared in M as a Python object, but it's not clear that M as a mathematical object is really assumed to be covered by only a finite number of parallelizable submanifolds...\n\n\nYou're right, this should be stated in the manifold documentation. The whole idea is described in Sec. 3.2 and 3.3 of this [document](https://ccirm.centre-mersenne.org/item/CCIRM_2018__6_1_A1_0/).\nNote that the finite number of parallelizable pieces is not a very severe limitation. For instance this holds for any compact manifold. Actually I don't know any manifold that is not of this type, not that I doubt that some examples can be constructed...",
    "created_at": "2022-09-29T20:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520362",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:17'></a>Replying to [comment:16 Matthias Köppe]:
> Replying to [comment:14 Eric Gourgoulhon]:
> > I would say that the vector field modules are indeed reflexive for the cases we can treat with Sage, namely those for which the manifold M can be split into a finite number of parallelizable manifolds N_i, i.e. there is a finite open cover of M, (N_i)_{1\leq i \leq p} (p finite), such that for each i, N_i is parallelizable.

> 
> Is this splitting into parallelizable manifolds explicitly done somewhere in the code?


Not explicitly, but `DifferentiableManifold`'s have the attribute `_parrelizable_parts`; for instance:

```
sage: M = manifolds.Sphere(2, coordinates='stereographic')
sage: M._parallelizable_parts
{Open subset S^2-{NP,SP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3,
 Open subset S^2-{NP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3,
 Open subset S^2-{SP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3}
sage: M._open_covers
[[2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3],
 [Open subset S^2-{NP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3,
  Open subset S^2-{SP} of the 2-sphere S^2 of radius 1 smoothly embedded in the Euclidean space E^3]]
```
Actually the parallelizable parts are declared on the fly, in the same spirit as the charts and other structures on the manifod. Even the parallelizable aspect of the manifold can appear quite late after the manifold instanciation. For example, in this [notebook about S^1](https://nbviewer.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/SM_sphere_S1.ipynb), the manifold is (implicitly) declared parallelizable only in cell no. 21, by declaring a vector frame on it. This action creates the object X(M) as a `VectorFieldFreeModule`. Previously, only the modules X(A) and X(B) had been instanciated.  However, one could imagine to add the keyword argument `parallelizable` to the manifold constructor (with default being `False`).
> 
> I guess a subtlety is that in sage.manifolds a manifold M is thought to be immutable but new submanifolds on it can be declared imperatively. At any point, of course only finitely many submanifolds have been declared in M as a Python object, but it's not clear that M as a mathematical object is really assumed to be covered by only a finite number of parallelizable submanifolds...


You're right, this should be stated in the manifold documentation. The whole idea is described in Sec. 3.2 and 3.3 of this [document](https://ccirm.centre-mersenne.org/item/CCIRM_2018__6_1_A1_0/).
Note that the finite number of parallelizable pieces is not a very severe limitation. For instance this holds for any compact manifold. Actually I don't know any manifold that is not of this type, not that I doubt that some examples can be constructed...



---

archive/issue_comments_520363.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-29T23:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520364.json:
```json
{
    "body": "<a id='comment:19'></a>Here's a draft of refactoring along these lines. (Of course src/sage/tensor/modules/reflexive_module.py would still need more documentation.)",
    "created_at": "2022-09-29T23:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520364",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>Here's a draft of refactoring along these lines. (Of course src/sage/tensor/modules/reflexive_module.py would still need more documentation.)



---

archive/issue_comments_520365.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-29T23:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520365",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520366.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-02T06:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520366",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520367.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n ... as previously done for `FiniteRankFreeModule` etc.\n+\n+We introduce abstract base classes `ReflexiveModule_*` to unify the implementations of `VectorFieldModule`... and `FiniteRankFreeModule`/`VectorFieldFreeModule`...\n+\n+Follow-up: #34621 Method `dual_pairing` for modules in `sage.tensor`\n \n Comment: 1\n \n```\n",
    "created_at": "2022-10-02T17:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520367",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
 ... as previously done for `FiniteRankFreeModule` etc.
+
+We introduce abstract base classes `ReflexiveModule_*` to unify the implementations of `VectorFieldModule`... and `FiniteRankFreeModule`/`VectorFieldFreeModule`...
+
+Follow-up: #34621 Method `dual_pairing` for modules in `sage.tensor`
 
 Comment: 1
 
```




---

archive/issue_comments_520368.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-02T18:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520368",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520369.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-02T18:43:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520369",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520370.json:
```json
{
    "body": "<a id='comment:26'></a>Looks nice! Thanks.\n\nAn entry for the new file `reflexive_module.py` is missing in `src/doc/en/reference/tensor_free_modules/`, so that the documentation is not generated. I would suggest to add it in `src/doc/en/reference/tensor_free_modules/tensors.rst`. Once this is done,\n\n```\nsage -docbuild reference/tensor_free_modules html\n```\nreveals that some `$` signs should be replaced by backticks:\n\n```diff\n-    the `R`-module of linear functionals $\\phi:\\ M \\longrightarrow R$.\n+    the `R`-module of linear functionals `\\phi:\\ M \\longrightarrow R`.\n```",
    "created_at": "2022-10-03T09:34:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520370",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:26'></a>Looks nice! Thanks.

An entry for the new file `reflexive_module.py` is missing in `src/doc/en/reference/tensor_free_modules/`, so that the documentation is not generated. I would suggest to add it in `src/doc/en/reference/tensor_free_modules/tensors.rst`. Once this is done,

```
sage -docbuild reference/tensor_free_modules html
```
reveals that some `$` signs should be replaced by backticks:

```diff
-    the `R`-module of linear functionals $\phi:\ M \longrightarrow R$.
+    the `R`-module of linear functionals `\phi:\ M \longrightarrow R`.
```



---

archive/issue_comments_520371.json:
```json
{
    "body": "<a id='comment:27'></a>Travis, Michael, if you have time (not sure this is the case at the moment...), could you comment on the argument sketched in comment:14 ?",
    "created_at": "2022-10-03T09:40:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520371",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:27'></a>Travis, Michael, if you have time (not sure this is the case at the moment...), could you comment on the argument sketched in comment:14 ?



---

archive/issue_comments_520372.json:
```json
{
    "body": "<a id='comment:28'></a>I think it is good. I do not quite see how it might break down for more obtuse finite-dimensional examples, but the question is should it? I think no, but I typically think in terms of \"nice\" objects.",
    "created_at": "2022-10-03T10:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520372",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:28'></a>I think it is good. I do not quite see how it might break down for more obtuse finite-dimensional examples, but the question is should it? I think no, but I typically think in terms of "nice" objects.



---

archive/issue_comments_520373.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 Travis Scrimshaw]:\n> I think it is good. I do not quite see how it might break down for more obtuse finite-dimensional examples, but the question is should it? I think no, but I typically think in terms of \"nice\" objects.\n\nThank you Travis!",
    "created_at": "2022-10-03T10:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520373",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:29'></a>Replying to [comment:28 Travis Scrimshaw]:
> I think it is good. I do not quite see how it might break down for more obtuse finite-dimensional examples, but the question is should it? I think no, but I typically think in terms of "nice" objects.

Thank you Travis!



---

archive/issue_comments_520374.json:
```json
{
    "body": "<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-03T11:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520375.json:
```json
{
    "body": "<a id='comment:31'></a>I have two questions regarding the inheritance structure:\n\n1/ There is a disymmetry in the MRO between `FiniteRankFreeModule`, `FiniteDualFreeModule` and `TensorFreeModule`: for the first two classes, the inheritance order is `(ReflexiveModule_(base or dual), FiniteRankFreeModule_abstract)`,  while for the third class it is the opposite order: `(FiniteRankFreeModule_abstract, ReflexiveModule_tensor)`. Is this intended?\n\n2/ The class `VectorFieldModule_abstract` has no method at all. Is such a class necessary? The only use I can see is that classes that inherit from it inherit from the pair `(UniqueRepresentation, ReflexiveModule_abstract)`, but it would be more clear to make this explicit in those classes, instead of using `VectorFieldModule_abstract` as a proxy for `(UniqueRepresentation, ReflexiveModule_abstract)`. Also, the name `VectorFieldModule_abstract` could be misleading since for instance `DiffFormModule` inherits from it.",
    "created_at": "2022-10-04T09:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520375",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:31'></a>I have two questions regarding the inheritance structure:

1/ There is a disymmetry in the MRO between `FiniteRankFreeModule`, `FiniteDualFreeModule` and `TensorFreeModule`: for the first two classes, the inheritance order is `(ReflexiveModule_(base or dual), FiniteRankFreeModule_abstract)`,  while for the third class it is the opposite order: `(FiniteRankFreeModule_abstract, ReflexiveModule_tensor)`. Is this intended?

2/ The class `VectorFieldModule_abstract` has no method at all. Is such a class necessary? The only use I can see is that classes that inherit from it inherit from the pair `(UniqueRepresentation, ReflexiveModule_abstract)`, but it would be more clear to make this explicit in those classes, instead of using `VectorFieldModule_abstract` as a proxy for `(UniqueRepresentation, ReflexiveModule_abstract)`. Also, the name `VectorFieldModule_abstract` could be misleading since for instance `DiffFormModule` inherits from it.



---

archive/issue_comments_520376.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-10-04T18:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520376",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520377.json:
```json
{
    "body": "<a id='comment:33'></a>1) Thanks for catching this, fixed.",
    "created_at": "2022-10-04T18:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520377",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:33'></a>1) Thanks for catching this, fixed.



---

archive/issue_comments_520378.json:
```json
{
    "body": "<a id='comment:34'></a>2) I guess I was planning to move some methods from `VectorFieldModule` to `VectorField_abstract`. Candidates would be `domain`, `ambient_domain`, and perhaps some others. But I agree that the name `VectorFieldModule_abstract` is misleading... Would you have a suggestion for a better name? It also doesn't have to happen on this ticket -- I can just back it out.",
    "created_at": "2022-10-04T18:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520378",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>2) I guess I was planning to move some methods from `VectorFieldModule` to `VectorField_abstract`. Candidates would be `domain`, `ambient_domain`, and perhaps some others. But I agree that the name `VectorFieldModule_abstract` is misleading... Would you have a suggestion for a better name? It also doesn't have to happen on this ticket -- I can just back it out.



---

archive/issue_comments_520379.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:34 Matthias K\u00f6ppe]:\n> 2) I guess I was planning to move some methods from `VectorFieldModule` to `VectorField_abstract`. Candidates would be `domain`, `ambient_domain`, and perhaps some others. But I agree that the name `VectorFieldModule_abstract` is misleading... Would you have a suggestion for a better name? \n\n\nMaybe `FieldModule_abstract`?\n\n> It also doesn't have to happen on this ticket -- I can just back it out.\n\n\nOK.",
    "created_at": "2022-10-05T06:24:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520379",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:35'></a>Replying to [comment:34 Matthias Köppe]:
> 2) I guess I was planning to move some methods from `VectorFieldModule` to `VectorField_abstract`. Candidates would be `domain`, `ambient_domain`, and perhaps some others. But I agree that the name `VectorFieldModule_abstract` is misleading... Would you have a suggestion for a better name? 


Maybe `FieldModule_abstract`?

> It also doesn't have to happen on this ticket -- I can just back it out.


OK.



---

archive/issue_comments_520380.json:
```json
{
    "body": "<a id='comment:36'></a>May I ask what do we choose? Renaming `VectorFieldModule_abstract` to `FieldModule_abstract` (or something similar) or backing it out for this ticket?",
    "created_at": "2022-10-31T13:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520380",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:36'></a>May I ask what do we choose? Renaming `VectorFieldModule_abstract` to `FieldModule_abstract` (or something similar) or backing it out for this ticket?



---

archive/issue_comments_520381.json:
```json
{
    "body": "<a id='comment:37'></a>I'll back it out",
    "created_at": "2022-11-12T23:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520381",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:37'></a>I'll back it out



---

archive/issue_comments_520382.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-11-12T23:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520382",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_520383.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-11-12T23:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520383",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_520384.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-11-12T23:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520384",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_520385.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-11-12T23:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520385",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_520386.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:37 Matthias K\u00f6ppe]:\n> I'll back it out\n\n\nThanks!\n\nOne minor last thing: as revealed by the patchbot, `ReflexiveModule_abstract` is imported by unused in `vectorfield_module.py`.",
    "created_at": "2022-11-13T10:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520386",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:42'></a>Replying to [comment:37 Matthias Köppe]:
> I'll back it out


Thanks!

One minor last thing: as revealed by the patchbot, `ReflexiveModule_abstract` is imported by unused in `vectorfield_module.py`.



---

archive/issue_comments_520387.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-13T18:10:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520387",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_520388.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-11-13T20:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520388",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_520389.json:
```json
{
    "body": "<a id='comment:44'></a>Thanks!",
    "created_at": "2022-11-13T20:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520389",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:44'></a>Thanks!



---

archive/issue_comments_520390.json:
```json
{
    "body": "<a id='comment:45'></a>Thank you!",
    "created_at": "2022-11-13T23:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520390",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:45'></a>Thank you!



---

archive/issue_events_089669.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-11-15T23:43:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34589#event-89669"
}
```



---

archive/issue_comments_520391.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-11-15T23:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34589",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34589#issuecomment-520391",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
