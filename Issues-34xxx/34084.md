# Issue 34084: Fix bug with comparison to 1 in IndexedFreeModuleElement

archive/issues_033847.json:
```json
{
    "body": "There is a monomial basis comparison to 1 in IndexedFreeModule element. This ticket expands it to a comparison with `.one_basis()`.\n\nCC:  @tscrim @trevorkarn\n\nKeywords: gsoc2022, one basis, indexed free module\n\nBranch/Commit: [2269b230fdb06efae4fcdfa7d890254ac9ded259](https://github.com/sagemath/sagetrac-mirror/commit/2269b230fdb06efae4fcdfa7d890254ac9ded259)\n\nReviewer: Travis Scrimshaw\n\nAuthor: Trevor K. Karn\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34084\n\n",
    "closed_at": "2022-08-04T22:45:09Z",
    "created_at": "2022-06-26T03:25:52Z",
    "labels": [
        "component: linear algebra",
        "trivial",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Fix bug with comparison to 1 in IndexedFreeModuleElement",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34084",
    "user": "https://github.com/trevorkarn"
}
```
There is a monomial basis comparison to 1 in IndexedFreeModule element. This ticket expands it to a comparison with `.one_basis()`.

CC:  @tscrim @trevorkarn

Keywords: gsoc2022, one basis, indexed free module

Branch/Commit: [2269b230fdb06efae4fcdfa7d890254ac9ded259](https://github.com/sagemath/sagetrac-mirror/commit/2269b230fdb06efae4fcdfa7d890254ac9ded259)

Reviewer: Travis Scrimshaw

Author: Trevor K. Karn

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34084





---

archive/issue_comments_678715.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-26T03:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678715",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_678716.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-27T02:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678716",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_678717.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2022-06-27T02:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678717",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_678718.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis is dangerous as a module does not have to implement a `one_basis()` (in fact, some of them do not because it is not an element of the basis). I agree with the principle of this change, but you should pull out getting the `self.parent().one_basis()` outside of the loops and into a `try`-`except AttributeError:` block. I would set the stored `one_basis` variable you'll need to `None` for the exception branch.\n\nThe same change should be done in `_unicode_art_` as well.",
    "created_at": "2022-06-27T02:26:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678718",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
This is dangerous as a module does not have to implement a `one_basis()` (in fact, some of them do not because it is not an element of the basis). I agree with the principle of this change, but you should pull out getting the `self.parent().one_basis()` outside of the loops and into a `try`-`except AttributeError:` block. I would set the stored `one_basis` variable you'll need to `None` for the exception branch.

The same change should be done in `_unicode_art_` as well.



---

archive/issue_comments_678719.json:
```json
{
    "body": "<a id='comment:3'></a>\nSounds good. Is there any examples of modules that don\u2019t implement .one_basis that come to mind? I want to make sure I can add an example in the doctest where the fix I had breaks.",
    "created_at": "2022-06-29T13:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678719",
    "user": "https://github.com/trevorkarn"
}
```

<a id='comment:3'></a>
Sounds good. Is there any examples of modules that don’t implement .one_basis that come to mind? I want to make sure I can add an example in the doctest where the fix I had breaks.



---

archive/issue_comments_678720.json:
```json
{
    "body": "<a id='comment:4'></a>\nI think one of the bases for the `DescentAlgebra` doesn\u2019t have a `one_basis()` since `one()` is a sum of basis elements. There is also a basis of one of the combinatorial Hopf algebras called the orbit basis that also has this IIRC.",
    "created_at": "2022-06-29T13:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678720",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
I think one of the bases for the `DescentAlgebra` doesn’t have a `one_basis()` since `one()` is a sum of basis elements. There is also a basis of one of the combinatorial Hopf algebras called the orbit basis that also has this IIRC.



---

archive/issue_comments_678721.json:
```json
{
    "body": "Changing commit from \"c76772915d6662ee791bc6dfeff5f900012fe848\" to \"382cb469daf94452620a318bf2ee5cf5092aea15\"",
    "created_at": "2022-07-25T15:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c76772915d6662ee791bc6dfeff5f900012fe848" to "382cb469daf94452620a318bf2ee5cf5092aea15"



---

archive/issue_comments_678722.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[382cb46](https://github.com/sagemath/sagetrac-mirror/commit/382cb469daf94452620a318bf2ee5cf5092aea15)|`Fix to work with algebras without a one_basis`|",
    "created_at": "2022-07-25T15:08:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678722",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[382cb46](https://github.com/sagemath/sagetrac-mirror/commit/382cb469daf94452620a318bf2ee5cf5092aea15)|`Fix to work with algebras without a one_basis`|



---

archive/issue_comments_678723.json:
```json
{
    "body": "Changing commit from \"382cb469daf94452620a318bf2ee5cf5092aea15\" to \"2269b230fdb06efae4fcdfa7d890254ac9ded259\"",
    "created_at": "2022-07-25T15:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678723",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "382cb469daf94452620a318bf2ee5cf5092aea15" to "2269b230fdb06efae4fcdfa7d890254ac9ded259"



---

archive/issue_comments_678724.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[2269b23](https://github.com/sagemath/sagetrac-mirror/commit/2269b230fdb06efae4fcdfa7d890254ac9ded259)|`Change one in _unicode_art_`|",
    "created_at": "2022-07-25T15:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678724",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[2269b23](https://github.com/sagemath/sagetrac-mirror/commit/2269b230fdb06efae4fcdfa7d890254ac9ded259)|`Change one in _unicode_art_`|



---

archive/issue_comments_678725.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-25T15:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678725",
    "user": "https://github.com/trevorkarn"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_678726.json:
```json
{
    "body": "<a id='comment:8'></a>\nThanks. LGTM.",
    "created_at": "2022-07-28T01:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678726",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
Thanks. LGTM.



---

archive/issue_comments_678727.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-28T01:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678727",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_678728.json:
```json
{
    "body": "Changing keywords from \"gsoc2022 one-basis indexed-free-module\" to \"gsoc2022, one basis, indexed free module\".",
    "created_at": "2022-07-28T01:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678728",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "gsoc2022 one-basis indexed-free-module" to "gsoc2022, one basis, indexed free module".



---

archive/issue_events_100304.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-04T22:45:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34084#event-100304"
}
```



---

archive/issue_comments_678729.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-04T22:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678729",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_678730.json:
```json
{
    "body": "Changing branch from \"u/tkarn/indexed-element-one-basis\" to \"2269b230fdb06efae4fcdfa7d890254ac9ded259\"",
    "created_at": "2022-08-04T22:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34084",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34084#issuecomment-678730",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/tkarn/indexed-element-one-basis" to "2269b230fdb06efae4fcdfa7d890254ac9ded259"
