# Issue 34521: Bernoulli(1) = +1/2

archive/issues_034284.json:
```json
{
    "body": "Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books (e.g. here are his [replacement pages](https://www-cs-faculty.stanford.edu/~knuth/gkp34.pdf)  for earlier that 34th editions of \"Concrete Mathematics\") now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.\n\nWell not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make the `+1/2` behaviour default later on, so as to give time for end-users to update their code.\n\nThis is a continuation of the sage-devel thread at https://groups.google.com/g/sage-devel/c/G4sbKoibXK4.\n\n**Assignee:** @dimpase\n\n**CC:**  @fredrik-johansson @davidayotte @PeterLuschny @edgarcosta asmeurer\n\n**Keywords:** bernoulli numbers\n\n**Branch:** [u/gh-Parcly-Taxel/bern1](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Parcly-Taxel/bern1)\n\n**Commit:** [b5ce7de42ad148dc4f04413daa98d799bf266bdd](https://github.com/sagemath/sagetrac-mirror/commit/b5ce7de42ad148dc4f04413daa98d799bf266bdd)\n\n**Author:** Jeremy Tan Jie Rui\n\n**Status:** new\n\nIssue created by migration from https://trac.sagemath.org/ticket/34521\n\n",
    "closed_at": "2022-09-12T08:10:24Z",
    "created_at": "2022-09-11T21:18:15Z",
    "labels": [
        "component: number theory",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Bernoulli(1) = +1/2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34521",
    "user": "https://github.com/Parcly-Taxel"
}
```
Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books (e.g. here are his [replacement pages](https://www-cs-faculty.stanford.edu/~knuth/gkp34.pdf)  for earlier that 34th editions of "Concrete Mathematics") now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.

Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make the `+1/2` behaviour default later on, so as to give time for end-users to update their code.

This is a continuation of the sage-devel thread at https://groups.google.com/g/sage-devel/c/G4sbKoibXK4.

**Assignee:** @dimpase

**CC:**  @fredrik-johansson @davidayotte @PeterLuschny @edgarcosta asmeurer

**Keywords:** bernoulli numbers

**Branch:** [u/gh-Parcly-Taxel/bern1](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-Parcly-Taxel/bern1)

**Commit:** [b5ce7de42ad148dc4f04413daa98d799bf266bdd](https://github.com/sagemath/sagetrac-mirror/commit/b5ce7de42ad148dc4f04413daa98d799bf266bdd)

**Author:** Jeremy Tan Jie Rui

**Status:** new

Issue created by migration from https://trac.sagemath.org/ticket/34521





---

archive/issue_comments_656696.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.\n \n-Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour by default. The intention is to make the default behaviour permanent later on, so as to give time for end-users to update their code.\n+Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour by default. The intention is to make the `+1/2` behaviour permanent later on, so as to give time for end-users to update their code.\n \n This is a continuation of the sage-devel thread at https://groups.google.com/g/sage-devel/c/G4sbKoibXK4.\n``````\n",
    "created_at": "2022-09-11T21:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656696",
    "user": "https://github.com/Parcly-Taxel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.
 
-Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour by default. The intention is to make the default behaviour permanent later on, so as to give time for end-users to update their code.
+Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour by default. The intention is to make the `+1/2` behaviour permanent later on, so as to give time for end-users to update their code.
 
 This is a continuation of the sage-devel thread at https://groups.google.com/g/sage-devel/c/G4sbKoibXK4.
``````




---

archive/issue_comments_656697.json:
```json
{
    "body": "<a id='comment:3'></a>\nWhat I think would be a good way to go in this ticket would be to follow the [one year deprecation policy](https://doc.sagemath.org/html/en/developer/coding_in_python.html#deprecation) of Sage. Therefore, the default value of the parameter `plus` would be `False` so that `Bernoulli(1)` still returns `-1/2`, but this option would return a warning message saying that this default value will change to `True` in a subsequent release of [SageMath](SageMath). This will give time to the user to adapt their code accordingly.\n\nAlso, if `plus=False` I would make the code return `Bernoulli(1)=-1/2` (instead of letting the algorithm decides). In my opinion, this would give the user the choice of its prefered value and avoid some possible confusions.\n\nHere's a list of all the files with failed doctests:\n\n```\nsage -t --random-seed=261341029976424338880876638067744409976 doc/en/thematic_tutorials/explicit_methods_in_number_theory/generators_for_rings.rst  # 1 doctest failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/combinat/q_bernoulli.pyx  # 1 doctest failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/dirichlet.py  # 3 doctests failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/ambient.py  # 1 doctest failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/constructor.py  # 1 doctest failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/ambient_g1.py  # 1 doctest failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/eisenstein_submodule.py  # 4 doctests failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/element.py  # 11 doctests failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/ring.py  # 3 doctests failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/overconvergent/genus0.py  # 28 doctests failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/overconvergent/weightspace.py  # 5 doctests failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/quasimodform/element.py  # 1 doctest failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/modular/quasimodform/ring.py  # 1 doctest failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/rings/bernmm.pyx  # 1 doctest failed\nsage -t --random-seed=261341029976424338880876638067744409976 sage/tests/book_stein_modform.py  # 1 doctest failed\n```",
    "created_at": "2022-09-12T01:38:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656697",
    "user": "https://github.com/DavidAyotte"
}
```

<a id='comment:3'></a>
What I think would be a good way to go in this ticket would be to follow the [one year deprecation policy](https://doc.sagemath.org/html/en/developer/coding_in_python.html#deprecation) of Sage. Therefore, the default value of the parameter `plus` would be `False` so that `Bernoulli(1)` still returns `-1/2`, but this option would return a warning message saying that this default value will change to `True` in a subsequent release of [SageMath](SageMath). This will give time to the user to adapt their code accordingly.

Also, if `plus=False` I would make the code return `Bernoulli(1)=-1/2` (instead of letting the algorithm decides). In my opinion, this would give the user the choice of its prefered value and avoid some possible confusions.

Here's a list of all the files with failed doctests:

```
sage -t --random-seed=261341029976424338880876638067744409976 doc/en/thematic_tutorials/explicit_methods_in_number_theory/generators_for_rings.rst  # 1 doctest failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/combinat/q_bernoulli.pyx  # 1 doctest failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/dirichlet.py  # 3 doctests failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/ambient.py  # 1 doctest failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/constructor.py  # 1 doctest failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/ambient_g1.py  # 1 doctest failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/eisenstein_submodule.py  # 4 doctests failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/element.py  # 11 doctests failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/modform/ring.py  # 3 doctests failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/overconvergent/genus0.py  # 28 doctests failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/overconvergent/weightspace.py  # 5 doctests failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/quasimodform/element.py  # 1 doctest failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/modular/quasimodform/ring.py  # 1 doctest failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/rings/bernmm.pyx  # 1 doctest failed
sage -t --random-seed=261341029976424338880876638067744409976 sage/tests/book_stein_modform.py  # 1 doctest failed
```



---

archive/issue_comments_656698.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/296535745b6cd3a818b6f2dad9a9f1569bec95cc\">2965357</a></td><td><code>It is a deprecation after all</code></td></tr></table>\n",
    "created_at": "2022-09-12T02:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656698",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/296535745b6cd3a818b6f2dad9a9f1569bec95cc">2965357</a></td><td><code>It is a deprecation after all</code></td></tr></table>




---

archive/issue_comments_656699.json:
```json
{
    "body": "**Changing commit** from \"[db023fafd879417326e22e1c99439dc3ae5675f3](https://github.com/sagemath/sagetrac-mirror/commit/db023fafd879417326e22e1c99439dc3ae5675f3)\" to \"[296535745b6cd3a818b6f2dad9a9f1569bec95cc](https://github.com/sagemath/sagetrac-mirror/commit/296535745b6cd3a818b6f2dad9a9f1569bec95cc)\".",
    "created_at": "2022-09-12T02:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[db023fafd879417326e22e1c99439dc3ae5675f3](https://github.com/sagemath/sagetrac-mirror/commit/db023fafd879417326e22e1c99439dc3ae5675f3)" to "[296535745b6cd3a818b6f2dad9a9f1569bec95cc](https://github.com/sagemath/sagetrac-mirror/commit/296535745b6cd3a818b6f2dad9a9f1569bec95cc)".



---

archive/issue_comments_656700.json:
```json
{
    "body": "<a id='comment:5'></a>\n**NO**.\n\nWe are not going to change this convention, which is the standard one. Live with it.",
    "created_at": "2022-09-12T06:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656700",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
**NO**.

We are not going to change this convention, which is the standard one. Live with it.



---

archive/issue_comments_656701.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/85e7c975e26b5e6b1d085d51cd9011d098bbd385\">85e7c97</a></td><td><code>Fix all doctests</code></td></tr></table>\n",
    "created_at": "2022-09-12T07:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/85e7c975e26b5e6b1d085d51cd9011d098bbd385">85e7c97</a></td><td><code>Fix all doctests</code></td></tr></table>




---

archive/issue_comments_656702.json:
```json
{
    "body": "**Changing commit** from \"[296535745b6cd3a818b6f2dad9a9f1569bec95cc](https://github.com/sagemath/sagetrac-mirror/commit/296535745b6cd3a818b6f2dad9a9f1569bec95cc)\" to \"[85e7c975e26b5e6b1d085d51cd9011d098bbd385](https://github.com/sagemath/sagetrac-mirror/commit/85e7c975e26b5e6b1d085d51cd9011d098bbd385)\".",
    "created_at": "2022-09-12T07:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[296535745b6cd3a818b6f2dad9a9f1569bec95cc](https://github.com/sagemath/sagetrac-mirror/commit/296535745b6cd3a818b6f2dad9a9f1569bec95cc)" to "[85e7c975e26b5e6b1d085d51cd9011d098bbd385](https://github.com/sagemath/sagetrac-mirror/commit/85e7c975e26b5e6b1d085d51cd9011d098bbd385)".



---

archive/issue_comments_656703.json:
```json
{
    "body": "<a id='comment:8'></a>\nHow can you say `B_1 = -1/2` is standard when Knuth uses `B_1 = +1/2`?\n\nHow can you say `B_1 = -1/2` is even a \"convention\" when Luschny has analysed the historical development of the Bernoulli numbers and found that Bernoulli himself and virtually all mathematicians before the 20th century used `B_1 = +1/2`?\n\nHave you read the manifesto? Luschny's argument has two main thrusts: the historical side as above, and the simplification of many formulae with `B_1 = +1/2`, including Euler\u2013Maclaurin. He eventually finds that the Hasse\u2013Worpitzky representation of the generalised Bernoulli function frees the numbers from all conventions \u2013 `B_1 = +1/2` is not another convention, it is the only logical value.",
    "created_at": "2022-09-12T08:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656703",
    "user": "https://github.com/Parcly-Taxel"
}
```

<a id='comment:8'></a>
How can you say `B_1 = -1/2` is standard when Knuth uses `B_1 = +1/2`?

How can you say `B_1 = -1/2` is even a "convention" when Luschny has analysed the historical development of the Bernoulli numbers and found that Bernoulli himself and virtually all mathematicians before the 20th century used `B_1 = +1/2`?

Have you read the manifesto? Luschny's argument has two main thrusts: the historical side as above, and the simplification of many formulae with `B_1 = +1/2`, including Euler–Maclaurin. He eventually finds that the Hasse–Worpitzky representation of the generalised Bernoulli function frees the numbers from all conventions – `B_1 = +1/2` is not another convention, it is the only logical value.



---

archive/issue_comments_656704.json:
```json
{
    "body": "<a id='comment:9'></a>\nMr Luschny has not published any mathematical article. We have more serious things to do, so I will now close this ticket.",
    "created_at": "2022-09-12T08:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656704",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>
Mr Luschny has not published any mathematical article. We have more serious things to do, so I will now close this ticket.



---

archive/issue_events_100656.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2022-09-12T08:10:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34521#event-100656"
}
```



---

archive/issue_events_100657.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "label": "invalid",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34521#event-100657"
}
```



---

archive/issue_comments_656705.json:
```json
{
    "body": "**Assignee:** @Parcly-Taxel",
    "created_at": "2022-09-12T08:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656705",
    "user": "https://github.com/Parcly-Taxel"
}
```

**Assignee:** @Parcly-Taxel



---

archive/issue_comments_656706.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [Fr\u00e9d\u00e9ric Chapoton](#comment%3A9):\n> Mr Luschny has not published any mathematical article. We have more serious things to do, so I will now close this ticket.\n\n\nFrederic, really? Knuth (does this name rings a bell :-)), mentioned in the ticket description, has published maths articles, and books, and if he uses +1/2 then this should have a merit.\n\nAnd there was a tentative agreement on sage-devel that this change can go forward.",
    "created_at": "2022-09-12T13:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656706",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'></a>
Replying to [Frédéric Chapoton](#comment%3A9):
> Mr Luschny has not published any mathematical article. We have more serious things to do, so I will now close this ticket.


Frederic, really? Knuth (does this name rings a bell :-)), mentioned in the ticket description, has published maths articles, and books, and if he uses +1/2 then this should have a merit.

And there was a tentative agreement on sage-devel that this change can go forward.



---

archive/issue_comments_656707.json:
```json
{
    "body": "**Changing assignee** from @Parcly-Taxel to @dimpase.",
    "created_at": "2022-09-12T13:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656707",
    "user": "https://github.com/dimpase"
}
```

**Changing assignee** from @Parcly-Taxel to @dimpase.



---

archive/issue_comments_656708.json:
```json
{
    "body": "<a id='comment:12'></a>\nDon't create extra work for other people by closing tickets without a review.",
    "created_at": "2022-09-12T13:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656708",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:12'></a>
Don't create extra work for other people by closing tickets without a review.



---

archive/issue_comments_656709.json:
```json
{
    "body": "<a id='comment:13'></a>\nHello Fr\u00e9d\u00e9ric, you clearly did not read the thread on [sage-devel](https://groups.google.com/g/sage-devel/c/G4sbKoibXK4/m/nruZdm9xBwAJ). I **strongly** think that something should be done about this in someway because FLINT is the default system for computing small Bernoulli numbers, otherwise we are just waiting for many bugs to appear once this system gets updated (see [comment:3](#comment%3A3)).\n\nI'm sorry Jeremy that you had to undergo this authoritarian outcome.",
    "created_at": "2022-09-12T14:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656709",
    "user": "https://github.com/DavidAyotte"
}
```

<a id='comment:13'></a>
Hello Frédéric, you clearly did not read the thread on [sage-devel](https://groups.google.com/g/sage-devel/c/G4sbKoibXK4/m/nruZdm9xBwAJ). I **strongly** think that something should be done about this in someway because FLINT is the default system for computing small Bernoulli numbers, otherwise we are just waiting for many bugs to appear once this system gets updated (see [comment:3](#comment%3A3)).

I'm sorry Jeremy that you had to undergo this authoritarian outcome.



---

archive/issue_comments_656710.json:
```json
{
    "body": "<a id='comment:14'></a>\nI'm re-opening this.  I have no opinion on which definition we settle on (having not read the cited paper), and according to the test suite this change mainly impacts code that I wrote.    That said, I am definitely OK with making the change following the 1-year deprecation policy, in order to avoid breaking code out there in the wild that depends on this.",
    "created_at": "2022-09-12T18:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656710",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:14'></a>
I'm re-opening this.  I have no opinion on which definition we settle on (having not read the cited paper), and according to the test suite this change mainly impacts code that I wrote.    That said, I am definitely OK with making the change following the 1-year deprecation policy, in order to avoid breaking code out there in the wild that depends on this.



---

archive/issue_comments_656711.json:
```json
{
    "body": "**Changing status** from closed to new.",
    "created_at": "2022-09-12T18:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656711",
    "user": "https://github.com/williamstein"
}
```

**Changing status** from closed to new.



---

archive/issue_events_100658.json:
```json
{
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "label": "invalid",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34521#event-100658"
}
```



---

archive/issue_comments_656712.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [Dima Pasechnik](#comment%3A11):\n> And there was a tentative agreement on sage-devel that this change can go forward.\n\n\nI don't think so. Most people said if to be done, would need to be done with 1 year deprecation warning.\nApart from the OP, I don't think anyone is excited about this change. Including me.\n\nReplying to [David Ayotte](#comment%3A13):\n> I **strongly** think that something should be done about this in someway because FLINT is the default system for computing small Bernoulli numbers, otherwise we are just waiting for many bugs to appear once this system gets updated (see [comment:3](#comment%3A3)).\n\n\nWhy do you think the PR will be merged?",
    "created_at": "2022-09-13T02:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656712",
    "user": "https://github.com/edgarcosta"
}
```

<a id='comment:15'></a>
Replying to [Dima Pasechnik](#comment%3A11):
> And there was a tentative agreement on sage-devel that this change can go forward.


I don't think so. Most people said if to be done, would need to be done with 1 year deprecation warning.
Apart from the OP, I don't think anyone is excited about this change. Including me.

Replying to [David Ayotte](#comment%3A13):
> I **strongly** think that something should be done about this in someway because FLINT is the default system for computing small Bernoulli numbers, otherwise we are just waiting for many bugs to appear once this system gets updated (see [comment:3](#comment%3A3)).


Why do you think the PR will be merged?



---

archive/issue_comments_656713.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [Edgar Costa](#comment%3A15):\n> Why do you think the PR will be merged?\n\n\nSomeone indeed pointed this out on sage-devel. This is a mistake from my part as I thougth that is was already closed. Sorry! It can indeed never be merged...",
    "created_at": "2022-09-13T02:17:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656713",
    "user": "https://github.com/DavidAyotte"
}
```

<a id='comment:16'></a>
Replying to [Edgar Costa](#comment%3A15):
> Why do you think the PR will be merged?


Someone indeed pointed this out on sage-devel. This is a mistake from my part as I thougth that is was already closed. Sorry! It can indeed never be merged...



---

archive/issue_comments_656714.json:
```json
{
    "body": "<a id='comment:17'></a>\n>  Apart from the OP, I don't think anyone is excited about this change. \n\n\nI personally am.  And, I think all code in Sage that is broken by this is code that I wrote, so I'm not just a completely random opinion.   I also like that it fixes that annoying special cases regarding generalized Bernoulli numbers.  I also find Knuth's opinion compelling.",
    "created_at": "2022-09-13T02:35:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656714",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:17'></a>
>  Apart from the OP, I don't think anyone is excited about this change. 


I personally am.  And, I think all code in Sage that is broken by this is code that I wrote, so I'm not just a completely random opinion.   I also like that it fixes that annoying special cases regarding generalized Bernoulli numbers.  I also find Knuth's opinion compelling.



---

archive/issue_comments_656715.json:
```json
{
    "body": "<a id='comment:18'></a>\n>  It can indeed never be merged...\n\n\nIt might or might not be merged.  We have a voting policy for contentious changes to Sage, which we carefully thought through and designed many years ago.  The weird thing is that I would link to the policy, but I just did some google searches and can't even find it!",
    "created_at": "2022-09-13T02:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656715",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:18'></a>
>  It can indeed never be merged...


It might or might not be merged.  We have a voting policy for contentious changes to Sage, which we carefully thought through and designed many years ago.  The weird thing is that I would link to the policy, but I just did some google searches and can't even find it!



---

archive/issue_comments_656716.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.\n \n-Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour by default. The intention is to make the `+1/2` behaviour permanent later on, so as to give time for end-users to update their code.\n+Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make such behaviour permanent later on, so as to give time for end-users to update their code.\n \n This is a continuation of the sage-devel thread at https://groups.google.com/g/sage-devel/c/G4sbKoibXK4.\n``````\n",
    "created_at": "2022-09-13T03:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656716",
    "user": "https://github.com/Parcly-Taxel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.
 
-Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour by default. The intention is to make the `+1/2` behaviour permanent later on, so as to give time for end-users to update their code.
+Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make such behaviour permanent later on, so as to give time for end-users to update their code.
 
 This is a continuation of the sage-devel thread at https://groups.google.com/g/sage-devel/c/G4sbKoibXK4.
``````




---

archive/issue_comments_656717.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.\n+Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books (e.g. here are his [replacement pages](https://www-cs-faculty.stanford.edu/~knuth/gkp34.pdf)  for earlier that 34th editions of \"Concrete Mathematics\") now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.\n \n Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make such behaviour permanent later on, so as to give time for end-users to update their code.\n \n``````\n",
    "created_at": "2022-09-15T13:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656717",
    "user": "https://github.com/dimpase"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.
+Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books (e.g. here are his [replacement pages](https://www-cs-faculty.stanford.edu/~knuth/gkp34.pdf)  for earlier that 34th editions of "Concrete Mathematics") now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.
 
 Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make such behaviour permanent later on, so as to give time for end-users to update their code.
 
``````




---

archive/issue_comments_656718.json:
```json
{
    "body": "<a id='comment:21'></a>\nI added a link to Knuth's take on it, e.g. https://www-cs-faculty.stanford.edu/~knuth/gkp34.pdf (replacement pages for CM), see also https://www-cs-faculty.stanford.edu/~knuth/news22.html",
    "created_at": "2022-09-15T13:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656718",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:21'></a>
I added a link to Knuth's take on it, e.g. https://www-cs-faculty.stanford.edu/~knuth/gkp34.pdf (replacement pages for CM), see also https://www-cs-faculty.stanford.edu/~knuth/news22.html



---

archive/issue_comments_656719.json:
```json
{
    "body": "<a id='comment:22'></a>\nHello Jeremy, thank you for working on this ticket and fixing the failing doctests.\n\nA small suggestion:\n\n```diff\n+    - ``plus`` (Boolean) - ``bernoulli(1)`` gives `1/2` if this is ``True`` and `-1/2` otherwise\n-    - ``plus`` - bernoulli(1) gives +1/2 if this is True and -1/2 otherwise\n```\nAlso, I think that a more descriptive depreciation message could be useful for the user:\n\n```diff\n         else:\n+            deprecation(34521, (\"bernoulli(1) will return +1/2 by default in\" +\n+            \"the future. In order to keep the original behavior, please set\" +\n+            \"the option ``plus`` to ``False`` (bernoulli(n, plus=False))\"))\n-            deprecation(34521, \"bernoulli(1) will always return +1/2 in the future\")\n```\n(or something else)\n\nI still support this change and I don't understand the convention argument against it.",
    "created_at": "2022-09-16T00:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656719",
    "user": "https://github.com/DavidAyotte"
}
```

<a id='comment:22'></a>
Hello Jeremy, thank you for working on this ticket and fixing the failing doctests.

A small suggestion:

```diff
+    - ``plus`` (Boolean) - ``bernoulli(1)`` gives `1/2` if this is ``True`` and `-1/2` otherwise
-    - ``plus`` - bernoulli(1) gives +1/2 if this is True and -1/2 otherwise
```
Also, I think that a more descriptive depreciation message could be useful for the user:

```diff
         else:
+            deprecation(34521, ("bernoulli(1) will return +1/2 by default in" +
+            "the future. In order to keep the original behavior, please set" +
+            "the option ``plus`` to ``False`` (bernoulli(n, plus=False))"))
-            deprecation(34521, "bernoulli(1) will always return +1/2 in the future")
```
(or something else)

I still support this change and I don't understand the convention argument against it.



---

archive/issue_comments_656720.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5ce7de42ad148dc4f04413daa98d799bf266bdd\">b5ce7de</a></td><td><code>More informative strings from David Ayotte</code></td></tr></table>\n",
    "created_at": "2022-09-16T00:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656720",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5ce7de42ad148dc4f04413daa98d799bf266bdd">b5ce7de</a></td><td><code>More informative strings from David Ayotte</code></td></tr></table>




---

archive/issue_comments_656721.json:
```json
{
    "body": "**Changing commit** from \"[85e7c975e26b5e6b1d085d51cd9011d098bbd385](https://github.com/sagemath/sagetrac-mirror/commit/85e7c975e26b5e6b1d085d51cd9011d098bbd385)\" to \"[b5ce7de42ad148dc4f04413daa98d799bf266bdd](https://github.com/sagemath/sagetrac-mirror/commit/b5ce7de42ad148dc4f04413daa98d799bf266bdd)\".",
    "created_at": "2022-09-16T00:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[85e7c975e26b5e6b1d085d51cd9011d098bbd385](https://github.com/sagemath/sagetrac-mirror/commit/85e7c975e26b5e6b1d085d51cd9011d098bbd385)" to "[b5ce7de42ad148dc4f04413daa98d799bf266bdd](https://github.com/sagemath/sagetrac-mirror/commit/b5ce7de42ad148dc4f04413daa98d799bf266bdd)".



---

archive/issue_comments_656722.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books (e.g. here are his [replacement pages](https://www-cs-faculty.stanford.edu/~knuth/gkp34.pdf)  for earlier that 34th editions of \"Concrete Mathematics\") now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.\n \n-Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make such behaviour permanent later on, so as to give time for end-users to update their code.\n+Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make the `+1/2` behaviour default later on, so as to give time for end-users to update their code.\n \n This is a continuation of the sage-devel thread at https://groups.google.com/g/sage-devel/c/G4sbKoibXK4.\n``````\n",
    "created_at": "2022-09-16T01:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34521",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34521#issuecomment-656722",
    "user": "https://github.com/Parcly-Taxel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 Peter Luschny's Bernoulli Manifesto (http://luschny.de/math/zeta/The-Bernoulli-Manifesto.html) makes a very convincing argument that `bernoulli(1)` should be `+1/2`, not `-1/2`. Knuth's books (e.g. here are his [replacement pages](https://www-cs-faculty.stanford.edu/~knuth/gkp34.pdf)  for earlier that 34th editions of "Concrete Mathematics") now use `+1/2`, SymPy now uses `+1/2` (and I made the PRs implementing that, see https://github.com/sympy/sympy/pull/23926), and so this ticket sets `bernoulli(1) = +1/2` here too.
 
-Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make such behaviour permanent later on, so as to give time for end-users to update their code.
+Well not quite; this ticket merely *deprecates* `bernoulli(1) = -1/2` by providing a flag enforcing `+1/2` behaviour. The intention is to make the `+1/2` behaviour default later on, so as to give time for end-users to update their code.
 
 This is a continuation of the sage-devel thread at https://groups.google.com/g/sage-devel/c/G4sbKoibXK4.
``````

