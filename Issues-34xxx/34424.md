# Issue 34424: Common base class for FiniteRankFreeModule and TensorFreeModule

archive/issues_034187.json:
```json
{
    "body": "Currently `TensorFreeModule` (and similar classes) inherits many methods from `FiniteRankFreeModule` that actually only work with the base module.\nTrying to use them leads to incomprehensible error messages. For example:\n\n```\nsage: M = FiniteRankFreeModule(ZZ, 3, name='M')\nsage: M.tensor_module(2, 1).tensor_module(3, 3)\nFree module of type-(3,3) tensors on the Free module of type-(2,1) tensors on the Rank-3 free module M over the Integer Ring\nsage: _.an_element()\nValueError: the None has not been defined on the Free module of type-(2,1) tensors on the Rank-3 free module M over the Integer Ring\n```\n\nAs discussed in #30229#comment:6, we introduce a common base class that only defines the methods that should be inherited by `TensorFreeModule` and other such classes.\n\n\nCC:  @egourgoulhon @tscrim\n\nBranch/Commit: 451ebe564d0adf19cf305e413d55b76db1d6b660\n\nReviewer: Eric Gourgoulhon\n\nAuthor: Matthias Koeppe\n\nDependencies: #31276\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34424\n\n",
    "closed_at": "2022-08-30T19:05:03Z",
    "created_at": "2022-08-24T17:33:05Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "Common base class for FiniteRankFreeModule and TensorFreeModule",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34424",
    "user": "https://github.com/mkoeppe"
}
```
Currently `TensorFreeModule` (and similar classes) inherits many methods from `FiniteRankFreeModule` that actually only work with the base module.
Trying to use them leads to incomprehensible error messages. For example:

```
sage: M = FiniteRankFreeModule(ZZ, 3, name='M')
sage: M.tensor_module(2, 1).tensor_module(3, 3)
Free module of type-(3,3) tensors on the Free module of type-(2,1) tensors on the Rank-3 free module M over the Integer Ring
sage: _.an_element()
ValueError: the None has not been defined on the Free module of type-(2,1) tensors on the Rank-3 free module M over the Integer Ring
```

As discussed in #30229#comment:6, we introduce a common base class that only defines the methods that should be inherited by `TensorFreeModule` and other such classes.


CC:  @egourgoulhon @tscrim

Branch/Commit: 451ebe564d0adf19cf305e413d55b76db1d6b660

Reviewer: Eric Gourgoulhon

Author: Matthias Koeppe

Dependencies: #31276

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34424





---

archive/issue_comments_685787.json:
```json
{
    "body": "<a id='comment:1'></a>I'd just call it `FiniteRankFreeModule_abstract` in analogy to the existing `Basis_abstract` unless there are better suggestions",
    "created_at": "2022-08-24T17:52:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685787",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:1'></a>I'd just call it `FiniteRankFreeModule_abstract` in analogy to the existing `Basis_abstract` unless there are better suggestions



---

archive/issue_comments_685788.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/common_base_class_for_finiterankfreemodule_and_tensorfreemodule\"",
    "created_at": "2022-08-25T02:38:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685788",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/common_base_class_for_finiterankfreemodule_and_tensorfreemodule"



---

archive/issue_comments_685789.json:
```json
{
    "body": "<a id='comment:3'></a>Here's a basic version that works.\n\nSome more of the methods can probably be moved to `FiniteRankFreeModule_abstract` -- but currently all doctests pass as is, so in this case we should add some examples that use subclasses.\n\n---\nNew commits:",
    "created_at": "2022-08-25T02:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685789",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:3'></a>Here's a basic version that works.

Some more of the methods can probably be moved to `FiniteRankFreeModule_abstract` -- but currently all doctests pass as is, so in this case we should add some examples that use subclasses.

---
New commits:



---

archive/issue_comments_685790.json:
```json
{
    "body": "Changing commit from \"\" to \"e76ee2f5da552453fccd25db0ba602c33cee9694\"",
    "created_at": "2022-08-25T02:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685790",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "e76ee2f5da552453fccd25db0ba602c33cee9694"



---

archive/issue_comments_685791.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-08-25T02:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685791",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_685792.json:
```json
{
    "body": "Changing commit from \"e76ee2f5da552453fccd25db0ba602c33cee9694\" to \"ac6d4657d95b72676d3b29152e74f9cc6ee8be6f\"",
    "created_at": "2022-08-25T03:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e76ee2f5da552453fccd25db0ba602c33cee9694" to "ac6d4657d95b72676d3b29152e74f9cc6ee8be6f"



---

archive/issue_comments_685793.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-25T03:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685793",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_685794.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-25T03:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685794",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_685795.json:
```json
{
    "body": "Changing commit from \"ac6d4657d95b72676d3b29152e74f9cc6ee8be6f\" to \"7e3ae02324ff89f8001c6657518eba6ad7e51962\"",
    "created_at": "2022-08-25T03:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685795",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ac6d4657d95b72676d3b29152e74f9cc6ee8be6f" to "7e3ae02324ff89f8001c6657518eba6ad7e51962"



---

archive/issue_comments_685796.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-25T03:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685796",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_685797.json:
```json
{
    "body": "<a id='comment:7'></a>Thanks for implementing this!\n\nReplying to [mkoeppe](#comment%3A1):\n> I'd just call it `FiniteRankFreeModule_abstract` in analogy to the existing `Basis_abstract` unless there are better suggestions\n\n\nSounds good to me.",
    "created_at": "2022-08-25T09:36:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685797",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:7'></a>Thanks for implementing this!

Replying to [mkoeppe](#comment%3A1):
> I'd just call it `FiniteRankFreeModule_abstract` in analogy to the existing `Basis_abstract` unless there are better suggestions


Sounds good to me.



---

archive/issue_comments_685798.json:
```json
{
    "body": "<a id='comment:8'></a>Just one suggestion: in the docstring of `FiniteRankFreeModule_abstract`:\n\n```diff\n- Free module of finite rank over a commutative ring.\n+ Abstract base class for free modules of finite rank over a commutative ring.\n```\nOtherwise, LGTM.",
    "created_at": "2022-08-26T15:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685798",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:8'></a>Just one suggestion: in the docstring of `FiniteRankFreeModule_abstract`:

```diff
- Free module of finite rank over a commutative ring.
+ Abstract base class for free modules of finite rank over a commutative ring.
```
Otherwise, LGTM.



---

archive/issue_comments_685799.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-26T19:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685799",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_685800.json:
```json
{
    "body": "Changing commit from \"7e3ae02324ff89f8001c6657518eba6ad7e51962\" to \"134c44f5de3c46de459e9c67ed9daafc15ecb148\"",
    "created_at": "2022-08-26T19:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685800",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7e3ae02324ff89f8001c6657518eba6ad7e51962" to "134c44f5de3c46de459e9c67ed9daafc15ecb148"



---

archive/issue_comments_685801.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Eric Gourgoulhon\"",
    "created_at": "2022-08-26T22:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685801",
    "user": "https://github.com/egourgoulhon"
}
```

Changing reviewer from "" to "Eric Gourgoulhon"



---

archive/issue_comments_685802.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-26T22:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685802",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_685803.json:
```json
{
    "body": "<a id='comment:10'></a>Thanks!",
    "created_at": "2022-08-26T22:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685803",
    "user": "https://github.com/egourgoulhon"
}
```

<a id='comment:10'></a>Thanks!



---

archive/issue_comments_685804.json:
```json
{
    "body": "<a id='comment:11'></a>Thank you!",
    "created_at": "2022-08-26T22:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685804",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>Thank you!



---

archive/issue_comments_685805.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#31276\"",
    "created_at": "2022-08-28T23:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685805",
    "user": "https://github.com/mkoeppe"
}
```

Changing dependencies from "" to "#31276"



---

archive/issue_comments_685806.json:
```json
{
    "body": "<a id='comment:12'></a>When merged with #31276, this gives a doctest failure",
    "created_at": "2022-08-28T23:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685806",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>When merged with #31276, this gives a doctest failure



---

archive/issue_comments_685807.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2022-08-28T23:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_685808.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2022-08-28T23:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685808",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_685809.json:
```json
{
    "body": "Changing commit from \"134c44f5de3c46de459e9c67ed9daafc15ecb148\" to \"451ebe564d0adf19cf305e413d55b76db1d6b660\"",
    "created_at": "2022-08-28T23:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685809",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "134c44f5de3c46de459e9c67ed9daafc15ecb148" to "451ebe564d0adf19cf305e413d55b76db1d6b660"



---

archive/issue_comments_685810.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-29T02:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685810",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_685811.json:
```json
{
    "body": "<a id='comment:14'></a>Bots are green, back to positive review (hoping that's OK)",
    "created_at": "2022-08-29T02:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685811",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Bots are green, back to positive review (hoping that's OK)



---

archive/issue_comments_685812.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-30T19:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685812",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_685813.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/common_base_class_for_finiterankfreemodule_and_tensorfreemodule\" to \"451ebe564d0adf19cf305e413d55b76db1d6b660\"",
    "created_at": "2022-08-30T19:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34424#issuecomment-685813",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/common_base_class_for_finiterankfreemodule_and_tensorfreemodule" to "451ebe564d0adf19cf305e413d55b76db1d6b660"



---

archive/issue_events_089503.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-30T19:05:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34424",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34424#event-89503"
}
```
