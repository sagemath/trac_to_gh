# Issue 34400: EnumeratedSets: Add method 'tuple', avoid making copies

archive/issues_034163.json:
```json
{
    "body": "CC:  @tscrim @seblabbe @fchapoton @nthiery\n\nWe change the attribute `_list` to actually store a `tuple` of the elements and switch methods such as `_iterator_from_list` to use the new `tuple` method instead of going through `list` (which makes a copy every time).\n\n```\nsage: L = list(range(100))\nsage: %timeit list(L)\n341 ns \u00b1 5.13 ns per loop (mean \u00b1 std. dev. of 7 runs, 1,000,000 loops each)\nsage: %timeit tuple(L)\n320 ns \u00b1 9.19 ns per loop (mean \u00b1 std. dev. of 7 runs, 1,000,000 loops each)\nsage: T = tuple(range(100))\nsage: %timeit list(T)\n354 ns \u00b1 2.88 ns per loop (mean \u00b1 std. dev. of 7 runs, 1,000,000 loops each)\nsage: %timeit tuple(T)\n53.5 ns \u00b1 0.764 ns per loop (mean \u00b1 std. dev. of 7 runs, 10,000,000 loops each)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34400\n\n",
    "closed_at": "2022-08-30T19:05:10Z",
    "created_at": "2022-08-20T20:27:36Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "EnumeratedSets: Add method 'tuple', avoid making copies",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34400",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @tscrim @seblabbe @fchapoton @nthiery

We change the attribute `_list` to actually store a `tuple` of the elements and switch methods such as `_iterator_from_list` to use the new `tuple` method instead of going through `list` (which makes a copy every time).

```
sage: L = list(range(100))
sage: %timeit list(L)
341 ns ± 5.13 ns per loop (mean ± std. dev. of 7 runs, 1,000,000 loops each)
sage: %timeit tuple(L)
320 ns ± 9.19 ns per loop (mean ± std. dev. of 7 runs, 1,000,000 loops each)
sage: T = tuple(range(100))
sage: %timeit list(T)
354 ns ± 2.88 ns per loop (mean ± std. dev. of 7 runs, 1,000,000 loops each)
sage: %timeit tuple(T)
53.5 ns ± 0.764 ns per loop (mean ± std. dev. of 7 runs, 10,000,000 loops each)
```


Issue created by migration from https://trac.sagemath.org/ticket/34400





---

archive/issue_comments_484212.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-08-20T23:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484212",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_484213.json:
```json
{
    "body": "Existing classes that define specialized `list` methods can (but don't have to be) changed to define `tuple` methods instead to avoid a tiny bit of copying overhead",
    "created_at": "2022-08-21T00:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484213",
    "user": "https://github.com/mkoeppe"
}
```

Existing classes that define specialized `list` methods can (but don't have to be) changed to define `tuple` methods instead to avoid a tiny bit of copying overhead



---

archive/issue_comments_484214.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-21T00:51:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_484215.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-21T01:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484215",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_484216.json:
```json
{
    "body": "Other than adding at least one doctest to the added methods, LGTM. This is a good idea.",
    "created_at": "2022-08-24T00:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484216",
    "user": "https://github.com/tscrim"
}
```

Other than adding at least one doctest to the added methods, LGTM. This is a good idea.



---

archive/issue_comments_484217.json:
```json
{
    "body": "Ah right, I'll add some tests",
    "created_at": "2022-08-24T01:02:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484217",
    "user": "https://github.com/mkoeppe"
}
```

Ah right, I'll add some tests



---

archive/issue_comments_484218.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-24T01:26:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484218",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_484219.json:
```json
{
    "body": "Thanks. Green bot => positive review.",
    "created_at": "2022-08-24T01:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484219",
    "user": "https://github.com/tscrim"
}
```

Thanks. Green bot => positive review.



---

archive/issue_comments_484220.json:
```json
{
    "body": "Actually, you missed `def tuple(self):` in `finite_enumerated_sets.py`.",
    "created_at": "2022-08-24T01:42:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484220",
    "user": "https://github.com/tscrim"
}
```

Actually, you missed `def tuple(self):` in `finite_enumerated_sets.py`.



---

archive/issue_comments_484221.json:
```json
{
    "body": "Indeed. I think my eyeballs need some rest",
    "created_at": "2022-08-24T01:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484221",
    "user": "https://github.com/mkoeppe"
}
```

Indeed. I think my eyeballs need some rest



---

archive/issue_comments_484222.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-24T01:59:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_484223.json:
```json
{
    "body": "Thank you.\n\nTrivial detail that you don't have to do, but `EXAMPLE::` -> `EXAMPLES::` to follow our general practice within Sage.\n\nGreen bot => positive review.",
    "created_at": "2022-08-25T00:27:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484223",
    "user": "https://github.com/tscrim"
}
```

Thank you.

Trivial detail that you don't have to do, but `EXAMPLE::` -> `EXAMPLES::` to follow our general practice within Sage.

Green bot => positive review.



---

archive/issue_comments_484224.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-25T00:50:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484224",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_484225.json:
```json
{
    "body": "Thanks, done.",
    "created_at": "2022-08-25T00:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484225",
    "user": "https://github.com/mkoeppe"
}
```

Thanks, done.



---

archive/issue_comments_484226.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-25T03:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484226",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_484227.json:
```json
{
    "body": "Bots are green",
    "created_at": "2022-08-25T03:21:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484227",
    "user": "https://github.com/mkoeppe"
}
```

Bots are green



---

archive/issue_events_089476.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-30T19:05:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34400#event-89476"
}
```



---

archive/issue_comments_484228.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-08-30T19:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34400",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34400#issuecomment-484228",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
