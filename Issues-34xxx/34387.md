# Issue 34387: Set() should construct facade parents or use ElementWrapper

archive/issues_034150.json:
```json
{
    "body": "Currently, `Set(...)` does not always construct an object with the full set of set operations.\n\n```\nsage: P = Set(Primes()); P\nSet of all prime numbers: 2, 3, 5, 7, ...\nsage: P.union\nAttributeError: 'Primes_with_category' object has no attribute 'union'\nsage: type(P)\n<class 'sage.sets.primes.Primes_with_category'>\n```\nWe change this so that users can rely on the methods provided by the mixins `Set_base`, `Set_boolean_operators`, `Set_add_sub_operators` being available.\n\nWhen `Set(...)` does construct an instance of `Set_object`, this is a parent whose elements do not belong to it. We update the category so that it is in `Sets().Facade()`.\n\nWe add the option `Set(..., universe=...)`. This option will be handled like `Sequence(..., universe=...)`: We convert the given elements to the given parent first. Via #34461, we register a \"pointless\" inclusion map from the set to the universe.\n\nFinally, we add the option `Set(..., facade=False)`. In this case, `Set` will use `ElementWrapper`s.\n\nHere on the ticket we ignore all issues of (1) sets of unhashable elements (#23324, #33932) and (2) abuses of `Set` and `EnumeratedSets` for multisets (#34389).\n\n\nCC:  @tscrim\n\nAuthor: Matthias Koeppe\n\nBranch: u/mkoeppe/set___should_construct_facade_parents\n\nStatus: new\n\nDependencies: #34461\n\nCommit: 9cc1113631116d4be2647b62769fb024fc44edbc\n\nIssue created by migration from https://trac.sagemath.org/ticket/34387\n\n",
    "created_at": "2022-08-18T03:35:08Z",
    "labels": [
        "component: categories"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Set() should construct facade parents or use ElementWrapper",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34387",
    "user": "https://github.com/mkoeppe"
}
```
Currently, `Set(...)` does not always construct an object with the full set of set operations.

```
sage: P = Set(Primes()); P
Set of all prime numbers: 2, 3, 5, 7, ...
sage: P.union
AttributeError: 'Primes_with_category' object has no attribute 'union'
sage: type(P)
<class 'sage.sets.primes.Primes_with_category'>
```
We change this so that users can rely on the methods provided by the mixins `Set_base`, `Set_boolean_operators`, `Set_add_sub_operators` being available.

When `Set(...)` does construct an instance of `Set_object`, this is a parent whose elements do not belong to it. We update the category so that it is in `Sets().Facade()`.

We add the option `Set(..., universe=...)`. This option will be handled like `Sequence(..., universe=...)`: We convert the given elements to the given parent first. Via #34461, we register a "pointless" inclusion map from the set to the universe.

Finally, we add the option `Set(..., facade=False)`. In this case, `Set` will use `ElementWrapper`s.

Here on the ticket we ignore all issues of (1) sets of unhashable elements (#23324, #33932) and (2) abuses of `Set` and `EnumeratedSets` for multisets (#34389).


CC:  @tscrim

Author: Matthias Koeppe

Branch: u/mkoeppe/set___should_construct_facade_parents

Status: new

Dependencies: #34461

Commit: 9cc1113631116d4be2647b62769fb024fc44edbc

Issue created by migration from https://trac.sagemath.org/ticket/34387





---

archive/issue_comments_483984.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2022-08-19T18:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483984",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_483985.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-19T22:02:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483985",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483986.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-19T23:26:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483986",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483987.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-19T23:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483988.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-20T18:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483988",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483989.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-31T01:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483989",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_089457.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34387#event-89457"
}
```



---

archive/issue_comments_483990.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-31T04:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483991.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-31T05:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483991",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483992.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-31T05:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483992",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483993.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-31T15:49:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483993",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483994.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-31T18:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483994",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483995.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-31T21:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483995",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483996.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-01T00:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483996",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483997.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-01T01:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483997",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_483998.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-01T01:33:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34387",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34387#issuecomment-483998",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:
