# Issue 34781: fixing the linter, once again

archive/issues_034544.json:
```json
{
    "body": "mostly broken by fusion_rings and lazy_rings recent tickets\n\nBranch/Commit: fdd4f7f9f0b50a6718eb682d905557f2766f4b4f\n\nReviewer: Matthias Koeppe, Lorenz Panny\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34781\n\n",
    "closed_at": "2022-12-14T22:11:59Z",
    "created_at": "2022-11-23T18:15:39Z",
    "labels": [
        "component: refactoring"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "fixing the linter, once again",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34781",
    "user": "https://github.com/fchapoton"
}
```
mostly broken by fusion_rings and lazy_rings recent tickets

Branch/Commit: fdd4f7f9f0b50a6718eb682d905557f2766f4b4f

Reviewer: Matthias Koeppe, Lorenz Panny

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34781





---

archive/issue_comments_522173.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-11-23T18:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522173",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_522174.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2022-11-23T18:17:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522174",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_522175.json:
```json
{
    "body": "<a id='comment:2'></a>\n```\n310     E275 missing whitespace after keyword\n1       E306 expected 1 blank line before a nested definition, found 0\n6       W391 blank line at end of file\n```",
    "created_at": "2022-11-23T20:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522175",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
```
310     E275 missing whitespace after keyword
1       E306 expected 1 blank line before a nested definition, found 0
6       W391 blank line at end of file
```



---

archive/issue_comments_522176.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-11-23T20:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522176",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_522177.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-24T07:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_522178.json:
```json
{
    "body": "<a id='comment:4'></a>strange, but then let us keep that for later and just fix the linter again here",
    "created_at": "2022-11-24T07:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522178",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>strange, but then let us keep that for later and just fix the linter again here



---

archive/issue_comments_522179.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-11-24T07:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522179",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_522180.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+also fix the recent breakage of the linter\n \n Author: Fr\u00e9d\u00e9ric Chapoton\n \n```\n",
    "created_at": "2022-11-24T07:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522180",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+also fix the recent breakage of the linter
 
 Author: Frédéric Chapoton
 
```




---

archive/issue_comments_522181.json:
```json
{
    "body": "<a id='comment:6'></a>Why are we removing the one blank line at the end of files? The description of W261 does not match its example. Its \"best practice\" has zero blank lines and removing these from the files in this change means they have none. If they are doing some other kind of counting, then it makes no sense to have zero \"blank lines\". I am quite confused by this.",
    "created_at": "2022-11-24T08:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522181",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>Why are we removing the one blank line at the end of files? The description of W261 does not match its example. Its "best practice" has zero blank lines and removing these from the files in this change means they have none. If they are doing some other kind of counting, then it makes no sense to have zero "blank lines". I am quite confused by this.



---

archive/issue_comments_522182.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-24T08:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_522183.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+mostly broken by fusion_rings and lazy_rings recent tickets\n \n Author: Fr\u00e9d\u00e9ric Chapoton\n \n```\n",
    "created_at": "2022-11-24T08:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522183",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+mostly broken by fusion_rings and lazy_rings recent tickets
 
 Author: Frédéric Chapoton
 
```




---

archive/issue_comments_522184.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:6 Travis Scrimshaw]:\n> Why are we removing the one blank line at the end of files? The description of W261 does not match its example. Its \"best practice\" has zero blank lines and removing these from the files in this change means they have none. If they are doing some other kind of counting, then it makes no sense to have zero \"blank lines\". I am quite confused by this.\n\n\nW391\n\nhttps://www.flake8rules.com/rules/W391.html",
    "created_at": "2022-11-24T10:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522184",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>Replying to [comment:6 Travis Scrimshaw]:
> Why are we removing the one blank line at the end of files? The description of W261 does not match its example. Its "best practice" has zero blank lines and removing these from the files in this change means they have none. If they are doing some other kind of counting, then it makes no sense to have zero "blank lines". I am quite confused by this.


W391

https://www.flake8rules.com/rules/W391.html



---

archive/issue_comments_522185.json:
```json
{
    "body": "<a id='comment:10'></a>but indeed the description is faulty\n\nthe good thing is to end by one line break, but no empty lines",
    "created_at": "2022-11-24T10:54:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522185",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>but indeed the description is faulty

the good thing is to end by one line break, but no empty lines



---

archive/issue_comments_522186.json:
```json
{
    "body": "<a id='comment:11'></a>It's not just faulty, it doesn't even satisfy it's own logic. If it ends with a line break, then by definition, there is a blank line. Otherwise there is no line break at the end. If the end of the last line counts (again, what line break?), then how could there possibly be zero?\n\nThe general standard, as I understand it, is to have a blank line. This is what they are claiming too. They have a bug in their implementation with a false example IMO.",
    "created_at": "2022-11-24T11:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522186",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:11'></a>It's not just faulty, it doesn't even satisfy it's own logic. If it ends with a line break, then by definition, there is a blank line. Otherwise there is no line break at the end. If the end of the last line counts (again, what line break?), then how could there possibly be zero?

The general standard, as I understand it, is to have a blank line. This is what they are claiming too. They have a bug in their implementation with a false example IMO.



---

archive/issue_comments_522187.json:
```json
{
    "body": "<a id='comment:12'></a>maybe there is a confusion with \"empty\" meaning \"no characters at all\" or \"just a bunch of spaces\" ? There should be a line break, followed (and preceded) by no spaces.",
    "created_at": "2022-11-24T11:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522187",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>maybe there is a confusion with "empty" meaning "no characters at all" or "just a bunch of spaces" ? There should be a line break, followed (and preceded) by no spaces.



---

archive/issue_comments_522188.json:
```json
{
    "body": "<a id='comment:13'></a>But again, a line break would mean we have a blank line. If what they meant was any type of whitespace, then it would be zero.\n\nHaving exactly one line break means\n\n```\nSomething\\n\n<blankline><EOF>\n```\nOtherwise there would be zero for\n\n```\nSomething<EOF>\n```",
    "created_at": "2022-11-24T11:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522188",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>But again, a line break would mean we have a blank line. If what they meant was any type of whitespace, then it would be zero.

Having exactly one line break means

```
Something\n
<blankline><EOF>
```
Otherwise there would be zero for

```
Something<EOF>
```



---

archive/issue_comments_522189.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:6 Travis Scrimshaw]:\n> I am quite confused by this.\n\n\nYes.\n\n- `Text\\n`, then EOF -- good.\n- `Text`, then EOF -- ungood - non-terminated line at EOF.\n- `Text\\n\\n`, then EOF -- ungood - empty line before EOF.\n- `Text\\n \\n`, then EOF -- ungood - line with trailing space.\n- `Text\\n `, then EOF -- plus ungood - line with trailing space, non-terminated.",
    "created_at": "2022-11-24T20:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522189",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>Replying to [comment:6 Travis Scrimshaw]:
> I am quite confused by this.


Yes.

- `Text\n`, then EOF -- good.
- `Text`, then EOF -- ungood - non-terminated line at EOF.
- `Text\n\n`, then EOF -- ungood - empty line before EOF.
- `Text\n \n`, then EOF -- ungood - line with trailing space.
- `Text\n `, then EOF -- plus ungood - line with trailing space, non-terminated.



---

archive/issue_comments_522190.json:
```json
{
    "body": "<a id='comment:15'></a>I would suggest not to make style changes like this:\n\n```\n-      if a == id_anyon:\n-          if x == b and y == d:\n-              return 1\n-          else:\n-              return 0\n+    if a == id_anyon:\n+        return 1 if x == b and y == d else 0\n```\nI don't think it's universally agreed that this would be an improvement. Personally, I never use `if-else` expressions and I find them harder to read.",
    "created_at": "2022-11-24T20:14:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522190",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:15'></a>I would suggest not to make style changes like this:

```
-      if a == id_anyon:
-          if x == b and y == d:
-              return 1
-          else:
-              return 0
+    if a == id_anyon:
+        return 1 if x == b and y == d else 0
```
I don't think it's universally agreed that this would be an improvement. Personally, I never use `if-else` expressions and I find them harder to read.



---

archive/issue_comments_522191.json:
```json
{
    "body": "<a id='comment:16'></a>maybe this debatable cosmetic change should not prevent to fix the linter as soon as possible ?",
    "created_at": "2022-11-25T08:59:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522191",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>maybe this debatable cosmetic change should not prevent to fix the linter as soon as possible ?



---

archive/issue_comments_522192.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:15 Matthias K\u00f6ppe]:\n> {{{\n> -      if a == id_anyon:\n> -          if x == b and y == d:\n> -              return 1\n> -          else:\n> -              return 0\n> +    if a == id_anyon:\n> +        return 1 if x == b and y == d else 0\n> }}}\n\n\nHow about `int(x == b and y == d)`?",
    "created_at": "2022-11-26T02:53:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522192",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:17'></a>Replying to [comment:15 Matthias Köppe]:
> {{{
> -      if a == id_anyon:
> -          if x == b and y == d:
> -              return 1
> -          else:
> -              return 0
> +    if a == id_anyon:
> +        return 1 if x == b and y == d else 0
> }}}


How about `int(x == b and y == d)`?



---

archive/issue_comments_522193.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-11-26T07:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_522194.json:
```json
{
    "body": "<a id='comment:19'></a>voil\u00e0, done",
    "created_at": "2022-11-26T07:21:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522194",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:19'></a>voilà, done



---

archive/issue_comments_522195.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-11-27T00:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522195",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_522196.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-12-14T22:11:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34781#issuecomment-522196",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_089812.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-12-14T22:11:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34781",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34781#event-89812"
}
```
