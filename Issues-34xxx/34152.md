# Issue 34152: Remove remaining dependencies of bootstrap on gettext (AC_LIB_RPATH etc.)

archive/issues_033915.json:
```json
{
    "assignees": [],
    "body": "**Background**: `./bootstrap` needs about 112 KB of m4 and shell code from `gnulib`: https://www.gnu.org/software/gnulib\nBefore #29549, these files were copied from a system-wide installation of `gettext` (which uses `gnulib`): https://www.gnu.org/software/gettext\n\nAs opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).\n\nWho needs to run `bootstrap` and where:\n- Any developer who switches to a branch that makes an SPKG upgrade or other changes to the build system, on their development machine.\n- Our  [portability testsuite](https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker), run locally using `tox -e docker-...` and on GH Actions, in the Docker container for the tested platform.\n\nWho does not need to run `bootstrap`:\n- Users who only build released versions from tarballs - because they come pre-bootstrapped\n- Users who only build released versions from a git clone - because Sage falls back to downloading a tarball of the `configure` SPKG.\n\n---\n\n**History**: #29549 intended to remove the dependency of `bootstrap` on `gettext`. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800). \n\nThe branch of #29549 followed \"copy files\" approach. However, some files that `gnulib-tool` added were left out from the commit, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n\n---\n\n**This ticket**: \nHere we complete the task and remove `gettext` from various `distros/` files etc.\n\nTwo approaches have been proposed:\n\nmkoeppe (\"copy files\") : [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__ @ 4011cc4608](https://github.com/sagemath/sagetrac-mirror/compare/develop...4011cc4608)\n- Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n- Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n- Introduces no new dependency.\n- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes. (Updates are expected to be necessary only very rarely.)\n- Burden on users and other developers: None.\n- dimpase's criticism of this approach: \"gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating the imported gnulib files is tricky and error-prone by design\". \n\ndimpase (\"Sage pseudo-package\"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).\n- Introduces a new (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).\n- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, verify that the list of files removed by `make bootstrap-clean` is still correct, commit this change \n- Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)\n- mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit.\"\n\nhybrid (\"copy files, spkg-src script for maintenance\"): [Branch u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/config/gnulib)\n- Resolves the criticism on the \"copy files\" approach: \"updating the imported gnulib files\" is now assisted by the `spkg-src` script (adapted from dimpase's branch)\n- Resolves the criticism on the \"Sage pseudo-package\" approach: \"operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)\" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.\n\n---\n\n**Voting took place at https://groups.google.com/g/sage-devel/c/E2qstbWXC7g**\n\n\n\n---\n\nTo test: For example `tox -r -e local-homebrew-macos-minimal -- config.status` \n\n\n\nCC:  @culler @dimpase @kiwifb @isuruf @nbruin\n\nBranch: **[8bf9d97](https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5)**\n\nReviewer: **Fran\u00e7ois Bissey, Dima Pasechnik, Matthias Koeppe, Kwankyu Lee**\n\nAuthor: **Matthias Koeppe, Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34152_\n\n",
    "closed_at": "2022-09-07T23:10:40Z",
    "created_at": "2022-07-11T16:11:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Remove remaining dependencies of bootstrap on gettext (AC_LIB_RPATH etc.)",
    "type": "issue",
    "updated_at": "2022-09-19T23:11:12Z",
    "url": "https://github.com/sagemath/sage/issues/34152",
    "user": "https://github.com/mkoeppe"
}
```
**Background**: `./bootstrap` needs about 112 KB of m4 and shell code from `gnulib`: https://www.gnu.org/software/gnulib
Before #29549, these files were copied from a system-wide installation of `gettext` (which uses `gnulib`): https://www.gnu.org/software/gettext

As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).

Who needs to run `bootstrap` and where:
- Any developer who switches to a branch that makes an SPKG upgrade or other changes to the build system, on their development machine.
- Our  [portability testsuite](https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker), run locally using `tox -e docker-...` and on GH Actions, in the Docker container for the tested platform.

Who does not need to run `bootstrap`:
- Users who only build released versions from tarballs - because they come pre-bootstrapped
- Users who only build released versions from a git clone - because Sage falls back to downloading a tarball of the `configure` SPKG.

---

**History**: #29549 intended to remove the dependency of `bootstrap` on `gettext`. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800). 

The branch of #29549 followed "copy files" approach. However, some files that `gnulib-tool` added were left out from the commit, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ

---

**This ticket**: 
Here we complete the task and remove `gettext` from various `distros/` files etc.

Two approaches have been proposed:

mkoeppe ("copy files") : [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__ @ 4011cc4608](https://github.com/sagemath/sagetrac-mirror/compare/develop...4011cc4608)
- Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
- Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
- Introduces no new dependency.
- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes. (Updates are expected to be necessary only very rarely.)
- Burden on users and other developers: None.
- dimpase's criticism of this approach: "gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating the imported gnulib files is tricky and error-prone by design". 

dimpase ("Sage pseudo-package"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).
- Introduces a new (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).
- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, verify that the list of files removed by `make bootstrap-clean` is still correct, commit this change 
- Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)
- mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit."

hybrid ("copy files, spkg-src script for maintenance"): [Branch u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/config/gnulib)
- Resolves the criticism on the "copy files" approach: "updating the imported gnulib files" is now assisted by the `spkg-src` script (adapted from dimpase's branch)
- Resolves the criticism on the "Sage pseudo-package" approach: "operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.

---

**Voting took place at https://groups.google.com/g/sage-devel/c/E2qstbWXC7g**



---

To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status` 



CC:  @culler @dimpase @kiwifb @isuruf @nbruin

Branch: **[8bf9d97](https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5)**

Reviewer: **François Bissey, Dima Pasechnik, Matthias Koeppe, Kwankyu Lee**

Author: **Matthias Koeppe, Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/34152_





---

archive/issue_events_448999.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-11T16:11:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-448999"
}
```



---

archive/issue_events_449000.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-11T16:11:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449000"
}
```



---

archive/issue_events_449001.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-11T16:11:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449001"
}
```



---

archive/issue_comments_554396.json:
```json
{
    "body": "Branch: **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)**",
    "created_at": "2022-07-11T16:15:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554396",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)**



---

archive/issue_comments_554397.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312\">65638b4</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr></table>\n",
    "created_at": "2022-07-11T16:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554397",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">Comment 2</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312">65638b4</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr></table>




---

archive/issue_comments_554398.json:
```json
{
    "body": "Commit: **[65638b4](https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312)**",
    "created_at": "2022-07-11T16:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554398",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[65638b4](https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312)**



---

archive/issue_comments_554399.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2022-07-11T16:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554399",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_events_449002.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-11T16:15:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build%3A%20configure",
    "label_color": "000080",
    "label_name": "component: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449002"
}
```



---

archive/issue_comments_554400.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,3 @@\n Broken in #29549, because I forgot to add some files.\n \n+Reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n``````\n",
    "created_at": "2022-07-11T16:17:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554400",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,3 @@
 Broken in #29549, because I forgot to add some files.
 
+Reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ
``````




---

archive/issue_events_449003.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-11T16:17:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449003"
}
```



---

archive/issue_comments_554401.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6\">4011cc4</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr></table>\n",
    "created_at": "2022-07-11T16:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554401",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4" align="right">Comment 4</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6">4011cc4</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr></table>




---

archive/issue_comments_554402.json:
```json
{
    "body": "Changed commit from **[65638b4](https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312)** to **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)**",
    "created_at": "2022-07-11T16:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554402",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[65638b4](https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312)** to **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)**



---

archive/issue_comments_554403.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Broken in #29549, because I forgot to add some files.\n \n+Also, `gettext` is no longer a bootstrapping prerequisite, so we remove it from various `distros/` files etc.\n+\n Reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n``````\n",
    "created_at": "2022-07-11T16:35:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554403",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Broken in #29549, because I forgot to add some files.
 
+Also, `gettext` is no longer a bootstrapping prerequisite, so we remove it from various `distros/` files etc.
+
 Reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ
``````




---

archive/issue_comments_554404.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nvendoring more and more of gnulib...\n\nshould we instead install,on demand, gnulib itself?",
    "created_at": "2022-07-11T18:18:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554404",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">Comment 6</div>

vendoring more and more of gnulib...

should we instead install,on demand, gnulib itself?



---

archive/issue_comments_554405.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nThis is how Gnulib is designed to be used. \n\"Its components are intended to be shared at the source level, rather than being a library that gets built, installed, and linked against. Thus, there is no distribution tarball; the idea is to copy files from Gnulib into your own source tree.\"\nhttps://www.gnu.org/software/gnulib/",
    "created_at": "2022-07-11T19:18:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554405",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">Comment 7</div>

This is how Gnulib is designed to be used. 
"Its components are intended to be shared at the source level, rather than being a library that gets built, installed, and linked against. Thus, there is no distribution tarball; the idea is to copy files from Gnulib into your own source tree."
https://www.gnu.org/software/gnulib/



---

archive/issue_comments_554406.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nit seems that \"copying\" is meant to be done from an installed `gnulib` version.\nThat's how I read https://www.mail-archive.com/bug-gnulib@gnu.org/msg36476.html\nwhere a way to do this is discussed.\n`gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh",
    "created_at": "2022-07-11T22:35:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554406",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">Comment 8</div>

it seems that "copying" is meant to be done from an installed `gnulib` version.
That's how I read https://www.mail-archive.com/bug-gnulib@gnu.org/msg36476.html
where a way to do this is discussed.
`gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh



---

archive/issue_comments_554407.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nThere's no such thing as an \"installed\" gnulib.",
    "created_at": "2022-07-11T22:38:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554407",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">Comment 9</div>

There's no such thing as an "installed" gnulib.



---

archive/issue_comments_554408.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nThe workflow with gnulib is documented in https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html",
    "created_at": "2022-07-11T22:46:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554408",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">Comment 10</div>

The workflow with gnulib is documented in https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html



---

archive/issue_comments_554409.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nReplying to [@dimpase](#comment%3A8):\n> `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh\n\nfrom https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh#L36:\n\"The package maintainer may choose to use or not use git submodules.\" - I chose to not use git submodules.",
    "created_at": "2022-07-11T22:53:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554409",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">Comment 11</div>

Replying to [@dimpase](#comment%3A8):
> `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh

from https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh#L36:
"The package maintainer may choose to use or not use git submodules." - I chose to not use git submodules.



---

archive/issue_comments_554410.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@mkoeppe](#comment%3A9):\n> There's no such thing as an \"installed\" gnulib.\n\nthere certainly is an executable/script called `gnulib-tool` - which is certainly a part of installed gnulib",
    "created_at": "2022-07-11T22:54:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554410",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@mkoeppe](#comment%3A9):
> There's no such thing as an "installed" gnulib.

there certainly is an executable/script called `gnulib-tool` - which is certainly a part of installed gnulib



---

archive/issue_comments_554411.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\n\"gnulib-tool is not installed in a standard directory that is contained in the PATH variable. It needs to be run directly in the directory that contains the Gnulib source code.\" https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html",
    "created_at": "2022-07-11T23:04:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554411",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:13" align="right">Comment 13</div>

"gnulib-tool is not installed in a standard directory that is contained in the PATH variable. It needs to be run directly in the directory that contains the Gnulib source code." https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html



---

archive/issue_comments_554412.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\n> gnulib-tool is not installed in a standard directory that is contained in the PATH variable\n\nOK, fine, but its directory has to appear somehow",
    "created_at": "2022-07-11T23:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554412",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">Comment 14</div>

> gnulib-tool is not installed in a standard directory that is contained in the PATH variable

OK, fine, but its directory has to appear somehow



---

archive/issue_comments_554413.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nYes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.",
    "created_at": "2022-07-11T23:08:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554413",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:15" align="right">Comment 15</div>

Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.



---

archive/issue_comments_554414.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nReplying to [@mkoeppe](#comment%3A11):\n> Replying to [@dimpase](#comment%3A8):\n> > `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh\n\n> \n> from https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html:\n> \"The package maintainer may choose to use or not use git submodules.\" - I chose to not use git submodules.\n> \n\nThe quote you attribute to `Invoking-gnulib_002dtool.html` is actually from `gitsub.sh`.\n\n`gitsub.sh` can do `subcheckouts` rather than `submodules`.\n\nThe docs don't even discuss manual vendoring of files, I think.",
    "created_at": "2022-07-11T23:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554414",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">Comment 16</div>

Replying to [@mkoeppe](#comment%3A11):
> Replying to [@dimpase](#comment%3A8):
> > `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh

> 
> from https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html:
> "The package maintainer may choose to use or not use git submodules." - I chose to not use git submodules.
> 

The quote you attribute to `Invoking-gnulib_002dtool.html` is actually from `gitsub.sh`.

`gitsub.sh` can do `subcheckouts` rather than `submodules`.

The docs don't even discuss manual vendoring of files, I think.



---

archive/issue_comments_554415.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nReplying to [@dimpase](#comment%3A16):\n> Replying to [@mkoeppe](#comment%3A11):\n> > Replying to [@dimpase](#comment%3A8):\n> > > `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh\n\n> > \n> > from https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html:\n> > \"The package maintainer may choose to use or not use git submodules.\" - I chose to not use git submodules.\n> > \n\n> \n> The quote you attribute to `Invoking-gnulib_002dtool.html` is actually from `gitsub.sh`.\n\nYes, sorry, wrong link.\nFixed now: I meant to paste https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh#L36",
    "created_at": "2022-07-11T23:11:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554415",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">Comment 17</div>

Replying to [@dimpase](#comment%3A16):
> Replying to [@mkoeppe](#comment%3A11):
> > Replying to [@dimpase](#comment%3A8):
> > > `gnulib` has a script to facilitate such an installation: https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh

> > 
> > from https://www.gnu.org/software/gnulib/manual/html_node/Invoking-gnulib_002dtool.html:
> > "The package maintainer may choose to use or not use git submodules." - I chose to not use git submodules.
> > 

> 
> The quote you attribute to `Invoking-gnulib_002dtool.html` is actually from `gitsub.sh`.

Yes, sorry, wrong link.
Fixed now: I meant to paste https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh#L36



---

archive/issue_comments_554416.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nReplying to [@dimpase](#comment%3A16):\n> The docs don't even discuss manual vendoring of files, I think.\n\nPlease, Dima, the whole manual talks about nothing else.",
    "created_at": "2022-07-11T23:13:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554416",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:18" align="right">Comment 18</div>

Replying to [@dimpase](#comment%3A16):
> The docs don't even discuss manual vendoring of files, I think.

Please, Dima, the whole manual talks about nothing else.



---

archive/issue_comments_554417.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nReplying to [@mkoeppe](#comment%3A15):\n> Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.\n\nbut not manually - rather, as a part of pre-configuring a project. Checking in our repo huge chunks of gnulib is suboptimal.",
    "created_at": "2022-07-11T23:13:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554417",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">Comment 19</div>

Replying to [@mkoeppe](#comment%3A15):
> Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.

but not manually - rather, as a part of pre-configuring a project. Checking in our repo huge chunks of gnulib is suboptimal.



---

archive/issue_comments_554418.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nReplying to [@dimpase](#comment%3A19):\n> Replying to [@mkoeppe](#comment%3A15):\n> > Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.\n\n> \n> but not manually\n\nIt's called the \"initial import\". https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html\nThis is what I did in #29549 (except that I forgot to `git add` some files).",
    "created_at": "2022-07-11T23:15:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554418",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">Comment 20</div>

Replying to [@dimpase](#comment%3A19):
> Replying to [@mkoeppe](#comment%3A15):
> > Yes, a developer who wants to update the portions of Gnulib that have been copied into the source tree will use a git clone of gnulib and invoke gnulib-tool from there.

> 
> but not manually

It's called the "initial import". https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html
This is what I did in #29549 (except that I forgot to `git add` some files).



---

archive/issue_comments_554419.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nReplying to [@mkoeppe](#comment%3A18):\n> Replying to [@dimpase](#comment%3A16):\n> > The docs don't even discuss manual vendoring of files, I think.\n\n> \n> Please, Dima, the whole manual talks about nothing else.\n\nThis manual is older than `git`, you know, no wonder it won't mention it.\n\n`gitsub.sh` is for the modern way of doing things, and that's what `gnulib` maintainer uses.",
    "created_at": "2022-07-11T23:19:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554419",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:21" align="right">Comment 21</div>

Replying to [@mkoeppe](#comment%3A18):
> Replying to [@dimpase](#comment%3A16):
> > The docs don't even discuss manual vendoring of files, I think.

> 
> Please, Dima, the whole manual talks about nothing else.

This manual is older than `git`, you know, no wonder it won't mention it.

`gitsub.sh` is for the modern way of doing things, and that's what `gnulib` maintainer uses.



---

archive/issue_comments_554420.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@dimpase](#comment%3A21):\n> `gitsub.sh` is for the modern way of doing things, and that's what `gnulib` maintainer uses.\n\nIt's a new option of how to work with gnulib, but it offers no benefits for us.",
    "created_at": "2022-07-11T23:23:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554420",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@dimpase](#comment%3A21):
> `gitsub.sh` is for the modern way of doing things, and that's what `gnulib` maintainer uses.

It's a new option of how to work with gnulib, but it offers no benefits for us.



---

archive/issue_comments_554421.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nReplying to [@dimpase](#comment%3A21):\n> This manual is older than `git`, you know, no wonder it won't mention it.\n\nUse with git is documented in https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html; it describes several approaches.",
    "created_at": "2022-07-11T23:27:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554421",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:23" align="right">Comment 23</div>

Replying to [@dimpase](#comment%3A21):
> This manual is older than `git`, you know, no wonder it won't mention it.

Use with git is documented in https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html; it describes several approaches.



---

archive/issue_comments_554422.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nReplying to [@dimpase](#comment%3A19):\n> Checking in our repo huge chunks of gnulib is suboptimal.\n\n#29549 added 2 files, the current ticket is adding 4 more.",
    "created_at": "2022-07-11T23:31:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554422",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">Comment 24</div>

Replying to [@dimpase](#comment%3A19):
> Checking in our repo huge chunks of gnulib is suboptimal.

#29549 added 2 files, the current ticket is adding 4 more.



---

archive/issue_comments_554423.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nyes, about 5000 loc, likely to cause trouble if not updated on time.\n\ndownstreams wouldn't be happy, maintenance is problematic.\n\nwhy vendor if it can be avoided?",
    "created_at": "2022-07-12T07:03:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554423",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">Comment 25</div>

yes, about 5000 loc, likely to cause trouble if not updated on time.

downstreams wouldn't be happy, maintenance is problematic.

why vendor if it can be avoided?



---

archive/issue_comments_554424.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nOnce again, this is the standard way to use gnulib.",
    "created_at": "2022-07-12T07:14:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554424",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">Comment 26</div>

Once again, this is the standard way to use gnulib.



---

archive/issue_comments_554425.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nReplying to [@dimpase](#comment%3A25):\n> why vendor if it can be avoided?\n\nBecause the alternative (the `gitsub.sh` -- which is to be copied into the source tree by the way) introduces a ridiculous amount of complexity.",
    "created_at": "2022-07-12T07:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554425",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">Comment 27</div>

Replying to [@dimpase](#comment%3A25):
> why vendor if it can be avoided?

Because the alternative (the `gitsub.sh` -- which is to be copied into the source tree by the way) introduces a ridiculous amount of complexity.



---

archive/issue_comments_554426.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nHow about just requiring `gnulib-tool` ? macOS purists may have to jump an extra hoop, but it's very minor.",
    "created_at": "2022-07-12T08:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554426",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">Comment 28</div>

How about just requiring `gnulib-tool` ? macOS purists may have to jump an extra hoop, but it's very minor.



---

archive/issue_comments_554427.json:
```json
{
    "body": "Changed commit from **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)** to **[02ea3ca](https://github.com/sagemath/sagetrac-mirror/commit/02ea3caf7a75fb9b914dd2ab0d57648e567ce660)**",
    "created_at": "2022-07-12T11:42:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554427",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)** to **[02ea3ca](https://github.com/sagemath/sagetrac-mirror/commit/02ea3caf7a75fb9b914dd2ab0d57648e567ce660)**



---

archive/issue_comments_554428.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nhere is a way to use gnulib-tool instead.\n\nBased on the original branch of this ticket.\nBy the way, I also noticed that gettext is still mentioned in a lot of `tox`-related and CI-related files.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6679325ea9d68506aaa81abe20aedd95686635fd\">6679325</a></td><td><code>Revert \"m4/: Add missing dependencies of iconv.m4\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fcd5c6ca0cfb71ee47462d51bcd4353d6ffe2b9f\">fcd5c6c</a></td><td><code>don't vendor gnulib files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02ea3caf7a75fb9b914dd2ab0d57648e567ce660\">02ea3ca</a></td><td><code>use gnulib-tool from ./bootstrap</code></td></tr></table>\n",
    "created_at": "2022-07-12T11:42:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554428",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:29" align="right">Comment 29</div>

here is a way to use gnulib-tool instead.

Based on the original branch of this ticket.
By the way, I also noticed that gettext is still mentioned in a lot of `tox`-related and CI-related files.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6679325ea9d68506aaa81abe20aedd95686635fd">6679325</a></td><td><code>Revert "m4/: Add missing dependencies of iconv.m4"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fcd5c6ca0cfb71ee47462d51bcd4353d6ffe2b9f">fcd5c6c</a></td><td><code>don't vendor gnulib files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02ea3caf7a75fb9b914dd2ab0d57648e567ce660">02ea3ca</a></td><td><code>use gnulib-tool from ./bootstrap</code></td></tr></table>




---

archive/issue_comments_554429.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)** to **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)**",
    "created_at": "2022-07-12T11:42:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554429",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)** to **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)**



---

archive/issue_comments_554430.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2022-07-12T11:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554430",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_554431.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nNo, we cannot assume that `gnulib-tool` (= all of gnulib) is available in the system.",
    "created_at": "2022-07-12T12:57:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554431",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:31" align="right">Comment 31</div>

No, we cannot assume that `gnulib-tool` (= all of gnulib) is available in the system.



---

archive/issue_comments_554432.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\n... because [comment:9](#comment%3A9)",
    "created_at": "2022-07-12T13:54:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554432",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:32" align="right">Comment 32</div>

... because [comment:9](#comment%3A9)



---

archive/issue_comments_554433.json:
```json
{
    "body": "Changed commit from **[02ea3ca](https://github.com/sagemath/sagetrac-mirror/commit/02ea3caf7a75fb9b914dd2ab0d57648e567ce660)** to **[f5a9f50](https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505)**",
    "created_at": "2022-07-12T14:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554433",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[02ea3ca](https://github.com/sagemath/sagetrac-mirror/commit/02ea3caf7a75fb9b914dd2ab0d57648e567ce660)** to **[f5a9f50](https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505)**



---

archive/issue_comments_554434.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505\">f5a9f50</a></td><td><code>git-ignore everything installed by gnulib-tool</code></td></tr></table>\n",
    "created_at": "2022-07-12T14:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554434",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33" align="right">Comment 33</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505">f5a9f50</a></td><td><code>git-ignore everything installed by gnulib-tool</code></td></tr></table>




---

archive/issue_comments_554435.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nReplying to [@mkoeppe](#comment%3A32):\n> ... because [comment:9](#comment%3A9)\n\nall the systems I checked either have `gnulib` package (with a reasonably recent, complete, version of `gnuilib`), or none at all, and then\nit can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)",
    "created_at": "2022-07-12T14:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554435",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">Comment 34</div>

Replying to [@mkoeppe](#comment%3A32):
> ... because [comment:9](#comment%3A9)

all the systems I checked either have `gnulib` package (with a reasonably recent, complete, version of `gnuilib`), or none at all, and then
it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)



---

archive/issue_comments_554436.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nReplying to [@dimpase](#comment%3A34):\n> or none at all\n\nexactly, that's the problem\n\n> and then\n> it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)\n\nBut we certainly do not want to force every developer who wants to run `./bootstrap` to do that.",
    "created_at": "2022-07-12T15:03:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554436",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:36" align="right">Comment 36</div>

Replying to [@dimpase](#comment%3A34):
> or none at all

exactly, that's the problem

> and then
> it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)

But we certainly do not want to force every developer who wants to run `./bootstrap` to do that.



---

archive/issue_comments_554437.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nReplying to [@mkoeppe](#comment%3A36):\n> Replying to [@dimpase](#comment%3A34):\n> > or none at all\n\n> \n> exactly, that's the problem\n> \n> > and then\n> > it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)\n\n> \n> But we certainly do not want to force every developer who wants to run `./bootstrap` to do that.\n\nonly these who use macOS and only these who do not use anything but Xcode might have to do this. And among the latter only these who need to  build ./configure\n\nIt's certainly not \"every developer\".",
    "created_at": "2022-07-12T16:14:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554437",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">Comment 37</div>

Replying to [@mkoeppe](#comment%3A36):
> Replying to [@dimpase](#comment%3A34):
> > or none at all

> 
> exactly, that's the problem
> 
> > and then
> > it can be installed (ok, ok, cloned from its repo, and PATH adjusted accordingly)

> 
> But we certainly do not want to force every developer who wants to run `./bootstrap` to do that.

only these who use macOS and only these who do not use anything but Xcode might have to do this. And among the latter only these who need to  build ./configure

It's certainly not "every developer".



---

archive/issue_comments_554438.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nAssuming that gnulib is installed in the system directly contradicts the intentions of upstream.\n\nAnd neither homebrew nor conda have a gnulib package.",
    "created_at": "2022-07-12T16:19:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554438",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:38" align="right">Comment 38</div>

Assuming that gnulib is installed in the system directly contradicts the intentions of upstream.

And neither homebrew nor conda have a gnulib package.



---

archive/issue_comments_554439.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nReplying to [@mkoeppe](#comment%3A38):\n> Assuming that gnulib is installed in the system directly contradicts the intentions of upstream.\n\none would expect the system maintainers to update reasonably often.\n(indeed, e.g. on Debian stable and Fedora 34 gnulib is dated 2021; it appears that https://repology.org/project/gnulib/versions is not complete/up to date, e.g. is doesn't show Fedora packages).\n\nNo need for us to do this maintainance job.\n\n> \n> And neither homebrew nor conda have a gnulib package.\n\nfor Homebrew we can actually make one; not sure how hard it's for conda",
    "created_at": "2022-07-12T16:35:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554439",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:39" align="right">Comment 39</div>

Replying to [@mkoeppe](#comment%3A38):
> Assuming that gnulib is installed in the system directly contradicts the intentions of upstream.

one would expect the system maintainers to update reasonably often.
(indeed, e.g. on Debian stable and Fedora 34 gnulib is dated 2021; it appears that https://repology.org/project/gnulib/versions is not complete/up to date, e.g. is doesn't show Fedora packages).

No need for us to do this maintainance job.

> 
> And neither homebrew nor conda have a gnulib package.

for Homebrew we can actually make one; not sure how hard it's for conda



---

archive/issue_comments_554440.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nLet me try to explain it again:\n\nUpstream states clearly that gnulib is not to be installed.\nAnd indeed, it does not have a `make install` target.\n\nWhen Debian/Fedora/... are shipping gnulib, it is likely for the purpose of implementing their policy when building packages -- i.e., updating the vendored portions of gnulib of a package before starting the build.",
    "created_at": "2022-07-12T16:55:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554440",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:40" align="right">Comment 40</div>

Let me try to explain it again:

Upstream states clearly that gnulib is not to be installed.
And indeed, it does not have a `make install` target.

When Debian/Fedora/... are shipping gnulib, it is likely for the purpose of implementing their policy when building packages -- i.e., updating the vendored portions of gnulib of a package before starting the build.



---

archive/issue_comments_554441.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nReplying to [@mkoeppe](#comment%3A40):\n> Let me try to explain it again:\n> \n> Upstream states clearly that gnulib is not to be installed.\n> And indeed, it does not have a `make install` target.\n> \n> When !Debian/Fedora/... are shipping gnulib, it is likely for the purpose of implementing their policy when building packages -- i.e., updating the vendored portions of gnulib of a package before starting the build.\n\nMy reading is that gnulib's upstream doesn't want gnulib to be vendored, either, as it leads to using outdated gnulib.\nThe upstream wants a fresh version to be used (well, this is understandable). That's why they promote `gitsub.sh`.",
    "created_at": "2022-07-12T17:13:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554441",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:41" align="right">Comment 41</div>

Replying to [@mkoeppe](#comment%3A40):
> Let me try to explain it again:
> 
> Upstream states clearly that gnulib is not to be installed.
> And indeed, it does not have a `make install` target.
> 
> When !Debian/Fedora/... are shipping gnulib, it is likely for the purpose of implementing their policy when building packages -- i.e., updating the vendored portions of gnulib of a package before starting the build.

My reading is that gnulib's upstream doesn't want gnulib to be vendored, either, as it leads to using outdated gnulib.
The upstream wants a fresh version to be used (well, this is understandable). That's why they promote `gitsub.sh`.



---

archive/issue_comments_554442.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nReplying to [@dimpase](#comment%3A41):\n> My reading is that gnulib's upstream doesn't want gnulib to be vendored\n\nMy branch does not \"vendor\" gnulib. It has imported the needed gnulib modules into our source tree. This is the standard documented usage.",
    "created_at": "2022-07-12T17:16:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554442",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:42" align="right">Comment 42</div>

Replying to [@dimpase](#comment%3A41):
> My reading is that gnulib's upstream doesn't want gnulib to be vendored

My branch does not "vendor" gnulib. It has imported the needed gnulib modules into our source tree. This is the standard documented usage.



---

archive/issue_comments_554443.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nReplying to [@dimpase](#comment%3A41):\n> That's why they promote `gitsub.sh`.\n\nThey don't \"promote\" it. The entire manual only *mentions* the existence of this file. see https://www.gnu.org/software/gnulib/manual/gnulib.html",
    "created_at": "2022-07-12T17:25:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554443",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:43" align="right">Comment 43</div>

Replying to [@dimpase](#comment%3A41):
> That's why they promote `gitsub.sh`.

They don't "promote" it. The entire manual only *mentions* the existence of this file. see https://www.gnu.org/software/gnulib/manual/gnulib.html



---

archive/issue_comments_554444.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nReplying to [@dimpase](#comment%3A41):\n> The upstream wants a fresh version to be used\n\nBut not \"fresh\" as in \"whatever is in upstream gnulib HEAD\" whenever someone runs `./bootstrap`.\n\nUpdating the imported gnulib modules is something that the maintainer of a package does explicitly. For example, gettext does use `gitsub.sh` (in \"submodule\" mode): updating is done by a maintainer - that's a commit.",
    "created_at": "2022-07-12T17:40:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554444",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:44" align="right">Comment 44</div>

Replying to [@dimpase](#comment%3A41):
> The upstream wants a fresh version to be used

But not "fresh" as in "whatever is in upstream gnulib HEAD" whenever someone runs `./bootstrap`.

Updating the imported gnulib modules is something that the maintainer of a package does explicitly. For example, gettext does use `gitsub.sh` (in "submodule" mode): updating is done by a maintainer - that's a commit.



---

archive/issue_comments_554445.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nthe relationship between gettext and gnulib is akin to the relationship between individual strands of pasta in a spaghetti bowl :-)",
    "created_at": "2022-07-12T18:27:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554445",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:45" align="right">Comment 45</div>

the relationship between gettext and gnulib is akin to the relationship between individual strands of pasta in a spaghetti bowl :-)



---

archive/issue_comments_554446.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nReplying to [@mkoeppe](#comment%3A44):\n> Replying to [@dimpase](#comment%3A41):\n> > The upstream wants a fresh version to be used\n\n> \n> But not \"fresh\" as in \"whatever is in upstream gnulib HEAD\" whenever someone runs `./bootstrap`.\n> \n\nbut, how fresh? Do they advice to age a version in a wine cask? \n\n\n> Updating the imported gnulib modules is something that the maintainer of a package does explicitly. For example, gettext does use `gitsub.sh` (in \"submodule\" mode): updating is done by a maintainer - that's a commit.\n\nAren't they maintained by the same people?",
    "created_at": "2022-07-12T18:31:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554446",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:46" align="right">Comment 46</div>

Replying to [@mkoeppe](#comment%3A44):
> Replying to [@dimpase](#comment%3A41):
> > The upstream wants a fresh version to be used

> 
> But not "fresh" as in "whatever is in upstream gnulib HEAD" whenever someone runs `./bootstrap`.
> 

but, how fresh? Do they advice to age a version in a wine cask? 


> Updating the imported gnulib modules is something that the maintainer of a package does explicitly. For example, gettext does use `gitsub.sh` (in "submodule" mode): updating is done by a maintainer - that's a commit.

Aren't they maintained by the same people?



---

archive/issue_comments_554447.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nReplying to [@dimpase](#comment%3A46):\n> Replying to [@mkoeppe](#comment%3A44):\n> > Replying to [@dimpase](#comment%3A41):\n> > > The upstream wants a fresh version to be used\n\n> > \n> > But not \"fresh\" as in \"whatever is in upstream gnulib HEAD\" whenever someone runs `./bootstrap`.\n> > \n\n> \n> but, how fresh?\n\nUpdate, test, commit, as usual",
    "created_at": "2022-07-12T18:34:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554447",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:47" align="right">Comment 47</div>

Replying to [@dimpase](#comment%3A46):
> Replying to [@mkoeppe](#comment%3A44):
> > Replying to [@dimpase](#comment%3A41):
> > > The upstream wants a fresh version to be used

> > 
> > But not "fresh" as in "whatever is in upstream gnulib HEAD" whenever someone runs `./bootstrap`.
> > 

> 
> but, how fresh?

Update, test, commit, as usual



---

archive/issue_comments_554448.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nthe gettext worked for us without committing any files/modules from it, at all. I don't see how using gnulib instead is going to break anything.",
    "created_at": "2022-07-12T18:46:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554448",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:48" align="right">Comment 48</div>

the gettext worked for us without committing any files/modules from it, at all. I don't see how using gnulib instead is going to break anything.



---

archive/issue_comments_554449.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nBefore #29549, we were getting our files at `./bootstrap` time from a system installation of `gettextize`. `gettextize` has the files that we need because gettext has imported these gnulib modules - see for example https://github.com/autotools-mirror/gettext/blob/master/autogen.sh#L168 for iconv.",
    "created_at": "2022-07-12T18:57:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554449",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:49" align="right">Comment 49</div>

Before #29549, we were getting our files at `./bootstrap` time from a system installation of `gettextize`. `gettextize` has the files that we need because gettext has imported these gnulib modules - see for example https://github.com/autotools-mirror/gettext/blob/master/autogen.sh#L168 for iconv.



---

archive/issue_comments_554450.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\n#29549 followed the advice from Bruno Haible that you relayed in [#27823 comment:52](https://github.com/sagemath/sage/issues/27823#comment:52) ([#29549 comment:3](https://github.com/sagemath/sage/issues/29549#comment:3)). \nExcept for the mistake of forgetting `git add` for some of the files, which is entirely my own.",
    "created_at": "2022-07-12T19:04:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554450",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:50" align="right">Comment 50</div>

#29549 followed the advice from Bruno Haible that you relayed in [#27823 comment:52](https://github.com/sagemath/sage/issues/27823#comment:52) ([#29549 comment:3](https://github.com/sagemath/sage/issues/29549#comment:3)). 
Except for the mistake of forgetting `git add` for some of the files, which is entirely my own.



---

archive/issue_comments_554451.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312\">65638b4</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6\">4011cc4</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr></table>\n",
    "created_at": "2022-07-12T20:35:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554451",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:51" align="right">Comment 51</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312">65638b4</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6">4011cc4</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr></table>




---

archive/issue_comments_554452.json:
```json
{
    "body": "Changed branch from **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)** to **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)**",
    "created_at": "2022-07-12T20:35:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554452",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)** to **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)**



---

archive/issue_comments_554453.json:
```json
{
    "body": "Changed commit from **[f5a9f50](https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505)** to **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)**",
    "created_at": "2022-07-12T20:35:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554453",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[f5a9f50](https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505)** to **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)**



---

archive/issue_comments_554454.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nI don't see how advice from Haible says that importing means copying+committing, rather than calling gnulib-tool every time autoconf has to be run.",
    "created_at": "2022-07-12T20:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554454",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:52" align="right">Comment 52</div>

I don't see how advice from Haible says that importing means copying+committing, rather than calling gnulib-tool every time autoconf has to be run.



---

archive/issue_comments_554455.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nReplying to [@dimpase](#comment%3A52):\n> I don't see how advice from Haible says that importing means copying+committing\n\nThat message only says, don't try to get it from gettext, get it from gnulib instead.",
    "created_at": "2022-07-12T21:01:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554455",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:53" align="right">Comment 53</div>

Replying to [@dimpase](#comment%3A52):
> I don't see how advice from Haible says that importing means copying+committing

That message only says, don't try to get it from gettext, get it from gnulib instead.



---

archive/issue_comments_554456.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\nI responded to your question in [comment:48](#comment%3A48).",
    "created_at": "2022-07-12T21:02:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554456",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:54" align="right">Comment 54</div>

I responded to your question in [comment:48](#comment%3A48).



---

archive/issue_comments_554457.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nI don't think you responded to my question in [comment:48](#comment%3A48)",
    "created_at": "2022-07-12T21:44:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554457",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:55" align="right">Comment 55</div>

I don't think you responded to my question in [comment:48](#comment%3A48)



---

archive/issue_comments_554458.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\nsorry, I see committing a bunch of files from another project as a regression (unneeded vendoring).",
    "created_at": "2022-07-12T21:47:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554458",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:56" align="right">Comment 56</div>

sorry, I see committing a bunch of files from another project as a regression (unneeded vendoring).



---

archive/issue_comments_554459.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">Comment 57</div>\n\nReplying to [@dimpase](#comment%3A55):\n> I don't think you responded to my question in [comment:48](#comment%3A48)\n\nTry rephrasing your question then please",
    "created_at": "2022-07-12T21:56:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554459",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:57" align="right">Comment 57</div>

Replying to [@dimpase](#comment%3A55):
> I don't think you responded to my question in [comment:48](#comment%3A48)

Try rephrasing your question then please



---

archive/issue_comments_554460.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nReplying to [@dimpase](#comment%3A56):\n> sorry, I see committing a bunch of files from another project as a regression (unneeded vendoring).\n\ncomment:42.",
    "created_at": "2022-07-12T22:04:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554460",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:58" align="right">Comment 58</div>

Replying to [@dimpase](#comment%3A56):
> sorry, I see committing a bunch of files from another project as a regression (unneeded vendoring).

comment:42.



---

archive/issue_comments_554461.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nI think Matthias is using gnulib as intended. Making it maintainable is possibly the tricky bit. Had to deal with gnulib before on AIX :( the advantage of using gettext in this case is to rely on a third party to do the maintenance. And then you have to make sure you are up to date yourself.\n\nAs to adding bunch of files from another project, yes it is trading them against the gettext dependency as far as I understand. So potentially a tarball with stuff you don't care about.\n\nDima, do you have a good stated technical opposition to gnulib rather than a philosophical one?",
    "created_at": "2022-07-13T09:22:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554461",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:59" align="right">Comment 59</div>

I think Matthias is using gnulib as intended. Making it maintainable is possibly the tricky bit. Had to deal with gnulib before on AIX :( the advantage of using gettext in this case is to rely on a third party to do the maintenance. And then you have to make sure you are up to date yourself.

As to adding bunch of files from another project, yes it is trading them against the gettext dependency as far as I understand. So potentially a tarball with stuff you don't care about.

Dima, do you have a good stated technical opposition to gnulib rather than a philosophical one?



---

archive/issue_comments_554462.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">Comment 60</div>\n\nI don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.",
    "created_at": "2022-07-13T09:27:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554462",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:60" align="right">Comment 60</div>

I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.



---

archive/issue_comments_554463.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">Comment 61</div>\n\nReplying to [@dimpase](#comment%3A60):\n> I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.\n\nI see, then we'll go round and round. Do I want to have to install gnulib to bootstrap?\n\n```\nfbissey@tarazed ~ $ eix gnulib\n* dev-libs/gnulib\n     Available versions:  ~*2019.03.17.09.24.57 ~*2022.02.12.16.27.05 ~*2022.05.26.07.24.56 **9999-r1*l {doc}\n     Homepage:            https://www.gnu.org/software/gnulib\n     Description:         Gnulib is a library of common routines intended to be shared at the source level\n```\nhum stuff that has all the markers for \"install at your own risks, you have been warned\" and which force to do things that are equivalent to signing a contract saying you understand the risks before you can install. Looking at the package itself it is \"grab a tarball and manually copy the files in a potentially arbitrary location\". No, I am with Matthias on that one, this is in a different class than autotools and libtools or cmake. You redistribute the bits you need. Having the tools to maintain it in the same package is a must though.",
    "created_at": "2022-07-13T09:42:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554463",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:61" align="right">Comment 61</div>

Replying to [@dimpase](#comment%3A60):
> I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.

I see, then we'll go round and round. Do I want to have to install gnulib to bootstrap?

```
fbissey@tarazed ~ $ eix gnulib
* dev-libs/gnulib
     Available versions:  ~*2019.03.17.09.24.57 ~*2022.02.12.16.27.05 ~*2022.05.26.07.24.56 **9999-r1*l {doc}
     Homepage:            https://www.gnu.org/software/gnulib
     Description:         Gnulib is a library of common routines intended to be shared at the source level
```
hum stuff that has all the markers for "install at your own risks, you have been warned" and which force to do things that are equivalent to signing a contract saying you understand the risks before you can install. Looking at the package itself it is "grab a tarball and manually copy the files in a potentially arbitrary location". No, I am with Matthias on that one, this is in a different class than autotools and libtools or cmake. You redistribute the bits you need. Having the tools to maintain it in the same package is a must though.



---

archive/issue_comments_554464.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">Comment 62</div>\n\n\"bits\" are thousands of lines, in about 10 files. To me it screams that it should be installed and copied as needed,  not copied once and committed in our tree. \n\nI think gnulib is in such a weird state due to GNU folks having badly failed QA on the gnulib/gettext stuff.",
    "created_at": "2022-07-13T09:52:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554464",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:62" align="right">Comment 62</div>

"bits" are thousands of lines, in about 10 files. To me it screams that it should be installed and copied as needed,  not copied once and committed in our tree. 

I think gnulib is in such a weird state due to GNU folks having badly failed QA on the gnulib/gettext stuff.



---

archive/issue_comments_554465.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">Comment 63</div>\n\nReplying to [@dimpase](#comment%3A62):\n> I think gnulib is in such a weird state due to GNU folks having badly failed QA on the gnulib/gettext stuff. \n\nPossibly :) that has never stopped anyone - and I am talking in a professional capacity as someone who helped people install real stinky software on \"supercomputers\" and computers not really super. Sometimes, I turn to my fellow researcher or a PhD student and go \"we are not going to do that one sorry, it stinks because it is real dead. Please reconsider\". Not so long ago sagemath was in the stinky pile, it still stinks a bit but not that bad :), using gnulib as Matthias wants will not make it smell much more. At the very least, gnulib and sagemath are very much alive and that counts for a lot.",
    "created_at": "2022-07-13T10:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554465",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:63" align="right">Comment 63</div>

Replying to [@dimpase](#comment%3A62):
> I think gnulib is in such a weird state due to GNU folks having badly failed QA on the gnulib/gettext stuff. 

Possibly :) that has never stopped anyone - and I am talking in a professional capacity as someone who helped people install real stinky software on "supercomputers" and computers not really super. Sometimes, I turn to my fellow researcher or a PhD student and go "we are not going to do that one sorry, it stinks because it is real dead. Please reconsider". Not so long ago sagemath was in the stinky pile, it still stinks a bit but not that bad :), using gnulib as Matthias wants will not make it smell much more. At the very least, gnulib and sagemath are very much alive and that counts for a lot.



---

archive/issue_comments_554466.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">Comment 64</div>\n\nIMHO my branch for the issue, i.e. `u/dimpase/config/gnulib`, is less stinky.\n\nMatthias already caused a bit of havoc in 9.7.beta5 by only keeping in `m4/` some of the files installed by `gnulib-tool --import iconv` and not all (a bug only visible on a box without gettext installed :-(). And still `u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__` doesn't add them all.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6679325ea9d68506aaa81abe20aedd95686635fd\">6679325</a></td><td><code>Revert \"m4/: Add missing dependencies of iconv.m4\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fcd5c6ca0cfb71ee47462d51bcd4353d6ffe2b9f\">fcd5c6c</a></td><td><code>don't vendor gnulib files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/02ea3caf7a75fb9b914dd2ab0d57648e567ce660\">02ea3ca</a></td><td><code>use gnulib-tool from ./bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505\">f5a9f50</a></td><td><code>git-ignore everything installed by gnulib-tool</code></td></tr></table>\n",
    "created_at": "2022-07-13T11:00:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554466",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:64" align="right">Comment 64</div>

IMHO my branch for the issue, i.e. `u/dimpase/config/gnulib`, is less stinky.

Matthias already caused a bit of havoc in 9.7.beta5 by only keeping in `m4/` some of the files installed by `gnulib-tool --import iconv` and not all (a bug only visible on a box without gettext installed :-(). And still `u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__` doesn't add them all.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6679325ea9d68506aaa81abe20aedd95686635fd">6679325</a></td><td><code>Revert "m4/: Add missing dependencies of iconv.m4"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fcd5c6ca0cfb71ee47462d51bcd4353d6ffe2b9f">fcd5c6c</a></td><td><code>don't vendor gnulib files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/02ea3caf7a75fb9b914dd2ab0d57648e567ce660">02ea3ca</a></td><td><code>use gnulib-tool from ./bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505">f5a9f50</a></td><td><code>git-ignore everything installed by gnulib-tool</code></td></tr></table>




---

archive/issue_comments_554467.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)** to **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)**",
    "created_at": "2022-07-13T11:00:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554467",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)** to **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)**



---

archive/issue_comments_554468.json:
```json
{
    "body": "Changed commit from **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)** to **[f5a9f50](https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505)**",
    "created_at": "2022-07-13T11:00:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554468",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)** to **[f5a9f50](https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505)**



---

archive/issue_comments_554469.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">Comment 65</div>\n\nadvice to install `gnutls` is missing in this branch, but that's minor, easy to fix.",
    "created_at": "2022-07-13T11:06:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554469",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:65" align="right">Comment 65</div>

advice to install `gnutls` is missing in this branch, but that's minor, easy to fix.



---

archive/issue_comments_554470.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">Comment 66</div>\n\nReplying to [@kiwifb](#comment%3A61):\n> Replying to [@dimpase](#comment%3A60):\n> > I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.\n\n> \n> I see, then we'll go round and round. Do I want to have to install gnulib to bootstrap?\n> \n> ```\n> fbissey@tarazed ~ $ eix gnulib\n> * dev-libs/gnulib\n>      Available versions:  ~*2019.03.17.09.24.57 ~*2022.02.12.16.27.05 ~*2022.05.26.07.24.56 **9999-r1*l {doc}\n>      Homepage:            https://www.gnu.org/software/gnulib\n>      Description:         Gnulib is a library of common routines intended to be shared at the source level\n> ```\n\non gentoo I had to do the \"missing keyword\" fix for gnulib, in order to install it.\nNot sure it's a bug or feature.",
    "created_at": "2022-07-13T11:21:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554470",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:66" align="right">Comment 66</div>

Replying to [@kiwifb](#comment%3A61):
> Replying to [@dimpase](#comment%3A60):
> > I don't have opposition to `gnulib`, I rather want have it installed and used by `./bootstrap` via `gnulib-tool`.

> 
> I see, then we'll go round and round. Do I want to have to install gnulib to bootstrap?
> 
> ```
> fbissey@tarazed ~ $ eix gnulib
> * dev-libs/gnulib
>      Available versions:  ~*2019.03.17.09.24.57 ~*2022.02.12.16.27.05 ~*2022.05.26.07.24.56 **9999-r1*l {doc}
>      Homepage:            https://www.gnu.org/software/gnulib
>      Description:         Gnulib is a library of common routines intended to be shared at the source level
> ```

on gentoo I had to do the "missing keyword" fix for gnulib, in order to install it.
Not sure it's a bug or feature.



---

archive/issue_comments_554471.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">Comment 67</div>\n\nIt is a feature. This is a way to get you to sign off that you know what you are doing. You have to be really explicit that you want to install it.",
    "created_at": "2022-07-13T11:58:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554471",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:67" align="right">Comment 67</div>

It is a feature. This is a way to get you to sign off that you know what you are doing. You have to be really explicit that you want to install it.



---

archive/issue_comments_554472.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">Comment 68</div>\n\nReplying to [@mkoeppe](#comment%3A23):\n> Replying to [@dimpase](#comment%3A21):\n> > This manual is older than `git`, you know, no wonder it won't mention it.\n\n> \n> Use with git is documented in https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html; it describes several approaches.\n\nDima, let me highlight this link again. It documents 3 approaches how to use gnulib with version control systems. Do you see which of the 3 corresponds to my branch?",
    "created_at": "2022-07-13T14:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554472",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:68" align="right">Comment 68</div>

Replying to [@mkoeppe](#comment%3A23):
> Replying to [@dimpase](#comment%3A21):
> > This manual is older than `git`, you know, no wonder it won't mention it.

> 
> Use with git is documented in https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html; it describes several approaches.

Dima, let me highlight this link again. It documents 3 approaches how to use gnulib with version control systems. Do you see which of the 3 corresponds to my branch?



---

archive/issue_comments_554473.json:
```json
{
    "body": "Changed reviewer from **Dima Pasechnik** to none",
    "created_at": "2022-07-13T16:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554473",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **Dima Pasechnik** to none



---

archive/issue_comments_554474.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">Comment 69</div>\n\nAfter all these years trying to unvendor as much as possible, all of a sudden you reverse the course. I don't get it.",
    "created_at": "2022-07-13T16:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554474",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:69" align="right">Comment 69</div>

After all these years trying to unvendor as much as possible, all of a sudden you reverse the course. I don't get it.



---

archive/issue_comments_554475.json:
```json
{
    "body": "Changed commit from **[f5a9f50](https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505)** to none",
    "created_at": "2022-07-13T16:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554475",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[f5a9f50](https://github.com/sagemath/sagetrac-mirror/commit/f5a9f50c4b0e0aad4ca64033a3f984e63c353505)** to none



---

archive/issue_comments_554476.json:
```json
{
    "body": "Changed branch from **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)** to none",
    "created_at": "2022-07-13T16:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554476",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)** to none



---

archive/issue_comments_554477.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">Comment 70</div>\n\nYou keep using this word \"vendoring\" here. This is not what's happening. My branch is using gnulib as documented.\n\nYou may find https://lists.gnu.org/archive/html/bug-gnulib/2008-11/msg00083.html helpful.",
    "created_at": "2022-07-13T16:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554477",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:70" align="right">Comment 70</div>

You keep using this word "vendoring" here. This is not what's happening. My branch is using gnulib as documented.

You may find https://lists.gnu.org/archive/html/bug-gnulib/2008-11/msg00083.html helpful.



---

archive/issue_comments_554478.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">Comment 71</div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312\">65638b4</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6\">4011cc4</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr></table>\n",
    "created_at": "2022-07-13T16:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554478",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:71" align="right">Comment 71</div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65638b43f833b5dcbb87b59bceb076ddd0552312">65638b4</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6">4011cc4</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr></table>




---

archive/issue_comments_554479.json:
```json
{
    "body": "Branch: **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)**",
    "created_at": "2022-07-13T16:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554479",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)**



---

archive/issue_comments_554480.json:
```json
{
    "body": "Commit: **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)**",
    "created_at": "2022-07-13T16:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554480",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)**



---

archive/issue_comments_554481.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">Comment 72</div>\n\nI consider the gnulib manual outdated. OK, it's not vendoring, it's an SCO (Special Copying Operation) :P",
    "created_at": "2022-07-13T17:18:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554481",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:72" align="right">Comment 72</div>

I consider the gnulib manual outdated. OK, it's not vendoring, it's an SCO (Special Copying Operation) :P



---

archive/issue_comments_554482.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">Comment 73</div>\n\nReplying to [@dimpase](#comment%3A72):\n> I consider the gnulib manual outdated.\n\nTry taking that to bug-gnulib.",
    "created_at": "2022-07-13T17:20:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554482",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:73" align="right">Comment 73</div>

Replying to [@dimpase](#comment%3A72):
> I consider the gnulib manual outdated.

Try taking that to bug-gnulib.



---

archive/issue_comments_554483.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">Comment 74</div>\n\nPro tip: Use the subject \"Gnulib considered harmful\"",
    "created_at": "2022-07-13T17:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554483",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:74" align="right">Comment 74</div>

Pro tip: Use the subject "Gnulib considered harmful"



---

archive/issue_events_449004.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-14T14:08:05Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "title_is": "Remove remaining dependencies of bootstrap on gettext (AC_LIB_RPATH etc.)",
    "title_was": "Fix broken bootstrap (AC_LIB_RPATH etc.)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449004"
}
```



---

archive/issue_comments_554484.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,9 @@\n-Broken in #29549, because I forgot to add some files.\n+#29549 intended to remove the dependency of `bootstrap` on gettext. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800).\n \n-Also, `gettext` is no longer a bootstrapping prerequisite, so we remove it from various `distros/` files etc.\n+However, I forgot to add some files that `gnulib-tool` added, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n \n-Reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n+Here we complete the task and remove `gettext` from various `distros/` files etc.\n+\n+To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n+\n+\n``````\n",
    "created_at": "2022-07-14T14:08:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554484",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,9 @@
-Broken in #29549, because I forgot to add some files.
+#29549 intended to remove the dependency of `bootstrap` on gettext. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800).
 
-Also, `gettext` is no longer a bootstrapping prerequisite, so we remove it from various `distros/` files etc.
+However, I forgot to add some files that `gnulib-tool` added, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ
 
-Reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ
+Here we complete the task and remove `gettext` from various `distros/` files etc.
+
+To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
+
+
``````




---

archive/issue_events_449005.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-14T14:08:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449005"
}
```



---

archive/issue_events_449006.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-14T14:08:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449006"
}
```



---

archive/issue_comments_554485.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">Comment 76</div>\n\nAdding those four files to the m4 directory fixed all of my problems with the bootstrap script, including the missing .dylib extension on LIBSINGULAR_PATH.  I am now getting a working macOS build with no issues.\n\nIt seems completely clear to me that this is the correct approach.  A project distributes an m4 directory containing the exact gnulib .m4 files that are needed to make its build work. By that I mean the exact versions of those files. The gnulib repository changes almost daily and they do not do releases.  So this seems like the only way to ensure a working build.  And it is also what gnulib says to do.",
    "created_at": "2022-07-15T15:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554485",
    "user": "https://github.com/culler"
}
```

<div id="comment:76" align="right">Comment 76</div>

Adding those four files to the m4 directory fixed all of my problems with the bootstrap script, including the missing .dylib extension on LIBSINGULAR_PATH.  I am now getting a working macOS build with no issues.

It seems completely clear to me that this is the correct approach.  A project distributes an m4 directory containing the exact gnulib .m4 files that are needed to make its build work. By that I mean the exact versions of those files. The gnulib repository changes almost daily and they do not do releases.  So this seems like the only way to ensure a working build.  And it is also what gnulib says to do.



---

archive/issue_comments_554486.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">Comment 77</div>\n\nReplying to [@culler](#comment%3A76):\n> Adding those four files to the m4 directory fixed all of my problems with the bootstrap script, including the missing .dylib extension on LIBSINGULAR_PATH.  I am now getting a working macOS build with no issues.\n> \n> It seems completely clear to me that this is the correct approach.  A project distributes an m4 directory containing the exact gnulib .m4 files that are needed to make its build work. By that I mean the exact versions of those files. The gnulib repository changes almost daily and they do not do releases.  So this seems like the only way to ensure a working build.  And it is also what gnulib says to do.\n\nThe only way? \nIf one wants to follow the gnulib updates then one can use `git submodule` or a similar solution; and this is mentioned in gnulib docs.\nTotally no need to follow the 30+ years old way of copying files by hand.",
    "created_at": "2022-07-16T19:59:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554486",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:77" align="right">Comment 77</div>

Replying to [@culler](#comment%3A76):
> Adding those four files to the m4 directory fixed all of my problems with the bootstrap script, including the missing .dylib extension on LIBSINGULAR_PATH.  I am now getting a working macOS build with no issues.
> 
> It seems completely clear to me that this is the correct approach.  A project distributes an m4 directory containing the exact gnulib .m4 files that are needed to make its build work. By that I mean the exact versions of those files. The gnulib repository changes almost daily and they do not do releases.  So this seems like the only way to ensure a working build.  And it is also what gnulib says to do.

The only way? 
If one wants to follow the gnulib updates then one can use `git submodule` or a similar solution; and this is mentioned in gnulib docs.
Totally no need to follow the 30+ years old way of copying files by hand.



---

archive/issue_comments_554487.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">Comment 78</div>\n\nGnulib provides `gnulib-tool` for the copying, so copying is not done \"by hand\".",
    "created_at": "2022-07-16T20:06:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554487",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:78" align="right">Comment 78</div>

Gnulib provides `gnulib-tool` for the copying, so copying is not done "by hand".



---

archive/issue_comments_554488.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">Comment 79</div>\n\nsure - but updating is done by hand; one needs to update gnulib on the box, and launch gnulib-tool",
    "created_at": "2022-07-16T21:03:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554488",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:79" align="right">Comment 79</div>

sure - but updating is done by hand; one needs to update gnulib on the box, and launch gnulib-tool



---

archive/issue_comments_554489.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">Comment 80</div>\n\nYes, the author of an upgrade ticket for these files will have to run `gnulibtool`.",
    "created_at": "2022-07-16T21:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554489",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:80" align="right">Comment 80</div>

Yes, the author of an upgrade ticket for these files will have to run `gnulibtool`.



---

archive/issue_comments_554490.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">Comment 81</div>\n\nThat's approach 3 of the three approaches explained in the manual (https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).",
    "created_at": "2022-07-16T21:34:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554490",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:81" align="right">Comment 81</div>

That's approach 3 of the three approaches explained in the manual (https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).



---

archive/issue_comments_554491.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">Comment 82</div>\n\nso you chose the most labour-intensive approach, resulting in extra maintenance to be done.",
    "created_at": "2022-07-17T10:04:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554491",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:82" align="right">Comment 82</div>

so you chose the most labour-intensive approach, resulting in extra maintenance to be done.



---

archive/issue_comments_554492.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">Comment 83</div>\n\nNo. \n\nIn approach 2 of the three approaches, in the variant with `git submodule`, the author of an upgrade ticket will have to run `git submodule update --remote` and then commit the change. \n\nFor the author of an upgrade ticket for gnulib, it's the same amount of labor as approach 3: One command and one commit.\n\nThe drawbacks of this approach: \n- it exposes all developers (not just an author of a gnulib upgrade ticket) to the complexity of git submodules. \n- a source tarball of Sage will have to contain the full copy of gnulib (a copy of the submodule). More \"vendoring\" ;)",
    "created_at": "2022-07-17T18:19:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554492",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:83" align="right">Comment 83</div>

No. 

In approach 2 of the three approaches, in the variant with `git submodule`, the author of an upgrade ticket will have to run `git submodule update --remote` and then commit the change. 

For the author of an upgrade ticket for gnulib, it's the same amount of labor as approach 3: One command and one commit.

The drawbacks of this approach: 
- it exposes all developers (not just an author of a gnulib upgrade ticket) to the complexity of git submodules. 
- a source tarball of Sage will have to contain the full copy of gnulib (a copy of the submodule). More "vendoring" ;)



---

archive/issue_comments_554493.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">Comment 84</div>\n\nwhy do you insist on committing exact copies of files in gnulib into Sage tree? My approach does not do this.",
    "created_at": "2022-07-18T11:41:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554493",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:84" align="right">Comment 84</div>

why do you insist on committing exact copies of files in gnulib into Sage tree? My approach does not do this.



---

archive/issue_comments_554494.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">Comment 85</div>\n\nReplying to [@dimpase](#comment%3A84):\n> why do you insist on committing exact copies of files in gnulib into Sage tree?\n\nIt is the documented way to use gnulib, specifically, approach 3.\n\nThe Gnulib manual, https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html, introduces the three approaches with this paragraph:\n\n  Here are the three different approaches in common use. Each has its place, and you should use whichever best suits your particular project and development methods.\n\nThe approach of your branch is neither of the three documented approaches. Upstream explicitly rejects this approach. It's reflected in: Gnulib not making releases and not having an \"install\" target (comment:9, [comment:40](#comment%3A40)); homebrew and conda not packaging it (comment:38); gentoo marking it as \"source only\" (comment:67); and the thread linked in [comment:70](#comment%3A70).",
    "created_at": "2022-07-18T16:31:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554494",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:85" align="right">Comment 85</div>

Replying to [@dimpase](#comment%3A84):
> why do you insist on committing exact copies of files in gnulib into Sage tree?

It is the documented way to use gnulib, specifically, approach 3.

The Gnulib manual, https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html, introduces the three approaches with this paragraph:

  Here are the three different approaches in common use. Each has its place, and you should use whichever best suits your particular project and development methods.

The approach of your branch is neither of the three documented approaches. Upstream explicitly rejects this approach. It's reflected in: Gnulib not making releases and not having an "install" target (comment:9, [comment:40](#comment%3A40)); homebrew and conda not packaging it (comment:38); gentoo marking it as "source only" (comment:67); and the thread linked in [comment:70](#comment%3A70).



---

archive/issue_comments_554495.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">Comment 86</div>\n\nI think upstream has it wrong. Why do they insist on partial, or even complete, vendoring of their code? This only make sense if one wants to change it, but for 99% of projects it is not the case.",
    "created_at": "2022-07-18T19:16:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554495",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:86" align="right">Comment 86</div>

I think upstream has it wrong. Why do they insist on partial, or even complete, vendoring of their code? This only make sense if one wants to change it, but for 99% of projects it is not the case.



---

archive/issue_comments_554496.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">Comment 87</div>\n\ncomment:73, [comment:74](#comment%3A74)",
    "created_at": "2022-07-18T19:23:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554496",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:87" align="right">Comment 87</div>

comment:73, [comment:74](#comment%3A74)



---

archive/issue_comments_554497.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">Comment 88</div>\n\nReplying to [@mkoeppe](#comment%3A87):\n> comment:73, [comment:74](#comment%3A74)\n\nno, I am not going to try to expain the obvious to upstream. They are either too stubbon, or have an agenda (?), or just don't care. This \"gnulib must not be installed\" is nonsense - the same can be said about any source-only package.\n`gnulib` can be distributed by distributions, as it's done with gettext, and gnulib consumers can just call `gnulib-tool`.\n\nJust revert #29549 if you prefer, it's ugly but at least we don't increase codebase unnecessarily.",
    "created_at": "2022-07-19T07:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554497",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:88" align="right">Comment 88</div>

Replying to [@mkoeppe](#comment%3A87):
> comment:73, [comment:74](#comment%3A74)

no, I am not going to try to expain the obvious to upstream. They are either too stubbon, or have an agenda (?), or just don't care. This "gnulib must not be installed" is nonsense - the same can be said about any source-only package.
`gnulib` can be distributed by distributions, as it's done with gettext, and gnulib consumers can just call `gnulib-tool`.

Just revert #29549 if you prefer, it's ugly but at least we don't increase codebase unnecessarily.



---

archive/issue_comments_554498.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">Comment 89</div>\n\nReplying to [@dimpase](#comment%3A88):\n> Just revert #29549\n\nNo. #29549 solved an actual problem, as explained in the 1st paragraph of the ticket description.",
    "created_at": "2022-07-19T15:21:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554498",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:89" align="right">Comment 89</div>

Replying to [@dimpase](#comment%3A88):
> Just revert #29549

No. #29549 solved an actual problem, as explained in the 1st paragraph of the ticket description.



---

archive/issue_comments_554499.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">Comment 90</div>\n\nReplying to [@dimpase](#comment%3A88):\n> `gnulib` can be distributed by distributions\n\nBut it isn't, and it's beyond the scope of our project to change that.",
    "created_at": "2022-07-19T15:24:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554499",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:90" align="right">Comment 90</div>

Replying to [@dimpase](#comment%3A88):
> `gnulib` can be distributed by distributions

But it isn't, and it's beyond the scope of our project to change that.



---

archive/issue_comments_554500.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">Comment 91</div>\n\nReplying to [@mkoeppe](#comment%3A90):\n> Replying to [@dimpase](#comment%3A88):\n> > `gnulib` can be distributed by distributions\n\n> \n> But it isn't, and it's beyond the scope of our project to change that.\n\nwell, yes, it is distributed by Fedora, !Debian/Ubuntu, Gentoo...",
    "created_at": "2022-07-19T16:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554500",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:91" align="right">Comment 91</div>

Replying to [@mkoeppe](#comment%3A90):
> Replying to [@dimpase](#comment%3A88):
> > `gnulib` can be distributed by distributions

> 
> But it isn't, and it's beyond the scope of our project to change that.

well, yes, it is distributed by Fedora, !Debian/Ubuntu, Gentoo...



---

archive/issue_comments_554501.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">Comment 92</div>\n\ncomment:38, [comment:67](#comment%3A67).",
    "created_at": "2022-07-19T17:30:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554501",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:92" align="right">Comment 92</div>

comment:38, [comment:67](#comment%3A67).



---

archive/issue_comments_554502.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">Comment 93</div>\n\nReplying to [@dimpase](#comment%3A88):\n> This \"gnulib must not be installed\" is nonsense - the same can be said about any source-only package.\n\nWhat other packages that need to run at bootstrap time do you have in mind?",
    "created_at": "2022-07-19T17:35:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554502",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:93" align="right">Comment 93</div>

Replying to [@dimpase](#comment%3A88):
> This "gnulib must not be installed" is nonsense - the same can be said about any source-only package.

What other packages that need to run at bootstrap time do you have in mind?



---

archive/issue_comments_554503.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">Comment 94</div>\n\nI think we may have to have a vote on what to do on sage-devel. People here have strong opinions on what is the right thing to do and the final decision may have to be done by a third party.",
    "created_at": "2022-07-19T21:27:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554503",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:94" align="right">Comment 94</div>

I think we may have to have a vote on what to do on sage-devel. People here have strong opinions on what is the right thing to do and the final decision may have to be done by a third party.



---

archive/issue_comments_554504.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">Comment 95</div>\n\nReplying to [@mkoeppe](#comment%3A93):\n> Replying to [@dimpase](#comment%3A88):\n> > This \"gnulib must not be installed\" is nonsense - the same can be said about any source-only package.\n\n> \n> What other packages that need to run at bootstrap time do you have in mind?\n\nthat's not what I had in mind - what I have in mind is an (imaginary, because it'd be insane design) header-only C++ library which comes with a tool to copy some of the headers it provides into the source tree, and the manual saying that you also should commit these copied headers into your tree. All that instead of having it installed and using `#include <...>`...",
    "created_at": "2022-07-20T09:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554504",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:95" align="right">Comment 95</div>

Replying to [@mkoeppe](#comment%3A93):
> Replying to [@dimpase](#comment%3A88):
> > This "gnulib must not be installed" is nonsense - the same can be said about any source-only package.

> 
> What other packages that need to run at bootstrap time do you have in mind?

that's not what I had in mind - what I have in mind is an (imaginary, because it'd be insane design) header-only C++ library which comes with a tool to copy some of the headers it provides into the source tree, and the manual saying that you also should commit these copied headers into your tree. All that instead of having it installed and using `#include <...>`...



---

archive/issue_comments_554505.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">Comment 96</div>\n\nReplying to [@dimpase](#comment%3A95):\n> what I have in mind is an (imaginary, because it'd be insane design) header-only C++ library which comes with a tool to copy some of the headers it provides into the source tree, and the manual saying that you also should commit these copied headers into your tree.\n\n`nauty` is a real example of this design by upstream. And of course distributions that engage in unvendoring, such as Debian, unvendor nauty from packages that have followed upstream's advice. See for example https://salsa.debian.org/python-team/packages/pynauty/-/tree/debian/latest/debian/patches",
    "created_at": "2022-07-20T16:28:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554505",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:96" align="right">Comment 96</div>

Replying to [@dimpase](#comment%3A95):
> what I have in mind is an (imaginary, because it'd be insane design) header-only C++ library which comes with a tool to copy some of the headers it provides into the source tree, and the manual saying that you also should commit these copied headers into your tree.

`nauty` is a real example of this design by upstream. And of course distributions that engage in unvendoring, such as Debian, unvendor nauty from packages that have followed upstream's advice. See for example https://salsa.debian.org/python-team/packages/pynauty/-/tree/debian/latest/debian/patches



---

archive/issue_comments_554506.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">Comment 97</div>\n\nnauty is designed by Brendan MacKay, who is really very far from software engineering practice - not sure if you know the saga, involving a threat to fork nauty, that resulted in it getting a normal license...",
    "created_at": "2022-07-20T16:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554506",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:97" align="right">Comment 97</div>

nauty is designed by Brendan MacKay, who is really very far from software engineering practice - not sure if you know the saga, involving a threat to fork nauty, that resulted in it getting a normal license...



---

archive/issue_comments_554507.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">Comment 98</div>\n\nYes, everyone agrees that upstream's policy is poorly motivated, and so it makes sense to override it and unvendor nauty from packages that have followed nauty's advice.",
    "created_at": "2022-07-20T16:37:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554507",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:98" align="right">Comment 98</div>

Yes, everyone agrees that upstream's policy is poorly motivated, and so it makes sense to override it and unvendor nauty from packages that have followed nauty's advice.



---

archive/issue_comments_554508.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">Comment 99</div>\n\nBut the situation with Gnulib is different because it has to run at bootstrap time.",
    "created_at": "2022-07-20T16:38:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554508",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:99" align="right">Comment 99</div>

But the situation with Gnulib is different because it has to run at bootstrap time.



---

archive/issue_comments_554509.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nSorry to explain the obvious, but bootstrap time comes before configure time. It is at configure time that one runs system package discovery.",
    "created_at": "2022-07-20T16:39:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554509",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">Comment 0</div>

Sorry to explain the obvious, but bootstrap time comes before configure time. It is at configure time that one runs system package discovery.



---

archive/issue_comments_554510.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nNot even Debian overrides the Gnulib maintainers' insight into their package. Well, they tried in 2008(?) -- let me again link https://lists.gnu.org/archive/html/bug-gnulib/2008-11/msg00083.html -- but as of today, Gnulib is not a build dependency of any Debian package. It is packaged as a tool for Debian package maintainers.",
    "created_at": "2022-07-20T16:40:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554510",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">Comment 1</div>

Not even Debian overrides the Gnulib maintainers' insight into their package. Well, they tried in 2008(?) -- let me again link https://lists.gnu.org/archive/html/bug-gnulib/2008-11/msg00083.html -- but as of today, Gnulib is not a build dependency of any Debian package. It is packaged as a tool for Debian package maintainers.



---

archive/issue_comments_554511.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nRelevant for the discussion are packages that runs at bootstrap time, not imaginary or real packages that can be discovered at configure time.",
    "created_at": "2022-07-20T16:43:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554511",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">Comment 2</div>

Relevant for the discussion are packages that runs at bootstrap time, not imaginary or real packages that can be discovered at configure time.



---

archive/issue_comments_554512.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nSo here's a relevant example: autoconf-archive.",
    "created_at": "2022-07-20T16:43:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554512",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">Comment 3</div>

So here's a relevant example: autoconf-archive.



---

archive/issue_comments_554513.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nAnd we have followed autoconf-archive's documented way to use it: Namely to (manually \ud83d\ude31) copy the m4 files into our m4 directory and commit them to our tree.",
    "created_at": "2022-07-20T16:45:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554513",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">Comment 4</div>

And we have followed autoconf-archive's documented way to use it: Namely to (manually 😱) copy the m4 files into our m4 directory and commit them to our tree.



---

archive/issue_comments_554514.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nGnulib uses the same model, and in contrast to autoconf-archive it even provides a tool that assists with updating the files.",
    "created_at": "2022-07-20T16:46:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554514",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">Comment 5</div>

Gnulib uses the same model, and in contrast to autoconf-archive it even provides a tool that assists with updating the files.



---

archive/issue_comments_554515.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">Comment 106</div>\n\nReplying to [@mkoeppe](#comment%3A102):\n> Relevant for the discussion are packages that runs at bootstrap time, not imaginary or real packages that can be discovered at configure time.\n\nCertainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.",
    "created_at": "2022-07-20T16:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554515",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:106" align="right">Comment 106</div>

Replying to [@mkoeppe](#comment%3A102):
> Relevant for the discussion are packages that runs at bootstrap time, not imaginary or real packages that can be discovered at configure time.

Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.



---

archive/issue_comments_554516.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nautoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.",
    "created_at": "2022-07-20T16:48:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554516",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">Comment 7</div>

autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.



---

archive/issue_comments_554517.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\ngnulib is really much more than a collection of independent m4 files, and we modify none of gnulib-supplied files.",
    "created_at": "2022-07-20T16:50:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554517",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">Comment 8</div>

gnulib is really much more than a collection of independent m4 files, and we modify none of gnulib-supplied files.



---

archive/issue_comments_554518.json:
```json
{
    "body": "<div id=\"comment:109\" align=\"right\">Comment 109</div>\n\nReplying to [@dimpase](#comment%3A106):\n> Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.\n\nWhat do you imagine would it do if it is not available?",
    "created_at": "2022-07-20T16:52:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554518",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:109" align="right">Comment 109</div>

Replying to [@dimpase](#comment%3A106):
> Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.

What do you imagine would it do if it is not available?



---

archive/issue_comments_554519.json:
```json
{
    "body": "<div id=\"comment:110\" align=\"right\">Comment 110</div>\n\nReplying to [@dimpase](#comment%3A107):\n> autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.\n\nThat we modify them without sending the changes upstream is actually a poor practice of our project. See also #29590",
    "created_at": "2022-07-20T16:54:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554519",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:110" align="right">Comment 110</div>

Replying to [@dimpase](#comment%3A107):
> autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.

That we modify them without sending the changes upstream is actually a poor practice of our project. See also #29590



---

archive/issue_comments_554520.json:
```json
{
    "body": "<div id=\"comment:111\" align=\"right\">Comment 111</div>\n\nReplying to [@dimpase](#comment%3A108):\n> gnulib is really much more than a collection of independent m4 files\n\nMacros in autoconf-archive also have interdependencies. For example, `ax_cxx_compile_stdcxx_11.m4` depends on `ax_cxx_compile_stdcxx.m4`.\n\n> and we modify none of gnulib-supplied files.\n\nI was puzzled before by your [comment:86](#comment%3A86) in the same direction. If there are concerns about maintainability, they should apply to files that are copied in from an upstream and then modified locally! Copying in files and leaving them unmodified is obviously less problematic.",
    "created_at": "2022-07-20T17:07:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554520",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:111" align="right">Comment 111</div>

Replying to [@dimpase](#comment%3A108):
> gnulib is really much more than a collection of independent m4 files

Macros in autoconf-archive also have interdependencies. For example, `ax_cxx_compile_stdcxx_11.m4` depends on `ax_cxx_compile_stdcxx.m4`.

> and we modify none of gnulib-supplied files.

I was puzzled before by your [comment:86](#comment%3A86) in the same direction. If there are concerns about maintainability, they should apply to files that are copied in from an upstream and then modified locally! Copying in files and leaving them unmodified is obviously less problematic.



---

archive/issue_comments_554521.json:
```json
{
    "body": "<div id=\"comment:112\" align=\"right\">Comment 112</div>\n\nReplying to [@mkoeppe](#comment%3A109):\n> Replying to [@dimpase](#comment%3A106):\n> > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.\n\n> \n> What do you imagine would it do if it is not available?\n\nthe usual for bootstrap thing - resort to downloading configure.spkg",
    "created_at": "2022-07-20T17:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554521",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:112" align="right">Comment 112</div>

Replying to [@mkoeppe](#comment%3A109):
> Replying to [@dimpase](#comment%3A106):
> > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.

> 
> What do you imagine would it do if it is not available?

the usual for bootstrap thing - resort to downloading configure.spkg



---

archive/issue_comments_554522.json:
```json
{
    "body": "<div id=\"comment:113\" align=\"right\">Comment 113</div>\n\nReplying to [@mkoeppe](#comment%3A110):\n> Replying to [@dimpase](#comment%3A107):\n> > autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.\n\n> \n> That we modify them without sending the changes upstream is actually a poor practice of our project. See also #29590\n\n\ncommunication with GNU/FSF greybeards is really above my pay grade. I tried with readline, autoconf, I really don't click with them...",
    "created_at": "2022-07-20T17:21:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554522",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:113" align="right">Comment 113</div>

Replying to [@mkoeppe](#comment%3A110):
> Replying to [@dimpase](#comment%3A107):
> > autoconf-archive is really a collection of independent m4 files, and we actually modify a few of them.

> 
> That we modify them without sending the changes upstream is actually a poor practice of our project. See also #29590


communication with GNU/FSF greybeards is really above my pay grade. I tried with readline, autoconf, I really don't click with them...



---

archive/issue_comments_554523.json:
```json
{
    "body": "<div id=\"comment:114\" align=\"right\">Comment 114</div>\n\nReplying to [@dimpase](#comment%3A112):\n> Replying to [@mkoeppe](#comment%3A109):\n> > Replying to [@dimpase](#comment%3A106):\n> > > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.\n\n> > \n> > What do you imagine would it do if it is not available?\n\n> \n> the usual for bootstrap thing - resort to downloading configure.spkg\n\nThis would make it harder for developers on macOS (with homebrew or without) or conda to work on tickets that upgrade packages. So they will have to learn about Gnulib even though their package upgrade has nothing to do with it.\n\nAnd it would make it harder for running our portability CIs: We would no longer be able to bootstrap a source tree from git on all supported platforms without an extra step that downloads/checks out the whole Gnulib.",
    "created_at": "2022-07-20T17:28:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554523",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:114" align="right">Comment 114</div>

Replying to [@dimpase](#comment%3A112):
> Replying to [@mkoeppe](#comment%3A109):
> > Replying to [@dimpase](#comment%3A106):
> > > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.

> > 
> > What do you imagine would it do if it is not available?

> 
> the usual for bootstrap thing - resort to downloading configure.spkg

This would make it harder for developers on macOS (with homebrew or without) or conda to work on tickets that upgrade packages. So they will have to learn about Gnulib even though their package upgrade has nothing to do with it.

And it would make it harder for running our portability CIs: We would no longer be able to bootstrap a source tree from git on all supported platforms without an extra step that downloads/checks out the whole Gnulib.



---

archive/issue_comments_554524.json:
```json
{
    "body": "<div id=\"comment:115\" align=\"right\">Comment 115</div>\n\nReplying to [@kiwifb](#comment%3A94):\n> I think we may have to have a vote on what to do on sage-devel. People here have strong opinions on what is the right thing to do and the final decision may have to be done by a third party.\n\n+100",
    "created_at": "2022-07-20T18:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554524",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:115" align="right">Comment 115</div>

Replying to [@kiwifb](#comment%3A94):
> I think we may have to have a vote on what to do on sage-devel. People here have strong opinions on what is the right thing to do and the final decision may have to be done by a third party.

+100



---

archive/issue_comments_554525.json:
```json
{
    "body": "<div id=\"comment:116\" align=\"right\">Comment 116</div>\n\nReplying to [@mkoeppe](#comment%3A114):\n> Replying to [@dimpase](#comment%3A112):\n> > Replying to [@mkoeppe](#comment%3A109):\n> > > Replying to [@dimpase](#comment%3A106):\n> > > > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.\n\n> > > \n> > > What do you imagine would it do if it is not available?\n\n> > \n> > the usual for bootstrap thing - resort to downloading configure.spkg\n\n> \n> This would make it harder for developers on macOS (with homebrew or without) or conda to work on tickets that upgrade packages. So they will have to learn about Gnulib even though their package upgrade has nothing to do with it.\n\nAs far as Homebrew is concerned, it's easy to provide a formula to install gnulib.\nSuch a formula can be hosted on sagemath GH.\nI don't know how easy it is to do the same with Conda.\n\n> \n> And it would make it harder for running our portability CIs: We would no longer be able to bootstrap a source tree from git on all supported platforms without an extra step that downloads/checks out the whole Gnulib.\n\nCome on, that's like 2 lines of shell, to `git clone --depth=1` the `gnulib`, and adjust the path so that  `gnulib-tool` is there. \nWe can just add this step to `./bootstrap`, to be run if it can't find `gnulib-tool`.",
    "created_at": "2022-07-21T08:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554525",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:116" align="right">Comment 116</div>

Replying to [@mkoeppe](#comment%3A114):
> Replying to [@dimpase](#comment%3A112):
> > Replying to [@mkoeppe](#comment%3A109):
> > > Replying to [@dimpase](#comment%3A106):
> > > > Certainly, there are already a number of packages which are checked for presence by bootstrap, why not gnulib? It can check for gnulib-tool being available.

> > > 
> > > What do you imagine would it do if it is not available?

> > 
> > the usual for bootstrap thing - resort to downloading configure.spkg

> 
> This would make it harder for developers on macOS (with homebrew or without) or conda to work on tickets that upgrade packages. So they will have to learn about Gnulib even though their package upgrade has nothing to do with it.

As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.
Such a formula can be hosted on sagemath GH.
I don't know how easy it is to do the same with Conda.

> 
> And it would make it harder for running our portability CIs: We would no longer be able to bootstrap a source tree from git on all supported platforms without an extra step that downloads/checks out the whole Gnulib.

Come on, that's like 2 lines of shell, to `git clone --depth=1` the `gnulib`, and adjust the path so that  `gnulib-tool` is there. 
We can just add this step to `./bootstrap`, to be run if it can't find `gnulib-tool`.



---

archive/issue_comments_554526.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nThis is not getting any better",
    "created_at": "2022-07-21T16:42:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554526",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">Comment 7</div>

This is not getting any better



---

archive/issue_comments_554527.json:
```json
{
    "body": "<div id=\"comment:118\" align=\"right\">Comment 118</div>\n\nReplying to [@mkoeppe](#comment%3A117):\n> This is not getting any better\n\nWhy? Because you must blindly follow the upstream's advice?",
    "created_at": "2022-07-25T07:19:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554527",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:118" align="right">Comment 118</div>

Replying to [@mkoeppe](#comment%3A117):
> This is not getting any better

Why? Because you must blindly follow the upstream's advice?



---

archive/issue_comments_554528.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\ncomment:27",
    "created_at": "2022-07-25T16:17:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554528",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">Comment 9</div>

comment:27



---

archive/issue_comments_554529.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nI would have pointed instead to [comment:94](#comment%3A94). I don't see a high likelihood of either Dima or Matthias convincing the other one. Taking the discussion to sage-devel seems like a good solution.",
    "created_at": "2022-07-25T17:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554529",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:0" align="right">Comment 0</div>

I would have pointed instead to [comment:94](#comment%3A94). I don't see a high likelihood of either Dima or Matthias convincing the other one. Taking the discussion to sage-devel seems like a good solution.



---

archive/issue_comments_554530.json:
```json
{
    "body": "<div id=\"comment:121\" align=\"right\">Comment 121</div>\n\nReplying to [@dimpase](#comment%3A37):\n> only these who use macOS and only these who do not use anything but Xcode might have to do this. And among the latter only these who need to build ./configure\n\nI am such a developer. I don't know gnulib. I wish that I could upgrade a package without  learning (or struggling to install) gnulib. So I am +1 to Matthias' approach.",
    "created_at": "2022-07-29T02:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554530",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:121" align="right">Comment 121</div>

Replying to [@dimpase](#comment%3A37):
> only these who use macOS and only these who do not use anything but Xcode might have to do this. And among the latter only these who need to build ./configure

I am such a developer. I don't know gnulib. I wish that I could upgrade a package without  learning (or struggling to install) gnulib. So I am +1 to Matthias' approach.



---

archive/issue_comments_554531.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI never said one must \"know\" gnulib.\nIt can all be handled by ./bootstrap script.\n\nBut Matthias is against it, as it would violate gnulib overlords commandments...",
    "created_at": "2022-07-29T06:27:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554531",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">Comment 2</div>

I never said one must "know" gnulib.
It can all be handled by ./bootstrap script.

But Matthias is against it, as it would violate gnulib overlords commandments...



---

archive/issue_comments_554532.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nDima, repeating this kind of rhetoric is not helpful for anything.",
    "created_at": "2022-07-29T06:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554532",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:3" align="right">Comment 3</div>

Dima, repeating this kind of rhetoric is not helpful for anything.



---

archive/issue_comments_554533.json:
```json
{
    "body": "<div id=\"comment:124\" align=\"right\">Comment 124</div>\n\nReplying to [@dimpase](#comment%3A116):\n> As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.\n> Such a formula can be hosted on sagemath GH.\n\nThe gnulib overlord is explicitly against this: https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html\n\nMaintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.",
    "created_at": "2022-07-29T07:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554533",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:124" align="right">Comment 124</div>

Replying to [@dimpase](#comment%3A116):
> As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.
> Such a formula can be hosted on sagemath GH.

The gnulib overlord is explicitly against this: https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html

Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.



---

archive/issue_comments_554534.json:
```json
{
    "body": "<div id=\"comment:125\" align=\"right\">Comment 125</div>\n\nReplying to [@kwankyu](#comment%3A124):\n> Replying to [@dimpase](#comment%3A116):\n> > As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.\n> > Such a formula can be hosted on sagemath GH.\n\n> \n> The gnulib overlord is explicitly against this: https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html\n\nthat message contains an explict advice against using an outdated gnulib. \n\n```\nPackaging gnulib through a packaging system would have the effect that its\nusers see an older version of gnulib...\n```\n\nYet your branch does exactly this - as the part of gnulib you copy becomes outdated very soon indeed.\n\n\n> \n> Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.\n\nNo, no! A brew formula can pull from a git repo. How is it a burden?\nhttps://docs.brew.sh/How-to-Create-and-Maintain-a-Tap",
    "created_at": "2022-07-29T07:52:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554534",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:125" align="right">Comment 125</div>

Replying to [@kwankyu](#comment%3A124):
> Replying to [@dimpase](#comment%3A116):
> > As far as Homebrew is concerned, it's easy to provide a formula to install gnulib.
> > Such a formula can be hosted on sagemath GH.

> 
> The gnulib overlord is explicitly against this: https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html

that message contains an explict advice against using an outdated gnulib. 

```
Packaging gnulib through a packaging system would have the effect that its
users see an older version of gnulib...
```

Yet your branch does exactly this - as the part of gnulib you copy becomes outdated very soon indeed.


> 
> Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.

No, no! A brew formula can pull from a git repo. How is it a burden?
https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap



---

archive/issue_comments_554535.json:
```json
{
    "body": "<div id=\"comment:126\" align=\"right\">Comment 126</div>\n\nReplying to [@dimpase](#comment%3A125):\n> > Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.\n\n> \n> No, no! A brew formula can pull from a git repo.\n\nI see. Pulling the latest gnulib from the repo sounds nice.\n\nSo if gnulib is not available on the system (I guess this is almost always the case), \"./configure\" would error out saying that I should brew install gnulib before continue. Right? I imagine this would be an extra hurdle for a new user.\n\n> How is it a burden?\n> https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap\n\nI guess that practically gnulib in sage would need to be updated very rarely. If so, keeping hombrew formula (and conda formula too?) is a burden unnecessary in Matthias' approach.",
    "created_at": "2022-07-29T09:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554535",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:126" align="right">Comment 126</div>

Replying to [@dimpase](#comment%3A125):
> > Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.

> 
> No, no! A brew formula can pull from a git repo.

I see. Pulling the latest gnulib from the repo sounds nice.

So if gnulib is not available on the system (I guess this is almost always the case), "./configure" would error out saying that I should brew install gnulib before continue. Right? I imagine this would be an extra hurdle for a new user.

> How is it a burden?
> https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap

I guess that practically gnulib in sage would need to be updated very rarely. If so, keeping hombrew formula (and conda formula too?) is a burden unnecessary in Matthias' approach.



---

archive/issue_comments_554536.json:
```json
{
    "body": "<div id=\"comment:127\" align=\"right\">Comment 127</div>\n\nReplying to [@kwankyu](#comment%3A126):\n> Replying to [@dimpase](#comment%3A125):\n> > > Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.\n\n> > \n> > No, no! A brew formula can pull from a git repo.\n\n> \n> I see. Pulling the latest gnulib from the repo sounds nice.\n> \n> So if gnulib is not available on the system (I guess this is almost always the case),\n\nno, it's available on !Debian/Ubuntu, Fedora, etc\n\n\n> \"./configure\" would error out saying that I should brew install gnulib before continue.\n> Right? \n\nno. It would be done by `./bootstrap`.\n\nconfigure (and confgure spkg) would already provide what's needed from gnulib.\nSo anyone who doesn't modify `./configure` won't even notice.\n\n> I imagine this would be an extra hurdle for a new user.\n> \n> > How is it a burden?\n> > https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap\n\n> \n> I guess that practically gnulib in sage would need to be updated very rarely. If so, keeping hombrew formula (and conda formula too?) is a burden unnecessary in Matthias' approach. \n\nMatthias' solution dumps a lot of unamended code in Sage git tree, as if there is no internet or a system package to get it from...",
    "created_at": "2022-07-29T09:17:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554536",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:127" align="right">Comment 127</div>

Replying to [@kwankyu](#comment%3A126):
> Replying to [@dimpase](#comment%3A125):
> > > Maintaining the homebrew formula ourselves would be as burdensome as keeping a part of gnulib in our source tree.

> > 
> > No, no! A brew formula can pull from a git repo.

> 
> I see. Pulling the latest gnulib from the repo sounds nice.
> 
> So if gnulib is not available on the system (I guess this is almost always the case),

no, it's available on !Debian/Ubuntu, Fedora, etc


> "./configure" would error out saying that I should brew install gnulib before continue.
> Right? 

no. It would be done by `./bootstrap`.

configure (and confgure spkg) would already provide what's needed from gnulib.
So anyone who doesn't modify `./configure` won't even notice.

> I imagine this would be an extra hurdle for a new user.
> 
> > How is it a burden?
> > https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap

> 
> I guess that practically gnulib in sage would need to be updated very rarely. If so, keeping hombrew formula (and conda formula too?) is a burden unnecessary in Matthias' approach. 

Matthias' solution dumps a lot of unamended code in Sage git tree, as if there is no internet or a system package to get it from...



---

archive/issue_comments_554537.json:
```json
{
    "body": "<div id=\"comment:128\" align=\"right\">Comment 128</div>\n\nReplying to [@dimpase](#comment%3A127):\n> Replying to [@kwankyu](#comment%3A126):\n> > So if gnulib is not available on the system (I guess this is almost always the case),\n\n> no, it's available on !Debian/Ubuntu, Fedora, etc\n\nI meant mac users...\n\n> > \"./configure\" would error out saying that I should brew install gnulib before continue.\n> > Right? \n\n> \n> no. It would be done by `./bootstrap`.\n\nSo in your solution, `brew install gnulib` will be a prerequisite before `./bootstrap` for a new mac user?\n\nPresently, Xcode is a unique prerequisite to build sage from source. In your solution, `gnulib` will be another one.  \n\n> Matthias' solution dumps a lot of unamended code in Sage git tree, as if there is no internet or a system package to get it from...\n\nI agree that it is not beautiful. But in terms of maintainability, I think unamended code is less problematic than amended. (I am thinking of amended Sphinx extension code in sage)\n\nI guess linux users would prefer your solution, but as a mac user I prefer Matthias' one...",
    "created_at": "2022-07-29T11:31:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554537",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:128" align="right">Comment 128</div>

Replying to [@dimpase](#comment%3A127):
> Replying to [@kwankyu](#comment%3A126):
> > So if gnulib is not available on the system (I guess this is almost always the case),

> no, it's available on !Debian/Ubuntu, Fedora, etc

I meant mac users...

> > "./configure" would error out saying that I should brew install gnulib before continue.
> > Right? 

> 
> no. It would be done by `./bootstrap`.

So in your solution, `brew install gnulib` will be a prerequisite before `./bootstrap` for a new mac user?

Presently, Xcode is a unique prerequisite to build sage from source. In your solution, `gnulib` will be another one.  

> Matthias' solution dumps a lot of unamended code in Sage git tree, as if there is no internet or a system package to get it from...

I agree that it is not beautiful. But in terms of maintainability, I think unamended code is less problematic than amended. (I am thinking of amended Sphinx extension code in sage)

I guess linux users would prefer your solution, but as a mac user I prefer Matthias' one...



---

archive/issue_comments_554538.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nI am talking about Homebrew users, not the other macOS users.\n\nBesides, isn't it true that our gfortran doesn't build on the increasingly popular M1 macs, and so just Xcode is not enough any more, anyway.\n\nFor mac non-homebrew (and other gnulib-less platforms)  developers we can have few extra lines in bootsrtap to install gnulib into upstream/, if needed.",
    "created_at": "2022-07-29T11:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554538",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">Comment 9</div>

I am talking about Homebrew users, not the other macOS users.

Besides, isn't it true that our gfortran doesn't build on the increasingly popular M1 macs, and so just Xcode is not enough any more, anyway.

For mac non-homebrew (and other gnulib-less platforms)  developers we can have few extra lines in bootsrtap to install gnulib into upstream/, if needed.



---

archive/issue_comments_554539.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nDima, let me try to summarize the approach that you are advocating. Correct me if I get anything wrong.\n\nDima 1. Start maintaining a homebrew recipe that tracks the `main` branch of Gnulib.\n\nDima 2. Start maintaining a conda-forge feedstock that tracks the `main` branch of Gnulib.\n\nDima 3. Extend `bootstrap` so that it uses and runs a `gnulib-tool` found in the system, no matter what version.\n\nDima 4. Extend `bootstrap` so that if no `gnulib-tool` is found in the system, it uses `git` to checkout the HEAD of the `main` branch of Gnulib, and then runs `gnulib-tool` from there. (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)",
    "created_at": "2022-07-29T18:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554539",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">Comment 0</div>

Dima, let me try to summarize the approach that you are advocating. Correct me if I get anything wrong.

Dima 1. Start maintaining a homebrew recipe that tracks the `main` branch of Gnulib.

Dima 2. Start maintaining a conda-forge feedstock that tracks the `main` branch of Gnulib.

Dima 3. Extend `bootstrap` so that it uses and runs a `gnulib-tool` found in the system, no matter what version.

Dima 4. Extend `bootstrap` so that if no `gnulib-tool` is found in the system, it uses `git` to checkout the HEAD of the `main` branch of Gnulib, and then runs `gnulib-tool` from there. (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)



---

archive/issue_comments_554540.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\n1 and 2 are optional. 3 and 4 alone would do the job.",
    "created_at": "2022-07-29T22:20:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554540",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">Comment 1</div>

1 and 2 are optional. 3 and 4 alone would do the job.



---

archive/issue_comments_554541.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nThen would you agree that we leave 1 and 2 out of this discussion altogether? \n\nThese two just seem wildly out of place for our project -- we are not currently maintaining any downstream recipes and for the Sage project to start to do so would require a really good reason, I'd say.\n\n(By the way, homebrew packaging does not work like you suggest. Every package is versioned. There is no package that just goes like \"fetch from upstream HEAD\". All homebrew recipes that pull from a repository pull from a specific ref. To install a HEAD version instead of the pinned version, there is a special command `brew install --HEAD` that overrides the pin.)",
    "created_at": "2022-07-29T22:27:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554541",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">Comment 2</div>

Then would you agree that we leave 1 and 2 out of this discussion altogether? 

These two just seem wildly out of place for our project -- we are not currently maintaining any downstream recipes and for the Sage project to start to do so would require a really good reason, I'd say.

(By the way, homebrew packaging does not work like you suggest. Every package is versioned. There is no package that just goes like "fetch from upstream HEAD". All homebrew recipes that pull from a repository pull from a specific ref. To install a HEAD version instead of the pinned version, there is a special command `brew install --HEAD` that overrides the pin.)



---

archive/issue_comments_554542.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nSure we can concentrate on 3 and 4 here.",
    "created_at": "2022-07-31T09:00:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554542",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">Comment 3</div>

Sure we can concentrate on 3 and 4 here.



---

archive/issue_comments_554543.json:
```json
{
    "body": "<div id=\"comment:134\" align=\"right\">Comment 134</div>\n\nReplying to [@mkoeppe](#comment%3A130):\n> (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)\n\nThis is reasonable.",
    "created_at": "2022-07-31T13:41:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554543",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:134" align="right">Comment 134</div>

Replying to [@mkoeppe](#comment%3A130):
> (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)

This is reasonable.



---

archive/issue_comments_554544.json:
```json
{
    "body": "<div id=\"comment:135\" align=\"right\">Comment 135</div>\n\nReplying to [@kwankyu](#comment%3A134):\n> Replying to [@mkoeppe](#comment%3A130):\n> > (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)\n\n> \n> This is reasonable.\n\nIn fact, `./bootstrap` is already dependent on internet connectivity - if it fails it tries do download `configure.spkg`. For building from git repo, internet connectivity is mandatory too (at least for the 1st build, which fetches tarballs to unstream/).\n\nAs well, if someone wants to do a remotely meaningful work on Sage, and that's a reason to run bootstrap, then `git` would already be there.\n\n---\n\nWe should pay more attention to our source tarballs - ideally they should already be configured, and so running bootstrap is never needed.",
    "created_at": "2022-07-31T13:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554544",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:135" align="right">Comment 135</div>

Replying to [@kwankyu](#comment%3A134):
> Replying to [@mkoeppe](#comment%3A130):
> > (This introduces a dependency on `git` for the bootstrapping and a dependency on internet connectivity for bootstrapping.)

> 
> This is reasonable.

In fact, `./bootstrap` is already dependent on internet connectivity - if it fails it tries do download `configure.spkg`. For building from git repo, internet connectivity is mandatory too (at least for the 1st build, which fetches tarballs to unstream/).

As well, if someone wants to do a remotely meaningful work on Sage, and that's a reason to run bootstrap, then `git` would already be there.

---

We should pay more attention to our source tarballs - ideally they should already be configured, and so running bootstrap is never needed.



---

archive/issue_comments_554545.json:
```json
{
    "body": "<div id=\"comment:136\" align=\"right\">Comment 136</div>\n\nReplying to [@dimpase](#comment%3A135):\n> We should pay more attention to our source tarballs - ideally they should already be configured, and so running bootstrap is never needed.\n\nYou probably mean \"they should already be bootstrapped\". And yes, they are.",
    "created_at": "2022-07-31T15:40:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554545",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:136" align="right">Comment 136</div>

Replying to [@dimpase](#comment%3A135):
> We should pay more attention to our source tarballs - ideally they should already be configured, and so running bootstrap is never needed.

You probably mean "they should already be bootstrapped". And yes, they are.



---

archive/issue_comments_554546.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nGiven that 4 is necessary to be included in this plan, is there a really a need for 3 or can we eliminate it too and focus on 4?\n\nPeople don't have gnulib installations in their system installations because even though debian and some other distro do have this package, it is not dependency of any package.",
    "created_at": "2022-07-31T15:46:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554546",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">Comment 7</div>

Given that 4 is necessary to be included in this plan, is there a really a need for 3 or can we eliminate it too and focus on 4?

People don't have gnulib installations in their system installations because even though debian and some other distro do have this package, it is not dependency of any package.



---

archive/issue_comments_554547.json:
```json
{
    "body": "<div id=\"comment:138\" align=\"right\">Comment 138</div>\n\nReplying to [@mkoeppe](#comment%3A137):\n> Given that 4 is necessary to be included in this plan, is there a really a need for 3 or can we eliminate it too and focus on 4?\n> \n> People don't have gnulib installations in their system installations because even though debian and some other distro do have this package, it is not dependency of any package.\n\nThe plan is to add upstream/gnulib to PATH and check for gnulib-tool in ./bootstrap. \nIf found, just call it.\n\nIf not, `git clone` gnulib in upstream/ - then gnulib-tool is already there, so it can be called.\n\nThis is options 3+4 with almost the same amount of code as for option 4 alone.",
    "created_at": "2022-07-31T16:29:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554547",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:138" align="right">Comment 138</div>

Replying to [@mkoeppe](#comment%3A137):
> Given that 4 is necessary to be included in this plan, is there a really a need for 3 or can we eliminate it too and focus on 4?
> 
> People don't have gnulib installations in their system installations because even though debian and some other distro do have this package, it is not dependency of any package.

The plan is to add upstream/gnulib to PATH and check for gnulib-tool in ./bootstrap. 
If found, just call it.

If not, `git clone` gnulib in upstream/ - then gnulib-tool is already there, so it can be called.

This is options 3+4 with almost the same amount of code as for option 4 alone.



---

archive/issue_comments_554548.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nNext question regarding Dima 4: Are you sure you want us to `git clone` from upstream main HEAD? Not checkout a fixed commit?",
    "created_at": "2022-07-31T16:41:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554548",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">Comment 9</div>

Next question regarding Dima 4: Are you sure you want us to `git clone` from upstream main HEAD? Not checkout a fixed commit?



---

archive/issue_comments_554549.json:
```json
{
    "body": "<div id=\"comment:140\" align=\"right\">Comment 140</div>\n\nReplying to [@mkoeppe](#comment%3A139):\n> Next question regarding Dima 4: Are you sure you want us to `git clone` from upstream main HEAD? Not checkout a fixed commit?\n\nas far as I understand, upstream wants fresh checkouts, in absence of official releases.\nSo HEAD should it be.",
    "created_at": "2022-08-01T06:56:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554549",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:140" align="right">Comment 140</div>

Replying to [@mkoeppe](#comment%3A139):
> Next question regarding Dima 4: Are you sure you want us to `git clone` from upstream main HEAD? Not checkout a fixed commit?

as far as I understand, upstream wants fresh checkouts, in absence of official releases.
So HEAD should it be.



---

archive/issue_comments_554550.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nWe are not doing this for any other package. Why do you think it would be OK for `gnulib`?",
    "created_at": "2022-08-01T06:58:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554550",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">Comment 1</div>

We are not doing this for any other package. Why do you think it would be OK for `gnulib`?



---

archive/issue_comments_554551.json:
```json
{
    "body": "<div id=\"comment:142\" align=\"right\">Comment 142</div>\n\nReplying to [@mkoeppe](#comment%3A141):\n> We are not doing this for any other package. Why do you think it would be OK for `gnulib`?\n\nCause that's the advice of upstream, no?",
    "created_at": "2022-08-01T08:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554551",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:142" align="right">Comment 142</div>

Replying to [@mkoeppe](#comment%3A141):
> We are not doing this for any other package. Why do you think it would be OK for `gnulib`?

Cause that's the advice of upstream, no?



---

archive/issue_comments_554552.json:
```json
{
    "body": "<div id=\"comment:143\" align=\"right\">Comment 143</div>\n\nReplying to [@dimpase](#comment%3A142):\n> Replying to [@mkoeppe](#comment%3A141):\n> > We are not doing this for any other package. Why do you think it would be OK for `gnulib`?\n\n> Cause that's the advice of upstream, no?\n\nIt is secure to pull an old one tested for some time.",
    "created_at": "2022-08-01T09:10:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554552",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:143" align="right">Comment 143</div>

Replying to [@dimpase](#comment%3A142):
> Replying to [@mkoeppe](#comment%3A141):
> > We are not doing this for any other package. Why do you think it would be OK for `gnulib`?

> Cause that's the advice of upstream, no?

It is secure to pull an old one tested for some time.



---

archive/issue_comments_554553.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nlike this? lightly tested, but seems to work\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1eb6220dcadc38a5780e5169f6badffd7f5fbeb0\">1eb6220</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39b73269708e729d3b02278157b927a52ccd965d\">39b7326</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d784eccd7c1c2e08dacf56e79e113f1210705410\">d784ecc</a></td><td><code>Revert \"m4/: Add missing dependencies of iconv.m4\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/251a4d15f1a12882f79d9ef87fe27d88928660bf\">251a4d1</a></td><td><code>don't vendor gnulib files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48d80e479ba139150bf88f1f6f6e8abd26e315e8\">48d80e4</a></td><td><code>use gnulib-tool from ./bootstrap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cdda6533759f38662fba0bdf431dcae627d7ac2a\">cdda653</a></td><td><code>git-ignore everything installed by gnulib-tool</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bee409c741ecf58a38bf2a57fc389301d595f35f\">bee409c</a></td><td><code>install gnulib if needed; use a specific branch</code></td></tr></table>\n",
    "created_at": "2022-08-01T14:24:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554553",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">Comment 4</div>

like this? lightly tested, but seems to work

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1eb6220dcadc38a5780e5169f6badffd7f5fbeb0">1eb6220</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39b73269708e729d3b02278157b927a52ccd965d">39b7326</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d784eccd7c1c2e08dacf56e79e113f1210705410">d784ecc</a></td><td><code>Revert "m4/: Add missing dependencies of iconv.m4"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/251a4d15f1a12882f79d9ef87fe27d88928660bf">251a4d1</a></td><td><code>don't vendor gnulib files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48d80e479ba139150bf88f1f6f6e8abd26e315e8">48d80e4</a></td><td><code>use gnulib-tool from ./bootstrap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cdda6533759f38662fba0bdf431dcae627d7ac2a">cdda653</a></td><td><code>git-ignore everything installed by gnulib-tool</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bee409c741ecf58a38bf2a57fc389301d595f35f">bee409c</a></td><td><code>install gnulib if needed; use a specific branch</code></td></tr></table>




---

archive/issue_comments_554554.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)** to **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)**",
    "created_at": "2022-08-01T14:24:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554554",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)** to **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)**



---

archive/issue_comments_554555.json:
```json
{
    "body": "Changed commit from **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)** to **[bee409c](https://github.com/sagemath/sagetrac-mirror/commit/bee409c741ecf58a38bf2a57fc389301d595f35f)**",
    "created_at": "2022-08-01T14:24:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554555",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[4011cc4](https://github.com/sagemath/sagetrac-mirror/commit/4011cc4608bd325bb77f294ce9997517302e51f6)** to **[bee409c](https://github.com/sagemath/sagetrac-mirror/commit/bee409c741ecf58a38bf2a57fc389301d595f35f)**



---

archive/issue_comments_554556.json:
```json
{
    "body": "Changed commit from **[bee409c](https://github.com/sagemath/sagetrac-mirror/commit/bee409c741ecf58a38bf2a57fc389301d595f35f)** to **[61523e3](https://github.com/sagemath/sagetrac-mirror/commit/61523e3bbec4fd9ba0eb34bddfff5c492dc83f07)**",
    "created_at": "2022-08-01T18:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554556",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[bee409c](https://github.com/sagemath/sagetrac-mirror/commit/bee409c741ecf58a38bf2a57fc389301d595f35f)** to **[61523e3](https://github.com/sagemath/sagetrac-mirror/commit/61523e3bbec4fd9ba0eb34bddfff5c492dc83f07)**



---

archive/issue_comments_554557.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61523e3bbec4fd9ba0eb34bddfff5c492dc83f07\">61523e3</a></td><td><code>honour -q option throughout</code></td></tr></table>\n",
    "created_at": "2022-08-01T18:18:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554557",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5" align="right">Comment 5</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61523e3bbec4fd9ba0eb34bddfff5c492dc83f07">61523e3</a></td><td><code>honour -q option throughout</code></td></tr></table>




---

archive/issue_comments_554558.json:
```json
{
    "body": "<div id=\"comment:146\" align=\"right\">Comment 146</div>\n\nReplying to [@dimpase](#comment%3A142):\n> Replying to [@mkoeppe](#comment%3A141):\n> > We are not doing this [git clone from upstream main HEAD] for any other package. Why do you think it would be OK for `gnulib`?\n\n> Cause that's the advice of upstream, no?\n\nNo, it's not. In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n\nThe Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. \n\n\nDima 4 is equivalent to the \"git subcheckout\" method of https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh, which we discussed back in [comment:16](#comment%3A16). In https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L98 you can see that it can either check out HEAD or a fixed ref (`GNULIB_REVISION`)\n\nBut I see in the current branch you are using a fixed ref, that's great. Could you please add a comment that adds the date of the commit in a comment for reference?",
    "created_at": "2022-08-01T19:20:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554558",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:146" align="right">Comment 146</div>

Replying to [@dimpase](#comment%3A142):
> Replying to [@mkoeppe](#comment%3A141):
> > We are not doing this [git clone from upstream main HEAD] for any other package. Why do you think it would be OK for `gnulib`?

> Cause that's the advice of upstream, no?

No, it's not. In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.

The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. 


Dima 4 is equivalent to the "git subcheckout" method of https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh, which we discussed back in [comment:16](#comment%3A16). In https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L98 you can see that it can either check out HEAD or a fixed ref (`GNULIB_REVISION`)

But I see in the current branch you are using a fixed ref, that's great. Could you please add a comment that adds the date of the commit in a comment for reference?



---

archive/issue_comments_554559.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1aad8ee34e81dee2c83266989ad8f39d1e6f73c0\">1aad8ee</a></td><td><code>note the gnulib commit date</code></td></tr></table>\n",
    "created_at": "2022-08-01T20:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554559",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7" align="right">Comment 7</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1aad8ee34e81dee2c83266989ad8f39d1e6f73c0">1aad8ee</a></td><td><code>note the gnulib commit date</code></td></tr></table>




---

archive/issue_comments_554560.json:
```json
{
    "body": "Changed commit from **[61523e3](https://github.com/sagemath/sagetrac-mirror/commit/61523e3bbec4fd9ba0eb34bddfff5c492dc83f07)** to **[1aad8ee](https://github.com/sagemath/sagetrac-mirror/commit/1aad8ee34e81dee2c83266989ad8f39d1e6f73c0)**",
    "created_at": "2022-08-01T20:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554560",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[61523e3](https://github.com/sagemath/sagetrac-mirror/commit/61523e3bbec4fd9ba0eb34bddfff5c492dc83f07)** to **[1aad8ee](https://github.com/sagemath/sagetrac-mirror/commit/1aad8ee34e81dee2c83266989ad8f39d1e6f73c0)**



---

archive/issue_comments_554561.json:
```json
{
    "body": "<div id=\"comment:148\" align=\"right\">Comment 148</div>\n\nReplying to [@mkoeppe](#comment%3A146):\n> Replying to [@dimpase](#comment%3A142):\n> > Replying to [@mkoeppe](#comment%3A141):\n> > > We are not doing this [git clone from upstream main HEAD] for any other package. Why do you think it would be OK for `gnulib`?\n\n> > Cause that's the advice of upstream, no?\n\n> \n> No, it's not. In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n\nHow does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects. Less sure about an arbitrary commit from the repo, but I expect, as they can't be bothered to tag a release for 9 years, all of them to be OKish.\n\n> \n> The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. \n> \n> \n> Dima 4 is equivalent to the \"git subcheckout\" method of https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh, which we discussed back in [comment:16](#comment%3A16). In https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L98 you can see that it can either check out HEAD or a fixed ref (`GNULIB_REVISION`)\n\nmaybe. A full checkout of gnulib, submodule or not, is too slow anyway to be useful for us, and it's an overkill.\n\n> \n> But I see in the current branch you are using a fixed ref, that's great. Could you please add a comment that adds the date of the commit in a comment for reference?\n\ndone.",
    "created_at": "2022-08-01T20:38:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554561",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:148" align="right">Comment 148</div>

Replying to [@mkoeppe](#comment%3A146):
> Replying to [@dimpase](#comment%3A142):
> > Replying to [@mkoeppe](#comment%3A141):
> > > We are not doing this [git clone from upstream main HEAD] for any other package. Why do you think it would be OK for `gnulib`?

> > Cause that's the advice of upstream, no?

> 
> No, it's not. In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.

How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects. Less sure about an arbitrary commit from the repo, but I expect, as they can't be bothered to tag a release for 9 years, all of them to be OKish.

> 
> The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. 
> 
> 
> Dima 4 is equivalent to the "git subcheckout" method of https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh, which we discussed back in [comment:16](#comment%3A16). In https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L98 you can see that it can either check out HEAD or a fixed ref (`GNULIB_REVISION`)

maybe. A full checkout of gnulib, submodule or not, is too slow anyway to be useful for us, and it's an overkill.

> 
> But I see in the current branch you are using a fixed ref, that's great. Could you please add a comment that adds the date of the commit in a comment for reference?

done.



---

archive/issue_comments_554562.json:
```json
{
    "body": "<div id=\"comment:149\" align=\"right\">Comment 149</div>\n\nReplying to [@dimpase](#comment%3A148):\n> > In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n\n> \n> How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects.\n\nI don't know about Gentoo (but see Francois [comment:59](#comment%3A59), [comment:61](#comment%3A61))\n\nAnd no, on Debian this package is *not* used for anything. It is not a build dependency of any package. [comment:101](#comment%3A101)",
    "created_at": "2022-08-01T20:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554562",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:149" align="right">Comment 149</div>

Replying to [@dimpase](#comment%3A148):
> > In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.

> 
> How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects.

I don't know about Gentoo (but see Francois [comment:59](#comment%3A59), [comment:61](#comment%3A61))

And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. [comment:101](#comment%3A101)



---

archive/issue_comments_554563.json:
```json
{
    "body": "<div id=\"comment:150\" align=\"right\">Comment 150</div>\n\nReplying to [@dimpase](#comment%3A148):\n> How does one know which version is good, and which is not?\n\nYou asked that before in [comment:46](#comment%3A46), and I answered it in [comment:47](#comment%3A47).",
    "created_at": "2022-08-01T20:49:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554563",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:150" align="right">Comment 150</div>

Replying to [@dimpase](#comment%3A148):
> How does one know which version is good, and which is not?

You asked that before in [comment:46](#comment%3A46), and I answered it in [comment:47](#comment%3A47).



---

archive/issue_comments_554564.json:
```json
{
    "body": "<div id=\"comment:151\" align=\"right\">Comment 151</div>\n\nReplying to [@mkoeppe](#comment%3A149):\n> Replying to [@dimpase](#comment%3A148):\n> > > In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n\n> > \n> > How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects.\n\n> \n> I don't know about Gentoo (but see Francois [comment:59](#comment%3A59), [comment:61](#comment%3A61))\n> \n> And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. [comment:101](#comment%3A101)\n\n\"It is packaged as a tool for Debian package maintainers.\" - you wrote it yourself. So it is used, I presume, just not in the way controlled by official dependencies. \n\n---\n\nMy theory is that gnulib maintainers just can't be bothered to do a sane redesign - no wonder autotools receive so much public hate...",
    "created_at": "2022-08-01T20:53:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554564",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:151" align="right">Comment 151</div>

Replying to [@mkoeppe](#comment%3A149):
> Replying to [@dimpase](#comment%3A148):
> > > In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.

> > 
> > How does one know which version is good, and which is not? I presume a version used by Debian or Gentoo is likely to be OK, because it's actually used by many projects.

> 
> I don't know about Gentoo (but see Francois [comment:59](#comment%3A59), [comment:61](#comment%3A61))
> 
> And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. [comment:101](#comment%3A101)

"It is packaged as a tool for Debian package maintainers." - you wrote it yourself. So it is used, I presume, just not in the way controlled by official dependencies. 

---

My theory is that gnulib maintainers just can't be bothered to do a sane redesign - no wonder autotools receive so much public hate...



---

archive/issue_comments_554565.json:
```json
{
    "body": "<div id=\"comment:152\" align=\"right\">Comment 152</div>\n\nReplying to [@dimpase](#comment%3A151):\n> > And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. [comment:101](#comment%3A101)\n\n> \n> \"It is packaged as a tool for Debian package maintainers.\" - you wrote it yourself. So it is used, I presume, just not in the way controlled by official dependencies. \n\nYes, for Debian package maintainers (persons) for their convenience in case they need to work on a package that has imported gnulib modules.",
    "created_at": "2022-08-01T20:55:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554565",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:152" align="right">Comment 152</div>

Replying to [@dimpase](#comment%3A151):
> > And no, on Debian this package is *not* used for anything. It is not a build dependency of any package. [comment:101](#comment%3A101)

> 
> "It is packaged as a tool for Debian package maintainers." - you wrote it yourself. So it is used, I presume, just not in the way controlled by official dependencies. 

Yes, for Debian package maintainers (persons) for their convenience in case they need to work on a package that has imported gnulib modules.



---

archive/issue_comments_554566.json:
```json
{
    "body": "<div id=\"comment:153\" align=\"right\">Comment 153</div>\n\nReplying to [@mkoeppe](#comment%3A150):\n> Replying to [@dimpase](#comment%3A148):\n> > How does one know which version is good, and which is not?\n\n> \n> You asked that before in [comment:46](#comment%3A46), and I answered it in [comment:47](#comment%3A47).\n\nNamely - we treat it like any other package upgrade.",
    "created_at": "2022-08-01T20:57:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554566",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:153" align="right">Comment 153</div>

Replying to [@mkoeppe](#comment%3A150):
> Replying to [@dimpase](#comment%3A148):
> > How does one know which version is good, and which is not?

> 
> You asked that before in [comment:46](#comment%3A46), and I answered it in [comment:47](#comment%3A47).

Namely - we treat it like any other package upgrade.



---

archive/issue_comments_554567.json:
```json
{
    "body": "<div id=\"comment:154\" align=\"right\">Comment 154</div>\n\nReplying to [@mkoeppe](#comment%3A150):\n> Replying to [@dimpase](#comment%3A148):\n> > How does one know which version is good, and which is not?\n\n> \n> You asked that before in [comment:46](#comment%3A46), and I answered it in [comment:47](#comment%3A47).\n\nif true, this is an insanely wasteful approach - meaning that every, EVERY project using their beloved code must be doing its own testing?! Basically, they go to great heights to prevent organised QA of their code - \"please everyone roll your own, and no, you must not organise to do share this burden\" ?!",
    "created_at": "2022-08-01T20:59:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554567",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:154" align="right">Comment 154</div>

Replying to [@mkoeppe](#comment%3A150):
> Replying to [@dimpase](#comment%3A148):
> > How does one know which version is good, and which is not?

> 
> You asked that before in [comment:46](#comment%3A46), and I answered it in [comment:47](#comment%3A47).

if true, this is an insanely wasteful approach - meaning that every, EVERY project using their beloved code must be doing its own testing?! Basically, they go to great heights to prevent organised QA of their code - "please everyone roll your own, and no, you must not organise to do share this burden" ?!



---

archive/issue_comments_554568.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nI am getting tired of seeing the two of you arguing back and forth without anyone wanting to concede. It is sterile.\n\nWe need some form of this ticket in 9.7 for cygwin as far as I understand. If we don't solve your argument soon. Exit cygwin support.\n\nI want you to agree to each write a small brief about your side of the argument and then we will post them on sage-devel for a vote. Someone will not get what they think is right. And if we choose wrong it will be apparent soon enough. But this deadlock has to end.",
    "created_at": "2022-08-01T21:04:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554568",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">Comment 5</div>

I am getting tired of seeing the two of you arguing back and forth without anyone wanting to concede. It is sterile.

We need some form of this ticket in 9.7 for cygwin as far as I understand. If we don't solve your argument soon. Exit cygwin support.

I want you to agree to each write a small brief about your side of the argument and then we will post them on sage-devel for a vote. Someone will not get what they think is right. And if we choose wrong it will be apparent soon enough. But this deadlock has to end.



---

archive/issue_comments_554569.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nFrancois, in fact, today I have here a complete branch, ready for review. IMHO I convinced Matthias to at least look at it :-)",
    "created_at": "2022-08-01T21:07:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554569",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">Comment 6</div>

Francois, in fact, today I have here a complete branch, ready for review. IMHO I convinced Matthias to at least look at it :-)



---

archive/issue_comments_554570.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nDima, I also looked at your previous branch, which was easily seen to be not suitable",
    "created_at": "2022-08-01T21:08:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554570",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">Comment 7</div>

Dima, I also looked at your previous branch, which was easily seen to be not suitable



---

archive/issue_events_449007.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T21:11:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449007"
}
```



---

archive/issue_events_449008.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T21:11:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449008"
}
```



---

archive/issue_comments_554571.json:
```json
{
    "body": "<div id=\"comment:158\" align=\"right\">Comment 158</div>\n\nReplying to [@kiwifb](#comment%3A155):\n> We need some form of this ticket in 9.7 for cygwin as far as I understand. If we don't solve your argument soon. Exit cygwin support.\n\nNo, it has nothing to do with Cygwin.\n\nIn fact, there isn't even a bug to be fixed. I thought there was when Marc reported this failure but there is actually no problem that needs to be solved. When gettext-devel is installed (as is documented as a bootstrap dependency), everything works OK.\n\nPresent ticket is an improvement that removes the remaining bits of dependency on gettext in our bootstrap process.",
    "created_at": "2022-08-01T21:11:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554571",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:158" align="right">Comment 158</div>

Replying to [@kiwifb](#comment%3A155):
> We need some form of this ticket in 9.7 for cygwin as far as I understand. If we don't solve your argument soon. Exit cygwin support.

No, it has nothing to do with Cygwin.

In fact, there isn't even a bug to be fixed. I thought there was when Marc reported this failure but there is actually no problem that needs to be solved. When gettext-devel is installed (as is documented as a bootstrap dependency), everything works OK.

Present ticket is an improvement that removes the remaining bits of dependency on gettext in our bootstrap process.



---

archive/issue_events_449009.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-08-01T21:13:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449009"
}
```



---

archive/issue_events_449010.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-08-01T21:13:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449010"
}
```



---

archive/issue_comments_554572.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nWhatever it is for, it seems even less worth the arguing.\n\nYou have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do. I am giving you 24 hours from this post to reach an agreement. After that I throw the whole thing on sage-devel for a vote.",
    "created_at": "2022-08-01T21:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554572",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">Comment 9</div>

Whatever it is for, it seems even less worth the arguing.

You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do. I am giving you 24 hours from this post to reach an agreement. After that I throw the whole thing on sage-devel for a vote.



---

archive/issue_comments_554573.json:
```json
{
    "body": "<div id=\"comment:160\" align=\"right\">Comment 160</div>\n\nReplying to [@dimpase](#comment%3A154):\n> if true, this is an insanely wasteful approach [... by upstream Gnulib]\n\nIt's not helpful for this ticket. As I said before, if you want to criticize their design decisions, this is the wrong forum. [comment:73](#comment%3A73)",
    "created_at": "2022-08-01T21:13:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554573",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:160" align="right">Comment 160</div>

Replying to [@dimpase](#comment%3A154):
> if true, this is an insanely wasteful approach [... by upstream Gnulib]

It's not helpful for this ticket. As I said before, if you want to criticize their design decisions, this is the wrong forum. [comment:73](#comment%3A73)



---

archive/issue_comments_554574.json:
```json
{
    "body": "<div id=\"comment:161\" align=\"right\">Comment 161</div>\n\nReplying to [@kiwifb](#comment%3A159):\n> You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do.\n\n+1, we actually made progress to determining something concrete that can be voted on in [comment:130](#comment%3A130) to [comment:133](#comment%3A133).",
    "created_at": "2022-08-01T21:15:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554574",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:161" align="right">Comment 161</div>

Replying to [@kiwifb](#comment%3A159):
> You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do.

+1, we actually made progress to determining something concrete that can be voted on in [comment:130](#comment%3A130) to [comment:133](#comment%3A133).



---

archive/issue_comments_554575.json:
```json
{
    "body": "<div id=\"comment:162\" align=\"right\">Comment 162</div>\n\nReplying to [@mkoeppe](#comment%3A146):\n> In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.\n> \n> The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. \n\nRemains to be resolved whether Dima 3 is essential to Dima's plan or whether Gnulib's solution for this -- `GNULIB_SRCDIR` -- is acceptable.",
    "created_at": "2022-08-01T21:22:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554575",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:162" align="right">Comment 162</div>

Replying to [@mkoeppe](#comment%3A146):
> In the message that you refer to in [comment:125](#comment%3A125), they argue against using a random arbitrary version from a package manager (which will be untested for use with the package to be built) -- which is Dima 3.
> 
> The Gnulib-provided bootstrap script - https://github.com/coreutils/gnulib/blob/master/top/bootstrap#L84 - does not take an arbitrary version of gnulib-tools from the system. Rather, developers can set the environment variable `GNULIB_SRCDIR` if they want to bring their own copy. 

Remains to be resolved whether Dima 3 is essential to Dima's plan or whether Gnulib's solution for this -- `GNULIB_SRCDIR` -- is acceptable.



---

archive/issue_comments_554576.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nI'm perfectly fine with only using `./upstream/gnulib/gnulib-tool`, if you don't like  `gnulib-tool` in the PATH.",
    "created_at": "2022-08-01T21:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554576",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">Comment 3</div>

I'm perfectly fine with only using `./upstream/gnulib/gnulib-tool`, if you don't like  `gnulib-tool` in the PATH.



---

archive/issue_comments_554577.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nOK, could you update your branch please?",
    "created_at": "2022-08-02T01:18:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554577",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">Comment 4</div>

OK, could you update your branch please?



---

archive/issue_comments_554578.json:
```json
{
    "body": "Changed commit from **[1aad8ee](https://github.com/sagemath/sagetrac-mirror/commit/1aad8ee34e81dee2c83266989ad8f39d1e6f73c0)** to **[eb6e614](https://github.com/sagemath/sagetrac-mirror/commit/eb6e614cbc00fc6043dd72135a1a3b0dec5024b9)**",
    "created_at": "2022-08-02T07:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554578",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1aad8ee](https://github.com/sagemath/sagetrac-mirror/commit/1aad8ee34e81dee2c83266989ad8f39d1e6f73c0)** to **[eb6e614](https://github.com/sagemath/sagetrac-mirror/commit/eb6e614cbc00fc6043dd72135a1a3b0dec5024b9)**



---

archive/issue_comments_554579.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb6e614cbc00fc6043dd72135a1a3b0dec5024b9\">eb6e614</a></td><td><code>ignore gnulib-tool in PATH</code></td></tr></table>\n",
    "created_at": "2022-08-02T07:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554579",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5" align="right">Comment 5</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb6e614cbc00fc6043dd72135a1a3b0dec5024b9">eb6e614</a></td><td><code>ignore gnulib-tool in PATH</code></td></tr></table>




---

archive/issue_comments_554580.json:
```json
{
    "body": "<div id=\"comment:166\" align=\"right\">Comment 166</div>\n\nReplying to [@mkoeppe](#comment%3A164):\n> OK, could you update your branch please?\n\ndone",
    "created_at": "2022-08-02T07:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554580",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:166" align="right">Comment 166</div>

Replying to [@mkoeppe](#comment%3A164):
> OK, could you update your branch please?

done



---

archive/issue_comments_554581.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nThanks.\n\nLooking at the `install_iconv` function in `bootstrap`: If we ever have to upgrade Gnulib (change the hardcoded commit), there is no mechanism that will bring this change to developer's `upstream` directories when `$SAGE_ROOT/upstream/gnulib/gnulib-tool` already exists. So this is not a complete solution yet",
    "created_at": "2022-08-02T18:48:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554581",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">Comment 7</div>

Thanks.

Looking at the `install_iconv` function in `bootstrap`: If we ever have to upgrade Gnulib (change the hardcoded commit), there is no mechanism that will bring this change to developer's `upstream` directories when `$SAGE_ROOT/upstream/gnulib/gnulib-tool` already exists. So this is not a complete solution yet



---

archive/issue_comments_554582.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\n(Neither `make distclean` nor `make bootstrap-clean` clean anything in `upstream/`.)",
    "created_at": "2022-08-02T18:50:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554582",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">Comment 8</div>

(Neither `make distclean` nor `make bootstrap-clean` clean anything in `upstream/`.)



---

archive/issue_comments_554583.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nOf course, Gnulib has a complete solution for all of this: Its implementation stretches over the following files:\n- https://github.com/coreutils/gnulib/blob/master/top/bootstrap\n- https://github.com/coreutils/gnulib/blob/master/top/autopull.sh\n- https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh\n- https://github.com/coreutils/gnulib/blob/master/top/gen-bootstrap.sed",
    "created_at": "2022-08-02T18:53:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554583",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">Comment 9</div>

Of course, Gnulib has a complete solution for all of this: Its implementation stretches over the following files:
- https://github.com/coreutils/gnulib/blob/master/top/bootstrap
- https://github.com/coreutils/gnulib/blob/master/top/autopull.sh
- https://github.com/coreutils/gnulib/blob/master/top/gitsub.sh
- https://github.com/coreutils/gnulib/blob/master/top/gen-bootstrap.sed



---

archive/issue_comments_554584.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nI can add removal of upstream/gnulib to bootstrap-clean target",
    "created_at": "2022-08-02T20:19:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554584",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:0" align="right">Comment 0</div>

I can add removal of upstream/gnulib to bootstrap-clean target



---

archive/issue_comments_554585.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nCan I take the motions happening in the last 24 hours as a sign you are moving towards a resolution without needing arbitration?",
    "created_at": "2022-08-02T21:42:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554585",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:1" align="right">Comment 1</div>

Can I take the motions happening in the last 24 hours as a sign you are moving towards a resolution without needing arbitration?



---

archive/issue_comments_554586.json:
```json
{
    "body": "<div id=\"comment:172\" align=\"right\">Comment 172</div>\n\nReplying to [@kiwifb](#comment%3A171):\n> Can I take the motions happening in the last 24 hours as a sign you are moving towards a resolution without needing arbitration?\n\nYes, they are :)",
    "created_at": "2022-08-02T21:56:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554586",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:172" align="right">Comment 172</div>

Replying to [@kiwifb](#comment%3A171):
> Can I take the motions happening in the last 24 hours as a sign you are moving towards a resolution without needing arbitration?

Yes, they are :)



---

archive/issue_comments_554587.json:
```json
{
    "body": "<div id=\"comment:173\" align=\"right\">Comment 173</div>\n\nReplying to [@dimpase](#comment%3A170):\n> I can add removal of upstream/gnulib to bootstrap-clean target\n\nthis is actually not a good idea, as it will force git clone on every run on bootstrap.\n\nOn the other hand, `mainainer-clean` target removes `upstream/` all together.\nFor the purposes of avoiding a possible confusion when `upstream/` is a symbolic link,\nI'll add an explicit removal of `upstream/gnulib` to `mainainer-clean`",
    "created_at": "2022-08-03T09:38:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554587",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:173" align="right">Comment 173</div>

Replying to [@dimpase](#comment%3A170):
> I can add removal of upstream/gnulib to bootstrap-clean target

this is actually not a good idea, as it will force git clone on every run on bootstrap.

On the other hand, `mainainer-clean` target removes `upstream/` all together.
For the purposes of avoiding a possible confusion when `upstream/` is a symbolic link,
I'll add an explicit removal of `upstream/gnulib` to `mainainer-clean`



---

archive/issue_comments_554588.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb8e36760e6f201d4bc1b280676f4ab860a12132\">cb8e367</a></td><td><code>adding explicit removal of upstream/gnulib to maintainer-clean target</code></td></tr></table>\n",
    "created_at": "2022-08-03T09:40:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554588",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4" align="right">Comment 4</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb8e36760e6f201d4bc1b280676f4ab860a12132">cb8e367</a></td><td><code>adding explicit removal of upstream/gnulib to maintainer-clean target</code></td></tr></table>




---

archive/issue_comments_554589.json:
```json
{
    "body": "Changed commit from **[eb6e614](https://github.com/sagemath/sagetrac-mirror/commit/eb6e614cbc00fc6043dd72135a1a3b0dec5024b9)** to **[cb8e367](https://github.com/sagemath/sagetrac-mirror/commit/cb8e36760e6f201d4bc1b280676f4ab860a12132)**",
    "created_at": "2022-08-03T09:40:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554589",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[eb6e614](https://github.com/sagemath/sagetrac-mirror/commit/eb6e614cbc00fc6043dd72135a1a3b0dec5024b9)** to **[cb8e367](https://github.com/sagemath/sagetrac-mirror/commit/cb8e36760e6f201d4bc1b280676f4ab860a12132)**



---

archive/issue_comments_554590.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nI don't think the last change is useful. `rm -rf` does not follow symlinks either way",
    "created_at": "2022-08-03T18:01:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554590",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">Comment 5</div>

I don't think the last change is useful. `rm -rf` does not follow symlinks either way



---

archive/issue_comments_554591.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nit can be skipped, no problem. After all as soon as upstream/ is a symlink, all bets are off.",
    "created_at": "2022-08-03T20:06:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554591",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">Comment 6</div>

it can be skipped, no problem. After all as soon as upstream/ is a symlink, all bets are off.



---

archive/issue_comments_554592.json:
```json
{
    "body": "Changed commit from **[cb8e367](https://github.com/sagemath/sagetrac-mirror/commit/cb8e36760e6f201d4bc1b280676f4ab860a12132)** to **[38916cd](https://github.com/sagemath/sagetrac-mirror/commit/38916cd93b64344ceecaf77681153410746099cd)**",
    "created_at": "2022-08-04T08:09:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554592",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[cb8e367](https://github.com/sagemath/sagetrac-mirror/commit/cb8e36760e6f201d4bc1b280676f4ab860a12132)** to **[38916cd](https://github.com/sagemath/sagetrac-mirror/commit/38916cd93b64344ceecaf77681153410746099cd)**



---

archive/issue_comments_554593.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38916cd93b64344ceecaf77681153410746099cd\">38916cd</a></td><td><code>Revert \"adding explicit removal of upstream/gnulib to maintainer-clean target\"</code></td></tr></table>\n",
    "created_at": "2022-08-04T08:09:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554593",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7" align="right">Comment 7</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38916cd93b64344ceecaf77681153410746099cd">38916cd</a></td><td><code>Revert "adding explicit removal of upstream/gnulib to maintainer-clean target"</code></td></tr></table>




---

archive/issue_comments_554594.json:
```json
{
    "body": "<div id=\"comment:178\" align=\"right\">Comment 178</div>\n\nReplying to [@mkoeppe](#comment%3A175):\n> I don't think the last change is useful. `rm -rf` does not follow symlinks either way\n\nOK, I've dropped it. Anything else?\n\nPS. Compared with the gnulib's `gitsub.sh`, the branch doesn't do a full checkout of their repo (which is 250Mb), it only checks out 83Mb (it probably can be trimmed even more, I didn't look into this). So that's a clear advantage, im my view (checking out a 250Mb repo takes a lot of time).",
    "created_at": "2022-08-04T09:11:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554594",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:178" align="right">Comment 178</div>

Replying to [@mkoeppe](#comment%3A175):
> I don't think the last change is useful. `rm -rf` does not follow symlinks either way

OK, I've dropped it. Anything else?

PS. Compared with the gnulib's `gitsub.sh`, the branch doesn't do a full checkout of their repo (which is 250Mb), it only checks out 83Mb (it probably can be trimmed even more, I didn't look into this). So that's a clear advantage, im my view (checking out a 250Mb repo takes a lot of time).



---

archive/issue_comments_554595.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nI think it is problematic to require developers to know that they need to do `make maintainer-clean` when they pick up a branch with a gnulib version change.\n\nPreviously in this thread, you seemed very concerned about the maintenance burden that gnulib updates bring (comment:25, [comment:82](#comment%3A82)). The lack of an incremental update mechanism in your current branch places such a burden on developers who aren't even touching gnulib - everyone who runs gnulib.\n\nWhat do others think about this?",
    "created_at": "2022-08-04T17:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554595",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">Comment 9</div>

I think it is problematic to require developers to know that they need to do `make maintainer-clean` when they pick up a branch with a gnulib version change.

Previously in this thread, you seemed very concerned about the maintenance burden that gnulib updates bring (comment:25, [comment:82](#comment%3A82)). The lack of an incremental update mechanism in your current branch places such a burden on developers who aren't even touching gnulib - everyone who runs gnulib.

What do others think about this?



---

archive/issue_comments_554596.json:
```json
{
    "body": "<div id=\"comment:180\" align=\"right\">Comment 180</div>\n\nReplying to [@mkoeppe](#comment%3A179):\n> I think it is problematic to require developers to know that they need to do `make maintainer-clean` when they pick up a branch with a gnulib version change.\n> \n> Previously in this thread, you seemed very concerned about the maintenance burden that gnulib updates bring (comment:25, [comment:82](#comment%3A82)). The lack of an incremental update mechanism in your current branch places such a burden on developers who aren't even touching gnulib - everyone who runs gnulib.\n\nMy main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\nAs to incremental updates - you argued that we don't want to follow the upstream closely, i.e. no incremental updates, but just want to pin a gnulib commit, and then, at a good moment, pin a newer one. That's what my branch does.\n\nI can add a comment in ./bootstrap regarding the way to do this kind of update -  that certainly should be enough IMHO.",
    "created_at": "2022-08-04T20:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554596",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:180" align="right">Comment 180</div>

Replying to [@mkoeppe](#comment%3A179):
> I think it is problematic to require developers to know that they need to do `make maintainer-clean` when they pick up a branch with a gnulib version change.
> 
> Previously in this thread, you seemed very concerned about the maintenance burden that gnulib updates bring (comment:25, [comment:82](#comment%3A82)). The lack of an incremental update mechanism in your current branch places such a burden on developers who aren't even touching gnulib - everyone who runs gnulib.

My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

As to incremental updates - you argued that we don't want to follow the upstream closely, i.e. no incremental updates, but just want to pin a gnulib commit, and then, at a good moment, pin a newer one. That's what my branch does.

I can add a comment in ./bootstrap regarding the way to do this kind of update -  that certainly should be enough IMHO.



---

archive/issue_comments_554597.json:
```json
{
    "body": "<div id=\"comment:181\" align=\"right\">Comment 181</div>\n\nReplying to [@dimpase](#comment%3A180):\n> As to incremental updates - you argued that we don't want to follow the upstream closely, i.e. no incremental updates, but just want to pin a gnulib commit, and then, at a good moment, pin a newer one. That's what my branch does.\n\nYes, but developers (everyone who has ever run `./bootstrap` in the tree) will not get the new pin unless they manually run `make maintainer-clean`.",
    "created_at": "2022-08-04T20:32:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554597",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:181" align="right">Comment 181</div>

Replying to [@dimpase](#comment%3A180):
> As to incremental updates - you argued that we don't want to follow the upstream closely, i.e. no incremental updates, but just want to pin a gnulib commit, and then, at a good moment, pin a newer one. That's what my branch does.

Yes, but developers (everyone who has ever run `./bootstrap` in the tree) will not get the new pin unless they manually run `make maintainer-clean`.



---

archive/issue_comments_554598.json:
```json
{
    "body": "<div id=\"comment:182\" align=\"right\">Comment 182</div>\n\nReplying to [@dimpase](#comment%3A180):\n> My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\nYou still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB from the Gnulib git repo?\n\nTo compare with the copied files:\n\n```\n$ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4\n 20K\tconfig/config.rpath\n8.0K\tm4/lib-ld.m4\n 36K\tm4/lib-link.m4\n 12K\tm4/lib-prefix.m4\n 12K\tm4/iconv.m4\n 24K\tm4/host-cpu-c-abi.m4\n```",
    "created_at": "2022-08-04T20:49:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554598",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:182" align="right">Comment 182</div>

Replying to [@dimpase](#comment%3A180):
> My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB from the Gnulib git repo?

To compare with the copied files:

```
$ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4
 20K	config/config.rpath
8.0K	m4/lib-ld.m4
 36K	m4/lib-link.m4
 12K	m4/lib-prefix.m4
 12K	m4/iconv.m4
 24K	m4/host-cpu-c-abi.m4
```



---

archive/issue_comments_554599.json:
```json
{
    "body": "<div id=\"comment:183\" align=\"right\">Comment 183</div>\n\nReplying to [@mkoeppe](#comment%3A182):\n> Replying to [@dimpase](#comment%3A180):\n> > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\n> \n> You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB \n> from the Gnulib git repo?\n\nThe complexity of the 20-line script? Where is the compelexity there? \nThere isn't even a loop. 1/3rd of it is about supporting `-q` option of ./bootstrap.\n\n> \n> To compare with the copied files:\n> \n> ```\n> $ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4\n>  20K\tconfig/config.rpath\n> 8.0K\tm4/lib-ld.m4\n>  36K\tm4/lib-link.m4\n>  12K\tm4/lib-prefix.m4\n>  12K\tm4/iconv.m4\n>  24K\tm4/host-cpu-c-abi.m4\n> ```\n\nThis is not Sage's code, it has no place in Sage git tree - and there are means to get it in if needed. And your branch provides absolutely zero support for updating said code, while you keep arguing here that my code provides less than ideal support for it...\n\nTo update files in your branch, one would need to manually install gnulib, and run `gnulib-tool` with appropriate options, remove the unneeded files, and check the result in. You already made a mistake setting it up in the previous ticket. \n\nUpdating in my branch is trivial compared to this.",
    "created_at": "2022-08-04T21:59:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554599",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:183" align="right">Comment 183</div>

Replying to [@mkoeppe](#comment%3A182):
> Replying to [@dimpase](#comment%3A180):
> > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

> 
> You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB 
> from the Gnulib git repo?

The complexity of the 20-line script? Where is the compelexity there? 
There isn't even a loop. 1/3rd of it is about supporting `-q` option of ./bootstrap.

> 
> To compare with the copied files:
> 
> ```
> $ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4
>  20K	config/config.rpath
> 8.0K	m4/lib-ld.m4
>  36K	m4/lib-link.m4
>  12K	m4/lib-prefix.m4
>  12K	m4/iconv.m4
>  24K	m4/host-cpu-c-abi.m4
> ```

This is not Sage's code, it has no place in Sage git tree - and there are means to get it in if needed. And your branch provides absolutely zero support for updating said code, while you keep arguing here that my code provides less than ideal support for it...

To update files in your branch, one would need to manually install gnulib, and run `gnulib-tool` with appropriate options, remove the unneeded files, and check the result in. You already made a mistake setting it up in the previous ticket. 

Updating in my branch is trivial compared to this.



---

archive/issue_comments_554600.json:
```json
{
    "body": "<div id=\"comment:184\" align=\"right\">Comment 184</div>\n\nReplying to [@dimpase](#comment%3A183):\n> Replying to [@mkoeppe](#comment%3A182):\n> > Replying to [@dimpase](#comment%3A180):\n> > > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\n> > \n> > You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB \n> > from the Gnulib git repo?\n\n> \n> The complexity of the 20-line script? Where is the compelexity there? \n\nYour script is not complete yet, see [comment:179](#comment%3A179)",
    "created_at": "2022-08-04T22:02:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554600",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:184" align="right">Comment 184</div>

Replying to [@dimpase](#comment%3A183):
> Replying to [@mkoeppe](#comment%3A182):
> > Replying to [@dimpase](#comment%3A180):
> > > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

> > 
> > You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB 
> > from the Gnulib git repo?

> 
> The complexity of the 20-line script? Where is the compelexity there? 

Your script is not complete yet, see [comment:179](#comment%3A179)



---

archive/issue_comments_554601.json:
```json
{
    "body": "<div id=\"comment:185\" align=\"right\">Comment 185</div>\n\nReplying to [@dimpase](#comment%3A183):\n> Updating in my branch is trivial compared to this.\n\nFor the ticket author who works on the gnulib update, yes. For everyone else, as I said, it introduces a burden.",
    "created_at": "2022-08-04T22:12:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554601",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:185" align="right">Comment 185</div>

Replying to [@dimpase](#comment%3A183):
> Updating in my branch is trivial compared to this.

For the ticket author who works on the gnulib update, yes. For everyone else, as I said, it introduces a burden.



---

archive/issue_comments_554602.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nBut maybe you can just find a simple solution for this problem? Just a few more lines of shell script",
    "created_at": "2022-08-04T22:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554602",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:6" align="right">Comment 6</div>

But maybe you can just find a simple solution for this problem? Just a few more lines of shell script



---

archive/issue_comments_554603.json:
```json
{
    "body": "<div id=\"comment:187\" align=\"right\">Comment 187</div>\n\nReplying to [@mkoeppe](#comment%3A184):\n> Replying to [@dimpase](#comment%3A183):\n> > Replying to [@mkoeppe](#comment%3A182):\n> > > Replying to [@dimpase](#comment%3A180):\n> > > > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. \n\n> > > \n> > > You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB \n> > > from the Gnulib git repo?\n\n> > \n> > The complexity of the 20-line script? Where is the compelexity there? \n\n> \n> Your script is not complete yet, see [comment:179](#comment%3A179)\n\nAs I wrote, I think it suffices to put something like\n\n```\n# to update macros coming from gnulib:\n# 1) change the commit hash below to the one desired\n# 2) remove upstream/gnulib/, e.g. by running \n#    make maintainer-clean\n# 3) re-run ./bootstrap\n```\nin ./bootstrap's `install_iconv()`",
    "created_at": "2022-08-04T22:24:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554603",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:187" align="right">Comment 187</div>

Replying to [@mkoeppe](#comment%3A184):
> Replying to [@dimpase](#comment%3A183):
> > Replying to [@mkoeppe](#comment%3A182):
> > > Replying to [@dimpase](#comment%3A180):
> > > > My main concern always was to avoid copying a lagre chunk of gnulib verbatim into Sage git tree. 

> > > 
> > > You still haven't quite explained what exactly the nature of this concern is and why it weighs so heavy that it would warrant the complexity of a script that checks out 83 MB 
> > > from the Gnulib git repo?

> > 
> > The complexity of the 20-line script? Where is the compelexity there? 

> 
> Your script is not complete yet, see [comment:179](#comment%3A179)

As I wrote, I think it suffices to put something like

```
# to update macros coming from gnulib:
# 1) change the commit hash below to the one desired
# 2) remove upstream/gnulib/, e.g. by running 
#    make maintainer-clean
# 3) re-run ./bootstrap
```
in ./bootstrap's `install_iconv()`



---

archive/issue_comments_554604.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nThese would be instructions for who?",
    "created_at": "2022-08-04T22:25:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554604",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:8" align="right">Comment 8</div>

These would be instructions for who?



---

archive/issue_comments_554605.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nI am sorry to admit that there is still a chasm between you, and it seems that sage-devel voting is the only way to escape from this seemingly eternal debate...\n\nThe voting would be about: \n\nDima's approach: install Gnulib by pulling 83 MB from Gnulib git repo (Dima, please rewrite in line of length < 80)\n\nvs\n\nMatthias' approach: install Gnulib by copying 112 KB into sagelib source tree (Matthias, please rewrite in line of length < 80)\n\nDima writes cons of Matthias' approach in 3 lines of each length < 80\n\nMatthias writes cons of Dima's approach in 3 lines of each length < 80\n\nThen please Fran\u00e7ois post the voting to sage-devel. Okay?",
    "created_at": "2022-08-04T22:41:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554605",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:9" align="right">Comment 9</div>

I am sorry to admit that there is still a chasm between you, and it seems that sage-devel voting is the only way to escape from this seemingly eternal debate...

The voting would be about: 

Dima's approach: install Gnulib by pulling 83 MB from Gnulib git repo (Dima, please rewrite in line of length < 80)

vs

Matthias' approach: install Gnulib by copying 112 KB into sagelib source tree (Matthias, please rewrite in line of length < 80)

Dima writes cons of Matthias' approach in 3 lines of each length < 80

Matthias writes cons of Dima's approach in 3 lines of each length < 80

Then please François post the voting to sage-devel. Okay?



---

archive/issue_comments_554606.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nI am afraid it looks that way too. I will once we have the Matthias and Dima's position arguments.",
    "created_at": "2022-08-04T22:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554606",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:0" align="right">Comment 0</div>

I am afraid it looks that way too. I will once we have the Matthias and Dima's position arguments.



---

archive/issue_comments_554607.json:
```json
{
    "body": "<div id=\"comment:191\" align=\"right\">Comment 191</div>\n\nReplying to [@mkoeppe](#comment%3A188):\n> These would be instructions for who?\n\nfor whoever will be updating the version of gnulib we use, isn't it obvious?",
    "created_at": "2022-08-04T22:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554607",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:191" align="right">Comment 191</div>

Replying to [@mkoeppe](#comment%3A188):
> These would be instructions for who?

for whoever will be updating the version of gnulib we use, isn't it obvious?



---

archive/issue_comments_554608.json:
```json
{
    "body": "<div id=\"comment:192\" align=\"right\">Comment 192</div>\n\nReplying to [@dimpase](#comment%3A191):\n> Replying to [@mkoeppe](#comment%3A188):\n> > These would be instructions for who?\n\n> \n> for whoever will be updating the version of gnulib we use, isn't it obvious?\n\nYou've apparently missed my point in [comment:179](#comment%3A179)\n\nYes, step 1 of your instructions needs to be run by \"whoever will be updating the version of gnulib we use\", that is, the ticket author.\n\nBut step 2 has to be run by everyone who runs `./bootstrap` and switches to a branch that contains such an update ticket.",
    "created_at": "2022-08-04T23:00:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554608",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:192" align="right">Comment 192</div>

Replying to [@dimpase](#comment%3A191):
> Replying to [@mkoeppe](#comment%3A188):
> > These would be instructions for who?

> 
> for whoever will be updating the version of gnulib we use, isn't it obvious?

You've apparently missed my point in [comment:179](#comment%3A179)

Yes, step 1 of your instructions needs to be run by "whoever will be updating the version of gnulib we use", that is, the ticket author.

But step 2 has to be run by everyone who runs `./bootstrap` and switches to a branch that contains such an update ticket.



---

archive/issue_comments_554609.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,16 @@\n #29549 intended to remove the dependency of `bootstrap` on gettext. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800).\n \n-However, I forgot to add some files that `gnulib-tool` added, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n+However, some files that `gnulib-tool` added were left out from the commit, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n \n Here we complete the task and remove `gettext` from various `distros/` files etc.\n+\n+Two approaches have been proposed:\n+\n+mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n+- TBD\n+\n+dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n+- TBD\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n \n``````\n",
    "created_at": "2022-08-04T23:24:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554609",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,16 @@
 #29549 intended to remove the dependency of `bootstrap` on gettext. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800).
 
-However, I forgot to add some files that `gnulib-tool` added, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ
+However, some files that `gnulib-tool` added were left out from the commit, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ
 
 Here we complete the task and remove `gettext` from various `distros/` files etc.
+
+Two approaches have been proposed:
+
+mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
+- TBD
+
+dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
+- TBD
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
 
``````




---

archive/issue_comments_554610.json:
```json
{
    "body": "<div id=\"comment:194\" align=\"right\">Comment 194</div>\n\nReplying to [@mkoeppe](#comment%3A192):\n> Replying to [@dimpase](#comment%3A191):\n> > Replying to [@mkoeppe](#comment%3A188):\n> > > These would be instructions for who?\n\n> > \n> > for whoever will be updating the version of gnulib we use, isn't it obvious?\n\n> \n> You've apparently missed my point in [comment:179](#comment%3A179)\n> \n> Yes, step 1 of your instructions needs to be run by \"whoever will be updating the version of gnulib we use\", that is, the ticket author.\n> \n> But step 2 has to be run by everyone who runs `./bootstrap` and switches to a branch that contains such an update ticket.\n\nAh, right, sorry. So we need to check that the output of `git rev-parse HEAD` in upstream/gnulib repo equals the commit hash hardwired in ./bootstrap, and if not, fetch the latter commit from the repo.",
    "created_at": "2022-08-04T23:31:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554610",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:194" align="right">Comment 194</div>

Replying to [@mkoeppe](#comment%3A192):
> Replying to [@dimpase](#comment%3A191):
> > Replying to [@mkoeppe](#comment%3A188):
> > > These would be instructions for who?

> > 
> > for whoever will be updating the version of gnulib we use, isn't it obvious?

> 
> You've apparently missed my point in [comment:179](#comment%3A179)
> 
> Yes, step 1 of your instructions needs to be run by "whoever will be updating the version of gnulib we use", that is, the ticket author.
> 
> But step 2 has to be run by everyone who runs `./bootstrap` and switches to a branch that contains such an update ticket.

Ah, right, sorry. So we need to check that the output of `git rev-parse HEAD` in upstream/gnulib repo equals the commit hash hardwired in ./bootstrap, and if not, fetch the latter commit from the repo.



---

archive/issue_comments_554611.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,7 +7,12 @@\n Two approaches have been proposed:\n \n mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n-- TBD\n+- Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)\n+- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch\n+- This matches our practice with imported files [`m4/ax_*`](https://github.com/sagemath/sage/tree/develop/m4) from autoconf\n+- Burden on a developers who author an update ticket for these files: TBA\n+- Burden on users and other developers: None\n+\n \n dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n - TBD\n``````\n",
    "created_at": "2022-08-04T23:32:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554611",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,7 +7,12 @@
 Two approaches have been proposed:
 
 mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
-- TBD
+- Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)
+- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch
+- This matches our practice with imported files [`m4/ax_*`](https://github.com/sagemath/sage/tree/develop/m4) from autoconf
+- Burden on a developers who author an update ticket for these files: TBA
+- Burden on users and other developers: None
+
 
 dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
 - TBD
``````




---

archive/issue_comments_554612.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,9 +9,10 @@\n mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch\n-- This matches our practice with imported files [`m4/ax_*`](https://github.com/sagemath/sage/tree/develop/m4) from autoconf\n-- Burden on a developers who author an update ticket for these files: TBA\n-- Burden on users and other developers: None\n+- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html).\n+- Removes bootstrap's dependency on gettext, introduces no new dependency.\n+- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import` and commit the changes. \n+- Burden on users and other developers: None.\n \n \n dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n``````\n",
    "created_at": "2022-08-04T23:35:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554612",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,9 +9,10 @@
 mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch
-- This matches our practice with imported files [`m4/ax_*`](https://github.com/sagemath/sage/tree/develop/m4) from autoconf
-- Burden on a developers who author an update ticket for these files: TBA
-- Burden on users and other developers: None
+- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html).
+- Removes bootstrap's dependency on gettext, introduces no new dependency.
+- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import` and commit the changes. 
+- Burden on users and other developers: None.
 
 
 dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
``````




---

archive/issue_comments_554613.json:
```json
{
    "body": "<div id=\"comment:197\" align=\"right\">Comment 197</div>\n\nReplying to [@kwankyu](#comment%3A189):\n> Matthias' approach: install Gnulib by copying 112 KB into sagelib source tree (Matthias, please rewrite in line of length < 80)\n\nI've put a short description in the ticket box",
    "created_at": "2022-08-04T23:39:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554613",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:197" align="right">Comment 197</div>

Replying to [@kwankyu](#comment%3A189):
> Matthias' approach: install Gnulib by copying 112 KB into sagelib source tree (Matthias, please rewrite in line of length < 80)

I've put a short description in the ticket box



---

archive/issue_comments_554614.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch\n-- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html).\n+- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with other packages because these files are used to generate the `configure` script.\n - Removes bootstrap's dependency on gettext, introduces no new dependency.\n - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import` and commit the changes. \n - Burden on users and other developers: None.\n``````\n",
    "created_at": "2022-08-04T23:41:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554614",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch
-- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html).
+- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with other packages because these files are used to generate the `configure` script.
 - Removes bootstrap's dependency on gettext, introduces no new dependency.
 - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import` and commit the changes. 
 - Burden on users and other developers: None.
``````




---

archive/issue_comments_554615.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch\n-- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with other packages because these files are used to generate the `configure` script.\n+- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n - Removes bootstrap's dependency on gettext, introduces no new dependency.\n - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import` and commit the changes. \n - Burden on users and other developers: None.\n``````\n",
    "created_at": "2022-08-04T23:42:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554615",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch
-- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with other packages because these files are used to generate the `configure` script.
+- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
 - Removes bootstrap's dependency on gettext, introduces no new dependency.
 - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import` and commit the changes. 
 - Burden on users and other developers: None.
``````




---

archive/issue_comments_554616.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,7 +11,7 @@\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch\n - This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n - Removes bootstrap's dependency on gettext, introduces no new dependency.\n-- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import` and commit the changes. \n+- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.\n - Burden on users and other developers: None.\n \n \n``````\n",
    "created_at": "2022-08-04T23:43:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554616",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,7 +11,7 @@
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch
 - This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
 - Removes bootstrap's dependency on gettext, introduces no new dependency.
-- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import` and commit the changes. 
+- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.
 - Burden on users and other developers: None.
 
 
``````




---

archive/issue_comments_554617.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,7 +16,8 @@\n \n \n dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n-- TBD\n+- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.\n+- Details TBD\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n \n``````\n",
    "created_at": "2022-08-04T23:47:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554617",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,7 +16,8 @@
 
 
 dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
-- TBD
+- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.
+- Details TBD
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
 
``````




---

archive/issue_comments_554618.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,7 +17,8 @@\n \n dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.\n-- Details TBD\n+- Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB\n+- More details TBD\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n \n``````\n",
    "created_at": "2022-08-04T23:49:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554618",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,7 +17,8 @@
 
 dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.
-- Details TBD
+- Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB
+- More details TBD
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
 
``````




---

archive/issue_comments_554619.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,6 +18,7 @@\n dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.\n - Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB\n+- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change, and test it.\n - More details TBD\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n``````\n",
    "created_at": "2022-08-04T23:52:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554619",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,6 +18,7 @@
 dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.
 - Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB
+- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change, and test it.
 - More details TBD
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
``````




---

archive/issue_comments_554620.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e\">fd82fb9</a></td><td><code>check that installed gnulib is up to date</code></td></tr></table>\n",
    "created_at": "2022-08-04T23:53:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554620",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4" align="right">Comment 4</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e">fd82fb9</a></td><td><code>check that installed gnulib is up to date</code></td></tr></table>




---

archive/issue_comments_554621.json:
```json
{
    "body": "Changed commit from **[38916cd](https://github.com/sagemath/sagetrac-mirror/commit/38916cd93b64344ceecaf77681153410746099cd)** to **[fd82fb9](https://github.com/sagemath/sagetrac-mirror/commit/fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e)**",
    "created_at": "2022-08-04T23:53:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554621",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[38916cd](https://github.com/sagemath/sagetrac-mirror/commit/38916cd93b64344ceecaf77681153410746099cd)** to **[fd82fb9](https://github.com/sagemath/sagetrac-mirror/commit/fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e)**



---

archive/issue_comments_554622.json:
```json
{
    "body": "<div id=\"comment:205\" align=\"right\">Comment 205</div>\n\nReplying to [@sagetrac-git](#comment%3A204):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e\">fd82fb9</a></td><td><code>check that installed gnulib is up to date</code></td></tr></table>\n\nthis is the change as explained in [comment:194](#comment%3A194) - needs testing (I tend to get srting comparison in scripts wrong :-))",
    "created_at": "2022-08-04T23:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554622",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:205" align="right">Comment 205</div>

Replying to [@sagetrac-git](#comment%3A204):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e">fd82fb9</a></td><td><code>check that installed gnulib is up to date</code></td></tr></table>

this is the change as explained in [comment:194](#comment%3A194) - needs testing (I tend to get srting comparison in scripts wrong :-))



---

archive/issue_comments_554623.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,7 +13,7 @@\n - Removes bootstrap's dependency on gettext, introduces no new dependency.\n - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.\n - Burden on users and other developers: None.\n-\n+- dimpase's criticism of this approach: \"This is not Sage's code, it has no place in Sage git tree.\"\n \n dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.\n``````\n",
    "created_at": "2022-08-05T00:33:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554623",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,7 +13,7 @@
 - Removes bootstrap's dependency on gettext, introduces no new dependency.
 - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.
 - Burden on users and other developers: None.
-
+- dimpase's criticism of this approach: "This is not Sage's code, it has no place in Sage git tree."
 
 dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.
``````




---

archive/issue_comments_554624.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,9 +7,9 @@\n Two approaches have been proposed:\n \n mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n-- Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)\n-- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch\n-- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n+- Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n+- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n+- Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n - Removes bootstrap's dependency on gettext, introduces no new dependency.\n - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.\n - Burden on users and other developers: None.\n@@ -17,7 +17,7 @@\n \n dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.\n-- Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB\n+- Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB.\n - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change, and test it.\n - More details TBD\n \n``````\n",
    "created_at": "2022-08-05T00:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554624",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,9 +7,9 @@
 Two approaches have been proposed:
 
 mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
-- Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html)
-- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch
-- This matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
+- Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
+- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
+- Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
 - Removes bootstrap's dependency on gettext, introduces no new dependency.
 - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.
 - Burden on users and other developers: None.
@@ -17,7 +17,7 @@
 
 dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.
-- Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB
+- Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB.
 - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change, and test it.
 - More details TBD
 
``````




---

archive/issue_comments_554625.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nOk is the material in the description what you want for going to a vote? Last call before I prepare the post.",
    "created_at": "2022-08-05T00:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554625",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:8" align="right">Comment 8</div>

Ok is the material in the description what you want for going to a vote? Last call before I prepare the post.



---

archive/issue_comments_554626.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nI think Dima should have a chance to edit the description and finish his branch",
    "created_at": "2022-08-05T00:37:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554626",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">Comment 9</div>

I think Dima should have a chance to edit the description and finish his branch



---

archive/issue_comments_554627.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n \n mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n-- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n+- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n - Removes bootstrap's dependency on gettext, introduces no new dependency.\n - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.\n@@ -19,7 +19,7 @@\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.\n - Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB.\n - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change, and test it.\n-- More details TBD\n+- mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone in the `upstream/` directory increases complexity for no benefit.\"\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n \n``````\n",
    "created_at": "2022-08-05T00:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554627",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 
 mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
-- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
+- 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
 - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
 - Removes bootstrap's dependency on gettext, introduces no new dependency.
 - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.
@@ -19,7 +19,7 @@
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.
 - Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB.
 - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change, and test it.
-- More details TBD
+- mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone in the `upstream/` directory increases complexity for no benefit."
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
 
``````




---

archive/issue_comments_554628.json:
```json
{
    "body": "<div id=\"comment:211\" align=\"right\">Comment 211</div>\n\nReplying to [@mkoeppe](#comment%3A209):\n> I think Dima should have a chance to edit the description and finish his branch\n\nFair enough, a few hours will not make much difference at this point.",
    "created_at": "2022-08-05T00:49:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554628",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:211" align="right">Comment 211</div>

Replying to [@mkoeppe](#comment%3A209):
> I think Dima should have a chance to edit the description and finish his branch

Fair enough, a few hours will not make much difference at this point.



---

archive/issue_comments_554629.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,25 +1,36 @@\n-#29549 intended to remove the dependency of `bootstrap` on gettext. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800).\n+**Background**: `./bootstrap` needs about 112K of m4 and shell code from `gnulib`: https://www.gnu.org/software/gnulib\n+Before #29549, these files were copied from a system-wide installation of `gettext` (which uses `gnulib`): https://www.gnu.org/software/gettext\n \n-However, some files that `gnulib-tool` added were left out from the commit, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n+As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).\n \n+---\n+\n+**History**: #29549 intended to remove the dependency of `bootstrap` on `gettext`. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800). \n+\n+The branch of #29549 followed \"copy files\" approach. However, some files that `gnulib-tool` added were left out from the commit, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ\n+\n+---\n+\n+**This ticket**: \n Here we complete the task and remove `gettext` from various `distros/` files etc.\n \n Two approaches have been proposed:\n \n-mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n+mkoeppe (\"copy files\") : https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n-- Removes bootstrap's dependency on gettext, introduces no new dependency.\n-- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.\n+- introduces no new dependency.\n+- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes.\n - Burden on users and other developers: None.\n-- dimpase's criticism of this approach: \"This is not Sage's code, it has no place in Sage git tree.\"\n+- dimpase's criticism of this approach: \"gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating gnulib used is tricky and error-prone by design\". \n \n-dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n-- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.\n-- Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB.\n-- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change, and test it.\n-- mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone in the `upstream/` directory increases complexity for no benefit.\"\n+dimpase (\"Sage pseudo-package\"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n+- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250M).\n+- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) \"new\" (although one can't really do Sage developent without `git` installed) dependency on `git`  and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83MB (fair to say that internet is needed for Sage development a lot, anyway).\n+- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).\n+- Burden on other users: a preudo-package needs to be installed once (and updated, automatically)\n+- mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit.\"\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n \n``````\n",
    "created_at": "2022-08-05T09:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554629",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,25 +1,36 @@
-#29549 intended to remove the dependency of `bootstrap` on gettext. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800).
+**Background**: `./bootstrap` needs about 112K of m4 and shell code from `gnulib`: https://www.gnu.org/software/gnulib
+Before #29549, these files were copied from a system-wide installation of `gettext` (which uses `gnulib`): https://www.gnu.org/software/gettext
 
-However, some files that `gnulib-tool` added were left out from the commit, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ
+As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).
 
+---
+
+**History**: #29549 intended to remove the dependency of `bootstrap` on `gettext`. #29549 made it possible to run `bootstrap` on the `manylinux` platforms needed by cibuildwheel (#33800). 
+
+The branch of #29549 followed "copy files" approach. However, some files that `gnulib-tool` added were left out from the commit, so it breaks on machines on which `gettext` is missing completely, as reported in https://groups.google.com/g/sage-release/c/FezzF5Q7Wt4/m/xyxVTaYgBAAJ
+
+---
+
+**This ticket**: 
 Here we complete the task and remove `gettext` from various `distros/` files etc.
 
 Two approaches have been proposed:
 
-mkoeppe: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
+mkoeppe ("copy files") : https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
 - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
-- Removes bootstrap's dependency on gettext, introduces no new dependency.
-- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, commit the changes, and test it.
+- introduces no new dependency.
+- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes.
 - Burden on users and other developers: None.
-- dimpase's criticism of this approach: "This is not Sage's code, it has no place in Sage git tree."
+- dimpase's criticism of this approach: "gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating gnulib used is tricky and error-prone by design". 
 
-dimpase: https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
-- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script.
-- Removes bootstrap's dependency on gettext; introduces a new dependency on `git` and on availability of a broadband internet connection at the first run of `./bootstrap` in a tree, to pull 83MB.
-- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change, and test it.
-- mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone in the `upstream/` directory increases complexity for no benefit."
+dimpase ("Sage pseudo-package"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
+- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250M).
+- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) "new" (although one can't really do Sage developent without `git` installed) dependency on `git`  and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83MB (fair to say that internet is needed for Sage development a lot, anyway).
+- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).
+- Burden on other users: a preudo-package needs to be installed once (and updated, automatically)
+- mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit."
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
 
``````




---

archive/issue_comments_554630.json:
```json
{
    "body": "Changed commit from **[fd82fb9](https://github.com/sagemath/sagetrac-mirror/commit/fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e)** to **[ea41741](https://github.com/sagemath/sagetrac-mirror/commit/ea41741b178f9d9ffd5392ced06c650413868f4e)**",
    "created_at": "2022-08-05T09:49:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554630",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fd82fb9](https://github.com/sagemath/sagetrac-mirror/commit/fd82fb9ea530fab6f9b9b4d2e77a8d0e1c4f565e)** to **[ea41741](https://github.com/sagemath/sagetrac-mirror/commit/ea41741b178f9d9ffd5392ced06c650413868f4e)**



---

archive/issue_comments_554631.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ea41741b178f9d9ffd5392ced06c650413868f4e\">ea41741</a></td><td><code>check that installed gnulib is up to date</code></td></tr></table>\n",
    "created_at": "2022-08-05T09:49:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554631",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3" align="right">Comment 3</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ea41741b178f9d9ffd5392ced06c650413868f4e">ea41741</a></td><td><code>check that installed gnulib is up to date</code></td></tr></table>




---

archive/issue_comments_554632.json:
```json
{
    "body": "Changed author from **Matthias Koeppe** to **Matthias Koeppe, Dima Pasechnik**",
    "created_at": "2022-08-05T09:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554632",
    "user": "https://github.com/dimpase"
}
```

Changed author from **Matthias Koeppe** to **Matthias Koeppe, Dima Pasechnik**



---

archive/issue_comments_554633.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nOK, fixed the branch, and expanded ticket description.",
    "created_at": "2022-08-05T09:51:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554633",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">Comment 4</div>

OK, fixed the branch, and expanded ticket description.



---

archive/issue_comments_554634.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -27,7 +27,7 @@\n \n dimpase (\"Sage pseudo-package\"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250M).\n-- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) \"new\" (although one can't really do Sage developent without `git` installed) dependency on `git`  and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83MB (fair to say that internet is needed for Sage development a lot, anyway).\n+- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) \"new\" (although one can't really do Sage development without `git` installed) dependency on `git`  and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83MB (fair to say that internet is needed for Sage development a lot, anyway).\n - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).\n - Burden on other users: a preudo-package needs to be installed once (and updated, automatically)\n - mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit.\"\n``````\n",
    "created_at": "2022-08-05T10:00:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554634",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -27,7 +27,7 @@
 
 dimpase ("Sage pseudo-package"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250M).
-- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) "new" (although one can't really do Sage developent without `git` installed) dependency on `git`  and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83MB (fair to say that internet is needed for Sage development a lot, anyway).
+- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) "new" (although one can't really do Sage development without `git` installed) dependency on `git`  and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83MB (fair to say that internet is needed for Sage development a lot, anyway).
 - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).
 - Burden on other users: a preudo-package needs to be installed once (and updated, automatically)
 - mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit."
``````




---

archive/issue_comments_554635.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nMatthias's branch link doesn't work.",
    "created_at": "2022-08-05T10:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554635",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:6" align="right">Comment 6</div>

Matthias's branch link doesn't work.



---

archive/issue_comments_554636.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nIt seems that `__` at the end of the branch name disappears.",
    "created_at": "2022-08-05T10:14:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554636",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:7" align="right">Comment 7</div>

It seems that `__` at the end of the branch name disappears.



---

archive/issue_comments_554637.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,7 +16,7 @@\n \n Two approaches have been proposed:\n \n-mkoeppe (\"copy files\") : https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n+mkoeppe (\"copy files\") : `https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__`\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n``````\n",
    "created_at": "2022-08-05T10:14:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554637",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,7 +16,7 @@
 
 Two approaches have been proposed:
 
-mkoeppe ("copy files") : https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
+mkoeppe ("copy files") : `https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__`
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
 - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
``````




---

archive/issue_comments_554638.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,7 +16,7 @@\n \n Two approaches have been proposed:\n \n-mkoeppe (\"copy files\") : `https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__`\n+mkoeppe (\"copy files\") : https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n``````\n",
    "created_at": "2022-08-05T10:16:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554638",
    "user": "https://github.com/kwankyu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,7 +16,7 @@
 
 Two approaches have been proposed:
 
-mkoeppe ("copy files") : `https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__`
+mkoeppe ("copy files") : https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
 - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
``````




---

archive/issue_comments_554639.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nIn Dima's branch: the sentence below seems broken. Omit `and`?\n\n```bash\necho >&2 \"gnulib-tool needs to be installed and in your PATH. We install a copy in upstream/ \"\n```",
    "created_at": "2022-08-05T10:38:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554639",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:9" align="right">Comment 9</div>

In Dima's branch: the sentence below seems broken. Omit `and`?

```bash
echo >&2 "gnulib-tool needs to be installed and in your PATH. We install a copy in upstream/ "
```



---

archive/issue_comments_554640.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nIn Dima' branch:\n\nI think it is better to place gnulib at its own directory `gnulib` instead of `upstream/gnulib`, since gnulib is not an ordinary package. It looks odd to me to find the gnulib directory in `upstream` among all those tar files.",
    "created_at": "2022-08-05T11:21:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554640",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:0" align="right">Comment 0</div>

In Dima' branch:

I think it is better to place gnulib at its own directory `gnulib` instead of `upstream/gnulib`, since gnulib is not an ordinary package. It looks odd to me to find the gnulib directory in `upstream` among all those tar files.



---

archive/issue_comments_554641.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-**Background**: `./bootstrap` needs about 112K of m4 and shell code from `gnulib`: https://www.gnu.org/software/gnulib\n+**Background**: `./bootstrap` needs about 112 KB of m4 and shell code from `gnulib`: https://www.gnu.org/software/gnulib\n Before #29549, these files were copied from a system-wide installation of `gettext` (which uses `gnulib`): https://www.gnu.org/software/gettext\n \n As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).\n@@ -23,11 +23,11 @@\n - introduces no new dependency.\n - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes.\n - Burden on users and other developers: None.\n-- dimpase's criticism of this approach: \"gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating gnulib used is tricky and error-prone by design\". \n+- dimpase's criticism of this approach: \"gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating the imported gnulib files is tricky and error-prone by design\". \n \n dimpase (\"Sage pseudo-package\"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n-- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250M).\n-- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) \"new\" (although one can't really do Sage development without `git` installed) dependency on `git`  and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83MB (fair to say that internet is needed for Sage development a lot, anyway).\n+- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).\n+- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) \"new\" (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).\n - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).\n - Burden on other users: a preudo-package needs to be installed once (and updated, automatically)\n - mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit.\"\n``````\n",
    "created_at": "2022-08-05T17:15:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554641",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-**Background**: `./bootstrap` needs about 112K of m4 and shell code from `gnulib`: https://www.gnu.org/software/gnulib
+**Background**: `./bootstrap` needs about 112 KB of m4 and shell code from `gnulib`: https://www.gnu.org/software/gnulib
 Before #29549, these files were copied from a system-wide installation of `gettext` (which uses `gnulib`): https://www.gnu.org/software/gettext
 
 As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).
@@ -23,11 +23,11 @@
 - introduces no new dependency.
 - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes.
 - Burden on users and other developers: None.
-- dimpase's criticism of this approach: "gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating gnulib used is tricky and error-prone by design". 
+- dimpase's criticism of this approach: "gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating the imported gnulib files is tricky and error-prone by design". 
 
 dimpase ("Sage pseudo-package"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
-- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250M).
-- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) "new" (although one can't really do Sage development without `git` installed) dependency on `git`  and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83MB (fair to say that internet is needed for Sage development a lot, anyway).
+- Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).
+- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) "new" (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).
 - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).
 - Burden on other users: a preudo-package needs to be installed once (and updated, automatically)
 - mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit."
``````




---

archive/issue_comments_554642.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,7 +16,7 @@\n \n Two approaches have been proposed:\n \n-mkoeppe (\"copy files\") : https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__\n+mkoeppe (\"copy files\") : [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n``````\n",
    "created_at": "2022-08-05T17:18:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554642",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,7 +16,7 @@
 
 Two approaches have been proposed:
 
-mkoeppe ("copy files") : https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__
+mkoeppe ("copy files") : [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
 - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
``````




---

archive/issue_comments_554643.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -29,7 +29,7 @@\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).\n - introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) \"new\" (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).\n - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).\n-- Burden on other users: a preudo-package needs to be installed once (and updated, automatically)\n+- Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)\n - mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit.\"\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n``````\n",
    "created_at": "2022-08-05T17:21:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554643",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -29,7 +29,7 @@
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).
 - introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) "new" (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).
 - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).
-- Burden on other users: a preudo-package needs to be installed once (and updated, automatically)
+- Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)
 - mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit."
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
``````




---

archive/issue_comments_554644.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nI'm going to add a paragraph to the \"Background\" that explains in what situations `./bootstrap` must be run.",
    "created_at": "2022-08-05T17:22:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554644",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">Comment 4</div>

I'm going to add a paragraph to the "Background" that explains in what situations `./bootstrap` must be run.



---

archive/issue_comments_554645.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -30,7 +30,7 @@\n - introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) \"new\" (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).\n - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).\n - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)\n-- mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit.\"\n+- mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit.\"\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n \n``````\n",
    "created_at": "2022-08-05T17:32:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554645",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -30,7 +30,7 @@
 - introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) "new" (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).
 - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).
 - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)
-- mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install) in the `upstream/` directory increases complexity for no benefit."
+- mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit."
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
 
``````




---

archive/issue_comments_554646.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,14 @@\n Before #29549, these files were copied from a system-wide installation of `gettext` (which uses `gnulib`): https://www.gnu.org/software/gettext\n \n As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).\n+\n+Who needs to run `bootstrap`:\n+- Any developer who switches to a branch that makes an SPKG upgrade or other changes to the build system\n+- Our  [portability testsuite](https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker), run locally using `tox -e docker-...` and on GH Actions\n+\n+Who does not need to run `bootstrap`:\n+- Users who only build released versions from tarballs - because they come pre-bootstrapped\n+- Users who only build released versions from a git clone - because `./bootstrap` falls back to downloading a pre-bootstrapped tarball of the `configure` SPKG. \n \n ---\n \n@@ -27,7 +35,7 @@\n \n dimpase (\"Sage pseudo-package\"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).\n-- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) \"new\" (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).\n+- introduces a new (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).\n - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).\n - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)\n - mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit.\"\n``````\n",
    "created_at": "2022-08-05T18:20:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554646",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,14 @@
 Before #29549, these files were copied from a system-wide installation of `gettext` (which uses `gnulib`): https://www.gnu.org/software/gettext
 
 As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).
+
+Who needs to run `bootstrap`:
+- Any developer who switches to a branch that makes an SPKG upgrade or other changes to the build system
+- Our  [portability testsuite](https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker), run locally using `tox -e docker-...` and on GH Actions
+
+Who does not need to run `bootstrap`:
+- Users who only build released versions from tarballs - because they come pre-bootstrapped
+- Users who only build released versions from a git clone - because `./bootstrap` falls back to downloading a pre-bootstrapped tarball of the `configure` SPKG. 
 
 ---
 
@@ -27,7 +35,7 @@
 
 dimpase ("Sage pseudo-package"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).
-- introduces a (conditional - only needed if you cannot use already prepared `configure` spkg) "new" (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).
+- introduces a new (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).
 - Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).
 - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)
 - mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit."
``````




---

archive/issue_comments_554647.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,7 +9,7 @@\n \n Who does not need to run `bootstrap`:\n - Users who only build released versions from tarballs - because they come pre-bootstrapped\n-- Users who only build released versions from a git clone - because `./bootstrap` falls back to downloading a pre-bootstrapped tarball of the `configure` SPKG. \n+- Users who only build released versions from a git clone - because `./bootstrap` falls back to downloading a tarball of the `configure` SPKG.\n \n ---\n \n``````\n",
    "created_at": "2022-08-05T18:25:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554647",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,7 +9,7 @@
 
 Who does not need to run `bootstrap`:
 - Users who only build released versions from tarballs - because they come pre-bootstrapped
-- Users who only build released versions from a git clone - because `./bootstrap` falls back to downloading a pre-bootstrapped tarball of the `configure` SPKG. 
+- Users who only build released versions from a git clone - because `./bootstrap` falls back to downloading a tarball of the `configure` SPKG.
 
 ---
 
``````




---

archive/issue_comments_554648.json:
```json
{
    "body": "<div id=\"comment:228\" align=\"right\">Comment 228</div>\n\nReplying to [@kwankyu](#comment%3A220):\n> In Dima' branch:\n> \n> I think it is better to place gnulib at its own directory `gnulib` instead of `upstream/gnulib`, since gnulib is not an ordinary package. It looks odd to me to find the gnulib directory in `upstream` among all those tar files.\n\ngnulib is an upstream package which does not provide tarballs. So instead of a tarball one has a directory under git control.",
    "created_at": "2022-08-05T19:47:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554648",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:228" align="right">Comment 228</div>

Replying to [@kwankyu](#comment%3A220):
> In Dima' branch:
> 
> I think it is better to place gnulib at its own directory `gnulib` instead of `upstream/gnulib`, since gnulib is not an ordinary package. It looks odd to me to find the gnulib directory in `upstream` among all those tar files.

gnulib is an upstream package which does not provide tarballs. So instead of a tarball one has a directory under git control.



---

archive/issue_comments_554649.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,13 +3,13 @@\n \n As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).\n \n-Who needs to run `bootstrap`:\n-- Any developer who switches to a branch that makes an SPKG upgrade or other changes to the build system\n-- Our  [portability testsuite](https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker), run locally using `tox -e docker-...` and on GH Actions\n+Who needs to run `bootstrap` and where:\n+- Any developer who switches to a branch that makes an SPKG upgrade or other changes to the build system, on their development machine.\n+- Our  [portability testsuite](https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker), run locally using `tox -e docker-...` and on GH Actions, in the Docker container for the tested platform.\n \n Who does not need to run `bootstrap`:\n - Users who only build released versions from tarballs - because they come pre-bootstrapped\n-- Users who only build released versions from a git clone - because `./bootstrap` falls back to downloading a tarball of the `configure` SPKG.\n+- Users who only build released versions from a git clone - because Sage falls back to downloading a tarball of the `configure` SPKG.\n \n ---\n \n``````\n",
    "created_at": "2022-08-05T20:27:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554649",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,13 +3,13 @@
 
 As opposed to `gettext`, `gnulib` does not make releases, and many systems don't package `gnulib` at all. Thus one cannot uniformly rely on `gnulib` being already installed. This essentially leaves two options for using `gnulib` in Sage - copy said 112K into the Sage git tree, or  provide `gnulib` as a Sage pseudo-package (pseudo, due to the chicken vs egg issue: one cannot just make it an ordinary spkg - it needs to be  used by `bootstrap`).
 
-Who needs to run `bootstrap`:
-- Any developer who switches to a branch that makes an SPKG upgrade or other changes to the build system
-- Our  [portability testsuite](https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker), run locally using `tox -e docker-...` and on GH Actions
+Who needs to run `bootstrap` and where:
+- Any developer who switches to a branch that makes an SPKG upgrade or other changes to the build system, on their development machine.
+- Our  [portability testsuite](https://doc.sagemath.org/html/en/developer/portability_testing.html#testing-sage-on-a-different-platform-using-docker), run locally using `tox -e docker-...` and on GH Actions, in the Docker container for the tested platform.
 
 Who does not need to run `bootstrap`:
 - Users who only build released versions from tarballs - because they come pre-bootstrapped
-- Users who only build released versions from a git clone - because `./bootstrap` falls back to downloading a tarball of the `configure` SPKG.
+- Users who only build released versions from a git clone - because Sage falls back to downloading a tarball of the `configure` SPKG.
 
 ---
 
``````




---

archive/issue_comments_554650.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nLet's see if we can reach consensus on the question how often the files / the commit hash will have to be updated. Previously in this thread: \n- dimpase in [comment:25](#comment%3A25) \"likely to cause trouble if not updated on time... maintenance is problematic\"\n- klee in [comment:126](#comment%3A126) \"I guess that practically gnulib in sage would need to be updated very rarely.\"\nHistorical information on the relevant files of gnulib can be obtained by using `git log build-aux/config.rpath m4/lib-* m4/iconv.m4 m4/host-cpu-c-abi.m4` in a clone of Gnulib. I think the last change relevant for any of our supported platforms is from 2017.",
    "created_at": "2022-08-05T20:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554650",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">Comment 0</div>

Let's see if we can reach consensus on the question how often the files / the commit hash will have to be updated. Previously in this thread: 
- dimpase in [comment:25](#comment%3A25) "likely to cause trouble if not updated on time... maintenance is problematic"
- klee in [comment:126](#comment%3A126) "I guess that practically gnulib in sage would need to be updated very rarely."
Historical information on the relevant files of gnulib can be obtained by using `git log build-aux/config.rpath m4/lib-* m4/iconv.m4 m4/host-cpu-c-abi.m4` in a clone of Gnulib. I think the last change relevant for any of our supported platforms is from 2017.



---

archive/issue_comments_554651.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nBy \"problematic\" I meant it's easy to make an error in your fully manual approach. And it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.\n\n\nMy proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc). I don't get why there is such a pushback against it.",
    "created_at": "2022-08-05T21:27:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554651",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">Comment 1</div>

By "problematic" I meant it's easy to make an error in your fully manual approach. And it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.


My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc). I don't get why there is such a pushback against it.



---

archive/issue_comments_554652.json:
```json
{
    "body": "<div id=\"comment:232\" align=\"right\">Comment 232</div>\n\nReplying to [@dimpase](#comment%3A231):\n > My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). \n\nI meant that by \"not ordinary package\".\n\n> By \"problematic\" I meant it's easy to make an error in your fully manual approach. And it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.\n\nIf Matthias' approach is adopted after voting, your script could be used as an automatic way to update gnulib in sage.",
    "created_at": "2022-08-05T21:49:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554652",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:232" align="right">Comment 232</div>

Replying to [@dimpase](#comment%3A231):
 > My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). 

I meant that by "not ordinary package".

> By "problematic" I meant it's easy to make an error in your fully manual approach. And it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.

If Matthias' approach is adopted after voting, your script could be used as an automatic way to update gnulib in sage.



---

archive/issue_comments_554653.json:
```json
{
    "body": "<div id=\"comment:233\" align=\"right\">Comment 233</div>\n\nReplying to [@dimpase](#comment%3A231):\n> it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.\n\nNo, we already test it automatically on GH Actions in all `-minimal` builds.",
    "created_at": "2022-08-05T21:52:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554653",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:233" align="right">Comment 233</div>

Replying to [@dimpase](#comment%3A231):
> it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.

No, we already test it automatically on GH Actions in all `-minimal` builds.



---

archive/issue_comments_554654.json:
```json
{
    "body": "<div id=\"comment:234\" align=\"right\">Comment 234</div>\n\nReplying to [@mkoeppe](#comment%3A233):\n> Replying to [@dimpase](#comment%3A231):\n> > it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.\n\n> \n> No, we already test it automatically on GH Actions in all `-minimal` builds.\n\nyes, this is an artificial isolated environment, and a very fragile one (-minimal builds time out often). We don't have easy means to \ndo this locally.",
    "created_at": "2022-08-05T22:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554654",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:234" align="right">Comment 234</div>

Replying to [@mkoeppe](#comment%3A233):
> Replying to [@dimpase](#comment%3A231):
> > it's hard to test, as one needs to uninstall gettext, something that might be hard on some OSs, or create an artificial isolated environment/VM.

> 
> No, we already test it automatically on GH Actions in all `-minimal` builds.

yes, this is an artificial isolated environment, and a very fragile one (-minimal builds time out often). We don't have easy means to 
do this locally.



---

archive/issue_comments_554655.json:
```json
{
    "body": "<div id=\"comment:235\" align=\"right\">Comment 235</div>\n\nThis can be run locally, and I know that you know this. It's `tox -e docker-ubuntu-jammy-minimal -- config.status` or `tox -e local-homebrew-macos-minimal -- config.status`.",
    "created_at": "2022-08-05T22:13:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554655",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:235" align="right">Comment 235</div>

This can be run locally, and I know that you know this. It's `tox -e docker-ubuntu-jammy-minimal -- config.status` or `tox -e local-homebrew-macos-minimal -- config.status`.



---

archive/issue_comments_554656.json:
```json
{
    "body": "<div id=\"comment:236\" align=\"right\">Comment 236</div>\n\nReplying to [@dimpase](#comment%3A231):\n> My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc).\n\nThat's not a very useful comparison. Our SciPy SPKG builds a 20 MB wheel from a 38 MB source tarball.\n\n```\n$ ls -l upstream/scipy-1.8.1.tar.gz\n-rw-r--r--  1 mkoeppe  staff  38196215 May 20 09:47 upstream/scipy-1.8.1.tar.gz\n$ ls -l venv/var/lib/sage/wheels/SciPy-1.8.1-cp310-cp310-macosx_12_0_x86_64.whl\n-rw-r--r--  1 mkoeppe  staff  20700328 Aug  3 00:44 venv/var/lib/sage/wheels/SciPy-1.8.1-cp310-cp310-macosx_12_0_x86_64.whl\n```",
    "created_at": "2022-08-05T22:30:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554656",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:236" align="right">Comment 236</div>

Replying to [@dimpase](#comment%3A231):
> My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc).

That's not a very useful comparison. Our SciPy SPKG builds a 20 MB wheel from a 38 MB source tarball.

```
$ ls -l upstream/scipy-1.8.1.tar.gz
-rw-r--r--  1 mkoeppe  staff  38196215 May 20 09:47 upstream/scipy-1.8.1.tar.gz
$ ls -l venv/var/lib/sage/wheels/SciPy-1.8.1-cp310-cp310-macosx_12_0_x86_64.whl
-rw-r--r--  1 mkoeppe  staff  20700328 Aug  3 00:44 venv/var/lib/sage/wheels/SciPy-1.8.1-cp310-cp310-macosx_12_0_x86_64.whl
```



---

archive/issue_comments_554657.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -29,7 +29,7 @@\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n - introduces no new dependency.\n-- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes.\n+- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes. (Updates are expected to be necessary only very rarely.)\n - Burden on users and other developers: None.\n - dimpase's criticism of this approach: \"gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating the imported gnulib files is tricky and error-prone by design\". \n \n``````\n",
    "created_at": "2022-08-05T22:46:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554657",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -29,7 +29,7 @@
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
 - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
 - introduces no new dependency.
-- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes.
+- Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes. (Updates are expected to be necessary only very rarely.)
 - Burden on users and other developers: None.
 - dimpase's criticism of this approach: "gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating the imported gnulib files is tricky and error-prone by design". 
 
``````




---

archive/issue_comments_554658.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nI've added \"Updates are expected to be necessary only very rarely.\" to the ticket description. At least this does not seem to be disputed.",
    "created_at": "2022-08-05T22:46:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554658",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">Comment 7</div>

I've added "Updates are expected to be necessary only very rarely." to the ticket description. At least this does not seem to be disputed.



---

archive/issue_comments_554659.json:
```json
{
    "body": "<div id=\"comment:238\" align=\"right\">Comment 238</div>\n\nReplying to [@kwankyu](#comment%3A232):\n> If Matthias' approach is adopted after voting, [dimpase's] script could be used as an automatic way to update gnulib in sage.\n\nIndeed, as an `spkg-src` script of sorts.",
    "created_at": "2022-08-05T23:16:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554659",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:238" align="right">Comment 238</div>

Replying to [@kwankyu](#comment%3A232):
> If Matthias' approach is adopted after voting, [dimpase's] script could be used as an automatic way to update gnulib in sage.

Indeed, as an `spkg-src` script of sorts.



---

archive/issue_comments_554660.json:
```json
{
    "body": "<div id=\"comment:239\" align=\"right\">Comment 239</div>\n\nReplying to [@dimpase](#comment%3A234):\n> > No, we already test it automatically on GH Actions in all `-minimal` builds.\n\n> \n> yes, this is an artificial isolated environment, and a very fragile one (-minimal builds time out often). We don't have easy means to \n> do this locally.\n\nThose who are interested in helping improve our testing infrastructure may want to take a look at #34228, #33062, #31505, #34270, #34255, which are waiting for review.",
    "created_at": "2022-08-05T23:24:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554660",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:239" align="right">Comment 239</div>

Replying to [@dimpase](#comment%3A234):
> > No, we already test it automatically on GH Actions in all `-minimal` builds.

> 
> yes, this is an artificial isolated environment, and a very fragile one (-minimal builds time out often). We don't have easy means to 
> do this locally.

Those who are interested in helping improve our testing infrastructure may want to take a look at #34228, #33062, #31505, #34270, #34255, which are waiting for review.



---

archive/issue_comments_554661.json:
```json
{
    "body": "<div id=\"comment:240\" align=\"right\">Comment 240</div>\n\nReplying to [@mkoeppe](#comment%3A235):\n> This can be run locally, and I know that you know this. It's `tox -e docker-ubuntu-jammy-minimal -- config.status` or `tox -e local-homebrew-macos-minimal -- config.status`.\n\n\nI don't have Docker at work - our sysadmins don't allow it.",
    "created_at": "2022-08-06T08:10:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554661",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:240" align="right">Comment 240</div>

Replying to [@mkoeppe](#comment%3A235):
> This can be run locally, and I know that you know this. It's `tox -e docker-ubuntu-jammy-minimal -- config.status` or `tox -e local-homebrew-macos-minimal -- config.status`.


I don't have Docker at work - our sysadmins don't allow it.



---

archive/issue_comments_554662.json:
```json
{
    "body": "<div id=\"comment:241\" align=\"right\">Comment 241</div>\n\nReplying to [@mkoeppe](#comment%3A236):\n> Replying to [@dimpase](#comment%3A231):\n> > My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc).\n\n> \n> That's not a very useful comparison. Our SciPy SPKG builds a 20 MB wheel from a 38 MB source tarball.\n\nOK, compare with GAP - almost 0.5G tarball, basic install is is few Mb",
    "created_at": "2022-08-06T08:16:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554662",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:241" align="right">Comment 241</div>

Replying to [@mkoeppe](#comment%3A236):
> Replying to [@dimpase](#comment%3A231):
> > My proposal is essentially to add a semi-standard package to Sage (and use it in bootstrap). We have many rarely updated packages, and many packages with tarballs of size tens of Mb (matplotlib, Pillow, SciPy, GAP, giac, etc).

> 
> That's not a very useful comparison. Our SciPy SPKG builds a 20 MB wheel from a 38 MB source tarball.

OK, compare with GAP - almost 0.5G tarball, basic install is is few Mb



---

archive/issue_comments_554663.json:
```json
{
    "body": "<div id=\"comment:242\" align=\"right\">Comment 242</div>\n\nReplying to [@dimpase](#comment%3A173):\n> Replying to [@dimpase](#comment%3A170):\n> > I can add removal of upstream/gnulib to bootstrap-clean target\n\n> this is actually not a good idea, as it will force git clone on every run on bootstrap.\n> \n> On the other hand, `maintainer-clean` target removes `upstream/` all together.\n\nBy the way, in your branch, `make bootstrap-clean` would need to remove the files that `gnulib-tool import` adds.",
    "created_at": "2022-08-06T13:37:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554663",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:242" align="right">Comment 242</div>

Replying to [@dimpase](#comment%3A173):
> Replying to [@dimpase](#comment%3A170):
> > I can add removal of upstream/gnulib to bootstrap-clean target

> this is actually not a good idea, as it will force git clone on every run on bootstrap.
> 
> On the other hand, `maintainer-clean` target removes `upstream/` all together.

By the way, in your branch, `make bootstrap-clean` would need to remove the files that `gnulib-tool import` adds.



---

archive/issue_comments_554664.json:
```json
{
    "body": "<div id=\"comment:243\" align=\"right\">Comment 243</div>\n\nReplying to [@dimpase](#comment%3A241):\n> OK, compare with GAP - almost 0.5G tarball, basic install is is few Mb\n\n\n```\n$ du -sh local/share/gap\ndu: local/share/gap: No such file or directory\n$ make gap\n[...]\n$ du -sh local/share/gap\n720M\tlocal/share/gap\n```",
    "created_at": "2022-08-06T13:50:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554664",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:243" align="right">Comment 243</div>

Replying to [@dimpase](#comment%3A241):
> OK, compare with GAP - almost 0.5G tarball, basic install is is few Mb


```
$ du -sh local/share/gap
du: local/share/gap: No such file or directory
$ make gap
[...]
$ du -sh local/share/gap
720M	local/share/gap
```



---

archive/issue_comments_554665.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,15 +28,15 @@\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n-- introduces no new dependency.\n+- Introduces no new dependency.\n - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes. (Updates are expected to be necessary only very rarely.)\n - Burden on users and other developers: None.\n - dimpase's criticism of this approach: \"gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating the imported gnulib files is tricky and error-prone by design\". \n \n dimpase (\"Sage pseudo-package\"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib\n - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).\n-- introduces a new (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).\n-- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).\n+- Introduces a new (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).\n+- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, verify that the list of files removed by `make bootstrap-clean` is still correct, commit this change \n - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)\n - mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit.\"\n \n``````\n",
    "created_at": "2022-08-06T13:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554665",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,15 +28,15 @@
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
 - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
-- introduces no new dependency.
+- Introduces no new dependency.
 - Burden on a developer who authors an update ticket for these files: Obtain gnulib by cloning the repo, then re-run `gnulib-tool import`, remove unneeded files (that's where #29549 went wrong), commit the changes. (Updates are expected to be necessary only very rarely.)
 - Burden on users and other developers: None.
 - dimpase's criticism of this approach: "gnulib's code is not Sage's code, it has no place in Sage git tree; this way, updating the imported gnulib files is tricky and error-prone by design". 
 
 dimpase ("Sage pseudo-package"): https://github.com/sagemath/sagetrac-mirror/compare/develop...u/dimpase/config/gnulib
 - Follows approach 2(C) of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html), but instead of using Gnulib's [Programs for developing in Git checkouts](https://www.gnu.org/software/gnulib/manual/html_node/Developer-tools.html), implements its own script (making checkout much faster, as full `gnulib` checkout is 250 MB).
-- introduces a new (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).
-- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, commit this change (very similar to a regular package upgrade).
+- Introduces a new (although one can't really do Sage development without `git` installed) dependency on `git` and on availability of internet connection at the first run of `./bootstrap` in a tree, to pull 83 MB (fair to say that internet is needed for Sage development a lot, anyway).
+- Burden on a developer who authors an update ticket for these files: Edit the `bootstrap` file to change the commit hash, verify that the list of files removed by `make bootstrap-clean` is still correct, commit this change 
 - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)
 - mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit."
 
``````




---

archive/issue_comments_554666.json:
```json
{
    "body": "<div id=\"comment:245\" align=\"right\">Comment 245</div>\n\nReplying to [@kwankyu](#comment%3A219):\n> In Dima's branch: the sentence below seems broken. Omit `and`?\n> \n> ```bash\n> echo >&2 \"gnulib-tool needs to be installed and in your PATH. We install a copy in upstream/ \"\n> ```\n\nI read the sentence wrong. But still this part \"`and in your PATH`\" seems to cause a confusion on the user(developer) if she is not expected to use the `gnulib-tool` directly.",
    "created_at": "2022-08-06T14:48:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554666",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:245" align="right">Comment 245</div>

Replying to [@kwankyu](#comment%3A219):
> In Dima's branch: the sentence below seems broken. Omit `and`?
> 
> ```bash
> echo >&2 "gnulib-tool needs to be installed and in your PATH. We install a copy in upstream/ "
> ```

I read the sentence wrong. But still this part "`and in your PATH`" seems to cause a confusion on the user(developer) if she is not expected to use the `gnulib-tool` directly.



---

archive/issue_comments_554667.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nDeveloping a comment of mine before, I suggest another candidate for the voting,\n\nhybrid: mkoeppe's and dimpase's branches may be combined. Dima's script is modified to a tool for updating the gnulib files, and kept in, perhaps,  `build/pkgs/gnulib/spkg-src`\n\nMatthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.\n\nI am aware that Dima' main concern is to merge external source files into our source tree, but there already exists `m4/` directory filed with such files.\n\nI leave it to Fran\u00e7ois to decide whether to take the hybrid candidate or not for the voting. I do not insist.",
    "created_at": "2022-08-07T01:56:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554667",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:6" align="right">Comment 6</div>

Developing a comment of mine before, I suggest another candidate for the voting,

hybrid: mkoeppe's and dimpase's branches may be combined. Dima's script is modified to a tool for updating the gnulib files, and kept in, perhaps,  `build/pkgs/gnulib/spkg-src`

Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.

I am aware that Dima' main concern is to merge external source files into our source tree, but there already exists `m4/` directory filed with such files.

I leave it to François to decide whether to take the hybrid candidate or not for the voting. I do not insist.



---

archive/issue_comments_554668.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nIf an hybrid both side could live with exists then I do not think we need a vote. The vote would only be to decide between two things that are incompatible.",
    "created_at": "2022-08-07T02:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554668",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:7" align="right">Comment 7</div>

If an hybrid both side could live with exists then I do not think we need a vote. The vote would only be to decide between two things that are incompatible.



---

archive/issue_comments_554669.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nyet another option is to require external gnulib.\n\nI don't recall how easy is to check the version by calling gnulib-tool (afk now).\n\nAssuming the version rarely changes, why not?",
    "created_at": "2022-08-07T13:18:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554669",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">Comment 8</div>

yet another option is to require external gnulib.

I don't recall how easy is to check the version by calling gnulib-tool (afk now).

Assuming the version rarely changes, why not?



---

archive/issue_comments_554670.json:
```json
{
    "body": "<div id=\"comment:249\" align=\"right\">Comment 249</div>\n\nReplying to [@dimpase](#comment%3A248):\n> yet another option is to require external gnulib.\n\nIn the nomenclature of [comment:130](#comment%3A130), that's Dima 3 as a standalone. We have discussed it at length already.",
    "created_at": "2022-08-09T19:10:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554670",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:249" align="right">Comment 249</div>

Replying to [@dimpase](#comment%3A248):
> yet another option is to require external gnulib.

In the nomenclature of [comment:130](#comment%3A130), that's Dima 3 as a standalone. We have discussed it at length already.



---

archive/issue_comments_554671.json:
```json
{
    "body": "<div id=\"comment:250\" align=\"right\">Comment 250</div>\n\nReplying to [@kiwifb](#comment%3A247):\n> If an hybrid both side could live with exists then I do not think we need a vote. The vote would only be to decide between two things that are incompatible.\n\nIt sounds like it's time for a vote",
    "created_at": "2022-08-12T22:20:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554671",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:250" align="right">Comment 250</div>

Replying to [@kiwifb](#comment%3A247):
> If an hybrid both side could live with exists then I do not think we need a vote. The vote would only be to decide between two things that are incompatible.

It sounds like it's time for a vote



---

archive/issue_comments_554672.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nI'm without a fast internet and mostly in vacation mode in the coming week.",
    "created_at": "2022-08-14T20:24:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554672",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">Comment 1</div>

I'm without a fast internet and mostly in vacation mode in the coming week.



---

archive/issue_comments_554673.json:
```json
{
    "body": "<div id=\"comment:252\" align=\"right\">Comment 252</div>\n\nReplying to [@dimpase](#comment%3A251):\n> I'm without a fast internet\n\nSorry, hard to resist: This means you can't test your branch, right?",
    "created_at": "2022-08-14T20:44:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554673",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:252" align="right">Comment 252</div>

Replying to [@dimpase](#comment%3A251):
> I'm without a fast internet

Sorry, hard to resist: This means you can't test your branch, right?



---

archive/issue_comments_554674.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nsurely, installing Sage using a mobile phone connection is a multilevel challenge...",
    "created_at": "2022-08-14T20:57:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554674",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">Comment 3</div>

surely, installing Sage using a mobile phone connection is a multilevel challenge...



---

archive/issue_comments_554675.json:
```json
{
    "body": "Changed branch from **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)** to **[u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/config/gnulib)**",
    "created_at": "2022-08-22T21:46:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554675",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/dimpase/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/config/gnulib)** to **[u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/config/gnulib)**



---

archive/issue_comments_554676.json:
```json
{
    "body": "<div id=\"comment:255\" align=\"right\">Comment 255</div>\n\nReplying to [@kwankyu](#comment%3A246):\n> Developing a comment of mine before, I suggest another candidate for the voting,\n> \n> hybrid: mkoeppe's and dimpase's branches may be combined. Dima's script is modified to a tool for updating the gnulib files, and kept in, perhaps,  `build/pkgs/gnulib/spkg-src`\n> \n> Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.\n\nI've prepared the hybrid version as outlined above.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f53bed1a6f9b699bf58519f0681f9ee5bcb36ea6\">f53bed1</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16b3c5aad1d87e219bd3f86979787ada5b1e9688\">16b3c5a</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44e2ed80ff4f13e329cc3cc80df376182ec21c84\">44e2ed8</a></td><td><code>build/pkgs/gnulib: New</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2d8f1b7d62311ed42d5186373c0462d95020286c\">2d8f1b7</a></td><td><code>build/pkgs/gnulib/spkg-src: New, adapted from bootstrap in branch u/dimpase/config/gnulib</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce70f3dc814a061021af4ca598e99dcede2c1a80\">ce70f3d</a></td><td><code>build/pkgs/gnulib/spkg-src: Update package-version.txt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5\">8bf9d97</a></td><td><code>build/pkgs/gnulib: Update to version of 2022-07-31</code></td></tr></table>\n",
    "created_at": "2022-08-22T21:47:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554676",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:255" align="right">Comment 255</div>

Replying to [@kwankyu](#comment%3A246):
> Developing a comment of mine before, I suggest another candidate for the voting,
> 
> hybrid: mkoeppe's and dimpase's branches may be combined. Dima's script is modified to a tool for updating the gnulib files, and kept in, perhaps,  `build/pkgs/gnulib/spkg-src`
> 
> Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.

I've prepared the hybrid version as outlined above.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f53bed1a6f9b699bf58519f0681f9ee5bcb36ea6">f53bed1</a></td><td><code>m4/: Add missing dependencies of iconv.m4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16b3c5aad1d87e219bd3f86979787ada5b1e9688">16b3c5a</a></td><td><code>.homebrew-build-env, build/pkgs/{_prereq,_bootstrap}/distros: Remove gettext</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44e2ed80ff4f13e329cc3cc80df376182ec21c84">44e2ed8</a></td><td><code>build/pkgs/gnulib: New</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2d8f1b7d62311ed42d5186373c0462d95020286c">2d8f1b7</a></td><td><code>build/pkgs/gnulib/spkg-src: New, adapted from bootstrap in branch u/dimpase/config/gnulib</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce70f3dc814a061021af4ca598e99dcede2c1a80">ce70f3d</a></td><td><code>build/pkgs/gnulib/spkg-src: Update package-version.txt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5">8bf9d97</a></td><td><code>build/pkgs/gnulib: Update to version of 2022-07-31</code></td></tr></table>




---

archive/issue_comments_554677.json:
```json
{
    "body": "Changed commit from **[ea41741](https://github.com/sagemath/sagetrac-mirror/commit/ea41741b178f9d9ffd5392ced06c650413868f4e)** to **[8bf9d97](https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5)**",
    "created_at": "2022-08-22T21:47:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554677",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[ea41741](https://github.com/sagemath/sagetrac-mirror/commit/ea41741b178f9d9ffd5392ced06c650413868f4e)** to **[8bf9d97](https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5)**



---

archive/issue_comments_554678.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,7 +24,7 @@\n \n Two approaches have been proposed:\n \n-mkoeppe (\"copy files\") : [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)\n+mkoeppe (\"copy files\") : [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__ @ 4011cc4608](https://github.com/sagemath/sagetrac-mirror/compare/develop...4011cc4608)\n - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).\n - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.\n - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.\n@@ -40,6 +40,10 @@\n - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)\n - mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit.\"\n \n-To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`\n+hybrid (\"copy files, spkg-src script for maintenance\"): [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)\n+- Resolves the criticism on the \"copy files\" approach: \"updating the imported gnulib files\" is now assisted by the `spkg-src` script\n+- Resolves the criticism on the \"Sage pseudo-package\" approach: \"operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)\" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.\n+\n+To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status` \n \n \n``````\n",
    "created_at": "2022-08-22T22:03:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554678",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,7 +24,7 @@
 
 Two approaches have been proposed:
 
-mkoeppe ("copy files") : [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)
+mkoeppe ("copy files") : [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__ @ 4011cc4608](https://github.com/sagemath/sagetrac-mirror/compare/develop...4011cc4608)
 - Follows approach 3 of the [Gnulib manual section 'Integration with Version Control Systems'](https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html).
 - 5 files, in `config/` and `m4/`, total 112 KB, have been imported by using [`gnulib-tool import iconv`](https://www.gnu.org/software/gnulib/manual/html_node/Initial-import.html) and committed to the branch.
 - Matches our practice with imported files [`m4/ax_*.m4`](https://github.com/sagemath/sage/tree/develop/m4) from [autoconf-archive](https://www.gnu.org/software/autoconf-archive/The-Macros.html). Different from our practice with SPKGs because the files are needed to generate the `configure` script.
@@ -40,6 +40,10 @@
 - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)
 - mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit."
 
-To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status`
+hybrid ("copy files, spkg-src script for maintenance"): [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)
+- Resolves the criticism on the "copy files" approach: "updating the imported gnulib files" is now assisted by the `spkg-src` script
+- Resolves the criticism on the "Sage pseudo-package" approach: "operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.
+
+To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status` 
 
 
``````




---

archive/issue_comments_554679.json:
```json
{
    "body": "<div id=\"comment:258\" align=\"right\">Comment 258</div>\n\nReplying to [@kiwifb](#comment%3A159):\n\n> You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do. I am giving you 24 hours from this post to reach an agreement. After that I throw the whole thing on sage-devel for a vote.\n\nPlease Fran\u00e7ois, could you put up the vote?",
    "created_at": "2022-08-23T00:05:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554679",
    "user": "https://github.com/GMS103"
}
```

<div id="comment:258" align="right">Comment 258</div>

Replying to [@kiwifb](#comment%3A159):

> You have been at it for at least 3 weeks. I don't see a breakthrough without a third party being involved. I think a vote is the most equitable thing to do. I am giving you 24 hours from this post to reach an agreement. After that I throw the whole thing on sage-devel for a vote.

Please François, could you put up the vote?



---

archive/issue_comments_554680.json:
```json
{
    "body": "<div id=\"comment:259\" align=\"right\">Comment 259</div>\n\nI think people have been waiting for Dima to react to this:\n\nReplying to [@kwankyu](#comment%3A246):\n> Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.",
    "created_at": "2022-08-23T00:10:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554680",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:259" align="right">Comment 259</div>

I think people have been waiting for Dima to react to this:

Replying to [@kwankyu](#comment%3A246):
> Matthias seems to have agreed to this (comment:238). If Dima agrees too, then we don't need to go for the voting.



---

archive/issue_comments_554681.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nI have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation because of stuff happening all over the place right now (I mean locally not globally, although that's also demoralizing).",
    "created_at": "2022-08-23T01:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554681",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:0" align="right">Comment 0</div>

I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation because of stuff happening all over the place right now (I mean locally not globally, although that's also demoralizing).



---

archive/issue_comments_554682.json:
```json
{
    "body": "<div id=\"comment:261\" align=\"right\">Comment 261</div>\n\nReplying to [@kiwifb](#comment%3A260):\n> I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation ...\n\nI am giving you 24 hours from this post to put up the vote. After that, I will take the role and put up the vote.\n\nDima seems to just want the voting.",
    "created_at": "2022-08-23T07:58:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554682",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:261" align="right">Comment 261</div>

Replying to [@kiwifb](#comment%3A260):
> I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation ...

I am giving you 24 hours from this post to put up the vote. After that, I will take the role and put up the vote.

Dima seems to just want the voting.



---

archive/issue_comments_554683.json:
```json
{
    "body": "<div id=\"comment:262\" align=\"right\">Comment 262</div>\n\nReplying to [@kwankyu](#comment%3A261):\n> Replying to [@kiwifb](#comment%3A260):\n> > I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation ...\n\n> \n> I am giving you 24 hours from this post to put up the vote. After that, I will take the role and put up the vote.\n> \n> Dima seems to just want the voting.\n> \n\nThen don't wait :) I am quite happy for you to take the role of convenor. I just fixed my daughter bed frame and I had enough for the day.",
    "created_at": "2022-08-23T08:18:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554683",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:262" align="right">Comment 262</div>

Replying to [@kwankyu](#comment%3A261):
> Replying to [@kiwifb](#comment%3A260):
> > I have been quite busy since it is not a holidays period in the southern hemisphere. There is the point Matthias just made and my current lack of motivation ...

> 
> I am giving you 24 hours from this post to put up the vote. After that, I will take the role and put up the vote.
> 
> Dima seems to just want the voting.
> 

Then don't wait :) I am quite happy for you to take the role of convenor. I just fixed my daughter bed frame and I had enough for the day.



---

archive/issue_comments_554684.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nthe current branch still puts over 100K of gnulib's code into Sage git tree.\nAnd this is the main point I don't approve of.",
    "created_at": "2022-08-23T09:20:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554684",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">Comment 3</div>

the current branch still puts over 100K of gnulib's code into Sage git tree.
And this is the main point I don't approve of.



---

archive/issue_comments_554685.json:
```json
{
    "body": "<div id=\"comment:264\" align=\"right\">Comment 264</div>\n\nReplying to [@kiwifb](#comment%3A262):\n> Then don't wait :) I am quite happy for you to take the role of convener. \n\nI need that time for me :) to prepare myself for the thing that people would vote about. You are still the better person for this job.",
    "created_at": "2022-08-23T10:48:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554685",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:264" align="right">Comment 264</div>

Replying to [@kiwifb](#comment%3A262):
> Then don't wait :) I am quite happy for you to take the role of convener. 

I need that time for me :) to prepare myself for the thing that people would vote about. You are still the better person for this job.



---

archive/issue_comments_554686.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nThe branches linked in `hybrid` and `mkoeppe` are the same.",
    "created_at": "2022-08-23T13:02:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554686",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:5" align="right">Comment 5</div>

The branches linked in `hybrid` and `mkoeppe` are the same.



---

archive/issue_comments_554687.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -40,7 +40,7 @@\n - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)\n - mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit.\"\n \n-hybrid (\"copy files, spkg-src script for maintenance\"): [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)\n+hybrid (\"copy files, spkg-src script for maintenance\"): [Branch u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/config/gnulib)\n - Resolves the criticism on the \"copy files\" approach: \"updating the imported gnulib files\" is now assisted by the `spkg-src` script\n - Resolves the criticism on the \"Sage pseudo-package\" approach: \"operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)\" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.\n \n``````\n",
    "created_at": "2022-08-23T13:17:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554687",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -40,7 +40,7 @@
 - Burden on other users: a pseudo-package needs to be installed once (and updated, automatically)
 - mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit."
 
-hybrid ("copy files, spkg-src script for maintenance"): [Branch u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/fix_broken_bootstrap__ac_lib_rpath_etc__)
+hybrid ("copy files, spkg-src script for maintenance"): [Branch u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/config/gnulib)
 - Resolves the criticism on the "copy files" approach: "updating the imported gnulib files" is now assisted by the `spkg-src` script
 - Resolves the criticism on the "Sage pseudo-package" approach: "operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.
 
``````




---

archive/issue_comments_554688.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nSorry, I've fixed the link in the description now",
    "created_at": "2022-08-23T13:18:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554688",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">Comment 7</div>

Sorry, I've fixed the link in the description now



---

archive/issue_comments_554689.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -41,7 +41,7 @@\n - mkoeppe's criticism of this approach: \"Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit.\"\n \n hybrid (\"copy files, spkg-src script for maintenance\"): [Branch u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/config/gnulib)\n-- Resolves the criticism on the \"copy files\" approach: \"updating the imported gnulib files\" is now assisted by the `spkg-src` script\n+- Resolves the criticism on the \"copy files\" approach: \"updating the imported gnulib files\" is now assisted by the `spkg-src` script (adapted from dimpase's branch)\n - Resolves the criticism on the \"Sage pseudo-package\" approach: \"operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)\" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.\n \n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status` \n``````\n",
    "created_at": "2022-08-23T13:23:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554689",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -41,7 +41,7 @@
 - mkoeppe's criticism of this approach: "Having `bootstrap` operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash) in the `upstream/` directory increases complexity for no benefit."
 
 hybrid ("copy files, spkg-src script for maintenance"): [Branch u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/config/gnulib)
-- Resolves the criticism on the "copy files" approach: "updating the imported gnulib files" is now assisted by the `spkg-src` script
+- Resolves the criticism on the "copy files" approach: "updating the imported gnulib files" is now assisted by the `spkg-src` script (adapted from dimpase's branch)
 - Resolves the criticism on the "Sage pseudo-package" approach: "operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.
 
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status` 
``````




---

archive/issue_comments_554690.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nOK, so if I understand the problem correctly:\n- we need 5 files in \"m4\" from \"gnulib\":\n\n``` \nm4/host-cpu-c-abi.m4\t\nm4/iconv.m4\nm4/lib-ld.m4\nm4/lib-link.m4\nm4/lib-prefix.m4\n```\n- the only officially supported way to get these is by a git pull\n- there are objections to having git as a prereq for bootstrapping a sagemath build\n\nThe \"hybrid\" solution:\n- checks the relevant files into the sagemath repo\n- includes a tool to pull from git and update those checked-in files\n\nThat means the \"hybrid\" solution is very robust once the files are successfully checked in: no dependency on anything outside of sagemath!\n\nUgly bit: we now have files in the sagemath repo that should definitely not be edited! There's another process to update them. It seems to me the ideal solution would be if there is a tarball somewhere that we CAN use to get those files from. We could do that, right? we could host a tiny repo inside sagemath that manages the tool to make the tarball by pulling from the gnulib repo and then host that tarball in our \"mirror\" infrastructure. Would the \"spkg\" download-and-resolve infrastructure already be available pre-bootstrap? or is in reasonable to special-case the download?\n\nIt looks to me like the pain of maintaining a tarball that can be referenced should be weighed against the impurity of having files under our git control that don't really belong there. But that could be processed as an improvement over \"hybrid\" which eminently looks like a maintainable solution.",
    "created_at": "2022-08-24T03:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554690",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:9" align="right">Comment 9</div>

OK, so if I understand the problem correctly:
- we need 5 files in "m4" from "gnulib":

``` 
m4/host-cpu-c-abi.m4	
m4/iconv.m4
m4/lib-ld.m4
m4/lib-link.m4
m4/lib-prefix.m4
```
- the only officially supported way to get these is by a git pull
- there are objections to having git as a prereq for bootstrapping a sagemath build

The "hybrid" solution:
- checks the relevant files into the sagemath repo
- includes a tool to pull from git and update those checked-in files

That means the "hybrid" solution is very robust once the files are successfully checked in: no dependency on anything outside of sagemath!

Ugly bit: we now have files in the sagemath repo that should definitely not be edited! There's another process to update them. It seems to me the ideal solution would be if there is a tarball somewhere that we CAN use to get those files from. We could do that, right? we could host a tiny repo inside sagemath that manages the tool to make the tarball by pulling from the gnulib repo and then host that tarball in our "mirror" infrastructure. Would the "spkg" download-and-resolve infrastructure already be available pre-bootstrap? or is in reasonable to special-case the download?

It looks to me like the pain of maintaining a tarball that can be referenced should be weighed against the impurity of having files under our git control that don't really belong there. But that could be processed as an improvement over "hybrid" which eminently looks like a maintainable solution.



---

archive/issue_comments_554691.json:
```json
{
    "body": "<div id=\"comment:270\" align=\"right\">Comment 270</div>\n\nReplying to [@nbruin](#comment%3A269):\n> OK, so if I understand the problem correctly:\n> - we need 5 files in \"m4\" from \"gnulib\":\n> \n> ``` \n> m4/host-cpu-c-abi.m4\t\n> m4/iconv.m4\n> m4/lib-ld.m4\n> m4/lib-link.m4\n> m4/lib-prefix.m4\n> ```\n> - the only officially supported way to get these is by a git pull\n> - there are objections to having git as a prereq for bootstrapping a sagemath build\n\n(... and triggering an 80MB pull to get 100kB of files...)\n\n> The \"hybrid\" solution:\n> - checks the relevant files into the sagemath repo\n> - includes a tool to pull from git and update those checked-in files\n> \n> That means the \"hybrid\" solution is very robust once the files are successfully checked in: no dependency on anything outside of sagemath!\n\nThat's right.\n\n> Ugly bit: we now have files in the sagemath repo that should definitely not be edited! \n\nYes. It shares this property with other files in our `m4/` directory, from autoconf-archive - see discussion in [comment:103](#comment%3A103) and following. It's just a \"fact of life\" - bootstrapping has to start somewhere.",
    "created_at": "2022-08-24T03:49:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554691",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:270" align="right">Comment 270</div>

Replying to [@nbruin](#comment%3A269):
> OK, so if I understand the problem correctly:
> - we need 5 files in "m4" from "gnulib":
> 
> ``` 
> m4/host-cpu-c-abi.m4	
> m4/iconv.m4
> m4/lib-ld.m4
> m4/lib-link.m4
> m4/lib-prefix.m4
> ```
> - the only officially supported way to get these is by a git pull
> - there are objections to having git as a prereq for bootstrapping a sagemath build

(... and triggering an 80MB pull to get 100kB of files...)

> The "hybrid" solution:
> - checks the relevant files into the sagemath repo
> - includes a tool to pull from git and update those checked-in files
> 
> That means the "hybrid" solution is very robust once the files are successfully checked in: no dependency on anything outside of sagemath!

That's right.

> Ugly bit: we now have files in the sagemath repo that should definitely not be edited! 

Yes. It shares this property with other files in our `m4/` directory, from autoconf-archive - see discussion in [comment:103](#comment%3A103) and following. It's just a "fact of life" - bootstrapping has to start somewhere.



---

archive/issue_comments_554692.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nSince Nils proposed to create a tarball for `gnulib` and host it somewhere, as an alternative to using git to\nclone `gnulib`, I've done it here:\nhttps://github.com/dimpase/gnulib/releases/tag/1.1beta\n\nAs you see, an `xz -9`-comperessed tarball is under 4.5Mb, instead of 80Mb via `git clone` - note that git normally uses compression (zlib) on the fly, meaning that in fact the amount of data transferred by `git clone` is perhaps only 1/10th of 80 Mb.\n\nThis places gnulib tarball size among rather average Sage spkgs.",
    "created_at": "2022-08-24T08:50:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554692",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">Comment 1</div>

Since Nils proposed to create a tarball for `gnulib` and host it somewhere, as an alternative to using git to
clone `gnulib`, I've done it here:
https://github.com/dimpase/gnulib/releases/tag/1.1beta

As you see, an `xz -9`-comperessed tarball is under 4.5Mb, instead of 80Mb via `git clone` - note that git normally uses compression (zlib) on the fly, meaning that in fact the amount of data transferred by `git clone` is perhaps only 1/10th of 80 Mb.

This places gnulib tarball size among rather average Sage spkgs.



---

archive/issue_comments_554693.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nAccording to the merged branch of #29549, we seem to only need `config/config.rpath` `m4/iconv.m4` from `gnulib`. Am i understanding correctly ?",
    "created_at": "2022-08-24T09:05:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554693",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:2" align="right">Comment 2</div>

According to the merged branch of #29549, we seem to only need `config/config.rpath` `m4/iconv.m4` from `gnulib`. Am i understanding correctly ?



---

archive/issue_comments_554694.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nOr, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?",
    "created_at": "2022-08-24T09:18:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554694",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:3" align="right">Comment 3</div>

Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?



---

archive/issue_comments_554695.json:
```json
{
    "body": "<div id=\"comment:274\" align=\"right\">Comment 274</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A273):\n> Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?\n\nyes, they are needed, too. Note that this ticket actually fixes a bug created in #29549 - the thing is that these files (perhaps, different versions) are also available as a part of gettext development on the system, so if you had the latter installed, you won't need this, more or less.\n\nAll together we need something like 112Kb from gnulib.",
    "created_at": "2022-08-24T09:25:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554695",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:274" align="right">Comment 274</div>

Replying to [@sagetrac-tmonteil](#comment%3A273):
> Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?

yes, they are needed, too. Note that this ticket actually fixes a bug created in #29549 - the thing is that these files (perhaps, different versions) are also available as a part of gettext development on the system, so if you had the latter installed, you won't need this, more or less.

All together we need something like 112Kb from gnulib.



---

archive/issue_comments_554696.json:
```json
{
    "body": "<div id=\"comment:275\" align=\"right\">Comment 275</div>\n\nReplying to [@dimpase](#comment%3A274):\n> Replying to [@sagetrac-tmonteil](#comment%3A273):\n> > Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?\n\n> yes, they are needed, too. Note that this ticket actually fixes a big - the thing is that these files (perhaps, different versions) are also available as a part of gettext development on the system, so if you had the latter installed, you won't need this, more or less.\n> \n> All together we need something like 112Kb from gnulib.\n\nOK, thanks. What is wrong with shipping only those files within a `gnulib_cropped` (or `gnulib_iconv`) spkg as we do with boost or did with mathjax 2 ?",
    "created_at": "2022-08-24T09:46:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554696",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:275" align="right">Comment 275</div>

Replying to [@dimpase](#comment%3A274):
> Replying to [@sagetrac-tmonteil](#comment%3A273):
> > Or, are `m4/host-cpu-c-abi.m4`, `m4/lib-ld.m4`, `m4/lib-link.m4` and `m4/lib-prefix.m4` required as well ?

> yes, they are needed, too. Note that this ticket actually fixes a big - the thing is that these files (perhaps, different versions) are also available as a part of gettext development on the system, so if you had the latter installed, you won't need this, more or less.
> 
> All together we need something like 112Kb from gnulib.

OK, thanks. What is wrong with shipping only those files within a `gnulib_cropped` (or `gnulib_iconv`) spkg as we do with boost or did with mathjax 2 ?



---

archive/issue_comments_554697.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nnothing much - except it cannot be an ordinary spkg, due to chicken vs egg issue.",
    "created_at": "2022-08-24T09:53:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554697",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">Comment 6</div>

nothing much - except it cannot be an ordinary spkg, due to chicken vs egg issue.



---

archive/issue_comments_554698.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -44,6 +44,14 @@\n - Resolves the criticism on the \"copy files\" approach: \"updating the imported gnulib files\" is now assisted by the `spkg-src` script (adapted from dimpase's branch)\n - Resolves the criticism on the \"Sage pseudo-package\" approach: \"operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)\" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.\n \n+---\n+\n+**Voting is taking place at https://groups.google.com/g/sage-devel/c/E2qstbWXC7g**\n+\n+\n+\n+---\n+\n To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status` \n \n \n``````\n",
    "created_at": "2022-08-24T15:28:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554698",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -44,6 +44,14 @@
 - Resolves the criticism on the "copy files" approach: "updating the imported gnulib files" is now assisted by the `spkg-src` script (adapted from dimpase's branch)
 - Resolves the criticism on the "Sage pseudo-package" approach: "operate a multi-megabyte git clone (on the 1st install and when there's a change of the gnulib commit hash)" is only done by authors of tickets that update gnulib, not by general users of `bootstrap`.
 
+---
+
+**Voting is taking place at https://groups.google.com/g/sage-devel/c/E2qstbWXC7g**
+
+
+
+---
+
 To test: For example `tox -r -e local-homebrew-macos-minimal -- config.status` 
 
 
``````




---

archive/issue_comments_554699.json:
```json
{
    "body": "<div id=\"comment:278\" align=\"right\">Comment 278</div>\n\nReplying to [@dimpase](#comment%3A271):\n> Since Nils proposed to create a tarball for `gnulib` and host it somewhere, as an alternative to using git to\n> clone `gnulib`, I've done it here:\n> https://github.com/dimpase/gnulib/releases/tag/1.1beta\n> \n> As you see, an `xz -9`-compressed tarball is under 4.5Mb, instead of 80Mb via `git clone` - note that git normally uses compression (zlib) on the fly, meaning that in fact the amount of data transferred by `git clone` is perhaps only 1/10th of 80 Mb.\n> \n> This places gnulib tarball size among rather average Sage spkgs.\n\nSince we're doing numbers again (after [comment:231](#comment%3A231), [comment:236](#comment%3A236), [comment:241](#comment%3A241), [comment:243](#comment%3A243)), let me just point out that the ratio 80 MB : 112KB after said compression changes to 4.5Mb : 22kB\n\n```\n$ tar cfz gl.tgz  config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4\n$ ls -l gl.tgz\n-rw-r--r--  1 mkoeppe  staff  22688 Aug 24 09:21 gl.tgz\n```\n... and is thus still in the \"ludicrous\" range.",
    "created_at": "2022-08-24T16:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554699",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:278" align="right">Comment 278</div>

Replying to [@dimpase](#comment%3A271):
> Since Nils proposed to create a tarball for `gnulib` and host it somewhere, as an alternative to using git to
> clone `gnulib`, I've done it here:
> https://github.com/dimpase/gnulib/releases/tag/1.1beta
> 
> As you see, an `xz -9`-compressed tarball is under 4.5Mb, instead of 80Mb via `git clone` - note that git normally uses compression (zlib) on the fly, meaning that in fact the amount of data transferred by `git clone` is perhaps only 1/10th of 80 Mb.
> 
> This places gnulib tarball size among rather average Sage spkgs.

Since we're doing numbers again (after [comment:231](#comment%3A231), [comment:236](#comment%3A236), [comment:241](#comment%3A241), [comment:243](#comment%3A243)), let me just point out that the ratio 80 MB : 112KB after said compression changes to 4.5Mb : 22kB

```
$ tar cfz gl.tgz  config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4
$ ls -l gl.tgz
-rw-r--r--  1 mkoeppe  staff  22688 Aug 24 09:21 gl.tgz
```
... and is thus still in the "ludicrous" range.



---

archive/issue_comments_554700.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nIt sounds like a `gnulib_cropped` package would strike a nice balance if hosting the files under sagemath git control is too impure. But it sounds like it's a bit of a one-off (because the normal spkg tools are not available yet when it's needed) and perhaps not worth the effort for what we get from it.\n\nI'll have a go at a \"conceptual\" design, having the benefit of not having the technical knowledge to delve into details (a good design can be understood on a conceptual level, but I won't claim there exists a reasonable converse):\n\nPerhaps there are other files/artifacts that we need but don't really want to \"git\" control ourselves, and are needed before our normal spkg infrastructure (which is normally responsible for this) is available?\nI saw `autoconf-archive` mentioned before? So would this be more worthwhile if we'd have a `bootstrap-aux.spkg` that has all this crap in it?\n\nThe tools for *building* that `spkg` could just be the normal tools: in the building process, it would clone `gnulib` and extract the required files and similarly fetch `autoconf-archive` and extract (and patch?) what it needs, and then wrap that up in something that would look like a normal `spkg`.\n\nHowever, this package would normally not be *installed* through the normal means -- instead, when bootstrap needs it, it would locate an appropriate `spkg` file (or download it) and then extract what's necessary from it by virtue of it being a tarball.\n\nOr perhaps fulfilling the bootstrap-aux resources needs to happen in a pre-bootstrap step, that augments our git repo with some auxiliary external files?\n\nThis makes me think Matthias comment \"bootstrapping has to start somewhere\" might apply and make this not worthwhile, but perhaps someone else can see a way of making something like this work without too much trouble.",
    "created_at": "2022-08-24T18:40:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554700",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:9" align="right">Comment 9</div>

It sounds like a `gnulib_cropped` package would strike a nice balance if hosting the files under sagemath git control is too impure. But it sounds like it's a bit of a one-off (because the normal spkg tools are not available yet when it's needed) and perhaps not worth the effort for what we get from it.

I'll have a go at a "conceptual" design, having the benefit of not having the technical knowledge to delve into details (a good design can be understood on a conceptual level, but I won't claim there exists a reasonable converse):

Perhaps there are other files/artifacts that we need but don't really want to "git" control ourselves, and are needed before our normal spkg infrastructure (which is normally responsible for this) is available?
I saw `autoconf-archive` mentioned before? So would this be more worthwhile if we'd have a `bootstrap-aux.spkg` that has all this crap in it?

The tools for *building* that `spkg` could just be the normal tools: in the building process, it would clone `gnulib` and extract the required files and similarly fetch `autoconf-archive` and extract (and patch?) what it needs, and then wrap that up in something that would look like a normal `spkg`.

However, this package would normally not be *installed* through the normal means -- instead, when bootstrap needs it, it would locate an appropriate `spkg` file (or download it) and then extract what's necessary from it by virtue of it being a tarball.

Or perhaps fulfilling the bootstrap-aux resources needs to happen in a pre-bootstrap step, that augments our git repo with some auxiliary external files?

This makes me think Matthias comment "bootstrapping has to start somewhere" might apply and make this not worthwhile, but perhaps someone else can see a way of making something like this work without too much trouble.



---

archive/issue_comments_554701.json:
```json
{
    "body": "<div id=\"comment:280\" align=\"right\">Comment 280</div>\n\nI think it is useful to think about why it is that the idea of having these files in `m4` elicits such strong emotions regarding \"uncleanliness\" in some of us, that some of us want to go to extremes (such as the bizarre solution in #27823, which introduced the gettext dependency; or accepting a bloat factor of 1000, [comment:278](#comment%3A278)) -- just to avoid the unclean feeling.\n\nI have to admit that when I first used gnulib (in a more substantial way than here, namely to implement relocatability for LattE, around 2007) that I was also kind of offended by the idea of adding its imported files to my pristine CVS repository.\n\nSo here's some food for thought: The strong emotional response may be the result of decades of abuse that we endured by the early version control systems (RCS, CVS, SVN): If you committed something \"unclean\" to the central system, the system would come back and hurt you.\n\nThis is all outdated with git.",
    "created_at": "2022-08-24T19:08:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554701",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:280" align="right">Comment 280</div>

I think it is useful to think about why it is that the idea of having these files in `m4` elicits such strong emotions regarding "uncleanliness" in some of us, that some of us want to go to extremes (such as the bizarre solution in #27823, which introduced the gettext dependency; or accepting a bloat factor of 1000, [comment:278](#comment%3A278)) -- just to avoid the unclean feeling.

I have to admit that when I first used gnulib (in a more substantial way than here, namely to implement relocatability for LattE, around 2007) that I was also kind of offended by the idea of adding its imported files to my pristine CVS repository.

So here's some food for thought: The strong emotional response may be the result of decades of abuse that we endured by the early version control systems (RCS, CVS, SVN): If you committed something "unclean" to the central system, the system would come back and hurt you.

This is all outdated with git.



---

archive/issue_comments_554702.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nRegardless of the numbers, for me (and others perhaps), the thing is \"another dependency on external resource that needs to be fetched through internet at build time\" vs \"the resource is already in\".",
    "created_at": "2022-08-24T19:33:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554702",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:1" align="right">Comment 1</div>

Regardless of the numbers, for me (and others perhaps), the thing is "another dependency on external resource that needs to be fetched through internet at build time" vs "the resource is already in".



---

archive/issue_comments_554703.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nAbsolutely, I for sure don't want to have to do some manual workaround if I do a `git worktree create` while out in the wilderness without broadband access.",
    "created_at": "2022-08-24T19:38:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554703",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">Comment 2</div>

Absolutely, I for sure don't want to have to do some manual workaround if I do a `git worktree create` while out in the wilderness without broadband access.



---

archive/issue_comments_554704.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nsolution in #27823 has advantages: 1) `gettext` is a properly versioned package, not that pile of goo called `gnulib`; 2) it does not check in anything alien into Sage git tree.",
    "created_at": "2022-08-24T19:58:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554704",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:3" align="right">Comment 3</div>

solution in #27823 has advantages: 1) `gettext` is a properly versioned package, not that pile of goo called `gnulib`; 2) it does not check in anything alien into Sage git tree.



---

archive/issue_comments_554705.json:
```json
{
    "body": "<div id=\"comment:284\" align=\"right\">Comment 284</div>\n\nReplying to [@kwankyu](#comment%3A281):\n> ... the thing is \"another dependency on external resource that needs to be fetched through internet at build time\" vs \"the resource is already in\".\n\nBut when I build sage from a fresh `git clone` the system already goes and measure speeds to mirrors, and (I think) fetch some spkgs. I presume the tarballs (or at least some fat versions of them) still come with those spkgs included, so that no internet connection is necessary to build those?\n\nI also recently learned that on all my previous builds, apparently `bootstrap -D` has executed, downloading a configuration from somewhere.\n\nSo it seems to me that if the bootstrap auxiliaries can be packaged in an spkg, we could provide the resources through an already-required pathway, so that shouldn't really make things more fragile.\n\nThat is provided that the `bootstrap-aux.spkg` locating/downloading can actually be done through normal means. If we have to special-case its discovery too much then *that* would probably make it more fragile and hence not worth it.\n\nI think it is important that for sagemath we do remain in a state where, after installing a well-defined set of prereqs (which should be commonly provided bits on our supported platforms) and obtaining a well-defined tarball, one should be able to build sage without internet access.\n\nI think that rule was previously already violated by `gettext-devel` being a soft prereq for which a silent workaround required internet access (in the form of `bootstrap -D`, which apparently does need internet access), so getting that solved is already progress. That can also be solved by declaring `gettext-devel` a hard prereq (provided it's a commonly provided component).",
    "created_at": "2022-08-24T20:05:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554705",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:284" align="right">Comment 284</div>

Replying to [@kwankyu](#comment%3A281):
> ... the thing is "another dependency on external resource that needs to be fetched through internet at build time" vs "the resource is already in".

But when I build sage from a fresh `git clone` the system already goes and measure speeds to mirrors, and (I think) fetch some spkgs. I presume the tarballs (or at least some fat versions of them) still come with those spkgs included, so that no internet connection is necessary to build those?

I also recently learned that on all my previous builds, apparently `bootstrap -D` has executed, downloading a configuration from somewhere.

So it seems to me that if the bootstrap auxiliaries can be packaged in an spkg, we could provide the resources through an already-required pathway, so that shouldn't really make things more fragile.

That is provided that the `bootstrap-aux.spkg` locating/downloading can actually be done through normal means. If we have to special-case its discovery too much then *that* would probably make it more fragile and hence not worth it.

I think it is important that for sagemath we do remain in a state where, after installing a well-defined set of prereqs (which should be commonly provided bits on our supported platforms) and obtaining a well-defined tarball, one should be able to build sage without internet access.

I think that rule was previously already violated by `gettext-devel` being a soft prereq for which a silent workaround required internet access (in the form of `bootstrap -D`, which apparently does need internet access), so getting that solved is already progress. That can also be solved by declaring `gettext-devel` a hard prereq (provided it's a commonly provided component).



---

archive/issue_comments_554706.json:
```json
{
    "body": "<div id=\"comment:285\" align=\"right\">Comment 285</div>\n\nReplying to [@nbruin](#comment%3A284):\n> Replying to [@kwankyu](#comment%3A281):\n> > ... the thing is \"another dependency on external resource that needs to be fetched through internet at build time\" vs \"the resource is already in\".\n\n> \n> But when I build sage from a fresh `git clone` the system already goes and measure speeds to mirrors, and (I think) fetch some spkgs.\n\nYes, it does after the \"configure\" phase has been completed and it starts to build packages.\n\n> I presume the tarballs [...] still come with those spkgs included, so that no internet connection is necessary to build those?\n\nYes, the tarballs include all standard packages and come pre-bootstrapped. No internet connection is needed.\n\n> I also recently learned that on all my previous builds, apparently `bootstrap -D` has executed, downloading a configuration from somewhere.\n\nYes, this happens when you switch branches that touch any of the files listed here: https://github.com/sagemath/sage/blob/develop/Makefile#L43: It knows it should re-bootstrap. When the bootstrapping prerequisites are missing, it falls back to `bootstrap -D`, which retrieves the SPKG containing the bootstrapping results as of the release that the branch is based on. This is OK if that branch made no actual changes to these files compared to that release -- but it will silently give you something that's not suitable otherwise.",
    "created_at": "2022-08-24T21:09:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554706",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:285" align="right">Comment 285</div>

Replying to [@nbruin](#comment%3A284):
> Replying to [@kwankyu](#comment%3A281):
> > ... the thing is "another dependency on external resource that needs to be fetched through internet at build time" vs "the resource is already in".

> 
> But when I build sage from a fresh `git clone` the system already goes and measure speeds to mirrors, and (I think) fetch some spkgs.

Yes, it does after the "configure" phase has been completed and it starts to build packages.

> I presume the tarballs [...] still come with those spkgs included, so that no internet connection is necessary to build those?

Yes, the tarballs include all standard packages and come pre-bootstrapped. No internet connection is needed.

> I also recently learned that on all my previous builds, apparently `bootstrap -D` has executed, downloading a configuration from somewhere.

Yes, this happens when you switch branches that touch any of the files listed here: https://github.com/sagemath/sage/blob/develop/Makefile#L43: It knows it should re-bootstrap. When the bootstrapping prerequisites are missing, it falls back to `bootstrap -D`, which retrieves the SPKG containing the bootstrapping results as of the release that the branch is based on. This is OK if that branch made no actual changes to these files compared to that release -- but it will silently give you something that's not suitable otherwise.



---

archive/issue_comments_554707.json:
```json
{
    "body": "<div id=\"comment:286\" align=\"right\">Comment 286</div>\n\nReplying to [@mkoeppe](#comment%3A285):\n> `bootstrap -D`, which retrieves the SPKG containing the bootstrapping results as of the release that the branch is based on.\n\nOK, so if `bootstrap -D` can retrieve an SPKG then it could also locate/retrieve an SPKG with m4 artifacts compiled from gnulib and autoconf-archive derived files. It would seem that this approach would lead to a scenario that is no less fragile than what we have already? Declaring this to be a \"standard\" SPKG would mean it's part of tarballs and hence that those would acquire the capability of bootstrapping without an internet connection.\n\nIt would just require that someone invests the time to build the requisite spkg.\n\nTo me that doesn't sound worse than the \"hybrid\" solution and for some it would have a conceptual advantage of not checking in other project's files.",
    "created_at": "2022-08-25T07:42:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554707",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:286" align="right">Comment 286</div>

Replying to [@mkoeppe](#comment%3A285):
> `bootstrap -D`, which retrieves the SPKG containing the bootstrapping results as of the release that the branch is based on.

OK, so if `bootstrap -D` can retrieve an SPKG then it could also locate/retrieve an SPKG with m4 artifacts compiled from gnulib and autoconf-archive derived files. It would seem that this approach would lead to a scenario that is no less fragile than what we have already? Declaring this to be a "standard" SPKG would mean it's part of tarballs and hence that those would acquire the capability of bootstrapping without an internet connection.

It would just require that someone invests the time to build the requisite spkg.

To me that doesn't sound worse than the "hybrid" solution and for some it would have a conceptual advantage of not checking in other project's files.



---

archive/issue_comments_554708.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nNils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.\n\nThe vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.\n\nBy the result of the vote, this ticket will be closed with adopting one solution from the candidates.\n\nNils may open another ticket for his idea, but that should build upon the present ticket.",
    "created_at": "2022-08-26T13:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554708",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:7" align="right">Comment 7</div>

Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.

The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.

By the result of the vote, this ticket will be closed with adopting one solution from the candidates.

Nils may open another ticket for his idea, but that should build upon the present ticket.



---

archive/issue_comments_554709.json:
```json
{
    "body": "<div id=\"comment:288\" align=\"right\">Comment 288</div>\n\nReplying to [@kwankyu](#comment%3A287):\n> Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.\n\nYes, indeed. I explored whether an SPKG solution could be robust and organized in such a way that the tarball isn't overly large. The answer seems to be yes: everything needed for locating spkgs is already available at bootstrap time, since this is implemented in python script in build, which run on the prerequisite python.\n\nOnce the vote has completed, we should implement whatever solution resolves this mess ASAP because the current state results in breakage of sagemath building. If after that someone has appetite for a cleaner solution, it looks like it's possible to provide one. I do not have the expertise for it, so I won't be pursuing it.",
    "created_at": "2022-08-26T16:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554709",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:288" align="right">Comment 288</div>

Replying to [@kwankyu](#comment%3A287):
> Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.

Yes, indeed. I explored whether an SPKG solution could be robust and organized in such a way that the tarball isn't overly large. The answer seems to be yes: everything needed for locating spkgs is already available at bootstrap time, since this is implemented in python script in build, which run on the prerequisite python.

Once the vote has completed, we should implement whatever solution resolves this mess ASAP because the current state results in breakage of sagemath building. If after that someone has appetite for a cleaner solution, it looks like it's possible to provide one. I do not have the expertise for it, so I won't be pursuing it.



---

archive/issue_comments_554710.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nHere what Bruno Haible (on of primary authors of gnulib/gettext) has to say about our problem:\nhttps://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00103.html\nNote that he does not suggest to check bits of gnulib in our git tree.\n(and elsewhere he says he seldom sees this done: https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00102.html)\n\n```\nDima Pasechnik wrote:\n> We are in fact having a fight now over whether to check in the\n> iconv pieces produced by gnulib-tool into the source tree, or call \n> gnulib-tool at bootstrap.\n> https://trac.sagemath.org/ticket/34152\n\nOK, now let's talk about the actual problem at hand.\n\nI won't jump into the discussion there, because\n  - it's already a very long thread,\n  - I don't know what an \"SPKG\" is,\n  - I don't know about the preferred habits in the sagemath dev community.\n\nBut there I read:\n> $ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4\n>  20K  config/config.rpath\n> 8.0K  m4/lib-ld.m4\n>  36K  m4/lib-link.m4\n>  12K  m4/lib-prefix.m4\n>  12K  m4/iconv.m4\n>  24K  m4/host-cpu-c-abi.m4\n\nYes, these is currently the list of files needed for AM_ICONV.\n\n> It's some kind of a weird tradition of jumping through hoops to get\n> config.rpath\n\nIf you need only a few files from Gnulib, the common approach is\nto invoke either gnulib-tool (if present, indicated through an\nenvironment variable GNULIB_SRCDIR that the user can set) or\nfetch the files from the git repository one by one.\n\nTo fetch only config.rpath:\n\nGNULIB_REPO_URL=\"https://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob_plain;hb=HEAD;f=\";\nfor file in build-aux/config.rpath; do\n  if test -n \"$GNULIB_SRCDIR\" && test -d \"$GNULIB_SRCDIR\"; then\n    \"GNULIB_SRCDIR/gnulib-tool\" --copy-file $file $file\n  else\n    wget -q --timeout=5 -O $file.tmp \"${GNULIB_REPO_URL}$file\" \\\n      && mv $file.tmp $file\n  fi\ndone\n\nTo fetch all 6 files:\n\nGNULIB_REPO_URL=\"https://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob_plain;hb=HEAD;f=\";\nfor file in build-aux/config.rpath m4/lib-ld.m4 m4/lib-link.m4 m4/lib-prefix.m4 \nm4/iconv.m4 m4/host-cpu-c-abi.m4; do\n  if test -n \"$GNULIB_SRCDIR\" && test -d \"$GNULIB_SRCDIR\"; then\n    \"GNULIB_SRCDIR/gnulib-tool\" --copy-file $file $file\n  else\n    wget -q --timeout=5 -O $file.tmp \"${GNULIB_REPO_URL}$file\" \\\n      && mv $file.tmp $file\n  fi\ndone\n\nThis is the quick solution, which minimizes network traffic. But it is not\nfuture-proof: At any moment, some more files may become needed, due to\nchanges in the *.m4 files. The future-proof solution is to download\nthe gnulib git repository (shallow, if you want) and run\n  $GNULIB_SRCDIR/gnulib-tool [OPTIONS] --import iconv\n\n> I don't quite understand the relationship between automake, gettext, and\n> gnutools here. Is AM_ICONV even meant to work without gnulib?\n> Or is it a libtool bug?\n\nAM_ICONV is documented in two places:\n- https://www.gnu.org/software/gettext/manual/html_node/AM_005fICONV.html\n- https://www.gnu.org/software/gnulib/MODULES.html#module=iconv\n\nThe consumption as a gnulib module is meant to be easier than through\ngettext. A lot of work has been put into gnulib to make such a consumption\neasy; gettext (autopoint) lags behind in this aspect.\n\n> https://lists.gnu.org/archive/html/bug-gettext/2011-10/msg00012.html\n\nAlready in 2011, if you need only AM_ICONV, the gnulib module 'iconv'\nwas the better choice.\n\n> config.rpath (in gnulib) appears to be an orphan.\n\nNo. It is maintained in gnulib, as you can see from the commit history.\n\n> (Does gettext misappropriate prefixes AM_ and\n> AC_ for its macros, making an impression that they are from autotools?)\n\nYes, the prefix AM_ here is a mistake. It should better be gl_. But\nchanging it now would cause more annoyance than benefit.\n```",
    "created_at": "2022-08-26T19:17:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554710",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">Comment 9</div>

Here what Bruno Haible (on of primary authors of gnulib/gettext) has to say about our problem:
https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00103.html
Note that he does not suggest to check bits of gnulib in our git tree.
(and elsewhere he says he seldom sees this done: https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00102.html)

```
Dima Pasechnik wrote:
> We are in fact having a fight now over whether to check in the
> iconv pieces produced by gnulib-tool into the source tree, or call 
> gnulib-tool at bootstrap.
> https://trac.sagemath.org/ticket/34152

OK, now let's talk about the actual problem at hand.

I won't jump into the discussion there, because
  - it's already a very long thread,
  - I don't know what an "SPKG" is,
  - I don't know about the preferred habits in the sagemath dev community.

But there I read:
> $ du -sh config/config.rpath m4/lib-*.m4 m4/iconv.m4 m4/host-cpu-c-abi.m4
>  20K  config/config.rpath
> 8.0K  m4/lib-ld.m4
>  36K  m4/lib-link.m4
>  12K  m4/lib-prefix.m4
>  12K  m4/iconv.m4
>  24K  m4/host-cpu-c-abi.m4

Yes, these is currently the list of files needed for AM_ICONV.

> It's some kind of a weird tradition of jumping through hoops to get
> config.rpath

If you need only a few files from Gnulib, the common approach is
to invoke either gnulib-tool (if present, indicated through an
environment variable GNULIB_SRCDIR that the user can set) or
fetch the files from the git repository one by one.

To fetch only config.rpath:

GNULIB_REPO_URL="https://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob_plain;hb=HEAD;f=";
for file in build-aux/config.rpath; do
  if test -n "$GNULIB_SRCDIR" && test -d "$GNULIB_SRCDIR"; then
    "GNULIB_SRCDIR/gnulib-tool" --copy-file $file $file
  else
    wget -q --timeout=5 -O $file.tmp "${GNULIB_REPO_URL}$file" \
      && mv $file.tmp $file
  fi
done

To fetch all 6 files:

GNULIB_REPO_URL="https://git.savannah.gnu.org/gitweb/?p=gnulib.git;a=blob_plain;hb=HEAD;f=";
for file in build-aux/config.rpath m4/lib-ld.m4 m4/lib-link.m4 m4/lib-prefix.m4 
m4/iconv.m4 m4/host-cpu-c-abi.m4; do
  if test -n "$GNULIB_SRCDIR" && test -d "$GNULIB_SRCDIR"; then
    "GNULIB_SRCDIR/gnulib-tool" --copy-file $file $file
  else
    wget -q --timeout=5 -O $file.tmp "${GNULIB_REPO_URL}$file" \
      && mv $file.tmp $file
  fi
done

This is the quick solution, which minimizes network traffic. But it is not
future-proof: At any moment, some more files may become needed, due to
changes in the *.m4 files. The future-proof solution is to download
the gnulib git repository (shallow, if you want) and run
  $GNULIB_SRCDIR/gnulib-tool [OPTIONS] --import iconv

> I don't quite understand the relationship between automake, gettext, and
> gnutools here. Is AM_ICONV even meant to work without gnulib?
> Or is it a libtool bug?

AM_ICONV is documented in two places:
- https://www.gnu.org/software/gettext/manual/html_node/AM_005fICONV.html
- https://www.gnu.org/software/gnulib/MODULES.html#module=iconv

The consumption as a gnulib module is meant to be easier than through
gettext. A lot of work has been put into gnulib to make such a consumption
easy; gettext (autopoint) lags behind in this aspect.

> https://lists.gnu.org/archive/html/bug-gettext/2011-10/msg00012.html

Already in 2011, if you need only AM_ICONV, the gnulib module 'iconv'
was the better choice.

> config.rpath (in gnulib) appears to be an orphan.

No. It is maintained in gnulib, as you can see from the commit history.

> (Does gettext misappropriate prefixes AM_ and
> AC_ for its macros, making an impression that they are from autotools?)

Yes, the prefix AM_ here is a mistake. It should better be gl_. But
changing it now would cause more annoyance than benefit.
```



---

archive/issue_comments_554711.json:
```json
{
    "body": "<div id=\"comment:290\" align=\"right\">Comment 290</div>\n\nDima, I suggested that you take your complaints about upstream gnulib to their mailing list in [comment:73](#comment%3A73) and again in [comment:87](#comment%3A87), 6 weeks ago, but you declined to do so in [comment:88](#comment%3A88).\n\nI see that now you did, after all, yesterday or so, in https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00089.html, and you are writing:\n\n```\nIf a project does not use git's submodules, noone wants an extra\ncomplexity of submodules to be added to the build system just due to\nthe need for gnulib.\nIn some projects I am or was involved, it's basically the case that the code \ninjected by\nthe gnulib-tool got committed into the tree, and blissfully forgotten\nabout. \n```\nYes, having the gnulib-imported modules \"blissfully forgotten\" is exactly what my approach (and the hybrid approach) is achieving. You now seem to acknowledge that it's common practice, which sounds like a way to a peaceful resolution of what we discussed here in this ticket.",
    "created_at": "2022-08-26T19:42:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554711",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:290" align="right">Comment 290</div>

Dima, I suggested that you take your complaints about upstream gnulib to their mailing list in [comment:73](#comment%3A73) and again in [comment:87](#comment%3A87), 6 weeks ago, but you declined to do so in [comment:88](#comment%3A88).

I see that now you did, after all, yesterday or so, in https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00089.html, and you are writing:

```
If a project does not use git's submodules, noone wants an extra
complexity of submodules to be added to the build system just due to
the need for gnulib.
In some projects I am or was involved, it's basically the case that the code 
injected by
the gnulib-tool got committed into the tree, and blissfully forgotten
about. 
```
Yes, having the gnulib-imported modules "blissfully forgotten" is exactly what my approach (and the hybrid approach) is achieving. You now seem to acknowledge that it's common practice, which sounds like a way to a peaceful resolution of what we discussed here in this ticket.



---

archive/issue_comments_554712.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\n> You now seem to acknowledge that it's common practice, which sounds like a way to a peaceful resolution of what we discussed here in this ticket. \n\nNo, you are twisting my words, please stop. I never conducted a study of this (and I trust Bruno did, one way or another, arriving to the conclusion opposite).\n\nI also wrote there, and got a confirmation from a Gentoo developer, that \"code \ninjected by\nthe gnulib-tool got committed into the tree, and blissfully forgotten\" is a bad approach.",
    "created_at": "2022-08-26T19:55:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554712",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:1" align="right">Comment 1</div>

> You now seem to acknowledge that it's common practice, which sounds like a way to a peaceful resolution of what we discussed here in this ticket. 

No, you are twisting my words, please stop. I never conducted a study of this (and I trust Bruno did, one way or another, arriving to the conclusion opposite).

I also wrote there, and got a confirmation from a Gentoo developer, that "code 
injected by
the gnulib-tool got committed into the tree, and blissfully forgotten" is a bad approach.



---

archive/issue_comments_554713.json:
```json
{
    "body": "<div id=\"comment:292\" align=\"right\">Comment 292</div>\n\nReplying to [@dimpase](#comment%3A289):\n> Here what Bruno Haible (on of primary authors of gnulib/gettext) has to say about our problem:\n> https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00103.html\n> Note that he does not suggest to check bits of gnulib in our git tree. [...]\n\nIn the previous message, https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00102.html, Bruno writes this:\n\n```\nIn [1] we document three approaches, dependending on the package's usual\nhandling of imported/generated files.\n\nDima Pasechnik wrote:\n> [...]\n> Why you at gnulib headquarters want large chunks of gnulib\n> scattered accross many, many thousands of downstream git trees, I don't know.\n\nThis is not what we \"want\". The documentation [1] gives three options. You\nchoose the one that fits best for your package.\n\n[1] https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html\n```\nHe is confirming what the manual is saying, disputing your [comment:72](#comment%3A72)",
    "created_at": "2022-08-26T19:58:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554713",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:292" align="right">Comment 292</div>

Replying to [@dimpase](#comment%3A289):
> Here what Bruno Haible (on of primary authors of gnulib/gettext) has to say about our problem:
> https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00103.html
> Note that he does not suggest to check bits of gnulib in our git tree. [...]

In the previous message, https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00102.html, Bruno writes this:

```
In [1] we document three approaches, dependending on the package's usual
handling of imported/generated files.

Dima Pasechnik wrote:
> [...]
> Why you at gnulib headquarters want large chunks of gnulib
> scattered accross many, many thousands of downstream git trees, I don't know.

This is not what we "want". The documentation [1] gives three options. You
choose the one that fits best for your package.

[1] https://www.gnu.org/software/gnulib/manual/html_node/VCS-Issues.html
```
He is confirming what the manual is saying, disputing your [comment:72](#comment%3A72)



---

archive/issue_comments_554714.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nThis is fun.\n\nI suggest that we stop the discussion and just agree to abide by the vote on sage-devel, which is still ongoing.",
    "created_at": "2022-08-26T20:05:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554714",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">Comment 3</div>

This is fun.

I suggest that we stop the discussion and just agree to abide by the vote on sage-devel, which is still ongoing.



---

archive/issue_comments_554715.json:
```json
{
    "body": "<div id=\"comment:294\" align=\"right\">Comment 294</div>\n\n+1, with the recommendation for everyone interested to read the whole thread in https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00089.html",
    "created_at": "2022-08-26T20:07:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554715",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:294" align="right">Comment 294</div>

+1, with the recommendation for everyone interested to read the whole thread in https://lists.gnu.org/archive/html/bug-gnulib/2022-08/msg00089.html



---

archive/issue_comments_554716.json:
```json
{
    "body": "<div id=\"comment:295\" align=\"right\">Comment 295</div>\n\nReplying to [@kwankyu](#comment%3A287):\n> Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.\n> \n> The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.\n> \n> By the result of the vote, this ticket will be closed with adopting one solution from the candidates.\n> \n> Nils may open another ticket for his idea, but that should build upon the present ticket.\n\nThis only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar \"vote don't discuss\" procedure by the past, including the \"code of conduct\" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.",
    "created_at": "2022-08-27T23:14:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554716",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:295" align="right">Comment 295</div>

Replying to [@kwankyu](#comment%3A287):
> Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.
> 
> The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.
> 
> By the result of the vote, this ticket will be closed with adopting one solution from the candidates.
> 
> Nils may open another ticket for his idea, but that should build upon the present ticket.

This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar "vote don't discuss" procedure by the past, including the "code of conduct" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.



---

archive/issue_comments_554717.json:
```json
{
    "body": "<div id=\"comment:296\" align=\"right\">Comment 296</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A295):\n> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. \n\nWe would be choked if we start a discussion on the procedure of voting that is likely to lead to a voting :) If you want the discussion anyway, please open it on sage-devel.",
    "created_at": "2022-08-28T00:24:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554717",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:296" align="right">Comment 296</div>

Replying to [@sagetrac-tmonteil](#comment%3A295):
> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. 

We would be choked if we start a discussion on the procedure of voting that is likely to lead to a voting :) If you want the discussion anyway, please open it on sage-devel.



---

archive/issue_comments_554718.json:
```json
{
    "body": "<div id=\"comment:297\" align=\"right\">Comment 297</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A295):\n> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar \"vote don't discuss\" procedure by the past, including the \"code of conduct\" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.\n\nThis problem must urgently be resolved: presently, you can have a valid setup according to the documentation and yet be unable to build/configure the last couple of sagemath beta releases.\n\nAs far as I could see, a valid solution could have been \"gettext-devel is a prereq for sagemath\" (a really ugly one, though) but the solutions on the ticket at the moment would work too. I think the priority is to get *something* merged that resolves the acute problem.\n\nOnce we have a somewhat workable solution in place that at least allows people to build sage, we can look if the solution, like any piece of sage, can be improved. Who knows, perhaps a better solution even gets merged before a release is actually made! But we cannot really wait for that now.",
    "created_at": "2022-08-28T01:30:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554718",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:297" align="right">Comment 297</div>

Replying to [@sagetrac-tmonteil](#comment%3A295):
> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar "vote don't discuss" procedure by the past, including the "code of conduct" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.

This problem must urgently be resolved: presently, you can have a valid setup according to the documentation and yet be unable to build/configure the last couple of sagemath beta releases.

As far as I could see, a valid solution could have been "gettext-devel is a prereq for sagemath" (a really ugly one, though) but the solutions on the ticket at the moment would work too. I think the priority is to get *something* merged that resolves the acute problem.

Once we have a somewhat workable solution in place that at least allows people to build sage, we can look if the solution, like any piece of sage, can be improved. Who knows, perhaps a better solution even gets merged before a release is actually made! But we cannot really wait for that now.



---

archive/issue_comments_554719.json:
```json
{
    "body": "<div id=\"comment:298\" align=\"right\">Comment 298</div>\n\nReplying to [@sagetrac-tmonteil](#comment%3A295):\n> Replying to [@kwankyu](#comment%3A287):\n> > Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.\n> > \n> > The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.\n> > \n> > By the result of the vote, this ticket will be closed with adopting one solution from the candidates.\n> > \n> > Nils may open another ticket for his idea, but that should build upon the present ticket.\n\n> \n> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar \"vote don't discuss\" procedure by the past, including the \"code of conduct\" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.\n> \n\nYour suggestion has some merits but there is no one size fits all for all cases. Problem: you have people arguing over two possible solution. You invite more sage developers in and now you have people arguing over 8 different solutions (Ok, I am exaggerating but I really see that kind of things as a real possibility). I'll take responsibility for calling the vote on this particular occasion. I was invited on the ticket but it became clear that I wouldn't sway one side over the other and I had nothing much more to offer to the ticket. May be calling someone else would have been better in this case.",
    "created_at": "2022-08-28T01:43:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554719",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:298" align="right">Comment 298</div>

Replying to [@sagetrac-tmonteil](#comment%3A295):
> Replying to [@kwankyu](#comment%3A287):
> > Nils seems to be proposing yet another solution for the present ticket, instead of arguing merits or demerits of the candidate solutions of the ongoing vote.
> > 
> > The vote is to finish endless debates about solutions for this ticket. Proposing another solution at this moment, regardless of its own merits, would just disrupt the vote.
> > 
> > By the result of the vote, this ticket will be closed with adopting one solution from the candidates.
> > 
> > Nils may open another ticket for his idea, but that should build upon the present ticket.

> 
> This only shows that asking people to vote on a proposal that was constructed by few other people without letting them to debate and improve the proposal first is a bad habit. We already experienced similar "vote don't discuss" procedure by the past, including the "code of conduct" episode. If a better proposal emerges, i do not see in the name of what it could not be chosen over the previous ones.
> 

Your suggestion has some merits but there is no one size fits all for all cases. Problem: you have people arguing over two possible solution. You invite more sage developers in and now you have people arguing over 8 different solutions (Ok, I am exaggerating but I really see that kind of things as a real possibility). I'll take responsibility for calling the vote on this particular occasion. I was invited on the ticket but it became clear that I wouldn't sway one side over the other and I had nothing much more to offer to the ticket. May be calling someone else would have been better in this case.



---

archive/issue_comments_554720.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nNot a large participation but of those who voted, the hybrid approach was clearly prefered.\n\n* hybrid: 8\n* pseudo-package: 2\n* copy: 0",
    "created_at": "2022-08-29T00:08:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554720",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">Comment 9</div>

Not a large participation but of those who voted, the hybrid approach was clearly prefered.

* hybrid: 8
* pseudo-package: 2
* copy: 0



---

archive/issue_comments_554721.json:
```json
{
    "body": "<div id=\"comment:0\" align=\"right\">Comment 0</div>\n\nI reviewed Dima's script while transforming it to the `spkg-src` script on the current branch.",
    "created_at": "2022-08-29T01:12:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554721",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:0" align="right">Comment 0</div>

I reviewed Dima's script while transforming it to the `spkg-src` script on the current branch.



---

archive/issue_comments_554722.json:
```json
{
    "body": "Reviewer: **..., Matthias Koeppe**",
    "created_at": "2022-08-29T01:12:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554722",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **..., Matthias Koeppe**



---

archive/issue_comments_554723.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -46,7 +46,7 @@\n \n ---\n \n-**Voting is taking place at https://groups.google.com/g/sage-devel/c/E2qstbWXC7g**\n+**Voting took place at https://groups.google.com/g/sage-devel/c/E2qstbWXC7g**\n \n \n \n``````\n",
    "created_at": "2022-08-29T01:13:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554723",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -46,7 +46,7 @@
 
 ---
 
-**Voting is taking place at https://groups.google.com/g/sage-devel/c/E2qstbWXC7g**
+**Voting took place at https://groups.google.com/g/sage-devel/c/E2qstbWXC7g**
 
 
 
``````




---

archive/issue_comments_554724.json:
```json
{
    "body": "Changed reviewer from **..., Matthias Koeppe** to **..., Matthias Koeppe, Kwankyu Lee**",
    "created_at": "2022-08-29T02:32:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554724",
    "user": "https://github.com/kwankyu"
}
```

Changed reviewer from **..., Matthias Koeppe** to **..., Matthias Koeppe, Kwankyu Lee**



---

archive/issue_comments_554725.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nIt looks good to me, except those m4 files of external origin. But we decided to accept them.",
    "created_at": "2022-08-29T02:32:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554725",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:2" align="right">Comment 2</div>

It looks good to me, except those m4 files of external origin. But we decided to accept them.



---

archive/issue_comments_554726.json:
```json
{
    "body": "<div id=\"comment:303\" align=\"right\">Comment 303</div>\n\nReplying to [@kwankyu](#comment%3A302):\n> It looks good to me, except those m4 files of external origin. But we decided to accept them.\n\nIf you put it like that, it's almost an argument *for* checking them in: by keeping them out of the tree, they'd be invisible for review and yet the files are used to build sagemath. When we put them into the repo at least it's clear for all to see those particular pieces of code that we depend on. We have of course plenty of dependencies that we don't put through our usual review process ...\n\nAnyway, thanks for getting the review process for this on track! I'm happy to see this problem is being resolved now. If people care enough to implement a nicer solution they can do so.",
    "created_at": "2022-08-29T03:11:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554726",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:303" align="right">Comment 303</div>

Replying to [@kwankyu](#comment%3A302):
> It looks good to me, except those m4 files of external origin. But we decided to accept them.

If you put it like that, it's almost an argument *for* checking them in: by keeping them out of the tree, they'd be invisible for review and yet the files are used to build sagemath. When we put them into the repo at least it's clear for all to see those particular pieces of code that we depend on. We have of course plenty of dependencies that we don't put through our usual review process ...

Anyway, thanks for getting the review process for this on track! I'm happy to see this problem is being resolved now. If people care enough to implement a nicer solution they can do so.



---

archive/issue_comments_554727.json:
```json
{
    "body": "<div id=\"comment:304\" align=\"right\">Comment 304</div>\n\nReplying to [@nbruin](#comment%3A303):\n> by keeping them out of the tree, they'd be invisible for review and yet the files are used to build sagemath. When we put them into the repo at least it's clear for all to see those particular pieces of code that we depend on. We have of course plenty of dependencies that we don't put through our usual review process ...\n\nYes, this is an important point, and it matches an earlier discussion that we had on sage-devel regarding monorepo vs. multirepo strategies (in the context of the Sage library, not the Sage distribution): https://groups.google.com/g/sage-devel/c/AaKxoNQAWMg/m/uY1rW5n0BQAJ\n\nRelated: https://groups.google.com/g/sage-devel/c/JBFbtUNhqNU/m/KuySNvTuBAAJ",
    "created_at": "2022-08-29T03:18:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554727",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:304" align="right">Comment 304</div>

Replying to [@nbruin](#comment%3A303):
> by keeping them out of the tree, they'd be invisible for review and yet the files are used to build sagemath. When we put them into the repo at least it's clear for all to see those particular pieces of code that we depend on. We have of course plenty of dependencies that we don't put through our usual review process ...

Yes, this is an important point, and it matches an earlier discussion that we had on sage-devel regarding monorepo vs. multirepo strategies (in the context of the Sage library, not the Sage distribution): https://groups.google.com/g/sage-devel/c/AaKxoNQAWMg/m/uY1rW5n0BQAJ

Related: https://groups.google.com/g/sage-devel/c/JBFbtUNhqNU/m/KuySNvTuBAAJ



---

archive/issue_comments_554728.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nLet's finally get this ticket in please.",
    "created_at": "2022-08-30T19:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554728",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:5" align="right">Comment 5</div>

Let's finally get this ticket in please.



---

archive/issue_events_449011.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-08-30T23:38:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449011"
}
```



---

archive/issue_events_449012.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-08-30T23:38:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449012"
}
```



---

archive/issue_comments_554729.json:
```json
{
    "body": "Changed reviewer from **..., Matthias Koeppe, Kwankyu Lee** to **Fran\u00e7ois Bissey, \u200bDima Pasechnik, Matthias Koeppe, Kwankyu Lee**",
    "created_at": "2022-08-30T23:38:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554729",
    "user": "https://github.com/kwankyu"
}
```

Changed reviewer from **..., Matthias Koeppe, Kwankyu Lee** to **François Bissey, ​Dima Pasechnik, Matthias Koeppe, Kwankyu Lee**



---

archive/issue_comments_554730.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nThanks!",
    "created_at": "2022-08-31T01:40:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554730",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">Comment 7</div>

Thanks!



---

archive/issue_events_449013.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T01:50:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449013"
}
```



---

archive/issue_events_449014.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T01:50:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449014"
}
```



---

archive/issue_events_449015.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-07T23:10:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449015"
}
```



---

archive/issue_events_449016.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "b37ed1cf0cc2706fa8849c3200a990d629e5b986",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-09-07T23:10:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34152#event-449016"
}
```



---

archive/issue_comments_554731.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/config/gnulib)** to **[8bf9d97](https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5)**",
    "created_at": "2022-09-07T23:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554731",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/config/gnulib](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/config/gnulib)** to **[8bf9d97](https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5)**



---

archive/issue_comments_554732.json:
```json
{
    "body": "Changed reviewer from **Fran\u00e7ois Bissey, \u200bDima Pasechnik, Matthias Koeppe, Kwankyu Lee** to **Fran\u00e7ois Bissey, Dima Pasechnik, Matthias Koeppe, Kwankyu Lee**",
    "created_at": "2022-09-19T23:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554732",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **François Bissey, ​Dima Pasechnik, Matthias Koeppe, Kwankyu Lee** to **François Bissey, Dima Pasechnik, Matthias Koeppe, Kwankyu Lee**



---

archive/issue_comments_554733.json:
```json
{
    "body": "Changed commit from **[8bf9d97](https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5)** to none",
    "created_at": "2022-09-19T23:11:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34152#issuecomment-554733",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[8bf9d97](https://github.com/sagemath/sagetrac-mirror/commit/8bf9d9738304b9bf1dee14ee639c934db15972a5)** to none
