# Issue 34906: use NTL's MinPolyMod()

archive/issues_034669.json:
```json
{
    "assignees": [],
    "body": "NTL implements Shoup's algorithm https://shoup.net/papers/mpol.pdf for minimal polynomials of algebraic elements over finite fields.\n\nThis patch adds call paths from `PolynomialQuotientRingElement.minpoly()` and `RingExtensionWithBasisElement.minpoly()` to NTL's `MinPolyMod()` function, yielding massive speedups in some important special cases.\n\nExample code:\n\n```sage\nsage: K.<u> = GF((23,5))\n....: L.<v> = K.extension(42)\n....: LK = L.over(K)\n....: _ = LK(L.random_element()).minpoly()  # warm up\n....: %timeit LK(L.random_element()).minpoly()\n```\n\nSage 9.7:\n\n```\n2.47 s \u00b1 25.7 ms per loop (mean \u00b1 std. dev. of 7 runs, 1 loop each)\n```\n\nThis branch:\n\n```\n49.6 ms \u00b1 546 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\n```\n\nBranch/Commit: **[public/use_NTL_MinPolyMod](https://github.com/sagemath/sagetrac-mirror/tree/public/use_NTL_MinPolyMod) @ [d230ff8](https://github.com/sagemath/sagetrac-mirror/commit/d230ff80c15690a6b3f4319d58459c22b0d31ad3)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Lorenz Panny**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34906_\n\n",
    "created_at": "2023-01-11T07:30:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/positive%20review"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "use NTL's MinPolyMod()",
    "type": "issue",
    "updated_at": "2023-01-13T03:21:17Z",
    "url": "https://github.com/sagemath/sage/issues/34906",
    "user": "https://github.com/yyyyx4"
}
```
NTL implements Shoup's algorithm https://shoup.net/papers/mpol.pdf for minimal polynomials of algebraic elements over finite fields.

This patch adds call paths from `PolynomialQuotientRingElement.minpoly()` and `RingExtensionWithBasisElement.minpoly()` to NTL's `MinPolyMod()` function, yielding massive speedups in some important special cases.

Example code:

```sage
sage: K.<u> = GF((23,5))
....: L.<v> = K.extension(42)
....: LK = L.over(K)
....: _ = LK(L.random_element()).minpoly()  # warm up
....: %timeit LK(L.random_element()).minpoly()
```

Sage 9.7:

```
2.47 s ± 25.7 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
```

This branch:

```
49.6 ms ± 546 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
```

Branch/Commit: **[public/use_NTL_MinPolyMod](https://github.com/sagemath/sagetrac-mirror/tree/public/use_NTL_MinPolyMod) @ [d230ff8](https://github.com/sagemath/sagetrac-mirror/commit/d230ff80c15690a6b3f4319d58459c22b0d31ad3)**

Reviewer: **Frédéric Chapoton**

Author: **Lorenz Panny**

_Issue created by migration from https://trac.sagemath.org/ticket/34906_





---

archive/issue_events_456334.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2023-01-11T07:30:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34906#event-456334"
}
```



---

archive/issue_events_456335.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2023-01-11T07:30:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34906#event-456335"
}
```



---

archive/issue_events_456336.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2023-01-11T07:30:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34906#event-456336"
}
```



---

archive/issue_events_456337.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2023-01-11T07:30:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34906#event-456337"
}
```



---

archive/issue_comments_565246.json:
```json
{
    "body": "Changed commit from **[1a1e4a4](https://github.com/sagemath/sagetrac-mirror/commit/1a1e4a48ade9d160cb1608b3156cfa7e7edf0bd5)** to **[33171a8](https://github.com/sagemath/sagetrac-mirror/commit/33171a867126b8f73e5dd0b6900e954bbe76ad8c)**",
    "created_at": "2023-01-11T09:55:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565246",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1a1e4a4](https://github.com/sagemath/sagetrac-mirror/commit/1a1e4a48ade9d160cb1608b3156cfa7e7edf0bd5)** to **[33171a8](https://github.com/sagemath/sagetrac-mirror/commit/33171a867126b8f73e5dd0b6900e954bbe76ad8c)**



---

archive/issue_comments_565247.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f29f31e314dc76acb468e5dff7a6fe2adf4c8fa3\">f29f31e</a></td><td><code>fix reference</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/33171a867126b8f73e5dd0b6900e954bbe76ad8c\">33171a8</a></td><td><code>avoid detour through multivariate polynomial ring</code></td></tr></table>\n",
    "created_at": "2023-01-11T09:55:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565247",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:1'>Comment 1:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f29f31e314dc76acb468e5dff7a6fe2adf4c8fa3">f29f31e</a></td><td><code>fix reference</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/33171a867126b8f73e5dd0b6900e954bbe76ad8c">33171a8</a></td><td><code>avoid detour through multivariate polynomial ring</code></td></tr></table>




---

archive/issue_comments_565248.json:
```json
{
    "body": "Changed commit from **[33171a8](https://github.com/sagemath/sagetrac-mirror/commit/33171a867126b8f73e5dd0b6900e954bbe76ad8c)** to **[0e9a4e2](https://github.com/sagemath/sagetrac-mirror/commit/0e9a4e280b4aa6a2b2268b0da8019fe6443f011e)**",
    "created_at": "2023-01-11T10:13:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565248",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[33171a8](https://github.com/sagemath/sagetrac-mirror/commit/33171a867126b8f73e5dd0b6900e954bbe76ad8c)** to **[0e9a4e2](https://github.com/sagemath/sagetrac-mirror/commit/0e9a4e280b4aa6a2b2268b0da8019fe6443f011e)**



---

archive/issue_comments_565249.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/23f2c2de3252eb7caec7450e91f8b4a5ed6928d1\">23f2c2d</a></td><td><code>expose NTL's MinPolyMod() and use it</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0e9a4e280b4aa6a2b2268b0da8019fe6443f011e\">0e9a4e2</a></td><td><code>avoid detour through multivariate polynomial ring</code></td></tr></table>\n",
    "created_at": "2023-01-11T10:13:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565249",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>Comment 2:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/23f2c2de3252eb7caec7450e91f8b4a5ed6928d1">23f2c2d</a></td><td><code>expose NTL's MinPolyMod() and use it</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0e9a4e280b4aa6a2b2268b0da8019fe6443f011e">0e9a4e2</a></td><td><code>avoid detour through multivariate polynomial ring</code></td></tr></table>




---

archive/issue_events_456338.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2023-01-11T15:06:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34906#event-456338"
}
```



---

archive/issue_comments_565250.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,8 +18,8 @@\n 2.47 s \u00b1 25.7 ms per loop (mean \u00b1 std. dev. of 7 runs, 1 loop each)\n ```\n \n-Sage 9.8.beta6 with this patch:\n+This branch:\n \n ```\n-51.9 ms \u00b1 522 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\n+49.6 ms \u00b1 546 \u00b5s per loop (mean \u00b1 std. dev. of 7 runs, 10 loops each)\n ```\n``````\n",
    "created_at": "2023-01-11T15:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565250",
    "user": "https://github.com/yyyyx4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,8 +18,8 @@
 2.47 s ± 25.7 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
 ```
 
-Sage 9.8.beta6 with this patch:
+This branch:
 
 ```
-51.9 ms ± 522 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
+49.6 ms ± 546 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
 ```
``````




---

archive/issue_comments_565251.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nyou could add the doi to the reference\n\nhttps://doi.org/10.1145/309831.309859\n\nso <code>:doi:\\`10.1145/309831.309859\\`</code>",
    "created_at": "2023-01-11T16:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565251",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'>Comment 4:</a>
you could add the doi to the reference

https://doi.org/10.1145/309831.309859

so <code>:doi:\`10.1145/309831.309859\`</code>



---

archive/issue_comments_565252.json:
```json
{
    "body": "Changed commit from **[0e9a4e2](https://github.com/sagemath/sagetrac-mirror/commit/0e9a4e280b4aa6a2b2268b0da8019fe6443f011e)** to **[8eba4eb](https://github.com/sagemath/sagetrac-mirror/commit/8eba4eb9d87349b55cfbbc7f52eed0f7f3f7c94d)**",
    "created_at": "2023-01-11T16:22:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565252",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[0e9a4e2](https://github.com/sagemath/sagetrac-mirror/commit/0e9a4e280b4aa6a2b2268b0da8019fe6443f011e)** to **[8eba4eb](https://github.com/sagemath/sagetrac-mirror/commit/8eba4eb9d87349b55cfbbc7f52eed0f7f3f7c94d)**



---

archive/issue_comments_565253.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8eba4eb9d87349b55cfbbc7f52eed0f7f3f7c94d\">8eba4eb</a></td><td><code>add DOI to reference</code></td></tr></table>\n",
    "created_at": "2023-01-11T16:22:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565253",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8eba4eb9d87349b55cfbbc7f52eed0f7f3f7c94d">8eba4eb</a></td><td><code>add DOI to reference</code></td></tr></table>




---

archive/issue_comments_565254.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nSure, why not. Done.",
    "created_at": "2023-01-11T16:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565254",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:6'>Comment 6:</a>
Sure, why not. Done.



---

archive/issue_comments_565255.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\none failing doctest, see patchbot, that seems to be related to the changes done here",
    "created_at": "2023-01-11T18:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565255",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'>Comment 7:</a>
one failing doctest, see patchbot, that seems to be related to the changes done here



---

archive/issue_comments_565256.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nSorry, that's a new test I added (and promptly got wrong). Fixing shortly.",
    "created_at": "2023-01-12T03:06:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565256",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:8'>Comment 8:</a>
Sorry, that's a new test I added (and promptly got wrong). Fixing shortly.



---

archive/issue_comments_565257.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d230ff80c15690a6b3f4319d58459c22b0d31ad3\">d230ff8</a></td><td><code>fix doctest</code></td></tr></table>\n",
    "created_at": "2023-01-12T05:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565257",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>Comment 9:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d230ff80c15690a6b3f4319d58459c22b0d31ad3">d230ff8</a></td><td><code>fix doctest</code></td></tr></table>




---

archive/issue_comments_565258.json:
```json
{
    "body": "Changed commit from **[8eba4eb](https://github.com/sagemath/sagetrac-mirror/commit/8eba4eb9d87349b55cfbbc7f52eed0f7f3f7c94d)** to **[d230ff8](https://github.com/sagemath/sagetrac-mirror/commit/d230ff80c15690a6b3f4319d58459c22b0d31ad3)**",
    "created_at": "2023-01-12T05:56:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565258",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8eba4eb](https://github.com/sagemath/sagetrac-mirror/commit/8eba4eb9d87349b55cfbbc7f52eed0f7f3f7c94d)** to **[d230ff8](https://github.com/sagemath/sagetrac-mirror/commit/d230ff80c15690a6b3f4319d58459c22b0d31ad3)**



---

archive/issue_events_456339.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2023-01-12T16:39:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34906#event-456339"
}
```



---

archive/issue_events_456340.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2023-01-12T16:39:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34906#event-456340"
}
```



---

archive/issue_comments_565259.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2023-01-12T16:39:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565259",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_565260.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nok, I will give a positive review, unless you want to ask some more qualified expert in the domain",
    "created_at": "2023-01-12T16:39:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565260",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'>Comment 10:</a>
ok, I will give a positive review, unless you want to ask some more qualified expert in the domain



---

archive/issue_comments_565261.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nThank you!",
    "created_at": "2023-01-13T03:21:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34906#issuecomment-565261",
    "user": "https://github.com/yyyyx4"
}
```

<a id='comment:11'>Comment 11:</a>
Thank you!
