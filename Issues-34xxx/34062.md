# Issue 34062: enhance our conversion system

archive/issues_033825.json:
```json
{
    "body": "Currently, we create the `symbol_table` to handle back-conversion from other systems. I will use \"giac\" as an example.\n\nFor example, we have `symbol_table[\"giac\"]`, which is a dictionary `string: func` where `string` is a function name in giac and `func` is the corresponding function in sage.\n\nProposal:\n\nEnrich the conversion dictionary as follows :\n`(string, number): func` where `number` is the number of arguments.\n\nThis allows to handle the conversion better when \"giac\" has one single function with various possible numbers of arguments and we have different functions.\n\nMore generally, this allows to be more precise in what we are doing.\n\nBranch/Commit: ac8fbb128cdb9b63a1ead6ea30ea58873e943948\n\nReviewer: Emmanuel Charpentier\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34062\n\n",
    "closed_at": "2022-07-09T22:32:54Z",
    "created_at": "2022-06-24T15:12:21Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.7",
    "title": "enhance our conversion system",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34062",
    "user": "https://github.com/fchapoton"
}
```
Currently, we create the `symbol_table` to handle back-conversion from other systems. I will use "giac" as an example.

For example, we have `symbol_table["giac"]`, which is a dictionary `string: func` where `string` is a function name in giac and `func` is the corresponding function in sage.

Proposal:

Enrich the conversion dictionary as follows :
`(string, number): func` where `number` is the number of arguments.

This allows to handle the conversion better when "giac" has one single function with various possible numbers of arguments and we have different functions.

More generally, this allows to be more precise in what we are doing.

Branch/Commit: ac8fbb128cdb9b63a1ead6ea30ea58873e943948

Reviewer: Emmanuel Charpentier

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34062





---

archive/issue_comments_678600.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2022-06-24T15:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678600",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_678601.json:
```json
{
    "body": "Changing commit from \"\" to \"71528ac46ef66be0879166b69562e132dd7397f4\"",
    "created_at": "2022-06-24T15:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678601",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "71528ac46ef66be0879166b69562e132dd7397f4"



---

archive/issue_comments_678602.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/34062\"",
    "created_at": "2022-06-24T15:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678602",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/34062"



---

archive/issue_comments_678603.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-24T15:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678603",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_678604.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,13 @@\n Currently, we create the `symbol_table` to handle back-conversion from other systems. I will use \"giac\" as an example.\n \n-For example, we have `symbol_table[\"giac\"]`, which is a dictionary ``string: func`` where ``string`` is a function name in giac and ``func`` is the corresponding function in sage.\n+For example, we have `symbol_table[\"giac\"]`, which is a dictionary `string: func` where `string` is a function name in giac and `func` is the corresponding function in sage.\n \n Proposal:\n \n Enrich the conversion dictionary as follows :\n-``(string, number): func`` where number is number of arguments.\n+`(string, number): func` where `number` is the number of arguments.\n \n-This allows to handle the conversion better when \"giac\" has one single function with various numbers of arguments and we have different functions.\n+This allows to handle the conversion better when \"giac\" has one single function with various possible numbers of arguments and we have different functions.\n \n More generally, this allows to be more precise in what we are doing.\n \n``````\n",
    "created_at": "2022-06-24T15:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678604",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,13 @@
 Currently, we create the `symbol_table` to handle back-conversion from other systems. I will use "giac" as an example.
 
-For example, we have `symbol_table["giac"]`, which is a dictionary ``string: func`` where ``string`` is a function name in giac and ``func`` is the corresponding function in sage.
+For example, we have `symbol_table["giac"]`, which is a dictionary `string: func` where `string` is a function name in giac and `func` is the corresponding function in sage.
 
 Proposal:
 
 Enrich the conversion dictionary as follows :
-``(string, number): func`` where number is number of arguments.
+`(string, number): func` where `number` is the number of arguments.
 
-This allows to handle the conversion better when "giac" has one single function with various numbers of arguments and we have different functions.
+This allows to handle the conversion better when "giac" has one single function with various possible numbers of arguments and we have different functions.
 
 More generally, this allows to be more precise in what we are doing.
 
``````




---

archive/issue_comments_678605.json:
```json
{
    "body": "<a id='comment:3'></a>For example, this happens in `Fricas` for `ellipticE` in\n\nhttps://fricas.github.io/api/SpecialFunctionCategory.html\n\nand something similar in `maple` for `Zeta` (more fishy) :\n\nhttps://fr.maplesoft.com/support/help/maple/view.aspx?path=Zeta\n\nand in `math...` for Gamma:\n\nhttps://reference.wolfram.com/language/ref/Gamma.html",
    "created_at": "2022-06-24T15:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678605",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>For example, this happens in `Fricas` for `ellipticE` in

https://fricas.github.io/api/SpecialFunctionCategory.html

and something similar in `maple` for `Zeta` (more fishy) :

https://fr.maplesoft.com/support/help/maple/view.aspx?path=Zeta

and in `math...` for Gamma:

https://reference.wolfram.com/language/ref/Gamma.html



---

archive/issue_comments_678606.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-24T15:37:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678606",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_678607.json:
```json
{
    "body": "Changing commit from \"71528ac46ef66be0879166b69562e132dd7397f4\" to \"b4a856604d37cdccd9081af8ef2e051f61802935\"",
    "created_at": "2022-06-24T15:37:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678607",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "71528ac46ef66be0879166b69562e132dd7397f4" to "b4a856604d37cdccd9081af8ef2e051f61802935"



---

archive/issue_comments_678608.json:
```json
{
    "body": "Changing commit from \"b4a856604d37cdccd9081af8ef2e051f61802935\" to \"f81a1cca7435cb65ad8bb3c1e96361d3f34ecc67\"",
    "created_at": "2022-06-24T15:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678608",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b4a856604d37cdccd9081af8ef2e051f61802935" to "f81a1cca7435cb65ad8bb3c1e96361d3f34ecc67"



---

archive/issue_comments_678609.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-24T15:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678609",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_678610.json:
```json
{
    "body": "<a id='comment:6'></a>maybe you could fix the typo in\n\n```\nregister_symbol(lambda: infinity, {'fricas': 'plusInfinity'}, 0) # %plusInfinity::INFORM is (minusInfinity)\n```\non the way? (\"minus\" should be \"plus\")",
    "created_at": "2022-06-24T20:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678610",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'></a>maybe you could fix the typo in

```
register_symbol(lambda: infinity, {'fricas': 'plusInfinity'}, 0) # %plusInfinity::INFORM is (minusInfinity)
```
on the way? ("minus" should be "plus")



---

archive/issue_comments_678611.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-25T06:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678611",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_678612.json:
```json
{
    "body": "Changing commit from \"f81a1cca7435cb65ad8bb3c1e96361d3f34ecc67\" to \"c76dbda5a4ed50fb8f71b3af11e387c647c5bc6b\"",
    "created_at": "2022-06-25T06:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678612",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f81a1cca7435cb65ad8bb3c1e96361d3f34ecc67" to "c76dbda5a4ed50fb8f71b3af11e387c647c5bc6b"



---

archive/issue_comments_678613.json:
```json
{
    "body": "<a id='comment:8'></a>done, but the Fricas interface still breaks on hypergeometric functions, which use \"CONSTRUCT\" with an arbirary number of arguments.",
    "created_at": "2022-06-25T06:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678613",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>done, but the Fricas interface still breaks on hypergeometric functions, which use "CONSTRUCT" with an arbirary number of arguments.



---

archive/issue_comments_678614.json:
```json
{
    "body": "<a id='comment:9'></a>I am currently rebuilding sage with this ticket.\n\nI do not know (please take this literally, not as criticism) whether having to specify the number of arguments is the best approach.\n\nI guess it should be possible to allow for functions with an arbitrary number of arguments, eg. by specifying `None` instead.  However, FriCAS itself actually does not allow this.  I have to sort out whether `construct` is special, or whether it does fit into the usual scheme.",
    "created_at": "2022-06-25T07:22:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678614",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'></a>I am currently rebuilding sage with this ticket.

I do not know (please take this literally, not as criticism) whether having to specify the number of arguments is the best approach.

I guess it should be possible to allow for functions with an arbitrary number of arguments, eg. by specifying `None` instead.  However, FriCAS itself actually does not allow this.  I have to sort out whether `construct` is special, or whether it does fit into the usual scheme.



---

archive/issue_comments_678615.json:
```json
{
    "body": "<a id='comment:10'></a>I guess the following is the easy fix.\n\n```diff\ndiff --git a/src/sage/interfaces/fricas.py b/src/sage/interfaces/fricas.py\nindex 19a56c062f4..671b4d2d085 100644\n--- a/src/sage/interfaces/fricas.py\n+++ b/src/sage/interfaces/fricas.py\n@@ -1367,7 +1367,10 @@ class FriCASElement(ExpectElement):\n         try:\n             fun = symbol_table[\"fricas\"][(fun_string, len(args))]\n         except KeyError:\n-            fun = function(fun_string)\n+            try:\n+                fun = symbol_table[\"fricas\"][(fun_string, -1)]\n+            except KeyError:\n+                fun = function(fun_string)\n         return fun(*args), a\n \n     @staticmethod\n```",
    "created_at": "2022-06-25T08:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678615",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:10'></a>I guess the following is the easy fix.

```diff
diff --git a/src/sage/interfaces/fricas.py b/src/sage/interfaces/fricas.py
index 19a56c062f4..671b4d2d085 100644
--- a/src/sage/interfaces/fricas.py
+++ b/src/sage/interfaces/fricas.py
@@ -1367,7 +1367,10 @@ class FriCASElement(ExpectElement):
         try:
             fun = symbol_table["fricas"][(fun_string, len(args))]
         except KeyError:
-            fun = function(fun_string)
+            try:
+                fun = symbol_table["fricas"][(fun_string, -1)]
+            except KeyError:
+                fun = function(fun_string)
         return fun(*args), a
 
     @staticmethod
```



---

archive/issue_comments_678616.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-25T11:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_678617.json:
```json
{
    "body": "Changing commit from \"c76dbda5a4ed50fb8f71b3af11e387c647c5bc6b\" to \"c0bbbe49fc41e1c841521628683c614d944e06e2\"",
    "created_at": "2022-06-25T11:56:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678617",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c76dbda5a4ed50fb8f71b3af11e387c647c5bc6b" to "c0bbbe49fc41e1c841521628683c614d944e06e2"



---

archive/issue_comments_678618.json:
```json
{
    "body": "<a id='comment:12'></a>now maple interface needs to be repaired",
    "created_at": "2022-06-26T10:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678618",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>now maple interface needs to be repaired



---

archive/issue_comments_678619.json:
```json
{
    "body": "<a id='comment:13'></a>I don't have access to maple, sorry.",
    "created_at": "2022-06-26T10:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678619",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:13'></a>I don't have access to maple, sorry.



---

archive/issue_comments_678620.json:
```json
{
    "body": "Changing commit from \"c0bbbe49fc41e1c841521628683c614d944e06e2\" to \"895683e2f927d27524ff11f80e4ceaeb70cfaa69\"",
    "created_at": "2022-06-26T10:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678620",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c0bbbe49fc41e1c841521628683c614d944e06e2" to "895683e2f927d27524ff11f80e4ceaeb70cfaa69"



---

archive/issue_comments_678621.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-26T10:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678621",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_678622.json:
```json
{
    "body": "<a id='comment:15'></a>maple interface now fixed. Somebody needs to check the mathematica back-conversion, please.",
    "created_at": "2022-06-26T11:05:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678622",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>maple interface now fixed. Somebody needs to check the mathematica back-conversion, please.



---

archive/issue_comments_678623.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-26T18:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_678624.json:
```json
{
    "body": "Changing commit from \"895683e2f927d27524ff11f80e4ceaeb70cfaa69\" to \"ac8fbb128cdb9b63a1ead6ea30ea58873e943948\"",
    "created_at": "2022-06-26T18:36:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "895683e2f927d27524ff11f80e4ceaeb70cfaa69" to "ac8fbb128cdb9b63a1ead6ea30ea58873e943948"



---

archive/issue_comments_678625.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-06-26T21:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678625",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_678626.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:15 chapoton]:\n> maple interface now fixed. Somebody needs to check the mathematica back-conversion, please.\n\n\nWell...\n\n```\ncharpent@zen-book-flip:/usr/local/sage-9$ sage -t src/sage/interfaces/mathematica.py \nRunning doctests with ID 2022-06-26-23-17-49-22d13eec.\nGit branch: t/34062/34062\nGit ref: 9.7.beta3-7-gac8fbb128cd\nRunning with SAGE_LOCAL='/usr/local/sage-9/local' and SAGE_VENV='/usr/local/sage-9/local/var/lib/sage/venv-python3.10'\nUsing --optional=debian,dot2tex,fricas,gap_packages,libsemigroups,mathics,mathics_scanner,palettable,pint,pip,pysingular,sage,sage_spkg\nFeatures to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,gfan,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,msolve,nauty,palp,pandoc,pdf2svg,pdftocairo,phitigra,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib\nDoctesting 1 file.\nTraceback (most recent call last):\n  File \"/usr/local/sage-9/src/bin/sage-runtests\", line 153, in <module>\n    err = DC.run()\n  File \"/usr/local/sage-9/src/sage/doctest/control.py\", line 1376, in run\n    self.run_doctests()\n  File \"/usr/local/sage-9/src/sage/doctest/control.py\", line 1052, in run_doctests\n    self.dispatcher = DocTestDispatcher(self)\n  File \"/usr/local/sage-9/src/sage/doctest/forker.py\", line 1626, in __init__\n    init_sage(controller)\n  File \"/usr/local/sage-9/src/sage/doctest/forker.py\", line 193, in init_sage\n    controller.load_environment()\n  File \"/usr/local/sage-9/src/sage/doctest/control.py\", line 589, in load_environment\n    return import_module(self.options.environment)\n  File \"/usr/lib/python3.10/importlib/__init__.py\", line 126, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"<frozen importlib._bootstrap>\", line 1050, in _gcd_import\n  File \"<frozen importlib._bootstrap>\", line 1027, in _find_and_load\n  File \"<frozen importlib._bootstrap>\", line 1006, in _find_and_load_unlocked\n  File \"<frozen importlib._bootstrap>\", line 688, in _load_unlocked\n  File \"<frozen importlib._bootstrap_external>\", line 883, in exec_module\n  File \"<frozen importlib._bootstrap>\", line 241, in _call_with_frames_removed\n  File \"/usr/local/sage-9/src/sage/repl/ipython_kernel/all_jupyter.py\", line 5, in <module>\n    from sage.all_cmdline import *\n  File \"/usr/local/sage-9/src/sage/all_cmdline.py\", line 19, in <module>\n    from sage.all import *\n  File \"/usr/local/sage-9/src/sage/all.py\", line 135, in <module>\n    from sage.symbolic.all   import *\n  File \"/usr/local/sage-9/src/sage/symbolic/all.py\", line 10, in <module>\n    from .constants import (pi, e, NaN, golden_ratio, log2, euler_gamma, catalan,\n  File \"/usr/local/sage-9/src/sage/symbolic/constants.py\", line 231, in <module>\n    register_symbol(infinity, {'maxima':'inf'}, 0)\n  File \"sage/symbolic/pynac_impl.pxi\", line 2375, in sage.symbolic.expression.register_symbol\nTypeError: register_symbol() takes exactly 2 positional arguments (3 given)\n```\n\n==> `needs_work`",
    "created_at": "2022-06-26T21:22:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678626",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:17'></a>Replying to [comment:15 chapoton]:
> maple interface now fixed. Somebody needs to check the mathematica back-conversion, please.


Well...

```
charpent@zen-book-flip:/usr/local/sage-9$ sage -t src/sage/interfaces/mathematica.py 
Running doctests with ID 2022-06-26-23-17-49-22d13eec.
Git branch: t/34062/34062
Git ref: 9.7.beta3-7-gac8fbb128cd
Running with SAGE_LOCAL='/usr/local/sage-9/local' and SAGE_VENV='/usr/local/sage-9/local/var/lib/sage/venv-python3.10'
Using --optional=debian,dot2tex,fricas,gap_packages,libsemigroups,mathics,mathics_scanner,palettable,pint,pip,pysingular,sage,sage_spkg
Features to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,gfan,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,msolve,nauty,palp,pandoc,pdf2svg,pdftocairo,phitigra,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib
Doctesting 1 file.
Traceback (most recent call last):
  File "/usr/local/sage-9/src/bin/sage-runtests", line 153, in <module>
    err = DC.run()
  File "/usr/local/sage-9/src/sage/doctest/control.py", line 1376, in run
    self.run_doctests()
  File "/usr/local/sage-9/src/sage/doctest/control.py", line 1052, in run_doctests
    self.dispatcher = DocTestDispatcher(self)
  File "/usr/local/sage-9/src/sage/doctest/forker.py", line 1626, in __init__
    init_sage(controller)
  File "/usr/local/sage-9/src/sage/doctest/forker.py", line 193, in init_sage
    controller.load_environment()
  File "/usr/local/sage-9/src/sage/doctest/control.py", line 589, in load_environment
    return import_module(self.options.environment)
  File "/usr/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/usr/local/sage-9/src/sage/repl/ipython_kernel/all_jupyter.py", line 5, in <module>
    from sage.all_cmdline import *
  File "/usr/local/sage-9/src/sage/all_cmdline.py", line 19, in <module>
    from sage.all import *
  File "/usr/local/sage-9/src/sage/all.py", line 135, in <module>
    from sage.symbolic.all   import *
  File "/usr/local/sage-9/src/sage/symbolic/all.py", line 10, in <module>
    from .constants import (pi, e, NaN, golden_ratio, log2, euler_gamma, catalan,
  File "/usr/local/sage-9/src/sage/symbolic/constants.py", line 231, in <module>
    register_symbol(infinity, {'maxima':'inf'}, 0)
  File "sage/symbolic/pynac_impl.pxi", line 2375, in sage.symbolic.expression.register_symbol
TypeError: register_symbol() takes exactly 2 positional arguments (3 given)
```

==> `needs_work`



---

archive/issue_comments_678627.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 charpent]:\n> Replying to [comment:15 chapoton]:\n\n\n[ Snip... ]\n\n> ==> `needs_work`\n\n\nWell... `configure --enable-editable` wasn('t sufficint in this case. After re-`make`ing :\n\n```\ncharpent@zen-book-flip:/usr/local/sage-9$ sage -t src/sage/interfaces/mathematica.py \nRunning doctests with ID 2022-06-26-23-34-51-5fc132c3.\nGit branch: t/34062/34062\nGit ref: 9.7.beta3-7-gac8fbb128cd\nRunning with SAGE_LOCAL='/usr/local/sage-9/local' and SAGE_VENV='/usr/local/sage-9/local/var/lib/sage/venv-python3.10'\nUsing --optional=debian,dot2tex,fricas,gap_packages,libsemigroups,mathics,mathics_scanner,palettable,pint,pip,pysingular,sage,sage_spkg\nFeatures to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,gfan,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,msolve,nauty,palp,pandoc,pdf2svg,pdftocairo,phitigra,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib\nDoctesting 1 file.\nsage -t --warn-long 194.5 --random-seed=217146151663288597630828810215703796564 src/sage/interfaces/mathematica.py\n    [25 tests, 0.05 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 5.1 seconds\n    cpu time: 0.0 seconds\n    cumulative wall time: 0.0 seconds\nFeatures detected for doctesting: \npytest is not installed in the venv, skip checking tests that rely on it\n```\n\n==> `needs_review`. Sorry for the noise...\n\n`ptestlong` underway. Stay tuned.",
    "created_at": "2022-06-26T21:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678627",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:18'></a>Replying to [comment:17 charpent]:
> Replying to [comment:15 chapoton]:


[ Snip... ]

> ==> `needs_work`


Well... `configure --enable-editable` wasn('t sufficint in this case. After re-`make`ing :

```
charpent@zen-book-flip:/usr/local/sage-9$ sage -t src/sage/interfaces/mathematica.py 
Running doctests with ID 2022-06-26-23-34-51-5fc132c3.
Git branch: t/34062/34062
Git ref: 9.7.beta3-7-gac8fbb128cd
Running with SAGE_LOCAL='/usr/local/sage-9/local' and SAGE_VENV='/usr/local/sage-9/local/var/lib/sage/venv-python3.10'
Using --optional=debian,dot2tex,fricas,gap_packages,libsemigroups,mathics,mathics_scanner,palettable,pint,pip,pysingular,sage,sage_spkg
Features to be detected: 4ti2,benzene,bliss,buckygen,conway_polynomials,csdp,database_cremona_ellcurve,database_cremona_mini_ellcurve,database_jones_numfield,database_knotinfo,dvipng,gfan,graphviz,imagemagick,jupymake,kenzo,latte_int,lrslib,mcqd,meataxe,msolve,nauty,palp,pandoc,pdf2svg,pdftocairo,phitigra,plantri,polytopes_db,polytopes_db_4d,pynormaliz,python_igraph,rubiks,sage.combinat,sage.geometry.polyhedron,sage.graphs,sage.groups,sage.plot,sage.rings.number_field,sage.rings.padics,sage.rings.real_double,sage.symbolic,sage_numerical_backends_coin,sagemath_doc_html,sphinx,tdlib
Doctesting 1 file.
sage -t --warn-long 194.5 --random-seed=217146151663288597630828810215703796564 src/sage/interfaces/mathematica.py
    [25 tests, 0.05 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 5.1 seconds
    cpu time: 0.0 seconds
    cumulative wall time: 0.0 seconds
Features detected for doctesting: 
pytest is not installed in the venv, skip checking tests that rely on it
```

==> `needs_review`. Sorry for the noise...

`ptestlong` underway. Stay tuned.



---

archive/issue_comments_678628.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-06-26T21:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678628",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_678629.json:
```json
{
    "body": "<a id='comment:19'></a>`ptestlong` gets the same failures as it does on `develop`.\n\n==>`positive_review`.\n\nI suggest a further check against the Wolfram engine before proceeding, but can't do that for to days (at least).\n\nHTH,",
    "created_at": "2022-06-27T03:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678629",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:19'></a>`ptestlong` gets the same failures as it does on `develop`.

==>`positive_review`.

I suggest a further check against the Wolfram engine before proceeding, but can't do that for to days (at least).

HTH,



---

archive/issue_comments_678630.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-06-27T03:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678630",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_678631.json:
```json
{
    "body": "<a id='comment:20'></a>Reviewer name",
    "created_at": "2022-06-27T03:21:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678631",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'></a>Reviewer name



---

archive/issue_comments_678632.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Emmanuel Charpentier\"",
    "created_at": "2022-06-27T06:06:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678632",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

Changing reviewer from "" to "Emmanuel Charpentier"



---

archive/issue_comments_678633.json:
```json
{
    "body": "<a id='comment:21'></a>Wups !Again...",
    "created_at": "2022-06-27T06:06:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678633",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<a id='comment:21'></a>Wups !Again...



---

archive/issue_comments_678634.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-09T22:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678634",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_678635.json:
```json
{
    "body": "Changing branch from \"u/chapoton/34062\" to \"ac8fbb128cdb9b63a1ead6ea30ea58873e943948\"",
    "created_at": "2022-07-09T22:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34062#issuecomment-678635",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/34062" to "ac8fbb128cdb9b63a1ead6ea30ea58873e943948"



---

archive/issue_events_089075.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-07-09T22:32:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34062",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34062#event-89075"
}
```
