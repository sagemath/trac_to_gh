# Issue 34615: Update to sphinx 5.2

archive/issues_034378.json:
```json
{
    "body": "New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.\n\nTherefore we think it is time to upgrade sphinx in sage.\n\nThe ticket update \n* sphinx to 5.2.3 \n* sphinxcontrib_websupport to 1.2.4 (no other sphinxcontrib package seem out of date)\n* imagesize to 1.4.1 (required dependency)\n\n**CC:**  @kiwifb\n\n**Branch:** [8f8af65e54d3a9962cfab40f15dc23f4e955b43f](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)\n\n**Reviewer:** Kwankyu Lee\n\n**Author:** Antonio Rojas, Fran\u00e7ois Bissey\n\nIssue created by migration from https://trac.sagemath.org/ticket/34615\n\n",
    "closed_at": "2022-10-16T22:15:42Z",
    "created_at": "2022-09-29T19:24:08Z",
    "labels": [
        "component: build",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "title": "Update to sphinx 5.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/34615",
    "user": "https://github.com/antonio-rojas"
}
```
New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.

Therefore we think it is time to upgrade sphinx in sage.

The ticket update 
* sphinx to 5.2.3 
* sphinxcontrib_websupport to 1.2.4 (no other sphinxcontrib package seem out of date)
* imagesize to 1.4.1 (required dependency)

**CC:**  @kiwifb

**Branch:** [8f8af65e54d3a9962cfab40f15dc23f4e955b43f](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)

**Reviewer:** Kwankyu Lee

**Author:** Antonio Rojas, Fran√ßois Bissey

Issue created by migration from https://trac.sagemath.org/ticket/34615





---

archive/issue_comments_561491.json:
```json
{
    "body": "**Branch:** [u/arojas/fix_build_with_sphinx_5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/fix_build_with_sphinx_5_2)",
    "created_at": "2022-09-29T19:24:44Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561491",
    "user": "https://github.com/antonio-rojas"
}
```

**Branch:** [u/arojas/fix_build_with_sphinx_5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/fix_build_with_sphinx_5_2)



---

archive/issue_comments_561492.json:
```json
{
    "body": "**Commit:** [c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb](https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb)",
    "created_at": "2022-09-29T19:29:14Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561492",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb](https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb)



---

archive/issue_comments_561493.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb\">c2e610c</a></td><td><code>Fix build with sphinx 5.2</code></td></tr></table>\n",
    "created_at": "2022-09-29T19:29:14Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561493",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb">c2e610c</a></td><td><code>Fix build with sphinx 5.2</code></td></tr></table>




---

archive/issue_events_307037.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T19:31:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307037"
}
```



---

archive/issue_comments_561494.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Still works with older sphinx (surprisingly)\n``````\n",
    "created_at": "2022-09-29T19:31:11Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561494",
    "user": "https://github.com/antonio-rojas"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Still works with older sphinx (surprisingly)
``````




---

archive/issue_comments_561495.json:
```json
{
    "body": "**Author:** Antonio Rojas",
    "created_at": "2022-09-29T19:31:11Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561495",
    "user": "https://github.com/antonio-rojas"
}
```

**Author:** Antonio Rojas



---

archive/issue_events_307038.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T19:31:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "component: build",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307038"
}
```



---

archive/issue_events_307039.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T19:31:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307039"
}
```



---

archive/issue_comments_561496.json:
```json
{
    "body": "<a id='comment:4'></a>\nI haven't been pushed to 5.2 yet, so I haven't seen it. Although I could have had reports. This is quite different from the previous fix we pushed. Was it supposed to be implicit in older version of sphinx.",
    "created_at": "2022-09-29T19:47:50Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561496",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
I haven't been pushed to 5.2 yet, so I haven't seen it. Although I could have had reports. This is quite different from the previous fix we pushed. Was it supposed to be implicit in older version of sphinx.



---

archive/issue_comments_561497.json:
```json
{
    "body": "<a id='comment:5'></a>\nNo, this is a new attribute in 5.2. That's why I was surprised this still works with older sphinx\n\nhttps://github.com/sphinx-doc/sphinx/commit/7da60f23539bd5d1a79bdbcf67cd5164311182b7",
    "created_at": "2022-09-29T19:58:16Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561497",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:5'></a>
No, this is a new attribute in 5.2. That's why I was surprised this still works with older sphinx

https://github.com/sphinx-doc/sphinx/commit/7da60f23539bd5d1a79bdbcf67cd5164311182b7



---

archive/issue_events_307040.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T20:03:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307040"
}
```



---

archive/issue_events_307041.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T20:03:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307041"
}
```



---

archive/issue_comments_561498.json:
```json
{
    "body": "<a id='comment:6'></a>\nAh, no. It does throw errors with older sphinx, although docs still seem to build fine.",
    "created_at": "2022-09-29T20:03:09Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561498",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:6'></a>
Ah, no. It does throw errors with older sphinx, although docs still seem to build fine.



---

archive/issue_comments_561499.json:
```json
{
    "body": "<a id='comment:7'></a>\nI suggest we take the opportunity to upgrade sphinx in sage itself then. I didn't do it for 5.1 and that may have been lazy on my part :)",
    "created_at": "2022-09-29T20:05:12Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561499",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
I suggest we take the opportunity to upgrade sphinx in sage itself then. I didn't do it for 5.1 and that may have been lazy on my part :)



---

archive/issue_comments_561500.json:
```json
{
    "body": "**Changing commit** from \"[c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb](https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb)\" to \"[0be8a8fa6ccea5c8514828913757be9c4da86062](https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062)\".",
    "created_at": "2022-09-29T21:00:58Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561500",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb](https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb)" to "[0be8a8fa6ccea5c8514828913757be9c4da86062](https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062)".



---

archive/issue_comments_561501.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062\">0be8a8f</a></td><td><code>Update sphinx to 5.2</code></td></tr></table>\n",
    "created_at": "2022-09-29T21:00:58Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561501",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062">0be8a8f</a></td><td><code>Update sphinx to 5.2</code></td></tr></table>




---

archive/issue_events_307042.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-09-29T21:15:48Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "rename": {
        "from": "Fix build with sphinx 5.2",
        "to": "Update to sphinx 5.2"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307042"
}
```



---

archive/issue_comments_561502.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-Still works with older sphinx (surprisingly)\n+New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.\n+\n+Therefore we think it is time to upgrade sphinx in sage.\n``````\n",
    "created_at": "2022-09-29T21:15:48Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561502",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-Still works with older sphinx (surprisingly)
+New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.
+
+Therefore we think it is time to upgrade sphinx in sage.
``````




---

archive/issue_comments_561503.json:
```json
{
    "body": "<a id='comment:9'></a>\nI am busy this morning but if you don't do more, I'll look at the sphinx contribution packages that may need updating or- be added to sage.",
    "created_at": "2022-09-29T21:15:48Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561503",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
I am busy this morning but if you don't do more, I'll look at the sphinx contribution packages that may need updating or- be added to sage.



---

archive/issue_comments_561504.json:
```json
{
    "body": "<a id='comment:10'></a>\nEverything builds fine and docs look OK",
    "created_at": "2022-09-30T06:00:23Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561504",
    "user": "https://github.com/antonio-rojas"
}
```

<a id='comment:10'></a>
Everything builds fine and docs look OK



---

archive/issue_events_307043.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-30T06:00:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307043"
}
```



---

archive/issue_events_307044.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-30T06:00:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307044"
}
```



---

archive/issue_comments_561505.json:
```json
{
    "body": "<a id='comment:11'></a>\nAfter looking more closely, only sphinxcontrib_websupport would need a version bump.",
    "created_at": "2022-10-05T09:25:18Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561505",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>
After looking more closely, only sphinxcontrib_websupport would need a version bump.



---

archive/issue_comments_561506.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.\n \n Therefore we think it is time to upgrade sphinx in sage.\n+\n+The ticket update sphinx to 5.2.0 and sphinxcontrib_websupport to 1.2.4 (no other sphinx package need updating).\n``````\n",
    "created_at": "2022-10-05T09:59:31Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561506",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.
 
 Therefore we think it is time to upgrade sphinx in sage.
+
+The ticket update sphinx to 5.2.0 and sphinxcontrib_websupport to 1.2.4 (no other sphinx package need updating).
``````




---

archive/issue_comments_561507.json:
```json
{
    "body": "**Changing commit** from \"[0be8a8fa6ccea5c8514828913757be9c4da86062](https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062)\" to \"[4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1](https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1)\".",
    "created_at": "2022-10-05T09:59:31Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561507",
    "user": "https://github.com/kiwifb"
}
```

**Changing commit** from "[0be8a8fa6ccea5c8514828913757be9c4da86062](https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062)" to "[4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1](https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1)".



---

archive/issue_comments_561508.json:
```json
{
    "body": "**Changing author** from \"Antonio Rojas\" to \"Antonio Rojas, Fran\u00e7ois Bissey\".",
    "created_at": "2022-10-05T09:59:31Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561508",
    "user": "https://github.com/kiwifb"
}
```

**Changing author** from "Antonio Rojas" to "Antonio Rojas, Fran√ßois Bissey".



---

archive/issue_comments_561509.json:
```json
{
    "body": "**Changing branch** from \"[u/arojas/fix_build_with_sphinx_5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/fix_build_with_sphinx_5_2)\" to \"[u/fbissey/sphinx5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sphinx5_2)\".",
    "created_at": "2022-10-05T09:59:31Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561509",
    "user": "https://github.com/kiwifb"
}
```

**Changing branch** from "[u/arojas/fix_build_with_sphinx_5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/fix_build_with_sphinx_5_2)" to "[u/fbissey/sphinx5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sphinx5_2)".



---

archive/issue_comments_561510.json:
```json
{
    "body": "<a id='comment:12'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1\">4a8c2b2</a></td><td><code>update sphinxcontrib_websupport to latest</code></td></tr></table>\n",
    "created_at": "2022-10-05T09:59:31Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561510",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:12'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1">4a8c2b2</a></td><td><code>update sphinxcontrib_websupport to latest</code></td></tr></table>




---

archive/issue_comments_561511.json:
```json
{
    "body": "<a id='comment:13'></a>\nOn macos, with the ticket branch merged to the develop branch, I encountered\n\n```\n[sagemath_doc_html-none]     raise DistributionNotFound(req, requirers)\n[sagemath_doc_html-none] pkg_resources.DistributionNotFound: The 'imagesize>=1.3'\n distribution was not found and is required by sphinx\n```",
    "created_at": "2022-10-07T13:42:11Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561511",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:13'></a>
On macos, with the ticket branch merged to the develop branch, I encountered

```
[sagemath_doc_html-none]     raise DistributionNotFound(req, requirers)
[sagemath_doc_html-none] pkg_resources.DistributionNotFound: The 'imagesize>=1.3'
 distribution was not found and is required by sphinx
```



---

archive/issue_comments_561512.json:
```json
{
    "body": "<a id='comment:14'></a>\nUpgrading to `imagesize-1.4.1` the latest gets it rolling.",
    "created_at": "2022-10-07T13:47:05Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561512",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:14'></a>
Upgrading to `imagesize-1.4.1` the latest gets it rolling.



---

archive/issue_comments_561513.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [Kwankyu Lee](#comment%3A14):\n> Upgrading to `imagesize-1.4.1` the latest gets it rolling.\n\n\nIt ended up successfully, and the built documents look good.",
    "created_at": "2022-10-07T20:28:05Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561513",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:15'></a>
Replying to [Kwankyu Lee](#comment%3A14):
> Upgrading to `imagesize-1.4.1` the latest gets it rolling.


It ended up successfully, and the built documents look good.



---

archive/issue_comments_561514.json:
```json
{
    "body": "<a id='comment:17'></a>\nYou are right, the version of imagesize was way to low in sage (1.2). Updating now.",
    "created_at": "2022-10-09T21:48:19Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561514",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>
You are right, the version of imagesize was way to low in sage (1.2). Updating now.



---

archive/issue_comments_561515.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5cf583646a4d990d3e5d3163ba7c620a1712f141\">5cf5836</a></td><td><code>update imagesize to 1.4.1. Minimum required for sphinx 5.2 is 1.3.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f\">8f8af65</a></td><td><code>update sphinx to 5.2.3</code></td></tr></table>\n",
    "created_at": "2022-10-09T21:58:18Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561515",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5cf583646a4d990d3e5d3163ba7c620a1712f141">5cf5836</a></td><td><code>update imagesize to 1.4.1. Minimum required for sphinx 5.2 is 1.3.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f">8f8af65</a></td><td><code>update sphinx to 5.2.3</code></td></tr></table>




---

archive/issue_comments_561516.json:
```json
{
    "body": "**Changing commit** from \"[4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1](https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1)\" to \"[8f8af65e54d3a9962cfab40f15dc23f4e955b43f](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)\".",
    "created_at": "2022-10-09T21:58:18Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561516",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1](https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1)" to "[8f8af65e54d3a9962cfab40f15dc23f4e955b43f](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)".



---

archive/issue_comments_561517.json:
```json
{
    "body": "<a id='comment:19'></a>\nUpdated imagesize and pushed sphinx to 5.2.3.",
    "created_at": "2022-10-09T22:00:33Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561517",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
Updated imagesize and pushed sphinx to 5.2.3.



---

archive/issue_comments_561518.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,4 +2,7 @@\n \n Therefore we think it is time to upgrade sphinx in sage.\n \n-The ticket update sphinx to 5.2.0 and sphinxcontrib_websupport to 1.2.4 (no other sphinx package need updating).\n+The ticket update \n+* sphinx to 5.2.3 \n+* sphinxcontrib_websupport to 1.2.4 (no other sphinxcontrib package seem out of date)\n+* imagesize to 1.4.1 (required dependency)\n``````\n",
    "created_at": "2022-10-09T22:00:33Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561518",
    "user": "https://github.com/kiwifb"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,4 +2,7 @@
 
 Therefore we think it is time to upgrade sphinx in sage.
 
-The ticket update sphinx to 5.2.0 and sphinxcontrib_websupport to 1.2.4 (no other sphinx package need updating).
+The ticket update 
+* sphinx to 5.2.3 
+* sphinxcontrib_websupport to 1.2.4 (no other sphinxcontrib package seem out of date)
+* imagesize to 1.4.1 (required dependency)
``````




---

archive/issue_comments_561519.json:
```json
{
    "body": "<a id='comment:20'></a>\nThanks.\n\nIt works well and looks good to me.",
    "created_at": "2022-10-10T02:09:19Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561519",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:20'></a>
Thanks.

It works well and looks good to me.



---

archive/issue_comments_561520.json:
```json
{
    "body": "**Reviewer:** Kwankyu Lee",
    "created_at": "2022-10-10T02:09:19Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561520",
    "user": "https://github.com/kwankyu"
}
```

**Reviewer:** Kwankyu Lee



---

archive/issue_events_307045.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-10-10T02:09:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307045"
}
```



---

archive/issue_events_307046.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-10-10T02:09:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307046"
}
```



---

archive/issue_events_307047.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-16T22:15:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307047"
}
```



---

archive/issue_events_307048.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-16T22:15:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-307048"
}
```



---

archive/issue_comments_561521.json:
```json
{
    "body": "**Changing branch** from \"[u/fbissey/sphinx5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sphinx5_2)\" to \"[8f8af65e54d3a9962cfab40f15dc23f4e955b43f](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)\".",
    "created_at": "2022-10-16T22:15:42Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561521",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/fbissey/sphinx5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sphinx5_2)" to "[8f8af65e54d3a9962cfab40f15dc23f4e955b43f](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)".



---

archive/issue_comments_561522.json:
```json
{
    "body": "<a id='comment:22'></a>\nThis upgrade seems to have introduced an unpleasant change of doc appearance. Compare\n\nhttps://8f8af65e54d3a9962cfab40f15dc23f4e955b43f--sagemath-tobias.netlify.app/reference/curves/index.html\n\nwith\n\nhttps://doc.sagemath.org/html/en/reference/curves/index.html\n\nSee all the second-level headings. Those weren't before.",
    "created_at": "2022-10-24T06:18:54Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561522",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:22'></a>
This upgrade seems to have introduced an unpleasant change of doc appearance. Compare

https://8f8af65e54d3a9962cfab40f15dc23f4e955b43f--sagemath-tobias.netlify.app/reference/curves/index.html

with

https://doc.sagemath.org/html/en/reference/curves/index.html

See all the second-level headings. Those weren't before.



---

archive/issue_comments_561523.json:
```json
{
    "body": "**Changing commit** from \"[8f8af65e54d3a9962cfab40f15dc23f4e955b43f](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)\" to \"\".",
    "created_at": "2022-10-24T06:18:54Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561523",
    "user": "https://github.com/kwankyu"
}
```

**Changing commit** from "[8f8af65e54d3a9962cfab40f15dc23f4e955b43f](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)" to "".



---

archive/issue_comments_561524.json:
```json
{
    "body": "<a id='comment:23'></a>\nI suspect that the upgrade does not work well with sage's custom `autodoc`.",
    "created_at": "2022-10-25T01:31:05Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561524",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:23'></a>
I suspect that the upgrade does not work well with sage's custom `autodoc`.



---

archive/issue_comments_561525.json:
```json
{
    "body": "<a id='comment:24'></a>\nPossibly, it is hardly news that we should get rid of it as quickly as we can. I wanted to ask whether you had an idea why there are subsection for say \"plane conics\" but not \"curves\"? When I tried to post yesterday, trac was in maintenance :(",
    "created_at": "2022-10-25T01:34:06Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561525",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:24'></a>
Possibly, it is hardly news that we should get rid of it as quickly as we can. I wanted to ask whether you had an idea why there are subsection for say "plane conics" but not "curves"? When I tried to post yesterday, trac was in maintenance :(



---

archive/issue_comments_561526.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [Fran\u00e7ois Bissey](#comment%3A24):\n> Possibly, it is hardly news that we should get rid of it as quickly as we can. \n\n\nI agree! But that seems a formidable task (unless we just leave the consequential \"broken doc\" at it is).\n\n> I wanted to ask whether you had an idea why there are subsection for say \"plane conics\" but not \"curves\"?\n\n\nIt is because of the `maxdepth: 2`. See \n\n```\nPlane conics\n============\n\n.. toctree::\n   :maxdepth: 2 \n```\nHence it is normal. The real problem seems that definitions doc is regarded as content headings. I don't know if this is a feature of the upgraded sphinx or a problem of `sage_autodoc`...",
    "created_at": "2022-10-25T02:32:12Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561526",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:25'></a>
Replying to [Fran√ßois Bissey](#comment%3A24):
> Possibly, it is hardly news that we should get rid of it as quickly as we can. 


I agree! But that seems a formidable task (unless we just leave the consequential "broken doc" at it is).

> I wanted to ask whether you had an idea why there are subsection for say "plane conics" but not "curves"?


It is because of the `maxdepth: 2`. See 

```
Plane conics
============

.. toctree::
   :maxdepth: 2 
```
Hence it is normal. The real problem seems that definitions doc is regarded as content headings. I don't know if this is a feature of the upgraded sphinx or a problem of `sage_autodoc`...



---

archive/issue_comments_561527.json:
```json
{
    "body": "<a id='comment:26'></a>\nA simple and laborious solution would be to change all affected `maxdepth: 2` to `maxdepth: 1`. This seems also a correct solution. Then we can avoid touching `sage_autodoc` :)",
    "created_at": "2022-10-25T04:00:20Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561527",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:26'></a>
A simple and laborious solution would be to change all affected `maxdepth: 2` to `maxdepth: 1`. This seems also a correct solution. Then we can avoid touching `sage_autodoc` :)



---

archive/issue_comments_561528.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [Kwankyu Lee](#comment%3A26):\n> A simple and laborious solution would be to change all affected `maxdepth: 2` to `maxdepth: 1`. This seems also a correct solution. Then we can avoid touching `sage_autodoc` :)\n\n\nThis certainly does not solve all problems. See the \"Contents\" on the right\n\nhttps://8f8af65e54d3a9962cfab40f15dc23f4e955b43f--sagemath-tobias.netlify.app/reference/curves/sage/schemes/plane_conics/constructor.html",
    "created_at": "2022-10-25T08:43:21Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561528",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:27'></a>
Replying to [Kwankyu Lee](#comment%3A26):
> A simple and laborious solution would be to change all affected `maxdepth: 2` to `maxdepth: 1`. This seems also a correct solution. Then we can avoid touching `sage_autodoc` :)


This certainly does not solve all problems. See the "Contents" on the right

https://8f8af65e54d3a9962cfab40f15dc23f4e955b43f--sagemath-tobias.netlify.app/reference/curves/sage/schemes/plane_conics/constructor.html



---

archive/issue_comments_561529.json:
```json
{
    "body": "<a id='comment:28'></a>\nI don't think that's bad. It is on a static right space while the content is just in a middle frame. This really looks like a standard template. One I have seen in other places.\n\nOf course, if it is inconsistent with other pages, we have a problem.",
    "created_at": "2022-10-25T08:52:05Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561529",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:28'></a>
I don't think that's bad. It is on a static right space while the content is just in a middle frame. This really looks like a standard template. One I have seen in other places.

Of course, if it is inconsistent with other pages, we have a problem.



---

archive/issue_comments_561530.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [Fran\u00e7ois Bissey](#comment%3A28):\n> I don't think that's bad. It is on a static right space while the content is just in a middle frame. This really looks like a standard template. One I have seen in other places.\n\n\nObject definitions in TOC is a new standard feature of the upgraded Sphinx. But this changes our doc in an unintended way. This is fixed now in #34706. Needs review.",
    "created_at": "2022-10-31T04:57:22Z",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-561530",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:29'></a>
Replying to [Fran√ßois Bissey](#comment%3A28):
> I don't think that's bad. It is on a static right space while the content is just in a middle frame. This really looks like a standard template. One I have seen in other places.


Object definitions in TOC is a new standard feature of the upgraded Sphinx. But this changes our doc in an unintended way. This is fixed now in #34706. Needs review.
