# Issue 34615: Update to sphinx 5.2

archive/issues_034378.json:
```json
{
    "assignees": [],
    "body": "New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.\n\nTherefore we think it is time to upgrade sphinx in sage.\n\nThe ticket update \n* sphinx to 5.2.3 \n* sphinxcontrib_websupport to 1.2.4 (no other sphinxcontrib package seem out of date)\n* imagesize to 1.4.1 (required dependency)\n\nCC:  @kiwifb\n\nBranch: **[`8f8af65`](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)**\n\nReviewer: **Kwankyu Lee**\n\nAuthor: **Antonio Rojas, Fran\u00e7ois Bissey**\n\nComponent: **build**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34615_\n\n",
    "closed_at": "2022-10-16T22:15:42Z",
    "created_at": "2022-09-29T19:24:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update to sphinx 5.2",
    "type": "issue",
    "updated_at": "2022-10-31T04:57:22Z",
    "url": "https://github.com/sagemath/sage/issues/34615",
    "user": "https://github.com/antonio-rojas"
}
```
New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.

Therefore we think it is time to upgrade sphinx in sage.

The ticket update 
* sphinx to 5.2.3 
* sphinxcontrib_websupport to 1.2.4 (no other sphinxcontrib package seem out of date)
* imagesize to 1.4.1 (required dependency)

CC:  @kiwifb

Branch: **[`8f8af65`](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)**

Reviewer: **Kwankyu Lee**

Author: **Antonio Rojas, François Bissey**

Component: **build**

_Issue created by migration from https://trac.sagemath.org/ticket/34615_





---

archive/issue_events_468744.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T19:24:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468744"
}
```



---

archive/issue_events_468745.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T19:24:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468745"
}
```



---

archive/issue_comments_558951.json:
```json
{
    "body": "Branch: **[u/arojas/fix_build_with_sphinx_5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/fix_build_with_sphinx_5_2)**",
    "created_at": "2022-09-29T19:24:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558951",
    "user": "https://github.com/antonio-rojas"
}
```

Branch: **[u/arojas/fix_build_with_sphinx_5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/fix_build_with_sphinx_5_2)**



---

archive/issue_comments_558952.json:
```json
{
    "body": "Commit: **[`c2e610c`](https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb)**",
    "created_at": "2022-09-29T19:29:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558952",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`c2e610c`](https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb)**



---

archive/issue_comments_558953.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb\"><code>c2e610c</code></a></td><td><code>Fix build with sphinx 5.2</code></td></tr></table>\n",
    "created_at": "2022-09-29T19:29:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558953",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb"><code>c2e610c</code></a></td><td><code>Fix build with sphinx 5.2</code></td></tr></table>




---

archive/issue_events_468746.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T19:31:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468746"
}
```



---

archive/issue_comments_558954.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Still works with older sphinx (surprisingly)\n``````\n",
    "created_at": "2022-09-29T19:31:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558954",
    "user": "https://github.com/antonio-rojas"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Still works with older sphinx (surprisingly)
``````




---

archive/issue_comments_558955.json:
```json
{
    "body": "Author: **Antonio Rojas**",
    "created_at": "2022-09-29T19:31:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558955",
    "user": "https://github.com/antonio-rojas"
}
```

Author: **Antonio Rojas**



---

archive/issue_events_468747.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T19:31:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468747"
}
```



---

archive/issue_events_468748.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T19:31:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468748"
}
```



---

archive/issue_comments_558956.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI haven't been pushed to 5.2 yet, so I haven't seen it. Although I could have had reports. This is quite different from the previous fix we pushed. Was it supposed to be implicit in older version of sphinx.",
    "created_at": "2022-09-29T19:47:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558956",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:4" align="right">comment:4</div>

I haven't been pushed to 5.2 yet, so I haven't seen it. Although I could have had reports. This is quite different from the previous fix we pushed. Was it supposed to be implicit in older version of sphinx.



---

archive/issue_comments_558957.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nNo, this is a new attribute in 5.2. That's why I was surprised this still works with older sphinx\n\nhttps://github.com/sphinx-doc/sphinx/commit/7da60f23539bd5d1a79bdbcf67cd5164311182b7",
    "created_at": "2022-09-29T19:58:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558957",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:5" align="right">comment:5</div>

No, this is a new attribute in 5.2. That's why I was surprised this still works with older sphinx

https://github.com/sphinx-doc/sphinx/commit/7da60f23539bd5d1a79bdbcf67cd5164311182b7



---

archive/issue_events_468749.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T20:03:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468749"
}
```



---

archive/issue_events_468750.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-29T20:03:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468750"
}
```



---

archive/issue_comments_558958.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAh, no. It does throw errors with older sphinx, although docs still seem to build fine.",
    "created_at": "2022-09-29T20:03:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558958",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:6" align="right">comment:6</div>

Ah, no. It does throw errors with older sphinx, although docs still seem to build fine.



---

archive/issue_comments_558959.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI suggest we take the opportunity to upgrade sphinx in sage itself then. I didn't do it for 5.1 and that may have been lazy on my part :)",
    "created_at": "2022-09-29T20:05:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558959",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:7" align="right">comment:7</div>

I suggest we take the opportunity to upgrade sphinx in sage itself then. I didn't do it for 5.1 and that may have been lazy on my part :)



---

archive/issue_comments_558960.json:
```json
{
    "body": "Changed commit from **[`c2e610c`](https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb)** to **[`0be8a8f`](https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062)**",
    "created_at": "2022-09-29T21:00:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558960",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c2e610c`](https://github.com/sagemath/sagetrac-mirror/commit/c2e610cfba02a8cb4db7d7691bfc8210be8a1ffb)** to **[`0be8a8f`](https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062)**



---

archive/issue_comments_558961.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062\"><code>0be8a8f</code></a></td><td><code>Update sphinx to 5.2</code></td></tr></table>\n",
    "created_at": "2022-09-29T21:00:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558961",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062"><code>0be8a8f</code></a></td><td><code>Update sphinx to 5.2</code></td></tr></table>




---

archive/issue_events_468751.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2022-09-29T21:15:48Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "title_is": "Update to sphinx 5.2",
    "title_was": "Fix build with sphinx 5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468751"
}
```



---

archive/issue_comments_558962.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n-Still works with older sphinx (surprisingly)\n+New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.\n+\n+Therefore we think it is time to upgrade sphinx in sage.\n``````\n",
    "created_at": "2022-09-29T21:15:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558962",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
-Still works with older sphinx (surprisingly)
+New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.
+
+Therefore we think it is time to upgrade sphinx in sage.
``````




---

archive/issue_comments_558963.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI am busy this morning but if you don't do more, I'll look at the sphinx contribution packages that may need updating or- be added to sage.",
    "created_at": "2022-09-29T21:15:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558963",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

I am busy this morning but if you don't do more, I'll look at the sphinx contribution packages that may need updating or- be added to sage.



---

archive/issue_comments_558964.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nEverything builds fine and docs look OK",
    "created_at": "2022-09-30T06:00:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558964",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:10" align="right">comment:10</div>

Everything builds fine and docs look OK



---

archive/issue_events_468752.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-30T06:00:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468752"
}
```



---

archive/issue_events_468753.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2022-09-30T06:00:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468753"
}
```



---

archive/issue_comments_558965.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAfter looking more closely, only sphinxcontrib_websupport would need a version bump.",
    "created_at": "2022-10-05T09:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558965",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

After looking more closely, only sphinxcontrib_websupport would need a version bump.



---

archive/issue_comments_558966.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.\n \n Therefore we think it is time to upgrade sphinx in sage.\n+\n+The ticket update sphinx to 5.2.0 and sphinxcontrib_websupport to 1.2.4 (no other sphinx package need updating).\n``````\n",
    "created_at": "2022-10-05T09:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558966",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 New changes in sphinx requires new attributes to be defined. Supporting this change introduces non fatal error and warnings when building with older version of sphinx.
 
 Therefore we think it is time to upgrade sphinx in sage.
+
+The ticket update sphinx to 5.2.0 and sphinxcontrib_websupport to 1.2.4 (no other sphinx package need updating).
``````




---

archive/issue_comments_558967.json:
```json
{
    "body": "Changed commit from **[`0be8a8f`](https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062)** to **[`4a8c2b2`](https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1)**",
    "created_at": "2022-10-05T09:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558967",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[`0be8a8f`](https://github.com/sagemath/sagetrac-mirror/commit/0be8a8fa6ccea5c8514828913757be9c4da86062)** to **[`4a8c2b2`](https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1)**



---

archive/issue_comments_558968.json:
```json
{
    "body": "Changed author from **Antonio Rojas** to **Antonio Rojas, Fran\u00e7ois Bissey**",
    "created_at": "2022-10-05T09:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558968",
    "user": "https://github.com/kiwifb"
}
```

Changed author from **Antonio Rojas** to **Antonio Rojas, François Bissey**



---

archive/issue_comments_558969.json:
```json
{
    "body": "Changed branch from **[u/arojas/fix_build_with_sphinx_5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/fix_build_with_sphinx_5_2)** to **[u/fbissey/sphinx5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sphinx5_2)**",
    "created_at": "2022-10-05T09:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558969",
    "user": "https://github.com/kiwifb"
}
```

Changed branch from **[u/arojas/fix_build_with_sphinx_5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/fix_build_with_sphinx_5_2)** to **[u/fbissey/sphinx5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sphinx5_2)**



---

archive/issue_comments_558970.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1\"><code>4a8c2b2</code></a></td><td><code>update sphinxcontrib_websupport to latest</code></td></tr></table>\n",
    "created_at": "2022-10-05T09:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558970",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:12"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1"><code>4a8c2b2</code></a></td><td><code>update sphinxcontrib_websupport to latest</code></td></tr></table>




---

archive/issue_comments_558971.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nOn macos, with the ticket branch merged to the develop branch, I encountered\n\n```\n[sagemath_doc_html-none]     raise DistributionNotFound(req, requirers)\n[sagemath_doc_html-none] pkg_resources.DistributionNotFound: The 'imagesize>=1.3'\n distribution was not found and is required by sphinx\n```",
    "created_at": "2022-10-07T13:42:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558971",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:13" align="right">comment:13</div>

On macos, with the ticket branch merged to the develop branch, I encountered

```
[sagemath_doc_html-none]     raise DistributionNotFound(req, requirers)
[sagemath_doc_html-none] pkg_resources.DistributionNotFound: The 'imagesize>=1.3'
 distribution was not found and is required by sphinx
```



---

archive/issue_comments_558972.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nUpgrading to `imagesize-1.4.1` the latest gets it rolling.",
    "created_at": "2022-10-07T13:47:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558972",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:14" align="right">comment:14</div>

Upgrading to `imagesize-1.4.1` the latest gets it rolling.



---

archive/issue_comments_558973.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [Kwankyu Lee](#comment:14):\n> Upgrading to `imagesize-1.4.1` the latest gets it rolling.\n\nIt ended up successfully, and the built documents look good.",
    "created_at": "2022-10-07T20:28:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558973",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [Kwankyu Lee](#comment:14):
> Upgrading to `imagesize-1.4.1` the latest gets it rolling.

It ended up successfully, and the built documents look good.



---

archive/issue_comments_558974.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nYou are right, the version of imagesize was way to low in sage (1.2). Updating now.",
    "created_at": "2022-10-09T21:48:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558974",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

You are right, the version of imagesize was way to low in sage (1.2). Updating now.



---

archive/issue_comments_558975.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5cf583646a4d990d3e5d3163ba7c620a1712f141\"><code>5cf5836</code></a></td><td><code>update imagesize to 1.4.1. Minimum required for sphinx 5.2 is 1.3.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f\"><code>8f8af65</code></a></td><td><code>update sphinx to 5.2.3</code></td></tr></table>\n",
    "created_at": "2022-10-09T21:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558975",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5cf583646a4d990d3e5d3163ba7c620a1712f141"><code>5cf5836</code></a></td><td><code>update imagesize to 1.4.1. Minimum required for sphinx 5.2 is 1.3.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f"><code>8f8af65</code></a></td><td><code>update sphinx to 5.2.3</code></td></tr></table>




---

archive/issue_comments_558976.json:
```json
{
    "body": "Changed commit from **[`4a8c2b2`](https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1)** to **[`8f8af65`](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)**",
    "created_at": "2022-10-09T21:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558976",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4a8c2b2`](https://github.com/sagemath/sagetrac-mirror/commit/4a8c2b2dd933b82ce3ecc2953dcc5347ed7dd2c1)** to **[`8f8af65`](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)**



---

archive/issue_comments_558977.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nUpdated imagesize and pushed sphinx to 5.2.3.",
    "created_at": "2022-10-09T22:00:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558977",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">comment:19</div>

Updated imagesize and pushed sphinx to 5.2.3.



---

archive/issue_comments_558978.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,7 @@\n \n Therefore we think it is time to upgrade sphinx in sage.\n \n-The ticket update sphinx to 5.2.0 and sphinxcontrib_websupport to 1.2.4 (no other sphinx package need updating).\n+The ticket update \n+* sphinx to 5.2.3 \n+* sphinxcontrib_websupport to 1.2.4 (no other sphinxcontrib package seem out of date)\n+* imagesize to 1.4.1 (required dependency)\n``````\n",
    "created_at": "2022-10-09T22:00:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558978",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,7 @@
 
 Therefore we think it is time to upgrade sphinx in sage.
 
-The ticket update sphinx to 5.2.0 and sphinxcontrib_websupport to 1.2.4 (no other sphinx package need updating).
+The ticket update 
+* sphinx to 5.2.3 
+* sphinxcontrib_websupport to 1.2.4 (no other sphinxcontrib package seem out of date)
+* imagesize to 1.4.1 (required dependency)
``````




---

archive/issue_comments_558979.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThanks.\n\nIt works well and looks good to me.",
    "created_at": "2022-10-10T02:09:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558979",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:20" align="right">comment:20</div>

Thanks.

It works well and looks good to me.



---

archive/issue_comments_558980.json:
```json
{
    "body": "Reviewer: **Kwankyu Lee**",
    "created_at": "2022-10-10T02:09:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558980",
    "user": "https://github.com/kwankyu"
}
```

Reviewer: **Kwankyu Lee**



---

archive/issue_events_468754.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-10-10T02:09:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468754"
}
```



---

archive/issue_events_468755.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-10-10T02:09:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468755"
}
```



---

archive/issue_events_468756.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-16T22:15:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468756"
}
```



---

archive/issue_events_468757.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "75636756b8f9d9909cb69c30ea8bb3167e422989",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-10-16T22:15:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34615#event-468757"
}
```



---

archive/issue_comments_558981.json:
```json
{
    "body": "Changed branch from **[u/fbissey/sphinx5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sphinx5_2)** to **[`8f8af65`](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)**",
    "created_at": "2022-10-16T22:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558981",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/fbissey/sphinx5_2](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/sphinx5_2)** to **[`8f8af65`](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)**



---

archive/issue_comments_558982.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThis upgrade seems to have introduced an unpleasant change of doc appearance. Compare\n\nhttps://8f8af65e54d3a9962cfab40f15dc23f4e955b43f--sagemath-tobias.netlify.app/reference/curves/index.html\n\nwith\n\nhttps://doc.sagemath.org/html/en/reference/curves/index.html\n\nSee all the second-level headings. Those weren't before.",
    "created_at": "2022-10-24T06:18:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558982",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:22" align="right">comment:22</div>

This upgrade seems to have introduced an unpleasant change of doc appearance. Compare

https://8f8af65e54d3a9962cfab40f15dc23f4e955b43f--sagemath-tobias.netlify.app/reference/curves/index.html

with

https://doc.sagemath.org/html/en/reference/curves/index.html

See all the second-level headings. Those weren't before.



---

archive/issue_comments_558983.json:
```json
{
    "body": "Changed commit from **[`8f8af65`](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)** to none",
    "created_at": "2022-10-24T06:18:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558983",
    "user": "https://github.com/kwankyu"
}
```

Changed commit from **[`8f8af65`](https://github.com/sagemath/sagetrac-mirror/commit/8f8af65e54d3a9962cfab40f15dc23f4e955b43f)** to none



---

archive/issue_comments_558984.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI suspect that the upgrade does not work well with sage's custom `autodoc`.",
    "created_at": "2022-10-25T01:31:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558984",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:23" align="right">comment:23</div>

I suspect that the upgrade does not work well with sage's custom `autodoc`.



---

archive/issue_comments_558985.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nPossibly, it is hardly news that we should get rid of it as quickly as we can. I wanted to ask whether you had an idea why there are subsection for say \"plane conics\" but not \"curves\"? When I tried to post yesterday, trac was in maintenance :(",
    "created_at": "2022-10-25T01:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558985",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

Possibly, it is hardly news that we should get rid of it as quickly as we can. I wanted to ask whether you had an idea why there are subsection for say "plane conics" but not "curves"? When I tried to post yesterday, trac was in maintenance :(



---

archive/issue_comments_558986.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [Fran\u00e7ois Bissey](#comment:24):\n> Possibly, it is hardly news that we should get rid of it as quickly as we can. \n\nI agree! But that seems a formidable task (unless we just leave the consequential \"broken doc\" at it is).\n\n> I wanted to ask whether you had an idea why there are subsection for say \"plane conics\" but not \"curves\"?\n\nIt is because of the `maxdepth: 2`. See \n\n```\nPlane conics\n============\n\n.. toctree::\n   :maxdepth: 2 \n```\nHence it is normal. The real problem seems that definitions doc is regarded as content headings. I don't know if this is a feature of the upgraded sphinx or a problem of `sage_autodoc`...",
    "created_at": "2022-10-25T02:32:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558986",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [François Bissey](#comment:24):
> Possibly, it is hardly news that we should get rid of it as quickly as we can. 

I agree! But that seems a formidable task (unless we just leave the consequential "broken doc" at it is).

> I wanted to ask whether you had an idea why there are subsection for say "plane conics" but not "curves"?

It is because of the `maxdepth: 2`. See 

```
Plane conics
============

.. toctree::
   :maxdepth: 2 
```
Hence it is normal. The real problem seems that definitions doc is regarded as content headings. I don't know if this is a feature of the upgraded sphinx or a problem of `sage_autodoc`...



---

archive/issue_comments_558987.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nA simple and laborious solution would be to change all affected `maxdepth: 2` to `maxdepth: 1`. This seems also a correct solution. Then we can avoid touching `sage_autodoc` :)",
    "created_at": "2022-10-25T04:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558987",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:26" align="right">comment:26</div>

A simple and laborious solution would be to change all affected `maxdepth: 2` to `maxdepth: 1`. This seems also a correct solution. Then we can avoid touching `sage_autodoc` :)



---

archive/issue_comments_558988.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [Kwankyu Lee](#comment:26):\n> A simple and laborious solution would be to change all affected `maxdepth: 2` to `maxdepth: 1`. This seems also a correct solution. Then we can avoid touching `sage_autodoc` :)\n\nThis certainly does not solve all problems. See the \"Contents\" on the right\n\nhttps://8f8af65e54d3a9962cfab40f15dc23f4e955b43f--sagemath-tobias.netlify.app/reference/curves/sage/schemes/plane_conics/constructor.html",
    "created_at": "2022-10-25T08:43:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558988",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [Kwankyu Lee](#comment:26):
> A simple and laborious solution would be to change all affected `maxdepth: 2` to `maxdepth: 1`. This seems also a correct solution. Then we can avoid touching `sage_autodoc` :)

This certainly does not solve all problems. See the "Contents" on the right

https://8f8af65e54d3a9962cfab40f15dc23f4e955b43f--sagemath-tobias.netlify.app/reference/curves/sage/schemes/plane_conics/constructor.html



---

archive/issue_comments_558989.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI don't think that's bad. It is on a static right space while the content is just in a middle frame. This really looks like a standard template. One I have seen in other places.\n\nOf course, if it is inconsistent with other pages, we have a problem.",
    "created_at": "2022-10-25T08:52:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558989",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:28" align="right">comment:28</div>

I don't think that's bad. It is on a static right space while the content is just in a middle frame. This really looks like a standard template. One I have seen in other places.

Of course, if it is inconsistent with other pages, we have a problem.



---

archive/issue_comments_558990.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [Fran\u00e7ois Bissey](#comment:28):\n> I don't think that's bad. It is on a static right space while the content is just in a middle frame. This really looks like a standard template. One I have seen in other places.\n\nObject definitions in TOC is a new standard feature of the upgraded Sphinx. But this changes our doc in an unintended way. This is fixed now in #34706. Needs review.",
    "created_at": "2022-10-31T04:57:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34615#issuecomment-558990",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [François Bissey](#comment:28):
> I don't think that's bad. It is on a static right space while the content is just in a middle frame. This really looks like a standard template. One I have seen in other places.

Object definitions in TOC is a new standard feature of the upgraded Sphinx. But this changes our doc in an unintended way. This is fixed now in #34706. Needs review.
