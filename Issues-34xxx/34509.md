# Issue 34509: Make IndexedFreeModuleElement compatible with collections.abc, change method support to return a SupportView

archive/issues_034272.json:
```json
{
    "assignees": [],
    "body": "This is the element class of a `CombinatorialFreeModule`.\n\nIts implementation of `__iter__`, `__contains__`, `__len__` are not compatible with anything in the [collections.abc](https://docs.python.org/3/library/collections.abc.html) protocols. Specifically, \n\n```\nsage: F = CombinatorialFreeModule(QQ, ['a','b','c'])\nsage: B = F.basis()\nsage: f = B['a'] + 3*B['c']; f\nsage: import collections.abc\nsage: isinstance(f, collections.abc.Collection)\nTrue\n```\nbut `__iter__`ating over this collection gives objects that are not `__contain__`ed in it.\n\nTo improve interoperability, we propose to make the following changes: \n- Deprecate the `__contains__` method (currently testing whether a given index is in the support). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. \n- As a replacement for this functionality, revise the method `support` to return an instance of a new class `SupportView`, which provides a fast `__contains__` method, instead of a list.\n\n\n(Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n\nPart of Meta-ticket #30309: Unify free module elements API: methods dict, monomial_coefficients, etc.\n\nDepends on #34505\n\nCC:  @fchapoton @tscrim @mwageringel @nthiery @anneschilling\n\nBranch/Commit: **[2fe3b98](https://github.com/sagemath/sagetrac-mirror/commit/2fe3b981c7ebf07dfe8992d5f591b3bb73841ede)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Matthias Koeppe**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34509_\n\n",
    "closed_at": "2022-09-22T22:35:05Z",
    "created_at": "2022-09-08T20:01:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Make IndexedFreeModuleElement compatible with collections.abc, change method support to return a SupportView",
    "type": "issue",
    "updated_at": "2022-09-22T22:35:05Z",
    "url": "https://github.com/sagemath/sage/issues/34509",
    "user": "https://github.com/mkoeppe"
}
```
This is the element class of a `CombinatorialFreeModule`.

Its implementation of `__iter__`, `__contains__`, `__len__` are not compatible with anything in the [collections.abc](https://docs.python.org/3/library/collections.abc.html) protocols. Specifically, 

```
sage: F = CombinatorialFreeModule(QQ, ['a','b','c'])
sage: B = F.basis()
sage: f = B['a'] + 3*B['c']; f
sage: import collections.abc
sage: isinstance(f, collections.abc.Collection)
True
```
but `__iter__`ating over this collection gives objects that are not `__contain__`ed in it.

To improve interoperability, we propose to make the following changes: 
- Deprecate the `__contains__` method (currently testing whether a given index is in the support). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. 
- As a replacement for this functionality, revise the method `support` to return an instance of a new class `SupportView`, which provides a fast `__contains__` method, instead of a list.


(Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)

Part of Meta-ticket #30309: Unify free module elements API: methods dict, monomial_coefficients, etc.

Depends on #34505

CC:  @fchapoton @tscrim @mwageringel @nthiery @anneschilling

Branch/Commit: **[2fe3b98](https://github.com/sagemath/sagetrac-mirror/commit/2fe3b981c7ebf07dfe8992d5f591b3bb73841ede)**

Reviewer: **Travis Scrimshaw**

Author: **Matthias Koeppe**

_Issue created by migration from https://trac.sagemath.org/ticket/34509_





---

archive/issue_events_452796.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-08T20:01:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452796"
}
```



---

archive/issue_events_452797.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-08T20:01:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452797"
}
```



---

archive/issue_events_452798.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-08T20:01:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452798"
}
```



---

archive/issue_events_452799.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-08T20:01:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452799"
}
```



---

archive/issue_comments_560384.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,10 @@\n+This is the element class of a `CombinatorialFreeModule`.\n+\n Its implementation of `__iter__`, `__contains__`, `__len__` are not compatible with anything in the [collections.abc](https://docs.python.org/3/library/collections.abc.html) protocols.\n \n To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):\n - Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)\n - Add methods `keys`, `items`, `values` with the semantics familiar from `dict`.\n \n-(In #24815, it was proposed to make it a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n+(Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n \n``````\n",
    "created_at": "2022-09-08T20:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560384",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,10 @@
+This is the element class of a `CombinatorialFreeModule`.
+
 Its implementation of `__iter__`, `__contains__`, `__len__` are not compatible with anything in the [collections.abc](https://docs.python.org/3/library/collections.abc.html) protocols.
 
 To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):
 - Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)
 - Add methods `keys`, `items`, `values` with the semantics familiar from `dict`.
 
-(In #24815, it was proposed to make it a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
+(Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
 
``````




---

archive/issue_comments_560385.json:
```json
{
    "body": "Dependencies: **#34505**",
    "created_at": "2022-09-08T20:08:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560385",
    "user": "https://github.com/mkoeppe"
}
```

Dependencies: **#34505**



---

archive/issue_comments_560386.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):\n - Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)\n-- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`.\n+- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`. If ``self`` is a submodule, they refer to the ambient module.\n \n (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n \n``````\n",
    "created_at": "2022-09-08T20:53:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560386",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):
 - Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)
-- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`.
+- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`. If ``self`` is a submodule, they refer to the ambient module.
 
 (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
 
``````




---

archive/issue_comments_560387.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):\n - Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)\n-- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`. If ``self`` is a submodule, they refer to the ambient module.\n+- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`. If `self` is a submodule, they refer to the ambient module (see #34455).\n \n (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n \n``````\n",
    "created_at": "2022-09-08T20:56:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560387",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):
 - Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)
-- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`. If ``self`` is a submodule, they refer to the ambient module.
+- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`. If `self` is a submodule, they refer to the ambient module (see #34455).
 
 (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
 
``````




---

archive/issue_comments_560388.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nI am against this change. They are vectors and only on their backend are implemented as a `dict`, but they are not dictionaries, nor mappings. Likewise, I strongly oppose changing them to iterating over keys. This brings their implementation further from the other free module vectors. The reason we iterate over both is because there is no natural way to order the basis so the sequence of coefficients occurs in a particular order (which will unfortunately be a source of incompatibility). Hence, most of the time when iterating we want to use both the support index and the coefficient. Being vectors, they don\u2019t have `keys` and `values`, but `support` and `coefficients`. Nor do they have a reasonable notion of containment.\n\nContrast this to the \u201cusual\u201d free modules, where they have a natural compatibility with `sequence` as elements in R<sup>n</sup>, which are also how we think of finite sequences.",
    "created_at": "2022-09-08T23:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560388",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'>Comment 5:</a>
I am against this change. They are vectors and only on their backend are implemented as a `dict`, but they are not dictionaries, nor mappings. Likewise, I strongly oppose changing them to iterating over keys. This brings their implementation further from the other free module vectors. The reason we iterate over both is because there is no natural way to order the basis so the sequence of coefficients occurs in a particular order (which will unfortunately be a source of incompatibility). Hence, most of the time when iterating we want to use both the support index and the coefficient. Being vectors, they don’t have `keys` and `values`, but `support` and `coefficients`. Nor do they have a reasonable notion of containment.

Contrast this to the “usual” free modules, where they have a natural compatibility with `sequence` as elements in R<sup>n</sup>, which are also how we think of finite sequences.



---

archive/issue_comments_560389.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nReplying to [Travis Scrimshaw](#comment%3A5):\n> Being vectors, they don\u2019t have `keys` and `values`, but `support` and `coefficients`. Nor do they have a reasonable notion of containment.\n\nIt does define `__contains__` currently; no change to that is proposed.\n\n```\n    def __contains__(self, x):\n        \"\"\"\n        Returns whether or not a combinatorial object x indexing a basis\n        element is in the support of self.\n    ...\n```",
    "created_at": "2022-09-08T23:48:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560389",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'>Comment 6:</a>
Replying to [Travis Scrimshaw](#comment%3A5):
> Being vectors, they don’t have `keys` and `values`, but `support` and `coefficients`. Nor do they have a reasonable notion of containment.

It does define `__contains__` currently; no change to that is proposed.

```
    def __contains__(self, x):
        """
        Returns whether or not a combinatorial object x indexing a basis
        element is in the support of self.
    ...
```



---

archive/issue_comments_560390.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [Travis Scrimshaw](#comment%3A5):\n> I strongly oppose changing them to iterating over keys. This brings their implementation further from the other free module vectors.\n\nThis makes no sense.",
    "created_at": "2022-09-08T23:50:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560390",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [Travis Scrimshaw](#comment%3A5):
> I strongly oppose changing them to iterating over keys. This brings their implementation further from the other free module vectors.

This makes no sense.



---

archive/issue_comments_560391.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nReplying to [Travis Scrimshaw](#comment%3A5):\n> most of the time when iterating we want to use both the support index and the coefficient.\n\nYes, and there are two interpretations of this when the parent is a submodule.\n\n- one is `monomial_coefficients`, which refers to the basis of the submodule\n- one is the proposed new `items`, which will refer to the ambient. (This will be compatible with sparse vectors in `sage.modules`.)",
    "created_at": "2022-09-08T23:55:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560391",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'>Comment 8:</a>
Replying to [Travis Scrimshaw](#comment%3A5):
> most of the time when iterating we want to use both the support index and the coefficient.

Yes, and there are two interpretations of this when the parent is a submodule.

- one is `monomial_coefficients`, which refers to the basis of the submodule
- one is the proposed new `items`, which will refer to the ambient. (This will be compatible with sparse vectors in `sage.modules`.)



---

archive/issue_comments_560392.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,3 +8,4 @@\n \n (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n \n+Part of Meta-ticket #30309: Unify free module elements API: methods dict, monomial_coefficients, etc.\n``````\n",
    "created_at": "2022-09-08T23:56:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560392",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,3 +8,4 @@
 
 (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
 
+Part of Meta-ticket #30309: Unify free module elements API: methods dict, monomial_coefficients, etc.
``````




---

archive/issue_comments_560393.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A7):\n> Replying to [Travis Scrimshaw](#comment%3A5):\n> > I strongly oppose changing them to iterating over keys. This brings their implementation further from the other free module vectors.\n\n> \n> This makes no sense.\n\nWe want the two implementations to have the same API as much as possible. R<sup>n</sup> vectors iterate over coefficients, but iterating over keys/supports here would be the exact opposite of that behavior.",
    "created_at": "2022-09-08T23:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560393",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'>Comment 10:</a>
Replying to [Matthias Köppe](#comment%3A7):
> Replying to [Travis Scrimshaw](#comment%3A5):
> > I strongly oppose changing them to iterating over keys. This brings their implementation further from the other free module vectors.

> 
> This makes no sense.

We want the two implementations to have the same API as much as possible. R<sup>n</sup> vectors iterate over coefficients, but iterating over keys/supports here would be the exact opposite of that behavior.



---

archive/issue_comments_560394.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nYes, it makes no sense to say that returning `(key,value)` pairs is closer to being the \"same API\" as returning `value`s.",
    "created_at": "2022-09-09T00:00:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560394",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'>Comment 11:</a>
Yes, it makes no sense to say that returning `(key,value)` pairs is closer to being the "same API" as returning `value`s.



---

archive/issue_comments_560395.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,16 @@\n This is the element class of a `CombinatorialFreeModule`.\n \n-Its implementation of `__iter__`, `__contains__`, `__len__` are not compatible with anything in the [collections.abc](https://docs.python.org/3/library/collections.abc.html) protocols.\n+Its implementation of `__iter__`, `__contains__`, `__len__` are not compatible with anything in the [collections.abc](https://docs.python.org/3/library/collections.abc.html) protocols. Specifically, \n+\n+```\n+sage: F = CombinatorialFreeModule(QQ, ['a','b','c'])\n+sage: B = F.basis()\n+sage: f = B['a'] + 3*B['c']; f\n+sage: import collections.abc\n+sage: isinstance(f, collections.abc.Collection)\n+True\n+```\n+but `__iter__`ating over this collection gives objects that are not `__contain__`ed in it.\n \n To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):\n - Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)\n``````\n",
    "created_at": "2022-09-09T00:15:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560395",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,16 @@
 This is the element class of a `CombinatorialFreeModule`.
 
-Its implementation of `__iter__`, `__contains__`, `__len__` are not compatible with anything in the [collections.abc](https://docs.python.org/3/library/collections.abc.html) protocols.
+Its implementation of `__iter__`, `__contains__`, `__len__` are not compatible with anything in the [collections.abc](https://docs.python.org/3/library/collections.abc.html) protocols. Specifically, 
+
+```
+sage: F = CombinatorialFreeModule(QQ, ['a','b','c'])
+sage: B = F.basis()
+sage: f = B['a'] + 3*B['c']; f
+sage: import collections.abc
+sage: isinstance(f, collections.abc.Collection)
+True
+```
+but `__iter__`ating over this collection gives objects that are not `__contain__`ed in it.
 
 To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):
 - Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)
``````




---

archive/issue_comments_560396.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A11):\n> Yes, it makes no sense to say that returning `(key,value)` pairs is closer to being the \"same API\" as returning `value`s.\n\nSo actually returning the coefficient as part of the iterator instead of saying you should access it by a completely different method is exactly the same by your logic. You wouldn\u2019t agree that it is a much smaller change to have R<sup>n</sup> vector iterators change to return the pairs?",
    "created_at": "2022-09-09T01:34:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560396",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [Matthias Köppe](#comment%3A11):
> Yes, it makes no sense to say that returning `(key,value)` pairs is closer to being the "same API" as returning `value`s.

So actually returning the coefficient as part of the iterator instead of saying you should access it by a completely different method is exactly the same by your logic. You wouldn’t agree that it is a much smaller change to have R<sup>n</sup> vector iterators change to return the pairs?



---

archive/issue_comments_560397.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [Travis Scrimshaw](#comment%3A13):\n> change to have R<sup>n</sup> vector iterators change to return the pairs?\n\nThat would be a really bad change for dense vectors, which clearly want to be a `collections.abc.Sequence`",
    "created_at": "2022-09-09T01:38:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560397",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [Travis Scrimshaw](#comment%3A13):
> change to have R<sup>n</sup> vector iterators change to return the pairs?

That would be a really bad change for dense vectors, which clearly want to be a `collections.abc.Sequence`



---

archive/issue_comments_560398.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A8):\n> Replying to [Travis Scrimshaw](#comment%3A5):\n> > most of the time when iterating we want to use both the support index and the coefficient.\n\n> \n> Yes, and there are two interpretations of this when the parent is a submodule.\n> \n> - one is `monomial_coefficients`, which refers to the basis of the submodule\n> - one is the proposed new `items`, which will refer to the ambient. (This will be compatible with sparse vectors in `sage.modules`.)\n\nUnfortunately because of different implementation goals (mainly the speed that is needed for the R<sup>n</sup> modules), we cannot enforce compatibility for everything. I would rather all vectors follow what CFM vectors do from a more abstract mathematical point of view, but we have to make trade-offs. This one is here very clear-cut.\n\nAlso, it isn\u2019t just limited to sparse vectors, right?",
    "created_at": "2022-09-09T01:39:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560398",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [Matthias Köppe](#comment%3A8):
> Replying to [Travis Scrimshaw](#comment%3A5):
> > most of the time when iterating we want to use both the support index and the coefficient.

> 
> Yes, and there are two interpretations of this when the parent is a submodule.
> 
> - one is `monomial_coefficients`, which refers to the basis of the submodule
> - one is the proposed new `items`, which will refer to the ambient. (This will be compatible with sparse vectors in `sage.modules`.)

Unfortunately because of different implementation goals (mainly the speed that is needed for the R<sup>n</sup> modules), we cannot enforce compatibility for everything. I would rather all vectors follow what CFM vectors do from a more abstract mathematical point of view, but we have to make trade-offs. This one is here very clear-cut.

Also, it isn’t just limited to sparse vectors, right?



---

archive/issue_comments_560399.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A14):\n> Replying to [Travis Scrimshaw](#comment%3A13):\n> > change to have R<sup>n</sup> vector iterators change to return the pairs?\n\n> \n> That would be a really bad change for dense vectors, which clearly want to be a `collections.abc.Sequence`\n\nI am not saying we should change it (see [comment:15](#comment%3A15)), but if we did, it would be smaller.",
    "created_at": "2022-09-09T01:39:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560399",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [Matthias Köppe](#comment%3A14):
> Replying to [Travis Scrimshaw](#comment%3A13):
> > change to have R<sup>n</sup> vector iterators change to return the pairs?

> 
> That would be a really bad change for dense vectors, which clearly want to be a `collections.abc.Sequence`

I am not saying we should change it (see [comment:15](#comment%3A15)), but if we did, it would be smaller.



---

archive/issue_comments_560400.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [Travis Scrimshaw](#comment%3A15):\n> Unfortunately because of different implementation goals (mainly the speed that is needed for the R<sup>n</sup> modules), we cannot enforce compatibility for everything.\n\nYou'll have to be more concrete than that. There's nothing in the proposed change that has anything to do with performance.",
    "created_at": "2022-09-09T01:43:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560400",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [Travis Scrimshaw](#comment%3A15):
> Unfortunately because of different implementation goals (mainly the speed that is needed for the R<sup>n</sup> modules), we cannot enforce compatibility for everything.

You'll have to be more concrete than that. There's nothing in the proposed change that has anything to do with performance.



---

archive/issue_comments_560401.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nI do see lots of uses of the idiom `... for (i, c) in self` in `sage.combinat`.\n\nSo maybe an easier change would be to get rid of the `__contains__` method (with deprecation, of course) to resolve this incompatibility. Then only uses of `if i in self` would have to be changed to `if i in self.support()`",
    "created_at": "2022-09-09T03:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560401",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'>Comment 18:</a>
I do see lots of uses of the idiom `... for (i, c) in self` in `sage.combinat`.

So maybe an easier change would be to get rid of the `__contains__` method (with deprecation, of course) to resolve this incompatibility. Then only uses of `if i in self` would have to be changed to `if i in self.support()`



---

archive/issue_comments_560402.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A17):\n> Replying to [Travis Scrimshaw](#comment%3A15):\n> > Unfortunately because of different implementation goals (mainly the speed that is needed for the R<sup>n</sup> modules), we cannot enforce compatibility for everything.\n\n> \n> You'll have to be more concrete than that. There's nothing in the proposed change that has anything to do with performance.\n\nIf we change the iterator for R<sup>n</sup> modules to make it compatible with what `IndexedFreeModuleElement` does, then this would lead to slow downs because the R<sup>n</sup> module elements are fairly likely to be used in time-critical code sections (where extra indirections can matter).",
    "created_at": "2022-09-09T03:27:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560402",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [Matthias Köppe](#comment%3A17):
> Replying to [Travis Scrimshaw](#comment%3A15):
> > Unfortunately because of different implementation goals (mainly the speed that is needed for the R<sup>n</sup> modules), we cannot enforce compatibility for everything.

> 
> You'll have to be more concrete than that. There's nothing in the proposed change that has anything to do with performance.

If we change the iterator for R<sup>n</sup> modules to make it compatible with what `IndexedFreeModuleElement` does, then this would lead to slow downs because the R<sup>n</sup> module elements are fairly likely to be used in time-critical code sections (where extra indirections can matter).



---

archive/issue_comments_560403.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A18):\n> I do see lots of uses of the idiom `... for (i, c) in self` in `sage.combinat`.\n> \n> So maybe an easier change would be to get rid of the `__contains__` method (with deprecation, of course) to resolve this incompatibility. Then only uses of `if i in self` would have to be changed to `if i in self.support()`\n\n+1 on this basically. I doubt anyone is using the support containment check where speed really matters, but that is my only slight hesitancy because that change would make it much slower (via the additional temporary object from `support()`). Perhaps a `self.index_in_support(i)` method instead?",
    "created_at": "2022-09-09T03:30:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560403",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:20'>Comment 20:</a>
Replying to [Matthias Köppe](#comment%3A18):
> I do see lots of uses of the idiom `... for (i, c) in self` in `sage.combinat`.
> 
> So maybe an easier change would be to get rid of the `__contains__` method (with deprecation, of course) to resolve this incompatibility. Then only uses of `if i in self` would have to be changed to `if i in self.support()`

+1 on this basically. I doubt anyone is using the support containment check where speed really matters, but that is my only slight hesitancy because that change would make it much slower (via the additional temporary object from `support()`). Perhaps a `self.index_in_support(i)` method instead?



---

archive/issue_comments_560404.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [Travis Scrimshaw](#comment%3A19):\n> Replying to [Matthias K\u00f6ppe](#comment%3A17):\n> > Replying to [Travis Scrimshaw](#comment%3A15):\n> > > Unfortunately because of different implementation goals (mainly the speed that is needed for the R<sup>n</sup> modules), we cannot enforce compatibility for everything.\n\n> > \n> > You'll have to be more concrete than that. There's nothing in the proposed change that has anything to do with performance.\n\n> \n> If we change the iterator for R<sup>n</sup> modules to make it compatible with what `IndexedFreeModuleElement` does\n\nOK, yes, that's just one of several reasons why this change would be bad. It's not being proposed here.",
    "created_at": "2022-09-09T04:25:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560404",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [Travis Scrimshaw](#comment%3A19):
> Replying to [Matthias Köppe](#comment%3A17):
> > Replying to [Travis Scrimshaw](#comment%3A15):
> > > Unfortunately because of different implementation goals (mainly the speed that is needed for the R<sup>n</sup> modules), we cannot enforce compatibility for everything.

> > 
> > You'll have to be more concrete than that. There's nothing in the proposed change that has anything to do with performance.

> 
> If we change the iterator for R<sup>n</sup> modules to make it compatible with what `IndexedFreeModuleElement` does

OK, yes, that's just one of several reasons why this change would be bad. It's not being proposed here.



---

archive/issue_comments_560405.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nReplying to [Travis Scrimshaw](#comment%3A20):\n> Replying to [Matthias K\u00f6ppe](#comment%3A18):\n> > I do see lots of uses of the idiom `... for (i, c) in self` in `sage.combinat`.\n> > \n> > So maybe an easier change would be to get rid of the `__contains__` method (with deprecation, of course) to resolve this incompatibility. Then only uses of `if i in self` would have to be changed to `if i in self.support()`\n\n> \n> +1 on this basically. I doubt anyone is using the support containment check where speed really matters, but that is my only slight hesitancy because that change would make it much slower (via the additional temporary object from `support()`). Perhaps a `self.index_in_support(i)` method instead?\n\nYes, of course the current implementation of `support()` is bad. It's another Python2-ish leftover of returning lists all the time.",
    "created_at": "2022-09-09T04:28:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560405",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'>Comment 22:</a>
Replying to [Travis Scrimshaw](#comment%3A20):
> Replying to [Matthias Köppe](#comment%3A18):
> > I do see lots of uses of the idiom `... for (i, c) in self` in `sage.combinat`.
> > 
> > So maybe an easier change would be to get rid of the `__contains__` method (with deprecation, of course) to resolve this incompatibility. Then only uses of `if i in self` would have to be changed to `if i in self.support()`

> 
> +1 on this basically. I doubt anyone is using the support containment check where speed really matters, but that is my only slight hesitancy because that change would make it much slower (via the additional temporary object from `support()`). Perhaps a `self.index_in_support(i)` method instead?

Yes, of course the current implementation of `support()` is bad. It's another Python2-ish leftover of returning lists all the time.



---

archive/issue_comments_560406.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBy the way, can `_monomial_coefficients` really contain keys that have a zero value? I looked briefly and it seemed that for example arithmetic would always remove the zeros",
    "created_at": "2022-09-09T04:31:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560406",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'>Comment 23:</a>
By the way, can `_monomial_coefficients` really contain keys that have a zero value? I looked briefly and it seemed that for example arithmetic would always remove the zeros



---

archive/issue_comments_560407.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nIf there's no zero value in `_monomial_coefficients`, then `support` can just return the `_monomial_coefficients.keys()` view.",
    "created_at": "2022-09-09T04:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560407",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'>Comment 24:</a>
If there's no zero value in `_monomial_coefficients`, then `support` can just return the `_monomial_coefficients.keys()` view.



---

archive/issue_comments_560408.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nEither way instead of inventing a new name such as `index_in_support`, we should just have `support` return a suitable object with a `__contains__` method.",
    "created_at": "2022-09-09T04:37:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560408",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:25'>Comment 25:</a>
Either way instead of inventing a new name such as `index_in_support`, we should just have `support` return a suitable object with a `__contains__` method.



---

archive/issue_comments_560409.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,9 +12,9 @@\n ```\n but `__iter__`ating over this collection gives objects that are not `__contain__`ed in it.\n \n-To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):\n-- Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)\n-- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`. If `self` is a submodule, they refer to the ambient module (see #34455).\n+To improve interoperability, we propose to make the following changes: \n+- Deprecate the `__contains__` method (currently testing whether a given index is in the suppport). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. \n+- Add a method `items`, with the same semantics as for sparse vectors from `sage.modules`, and matrices and tensor components after #29619. If `self` is a submodule, they refer to the ambient module (see #34455).\n \n (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n \n``````\n",
    "created_at": "2022-09-10T05:41:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560409",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,9 +12,9 @@
 ```
 but `__iter__`ating over this collection gives objects that are not `__contain__`ed in it.
 
-To improve interoperability, we propose to make changes to make it a [collections.abc.Mapping](https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping) (= supporting the operations of a `dict` but without mutability):
-- Because a `Mapping` is a `Collection`, we change the `__iter__` method from yielding (key, value) items to yielding keys only. (Thus it will be compatible with the existing `__contains__` method which check for the presence of a key)
-- Add methods `keys`, `items`, `values` with the semantics familiar from `dict`. If `self` is a submodule, they refer to the ambient module (see #34455).
+To improve interoperability, we propose to make the following changes: 
+- Deprecate the `__contains__` method (currently testing whether a given index is in the suppport). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. 
+- Add a method `items`, with the same semantics as for sparse vectors from `sage.modules`, and matrices and tensor components after #29619. If `self` is a submodule, they refer to the ambient module (see #34455).
 
 (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
 
``````




---

archive/issue_events_452800.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-10T05:41:34Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "title_is": "Make IndexedFreeModuleElement compatible with collections.abc, add method items",
    "title_was": "Make IndexedFreeModuleElement a collections.abc.Mapping",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452800"
}
```



---

archive/issue_comments_560410.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,6 +14,7 @@\n \n To improve interoperability, we propose to make the following changes: \n - Deprecate the `__contains__` method (currently testing whether a given index is in the suppport). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. \n+- As a replacement for this functionality, revise the method `support` to return an object with a fast `__contains__` method instead of a list.\n - Add a method `items`, with the same semantics as for sparse vectors from `sage.modules`, and matrices and tensor components after #29619. If `self` is a submodule, they refer to the ambient module (see #34455).\n \n (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n``````\n",
    "created_at": "2022-09-10T05:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560410",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,6 +14,7 @@
 
 To improve interoperability, we propose to make the following changes: 
 - Deprecate the `__contains__` method (currently testing whether a given index is in the suppport). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. 
+- As a replacement for this functionality, revise the method `support` to return an object with a fast `__contains__` method instead of a list.
 - Add a method `items`, with the same semantics as for sparse vectors from `sage.modules`, and matrices and tensor components after #29619. If `self` is a submodule, they refer to the ambient module (see #34455).
 
 (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
``````




---

archive/issue_comments_560411.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nI've updated the ticket description to reflect this revised plan",
    "created_at": "2022-09-10T05:43:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560411",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:28'>Comment 28:</a>
I've updated the ticket description to reflect this revised plan



---

archive/issue_comments_560412.json:
```json
{
    "body": "Branch: **[u/mkoeppe/make_indexedfreemoduleelement_a_collections_abc_mapping](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/make_indexedfreemoduleelement_a_collections_abc_mapping)**",
    "created_at": "2022-09-10T22:35:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560412",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/make_indexedfreemoduleelement_a_collections_abc_mapping](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/make_indexedfreemoduleelement_a_collections_abc_mapping)**



---

archive/issue_comments_560413.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35b8b6ec6dcbd3dcf25e54937aec668322e5ad1c\">35b8b6e</a></td><td><code>ModulesWithBasis.ElementMethod.support: Return a SupportView</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ae8f09538745e3388340d9307e2b661eae0148a\">8ae8f09</a></td><td><code>src/sage/combinat/crystals, src/sage/categories/*crystals*: Use collections.abc for isinstance</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5857f82c435f706ddce6ff496949cb3fb9fd242\">c5857f8</a></td><td><code>Convert result of support() to list or tuple in two places</code></td></tr></table>\n",
    "created_at": "2022-09-10T22:37:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560413",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'>Comment 30:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35b8b6ec6dcbd3dcf25e54937aec668322e5ad1c">35b8b6e</a></td><td><code>ModulesWithBasis.ElementMethod.support: Return a SupportView</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ae8f09538745e3388340d9307e2b661eae0148a">8ae8f09</a></td><td><code>src/sage/combinat/crystals, src/sage/categories/*crystals*: Use collections.abc for isinstance</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5857f82c435f706ddce6ff496949cb3fb9fd242">c5857f8</a></td><td><code>Convert result of support() to list or tuple in two places</code></td></tr></table>




---

archive/issue_comments_560414.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,8 +13,8 @@\n but `__iter__`ating over this collection gives objects that are not `__contain__`ed in it.\n \n To improve interoperability, we propose to make the following changes: \n-- Deprecate the `__contains__` method (currently testing whether a given index is in the suppport). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. \n-- As a replacement for this functionality, revise the method `support` to return an object with a fast `__contains__` method instead of a list.\n+- Deprecate the `__contains__` method (currently testing whether a given index is in the support). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. \n+- As a replacement for this functionality, revise the method `support` to return an instance of a new class `SupportView`, which provides a fast `__contains__` method, instead of a list.\n - Add a method `items`, with the same semantics as for sparse vectors from `sage.modules`, and matrices and tensor components after #29619. If `self` is a submodule, they refer to the ambient module (see #34455).\n \n (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n``````\n",
    "created_at": "2022-09-10T22:37:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560414",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,8 +13,8 @@
 but `__iter__`ating over this collection gives objects that are not `__contain__`ed in it.
 
 To improve interoperability, we propose to make the following changes: 
-- Deprecate the `__contains__` method (currently testing whether a given index is in the suppport). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. 
-- As a replacement for this functionality, revise the method `support` to return an object with a fast `__contains__` method instead of a list.
+- Deprecate the `__contains__` method (currently testing whether a given index is in the support). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. 
+- As a replacement for this functionality, revise the method `support` to return an instance of a new class `SupportView`, which provides a fast `__contains__` method, instead of a list.
 - Add a method `items`, with the same semantics as for sparse vectors from `sage.modules`, and matrices and tensor components after #29619. If `self` is a submodule, they refer to the ambient module (see #34455).
 
 (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
``````




---

archive/issue_comments_560415.json:
```json
{
    "body": "Commit: **[c5857f8](https://github.com/sagemath/sagetrac-mirror/commit/c5857f82c435f706ddce6ff496949cb3fb9fd242)**",
    "created_at": "2022-09-10T22:37:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560415",
    "user": "https://github.com/mkoeppe"
}
```

Commit: **[c5857f8](https://github.com/sagemath/sagetrac-mirror/commit/c5857f82c435f706ddce6ff496949cb3fb9fd242)**



---

archive/issue_comments_560416.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12da4ed7451883da43371a0296f0f29a3b9af347\">12da4ed</a></td><td><code>ModulesWithBasis.ElementMethod.len: Use support</code></td></tr></table>\n",
    "created_at": "2022-09-10T22:44:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560416",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:31'>Comment 31:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12da4ed7451883da43371a0296f0f29a3b9af347">12da4ed</a></td><td><code>ModulesWithBasis.ElementMethod.len: Use support</code></td></tr></table>




---

archive/issue_comments_560417.json:
```json
{
    "body": "Changed commit from **[c5857f8](https://github.com/sagemath/sagetrac-mirror/commit/c5857f82c435f706ddce6ff496949cb3fb9fd242)** to **[12da4ed](https://github.com/sagemath/sagetrac-mirror/commit/12da4ed7451883da43371a0296f0f29a3b9af347)**",
    "created_at": "2022-09-10T22:44:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560417",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c5857f8](https://github.com/sagemath/sagetrac-mirror/commit/c5857f82c435f706ddce6ff496949cb3fb9fd242)** to **[12da4ed](https://github.com/sagemath/sagetrac-mirror/commit/12da4ed7451883da43371a0296f0f29a3b9af347)**



---

archive/issue_comments_560418.json:
```json
{
    "body": "Changed commit from **[12da4ed](https://github.com/sagemath/sagetrac-mirror/commit/12da4ed7451883da43371a0296f0f29a3b9af347)** to **[31559b2](https://github.com/sagemath/sagetrac-mirror/commit/31559b26eacad4c2d1591bd8212d3b4e4f3fcead)**",
    "created_at": "2022-09-10T22:55:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560418",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[12da4ed](https://github.com/sagemath/sagetrac-mirror/commit/12da4ed7451883da43371a0296f0f29a3b9af347)** to **[31559b2](https://github.com/sagemath/sagetrac-mirror/commit/31559b26eacad4c2d1591bd8212d3b4e4f3fcead)**



---

archive/issue_comments_560419.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ddb29bcae0394d86153231bf2c4e6090bccd757\">1ddb29b</a></td><td><code>src/sage/structure/support_view.py: Fix up</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31559b26eacad4c2d1591bd8212d3b4e4f3fcead\">31559b2</a></td><td><code>IndexedFreeModuleElement.__contains__: Deprecate</code></td></tr></table>\n",
    "created_at": "2022-09-10T22:55:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560419",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:32'>Comment 32:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ddb29bcae0394d86153231bf2c4e6090bccd757">1ddb29b</a></td><td><code>src/sage/structure/support_view.py: Fix up</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31559b26eacad4c2d1591bd8212d3b4e4f3fcead">31559b2</a></td><td><code>IndexedFreeModuleElement.__contains__: Deprecate</code></td></tr></table>




---

archive/issue_comments_560420.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb2c92d58022493a6b005e4fcca6e982e41f95ad\">eb2c92d</a></td><td><code>ModulesWithBasis.support: Try to cache the SupportView object</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bf91ea48ff7409cc2de2fecd236808bb1abd1a06\">bf91ea4</a></td><td><code>src/sage/combinat/ncsf_qsym/generic_basis_code.py: Replace deprecated 'index in vector'</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3abc6c4094959e0ab6b75a67c06c8ce1acb004d\">b3abc6c</a></td><td><code>src/sage/combinat/sf/sfa.py: Replace deprecated 'index in vector'</code></td></tr></table>\n",
    "created_at": "2022-09-10T23:14:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560420",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:33'>Comment 33:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb2c92d58022493a6b005e4fcca6e982e41f95ad">eb2c92d</a></td><td><code>ModulesWithBasis.support: Try to cache the SupportView object</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bf91ea48ff7409cc2de2fecd236808bb1abd1a06">bf91ea4</a></td><td><code>src/sage/combinat/ncsf_qsym/generic_basis_code.py: Replace deprecated 'index in vector'</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3abc6c4094959e0ab6b75a67c06c8ce1acb004d">b3abc6c</a></td><td><code>src/sage/combinat/sf/sfa.py: Replace deprecated 'index in vector'</code></td></tr></table>




---

archive/issue_comments_560421.json:
```json
{
    "body": "Changed commit from **[31559b2](https://github.com/sagemath/sagetrac-mirror/commit/31559b26eacad4c2d1591bd8212d3b4e4f3fcead)** to **[b3abc6c](https://github.com/sagemath/sagetrac-mirror/commit/b3abc6c4094959e0ab6b75a67c06c8ce1acb004d)**",
    "created_at": "2022-09-10T23:14:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560421",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[31559b2](https://github.com/sagemath/sagetrac-mirror/commit/31559b26eacad4c2d1591bd8212d3b4e4f3fcead)** to **[b3abc6c](https://github.com/sagemath/sagetrac-mirror/commit/b3abc6c4094959e0ab6b75a67c06c8ce1acb004d)**



---

archive/issue_comments_560422.json:
```json
{
    "body": "Author: **Matthias Koeppe**",
    "created_at": "2022-09-10T23:15:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560422",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Matthias Koeppe**



---

archive/issue_events_452801.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-10T23:18:55Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "title_is": "Make IndexedFreeModuleElement compatible with collections.abc, change method support to return a SupportView",
    "title_was": "Make IndexedFreeModuleElement compatible with collections.abc, add method items",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452801"
}
```



---

archive/issue_comments_560423.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,7 +15,7 @@\n To improve interoperability, we propose to make the following changes: \n - Deprecate the `__contains__` method (currently testing whether a given index is in the support). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. \n - As a replacement for this functionality, revise the method `support` to return an instance of a new class `SupportView`, which provides a fast `__contains__` method, instead of a list.\n-- Add a method `items`, with the same semantics as for sparse vectors from `sage.modules`, and matrices and tensor components after #29619. If `self` is a submodule, they refer to the ambient module (see #34455).\n+\n \n (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)\n \n``````\n",
    "created_at": "2022-09-10T23:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560423",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,7 +15,7 @@
 To improve interoperability, we propose to make the following changes: 
 - Deprecate the `__contains__` method (currently testing whether a given index is in the support). After its removal, the class would no longer be considered by Python to be a subclass of `collections.abc.Collection`, but merely a `Sized` `Iterable`. 
 - As a replacement for this functionality, revise the method `support` to return an instance of a new class `SupportView`, which provides a fast `__contains__` method, instead of a list.
-- Add a method `items`, with the same semantics as for sparse vectors from `sage.modules`, and matrices and tensor components after #29619. If `self` is a submodule, they refer to the ambient module (see #34455).
+
 
 (Similarly, in #24815, it was proposed to make the elements of free modules from `sage.modules` a [collections.abc.Sequence](https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence).)
 
``````




---

archive/issue_comments_560424.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\nThe proposed method `items` will be added in #34511",
    "created_at": "2022-09-10T23:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560424",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:36'>Comment 36:</a>
The proposed method `items` will be added in #34511



---

archive/issue_comments_560425.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A23):\n> By the way, can `_monomial_coefficients` really contain keys that have a zero value? I looked briefly and it seemed that for example arithmetic would always remove the zeros\n\nWe have somewhat allowed for the possibility that it can hold zero coefficients, but we almost always in practice just remove them. We probably should just enforce this. This would make the `support()` call much cheaper, although checking containment could still be slow as it might be `list`-like checking rather than `set`-like. Anyways, I doubt it is used in much time critical code, but it is still good to keep similar performance in mind.",
    "created_at": "2022-09-10T23:38:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560425",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:37'>Comment 37:</a>
Replying to [Matthias Köppe](#comment%3A23):
> By the way, can `_monomial_coefficients` really contain keys that have a zero value? I looked briefly and it seemed that for example arithmetic would always remove the zeros

We have somewhat allowed for the possibility that it can hold zero coefficients, but we almost always in practice just remove them. We probably should just enforce this. This would make the `support()` call much cheaper, although checking containment could still be slow as it might be `list`-like checking rather than `set`-like. Anyways, I doubt it is used in much time critical code, but it is still good to keep similar performance in mind.



---

archive/issue_comments_560426.json:
```json
{
    "body": "Changed commit from **[b3abc6c](https://github.com/sagemath/sagetrac-mirror/commit/b3abc6c4094959e0ab6b75a67c06c8ce1acb004d)** to **[82d8b62](https://github.com/sagemath/sagetrac-mirror/commit/82d8b62091f58f3ff68a8287be7e30515000f61f)**",
    "created_at": "2022-09-10T23:41:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560426",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b3abc6c](https://github.com/sagemath/sagetrac-mirror/commit/b3abc6c4094959e0ab6b75a67c06c8ce1acb004d)** to **[82d8b62](https://github.com/sagemath/sagetrac-mirror/commit/82d8b62091f58f3ff68a8287be7e30515000f61f)**



---

archive/issue_comments_560427.json:
```json
{
    "body": "<a id='comment:38'>Comment 38:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82d8b62091f58f3ff68a8287be7e30515000f61f\">82d8b62</a></td><td><code>src/sage/structure/support_view.py: Add tests</code></td></tr></table>\n",
    "created_at": "2022-09-10T23:41:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560427",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:38'>Comment 38:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82d8b62091f58f3ff68a8287be7e30515000f61f">82d8b62</a></td><td><code>src/sage/structure/support_view.py: Add tests</code></td></tr></table>




---

archive/issue_comments_560428.json:
```json
{
    "body": "Changed commit from **[82d8b62](https://github.com/sagemath/sagetrac-mirror/commit/82d8b62091f58f3ff68a8287be7e30515000f61f)** to **[1f48aa0](https://github.com/sagemath/sagetrac-mirror/commit/1f48aa0a04db254a63ad3eb953d64f167a2295cc)**",
    "created_at": "2022-09-10T23:57:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560428",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[82d8b62](https://github.com/sagemath/sagetrac-mirror/commit/82d8b62091f58f3ff68a8287be7e30515000f61f)** to **[1f48aa0](https://github.com/sagemath/sagetrac-mirror/commit/1f48aa0a04db254a63ad3eb953d64f167a2295cc)**



---

archive/issue_comments_560429.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f48aa0a04db254a63ad3eb953d64f167a2295cc\">1f48aa0</a></td><td><code>src/sage/structure/support_view.py: Add more tests</code></td></tr></table>\n",
    "created_at": "2022-09-10T23:57:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560429",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:39'>Comment 39:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f48aa0a04db254a63ad3eb953d64f167a2295cc">1f48aa0</a></td><td><code>src/sage/structure/support_view.py: Add more tests</code></td></tr></table>




---

archive/issue_comments_560430.json:
```json
{
    "body": "Changed commit from **[1f48aa0](https://github.com/sagemath/sagetrac-mirror/commit/1f48aa0a04db254a63ad3eb953d64f167a2295cc)** to **[2583a37](https://github.com/sagemath/sagetrac-mirror/commit/2583a37c57bf2ea04c48eec6cc65a45b02c4938d)**",
    "created_at": "2022-09-11T00:05:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560430",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1f48aa0](https://github.com/sagemath/sagetrac-mirror/commit/1f48aa0a04db254a63ad3eb953d64f167a2295cc)** to **[2583a37](https://github.com/sagemath/sagetrac-mirror/commit/2583a37c57bf2ea04c48eec6cc65a45b02c4938d)**



---

archive/issue_comments_560431.json:
```json
{
    "body": "<a id='comment:40'>Comment 40:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2583a37c57bf2ea04c48eec6cc65a45b02c4938d\">2583a37</a></td><td><code>IndexedFreeModuleElement: Add doc</code></td></tr></table>\n",
    "created_at": "2022-09-11T00:05:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560431",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:40'>Comment 40:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2583a37c57bf2ea04c48eec6cc65a45b02c4938d">2583a37</a></td><td><code>IndexedFreeModuleElement: Add doc</code></td></tr></table>




---

archive/issue_comments_560432.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nReplying to [Travis Scrimshaw](#comment%3A37):\n> Replying to [Matthias K\u00f6ppe](#comment%3A23):\n> > By the way, can `_monomial_coefficients` really contain keys that have a zero value? I looked briefly and it seemed that for example arithmetic would always remove the zeros\n\n> \n> We have somewhat allowed for the possibility that it can hold zero coefficients, but we almost always in practice just remove them. We probably should just enforce this. This would make the `support()` call much cheaper\n\nOn the level of `CombinatorialFreeModule`, not the category, right? We can do that in a follow-up ticket. (The tensor modules don't enforce the sparsity, I think.)",
    "created_at": "2022-09-11T00:07:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560432",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:41'>Comment 41:</a>
Replying to [Travis Scrimshaw](#comment%3A37):
> Replying to [Matthias Köppe](#comment%3A23):
> > By the way, can `_monomial_coefficients` really contain keys that have a zero value? I looked briefly and it seemed that for example arithmetic would always remove the zeros

> 
> We have somewhat allowed for the possibility that it can hold zero coefficients, but we almost always in practice just remove them. We probably should just enforce this. This would make the `support()` call much cheaper

On the level of `CombinatorialFreeModule`, not the category, right? We can do that in a follow-up ticket. (The tensor modules don't enforce the sparsity, I think.)



---

archive/issue_events_452802.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-11T00:08:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452802"
}
```



---

archive/issue_comments_560433.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nThis could of course be rewritten to avoid forming all these lists, but I don't know if it's worth it. Question for the author\n\n```\nindex aa96f2b..e065b7e 100644\n--- a/src/sage/categories/loop_crystals.py\n+++ b/src/sage/categories/loop_crystals.py\n@@ -456,7 +456,7 @@ class KirillovReshetikhinCrystals(Category_singleton):\n             bsharp = None\n             for b in self:\n                 phi = b.Phi()\n-                if phi.support() == [0] and phi[0] < ell:\n+                if list(phi.support()) == [0] and phi[0] < ell:\n                     bsharp = b\n```",
    "created_at": "2022-09-11T00:10:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560433",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:43'>Comment 43:</a>
This could of course be rewritten to avoid forming all these lists, but I don't know if it's worth it. Question for the author

```
index aa96f2b..e065b7e 100644
--- a/src/sage/categories/loop_crystals.py
+++ b/src/sage/categories/loop_crystals.py
@@ -456,7 +456,7 @@ class KirillovReshetikhinCrystals(Category_singleton):
             bsharp = None
             for b in self:
                 phi = b.Phi()
-                if phi.support() == [0] and phi[0] < ell:
+                if list(phi.support()) == [0] and phi[0] < ell:
                     bsharp = b
```



---

archive/issue_comments_560434.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88fe278795354296ad74dcc41b61b2aeb301d900\">88fe278</a></td><td><code>src/sage/structure/support_view.py: Fix doctest output</code></td></tr></table>\n",
    "created_at": "2022-09-11T00:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560434",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:44'>Comment 44:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88fe278795354296ad74dcc41b61b2aeb301d900">88fe278</a></td><td><code>src/sage/structure/support_view.py: Fix doctest output</code></td></tr></table>




---

archive/issue_comments_560435.json:
```json
{
    "body": "Changed commit from **[2583a37](https://github.com/sagemath/sagetrac-mirror/commit/2583a37c57bf2ea04c48eec6cc65a45b02c4938d)** to **[88fe278](https://github.com/sagemath/sagetrac-mirror/commit/88fe278795354296ad74dcc41b61b2aeb301d900)**",
    "created_at": "2022-09-11T00:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560435",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2583a37](https://github.com/sagemath/sagetrac-mirror/commit/2583a37c57bf2ea04c48eec6cc65a45b02c4938d)** to **[88fe278](https://github.com/sagemath/sagetrac-mirror/commit/88fe278795354296ad74dcc41b61b2aeb301d900)**



---

archive/issue_comments_560436.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A41):\n> Replying to [Travis Scrimshaw](#comment%3A37):\n> > Replying to [Matthias K\u00f6ppe](#comment%3A23):\n> > > By the way, can `_monomial_coefficients` really contain keys that have a zero value? I looked briefly and it seemed that for example arithmetic would always remove the zeros\n\n> > \n> > We have somewhat allowed for the possibility that it can hold zero coefficients, but we almost always in practice just remove them. We probably should just enforce this. This would make the `support()` call much cheaper\n\n> \n> On the level of `CombinatorialFreeModule`, not the category, right? We can do that in a follow-up ticket. (The tensor modules don't enforce the sparsity, I think.)\n\nI was thinking more for any `Parent` that uses the element class, but basically, yes.",
    "created_at": "2022-09-11T00:34:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560436",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:45'>Comment 45:</a>
Replying to [Matthias Köppe](#comment%3A41):
> Replying to [Travis Scrimshaw](#comment%3A37):
> > Replying to [Matthias Köppe](#comment%3A23):
> > > By the way, can `_monomial_coefficients` really contain keys that have a zero value? I looked briefly and it seemed that for example arithmetic would always remove the zeros

> > 
> > We have somewhat allowed for the possibility that it can hold zero coefficients, but we almost always in practice just remove them. We probably should just enforce this. This would make the `support()` call much cheaper

> 
> On the level of `CombinatorialFreeModule`, not the category, right? We can do that in a follow-up ticket. (The tensor modules don't enforce the sparsity, I think.)

I was thinking more for any `Parent` that uses the element class, but basically, yes.



---

archive/issue_comments_560437.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nSure, yes, that's what I meant.",
    "created_at": "2022-09-11T00:35:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560437",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:46'>Comment 46:</a>
Sure, yes, that's what I meant.



---

archive/issue_comments_560438.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A43):\n> This could of course be rewritten to avoid forming all these lists, but I don't know if it's worth it. Question for the author\n> \n> ```\n> index aa96f2b..e065b7e 100644\n> --- a/src/sage/categories/loop_crystals.py\n> +++ b/src/sage/categories/loop_crystals.py\n> @@ -456,7 +456,7 @@ class KirillovReshetikhinCrystals(Category_singleton):\n>              bsharp = None\n>              for b in self:\n>                  phi = b.Phi()\n> -                if phi.support() == [0] and phi[0] < ell:\n> +                if list(phi.support()) == [0] and phi[0] < ell:\n>                      bsharp = b\n> ```\n\nI don\u2019t think it is necessarily worth it as it won\u2019t be run in tight loops. Although it would just become `if len(phi.support()) == 1 and 0 in phi.support() and phi[0] < ell:` I guess.",
    "created_at": "2022-09-11T00:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560438",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:47'>Comment 47:</a>
Replying to [Matthias Köppe](#comment%3A43):
> This could of course be rewritten to avoid forming all these lists, but I don't know if it's worth it. Question for the author
> 
> ```
> index aa96f2b..e065b7e 100644
> --- a/src/sage/categories/loop_crystals.py
> +++ b/src/sage/categories/loop_crystals.py
> @@ -456,7 +456,7 @@ class KirillovReshetikhinCrystals(Category_singleton):
>              bsharp = None
>              for b in self:
>                  phi = b.Phi()
> -                if phi.support() == [0] and phi[0] < ell:
> +                if list(phi.support()) == [0] and phi[0] < ell:
>                      bsharp = b
> ```

I don’t think it is necessarily worth it as it won’t be run in tight loops. Although it would just become `if len(phi.support()) == 1 and 0 in phi.support() and phi[0] < ell:` I guess.



---

archive/issue_comments_560439.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nI guess one other option would be the `SupportView` to support comparisons with lists (and/or tuple)?",
    "created_at": "2022-09-11T00:38:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560439",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:48'>Comment 48:</a>
I guess one other option would be the `SupportView` to support comparisons with lists (and/or tuple)?



---

archive/issue_comments_560440.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nWell, using `len(phi.support())` wouldn't be much better because `len` has to iterate through the whole thing. \nFaster would be to do \n\n```\n  i = iter(phi)\n  next(i)\n  try: next(i) except ...\n```",
    "created_at": "2022-09-11T00:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560440",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:49'>Comment 49:</a>
Well, using `len(phi.support())` wouldn't be much better because `len` has to iterate through the whole thing. 
Faster would be to do 

```
  i = iter(phi)
  next(i)
  try: next(i) except ...
```



---

archive/issue_comments_560441.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nReplying to [Travis Scrimshaw](#comment%3A48):\n> I guess one other option would be the `SupportView` to support comparisons with lists (and/or tuple)?\n\nWell, I think that's problematic because we don't even have `[1, 2] == (1, 2)`",
    "created_at": "2022-09-11T00:39:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560441",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:50'>Comment 50:</a>
Replying to [Travis Scrimshaw](#comment%3A48):
> I guess one other option would be the `SupportView` to support comparisons with lists (and/or tuple)?

Well, I think that's problematic because we don't even have `[1, 2] == (1, 2)`



---

archive/issue_comments_560442.json:
```json
{
    "body": "<a id='comment:51'>Comment 51:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A49):\n> Well, using `len(phi.support())` wouldn't be much better because `len` has to iterate through the whole thing. \n> Faster would be to do \n> \n> ```\n>   i = iter(phi)\n>   next(i)\n>   try: next(i) except ...\n> ```\n\nTrue, and that is complicated in an `if` statement.",
    "created_at": "2022-09-11T00:40:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560442",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:51'>Comment 51:</a>
Replying to [Matthias Köppe](#comment%3A49):
> Well, using `len(phi.support())` wouldn't be much better because `len` has to iterate through the whole thing. 
> Faster would be to do 
> 
> ```
>   i = iter(phi)
>   next(i)
>   try: next(i) except ...
> ```

True, and that is complicated in an `if` statement.



---

archive/issue_comments_560443.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nClear use case for https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.take",
    "created_at": "2022-09-11T00:41:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560443",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:52'>Comment 52:</a>
Clear use case for https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.take



---

archive/issue_comments_560444.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nor https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.strictly_n",
    "created_at": "2022-09-11T00:42:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560444",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:53'>Comment 53:</a>
or https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.strictly_n



---

archive/issue_comments_560445.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nor https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.only",
    "created_at": "2022-09-11T00:42:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560445",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:54'>Comment 54:</a>
or https://more-itertools.readthedocs.io/en/stable/api.html#more_itertools.only



---

archive/issue_comments_560446.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A50):\n> Replying to [Travis Scrimshaw](#comment%3A48):\n> > I guess one other option would be the `SupportView` to support comparisons with lists (and/or tuple)?\n\n> \n> Well, I think that's problematic because we don't even have `[1, 2] == (1, 2)`\n\nTransitivity of `==` is indeed good to have. Well, maybe just comparisons with a list then? Or at least temporarily with a deprecation?",
    "created_at": "2022-09-11T00:42:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560446",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:55'>Comment 55:</a>
Replying to [Matthias Köppe](#comment%3A50):
> Replying to [Travis Scrimshaw](#comment%3A48):
> > I guess one other option would be the `SupportView` to support comparisons with lists (and/or tuple)?

> 
> Well, I think that's problematic because we don't even have `[1, 2] == (1, 2)`

Transitivity of `==` is indeed good to have. Well, maybe just comparisons with a list then? Or at least temporarily with a deprecation?



---

archive/issue_comments_560447.json:
```json
{
    "body": "<a id='comment:56'>Comment 56:</a>\nThat would be doable but I think it's overkill.\n\nI think the license to break functions like this, from the Python 2 to 3 transition, is not expired yet",
    "created_at": "2022-09-11T00:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560447",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:56'>Comment 56:</a>
That would be doable but I think it's overkill.

I think the license to break functions like this, from the Python 2 to 3 transition, is not expired yet



---

archive/issue_comments_560448.json:
```json
{
    "body": "<a id='comment:57'>Comment 57:</a>\nThis is a little different as it was the support of a vector, not the keys of a `dict`.",
    "created_at": "2022-09-11T00:47:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560448",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:57'>Comment 57:</a>
This is a little different as it was the support of a vector, not the keys of a `dict`.



---

archive/issue_comments_560449.json:
```json
{
    "body": "<a id='comment:58'>Comment 58:</a>\nI'm referring to the general change in the Python library from explicit lists as return values to iterators",
    "created_at": "2022-09-11T00:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560449",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:58'>Comment 58:</a>
I'm referring to the general change in the Python library from explicit lists as return values to iterators



---

archive/issue_comments_560450.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nI think that would need a more general policy agreement discussed on sage-devel (as much as I would like to freely do this to a number of functions).",
    "created_at": "2022-09-11T00:53:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560450",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:59'>Comment 59:</a>
I think that would need a more general policy agreement discussed on sage-devel (as much as I would like to freely do this to a number of functions).



---

archive/issue_comments_560451.json:
```json
{
    "body": "<a id='comment:60'>Comment 60:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/026d8a5061f8d7de5e6366679f7047e4a83f541e\">026d8a5</a></td><td><code>src/sage/algebras/steenrod/steenrod_algebra.py: Use key=...tuple(....support()) for sorting by lex support</code></td></tr></table>\n",
    "created_at": "2022-09-11T00:54:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560451",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:60'>Comment 60:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/026d8a5061f8d7de5e6366679f7047e4a83f541e">026d8a5</a></td><td><code>src/sage/algebras/steenrod/steenrod_algebra.py: Use key=...tuple(....support()) for sorting by lex support</code></td></tr></table>




---

archive/issue_comments_560452.json:
```json
{
    "body": "Changed commit from **[88fe278](https://github.com/sagemath/sagetrac-mirror/commit/88fe278795354296ad74dcc41b61b2aeb301d900)** to **[026d8a5](https://github.com/sagemath/sagetrac-mirror/commit/026d8a5061f8d7de5e6366679f7047e4a83f541e)**",
    "created_at": "2022-09-11T00:54:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560452",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[88fe278](https://github.com/sagemath/sagetrac-mirror/commit/88fe278795354296ad74dcc41b61b2aeb301d900)** to **[026d8a5](https://github.com/sagemath/sagetrac-mirror/commit/026d8a5061f8d7de5e6366679f7047e4a83f541e)**



---

archive/issue_comments_560453.json:
```json
{
    "body": "<a id='comment:61'>Comment 61:</a>\nOK, OK, I'll write an `__eq__` method with deprecation",
    "created_at": "2022-09-11T00:56:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560453",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:61'>Comment 61:</a>
OK, OK, I'll write an `__eq__` method with deprecation



---

archive/issue_comments_560454.json:
```json
{
    "body": "<a id='comment:62'>Comment 62:</a>\nThank you. (So many things that return lists in `combinat` that would be better as iterators\u2026)",
    "created_at": "2022-09-11T01:00:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560454",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:62'>Comment 62:</a>
Thank you. (So many things that return lists in `combinat` that would be better as iterators…)



---

archive/issue_comments_560455.json:
```json
{
    "body": "<a id='comment:63'>Comment 63:</a>\nHa, this does catch a few places that do such comparisons",
    "created_at": "2022-09-11T01:05:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560455",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:63'>Comment 63:</a>
Ha, this does catch a few places that do such comparisons



---

archive/issue_comments_560456.json:
```json
{
    "body": "Changed commit from **[026d8a5](https://github.com/sagemath/sagetrac-mirror/commit/026d8a5061f8d7de5e6366679f7047e4a83f541e)** to **[a417411](https://github.com/sagemath/sagetrac-mirror/commit/a4174115ef0899344ecfb301c42f032de5b1950e)**",
    "created_at": "2022-09-11T01:06:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560456",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[026d8a5](https://github.com/sagemath/sagetrac-mirror/commit/026d8a5061f8d7de5e6366679f7047e4a83f541e)** to **[a417411](https://github.com/sagemath/sagetrac-mirror/commit/a4174115ef0899344ecfb301c42f032de5b1950e)**



---

archive/issue_comments_560457.json:
```json
{
    "body": "<a id='comment:64'>Comment 64:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4174115ef0899344ecfb301c42f032de5b1950e\">a417411</a></td><td><code>SupportView.__eq__, __ne__: New</code></td></tr></table>\n",
    "created_at": "2022-09-11T01:06:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560457",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:64'>Comment 64:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4174115ef0899344ecfb301c42f032de5b1950e">a417411</a></td><td><code>SupportView.__eq__, __ne__: New</code></td></tr></table>




---

archive/issue_comments_560458.json:
```json
{
    "body": "Changed commit from **[a417411](https://github.com/sagemath/sagetrac-mirror/commit/a4174115ef0899344ecfb301c42f032de5b1950e)** to **[b80989f](https://github.com/sagemath/sagetrac-mirror/commit/b80989ff00667e5578f04a28a3d7ec6ff679c498)**",
    "created_at": "2022-09-11T01:08:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560458",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a417411](https://github.com/sagemath/sagetrac-mirror/commit/a4174115ef0899344ecfb301c42f032de5b1950e)** to **[b80989f](https://github.com/sagemath/sagetrac-mirror/commit/b80989ff00667e5578f04a28a3d7ec6ff679c498)**



---

archive/issue_comments_560459.json:
```json
{
    "body": "<a id='comment:65'>Comment 65:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b80989ff00667e5578f04a28a3d7ec6ff679c498\">b80989f</a></td><td><code>src/sage/combinat/sf/character.py: Use list(....support())</code></td></tr></table>\n",
    "created_at": "2022-09-11T01:08:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560459",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:65'>Comment 65:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b80989ff00667e5578f04a28a3d7ec6ff679c498">b80989f</a></td><td><code>src/sage/combinat/sf/character.py: Use list(....support())</code></td></tr></table>




---

archive/issue_comments_560460.json:
```json
{
    "body": "<a id='comment:66'>Comment 66:</a>\nok, done",
    "created_at": "2022-09-11T01:08:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560460",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:66'>Comment 66:</a>
ok, done



---

archive/issue_comments_560461.json:
```json
{
    "body": "<a id='comment:67'>Comment 67:</a>\nShould we also do comparisons with different `SupportView` objects, following python?\n\n```\nsage: d = {1:1, 2:2}\nsage: dp = {1:-1, 2:-2}\nsage: d.keys() == dp.keys()\nTrue\n```\nSorry if this was something you were planning to support and hadn\u2019t gotten to that stage yet.",
    "created_at": "2022-09-11T01:41:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560461",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:67'>Comment 67:</a>
Should we also do comparisons with different `SupportView` objects, following python?

```
sage: d = {1:1, 2:2}
sage: dp = {1:-1, 2:-2}
sage: d.keys() == dp.keys()
True
```
Sorry if this was something you were planning to support and hadn’t gotten to that stage yet.



---

archive/issue_comments_560462.json:
```json
{
    "body": "<a id='comment:68'>Comment 68:</a>\nReplying to [Matthias K\u00f6ppe](#comment%3A66):\n> ok, done\n\nThank you.",
    "created_at": "2022-09-11T01:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560462",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:68'>Comment 68:</a>
Replying to [Matthias Köppe](#comment%3A66):
> ok, done

Thank you.



---

archive/issue_comments_560463.json:
```json
{
    "body": "<a id='comment:69'>Comment 69:</a>\nReplying to [Travis Scrimshaw](#comment%3A67):\n> Should we also do comparisons with different `SupportView` objects, following python?\n> \n> ```\n> sage: d = {1:1, 2:2}\n> sage: dp = {1:-1, 2:-2}\n> sage: d.keys() == dp.keys()\n> True\n> ```\n> Sorry if this was something you were planning to support and hadn\u2019t gotten to that stage yet.\n\nI'm unsure about this, and I think I would defer it to a follow-up ticket.\n\nIt could get full `collections.abc.Set` semantics actually, including `<=` as subset test etc. But that's a bit more work",
    "created_at": "2022-09-11T01:46:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560463",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:69'>Comment 69:</a>
Replying to [Travis Scrimshaw](#comment%3A67):
> Should we also do comparisons with different `SupportView` objects, following python?
> 
> ```
> sage: d = {1:1, 2:2}
> sage: dp = {1:-1, 2:-2}
> sage: d.keys() == dp.keys()
> True
> ```
> Sorry if this was something you were planning to support and hadn’t gotten to that stage yet.

I'm unsure about this, and I think I would defer it to a follow-up ticket.

It could get full `collections.abc.Set` semantics actually, including `<=` as subset test etc. But that's a bit more work



---

archive/issue_comments_560464.json:
```json
{
    "body": "<a id='comment:70'>Comment 70:</a>\nIn view of #29218, I would also move `__iter__` from `IndexedFreeModuleElement` to the category, next to `__len__`. Together they merely provide a default implementation of the `Sized` `Iterable` protocols. (Dense modules necessarily override both.)\n\nThe `length` method, on the other hand, is full specified and would be changed to not go through `__len__`.",
    "created_at": "2022-09-11T02:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560464",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:70'>Comment 70:</a>
In view of #29218, I would also move `__iter__` from `IndexedFreeModuleElement` to the category, next to `__len__`. Together they merely provide a default implementation of the `Sized` `Iterable` protocols. (Dense modules necessarily override both.)

The `length` method, on the other hand, is full specified and would be changed to not go through `__len__`.



---

archive/issue_comments_560465.json:
```json
{
    "body": "<a id='comment:71'>Comment 71:</a>\nBut that will go to #29218.",
    "created_at": "2022-09-11T02:38:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560465",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:71'>Comment 71:</a>
But that will go to #29218.



---

archive/issue_events_452803.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-11T04:10:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452803"
}
```



---

archive/issue_events_452804.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-11T04:10:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452804"
}
```



---

archive/issue_comments_560466.json:
```json
{
    "body": "<a id='comment:72'>Comment 72:</a>\n\n```\nsage -t --random-seed=124699541928353137721504742146487601068 doc/en/thematic_tutorials/lie/weyl_character_ring.rst  # 3 doctests failed\nsage -t --random-seed=124699541928353137721504742146487601068 sage/algebras/quantum_groups/fock_space.py  # 80 doctests failed\nsage -t --random-seed=124699541928353137721504742146487601068 sage/graphs/generators/random.py  # 1 doctest failed\nsage -t --random-seed=124699541928353137721504742146487601068 sage/modules/tutorial_free_modules.py  # 1 doctest failed\n```",
    "created_at": "2022-09-11T04:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560466",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:72'>Comment 72:</a>

```
sage -t --random-seed=124699541928353137721504742146487601068 doc/en/thematic_tutorials/lie/weyl_character_ring.rst  # 3 doctests failed
sage -t --random-seed=124699541928353137721504742146487601068 sage/algebras/quantum_groups/fock_space.py  # 80 doctests failed
sage -t --random-seed=124699541928353137721504742146487601068 sage/graphs/generators/random.py  # 1 doctest failed
sage -t --random-seed=124699541928353137721504742146487601068 sage/modules/tutorial_free_modules.py  # 1 doctest failed
```



---

archive/issue_comments_560467.json:
```json
{
    "body": "<a id='comment:73'>Comment 73:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57273ea3262a27501953d1af04f6d8f35110b0da\">57273ea</a></td><td><code>src/doc/en/thematic_tutorials/lie/weyl_character_ring.rst: Use key=...tuple(....support()) for sorting by lex support</code></td></tr></table>\n",
    "created_at": "2022-09-11T04:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560467",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:73'>Comment 73:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57273ea3262a27501953d1af04f6d8f35110b0da">57273ea</a></td><td><code>src/doc/en/thematic_tutorials/lie/weyl_character_ring.rst: Use key=...tuple(....support()) for sorting by lex support</code></td></tr></table>




---

archive/issue_comments_560468.json:
```json
{
    "body": "Changed commit from **[b80989f](https://github.com/sagemath/sagetrac-mirror/commit/b80989ff00667e5578f04a28a3d7ec6ff679c498)** to **[57273ea](https://github.com/sagemath/sagetrac-mirror/commit/57273ea3262a27501953d1af04f6d8f35110b0da)**",
    "created_at": "2022-09-11T04:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560468",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b80989f](https://github.com/sagemath/sagetrac-mirror/commit/b80989ff00667e5578f04a28a3d7ec6ff679c498)** to **[57273ea](https://github.com/sagemath/sagetrac-mirror/commit/57273ea3262a27501953d1af04f6d8f35110b0da)**



---

archive/issue_comments_560469.json:
```json
{
    "body": "<a id='comment:74'>Comment 74:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ce669c687776a781f01c86439fc8739a25eb4cc\">6ce669c</a></td><td><code>src/sage/modules/tutorial_free_modules.py: Fix doctest output</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2fe3b981c7ebf07dfe8992d5f591b3bb73841ede\">2fe3b98</a></td><td><code>src/sage/algebras/quantum_groups/fock_space.py: Use sorted() with support, not sort</code></td></tr></table>\n",
    "created_at": "2022-09-11T04:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560469",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:74'>Comment 74:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ce669c687776a781f01c86439fc8739a25eb4cc">6ce669c</a></td><td><code>src/sage/modules/tutorial_free_modules.py: Fix doctest output</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2fe3b981c7ebf07dfe8992d5f591b3bb73841ede">2fe3b98</a></td><td><code>src/sage/algebras/quantum_groups/fock_space.py: Use sorted() with support, not sort</code></td></tr></table>




---

archive/issue_comments_560470.json:
```json
{
    "body": "Changed commit from **[57273ea](https://github.com/sagemath/sagetrac-mirror/commit/57273ea3262a27501953d1af04f6d8f35110b0da)** to **[2fe3b98](https://github.com/sagemath/sagetrac-mirror/commit/2fe3b981c7ebf07dfe8992d5f591b3bb73841ede)**",
    "created_at": "2022-09-11T04:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560470",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[57273ea](https://github.com/sagemath/sagetrac-mirror/commit/57273ea3262a27501953d1af04f6d8f35110b0da)** to **[2fe3b98](https://github.com/sagemath/sagetrac-mirror/commit/2fe3b981c7ebf07dfe8992d5f591b3bb73841ede)**



---

archive/issue_comments_560471.json:
```json
{
    "body": "<a id='comment:75'>Comment 75:</a>\nThe failure in `sage/graphs/generators/random.py` is an unrelated random failure, I've added it to #32544.",
    "created_at": "2022-09-11T04:20:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560471",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:75'>Comment 75:</a>
The failure in `sage/graphs/generators/random.py` is an unrelated random failure, I've added it to #32544.



---

archive/issue_events_452805.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-11T04:23:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452805"
}
```



---

archive/issue_events_452806.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-11T04:23:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452806"
}
```



---

archive/issue_comments_560472.json:
```json
{
    "body": "<a id='comment:77'>Comment 77:</a>\nAll morally green, ready for review\n\n(The Build&Test failure is another well-known random failure, in `sage/schemes/toric/sheaf/klyachko.py`, and Lint failures are known and unrelated.)",
    "created_at": "2022-09-11T17:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560472",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:77'>Comment 77:</a>
All morally green, ready for review

(The Build&Test failure is another well-known random failure, in `sage/schemes/toric/sheaf/klyachko.py`, and Lint failures are known and unrelated.)



---

archive/issue_events_452807.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-09-20T07:57:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452807"
}
```



---

archive/issue_events_452808.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-09-20T07:57:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452808"
}
```



---

archive/issue_comments_560473.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2022-09-20T07:57:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560473",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_560474.json:
```json
{
    "body": "<a id='comment:78'>Comment 78:</a>\nSorry, lost track of this. LGTM.",
    "created_at": "2022-09-20T07:57:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560474",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:78'>Comment 78:</a>
Sorry, lost track of this. LGTM.



---

archive/issue_comments_560475.json:
```json
{
    "body": "<a id='comment:79'>Comment 79:</a>\nThank you!",
    "created_at": "2022-09-20T16:29:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560475",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:79'>Comment 79:</a>
Thank you!



---

archive/issue_events_452809.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-22T22:35:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452809"
}
```



---

archive/issue_events_452810.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4db51ba832e77886c9f42c2ada4be83106191261",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-09-22T22:35:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34509#event-452810"
}
```



---

archive/issue_comments_560476.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/make_indexedfreemoduleelement_a_collections_abc_mapping](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/make_indexedfreemoduleelement_a_collections_abc_mapping)** to **[2fe3b98](https://github.com/sagemath/sagetrac-mirror/commit/2fe3b981c7ebf07dfe8992d5f591b3bb73841ede)**",
    "created_at": "2022-09-22T22:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34509#issuecomment-560476",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/make_indexedfreemoduleelement_a_collections_abc_mapping](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/make_indexedfreemoduleelement_a_collections_abc_mapping)** to **[2fe3b98](https://github.com/sagemath/sagetrac-mirror/commit/2fe3b981c7ebf07dfe8992d5f591b3bb73841ede)**
