# Issue 34235: Error in comparing two Symbolic Ring elements

archive/issues_033998.json:
```json
{
    "body": "It seems a bug:\n\n```\nsage: bool(AA(sqrt(2))/pi == sqrt(2)/pi)\nTypeError: ECL says: THROW: The catch MACSYMA-QUIT is undefined.\n```\nThe following comparison is fine, though.\n\n```\nsage: bool(AA(sqrt(2)) == sqrt(2))\nTrue\n```\n\nTo fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that \n- handles the case of elements for which Sage can find a radical expression and \n- raises an error in all other cases. \nThis is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n\n\n**CC:**  @mkoeppe @DaveWitteMorris @videlec @tscrim\n\n**Branch/Commit:** [58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/34235\n\n",
    "closed_at": "2022-09-22T22:35:39Z",
    "created_at": "2022-07-28T18:45:19Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Error in comparing two Symbolic Ring elements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34235",
    "user": "https://github.com/yuan-zhou"
}
```
It seems a bug:

```
sage: bool(AA(sqrt(2))/pi == sqrt(2)/pi)
TypeError: ECL says: THROW: The catch MACSYMA-QUIT is undefined.
```
The following comparison is fine, though.

```
sage: bool(AA(sqrt(2)) == sqrt(2))
True
```

To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that 
- handles the case of elements for which Sage can find a radical expression and 
- raises an error in all other cases. 
This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.


**CC:**  @mkoeppe @DaveWitteMorris @videlec @tscrim

**Branch/Commit:** [58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)

**Reviewer:** Travis Scrimshaw

**Author:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/34235





---

archive/issue_comments_557091.json:
```json
{
    "body": "<a id='comment:2'></a>\nConfirmed in 9.7.beta5",
    "created_at": "2022-07-28T23:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557091",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Confirmed in 9.7.beta5



---

archive/issue_comments_557092.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/error_in_comparing_two_symbolic_ring_elements](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/error_in_comparing_two_symbolic_ring_elements)",
    "created_at": "2022-07-29T02:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557092",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/error_in_comparing_two_symbolic_ring_elements](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/error_in_comparing_two_symbolic_ring_elements)



---

archive/issue_comments_557093.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -10,3 +10,6 @@\n sage: bool(AA(sqrt(2)) == sqrt(2))\n True\n ```\n+\n+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the easiest cases (rationals, square roots of rationals) and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n+\n``````\n",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557093",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -10,3 +10,6 @@
 sage: bool(AA(sqrt(2)) == sqrt(2))
 True
 ```
+
+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the easiest cases (rationals, square roots of rationals) and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
+
``````




---

archive/issue_comments_557094.json:
```json
{
    "body": "<a id='comment:4'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a627ce685f4ac30ba9660f66b24fae246209c5d1\">a627ce6</a></td><td><code>src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): New</code></td></tr></table>\n",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557094",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a627ce685f4ac30ba9660f66b24fae246209c5d1">a627ce6</a></td><td><code>src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): New</code></td></tr></table>




---

archive/issue_events_309644.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-07-29T02:07:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-309644"
}
```



---

archive/issue_comments_557095.json:
```json
{
    "body": "**Commit:** [a627ce685f4ac30ba9660f66b24fae246209c5d1](https://github.com/sagemath/sagetrac-mirror/commit/a627ce685f4ac30ba9660f66b24fae246209c5d1)",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557095",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [a627ce685f4ac30ba9660f66b24fae246209c5d1](https://github.com/sagemath/sagetrac-mirror/commit/a627ce685f4ac30ba9660f66b24fae246209c5d1)



---

archive/issue_comments_557096.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557096",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_557097.json:
```json
{
    "body": "**Changing commit** from \"[a627ce685f4ac30ba9660f66b24fae246209c5d1](https://github.com/sagemath/sagetrac-mirror/commit/a627ce685f4ac30ba9660f66b24fae246209c5d1)\" to \"[6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0](https://github.com/sagemath/sagetrac-mirror/commit/6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0)\".",
    "created_at": "2022-07-29T04:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557097",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a627ce685f4ac30ba9660f66b24fae246209c5d1](https://github.com/sagemath/sagetrac-mirror/commit/a627ce685f4ac30ba9660f66b24fae246209c5d1)" to "[6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0](https://github.com/sagemath/sagetrac-mirror/commit/6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0)".



---

archive/issue_comments_557098.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0\">6204a76</a></td><td><code>src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): Fixup</code></td></tr></table>\n",
    "created_at": "2022-07-29T04:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557098",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0">6204a76</a></td><td><code>src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): Fixup</code></td></tr></table>




---

archive/issue_comments_557099.json:
```json
{
    "body": "**Changing commit** from \"[6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0](https://github.com/sagemath/sagetrac-mirror/commit/6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0)\" to \"[3e560cf5b30377da9d3122427f81f9b0ef93c5c4](https://github.com/sagemath/sagetrac-mirror/commit/3e560cf5b30377da9d3122427f81f9b0ef93c5c4)\".",
    "created_at": "2022-07-29T04:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557099",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0](https://github.com/sagemath/sagetrac-mirror/commit/6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0)" to "[3e560cf5b30377da9d3122427f81f9b0ef93c5c4](https://github.com/sagemath/sagetrac-mirror/commit/3e560cf5b30377da9d3122427f81f9b0ef93c5c4)".



---

archive/issue_comments_557100.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e560cf5b30377da9d3122427f81f9b0ef93c5c4\">3e560cf</a></td><td><code>src/sage/rings/qqbar.py: Add doctest</code></td></tr></table>\n",
    "created_at": "2022-07-29T04:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557100",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e560cf5b30377da9d3122427f81f9b0ef93c5c4">3e560cf</a></td><td><code>src/sage/rings/qqbar.py: Add doctest</code></td></tr></table>




---

archive/issue_comments_557101.json:
```json
{
    "body": "<a id='comment:7'></a>\nInstead of defining `_maxima_init_`, perhaps it's better to define `_symbolic_`",
    "created_at": "2022-07-29T05:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557101",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Instead of defining `_maxima_init_`, perhaps it's better to define `_symbolic_`



---

archive/issue_comments_557102.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061\">58f4cd1</a></td><td><code>src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): Generalize using radical_expression</code></td></tr></table>\n",
    "created_at": "2022-07-29T05:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557102",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061">58f4cd1</a></td><td><code>src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): Generalize using radical_expression</code></td></tr></table>




---

archive/issue_comments_557103.json:
```json
{
    "body": "**Changing commit** from \"[3e560cf5b30377da9d3122427f81f9b0ef93c5c4](https://github.com/sagemath/sagetrac-mirror/commit/3e560cf5b30377da9d3122427f81f9b0ef93c5c4)\" to \"[58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)\".",
    "created_at": "2022-07-29T05:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3e560cf5b30377da9d3122427f81f9b0ef93c5c4](https://github.com/sagemath/sagetrac-mirror/commit/3e560cf5b30377da9d3122427f81f9b0ef93c5c4)" to "[58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)".



---

archive/issue_comments_557104.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -11,5 +11,5 @@\n True\n ```\n \n-To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the easiest cases (rationals, square roots of rationals) and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the case of elements for which Sage can find a radical expression and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n \n``````\n",
    "created_at": "2022-07-29T22:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557104",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -11,5 +11,5 @@
 True
 ```
 
-To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the easiest cases (rationals, square roots of rationals) and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the case of elements for which Sage can find a radical expression and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
 
``````




---

archive/issue_comments_557105.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -11,5 +11,8 @@\n True\n ```\n \n-To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the case of elements for which Sage can find a radical expression and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that \n+- handles the case of elements for which Sage can find a radical expression and \n+- raises an error in all other cases. \n+This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n \n``````\n",
    "created_at": "2022-07-29T22:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557105",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -11,5 +11,8 @@
 True
 ```
 
-To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the case of elements for which Sage can find a radical expression and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that 
+- handles the case of elements for which Sage can find a radical expression and 
+- raises an error in all other cases. 
+This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
 
``````




---

archive/issue_comments_557106.json:
```json
{
    "body": "<a id='comment:13'></a>\nLGTM.",
    "created_at": "2022-08-31T02:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557106",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>
LGTM.



---

archive/issue_comments_557107.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2022-08-31T02:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557107",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_events_309645.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-08-31T02:11:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-309645"
}
```



---

archive/issue_events_309646.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-08-31T02:11:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-309646"
}
```



---

archive/issue_comments_557108.json:
```json
{
    "body": "<a id='comment:14'></a>\nThanks!",
    "created_at": "2022-08-31T02:52:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557108",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
Thanks!



---

archive/issue_events_309647.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-309647"
}
```



---

archive/issue_events_309648.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-309648"
}
```



---

archive/issue_comments_557109.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/error_in_comparing_two_symbolic_ring_elements](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/error_in_comparing_two_symbolic_ring_elements)\" to \"[58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)\".",
    "created_at": "2022-09-22T22:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-557109",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/error_in_comparing_two_symbolic_ring_elements](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/error_in_comparing_two_symbolic_ring_elements)" to "[58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)".



---

archive/issue_events_309649.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-22T22:35:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-309649"
}
```



---

archive/issue_events_309650.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-22T22:35:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-309650"
}
```
