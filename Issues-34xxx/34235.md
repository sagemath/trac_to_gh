# Issue 34235: Error in comparing two Symbolic Ring elements

archive/issues_033998.json:
```json
{
    "body": "It seems a bug:\n\n```\nsage: bool(AA(sqrt(2))/pi == sqrt(2)/pi)\nTypeError: ECL says: THROW: The catch MACSYMA-QUIT is undefined.\n```\nThe following comparison is fine, though.\n\n```\nsage: bool(AA(sqrt(2)) == sqrt(2))\nTrue\n```\n\nTo fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that \n- handles the case of elements for which Sage can find a radical expression and \n- raises an error in all other cases. \nThis is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n\n\nCC:  @mkoeppe @davewittemorris @videlec @tscrim\n\nBranch/Commit: [58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)\n\nReviewer: Travis Scrimshaw\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/34235\n\n",
    "closed_at": "2022-09-22T22:35:39Z",
    "created_at": "2022-07-28T18:45:19Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Error in comparing two Symbolic Ring elements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34235",
    "user": "https://github.com/yuan-zhou"
}
```
It seems a bug:

```
sage: bool(AA(sqrt(2))/pi == sqrt(2)/pi)
TypeError: ECL says: THROW: The catch MACSYMA-QUIT is undefined.
```
The following comparison is fine, though.

```
sage: bool(AA(sqrt(2)) == sqrt(2))
True
```

To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that 
- handles the case of elements for which Sage can find a radical expression and 
- raises an error in all other cases. 
This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.


CC:  @mkoeppe @davewittemorris @videlec @tscrim

Branch/Commit: [58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)

Reviewer: Travis Scrimshaw

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/34235





---

archive/issue_comments_681588.json:
```json
{
    "body": "<a id='comment:2'></a>\nConfirmed in 9.7.beta5",
    "created_at": "2022-07-28T23:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681588",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
Confirmed in 9.7.beta5



---

archive/issue_comments_681589.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/error_in_comparing_two_symbolic_ring_elements\"",
    "created_at": "2022-07-29T02:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681589",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/error_in_comparing_two_symbolic_ring_elements"



---

archive/issue_comments_681590.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,6 @@\n sage: bool(AA(sqrt(2)) == sqrt(2))\n True\n ```\n+\n+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the easiest cases (rationals, square roots of rationals) and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n+\n``````\n",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681590",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,6 @@
 sage: bool(AA(sqrt(2)) == sqrt(2))
 True
 ```
+
+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the easiest cases (rationals, square roots of rationals) and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
+
``````




---

archive/issue_comments_681591.json:
```json
{
    "body": "<a id='comment:4'></a>\nNew commits:\n|                                                                                                                                          |                                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|\n|[a627ce6](https://github.com/sagemath/sagetrac-mirror/commit/a627ce685f4ac30ba9660f66b24fae246209c5d1)|`src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): New`|",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681591",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
New commits:
|                                                                                                                                          |                                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|
|[a627ce6](https://github.com/sagemath/sagetrac-mirror/commit/a627ce685f4ac30ba9660f66b24fae246209c5d1)|`src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): New`|



---

archive/issue_comments_681592.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681592",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_681593.json:
```json
{
    "body": "Changing commit from \"\" to \"a627ce685f4ac30ba9660f66b24fae246209c5d1\"",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681593",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "a627ce685f4ac30ba9660f66b24fae246209c5d1"



---

archive/issue_comments_681594.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2022-07-29T02:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681594",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_681595.json:
```json
{
    "body": "Changing commit from \"a627ce685f4ac30ba9660f66b24fae246209c5d1\" to \"6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0\"",
    "created_at": "2022-07-29T04:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681595",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a627ce685f4ac30ba9660f66b24fae246209c5d1" to "6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0"



---

archive/issue_comments_681596.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|\n|[6204a76](https://github.com/sagemath/sagetrac-mirror/commit/6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0)|`src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): Fixup`|",
    "created_at": "2022-07-29T04:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681596",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
|[6204a76](https://github.com/sagemath/sagetrac-mirror/commit/6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0)|`src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): Fixup`|



---

archive/issue_comments_681597.json:
```json
{
    "body": "Changing commit from \"6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0\" to \"3e560cf5b30377da9d3122427f81f9b0ef93c5c4\"",
    "created_at": "2022-07-29T04:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681597",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6204a76d0ec2cbc3cd350cd82f77b2b3ec8088c0" to "3e560cf5b30377da9d3122427f81f9b0ef93c5c4"



---

archive/issue_comments_681598.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[3e560cf](https://github.com/sagemath/sagetrac-mirror/commit/3e560cf5b30377da9d3122427f81f9b0ef93c5c4)|`src/sage/rings/qqbar.py: Add doctest`|",
    "created_at": "2022-07-29T04:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681598",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[3e560cf](https://github.com/sagemath/sagetrac-mirror/commit/3e560cf5b30377da9d3122427f81f9b0ef93c5c4)|`src/sage/rings/qqbar.py: Add doctest`|



---

archive/issue_comments_681599.json:
```json
{
    "body": "<a id='comment:7'></a>\nInstead of defining `_maxima_init_`, perhaps it's better to define `_symbolic_`",
    "created_at": "2022-07-29T05:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681599",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Instead of defining `_maxima_init_`, perhaps it's better to define `_symbolic_`



---

archive/issue_comments_681600.json:
```json
{
    "body": "<a id='comment:8'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|\n|[58f4cd1](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)|`src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): Generalize using radical_expression`|",
    "created_at": "2022-07-29T05:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681600",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
|[58f4cd1](https://github.com/sagemath/sagetrac-mirror/commit/58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061)|`src/sage/rings/qqbar.py (AlgebraicNumber_base._maxima_init_): Generalize using radical_expression`|



---

archive/issue_comments_681601.json:
```json
{
    "body": "Changing commit from \"3e560cf5b30377da9d3122427f81f9b0ef93c5c4\" to \"58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061\"",
    "created_at": "2022-07-29T05:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681601",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3e560cf5b30377da9d3122427f81f9b0ef93c5c4" to "58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061"



---

archive/issue_comments_681602.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,5 +11,5 @@\n True\n ```\n \n-To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the easiest cases (rationals, square roots of rationals) and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the case of elements for which Sage can find a radical expression and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n \n``````\n",
    "created_at": "2022-07-29T22:53:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681602",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,5 +11,5 @@
 True
 ```
 
-To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the easiest cases (rationals, square roots of rationals) and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the case of elements for which Sage can find a radical expression and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
 
``````




---

archive/issue_comments_681603.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,5 +11,8 @@\n True\n ```\n \n-To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the case of elements for which Sage can find a radical expression and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that \n+- handles the case of elements for which Sage can find a radical expression and \n+- raises an error in all other cases. \n+This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.\n \n``````\n",
    "created_at": "2022-07-29T22:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681603",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,5 +11,8 @@
 True
 ```
 
-To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that handles the case of elements for which Sage can find a radical expression and raises an error in all other cases. This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
+To fix this, we provide elements of `AA` and `QQbar` with a `_maxima_init_` method that 
+- handles the case of elements for which Sage can find a radical expression and 
+- raises an error in all other cases. 
+This is better than sending the unusable print representation of algebraic numbers (including `?`) to Maxima.
 
``````




---

archive/issue_comments_681604.json:
```json
{
    "body": "<a id='comment:13'></a>\nLGTM.",
    "created_at": "2022-08-31T02:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681604",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>
LGTM.



---

archive/issue_comments_681605.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2022-08-31T02:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681605",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_681606.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-31T02:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681606",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_681607.json:
```json
{
    "body": "<a id='comment:14'></a>\nThanks!",
    "created_at": "2022-08-31T02:52:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681607",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
Thanks!



---

archive/issue_events_100517.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-100517"
}
```



---

archive/issue_comments_681608.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-09-22T22:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681608",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_681609.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/error_in_comparing_two_symbolic_ring_elements\" to \"58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061\"",
    "created_at": "2022-09-22T22:35:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34235#issuecomment-681609",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/error_in_comparing_two_symbolic_ring_elements" to "58f4cd1c63b7d7a8aee04de5d8c53a7fac27d061"



---

archive/issue_events_100518.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-09-22T22:35:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34235",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34235#event-100518"
}
```
