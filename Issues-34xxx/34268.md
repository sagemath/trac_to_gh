# Issue 34268: Reduce R to a dummy package, upgrade rpy2 to 3.4.5

archive/issues_034031.json:
```json
{
    "body": "CC:  @EmmanuelCharpentier @videlec @dimpase @isuruf @jhpalmieri @novoselt @williamstein\n\nWe reduce the unmaintained `r` package (stuck at 3.6.3) so that we detect a system installation of R (>= 3.5) but do not attempt to install it ourselves.\n\nWhen R is found as a system package, `rpy2` will be built; otherwise it won't.\n\nrpy2 3.5.x only supports R >= 4.0 according to\nhttps://rpy2.github.io/doc/v3.5.x/html/overview.html#requirements\n\nHere we upgrade rpy2 to 3.4.5, the latest that still supports R >= 3.5 according to https://rpy2.github.io/doc/v3.4.x/html/overview.html#requirements\n\nSupport for R < 3.5 was already dropped in the rpy 3.3.x series (our current version of rpy2 is 3.3.6).\n\nAccording to https://repology.org/project/r/versions, we will thus drop support for R on the ancient platforms:\n- `ubuntu-trusty` (R 3.0.2; past [End of Standard Support](https://wiki.ubuntu.com/Releases); EOL April 2024]), \n- `ubuntu-xenial` (R 3.2.3; past End of Standard Support; EOL April 2026), \n- `ubuntu-bionic` (R 3.4.4; End of Standard Support: April 2023)\n- `debian-stretch` (R 3.3.3; past EOL)\n- `fedora-26` (R 3.4.4; past EOL), \nas well as on Cygwin. (See #32074)\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/34268\n\n",
    "closed_at": "2022-10-11T09:14:43Z",
    "created_at": "2022-08-03T16:31:06Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Reduce R to a dummy package, upgrade rpy2 to 3.4.5",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34268",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @EmmanuelCharpentier @videlec @dimpase @isuruf @jhpalmieri @novoselt @williamstein

We reduce the unmaintained `r` package (stuck at 3.6.3) so that we detect a system installation of R (>= 3.5) but do not attempt to install it ourselves.

When R is found as a system package, `rpy2` will be built; otherwise it won't.

rpy2 3.5.x only supports R >= 4.0 according to
https://rpy2.github.io/doc/v3.5.x/html/overview.html#requirements

Here we upgrade rpy2 to 3.4.5, the latest that still supports R >= 3.5 according to https://rpy2.github.io/doc/v3.4.x/html/overview.html#requirements

Support for R < 3.5 was already dropped in the rpy 3.3.x series (our current version of rpy2 is 3.3.6).

According to https://repology.org/project/r/versions, we will thus drop support for R on the ancient platforms:
- `ubuntu-trusty` (R 3.0.2; past [End of Standard Support](https://wiki.ubuntu.com/Releases); EOL April 2024]), 
- `ubuntu-xenial` (R 3.2.3; past End of Standard Support; EOL April 2026), 
- `ubuntu-bionic` (R 3.4.4; End of Standard Support: April 2023)
- `debian-stretch` (R 3.3.3; past EOL)
- `fedora-26` (R 3.4.4; past EOL), 
as well as on Cygwin. (See #32074)


Issue created by migration from https://trac.sagemath.org/ticket/34268





---

archive/issue_comments_482437.json:
```json
{
    "body": "good idea",
    "created_at": "2022-08-03T16:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482437",
    "user": "https://github.com/dimpase"
}
```

good idea



---

archive/issue_comments_482438.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-03T18:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482438",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482439.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-03T18:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482439",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482440.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-08-03T18:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482440",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_482441.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-03T19:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482441",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482442.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-03T19:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482442",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482443.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-03T19:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482443",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_482444.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-03T19:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482445.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-03T20:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482445",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_089310.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-03T20:31:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34268#event-89310"
}
```



---

archive/issue_comments_482446.json:
```json
{
    "body": "How about requiring R to be at least version 4 (4.0.0 was released over two years ago)? The current R version is 4.2.1.\nThis would allow newer rpy2.",
    "created_at": "2022-08-04T09:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482446",
    "user": "https://github.com/dimpase"
}
```

How about requiring R to be at least version 4 (4.0.0 was released over two years ago)? The current R version is 4.2.1.
This would allow newer rpy2.



---

archive/issue_comments_482447.json:
```json
{
    "body": "How do the \"rpy2\" optional tests in [interfaces/r.py](https://github.com/sagemath/sage/blob/develop/src/sage/interfaces/r.py) do with this?",
    "created_at": "2022-08-04T12:32:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482447",
    "user": "https://github.com/kcrisman"
}
```

How do the "rpy2" optional tests in [interfaces/r.py](https://github.com/sagemath/sage/blob/develop/src/sage/interfaces/r.py) do with this?



---

archive/issue_comments_482448.json:
```json
{
    "body": "Replying to [comment:21 kcrisman]:\n> How do the \"rpy2\" optional tests in [interfaces/r.py](https://github.com/sagemath/sage/blob/develop/src/sage/interfaces/r.py) do with this?\n\n\nNo change necessary",
    "created_at": "2022-08-04T16:50:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482448",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:21 kcrisman]:
> How do the "rpy2" optional tests in [interfaces/r.py](https://github.com/sagemath/sage/blob/develop/src/sage/interfaces/r.py) do with this?


No change necessary



---

archive/issue_comments_482449.json:
```json
{
    "body": "Replying to [comment:20 dimpase]:\n> How about requiring R to be at least version 4 (4.0.0 was released over two years ago)? The current R version is 4.2.1.\n\n\nThis would make R unavailable on a lot more platforms, so I don't think it would be the right choice.\n\nSee https://repology.org/project/r/versions: `debian-buster`, `fedora` <= 32, `opensuse` <= 15.3, `ubuntu` <= focal",
    "created_at": "2022-08-04T16:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482449",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:20 dimpase]:
> How about requiring R to be at least version 4 (4.0.0 was released over two years ago)? The current R version is 4.2.1.


This would make R unavailable on a lot more platforms, so I don't think it would be the right choice.

See https://repology.org/project/r/versions: `debian-buster`, `fedora` <= 32, `opensuse` <= 15.3, `ubuntu` <= focal



---

archive/issue_comments_482450.json:
```json
{
    "body": "Fedora <= 32 is past EOL. We should not be concerned about it.\nFurther, accoding to https://cran.r-project.org/bin/linux/ubuntu/fullREADME.html, Ubunty Focal LTS has R 4.2.",
    "created_at": "2022-08-05T09:55:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482450",
    "user": "https://github.com/dimpase"
}
```

Fedora <= 32 is past EOL. We should not be concerned about it.
Further, accoding to https://cran.r-project.org/bin/linux/ubuntu/fullREADME.html, Ubunty Focal LTS has R 4.2.



---

archive/issue_comments_482451.json:
```json
{
    "body": "Replying to [comment:24 dimpase]:\n> Further, accoding to https://cran.r-project.org/bin/linux/ubuntu/fullREADME.html, Ubunty Focal LTS has R 4.2.\n\n\nNo, that's not what the page says.\n\nThey are offering a custom repository with their own package for ubuntu focal.",
    "created_at": "2022-08-05T16:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482451",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:24 dimpase]:
> Further, accoding to https://cran.r-project.org/bin/linux/ubuntu/fullREADME.html, Ubunty Focal LTS has R 4.2.


No, that's not what the page says.

They are offering a custom repository with their own package for ubuntu focal.



---

archive/issue_comments_482452.json:
```json
{
    "body": "Other than just the fact that it's newer, what is the compelling reason to push for a later version than 3.4.5 of `rpy2`?",
    "created_at": "2022-08-05T16:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482452",
    "user": "https://github.com/jhpalmieri"
}
```

Other than just the fact that it's newer, what is the compelling reason to push for a later version than 3.4.5 of `rpy2`?



---

archive/issue_comments_482453.json:
```json
{
    "body": "I don't think there's a good reason, in particular given that there is zero evidence for the existence of any active users of our R interface",
    "created_at": "2022-08-05T17:01:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482453",
    "user": "https://github.com/mkoeppe"
}
```

I don't think there's a good reason, in particular given that there is zero evidence for the existence of any active users of our R interface



---

archive/issue_comments_482454.json:
```json
{
    "body": "Replying to [comment:27 mkoeppe]:\n> I don't think there's a good reason, in particular given that there is zero evidence for the existence of any active users of our R interface\n\n\nJust a few hours ago I got a request for some improvements to how R is handled in [SageMathCell](SageMathCell), which does rely on our R interface. There were other discussions involving it over the years. So while I cannot say how wide-spread it is, there are certainly users out there and I would appreciate continuation of the support which is available via standard means, i.e. either by installing Sage and its packages, or using standard system packages. Using other custom repositories is highly undesirable as it tends to break over time.",
    "created_at": "2022-08-05T17:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482454",
    "user": "https://github.com/novoselt"
}
```

Replying to [comment:27 mkoeppe]:
> I don't think there's a good reason, in particular given that there is zero evidence for the existence of any active users of our R interface


Just a few hours ago I got a request for some improvements to how R is handled in [SageMathCell](SageMathCell), which does rely on our R interface. There were other discussions involving it over the years. So while I cannot say how wide-spread it is, there are certainly users out there and I would appreciate continuation of the support which is available via standard means, i.e. either by installing Sage and its packages, or using standard system packages. Using other custom repositories is highly undesirable as it tends to break over time.



---

archive/issue_comments_482455.json:
```json
{
    "body": "Are you using system R on SageMathCell or a build of R from the SPKG?",
    "created_at": "2022-08-05T17:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482455",
    "user": "https://github.com/mkoeppe"
}
```

Are you using system R on SageMathCell or a build of R from the SPKG?



---

archive/issue_comments_482456.json:
```json
{
    "body": "SPKG, as far as I know. I didn't explore if it is already an option to use the system one.",
    "created_at": "2022-08-05T17:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482456",
    "user": "https://github.com/novoselt"
}
```

SPKG, as far as I know. I didn't explore if it is already an option to use the system one.



---

archive/issue_comments_482457.json:
```json
{
    "body": "> > I don't think there's a good reason, in particular given that there is zero evidence for the existence of any active users of our R interface\n\n> \n> Just a few hours ago I got a request for some improvements to how R is handled in [SageMathCell](SageMathCell), which does rely on our R interface. There were other discussions involving it over the years. So while I cannot say how wide-spread it is, there are certainly users out there\n\n\nThanks for pointing this out.  R (via the zillions of packages) provides access to so many weird numerical methods and other things that removing the interface seems unwise, even if it's not a prime use of Sage.  (This conversation seems to come up about every three years on sage-devel as well, where people come out of the woodwork; I've used the R interface for research purposes on several occasions myself.)",
    "created_at": "2022-08-05T17:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482457",
    "user": "https://github.com/kcrisman"
}
```

> > I don't think there's a good reason, in particular given that there is zero evidence for the existence of any active users of our R interface

> 
> Just a few hours ago I got a request for some improvements to how R is handled in [SageMathCell](SageMathCell), which does rely on our R interface. There were other discussions involving it over the years. So while I cannot say how wide-spread it is, there are certainly users out there


Thanks for pointing this out.  R (via the zillions of packages) provides access to so many weird numerical methods and other things that removing the interface seems unwise, even if it's not a prime use of Sage.  (This conversation seems to come up about every three years on sage-devel as well, where people come out of the woodwork; I've used the R interface for research purposes on several occasions myself.)



---

archive/issue_comments_482458.json:
```json
{
    "body": "Using system R has been the default since #28884 (Sage 9.1)",
    "created_at": "2022-08-05T17:36:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482458",
    "user": "https://github.com/mkoeppe"
}
```

Using system R has been the default since #28884 (Sage 9.1)



---

archive/issue_comments_482459.json:
```json
{
    "body": "Replying to [comment:31 kcrisman]:\n> removing the interface seems unwise\n\n\nThis is not proposed on this ticket",
    "created_at": "2022-08-05T17:37:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482459",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:31 kcrisman]:
> removing the interface seems unwise


This is not proposed on this ticket



---

archive/issue_comments_482460.json:
```json
{
    "body": "> > removing the interface seems unwise\n\n> This is not proposed on this ticket\nno worries, just being proactive regarding the phrase \"given that there is zero evidence\" which could be misinterpreted",
    "created_at": "2022-08-05T17:41:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482460",
    "user": "https://github.com/kcrisman"
}
```

> > removing the interface seems unwise

> This is not proposed on this ticket
no worries, just being proactive regarding the phrase "given that there is zero evidence" which could be misinterpreted



---

archive/issue_comments_482461.json:
```json
{
    "body": "Replying to [comment:30 novoselt]:\n> SPKG, as far as I know. I didn't explore if it is already an option to use the system one.\n\n\nThe files in https://github.com/sagemath/sagecell/tree/master/contrib/vm suggest that you are using `ubuntu-bionic`, so if this is what you use in production, you will be affected by the proposed change.\n\nThe ticket is marked for the Sage 9.8 milestone, so you'll have plenty of time to do an upgrade to the current LTS (`ubuntu-jammy`)",
    "created_at": "2022-08-05T17:47:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482461",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:30 novoselt]:
> SPKG, as far as I know. I didn't explore if it is already an option to use the system one.


The files in https://github.com/sagemath/sagecell/tree/master/contrib/vm suggest that you are using `ubuntu-bionic`, so if this is what you use in production, you will be affected by the proposed change.

The ticket is marked for the Sage 9.8 milestone, so you'll have plenty of time to do an upgrade to the current LTS (`ubuntu-jammy`)



---

archive/issue_comments_482462.json:
```json
{
    "body": "Replying to [comment:26 jhpalmieri]:\n> Other than just the fact that it's newer, what is the compelling reason to push for a later version than 3.4.5 of `rpy2`?\n\n\nUpstreams hate to support old versions, that's the main reason.",
    "created_at": "2022-08-05T22:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482462",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:26 jhpalmieri]:
> Other than just the fact that it's newer, what is the compelling reason to push for a later version than 3.4.5 of `rpy2`?


Upstreams hate to support old versions, that's the main reason.



---

archive/issue_comments_482463.json:
```json
{
    "body": "I'd say that's not concrete enough to dictate that an upgrade has to go all the way to the most recent version. (Previous updates to rpy2 were done in 2020.)",
    "created_at": "2022-08-05T23:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482463",
    "user": "https://github.com/mkoeppe"
}
```

I'd say that's not concrete enough to dictate that an upgrade has to go all the way to the most recent version. (Previous updates to rpy2 were done in 2020.)



---

archive/issue_comments_482464.json:
```json
{
    "body": "Something is going wrong with prerequisites. From `sagemath_doc_html-none.log`:\n\n```\npkg_resources.DistributionNotFound: The 'rpy2<3.4,>=3.3' distribution was not found and is required by sagemath-standard\n```\n(The `rpy2` package has not yet been built \u2014 it's still in progress trying to download the tarball. Since the downloading timeouts can take a while, is there any way to tell Sage to skip the standard mirrors and just jump straight to the option given by `--enable-download-from-upstream-url`?)",
    "created_at": "2022-08-22T03:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482464",
    "user": "https://github.com/jhpalmieri"
}
```

Something is going wrong with prerequisites. From `sagemath_doc_html-none.log`:

```
pkg_resources.DistributionNotFound: The 'rpy2<3.4,>=3.3' distribution was not found and is required by sagemath-standard
```
(The `rpy2` package has not yet been built â€” it's still in progress trying to download the tarball. Since the downloading timeouts can take a while, is there any way to tell Sage to skip the standard mirrors and just jump straight to the option given by `--enable-download-from-upstream-url`?)



---

archive/issue_comments_482465.json:
```json
{
    "body": "Replying to [comment:42 jhpalmieri]:\n> Since the downloading timeouts can take a while, is there any way to tell Sage to skip the standard mirrors and just jump straight to the option given by `--enable-download-from-upstream-url`?)\n\n\nYou can edit the file `upstream/mirror_list` to remove most mirrors",
    "created_at": "2022-08-22T03:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482465",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:42 jhpalmieri]:
> Since the downloading timeouts can take a while, is there any way to tell Sage to skip the standard mirrors and just jump straight to the option given by `--enable-download-from-upstream-url`?)


You can edit the file `upstream/mirror_list` to remove most mirrors



---

archive/issue_comments_482466.json:
```json
{
    "body": "Replying to [comment:42 jhpalmieri]:\n> Something is going wrong with prerequisites. From `sagemath_doc_html-none.log`:\n> \n> ```\n> pkg_resources.DistributionNotFound: The 'rpy2<3.4,>=3.3' distribution was not found and is required by sagemath-standard\n> ```\n\n\nIs this giving an error, or does it continue after that?",
    "created_at": "2022-08-22T03:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482466",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:42 jhpalmieri]:
> Something is going wrong with prerequisites. From `sagemath_doc_html-none.log`:
> 
> ```
> pkg_resources.DistributionNotFound: The 'rpy2<3.4,>=3.3' distribution was not found and is required by sagemath-standard
> ```


Is this giving an error, or does it continue after that?



---

archive/issue_comments_482467.json:
```json
{
    "body": "Replying to [comment:44 mkoeppe]:\n> Replying to [comment:42 jhpalmieri]:\n> > Something is going wrong with prerequisites. From `sagemath_doc_html-none.log`:\n> > \n> > ```\n> > pkg_resources.DistributionNotFound: The 'rpy2<3.4,>=3.3' distribution was not found and is required by sagemath-standard\n> > ```\n\n> \n> Is this giving an error, or does it continue after that?\n\n\nThe message repeats many times, including a traceback, but the build continues.",
    "created_at": "2022-08-22T04:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482467",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:44 mkoeppe]:
> Replying to [comment:42 jhpalmieri]:
> > Something is going wrong with prerequisites. From `sagemath_doc_html-none.log`:
> > 
> > ```
> > pkg_resources.DistributionNotFound: The 'rpy2<3.4,>=3.3' distribution was not found and is required by sagemath-standard
> > ```

> 
> Is this giving an error, or does it continue after that?


The message repeats many times, including a traceback, but the build continues.



---

archive/issue_comments_482468.json:
```json
{
    "body": "Right, and of course it doesn't matter whether `rpy2` has been built, the same message appears, because this branch installs version 3.4.5 of `rpy2`, and that does not satisfy `rpy2<3.4,>=3.3`.",
    "created_at": "2022-08-22T04:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482468",
    "user": "https://github.com/jhpalmieri"
}
```

Right, and of course it doesn't matter whether `rpy2` has been built, the same message appears, because this branch installs version 3.4.5 of `rpy2`, and that does not satisfy `rpy2<3.4,>=3.3`.



---

archive/issue_comments_482469.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T04:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482470.json:
```json
{
    "body": "`./configure` says\n\n```\n    notice: the following SPKGs did not find equivalent system packages:\n\n        rpy2   4ti2 _recommended cbc coxeter3 ffmpeg gp2c igraph libsemigroups lrslib pandoc pdf2svg perl_mongodb perl_term_readline_gnu polymake\n```\nDo you know why there seems to be extra space after `rpy2`?",
    "created_at": "2022-08-22T05:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482470",
    "user": "https://github.com/jhpalmieri"
}
```

`./configure` says

```
    notice: the following SPKGs did not find equivalent system packages:

        rpy2   4ti2 _recommended cbc coxeter3 ffmpeg gp2c igraph libsemigroups lrslib pandoc pdf2svg perl_mongodb perl_term_readline_gnu polymake
```
Do you know why there seems to be extra space after `rpy2`?



---

archive/issue_comments_482471.json:
```json
{
    "body": "With `./configure --with-system-r=no`, `rpy2` is not built and I see lots of warnings in docbuilding:\n\n```\npkg_resources.DistributionNotFound: The 'rpy2>=3.3' distribution was not found and is required by sagemath-standard\n```\nThe `scipy` log file says\n\n```\nsagemath-standard 9.7b8 requires networkx<3.0,>=2.4, which is not installed.\nsagemath-standard 9.7b8 requires rpy2>=3.3, which is not installed.\n```\n(`networkx-2.8.4` had not yet finished installing at this point.)",
    "created_at": "2022-08-22T06:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482471",
    "user": "https://github.com/jhpalmieri"
}
```

With `./configure --with-system-r=no`, `rpy2` is not built and I see lots of warnings in docbuilding:

```
pkg_resources.DistributionNotFound: The 'rpy2>=3.3' distribution was not found and is required by sagemath-standard
```
The `scipy` log file says

```
sagemath-standard 9.7b8 requires networkx<3.0,>=2.4, which is not installed.
sagemath-standard 9.7b8 requires rpy2>=3.3, which is not installed.
```
(`networkx-2.8.4` had not yet finished installing at this point.)



---

archive/issue_comments_482472.json:
```json
{
    "body": "Replying to [comment:48 jhpalmieri]:\n> `./configure` says\n> \n> ```\n>     notice: the following SPKGs did not find equivalent system packages:\n> \n>         rpy2   4ti2 _recommended cbc coxeter3 ffmpeg gp2c igraph libsemigroups lrslib pandoc pdf2svg perl_mongodb perl_term_readline_gnu polymake\n> ```\n> Do you know why there seems to be extra space after `rpy2`?\n\n\nI think I put this space there to separate standard packages from optional packages",
    "created_at": "2022-08-22T16:31:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482472",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:48 jhpalmieri]:
> `./configure` says
> 
> ```
>     notice: the following SPKGs did not find equivalent system packages:
> 
>         rpy2   4ti2 _recommended cbc coxeter3 ffmpeg gp2c igraph libsemigroups lrslib pandoc pdf2svg perl_mongodb perl_term_readline_gnu polymake
> ```
> Do you know why there seems to be extra space after `rpy2`?


I think I put this space there to separate standard packages from optional packages



---

archive/issue_comments_482473.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-08-22T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482473",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482474.json:
```json
{
    "body": "Looks okay to me. Passes tests with and without using the system installation of R.",
    "created_at": "2022-08-23T00:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482474",
    "user": "https://github.com/jhpalmieri"
}
```

Looks okay to me. Passes tests with and without using the system installation of R.



---

archive/issue_comments_482475.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-08-23T00:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482475",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_482476.json:
```json
{
    "body": "Thank you!",
    "created_at": "2022-08-23T00:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482476",
    "user": "https://github.com/mkoeppe"
}
```

Thank you!



---

archive/issue_comments_482477.json:
```json
{
    "body": "Replying to [comment:43 mkoeppe]:\n> Replying to [comment:42 jhpalmieri]:\n> > Since the downloading timeouts can take a while, is there any way to tell Sage to skip the standard mirrors and just jump straight to the option given by `--enable-download-from-upstream-url`?)\n\n> \n> You can edit the file `upstream/mirror_list` to remove most mirrors\n\n\nWould it be useful to be able to add `$UPSTREAM` (or something like that) to the mirror list, which would have the effect of turning on `--enable-download-from-upstream-url`?",
    "created_at": "2022-08-23T00:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482477",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:43 mkoeppe]:
> Replying to [comment:42 jhpalmieri]:
> > Since the downloading timeouts can take a while, is there any way to tell Sage to skip the standard mirrors and just jump straight to the option given by `--enable-download-from-upstream-url`?)

> 
> You can edit the file `upstream/mirror_list` to remove most mirrors


Would it be useful to be able to add `$UPSTREAM` (or something like that) to the mirror list, which would have the effect of turning on `--enable-download-from-upstream-url`?



---

archive/issue_comments_482478.json:
```json
{
    "body": "I think it would make sense to limit the number of mirrors it tries to some small number (5?) before it tries the upstream.",
    "created_at": "2022-08-23T00:20:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482478",
    "user": "https://github.com/mkoeppe"
}
```

I think it would make sense to limit the number of mirrors it tries to some small number (5?) before it tries the upstream.



---

archive/issue_comments_482479.json:
```json
{
    "body": "I've opened #34411 for this",
    "created_at": "2022-08-23T00:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482479",
    "user": "https://github.com/mkoeppe"
}
```

I've opened #34411 for this



---

archive/issue_comments_482480.json:
```json
{
    "body": "Also see #32390",
    "created_at": "2022-08-23T00:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482480",
    "user": "https://github.com/mkoeppe"
}
```

Also see #32390



---

archive/issue_comments_482481.json:
```json
{
    "body": "Merge failure on top of:\n\n024b81f7a14 Trac #33812: Refactor distributions sagemath-{objects,categories} through sagemath-{environment,repl}\n\ne4d3004ae09 Trac #33805: use Homebrew's primecount\n\n5076cd5d57d Trac #34110: numpy 1.23.x\n\n025fdd4137c Trac #34532: modernize super in manifolds/\n\nf9129b172a6 Trac #34531: some details in LS paths crystals\n\n7f7088d750d Trac #34529: remove deprecated method spring_layout_fast_split from src/sage/graphs/generic_graph_pyx.pyx\n\n12890b6eae8 Trac #34520: Remove randomly failing doctest in src/sage/graphs/generators/random.py\n\nc8511abe7bf Trac #34512: compute list CRT via tree\n\n3f4e5446872 Trac #34508: Improve documentation of JoinFeature\n\ncb5e1afa20e Trac #34493: Make TrivialFamily.map return a TrivialFamily\n\nc036cccaab9 Trac #34486: VectorFieldModule: Faster fast path for tensor_module, exterior_power, dual_exterior_power\n\n89b4155bd13 Trac #34469: modern super in matrix_space\n\n4f3a9b020a0 Trac #34468: fix W605 in all pyx files inside matroids/\n\nbfa6342db03 Trac #34465: Invalid escape sequence in special.py\n\ncd65d443541 Trac #34462: Uniformize the headline: finite rings\n\n7736a49d9a6 Trac #34435: Add method to trim trailing zeros from IntegerVector\n\n154baa594e1 Trac #34432: Upgrade: jupyter-packaging 0.12.3\n\nbfc2ccf5c01 Trac #34409: remove experimental warning for composite elliptic-curve isogenies\n\n89b0d28500d Trac #34375: Replace sage.algebras.yangian.GeneratorIndexingSet with cartesian_product\n\nce82f8112a0 Trac #34358: pycodestyle cleanup in src/sage/graphs/generic_graph.py (part 4)\n\nc8c541f386e Trac #34578: standard error messages in pbori\n\n721c4c18d0d Trac #34573: Remove binary_function from ginac's code in sage\n\n5fc16f5552a Trac #34571: fix typo in docstring\n\nb836c6c85db Trac #34562: refactor multiple zeta values\n\n1366a0d9f49 Trac #34528: Installation guide: Improve section on prerequisites/recommendations\n\nad97e1b2278 Trac #34413: implement derivatives of lazy series\n\na802d076b46 Trac #31664: Add package msolve 0.4.4 (multivariate polynomial system solver)\n\n4541564cf15 Updated [SageMath](SageMath) version to 9.8.beta0\n\n\n\nmerge was not clean: conflicts in build/make/Makefile.in",
    "created_at": "2022-09-27T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482481",
    "user": "https://github.com/vbraun"
}
```

Merge failure on top of:

024b81f7a14 Trac #33812: Refactor distributions sagemath-{objects,categories} through sagemath-{environment,repl}

e4d3004ae09 Trac #33805: use Homebrew's primecount

5076cd5d57d Trac #34110: numpy 1.23.x

025fdd4137c Trac #34532: modernize super in manifolds/

f9129b172a6 Trac #34531: some details in LS paths crystals

7f7088d750d Trac #34529: remove deprecated method spring_layout_fast_split from src/sage/graphs/generic_graph_pyx.pyx

12890b6eae8 Trac #34520: Remove randomly failing doctest in src/sage/graphs/generators/random.py

c8511abe7bf Trac #34512: compute list CRT via tree

3f4e5446872 Trac #34508: Improve documentation of JoinFeature

cb5e1afa20e Trac #34493: Make TrivialFamily.map return a TrivialFamily

c036cccaab9 Trac #34486: VectorFieldModule: Faster fast path for tensor_module, exterior_power, dual_exterior_power

89b4155bd13 Trac #34469: modern super in matrix_space

4f3a9b020a0 Trac #34468: fix W605 in all pyx files inside matroids/

bfa6342db03 Trac #34465: Invalid escape sequence in special.py

cd65d443541 Trac #34462: Uniformize the headline: finite rings

7736a49d9a6 Trac #34435: Add method to trim trailing zeros from IntegerVector

154baa594e1 Trac #34432: Upgrade: jupyter-packaging 0.12.3

bfc2ccf5c01 Trac #34409: remove experimental warning for composite elliptic-curve isogenies

89b0d28500d Trac #34375: Replace sage.algebras.yangian.GeneratorIndexingSet with cartesian_product

ce82f8112a0 Trac #34358: pycodestyle cleanup in src/sage/graphs/generic_graph.py (part 4)

c8c541f386e Trac #34578: standard error messages in pbori

721c4c18d0d Trac #34573: Remove binary_function from ginac's code in sage

5fc16f5552a Trac #34571: fix typo in docstring

b836c6c85db Trac #34562: refactor multiple zeta values

1366a0d9f49 Trac #34528: Installation guide: Improve section on prerequisites/recommendations

ad97e1b2278 Trac #34413: implement derivatives of lazy series

a802d076b46 Trac #31664: Add package msolve 0.4.4 (multivariate polynomial system solver)

4541564cf15 Updated [SageMath](SageMath) version to 9.8.beta0



merge was not clean: conflicts in build/make/Makefile.in



---

archive/issue_comments_482482.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-09-27T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482482",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_482483.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-30T00:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482483",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_482484.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-09-30T00:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482484",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_482485.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-10-11T09:14:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34268#issuecomment-482485",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_089311.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-10-11T09:14:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/34268",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34268#event-89311"
}
```
