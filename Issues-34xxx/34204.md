# Issue 34204: Misleading OSError message when saving an animation to an inexistent folder

archive/issues_033967.json:
```json
{
    "body": "From this [ask question](https://ask.sagemath.org/question/63317/saving-animation-problem/), the command\n\n```\nsines = [plot(c*sin(x), (-2*pi,2*pi), color=Color(c,0,0), ymin=-1, ymax=1)\nfor c in srange(0,1,.1)]\na = animate(sines)\na.save('animations/sines')\n```\nreturns\n\n```\nCommand \"['convert', '-dispose', 'Background', '-delay', '20', '-loop',\n'0', '*.png', '/home/slabbe/animations/sines.gif']\" returned non-zero \nexit status \"1\" (with stderr \"convert-im6.q16: unable to open image \n`/home/slabbe/animations/sines.gif': Aucun fichier ou dossier de ce \ntype @ error/blob.c/OpenBlob/2874.\" and stdout \"\").\n---------------------------------------------------------------------------\nTraceback (most recent call last):\n...\nOSError: Error: Cannot generate GIF animation. The convert command\n(ImageMagick) is present but does not seem to be functional. Verify \nthat the objects passed to the animate command can be saved in PNG \nimage format. See www.imagemagick.org more information.\n```\nThe problem is not that imagemagick is not functional.\n\nThe way error message are given as written in #33092 needs to be improved.\n\nCC:  tmonteil\n\nAuthor: S\u00e9bastien Labb\u00e9\n\nBranch: u/slabbe/34204\n\nStatus: needs_review\n\nCommit: bc5851ce81c609dbb29290d52e6f442bd8eaf9cf\n\nIssue created by migration from https://trac.sagemath.org/ticket/34204\n\n",
    "created_at": "2022-07-21T14:00:48Z",
    "labels": [
        "component: graphics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Misleading OSError message when saving an animation to an inexistent folder",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34204",
    "user": "https://github.com/seblabbe"
}
```
From this [ask question](https://ask.sagemath.org/question/63317/saving-animation-problem/), the command

```
sines = [plot(c*sin(x), (-2*pi,2*pi), color=Color(c,0,0), ymin=-1, ymax=1)
for c in srange(0,1,.1)]
a = animate(sines)
a.save('animations/sines')
```
returns

```
Command "['convert', '-dispose', 'Background', '-delay', '20', '-loop',
'0', '*.png', '/home/slabbe/animations/sines.gif']" returned non-zero 
exit status "1" (with stderr "convert-im6.q16: unable to open image 
`/home/slabbe/animations/sines.gif': Aucun fichier ou dossier de ce 
type @ error/blob.c/OpenBlob/2874." and stdout "").
---------------------------------------------------------------------------
Traceback (most recent call last):
...
OSError: Error: Cannot generate GIF animation. The convert command
(ImageMagick) is present but does not seem to be functional. Verify 
that the objects passed to the animate command can be saved in PNG 
image format. See www.imagemagick.org more information.
```
The problem is not that imagemagick is not functional.

The way error message are given as written in #33092 needs to be improved.

CC:  tmonteil

Author: Sébastien Labbé

Branch: u/slabbe/34204

Status: needs_review

Commit: bc5851ce81c609dbb29290d52e6f442bd8eaf9cf

Issue created by migration from https://trac.sagemath.org/ticket/34204





---

archive/issue_comments_681051.json:
```json
{
    "body": "Changing commit from \"\" to \"bc5851ce81c609dbb29290d52e6f442bd8eaf9cf\"",
    "created_at": "2022-08-24T14:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34204#issuecomment-681051",
    "user": "https://github.com/seblabbe"
}
```

Changing commit from "" to "bc5851ce81c609dbb29290d52e6f442bd8eaf9cf"



---

archive/issue_comments_681052.json:
```json
{
    "body": "Changing branch from \"\" to \"u/slabbe/34204\"",
    "created_at": "2022-08-24T14:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34204#issuecomment-681052",
    "user": "https://github.com/seblabbe"
}
```

Changing branch from "" to "u/slabbe/34204"



---

archive/issue_comments_681053.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|\n|[02b5205](https://github.com/sagemath/sagetrac-mirror/commit/02b5205a9d5f1fca347185889abdec66d952d698)|`34204: better error message when pathhead of savefile does not exist`|\n|[bc5851c](https://github.com/sagemath/sagetrac-mirror/commit/bc5851ce81c609dbb29290d52e6f442bd8eaf9cf)|`34204: moving the require() command just before features ffmpeg and imagemagick are used`|",
    "created_at": "2022-08-24T14:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34204#issuecomment-681053",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------|
|[02b5205](https://github.com/sagemath/sagetrac-mirror/commit/02b5205a9d5f1fca347185889abdec66d952d698)|`34204: better error message when pathhead of savefile does not exist`|
|[bc5851c](https://github.com/sagemath/sagetrac-mirror/commit/bc5851ce81c609dbb29290d52e6f442bd8eaf9cf)|`34204: moving the require() command just before features ffmpeg and imagemagick are used`|



---

archive/issue_comments_681054.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-08-24T14:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34204#issuecomment-681054",
    "user": "https://github.com/seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_681055.json:
```json
{
    "body": "Changing author from \"\" to \"S\u00e9bastien Labb\u00e9\"",
    "created_at": "2022-08-24T14:43:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34204#issuecomment-681055",
    "user": "https://github.com/seblabbe"
}
```

Changing author from "" to "Sébastien Labbé"



---

archive/issue_comments_681056.json:
```json
{
    "body": "<a id='comment:2'></a>\nBoth:\n\n```\nsage -t src/sage/plot/animate.py\nsage -t --optional=sage,optional,external src/sage/plot/animate.py\n```\nworks for me. My setup is that I have both ffmpeg and imagemagick installed.\n\nHowever, newly added doctests do not depend on ffmpeg or imagemagick because these features are \"required\" only after the new error message is raised.\n\nNeeds review.",
    "created_at": "2022-08-24T14:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34204",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34204#issuecomment-681056",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:2'></a>
Both:

```
sage -t src/sage/plot/animate.py
sage -t --optional=sage,optional,external src/sage/plot/animate.py
```
works for me. My setup is that I have both ffmpeg and imagemagick installed.

However, newly added doctests do not depend on ffmpeg or imagemagick because these features are "required" only after the new error message is raised.

Needs review.



---

archive/issue_events_100472.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/34204",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/34204#event-100472"
}
```
