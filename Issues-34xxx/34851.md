# Issue 34851: Upgrade singular to 4.3.1p3

archive/issues_034614.json:
```json
{
    "assignees": [],
    "body": "https://groups.google.com/g/sage-devel/c/0EkgkDgMnYE/m/LFW_ZM-LAAAJ\n\nCritical because a change in the Sage library is needed also with new system installations of Singular\n\nCC:  @antonio-rojas @videlec @behackl @kiwifb\n\nBranch/Commit: **[u/arojas/upgrade_singular_to_4_3_1p3](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_singular_to_4_3_1p3) @ [`388d1c7`](https://github.com/sagemath/sagetrac-mirror/commit/388d1c7829e0e0c089e2422ba7aef6a397d0d47c)**\n\nAuthor: **Antonio Rojas**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34851_\n\n",
    "created_at": "2022-12-14T20:28:09Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20review"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade singular to 4.3.1p3",
    "type": "issue",
    "updated_at": "2023-01-08T00:29:58Z",
    "url": "https://github.com/sagemath/sage/issues/34851",
    "user": "https://github.com/mkoeppe"
}
```
https://groups.google.com/g/sage-devel/c/0EkgkDgMnYE/m/LFW_ZM-LAAAJ

Critical because a change in the Sage library is needed also with new system installations of Singular

CC:  @antonio-rojas @videlec @behackl @kiwifb

Branch/Commit: **[u/arojas/upgrade_singular_to_4_3_1p3](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_singular_to_4_3_1p3) @ [`388d1c7`](https://github.com/sagemath/sagetrac-mirror/commit/388d1c7829e0e0c089e2422ba7aef6a397d0d47c)**

Author: **Antonio Rojas**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/34851_





---

archive/issue_events_470856.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-14T20:28:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470856"
}
```



---

archive/issue_events_470857.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-14T20:28:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470857"
}
```



---

archive/issue_events_470858.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-14T20:28:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470858"
}
```



---

archive/issue_events_470859.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-14T20:28:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470859"
}
```



---

archive/issue_comments_561673.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAPI change in Singular https://github.com/Singular/Singular/commit/5cc997784cbce4c118fa8bc8c2a902459d4068d4\n\nThe patch in https://github.com/archlinux/svntogit-community/blob/packages/sagemath/trunk/sagemath-singular-4.3.1.p3.patch changes use of `pTakeOutComp1` to `pTakeOutComp`. \nBut the 2-argument call of `pTakeOutComp` is marked as \n\"This is something weird -- Don't use it, unless you know what you are doing\" https://github.com/Singular/Singular/commit/5cc997784cbce4c118fa8bc8c2a902459d4068d4#diff-a690828b6277677d330d60ef57a926af0e7df24683f0ad94da92c9f0a7819ab0R344",
    "created_at": "2022-12-15T02:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561673",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:1" align="right">comment:1</div>

API change in Singular https://github.com/Singular/Singular/commit/5cc997784cbce4c118fa8bc8c2a902459d4068d4

The patch in https://github.com/archlinux/svntogit-community/blob/packages/sagemath/trunk/sagemath-singular-4.3.1.p3.patch changes use of `pTakeOutComp1` to `pTakeOutComp`. 
But the 2-argument call of `pTakeOutComp` is marked as 
"This is something weird -- Don't use it, unless you know what you are doing" https://github.com/Singular/Singular/commit/5cc997784cbce4c118fa8bc8c2a902459d4068d4#diff-a690828b6277677d330d60ef57a926af0e7df24683f0ad94da92c9f0a7819ab0R344



---

archive/issue_comments_561674.json:
```json
{
    "body": "Branch: **[u/mkoeppe/upgrade_singular_to_4_3_1p3](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/upgrade_singular_to_4_3_1p3)**",
    "created_at": "2022-12-15T02:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561674",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/upgrade_singular_to_4_3_1p3](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/upgrade_singular_to_4_3_1p3)**



---

archive/issue_comments_561675.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42342b90043cd7cd493f294e99e98e892850f883\"><code>42342b9</code></a></td><td><code>Apply https://github.com/archlinux/svntogit-community/blob/packages/sagemath/trunk/sagemath-singular-4.3.1.p3.patch</code></td></tr></table>\n",
    "created_at": "2022-12-15T08:37:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561675",
    "user": "https://github.com/behackl"
}
```

<div id="comment:3"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42342b90043cd7cd493f294e99e98e892850f883"><code>42342b9</code></a></td><td><code>Apply https://github.com/archlinux/svntogit-community/blob/packages/sagemath/trunk/sagemath-singular-4.3.1.p3.patch</code></td></tr></table>




---

archive/issue_comments_561676.json:
```json
{
    "body": "Commit: **[`42342b9`](https://github.com/sagemath/sagetrac-mirror/commit/42342b90043cd7cd493f294e99e98e892850f883)**",
    "created_at": "2022-12-15T08:37:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561676",
    "user": "https://github.com/behackl"
}
```

Commit: **[`42342b9`](https://github.com/sagemath/sagetrac-mirror/commit/42342b90043cd7cd493f294e99e98e892850f883)**



---

archive/issue_comments_561677.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/upgrade_singular_to_4_3_1p3](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/upgrade_singular_to_4_3_1p3)** to **[u/arojas/upgrade_singular_to_4_3_1p3](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_singular_to_4_3_1p3)**",
    "created_at": "2022-12-20T17:40:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561677",
    "user": "https://github.com/antonio-rojas"
}
```

Changed branch from **[u/mkoeppe/upgrade_singular_to_4_3_1p3](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/upgrade_singular_to_4_3_1p3)** to **[u/arojas/upgrade_singular_to_4_3_1p3](https://github.com/sagemath/sagetrac-mirror/tree/u/arojas/upgrade_singular_to_4_3_1p3)**



---

archive/issue_comments_561678.json:
```json
{
    "body": "Changed commit from **[`42342b9`](https://github.com/sagemath/sagetrac-mirror/commit/42342b90043cd7cd493f294e99e98e892850f883)** to **[`267177a`](https://github.com/sagemath/sagetrac-mirror/commit/267177af61d742d1571c28c49b9660720173cba7)**",
    "created_at": "2022-12-20T17:45:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561678",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`42342b9`](https://github.com/sagemath/sagetrac-mirror/commit/42342b90043cd7cd493f294e99e98e892850f883)** to **[`267177a`](https://github.com/sagemath/sagetrac-mirror/commit/267177af61d742d1571c28c49b9660720173cba7)**



---

archive/issue_comments_561679.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/267177af61d742d1571c28c49b9660720173cba7\"><code>267177a</code></a></td><td><code>Fix one more test</code></td></tr></table>\n",
    "created_at": "2022-12-20T17:45:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561679",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/267177af61d742d1571c28c49b9660720173cba7"><code>267177a</code></a></td><td><code>Fix one more test</code></td></tr></table>




---

archive/issue_comments_561680.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n`lift` seems to be broken\n\n```\nsage -t --long --random-seed=299698150490166540162136571885065553921 src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 4490, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift\nFailed example:\n    M\nExpected:\n    [y^7, x^7*y^2 + x^8 + x^5*y^3 + x^6*y + x^3*y^4 + x^4*y^2 + x*y^5 + x^2*y^3 + y^4]\nGot:\n    [y^7, 0]\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 4492, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift\nFailed example:\n    sum( map( mul , zip( M, I.gens() ) ) ) == f\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 4500, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift\nFailed example:\n    f.lift(I)\nExpected:\n    [1, x2]\nGot:\n    [1, 0]\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 4506, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift\nFailed example:\n    f.lift(I)\nExpected:\n    [1, x2]\nGot:\n    [1, 0]\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_libsingular.pyx\", line 4637, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.reduce\nFailed example:\n    f.reduce([2*x,y])\nExpected:\n    3*x\nGot:\n    x\n**********************************************************************\n2 items had failures:\n   4 of  18 in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift\n   1 of  22 in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.reduce\n    [1197 tests, 5 failures, 1.11 s]\n```\nand there are also many failures in `asymptotics`\n\n```\nsage -t --long --random-seed=241071912408585997575727450771429802043 src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 123, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\nFailed example:\n    decomp =  F.asymptotic_decomposition(alpha); decomp\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions[48]>\", line 1, in <module>\n        decomp =  F.asymptotic_decomposition(alpha); decomp\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1502, in asymptotic_decomposition\n        decomp2.extend(ff.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1422, in cohomology_decomposition\n        decomp.extend(r.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1422, in cohomology_decomposition\n        decomp.extend(r.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1425, in cohomology_decomposition\n        return decomp._combine_like_terms_().whole_and_parts()\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 3495, in whole_and_parts\n        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here\n    UnboundLocalError: local variable 'r' referenced before assignment\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 130, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\nFailed example:\n    F1.asymptotics(p, alpha, 2)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions[50]>\", line 1, in <module>\n        F1.asymptotics(p, alpha, Integer(2))\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1636, in asymptotics\n        p = coerce_point(R, p)\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 4238, in coerce_point\n        return {x: p[SR(x)] for x in R.gens()}\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 4238, in <dictcomp>\n        return {x: p[SR(x)] for x in R.gens()}\n    KeyError: x\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 134, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\nFailed example:\n    decomp =  F.asymptotic_decomposition(alpha)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions[52]>\", line 1, in <module>\n        decomp =  F.asymptotic_decomposition(alpha)\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1502, in asymptotic_decomposition\n        decomp2.extend(ff.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1422, in cohomology_decomposition\n        decomp.extend(r.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1422, in cohomology_decomposition\n        decomp.extend(r.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1425, in cohomology_decomposition\n        return decomp._combine_like_terms_().whole_and_parts()\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 3495, in whole_and_parts\n        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here\n    UnboundLocalError: local variable 'r' referenced before assignment\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 136, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\nFailed example:\n    asy = F1.asymptotics(p, alpha, 2)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions[54]>\", line 1, in <module>\n        asy = F1.asymptotics(p, alpha, Integer(2))\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1636, in asymptotics\n        p = coerce_point(R, p)\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 4238, in coerce_point\n        return {x: p[SR(x)] for x in R.gens()}\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 4238, in <dictcomp>\n        return {x: p[SR(x)] for x in R.gens()}\n    KeyError: x\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 137, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\nFailed example:\n    asy\nExpected:\n    (3*(10*r^2 - 7*r - 3)*2187^r, 2187, 30*r^2 - 21*r - 9)\nGot:\n    (1/24*2^(2/3)*(sqrt(3) + 4/(sqrt(3) + I) + I)*gamma(1/3)/(pi*r^(1/3)),\n     1,\n     1/24*2^(2/3)*(sqrt(3) + 4/(sqrt(3) + I) + I)*gamma(1/3)/(pi*r^(1/3)))\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 139, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\nFailed example:\n    F.relative_error(asy[0], alpha, [1, 2, 4, 8], asy[1])\nExpected:\n    [((4, 3), 30.72702332, [0.0000000000], [1.000000000]),\n     ((8, 6), 111.9315678, [69.00000000], [0.3835519207]),\n     ((16, 12), 442.7813138, [387.0000000], [0.1259793763]),\n     ((32, 24), 1799.879232, [1743.000000], [0.03160169385])]\nGot:\n    [((4, 3),\n      67200.00000,\n      [0.1953794675 - 8.207453952e-13*I],\n      [0.9999970926 + 1.221347314e-17*I]),\n     ((8, 6),\n      5.353652190e8,\n      [0.1550727862 - 6.514260518e-13*I],\n      [0.9999999997 + 1.216788145e-21*I]),\n     ((16, 12),\n      1.012941622e16,\n      [0.1230813519 - 5.170372000e-13*I],\n      [1.000000000 + 5.104313900e-29*I]),\n     ((32, 24),\n      9.419625360e29,\n      [0.09768973377 - 4.103726976e-13*I],\n      [1.000000000 + 4.356571327e-43*I])]\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 860, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_certificate\nFailed example:\n    L\nExpected:\n    [y^2, -x*y + 1]\nGot:\n    [y^2, 0]\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 863, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_certificate\nFailed example:\n    sum(L[i]*df[i][0]**df[i][1] for i in range(len(df))) == 1\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 921, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition\nFailed example:\n    decomp\nExpected:\n    (0, []) + (1, [(x, 1)]) + (-y, [(x*y + 1, 1)])\nGot:\n    (0, []) + (-y, [(x*y + 1, 1)])\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 923, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition\nFailed example:\n    decomp.sum().quotient() == f\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 925, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition\nFailed example:\n    [r.nullstellensatz_certificate() is None for r in decomp]\nExpected:\n    [True, True, True]\nGot:\n    [True, True]\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 936, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition\nFailed example:\n    decomp\nExpected:\n    (0, []) + (sin(y), [(x, 1)]) + (-y*sin(y), [(x*y + 1, 1)])\nGot:\n    (0, []) + (-y*sin(y), [(x*y + 1, 1)])\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 938, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition\nFailed example:\n    bool(decomp.sum().quotient() == G/H)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 940, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition\nFailed example:\n    [r.nullstellensatz_certificate() is None for r in decomp]\nExpected:\n    [True, True, True]\nGot:\n    [True, True]\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1234, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition\nFailed example:\n    decomp\nExpected:\n    (0, []) + (1, [(x*y + 1, 1)]) + (x + y, [(y, 1), (x, 1)])\nGot:\n    (-x^2 - x*y - x, []) + (x, [(x*y + 1, 1)])\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1236, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition\nFailed example:\n    decomp.sum().quotient() == f\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1254, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition\nFailed example:\n    decomp\nExpected:\n    (0, []) +\n    (-(x*y^2*sin(x) + x^2*y + x*y + y*sin(x) + x)*y, [(y, 1)]) +\n    ((x*y^2*sin(x) + x^2*y + x*y + y*sin(x) + x)*x*y, [(x*y + 1, 1)]) +\n    (x*y^2*sin(x) + x^2*y + x*y + y*sin(x) + x, [(y, 1), (x, 1)])\nGot:\n    (0, []) + (-(x*y^2*sin(x) + x^2*y + x*y + y*sin(x) + x)*x, [(x*y + 1, 1)])\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1259, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition\nFailed example:\n    bool(decomp.sum().quotient() == f)\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1335, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.cohomology_decomposition\nFailed example:\n    FFPD(1, [(x, 1), (y, 2)]).cohomology_decomposition()\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.cohomology_decomposition[8]>\", line 1, in <module>\n        FFPD(Integer(1), [(x, Integer(1)), (y, Integer(2))]).cohomology_decomposition()\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1422, in cohomology_decomposition\n        decomp.extend(r.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1425, in cohomology_decomposition\n        return decomp._combine_like_terms_().whole_and_parts()\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 3495, in whole_and_parts\n        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here\n    UnboundLocalError: local variable 'r' referenced before assignment\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1343, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.cohomology_decomposition\nFailed example:\n    f.cohomology_decomposition()\nExpected:\n    (0, []) + (-4/3*x*y, [(x^2 + y^2 - 1, 1)]) +\n    (1/3, [(x*y - 1, 1), (x^2 + y^2 - 1, 1)])\nGot:\n    (0, []) + (-2/3*x^2 + 4/3*x*y + 4/3, [(x^2 + y^2 - 1, 1)]) + (-1/3*x^2 + 1/6, [(x*y - 1, 1), (x^2 + y^2 - 1, 1)])\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1474, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.asymptotic_decomposition\nFailed example:\n    F.asymptotic_decomposition(alpha)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.asymptotic_decomposition[14]>\", line 1, in <module>\n        F.asymptotic_decomposition(alpha)\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1502, in asymptotic_decomposition\n        decomp2.extend(ff.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1422, in cohomology_decomposition\n        decomp.extend(r.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1425, in cohomology_decomposition\n        return decomp._combine_like_terms_().whole_and_parts()\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 3495, in whole_and_parts\n        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here\n    UnboundLocalError: local variable 'r' referenced before assignment\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1580, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    decomp = F.asymptotic_decomposition(alpha); decomp\nExpected:\n    (0, []) + (... - 1/2, [(x*y + x + y - 1, 1)])\nGot:\n    (0, []) + (-1/2, [(x*y + x + y - 1, 1)])\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1589, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    asy\nExpected:\n    (1/6000*(3600*sqrt(5)*sqrt(3)*sqrt(2)*sqrt(r)/sqrt(pi)\n      + 463*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)))*432^r,\n     432,\n     3/5*sqrt(5)*sqrt(3)*sqrt(2)*sqrt(r)/sqrt(pi)\n      + 463/6000*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)))\nGot:\n    (1/2880*432^r*(144*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)) - 5*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*r^(3/2))),\n     432,\n     1/20*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)) - 1/576*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*r^(3/2)))\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1595, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    F.relative_error(asy[0], alpha, [1, 2, 4, 8, 16], asy[1])  # abs tol 1e-10\nExpected:\n    [((4, 3), 2.083333333, [2.092576110], [-0.004436533009]),\n     ((8, 6), 2.787374614, [2.790732875], [-0.001204811281]),\n     ((16, 12), 3.826259447, [3.827462310], [-0.0003143703383]),\n     ((32, 24), 5.328112821, [5.328540787], [-0.00008032230388]),\n     ((64, 48), 7.475927885, [7.476079664], [-0.00002030232879])]\nGot:\n    [((4, 3), 2.083333333, [0.1491447613], [0.9284105146]),\n     ((8, 6), 2.787374614, [0.1073580576], [0.9614841661]),\n     ((16, 12), 3.826259447, [0.07658422547], [0.9799845707]),\n     ((32, 24), 5.328112821, [0.05439032335], [0.9897918221]),\n     ((64, 48), 7.475927885, [0.03854359334], [0.9948443064])]\nTolerance exceeded in 10 of 25:\n    2.092576110 vs 0.1491447613, tolerance 2e0 > 1e-10\n    -0.004436533009 vs 0.9284105146, tolerance 1e0 > 1e-10\n    2.790732875 vs 0.1073580576, tolerance 3e0 > 1e-10\n    -0.001204811281 vs 0.9614841661, tolerance 1e0 > 1e-10\n    3.827462310 vs 0.07658422547, tolerance 4e0 > 1e-10\n    -0.0003143703383 vs 0.9799845707, tolerance 1e0 > 1e-10\n    5.328540787 vs 0.05439032335, tolerance 6e0 > 1e-10\n    -0.00008032230388 vs 0.9897918221, tolerance 1e0 > 1e-10\n    7.476079664 vs 0.03854359334, tolerance 8e0 > 1e-10\n    -0.00002030232879 vs 0.9948443064, tolerance 1e0 > 1e-10\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1613, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    decomp = F.asymptotic_decomposition(alpha); decomp\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?[22]>\", line 1, in <module>\n        decomp = F.asymptotic_decomposition(alpha); decomp\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1502, in asymptotic_decomposition\n        decomp2.extend(ff.cohomology_decomposition())\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1425, in cohomology_decomposition\n        return decomp._combine_like_terms_().whole_and_parts()\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 3495, in whole_and_parts\n        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here\n    UnboundLocalError: local variable 'r' referenced before assignment\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1619, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    asy = F1.asymptotics(p, alpha, 2, verbose=True) # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python3.10/site-packages/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?[25]>\", line 1, in <module>\n        asy = F1.asymptotics(p, alpha, Integer(2), verbose=True) # long time\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1636, in asymptotics\n        p = coerce_point(R, p)\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 4238, in coerce_point\n        return {x: p[SR(x)] for x in R.gens()}\n      File \"/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 4238, in <dictcomp>\n        return {x: p[SR(x)] for x in R.gens()}\n    KeyError: x\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1624, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    asy # long time\nExpected:\n    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)),\n     1, 4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)))\nGot:\n    (1/2880*432^r*(144*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)) - 5*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*r^(3/2))),\n     432,\n     1/20*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)) - 1/576*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*r^(3/2)))\n**********************************************************************\nFile \"src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py\", line 1627, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\nFailed example:\n    F.relative_error(asy[0], alpha, [1, 2, 4, 8], asy[1]) # long time\nExpected:\n    [((3, 3, 2), 0.9812164307, [1.515572606], [-0.54458543...]),\n     ((6, 6, 4), 1.576181132, [1.992989399], [-0.26444185...]),\n     ((12, 12, 8), 2.485286378, [2.712196351], [-0.091301338...]),\n     ((24, 24, 16), 3.700576827, [3.760447895], [-0.016178847...])]\nGot:\n    [((3, 3, 2), 0.002271334330, [0.1491447613], [-64.66394007]),\n     ((6, 6, 4), 8.445757952e-6, [0.1073580576], [-12710.47696]),\n     ((12, 12, 8), 7.135780002e-11, [0.07658422547], [-1.073242524e9]),\n     ((24, 24, 16), 3.050699638e-21, [0.05439032335], [-1.782880316e19])]\n**********************************************************************\n7 items had failures:\n   6 of  77 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions\n   7 of 104 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?\n   1 of  16 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.asymptotic_decomposition\n   2 of  14 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.cohomology_decomposition\n   4 of  32 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition\n   2 of  14 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_certificate\n   6 of  18 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition\n    [805 tests, 28 failures, 56.34 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=241071912408585997575727450771429802043 src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 28 doctests failed\n```",
    "created_at": "2022-12-20T17:53:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561680",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:6" align="right">comment:6</div>

`lift` seems to be broken

```
sage -t --long --random-seed=299698150490166540162136571885065553921 src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 4490, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift
Failed example:
    M
Expected:
    [y^7, x^7*y^2 + x^8 + x^5*y^3 + x^6*y + x^3*y^4 + x^4*y^2 + x*y^5 + x^2*y^3 + y^4]
Got:
    [y^7, 0]
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 4492, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift
Failed example:
    sum( map( mul , zip( M, I.gens() ) ) ) == f
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 4500, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift
Failed example:
    f.lift(I)
Expected:
    [1, x2]
Got:
    [1, 0]
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 4506, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift
Failed example:
    f.lift(I)
Expected:
    [1, x2]
Got:
    [1, 0]
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_libsingular.pyx", line 4637, in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.reduce
Failed example:
    f.reduce([2*x,y])
Expected:
    3*x
Got:
    x
**********************************************************************
2 items had failures:
   4 of  18 in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift
   1 of  22 in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.reduce
    [1197 tests, 5 failures, 1.11 s]
```
and there are also many failures in `asymptotics`

```
sage -t --long --random-seed=241071912408585997575727450771429802043 src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 123, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
Failed example:
    decomp =  F.asymptotic_decomposition(alpha); decomp
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions[48]>", line 1, in <module>
        decomp =  F.asymptotic_decomposition(alpha); decomp
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1502, in asymptotic_decomposition
        decomp2.extend(ff.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1422, in cohomology_decomposition
        decomp.extend(r.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1422, in cohomology_decomposition
        decomp.extend(r.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1425, in cohomology_decomposition
        return decomp._combine_like_terms_().whole_and_parts()
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 3495, in whole_and_parts
        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here
    UnboundLocalError: local variable 'r' referenced before assignment
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 130, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
Failed example:
    F1.asymptotics(p, alpha, 2)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions[50]>", line 1, in <module>
        F1.asymptotics(p, alpha, Integer(2))
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1636, in asymptotics
        p = coerce_point(R, p)
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 4238, in coerce_point
        return {x: p[SR(x)] for x in R.gens()}
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 4238, in <dictcomp>
        return {x: p[SR(x)] for x in R.gens()}
    KeyError: x
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 134, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
Failed example:
    decomp =  F.asymptotic_decomposition(alpha)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions[52]>", line 1, in <module>
        decomp =  F.asymptotic_decomposition(alpha)
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1502, in asymptotic_decomposition
        decomp2.extend(ff.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1422, in cohomology_decomposition
        decomp.extend(r.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1422, in cohomology_decomposition
        decomp.extend(r.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1425, in cohomology_decomposition
        return decomp._combine_like_terms_().whole_and_parts()
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 3495, in whole_and_parts
        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here
    UnboundLocalError: local variable 'r' referenced before assignment
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 136, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
Failed example:
    asy = F1.asymptotics(p, alpha, 2)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions[54]>", line 1, in <module>
        asy = F1.asymptotics(p, alpha, Integer(2))
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1636, in asymptotics
        p = coerce_point(R, p)
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 4238, in coerce_point
        return {x: p[SR(x)] for x in R.gens()}
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 4238, in <dictcomp>
        return {x: p[SR(x)] for x in R.gens()}
    KeyError: x
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 137, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
Failed example:
    asy
Expected:
    (3*(10*r^2 - 7*r - 3)*2187^r, 2187, 30*r^2 - 21*r - 9)
Got:
    (1/24*2^(2/3)*(sqrt(3) + 4/(sqrt(3) + I) + I)*gamma(1/3)/(pi*r^(1/3)),
     1,
     1/24*2^(2/3)*(sqrt(3) + 4/(sqrt(3) + I) + I)*gamma(1/3)/(pi*r^(1/3)))
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 139, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
Failed example:
    F.relative_error(asy[0], alpha, [1, 2, 4, 8], asy[1])
Expected:
    [((4, 3), 30.72702332, [0.0000000000], [1.000000000]),
     ((8, 6), 111.9315678, [69.00000000], [0.3835519207]),
     ((16, 12), 442.7813138, [387.0000000], [0.1259793763]),
     ((32, 24), 1799.879232, [1743.000000], [0.03160169385])]
Got:
    [((4, 3),
      67200.00000,
      [0.1953794675 - 8.207453952e-13*I],
      [0.9999970926 + 1.221347314e-17*I]),
     ((8, 6),
      5.353652190e8,
      [0.1550727862 - 6.514260518e-13*I],
      [0.9999999997 + 1.216788145e-21*I]),
     ((16, 12),
      1.012941622e16,
      [0.1230813519 - 5.170372000e-13*I],
      [1.000000000 + 5.104313900e-29*I]),
     ((32, 24),
      9.419625360e29,
      [0.09768973377 - 4.103726976e-13*I],
      [1.000000000 + 4.356571327e-43*I])]
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 860, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_certificate
Failed example:
    L
Expected:
    [y^2, -x*y + 1]
Got:
    [y^2, 0]
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 863, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_certificate
Failed example:
    sum(L[i]*df[i][0]**df[i][1] for i in range(len(df))) == 1
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 921, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition
Failed example:
    decomp
Expected:
    (0, []) + (1, [(x, 1)]) + (-y, [(x*y + 1, 1)])
Got:
    (0, []) + (-y, [(x*y + 1, 1)])
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 923, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition
Failed example:
    decomp.sum().quotient() == f
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 925, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition
Failed example:
    [r.nullstellensatz_certificate() is None for r in decomp]
Expected:
    [True, True, True]
Got:
    [True, True]
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 936, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition
Failed example:
    decomp
Expected:
    (0, []) + (sin(y), [(x, 1)]) + (-y*sin(y), [(x*y + 1, 1)])
Got:
    (0, []) + (-y*sin(y), [(x*y + 1, 1)])
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 938, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition
Failed example:
    bool(decomp.sum().quotient() == G/H)
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 940, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition
Failed example:
    [r.nullstellensatz_certificate() is None for r in decomp]
Expected:
    [True, True, True]
Got:
    [True, True]
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1234, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition
Failed example:
    decomp
Expected:
    (0, []) + (1, [(x*y + 1, 1)]) + (x + y, [(y, 1), (x, 1)])
Got:
    (-x^2 - x*y - x, []) + (x, [(x*y + 1, 1)])
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1236, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition
Failed example:
    decomp.sum().quotient() == f
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1254, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition
Failed example:
    decomp
Expected:
    (0, []) +
    (-(x*y^2*sin(x) + x^2*y + x*y + y*sin(x) + x)*y, [(y, 1)]) +
    ((x*y^2*sin(x) + x^2*y + x*y + y*sin(x) + x)*x*y, [(x*y + 1, 1)]) +
    (x*y^2*sin(x) + x^2*y + x*y + y*sin(x) + x, [(y, 1), (x, 1)])
Got:
    (0, []) + (-(x*y^2*sin(x) + x^2*y + x*y + y*sin(x) + x)*x, [(x*y + 1, 1)])
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1259, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition
Failed example:
    bool(decomp.sum().quotient() == f)
Expected:
    True
Got:
    False
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1335, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.cohomology_decomposition
Failed example:
    FFPD(1, [(x, 1), (y, 2)]).cohomology_decomposition()
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.cohomology_decomposition[8]>", line 1, in <module>
        FFPD(Integer(1), [(x, Integer(1)), (y, Integer(2))]).cohomology_decomposition()
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1422, in cohomology_decomposition
        decomp.extend(r.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1425, in cohomology_decomposition
        return decomp._combine_like_terms_().whole_and_parts()
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 3495, in whole_and_parts
        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here
    UnboundLocalError: local variable 'r' referenced before assignment
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1343, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.cohomology_decomposition
Failed example:
    f.cohomology_decomposition()
Expected:
    (0, []) + (-4/3*x*y, [(x^2 + y^2 - 1, 1)]) +
    (1/3, [(x*y - 1, 1), (x^2 + y^2 - 1, 1)])
Got:
    (0, []) + (-2/3*x^2 + 4/3*x*y + 4/3, [(x^2 + y^2 - 1, 1)]) + (-1/3*x^2 + 1/6, [(x*y - 1, 1), (x^2 + y^2 - 1, 1)])
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1474, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.asymptotic_decomposition
Failed example:
    F.asymptotic_decomposition(alpha)
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.asymptotic_decomposition[14]>", line 1, in <module>
        F.asymptotic_decomposition(alpha)
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1502, in asymptotic_decomposition
        decomp2.extend(ff.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1422, in cohomology_decomposition
        decomp.extend(r.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1425, in cohomology_decomposition
        return decomp._combine_like_terms_().whole_and_parts()
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 3495, in whole_and_parts
        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here
    UnboundLocalError: local variable 'r' referenced before assignment
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1580, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    decomp = F.asymptotic_decomposition(alpha); decomp
Expected:
    (0, []) + (... - 1/2, [(x*y + x + y - 1, 1)])
Got:
    (0, []) + (-1/2, [(x*y + x + y - 1, 1)])
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1589, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    asy
Expected:
    (1/6000*(3600*sqrt(5)*sqrt(3)*sqrt(2)*sqrt(r)/sqrt(pi)
      + 463*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)))*432^r,
     432,
     3/5*sqrt(5)*sqrt(3)*sqrt(2)*sqrt(r)/sqrt(pi)
      + 463/6000*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)))
Got:
    (1/2880*432^r*(144*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)) - 5*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*r^(3/2))),
     432,
     1/20*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)) - 1/576*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*r^(3/2)))
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1595, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    F.relative_error(asy[0], alpha, [1, 2, 4, 8, 16], asy[1])  # abs tol 1e-10
Expected:
    [((4, 3), 2.083333333, [2.092576110], [-0.004436533009]),
     ((8, 6), 2.787374614, [2.790732875], [-0.001204811281]),
     ((16, 12), 3.826259447, [3.827462310], [-0.0003143703383]),
     ((32, 24), 5.328112821, [5.328540787], [-0.00008032230388]),
     ((64, 48), 7.475927885, [7.476079664], [-0.00002030232879])]
Got:
    [((4, 3), 2.083333333, [0.1491447613], [0.9284105146]),
     ((8, 6), 2.787374614, [0.1073580576], [0.9614841661]),
     ((16, 12), 3.826259447, [0.07658422547], [0.9799845707]),
     ((32, 24), 5.328112821, [0.05439032335], [0.9897918221]),
     ((64, 48), 7.475927885, [0.03854359334], [0.9948443064])]
Tolerance exceeded in 10 of 25:
    2.092576110 vs 0.1491447613, tolerance 2e0 > 1e-10
    -0.004436533009 vs 0.9284105146, tolerance 1e0 > 1e-10
    2.790732875 vs 0.1073580576, tolerance 3e0 > 1e-10
    -0.001204811281 vs 0.9614841661, tolerance 1e0 > 1e-10
    3.827462310 vs 0.07658422547, tolerance 4e0 > 1e-10
    -0.0003143703383 vs 0.9799845707, tolerance 1e0 > 1e-10
    5.328540787 vs 0.05439032335, tolerance 6e0 > 1e-10
    -0.00008032230388 vs 0.9897918221, tolerance 1e0 > 1e-10
    7.476079664 vs 0.03854359334, tolerance 8e0 > 1e-10
    -0.00002030232879 vs 0.9948443064, tolerance 1e0 > 1e-10
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1613, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    decomp = F.asymptotic_decomposition(alpha); decomp
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?[22]>", line 1, in <module>
        decomp = F.asymptotic_decomposition(alpha); decomp
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1502, in asymptotic_decomposition
        decomp2.extend(ff.cohomology_decomposition())
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1425, in cohomology_decomposition
        return decomp._combine_like_terms_().whole_and_parts()
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 3495, in whole_and_parts
        [r.parent()(whole, ())] + parts)  # r.parent() is not the nicest here
    UnboundLocalError: local variable 'r' referenced before assignment
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1619, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    asy = F1.asymptotics(p, alpha, 2, verbose=True) # long time
Exception raised:
    Traceback (most recent call last):
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python3.10/site-packages/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?[25]>", line 1, in <module>
        asy = F1.asymptotics(p, alpha, Integer(2), verbose=True) # long time
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1636, in asymptotics
        p = coerce_point(R, p)
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 4238, in coerce_point
        return {x: p[SR(x)] for x in R.gens()}
      File "/usr/lib/python3.10/site-packages/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 4238, in <dictcomp>
        return {x: p[SR(x)] for x in R.gens()}
    KeyError: x
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1624, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    asy # long time
Expected:
    (4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)),
     1, 4/3*sqrt(3)*sqrt(r)/sqrt(pi) + 47/216*sqrt(3)/(sqrt(pi)*sqrt(r)))
Got:
    (1/2880*432^r*(144*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)) - 5*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*r^(3/2))),
     432,
     1/20*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*sqrt(r)) - 1/576*sqrt(5)*sqrt(3)*sqrt(2)/(sqrt(pi)*r^(3/2)))
**********************************************************************
File "src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py", line 1627, in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
Failed example:
    F.relative_error(asy[0], alpha, [1, 2, 4, 8], asy[1]) # long time
Expected:
    [((3, 3, 2), 0.9812164307, [1.515572606], [-0.54458543...]),
     ((6, 6, 4), 1.576181132, [1.992989399], [-0.26444185...]),
     ((12, 12, 8), 2.485286378, [2.712196351], [-0.091301338...]),
     ((24, 24, 16), 3.700576827, [3.760447895], [-0.016178847...])]
Got:
    [((3, 3, 2), 0.002271334330, [0.1491447613], [-64.66394007]),
     ((6, 6, 4), 8.445757952e-6, [0.1073580576], [-12710.47696]),
     ((12, 12, 8), 7.135780002e-11, [0.07658422547], [-1.073242524e9]),
     ((24, 24, 16), 3.050699638e-21, [0.05439032335], [-1.782880316e19])]
**********************************************************************
7 items had failures:
   6 of  77 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions
   7 of 104 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.?
   1 of  16 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.asymptotic_decomposition
   2 of  14 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.cohomology_decomposition
   4 of  32 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.leinartas_decomposition
   2 of  14 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_certificate
   6 of  18 in sage.rings.asymptotic.asymptotics_multivariate_generating_functions.FractionWithFactoredDenominator.nullstellensatz_decomposition
    [805 tests, 28 failures, 56.34 s]
----------------------------------------------------------------------
sage -t --long --random-seed=241071912408585997575727450771429802043 src/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py  # 28 doctests failed
```



---

archive/issue_events_470860.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-31T21:31:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470860"
}
```



---

archive/issue_events_470861.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-31T21:31:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470861"
}
```



---

archive/issue_comments_561681.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe failures are caused by the patch. Looks like `pTakeOutComp1` and `pTakeOutComp` behave differently, and the latter shifts the polynomial after extracting the component.",
    "created_at": "2023-01-04T14:30:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561681",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:9" align="right">comment:9</div>

The failures are caused by the patch. Looks like `pTakeOutComp1` and `pTakeOutComp` behave differently, and the latter shifts the polynomial after extracting the component.



---

archive/issue_comments_561682.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2b0016b838703dd77e5b110a4a27ccfba534d32\"><code>d2b0016</code></a></td><td><code>Account for different bahavior of pTakeOutComp and pTakeOutComp1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55e3b32672fb0909235d12f3d031c9645f9c7cca\"><code>55e3b32</code></a></td><td><code>Fix one more test</code></td></tr></table>\n",
    "created_at": "2023-01-04T14:38:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561682",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2b0016b838703dd77e5b110a4a27ccfba534d32"><code>d2b0016</code></a></td><td><code>Account for different bahavior of pTakeOutComp and pTakeOutComp1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55e3b32672fb0909235d12f3d031c9645f9c7cca"><code>55e3b32</code></a></td><td><code>Fix one more test</code></td></tr></table>




---

archive/issue_comments_561683.json:
```json
{
    "body": "Changed commit from **[`267177a`](https://github.com/sagemath/sagetrac-mirror/commit/267177af61d742d1571c28c49b9660720173cba7)** to **[`55e3b32`](https://github.com/sagemath/sagetrac-mirror/commit/55e3b32672fb0909235d12f3d031c9645f9c7cca)**",
    "created_at": "2023-01-04T14:38:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561683",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`267177a`](https://github.com/sagemath/sagetrac-mirror/commit/267177af61d742d1571c28c49b9660720173cba7)** to **[`55e3b32`](https://github.com/sagemath/sagetrac-mirror/commit/55e3b32672fb0909235d12f3d031c9645f9c7cca)**



---

archive/issue_comments_561684.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d059c606c1f36bc217d6189318e32fc207e16dfc\"><code>d059c60</code></a></td><td><code>Apply https://github.com/archlinux/svntogit-community/blob/packages/sagemath/trunk/sagemath-singular-4.3.1.p3.patch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb01a65009f65a794c7228246510598053551245\"><code>cb01a65</code></a></td><td><code>Fix tests with singular 4.3.1.p3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6fc41ae8bde2c3c8aaff7799ebb14689e7152314\"><code>6fc41ae</code></a></td><td><code>Singular supports larger exponents now, adapt tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/404a3a2bfb5151bb0f14fd85dc322bfec6e52c94\"><code>404a3a2</code></a></td><td><code>Fix one more test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87faa20db00464fa853fe7352df9be36a0ed913d\"><code>87faa20</code></a></td><td><code>Account for different bahavior of pTakeOutComp and pTakeOutComp1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6b0bcf39e1fb3ba2c7f1d6d4f314969bdbf1777\"><code>e6b0bcf</code></a></td><td><code>Fix one more test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d82304b6008bb24e177e225f6cc627d9b7970c4\"><code>5d82304</code></a></td><td><code>Update singular to 4.3.1p3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/388d1c7829e0e0c089e2422ba7aef6a397d0d47c\"><code>388d1c7</code></a></td><td><code>Merge branch 'u/arojas/upgrade_singular_to_4_3_1p3' of git://trac.sagemath.org/sage into t/34851/upgrade_singular_to_4_3_1p3</code></td></tr></table>\n",
    "created_at": "2023-01-04T18:21:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561684",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d059c606c1f36bc217d6189318e32fc207e16dfc"><code>d059c60</code></a></td><td><code>Apply https://github.com/archlinux/svntogit-community/blob/packages/sagemath/trunk/sagemath-singular-4.3.1.p3.patch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb01a65009f65a794c7228246510598053551245"><code>cb01a65</code></a></td><td><code>Fix tests with singular 4.3.1.p3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6fc41ae8bde2c3c8aaff7799ebb14689e7152314"><code>6fc41ae</code></a></td><td><code>Singular supports larger exponents now, adapt tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/404a3a2bfb5151bb0f14fd85dc322bfec6e52c94"><code>404a3a2</code></a></td><td><code>Fix one more test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87faa20db00464fa853fe7352df9be36a0ed913d"><code>87faa20</code></a></td><td><code>Account for different bahavior of pTakeOutComp and pTakeOutComp1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6b0bcf39e1fb3ba2c7f1d6d4f314969bdbf1777"><code>e6b0bcf</code></a></td><td><code>Fix one more test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d82304b6008bb24e177e225f6cc627d9b7970c4"><code>5d82304</code></a></td><td><code>Update singular to 4.3.1p3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/388d1c7829e0e0c089e2422ba7aef6a397d0d47c"><code>388d1c7</code></a></td><td><code>Merge branch 'u/arojas/upgrade_singular_to_4_3_1p3' of git://trac.sagemath.org/sage into t/34851/upgrade_singular_to_4_3_1p3</code></td></tr></table>




---

archive/issue_comments_561685.json:
```json
{
    "body": "Changed commit from **[`55e3b32`](https://github.com/sagemath/sagetrac-mirror/commit/55e3b32672fb0909235d12f3d031c9645f9c7cca)** to **[`388d1c7`](https://github.com/sagemath/sagetrac-mirror/commit/388d1c7829e0e0c089e2422ba7aef6a397d0d47c)**",
    "created_at": "2023-01-04T18:21:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561685",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`55e3b32`](https://github.com/sagemath/sagetrac-mirror/commit/55e3b32672fb0909235d12f3d031c9645f9c7cca)** to **[`388d1c7`](https://github.com/sagemath/sagetrac-mirror/commit/388d1c7829e0e0c089e2422ba7aef6a397d0d47c)**



---

archive/issue_comments_561686.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAll tests pass locally now",
    "created_at": "2023-01-04T18:23:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561686",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:12" align="right">comment:12</div>

All tests pass locally now



---

archive/issue_events_470862.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2023-01-04T18:23:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470862"
}
```



---

archive/issue_events_470863.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-05T18:56:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470863"
}
```



---

archive/issue_events_470864.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-05T18:56:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470864"
}
```



---

archive/issue_comments_561687.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n https://groups.google.com/g/sage-devel/c/0EkgkDgMnYE/m/LFW_ZM-LAAAJ\n \n-\n+Critical because a change in the Sage library is needed also with new system installations of Singular\n``````\n",
    "created_at": "2023-01-05T18:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561687",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 https://groups.google.com/g/sage-devel/c/0EkgkDgMnYE/m/LFW_ZM-LAAAJ
 
-
+Critical because a change in the Sage library is needed also with new system installations of Singular
``````




---

archive/issue_events_470865.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-05T18:56:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "milestone_number": null,
    "milestone_title": "sage-9.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470865"
}
```



---

archive/issue_events_470866.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2023-01-05T18:56:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34851#event-470866"
}
```



---

archive/issue_comments_561688.json:
```json
{
    "body": "Author: **Antonio Rojas**",
    "created_at": "2023-01-05T18:56:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561688",
    "user": "https://github.com/mkoeppe"
}
```

Author: **Antonio Rojas**



---

archive/issue_comments_561689.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI see a number of failures on some platforms that may come from this upgrade.\n\n`ubuntu-kinetic-minimal`\nhttps://github.com/mkoeppe/sage/actions/runs/3853109922/jobs/6586248561\n\n```\nsage -t --random-seed=169150125281996254137137385578937357424 src/sage/schemes/affine/affine_homset.py\n**********************************************************************\nFile \"src/sage/schemes/affine/affine_homset.py\", line 412, in sage.schemes.affine.affine_homset.SchemeHomset_points_affine.numerical_points\nFailed example:\n    len(E(A.base_ring()).numerical_points(F=CDF, zero_tolerance=1e-9))\nExpected:\n    100\nGot:\n    99\nsage -t --random-seed=169150125281996254137137385578937357424 src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\", line 2962, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.dual\nFailed example:\n    E.isogeny(3*E.lift_x(0)).dual()\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/src/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/src/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.dual[38]>\", line 1, in <module>\n        E.isogeny(Integer(3)*E.lift_x(Integer(0))).dual()\n      File \"/sage/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py\", line 3076, in dual\n        corr = find_post_isomorphism(mult, rhs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/hom.py\", line 856, in find_post_isomorphism\n        isos = [iso for iso in isos if iso._eval(im_phi) == im_psi]\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/hom.py\", line 856, in <listcomp>\n        isos = [iso for iso in isos if iso._eval(im_phi) == im_psi]\n                                       ^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/weierstrass_morphism.py\", line 586, in _eval\n        return self._codomain.base_extend(k).point(Q)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/ell_generic.py\", line 1352, in base_extend\n        E = constructor.EllipticCurve([R(a) for a in self.a_invariants()])\n                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/ell_generic.py\", line 1352, in <listcomp>\n        E = constructor.EllipticCurve([R(a) for a in self.a_invariants()])\n                                       ^^^^\n      File \"sage/rings/finite_rings/element_givaro.pyx\", line 1355, in sage.rings.finite_rings.element_givaro.FiniteField_givaroElement.__int__\n        raise TypeError(\"Cannot coerce element to an integer.\")\n    TypeError: Cannot coerce element to an integer.\n**********************************************************************\n```\nAccess with `docker run -it ghcr.io/mkoeppe/sage/sage-docker-ubuntu-kinetic-minimal-with-targets-optional:9.5-107758-g45159d349c`\n\nThe first error is also seen in `fedora-37-minimal` (https://github.com/mkoeppe/sage/actions/runs/3853109922/jobs/6586249291).\n\n\n\nAnd on `ubuntu-focal-minimal` (https://github.com/mkoeppe/sage/actions/runs/3853109922/jobs/6586248488)\n\n```\nsage -t --random-seed=208605993874906489063634972527029657419 src/sage/schemes/elliptic_curves/hom.py\n**********************************************************************\nFile \"src/sage/schemes/elliptic_curves/hom.py\", line 817, in sage.schemes.elliptic_curves.hom.find_post_isomorphism\nFailed example:\n    find_post_isomorphism(f, g) == g\nException raised:\n    Traceback (most recent call last):\n      File \"sage/structure/category_object.pyx\", line 839, in sage.structure.category_object.CategoryObject.getattr_from_category\n        return self.__cached_methods[name]\n    KeyError: 'point_homset'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"/sage/src/sage/schemes/projective/projective_subscheme.py\", line 122, in point\n        return self._point(self.point_homset(), v, check=check)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/ell_point.py\", line 256, in __init__\n        point_homset = curve.point_homset()\n                       ^^^^^^^^^^^^^^^^^^\n      File \"sage/structure/category_object.pyx\", line 833, in sage.structure.category_object.CategoryObject.__getattr__\n        return self.getattr_from_category(name)\n      File \"sage/structure/category_object.pyx\", line 848, in sage.structure.category_object.CategoryObject.getattr_from_category\n        attr = getattr_from_other_class(self, cls, name)\n      File \"sage/cpython/getattr.pyx\", line 356, in sage.cpython.getattr.getattr_from_other_class\n        raise AttributeError(dummy_error_message)\n    AttributeError: 'RationalField_with_category' object has no attribute '__custom_name'\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"/sage/src/sage/structure/sequence.py\", line 450, in __init__\n        x[i] = universe(x[i])\n               ^^^^^^^^^^^^^^\n      File \"sage/structure/parent.pyx\", line 896, in sage.structure.parent.Parent.__call__\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 161, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 156, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_\n        return C._element_constructor(x)\n      File \"sage/rings/rational.pyx\", line 538, in sage.rings.rational.Rational.__init__\n        self.__set_value(x, base)\n      File \"sage/rings/rational.pyx\", line 683, in sage.rings.rational.Rational.__set_value\n        raise TypeError(\"unable to convert {!r} to a rational\".format(x))\n    TypeError: unable to convert 0 to a rational\n\n    During handling of the above exception, another exception occurred:\n\n    Traceback (most recent call last):\n      File \"/sage/src/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/sage/src/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.elliptic_curves.hom.find_post_isomorphism[4]>\", line 1, in <module>\n        find_post_isomorphism(f, g) == g\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/hom.py\", line 856, in find_post_isomorphism\n        isos = [iso for iso in isos if iso._eval(im_phi) == im_psi]\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/hom.py\", line 856, in <listcomp>\n        isos = [iso for iso in isos if iso._eval(im_phi) == im_psi]\n                                       ^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/weierstrass_morphism.py\", line 586, in _eval\n        return self._codomain.base_extend(k).point(Q)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/projective/projective_subscheme.py\", line 124, in point\n        return self._point(self, v, check=check)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/schemes/elliptic_curves/ell_point.py\", line 272, in __init__\n        v = Sequence(v, point_homset.value_ring())\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/structure/sequence.py\", line 266, in Sequence\n        return Sequence_generic(x, universe, check, immutable, cr, cr_str, use_sage_types)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"/sage/src/sage/structure/sequence.py\", line 452, in __init__\n        raise TypeError(\"unable to convert {} to an element of {}\"\n    TypeError: unable to convert 0 to an element of Rational Field\n**********************************************************************\n1 item had failures:\n   1 of  17 in sage.schemes.elliptic_curves.hom.find_post_isomorphism\n    [201 tests, 1 failure, 3.92 s]\n```\nAccess with `docker run -it ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-minimal-with-targets-optional:9.5-107758-g45159d349c`",
    "created_at": "2023-01-08T00:29:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34851",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34851#issuecomment-561689",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

I see a number of failures on some platforms that may come from this upgrade.

`ubuntu-kinetic-minimal`
https://github.com/mkoeppe/sage/actions/runs/3853109922/jobs/6586248561

```
sage -t --random-seed=169150125281996254137137385578937357424 src/sage/schemes/affine/affine_homset.py
**********************************************************************
File "src/sage/schemes/affine/affine_homset.py", line 412, in sage.schemes.affine.affine_homset.SchemeHomset_points_affine.numerical_points
Failed example:
    len(E(A.base_ring()).numerical_points(F=CDF, zero_tolerance=1e-9))
Expected:
    100
Got:
    99
sage -t --random-seed=169150125281996254137137385578937357424 src/sage/schemes/elliptic_curves/ell_curve_isogeny.py
**********************************************************************
File "src/sage/schemes/elliptic_curves/ell_curve_isogeny.py", line 2962, in sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.dual
Failed example:
    E.isogeny(3*E.lift_x(0)).dual()
Exception raised:
    Traceback (most recent call last):
      File "/sage/src/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/src/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.dual[38]>", line 1, in <module>
        E.isogeny(Integer(3)*E.lift_x(Integer(0))).dual()
      File "/sage/src/sage/schemes/elliptic_curves/ell_curve_isogeny.py", line 3076, in dual
        corr = find_post_isomorphism(mult, rhs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/hom.py", line 856, in find_post_isomorphism
        isos = [iso for iso in isos if iso._eval(im_phi) == im_psi]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/hom.py", line 856, in <listcomp>
        isos = [iso for iso in isos if iso._eval(im_phi) == im_psi]
                                       ^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/weierstrass_morphism.py", line 586, in _eval
        return self._codomain.base_extend(k).point(Q)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/ell_generic.py", line 1352, in base_extend
        E = constructor.EllipticCurve([R(a) for a in self.a_invariants()])
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/ell_generic.py", line 1352, in <listcomp>
        E = constructor.EllipticCurve([R(a) for a in self.a_invariants()])
                                       ^^^^
      File "sage/rings/finite_rings/element_givaro.pyx", line 1355, in sage.rings.finite_rings.element_givaro.FiniteField_givaroElement.__int__
        raise TypeError("Cannot coerce element to an integer.")
    TypeError: Cannot coerce element to an integer.
**********************************************************************
```
Access with `docker run -it ghcr.io/mkoeppe/sage/sage-docker-ubuntu-kinetic-minimal-with-targets-optional:9.5-107758-g45159d349c`

The first error is also seen in `fedora-37-minimal` (https://github.com/mkoeppe/sage/actions/runs/3853109922/jobs/6586249291).



And on `ubuntu-focal-minimal` (https://github.com/mkoeppe/sage/actions/runs/3853109922/jobs/6586248488)

```
sage -t --random-seed=208605993874906489063634972527029657419 src/sage/schemes/elliptic_curves/hom.py
**********************************************************************
File "src/sage/schemes/elliptic_curves/hom.py", line 817, in sage.schemes.elliptic_curves.hom.find_post_isomorphism
Failed example:
    find_post_isomorphism(f, g) == g
Exception raised:
    Traceback (most recent call last):
      File "sage/structure/category_object.pyx", line 839, in sage.structure.category_object.CategoryObject.getattr_from_category
        return self.__cached_methods[name]
    KeyError: 'point_homset'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "/sage/src/sage/schemes/projective/projective_subscheme.py", line 122, in point
        return self._point(self.point_homset(), v, check=check)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/ell_point.py", line 256, in __init__
        point_homset = curve.point_homset()
                       ^^^^^^^^^^^^^^^^^^
      File "sage/structure/category_object.pyx", line 833, in sage.structure.category_object.CategoryObject.__getattr__
        return self.getattr_from_category(name)
      File "sage/structure/category_object.pyx", line 848, in sage.structure.category_object.CategoryObject.getattr_from_category
        attr = getattr_from_other_class(self, cls, name)
      File "sage/cpython/getattr.pyx", line 356, in sage.cpython.getattr.getattr_from_other_class
        raise AttributeError(dummy_error_message)
    AttributeError: 'RationalField_with_category' object has no attribute '__custom_name'

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "/sage/src/sage/structure/sequence.py", line 450, in __init__
        x[i] = universe(x[i])
               ^^^^^^^^^^^^^^
      File "sage/structure/parent.pyx", line 896, in sage.structure.parent.Parent.__call__
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 161, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_
        raise
      File "sage/structure/coerce_maps.pyx", line 156, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_
        return C._element_constructor(x)
      File "sage/rings/rational.pyx", line 538, in sage.rings.rational.Rational.__init__
        self.__set_value(x, base)
      File "sage/rings/rational.pyx", line 683, in sage.rings.rational.Rational.__set_value
        raise TypeError("unable to convert {!r} to a rational".format(x))
    TypeError: unable to convert 0 to a rational

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File "/sage/src/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/sage/src/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.elliptic_curves.hom.find_post_isomorphism[4]>", line 1, in <module>
        find_post_isomorphism(f, g) == g
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/hom.py", line 856, in find_post_isomorphism
        isos = [iso for iso in isos if iso._eval(im_phi) == im_psi]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/hom.py", line 856, in <listcomp>
        isos = [iso for iso in isos if iso._eval(im_phi) == im_psi]
                                       ^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/weierstrass_morphism.py", line 586, in _eval
        return self._codomain.base_extend(k).point(Q)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/projective/projective_subscheme.py", line 124, in point
        return self._point(self, v, check=check)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/schemes/elliptic_curves/ell_point.py", line 272, in __init__
        v = Sequence(v, point_homset.value_ring())
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/structure/sequence.py", line 266, in Sequence
        return Sequence_generic(x, universe, check, immutable, cr, cr_str, use_sage_types)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "/sage/src/sage/structure/sequence.py", line 452, in __init__
        raise TypeError("unable to convert {} to an element of {}"
    TypeError: unable to convert 0 to an element of Rational Field
**********************************************************************
1 item had failures:
   1 of  17 in sage.schemes.elliptic_curves.hom.find_post_isomorphism
    [201 tests, 1 failure, 3.92 s]
```
Access with `docker run -it ghcr.io/mkoeppe/sage/sage-docker-ubuntu-focal-minimal-with-targets-optional:9.5-107758-g45159d349c`
