# Issue 34303: √élu algorithm: asymptotically faster elliptic-curve isogenies

archive/issues_034066.json:
```json
{
    "assignees": [],
    "body": "Sage currently computes an isogeny of prime degree `\u2113` using `\u03f4(\u2113)` base-field operations. We can achieve the same task in `O\u0303(\u221a\u2113)` operations using the **\u221a\u00e9lu algorithm**; see https://velusqrt.isogeny.org.\n\nThis patch adds a fairly reasonable implementation of the algorithm to Sage. It works for odd-degree isogenies over all finite fields and can outperform the current `EllipticCurveIsogeny` class starting from degrees around 100, depending on the concrete performance of the underlying base-field and polynomial arithmetic.\n\nThe new code is marked as experimental and isn't used anywhere by default. After some real-world testing and careful benchmarking, we can (and should) let Sage automatically decide which implementation to use for a given input.\n\nCC:  @defeo @JohnCremona @categorie @sagetrac-bensmith @sagetrac-tanja @tscrim @videlec @slel @kwankyu\n\nBranch: **[`a0f4c4a`](https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828)**\n\nReviewer: **John Cremona, Travis Scrimshaw, Kwankyu Lee**\n\nAuthor: **Lorenz Panny**\n\nComponent: **elliptic curves**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/34303_\n\n",
    "closed_at": "2022-08-30T06:51:36Z",
    "created_at": "2022-08-08T10:19:09Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "\u221a\u00e9lu algorithm: asymptotically faster elliptic-curve isogenies",
    "type": "issue",
    "updated_at": "2022-09-01T07:14:54Z",
    "url": "https://github.com/sagemath/sage/issues/34303",
    "user": "https://github.com/yyyyx4"
}
```
Sage currently computes an isogeny of prime degree `ℓ` using `ϴ(ℓ)` base-field operations. We can achieve the same task in `Õ(√ℓ)` operations using the **√élu algorithm**; see https://velusqrt.isogeny.org.

This patch adds a fairly reasonable implementation of the algorithm to Sage. It works for odd-degree isogenies over all finite fields and can outperform the current `EllipticCurveIsogeny` class starting from degrees around 100, depending on the concrete performance of the underlying base-field and polynomial arithmetic.

The new code is marked as experimental and isn't used anywhere by default. After some real-world testing and careful benchmarking, we can (and should) let Sage automatically decide which implementation to use for a given input.

CC:  @defeo @JohnCremona @categorie @sagetrac-bensmith @sagetrac-tanja @tscrim @videlec @slel @kwankyu

Branch: **[`a0f4c4a`](https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828)**

Reviewer: **John Cremona, Travis Scrimshaw, Kwankyu Lee**

Author: **Lorenz Panny**

Component: **elliptic curves**

_Issue created by migration from https://trac.sagemath.org/ticket/34303_





---

archive/issue_events_468955.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-08T10:19:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468955"
}
```



---

archive/issue_events_468956.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-08T10:19:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468956"
}
```



---

archive/issue_events_468957.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-08T10:19:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468957"
}
```



---

archive/issue_events_468958.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-08T10:19:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468958"
}
```



---

archive/issue_events_468959.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-08T10:25:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468959"
}
```



---

archive/issue_comments_554040.json:
```json
{
    "body": "Author: **Lorenz Panny**",
    "created_at": "2022-08-08T10:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554040",
    "user": "https://github.com/yyyyx4"
}
```

Author: **Lorenz Panny**



---

archive/issue_comments_554041.json:
```json
{
    "body": "Commit: **[`4b24a77`](https://github.com/sagemath/sagetrac-mirror/commit/4b24a772b7115c97ed4d8c1727347e90aec4587a)**",
    "created_at": "2022-08-08T10:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554041",
    "user": "https://github.com/yyyyx4"
}
```

Commit: **[`4b24a77`](https://github.com/sagemath/sagetrac-mirror/commit/4b24a772b7115c97ed4d8c1727347e90aec4587a)**



---

archive/issue_comments_554042.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,5 @@\n Sage currently computes an isogeny of prime degree `\u2113` using `\u03f4(\u2113)` base-field operations. We can achieve the same task in `O\u0303(\u221a\u2113)` operations using the **\u221a\u00e9lu algorithm**; see https://velusqrt.isogeny.org.\n \n+This patch adds a fairly reasonable implementation of the algorithm to Sage. It works for odd-degree isogenies over all finite fields and can outperform the current `EllipticCurveIsogeny` class starting from degrees around 100, depending on the concrete performance of the underlying base-field and polynomial arithmetic.\n+\n+The new code is marked as experimental and isn't used anywhere by default. After some real-world testing and careful benchmarking, we can (and should) let Sage automatically decide which implementation to use for a given input.\n``````\n",
    "created_at": "2022-08-08T10:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554042",
    "user": "https://github.com/yyyyx4"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,5 @@
 Sage currently computes an isogeny of prime degree `ℓ` using `ϴ(ℓ)` base-field operations. We can achieve the same task in `Õ(√ℓ)` operations using the **√élu algorithm**; see https://velusqrt.isogeny.org.
 
+This patch adds a fairly reasonable implementation of the algorithm to Sage. It works for odd-degree isogenies over all finite fields and can outperform the current `EllipticCurveIsogeny` class starting from degrees around 100, depending on the concrete performance of the underlying base-field and polynomial arithmetic.
+
+The new code is marked as experimental and isn't used anywhere by default. After some real-world testing and careful benchmarking, we can (and should) let Sage automatically decide which implementation to use for a given input.
``````




---

archive/issue_comments_554043.json:
```json
{
    "body": "Branch: **[public/velusqrt_algorithm_for_elliptic_curve_isogenies](https://github.com/sagemath/sagetrac-mirror/tree/public/velusqrt_algorithm_for_elliptic_curve_isogenies)**",
    "created_at": "2022-08-08T10:25:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554043",
    "user": "https://github.com/yyyyx4"
}
```

Branch: **[public/velusqrt_algorithm_for_elliptic_curve_isogenies](https://github.com/sagemath/sagetrac-mirror/tree/public/velusqrt_algorithm_for_elliptic_curve_isogenies)**



---

archive/issue_comments_554044.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI have a question: although I know that the application of greatest interest involves curves over finite fields, I assume that the faster algorithm also works in characteristic 0, so that isogenies between curves defined over number fields will also be affected by this? I hope so.",
    "created_at": "2022-08-10T13:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554044",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:2" align="right">comment:2</div>

I have a question: although I know that the application of greatest interest involves curves over finite fields, I assume that the faster algorithm also works in characteristic 0, so that isogenies between curves defined over number fields will also be affected by this? I hope so.



---

archive/issue_comments_554045.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThat's a good question. The \u221a\u00e9lu speedup works best if you have an actual rational kernel point as input, which requires big field extensions for large isogeny degrees over number fields. There is a variant of the algorithm for rational kernels made up of irrational points, but the speedup is smaller in that case.\n\nDo you have an application in mind? Which field and isogeny degree, and how is the input given? It shouldn't be hard to make this work for number fields, but I'm not sure if it helps at all, which is why I restricted the current implementation to finite fields.",
    "created_at": "2022-08-16T16:06:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554045",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:3" align="right">comment:3</div>

That's a good question. The √élu speedup works best if you have an actual rational kernel point as input, which requires big field extensions for large isogeny degrees over number fields. There is a variant of the algorithm for rational kernels made up of irrational points, but the speedup is smaller in that case.

Do you have an application in mind? Which field and isogeny degree, and how is the input given? It shouldn't be hard to make this work for number fields, but I'm not sure if it helps at all, which is why I restricted the current implementation to finite fields.



---

archive/issue_comments_554046.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI was hoping we could get this into the upcoming release so that other people can play around with it. This is opt-in and marked as experimental, so a minimum viable review basically consists of checking that it doesn't do any harm. Could someone please spare a few minutes to have a look?",
    "created_at": "2022-08-18T17:35:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554046",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:4" align="right">comment:4</div>

I was hoping we could get this into the upcoming release so that other people can play around with it. This is opt-in and marked as experimental, so a minimum viable review basically consists of checking that it doesn't do any harm. Could someone please spare a few minutes to have a look?



---

archive/issue_comments_554047.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@yyyyx4](#comment:3):\n> That's a good question. The \u221a\u00e9lu speedup works best if you have an actual rational kernel point as input, which requires big field extensions for large isogeny degrees over number fields. There is a variant of the algorithm for rational kernels made up of irrational points, but the speedup is smaller in that case.\n> \n> Do you have an application in mind? Which field and isogeny degree, and how is the input given? It shouldn't be hard to make this work for number fields, but I'm not sure if it helps at all, which is why I restricted the current implementation to finite fields.\n\nThe isogenies I compute are mostly over number fields and of small prime degree ell, where \"small\" mostly means <50.  And for most of these ell, I have implemented special code for them (which works over finte fields too, except characteristic ell).  As for the input, it's just the curve and ell and I need all the ell-isogenous curves;  there are easy necessary conditions for an ell-isogeny to exist so I would rarely try to compute one when it does not exist.",
    "created_at": "2022-08-18T18:02:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554047",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@yyyyx4](#comment:3):
> That's a good question. The √élu speedup works best if you have an actual rational kernel point as input, which requires big field extensions for large isogeny degrees over number fields. There is a variant of the algorithm for rational kernels made up of irrational points, but the speedup is smaller in that case.
> 
> Do you have an application in mind? Which field and isogeny degree, and how is the input given? It shouldn't be hard to make this work for number fields, but I'm not sure if it helps at all, which is why I restricted the current implementation to finite fields.

The isogenies I compute are mostly over number fields and of small prime degree ell, where "small" mostly means <50.  And for most of these ell, I have implemented special code for them (which works over finte fields too, except characteristic ell).  As for the input, it's just the curve and ell and I need all the ell-isogenous curves;  there are easy necessary conditions for an ell-isogeny to exist so I would rarely try to compute one when it does not exist.



---

archive/issue_comments_554048.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@yyyyx4](#comment:4):\n> I was hoping we could get this into the upcoming release so that other people can play around with it. This is opt-in and marked as experimental, so a minimum viable review basically consists of checking that it doesn't do any harm. Could someone please spare a few minutes to have a look?\n\nI had a first look, and will come back to it tomorrow.",
    "created_at": "2022-08-18T18:03:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554048",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@yyyyx4](#comment:4):
> I was hoping we could get this into the upcoming release so that other people can play around with it. This is opt-in and marked as experimental, so a minimum viable review basically consists of checking that it doesn't do any harm. Could someone please spare a few minutes to have a look?

I had a first look, and will come back to it tomorrow.



---

archive/issue_events_468960.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2022-08-19T10:34:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468960"
}
```



---

archive/issue_events_468961.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2022-08-19T10:34:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468961"
}
```



---

archive/issue_comments_554049.json:
```json
{
    "body": "Reviewer: **John Cremona**",
    "created_at": "2022-08-19T10:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554049",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **John Cremona**



---

archive/issue_comments_554050.json:
```json
{
    "body": "Work Issues: **document parameters for all methods and functions**",
    "created_at": "2022-08-19T10:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554050",
    "user": "https://github.com/JohnCremona"
}
```

Work Issues: **document parameters for all methods and functions**



---

archive/issue_comments_554051.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHere are some comments made as I read the code, so not in order of importance.  Point 4 about documenting parameters is the most important -- otherwise docstrings, examples ans tests are very good.\n\n1. Instead of \n\n```\n    sage: sum(iso(psiQ) == phiQ for iso in isos)\n    1\n```\nI would suggest\n\n```\n    sage: any(iso(psiQ) == phiQ for iso in isos)\n    True\n```\n\n2. There's a comment which says that the code works on \"short Weierstrass curves\", so I assume that menas that the characteristic should not be 2 (and perhaps also not 3).  This should probably be stated at the top of the file `hom_velusqrt.py`.  I haven't yet checked whether this condition is checked in the code.\n\n3. I see the comment about this implementation only being over finite fields.  I think that is fine, given that isogenies of high degree over number fields are rarely encountered (since the field would have to have high degree over `QQ`), as I said in an earlier comment.\n\n4. Methods' docstrings should have an INPUT block documenting all parameters (apart from `self`), for example the `_init_` method, of ProductTree and more (not itemised here!).\n\nI see that the code here is not called from elsewhere -- in particular, not called by default by isogeny methods of elliptic curve classes -- so is certainly harmless to include.",
    "created_at": "2022-08-19T10:34:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554051",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

Here are some comments made as I read the code, so not in order of importance.  Point 4 about documenting parameters is the most important -- otherwise docstrings, examples ans tests are very good.

1. Instead of 

```
    sage: sum(iso(psiQ) == phiQ for iso in isos)
    1
```
I would suggest

```
    sage: any(iso(psiQ) == phiQ for iso in isos)
    True
```

2. There's a comment which says that the code works on "short Weierstrass curves", so I assume that menas that the characteristic should not be 2 (and perhaps also not 3).  This should probably be stated at the top of the file `hom_velusqrt.py`.  I haven't yet checked whether this condition is checked in the code.

3. I see the comment about this implementation only being over finite fields.  I think that is fine, given that isogenies of high degree over number fields are rarely encountered (since the field would have to have high degree over `QQ`), as I said in an earlier comment.

4. Methods' docstrings should have an INPUT block documenting all parameters (apart from `self`), for example the `_init_` method, of ProductTree and more (not itemised here!).

I see that the code here is not called from elsewhere -- in particular, not called by default by isogeny methods of elliptic curve classes -- so is certainly harmless to include.



---

archive/issue_comments_554052.json:
```json
{
    "body": "Changed commit from **[`4b24a77`](https://github.com/sagemath/sagetrac-mirror/commit/4b24a772b7115c97ed4d8c1727347e90aec4587a)** to **[`986462f`](https://github.com/sagemath/sagetrac-mirror/commit/986462f5576f046fd7117c7585269b7fcaf79af6)**",
    "created_at": "2022-08-21T02:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554052",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4b24a77`](https://github.com/sagemath/sagetrac-mirror/commit/4b24a772b7115c97ed4d8c1727347e90aec4587a)** to **[`986462f`](https://github.com/sagemath/sagetrac-mirror/commit/986462f5576f046fd7117c7585269b7fcaf79af6)**



---

archive/issue_comments_554053.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0b8cfb988118d993acd5ef1e2bdac5bb7bf4dbe\"><code>b0b8cfb</code></a></td><td><code>clarify that curves without a short Weierstra\u00df model only exist in characteristics 2 and 3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f9a77c3be5be220729d47f655627ec30aff2818\"><code>9f9a77c</code></a></td><td><code>improve documentation for \u221a\u00e9lu code</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8bdcd4516ce9b4f7d81a33e3f1420f660279b2d8\"><code>8bdcd45</code></a></td><td><code>move comparison by evaluation up from hom_composite.py to hom.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1e80198ddfd554ab358d88b5740dee3ab20e02a9\"><code>1e80198</code></a></td><td><code>implement more flexible comparison for EllipticCurveHom children including \u221a\u00e9lu</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab4b4bf817ba3e7bd6dda4588d0047d28cd83a77\"><code>ab4b4bf</code></a></td><td><code>ensure correct base rings (example from failing random doctest)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/986462f5576f046fd7117c7585269b7fcaf79af6\"><code>986462f</code></a></td><td><code>add glue code in EllipticCurve_field.isogeny() to use the \u221a\u00e9lu implementation</code></td></tr></table>\n",
    "created_at": "2022-08-21T02:24:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554053",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0b8cfb988118d993acd5ef1e2bdac5bb7bf4dbe"><code>b0b8cfb</code></a></td><td><code>clarify that curves without a short Weierstraß model only exist in characteristics 2 and 3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f9a77c3be5be220729d47f655627ec30aff2818"><code>9f9a77c</code></a></td><td><code>improve documentation for √élu code</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8bdcd4516ce9b4f7d81a33e3f1420f660279b2d8"><code>8bdcd45</code></a></td><td><code>move comparison by evaluation up from hom_composite.py to hom.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1e80198ddfd554ab358d88b5740dee3ab20e02a9"><code>1e80198</code></a></td><td><code>implement more flexible comparison for EllipticCurveHom children including √élu</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab4b4bf817ba3e7bd6dda4588d0047d28cd83a77"><code>ab4b4bf</code></a></td><td><code>ensure correct base rings (example from failing random doctest)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/986462f5576f046fd7117c7585269b7fcaf79af6"><code>986462f</code></a></td><td><code>add glue code in EllipticCurve_field.isogeny() to use the √élu implementation</code></td></tr></table>




---

archive/issue_comments_554054.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThank you for the comments! I added `INPUT:` blocks to (I believe) all functions that need them.\n\nI also made comparison work using the same code as for composite isogenies (by reducing to evaluation), and added a (purely opt-in) call path from the `.isogeny()` method for elliptic curves so that it's easy to use the new algorithm without typing long import statements.\n\nAbout your other remarks:\n\n1. `sum(...) == 1` is a stronger statement than `any(...)`, which is why I wrote it this way: The former checks unique existence, the latter just existence.\n\n2. The implementation does work for some curves in characteristic 3, but not all of them. In the code, it simply tries converting the curve to short Weierstra\u00df form and throws an exception if that fails. This is slightly more general than checking the characteristic.\n\n3. Indeed, the situation over number fields mentioned in [#34303 comment:5](https://github.com/sagemath/sage/issues/34303#comment:5) does not seem like it would benefit from this. Should it turn out that there's something we can do after all, this can of course be taken care of at a later time.",
    "created_at": "2022-08-21T02:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554054",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:9" align="right">comment:9</div>

Thank you for the comments! I added `INPUT:` blocks to (I believe) all functions that need them.

I also made comparison work using the same code as for composite isogenies (by reducing to evaluation), and added a (purely opt-in) call path from the `.isogeny()` method for elliptic curves so that it's easy to use the new algorithm without typing long import statements.

About your other remarks:

1. `sum(...) == 1` is a stronger statement than `any(...)`, which is why I wrote it this way: The former checks unique existence, the latter just existence.

2. The implementation does work for some curves in characteristic 3, but not all of them. In the code, it simply tries converting the curve to short Weierstraß form and throws an exception if that fails. This is slightly more general than checking the characteristic.

3. Indeed, the situation over number fields mentioned in [#34303 comment:5](https://github.com/sagemath/sage/issues/34303#comment:5) does not seem like it would benefit from this. Should it turn out that there's something we can do after all, this can of course be taken care of at a later time.



---

archive/issue_comments_554055.json:
```json
{
    "body": "Changed work issues from **document parameters for all methods and functions** to none",
    "created_at": "2022-08-21T02:42:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554055",
    "user": "https://github.com/yyyyx4"
}
```

Changed work issues from **document parameters for all methods and functions** to none



---

archive/issue_events_468962.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-21T02:42:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468962"
}
```



---

archive/issue_events_468963.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-21T02:42:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468963"
}
```



---

archive/issue_comments_554056.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@JohnCremona](#comment:7):\n> 4. Methods' docstrings should have an INPUT block documenting all parameters (apart from `self`), for example the `_init_` method, of ProductTree and more (not itemised here!).\n\nOne comment on this: To make it more publicly visible, it can be useful to have the inputs for `__init__` to be at the class-level documentation and not (repeated) at the method-level since it does not appear in the docstrings. However, this is mostly a suggestion when you expect the user to directly call the class to build the object (rather than, e.g., an element of a parent which is through the parent's `_element_constructor_`).\n\nOne additional comment to John's, the `INPUT:` items should always be in code format, e.g.:\n\n```diff\n     INPUT:\n \n-    - `n` -- odd integer `\\geq 5`\n+    - ``n`` -- odd integer `\\geq 5`\n```\n\nIn `_choose_IJK`, it would also be good to specify that this needs to be an <code>:class:\\`Integer\\`</code> otherwise the method will break. In fact, since you are just wanting the integer part, you could do\n\n```python\n(n-1).sqrtrem()[0] // 2\n```\nAs a general programming note, I prefer to avoid similar variable names, such as `b` and `b_`. It is too easy to make a mistake with them.",
    "created_at": "2022-08-21T23:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554056",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@JohnCremona](#comment:7):
> 4. Methods' docstrings should have an INPUT block documenting all parameters (apart from `self`), for example the `_init_` method, of ProductTree and more (not itemised here!).

One comment on this: To make it more publicly visible, it can be useful to have the inputs for `__init__` to be at the class-level documentation and not (repeated) at the method-level since it does not appear in the docstrings. However, this is mostly a suggestion when you expect the user to directly call the class to build the object (rather than, e.g., an element of a parent which is through the parent's `_element_constructor_`).

One additional comment to John's, the `INPUT:` items should always be in code format, e.g.:

```diff
     INPUT:
 
-    - `n` -- odd integer `\geq 5`
+    - ``n`` -- odd integer `\geq 5`
```

In `_choose_IJK`, it would also be good to specify that this needs to be an <code>:class:\`Integer\`</code> otherwise the method will break. In fact, since you are just wanting the integer part, you could do

```python
(n-1).sqrtrem()[0] // 2
```
As a general programming note, I prefer to avoid similar variable names, such as `b` and `b_`. It is too easy to make a mistake with them.



---

archive/issue_comments_554057.json:
```json
{
    "body": "Changed commit from **[`986462f`](https://github.com/sagemath/sagetrac-mirror/commit/986462f5576f046fd7117c7585269b7fcaf79af6)** to **[`368a18e`](https://github.com/sagemath/sagetrac-mirror/commit/368a18e9fc901f08596ee3ae4575eacfae77a7ac)**",
    "created_at": "2022-08-22T06:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554057",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`986462f`](https://github.com/sagemath/sagetrac-mirror/commit/986462f5576f046fd7117c7585269b7fcaf79af6)** to **[`368a18e`](https://github.com/sagemath/sagetrac-mirror/commit/368a18e9fc901f08596ee3ae4575eacfae77a7ac)**



---

archive/issue_comments_554058.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/156c82053308448eb9845741e93f097b4134b4e5\"><code>156c820</code></a></td><td><code>prevent crash in _random_example_for_testing() when group is trivial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d63a50db73a3a77d3b65d3419ba195304e4d03e\"><code>3d63a50</code></a></td><td><code>move INPUT blocks from .__init__() docstrings to class docstrings</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c874dc39504705108771bee98ec1d9d47bbcfc36\"><code>c874dc3</code></a></td><td><code>explicitly convert given n to Integer in FastEllipticPolynomial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e499ea6549cbb1f05cfe6687250f9fae5d3e1197\"><code>e499ea6</code></a></td><td><code>clarify that _choose_IJK needs an Integer; use .isqrt(); rename b_ to c</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c7b344986a85a95a3976ba8a10f3cf7f94675f3\"><code>9c7b344</code></a></td><td><code>change all INPUT parameters to code formatting</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/368a18e9fc901f08596ee3ae4575eacfae77a7ac\"><code>368a18e</code></a></td><td><code>ensure correct base rings (for real this time); cf. ab4b4bf817b</code></td></tr></table>\n",
    "created_at": "2022-08-22T06:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554058",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/156c82053308448eb9845741e93f097b4134b4e5"><code>156c820</code></a></td><td><code>prevent crash in _random_example_for_testing() when group is trivial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d63a50db73a3a77d3b65d3419ba195304e4d03e"><code>3d63a50</code></a></td><td><code>move INPUT blocks from .__init__() docstrings to class docstrings</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c874dc39504705108771bee98ec1d9d47bbcfc36"><code>c874dc3</code></a></td><td><code>explicitly convert given n to Integer in FastEllipticPolynomial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e499ea6549cbb1f05cfe6687250f9fae5d3e1197"><code>e499ea6</code></a></td><td><code>clarify that _choose_IJK needs an Integer; use .isqrt(); rename b_ to c</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c7b344986a85a95a3976ba8a10f3cf7f94675f3"><code>9c7b344</code></a></td><td><code>change all INPUT parameters to code formatting</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/368a18e9fc901f08596ee3ae4575eacfae77a7ac"><code>368a18e</code></a></td><td><code>ensure correct base rings (for real this time); cf. ab4b4bf817b</code></td></tr></table>




---

archive/issue_comments_554059.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThanks! All done.",
    "created_at": "2022-08-22T06:39:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554059",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:12" align="right">comment:12</div>

Thanks! All done.



---

archive/issue_comments_554060.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThanks for making all these changes, and answering my comments.   I am happy with this, so if Travis is too he can add his name to the reviewers list and set it to \"positive review\".",
    "created_at": "2022-08-22T08:14:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554060",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:13" align="right">comment:13</div>

Thanks for making all these changes, and answering my comments.   I am happy with this, so if Travis is too he can add his name to the reviewers list and set it to "positive review".



---

archive/issue_events_468964.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-08-22T08:29:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468964"
}
```



---

archive/issue_events_468965.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2022-08-22T08:29:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468965"
}
```



---

archive/issue_comments_554061.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nGood with me too.",
    "created_at": "2022-08-22T08:29:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554061",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

Good with me too.



---

archive/issue_comments_554062.json:
```json
{
    "body": "Changed reviewer from **John Cremona** to **John Cremona, Travis Scrimshaw**",
    "created_at": "2022-08-22T08:29:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554062",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **John Cremona** to **John Cremona, Travis Scrimshaw**



---

archive/issue_comments_554063.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nSorry for being late. Let me have some time to write a comment and a question.",
    "created_at": "2022-08-22T08:33:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554063",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:15" align="right">comment:15</div>

Sorry for being late. Let me have some time to write a comment and a question.



---

archive/issue_events_468966.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-08-22T08:33:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468966"
}
```



---

archive/issue_events_468967.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-08-22T08:33:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468967"
}
```



---

archive/issue_comments_554064.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOne minor comment\n\n- You added a new option `short_weierstrass` to `compute_model`, but did not put it in `INPUT` section.\n\nAnd one question. You added this \n\n```\n.. WARNING::\n\n    This module is currently considered experimental.\n    It may change in a future release without prior warning.        \n```\nIn what sense is this experimental? What change do you mean? (1) bug fixes (2) wrong result (3) performance improvement, or (4) removal?\n\nI guess you mean only (3). In that case, you don't need to tag it as experimental. Any part of code in sage can be improved later without \"prior warning\". If this is the case, then I suggest to remove those scary \"experimental\" warnings.\n\nIf you mean (4), what is the condition of removal?",
    "created_at": "2022-08-22T08:51:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554064",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:16" align="right">comment:16</div>

One minor comment

- You added a new option `short_weierstrass` to `compute_model`, but did not put it in `INPUT` section.

And one question. You added this 

```
.. WARNING::

    This module is currently considered experimental.
    It may change in a future release without prior warning.        
```
In what sense is this experimental? What change do you mean? (1) bug fixes (2) wrong result (3) performance improvement, or (4) removal?

I guess you mean only (3). In that case, you don't need to tag it as experimental. Any part of code in sage can be improved later without "prior warning". If this is the case, then I suggest to remove those scary "experimental" warnings.

If you mean (4), what is the condition of removal?



---

archive/issue_comments_554065.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nYou have 2 (2)'s leading to a non-bijective map. `;)`",
    "created_at": "2022-08-22T08:52:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554065",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

You have 2 (2)'s leading to a non-bijective map. `;)`



---

archive/issue_comments_554066.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nKwankyu Lee's question is a good one, and I agree that there is no need for such a tag, unless you really think that this code is likely to give incorrect answers.  If that was the case, it would be better not to allow it as an option visible from the elliptic curve class.  Otherwise, if it was one day removed you would have to give deprecation warnings etc.  If you believe the code to be correct (as I hope you do!) then you can just delete the warning.",
    "created_at": "2022-08-22T10:41:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554066",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:18" align="right">comment:18</div>

Kwankyu Lee's question is a good one, and I agree that there is no need for such a tag, unless you really think that this code is likely to give incorrect answers.  If that was the case, it would be better not to allow it as an option visible from the elliptic curve class.  Otherwise, if it was one day removed you would have to give deprecation warnings etc.  If you believe the code to be correct (as I hope you do!) then you can just delete the warning.



---

archive/issue_comments_554067.json:
```json
{
    "body": "Changed commit from **[`368a18e`](https://github.com/sagemath/sagetrac-mirror/commit/368a18e9fc901f08596ee3ae4575eacfae77a7ac)** to **[`a0f4c4a`](https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828)**",
    "created_at": "2022-08-22T10:55:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554067",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`368a18e`](https://github.com/sagemath/sagetrac-mirror/commit/368a18e9fc901f08596ee3ae4575eacfae77a7ac)** to **[`a0f4c4a`](https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828)**



---

archive/issue_comments_554068.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5fe7ef4b54e1a249c42f2f5dc9147767ccf766b4\"><code>5fe7ef4</code></a></td><td><code>add \"short_weierstrass\" to list of valid inputs for compute_model()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828\"><code>a0f4c4a</code></a></td><td><code>remove experimental warning</code></td></tr></table>\n",
    "created_at": "2022-08-22T10:55:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554068",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5fe7ef4b54e1a249c42f2f5dc9147767ccf766b4"><code>5fe7ef4</code></a></td><td><code>add "short_weierstrass" to list of valid inputs for compute_model()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828"><code>a0f4c4a</code></a></td><td><code>remove experimental warning</code></td></tr></table>




---

archive/issue_comments_554069.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThanks, done! I've also created #34409, which (inspired by your comments here) suggests to remove the experimental warning for composite elliptic-curve isogenies.",
    "created_at": "2022-08-22T11:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554069",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:20" align="right">comment:20</div>

Thanks, done! I've also created #34409, which (inspired by your comments here) suggests to remove the experimental warning for composite elliptic-curve isogenies.



---

archive/issue_events_468968.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-22T11:10:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468968"
}
```



---

archive/issue_events_468969.json:
```json
{
    "actor": "https://github.com/yyyyx4",
    "created_at": "2022-08-22T11:10:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468969"
}
```



---

archive/issue_comments_554070.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@tscrim](#comment:17):\n> You have 2 (2)'s leading to a non-bijective map. `;)`\n\nFixed. Thanks. It was awful.",
    "created_at": "2022-08-22T11:22:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554070",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@tscrim](#comment:17):
> You have 2 (2)'s leading to a non-bijective map. `;)`

Fixed. Thanks. It was awful.



---

archive/issue_events_468970.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-08-22T11:41:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468970"
}
```



---

archive/issue_events_468971.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2022-08-22T11:41:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468971"
}
```



---

archive/issue_comments_554071.json:
```json
{
    "body": "Changed reviewer from **John Cremona, Travis Scrimshaw** to **John Cremona, Travis Scrimshaw, Kwankyu Lee**",
    "created_at": "2022-08-22T11:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554071",
    "user": "https://github.com/kwankyu"
}
```

Changed reviewer from **John Cremona, Travis Scrimshaw** to **John Cremona, Travis Scrimshaw, Kwankyu Lee**



---

archive/issue_comments_554072.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@yyyyx4](#comment:20):\n> Thanks, done! I've also created #34409, which (inspired by your comments here) suggests to remove the experimental warning for composite elliptic-curve isogenies.\n\nThank you. It was perhaps your being modest. But Sage should always deliver reliable code, and I think we should avoid including experimental code in Sage.",
    "created_at": "2022-08-22T11:41:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554072",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@yyyyx4](#comment:20):
> Thanks, done! I've also created #34409, which (inspired by your comments here) suggests to remove the experimental warning for composite elliptic-curve isogenies.

Thank you. It was perhaps your being modest. But Sage should always deliver reliable code, and I think we should avoid including experimental code in Sage.



---

archive/issue_comments_554073.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThanks a lot everyone!\n\n(Indeed, I'm reasonably convinced that the code is correct. I added the experimental warning not because I feared things were broken, but because it'd make it easier to tweak the API later. Presumably though, this won't be necessary anyway.)",
    "created_at": "2022-08-22T13:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554073",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:23" align="right">comment:23</div>

Thanks a lot everyone!

(Indeed, I'm reasonably convinced that the code is correct. I added the experimental warning not because I feared things were broken, but because it'd make it easier to tweak the API later. Presumably though, this won't be necessary anyway.)



---

archive/issue_comments_554074.json:
```json
{
    "body": "Changed branch from **[public/velusqrt_algorithm_for_elliptic_curve_isogenies](https://github.com/sagemath/sagetrac-mirror/tree/public/velusqrt_algorithm_for_elliptic_curve_isogenies)** to **[`a0f4c4a`](https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828)**",
    "created_at": "2022-08-30T06:51:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554074",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/velusqrt_algorithm_for_elliptic_curve_isogenies](https://github.com/sagemath/sagetrac-mirror/tree/public/velusqrt_algorithm_for_elliptic_curve_isogenies)** to **[`a0f4c4a`](https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828)**



---

archive/issue_events_468972.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-08-30T06:51:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468972"
}
```



---

archive/issue_events_468973.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9005c089e865552e2696d838d18fb0a888a5f5e8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2022-08-30T06:51:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/34303#event-468973"
}
```



---

archive/issue_comments_554075.json:
```json
{
    "body": "Changed commit from **[`a0f4c4a`](https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828)** to none",
    "created_at": "2022-08-31T15:25:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554075",
    "user": "https://github.com/antonio-rojas"
}
```

Changed commit from **[`a0f4c4a`](https://github.com/sagemath/sagetrac-mirror/commit/a0f4c4a994abeadc7719c44625b37b0c2ee7c828)** to none



---

archive/issue_comments_554076.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nGot a test failure with a specific random seed\n\n```\nsage -t --long --random-seed=66297844331759291946775140613791774160 /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/hom_velusqrt.py\n**********************************************************************\nFile \"/usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/hom_velusqrt.py\", line 829, in sage.schemes.elliptic_curves.hom_velusqrt.EllipticCurveHom_velusqrt\nFailed example:\n    any(map(check, psi.codomain().isomorphisms(phi.codomain())))\nExpected:\n    True\nGot:\n    False\n**********************************************************************\n```",
    "created_at": "2022-08-31T15:25:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554076",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:25" align="right">comment:25</div>

Got a test failure with a specific random seed

```
sage -t --long --random-seed=66297844331759291946775140613791774160 /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/hom_velusqrt.py
**********************************************************************
File "/usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/hom_velusqrt.py", line 829, in sage.schemes.elliptic_curves.hom_velusqrt.EllipticCurveHom_velusqrt
Failed example:
    any(map(check, psi.codomain().isomorphisms(phi.codomain())))
Expected:
    True
Got:
    False
**********************************************************************
```



---

archive/issue_comments_554077.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nand the linter now requires a blank line before nested definitions",
    "created_at": "2022-08-31T19:06:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554077",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:26" align="right">comment:26</div>

and the linter now requires a blank line before nested definitions



---

archive/issue_comments_554078.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThanks both of you. See #34467 and #34466.",
    "created_at": "2022-09-01T07:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/34303",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/34303#issuecomment-554078",
    "user": "https://github.com/yyyyx4"
}
```

<div id="comment:27" align="right">comment:27</div>

Thanks both of you. See #34467 and #34466.
