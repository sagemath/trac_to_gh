# Issue 18163: Maximum recursion depth error when listing points of a projective space

archive/issues_018163.json:
```json
{
    "body": "CC:  @nathanncohen\n\n\n```\nsage: P = ProjectiveSpace(2,GF(2))\nsage: P.point_set().list()\nTraceback (most recent call last):\n...\nRuntimeError: maximum recursion depth exceeded in __instancecheck__\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18400\n\n",
    "created_at": "2015-05-11T10:48:08Z",
    "labels": [
        "algebraic geometry",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "Maximum recursion depth error when listing points of a projective space",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18163",
    "user": "@videlec"
}
```
CC:  @nathanncohen


```
sage: P = ProjectiveSpace(2,GF(2))
sage: P.point_set().list()
Traceback (most recent call last):
...
RuntimeError: maximum recursion depth exceeded in __instancecheck__
```


Issue created by migration from https://trac.sagemath.org/ticket/18400





---

archive/issue_comments_244957.json:
```json
{
    "body": "Though, the following works\n\n```\nsage: P.point_set().points()\n[(0 : 0 : 1),\n (0 : 1 : 0),\n (0 : 1 : 1),\n (0 : 2 : 1),\n (1 : 0 : 0),\n (1 : 0 : 1),\n (1 : 1 : 0),\n (1 : 1 : 1),\n (1 : 2 : 1),\n (2 : 0 : 1),\n (2 : 1 : 0),\n (2 : 1 : 1),\n (2 : 2 : 1)]\n```\n",
    "created_at": "2015-05-11T11:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244957",
    "user": "@videlec"
}
```

Though, the following works

```
sage: P.point_set().points()
[(0 : 0 : 1),
 (0 : 1 : 0),
 (0 : 1 : 1),
 (0 : 2 : 1),
 (1 : 0 : 0),
 (1 : 0 : 1),
 (1 : 1 : 0),
 (1 : 1 : 1),
 (1 : 2 : 1),
 (2 : 0 : 1),
 (2 : 1 : 0),
 (2 : 1 : 1),
 (2 : 2 : 1)]
```




---

archive/issue_comments_244958.json:
```json
{
    "body": "Also:\n\n\n```\nsage: len(ProjectiveSpace(2,GF(2)))\n...\nAttributeError: 'ProjectiveSpace_finite_field_with_category' object has no attribute 'list'\n```\n",
    "created_at": "2015-05-11T11:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244958",
    "user": "@nathanncohen"
}
```

Also:


```
sage: len(ProjectiveSpace(2,GF(2)))
...
AttributeError: 'ProjectiveSpace_finite_field_with_category' object has no attribute 'list'
```




---

archive/issue_comments_244959.json:
```json
{
    "body": "And\n\n```\nsage: len(ProjectiveSpace(2,GF(2)).point_set())\n...\nRuntimeError: maximum recursion depth exceeded while calling a Python object\n```\n",
    "created_at": "2015-05-11T11:49:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244959",
    "user": "@nathanncohen"
}
```

And

```
sage: len(ProjectiveSpace(2,GF(2)).point_set())
...
RuntimeError: maximum recursion depth exceeded while calling a Python object
```




---

archive/issue_comments_244960.json:
```json
{
    "body": "apparently `list()` calls `len`, and `len` calls list. I do not see anything wrong with the design.",
    "created_at": "2015-05-11T11:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244960",
    "user": "@nathanncohen"
}
```

apparently `list()` calls `len`, and `len` calls list. I do not see anything wrong with the design.



---

archive/issue_comments_244961.json:
```json
{
    "body": "The two examples in [comment:3 comment:3] and [comment:4 comment:4] are not exactly wrong in the same way. In algebraic geometry, a scheme is not a set. And indeed\n\n```\nsage: P = ProjectiveSapce(2,GF(2))\nsage: P in Sets()\nFalse\nsage: P.point_set() in Sets()\nTrue\n```\n\nI do not understand why there is a `__len__` implemented there! It is inherited from `Parent` as\n\n```\ndef __len__(self):\n    return len(self.list())\n```\n\nHaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\n\nVincent",
    "created_at": "2015-05-11T11:54:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244961",
    "user": "@videlec"
}
```

The two examples in [comment:3 comment:3] and [comment:4 comment:4] are not exactly wrong in the same way. In algebraic geometry, a scheme is not a set. And indeed

```
sage: P = ProjectiveSapce(2,GF(2))
sage: P in Sets()
False
sage: P.point_set() in Sets()
True
```

I do not understand why there is a `__len__` implemented there! It is inherited from `Parent` as

```
def __len__(self):
    return len(self.list())
```

Haaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

Vincent



---

archive/issue_comments_244962.json:
```json
{
    "body": "First, what about removing the `.list()` function, which returns `tuple(self)`, i.e. a tuple?",
    "created_at": "2015-05-11T11:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244962",
    "user": "@nathanncohen"
}
```

First, what about removing the `.list()` function, which returns `tuple(self)`, i.e. a tuple?



---

archive/issue_comments_244963.json:
```json
{
    "body": "What about removing `.list()` from `Parent`? God knows that I hate both `Parent` and categories, but given that a `Parent` is not necessarily a finite set it is not very smart to have it return the cardinality of the set after a full enumeration.\n\nThis 'len' should be in `FiniteEnumerateSet` or whatever it is named nowadays.",
    "created_at": "2015-05-11T11:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244963",
    "user": "@nathanncohen"
}
```

What about removing `.list()` from `Parent`? God knows that I hate both `Parent` and categories, but given that a `Parent` is not necessarily a finite set it is not very smart to have it return the cardinality of the set after a full enumeration.

This 'len' should be in `FiniteEnumerateSet` or whatever it is named nowadays.



---

archive/issue_comments_244964.json:
```json
{
    "body": "See the 3 years old ticket #12955...",
    "created_at": "2015-05-11T12:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244964",
    "user": "@videlec"
}
```

See the 3 years old ticket #12955...



---

archive/issue_comments_244965.json:
```json
{
    "body": "Oh. Then it is going to be addressed. Fine.",
    "created_at": "2015-05-11T12:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244965",
    "user": "@nathanncohen"
}
```

Oh. Then it is going to be addressed. Fine.



---

archive/issue_comments_244966.json:
```json
{
    "body": "Replying to [comment:10 ncohen]:\n> Oh. Then it is going to be addressed.\n\nSome people thinks that opening a ticket solves an issue... I am worried by the \"it is going to\" which is a date between now and never (though the bound is strict on the right hand side).",
    "created_at": "2015-05-11T12:29:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244966",
    "user": "@videlec"
}
```

Replying to [comment:10 ncohen]:
> Oh. Then it is going to be addressed.

Some people thinks that opening a ticket solves an issue... I am worried by the "it is going to" which is a date between now and never (though the bound is strict on the right hand side).



---

archive/issue_comments_244967.json:
```json
{
    "body": "Yeah. And the people who think that just got millions from Europe.",
    "created_at": "2015-05-11T12:32:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244967",
    "user": "@nathanncohen"
}
```

Yeah. And the people who think that just got millions from Europe.



---

archive/issue_comments_244968.json:
```json
{
    "body": "I just ran into this bug:\n\n```\nsage: P.<x,y> = ProjectiveSpace(1, QQ)\nsage: Q = P.subscheme(x - y)\nsage: S = Q.point_set()\nsage: S.points()\n[(1 : 1)]\nsage: S.list()\nTraceback (most recent call last):\n...\nRuntimeError: maximum recursion depth exceeded in __instancecheck__\n```\n\nThe easiest way to solve this is to make `list()` an alias for `points()` in `sage.schemes.projective.projective_homset.SchemeHomset_points_projective_field`.  Alternatively we could implement `__iter__()` in this class and make `points()` a wrapper around that.",
    "created_at": "2016-11-04T10:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18163",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18163#issuecomment-244968",
    "user": "@pjbruin"
}
```

I just ran into this bug:

```
sage: P.<x,y> = ProjectiveSpace(1, QQ)
sage: Q = P.subscheme(x - y)
sage: S = Q.point_set()
sage: S.points()
[(1 : 1)]
sage: S.list()
Traceback (most recent call last):
...
RuntimeError: maximum recursion depth exceeded in __instancecheck__
```

The easiest way to solve this is to make `list()` an alias for `points()` in `sage.schemes.projective.projective_homset.SchemeHomset_points_projective_field`.  Alternatively we could implement `__iter__()` in this class and make `points()` a wrapper around that.
