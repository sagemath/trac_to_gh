# Issue 18163: Maximum recursion depth error when listing points of a projective space

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2015-05-11 10:48:08

CC:  ncohen


```
sage: P = ProjectiveSpace(2,GF(2))
sage: P.point_set().list()
Traceback (most recent call last):
...
RuntimeError: maximum recursion depth exceeded in __instancecheck__
```



---

Comment by vdelecroix created at 2015-05-11 11:11:20

Though, the following works

```
sage: P.point_set().points()
[(0 : 0 : 1),
 (0 : 1 : 0),
 (0 : 1 : 1),
 (0 : 2 : 1),
 (1 : 0 : 0),
 (1 : 0 : 1),
 (1 : 1 : 0),
 (1 : 1 : 1),
 (1 : 2 : 1),
 (2 : 0 : 1),
 (2 : 1 : 0),
 (2 : 1 : 1),
 (2 : 2 : 1)]
```



---

Comment by ncohen created at 2015-05-11 11:47:40

Also:


```
sage: len(ProjectiveSpace(2,GF(2)))
...
AttributeError: 'ProjectiveSpace_finite_field_with_category' object has no attribute 'list'
```



---

Comment by ncohen created at 2015-05-11 11:49:02

And

```
sage: len(ProjectiveSpace(2,GF(2)).point_set())
...
RuntimeError: maximum recursion depth exceeded while calling a Python object
```



---

Comment by ncohen created at 2015-05-11 11:51:06

apparently `list()` calls `len`, and `len` calls list. I do not see anything wrong with the design.


---

Comment by vdelecroix created at 2015-05-11 11:54:04

The two examples in [comment:3 comment:3] and [comment:4 comment:4] are not exactly wrong in the same way. In algebraic geometry, a scheme is not a set. And indeed

```
sage: P = ProjectiveSapce(2,GF(2))
sage: P in Sets()
False
sage: P.point_set() in Sets()
True
```

I do not understand why there is a `__len__` implemented there! It is inherited from `Parent` as

```
def __len__(self):
    return len(self.list())
```

Haaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

Vincent


---

Comment by ncohen created at 2015-05-11 11:54:49

First, what about removing the `.list()` function, which returns `tuple(self)`, i.e. a tuple?


---

Comment by ncohen created at 2015-05-11 11:59:17

What about removing `.list()` from `Parent`? God knows that I hate both `Parent` and categories, but given that a `Parent` is not necessarily a finite set it is not very smart to have it return the cardinality of the set after a full enumeration.

This 'len' should be in `FiniteEnumerateSet` or whatever it is named nowadays.


---

Comment by vdelecroix created at 2015-05-11 12:03:01

See the 3 years old ticket #12955...


---

Comment by ncohen created at 2015-05-11 12:03:47

Oh. Then it is going to be addressed. Fine.


---

Comment by vdelecroix created at 2015-05-11 12:29:06

Replying to [comment:10 ncohen]:
> Oh. Then it is going to be addressed.

Some people thinks that opening a ticket solves an issue... I am worried by the "it is going to" which is a date between now and never (though the bound is strict on the right hand side).


---

Comment by ncohen created at 2015-05-11 12:32:34

Yeah. And the people who think that just got millions from Europe.


---

Comment by pbruin created at 2016-11-04 10:56:57

I just ran into this bug:

```
sage: P.<x,y> = ProjectiveSpace(1, QQ)
sage: Q = P.subscheme(x - y)
sage: S = Q.point_set()
sage: S.points()
[(1 : 1)]
sage: S.list()
Traceback (most recent call last):
...
RuntimeError: maximum recursion depth exceeded in __instancecheck__
```

The easiest way to solve this is to make `list()` an alias for `points()` in `sage.schemes.projective.projective_homset.SchemeHomset_points_projective_field`.  Alternatively we could implement `__iter__()` in this class and make `points()` a wrapper around that.
