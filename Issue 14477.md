# Issue 14477: dumps doesn't save immutability for Matrix_mod2_dense

archive/issues_014477.json:
```json
{
    "body": "Assignee: jason, was\n\nCC:  @tscrim\n\nKeywords: immutable hashable matrix GF(2)\n\nDumps doesn't save immutability for matrices over GF(2).\n\nSimple example:\n\n```\nz = zero_matrix(GF(2), 3)\nz.set_immutable()\nprint(z.is_immutable())\nzstr = z.dumps()\nz2 = loads(zstr)\nprint(z2.is_immutable())\n```\n\nThis affects saving matrices and in particular raises `TypeError('mutable matrices are unhashable',)` when these matrices are used in hashed collections (set/dict etc):\n\n```\nz = zero_matrix(GF(2), 3)\nz.set_immutable()\ns = set()\ns.add(z)\nsstr = dumps(s)\ns2 = loads(sstr)\n```\n\n**Work Around for saving:**\nSaving lists of matrices works just fine, so if you need to save a set or dictionary, convert to/from a list on before/after save. \n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/14681\n\n",
    "closed_at": "2021-09-10T17:33:19Z",
    "created_at": "2013-06-03T16:30:58Z",
    "labels": [
        "component: linear algebra",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "dumps doesn't save immutability for Matrix_mod2_dense",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14477",
    "user": "https://trac.sagemath.org/admin/accounts/users/matthew.weippert"
}
```
Assignee: jason, was

CC:  @tscrim

Keywords: immutable hashable matrix GF(2)

Dumps doesn't save immutability for matrices over GF(2).

Simple example:

```
z = zero_matrix(GF(2), 3)
z.set_immutable()
print(z.is_immutable())
zstr = z.dumps()
z2 = loads(zstr)
print(z2.is_immutable())
```

This affects saving matrices and in particular raises `TypeError('mutable matrices are unhashable',)` when these matrices are used in hashed collections (set/dict etc):

```
z = zero_matrix(GF(2), 3)
z.set_immutable()
s = set()
s.add(z)
sstr = dumps(s)
s2 = loads(sstr)
```

**Work Around for saving:**
Saving lists of matrices works just fine, so if you need to save a set or dictionary, convert to/from a list on before/after save. 



Issue created by migration from https://trac.sagemath.org/ticket/14681





---

archive/issue_events_041982.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41982"
}
```



---

archive/issue_events_041983.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41983"
}
```



---

archive/issue_events_041984.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41984"
}
```



---

archive/issue_events_041985.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41985"
}
```



---

archive/issue_events_041986.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41986"
}
```



---

archive/issue_events_041987.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41987"
}
```



---

archive/issue_events_041988.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41988"
}
```



---

archive/issue_events_041989.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-10T06:37:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41989"
}
```



---

archive/issue_events_041990.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-10T06:37:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41990"
}
```



---

archive/issue_comments_182949.json:
```json
{
    "body": "outdated, works ok in 9.5.beta0",
    "created_at": "2021-09-10T06:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14477#issuecomment-182949",
    "user": "https://github.com/mkoeppe"
}
```

outdated, works ok in 9.5.beta0



---

archive/issue_comments_182950.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-10T06:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14477#issuecomment-182950",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_182951.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-10T11:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14477#issuecomment-182951",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_182952.json:
```json
{
    "body": "Non-existent issue now.",
    "created_at": "2021-09-10T11:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14477#issuecomment-182952",
    "user": "https://github.com/kwankyu"
}
```

Non-existent issue now.



---

archive/issue_events_041991.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-09-10T17:33:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14477#event-41991"
}
```



---

archive/issue_comments_182953.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-09-10T17:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14477#issuecomment-182953",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
