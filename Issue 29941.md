# Issue 29941: Adding Orientibility and Compactness

archive/issues_029941.json:
```json
{
    "body": "CC:  egourgoulhon tscrim mkoeppe slelievre @tobiasdiez\n\nIt would be good if one can state whether a manifold is compact and/or orientable as some statements only apply for these kind of manifolds. Of course, at the end it will be, except for very trivial cases, the user's responsibility that the conditions are actually satisfied.\n\nIssue created by migration from https://trac.sagemath.org/ticket/30178\n\n",
    "created_at": "2020-07-20T11:49:42Z",
    "labels": [
        "manifolds",
        "major",
        "enhancement"
    ],
    "title": "Adding Orientibility and Compactness",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29941",
    "user": "@mjungmath"
}
```
CC:  egourgoulhon tscrim mkoeppe slelievre @tobiasdiez

It would be good if one can state whether a manifold is compact and/or orientable as some statements only apply for these kind of manifolds. Of course, at the end it will be, except for very trivial cases, the user's responsibility that the conditions are actually satisfied.

Issue created by migration from https://trac.sagemath.org/ticket/30178





---

archive/issue_comments_425268.json:
```json
{
    "body": "**Regarding orientability:**\n\nOne could add a method `set_orientation` which takes a list of charts or frames which cover the manifold yielding an orientation. Then it is the user's responsibility to check that this is indeed an orientation. Using this, one can construct things like volume forms etc.\n\nIn very easy cases, like if the manifold is covered by only one chart, one can give the orientation right away.\n\n*Remark:* Notice that the volume form returned by [sage.manifolds.differentiable.metric.PseudoRiemannianMetric.volume_form](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/metric.html#sage.manifolds.differentiable.metric.PseudoRiemannianMetric.volume_form) does not necessarily yield a volume form at all. One indeed needs an oriented atlas. Otherwise, the gluing process could be messed up. This can all be prevented and covered by my proposal above.\n\n**Regarding Compactness:**\n\nI think, the best way would be to state compactness right from the beginning. Not stating compactness should, in my opinion, not exclude compactness. Maybe a new manifold class does a suitable job?",
    "created_at": "2020-07-20T15:54:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425268",
    "user": "@mjungmath"
}
```

**Regarding orientability:**

One could add a method `set_orientation` which takes a list of charts or frames which cover the manifold yielding an orientation. Then it is the user's responsibility to check that this is indeed an orientation. Using this, one can construct things like volume forms etc.

In very easy cases, like if the manifold is covered by only one chart, one can give the orientation right away.

*Remark:* Notice that the volume form returned by [sage.manifolds.differentiable.metric.PseudoRiemannianMetric.volume_form](https://doc.sagemath.org/html/en/reference/manifolds/sage/manifolds/differentiable/metric.html#sage.manifolds.differentiable.metric.PseudoRiemannianMetric.volume_form) does not necessarily yield a volume form at all. One indeed needs an oriented atlas. Otherwise, the gluing process could be messed up. This can all be prevented and covered by my proposal above.

**Regarding Compactness:**

I think, the best way would be to state compactness right from the beginning. Not stating compactness should, in my opinion, not exclude compactness. Maybe a new manifold class does a suitable job?



---

archive/issue_comments_425269.json:
```json
{
    "body": "In the differentiable setting, things are easy and can be managed by using frames. This is quite convenient because there are manifolds which can be covered by one global frame, and therefore admit an orientation, but need at least two charts.\n\nHowever, I know that there is a notion of orientability in the topological setting, where the use of charts is mandatory. I look for further literature.\n\nI would prefer the chart version because it is applicable to both, topological and differentiable manifolds. Because the former case is easier and more practical, one could also implement orientations only for differentiable manifolds at first. Further opinions on that?\n\n**Addendum:** If someone has an idea of how both cases, charts and frames, can be managed conveniently, I welcome that pretty much.",
    "created_at": "2020-07-21T12:19:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425269",
    "user": "@mjungmath"
}
```

In the differentiable setting, things are easy and can be managed by using frames. This is quite convenient because there are manifolds which can be covered by one global frame, and therefore admit an orientation, but need at least two charts.

However, I know that there is a notion of orientability in the topological setting, where the use of charts is mandatory. I look for further literature.

I would prefer the chart version because it is applicable to both, topological and differentiable manifolds. Because the former case is easier and more practical, one could also implement orientations only for differentiable manifolds at first. Further opinions on that?

**Addendum:** If someone has an idea of how both cases, charts and frames, can be managed conveniently, I welcome that pretty much.



---

archive/issue_comments_425270.json:
```json
{
    "body": "I have added a first draft (without documentation). I wait for your opinions before I go on.\n----\nNew commits:",
    "created_at": "2020-07-21T13:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425270",
    "user": "@mjungmath"
}
```

I have added a first draft (without documentation). I wait for your opinions before I go on.
----
New commits:



---

archive/issue_comments_425271.json:
```json
{
    "body": "Just a quick note that there is already an axiom `Compact` provided by `TopologicalSpaces`.",
    "created_at": "2020-07-27T00:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425271",
    "user": "mkoeppe"
}
```

Just a quick note that there is already an axiom `Compact` provided by `TopologicalSpaces`.



---

archive/issue_comments_425272.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-29T18:01:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425272",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425273.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-29T19:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425273",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425274.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-30T19:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425274",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425275.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-30T19:05:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425275",
    "user": "@mjungmath"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_425276.json:
```json
{
    "body": "I forgot the authorship...again.",
    "created_at": "2020-07-30T19:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425276",
    "user": "@mjungmath"
}
```

I forgot the authorship...again.



---

archive/issue_comments_425277.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-31T10:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425277",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425278.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-31T10:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425278",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425279.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-31T10:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425279",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425280.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-01T07:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425280",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425281.json:
```json
{
    "body": "Patchbot won't go green, startup issues. Can one force another patchbot check?",
    "created_at": "2020-08-05T12:06:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425281",
    "user": "@mjungmath"
}
```

Patchbot won't go green, startup issues. Can one force another patchbot check?



---

archive/issue_comments_425282.json:
```json
{
    "body": "There was a green patchbot run (also that plugin can be a bit more fickle).",
    "created_at": "2020-08-06T05:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425282",
    "user": "tscrim"
}
```

There was a green patchbot run (also that plugin can be a bit more fickle).



---

archive/issue_comments_425283.json:
```json
{
    "body": "Ah yes, on beta6. Anyway, this ticket is ready for review. :)",
    "created_at": "2020-08-06T07:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425283",
    "user": "@mjungmath"
}
```

Ah yes, on beta6. Anyway, this ticket is ready for review. :)



---

archive/issue_comments_425284.json:
```json
{
    "body": "In response to your questions/comments from comment:2: I think it should just be the user's responsibility as it would be too costly and annoying to include code to check this. Trusting the usuer is done in a number of places in Sage too. As Matthias said, you can use `Manifolds(R).Compact()` to indicate compactness.\n\nA few stylistic things:\n\nYou are saving 1 character here\n\n```\n            from sage.manifolds.differentiable.vector_bundle \\\n                                                            import TensorBundle\n```\n\nJust go over the 80 char/line limit; it makes it much more readable.\n\nSimilar for these changes:\n\n```diff\n             sage: repr(TM) # indirect doctest\n-            'Tangent bundle TM over the 2-dimensional differentiable manifold M'\n+            'Tangent bundle TM over the 2-dimensional differentiable\n+             manifold M'\n             sage: TM._repr_()\n-            'Tangent bundle TM over the 2-dimensional differentiable manifold M'\n+            'Tangent bundle TM over the 2-dimensional differentiable\n+             manifold M'\n```\n\n\nFurther indent the last line on this change and all other similar changes:\n\n```diff\n             {(Chart (M, (x, y)),\n-              Chart (M, (u, v))): Change of coordinates from Chart (M, (x, y)) to Chart (M, (u, v))}\n+              Chart (M, (u, v))): Change of coordinates from Chart (M, (x, y))\n+              to Chart (M, (u, v))}\n```\n\nto make it (more) clear that it is associated to that item.",
    "created_at": "2020-08-08T01:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425284",
    "user": "tscrim"
}
```

In response to your questions/comments from comment:2: I think it should just be the user's responsibility as it would be too costly and annoying to include code to check this. Trusting the usuer is done in a number of places in Sage too. As Matthias said, you can use `Manifolds(R).Compact()` to indicate compactness.

A few stylistic things:

You are saving 1 character here

```
            from sage.manifolds.differentiable.vector_bundle \
                                                            import TensorBundle
```

Just go over the 80 char/line limit; it makes it much more readable.

Similar for these changes:

```diff
             sage: repr(TM) # indirect doctest
-            'Tangent bundle TM over the 2-dimensional differentiable manifold M'
+            'Tangent bundle TM over the 2-dimensional differentiable
+             manifold M'
             sage: TM._repr_()
-            'Tangent bundle TM over the 2-dimensional differentiable manifold M'
+            'Tangent bundle TM over the 2-dimensional differentiable
+             manifold M'
```


Further indent the last line on this change and all other similar changes:

```diff
             {(Chart (M, (x, y)),
-              Chart (M, (u, v))): Change of coordinates from Chart (M, (x, y)) to Chart (M, (u, v))}
+              Chart (M, (u, v))): Change of coordinates from Chart (M, (x, y))
+              to Chart (M, (u, v))}
```

to make it (more) clear that it is associated to that item.



---

archive/issue_comments_425285.json:
```json
{
    "body": "Replying to [comment:22 tscrim]:\n> In response to your questions/comments from comment:2: I think it should just be the user's responsibility as it would be too costly and annoying to include code to check this. Trusting the usuer is done in a number of places in Sage too. As Matthias said, you can use `Manifolds(R).Compact()` to indicate compactness.\n\nRight. There are many tickets going on simultaneously. I have to catch them up first.\n\n> \n> A few stylistic things:\n> \n> You are saving 1 character here\n> {{{\n>             from sage.manifolds.differentiable.vector_bundle \\\n>                                                             import TensorBundle\n> }}}\n> Just go over the 80 char/line limit; it makes it much more readable.\n> \n> Similar for these changes:\n> {{{#!diff\n>              sage: repr(TM) # indirect doctest\n> -            'Tangent bundle TM over the 2-dimensional differentiable manifold M'\n> +            'Tangent bundle TM over the 2-dimensional differentiable\n> +             manifold M'\n>              sage: TM._repr_()\n> -            'Tangent bundle TM over the 2-dimensional differentiable manifold M'\n> +            'Tangent bundle TM over the 2-dimensional differentiable\n> +             manifold M'\n> }}}\n> \n> Further indent the last line on this change and all other similar changes:\n> {{{#!diff\n>              {(Chart (M, (x, y)),\n> -              Chart (M, (u, v))): Change of coordinates from Chart (M, (x, y)) to Chart (M, (u, v))}\n> +              Chart (M, (u, v))): Change of coordinates from Chart (M, (x, y))\n> +              to Chart (M, (u, v))}\n> }}}\n> to make it (more) clear that it is associated to that item.\n\nMh, okay. Well, I followed the PEP8 guidelines which indicates 79 characters per line: https://www.python.org/dev/peps/pep-0008/#maximum-line-length",
    "created_at": "2020-08-08T07:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425285",
    "user": "@mjungmath"
}
```

Replying to [comment:22 tscrim]:
> In response to your questions/comments from comment:2: I think it should just be the user's responsibility as it would be too costly and annoying to include code to check this. Trusting the usuer is done in a number of places in Sage too. As Matthias said, you can use `Manifolds(R).Compact()` to indicate compactness.

Right. There are many tickets going on simultaneously. I have to catch them up first.

> 
> A few stylistic things:
> 
> You are saving 1 character here
> {{{
>             from sage.manifolds.differentiable.vector_bundle \
>                                                             import TensorBundle
> }}}
> Just go over the 80 char/line limit; it makes it much more readable.
> 
> Similar for these changes:
> {{{#!diff
>              sage: repr(TM) # indirect doctest
> -            'Tangent bundle TM over the 2-dimensional differentiable manifold M'
> +            'Tangent bundle TM over the 2-dimensional differentiable
> +             manifold M'
>              sage: TM._repr_()
> -            'Tangent bundle TM over the 2-dimensional differentiable manifold M'
> +            'Tangent bundle TM over the 2-dimensional differentiable
> +             manifold M'
> }}}
> 
> Further indent the last line on this change and all other similar changes:
> {{{#!diff
>              {(Chart (M, (x, y)),
> -              Chart (M, (u, v))): Change of coordinates from Chart (M, (x, y)) to Chart (M, (u, v))}
> +              Chart (M, (u, v))): Change of coordinates from Chart (M, (x, y))
> +              to Chart (M, (u, v))}
> }}}
> to make it (more) clear that it is associated to that item.

Mh, okay. Well, I followed the PEP8 guidelines which indicates 79 characters per line: https://www.python.org/dev/peps/pep-0008/#maximum-line-length



---

archive/issue_comments_425286.json:
```json
{
    "body": "Apparently, the guidelines have changed a couple of years ago. The PEP8 guidelines are linked in the [Sage reference](https://doc.sagemath.org/html/en/developer/coding_basics.html#sage-documentation-style) but their recommendations have not been updated.",
    "created_at": "2020-08-08T09:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425286",
    "user": "@mjungmath"
}
```

Apparently, the guidelines have changed a couple of years ago. The PEP8 guidelines are linked in the [Sage reference](https://doc.sagemath.org/html/en/developer/coding_basics.html#sage-documentation-style) but their recommendations have not been updated.



---

archive/issue_comments_425287.json:
```json
{
    "body": "PEP8 sets guidelines, but code readability is the most important thing. Each of those changes makes it harder to read the code.",
    "created_at": "2020-08-08T11:58:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425287",
    "user": "tscrim"
}
```

PEP8 sets guidelines, but code readability is the most important thing. Each of those changes makes it harder to read the code.



---

archive/issue_comments_425288.json:
```json
{
    "body": "Replying to [comment:25 tscrim]:\n> PEP8 sets guidelines, but code readability is the most important thing. Each of those changes makes it harder to read the code.\n\nFair enough, I'll change it back. Thanks.",
    "created_at": "2020-08-08T12:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425288",
    "user": "@mjungmath"
}
```

Replying to [comment:25 tscrim]:
> PEP8 sets guidelines, but code readability is the most important thing. Each of those changes makes it harder to read the code.

Fair enough, I'll change it back. Thanks.



---

archive/issue_comments_425289.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-08T12:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425289",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425290.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-08T12:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425290",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425291.json:
```json
{
    "body": "Like this?",
    "created_at": "2020-08-08T12:45:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425291",
    "user": "@mjungmath"
}
```

Like this?



---

archive/issue_comments_425292.json:
```json
{
    "body": "Yes, except I think you are better off leaving this alone:\n\n```\nfrom sage.manifolds.differentiable.vector_bundle import TensorBundle\n```\n\n(i.e., on one line).",
    "created_at": "2020-08-08T12:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425292",
    "user": "tscrim"
}
```

Yes, except I think you are better off leaving this alone:

```
from sage.manifolds.differentiable.vector_bundle import TensorBundle
```

(i.e., on one line).



---

archive/issue_comments_425293.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-08T13:01:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425293",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425294.json:
```json
{
    "body": "Satisfied? :)",
    "created_at": "2020-08-08T13:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425294",
    "user": "@mjungmath"
}
```

Satisfied? :)



---

archive/issue_comments_425295.json:
```json
{
    "body": "Patchbot is green.",
    "created_at": "2020-08-08T15:57:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425295",
    "user": "@mjungmath"
}
```

Patchbot is green.



---

archive/issue_comments_425296.json:
```json
{
    "body": "Yes, thank you. However, I do have a few other comments from another read-over. However, these should be the last of them.\n\nThe `keys()` call here\n\n```\nfor frame in base_space._get_min_covering(connection._coefficients.keys()):\n```\n\nseem like it is not needed.\n\n\n```diff\n         INPUT:\n \n-        - an orientation; either a chart / list of charts, or a vector frame /\n+        - ``orientation`` -- either a chart / list of charts, or a vector frame /\n           list of vector frames, covering ``self``\n```\n\nand similar.\n\nThis\n\n```\n        .. NOTE::\n\n            This assumes that the manifold admits an orientation, see\n            :meth:`~sage.manifolds.manifold.DifferentiableManifold.orientation`\n            for details.\n```\n\nin `volume_form()` (in `differentiable/metric.py`) is wrong. An error is raised if the manifold does not admit an orientation. Subsequently in `hodge_star` as well.\n\nIn `set_orientation` is it the default orientation or simply the orientation? I don't think you allow multiple orientations on a manifold. Is that a planned future feature?\n\n`# set a priori no orientation` -> `# default is no orientation` (or `# set no orientation a priori`)\n\n\n```diff\n-        if self.orientation():\n-            return True\n-        return False\n+        return bool(self.orientation())\n```\n",
    "created_at": "2020-08-08T23:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425296",
    "user": "tscrim"
}
```

Yes, thank you. However, I do have a few other comments from another read-over. However, these should be the last of them.

The `keys()` call here

```
for frame in base_space._get_min_covering(connection._coefficients.keys()):
```

seem like it is not needed.


```diff
         INPUT:
 
-        - an orientation; either a chart / list of charts, or a vector frame /
+        - ``orientation`` -- either a chart / list of charts, or a vector frame /
           list of vector frames, covering ``self``
```

and similar.

This

```
        .. NOTE::

            This assumes that the manifold admits an orientation, see
            :meth:`~sage.manifolds.manifold.DifferentiableManifold.orientation`
            for details.
```

in `volume_form()` (in `differentiable/metric.py`) is wrong. An error is raised if the manifold does not admit an orientation. Subsequently in `hodge_star` as well.

In `set_orientation` is it the default orientation or simply the orientation? I don't think you allow multiple orientations on a manifold. Is that a planned future feature?

`# set a priori no orientation` -> `# default is no orientation` (or `# set no orientation a priori`)


```diff
-        if self.orientation():
-            return True
-        return False
+        return bool(self.orientation())
```




---

archive/issue_comments_425297.json:
```json
{
    "body": "Replying to [comment:34 tscrim]:\n> Yes, thank you. However, I do have a few other comments from another read-over. However, these should be the last of them.\n> \n> The `keys()` call here\n> {{{\n> for frame in base_space._get_min_covering(connection._coefficients.keys()):\n> }}}\n> seem like it is not needed.\n\nAh yes. Thank you. \n\n> \n> {{{#!diff\n>          INPUT:\n>  \n> -        - an orientation; either a chart / list of charts, or a vector frame /\n> +        - ``orientation`` -- either a chart / list of charts, or a vector frame /\n>            list of vector frames, covering ``self``\n> }}}\n> and similar.\n\nGood. Thanks.\n\n> \n> This\n> {{{\n>         .. NOTE::\n> \n>             This assumes that the manifold admits an orientation, see\n>             :meth:`~sage.manifolds.manifold.DifferentiableManifold.orientation`\n>             for details.\n> }}}\n> in `volume_form()` (in `differentiable/metric.py`) is wrong. An error is raised if the manifold does not admit an orientation. Subsequently in `hodge_star` as well.\n\nYou mean wrong in the sense that we should note that having no orientation means this feature is not available? \n\n> \n> In `set_orientation` is it the default orientation or simply the orientation? I don't think you allow multiple orientations on a manifold. Is that a planned future feature?\n\nI cannot think of a case where a manifold has *the* orientation. Allowing multiple orientations means also allowing multiple volume forms. But which one then to choose for `hodge_star`? I think it is reasonable to fix just one orientation. \n\n>\n> `# set a priori no orientation` -> `# default is no orientation` (or `# set no orientation a priori`)\n> \n> {{{#!diff\n> -        if self.orientation():\n> -            return True\n> -        return False\n> +        return bool(self.orientation())\n> }}}\n\nGood. Already done.",
    "created_at": "2020-08-09T05:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425297",
    "user": "@mjungmath"
}
```

Replying to [comment:34 tscrim]:
> Yes, thank you. However, I do have a few other comments from another read-over. However, these should be the last of them.
> 
> The `keys()` call here
> {{{
> for frame in base_space._get_min_covering(connection._coefficients.keys()):
> }}}
> seem like it is not needed.

Ah yes. Thank you. 

> 
> {{{#!diff
>          INPUT:
>  
> -        - an orientation; either a chart / list of charts, or a vector frame /
> +        - ``orientation`` -- either a chart / list of charts, or a vector frame /
>            list of vector frames, covering ``self``
> }}}
> and similar.

Good. Thanks.

> 
> This
> {{{
>         .. NOTE::
> 
>             This assumes that the manifold admits an orientation, see
>             :meth:`~sage.manifolds.manifold.DifferentiableManifold.orientation`
>             for details.
> }}}
> in `volume_form()` (in `differentiable/metric.py`) is wrong. An error is raised if the manifold does not admit an orientation. Subsequently in `hodge_star` as well.

You mean wrong in the sense that we should note that having no orientation means this feature is not available? 

> 
> In `set_orientation` is it the default orientation or simply the orientation? I don't think you allow multiple orientations on a manifold. Is that a planned future feature?

I cannot think of a case where a manifold has *the* orientation. Allowing multiple orientations means also allowing multiple volume forms. But which one then to choose for `hodge_star`? I think it is reasonable to fix just one orientation. 

>
> `# set a priori no orientation` -> `# default is no orientation` (or `# set no orientation a priori`)
> 
> {{{#!diff
> -        if self.orientation():
> -            return True
> -        return False
> +        return bool(self.orientation())
> }}}

Good. Already done.



---

archive/issue_comments_425298.json:
```json
{
    "body": "Replying to [comment:35 gh-mjungmath]:\n> Replying to [comment:34 tscrim]:\n> > \n> > This\n> > {{{\n> >         .. NOTE::\n> > \n> >             This assumes that the manifold admits an orientation, see\n> >             :meth:`~sage.manifolds.manifold.DifferentiableManifold.orientation`\n> >             for details.\n> > }}}\n> > in `volume_form()` (in `differentiable/metric.py`) is wrong. An error is raised if the manifold does not admit an orientation. Subsequently in `hodge_star` as well.\n> \n> You mean wrong in the sense that we should note that having no orientation means this feature is not available? \n\nNo, as in there is not an assumption being made. If it has not been defined, an error is raised rather than assuming that the manifold admits an orientation (and using that implicit orientation).\n\n> > In `set_orientation` is it the default orientation or simply the orientation? I don't think you allow multiple orientations on a manifold. Is that a planned future feature?\n> \n> I cannot think of a case where a manifold has *the* orientation. Allowing multiple orientations means also allowing multiple volume forms. But which one then to choose for `hodge_star`? I think it is reasonable to fix just one orientation. \n\nI know there are multiple orientations possible for a manifold, but there is a set orientation for the manifold. There is not a default one where a user can arbitrarily choose another as an input. Contrast this with charts. I would think of this like a manifold with a distinguished orientation (which can be changed later on, but the manifold has still indicated the one orientation to rule them all).",
    "created_at": "2020-08-09T05:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425298",
    "user": "tscrim"
}
```

Replying to [comment:35 gh-mjungmath]:
> Replying to [comment:34 tscrim]:
> > 
> > This
> > {{{
> >         .. NOTE::
> > 
> >             This assumes that the manifold admits an orientation, see
> >             :meth:`~sage.manifolds.manifold.DifferentiableManifold.orientation`
> >             for details.
> > }}}
> > in `volume_form()` (in `differentiable/metric.py`) is wrong. An error is raised if the manifold does not admit an orientation. Subsequently in `hodge_star` as well.
> 
> You mean wrong in the sense that we should note that having no orientation means this feature is not available? 

No, as in there is not an assumption being made. If it has not been defined, an error is raised rather than assuming that the manifold admits an orientation (and using that implicit orientation).

> > In `set_orientation` is it the default orientation or simply the orientation? I don't think you allow multiple orientations on a manifold. Is that a planned future feature?
> 
> I cannot think of a case where a manifold has *the* orientation. Allowing multiple orientations means also allowing multiple volume forms. But which one then to choose for `hodge_star`? I think it is reasonable to fix just one orientation. 

I know there are multiple orientations possible for a manifold, but there is a set orientation for the manifold. There is not a default one where a user can arbitrarily choose another as an input. Contrast this with charts. I would think of this like a manifold with a distinguished orientation (which can be changed later on, but the manifold has still indicated the one orientation to rule them all).



---

archive/issue_comments_425299.json:
```json
{
    "body": "Okay, I will call it \"preferred\" orientation instead. It would be good if, in the trivial case, the default chart/frame is used. While applying this, I discovered a bug (see #30320).",
    "created_at": "2020-08-09T10:44:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425299",
    "user": "@mjungmath"
}
```

Okay, I will call it "preferred" orientation instead. It would be good if, in the trivial case, the default chart/frame is used. While applying this, I discovered a bug (see #30320).



---

archive/issue_comments_425300.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-09T12:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425300",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425301.json:
```json
{
    "body": "See my new push. This approach is independent of #30320.",
    "created_at": "2020-08-09T12:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425301",
    "user": "@mjungmath"
}
```

See my new push. This approach is independent of #30320.



---

archive/issue_comments_425302.json:
```json
{
    "body": "Just to be clear, as long as you raise an error when there is no orientation, you need to remove that `.. NOTE::` because it is wrong. No assumption is made as an explicit check is performed.",
    "created_at": "2020-08-09T23:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425302",
    "user": "tscrim"
}
```

Just to be clear, as long as you raise an error when there is no orientation, you need to remove that `.. NOTE::` because it is wrong. No assumption is made as an explicit check is performed.



---

archive/issue_comments_425303.json:
```json
{
    "body": "Replying to [comment:40 tscrim]:\n> Just to be clear, as long as you raise an error when there is no orientation, you need to remove that `.. NOTE::` because it is wrong. No assumption is made as an explicit check is performed.\n\nAh, it's just about the note block. I'll remove it.",
    "created_at": "2020-08-10T07:18:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425303",
    "user": "@mjungmath"
}
```

Replying to [comment:40 tscrim]:
> Just to be clear, as long as you raise an error when there is no orientation, you need to remove that `.. NOTE::` because it is wrong. No assumption is made as an explicit check is performed.

Ah, it's just about the note block. I'll remove it.



---

archive/issue_comments_425304.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-10T07:59:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425304",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425305.json:
```json
{
    "body": "Is this better? If not, could you please suggest an improvement, because then I don't know what you mean.",
    "created_at": "2020-08-10T08:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425305",
    "user": "@mjungmath"
}
```

Is this better? If not, could you please suggest an improvement, because then I don't know what you mean.



---

archive/issue_comments_425306.json:
```json
{
    "body": "That is perfect, thank you.",
    "created_at": "2020-08-10T08:15:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425306",
    "user": "tscrim"
}
```

That is perfect, thank you.



---

archive/issue_comments_425307.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-10T08:15:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425307",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_425308.json:
```json
{
    "body": "Okay good. Thank you for the review and your patience. :)",
    "created_at": "2020-08-10T08:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425308",
    "user": "@mjungmath"
}
```

Okay good. Thank you for the review and your patience. :)



---

archive/issue_comments_425309.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2020-08-10T22:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425309",
    "user": "vbraun"
}
```

Merge conflict



---

archive/issue_comments_425310.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-08-10T22:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425310",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_425311.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-10T22:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425311",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425312.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-08-10T23:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425312",
    "user": "@mjungmath"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_425313.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-10T23:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425313",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_425314.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-14T22:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425314",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_425315.json:
```json
{
    "body": "See #30519 for a follow up.",
    "created_at": "2020-09-06T20:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29941",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29941#issuecomment-425315",
    "user": "egourgoulhon"
}
```

See #30519 for a follow up.
