# Issue 32210: "SignalError: Illegal instruction" on calling .right_kernel()

archive/issues_032210.json:
```json
{
    "body": "I have a particular matrix on which computing .right_kernel() by Sage 9.4 results in \"SignalError: Illegal instruction\". Sage 9.4 is installed from sage-9.4-Ubuntu_20.04-x86_64.tar.bz2\n\nI see the same problem in Sage 9.3, but not in Sage 9.2. The screenlog from Sage 9.4 is quoted below. The file bug_illegal_kernel.sage and the output of lscpu are attached.\n\n### sage: load(\"bug_illegal_kernel.sage\")                                                                                                                                                                                                                                                                                        \n---------------------------------------------------------------------------\nSignalError                               Traceback (most recent call last)\n<ipython-input-1-5e05d00e2706> in <module>\n----> 1 load(\"bug_illegal_kernel.sage\")\n\n/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/misc/persist.pyx in sage.misc.persist.load (build/cythonized/sage/misc/persist.c:2563)()\n    171 \n    172     if sage.repl.load.is_loadable_filename(filename):\n--> 173         sage.repl.load.load(filename, globals())\n    174         return\n    175 \n\n/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/repl/load.py in load(filename, globals, attach)\n    270                 add_attached_file(fpath)\n    271             with open(fpath) as f:\n--> 272                 exec(preparse_file(f.read()) + \"\\n\", globals)\n    273     elif ext == '.spyx' or ext == '.pyx':\n    274         if attach:\n\n<string> in <module>\n\n/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:31019)()\n   4715 \n   4716         # Go get the kernel matrix, this is where it all happens\n-> 4717         M = self.right_kernel_matrix(*args, **kwds)\n   4718 \n   4719         ambient = R**self.ncols()\n\n/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:29656)()\n   4316         if M is None:\n   4317             try:\n-> 4318                 format, M = self._right_kernel_matrix(algorithm=algorithm, proof=proof)\n   4319             except AttributeError:\n   4320                 pass\n\n/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/matrix/matrix_integer_dense.pyx in sage.matrix.matrix_integer_dense.Matrix_integer_dense._right_kernel_matrix (build/cythonized/sage/matrix/matrix_integer_dense.cpp:22522)()\n   2694             proof = kwds.pop('proof', None)\n   2695             proof = get_proof_flag(proof, \"linear_algebra\")\n-> 2696             K = self._rational_kernel_iml().transpose().saturation(proof=proof)\n   2697             format = 'computed-iml-int'\n   2698         else:\n\n/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/matrix/matrix_integer_dense.pyx in sage.matrix.matrix_integer_dense.Matrix_integer_dense._rational_kernel_iml (build/cythonized/sage/matrix/matrix_integer_dense.cpp:32421)()\n   3882         time = verbose('computing null space of %s x %s matrix using IML'%(self._nrows, self._ncols))\n   3883         cdef mpz_t * m = fmpz_mat_to_mpz_array(self._matrix)\n-> 3884         sig_on()\n   3885         dim = nullspaceMP(self._nrows, self._ncols, m, &mp_N)\n   3886         sig_off()\n\nSignalError: Illegal instruction\n===\n\nIssue created by migration from https://trac.sagemath.org/ticket/32447\n\n",
    "created_at": "2021-09-01T14:42:56Z",
    "labels": [
        "linear algebra",
        "major",
        "bug"
    ],
    "title": "\"SignalError: Illegal instruction\" on calling .right_kernel()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32210",
    "user": "@maxale"
}
```
I have a particular matrix on which computing .right_kernel() by Sage 9.4 results in "SignalError: Illegal instruction". Sage 9.4 is installed from sage-9.4-Ubuntu_20.04-x86_64.tar.bz2

I see the same problem in Sage 9.3, but not in Sage 9.2. The screenlog from Sage 9.4 is quoted below. The file bug_illegal_kernel.sage and the output of lscpu are attached.

### sage: load("bug_illegal_kernel.sage")                                                                                                                                                                                                                                                                                        
---------------------------------------------------------------------------
SignalError                               Traceback (most recent call last)
<ipython-input-1-5e05d00e2706> in <module>
----> 1 load("bug_illegal_kernel.sage")

/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/misc/persist.pyx in sage.misc.persist.load (build/cythonized/sage/misc/persist.c:2563)()
    171 
    172     if sage.repl.load.is_loadable_filename(filename):
--> 173         sage.repl.load.load(filename, globals())
    174         return
    175 

/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/repl/load.py in load(filename, globals, attach)
    270                 add_attached_file(fpath)
    271             with open(fpath) as f:
--> 272                 exec(preparse_file(f.read()) + "\n", globals)
    273     elif ext == '.spyx' or ext == '.pyx':
    274         if attach:

<string> in <module>

/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:31019)()
   4715 
   4716         # Go get the kernel matrix, this is where it all happens
-> 4717         M = self.right_kernel_matrix(*args, **kwds)
   4718 
   4719         ambient = R**self.ncols()

/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:29656)()
   4316         if M is None:
   4317             try:
-> 4318                 format, M = self._right_kernel_matrix(algorithm=algorithm, proof=proof)
   4319             except AttributeError:
   4320                 pass

/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/matrix/matrix_integer_dense.pyx in sage.matrix.matrix_integer_dense.Matrix_integer_dense._right_kernel_matrix (build/cythonized/sage/matrix/matrix_integer_dense.cpp:22522)()
   2694             proof = kwds.pop('proof', None)
   2695             proof = get_proof_flag(proof, "linear_algebra")
-> 2696             K = self._rational_kernel_iml().transpose().saturation(proof=proof)
   2697             format = 'computed-iml-int'
   2698         else:

/usr/local/SageMath.94/local/lib/python3.9/site-packages/sage/matrix/matrix_integer_dense.pyx in sage.matrix.matrix_integer_dense.Matrix_integer_dense._rational_kernel_iml (build/cythonized/sage/matrix/matrix_integer_dense.cpp:32421)()
   3882         time = verbose('computing null space of %s x %s matrix using IML'%(self._nrows, self._ncols))
   3883         cdef mpz_t * m = fmpz_mat_to_mpz_array(self._matrix)
-> 3884         sig_on()
   3885         dim = nullspaceMP(self._nrows, self._ncols, m, &mp_N)
   3886         sig_off()

SignalError: Illegal instruction
===

Issue created by migration from https://trac.sagemath.org/ticket/32447





---

archive/issue_comments_460208.json:
```json
{
    "body": "Sage code resulting in an error",
    "created_at": "2021-09-01T14:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32210#issuecomment-460208",
    "user": "@maxale"
}
```

Sage code resulting in an error



---

archive/issue_comments_460209.json:
```json
{
    "body": "Attachment [lscpu.log](tarball://root/attachments/some-uuid/ticket32447/lscpu.log) by @maxale created at 2021-09-01 14:46:03\n\noutput of lscpu",
    "created_at": "2021-09-01T14:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32210#issuecomment-460209",
    "user": "@maxale"
}
```

Attachment [lscpu.log](tarball://root/attachments/some-uuid/ticket32447/lscpu.log) by @maxale created at 2021-09-01 14:46:03

output of lscpu



---

archive/issue_comments_460210.json:
```json
{
    "body": "probably dup of #32424",
    "created_at": "2021-09-01T20:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32210#issuecomment-460210",
    "user": "mkoeppe"
}
```

probably dup of #32424



---

archive/issue_comments_460211.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-01T20:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32210#issuecomment-460211",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_460212.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-10T12:56:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32210#issuecomment-460212",
    "user": "mjo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_460213.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-09-10T17:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32210#issuecomment-460213",
    "user": "mkoeppe"
}
```

Resolution: invalid
