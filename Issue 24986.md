# Issue 24986: Cleaning of the usage of BFS

archive/issues_024986.json:
```json
{
    "body": "CC:  @dcoudert\n\nKeywords: BFS Cleaning\n\nShifting of `simple_BFS` function from `distances_all_pairs.pyx` to `static_sparse_backend`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25223\n\n",
    "created_at": "2018-04-21T22:11:44Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "Cleaning of the usage of BFS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24986",
    "user": "saiharsh"
}
```
CC:  @dcoudert

Keywords: BFS Cleaning

Shifting of `simple_BFS` function from `distances_all_pairs.pyx` to `static_sparse_backend`.

Issue created by migration from https://trac.sagemath.org/ticket/25223





---

archive/issue_comments_351629.json:
```json
{
    "body": "With reference to #25123 ticket, this ticket is created.\n\nI have changed the location of the simple_bfs function, make all command is successfully executed, please let me know if any modifications are needed.",
    "created_at": "2018-04-22T14:37:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351629",
    "user": "saiharsh"
}
```

With reference to #25123 ticket, this ticket is created.

I have changed the location of the simple_bfs function, make all command is successfully executed, please let me know if any modifications are needed.



---

archive/issue_comments_351630.json:
```json
{
    "body": "Instead of `uint32_t n, uint32_t ** p_vertices`, could you try to pass `short_digraph g, ` instead. \nThen, inside the method, you can add shortcuts to `n` and `p_vertices`.\n\nIt's not a trivial change, since you will certainly have to report it inside `distances_all_pairs.pyx`, but in the end it will be a better code, and consistent with other methods. Thanks.",
    "created_at": "2018-04-23T16:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351630",
    "user": "@dcoudert"
}
```

Instead of `uint32_t n, uint32_t ** p_vertices`, could you try to pass `short_digraph g, ` instead. 
Then, inside the method, you can add shortcuts to `n` and `p_vertices`.

It's not a trivial change, since you will certainly have to report it inside `distances_all_pairs.pyx`, but in the end it will be a better code, and consistent with other methods. Thanks.



---

archive/issue_comments_351631.json:
```json
{
    "body": "Thanks for giving feedback. \\\\\nReplying to [comment:2 dcoudert]:\n> Instead of `uint32_t n, uint32_t ** p_vertices`, could you try to pass `short_digraph g, ` instead. \n> Then, inside the method, you can add shortcuts to `n` and `p_vertices`.\nSure I will try to add it.\n> \n> It's not a trivial change, since you will certainly have to report it inside `distances_all_pairs.pyx`, but in the end it will be a better code, and consistent with other methods. Thanks.\nSure I will write a comment in distances_all_pairs.pyx code that `Simple_BFS` is shifted.\n\nI have my final exam on 26th April after that I will be more active. \\\\\nUpdate you as soon as possible.",
    "created_at": "2018-04-23T21:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351631",
    "user": "saiharsh"
}
```

Thanks for giving feedback. \\
Replying to [comment:2 dcoudert]:
> Instead of `uint32_t n, uint32_t ** p_vertices`, could you try to pass `short_digraph g, ` instead. 
> Then, inside the method, you can add shortcuts to `n` and `p_vertices`.
Sure I will try to add it.
> 
> It's not a trivial change, since you will certainly have to report it inside `distances_all_pairs.pyx`, but in the end it will be a better code, and consistent with other methods. Thanks.
Sure I will write a comment in distances_all_pairs.pyx code that `Simple_BFS` is shifted.

I have my final exam on 26th April after that I will be more active. \\
Update you as soon as possible.



---

archive/issue_comments_351632.json:
```json
{
    "body": "Replying to [comment:2 dcoudert]:\n> Instead of `uint32_t n, uint32_t ** p_vertices`, could you try to pass `short_digraph g, ` instead. \n> Then, inside the method, you can add shortcuts to `n` and `p_vertices`.\n\nI have updated the `Simple_BFS`, now it will take `short_digraph g` instead of `n` and `p_vertices` but it's leading to change the definitions of \\\\ \n1. `c_eccentricity_bounding` \\\\ \n2. `diameter_lower_bound_2sweep` \\\\\n3. `diameter_iFUB` \\\\ \n\nIn which `c_eccentricity_bounding` create `short_digraph g` of `G` so no problem with it but `diameter_lower_bound_2sweep` and `diameter_iFUB` functions take input in terms of `n` and `p_vertices`.\n\nSo what do you suggest me to do? go ahead and do necessary changes(may `diameter_lower_bound_2sweep` and `diameter_iFUB` will have future dependencies)?",
    "created_at": "2018-04-28T16:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351632",
    "user": "saiharsh"
}
```

Replying to [comment:2 dcoudert]:
> Instead of `uint32_t n, uint32_t ** p_vertices`, could you try to pass `short_digraph g, ` instead. 
> Then, inside the method, you can add shortcuts to `n` and `p_vertices`.

I have updated the `Simple_BFS`, now it will take `short_digraph g` instead of `n` and `p_vertices` but it's leading to change the definitions of \\ 
1. `c_eccentricity_bounding` \\ 
2. `diameter_lower_bound_2sweep` \\
3. `diameter_iFUB` \\ 

In which `c_eccentricity_bounding` create `short_digraph g` of `G` so no problem with it but `diameter_lower_bound_2sweep` and `diameter_iFUB` functions take input in terms of `n` and `p_vertices`.

So what do you suggest me to do? go ahead and do necessary changes(may `diameter_lower_bound_2sweep` and `diameter_iFUB` will have future dependencies)?



---

archive/issue_comments_351633.json:
```json
{
    "body": "Yes, go ahead and do necessary changes. You will have to change the calls in method `diameter` as well and it should be enough.",
    "created_at": "2018-04-28T17:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351633",
    "user": "@dcoudert"
}
```

Yes, go ahead and do necessary changes. You will have to change the calls in method `diameter` as well and it should be enough.



---

archive/issue_comments_351634.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-28T19:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351634",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_351635.json:
```json
{
    "body": "Replying to [comment:6 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[1ad2c57](https://git.sagemath.org/sage.git/commit/?id=1ad2c57104a9ea2e1bec424b59ad82462f1ca422)||`Completed necessary changes and comments updated only for Simple_BFS function.`||\n\nCompleted necessary changes and able to generate executable file i.e `sage`.\nComments are updated only in `Simple_BFS` function. \\\\\n`diameter_lower_bound_multi_sweep` defination is also changed.\n\nLet me know anymore changes required and is comment `g (short_digraph) -- The input graph.` is enough? if yes than shall I update same for remaining functions?",
    "created_at": "2018-04-28T19:54:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351635",
    "user": "saiharsh"
}
```

Replying to [comment:6 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[1ad2c57](https://git.sagemath.org/sage.git/commit/?id=1ad2c57104a9ea2e1bec424b59ad82462f1ca422)||`Completed necessary changes and comments updated only for Simple_BFS function.`||

Completed necessary changes and able to generate executable file i.e `sage`.
Comments are updated only in `Simple_BFS` function. \\
`diameter_lower_bound_multi_sweep` defination is also changed.

Let me know anymore changes required and is comment `g (short_digraph) -- The input graph.` is enough? if yes than shall I update same for remaining functions?



---

archive/issue_comments_351636.json:
```json
{
    "body": "This formulation might be better: `- ``g`` -- a short_digraph, as documented in the module sage.graphs.base.static_sparse_graph.`\n\n- `n=g.n` -> `n = g.n`. Adding spaces is good for the readability.",
    "created_at": "2018-04-29T07:30:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351636",
    "user": "@dcoudert"
}
```

This formulation might be better: `- ``g`` -- a short_digraph, as documented in the module sage.graphs.base.static_sparse_graph.`

- `n=g.n` -> `n = g.n`. Adding spaces is good for the readability.



---

archive/issue_comments_351637.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-29T09:23:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351637",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_351638.json:
```json
{
    "body": "Replying to [comment:9 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[7230d97](https://git.sagemath.org/sage.git/commit/?id=7230d974b7f81045daa90c80a404fe6f68e48008)||`Comments updated.`||\n\nComments and spaces are added. \\\\\nPlease have a look.",
    "created_at": "2018-04-29T09:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351638",
    "user": "saiharsh"
}
```

Replying to [comment:9 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[7230d97](https://git.sagemath.org/sage.git/commit/?id=7230d974b7f81045daa90c80a404fe6f68e48008)||`Comments updated.`||

Comments and spaces are added. \\
Please have a look.



---

archive/issue_comments_351639.json:
```json
{
    "body": "If you think the code is ready for review, please change the status to `needs review`.",
    "created_at": "2018-04-30T07:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351639",
    "user": "@dcoudert"
}
```

If you think the code is ready for review, please change the status to `needs review`.



---

archive/issue_comments_351640.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-30T11:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351640",
    "user": "saiharsh"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_351641.json:
```json
{
    "body": "Replying to [comment:11 dcoudert]:\n> If you think the code is ready for review, please change the status to `needs review`.\nShall I add `@`dimpase for review? \\\\\nShall I resume the work of #25123 concentrating on the undirected graph version?",
    "created_at": "2018-04-30T16:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351641",
    "user": "saiharsh"
}
```

Replying to [comment:11 dcoudert]:
> If you think the code is ready for review, please change the status to `needs review`.
Shall I add `@`dimpase for review? \\
Shall I resume the work of #25123 concentrating on the undirected graph version?



---

archive/issue_comments_351642.json:
```json
{
    "body": "Replying to [comment:13 saiharsh]:\n> Replying to [comment:11 dcoudert]:\n> > If you think the code is ready for review, please change the status to `needs review`.\n> Shall I add `@`dimpase for review? \\\\\nno need.\n\n> Shall I resume the work of #25123 concentrating on the undirected graph version?\n\nYes, you must 1) rebase it on top of this ticket, 2) perform necessary changes, 3) don't forget to add the dependency in the ticket description.\n\nI will review this ticket asap (it's a long week end in France).",
    "created_at": "2018-04-30T17:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351642",
    "user": "@dcoudert"
}
```

Replying to [comment:13 saiharsh]:
> Replying to [comment:11 dcoudert]:
> > If you think the code is ready for review, please change the status to `needs review`.
> Shall I add `@`dimpase for review? \\
no need.

> Shall I resume the work of #25123 concentrating on the undirected graph version?

Yes, you must 1) rebase it on top of this ticket, 2) perform necessary changes, 3) don't forget to add the dependency in the ticket description.

I will review this ticket asap (it's a long week end in France).



---

archive/issue_comments_351643.json:
```json
{
    "body": "> Yes, you must 1) rebase it on top of this ticket, 2) perform necessary changes, 3) don't forget to add the dependency in the ticket description.\n> \nI will work on it and let you know asap.\n\n> I will review this ticket asap (it's a long weekend in France).\nSorry for disturbing you during the weekend time, please take your own time.",
    "created_at": "2018-04-30T17:28:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351643",
    "user": "saiharsh"
}
```

> Yes, you must 1) rebase it on top of this ticket, 2) perform necessary changes, 3) don't forget to add the dependency in the ticket description.
> 
I will work on it and let you know asap.

> I will review this ticket asap (it's a long weekend in France).
Sorry for disturbing you during the weekend time, please take your own time.



---

archive/issue_comments_351644.json:
```json
{
    "body": "You should fill the `Authors` field of the ticket with your full name.",
    "created_at": "2018-05-01T12:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351644",
    "user": "@videlec"
}
```

You should fill the `Authors` field of the ticket with your full name.



---

archive/issue_comments_351645.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-05-01T12:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351645",
    "user": "@videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_351646.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-05-01T13:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351646",
    "user": "@dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_351647.json:
```json
{
    "body": "Apparently we should not declare inline method inside a .pxd file.\n\n```\n[1/3] Cythonizing sage/graphs/base/static_sparse_backend.pyx\nwarning: sage/graphs/base/static_sparse_backend.pxd:21:31: Declarations should not be declared inline.\n...\n```\n\nSo could you remove `inline` in .pxd and may be .pyx file as well.",
    "created_at": "2018-05-04T22:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351647",
    "user": "@dcoudert"
}
```

Apparently we should not declare inline method inside a .pxd file.

```
[1/3] Cythonizing sage/graphs/base/static_sparse_backend.pyx
warning: sage/graphs/base/static_sparse_backend.pxd:21:31: Declarations should not be declared inline.
...
```

So could you remove `inline` in .pxd and may be .pyx file as well.



---

archive/issue_comments_351648.json:
```json
{
    "body": "Replying to [comment:19 dcoudert]:\n> Apparently we should not declare inline method inside a .pxd file.\n> {{{\n> [1/3] Cythonizing sage/graphs/base/static_sparse_backend.pyx\n> warning: sage/graphs/base/static_sparse_backend.pxd:21:31: Declarations should not be declared inline.\n> ...\n> }}}\n> So could you remove `inline` in .pxd and may be .pyx file as well.\n\nMore precisely, it makes no sense to *declare* an inline function. You have two choices for using inline\n\n- *define* it in a pxd, so that they are available from other Cython modules with standard cimport\n- *define* it in a pyx, in which case it is only internal to the file\n\nBoth situations are in use in Sage.",
    "created_at": "2018-05-05T11:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351648",
    "user": "@videlec"
}
```

Replying to [comment:19 dcoudert]:
> Apparently we should not declare inline method inside a .pxd file.
> {{{
> [1/3] Cythonizing sage/graphs/base/static_sparse_backend.pyx
> warning: sage/graphs/base/static_sparse_backend.pxd:21:31: Declarations should not be declared inline.
> ...
> }}}
> So could you remove `inline` in .pxd and may be .pyx file as well.

More precisely, it makes no sense to *declare* an inline function. You have two choices for using inline

- *define* it in a pxd, so that they are available from other Cython modules with standard cimport
- *define* it in a pyx, in which case it is only internal to the file

Both situations are in use in Sage.



---

archive/issue_comments_351649.json:
```json
{
    "body": "Thank you for the clarification.\n\nSo here we should just remove inline in .pxd and .pyx for this method.",
    "created_at": "2018-05-05T11:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351649",
    "user": "@dcoudert"
}
```

Thank you for the clarification.

So here we should just remove inline in .pxd and .pyx for this method.



---

archive/issue_comments_351650.json:
```json
{
    "body": "`@`vdelecroix thanks for the clarification.\nI have removed `inline` from .pxd and .pyx",
    "created_at": "2018-05-05T12:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351650",
    "user": "saiharsh"
}
```

`@`vdelecroix thanks for the clarification.
I have removed `inline` from .pxd and .pyx



---

archive/issue_comments_351651.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-05T12:39:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351651",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_351652.json:
```json
{
    "body": "Thanks. For me this patch is now good to go.",
    "created_at": "2018-05-05T12:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351652",
    "user": "@dcoudert"
}
```

Thanks. For me this patch is now good to go.



---

archive/issue_comments_351653.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-05T12:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351653",
    "user": "@dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_351654.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-05-14T17:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24986#issuecomment-351654",
    "user": "@vbraun"
}
```

Resolution: fixed
