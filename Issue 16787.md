# Issue 16787: Bring back the p-adic gamma function

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2014-09-22 11:08:15

CC:  asalerno chapoton




---

Comment by vbraun created at 2014-09-22 11:10:04

Changing type from PLEASE CHANGE to defect.


---

Comment by vbraun created at 2014-09-22 11:10:04

Changing component from PLEASE CHANGE to basic arithmetic.


---

Comment by vbraun created at 2014-09-22 11:41:27

New commits:


---

Comment by vbraun created at 2014-09-22 11:42:31

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2014-09-23 06:29:47

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2014-09-23 06:29:47

The keyword for choosing the algorithm should be called `algorithm`, not `flag`.


---

Comment by jdemeyer created at 2014-09-23 08:00:01

When using the PARI algorithm, the answer should be converted back to the correct Sage parent.


---

Comment by git created at 2014-09-23 08:14:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vbraun created at 2014-09-23 08:15:17

Thanks, fixed.


---

Comment by jdemeyer created at 2014-09-23 08:46:22

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2014-09-23 08:46:22

The `"sage"` algorithm doesn't work as well as `"pari"`:

```
sage: Zp(2)(1).gamma("sage")
1 + 2 + 2^2 + 2^3 + 2^4 + 2^5 + 2^6 + 2^7 + 2^8 + 2^9 + 2^10 + 2^11 + 2^12 + 2^13 + 2^14 + 2^15 + 2^16 + 2^17 + 2^18 + O(2^19)
```

(precision only 19 instead of 20)

```
sage: ZpFM(17).random_element().gamma("sage")
...
ValueError: cannot invert non-unit
```

(`"sage"` algorithm doesn't work for `ZpFM`)

But since it's not the default, I'll let it be.


---

Comment by vbraun created at 2014-09-25 12:05:40

Resolution: fixed
