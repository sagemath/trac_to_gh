# Issue 25390: RuntimeError: ECL says: THROW: The catch RAT-ERR is undefined

Issue created by migration from https://trac.sagemath.org/ticket/25627

Original creator: @nasser1

Original creation time: 2018-06-21 11:07:36

Keywords: RuntimeError:

Using `8.3.beta6` on Linux Manjaro

Is this a known issue? Problem with integrate. 



```
    sage: var('x')
    sage: integrate((cos(x) + 2*sin(x) + 1)/(cos(x)^2 - 2*cos(x)*sin(x) + 2*sin(x) + 3),x)

```


gives



```
    RuntimeError                              Traceback (most recent call last)
    <ipython-input-2-f1dceacbaccd> in <module>()
    ----> 1 integrate((cos(x) + Integer(2)*sin(x) + Integer(1))/(cos(x)**Integer(2) - Integer(2)*cos(x)*sin(x) + Integer(2)*sin(x) + Integer(3)),x)
    
     .......    
    RuntimeError: ECL says: THROW: The catch RAT-ERR is undefined.

```


This one also 



```
         integrate(log(x + sqrt(x + 1))/(x^2 + 1),x)

```


gives



```
    RuntimeError                              Traceback (most recent call last)
    <ipython-input-70-f29d0d9e0a0b> in <module>()
    ----> 1 anti=integrate(log(x + sqrt(x + Integer(1)))/(x**Integer(2) + Integer(1)),x)
      ......

```




---

Comment by nbruin created at 2018-06-21 17:30:03

In maxima, the throw/catch RAT-ERR is used because it's a frequently occurring condition that needs to be handled efficiently, and the common-lisp way of handing "conditions" (close to python's exceptions) is slow on some lisps. That's why they set up a RAT-ERR. Since this error should happen a lot anyway, I'm a little surprised that we're finding this here. If we're supposed to be running maxima code inside a "catch" for this, then I expect we would have noticed elsewhere. It's also strange that these integrals in maxima itself do not seem to generate an error of this type. So I suspect this may be more a bug/anomalous in maxima's integrate (bad interaction with other options sage is setting?) than the obvious solution: catch the throw and raise an error.


---

Comment by @DaveWitteMorris created at 2022-02-15 06:14:59

These no longer give an error:

```
sage: integrate((cos(x) + 2*sin(x) + 1)/(cos(x)^2 - 2*cos(x)*sin(x) + 2*sin(x) + 3),x)
Help file /Applications/usr/share/giac/doc/fr/aide_cas not found
Added 0 synonyms
-arctan(-tan(1/2*x)^2 - tan(1/2*x))
sage: integrate((cos(x) + 2*sin(x) + 1)/(cos(x)^2 - 2*cos(x)*sin(x) + 2*sin(x) + 3),x, algorithm="maxima")
integrate((cos(x) + 2*sin(x) + 1)/(cos(x)^2 - 2*cos(x)*sin(x) + 2*sin(x) + 3), x)
sage: integrate(log(x + sqrt(x + 1))/(x^2 + 1),x, algorithm="maxima")
integrate(log(x + sqrt(x + 1))/(x^2 + 1), x)
```

Maxima does not give a good answer for either integral, so I don't think they are worth adding as doctests.


---

Comment by @DaveWitteMorris created at 2022-02-15 06:14:59

Changing keywords from "RuntimeError:" to "RuntimeError, integration, maxima".


---

Comment by @DaveWitteMorris created at 2022-02-15 06:14:59

Changing component from PLEASE CHANGE to calculus.


---

Comment by @DaveWitteMorris created at 2022-02-15 06:14:59

Changing status from new to needs_review.


---

Comment by @mwageringel created at 2022-02-15 20:29:23

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-02-26 18:53:04

Resolution: invalid
