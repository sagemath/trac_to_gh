# Issue 32368: Update polymake to 4.5

Issue created by migration from https://trac.sagemath.org/ticket/32605

Original creator: mkoeppe

Original creation time: 2021-10-01 01:26:42

CC:  @kliem tscrim tmonteil simonking




---

Comment by mkoeppe created at 2021-10-01 02:48:44


```
[polymake-4.5] checking perl module Term::ReadKey ... failed
[polymake-4.5] WARNING: perl module Term::ReadKey required for polymake not found on your machine.
[polymake-4.5]          Please be sure to install it prior to starting to use polymake. 
[}}}


---

Comment by mkoeppe created at 2021-10-01 04:04:50


```
sage -t --random-seed=0 src/sage/interfaces/polymake.py
**********************************************************************
File "src/sage/interfaces/polymake.py", line 2185, in sage.interfaces.polymake.PolymakeExpect._eval_line
Failed example:
    c                                 # optional - polymake
Expected:
    cube of dimension 15
Got:
    <repr(<sage.interfaces.polymake.PolymakeElement at 0x4141d9f80>) failed: sage.interfaces.polymake.PolymakeError: Can't locate object method "description" via package "1" (perhaps you forgot to load "1"?)>
**********************************************************************
File "src/sage/interfaces/polymake.py", line 2187, in sage.interfaces.polymake.PolymakeExpect._eval_line
Failed example:
    c.N_VERTICES                      # optional - polymake
Expected:
    32768
Got:
    Member function 'N_VERTICES' of 1 object
**********************************************************************
```



---

Comment by mkoeppe created at 2021-10-01 04:10:02

New commits:


---

Comment by mkoeppe created at 2021-10-01 04:10:02

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-10-01 04:11:11

Replying to [comment:4 mkoeppe]:
> {{{
> sage -t --random-seed=0 src/sage/interfaces/polymake.py
> **********************************************************************
> File "src/sage/interfaces/polymake.py", line 2187, in sage.interfaces.polymake.PolymakeExpect._eval_line
> Failed example:
>     c.N_VERTICES                      # optional - polymake
> Expected:
>     32768
> Got:
>     Member function 'N_VERTICES' of 1 object
> **********************************************************************
> }}}

This one (with the deprecated pexpect-based interface) we already saw in the previous upgrade ticket, #27745#comment:69


---

Comment by tscrim created at 2021-10-01 04:14:54

If we are having a test failure like that, then we can't upgrade this to an optional. Or is it still marked as `# known bug`?


---

Comment by mkoeppe created at 2021-10-01 04:20:29

Right, we had marked some of the failing or non-robust tests `optional - polymake_expect`.
I'll mark the ones that failed this time in the same way.


---

Comment by git created at 2021-10-01 04:24:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2021-10-01 06:42:30

Okay, that will be good.

The only other thing I am not sure about with making this optional is the perl dependencies. It should be okay, but I feel like we should just double check on sage-devel about this.


---

Comment by git created at 2021-10-01 17:17:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-10-01 17:21:20

I'd say the Perl dependencies are just like other dummy packages that we have that can only be installed using system packages. For example: `pandoc`

I've now merged #31163, which gives better system package info when someone ignores the advice issued by `configure` and attempts to install `perl_cpan_polymake_prereq` (directly or as a dependency of `polymake`).


---

Comment by git created at 2021-10-01 17:23:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2021-10-02 00:28:47

Okay, then let it be so.


---

Comment by tscrim created at 2021-10-02 00:28:47

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-10-02 00:30:50

Thank you!


---

Comment by vbraun created at 2021-10-13 22:50:29

Resolution: fixed


---

Comment by dimpase created at 2021-10-22 09:18:50

On #31527 I found that `jupymake` must be installed if `polymake` is, so dependencies aren't set right here.
