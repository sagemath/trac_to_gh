# Issue 32368: Update polymake to 4.5, change from experimental to optional

archive/issues_032368.json:
```json
{
    "body": "CC:  @kliem @tscrim tmonteil simonking\n\nhttps://polymake.org/doku.php/news/release_4_5 (2021-09-29)\n\nPrevious update: 4.4 (#27745)\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32605\n\n",
    "closed_at": "2021-10-13T22:50:29Z",
    "created_at": "2021-10-01T01:26:42Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Update polymake to 4.5, change from experimental to optional",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32368",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @kliem @tscrim tmonteil simonking

https://polymake.org/doku.php/news/release_4_5 (2021-09-29)

Previous update: 4.4 (#27745)


Issue created by migration from https://trac.sagemath.org/ticket/32605





---

archive/issue_comments_461294.json:
```json
{
    "body": "```\n[polymake-4.5] checking perl module Term::ReadKey ... failed\n[polymake-4.5] WARNING: perl module Term::ReadKey required for polymake not found on your machine.\n[polymake-4.5]          Please be sure to install it prior to starting to use polymake. \n[}}}",
    "created_at": "2021-10-01T02:48:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461294",
    "user": "https://github.com/mkoeppe"
}
```

```
[polymake-4.5] checking perl module Term::ReadKey ... failed
[polymake-4.5] WARNING: perl module Term::ReadKey required for polymake not found on your machine.
[polymake-4.5]          Please be sure to install it prior to starting to use polymake. 
[}}}



---

archive/issue_comments_461295.json:
```json
{
    "body": "```\nsage -t --random-seed=0 src/sage/interfaces/polymake.py\n**********************************************************************\nFile \"src/sage/interfaces/polymake.py\", line 2185, in sage.interfaces.polymake.PolymakeExpect._eval_line\nFailed example:\n    c                                 # optional - polymake\nExpected:\n    cube of dimension 15\nGot:\n    <repr(<sage.interfaces.polymake.PolymakeElement at 0x4141d9f80>) failed: sage.interfaces.polymake.PolymakeError: Can't locate object method \"description\" via package \"1\" (perhaps you forgot to load \"1\"?)>\n**********************************************************************\nFile \"src/sage/interfaces/polymake.py\", line 2187, in sage.interfaces.polymake.PolymakeExpect._eval_line\nFailed example:\n    c.N_VERTICES                      # optional - polymake\nExpected:\n    32768\nGot:\n    Member function 'N_VERTICES' of 1 object\n**********************************************************************\n```",
    "created_at": "2021-10-01T04:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461295",
    "user": "https://github.com/mkoeppe"
}
```

```
sage -t --random-seed=0 src/sage/interfaces/polymake.py
**********************************************************************
File "src/sage/interfaces/polymake.py", line 2185, in sage.interfaces.polymake.PolymakeExpect._eval_line
Failed example:
    c                                 # optional - polymake
Expected:
    cube of dimension 15
Got:
    <repr(<sage.interfaces.polymake.PolymakeElement at 0x4141d9f80>) failed: sage.interfaces.polymake.PolymakeError: Can't locate object method "description" via package "1" (perhaps you forgot to load "1"?)>
**********************************************************************
File "src/sage/interfaces/polymake.py", line 2187, in sage.interfaces.polymake.PolymakeExpect._eval_line
Failed example:
    c.N_VERTICES                      # optional - polymake
Expected:
    32768
Got:
    Member function 'N_VERTICES' of 1 object
**********************************************************************
```



---

archive/issue_comments_461296.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-10-01T04:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461296",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_461297.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-10-01T04:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461297",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_461298.json:
```json
{
    "body": "Replying to [comment:4 mkoeppe]:\n> {{{\n> sage -t --random-seed=0 src/sage/interfaces/polymake.py\n> **********************************************************************\n> File \"src/sage/interfaces/polymake.py\", line 2187, in sage.interfaces.polymake.PolymakeExpect._eval_line\n> Failed example:\n>     c.N_VERTICES                      # optional - polymake\n> Expected:\n>     32768\n> Got:\n>     Member function 'N_VERTICES' of 1 object\n> **********************************************************************\n> }}}\n\n\nThis one (with the deprecated pexpect-based interface) we already saw in the previous upgrade ticket, #27745#comment:69",
    "created_at": "2021-10-01T04:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461298",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:4 mkoeppe]:
> {{{
> sage -t --random-seed=0 src/sage/interfaces/polymake.py
> **********************************************************************
> File "src/sage/interfaces/polymake.py", line 2187, in sage.interfaces.polymake.PolymakeExpect._eval_line
> Failed example:
>     c.N_VERTICES                      # optional - polymake
> Expected:
>     32768
> Got:
>     Member function 'N_VERTICES' of 1 object
> **********************************************************************
> }}}


This one (with the deprecated pexpect-based interface) we already saw in the previous upgrade ticket, #27745#comment:69



---

archive/issue_comments_461299.json:
```json
{
    "body": "If we are having a test failure like that, then we can't upgrade this to an optional. Or is it still marked as `# known bug`?",
    "created_at": "2021-10-01T04:14:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461299",
    "user": "https://github.com/tscrim"
}
```

If we are having a test failure like that, then we can't upgrade this to an optional. Or is it still marked as `# known bug`?



---

archive/issue_comments_461300.json:
```json
{
    "body": "Right, we had marked some of the failing or non-robust tests `optional - polymake_expect`.\nI'll mark the ones that failed this time in the same way.",
    "created_at": "2021-10-01T04:20:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461300",
    "user": "https://github.com/mkoeppe"
}
```

Right, we had marked some of the failing or non-robust tests `optional - polymake_expect`.
I'll mark the ones that failed this time in the same way.



---

archive/issue_comments_461301.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-01T04:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461301",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461302.json:
```json
{
    "body": "Okay, that will be good.\n\nThe only other thing I am not sure about with making this optional is the perl dependencies. It should be okay, but I feel like we should just double check on sage-devel about this.",
    "created_at": "2021-10-01T06:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461302",
    "user": "https://github.com/tscrim"
}
```

Okay, that will be good.

The only other thing I am not sure about with making this optional is the perl dependencies. It should be okay, but I feel like we should just double check on sage-devel about this.



---

archive/issue_comments_461303.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-01T17:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461303",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461304.json:
```json
{
    "body": "I'd say the Perl dependencies are just like other dummy packages that we have that can only be installed using system packages. For example: `pandoc`\n\nI've now merged #31163, which gives better system package info when someone ignores the advice issued by `configure` and attempts to install `perl_cpan_polymake_prereq` (directly or as a dependency of `polymake`).",
    "created_at": "2021-10-01T17:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461304",
    "user": "https://github.com/mkoeppe"
}
```

I'd say the Perl dependencies are just like other dummy packages that we have that can only be installed using system packages. For example: `pandoc`

I've now merged #31163, which gives better system package info when someone ignores the advice issued by `configure` and attempts to install `perl_cpan_polymake_prereq` (directly or as a dependency of `polymake`).



---

archive/issue_comments_461305.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-10-01T17:23:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461305",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_461306.json:
```json
{
    "body": "Okay, then let it be so.",
    "created_at": "2021-10-02T00:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461306",
    "user": "https://github.com/tscrim"
}
```

Okay, then let it be so.



---

archive/issue_comments_461307.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-02T00:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461307",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_461308.json:
```json
{
    "body": "Thank you!",
    "created_at": "2021-10-02T00:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461308",
    "user": "https://github.com/mkoeppe"
}
```

Thank you!



---

archive/issue_events_086406.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-10-13T22:50:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32368#event-86406"
}
```



---

archive/issue_comments_461309.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-10-13T22:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461309",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_461310.json:
```json
{
    "body": "On #31527 I found that `jupymake` must be installed if `polymake` is, so dependencies aren't set right here.",
    "created_at": "2021-10-22T09:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32368#issuecomment-461310",
    "user": "https://github.com/dimpase"
}
```

On #31527 I found that `jupymake` must be installed if `polymake` is, so dependencies aren't set right here.
