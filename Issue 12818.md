# Issue 12818: typo in connecting conversion maps

Issue created by migration from https://trac.sagemath.org/ticket/12990

Original creator: lftabera

Original creation time: 2012-05-22 16:58:46

Assignee: robertwb

CC:  simonking

We currently have this error


```
K = NumberField([x^2-2, x^2-3], 'a,b')
M = K.absolute_field('c')
M_to_K, K_to_M = M.structure()
M.register_coercion(K_to_M)
K.register_coercion(M_to_K)
M.coerce_map_from(QQ)
...
UnboundLocalError: local variable 'connecting' referenced before assignment
```


This error was not present in 4.7.x series


---

Comment by lftabera created at 2012-05-22 18:04:54

The solution was found by Simon King discussing #12269


---

Comment by lftabera created at 2012-05-22 18:05:42

Changing status from new to needs_review.


---

Comment by nbruin created at 2012-05-22 18:12:20

OK, nevermind [attachment:trac_12990.patch]. Overlapping time windows! Just go with the first patch. The typo was introduced in #7420, which was merged in 4.3. Apparently changes after 4.7.1 made it so that the example in the ticket activates this code path.


---

Comment by kini created at 2012-05-22 19:54:18

patchbot: apply connecting.patch


---

Comment by kini created at 2012-05-22 20:38:56

Changing status from needs_review to positive_review.


---

Comment by kini created at 2012-05-22 20:38:56

Looks good to go.


---

Comment by jdemeyer created at 2012-05-26 17:43:57

Looks like like a duplicate of #12919.


---

Comment by jdemeyer created at 2012-05-26 17:43:57

Changing status from positive_review to needs_info.


---

Comment by kini created at 2012-05-26 17:52:30

Well would you look at that... hmm. Maybe we can keep the doctest from this patch. I've posted a comment on #12919.


---

Comment by lftabera created at 2012-05-31 07:24:17

Yes, whis is a clear duplicate of #12919, however, I would like to keep also the doctest of this patch, 12919 doctest is a an ad-hoc class for testing the bug. In this patch is a "real-life" situation where the bug is triggered.

Should I clear the patch to keep only the doctest and possibli be merged?


---

Comment by kini created at 2012-05-31 07:35:11

Sounds good to me.


---

Comment by lftabera created at 2012-06-22 17:08:18

Changing status from needs_info to needs_review.


---

Attachment


---

Comment by mstreng created at 2012-08-06 13:55:11

Changing status from needs_review to positive_review.


---

Comment by kini created at 2012-08-06 13:58:31

Whoops, forgot about this ticket. Thanks for the positive review, mstreng.


---

Comment by jdemeyer created at 2012-08-14 07:03:33

Resolution: fixed
