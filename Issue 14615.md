# Issue 14615: Root system plot improvements: arrow tips, fundamental polygon, ...

archive/issues_014615.json:
```json
{
    "body": "Assignee: sage-combinat\n\nThis small patch implements some little improvements to root system plots:\n\n- Configurable arrow tip size\n- Thicker 0-walls to highlight the fundamental polygon and its translates\n\nTODO, in this ticket or later: \"a4\" \"a4l\" options for bounding box to optimize the bounding box for print outs on a4 / a4 landscape paper.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14819\n\n",
    "created_at": "2013-06-25T13:59:47Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "title": "Root system plot improvements: arrow tips, fundamental polygon, ...",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14615",
    "user": "nthiery"
}
```
Assignee: sage-combinat

This small patch implements some little improvements to root system plots:

- Configurable arrow tip size
- Thicker 0-walls to highlight the fundamental polygon and its translates

TODO, in this ticket or later: "a4" "a4l" options for bounding box to optimize the bounding box for print outs on a4 / a4 landscape paper.

Issue created by migration from https://trac.sagemath.org/ticket/14819





---

archive/issue_comments_185887.json:
```json
{
    "body": "Attachment [trac_14819-root_system_plots-nt.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819-root_system_plots-nt.patch) by nthiery created at 2013-06-25 14:03:57",
    "created_at": "2013-06-25T14:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185887",
    "user": "nthiery"
}
```

Attachment [trac_14819-root_system_plots-nt.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819-root_system_plots-nt.patch) by nthiery created at 2013-06-25 14:03:57



---

archive/issue_comments_185888.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-06-25T14:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185888",
    "user": "nthiery"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_185889.json:
```json
{
    "body": "Attachment [trac_14819_review1.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819_review1.patch) by chapoton created at 2013-08-21 12:39:38",
    "created_at": "2013-08-21T12:39:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185889",
    "user": "chapoton"
}
```

Attachment [trac_14819_review1.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819_review1.patch) by chapoton created at 2013-08-21 12:39:38



---

archive/issue_comments_185890.json:
```json
{
    "body": "here is a review patch, trying to make all tests pass",
    "created_at": "2013-08-21T12:40:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185890",
    "user": "chapoton"
}
```

here is a review patch, trying to make all tests pass



---

archive/issue_comments_185891.json:
```json
{
    "body": "Attachment [trac_14819-review2-ts.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819-review2-ts.patch) by tscrim created at 2013-08-24 15:59:41",
    "created_at": "2013-08-24T15:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185891",
    "user": "tscrim"
}
```

Attachment [trac_14819-review2-ts.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819-review2-ts.patch) by tscrim created at 2013-08-24 15:59:41



---

archive/issue_comments_185892.json:
```json
{
    "body": "All tests pass for me, however I'm a little paranoid about ordering in dictionaries (of more than 3 entries), so I've just changed it to output a sorted list of the items.",
    "created_at": "2013-08-24T16:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185892",
    "user": "tscrim"
}
```

All tests pass for me, however I'm a little paranoid about ordering in dictionaries (of more than 3 entries), so I've just changed it to output a sorted list of the items.



---

archive/issue_comments_185893.json:
```json
{
    "body": "I agree with your changes. \n\nShould we wait until the patchbot raises from the deads, before we give a positive review ?",
    "created_at": "2013-08-24T19:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185893",
    "user": "chapoton"
}
```

I agree with your changes. 

Should we wait until the patchbot raises from the deads, before we give a positive review ?



---

archive/issue_comments_185894.json:
```json
{
    "body": "I think we should wait (at most a day) as well. I just gave it a kick since it timed out on trying to apply this ticket.",
    "created_at": "2013-08-24T19:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185894",
    "user": "tscrim"
}
```

I think we should wait (at most a day) as well. I just gave it a kick since it timed out on trying to apply this ticket.



---

archive/issue_comments_185895.json:
```json
{
    "body": "So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?",
    "created_at": "2013-08-25T01:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185895",
    "user": "tscrim"
}
```

So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?



---

archive/issue_comments_185896.json:
```json
{
    "body": "I get the same failure as the bot on 5.12.beta3\n\nSo I propose to correct the doctest. Here is a patch doing just that",
    "created_at": "2013-08-25T07:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185896",
    "user": "chapoton"
}
```

I get the same failure as the bot on 5.12.beta3

So I propose to correct the doctest. Here is a patch doing just that



---

archive/issue_comments_185897.json:
```json
{
    "body": "Attachment [trac_14819_review3-fc.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819_review3-fc.patch) by chapoton created at 2013-08-25 07:25:21",
    "created_at": "2013-08-25T07:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185897",
    "user": "chapoton"
}
```

Attachment [trac_14819_review3-fc.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819_review3-fc.patch) by chapoton created at 2013-08-25 07:25:21



---

archive/issue_comments_185898.json:
```json
{
    "body": "Attachment [trac_14819-root_system_plots-nt-folded.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819-root_system_plots-nt-folded.patch) by chapoton created at 2013-08-25 13:57:34",
    "created_at": "2013-08-25T13:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185898",
    "user": "chapoton"
}
```

Attachment [trac_14819-root_system_plots-nt-folded.patch](tarball://root/attachments/some-uuid/ticket14819/trac_14819-root_system_plots-nt-folded.patch) by chapoton created at 2013-08-25 13:57:34



---

archive/issue_comments_185899.json:
```json
{
    "body": "I have folded all the patches:\n\napply only trac_14819-root_system_plots-nt-folded.patch",
    "created_at": "2013-08-25T13:58:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185899",
    "user": "chapoton"
}
```

I have folded all the patches:

apply only trac_14819-root_system_plots-nt-folded.patch



---

archive/issue_comments_185900.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-08-25T17:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185900",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_185901.json:
```json
{
    "body": "Now I get (with `sage-5.11.rc0` in the combinat queue):\n\n```\nsage -t root_lattice_realizations.py\n    [450 tests, 49.10 s]\nsage -t plot.py\n**********************************************************************\nFile \"plot.py\", line 1091, in sage.combinat.root_system.plot.PlotOptions.?\nFailed example:\n    sorted(p[0].options().items())\nExpected:\n    [('alpha', 0.500000000000000), ('legend_color', None),\n     ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4),\n     ('zorder', 1)]\nGot:\n    [('alpha', 0.500000000000000), ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4), ('zorder', 1)]\n**********************************************************************\n1 item had failures:\n   1 of  33 in sage.combinat.root_system.plot.PlotOptions.?\n    [252 tests, 1 failure, 74.20 s]\n----------------------------------------------------------------------\nsage -t plot.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\n\nSo it's probable that something changed between `5.11.rc0` and `5.12.beta3` which is not reflected in the combinat queue. I'm going to set this to positive review and build `5.12.beta3` today and report back if I get a doctest failure.",
    "created_at": "2013-08-25T17:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185901",
    "user": "tscrim"
}
```

Now I get (with `sage-5.11.rc0` in the combinat queue):

```
sage -t root_lattice_realizations.py
    [450 tests, 49.10 s]
sage -t plot.py
**********************************************************************
File "plot.py", line 1091, in sage.combinat.root_system.plot.PlotOptions.?
Failed example:
    sorted(p[0].options().items())
Expected:
    [('alpha', 0.500000000000000), ('legend_color', None),
     ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4),
     ('zorder', 1)]
Got:
    [('alpha', 0.500000000000000), ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4), ('zorder', 1)]
**********************************************************************
1 item had failures:
   1 of  33 in sage.combinat.root_system.plot.PlotOptions.?
    [252 tests, 1 failure, 74.20 s]
----------------------------------------------------------------------
sage -t plot.py  # 1 doctest failed
----------------------------------------------------------------------
```


So it's probable that something changed between `5.11.rc0` and `5.12.beta3` which is not reflected in the combinat queue. I'm going to set this to positive review and build `5.12.beta3` today and report back if I get a doctest failure.



---

archive/issue_comments_185902.json:
```json
{
    "body": "Replying to [comment:6 tscrim]:\n> So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?\n\nOr with some properly placed \"...\" ?\n\nIn any cases, thanks guys for reviewing this ticket!",
    "created_at": "2013-08-27T10:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185902",
    "user": "nthiery"
}
```

Replying to [comment:6 tscrim]:
> So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?

Or with some properly placed "..." ?

In any cases, thanks guys for reviewing this ticket!



---

archive/issue_comments_185903.json:
```json
{
    "body": "It worked for me on `5.12.beta3`, so something probably changed in the general graphics part of Sage...",
    "created_at": "2013-08-27T15:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185903",
    "user": "tscrim"
}
```

It worked for me on `5.12.beta3`, so something probably changed in the general graphics part of Sage...



---

archive/issue_comments_185904.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-08-28T06:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14615",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14615#issuecomment-185904",
    "user": "jdemeyer"
}
```

Resolution: fixed
