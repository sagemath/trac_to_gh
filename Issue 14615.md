# Issue 14615: Root system plot improvements: arrow tips, fundamental polygon, ...

Issue created by migration from Trac.

Original creator: nthiery

Original creation time: 2013-06-25 13:59:47

Assignee: sage-combinat

This small patch implements some little improvements to root system plots:

- Configurable arrow tip size
- Thicker 0-walls to highlight the fundamental polygon and its translates

TODO, in this ticket or later: "a4" "a4l" options for bounding box to optimize the bounding box for print outs on a4 / a4 landscape paper.


---

Attachment


---

Comment by nthiery created at 2013-06-25 14:03:57

Changing status from new to needs_review.


---

Attachment


---

Comment by chapoton created at 2013-08-21 12:40:06

here is a review patch, trying to make all tests pass


---

Attachment


---

Comment by tscrim created at 2013-08-24 16:01:22

All tests pass for me, however I'm a little paranoid about ordering in dictionaries (of more than 3 entries), so I've just changed it to output a sorted list of the items.


---

Comment by chapoton created at 2013-08-24 19:25:44

I agree with your changes. 

Should we wait until the patchbot raises from the deads, before we give a positive review ?


---

Comment by tscrim created at 2013-08-24 19:33:14

I think we should wait (at most a day) as well. I just gave it a kick since it timed out on trying to apply this ticket.


---

Comment by tscrim created at 2013-08-25 01:02:22

So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?


---

Comment by chapoton created at 2013-08-25 07:25:01

I get the same failure as the bot on 5.12.beta3

So I propose to correct the doctest. Here is a patch doing just that


---

Attachment


---

Attachment


---

Comment by chapoton created at 2013-08-25 13:58:30

I have folded all the patches:

apply only trac_14819-root_system_plots-nt-folded.patch


---

Comment by tscrim created at 2013-08-25 17:08:22

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2013-08-25 17:08:22

Now I get (with `sage-5.11.rc0` in the combinat queue):

```
sage -t root_lattice_realizations.py
    [450 tests, 49.10 s]
sage -t plot.py
**********************************************************************
File "plot.py", line 1091, in sage.combinat.root_system.plot.PlotOptions.?
Failed example:
    sorted(p[0].options().items())
Expected:
    [('alpha', 0.500000000000000), ('legend_color', None),
     ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4),
     ('zorder', 1)]
Got:
    [('alpha', 0.500000000000000), ('legend_label', None), ('rgbcolor', 'green'), ('thickness', 4), ('zorder', 1)]
**********************************************************************
1 item had failures:
   1 of  33 in sage.combinat.root_system.plot.PlotOptions.?
    [252 tests, 1 failure, 74.20 s]
----------------------------------------------------------------------
sage -t plot.py  # 1 doctest failed
----------------------------------------------------------------------
```


So it's probable that something changed between `5.11.rc0` and `5.12.beta3` which is not reflected in the combinat queue. I'm going to set this to positive review and build `5.12.beta3` today and report back if I get a doctest failure.


---

Comment by nthiery created at 2013-08-27 10:53:39

Replying to [comment:6 tscrim]:
> So the patchbot responds with a doctest failure, which has the extra option of `('legend_color', None),`. I have no idea where this comes from, nor why it only shows up for the patchbot... Nicolas, Frederic, any ideas? Or since we're getting different outputs, should we just mark the test as `# random`?

Or with some properly placed "..." ?

In any cases, thanks guys for reviewing this ticket!


---

Comment by tscrim created at 2013-08-27 15:56:06

It worked for me on `5.12.beta3`, so something probably changed in the general graphics part of Sage...


---

Comment by jdemeyer created at 2013-08-28 06:54:03

Resolution: fixed
