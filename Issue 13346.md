# Issue 13346: improvements and additions to dyck_words.py

Issue created by migration from Trac.

Original creator: zabrocki

Original creation time: 2012-09-29 19:16:42

Assignee: sage-combinat

CC:  zabrocki dorota@yorku.ca stumpc5 hivert

Add functionality to DyckWord and DyckWords classes including:

* the ability to input a Dyck word by specifying the area sequence of the corresponding path
* injections/surjections to other combinatorial objects (e.g. touch composition, Haglund's area<->bounce map, etc.)
* combinatorial statistics (e.g. number of touch points, length of first/last run, area, bounce, dinv)
* connections with symmetric functions
* a pretty print function


---

Comment by zabrocki created at 2012-10-27 01:10:18

Changing keywords from "" to "dyck_words, noncrossing partitions, parking functions".


---

Comment by zabrocki created at 2012-10-27 01:10:18

Changing status from new to needs_review.


---

Comment by chapoton created at 2012-10-29 11:22:52

You should add doctests to all fonctions.

And try not to insert new trailing whitespaces.

Two doctests are failing. They seem to be caused by changes in other places. Just change them to their new value.


---

Comment by zabrocki created at 2012-10-29 14:41:45

I think I got the trailing whitespaces.  I had a mistake when I searched for them before.
I changed doc-tests failing in combinat/q_analogues.py and misc/latex.py.
I am not seeing the missing doc-tests.

Christian has asked to resolve a question about if we should join functions of the form .to_xyz_avoiding_permutation() to a .to_permutation() function in https://groups.google.com/d/msg/sage-combinat-devel/jzGHkbcrLec/9WurflNlyEoJ


---

Comment by chapoton created at 2012-10-29 15:19:04

there should be 3 missing docs :

one of them is the __init__ of DyckWord_class

and b_statistic and a_statistic, which are no longer tested !


---

Comment by chapoton created at 2012-10-29 15:20:17

maybe rather use deprecated_function_alias (see http://trac.sagemath.org/sage_trac/attachment/ticket/13109/trac_13109-documentation.v3.patch)


---

Comment by zabrocki created at 2012-10-29 17:36:03

Thanks!  I've added the init doctests and I used the deprecated_function_alias.  I also added a check in min_from_heights that the first entry is 0 (as existed in from_heights method).


---

Comment by chapoton created at 2012-11-05 10:35:58

Christian, is your patch supposed to replace the previous one ?


---

Comment by stumpc5 created at 2012-11-05 10:39:29

Replying to [comment:8 chapoton]:
> Christian, is your patch supposed to replace the previous one ?

No. I haven't yet checked why my patch doesn't apply on 5.4.rc3. I plan to do this as soon as the sage-combinat queue (containing Mike's last changes) is working again -- I hope this to happen today!


---

Comment by stumpc5 created at 2012-11-05 18:37:55

Replying to [comment:9 stumpc5]:
> Replying to [comment:8 chapoton]:
> > Christian, is your patch supposed to replace the previous one ?
> 
> No. I haven't yet checked why my patch doesn't apply on 5.4.rc3. I plan to do this as soon as the sage-combinat queue (containing Mike's last changes) is working again -- I hope this to happen today!

I uploaded the newest version of the patch containing Mike's and my changes. 5.4.rc3 is still compiling, I will check why it doesn't apply there as soon as it's ready (I am still using 5.3 currently).


---

Comment by stumpc5 created at 2012-11-05 21:18:12

> I uploaded the newest version of the patch containing Mike's and my changes. 5.4.rc3 is still compiling, I will check why it doesn't apply there as soon as it's ready (I am still using 5.3 currently).

Apparently, it was patchbot's mistake...

I now deleted the trailing whitespaces, and will finish my review tomorrow. Since I was doing many changes, I would then still hope that someone else is looking at these (but I guess Mike could do it as well).

Best, Christian


---

Comment by stumpc5 created at 2012-11-06 10:46:23

Hi,

I'd give this ticket a positive review as is. Nonetheless, I would prefer if someone else is giving his/her okay as well since I made many changes in this ticket myself.

Two issues I somehow do not like with Dyck words (but, if desired, should be taken care of in another ticket) are:

- the `__repr__` and the `__str__` methods for Dyck words differ:

```
sage: D = DyckWord([1,1,1,0,1,0,0,1,1,0,0,0])
sage: D
[1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0]
sage: print D
((()())(()))
```


- We now distinguish between complete and uncomplete Dyck words (and implicitly did that before as well). But iterating through `DyckWords` only yield complete Dyck words.

```
sage: I = iter(DyckWords())                   
sage: for i in range(10):^J    print I.next() 
....:     

()
()()
(())
()()()
()(())
(())()
(()())
((()))
()()()()
```


Would you expect this behaviour? Are there better solutions for those?

Best, Christian


---

Comment by zabrocki created at 2012-11-06 14:24:16

I have looked at Christian's changes and approve.  This patch is ready to go.

About the two issues:

 * I don't object strongly to the !__str!__ and the !__repr!__ being different, but I can see that is a bit unusual.  This patch adds a pretty_print method (and this isn't it at all), but we could rename !__str!__() to be .pp() or put an optional argument in .to_string(parens=True)

 * I think that this seems like correct behavior to me. There isn't a natural way of iterating through incomplete DyckWords() that I would find particularly helpful.  As it is, if you want to access incomplete Dyck words you need to specify the the number of open and close parentheses.  That is DyckWords() is all complete DyckWords, DyckWords(n) is Dyck words with n open and n close and DyckWords(n,k) is Dyck words with n open and k close.  The truth is, I don't have a use for iterating through all complete/incomplete Dyck words.


---

Comment by stumpc5 created at 2012-11-06 14:45:53

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-11-07 07:55:39

Please fill in your real names as Author and Reviewer.


---

Comment by jdemeyer created at 2012-11-12 13:11:49

Why the change in `latex.py`?  It causes doctest failures on various machines:

```
sage -t  --long -force_lib devel/sage/sage/misc/latex.py
**********************************************************************
File "/home/buildbot/build/sage/rosemary-1/rosemary_full/build/sage-5.5.beta2/devel/sage-main/sage/misc/latex.py", line 604:
    sage: print latex_extra_preamble()
Expected:
    \usepackage{tikz}
    <BLANKLINE>
    \newcommand{\ZZ}{\Bold{Z}}
    \newcommand{\NN}{\Bold{N}}
    \newcommand{\RR}{\Bold{R}}
    \newcommand{\CC}{\Bold{C}}
    \newcommand{\QQ}{\Bold{Q}}
    \newcommand{\QQbar}{\overline{\QQ}}
    \newcommand{\GF}[1]{\Bold{F}_{#1}}
    \newcommand{\Zp}[1]{\ZZ_{#1}}
    \newcommand{\Qp}[1]{\QQ_{#1}}
    \newcommand{\Zmod}[1]{\ZZ/#1\ZZ}
    \newcommand{\CDF}{\Bold{C}}
    \newcommand{\CIF}{\Bold{C}}
    \newcommand{\CLF}{\Bold{C}}
    \newcommand{\RDF}{\Bold{R}}
    \newcommand{\RIF}{\Bold{I} \Bold{R}}
    \newcommand{\RLF}{\Bold{R}}
    \newcommand{\CFF}{\Bold{CFF}}
    \newcommand{\Bold}[1]{\mathbf{#1}}
    <BLANKLINE>
Got:
    <BLANKLINE>
    \newcommand{\ZZ}{\Bold{Z}}
    \newcommand{\NN}{\Bold{N}}
    \newcommand{\RR}{\Bold{R}}
    \newcommand{\CC}{\Bold{C}}
    \newcommand{\QQ}{\Bold{Q}}
    \newcommand{\QQbar}{\overline{\QQ}}
    \newcommand{\GF}[1]{\Bold{F}_{#1}}
    \newcommand{\Zp}[1]{\ZZ_{#1}}
    \newcommand{\Qp}[1]{\QQ_{#1}}
    \newcommand{\Zmod}[1]{\ZZ/#1\ZZ}
    \newcommand{\CDF}{\Bold{C}}
    \newcommand{\CIF}{\Bold{C}}
    \newcommand{\CLF}{\Bold{C}}
    \newcommand{\RDF}{\Bold{R}}
    \newcommand{\RIF}{\Bold{I} \Bold{R}}
    \newcommand{\RLF}{\Bold{R}}
    \newcommand{\CFF}{\Bold{CFF}}
    \newcommand{\Bold}[1]{\mathbf{#1}}
    <BLANKLINE>
**********************************************************************
```



---

Comment by jdemeyer created at 2012-11-12 13:11:49

Changing status from positive_review to needs_work.


---

Comment by zabrocki created at 2012-11-12 18:04:00

The change to latex_extra_preamble came from a call to latex.add_package_to_preamble_if_available("tikz").  This was moved into its proper place and the change to latex.py was removed.  Christian will upload the patch since I don't have overwrite permission.


---

Attachment


---

Comment by stumpc5 created at 2012-11-12 18:07:42

Replying to [comment:18 zabrocki]:
> The change to latex_extra_preamble came from a call to latex.add_package_to_preamble_if_available("tikz").  This was moved into its proper place and the change to latex.py was removed.  Christian will upload the patch since I don't have overwrite permission.

done!


---

Comment by zabrocki created at 2012-11-12 18:47:30

Changing status from needs_work to positive_review.


---

Comment by zabrocki created at 2012-11-12 18:47:30

Tests re-run and all pass.  I am restoring the positive review.


---

Comment by jdemeyer created at 2012-11-16 21:25:59

Resolution: fixed


---

Comment by ncohen created at 2013-06-10 08:00:16

I do not know who I should send this to, but the following line fails, at least on my computer 

```
sage: view( DyckWord([1,0]))
```


This ticket is the last one which modified the ._latex_ function of Dyck words.

Nathann
