# Issue 30518: control the number of digits to display in matrices via IPython's %precision magic

archive/issues_030518.json:
```json
{
    "body": "CC:  @slel @davidayotte\n\nBased on #30552, this ticket adds options for customizing the number of floating point digits to display in matrices. This is particularly useful for numeric computations involving large matrices.\n\nThe option is linked to the IPython magic [%precision](https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-precision). (The IPython magic also sets the corresponding option in NumPy.)\n\n\n```\nsage: %precision 4\n'%.4f'\nsage: A = matrix.random(RDF, 5); A\n[-0.01337  -0.9269  -0.0893   0.1784    0.975]\n[  0.2152   0.6165   0.4195   0.7558  -0.9292]\n[  0.8234  -0.2305     0.83  -0.9375   0.4938]\n[ -0.6378   0.7058   0.1209  -0.9081  -0.9551]\n[  0.9217  -0.3054  -0.2997   0.5871  -0.5642]\nsage: %precision\n'%r'\nsage: A\n[-0.013365510514271595   -0.9268868721196306  -0.08930150422327143   0.17839999989498323    0.9750196839071508]\n[  0.21517169403284941    0.6165223907365385    0.4195049240955384    0.7557760012777428   -0.9291629307331721]\n[   0.8233703740645537  -0.23053733934301857    0.8299695817296515   -0.9375095363818953    0.4937640499860838]\n[  -0.6378186095056861    0.7057551432596336   0.12087801033553447   -0.9080993678019631   -0.9551440194578318]\n[   0.9216765622236254  -0.30541498083145413  -0.29967291645930083    0.5871367386637378   -0.5642041854379536]\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/30755\n\n",
    "created_at": "2020-10-11T13:21:49Z",
    "labels": [
        "component: numerical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "control the number of digits to display in matrices via IPython's %precision magic",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30518",
    "user": "https://github.com/mwageringel"
}
```
CC:  @slel @davidayotte

Based on #30552, this ticket adds options for customizing the number of floating point digits to display in matrices. This is particularly useful for numeric computations involving large matrices.

The option is linked to the IPython magic [%precision](https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-precision). (The IPython magic also sets the corresponding option in NumPy.)


```
sage: %precision 4
'%.4f'
sage: A = matrix.random(RDF, 5); A
[-0.01337  -0.9269  -0.0893   0.1784    0.975]
[  0.2152   0.6165   0.4195   0.7558  -0.9292]
[  0.8234  -0.2305     0.83  -0.9375   0.4938]
[ -0.6378   0.7058   0.1209  -0.9081  -0.9551]
[  0.9217  -0.3054  -0.2997   0.5871  -0.5642]
sage: %precision
'%r'
sage: A
[-0.013365510514271595   -0.9268868721196306  -0.08930150422327143   0.17839999989498323    0.9750196839071508]
[  0.21517169403284941    0.6165223907365385    0.4195049240955384    0.7557760012777428   -0.9291629307331721]
[   0.8233703740645537  -0.23053733934301857    0.8299695817296515   -0.9375095363818953    0.4937640499860838]
[  -0.6378186095056861    0.7057551432596336   0.12087801033553447   -0.9080993678019631   -0.9551440194578318]
[   0.9216765622236254  -0.30541498083145413  -0.29967291645930083    0.5871367386637378   -0.5642041854379536]
```



Issue created by migration from https://trac.sagemath.org/ticket/30755





---

archive/issue_comments_435308.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-10-11T13:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435308",
    "user": "https://github.com/mwageringel"
}
```

New commits:



---

archive/issue_comments_435309.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-10-11T13:25:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435309",
    "user": "https://github.com/mwageringel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_435310.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-10-12T19:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435310",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_435311.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435311",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_435312.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-05-08T14:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435312",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_435313.json:
```json
{
    "body": "Rebased on 9.3.rc5.",
    "created_at": "2021-05-08T14:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435313",
    "user": "https://github.com/mwageringel"
}
```

Rebased on 9.3.rc5.



---

archive/issue_comments_435314.json:
```json
{
    "body": "Hello Markus,\n\nThanks for this enhancement. I have reviewed it and everything is correct. However, I got two unrelated errors when testing the whole documentation:\n\n\n```\nRunning doctests with ID 2021-06-28-14-01-05-7ec3f02e.\nGit branch: HEAD\nUsing --optional=build,debian,dochtml,pip,sage,sage_spkg\nDoctesting 1 file.\nsage -t --long --warn-long 160.0 --random-seed=0 src/sage/modules/fg_pid/fgp_module.py\n**********************************************************************\nFile \"src/sage/modules/fg_pid/fgp_module.py\", line 1274, in sage.modules.fg_pid.fgp_module.FGP_Module_class.coordinate_vector\nFailed example:\n    Q.coordinate_vector(Q.0 - Q.1)\nExpected:\n    (1, -1)\nGot:\n    (1, 47)\n**********************************************************************\nFile \"src/sage/modules/fg_pid/fgp_module.py\", line 1294, in sage.modules.fg_pid.fgp_module.FGP_Module_class.coordinate_vector\nFailed example:\n    Q.coordinate_vector(x)\nExpected:\n    (0, -1)\nGot:\n    (0, 11)\n**********************************************************************\n1 item had failures:\n   2 of  23 in sage.modules.fg_pid.fgp_module.FGP_Module_class.coordinate_vector\n    [397 tests, 2 failures, 2.04 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 160.0 --random-seed=0 src/sage/modules/fg_pid/fgp_module.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 2.1 seconds\n    cpu time: 2.0 seconds\n    cumulative wall time: 2.0 seconds\n```\n\n\nI tested this module outside of your ticket (on the develop branch) and I also got the same error, so it is definitely not related with your code. Do you know if there is already a ticket about this?\n\nEDIT: this issue is already known and is covered in ticket #32048",
    "created_at": "2021-06-28T18:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435314",
    "user": "https://github.com/DavidAyotte"
}
```

Hello Markus,

Thanks for this enhancement. I have reviewed it and everything is correct. However, I got two unrelated errors when testing the whole documentation:


```
Running doctests with ID 2021-06-28-14-01-05-7ec3f02e.
Git branch: HEAD
Using --optional=build,debian,dochtml,pip,sage,sage_spkg
Doctesting 1 file.
sage -t --long --warn-long 160.0 --random-seed=0 src/sage/modules/fg_pid/fgp_module.py
**********************************************************************
File "src/sage/modules/fg_pid/fgp_module.py", line 1274, in sage.modules.fg_pid.fgp_module.FGP_Module_class.coordinate_vector
Failed example:
    Q.coordinate_vector(Q.0 - Q.1)
Expected:
    (1, -1)
Got:
    (1, 47)
**********************************************************************
File "src/sage/modules/fg_pid/fgp_module.py", line 1294, in sage.modules.fg_pid.fgp_module.FGP_Module_class.coordinate_vector
Failed example:
    Q.coordinate_vector(x)
Expected:
    (0, -1)
Got:
    (0, 11)
**********************************************************************
1 item had failures:
   2 of  23 in sage.modules.fg_pid.fgp_module.FGP_Module_class.coordinate_vector
    [397 tests, 2 failures, 2.04 s]
----------------------------------------------------------------------
sage -t --long --warn-long 160.0 --random-seed=0 src/sage/modules/fg_pid/fgp_module.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 2.1 seconds
    cpu time: 2.0 seconds
    cumulative wall time: 2.0 seconds
```


I tested this module outside of your ticket (on the develop branch) and I also got the same error, so it is definitely not related with your code. Do you know if there is already a ticket about this?

EDIT: this issue is already known and is covered in ticket #32048



---

archive/issue_comments_435315.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-28T19:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435315",
    "user": "https://github.com/DavidAyotte"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_435316.json:
```json
{
    "body": "Thank you for the review, David.",
    "created_at": "2021-06-29T07:43:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435316",
    "user": "https://github.com/mwageringel"
}
```

Thank you for the review, David.



---

archive/issue_comments_435317.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-29T23:08:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30518#issuecomment-435317",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_028027.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-29T23:08:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30518",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30518#event-28027"
}
```
