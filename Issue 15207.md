# Issue 15207: Two algorithms for k-charge do not give same answer

Issue created by migration from Trac.

Original creator: aschilling

Original creation time: 2013-11-22 03:53:05

CC:  sage-combinat zabrocki

Keywords: tableaux, charge

Currently, the two implementations of k-charge do not give the same answer:

```
sage: T = WeakTableaux(4,[4,3,2,1],[2,2,2,2,1,1],representation='bounded')
sage: for t in T:
    print t.k_charge(), t.k_charge(algorithm='J')
....:
9 10
10 10
8 8
9 9
10 10
8 9
11 11
```

Comparing against the expansion of Hall-Littlewood symmetric functions in terms of k-Schur functions, it seems that the I-implementation is correct

```
sage: Sym = SymmetricFunctions(QQ['t'])
sage: Qp = Sym.hall_littlewood().Qp()
sage: ks = Sym.kschur(4)
sage: ks(Qp[2,2,2,2,1,1])[Partition([4,3,2,1])]
t^11 + 2*t^10 + 2*t^9 + 2*t^8
```



---

Comment by zabrocki created at 2013-11-22 12:08:49

Proposition 3.15 on p. 84 of [our book](https://www.math.ucdavis.edu/~anne/FQ2012/book-released-September2012.pdf) states that the k-charge with the two algorithms are equal.  Am I correct to assume that since you opened a ticket that the error is in the algorithm and not in that proposition?

To clarify

```
sage: T = WeakTableau([[1, 1, 2, 3], [2, 4, 4], [3, 6], [5]],4,representation='bounded')
sage: T.k_charge()
9
sage: T.k_charge(algorithm='J')
10
```



---

Comment by aschilling created at 2013-11-24 05:40:18

Yes, I think the implementation that Avi and Nate did is not quite correct. If you look at the second standard subword of your example above, then the program computes the height of the restricted subword incorrectly for the letter r=3.


---

Comment by aschilling created at 2013-11-24 07:28:08

New commits:


---

Comment by aschilling created at 2013-11-24 07:28:08

Changing status from new to needs_review.


---

Comment by aschilling created at 2013-11-24 07:34:45

I ran the following code for k=3 and 4 and now the two implementations seem to agree:

```
sage: for n in range(10):
    for la in Partitions(n,max_part=k):
        for mu in Partitions(n,max_part=k):
            T = WeakTableaux(k,la,mu,representation='bounded')
            if not all(t.k_charge() == t.k_charge(algorithm="J") for t in T):
                print la,mu
....:         
```



---

Comment by zabrocki created at 2013-11-24 13:56:35

Looks good to me.  I tested it on much larger examples and everything seems to be correct now.

Thanks for fixing it.


---

Comment by zabrocki created at 2013-11-24 13:56:35

Changing status from needs_review to positive_review.


---

Comment by aschilling created at 2013-11-24 17:23:38

Thank you for the swift review! Anne


---

Comment by vbraun created at 2014-01-04 02:09:32

Resolution: fixed
