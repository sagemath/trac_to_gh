# Issue 31227: add the function is_prime_of_good_reduction

Issue created by migration from https://trac.sagemath.org/ticket/31464

Original creator: @Saher-Amasha

Original creation time: 2021-03-07 19:53:34

CC:  bhutz

the functions takes as input a dynamical system and a prime the function returns true if the prime is a prime of good reduction otherwise the function returns false


---

Comment by @Saher-Amasha created at 2021-03-11 18:01:09

New commits:


---

Comment by @Saher-Amasha created at 2021-03-11 18:01:09

Changing status from new to needs_review.


---

Comment by git created at 2021-03-17 17:44:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-03-17 18:14:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.


---

Comment by roed created at 2021-04-28 05:47:18

There's a test failure (no attribute `mod_DS`); you can click on the yellow question mark for details.  There's also a plugin failure from style issues in your documentation (see also notes below).

Style changes:
 * Use spaces after commas (and not before), and around +, *, / and = (except in keyword arguments like `dS.mod(p=5)`).
 * Description should use "return" rather than "returns" and could probably be rephrased as "Whether this dynamical system has good reduction at the given prime"
 * For mod, I would suggest using an `EXAMPLES` block rather than a `TESTS` block

Code questions/suggestions:
 * Why do you need to copy self?  I wouldn't expect any of these functions to change self in place.
 * You shouldn't use a bare except, since it will catch KeyboardInterrupts.  Better practice is to either catch the specific error type, or at least use `except Exception:`
 * You can just `return new_DS.degree_sequence(1)[0] == degree` rather than using an if statement.
 * Rather than looping over `range(0, len(blah))` it's usually nicer to iterate over the object itself (e.g. `for poly in df_p_all:`)
 * Even better: use a list comprehension like `coefficients = [poly.coefficients() for poly in DS.defining_polynomials()]`.


---

Comment by roed created at 2021-04-28 05:47:18

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-05-28 21:24:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @Saher-Amasha created at 2021-05-28 21:26:36

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.


---

Comment by @EnderWannabe created at 2021-08-10 22:16:34

Changing status from needs_review to needs_work.


---

Comment by @EnderWannabe created at 2021-08-10 22:16:34

This seems like worthwhile functionality, but we should support number fields as well as function fields. The algorithm also seems a bit off. There are two options I see:

- 1. reducing modulo the prime using `change_ring`, normalizing coordinates and then checking if the degree of the reduced dynamical system is less than the original dynamical system

- 2. computing the resultant and then reducing the resultant modulo the prime. The dynamical system has good reduction if and only if the resultant is non zero.

Reducing using `change_ring` will be harder to code - there will probably be separate cases for number fields and function fields. On the other hand, the resultant computation will probably be slower.


---

Comment by @EnderWannabe created at 2021-08-10 22:16:34

Changing component from algebra to dynamics.


---

Comment by bhutz created at 2021-08-11 00:29:31

The resultant calculation can be *much* slower, so checking degrees would be better, but the issue there is whether normalize will be effective in all settings.
