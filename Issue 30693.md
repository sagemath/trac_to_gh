# Issue 30693: Add/update the system package information for the "_recommended" dummy package

Issue created by migration from https://trac.sagemath.org/ticket/30930

Original creator: mkoeppe

Original creation time: 2020-11-17 02:17:06

CC:  jhpalmieri egourgoulhon @tobiasdiez slabbe slelievre

Follow-up from #29557 (Add script package _recommended and generate "recommended system packages" info).


---

Comment by mkoeppe created at 2020-11-17 02:32:17

The debian package providing latex is updated in #30910, which I have made a dependency.


---

Comment by mkoeppe created at 2020-11-17 02:42:35

This is taking care of the issue with pandoc.
----
Last 10 new commits:


---

Comment by mkoeppe created at 2020-11-17 02:45:11

That `configure` keeps suggesting packages from the `_recommended` dummy package is because `build/pkgs/_recommended/spkg-configure.m4` does not check anything.

To improve this, tests need to be added for the presence of the various recommended packages in the system. Either in `build/pkgs/_recommended/spkg-configure.m4` or in individual "script packages" similar to `build/pkgs/pandoc`.


---

Comment by dimpase created at 2020-11-18 16:59:24

OK, this does the trick for pandoc. I guess  ffmpeg, imagemagick, texinfo need semi-dummy packages created (i.e. with spkg-configure checking their presence, but without real spkg-install), right?


---

Comment by mkoeppe created at 2020-11-18 19:20:49

Replying to [comment:8 dimpase]:
> OK, this does the trick for pandoc. I guess  ffmpeg, imagemagick, texinfo need semi-dummy packages created (i.e. with spkg-configure checking their presence, but without real spkg-install), right?
That's right. Likewise for `libxml` in #30899.


---

Comment by dimpase created at 2020-11-18 22:30:11

Replying to [comment:9 mkoeppe]:
> Replying to [comment:8 dimpase]:
> > OK, this does the trick for pandoc. I guess  ffmpeg, imagemagick, texinfo need semi-dummy packages created (i.e. with spkg-configure checking their presence, but without real spkg-install), right?
> That's right. Likewise for `libxml` in #30899.

should this be done on this ticket, or rather elsewhere?


---

Comment by mkoeppe created at 2020-11-18 22:33:25

Fine to do it here if it's not holding up this ticket too long


---

Comment by mkoeppe created at 2020-11-22 23:52:03

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-12-03 05:10:25

Replying to [comment:9 mkoeppe]:
> Likewise for `libxml` in #30899.

This is now done in #27921


---

Comment by mkoeppe created at 2020-12-04 19:21:18

Needs review


---

Comment by mkoeppe created at 2020-12-06 18:17:38

Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111


---

Comment by mkoeppe created at 2020-12-06 18:17:38

Changing keywords from "" to "sd111".


---

Comment by slabbe created at 2020-12-09 10:42:45

The branch has a conflict on top of 9.3.beta3 (I confirm there is one)


---

Comment by slabbe created at 2020-12-09 10:42:45

Changing status from needs_review to needs_work.


---

Comment by git created at 2020-12-10 06:22:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-12-10 06:23:23

Changing status from needs_work to needs_review.


---

Comment by slabbe created at 2020-12-11 21:37:15

Changing status from needs_review to needs_info.


---

Comment by slabbe created at 2020-12-11 21:37:15

I tested the branch. make build works.

With the branch, I see the following message on my computer (Ubuntu 20.04):

```
    notice: the following SPKGs did not find equivalent system packages:

        _recommended boost coxeter3 gp2c igraph isl libsemigroups pari_elldata pari_galpol pari_nftables pari_seadata
        
checking for the package system in use... debian
configure:

    hint: installing the following system packages, if not
    already present, is recommended and may avoid having to
    build them (though some may have to be built anyway):

      $ sudo apt-get update 
      $ sudo apt-get install  texlive-latex-extra texlive-xetex latexmk dvipng default-jdk ffmpeg libavdevice-dev libboost-dev pari-gp2c libigraph-dev libisl-dev

    After installation, re-run configure using:

      $ ./config.status --recheck && ./config.status
```


And `tox -e docker-archlinux-minimal -- config.status` gives this:


```
    notice: the following SPKGs did not find equivalent system packages:

        _recommended arb boost boost_cropped brial cbc cddlib cliquer cmake coxeter3 eclib ecm fflas_ffpack flint flintqs fplll freetype gc gf2x gfan gfortran giac git givaro glpk gp2c gsl igraph iml isl lcalc libatomic_ops libbraiding libgd libhomfly libnauty libpng libsemigroups lrcalc m4ri m4rie mpfi nauty ninja_build ntl openblas palp pandoc pari pari_elldata pari_galdata pari_galpol pari_nftables pari_seadata pari_seadata_small patch perl_cpan_polymake_prereq perl_term_readline_gnu planarity ppl python3 r rw suitesparse symmetrica sympow tachyon tox zeromq zn_poly
        
checking for the package system in use... arch
configure:

    hint: installing the following system packages, if not
    already present, is recommended and may avoid having to
    build them (though some may have to be built anyway):

      $ sudo pacman -Sy
      $ sudo pacman -S  arb boost boost brial coin-or-cbc cddlib coxeter eclib fflas-ffpack flintqs gc gf2x gfan gcc-fortran libgiac giac glpk gsl igraph iml lcalc libatomic_ops libbraiding gd libhomfly lrcalc m4ri m4rie nauty ninja openblas lapack cblas palp pandoc pari pari-galdata pari-seadata pari-elldata pari-galpol pari-elldata pari-galdata pari-galpol pari-seadata pari-seadata patch perl-term-readline-gnu planarity ppl r rankwidth suitesparse symmetrica sympow tachyon zn_poly

    After installation, re-run configure using:

      $ ./config.status --recheck && ./config.status
```


We see that `pandoc` still appears above. Is this what we want?

Could we update the description of the ticket (which is too large), because I don't know what the branch is suppose to do exactly?


---

Comment by mkoeppe created at 2020-12-11 22:17:59

Replying to [comment:20 slabbe]:
> Could we update the description of the ticket (which is too large), because I don't know what the branch is suppose to do exactly?

I have instead split out the pandoc part (which is the only thing that the current branch took care of) out into the separate ticket #31042.


---

Comment by mkoeppe created at 2020-12-11 22:26:02

Changing status from needs_info to needs_work.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by slelievre created at 2021-03-22 21:20:42

Should `_recommended` really be listed in this configure notice?

```
    notice: the following SPKGs did not find equivalent system packages:

        _recommended cbc coxeter3 gp2c ...
```



---

Comment by mkoeppe created at 2021-03-22 21:27:45

Yes, it may look funny but at least one can see that way where the system package recommendations are coming from


---

Comment by slelievre created at 2021-03-22 22:15:54

Makes sense.


---

Comment by dimpase created at 2021-05-28 16:57:32

texinfo keeps popping up on Homebrew for some reason --- perhaps, because `texinfo` is not a program, there no such executable anymore, it's replaced by `tex2any` - but the package name remains `texinfo`.


---

Comment by mkoeppe created at 2021-05-28 17:01:49

From the ticket description: 
  To this end, tests need to be added for the presence of the various recommended packages in the system. Either in build/pkgs/_recommended/spkg-configure.m4 or in individual script packages similar to build/pkgs/pandoc.
