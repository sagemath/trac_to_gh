# Issue 13570: Irreducible Cartan types created as reducibles

Issue created by migration from Trac.

Original creator: JesusTorrado

Original creation time: 2012-11-28 21:18:55

Assignee: joyner

CC:  sage-combinat nthiery

Keywords: CartanType Reducible Irreducible


```
    sage: c = CartanType([This is the Trac macro *A* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#A-macro))
    sage: c.is_irreducible()      
    False
```


As a consequence, e.g. the cartan_matrix() method fails too.


---

Attachment


---

Comment by JesusTorrado created at 2012-11-28 21:38:31

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2012-11-28 21:59:02

You should add doctests showing that the behavior is now correct, probably with a reference to this ticket:

```
Fixed in :trac:`13774`::

    sage: c = CartanType([This is the Trac macro *A* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#A-macro))
    sage: c.is_irreducible()
    True
    sage: c = CartanType(["A2"])
    sage: c.is_irreducible()
    True
```

I don't have any comments about the mathematical correctness of the fix here; I hope someone else will address that.


---

Comment by JesusTorrado created at 2012-11-28 22:23:54

Replying to [comment:3 jhpalmieri]:
> You should add doctests showing that the behavior is now correct, probably with a reference to this ticket: [...]

I thought about it, but I wasn't sure of whether this was relevant enough to do so. Also, I wouldn't know where to include it: in the top of the file? In the CartanTypeFactory class?


---

Comment by JesusTorrado created at 2012-11-29 08:45:34


```
----------------------------------------------------------------------
All tests passed!
Total time for all tests: 15973.8 seconds
```



---

Attachment

I've uploaded a small review patch which adds the doctests to `__call__()`. If you agree with the changes, feel free to set this to positive review.


---

Comment by tscrim created at 2013-04-06 18:54:50

Changing component from group theory to combinatorics.


---

Comment by tscrim created at 2013-12-27 17:21:06

(Rebased) Branch version. I just need someone to double-check my review changes.
----
New commits:


---

Comment by darij created at 2014-03-07 05:47:52

Is this still relevant? I can't reproduce the bug with a current version of Sage, but I'm not sure if it was cause or symptoms that has been healed.


---

Comment by tscrim created at 2014-03-07 15:17:01

I can still reproduce it:

```

# This is the expected behavior

sage: c = CartanType([['A',2], ['D',4]]); c
A2xD4
sage: c.is_irreducible()
False
sage: c.cartan_matrix()
[ 2 -1| 0  0  0  0]
[-1  2| 0  0  0  0]
[-----+-----------]
[ 0  0| 2 -1  0  0]
[ 0  0|-1  2 -1 -1]
[ 0  0| 0 -1  2  0]
[ 0  0| 0 -1  0  2]
sage: c = CartanType(['A',2]); c
['A', 2]
sage: c.cartan_matrix()
[ 2 -1]
[-1  2]

# This is wrong

sage: c = CartanType([This is the Trac macro *'A',2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'A',2-macro)); c
A2
sage: c.is_irreducible()
False
sage: c.cartan_matrix()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: matrix is immutable; please change a copy instead (i.e., use copy(M) to change a copy of M).
```



---

Comment by darij created at 2014-03-07 16:42:12

Oops, I mucked something up. Anyway, could you add the Cartan matrix to the doctests?


---

Comment by git created at 2014-03-07 20:43:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-03-07 20:43:34

Done.


---

Comment by git created at 2014-03-15 17:21:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2014-03-15 17:23:28

Changing status from needs_review to positive_review.


---

Comment by darij created at 2014-03-15 17:23:28

Sorry for forgetting about this. Positive review. (My commit just fixes typos, which should not be much in need for reviewing.)


---

Comment by tscrim created at 2014-03-15 17:30:41

Thanks Darij.


---

Comment by vbraun created at 2014-03-21 17:47:39

Resolution: fixed
