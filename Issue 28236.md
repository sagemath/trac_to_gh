# Issue 28236: decomposition by clique minimal separators

Issue created by migration from https://trac.sagemath.org/ticket/28473

Original creator: dcoudert

Original creation time: 2019-09-11 09:36:02

We implement the following methods:
- `maximum_cardinality_search` (MCS) graph traversal -- `O(n + m)`
- `maximum_cardinality_search_M` (MCS-M) graph traversal, an extension of MCS that also returns a minimal triangulation -- `O(n.m)`
- `atoms`, a method that decompose the graph according its minimal clique separators and returns its atoms and clique separators -- `O(n.m)`


---

Comment by dcoudert created at 2019-09-11 15:07:45

New commits:


---

Comment by dcoudert created at 2019-09-11 15:07:45

Changing status from new to needs_review.


---

Comment by git created at 2019-09-12 09:26:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-09-12 09:30:31

Fix a doctest in `lex_M` that is now a method of `Graph` and no longer of `GenericGraph` (it works for undirected graphs only), simplifies some tests (no need to waste time), and fix compilation warnings.


---

Comment by git created at 2019-10-07 10:15:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2020-01-04 11:43:18

Successfully tested over 9.0


---

Comment by tscrim created at 2020-01-16 08:18:45

Can you rebase? I will do the review after that.


---

Comment by git created at 2020-01-16 09:27:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2020-01-16 09:28:33

I fixed the merge conflicts.


---

Comment by tscrim created at 2020-01-16 15:31:57

Here are my comments:

I think it is better to have the import grouped:

```diff
-    from sage.graphs.traversals import lex_M
-    from sage.graphs.traversals import maximum_cardinality_search
-    from sage.graphs.traversals import maximum_cardinality_search_M
+    from sage.graphs.traversals import (lex_M, maximum_cardinality_search,
+                                        maximum_cardinality_search_M)
```

You can do the same thing for `cimport` as well IIRC.

I don't know if Cython is smart enough to break this up (which means you'll have to look at the C code), but I am a little dubious about this line:

```
Sc.extend(res[2 if separators else 1])
```

and I think you will get better C code if you do

```
if separators:
    Sc.extend(res[2])
else:
    Sc.extend(res[1])
```


In `atoms_and_clique_separators`, since you use `H[x]` a lot, it probably would be good to define a variable for it. Same for `H[x].size()`. I think it also would be good to pull out

```python
            # Check if the subgraph of G[H[x]] is a clique
            stop = False
            for ui in range(H[x].size() -1):
                u = H[x][ui]
                for vi in range(ui + 1, H[x].size()):
                    if not has_edge(sd, u, H[x][vi]):
                        stop = True
                        break
                if stop:
                    break
            else:
```

into a separate `cdef inline` helper function (which does not need doctests).


```diff
-    OUPUT: by default, return the ordering `\alpha` as a list. When ``tree`` is
+    OUTPUT:
+
+    By default, return the ordering `\alpha` as a list. When ``tree`` is
     ``True``, the method returns a tuple `(\alpha, T)`, where `T` is a directed
     tree with the same set of vertices as `G`and a directed edge from `u` to `v`
     if `u` was the first vertex to saw `v`.
```



```diff
-    for i in range(G.order()):
+    for i in range(N):
```



---

Comment by git created at 2020-01-16 16:21:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2020-01-16 16:23:47

Thanks for the comments.


---

Comment by tscrim created at 2020-01-16 16:26:37

Thanks. LGTM.


---

Comment by tscrim created at 2020-01-16 16:26:37

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2020-01-16 16:33:55

Thank you for the review.


---

Comment by vbraun created at 2020-01-20 21:18:34

Resolution: fixed
