# Issue 16251: upgrade to IPython 2.1

Issue created by migration from Trac.

Original creator: was

Original creation time: 2014-06-17 01:53:49

Whoever does this -- this is the patch you'll need to get around the deprecation warning (which is the ONLY doctest failure):


```
diff --git a/src/sage/repl/ipython_extension.py b/src/sage/repl/ipython_extension.py
index 3382aee..63864ff 100644
--- a/src/sage/repl/ipython_extension.py
+++ b/src/sage/repl/ipython_extension.py
`@``@` -332,10 +332,11 `@``@` class SageCustomizations(object):
         """
         Set the exit hook to cleanly exit Sage.
         """
-        def quit(shell):
+        def quit():
             import sage.all
             sage.all.quit_sage(self.shell.verbose_quit)
-        self.shell.set_hook('shutdown_hook', quit)
+        import atexit
+        atexit.register(quit)
 
     def init_environment(self):
         """
```



---

Comment by ohanar created at 2014-06-17 23:02:10

Changing status from new to needs_review.


---

Comment by ohanar created at 2014-06-17 23:02:10

New commits:


---

Comment by tmonteil created at 2014-06-18 15:28:23

On i686 architecture running Debian stable, with recent `zeromq` and `pyzmq` from #16455:

- playing by hand on various features works as expected
- `make ptestlong` pass without errors (but some MILP-related, due to a problem with CBC)

No custom patch anymore, everything looks good to me.

If someone wants to test on other archs, please do as well, otherwise i am okay for positive review.


---

Comment by ohanar created at 2014-06-18 22:52:59

Changing status from needs_review to positive_review.


---

Comment by ohanar created at 2014-06-18 22:52:59

I think that is good enough.


---

Comment by vbraun created at 2014-06-19 13:12:41

Resolution: fixed
