# Issue 22612: Heaviside in numerical resolutions

Issue created by migration from Trac.

Original creator: mforets

Original creation time: 2017-04-20 21:56:06

CC:  rws kcrisman egourgoulhon tscrim

Keywords: heaviside, integrate

- numerical ode:


```
sage: y = var('y')
sage: desolve_rk4(x,y,ics=[0,0],end_points=1,step=0.5) # solution is x^2/2
[[0, 0], [0.5, 0.125], [1.0, 0.4999999999999999]]
sage: desolve_rk4(x*unit_step(1+x),y,ics=[0,0],end_points=1,step=0.5) # OK
[[0, 0], [0.5, 0.125], [1.0, 0.4999999999999999]]
sage: desolve_rk4(x*heaviside(1+x),y,ics=[0,0],end_points=1,step=0.5) # ??
[This is the Trac macro *0, 0* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#0, 0-macro)
```


- integration: 


```
sage: integral(unit_step(x), (x, 0, 1))
1
sage: integral(heaviside(x), (x, 0, 1)) # ??
integrate(heaviside(x), x, 0, 1)
```


- custom numerical value at 0:


```
sage: heaviside(0)
heaviside(0)
sage: f(x) = heaviside(x, 1/2); f(0)  # new 2nd argument (?)
1
```



---

Comment by rws created at 2017-04-21 05:52:01


```
sage: desolve_rk4(x*unit_step(1+x),y,ics=[0,0],end_points=1,step=0.5) # OK
[[0, 0], [0.5, 0.125], [1.0, 0.4999999999999999]]
sage: desolve_rk4(x*heaviside(1+x),y,ics=[0,0],end_points=1,step=0.5) # ??
[This is the Trac macro *0, 0* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#0, 0-macro)
```

This is due to Maxima because with Maxima 5.38.1:

```
(%i3) rk(x*unit_step(x+1),y,0,[x,0,1,0.500000000000000]);
(%o3)               [[0.0, 0.0], [0.5, 0.125], [1.0, 0.5]]
(%i4) rk(x*hstep(x+1),y,0,[x,0,1,0.500000000000000]);
(%o4)                            [This is the Trac macro *0.0, 0.0* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#0.0, 0.0-macro)
```



---

Comment by rws created at 2017-04-21 06:00:18

I cannot even find online documentation on `hstep`, nor a mention of the Heaviside function. I don't think we can rely on Maxima having implemented it, so we cannot provide DE or integral services with it.


---

Comment by rws created at 2017-04-21 06:14:48

This is now #22850.
