# Issue 6741: Python Imaging Library interface

archive/issues_006741.json:
```json
{
    "body": "The attached patch implements several functions providing a simpler interface to the Python Imaging Library. For example, you can sharpen the image of an image on the internet you have the url of and save it to Sage's tmp subdirectory.\n\nApply:\n* [attachment:trac_6741-pil.patch\u200b]\n* [attachment:trac_6741_cleanup1.patch]\n\nAssignee: mabshoff\n\nWork_Issues: doc, font_manager\n\nBranch: u/chapoton/6741\n\nStatus: needs_work\n\nCommit: 3fd7a6efd69426e465a65f200971e073f4a71aaa\n\nIssue created by migration from https://trac.sagemath.org/ticket/6741\n\n",
    "created_at": "2009-08-13T23:15:11Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Python Imaging Library interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6741",
    "user": "https://github.com/wdjoyner"
}
```
The attached patch implements several functions providing a simpler interface to the Python Imaging Library. For example, you can sharpen the image of an image on the internet you have the url of and save it to Sage's tmp subdirectory.

Apply:
* [attachment:trac_6741-pil.patch​]
* [attachment:trac_6741_cleanup1.patch]

Assignee: mabshoff

Work_Issues: doc, font_manager

Branch: u/chapoton/6741

Status: needs_work

Commit: 3fd7a6efd69426e465a65f200971e073f4a71aaa

Issue created by migration from https://trac.sagemath.org/ticket/6741





---

archive/issue_comments_062686.json:
```json
{
    "body": "Attachment [trac_6741-pil.patch](tarball://root/attachments/some-uuid/ticket6741/trac_6741-pil.patch) by @wdjoyner created at 2009-08-13 23:20:20\n\nrequires pil-1.1.6, applies to 4.1.1.rc2",
    "created_at": "2009-08-13T23:20:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62686",
    "user": "https://github.com/wdjoyner"
}
```

Attachment [trac_6741-pil.patch](tarball://root/attachments/some-uuid/ticket6741/trac_6741-pil.patch) by @wdjoyner created at 2009-08-13 23:20:20

requires pil-1.1.6, applies to 4.1.1.rc2



---

archive/issue_comments_062687.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n The attached patch implements several functions providing a simpler interface to the Python Imaging Library. For example, you can sharpen the image of an image on the internet you have the url of and save it to Sage's tmp subdirectory.\n+\n+\n``````\n",
    "created_at": "2009-08-13T23:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62687",
    "user": "https://github.com/wdjoyner"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 The attached patch implements several functions providing a simpler interface to the Python Imaging Library. For example, you can sharpen the image of an image on the internet you have the url of and save it to Sage's tmp subdirectory.
+
+
``````




---

archive/issue_comments_062688.json:
```json
{
    "body": "Changing component from interfaces to packages.",
    "created_at": "2009-08-18T17:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62688",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing component from interfaces to packages.



---

archive/issue_comments_062689.json:
```json
{
    "body": "Changing assignee from @williamstein to mabshoff.",
    "created_at": "2009-08-18T17:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62689",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing assignee from @williamstein to mabshoff.



---

archive/issue_comments_062690.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/caac9691d6fb0160) thread has a discussion about making PIL a standard spkg. The vote for doing so was carried out in that thread.",
    "created_at": "2009-08-18T17:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62690",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:4'></a>
This [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/caac9691d6fb0160) thread has a discussion about making PIL a standard spkg. The vote for doing so was carried out in that thread.



---

archive/issue_comments_062691.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis looks very nice.  However, the doctests write to SAGE_ROOT/tmp, which means that a normal user cannot run doctests on this file.  Isn't there somewhere else that we should write temporary data during a doctest?  Maybe using SAGE_TMP or something like that?",
    "created_at": "2009-09-17T09:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62691",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:5'></a>
This looks very nice.  However, the doctests write to SAGE_ROOT/tmp, which means that a normal user cannot run doctests on this file.  Isn't there somewhere else that we should write temporary data during a doctest?  Maybe using SAGE_TMP or something like that?



---

archive/issue_comments_062692.json:
```json
{
    "body": "<a id='comment:6'></a>\nI guess there isn't a SAGE_TMP.  How about a temporary directory under .sage?",
    "created_at": "2009-09-17T09:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62692",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:6'></a>
I guess there isn't a SAGE_TMP.  How about a temporary directory under .sage?



---

archive/issue_comments_062693.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [jason](#comment%3A6):\n> I guess there isn't a SAGE_TMP.  How about a temporary directory under .sage?\n\nYes.",
    "created_at": "2009-09-17T10:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62693",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:7'></a>
Replying to [jason](#comment%3A6):
> I guess there isn't a SAGE_TMP.  How about a temporary directory under .sage?

Yes.



---

archive/issue_comments_062694.json:
```json
{
    "body": "<a id='comment:8'></a>\nNice work; thanks for doing this!\n\nMarking as \"needs work\" for the following reasons:\n\n* Doctests which rely on internet should be marked \"optional - requires internet\"\n* image_convert should probably let me specify an output file name, or by default write in the current directory so that we can use it easily in the notebook (e.g., we convert something and it magically appears in the cell output).\n* someone should test this on a mac and then remove the note about it not being tested on a mac\n* stylistically, it looks like there is lots of duplicated code that opens files from the internet; maybe this could be refactored into a single function (and then used for image_convert as well)?",
    "created_at": "2009-09-22T15:21:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62694",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:8'></a>
Nice work; thanks for doing this!

Marking as "needs work" for the following reasons:

* Doctests which rely on internet should be marked "optional - requires internet"
* image_convert should probably let me specify an output file name, or by default write in the current directory so that we can use it easily in the notebook (e.g., we convert something and it magically appears in the cell output).
* someone should test this on a mac and then remove the note about it not being tested on a mac
* stylistically, it looks like there is lots of duplicated code that opens files from the internet; maybe this could be refactored into a single function (and then used for image_convert as well)?



---

archive/issue_comments_062695.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2010-01-04T03:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62695",
    "user": "https://github.com/wdjoyner"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_comments_062696.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [jason](#comment%3A8):\n> Nice work; thanks for doing this!\n> \n> Marking as \"needs work\" for the following reasons:\n> \n\n\nArrgghh ...\nJust saw this now, going through old emails.\n\nI will try to work on these referee comments/suggestions now. It probably needs rebasing anyway.\nSorry for the late reply.",
    "created_at": "2010-01-04T03:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62696",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:9'></a>
Replying to [jason](#comment%3A8):
> Nice work; thanks for doing this!
> 
> Marking as "needs work" for the following reasons:
> 


Arrgghh ...
Just saw this now, going through old emails.

I will try to work on these referee comments/suggestions now. It probably needs rebasing anyway.
Sorry for the late reply.



---

archive/issue_comments_062697.json:
```json
{
    "body": "<a id='comment:10'></a>\nGood news: it applies fine and does not need rebasing.\n\nBad news: Now I can't even get the code to work. I've tried on an imac (which requires some extra work to get libjpeg to install) and on an ubuntu machine. Probably I'm missing something obvious, but I don't know what it is.",
    "created_at": "2010-01-08T12:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62697",
    "user": "https://github.com/wdjoyner"
}
```

<a id='comment:10'></a>
Good news: it applies fine and does not need rebasing.

Bad news: Now I can't even get the code to work. I've tried on an imac (which requires some extra work to get libjpeg to install) and on an ubuntu machine. Probably I'm missing something obvious, but I don't know what it is.



---

archive/issue_events_015898.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6741#event-15898"
}
```



---

archive/issue_comments_062698.json:
```json
{
    "body": "<a id='comment:12'></a>\nAttachment [trac_6741_cleanup1.patch](tarball://root/attachments/some-uuid/ticket6741/trac_6741_cleanup1.patch) by @fchapoton created at 2013-08-22 20:11:42\n\nok, here is a cleanup patch.\n\nThere is an issue with fontmanager that I do not understand",
    "created_at": "2013-08-22T20:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62698",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>
Attachment [trac_6741_cleanup1.patch](tarball://root/attachments/some-uuid/ticket6741/trac_6741_cleanup1.patch) by @fchapoton created at 2013-08-22 20:11:42

ok, here is a cleanup patch.

There is an issue with fontmanager that I do not understand



---

archive/issue_comments_062699.json:
```json
{
    "body": "Changing work_issues from \"\" to \"doc, font_manager\"",
    "created_at": "2013-08-22T20:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62699",
    "user": "https://github.com/fchapoton"
}
```

Changing work_issues from "" to "doc, font_manager"



---

archive/issue_comments_062700.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n The attached patch implements several functions providing a simpler interface to the Python Imaging Library. For example, you can sharpen the image of an image on the internet you have the url of and save it to Sage's tmp subdirectory.\n \n-\n+Apply:\n+* [attachment:trac_6741-pil.patch\u200b]\n+* [attachment:trac_6741_cleanup1.patch]\n``````\n",
    "created_at": "2013-08-22T20:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62700",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 The attached patch implements several functions providing a simpler interface to the Python Imaging Library. For example, you can sharpen the image of an image on the internet you have the url of and save it to Sage's tmp subdirectory.
 
-
+Apply:
+* [attachment:trac_6741-pil.patch​]
+* [attachment:trac_6741_cleanup1.patch]
``````




---

archive/issue_comments_062701.json:
```json
{
    "body": "<a id='comment:14'></a>\nCan one mark in some way the tests that depends on the presence of libpeg ?\n\nSomething like # optional libjpeg ?",
    "created_at": "2013-08-31T14:46:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62701",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>
Can one mark in some way the tests that depends on the presence of libpeg ?

Something like # optional libjpeg ?



---

archive/issue_comments_062702.json:
```json
{
    "body": "Changing commit from \"\" to \"fea091d10f0203e7d3c682a11f2508b4848f554f\"",
    "created_at": "2014-01-08T09:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62702",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "fea091d10f0203e7d3c682a11f2508b4848f554f"



---

archive/issue_comments_062703.json:
```json
{
    "body": "<a id='comment:15'></a>\nNew commits:\n|                                                                                                                                          |                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|\n|[9ec5654](http://git.sagemath.org/sage.git/commit/?id=9ec56541c6deeb2e5b3f2e1c35165e745de14f0b)|`added pil.pi - wdj:wq`|\n|[831223d](http://git.sagemath.org/sage.git/commit/?id=831223dba958bac73d20e501d607aa68d9867f77)|`trac_6741_cleanup1.patch`|\n|[fea091d](http://git.sagemath.org/sage.git/commit/?id=fea091d10f0203e7d3c682a11f2508b4848f554f)|`trac #6741 whitespace cleanup`|",
    "created_at": "2014-01-08T09:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62703",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>
New commits:
|                                                                                                                                          |                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------|
|[9ec5654](http://git.sagemath.org/sage.git/commit/?id=9ec56541c6deeb2e5b3f2e1c35165e745de14f0b)|`added pil.pi - wdj:wq`|
|[831223d](http://git.sagemath.org/sage.git/commit/?id=831223dba958bac73d20e501d607aa68d9867f77)|`trac_6741_cleanup1.patch`|
|[fea091d](http://git.sagemath.org/sage.git/commit/?id=fea091d10f0203e7d3c682a11f2508b4848f554f)|`trac #6741 whitespace cleanup`|



---

archive/issue_comments_062704.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/6741\"",
    "created_at": "2014-01-08T09:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62704",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/6741"



---

archive/issue_events_015899.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6741#event-15899"
}
```



---

archive/issue_events_015900.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6741#event-15900"
}
```



---

archive/issue_events_015901.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6741#event-15901"
}
```



---

archive/issue_events_015902.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6741#event-15902"
}
```



---

archive/issue_events_015903.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6741#event-15903"
}
```



---

archive/issue_events_015904.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6741#event-15904"
}
```



---

archive/issue_comments_062705.json:
```json
{
    "body": "Changing commit from \"fea091d10f0203e7d3c682a11f2508b4848f554f\" to \"1348bb6fadd0ccd9b237ae14ce02876184b1e256\"",
    "created_at": "2016-05-19T12:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62705",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fea091d10f0203e7d3c682a11f2508b4848f554f" to "1348bb6fadd0ccd9b237ae14ce02876184b1e256"



---

archive/issue_comments_062706.json:
```json
{
    "body": "<a id='comment:19'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|\n|[af73aeb](http://git.sagemath.org/sage.git/commit/?id=af73aebcf95cb8e9e4416f77b21cff945d128e09)|`Merge branch 'u/chapoton/6741' into 7.2`|\n|[1348bb6](http://git.sagemath.org/sage.git/commit/?id=1348bb6fadd0ccd9b237ae14ce02876184b1e256)|`no print`|",
    "created_at": "2016-05-19T12:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62706",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
|[af73aeb](http://git.sagemath.org/sage.git/commit/?id=af73aebcf95cb8e9e4416f77b21cff945d128e09)|`Merge branch 'u/chapoton/6741' into 7.2`|
|[1348bb6](http://git.sagemath.org/sage.git/commit/?id=1348bb6fadd0ccd9b237ae14ce02876184b1e256)|`no print`|



---

archive/issue_comments_062707.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[3fd7a6e](https://git.sagemath.org/sage.git/commit/?id=3fd7a6efd69426e465a65f200971e073f4a71aaa)|`Merge branch 'u/chapoton/6741' in 7.3.rc0`|",
    "created_at": "2016-07-29T18:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62707",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[3fd7a6e](https://git.sagemath.org/sage.git/commit/?id=3fd7a6efd69426e465a65f200971e073f4a71aaa)|`Merge branch 'u/chapoton/6741' in 7.3.rc0`|



---

archive/issue_comments_062708.json:
```json
{
    "body": "Changing commit from \"1348bb6fadd0ccd9b237ae14ce02876184b1e256\" to \"3fd7a6efd69426e465a65f200971e073f4a71aaa\"",
    "created_at": "2016-07-29T18:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6741#issuecomment-62708",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1348bb6fadd0ccd9b237ae14ce02876184b1e256" to "3fd7a6efd69426e465a65f200971e073f4a71aaa"
