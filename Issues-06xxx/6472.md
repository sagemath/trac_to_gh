# Issue 6472: ideal.groebner_basis gives incorrect answers

archive/issues_006472.json:
```json
{
    "assignees": [],
    "body": "This is wrong:\n\n```\nsage: R.<a,b,c,d>=PolynomialRing(QQ,order=\"lex\")\nsage: ideal(a-b^16,b-c^16,c-d^1024).groebner_basis()\n[a - d^4096, b - d^16384, c - d^1024]\n```\n\nThe correct answer as given by Macaulay 2:\n\n```\ni30 : R=QQ[a,b,c,d, MonomialOrder=>Lex];\ni31 : I=ideal(a-b^16,b-c^16,c-d^1024);\ni32 : gens gb I\no32 = | c-d1024 b-d16384 a-d262144 |\n```\n\nIn particular the binomial involving a should raise d to the power 262144=2<sup>18</sup>, not 4096=2<sup>12</sup> as Sage reports.\n\nI suspect that the reason is that by default Sage uses Singular to implement groebner_basis, and Singular has limitations on the size of exponents. See https://www.singular.uni-kl.de/Manual/4-0-2/sing_455.htm which in particular says\n\n```\nthe maximal allowed exponent of a ring variable depends on the ordering of the ring\nand is at least 32767.\n```\n(I suppose \"least\" is a typo, should be \"most\"...)\n\n\nUpstream: **Reported upstream. Developers acknowledge bug.**\n\nStopgaps: **todo**\n\nComponent: **commutative algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6472_\n\n",
    "closed_at": "2018-08-14T17:30:02Z",
    "created_at": "2009-07-07T04:49:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20commutative%20algebra",
        "https://github.com/sagemath/sage/labels/worksforme"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "ideal.groebner_basis gives incorrect answers",
    "type": "issue",
    "updated_at": "2018-08-14T17:30:02Z",
    "url": "https://github.com/sagemath/sage/issues/6472",
    "user": "https://github.com/sagetrac-broune"
}
```
This is wrong:

```
sage: R.<a,b,c,d>=PolynomialRing(QQ,order="lex")
sage: ideal(a-b^16,b-c^16,c-d^1024).groebner_basis()
[a - d^4096, b - d^16384, c - d^1024]
```

The correct answer as given by Macaulay 2:

```
i30 : R=QQ[a,b,c,d, MonomialOrder=>Lex];
i31 : I=ideal(a-b^16,b-c^16,c-d^1024);
i32 : gens gb I
o32 = | c-d1024 b-d16384 a-d262144 |
```

In particular the binomial involving a should raise d to the power 262144=2<sup>18</sup>, not 4096=2<sup>12</sup> as Sage reports.

I suspect that the reason is that by default Sage uses Singular to implement groebner_basis, and Singular has limitations on the size of exponents. See https://www.singular.uni-kl.de/Manual/4-0-2/sing_455.htm which in particular says

```
the maximal allowed exponent of a ring variable depends on the ordering of the ring
and is at least 32767.
```
(I suppose "least" is a typo, should be "most"...)


Upstream: **Reported upstream. Developers acknowledge bug.**

Stopgaps: **todo**

Component: **commutative algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/6472_





---

archive/issue_events_078132.json:
```json
{
    "actor": "https://github.com/sagetrac-broune",
    "created_at": "2009-07-07T04:49:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78132"
}
```



---

archive/issue_events_078133.json:
```json
{
    "actor": "https://github.com/sagetrac-broune",
    "created_at": "2009-07-07T04:49:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78133"
}
```



---

archive/issue_events_078134.json:
```json
{
    "actor": "https://github.com/sagetrac-broune",
    "created_at": "2009-07-07T04:49:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78134"
}
```



---

archive/issue_events_078135.json:
```json
{
    "actor": "https://github.com/sagetrac-broune",
    "created_at": "2009-07-07T04:49:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78135"
}
```



---

archive/issue_events_078136.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-07T18:59:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78136"
}
```



---

archive/issue_events_078137.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-07T18:59:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-4.1.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78137"
}
```



---

archive/issue_events_078138.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-11-15T13:15:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78138"
}
```



---

archive/issue_events_078139.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-11-15T13:15:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20commutative%20algebra",
    "label_color": "0000ff",
    "label_name": "c: commutative algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78139"
}
```



---

archive/issue_events_078140.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78140"
}
```



---

archive/issue_events_078141.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78141"
}
```



---

archive/issue_events_078142.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78142"
}
```



---

archive/issue_events_078143.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78143"
}
```



---

archive/issue_events_078144.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78144"
}
```



---

archive/issue_events_078145.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78145"
}
```



---

archive/issue_events_078146.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78146"
}
```



---

archive/issue_events_078147.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78147"
}
```



---

archive/issue_comments_044054.json:
```json
{
    "body": "Stopgaps: **todo**",
    "created_at": "2015-08-19T23:33:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44054",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

Stopgaps: **todo**



---

archive/issue_comments_044055.json:
```json
{
    "body": "Upstream: **Reported upstream. No feedback yet.**",
    "created_at": "2016-10-04T23:18:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44055",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

Upstream: **Reported upstream. No feedback yet.**



---

archive/issue_comments_044056.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nreported upstream:\n\nhttps://www.singular.uni-kl.de:8005/trac/ticket/774#ticket",
    "created_at": "2016-10-04T23:18:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44056",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

<div id="comment:8" align="right">comment:8</div>

reported upstream:

https://www.singular.uni-kl.de:8005/trac/ticket/774#ticket



---

archive/issue_comments_044057.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nanother funny example :\n\n```\nR.<b,c,d>=PolynomialRing(QQ,order=\"lex\")\nsage: ideal(b-c^64,c-d^1024).groebner_basis()\n```\n(wrong result and zero not shown)\n\n```\n[b - , c - d^1024]\n```",
    "created_at": "2016-10-04T23:50:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44057",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

<div id="comment:9" align="right">comment:9</div>

another funny example :

```
R.<b,c,d>=PolynomialRing(QQ,order="lex")
sage: ideal(b-c^64,c-d^1024).groebner_basis()
```
(wrong result and zero not shown)

```
[b - , c - d^1024]
```



---

archive/issue_comments_044058.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nDoes Singular simply return incorrect results, or it's rather a Sage interface bug?",
    "created_at": "2016-10-05T23:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44058",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

Does Singular simply return incorrect results, or it's rather a Sage interface bug?



---

archive/issue_comments_044059.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,9 +17,11 @@\n \n In particular the binomial involving a should raise d to the power 262144=2<sup>18</sup>, not 4096=2<sup>12</sup> as Sage reports.\n \n-I suspect that the reason is that by default Sage uses Singular to implement groebner_basis, and Singular has limitations on the size of exponents. See http://www.singular.uni-kl.de/Manual/latest/sing_343.htm#SEC384 which in particular says\n+I suspect that the reason is that by default Sage uses Singular to implement groebner_basis, and Singular has limitations on the size of exponents. See https://www.singular.uni-kl.de/Manual/4-0-2/sing_455.htm which in particular says\n \n ```\n-the maximal allowed exponent of a ring variable depends on the ordering of the ring and is at least 32767.\n+the maximal allowed exponent of a ring variable depends on the ordering of the ring\n+and is at least 32767.\n ```\n+(I suppose \"least\" is a typo, should be \"most\"...)\n \n``````\n",
    "created_at": "2016-10-05T23:49:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44059",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,9 +17,11 @@
 
 In particular the binomial involving a should raise d to the power 262144=2<sup>18</sup>, not 4096=2<sup>12</sup> as Sage reports.
 
-I suspect that the reason is that by default Sage uses Singular to implement groebner_basis, and Singular has limitations on the size of exponents. See http://www.singular.uni-kl.de/Manual/latest/sing_343.htm#SEC384 which in particular says
+I suspect that the reason is that by default Sage uses Singular to implement groebner_basis, and Singular has limitations on the size of exponents. See https://www.singular.uni-kl.de/Manual/4-0-2/sing_455.htm which in particular says
 
 ```
-the maximal allowed exponent of a ring variable depends on the ordering of the ring and is at least 32767.
+the maximal allowed exponent of a ring variable depends on the ordering of the ring
+and is at least 32767.
 ```
+(I suppose "least" is a typo, should be "most"...)
 
``````




---

archive/issue_comments_044060.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nfixed in https://github.com/Singular/Sources/commit/349e5e898aad7e735b03bda328f2741a7c36a092\n\nbroken again for 'groebner' with https://github.com/Singular/Sources/commit/17510a828cdc33aa541d40a9bbfb825b72812521",
    "created_at": "2016-10-06T22:57:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44060",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

<div id="comment:11" align="right">comment:11</div>

fixed in https://github.com/Singular/Sources/commit/349e5e898aad7e735b03bda328f2741a7c36a092

broken again for 'groebner' with https://github.com/Singular/Sources/commit/17510a828cdc33aa541d40a9bbfb825b72812521



---

archive/issue_comments_044061.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2016-10-06T22:57:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44061",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_events_078148.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-07-01T20:44:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78148"
}
```



---

archive/issue_comments_044062.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n\n```\nsage: R.<a,b,c,d>=PolynomialRing(QQ,order=\"lex\")\n....: \nsage: I = ideal(a-b^16,b-c^16,c-d^1024)\nsage: I.groebner_basis()\n   skipping text from `)` error at token `)`\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\nRuntimeError: Error raised calling singular function\n...\nRuntimeError: error in Singular function call 'groebner':\nexponent bound is 65535\nerror occurred in or before standard.lib::stdhilb line 381: `    i=interred(i);`\nleaving standard.lib::stdhilb\nleaving standard.lib::groebner\n```\n\nLooks good to me.",
    "created_at": "2018-07-01T20:44:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44062",
    "user": "https://github.com/simonbrandhorst"
}
```

<div id="comment:12" align="right">comment:12</div>


```
sage: R.<a,b,c,d>=PolynomialRing(QQ,order="lex")
....: 
sage: I = ideal(a-b^16,b-c^16,c-d^1024)
sage: I.groebner_basis()
   skipping text from `)` error at token `)`
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
RuntimeError: Error raised calling singular function
...
RuntimeError: error in Singular function call 'groebner':
exponent bound is 65535
error occurred in or before standard.lib::stdhilb line 381: `    i=interred(i);`
leaving standard.lib::stdhilb
leaving standard.lib::groebner
```

Looks good to me.



---

archive/issue_comments_044063.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThis \n\n```\n  skipping text from `)` error at token `)`\n```\nlooks ugly, but otherwise there seems nothing to fix here---unless nowadays Singular offers an option to have bigger exponents.",
    "created_at": "2018-07-01T20:51:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6472#issuecomment-44063",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">comment:13</div>

This 

```
  skipping text from `)` error at token `)`
```
looks ugly, but otherwise there seems nothing to fix here---unless nowadays Singular offers an option to have bigger exponents.



---

archive/issue_events_078149.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-07-01T20:51:11Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78149"
}
```



---

archive/issue_events_078150.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-07-01T20:51:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78150"
}
```



---

archive/issue_events_078151.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-07-01T20:51:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78151"
}
```



---

archive/issue_events_078152.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-14T17:30:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/worksforme",
    "label_color": "a6a6a6",
    "label_name": "worksforme",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78152"
}
```



---

archive/issue_events_078153.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-14T17:30:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78153"
}
```



---

archive/issue_events_078154.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2018-08-14T17:30:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6472",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6472#event-78154"
}
```
