# Issue 6642: problem with solve (from the tutorial)

archive/issues_006642.json:
```json
{
    "assignees": [],
    "body": "From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/85929d86accdf94d):\n\n```\n     sage: theta = var('theta')\n     sage: solve(cos(theta)==sin(theta))\n```\nshould produce\n\n```\n     [sin(theta) == cos(theta)]\n```\nbut instead it produces\n\n```\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/palmieri/.sage/temp/Macintosh.local/69786/_Users_palmieri__sage_init_sage_0.py in <module>()\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/symbolic/relation.pyc in solve(f, *args, **kwds)\n    478     \"\"\"\n    479     try:\n--> 480         return f.solve(*args,**kwds)\n    481     except AttributeError:\n    482         from sage.symbolic.ring import is_SymbolicVariable\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.solve (sage/symbolic/expression.cpp:21764)()\n\nTypeError: solve() takes at least 1 positional argument (0 given)\n```\nProviding a second argument 'theta' gives another error:\n\n```\n    sage: solve(cos(theta)==sin(theta), theta)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/palmieri/.sage/temp/Macintosh.local/69786/_Users_palmieri__sage_init_sage_0.py in <module>()\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/symbolic/relation.pyc in solve(f, *args, **kwds)\n    478     \"\"\"\n    479     try:\n--> 480         return f.solve(*args,**kwds)\n    481     except AttributeError:\n    482         from sage.symbolic.ring import is_SymbolicVariable\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.solve (sage/symbolic/expression.cpp:22291)()\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in __call__(self, *args, **kwds)\n   1380 \n   1381     def __call__(self, *args, **kwds):\n-> 1382         return self._obj.parent().function_call(self._name, [self._obj] + list(args), kwds)\n   1383 \n   1384     def help(self):\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in function_call(self, function, args, kwds)\n   1288                                        [s.name() for s in args],\n   1289                                        ['%s=%s'%(key,value.name()) for key, value in kwds.items()])\n-> 1290         return self.new(s)\n   1291 \n   1292     def _function_call_string(self, function, args, kwds):\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in new(self, code)\n   1084 \n   1085     def new(self, code):\n-> 1086         return self(code)\n   1087 \n   1088     ###################################################################\n\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in __call__(self, x, name)\n   1019 \n   1020         if isinstance(x, basestring):\n-> 1021             return cls(self, x, name=name)\n   1022         try:\n   1023             return self._coerce_from_special_method(x)\n\n/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in __init__(self, parent, value, is_name, name)\n   1423             except (TypeError, KeyboardInterrupt, RuntimeError, ValueError), x:\n   1424                 self._session_number = -1\n-> 1425                 raise TypeError, x\n   1426         self._session_number = parent._session_number\n   1427 \n\nTypeError: Error executing code in Maxima\nCODE:\nsage4 : to_poly_solve(sage0,sage3)$\nMaxima ERROR:\n\nNonalgebraic argument given to 'topoly'\n#0: to_poly_solve(e=cos(theta) = sin(theta),vars=theta)(topoly_solver.mac line 10)\n```\nThe first version of this -- `solve(cos(theta)==sin(theta))` -- is in the tutorial, and so presumably used to work.  \n\nSee #6572 for a related ticket which, among other things, tells doctesting to skip this test in the tutorial.  If the underlying problem is solved, the test in the tutorial should be restored, and of course a test should be put into the main Sage code illustrating that it now works.\n\n\nCC:  mvngu @jasongrout @burcin @robertwb\n\nReviewer: **John Palmieri**\n\nAuthor: **Karl-Dieter Crisman**\n\nMerged: **sage-4.2.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6642_\n\n",
    "closed_at": "2009-10-15T09:05:10Z",
    "created_at": "2009-07-27T17:13:55Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "problem with solve (from the tutorial)",
    "type": "issue",
    "updated_at": "2015-09-06T16:41:54Z",
    "url": "https://github.com/sagemath/sage/issues/6642",
    "user": "https://github.com/jhpalmieri"
}
```
From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/85929d86accdf94d):

```
     sage: theta = var('theta')
     sage: solve(cos(theta)==sin(theta))
```
should produce

```
     [sin(theta) == cos(theta)]
```
but instead it produces

```
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/palmieri/.sage/temp/Macintosh.local/69786/_Users_palmieri__sage_init_sage_0.py in <module>()

/Applications/sage/local/lib/python2.6/site-packages/sage/symbolic/relation.pyc in solve(f, *args, **kwds)
    478     """
    479     try:
--> 480         return f.solve(*args,**kwds)
    481     except AttributeError:
    482         from sage.symbolic.ring import is_SymbolicVariable

/Applications/sage/local/lib/python2.6/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.solve (sage/symbolic/expression.cpp:21764)()

TypeError: solve() takes at least 1 positional argument (0 given)
```
Providing a second argument 'theta' gives another error:

```
    sage: solve(cos(theta)==sin(theta), theta)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/palmieri/.sage/temp/Macintosh.local/69786/_Users_palmieri__sage_init_sage_0.py in <module>()

/Applications/sage/local/lib/python2.6/site-packages/sage/symbolic/relation.pyc in solve(f, *args, **kwds)
    478     """
    479     try:
--> 480         return f.solve(*args,**kwds)
    481     except AttributeError:
    482         from sage.symbolic.ring import is_SymbolicVariable

/Applications/sage/local/lib/python2.6/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.solve (sage/symbolic/expression.cpp:22291)()

/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in __call__(self, *args, **kwds)
   1380 
   1381     def __call__(self, *args, **kwds):
-> 1382         return self._obj.parent().function_call(self._name, [self._obj] + list(args), kwds)
   1383 
   1384     def help(self):

/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in function_call(self, function, args, kwds)
   1288                                        [s.name() for s in args],
   1289                                        ['%s=%s'%(key,value.name()) for key, value in kwds.items()])
-> 1290         return self.new(s)
   1291 
   1292     def _function_call_string(self, function, args, kwds):

/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in new(self, code)
   1084 
   1085     def new(self, code):
-> 1086         return self(code)
   1087 
   1088     ###################################################################


/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in __call__(self, x, name)
   1019 
   1020         if isinstance(x, basestring):
-> 1021             return cls(self, x, name=name)
   1022         try:
   1023             return self._coerce_from_special_method(x)

/Applications/sage/local/lib/python2.6/site-packages/sage/interfaces/expect.pyc in __init__(self, parent, value, is_name, name)
   1423             except (TypeError, KeyboardInterrupt, RuntimeError, ValueError), x:
   1424                 self._session_number = -1
-> 1425                 raise TypeError, x
   1426         self._session_number = parent._session_number
   1427 

TypeError: Error executing code in Maxima
CODE:
sage4 : to_poly_solve(sage0,sage3)$
Maxima ERROR:

Nonalgebraic argument given to 'topoly'
#0: to_poly_solve(e=cos(theta) = sin(theta),vars=theta)(topoly_solver.mac line 10)
```
The first version of this -- `solve(cos(theta)==sin(theta))` -- is in the tutorial, and so presumably used to work.  

See #6572 for a related ticket which, among other things, tells doctesting to skip this test in the tutorial.  If the underlying problem is solved, the test in the tutorial should be restored, and of course a test should be put into the main Sage code illustrating that it now works.


CC:  mvngu @jasongrout @burcin @robertwb

Reviewer: **John Palmieri**

Author: **Karl-Dieter Crisman**

Merged: **sage-4.2.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/6642_





---

archive/issue_events_070682.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-07-27T17:13:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "milestone_number": null,
    "milestone_title": "sage-4.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70682"
}
```



---

archive/issue_events_070683.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-07-27T17:13:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "component: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70683"
}
```



---

archive/issue_events_070684.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-07-27T17:13:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70684"
}
```



---

archive/issue_events_070685.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-07-27T17:13:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70685"
}
```



---

archive/issue_events_070686.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-07-27T17:13:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70686"
}
```



---

archive/issue_comments_047866.json:
```json
{
    "body": "Attachment: **[trac_6642-solve-implicit-Maxima.patch.gz](https://github.com/sagemath/sage/files/ticket6642/trac_6642-solve-implicit-Maxima.patch.gz)**\n\nBased on 4.1.1",
    "created_at": "2009-08-26T21:19:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47866",
    "user": "https://github.com/kcrisman"
}
```

Attachment: **[trac_6642-solve-implicit-Maxima.patch.gz](https://github.com/sagemath/sage/files/ticket6642/trac_6642-solve-implicit-Maxima.patch.gz)**

Based on 4.1.1



---

archive/issue_events_070687.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-08-26T21:21:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70687"
}
```



---

archive/issue_events_070688.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-08-26T21:21:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70688"
}
```



---

archive/issue_comments_047867.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nThis should fix the problem.  The behavior of explicit_solutions has been clarified a bit, and should pass doctests in sage/calculus and sage/symbolic.  Please test thoroughly, though, as whenever one uses a black box (here, Maxima) there is potential for trouble!",
    "created_at": "2009-08-26T21:21:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47867",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:1'>Comment 1:</a>
This should fix the problem.  The behavior of explicit_solutions has been clarified a bit, and should pass doctests in sage/calculus and sage/symbolic.  Please test thoroughly, though, as whenever one uses a black box (here, Maxima) there is potential for trouble!



---

archive/issue_comments_047868.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nIn 4.1.2.alpha1, I'm getting something odd when I don't specify `explicit_solutions`:\n\n```\nsage: solve(sin(x) == cos(x), x, explicit_solutions=False)\n[sin(x) == cos(x)]\nsage: solve(sin(x) == cos(x), x, explicit_solutions=True)\n[]\nsage: solve(sin(x) == cos(x), x)\n[x == r2, x == r1]\n```\nI think at least two changes are in order, if I understand the code right: first, change the default value for explicit_solutions from \"None\" to \"False\".  As it stands, in the \"if\" block that starts with the line\n\n```\nif explicit_solutions is not False:\n```\nthe code is executed if explicit_solutions is None or True, but not if it's False.  I suppose this line could be changed to\n\n```\nif bool(explicit_solutions) is not False:\n```\nSecond, several comments (\"We only reach this if explicit_solutions is None\", \"This is fine because explicit_solutions is None\") may need to be changed to reflect this.\n\nOf course, I could be misunderstanding everything, and we want \"False\", \"True\", and \"None\" to each behave differently.  If so, this needs to be documented; for example, \"explicit_solutions\" is not a bool in this case.",
    "created_at": "2009-09-08T20:32:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47868",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'>Comment 2:</a>
In 4.1.2.alpha1, I'm getting something odd when I don't specify `explicit_solutions`:

```
sage: solve(sin(x) == cos(x), x, explicit_solutions=False)
[sin(x) == cos(x)]
sage: solve(sin(x) == cos(x), x, explicit_solutions=True)
[]
sage: solve(sin(x) == cos(x), x)
[x == r2, x == r1]
```
I think at least two changes are in order, if I understand the code right: first, change the default value for explicit_solutions from "None" to "False".  As it stands, in the "if" block that starts with the line

```
if explicit_solutions is not False:
```
the code is executed if explicit_solutions is None or True, but not if it's False.  I suppose this line could be changed to

```
if bool(explicit_solutions) is not False:
```
Second, several comments ("We only reach this if explicit_solutions is None", "This is fine because explicit_solutions is None") may need to be changed to reflect this.

Of course, I could be misunderstanding everything, and we want "False", "True", and "None" to each behave differently.  If so, this needs to be documented; for example, "explicit_solutions" is not a bool in this case.



---

archive/issue_events_070689.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-09-08T20:32:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70689"
}
```



---

archive/issue_events_070690.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-09-08T20:32:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70690"
}
```



---

archive/issue_comments_047869.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nHold up; this seems to be related to the new Maxima .spkg, actually - has nothing to do with the patch.  Perhaps they are interpreting something as a symbol which isn't?  Stay tuned.",
    "created_at": "2009-09-09T01:11:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47869",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'>Comment 3:</a>
Hold up; this seems to be related to the new Maxima .spkg, actually - has nothing to do with the patch.  Perhaps they are interpreting something as a symbol which isn't?  Stay tuned.



---

archive/issue_comments_047870.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nYeah, to_poly_solve has changed significantly - namely, it actually tries to solve these guys, so the TypeError is no longer raised.  But the way it tries to solve them seems to be a little unintelligible to Sage - even the Maxima documentation examples don't seem to come out the same way.  This will take some effort to figure out.  \n\nOne should check whether these errors show up without the patch.  Also, note that to_poly and to_poly_solve are experimental packages!  So whoever put it in was already playing with fire to some extent, though it is quite useful.",
    "created_at": "2009-09-09T02:08:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47870",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'>Comment 4:</a>
Yeah, to_poly_solve has changed significantly - namely, it actually tries to solve these guys, so the TypeError is no longer raised.  But the way it tries to solve them seems to be a little unintelligible to Sage - even the Maxima documentation examples don't seem to come out the same way.  This will take some effort to figure out.  

One should check whether these errors show up without the patch.  Also, note that to_poly and to_poly_solve are experimental packages!  So whoever put it in was already playing with fire to some extent, though it is quite useful.



---

archive/issue_comments_047871.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nOkay, that's progress: at least we (meaning you) understand what the problem is.  However, if it's intentional that False and None should behave differently (as the code is currently written), then this should be documented and there should be doctests for it.",
    "created_at": "2009-09-09T05:15:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47871",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:5'>Comment 5:</a>
Okay, that's progress: at least we (meaning you) understand what the problem is.  However, if it's intentional that False and None should behave differently (as the code is currently written), then this should be documented and there should be doctests for it.



---

archive/issue_comments_047872.json:
```json
{
    "body": "Attachment: **[trac_6642-to-poly-solve-take2.patch.gz](https://github.com/sagemath/sage/files/ticket6642/trac_6642-to-poly-solve-take2.patch.gz)**\n\nDepends on #4786",
    "created_at": "2009-09-20T02:03:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47872",
    "user": "https://github.com/kcrisman"
}
```

Attachment: **[trac_6642-to-poly-solve-take2.patch.gz](https://github.com/sagemath/sage/files/ticket6642/trac_6642-to-poly-solve-take2.patch.gz)**

Depends on #4786



---

archive/issue_events_070691.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-09-20T02:11:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70691"
}
```



---

archive/issue_events_070692.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-09-20T02:11:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70692"
}
```



---

archive/issue_comments_047873.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nOkay, this is ready for review.  I expect that there will be some problems somewhere, but it has to get out there to be tested.  There is the possibility of it not applying properly if some of the other symbolic patches post-4.1.1.alpha1 have been merged, but I don't think they have been yet.  See also discussion at [http://groups.google.com/group/sage-devel/browse_thread/thread/e797a9904baaa4a6](http://groups.google.com/group/sage-devel/browse_thread/thread/e797a9904baaa4a6).  Note I have not done the solve_numerical=find_root, as that is probably for a different ticket.\n\nAlso, there is one doctest I am currently not testing.  It is fixed in the CVS version of Maxima, but I have absolutely no idea how to make a new .spkg, nor even really to build Maxima from scratch since I can't get cmucl to work on my computer (not to mention that the just-updated Maxima package is currently a little dicey because of Solaris and OSX build issues) so probably one would open a new ticket to fix that again with a new .spkg.",
    "created_at": "2009-09-20T02:11:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47873",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'>Comment 6:</a>
Okay, this is ready for review.  I expect that there will be some problems somewhere, but it has to get out there to be tested.  There is the possibility of it not applying properly if some of the other symbolic patches post-4.1.1.alpha1 have been merged, but I don't think they have been yet.  See also discussion at [http://groups.google.com/group/sage-devel/browse_thread/thread/e797a9904baaa4a6](http://groups.google.com/group/sage-devel/browse_thread/thread/e797a9904baaa4a6).  Note I have not done the solve_numerical=find_root, as that is probably for a different ticket.

Also, there is one doctest I am currently not testing.  It is fixed in the CVS version of Maxima, but I have absolutely no idea how to make a new .spkg, nor even really to build Maxima from scratch since I can't get cmucl to work on my computer (not to mention that the just-updated Maxima package is currently a little dicey because of Solaris and OSX build issues) so probably one would open a new ticket to fix that again with a new .spkg.



---

archive/issue_events_070693.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-10-05T20:18:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70693"
}
```



---

archive/issue_events_070694.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-10-05T20:18:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70694"
}
```



---

archive/issue_comments_047874.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nThis seems to fix the issue with the tutorial.  On the other hand, on sage.math, I'm getting a doctest failure:\n\n```\nsage -t -long \"devel/sage/sage/rings/number_field/number_field_element.pyx\"\n**********************************************************************\nFile \"/scratch/palmieri/sage-4.1.2.rc0-sage.math.washington.edu-x86_64-Linux/devel/sage/sage/rings/number_field/number_field_element.pyx\", line 1421:\n    sage: SR(a)\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/palmieri/sage-4.1.2.rc0-sage.math.washington.edu-x86_64-Linux/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/palmieri/sage-4.1.2.rc0-sage.math.washington.edu-x86_64-Linux/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/scratch/palmieri/sage-4.1.2.rc0-sage.math.washington.edu-x86_64-Linux/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_40[20]>\", line 1, in <module>\n        SR(a)###line 1421:\n    sage: SR(a)\n      File \"parent.pyx\", line 323, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:4174)\n      File \"coerce_maps.pyx\", line 156, in sage.structure.coerce_maps.NamedConvertMap._call_ (sage/structure/coerce_maps.c:4067)\n      File \"number_field_element.pyx\", line 1468, in sage.rings.number_field.number_field_element.NumberFieldElement._symbolic_ (sage/rings/number_field/number_field_element.cpp:11860)\n    TypeError: Unable to solve by radicals.\n```",
    "created_at": "2009-10-05T20:18:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47874",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'>Comment 7:</a>
This seems to fix the issue with the tutorial.  On the other hand, on sage.math, I'm getting a doctest failure:

```
sage -t -long "devel/sage/sage/rings/number_field/number_field_element.pyx"
**********************************************************************
File "/scratch/palmieri/sage-4.1.2.rc0-sage.math.washington.edu-x86_64-Linux/devel/sage/sage/rings/number_field/number_field_element.pyx", line 1421:
    sage: SR(a)
Exception raised:
    Traceback (most recent call last):
      File "/scratch/palmieri/sage-4.1.2.rc0-sage.math.washington.edu-x86_64-Linux/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/palmieri/sage-4.1.2.rc0-sage.math.washington.edu-x86_64-Linux/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/scratch/palmieri/sage-4.1.2.rc0-sage.math.washington.edu-x86_64-Linux/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_40[20]>", line 1, in <module>
        SR(a)###line 1421:
    sage: SR(a)
      File "parent.pyx", line 323, in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:4174)
      File "coerce_maps.pyx", line 156, in sage.structure.coerce_maps.NamedConvertMap._call_ (sage/structure/coerce_maps.c:4067)
      File "number_field_element.pyx", line 1468, in sage.rings.number_field.number_field_element.NumberFieldElement._symbolic_ (sage/rings/number_field/number_field_element.cpp:11860)
    TypeError: Unable to solve by radicals.
```



---

archive/issue_comments_047875.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nWell, here I need to know from someone what the intended behavior of `_symbolic_` is for algebraic number field elements.  Do they want an approximation or not?  Because right now it's not clear that the TypeError of unable to solve by radicals is ever going to show up, yet that would seem to be the appropriate response to this.  \n\nIf an approximation is still desired, it's easy to pass to_poly_solve=True in at line 1464 of number_field_element.pyx, but if not, then the doctest can just be changed, so either way the solution is easy.  I don't feel authorized to make changes like that in code I don't use on a daily basis, though; perhaps the numerical approximation is actually quite useful, though I have to say to me it sort of undermines the spirit of the rest of the method, where CC is used to get numerical approximations of radical solutions. \n\n(This is a place where Jason's idea of \"needs info\" would be really helpful.)",
    "created_at": "2009-10-05T20:39:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47875",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'>Comment 8:</a>
Well, here I need to know from someone what the intended behavior of `_symbolic_` is for algebraic number field elements.  Do they want an approximation or not?  Because right now it's not clear that the TypeError of unable to solve by radicals is ever going to show up, yet that would seem to be the appropriate response to this.  

If an approximation is still desired, it's easy to pass to_poly_solve=True in at line 1464 of number_field_element.pyx, but if not, then the doctest can just be changed, so either way the solution is easy.  I don't feel authorized to make changes like that in code I don't use on a daily basis, though; perhaps the numerical approximation is actually quite useful, though I have to say to me it sort of undermines the spirit of the rest of the method, where CC is used to get numerical approximations of radical solutions. 

(This is a place where Jason's idea of "needs info" would be really helpful.)



---

archive/issue_comments_047876.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nWell, it does say right before the doctest (lines 1416-1418 of number_field_element.pyx)\n\n```\n        For degree greater than 5, sometimes Galois theory prevents a\n        closed-form solution.  In this case, a numerical approximation\n        is used::\n```\nGiven this and the output of the doctest (-1.1673040153), I think numerical approximation is the way to go.  Do you want to make a new patch with this change (and also fixing the \"approximtae\" typo that you pointed out)?  I think that it can be given a positive review if it passes all doctests.",
    "created_at": "2009-10-08T02:21:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47876",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'>Comment 9:</a>
Well, it does say right before the doctest (lines 1416-1418 of number_field_element.pyx)

```
        For degree greater than 5, sometimes Galois theory prevents a
        closed-form solution.  In this case, a numerical approximation
        is used::
```
Given this and the output of the doctest (-1.1673040153), I think numerical approximation is the way to go.  Do you want to make a new patch with this change (and also fixing the "approximtae" typo that you pointed out)?  I think that it can be given a positive review if it passes all doctests.



---

archive/issue_comments_047877.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\n> Do you want to make a new patch \n\nSorry, this is silly.  I'll make a referee's patch since you already said exactly what to do.  I'm running doctests now, and if all goes well, I'll post the referee's patch and a positive review.",
    "created_at": "2009-10-08T03:25:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47877",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'>Comment 10:</a>
> Do you want to make a new patch 

Sorry, this is silly.  I'll make a referee's patch since you already said exactly what to do.  I'm running doctests now, and if all goes well, I'll post the referee's patch and a positive review.



---

archive/issue_comments_047878.json:
```json
{
    "body": "Attachment: **[trac_6642-to-poly-solve-take3.patch.gz](https://github.com/sagemath/sage/files/ticket6642/trac_6642-to-poly-solve-take3.patch.gz)**\n\nBased on 4.1.2.rc1.alpha3",
    "created_at": "2009-10-08T03:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47878",
    "user": "https://github.com/kcrisman"
}
```

Attachment: **[trac_6642-to-poly-solve-take3.patch.gz](https://github.com/sagemath/sage/files/ticket6642/trac_6642-to-poly-solve-take3.patch.gz)**

Based on 4.1.2.rc1.alpha3



---

archive/issue_events_070695.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-10-08T03:57:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70695"
}
```



---

archive/issue_events_070696.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-10-08T03:57:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70696"
}
```



---

archive/issue_comments_047879.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nSorry, I was away from the computer when you posted that last comment, and made a new patch already.  I assume that this patch will do the same thing you were about to do. However, it does fix a doctest issue in calculus/calculus.py (a numerical integral), so perhaps it will save you a little trouble if I post this.  The issue may also be platform-dependent, so maybe it helped discover something good - you can use ... to comment the last digit out if that's what it turns out to be.\n\nIncidentally, my initial thought was that the 1416ff. lines were an overzealous doctester earlier, after to_poly_solve was first incorporated.  But someone else can change that if that's not the desired behavior.",
    "created_at": "2009-10-08T03:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47879",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'>Comment 11:</a>
Sorry, I was away from the computer when you posted that last comment, and made a new patch already.  I assume that this patch will do the same thing you were about to do. However, it does fix a doctest issue in calculus/calculus.py (a numerical integral), so perhaps it will save you a little trouble if I post this.  The issue may also be platform-dependent, so maybe it helped discover something good - you can use ... to comment the last digit out if that's what it turns out to be.

Incidentally, my initial thought was that the 1416ff. lines were an overzealous doctester earlier, after to_poly_solve was first incorporated.  But someone else can change that if that's not the desired behavior.



---

archive/issue_comments_047880.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nOkay, I checked on a Intel and it IS plaform-dependent.  So here's the real patch.  Sorry for the confusion, jhpalmieri - you've been very helpful.",
    "created_at": "2009-10-08T13:46:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47880",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'>Comment 12:</a>
Okay, I checked on a Intel and it IS plaform-dependent.  So here's the real patch.  Sorry for the confusion, jhpalmieri - you've been very helpful.



---

archive/issue_comments_047881.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nSorry, use last patch, I keep on forgetting to click \"replace\".",
    "created_at": "2009-10-08T13:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47881",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'>Comment 13:</a>
Sorry, use last patch, I keep on forgetting to click "replace".



---

archive/issue_comments_047882.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nI came to the same conclusion.  Now all tests pass.",
    "created_at": "2009-10-08T14:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47882",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'>Comment 14:</a>
I came to the same conclusion.  Now all tests pass.



---

archive/issue_comments_047883.json:
```json
{
    "body": "Author: **Karl-Dieter Crisman**",
    "created_at": "2009-10-08T14:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47883",
    "user": "https://github.com/jhpalmieri"
}
```

Author: **Karl-Dieter Crisman**



---

archive/issue_events_070697.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-10-08T14:55:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70697"
}
```



---

archive/issue_events_070698.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2009-10-08T14:55:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70698"
}
```



---

archive/issue_comments_047884.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2009-10-08T14:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47884",
    "user": "https://github.com/jhpalmieri"
}
```

Reviewer: **John Palmieri**



---

archive/issue_comments_047885.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nJust FYI, this will probably not get in before 4.1.2, and at #7112 William has already fixed the numerical noise issue.  So we'll probably have to remove it.  Sigh.",
    "created_at": "2009-10-08T16:01:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47885",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'>Comment 15:</a>
Just FYI, this will probably not get in before 4.1.2, and at #7112 William has already fixed the numerical noise issue.  So we'll probably have to remove it.  Sigh.



---

archive/issue_comments_047886.json:
```json
{
    "body": "Attachment: **[trac_6642-to-poly-solve-take3.2.patch.gz](https://github.com/sagemath/sage/files/ticket6642/trac_6642-to-poly-solve-take3.2.patch.gz)**\n\nBased on 4.1.2.rc1.alpha3",
    "created_at": "2009-10-14T20:07:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47886",
    "user": "https://github.com/kcrisman"
}
```

Attachment: **[trac_6642-to-poly-solve-take3.2.patch.gz](https://github.com/sagemath/sage/files/ticket6642/trac_6642-to-poly-solve-take3.2.patch.gz)**

Based on 4.1.2.rc1.alpha3



---

archive/issue_comments_047887.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nThis most recent one should hopefully apply well to 4.1.2 itself.  The only change was to remove a doctest fix that was already in #7112, so shouldn't disturb anything else.",
    "created_at": "2009-10-14T20:08:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47887",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:16'>Comment 16:</a>
This most recent one should hopefully apply well to 4.1.2 itself.  The only change was to remove a doctest fix that was already in #7112, so shouldn't disturb anything else.



---

archive/issue_events_070699.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2009-10-15T09:05:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70699"
}
```



---

archive/issue_events_070700.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2009-10-15T09:05:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6642#event-70700"
}
```



---

archive/issue_comments_047888.json:
```json
{
    "body": "Merged: **sage-4.2.alpha0**",
    "created_at": "2009-10-15T09:05:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47888",
    "user": "https://github.com/mwhansen"
}
```

Merged: **sage-4.2.alpha0**



---

archive/issue_comments_047889.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -84,9 +84,9 @@\n \n TypeError: Error executing code in Maxima\n CODE:\n-\tsage4 : to_poly_solve(sage0,sage3)$\n+sage4 : to_poly_solve(sage0,sage3)$\n Maxima ERROR:\n-\t\n+\n Nonalgebraic argument given to 'topoly'\n #0: to_poly_solve(e=cos(theta) = sin(theta),vars=theta)(topoly_solver.mac line 10)\n ```\n``````\n",
    "created_at": "2015-09-06T16:41:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6642",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6642#issuecomment-47889",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -84,9 +84,9 @@
 
 TypeError: Error executing code in Maxima
 CODE:
-	sage4 : to_poly_solve(sage0,sage3)$
+sage4 : to_poly_solve(sage0,sage3)$
 Maxima ERROR:
-	
+
 Nonalgebraic argument given to 'topoly'
 #0: to_poly_solve(e=cos(theta) = sin(theta),vars=theta)(topoly_solver.mac line 10)
 ```
``````

