# Issue 6554: plotting sparse matrices converts the matrix to a dense matrix

archive/issues_006554.json:
```json
{
    "assignees": [],
    "body": "Plotting big sparse matrices doesn't even work since it automatically converts the matrix to a dense matrix, instead of calling the spy() function.\n\nAssignee: **@williamstein**\n\nCC:  @rbeezer @mwhansen @williamstein @sagetrac-wcauchois @robertwb\n\nAuthor: **Jason Grout**\n\nReviewer: **David Joyner**\n\nMerged: **Sage 4.1.1.rc0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6554_\n\n",
    "closed_at": "2009-07-29T12:57:11Z",
    "created_at": "2009-07-18T14:00:55Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.1.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "plotting sparse matrices converts the matrix to a dense matrix",
    "type": "issue",
    "updated_at": "2009-07-29T12:57:11Z",
    "url": "https://github.com/sagemath/sage/issues/6554",
    "user": "https://github.com/jasongrout"
}
```
Plotting big sparse matrices doesn't even work since it automatically converts the matrix to a dense matrix, instead of calling the spy() function.

Assignee: **@williamstein**

CC:  @rbeezer @mwhansen @williamstein @sagetrac-wcauchois @robertwb

Author: **Jason Grout**

Reviewer: **David Joyner**

Merged: **Sage 4.1.1.rc0**

_Issue created by migration from https://trac.sagemath.org/ticket/6554_





---

archive/issue_events_071503.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-07-18T14:00:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "milestone_number": null,
    "milestone_title": "sage-4.1.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6554#event-71503"
}
```



---

archive/issue_events_071504.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-07-18T14:00:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6554#event-71504"
}
```



---

archive/issue_events_071505.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-07-18T14:00:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6554#event-71505"
}
```



---

archive/issue_events_071506.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-07-18T14:00:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6554#event-71506"
}
```



---

archive/issue_events_071507.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2009-07-18T14:00:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6554#event-71507"
}
```



---

archive/issue_comments_046762.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nAttachment: **[trac-6554-sparse-matrix-plot.patch.gz](https://github.com/sagemath/sage/files/ticket6554/trac-6554-sparse-matrix-plot.patch.gz)**\n\nThis took a very long time before, if it was even possible.\n\n```\n        sage: A=random_matrix(ZZ,100000,density=.00001,sparse=True)\n        sage: matrix_plot(A,marker=',')\n```",
    "created_at": "2009-07-18T14:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46762",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:1" align="right">Comment 1</div>

Attachment: **[trac-6554-sparse-matrix-plot.patch.gz](https://github.com/sagemath/sage/files/ticket6554/trac-6554-sparse-matrix-plot.patch.gz)**

This took a very long time before, if it was even possible.

```
        sage: A=random_matrix(ZZ,100000,density=.00001,sparse=True)
        sage: matrix_plot(A,marker=',')
```



---

archive/issue_comments_046763.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\n(To those I'm adding as CC): if you have time, could you review this ticket?  This is a simple change that makes plotting sparse matrices possible.  Currently, it is very, very slow or is not even really possible to plot large sparse matrices because Sage immediately converts the matrix to a dense matrix.",
    "created_at": "2009-07-21T17:06:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46763",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:2" align="right">Comment 2</div>

(To those I'm adding as CC): if you have time, could you review this ticket?  This is a simple change that makes plotting sparse matrices possible.  Currently, it is very, very slow or is not even really possible to plot large sparse matrices because Sage immediately converts the matrix to a dense matrix.



---

archive/issue_comments_046764.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nIt would be really great if this was reviewed in time for the Monday deadline for 4.1.1.  This is a simple change that makes plotting sparse matrices possible. Currently, it is very, very slow or is not even really possible to plot large sparse matrices because Sage immediately converts the matrix to a dense matrix.",
    "created_at": "2009-07-26T09:02:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46764",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:3" align="right">Comment 3</div>

It would be really great if this was reviewed in time for the Monday deadline for 4.1.1.  This is a simple change that makes plotting sparse matrices possible. Currently, it is very, very slow or is not even really possible to plot large sparse matrices because Sage immediately converts the matrix to a dense matrix.



---

archive/issue_comments_046765.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThis installs fine (amd64 ubuntu 9.04, sage 4.1.1.alpha0) and I'm running tests now. However, why is it that\n\n```\nsage: B = random_matrix(ZZ, 10, 20, density=.4, sparse=True, x = 10)\nsage: matrix_plot(B, cmap='hsv').show(axes=False)\n```\nreturns a ble-and white scatterplot, but\n\n```\nsage: C = random_matrix(ZZ, 10, 20, x = 10)\nsage: matrix_plot(C, cmap='hsv').show(axes=False)\n```\nreturns a multi-colored plot? The docstring indicates that the colors plotted\nindicate the relative difference in sizes between the matrix entries. This seems\nto be incorrect, unless I am missing something, in the sparse case. Should a \ncomment to this effect be added to the docstring?",
    "created_at": "2009-07-26T12:07:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46765",
    "user": "https://github.com/wdjoyner"
}
```

<div id="comment:4" align="right">Comment 4</div>

This installs fine (amd64 ubuntu 9.04, sage 4.1.1.alpha0) and I'm running tests now. However, why is it that

```
sage: B = random_matrix(ZZ, 10, 20, density=.4, sparse=True, x = 10)
sage: matrix_plot(B, cmap='hsv').show(axes=False)
```
returns a ble-and white scatterplot, but

```
sage: C = random_matrix(ZZ, 10, 20, x = 10)
sage: matrix_plot(C, cmap='hsv').show(axes=False)
```
returns a multi-colored plot? The docstring indicates that the colors plotted
indicate the relative difference in sizes between the matrix entries. This seems
to be incorrect, unless I am missing something, in the sparse case. Should a 
comment to this effect be added to the docstring?



---

archive/issue_comments_046766.json:
```json
{
    "body": "Attachment: **[trac-6554-matrix-plot-docs.patch.gz](https://github.com/sagemath/sage/files/ticket6554/trac-6554-matrix-plot-docs.patch.gz)**\n\napply on top of previous patch",
    "created_at": "2009-07-27T16:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46766",
    "user": "https://github.com/jasongrout"
}
```

Attachment: **[trac-6554-matrix-plot-docs.patch.gz](https://github.com/sagemath/sage/files/ticket6554/trac-6554-matrix-plot-docs.patch.gz)**

apply on top of previous patch



---

archive/issue_comments_046767.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nGood point; the docstring should be updated.  I've attached a small patch that updates the docstring.  Can you review this docstring change?",
    "created_at": "2009-07-27T16:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46767",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:5" align="right">Comment 5</div>

Good point; the docstring should be updated.  I've attached a small patch that updates the docstring.  Can you review this docstring change?



---

archive/issue_comments_046768.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nYes, looks good and passes sage -testall (intel macbook, OS 10.4.11) except for\n\n```\n        sage -t  \"devel/sage/sage/parallel/decorate.py\"\n        sage -t  \"devel/sage/sage/symbolic/expression.pyx\"\n```\nThey seem unrelated. As far as I am concerned, this gets a positive review.",
    "created_at": "2009-07-27T18:29:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46768",
    "user": "https://github.com/wdjoyner"
}
```

<div id="comment:6" align="right">Comment 6</div>

Yes, looks good and passes sage -testall (intel macbook, OS 10.4.11) except for

```
        sage -t  "devel/sage/sage/parallel/decorate.py"
        sage -t  "devel/sage/sage/symbolic/expression.pyx"
```
They seem unrelated. As far as I am concerned, this gets a positive review.



---

archive/issue_events_071508.json:
```json
{
    "actor": "https://github.com/wdjoyner",
    "created_at": "2009-07-27T18:29:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6554#event-71508"
}
```



---

archive/issue_events_071509.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2009-07-29T12:57:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6554#event-71509"
}
```



---

archive/issue_events_071510.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2009-07-29T12:57:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6554#event-71510"
}
```



---

archive/issue_comments_046769.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nMerged both patches.",
    "created_at": "2009-07-29T12:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46769",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:7" align="right">Comment 7</div>

Merged both patches.



---

archive/issue_comments_046770.json:
```json
{
    "body": "Reviewer: **David Joyner**",
    "created_at": "2009-07-29T12:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46770",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Reviewer: **David Joyner**



---

archive/issue_comments_046771.json:
```json
{
    "body": "Merged: **Sage 4.1.1.rc0**",
    "created_at": "2009-07-29T12:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6554",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6554#issuecomment-46771",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Merged: **Sage 4.1.1.rc0**
