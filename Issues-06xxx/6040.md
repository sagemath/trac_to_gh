# Issue 6040: Added Doctests for QuadraticForms methods

archive/issues_006040.json:
```json
{
    "assignees": [
        "https://github.com/RalphieBoy"
    ],
    "body": "Adding Doctests to bring coverage up to 100%.\n\nCC:  @sagetrac-mabshoff @williamstein @tornaria\n\nKeywords: **quadraticform**\n\nComponent: **quadratic forms**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6040_\n\n",
    "closed_at": "2009-05-19T00:41:25Z",
    "created_at": "2009-05-15T03:40:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20quadratic%20forms",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Added Doctests for QuadraticForms methods",
    "type": "issue",
    "updated_at": "2023-01-14T14:01:18Z",
    "url": "https://github.com/sagemath/sage/issues/6040",
    "user": "https://github.com/jonhanke"
}
```
Adding Doctests to bring coverage up to 100%.

CC:  @sagetrac-mabshoff @williamstein @tornaria

Keywords: **quadraticform**

Component: **quadratic forms**

_Issue created by migration from https://trac.sagemath.org/ticket/6040_





---

archive/issue_events_071873.json:
```json
{
    "actor": "https://github.com/jonhanke",
    "created_at": "2009-05-15T03:40:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "milestone_number": null,
    "milestone_title": "sage-4.0.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71873"
}
```



---

archive/issue_events_071874.json:
```json
{
    "actor": "https://github.com/jonhanke",
    "created_at": "2009-05-15T03:40:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20quadratic%20forms",
    "label_color": "0000ff",
    "label_name": "c: quadratic forms",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71874"
}
```



---

archive/issue_events_071875.json:
```json
{
    "actor": "https://github.com/jonhanke",
    "created_at": "2009-05-15T03:40:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71875"
}
```



---

archive/issue_events_071876.json:
```json
{
    "actor": "https://github.com/jonhanke",
    "created_at": "2009-05-15T03:40:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71876"
}
```



---

archive/issue_events_071877.json:
```json
{
    "actor": "https://github.com/RalphieBoy",
    "created_at": "2009-05-15T03:40:59Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "subject": "https://github.com/jonhanke",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71877"
}
```



---

archive/issue_comments_039516.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[patch-3__QF_misc_doctests__3.4.1.patch.gz](https://github.com/sagemath/sage/files/ticket6040/patch-3__QF_misc_doctests__3.4.1.patch.gz)**\n\nNote:  There are currently two broken doctests in this patch (using the older routine IsPadic Square()), which should resolve themselves once Cremona's patch (Ticket #5834) is applied.",
    "created_at": "2009-05-15T03:43:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39516",
    "user": "https://github.com/jonhanke"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[patch-3__QF_misc_doctests__3.4.1.patch.gz](https://github.com/sagemath/sage/files/ticket6040/patch-3__QF_misc_doctests__3.4.1.patch.gz)**

Note:  There are currently two broken doctests in this patch (using the older routine IsPadic Square()), which should resolve themselves once Cremona's patch (Ticket #5834) is applied.



---

archive/issue_events_071878.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-15T06:11:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71878"
}
```



---

archive/issue_comments_039517.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAdditional patch to bring QuadraticForm doctests to 100%.\n\nKnown Issues:\n    Several doctests fail because of the need for hilbert_symbol() to accept rational numbers, and similarly for IsPadicSquare().  These should be addressed by the changes made in Ticket #5834.",
    "created_at": "2009-05-15T11:15:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39517",
    "user": "https://github.com/jonhanke"
}
```

<div id="comment:3" align="right">comment:3</div>

Additional patch to bring QuadraticForm doctests to 100%.

Known Issues:
    Several doctests fail because of the need for hilbert_symbol() to accept rational numbers, and similarly for IsPadicSquare().  These should be addressed by the changes made in Ticket #5834.



---

archive/issue_comments_039518.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAttachment: **[patch-4__QF_more_doctests__3.4.1.patch.gz](https://github.com/sagemath/sage/files/ticket6040/patch-4__QF_more_doctests__3.4.1.patch.gz)**\n\nTogether with #5954 this brings coverage in the QF code to 100%.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-15T11:22:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39518",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:4" align="right">comment:4</div>

Attachment: **[patch-4__QF_more_doctests__3.4.1.patch.gz](https://github.com/sagemath/sage/files/ticket6040/patch-4__QF_more_doctests__3.4.1.patch.gz)**

Together with #5954 this brings coverage in the QF code to 100%.

Cheers,

Michael



---

archive/issue_comments_039519.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nAlso the patch in Ticket #6037 (rewrite and careful documentation of local density routines) is related to getting the doctest coverage to 100%.",
    "created_at": "2009-05-15T18:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39519",
    "user": "https://github.com/jonhanke"
}
```

<div id="comment:5" align="right">comment:5</div>

Also the patch in Ticket #6037 (rewrite and careful documentation of local density routines) is related to getting the doctest coverage to 100%.



---

archive/issue_comments_039520.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Adding Doctests to bring coverage up to 100% (coming soon).\n+Adding Doctests to bring coverage up to 100%.\n``````\n",
    "created_at": "2009-05-15T18:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39520",
    "user": "https://github.com/jonhanke"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-Adding Doctests to bring coverage up to 100% (coming soon).
+Adding Doctests to bring coverage up to 100%.
``````




---

archive/issue_comments_039521.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSo, it turns out there are 4 patches in this series, and they must be applied in order. In particular, patch-3 depends on patch-2, which is at #6037, but I misunderstood that.\nThe correct sequence is to apply patch-1 in #5954, then patch-2 in #6037, then patch-3 and patch-4 in this ticket.\n\nIf that order is followed, the patch sequence applies cleanly to 3.4.1 as well as 4.0.alpha0.",
    "created_at": "2009-05-17T21:48:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39521",
    "user": "https://github.com/tornaria"
}
```

<div id="comment:6" align="right">comment:6</div>

So, it turns out there are 4 patches in this series, and they must be applied in order. In particular, patch-3 depends on patch-2, which is at #6037, but I misunderstood that.
The correct sequence is to apply patch-1 in #5954, then patch-2 in #6037, then patch-3 and patch-4 in this ticket.

If that order is followed, the patch sequence applies cleanly to 3.4.1 as well as 4.0.alpha0.



---

archive/issue_comments_039522.json:
```json
{
    "body": "Attachment: **[patch-5__QF_reviewer__4.0.alpha0.patch.gz](https://github.com/sagemath/sage/files/ticket6040/patch-5__QF_reviewer__4.0.alpha0.patch.gz)**\n\nfix doctests for 4.0.alpha0",
    "created_at": "2009-05-18T05:46:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39522",
    "user": "https://github.com/tornaria"
}
```

Attachment: **[patch-5__QF_reviewer__4.0.alpha0.patch.gz](https://github.com/sagemath/sage/files/ticket6040/patch-5__QF_reviewer__4.0.alpha0.patch.gz)**

fix doctests for 4.0.alpha0



---

archive/issue_comments_039523.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSome doctests were broken on 4.0.alpha0 + patch-1 (#5954) + patch-2 (#6037) + patch-3 + patch-4.\n\nAll doctests pass for me when adding on top of that\n- [attachment: patch-5__QF_reviewer__4.0.alpha0.patch](https://github.com/sagemath/sage/files/ticket6040/patch-5__QF_reviewer__4.0.alpha0.patch.gz)\n- patch in #6059\n- patch in #6062\n- patch in #6064\n\nNote that the `patch-3__QF_misc_doctests__4.0.alpha0.patch` I uploaded earlier is a mistake, just ignore it.",
    "created_at": "2009-05-18T05:54:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39523",
    "user": "https://github.com/tornaria"
}
```

<div id="comment:7" align="right">comment:7</div>

Some doctests were broken on 4.0.alpha0 + patch-1 (#5954) + patch-2 (#6037) + patch-3 + patch-4.

All doctests pass for me when adding on top of that
- [attachment: patch-5__QF_reviewer__4.0.alpha0.patch](https://github.com/sagemath/sage/files/ticket6040/patch-5__QF_reviewer__4.0.alpha0.patch.gz)
- patch in #6059
- patch in #6062
- patch in #6064

Note that the `patch-3__QF_misc_doctests__4.0.alpha0.patch` I uploaded earlier is a mistake, just ignore it.



---

archive/issue_comments_039524.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nNote: the patch-5 also adds a few \"#long time\" comments to file `quadratic_form__local_representation_conditions.py`. Skipping these reduces the time for doctesting the whole file from 48 s to 20 s.",
    "created_at": "2009-05-18T05:59:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39524",
    "user": "https://github.com/tornaria"
}
```

<div id="comment:8" align="right">comment:8</div>

Note: the patch-5 also adds a few "#long time" comments to file `quadratic_form__local_representation_conditions.py`. Skipping these reduces the time for doctesting the whole file from 48 s to 20 s.



---

archive/issue_events_071879.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-18T23:57:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71879"
}
```



---

archive/issue_events_071880.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-18T23:57:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71880"
}
```



---

archive/issue_comments_039525.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAdd positive review due to Gonzalo.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-18T23:57:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39525",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:9" align="right">comment:9</div>

Add positive review due to Gonzalo.

Cheers,

Michael



---

archive/issue_comments_039526.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI'm ok with the positive review. I'll list the renamed/removed functions as for the other tickets, and I'll post a ticket to add compatibility functions with deprecation warnings.\n- `hanke_mass__maximal` was removed.\n- `GHY_mass_maximal` was renamed `GHY_mass__maximal`.\n- `conway_generic_mass` was removed.\n- `conway_p_mass_adjustment` was removed.\n- `local_diagonal` was removed.\n- `find_primitive_p_divisible_vector__all` was removed.",
    "created_at": "2009-05-19T00:37:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39526",
    "user": "https://github.com/tornaria"
}
```

<div id="comment:10" align="right">comment:10</div>

I'm ok with the positive review. I'll list the renamed/removed functions as for the other tickets, and I'll post a ticket to add compatibility functions with deprecation warnings.
- `hanke_mass__maximal` was removed.
- `GHY_mass_maximal` was renamed `GHY_mass__maximal`.
- `conway_generic_mass` was removed.
- `conway_p_mass_adjustment` was removed.
- `local_diagonal` was removed.
- `find_primitive_p_divisible_vector__all` was removed.



---

archive/issue_events_071881.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-19T00:41:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "milestone_number": null,
    "milestone_title": "sage-4.0.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71881"
}
```



---

archive/issue_events_071882.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-19T00:41:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "milestone_number": null,
    "milestone_title": "sage-4.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71882"
}
```



---

archive/issue_events_071883.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-19T00:41:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71883"
}
```



---

archive/issue_events_071884.json:
```json
{
    "actor": "https://github.com/sagetrac-mabshoff",
    "created_at": "2009-05-19T00:41:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6040#event-71884"
}
```



---

archive/issue_comments_039527.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nMerged in Sage 4.0.rc0.\n\nCheers,\n\nMichael",
    "created_at": "2009-05-19T00:41:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6040",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6040#issuecomment-39527",
    "user": "https://github.com/sagetrac-mabshoff"
}
```

<div id="comment:11" align="right">comment:11</div>

Merged in Sage 4.0.rc0.

Cheers,

Michael
