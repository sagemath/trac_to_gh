# Issue 6922: Matrix term ordering

archive/issues_006922.json:
```json
{
    "assignees": [],
    "body": "In Sage, I am trying to construct a polynomial ring with matrix\nordering. \n....\nAFAIK, it is not implemented, but I think that some people were\nworking on it.\n\nIt is in fact one of the things that I miss in Sage's polynomial rings\n(the other thing are supercommutative rings), so that I need to use\nthe Singular interface rather than libsingular. \n....\nAnyway it will be great that the matrix ordering is included in Sage\nnatively. \n\n**Assignee:** Somebody\n\n**CC:**  @novoselt\n\n**Keywords:** term order\n\n**Author:** Kwankyu Lee\n\n**Reviewer:** Martin Albrecht\n\n**Merged:** sage-4.5.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/6922\n\n",
    "closed_at": "2010-07-20T09:21:03Z",
    "created_at": "2009-09-11T04:47:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20basic%20arithmetic",
        "https://github.com/sagemath/sage/labels/minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.5.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Matrix term ordering",
    "type": "issue",
    "updated_at": "2010-07-20T09:21:03Z",
    "url": "https://github.com/sagemath/sage/issues/6922",
    "user": "https://github.com/kwankyu"
}
```
In Sage, I am trying to construct a polynomial ring with matrix
ordering. 
....
AFAIK, it is not implemented, but I think that some people were
working on it.

It is in fact one of the things that I miss in Sage's polynomial rings
(the other thing are supercommutative rings), so that I need to use
the Singular interface rather than libsingular. 
....
Anyway it will be great that the matrix ordering is included in Sage
natively. 

**Assignee:** Somebody

**CC:**  @novoselt

**Keywords:** term order

**Author:** Kwankyu Lee

**Reviewer:** Martin Albrecht

**Merged:** sage-4.5.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/6922





---

archive/issue_events_069890.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2009-09-11T04:47:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "milestone_number": null,
    "milestone_title": "sage-4.5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69890"
}
```



---

archive/issue_events_069891.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2009-09-11T04:47:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20basic%20arithmetic",
    "label_color": "08517b",
    "label_name": "component: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69891"
}
```



---

archive/issue_events_069892.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2009-09-11T04:47:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/minor",
    "label_color": "ff0000",
    "label_name": "minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69892"
}
```



---

archive/issue_events_069893.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2009-09-11T04:47:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69893"
}
```



---

archive/issue_comments_050837.json:
```json
{
    "body": "<a id='comment:1'>**Comment 1:**</a>\nThe patch introduces matrix term ordering, but it does not work yet unfortunately.\n\n```\n----------------------------------------------------------------------\n| Sage Version 4.1.1, Release Date: 2009-08-14                       |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nLoading Sage library. Current Mercurial branch is: local2\nsage: R.<x,y>=PolynomialRing(QQ,order=\"matrix(1,3,1,0)\")\nsage: r=singular(R)\nsage: r\n\n//   characteristic : 0\n//   number of vars : 2\n//        block   1 : ordering M\n//                  : names    x y \n//                  : weights  1 3 \n//                  : weights  1 0 \n//        block   2 : ordering C\nsage: f=x^2+y\nsage: f.lt()\nx^2\nsage: f=x^3+y\nsage: f.lt()\nx^3\nsage: t=R.term_order()\nsage: t\nmatrix(1,3,1,0) term order\n```\n\nPlease someone who knows better check the patch, and make it work!\n\nSimon says:\n\nBetter wait for a proper implementation in libsingular \n(which is beyond my capabilities, I am afraid).\n\nCheers,\nSimon",
    "created_at": "2009-09-11T05:05:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50837",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:1'>**Comment 1:**</a>
The patch introduces matrix term ordering, but it does not work yet unfortunately.

```
----------------------------------------------------------------------
| Sage Version 4.1.1, Release Date: 2009-08-14                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
Loading Sage library. Current Mercurial branch is: local2
sage: R.<x,y>=PolynomialRing(QQ,order="matrix(1,3,1,0)")
sage: r=singular(R)
sage: r

//   characteristic : 0
//   number of vars : 2
//        block   1 : ordering M
//                  : names    x y 
//                  : weights  1 3 
//                  : weights  1 0 
//        block   2 : ordering C
sage: f=x^2+y
sage: f.lt()
x^2
sage: f=x^3+y
sage: f.lt()
x^3
sage: t=R.term_order()
sage: t
matrix(1,3,1,0) term order
```

Please someone who knows better check the patch, and make it work!

Simon says:

Better wait for a proper implementation in libsingular 
(which is beyond my capabilities, I am afraid).

Cheers,
Simon



---

archive/issue_comments_050838.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nI don't think we should support the 'matrix()' syntax. The Singular syntax is 'M()' which we should support for compatibility and familiarity. However, adding another string expression does not seem to make sense, because we will be able to simply write `order=A` where A is an integer matrix which is much more python-ic.",
    "created_at": "2009-09-11T10:20:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50838",
    "user": "https://github.com/malb"
}
```

<a id='comment:2'>**Comment 2:**</a>
I don't think we should support the 'matrix()' syntax. The Singular syntax is 'M()' which we should support for compatibility and familiarity. However, adding another string expression does not seem to make sense, because we will be able to simply write `order=A` where A is an integer matrix which is much more python-ic.



---

archive/issue_comments_050839.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nI agree partially. Should we follow the Singular syntax exactly? For short syntax, how about just \"m(1,3,1,0)\"? I personally think the Singular syntax for term ordering is somewhat cryptic.\n\nI think it is better for Sage to support both the string description and `TermOrder` description. Thus for examples,\n\n```\norder='m(1,3,1,0)'+'deglex(2)'\n```\n\n```\norder='m(1,3,1,0),deglex(3)'\n```\n\nfor a square matrix m,\n\n```\norder=TermOrder(m)+TermOrder('deglex',3)\n```\n\nare all supported.\n\nMarshall Hampton says:\n\nI agree with John that Simon's example:\n\n```\n  sage: M = Matrix(2,2, [1,3,1,0])\n  sage: R.<a,b,c,d,e,f> = PolynomialRing(QQ, order=TermOrder(M)\n+TermOrder('deglex',3))\n```\n\nlooks good and reasonably intuitive to me.",
    "created_at": "2009-09-12T01:30:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50839",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:3'>**Comment 3:**</a>
I agree partially. Should we follow the Singular syntax exactly? For short syntax, how about just "m(1,3,1,0)"? I personally think the Singular syntax for term ordering is somewhat cryptic.

I think it is better for Sage to support both the string description and `TermOrder` description. Thus for examples,

```
order='m(1,3,1,0)'+'deglex(2)'
```

```
order='m(1,3,1,0),deglex(3)'
```

for a square matrix m,

```
order=TermOrder(m)+TermOrder('deglex',3)
```

are all supported.

Marshall Hampton says:

I agree with John that Simon's example:

```
  sage: M = Matrix(2,2, [1,3,1,0])
  sage: R.<a,b,c,d,e,f> = PolynomialRing(QQ, order=TermOrder(M)
+TermOrder('deglex',3))
```

looks good and reasonably intuitive to me.



---

archive/issue_comments_050840.json:
```json
{
    "body": "**Changing author** from \"Kwankyu Lee\" to \"\".",
    "created_at": "2009-09-12T01:30:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50840",
    "user": "https://github.com/kwankyu"
}
```

**Changing author** from "Kwankyu Lee" to "".



---

archive/issue_comments_050841.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nReplying to [@kwankyu](#comment%3A3):\n> I agree partially. Should we follow the Singular syntax exactly? For short syntax, how about just \"m(1,3,1,0)\"? I personally think the Singular syntax for term ordering is somewhat cryptic.\n\nSure, but it would be accepted anyway and passed through to Singular (in an ideal implementation) :)\n\n> I think it is better for Sage to support both the string description and `TermOrder` description. Thus for examples,\n> \n> ```\n> order='m(1,3,1,0)'+'deglex(2)'\n> ```\n> \n> ```\n> order='m(1,3,1,0),deglex(3)'\n> ```\n\nThis description is a mix of Singular syntax and Sage string syntax. I would like to avoid Sage string syntax as much as possible.\n\n> for a square matrix m,\n> \n> ```\n> order=TermOrder(m)+TermOrder('deglex',3)\n> ```\n> are all supported.\n\nI like this best.\n \n> Marshall Hampton says:\n> \n> I agree with John that Simon's example:\n> \n> ```\n>   sage: M = Matrix(2,2, [1,3,1,0])\n>   sage: R.<a,b,c,d,e,f> = PolynomialRing(QQ, order=TermOrder(M)\n> +TermOrder('deglex',3))\n> ```\n> \n> looks good and reasonably intuitive to me.\n\nYep, that's what I would be aiming for.",
    "created_at": "2009-09-12T09:59:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50841",
    "user": "https://github.com/malb"
}
```

<a id='comment:4'>**Comment 4:**</a>
Replying to [@kwankyu](#comment%3A3):
> I agree partially. Should we follow the Singular syntax exactly? For short syntax, how about just "m(1,3,1,0)"? I personally think the Singular syntax for term ordering is somewhat cryptic.

Sure, but it would be accepted anyway and passed through to Singular (in an ideal implementation) :)

> I think it is better for Sage to support both the string description and `TermOrder` description. Thus for examples,
> 
> ```
> order='m(1,3,1,0)'+'deglex(2)'
> ```
> 
> ```
> order='m(1,3,1,0),deglex(3)'
> ```

This description is a mix of Singular syntax and Sage string syntax. I would like to avoid Sage string syntax as much as possible.

> for a square matrix m,
> 
> ```
> order=TermOrder(m)+TermOrder('deglex',3)
> ```
> are all supported.

I like this best.
 
> Marshall Hampton says:
> 
> I agree with John that Simon's example:
> 
> ```
>   sage: M = Matrix(2,2, [1,3,1,0])
>   sage: R.<a,b,c,d,e,f> = PolynomialRing(QQ, order=TermOrder(M)
> +TermOrder('deglex',3))
> ```
> 
> looks good and reasonably intuitive to me.

Yep, that's what I would be aiming for.



---

archive/issue_comments_050842.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nThe replaced patch is still in beta stage, due to lack of docstrings. It adds matrix ordering to Sage term order suite, which works fine. It is based on Sage 4.4.2. The reason that I uploaded this premature patch is related with the ticket !#9003",
    "created_at": "2010-05-25T15:05:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50842",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:5'>**Comment 5:**</a>
The replaced patch is still in beta stage, due to lack of docstrings. It adds matrix ordering to Sage term order suite, which works fine. It is based on Sage 4.4.2. The reason that I uploaded this premature patch is related with the ticket !#9003



---

archive/issue_events_069894.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-05-25T15:05:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69894"
}
```



---

archive/issue_comments_050843.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nThe replaced patch now works, though only with PolyDict engine.",
    "created_at": "2010-05-27T02:23:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50843",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:6'>**Comment 6:**</a>
The replaced patch now works, though only with PolyDict engine.



---

archive/issue_events_069895.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-05-27T02:23:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69895"
}
```



---

archive/issue_events_069896.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-05-27T02:23:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69896"
}
```



---

archive/issue_comments_050844.json:
```json
{
    "body": "**Author:** Kwankyu Lee",
    "created_at": "2010-05-27T02:24:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50844",
    "user": "https://github.com/kwankyu"
}
```

**Author:** Kwankyu Lee



---

archive/issue_events_069897.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-05-27T02:24:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "milestone_number": null,
    "milestone_title": "sage-4.4.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69897"
}
```



---

archive/issue_comments_050845.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nReplying to [@kwankyu](#comment%3A6):\n> The replaced patch now works, though only with PolyDict engine.\n\nSorry for being a bit obnoxious about it, but shouldn't this be needs work until it works across the board? At least we should fall back to the `PolyDict` version automatically if a matrix term ordering is selected or something.",
    "created_at": "2010-06-02T18:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50845",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'>**Comment 9:**</a>
Replying to [@kwankyu](#comment%3A6):
> The replaced patch now works, though only with PolyDict engine.

Sorry for being a bit obnoxious about it, but shouldn't this be needs work until it works across the board? At least we should fall back to the `PolyDict` version automatically if a matrix term ordering is selected or something.



---

archive/issue_events_069898.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-06-03T00:55:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69898"
}
```



---

archive/issue_events_069899.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-06-03T00:55:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69899"
}
```



---

archive/issue_comments_050846.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nReplying to [@malb](#comment%3A9):\n\n> Sorry for being a bit obnoxious about it, but shouldn't this be needs work until it works across the board? At least we should fall back to the `PolyDict` version automatically if a matrix term ordering is selected or something. \u00a0\u00a0\n\nI am sorry that I cannot understand what you mean. Do you mean that matrix term order should work with Singular version before this patch is merged? Now, if a matrix term ordering is selected, then {{PolyDict}} version is used automatically because Singular version does not support matrix term ordering. If someone implements matrix term ordering with Singular version, then I would be happy. I have been waiting for this to be done. As it is not the case, I thought it's not bad to add matrix term ordering support only with {{PolyDict}} version--Singular version may be added later.",
    "created_at": "2010-06-03T00:55:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50846",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:10'>**Comment 10:**</a>
Replying to [@malb](#comment%3A9):

> Sorry for being a bit obnoxious about it, but shouldn't this be needs work until it works across the board? At least we should fall back to the `PolyDict` version automatically if a matrix term ordering is selected or something.   

I am sorry that I cannot understand what you mean. Do you mean that matrix term order should work with Singular version before this patch is merged? Now, if a matrix term ordering is selected, then {{PolyDict}} version is used automatically because Singular version does not support matrix term ordering. If someone implements matrix term ordering with Singular version, then I would be happy. I have been waiting for this to be done. As it is not the case, I thought it's not bad to add matrix term ordering support only with {{PolyDict}} version--Singular version may be added later.



---

archive/issue_comments_050847.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\n> I am sorry that I cannot understand what you mean. Do you mean that matrix term \n> order should work with Singular version before this patch is merged? Now, if a \n> matrix term ordering is selected, then `PolyDict` version is used \n> automatically because Singular version does not support matrix term ordering. \n\nRight, I forgot that I implemented to fall back this way :) Okay, my bad then. \n\n> If someone implements matrix term ordering with Singular version, then I would be \n> happy. \n\nWe all would be happy. All one needs to do btw. is to fix the constructor.\n\n> I have been waiting for this to be done. \n\nWhy not give it a try yourself? I'd love to help but other commitments prevent me from doing so.\n\n> As it is not the case, I thought it's not bad to add matrix term ordering support \n> only with `PolyDict` version--Singular version may be added later.\u00a0\n\nYou are right, I stand corrected.",
    "created_at": "2010-06-03T21:29:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50847",
    "user": "https://github.com/malb"
}
```

<a id='comment:11'>**Comment 11:**</a>
> I am sorry that I cannot understand what you mean. Do you mean that matrix term 
> order should work with Singular version before this patch is merged? Now, if a 
> matrix term ordering is selected, then `PolyDict` version is used 
> automatically because Singular version does not support matrix term ordering. 

Right, I forgot that I implemented to fall back this way :) Okay, my bad then. 

> If someone implements matrix term ordering with Singular version, then I would be 
> happy. 

We all would be happy. All one needs to do btw. is to fix the constructor.

> I have been waiting for this to be done. 

Why not give it a try yourself? I'd love to help but other commitments prevent me from doing so.

> As it is not the case, I thought it's not bad to add matrix term ordering support 
> only with `PolyDict` version--Singular version may be added later. 

You are right, I stand corrected.



---

archive/issue_events_069900.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-06-03T21:29:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69900"
}
```



---

archive/issue_events_069901.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-06-03T21:29:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69901"
}
```



---

archive/issue_comments_050848.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nI stand corrected twice. YOU implemented it to fall back not me. I thought the automatic fallback would kick in, but from your patch it looks like it doesn't.",
    "created_at": "2010-06-03T21:30:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50848",
    "user": "https://github.com/malb"
}
```

<a id='comment:12'>**Comment 12:**</a>
I stand corrected twice. YOU implemented it to fall back not me. I thought the automatic fallback would kick in, but from your patch it looks like it doesn't.



---

archive/issue_comments_050849.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\n* `NotImplementedError, \"Singular engine in Sage cannot handle matrix ordering yet.\"` should be replaced by `NotImplementedError(\"Matrix term orderings are not supported by the libSingular interface yet.\"` or something along those lines. I propose this change to make it clearer that Singular can indeed deal with Matrix term orderings and that it is us who cannot.\n  * `TypeError: Cannot use a matrix term order as a block.` shouldn't that be a `NotImplementedError`?\n  * I thought the agreement was not to allow 'matrix(0,1,2,3)' but to use Singular's convention instead? It seems you are allowing at and using it internally.",
    "created_at": "2010-06-03T21:41:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50849",
    "user": "https://github.com/malb"
}
```

<a id='comment:13'>**Comment 13:**</a>
* `NotImplementedError, "Singular engine in Sage cannot handle matrix ordering yet."` should be replaced by `NotImplementedError("Matrix term orderings are not supported by the libSingular interface yet."` or something along those lines. I propose this change to make it clearer that Singular can indeed deal with Matrix term orderings and that it is us who cannot.
  * `TypeError: Cannot use a matrix term order as a block.` shouldn't that be a `NotImplementedError`?
  * I thought the agreement was not to allow 'matrix(0,1,2,3)' but to use Singular's convention instead? It seems you are allowing at and using it internally.



---

archive/issue_comments_050850.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nOh, one more thing, isn't\n\n```python\nTermOrder([0,1,2,3])\n```\n\nambiguous since it could be interpreted as a list of weights? I'd vote to not to allow it for matrix term orders.",
    "created_at": "2010-06-03T21:52:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50850",
    "user": "https://github.com/malb"
}
```

<a id='comment:14'>**Comment 14:**</a>
Oh, one more thing, isn't

```python
TermOrder([0,1,2,3])
```

ambiguous since it could be interpreted as a list of weights? I'd vote to not to allow it for matrix term orders.



---

archive/issue_comments_050851.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nReplying to [@malb](#comment%3A13):\n\n> * `NotImplementedError, \"Singular engine in Sage cannot handle matrix ordering yet.\"` should be replaced by `NotImplementedError(\"Matrix term orderings are not supported by the libSingular interface yet.\"` or something along those lines. I propose this change to make it clearer that Singular can indeed deal with Matrix term orderings and that it is us who cannot. \n\nI agree.\n\n> * `TypeError: Cannot use a matrix term order as a block.` shouldn't that be a `NotImplementedError`? \n\nI know Singular allow matrix term orderings in block order. But this feature is not one of the aims of the current patch. That could be included in a future patch that use Singular version.\n\n> * I thought the agreement was not to allow 'matrix(0,1,2,3)' but to use Singular's convention instead? It seems you are allowing at and using it internally.\n\nI did not agree then. :-) Anyway, I will change it to 'm(...)'",
    "created_at": "2010-06-04T01:22:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50851",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:15'>**Comment 15:**</a>
Replying to [@malb](#comment%3A13):

> * `NotImplementedError, "Singular engine in Sage cannot handle matrix ordering yet."` should be replaced by `NotImplementedError("Matrix term orderings are not supported by the libSingular interface yet."` or something along those lines. I propose this change to make it clearer that Singular can indeed deal with Matrix term orderings and that it is us who cannot. 

I agree.

> * `TypeError: Cannot use a matrix term order as a block.` shouldn't that be a `NotImplementedError`? 

I know Singular allow matrix term orderings in block order. But this feature is not one of the aims of the current patch. That could be included in a future patch that use Singular version.

> * I thought the agreement was not to allow 'matrix(0,1,2,3)' but to use Singular's convention instead? It seems you are allowing at and using it internally.

I did not agree then. :-) Anyway, I will change it to 'm(...)'



---

archive/issue_comments_050852.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nReplying to [@malb](#comment%3A14):\n\n> Oh, one more thing, isn't ` #!python TermOrder([0,1,2,3]) ` ambiguous since it could be interpreted as a list of weights? I'd vote to not to allow it for matrix term orders. \n\nOk.",
    "created_at": "2010-06-04T01:24:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50852",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:16'>**Comment 16:**</a>
Replying to [@malb](#comment%3A14):

> Oh, one more thing, isn't ` #!python TermOrder([0,1,2,3]) ` ambiguous since it could be interpreted as a list of weights? I'd vote to not to allow it for matrix term orders. 

Ok.



---

archive/issue_comments_050853.json:
```json
{
    "body": "**Attachment:** [trac#6922.patch.gz](https://github.com/sagemath/sage/files/ticket6922/61dc71737722791f7bf16d969c853137.gz)\n\nreplaced",
    "created_at": "2010-06-04T01:35:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50853",
    "user": "https://github.com/kwankyu"
}
```

**Attachment:** [trac#6922.patch.gz](https://github.com/sagemath/sage/files/ticket6922/61dc71737722791f7bf16d969c853137.gz)

replaced



---

archive/issue_comments_050854.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nThe patch applies cleanly and doctests pass.\n\nI'm still not happy with the interface:\n\n```python\nsage: P.<a,b> = PolynomialRing(GF(32003),order=TermOrder(Matrix([1,2,0,3])))\nsage: P.term_order()\nm(1,2,0,3) term order\n```\n\nThis uses the non-standard \"m(...)\" representation which I would avoid. I'd be happy with either \"M()\" (Singular notation) or \"Matrix term ordering with matrix ...\" or so.\n\nAlso, the \"m()\" notation is allowed but shouldn't.\n\n```python\nsage: P.<a,b> = PolynomialRing(GF(32003),order='m(1,2,0,3)')\n```\n\nI understand that this is a typical paint-the-bike-shed scenario and in particular a question of choice. Still, I think we shouldn't invent more ad-hoc string notation when (a) there is an established notation and (b) we have a much nicer object oriented way of constructing term orderings.\n\nHowever, since this isn't really that big of a deal, I am okay with being overruled by some other referee who disagrees.\n\nPS: Apologies for taking so long to revisit this ticket.",
    "created_at": "2010-06-24T12:38:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50854",
    "user": "https://github.com/malb"
}
```

<a id='comment:17'>**Comment 17:**</a>
The patch applies cleanly and doctests pass.

I'm still not happy with the interface:

```python
sage: P.<a,b> = PolynomialRing(GF(32003),order=TermOrder(Matrix([1,2,0,3])))
sage: P.term_order()
m(1,2,0,3) term order
```

This uses the non-standard "m(...)" representation which I would avoid. I'd be happy with either "M()" (Singular notation) or "Matrix term ordering with matrix ..." or so.

Also, the "m()" notation is allowed but shouldn't.

```python
sage: P.<a,b> = PolynomialRing(GF(32003),order='m(1,2,0,3)')
```

I understand that this is a typical paint-the-bike-shed scenario and in particular a question of choice. Still, I think we shouldn't invent more ad-hoc string notation when (a) there is an established notation and (b) we have a much nicer object oriented way of constructing term orderings.

However, since this isn't really that big of a deal, I am okay with being overruled by some other referee who disagrees.

PS: Apologies for taking so long to revisit this ticket.



---

archive/issue_events_069902.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-06-25T00:51:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69902"
}
```



---

archive/issue_events_069903.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-06-25T00:51:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69903"
}
```



---

archive/issue_comments_050855.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nReplying to [@malb](#comment%3A17):\n\nI prefer \"Matrix term ordering with matrix ...\".\n\nboth \"M(1,2,0,3)\" and \"m(1,2,0,3)\" is allowed, which is not bad. The situation is the same with other orderings like \"Lex\", which is converted to lower case internally. I don't mind that \"M(...)\" should be the official string representation of matrix orderings.\n\nI am working to make matrix ordering work with Singular version. I am not really confident whether the code is sound as it is based on a knowledge obtained by a reverse engineering of libSingular Sage interface. \n\nI will upload a revised patch soon, perhaps within a couple of hours. Then I wish you again to review the patch.",
    "created_at": "2010-06-25T00:51:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50855",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:18'>**Comment 18:**</a>
Replying to [@malb](#comment%3A17):

I prefer "Matrix term ordering with matrix ...".

both "M(1,2,0,3)" and "m(1,2,0,3)" is allowed, which is not bad. The situation is the same with other orderings like "Lex", which is converted to lower case internally. I don't mind that "M(...)" should be the official string representation of matrix orderings.

I am working to make matrix ordering work with Singular version. I am not really confident whether the code is sound as it is based on a knowledge obtained by a reverse engineering of libSingular Sage interface. 

I will upload a revised patch soon, perhaps within a couple of hours. Then I wish you again to review the patch.



---

archive/issue_comments_050856.json:
```json
{
    "body": "with singular version support",
    "created_at": "2010-06-25T04:56:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50856",
    "user": "https://github.com/kwankyu"
}
```

with singular version support



---

archive/issue_events_069904.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-06-25T04:58:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69904"
}
```



---

archive/issue_events_069905.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-06-25T04:58:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69905"
}
```



---

archive/issue_comments_050857.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\n**Attachment:** [trac#6922.2.patch.gz](https://github.com/sagemath/sage/files/ticket6922/72d1782921d11f4af1efed23c9f15b76.gz)\n\nThe new patch supports also the Singular version.  Now \"M(...)\" is the official string representation of matrix  orderings.",
    "created_at": "2010-06-25T04:58:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50857",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:19'>**Comment 19:**</a>
**Attachment:** [trac#6922.2.patch.gz](https://github.com/sagemath/sage/files/ticket6922/72d1782921d11f4af1efed23c9f15b76.gz)

The new patch supports also the Singular version.  Now "M(...)" is the official string representation of matrix  orderings.



---

archive/issue_comments_050858.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nReplying to [@kwankyu](#comment%3A18):\n> The situation is the same with other orderings like \"Lex\", which is converted to \n> lower case internally.\n\nGood point, I'm convinced.\n\n> I am working to make matrix ordering work with Singular version. I am not really \n> confident whether the code is sound as it is based on a knowledge obtained by a \n> reverse engineering of libSingular Sage interface. \n\nGreat, I'll take a look.",
    "created_at": "2010-06-25T07:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50858",
    "user": "https://github.com/malb"
}
```

<a id='comment:20'>**Comment 20:**</a>
Replying to [@kwankyu](#comment%3A18):
> The situation is the same with other orderings like "Lex", which is converted to 
> lower case internally.

Good point, I'm convinced.

> I am working to make matrix ordering work with Singular version. I am not really 
> confident whether the code is sound as it is based on a knowledge obtained by a 
> reverse engineering of libSingular Sage interface. 

Great, I'll take a look.



---

archive/issue_comments_050859.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nPatch looks good (small issue see below), applies cleanly, doctests pass.\n\nSo, this stuff now works, very cool:\n\n```python\nsage: P = PolynomialRing(GF(127),2,'x',order=Matrix([1,2,0,3]))\nsage: P.term_order()\nMatrix term order with matrix\n[1 2]\n[0 3]\nsage: magma(P)\nPolynomial ring of rank 2 over GF(127)\nOrder: Weight [full]\nVariables: x0, x1\nsage: singular(P)\n//   characteristic : 127\n//   number of vars : 2\n//        block   1 : ordering M\n//                  : names    x0 x1\n//                  : weights   1  2\n//                  : weights   0  3\n//        block   2 : ordering C\n```\n\nI've attached a small referee patch which Kwankyu or someone else has to sign of. Kwankyu's patch gets a positive review modulo the issue in the referee patch.",
    "created_at": "2010-06-25T09:06:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50859",
    "user": "https://github.com/malb"
}
```

<a id='comment:21'>**Comment 21:**</a>
Patch looks good (small issue see below), applies cleanly, doctests pass.

So, this stuff now works, very cool:

```python
sage: P = PolynomialRing(GF(127),2,'x',order=Matrix([1,2,0,3]))
sage: P.term_order()
Matrix term order with matrix
[1 2]
[0 3]
sage: magma(P)
Polynomial ring of rank 2 over GF(127)
Order: Weight [full]
Variables: x0, x1
sage: singular(P)
//   characteristic : 127
//   number of vars : 2
//        block   1 : ordering M
//                  : names    x0 x1
//                  : weights   1  2
//                  : weights   0  3
//        block   2 : ordering C
```

I've attached a small referee patch which Kwankyu or someone else has to sign of. Kwankyu's patch gets a positive review modulo the issue in the referee patch.



---

archive/issue_comments_050860.json:
```json
{
    "body": "**Attachment:** [trac_6922_referee.patch.gz](https://github.com/sagemath/sage/files/ticket6922/trac_6922_referee.patch.gz)\n\napply after klee's patch",
    "created_at": "2010-06-25T09:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50860",
    "user": "https://github.com/malb"
}
```

**Attachment:** [trac_6922_referee.patch.gz](https://github.com/sagemath/sage/files/ticket6922/trac_6922_referee.patch.gz)

apply after klee's patch



---

archive/issue_comments_050861.json:
```json
{
    "body": "**Attachment:** [trac#6922_final.patch.gz](https://github.com/sagemath/sage/files/ticket6922/f3b8b06b0e97205d062adb7daf9938bc.gz)\n\ncombined with referee's patch",
    "created_at": "2010-06-25T10:44:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50861",
    "user": "https://github.com/kwankyu"
}
```

**Attachment:** [trac#6922_final.patch.gz](https://github.com/sagemath/sage/files/ticket6922/f3b8b06b0e97205d062adb7daf9938bc.gz)

combined with referee's patch



---

archive/issue_events_069906.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-06-25T10:54:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69906"
}
```



---

archive/issue_events_069907.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2010-06-25T10:54:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69907"
}
```



---

archive/issue_comments_050862.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nPositive review for the referee's patch. Thank you!",
    "created_at": "2010-06-25T10:54:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50862",
    "user": "https://github.com/kwankyu"
}
```

<a id='comment:22'>**Comment 22:**</a>
Positive review for the referee's patch. Thank you!



---

archive/issue_comments_050863.json:
```json
{
    "body": "**Reviewer:** Martin Albrecht",
    "created_at": "2010-06-29T08:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50863",
    "user": "https://github.com/loefflerd"
}
```

**Reviewer:** Martin Albrecht



---

archive/issue_comments_050864.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nI'm applying just `trac#6922_final.patch` to 4.5.2.alpha0.  Just let me know if I'm wrong.",
    "created_at": "2010-07-20T08:38:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50864",
    "user": "https://github.com/qed777"
}
```

<a id='comment:24'>**Comment 24:**</a>
I'm applying just `trac#6922_final.patch` to 4.5.2.alpha0.  Just let me know if I'm wrong.



---

archive/issue_events_069908.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-07-20T09:21:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69908"
}
```



---

archive/issue_events_069909.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-07-20T09:21:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6922#event-69909"
}
```



---

archive/issue_comments_050865.json:
```json
{
    "body": "**Merged:** sage-4.5.2.alpha0",
    "created_at": "2010-07-20T09:21:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6922#issuecomment-50865",
    "user": "https://github.com/qed777"
}
```

**Merged:** sage-4.5.2.alpha0
