# Issue 6777: segfault with univariate polynomial, realfield, complexfield

archive/issues_006777.json:
```json
{
    "body": "This is with a modified\n\n```\n```\n| Sage Version 4.1.rc1, Release Date: 2009-07-07                     |\n\nMac OS X, Intel hardware.\n\n```\nsage: RealField(300)['x']( [ 1, ComplexField(300).gen(), 0 ])\n\n\n------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occured in SAGE.\nThis probably occured because a *compiled* component\nof SAGE has a bug in it (typically accessing invalid memory)\nor is not properly wrapped with _sig_on, _sig_off.\nYou might want to run SAGE under gdb with 'sage -gdb' to debug this.\nSAGE will now terminate (sorry).\n------------------------------------------------------------\n\n\nProcess SAGE exited abnormally with code 1\n```\n\nAssignee: @malb\n\nCC:  @orlitzky\n\nKeywords: polynomial segfault\n\nResolution: fixed\n\nDependencies: #11900\n\nAuthor: Michael Orlitzky\n\nReviewer: Mike Hansen\n\nMerged: sage-5.0.beta0\n\nIssue created by migration from https://trac.sagemath.org/ticket/6777\n\n",
    "closed_at": "2012-01-18T08:08:18Z",
    "created_at": "2009-08-19T22:48:53Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "segfault with univariate polynomial, realfield, complexfield",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6777",
    "user": "https://github.com/ncalexan"
}
```
This is with a modified

```
```
| Sage Version 4.1.rc1, Release Date: 2009-07-07                     |

Mac OS X, Intel hardware.

```
sage: RealField(300)['x']( [ 1, ComplexField(300).gen(), 0 ])


------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occured in SAGE.
This probably occured because a *compiled* component
of SAGE has a bug in it (typically accessing invalid memory)
or is not properly wrapped with _sig_on, _sig_off.
You might want to run SAGE under gdb with 'sage -gdb' to debug this.
SAGE will now terminate (sorry).
------------------------------------------------------------


Process SAGE exited abnormally with code 1
```

Assignee: @malb

CC:  @orlitzky

Keywords: polynomial segfault

Resolution: fixed

Dependencies: #11900

Author: Michael Orlitzky

Reviewer: Mike Hansen

Merged: sage-5.0.beta0

Issue created by migration from https://trac.sagemath.org/ticket/6777





---

archive/issue_comments_063452.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2011-12-15T17:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63452",
    "user": "https://github.com/simon-king-jena"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_comments_063453.json:
```json
{
    "body": "<a id='comment:1'></a>\nI don't obtain a segmentation fault, but this is on Debian GNU/Linux.\n\nOn [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/d4807256e57cd843), it is discussed that one gets a rather strange phenomenon: Before the traceback starts, some ERROR is printed.\n\n```\nsage: RealField(300)['x']( [ 1, ComplexField(300).gen(), 0 ])\nERROR: An unexpected error occurred while tokenizing input\nThe following traceback may be corrupted or invalid\nThe error message is: ('EOF in multi-line statement', (1375, 0))\n\nERROR: An unexpected error occurred while tokenizing input\nThe following traceback may be corrupted or invalid\nThe error message is: ('EOF in multi-line statement', (1375, 0))\n\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n```\nI get this with unpatched sage (hence, no segfault), and Michael Orlitzky reports the same after fixing the segfault.\n\nHowever, with some of my patches applied, one simply gets a straight forward traceback:\n\n```\nsage: RealField(300)['x']([ ComplexField(300).gen() ]) \n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: Unable to convert x (='1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000*I') to real number.\n```\n\nCould you test whether #9138 (or perhaps #11900) actually fixes the problem already?",
    "created_at": "2011-12-15T17:44:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63453",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:1'></a>
I don't obtain a segmentation fault, but this is on Debian GNU/Linux.

On [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/d4807256e57cd843), it is discussed that one gets a rather strange phenomenon: Before the traceback starts, some ERROR is printed.

```
sage: RealField(300)['x']( [ 1, ComplexField(300).gen(), 0 ])
ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (1375, 0))

ERROR: An unexpected error occurred while tokenizing input
The following traceback may be corrupted or invalid
The error message is: ('EOF in multi-line statement', (1375, 0))

---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

```
I get this with unpatched sage (hence, no segfault), and Michael Orlitzky reports the same after fixing the segfault.

However, with some of my patches applied, one simply gets a straight forward traceback:

```
sage: RealField(300)['x']([ ComplexField(300).gen() ]) 
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: Unable to convert x (='1.00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000*I') to real number.
```

Could you test whether #9138 (or perhaps #11900) actually fixes the problem already?



---

archive/issue_comments_063454.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#11900\"",
    "created_at": "2011-12-15T18:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63454",
    "user": "https://github.com/orlitzky"
}
```

Changing dependencies from "" to "#11900"



---

archive/issue_comments_063455.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe fix is in #11900, and it has a positive review, so I'm adding it as a dependency before a doctest can be added.",
    "created_at": "2011-12-15T18:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63455",
    "user": "https://github.com/orlitzky"
}
```

<a id='comment:2'></a>
The fix is in #11900, and it has a positive review, so I'm adding it as a dependency before a doctest can be added.



---

archive/issue_comments_063456.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-12-15T18:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63456",
    "user": "https://github.com/orlitzky"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_063457.json:
```json
{
    "body": "Changing author from \"\" to \"Michael Orlitzky\"",
    "created_at": "2011-12-16T17:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63457",
    "user": "https://github.com/orlitzky"
}
```

Changing author from "" to "Michael Orlitzky"



---

archive/issue_comments_063458.json:
```json
{
    "body": "Patch to add a doctest expecting a TypeError",
    "created_at": "2011-12-17T20:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63458",
    "user": "https://github.com/mwhansen"
}
```

Patch to add a doctest expecting a TypeError



---

archive/issue_comments_063459.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Mike Hansen\"",
    "created_at": "2011-12-17T20:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63459",
    "user": "https://github.com/mwhansen"
}
```

Changing reviewer from "" to "Mike Hansen"



---

archive/issue_comments_063460.json:
```json
{
    "body": "<a id='comment:5'></a>\nAttachment [sage-trac_6777.patch](tarball://root/attachments/some-uuid/ticket6777/sage-trac_6777.patch) by @mwhansen created at 2011-12-17 20:55:16\n\nmjo's patch looks good to me.  I updated the formatting slightly.",
    "created_at": "2011-12-17T20:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63460",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:5'></a>
Attachment [sage-trac_6777.patch](tarball://root/attachments/some-uuid/ticket6777/sage-trac_6777.patch) by @mwhansen created at 2011-12-17 20:55:16

mjo's patch looks good to me.  I updated the formatting slightly.



---

archive/issue_comments_063461.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-12-17T20:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63461",
    "user": "https://github.com/mwhansen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_015972.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-18T13:42:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6777#event-15972"
}
```



---

archive/issue_comments_063462.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-01-18T08:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63462",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_063463.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.0.beta0\"",
    "created_at": "2012-01-18T08:08:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6777#issuecomment-63463",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.0.beta0"



---

archive/issue_events_015973.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-18T08:08:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6777",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6777#event-15973"
}
```
