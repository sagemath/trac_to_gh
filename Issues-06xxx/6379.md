# Issue 6379: #2513 made R.py doctest fail for non-english locale

archive/issues_006379.json:
```json
{
    "body": "In ticket #276, the LANG environment variable was set in sage-env (to en_US.UTF-8) and in ticket #2513, this was undone. On my box, the following doctest failure was a consequence:\n\n```\nsage -t -long \"devel/sage/sage/interfaces/r.py\"             \n**********************************************************************\nFile \"/Users/Shared/sage/sage-4.0.2/devel/sage/sage/interfaces/r.py\", line 554:\n    sage: r.library('foobar')\nExpected:\n    Traceback (most recent call last):\n    ...\n    ImportError: there is no package called 'foobar'\nGot nothing\n**********************************************************************\nFile \"/Users/Shared/sage/sage-4.0.2/devel/sage/sage/interfaces/r.py\", line 840:\n    sage: r.completions('tes')\nExpected:\n    ['testPlatformEquivalence', 'testVirtual']\nGot:\n    ['testPlatformEquivalence', 'testPlatformEquivalence', 'testVirtual', 'testVirtual']\n**********************************************************************\n2 items had failures:\n   1 of   5 in __main__.example_17\n   1 of   3 in __main__.example_34\n***Test Failed*** 2 failures.\nFor whitespace errors, see the file /Users/Shared/sage/sage-4.0.2/tmp/.doctest_r.py\n         [6.3 s]\n```\nI have *none* of the usual \"locale\" variables set (LANG, LC_ALL, ...) but nevertheless R is clever enough to detect that I might want read its messages in german. (It's using some Mac OS feature, I think.) But unfortunately the Sage code did parse for english key-words in the R messages. \nAnyway, the above doctest failure could be triggered by anyone by issuing e.g. \"export LANG=de_DE.UTF-8\" just before running the doctest.\n\n**Assignee:** GeorgSWeber\n\n**Resolution:** fixed\n\n**Author:** Georg S. Weber\n\n**Reviewer:** Minh Van Nguyen\n\n**Merged:** sage-4.1.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/6379\n\n",
    "closed_at": "2009-07-16T21:29:55Z",
    "created_at": "2009-06-21T21:49:20Z",
    "labels": [
        "component: interfaces",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1.1",
    "title": "#2513 made R.py doctest fail for non-english locale",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6379",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```
In ticket #276, the LANG environment variable was set in sage-env (to en_US.UTF-8) and in ticket #2513, this was undone. On my box, the following doctest failure was a consequence:

```
sage -t -long "devel/sage/sage/interfaces/r.py"             
**********************************************************************
File "/Users/Shared/sage/sage-4.0.2/devel/sage/sage/interfaces/r.py", line 554:
    sage: r.library('foobar')
Expected:
    Traceback (most recent call last):
    ...
    ImportError: there is no package called 'foobar'
Got nothing
**********************************************************************
File "/Users/Shared/sage/sage-4.0.2/devel/sage/sage/interfaces/r.py", line 840:
    sage: r.completions('tes')
Expected:
    ['testPlatformEquivalence', 'testVirtual']
Got:
    ['testPlatformEquivalence', 'testPlatformEquivalence', 'testVirtual', 'testVirtual']
**********************************************************************
2 items had failures:
   1 of   5 in __main__.example_17
   1 of   3 in __main__.example_34
***Test Failed*** 2 failures.
For whitespace errors, see the file /Users/Shared/sage/sage-4.0.2/tmp/.doctest_r.py
         [6.3 s]
```
I have *none* of the usual "locale" variables set (LANG, LC_ALL, ...) but nevertheless R is clever enough to detect that I might want read its messages in german. (It's using some Mac OS feature, I think.) But unfortunately the Sage code did parse for english key-words in the R messages. 
Anyway, the above doctest failure could be triggered by anyone by issuing e.g. "export LANG=de_DE.UTF-8" just before running the doctest.

**Assignee:** GeorgSWeber

**Resolution:** fixed

**Author:** Georg S. Weber

**Reviewer:** Minh Van Nguyen

**Merged:** sage-4.1.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/6379





---

archive/issue_comments_062961.json:
```json
{
    "body": "**Changing status** from new to assigned.",
    "created_at": "2009-06-21T21:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62961",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

**Changing status** from new to assigned.



---

archive/issue_comments_062962.json:
```json
{
    "body": "**Changing assignee** from @williamstein to GeorgSWeber.",
    "created_at": "2009-06-21T21:49:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62962",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

**Changing assignee** from @williamstein to GeorgSWeber.



---

archive/issue_comments_062963.json:
```json
{
    "body": "Attachment [trac_6379-Rdoctest.patch](tarball://root/attachments/some-uuid/ticket6379/trac_6379-Rdoctest.patch) by GeorgSWeber created at 2009-06-21 21:54:06\n\ntested against 4.0.2",
    "created_at": "2009-06-21T21:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62963",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

Attachment [trac_6379-Rdoctest.patch](tarball://root/attachments/some-uuid/ticket6379/trac_6379-Rdoctest.patch) by GeorgSWeber created at 2009-06-21 21:54:06

tested against 4.0.2



---

archive/issue_comments_062964.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-06-21T21:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62964",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_062965.json:
```json
{
    "body": "**Author:** GeorgSWeber",
    "created_at": "2009-07-02T22:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62965",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

**Author:** GeorgSWeber



---

archive/issue_comments_062966.json:
```json
{
    "body": "<a id='comment:4'></a>\nAll tests passed in Sage 4.1.",
    "created_at": "2009-07-13T22:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62966",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:4'></a>
All tests passed in Sage 4.1.



---

archive/issue_comments_062967.json:
```json
{
    "body": "**Reviewer:** Minh Van Nguyen",
    "created_at": "2009-07-13T22:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62967",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Reviewer:** Minh Van Nguyen



---

archive/issue_comments_062968.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-07-13T22:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62968",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_062969.json:
```json
{
    "body": "<a id='comment:5'></a>\nWhile testing out this patch, I came across an incidental problem. It's reported at this [sage-support](http://groups.google.com/group/sage-support/browse_thread/thread/f8da7ca9d81b506b) thread. OK, so the patch fixes a locale problem. But then comes a problem with the R interface command `r.library()`. By the way, this has nothing to do with Georg's patch.",
    "created_at": "2009-07-14T10:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62969",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:5'></a>
While testing out this patch, I came across an incidental problem. It's reported at this [sage-support](http://groups.google.com/group/sage-support/browse_thread/thread/f8da7ca9d81b506b) thread. OK, so the patch fixes a locale problem. But then comes a problem with the R interface command `r.library()`. By the way, this has nothing to do with Georg's patch.



---

archive/issue_comments_062970.json:
```json
{
    "body": "<a id='comment:6'></a>\nJust to let people know, this has been merged in sage-4.1.1-alpha0. I can't close this ticket because I don't have the privilege to do so. Sorry, folks :-(",
    "created_at": "2009-07-16T10:25:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62970",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:6'></a>
Just to let people know, this has been merged in sage-4.1.1-alpha0. I can't close this ticket because I don't have the privilege to do so. Sorry, folks :-(



---

archive/issue_comments_062971.json:
```json
{
    "body": "**Merged:** sage-4.1.1.alpha0",
    "created_at": "2009-07-16T21:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62971",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Merged:** sage-4.1.1.alpha0



---

archive/issue_events_019315.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2009-07-16T21:29:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6379#event-19315"
}
```



---

archive/issue_comments_062972.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2009-07-16T21:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62972",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Resolution:** fixed



---

archive/issue_comments_062973.json:
```json
{
    "body": "**Changing author** from \"GeorgSWeber\" to \"Georg S. Weber\".",
    "created_at": "2009-07-16T21:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6379",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6379#issuecomment-62973",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing author** from "GeorgSWeber" to "Georg S. Weber".
