# Issue 6990: readline tab completion has an extra space appended

archive/issues_006990.json:
```json
{
    "body": "This is the same symtom we had in #2469 (but different problem now), which apparently again crops up with the upgrade to readline-6.0.\n\nI get it with a fresh compile of 4.1.2.alpha2 on ubuntu 9.04.\n\nA new spkg is here: http://sage.math.washington.edu/home/jason/python-2.6.2.p2.spkg\n\n**Assignee:** mabshoff\n\n**CC:**  @kcrisman\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/6990\n\n",
    "closed_at": "2009-10-04T18:04:20Z",
    "created_at": "2009-09-22T18:09:11Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1.2",
    "title": "readline tab completion has an extra space appended",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6990",
    "user": "https://github.com/jasongrout"
}
```
This is the same symtom we had in #2469 (but different problem now), which apparently again crops up with the upgrade to readline-6.0.

I get it with a fresh compile of 4.1.2.alpha2 on ubuntu 9.04.

A new spkg is here: http://sage.math.washington.edu/home/jason/python-2.6.2.p2.spkg

**Assignee:** mabshoff

**CC:**  @kcrisman

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/6990





---

archive/issue_comments_072781.json:
```json
{
    "body": "<a id='comment:1'></a>\nThis bug is documented here: http://bugs.python.org/issue5833\n\nA nice patch is here: http://bugs.python.org/file14599/python-2.6-readline.patch\n\nI'll make a new python spkg.",
    "created_at": "2009-09-22T18:36:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72781",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:1'></a>
This bug is documented here: http://bugs.python.org/issue5833

A nice patch is here: http://bugs.python.org/file14599/python-2.6-readline.patch

I'll make a new python spkg.



---

archive/issue_comments_072782.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-This is the same problem we had in #2469, which apparently again crops up with the upgrade to readline-6.0.\n+This is the same symtom we had in #2469 (but different problem now), which apparently again crops up with the upgrade to readline-6.0.\n \n I get it with a fresh compile of 4.1.2.alpha2 on ubuntu 9.04.\n``````\n",
    "created_at": "2009-09-22T18:36:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72782",
    "user": "https://github.com/jasongrout"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-This is the same problem we had in #2469, which apparently again crops up with the upgrade to readline-6.0.
+This is the same symtom we had in #2469 (but different problem now), which apparently again crops up with the upgrade to readline-6.0.
 
 I get it with a fresh compile of 4.1.2.alpha2 on ubuntu 9.04.
``````




---

archive/issue_comments_072783.json:
```json
{
    "body": "<a id='comment:2'></a>\n(that patch is from: http://bugs.python.org/issue5833)",
    "created_at": "2009-09-22T18:53:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72783",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:2'></a>
(that patch is from: http://bugs.python.org/issue5833)



---

archive/issue_comments_072784.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n This is the same symtom we had in #2469 (but different problem now), which apparently again crops up with the upgrade to readline-6.0.\n \n I get it with a fresh compile of 4.1.2.alpha2 on ubuntu 9.04.\n+\n+A new spkg is here: http://sage.math.washington.edu/home/jason/python-2.6.2.p2.spkg\n``````\n",
    "created_at": "2009-09-22T19:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72784",
    "user": "https://github.com/jasongrout"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 This is the same symtom we had in #2469 (but different problem now), which apparently again crops up with the upgrade to readline-6.0.
 
 I get it with a fresh compile of 4.1.2.alpha2 on ubuntu 9.04.
+
+A new spkg is here: http://sage.math.washington.edu/home/jason/python-2.6.2.p2.spkg
``````




---

archive/issue_comments_072785.json:
```json
{
    "body": "<a id='comment:3'></a>\nMy spkg is up",
    "created_at": "2009-09-22T19:07:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72785",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:3'></a>
My spkg is up



---

archive/issue_comments_072786.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-09-22T19:07:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72786",
    "user": "https://github.com/jasongrout"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_072787.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis spkg takes care of the problem for me.",
    "created_at": "2009-09-22T19:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72787",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:5'></a>
This spkg takes care of the problem for me.



---

archive/issue_comments_072788.json:
```json
{
    "body": "<a id='comment:7'></a>\nI tested the spkg (64-bit Ubuntu 9.04), and it does fix the problem. Couple other recommendations:\n\n* in SPKG.txt, delete Michael from maintainers, and fix the \"cimmunity\" typo just below that\n* in spkg-install, should we have \"set -e\"? I recall some discussion about that, so that failed builds immediately stop.\n\nI'll try the spkg on some other platforms.",
    "created_at": "2009-09-23T00:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72788",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:7'></a>
I tested the spkg (64-bit Ubuntu 9.04), and it does fix the problem. Couple other recommendations:

* in SPKG.txt, delete Michael from maintainers, and fix the "cimmunity" typo just below that
* in spkg-install, should we have "set -e"? I recall some discussion about that, so that failed builds immediately stop.

I'll try the spkg on some other platforms.



---

archive/issue_comments_072789.json:
```json
{
    "body": "<a id='comment:8'></a>\nSee my report at #6849. Positive review from me, pending the fixes suggested by ddrake. If ddrake's happy, I'm happy.\n\n\n\nddrake --- Any comments on this ticket?",
    "created_at": "2009-09-27T03:45:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72789",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:8'></a>
See my report at #6849. Positive review from me, pending the fixes suggested by ddrake. If ddrake's happy, I'm happy.



ddrake --- Any comments on this ticket?



---

archive/issue_comments_072790.json:
```json
{
    "body": "<a id='comment:9'></a>\nSeems to work on OS X 10.5 (32 and 64 bit).",
    "created_at": "2009-09-27T16:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72790",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
Seems to work on OS X 10.5 (32 and 64 bit).



---

archive/issue_comments_072791.json:
```json
{
    "body": "<a id='comment:10'></a>\nI'm trying to build 4.1.2.alpha4 on Arch amd64, and with the new readline/python package, I'm getting \"undefined symbols\". It compiles readline just fine, and then it starts working on the sqlite spkg, and immediately bombs out with:\n\n```\n/bin/bash: symbol lookup error: $SAGE_ROOT/local/lib/libreadline.so.6: undefined symbol: PC\n```\nI tried skipped sqlite (by touching spkg/installed/sqlite-3.6.17) and when it started working on libgpg_error, it immediately failed with the same error.\n\nIt looks like the shell is getting confused and picking up the wrong libreadline, probably because Arch includes readline 6. On other systems, maybe this isn't a problem because the shell looks for a different readline...I guess?\n\nOn Ubuntu Karmic (9.10) amd64, I don't see this error, even though it does use readline 6.\n\n(Apologies if this comment should be on the readline spkg ticket, or should be in a new ticket...)",
    "created_at": "2009-09-28T01:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72791",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:10'></a>
I'm trying to build 4.1.2.alpha4 on Arch amd64, and with the new readline/python package, I'm getting "undefined symbols". It compiles readline just fine, and then it starts working on the sqlite spkg, and immediately bombs out with:

```
/bin/bash: symbol lookup error: $SAGE_ROOT/local/lib/libreadline.so.6: undefined symbol: PC
```
I tried skipped sqlite (by touching spkg/installed/sqlite-3.6.17) and when it started working on libgpg_error, it immediately failed with the same error.

It looks like the shell is getting confused and picking up the wrong libreadline, probably because Arch includes readline 6. On other systems, maybe this isn't a problem because the shell looks for a different readline...I guess?

On Ubuntu Karmic (9.10) amd64, I don't see this error, even though it does use readline 6.

(Apologies if this comment should be on the readline spkg ticket, or should be in a new ticket...)



---

archive/issue_comments_072792.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [ddrake](#comment%3A10):\n> I'm trying to build 4.1.2.alpha4 on Arch amd64, and with the new readline/python package, I'm getting \"undefined symbols\". It compiles readline just fine, and then it starts working on the sqlite spkg, and immediately bombs out with:\n\n\n```\n /bin/bash: symbol lookup error: $SAGE_ROOT/local/lib/libreadline.so.6: undefined symbol: PC\n```\n> I tried skipped sqlite (by touching spkg/installed/sqlite-3.6.17) and when it started working on libgpg_error, it immediately failed with the same error.\n\n\nI don't see why the error on Arch would prevent this ticket from getting into 4.1.2. The official supported platforms are CentOS, Debian, Fedora, RHEL, Mandriva, openSUSE, OS X 10.5, and Ubuntu. We are now porting to OS X 10.6 as well, a goal of the 4.1.2 release. Testing on all of these platforms, the updated spkg build OK and doctests pass, except for known doctest failures. Having said that, it's good to investigate why Jason's updated spkg failed to build on Arch. But that's another ticket.\n\n\n\n\nAn updated spkg based on Jason's is available at\n\nhttp://sage.math.washington.edu/home/mvngu/release/spkg/standard/python-2.6.2.p3.spkg\n\nThe changes from Jason's spkg include:\n\n* Some general clean up of the file `SPKG.txt`. In particular, the typo pointed out by Dan, and some typo fixes. Make lines no more than 75 or so characters wide. Any line wider than that and it would be difficult to read on a standard terminal width, i.e. 80 characters wide.\n* Put in the lines \"set -e\" and \"set +e\".",
    "created_at": "2009-09-28T06:13:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72792",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:11'></a>
Replying to [ddrake](#comment%3A10):
> I'm trying to build 4.1.2.alpha4 on Arch amd64, and with the new readline/python package, I'm getting "undefined symbols". It compiles readline just fine, and then it starts working on the sqlite spkg, and immediately bombs out with:


```
 /bin/bash: symbol lookup error: $SAGE_ROOT/local/lib/libreadline.so.6: undefined symbol: PC
```
> I tried skipped sqlite (by touching spkg/installed/sqlite-3.6.17) and when it started working on libgpg_error, it immediately failed with the same error.


I don't see why the error on Arch would prevent this ticket from getting into 4.1.2. The official supported platforms are CentOS, Debian, Fedora, RHEL, Mandriva, openSUSE, OS X 10.5, and Ubuntu. We are now porting to OS X 10.6 as well, a goal of the 4.1.2 release. Testing on all of these platforms, the updated spkg build OK and doctests pass, except for known doctest failures. Having said that, it's good to investigate why Jason's updated spkg failed to build on Arch. But that's another ticket.




An updated spkg based on Jason's is available at

http://sage.math.washington.edu/home/mvngu/release/spkg/standard/python-2.6.2.p3.spkg

The changes from Jason's spkg include:

* Some general clean up of the file `SPKG.txt`. In particular, the typo pointed out by Dan, and some typo fixes. Make lines no more than 75 or so characters wide. Any line wider than that and it would be difficult to read on a standard terminal width, i.e. 80 characters wide.
* Put in the lines "set -e" and "set +e".



---

archive/issue_events_020988.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-10-02T17:45:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "milestone": "sage-4.1.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6990#event-20988"
}
```



---

archive/issue_comments_072793.json:
```json
{
    "body": "<a id='comment:13'></a>\nI'm giving this a positive review, though I have issues with how \"set -e\" is used.  However, in this particular case no harm will be done.",
    "created_at": "2009-10-04T18:04:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72793",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:13'></a>
I'm giving this a positive review, though I have issues with how "set -e" is used.  However, in this particular case no harm will be done.



---

archive/issue_comments_072794.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2009-10-04T18:04:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72794",
    "user": "https://github.com/williamstein"
}
```

**Resolution:** fixed



---

archive/issue_events_020989.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-10-04T18:04:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6990#event-20989"
}
```



---

archive/issue_comments_072795.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2009-10-04T18:04:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6990",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6990#issuecomment-72795",
    "user": "https://github.com/williamstein"
}
```

**Changing status** from needs_review to positive_review.
