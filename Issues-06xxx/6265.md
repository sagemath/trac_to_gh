# Issue 6265: fix toy_d_basis.py

archive/issues_006265.json:
```json
{
    "body": "As discussed at #6051.  Line 91 of sage/rings/polynomial/toy_d_basis.py needs to be unrandomed when this is fixed.\n\n```\nHowever, when we compute the Groebner basis of I (defined over `\\ZZ`), we note that there is a certain integer in the ideal which is not 1.::\n\n    sage: d_basis(I) # random -- waiting on upstream singular fixes at #6051\n    [x + 170269749119, y + 2149906854, z + ..., 282687803443]                                \n```\n\nAssignee: @malb\n\nCC:  @malb @tscrim @kedlaya simonking\n\nBranch/Commit: 39616a708fcbeadc905da86fe3eeb0a63155c244\n\nReviewer: Travis Scrimshaw\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/6265\n\n",
    "closed_at": "2017-04-07T22:24:09Z",
    "created_at": "2009-06-12T08:01:59Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "fix toy_d_basis.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6265",
    "user": "https://github.com/ncalexan"
}
```
As discussed at #6051.  Line 91 of sage/rings/polynomial/toy_d_basis.py needs to be unrandomed when this is fixed.

```
However, when we compute the Groebner basis of I (defined over `\ZZ`), we note that there is a certain integer in the ideal which is not 1.::

    sage: d_basis(I) # random -- waiting on upstream singular fixes at #6051
    [x + 170269749119, y + 2149906854, z + ..., 282687803443]                                
```

Assignee: @malb

CC:  @malb @tscrim @kedlaya simonking

Branch/Commit: 39616a708fcbeadc905da86fe3eeb0a63155c244

Reviewer: Travis Scrimshaw

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/6265





---

archive/issue_events_014661.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14661"
}
```



---

archive/issue_events_014662.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14662"
}
```



---

archive/issue_events_014663.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14663"
}
```



---

archive/issue_events_014664.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14664"
}
```



---

archive/issue_events_014665.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14665"
}
```



---

archive/issue_events_014666.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14666"
}
```



---

archive/issue_events_014667.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14667"
}
```



---

archive/issue_comments_055713.json:
```json
{
    "body": "Changing commit from \"\" to \"24ad1fe4f21060b40ce00e23ca800b664ab63718\"",
    "created_at": "2017-03-30T20:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55713",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "24ad1fe4f21060b40ce00e23ca800b664ab63718"



---

archive/issue_comments_055714.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2017-03-30T20:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55714",
    "user": "https://github.com/fchapoton"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_comments_055715.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/6265\"",
    "created_at": "2017-03-30T20:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55715",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/6265"



---

archive/issue_comments_055716.json:
```json
{
    "body": "Changing author from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2017-03-30T20:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55716",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "" to "Frédéric Chapoton"



---

archive/issue_comments_055717.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2017-03-30T20:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55717",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_055718.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-30T20:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55718",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_055719.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-30T20:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55719",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_055720.json:
```json
{
    "body": "Changing commit from \"24ad1fe4f21060b40ce00e23ca800b664ab63718\" to \"716ac65de8e0001dfb4bd0e3add639c1a83eb98d\"",
    "created_at": "2017-03-30T20:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55720",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "24ad1fe4f21060b40ce00e23ca800b664ab63718" to "716ac65de8e0001dfb4bd0e3add639c1a83eb98d"



---

archive/issue_comments_055721.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-30T20:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55721",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_014668.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-30T20:41:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14668"
}
```



---

archive/issue_events_014669.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-30T20:41:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14669"
}
```



---

archive/issue_comments_055722.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-30T20:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55722",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_055723.json:
```json
{
    "body": "<a id='comment:9'></a>It doesn't seem like the problem is fixed if you have to use `...` in the doctest. So I'm not sure we should remove the comment, but I haven't looked to deep into this.",
    "created_at": "2017-03-30T22:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55723",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>It doesn't seem like the problem is fixed if you have to use `...` in the doctest. So I'm not sure we should remove the comment, but I haven't looked to deep into this.



---

archive/issue_comments_055724.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2017-03-31T06:56:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55724",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_055725.json:
```json
{
    "body": "<a id='comment:10'></a>Indeed, I also have some doubts. Let us check \"needs_info\"\n\nThe `...` are there to replace *huge* numbers. Maybe we should keep the top few digits ?",
    "created_at": "2017-03-31T06:56:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55725",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>Indeed, I also have some doubts. Let us check "needs_info"

The `...` are there to replace *huge* numbers. Maybe we should keep the top few digits ?



---

archive/issue_comments_055726.json:
```json
{
    "body": "Changing commit from \"716ac65de8e0001dfb4bd0e3add639c1a83eb98d\" to \"140579b4c2a251712763e21001df9aacce2b8c90\"",
    "created_at": "2017-04-01T16:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55726",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "716ac65de8e0001dfb4bd0e3add639c1a83eb98d" to "140579b4c2a251712763e21001df9aacce2b8c90"



---

archive/issue_comments_055727.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-01T16:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55727",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_055728.json:
```json
{
    "body": "<a id='comment:12'></a>Here is another try, with green bot. I changed the term order so that the Groebner basis has much smaller coefficients. Maybe this should be tested on diverse machines.",
    "created_at": "2017-04-01T19:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55728",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>Here is another try, with green bot. I changed the term order so that the Groebner basis has much smaller coefficients. Maybe this should be tested on diverse machines.



---

archive/issue_comments_055729.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2017-04-01T19:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55729",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_055730.json:
```json
{
    "body": "<a id='comment:14'></a>maybe this is good enough, I don't know..",
    "created_at": "2017-04-04T19:13:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55730",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>maybe this is good enough, I don't know..



---

archive/issue_comments_055731.json:
```json
{
    "body": "<a id='comment:15'></a>Hmm...I'm now not so sure what the point of the doctest is. From the description above it looks more like the minimal integer that is in the ideal is the important point rather than the integers that are part of the binomial generators. I'm cc-ing Simon to see if he has a thought on this. Yet, this was last touched in 2009, so maybe we can just `...` the binomial term integers and be done with it.",
    "created_at": "2017-04-04T19:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55731",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>Hmm...I'm now not so sure what the point of the doctest is. From the description above it looks more like the minimal integer that is in the ideal is the important point rather than the integers that are part of the binomial generators. I'm cc-ing Simon to see if he has a thought on this. Yet, this was last touched in 2009, so maybe we can just `...` the binomial term integers and be done with it.



---

archive/issue_comments_055732.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [tscrim](#comment%3A15):\n> Hmm...I'm now not so sure what the point of the doctest is. From the description above it looks more like the minimal integer that is in the ideal is the important point rather than the integers that are part of the binomial generators. I'm cc-ing Simon to see if he has a thought on this.\n\n\nI don't know anything about the theory of d-Gr\u00f6bner bases. However, from the explanation in the doctest, it seems to me that the integers in the binomial generators do not matter (at least not for the test). It seems to me that the point of the example is to show that\n- there is an integer in the d_basis, and\n- the prime factors of that integer have the property that the original system has solutions modulo that prime.",
    "created_at": "2017-04-04T19:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55732",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:16'></a>Replying to [tscrim](#comment%3A15):
> Hmm...I'm now not so sure what the point of the doctest is. From the description above it looks more like the minimal integer that is in the ideal is the important point rather than the integers that are part of the binomial generators. I'm cc-ing Simon to see if he has a thought on this.


I don't know anything about the theory of d-Gröbner bases. However, from the explanation in the doctest, it seems to me that the integers in the binomial generators do not matter (at least not for the test). It seems to me that the point of the example is to show that
- there is an integer in the d_basis, and
- the prime factors of that integer have the property that the original system has solutions modulo that prime.



---

archive/issue_comments_055733.json:
```json
{
    "body": "<a id='comment:17'></a>Thanks Simon.\n\nSo shall we revert back to 716ac65?",
    "created_at": "2017-04-05T16:33:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55733",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>Thanks Simon.

So shall we revert back to 716ac65?



---

archive/issue_comments_055734.json:
```json
{
    "body": "<a id='comment:18'></a>IMHO, the current branch should be just as good. I would rather try to let this in and see if the buildbots of Volker report any failure on apples and oranges.",
    "created_at": "2017-04-05T18:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55734",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>IMHO, the current branch should be just as good. I would rather try to let this in and see if the buildbots of Volker report any failure on apples and oranges.



---

archive/issue_comments_055735.json:
```json
{
    "body": "<a id='comment:19'></a>Okay, then if you break the long line into each of the generators, you can set a positive review on my behalf.",
    "created_at": "2017-04-05T21:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55735",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:19'></a>Okay, then if you break the long line into each of the generators, you can set a positive review on my behalf.



---

archive/issue_comments_055736.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2017-04-05T21:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55736",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_055737.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-06T06:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_055738.json:
```json
{
    "body": "Changing commit from \"140579b4c2a251712763e21001df9aacce2b8c90\" to \"39616a708fcbeadc905da86fe3eeb0a63155c244\"",
    "created_at": "2017-04-06T06:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "140579b4c2a251712763e21001df9aacce2b8c90" to "39616a708fcbeadc905da86fe3eeb0a63155c244"



---

archive/issue_comments_055739.json:
```json
{
    "body": "<a id='comment:21'></a>ok, done. Thanks. Setting to positive",
    "created_at": "2017-04-06T06:20:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55739",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>ok, done. Thanks. Setting to positive



---

archive/issue_comments_055740.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-06T06:20:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55740",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_055741.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-07T22:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55741",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_014670.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-04-07T22:24:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6265#event-14670"
}
```



---

archive/issue_comments_055742.json:
```json
{
    "body": "Changing branch from \"u/chapoton/6265\" to \"39616a708fcbeadc905da86fe3eeb0a63155c244\"",
    "created_at": "2017-04-07T22:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6265",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6265#issuecomment-55742",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/6265" to "39616a708fcbeadc905da86fe3eeb0a63155c244"
