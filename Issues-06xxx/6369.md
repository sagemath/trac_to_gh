# Issue 6369: the sage cleaner should kill all notebook servers if sage that spawned them is killed

archive/issues_006369.json:
```json
{
    "assignees": [],
    "body": "Try this:\n\n1. `sage -notebook foo`\n\n2. Find the pid of the sage -notebook process with `ps ax |grep \"sage -notebook\"`\n\n3. Kill that process with `kill -9 [pid]`\n\n4. The notebook server is still going.  And now the only way to kill it is with `ps ax |grep tracd` and start killing things until you hit the right one.\n\nSince people, especially new sage users, often kill the notebook server by, e.g., clicking kill in a terminal or some other silly means, it would be much better if the sage-cleaner could at least step in and kill the notebook server, so it gets shut down cleanly (saving its state), and doesn't stop the notebook from running in the future (if it is always running, it can't run again), hence confusing users.\n\nTo do all this is probably as simple as calling one little register function in sage.misc.cleaner.\n\nAssignee: **@sagetrac-boothby**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6369_\n\n",
    "closed_at": "2020-03-29T02:13:09Z",
    "created_at": "2009-06-20T15:34:43Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/component%3A%20notebook",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "the sage cleaner should kill all notebook servers if sage that spawned them is killed",
    "type": "issue",
    "updated_at": "2020-03-29T02:13:09Z",
    "url": "https://github.com/sagemath/sage/issues/6369",
    "user": "https://github.com/williamstein"
}
```
Try this:

1. `sage -notebook foo`

2. Find the pid of the sage -notebook process with `ps ax |grep "sage -notebook"`

3. Kill that process with `kill -9 [pid]`

4. The notebook server is still going.  And now the only way to kill it is with `ps ax |grep tracd` and start killing things until you hit the right one.

Since people, especially new sage users, often kill the notebook server by, e.g., clicking kill in a terminal or some other silly means, it would be much better if the sage-cleaner could at least step in and kill the notebook server, so it gets shut down cleanly (saving its state), and doesn't stop the notebook from running in the future (if it is always running, it can't run again), hence confusing users.

To do all this is probably as simple as calling one little register function in sage.misc.cleaner.

Assignee: **@sagetrac-boothby**

_Issue created by migration from https://trac.sagemath.org/ticket/6369_





---

archive/issue_events_069050.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-06-20T15:34:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69050"
}
```



---

archive/issue_events_069051.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-06-20T15:34:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20notebook",
    "label_color": "000080",
    "label_name": "component: notebook",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69051"
}
```



---

archive/issue_events_069052.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-06-20T15:34:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69052"
}
```



---

archive/issue_events_069053.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2009-06-20T15:34:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69053"
}
```



---

archive/issue_comments_044071.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,11 @@\n Try this:\n \n 1. `sage -notebook foo`\n+\n 2. Find the pid of the sage -notebook process with `ps ax |grep \"sage -notebook\"`\n+\n 3. Kill that process with `kill -9 [pid]`\n+\n 4. The notebook server is still going.  And now the only way to kill it is with `ps ax |grep tracd` and start killing things until you hit the right one.\n \n Since people, especially new sage users, often kill the notebook server by, e.g., clicking kill in a terminal or some other silly means, it would be much better if the sage-cleaner could at least step in and kill the notebook server, so it gets shut down cleanly (saving its state), and doesn't stop the notebook from running in the future (if it is always running, it can't run again), hence confusing users.\n``````\n",
    "created_at": "2009-06-20T15:35:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6369#issuecomment-44071",
    "user": "https://github.com/williamstein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,11 @@
 Try this:
 
 1. `sage -notebook foo`
+
 2. Find the pid of the sage -notebook process with `ps ax |grep "sage -notebook"`
+
 3. Kill that process with `kill -9 [pid]`
+
 4. The notebook server is still going.  And now the only way to kill it is with `ps ax |grep tracd` and start killing things until you hit the right one.
 
 Since people, especially new sage users, often kill the notebook server by, e.g., clicking kill in a terminal or some other silly means, it would be much better if the sage-cleaner could at least step in and kill the notebook server, so it gets shut down cleanly (saving its state), and doesn't stop the notebook from running in the future (if it is always running, it can't run again), hence confusing users.
``````




---

archive/issue_comments_044072.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nThis seems to be fixed now. `kill [pid]` kills the notebook as well. SIG_KILL doesn't seem like it will allow sage-cleaner to kill the notebook since it will be killed immediately. Confirm and close?",
    "created_at": "2010-01-19T07:06:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6369#issuecomment-44072",
    "user": "https://github.com/TimDumol"
}
```

<div id="comment:2" align="right">Comment 2</div>

This seems to be fixed now. `kill [pid]` kills the notebook as well. SIG_KILL doesn't seem like it will allow sage-cleaner to kill the notebook since it will be killed immediately. Confirm and close?



---

archive/issue_comments_044073.json:
```json
{
    "body": "Work Issues: **Close/mark as fixed?**",
    "created_at": "2010-01-19T07:13:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6369#issuecomment-44073",
    "user": "https://github.com/TimDumol"
}
```

Work Issues: **Close/mark as fixed?**



---

archive/issue_events_069054.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69054"
}
```



---

archive/issue_events_069055.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69055"
}
```



---

archive/issue_events_069056.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69056"
}
```



---

archive/issue_events_069057.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69057"
}
```



---

archive/issue_events_069058.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69058"
}
```



---

archive/issue_events_069059.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69059"
}
```



---

archive/issue_events_069060.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69060"
}
```



---

archive/issue_events_069061.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69061"
}
```



---

archive/issue_comments_044074.json:
```json
{
    "body": "Changed work issues from **Close/mark as fixed?** to none",
    "created_at": "2014-12-10T19:21:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6369#issuecomment-44074",
    "user": "https://github.com/kcrisman"
}
```

Changed work issues from **Close/mark as fixed?** to none



---

archive/issue_comments_044075.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nThis definitely kills the process but also definitely keeps the server going!  (And a number of other processes as well.)",
    "created_at": "2014-12-10T19:21:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6369#issuecomment-44075",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:8" align="right">Comment 8</div>

This definitely kills the process but also definitely keeps the server going!  (And a number of other processes as well.)



---

archive/issue_events_069062.json:
```json
{
    "actor": "https://github.com/sagetrac-boothby",
    "created_at": "2020-03-29T02:13:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69062"
}
```



---

archive/issue_events_069063.json:
```json
{
    "actor": "https://github.com/sagetrac-boothby",
    "created_at": "2020-03-29T02:13:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69063"
}
```



---

archive/issue_comments_044076.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nClosing deprecated notebook tickets",
    "created_at": "2020-03-29T02:13:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6369#issuecomment-44076",
    "user": "https://github.com/sagetrac-boothby"
}
```

<div id="comment:9" align="right">Comment 9</div>

Closing deprecated notebook tickets



---

archive/issue_events_069064.json:
```json
{
    "actor": "https://github.com/sagetrac-boothby",
    "created_at": "2020-03-29T02:13:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6369",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6369#event-69064"
}
```
