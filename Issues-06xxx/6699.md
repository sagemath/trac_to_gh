# Issue 6699: [with spkg and patch] Update to Maxima 5.19.1 (particularly important for Solaris support).

archive/issues_006699.json:
```json
{
    "assignees": [],
    "body": "I've made a new .spkg file for Maxima based on the latest 5.19.0 release. \n\nhttp://sage.math.washington.edu/home/kirkby/Solaris-fixes/maxima-5.19.0/maxima-5.19.0.spkg\n\nI gather updates to Maxima have caused some issues in the past in Sage, so I don't know how this will go. \n\nI've also created a new .spkg file for ECL, based on the latest 9.8.1 source code (despite the fact the web site shows 9.7.1 as the latest, if you go to the downloads page, you can get 9.8.1). \n\nhttp://sage.math.washington.edu/home/kirkby/Solaris-fixes/ecl-9.8.1/ecl-9.8.1.spkg\n\nThis updated ECL resolves Trac #6564, as ECL 9.8.1 works on Solaris SPARC, but ECL 9.7.1 does not.  \n\nIf the updated ECL is applied (so solving #6564), Maxima **must** be updated, as improved type-check in ECL has found a bug that existed in Maxima for 35 years! (confirmed by Maxima developers). \n\nSo in summary\n\n* An update to ECL 9.8.1 is needed for Solaris SPARC, as 9.7.1 will not build. (Track #6564)\n* ECL 9.8.1 refuses to build Maxima due to a Maxima bug.\n* This new .spkg for Maxima is necessary in order that Maxima can be used on Solaris. \n\nThis suggests to me that if there are issues in Sage with this latest Maxima, they should be resolved. There is no point staying with an old version of Maxima, which needs an old version of ECL, which will not build on Solaris. \n\nI appreciate things might not be as simple as that. \n\nDave \n\n\n\n**Assignee:** mabshoff\n\n**Keywords:** maxima\n\n**Author:** David Kirkby, Alex Ghitza\n\n**Reviewer:** Adam Webb, Minh Van Nguyen\n\n**Merged:** Sage 4.1.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/6699\n\n",
    "closed_at": "2009-09-02T10:52:22Z",
    "created_at": "2009-08-09T07:53:37Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.1.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "[with spkg and patch] Update to Maxima 5.19.1 (particularly important for Solaris support).",
    "type": "issue",
    "updated_at": "2009-09-04T06:40:15Z",
    "url": "https://github.com/sagemath/sage/issues/6699",
    "user": "https://github.com/sagetrac-drkirkby"
}
```
I've made a new .spkg file for Maxima based on the latest 5.19.0 release. 

http://sage.math.washington.edu/home/kirkby/Solaris-fixes/maxima-5.19.0/maxima-5.19.0.spkg

I gather updates to Maxima have caused some issues in the past in Sage, so I don't know how this will go. 

I've also created a new .spkg file for ECL, based on the latest 9.8.1 source code (despite the fact the web site shows 9.7.1 as the latest, if you go to the downloads page, you can get 9.8.1). 

http://sage.math.washington.edu/home/kirkby/Solaris-fixes/ecl-9.8.1/ecl-9.8.1.spkg

This updated ECL resolves Trac #6564, as ECL 9.8.1 works on Solaris SPARC, but ECL 9.7.1 does not.  

If the updated ECL is applied (so solving #6564), Maxima **must** be updated, as improved type-check in ECL has found a bug that existed in Maxima for 35 years! (confirmed by Maxima developers). 

So in summary

* An update to ECL 9.8.1 is needed for Solaris SPARC, as 9.7.1 will not build. (Track #6564)
* ECL 9.8.1 refuses to build Maxima due to a Maxima bug.
* This new .spkg for Maxima is necessary in order that Maxima can be used on Solaris. 

This suggests to me that if there are issues in Sage with this latest Maxima, they should be resolved. There is no point staying with an old version of Maxima, which needs an old version of ECL, which will not build on Solaris. 

I appreciate things might not be as simple as that. 

Dave 



**Assignee:** mabshoff

**Keywords:** maxima

**Author:** David Kirkby, Alex Ghitza

**Reviewer:** Adam Webb, Minh Van Nguyen

**Merged:** Sage 4.1.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/6699





---

archive/issue_events_067504.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-08-09T07:53:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "milestone_number": null,
    "milestone_title": "sage-4.1.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67504"
}
```



---

archive/issue_events_067505.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-08-09T07:53:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "08517b",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67505"
}
```



---

archive/issue_events_067506.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-08-09T07:53:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67506"
}
```



---

archive/issue_events_067507.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-08-09T07:53:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67507"
}
```



---

archive/issue_comments_048504.json:
```json
{
    "body": "**Author:** David Kirkby",
    "created_at": "2009-08-09T10:18:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48504",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

**Author:** David Kirkby



---

archive/issue_comments_048505.json:
```json
{
    "body": "**Assignee:** mabshoff",
    "created_at": "2009-08-16T05:52:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48505",
    "user": "https://github.com/aghitza"
}
```

**Assignee:** mabshoff



---

archive/issue_events_067508.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-08-16T05:52:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "08517b",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67508"
}
```



---

archive/issue_events_067509.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-08-16T05:52:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages",
    "label_color": "08517b",
    "label_name": "component: packages",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67509"
}
```



---

archive/issue_comments_048506.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nStarting from sage 4.1.1, I installed ecl-9.8.3.spkg and maxima-5.19.0.spkg. The following errors occurred.\n\n```\nsage -t -long -optional \"devel/sage-myver/sage/interfaces/maxima.py\"\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 116:\n    sage: a.expand()\nExpected:\n    29*sqrt(2)+41\nGot:\n    3*2^(7/2)+5*sqrt(2)+41\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 227:\n    sage: A.eigenvectors()\nExpected:\n    [[[0,4],[3,1]],[1,0,0,-4],[0,1,0,-2],[0,0,1,-4/3],[1,2,3,4]]\nGot:\n    [[[0,4],[3,1]],[[[1,0,0,-4],[0,1,0,-2],[0,0,1,-4/3]],[[1,2,3,4]]]]\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 275:\n    sage: maxima(\"laplace(diff(x(t),t),t,s)\")\nExpected:\n    s*?%laplace(x(t),t,s)-x(0)\nGot:\n    s*'laplace(x(t),t,s)-x(0)\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 280:\n    sage: maxima(\"laplace(diff(x(t),t,2),t,s)\")\nExpected:\n    -?%at('diff(x(t),t,1),t=0)+s^2*?%laplace(x(t),t,s)-x(0)*s\nGot:\n    -?%at('diff(x(t),t,1),t=0)+s^2*'laplace(x(t),t,s)-x(0)*s\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 426:\n    sage: t.limit(Ax=0,dir='above')\nExpected:\n    Traceback (most recent call last):\n    ...\n    TypeError: Computation failed since Maxima requested additional constraints (try the command 'assume(By^2+Bx^2>0)' before integral or limit evaluation, for example):\n    Is By^2+Bx^2  positive or zero?\nGot:\n    0\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 824:\n    sage: maxima._command_runner('describe', 'gcd')\nExpected:\n    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n    ...\nGot:\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp\"\n    <BLANKLINE>\n     -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n         Returns the greatest common divisor of <p_1> and <p_2>.  The flag\n         `gcd' determines which algorithm is employed.  Setting `gcd' to\n         `ez', `subres', `red', or `spmod' selects the `ezgcd',\n         subresultant `prs', reduced, or modular algorithm, respectively.\n         If `gcd' `false' then `gcd (<p_1>, <p_2>, <x>)' always returns 1\n         for all <x>.  Many functions (e.g.  `ratsimp', `factor', etc.)\n         cause gcd's to be taken implicitly.  For homogeneous polynomials\n         it is recommended that `gcd' equal to `subres' be used.  To take\n         the gcd when an algebraic is present, e.g., `gcd (<x>^2 -\n         2*sqrt(2)*<x> + 2, <x> - sqrt(2))', `algebraic' must be `true' and\n         `gcd' must not be `ez'.\n    <BLANKLINE>\n         The `gcd' flag, default: `spmod', if `false' will also prevent the\n         greatest common divisor from being taken when expressions are\n         converted to canonical rational expression (CRE) form.  This will\n         sometimes speed the calculation if gcds are not required.\n    <BLANKLINE>\n    <BLANKLINE>\n      There are also some inexact matches for `gcd'.\n      Try `?? gcd' to see them.\n    <BLANKLINE>\n                                         true\n    <BLANKLINE>\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 845:\n    sage: maxima.help('gcd')\nExpected:\n    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n    ...\nGot:\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp\"\n    <BLANKLINE>\n     -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n         Returns the greatest common divisor of <p_1> and <p_2>.  The flag\n         `gcd' determines which algorithm is employed.  Setting `gcd' to\n         `ez', `subres', `red', or `spmod' selects the `ezgcd',\n         subresultant `prs', reduced, or modular algorithm, respectively.\n         If `gcd' `false' then `gcd (<p_1>, <p_2>, <x>)' always returns 1\n         for all <x>.  Many functions (e.g.  `ratsimp', `factor', etc.)\n         cause gcd's to be taken implicitly.  For homogeneous polynomials\n         it is recommended that `gcd' equal to `subres' be used.  To take\n         the gcd when an algebraic is present, e.g., `gcd (<x>^2 -\n         2*sqrt(2)*<x> + 2, <x> - sqrt(2))', `algebraic' must be `true' and\n         `gcd' must not be `ez'.\n    <BLANKLINE>\n         The `gcd' flag, default: `spmod', if `false' will also prevent the\n         greatest common divisor from being taken when expressions are\n         converted to canonical rational expression (CRE) form.  This will\n         sometimes speed the calculation if gcds are not required.\n    <BLANKLINE>\n    <BLANKLINE>\n      There are also some inexact matches for `gcd'.\n      Try `?? gcd' to see them.\n    <BLANKLINE>\n                                         true\n    <BLANKLINE>\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 855:\n    sage: maxima.example('arrays')\nExpected:\n    a[n]:=n*a[n-1]\n                                    a  := n a\n                                     n       n - 1\n    a[0]:1\n    a[5]\n                                          120\n    a[n]:=n\n    a[6]\n                                           6\n    a[4]\n                                          24\n                                         done\nGot:\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp\"\n    a[n]:=n*a[n-1]\n                                    a  := n a\n                                     n       n - 1\n    a[0]:1\n    a[5]\n                                          120\n    a[n]:=n\n    a[6]\n                                           6\n    a[4]\n                                          24\n                                         done\n    <BLANKLINE>\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 892:\n    sage: sorted(maxima.completions('gc', verbose=False))\nExpected:\n    ['gc', 'gcd', 'gcdex', 'gcfactor', 'gcprint', 'gctime']\nGot:\n    ['propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)']\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 907:\n    sage: sorted(maxima._commands(verbose=False))\nExpected:\n    ['Alpha',\n     'Beta',\n     ...\n     'zunderflow']\nGot:\n    ['propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)']\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 926:\n    sage: 'gcd' in t\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 1169:\n    sage: maxima.version()\nExpected:\n    '5.16.3'\nGot:\n    'Loading'\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 1994:\n    sage: f.numer()         # I wonder how to get a real number (~1.463)??\nExpected:\n    -.8862269254527579*%i*erf(%i)\nGot:\n    1.462651745907182\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 2174:\n    sage: 'gcd' in m.trait_names()\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 2274:\n    sage: m.gcd._sage_doc_()\nExpected:\n    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n    ...\nGot:\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp\"\n    <BLANKLINE>\n     -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n         Returns the greatest common divisor of <p_1> and <p_2>.  The flag\n         `gcd' determines which algorithm is employed.  Setting `gcd' to\n         `ez', `subres', `red', or `spmod' selects the `ezgcd',\n         subresultant `prs', reduced, or modular algorithm, respectively.\n         If `gcd' `false' then `gcd (<p_1>, <p_2>, <x>)' always returns 1\n         for all <x>.  Many functions (e.g.  `ratsimp', `factor', etc.)\n         cause gcd's to be taken implicitly.  For homogeneous polynomials\n         it is recommended that `gcd' equal to `subres' be used.  To take\n         the gcd when an algebraic is present, e.g., `gcd (<x>^2 -\n         2*sqrt(2)*<x> + 2, <x> - sqrt(2))', `algebraic' must be `true' and\n         `gcd' must not be `ez'.\n    <BLANKLINE>\n         The `gcd' flag, default: `spmod', if `false' will also prevent the\n         greatest common divisor from being taken when expressions are\n         converted to canonical rational expression (CRE) form.  This will\n         sometimes speed the calculation if gcds are not required.\n    <BLANKLINE>\n    <BLANKLINE>\n      There are also some inexact matches for `gcd'.\n      Try `?? gcd' to see them.\n    <BLANKLINE>\n                                         true\n    <BLANKLINE>\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 2285:\n    sage: maxima.gcd._sage_doc_()\nExpected:\n    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n    ...\nGot:\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas\"\n    ;;; Loading #P\"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp\"\n    <BLANKLINE>\n     -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)\n         Returns the greatest common divisor of <p_1> and <p_2>.  The flag\n         `gcd' determines which algorithm is employed.  Setting `gcd' to\n         `ez', `subres', `red', or `spmod' selects the `ezgcd',\n         subresultant `prs', reduced, or modular algorithm, respectively.\n         If `gcd' `false' then `gcd (<p_1>, <p_2>, <x>)' always returns 1\n         for all <x>.  Many functions (e.g.  `ratsimp', `factor', etc.)\n         cause gcd's to be taken implicitly.  For homogeneous polynomials\n         it is recommended that `gcd' equal to `subres' be used.  To take\n         the gcd when an algebraic is present, e.g., `gcd (<x>^2 -\n         2*sqrt(2)*<x> + 2, <x> - sqrt(2))', `algebraic' must be `true' and\n         `gcd' must not be `ez'.\n    <BLANKLINE>\n         The `gcd' flag, default: `spmod', if `false' will also prevent the\n         greatest common divisor from being taken when expressions are\n         converted to canonical rational expression (CRE) form.  This will\n         sometimes speed the calculation if gcds are not required.\n    <BLANKLINE>\n    <BLANKLINE>\n      There are also some inexact matches for `gcd'.\n      Try `?? gcd' to see them.\n    <BLANKLINE>\n                                         true\n    <BLANKLINE>\n**********************************************************************\nFile \"/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py\", line 2667:\n    sage: maxima_version()\nExpected:\n    '5.16.3'\nGot:\n    'Loading'\n**********************************************************************\n13 items had failures:\n   5 of  95 in __main__.example_0\n   1 of   3 in __main__.example_12\n   1 of   3 in __main__.example_13\n   1 of   3 in __main__.example_14\n   1 of   3 in __main__.example_16\n   1 of   3 in __main__.example_17\n   1 of   5 in __main__.example_18\n   1 of   3 in __main__.example_29\n   1 of  10 in __main__.example_59\n   1 of   4 in __main__.example_68\n   1 of   4 in __main__.example_72\n   1 of   3 in __main__.example_73\n   1 of   4 in __main__.example_93\n***Test Failed*** 17 failures.\nFor whitespace errors, see the file /home/adamwebb/local/sage/tmp/.doctest_maxima.py\n\t [17.9 s]\nexit code: 1024\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t -long -optional \"devel/sage-myver/sage/interfaces/maxima.py\"\nTotal time for all tests: 17.9 seconds\n```\n\nIt appears that the output from maxima has changed in a number of cases and is returning more comments and the like. I don't know if this is the correct/new behaviour of maxima. \n\nAdam",
    "created_at": "2009-08-17T09:54:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48506",
    "user": "https://github.com/maxthemouse"
}
```

<a id='comment:3'>**Comment 3:**</a>
Starting from sage 4.1.1, I installed ecl-9.8.3.spkg and maxima-5.19.0.spkg. The following errors occurred.

```
sage -t -long -optional "devel/sage-myver/sage/interfaces/maxima.py"
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 116:
    sage: a.expand()
Expected:
    29*sqrt(2)+41
Got:
    3*2^(7/2)+5*sqrt(2)+41
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 227:
    sage: A.eigenvectors()
Expected:
    [[[0,4],[3,1]],[1,0,0,-4],[0,1,0,-2],[0,0,1,-4/3],[1,2,3,4]]
Got:
    [[[0,4],[3,1]],[[[1,0,0,-4],[0,1,0,-2],[0,0,1,-4/3]],[[1,2,3,4]]]]
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 275:
    sage: maxima("laplace(diff(x(t),t),t,s)")
Expected:
    s*?%laplace(x(t),t,s)-x(0)
Got:
    s*'laplace(x(t),t,s)-x(0)
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 280:
    sage: maxima("laplace(diff(x(t),t,2),t,s)")
Expected:
    -?%at('diff(x(t),t,1),t=0)+s^2*?%laplace(x(t),t,s)-x(0)*s
Got:
    -?%at('diff(x(t),t,1),t=0)+s^2*'laplace(x(t),t,s)-x(0)*s
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 426:
    sage: t.limit(Ax=0,dir='above')
Expected:
    Traceback (most recent call last):
    ...
    TypeError: Computation failed since Maxima requested additional constraints (try the command 'assume(By^2+Bx^2>0)' before integral or limit evaluation, for example):
    Is By^2+Bx^2  positive or zero?
Got:
    0
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 824:
    sage: maxima._command_runner('describe', 'gcd')
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp"
    <BLANKLINE>
     -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
         Returns the greatest common divisor of <p_1> and <p_2>.  The flag
         `gcd' determines which algorithm is employed.  Setting `gcd' to
         `ez', `subres', `red', or `spmod' selects the `ezgcd',
         subresultant `prs', reduced, or modular algorithm, respectively.
         If `gcd' `false' then `gcd (<p_1>, <p_2>, <x>)' always returns 1
         for all <x>.  Many functions (e.g.  `ratsimp', `factor', etc.)
         cause gcd's to be taken implicitly.  For homogeneous polynomials
         it is recommended that `gcd' equal to `subres' be used.  To take
         the gcd when an algebraic is present, e.g., `gcd (<x>^2 -
         2*sqrt(2)*<x> + 2, <x> - sqrt(2))', `algebraic' must be `true' and
         `gcd' must not be `ez'.
    <BLANKLINE>
         The `gcd' flag, default: `spmod', if `false' will also prevent the
         greatest common divisor from being taken when expressions are
         converted to canonical rational expression (CRE) form.  This will
         sometimes speed the calculation if gcds are not required.
    <BLANKLINE>
    <BLANKLINE>
      There are also some inexact matches for `gcd'.
      Try `?? gcd' to see them.
    <BLANKLINE>
                                         true
    <BLANKLINE>
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 845:
    sage: maxima.help('gcd')
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp"
    <BLANKLINE>
     -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
         Returns the greatest common divisor of <p_1> and <p_2>.  The flag
         `gcd' determines which algorithm is employed.  Setting `gcd' to
         `ez', `subres', `red', or `spmod' selects the `ezgcd',
         subresultant `prs', reduced, or modular algorithm, respectively.
         If `gcd' `false' then `gcd (<p_1>, <p_2>, <x>)' always returns 1
         for all <x>.  Many functions (e.g.  `ratsimp', `factor', etc.)
         cause gcd's to be taken implicitly.  For homogeneous polynomials
         it is recommended that `gcd' equal to `subres' be used.  To take
         the gcd when an algebraic is present, e.g., `gcd (<x>^2 -
         2*sqrt(2)*<x> + 2, <x> - sqrt(2))', `algebraic' must be `true' and
         `gcd' must not be `ez'.
    <BLANKLINE>
         The `gcd' flag, default: `spmod', if `false' will also prevent the
         greatest common divisor from being taken when expressions are
         converted to canonical rational expression (CRE) form.  This will
         sometimes speed the calculation if gcds are not required.
    <BLANKLINE>
    <BLANKLINE>
      There are also some inexact matches for `gcd'.
      Try `?? gcd' to see them.
    <BLANKLINE>
                                         true
    <BLANKLINE>
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 855:
    sage: maxima.example('arrays')
Expected:
    a[n]:=n*a[n-1]
                                    a  := n a
                                     n       n - 1
    a[0]:1
    a[5]
                                          120
    a[n]:=n
    a[6]
                                           6
    a[4]
                                          24
                                         done
Got:
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp"
    a[n]:=n*a[n-1]
                                    a  := n a
                                     n       n - 1
    a[0]:1
    a[5]
                                          120
    a[n]:=n
    a[6]
                                           6
    a[4]
                                          24
                                         done
    <BLANKLINE>
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 892:
    sage: sorted(maxima.completions('gc', verbose=False))
Expected:
    ['gc', 'gcd', 'gcdex', 'gcfactor', 'gcprint', 'gctime']
Got:
    ['propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)']
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 907:
    sage: sorted(maxima._commands(verbose=False))
Expected:
    ['Alpha',
     'Beta',
     ...
     'zunderflow']
Got:
    ['propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)', 'propos:Theargumenthastobeastring.--anerror.Todebugthistrydebugmode(true)']
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 926:
    sage: 'gcd' in t
Expected:
    True
Got:
    False
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 1169:
    sage: maxima.version()
Expected:
    '5.16.3'
Got:
    'Loading'
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 1994:
    sage: f.numer()         # I wonder how to get a real number (~1.463)??
Expected:
    -.8862269254527579*%i*erf(%i)
Got:
    1.462651745907182
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 2174:
    sage: 'gcd' in m.trait_names()
Expected:
    True
Got:
    False
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 2274:
    sage: m.gcd._sage_doc_()
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp"
    <BLANKLINE>
     -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
         Returns the greatest common divisor of <p_1> and <p_2>.  The flag
         `gcd' determines which algorithm is employed.  Setting `gcd' to
         `ez', `subres', `red', or `spmod' selects the `ezgcd',
         subresultant `prs', reduced, or modular algorithm, respectively.
         If `gcd' `false' then `gcd (<p_1>, <p_2>, <x>)' always returns 1
         for all <x>.  Many functions (e.g.  `ratsimp', `factor', etc.)
         cause gcd's to be taken implicitly.  For homogeneous polynomials
         it is recommended that `gcd' equal to `subres' be used.  To take
         the gcd when an algebraic is present, e.g., `gcd (<x>^2 -
         2*sqrt(2)*<x> + 2, <x> - sqrt(2))', `algebraic' must be `true' and
         `gcd' must not be `ez'.
    <BLANKLINE>
         The `gcd' flag, default: `spmod', if `false' will also prevent the
         greatest common divisor from being taken when expressions are
         converted to canonical rational expression (CRE) form.  This will
         sometimes speed the calculation if gcds are not required.
    <BLANKLINE>
    <BLANKLINE>
      There are also some inexact matches for `gcd'.
      Try `?? gcd' to see them.
    <BLANKLINE>
                                         true
    <BLANKLINE>
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 2285:
    sage: maxima.gcd._sage_doc_()
Expected:
    -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
    ...
Got:
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/defsystem.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/cmp.fas"
    ;;; Loading #P"/home/adamwebb/local/sage/local/lib/ecl-9.8.3/sysfun.lsp"
    <BLANKLINE>
     -- Function: gcd (<p_1>, <p_2>, <x_1>, ...)
         Returns the greatest common divisor of <p_1> and <p_2>.  The flag
         `gcd' determines which algorithm is employed.  Setting `gcd' to
         `ez', `subres', `red', or `spmod' selects the `ezgcd',
         subresultant `prs', reduced, or modular algorithm, respectively.
         If `gcd' `false' then `gcd (<p_1>, <p_2>, <x>)' always returns 1
         for all <x>.  Many functions (e.g.  `ratsimp', `factor', etc.)
         cause gcd's to be taken implicitly.  For homogeneous polynomials
         it is recommended that `gcd' equal to `subres' be used.  To take
         the gcd when an algebraic is present, e.g., `gcd (<x>^2 -
         2*sqrt(2)*<x> + 2, <x> - sqrt(2))', `algebraic' must be `true' and
         `gcd' must not be `ez'.
    <BLANKLINE>
         The `gcd' flag, default: `spmod', if `false' will also prevent the
         greatest common divisor from being taken when expressions are
         converted to canonical rational expression (CRE) form.  This will
         sometimes speed the calculation if gcds are not required.
    <BLANKLINE>
    <BLANKLINE>
      There are also some inexact matches for `gcd'.
      Try `?? gcd' to see them.
    <BLANKLINE>
                                         true
    <BLANKLINE>
**********************************************************************
File "/home/adamwebb/local/sage/devel/sage-myver/sage/interfaces/maxima.py", line 2667:
    sage: maxima_version()
Expected:
    '5.16.3'
Got:
    'Loading'
**********************************************************************
13 items had failures:
   5 of  95 in __main__.example_0
   1 of   3 in __main__.example_12
   1 of   3 in __main__.example_13
   1 of   3 in __main__.example_14
   1 of   3 in __main__.example_16
   1 of   3 in __main__.example_17
   1 of   5 in __main__.example_18
   1 of   3 in __main__.example_29
   1 of  10 in __main__.example_59
   1 of   4 in __main__.example_68
   1 of   4 in __main__.example_72
   1 of   3 in __main__.example_73
   1 of   4 in __main__.example_93
***Test Failed*** 17 failures.
For whitespace errors, see the file /home/adamwebb/local/sage/tmp/.doctest_maxima.py
	 [17.9 s]
exit code: 1024
 
----------------------------------------------------------------------
The following tests failed:


	sage -t -long -optional "devel/sage-myver/sage/interfaces/maxima.py"
Total time for all tests: 17.9 seconds
```

It appears that the output from maxima has changed in a number of cases and is returning more comments and the like. I don't know if this is the correct/new behaviour of maxima. 

Adam



---

archive/issue_comments_048507.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nSo it seems that a number of doctests need to be fixed.  I'm marking this as \"needs work\", although the spkg itself seems fine, we just need a patch that fixes the doctests.\n\nNote that interfaces/maxima.py is most likely not the only file affected by this.",
    "created_at": "2009-08-17T10:06:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48507",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:4'>**Comment 4:**</a>
So it seems that a number of doctests need to be fixed.  I'm marking this as "needs work", although the spkg itself seems fine, we just need a patch that fixes the doctests.

Note that interfaces/maxima.py is most likely not the only file affected by this.



---

archive/issue_events_067510.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-08-17T10:06:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67510"
}
```



---

archive/issue_events_067511.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2009-08-21T05:59:49Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "rename": {
        "from": "Update to Maxima 5.19.0 (particularly important for Solaris support).",
        "to": "Update to Maxima 5.19.1 (particularly important for Solaris support)."
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67511"
}
```



---

archive/issue_comments_048508.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nAfter creating this ticket, a newer Maxima was released. The spkg can be found here\n\nhttp://sage.math.washington.edu/home/kirkby/Solaris-fixes/maxima-5.19.1/",
    "created_at": "2009-08-21T05:59:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48508",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:5'>**Comment 5:**</a>
After creating this ticket, a newer Maxima was released. The spkg can be found here

http://sage.math.washington.edu/home/kirkby/Solaris-fixes/maxima-5.19.1/



---

archive/issue_comments_048509.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nI'm attaching a patch that fixes all but one of the doctest failures observed on sage.math and other Linux machines.\n\nMost of these are very simple fixes due to (a) change of formatting of Maxima output or (b) new functionality in Maxima.  For anything else I have tried to comment on my fix in the corresponding file.  Where new answers appear due to new functionality, I checked these answers against Wolfram Alpha (yes, I know; I feel weird about this).\n\nAs far as I know there is one remaining doctest failures:\n\n```\nsage -t  \"expression.pyx\"                                   \n**********************************************************************\nFile \"/opt/sage-4.1.1/devel/sage-main/sage/symbolic/expression.pyx\", line 5541:\n    sage: solve(Q*sqrt(Q^2 + 2) - 1,Q)\nExpected:\n    [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]\nGot:\n    [Q == 1/sqrt(sqrt(2) + 1)]\n**********************************************************************\n```\n\nI think this is due to the fact that Maxima now only returns the real solution, and ignores the complex solution.  I'm not sure what we should do about this.\n\n\nNote that there are also some timeouts observed by David Kirkby on Solaris, but at least some of them are not Maxima-related so it would be better to deal with them in separate tickets.\n\nFinally, this patch puts together a number of tiny patches on a number of recently-opened tickets.  I've decided that it is quite a bit easier to just referee the whole thing, and definitely easier for me to maintain and make necessary modifications to a single patch rather than a dozen of them.",
    "created_at": "2009-08-21T13:03:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48509",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:6'>**Comment 6:**</a>
I'm attaching a patch that fixes all but one of the doctest failures observed on sage.math and other Linux machines.

Most of these are very simple fixes due to (a) change of formatting of Maxima output or (b) new functionality in Maxima.  For anything else I have tried to comment on my fix in the corresponding file.  Where new answers appear due to new functionality, I checked these answers against Wolfram Alpha (yes, I know; I feel weird about this).

As far as I know there is one remaining doctest failures:

```
sage -t  "expression.pyx"                                   
**********************************************************************
File "/opt/sage-4.1.1/devel/sage-main/sage/symbolic/expression.pyx", line 5541:
    sage: solve(Q*sqrt(Q^2 + 2) - 1,Q)
Expected:
    [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]
Got:
    [Q == 1/sqrt(sqrt(2) + 1)]
**********************************************************************
```

I think this is due to the fact that Maxima now only returns the real solution, and ignores the complex solution.  I'm not sure what we should do about this.


Note that there are also some timeouts observed by David Kirkby on Solaris, but at least some of them are not Maxima-related so it would be better to deal with them in separate tickets.

Finally, this patch puts together a number of tiny patches on a number of recently-opened tickets.  I've decided that it is quite a bit easier to just referee the whole thing, and definitely easier for me to maintain and make necessary modifications to a single patch rather than a dozen of them.



---

archive/issue_comments_048510.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"maxima\".",
    "created_at": "2009-08-21T13:03:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48510",
    "user": "https://github.com/aghitza"
}
```

**Changing keywords** from "" to "maxima".



---

archive/issue_comments_048511.json:
```json
{
    "body": "apply after the ecl and maxima spkg's",
    "created_at": "2009-08-21T13:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48511",
    "user": "https://github.com/aghitza"
}
```

apply after the ecl and maxima spkg's



---

archive/issue_comments_048512.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\n**Attachment:** [maxima_doctests.patch.gz](https://github.com/sagemath/sage/files/ticket6699/maxima_doctests.patch.gz)\n\nReplying to [@aghitza](#comment%3A6):\n\n> ```\n> ```\n\n**********************************************************************\n File \"/opt/sage-4.1.1/devel/sage-main/sage/symbolic/expression.pyx\", line 5541:\n     sage: solve(Q*sqrt(Q^2 + 2) - 1,Q)\n Expected:\n     [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]\n Got:\n     [Q == 1/sqrt(sqrt(2) + 1)]\n **********************************************************************\n }}}\n> \n> I think this is due to the fact that Maxima now only returns the real solution, and ignores the complex solution.  I'm not sure what we should do about this.\n\nI think you are right. Maxima treats variables to be real by default. To see that in maxima\n\n```\nsage: !maxima\nMaxima 5.16.3 http://maxima.sourceforge.net\nUsing Lisp ECL 9.4.1\nDistributed under the GNU Public License. See the file COPYING.\nDedicated to the memory of William Schelter.\nThe function bug_report() provides bug reporting information.\n(%i1) conjugate(Q);\n(%o1)                                  Q\n```\n\nSo, if maxima is throwing away complex solution then its consistent with its own assumptions. \nUnless someone else has different opinion then we should simply accept what maxima is returning\nnow.",
    "created_at": "2009-08-21T13:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48512",
    "user": "https://github.com/golam-m-hossain"
}
```

<a id='comment:7'>**Comment 7:**</a>
**Attachment:** [maxima_doctests.patch.gz](https://github.com/sagemath/sage/files/ticket6699/maxima_doctests.patch.gz)

Replying to [@aghitza](#comment%3A6):

> ```
> ```

**********************************************************************
 File "/opt/sage-4.1.1/devel/sage-main/sage/symbolic/expression.pyx", line 5541:
     sage: solve(Q*sqrt(Q^2 + 2) - 1,Q)
 Expected:
     [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]
 Got:
     [Q == 1/sqrt(sqrt(2) + 1)]
 **********************************************************************
 }}}
> 
> I think this is due to the fact that Maxima now only returns the real solution, and ignores the complex solution.  I'm not sure what we should do about this.

I think you are right. Maxima treats variables to be real by default. To see that in maxima

```
sage: !maxima
Maxima 5.16.3 http://maxima.sourceforge.net
Using Lisp ECL 9.4.1
Distributed under the GNU Public License. See the file COPYING.
Dedicated to the memory of William Schelter.
The function bug_report() provides bug reporting information.
(%i1) conjugate(Q);
(%o1)                                  Q
```

So, if maxima is throwing away complex solution then its consistent with its own assumptions. 
Unless someone else has different opinion then we should simply accept what maxima is returning
now.



---

archive/issue_comments_048513.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nActually, I was wrong.  This is a bug in Maxima, which used to give the right answer but doesn't any more.  See \n\nhttp://www.math.utexas.edu/pipermail/maxima/2009/017632.html\n\nfor a discussion of this.",
    "created_at": "2009-08-22T12:03:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48513",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:8'>**Comment 8:**</a>
Actually, I was wrong.  This is a bug in Maxima, which used to give the right answer but doesn't any more.  See 

http://www.math.utexas.edu/pipermail/maxima/2009/017632.html

for a discussion of this.



---

archive/issue_comments_048514.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nWe might have to get Maxima's \"solutions\" and check them before returning them to the user.  This is a pain.",
    "created_at": "2009-08-22T12:06:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48514",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:9'>**Comment 9:**</a>
We might have to get Maxima's "solutions" and check them before returning them to the user.  This is a pain.



---

archive/issue_comments_048515.json:
```json
{
    "body": "**Changing author** from \"David Kirkby\" to \"David Kirkby, Alex Ghitza\".",
    "created_at": "2009-08-24T01:16:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48515",
    "user": "https://github.com/aghitza"
}
```

**Changing author** from "David Kirkby" to "David Kirkby, Alex Ghitza".



---

archive/issue_events_067512.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-08-24T01:16:12Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "rename": {
        "from": "Update to Maxima 5.19.1 (particularly important for Solaris support).",
        "to": "[with new spkg and patch] Update to Maxima 5.19.1 (particularly important for Solaris support)."
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67512"
}
```



---

archive/issue_events_067513.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-08-24T01:16:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67513"
}
```



---

archive/issue_events_067514.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-08-24T01:16:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67514"
}
```



---

archive/issue_comments_048516.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nOK, I have come up with a workaround for Maxima's bug.  Since we are now patching Maxima 5.19.1, I've made a new spkg with \"bumped\" version number:\n\nhttp://sage.math.washington.edu/home/ghitza/maxima-5.19.1.p0.spkg\n\nI will soon explain my workaround here to facilitate reviewing, but I thought I'd first put the spkg up in case people want to test it.",
    "created_at": "2009-08-24T01:16:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48516",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:10'>**Comment 10:**</a>
OK, I have come up with a workaround for Maxima's bug.  Since we are now patching Maxima 5.19.1, I've made a new spkg with "bumped" version number:

http://sage.math.washington.edu/home/ghitza/maxima-5.19.1.p0.spkg

I will soon explain my workaround here to facilitate reviewing, but I thought I'd first put the spkg up in case people want to test it.



---

archive/issue_comments_048517.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nHere's a description of the problem and the workaround patched in the latest spkg:\n\nWe are calling Maxima's function `to_poly_solve` on the symbolic expression `Q*sqrt(Q^2+2)-1 == 0`.  Maxima takes this expression and turns it into a system of polynomial equations, and possibly some inequalities giving constraints on the variables.  This is done by a function in `share/contrib/topoly.lisp`.  This function behaves differently under Maxima 5.19.1 than it did under Maxima 5.16.3, and that's what is causing Maxima to lose one of the solutions:\n\nMaxima 5.16.3:\n\n```\nsage: var('Q');\nsage: ex = Q*sqrt(Q^2+2)-1 == 0\nsage: m = ex._maxima_()\nsage: m.to_poly()\n[[%g0*Q-1,Q^2+2=%g0^2],[-%pi/2<carg(%g0),carg(%g0)<=%pi/2]]\n```\n\nMaxima 5.19.1:\n\n```\nsage: var('Q');\nsage: ex = Q*sqrt(Q^2+2)-1 == 0\nsage: m = ex._maxima_()\nsage: m.to_poly()\n[[%g0*Q-1,Q^2+2=%g0^2],[-%pi/2<parg(%g0),parg(%g0)<=%pi/2],[]]\n```\n\nThe main difference between the two is that `carg` turned into `parg`.  The latter is a new function which is supposed to be a lightweight alternative to `carg`.\n\nThe right way to fix this is to properly debug `topoly.lisp` and send a patch to Maxima, but I do not have the time or expertise to do that.  The author knows about the bug (see above link to maxima mailing list), so hopefully this will get sorted out in a future release of Maxima.\n\nFor now, I'm patching `topoly.lisp` so that the appropriate occurrences of `parg` are changed back into `carg`.  This solves our doctest failure.",
    "created_at": "2009-08-24T03:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48517",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:11'>**Comment 11:**</a>
Here's a description of the problem and the workaround patched in the latest spkg:

We are calling Maxima's function `to_poly_solve` on the symbolic expression `Q*sqrt(Q^2+2)-1 == 0`.  Maxima takes this expression and turns it into a system of polynomial equations, and possibly some inequalities giving constraints on the variables.  This is done by a function in `share/contrib/topoly.lisp`.  This function behaves differently under Maxima 5.19.1 than it did under Maxima 5.16.3, and that's what is causing Maxima to lose one of the solutions:

Maxima 5.16.3:

```
sage: var('Q');
sage: ex = Q*sqrt(Q^2+2)-1 == 0
sage: m = ex._maxima_()
sage: m.to_poly()
[[%g0*Q-1,Q^2+2=%g0^2],[-%pi/2<carg(%g0),carg(%g0)<=%pi/2]]
```

Maxima 5.19.1:

```
sage: var('Q');
sage: ex = Q*sqrt(Q^2+2)-1 == 0
sage: m = ex._maxima_()
sage: m.to_poly()
[[%g0*Q-1,Q^2+2=%g0^2],[-%pi/2<parg(%g0),parg(%g0)<=%pi/2],[]]
```

The main difference between the two is that `carg` turned into `parg`.  The latter is a new function which is supposed to be a lightweight alternative to `carg`.

The right way to fix this is to properly debug `topoly.lisp` and send a patch to Maxima, but I do not have the time or expertise to do that.  The author knows about the bug (see above link to maxima mailing list), so hopefully this will get sorted out in a future release of Maxima.

For now, I'm patching `topoly.lisp` so that the appropriate occurrences of `parg` are changed back into `carg`.  This solves our doctest failure.



---

archive/issue_comments_048518.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nNote to the release manager: when this gets merged, the following tickets should be closed as fixed (they are all contained in this patch):\n\n#6782, #6783, #6784, #6785, #6786, #6787, #6789, #6792",
    "created_at": "2009-08-24T08:12:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48518",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:12'>**Comment 12:**</a>
Note to the release manager: when this gets merged, the following tickets should be closed as fixed (they are all contained in this patch):

#6782, #6783, #6784, #6785, #6786, #6787, #6789, #6792



---

archive/issue_comments_048519.json:
```json
{
    "body": "**Reviewer:** Adam Webb",
    "created_at": "2009-08-25T06:28:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48519",
    "user": "https://github.com/maxthemouse"
}
```

**Reviewer:** Adam Webb



---

archive/issue_comments_048520.json:
```json
{
    "body": "<a id='comment:13'>**Comment 13:**</a>\nNot to be pedantic but it would be good to add the usual stuff to the SPKG.txt file to make it more like other packages. I don't know if anyone would like to put their name in for the package maintainer.\n\n```\n== Description ==\n\nMaxima is a symbolic computation program.  It is full featured,\ndoing symbolic manipulation of polynomials, matrices, rational\nfunctions, integration, Todd-coxeter, graphing, bigfloats.  It has a\nsymbolic debugger source level debugger for maxima code.  Maxima is\nbased on the original Macsyma developed at MIT in the 1970's.  It is\nquite reliable, and has good garbage collection, and no memory leaks.\nIt comes with hundreds of self tests.\n\nWebsite: http://maxima.sourceforge.net\n\n== License ==\n\n * Maxima is distributed under the GNU General Public License, with some\nexport restrictions from the U.S. Department of Energy. See the file\nCOPYING.\n\n== SPKG Maintainers ==\n\n * ?\n\n== Upstream Contact ==\n\n * the Maxima mailing list - see http://maxima.sourceforge.net/maximalist.html\n```\n\nThe patch seems quite reasonable to me. Most of it seems to be due to improvements in maxima. Changing parg back to carg will likely have to be looked at in a future update but I think is appropriate at this time. I tested the package on 32 and 64 bit linux and it worked well. I ran 'make testlong' and everything passed. I give it a positive review. Has this been tested on Solaris?\n\nAdam",
    "created_at": "2009-08-25T06:28:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48520",
    "user": "https://github.com/maxthemouse"
}
```

<a id='comment:13'>**Comment 13:**</a>
Not to be pedantic but it would be good to add the usual stuff to the SPKG.txt file to make it more like other packages. I don't know if anyone would like to put their name in for the package maintainer.

```
== Description ==

Maxima is a symbolic computation program.  It is full featured,
doing symbolic manipulation of polynomials, matrices, rational
functions, integration, Todd-coxeter, graphing, bigfloats.  It has a
symbolic debugger source level debugger for maxima code.  Maxima is
based on the original Macsyma developed at MIT in the 1970's.  It is
quite reliable, and has good garbage collection, and no memory leaks.
It comes with hundreds of self tests.

Website: http://maxima.sourceforge.net

== License ==

 * Maxima is distributed under the GNU General Public License, with some
export restrictions from the U.S. Department of Energy. See the file
COPYING.

== SPKG Maintainers ==

 * ?

== Upstream Contact ==

 * the Maxima mailing list - see http://maxima.sourceforge.net/maximalist.html
```

The patch seems quite reasonable to me. Most of it seems to be due to improvements in maxima. Changing parg back to carg will likely have to be looked at in a future update but I think is appropriate at this time. I tested the package on 32 and 64 bit linux and it worked well. I ran 'make testlong' and everything passed. I give it a positive review. Has this been tested on Solaris?

Adam



---

archive/issue_comments_048521.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nAdam,\n\nThanks for taking the time to review this.  I have made changes very close to what you suggested in SPKG.txt, and replaced the spkg -- it's in the same place as before.\n\nI also changed the ticket summary in light of your positive review.",
    "created_at": "2009-08-25T11:40:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48521",
    "user": "https://github.com/aghitza"
}
```

<a id='comment:14'>**Comment 14:**</a>
Adam,

Thanks for taking the time to review this.  I have made changes very close to what you suggested in SPKG.txt, and replaced the spkg -- it's in the same place as before.

I also changed the ticket summary in light of your positive review.



---

archive/issue_events_067515.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-08-25T11:40:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67515"
}
```



---

archive/issue_events_067516.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2009-08-25T11:40:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67516"
}
```



---

archive/issue_comments_048522.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nMerged `maxima-5.19.1.p0.spkg` in the standard packages repository and applied the patch `maxima_doctests.patch`. See my comments at #6564 for test results on various platforms.",
    "created_at": "2009-09-02T10:52:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48522",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<a id='comment:15'>**Comment 15:**</a>
Merged `maxima-5.19.1.p0.spkg` in the standard packages repository and applied the patch `maxima_doctests.patch`. See my comments at #6564 for test results on various platforms.



---

archive/issue_events_067517.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2009-09-02T10:52:22Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "rename": {
        "from": "[with new spkg and patch] Update to Maxima 5.19.1 (particularly important for Solaris support).",
        "to": "[with spkg and patch] Update to Maxima 5.19.1 (particularly important for Solaris support)."
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67517"
}
```



---

archive/issue_events_067518.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2009-09-02T10:52:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67518"
}
```



---

archive/issue_events_067519.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2009-09-02T10:52:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6699#event-67519"
}
```



---

archive/issue_comments_048523.json:
```json
{
    "body": "**Changing reviewer** from \"Adam Webb\" to \"Adam Webb, Minh Van Nguyen\".",
    "created_at": "2009-09-02T10:52:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48523",
    "user": "https://github.com/sagetrac-mvngu"
}
```

**Changing reviewer** from "Adam Webb" to "Adam Webb, Minh Van Nguyen".



---

archive/issue_comments_048524.json:
```json
{
    "body": "**Merged:** Sage 4.1.2.alpha0",
    "created_at": "2009-09-02T10:52:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48524",
    "user": "https://github.com/sagetrac-mvngu"
}
```

**Merged:** Sage 4.1.2.alpha0



---

archive/issue_comments_048525.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nSee #6883 for a follow-up to this ticket.",
    "created_at": "2009-09-04T06:40:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6699",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6699#issuecomment-48525",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<a id='comment:16'>**Comment 16:**</a>
See #6883 for a follow-up to this ticket.
