# Issue 6465: Derivative D acts wrongly on symbolic integration

archive/issues_006465.json:
```json
{
    "body": "In new symbolics, derivative operator does not know \nhow to act on symbolic integration.\n\n```\nsage: f(x) = function('f',x)\nsage: g = integrate(f(x),x)\nsage: g.diff(x)\nD[0](integrate)(f(x), x)*D[0](f)(x) + D[1](integrate)(f(x), x)\n```\n\n**Patches**:\n\n* Both patches should be applied in order (spkg is already included in sage-4.1.1).\n\nApart from solving this bug it introduces couple\nof new features (by moving it into new symbolics' SFunction sub-class)\n\n (1) Stricter syntax:\n\n  http://groups.google.com/group/sage-devel/browse_thread/thread/3e98841311653d7a\n\n (2) Numerical approximation using .n() method\n\n (3) Updated \"integrate?\" docstring\n \n (4) Graceful handling of situations where integration is specified w.r.t. an expression\n\n  http://groups.google.com/group/sage-devel/browse_thread/thread/cd9f91338635ada9\n\n\n\n (4) Behind the scene it provides a framework to hook up easily new integration algorithm written within sage.\n\n\n\n**Author:** Burcin Erocal, Golam Mortuza Hossain\n\n**Reviewer:** Tim Dumol, Karl-Dieter Crisman, Ross Kyprianou, Minh Van Nguyen\n\n**Merged:** sage-4.3.3.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/6465\n\n",
    "closed_at": "2010-02-18T21:51:14Z",
    "created_at": "2009-07-05T02:31:55Z",
    "labels": [
        "component: symbolics",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.3.3",
    "title": "Derivative D acts wrongly on symbolic integration",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6465",
    "user": "https://github.com/golam-m-hossain"
}
```
In new symbolics, derivative operator does not know 
how to act on symbolic integration.

```
sage: f(x) = function('f',x)
sage: g = integrate(f(x),x)
sage: g.diff(x)
D[0](integrate)(f(x), x)*D[0](f)(x) + D[1](integrate)(f(x), x)
```

**Patches**:

* Both patches should be applied in order (spkg is already included in sage-4.1.1).

Apart from solving this bug it introduces couple
of new features (by moving it into new symbolics' SFunction sub-class)

 (1) Stricter syntax:

  http://groups.google.com/group/sage-devel/browse_thread/thread/3e98841311653d7a

 (2) Numerical approximation using .n() method

 (3) Updated "integrate?" docstring
 
 (4) Graceful handling of situations where integration is specified w.r.t. an expression

  http://groups.google.com/group/sage-devel/browse_thread/thread/cd9f91338635ada9



 (4) Behind the scene it provides a framework to hook up easily new integration algorithm written within sage.



**Author:** Burcin Erocal, Golam Mortuza Hossain

**Reviewer:** Tim Dumol, Karl-Dieter Crisman, Ross Kyprianou, Minh Van Nguyen

**Merged:** sage-4.3.3.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/6465





---

archive/issue_comments_057826.json:
```json
{
    "body": "support disabling chain rule for symbolic functions",
    "created_at": "2009-08-01T02:36:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57826",
    "user": "https://github.com/burcin"
}
```

support disabling chain rule for symbolic functions



---

archive/attachments_007646.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-chain_rule.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-chain_rule.patch",
    "created_at": "2009-08-01T02:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_057827.json:
```json
{
    "body": "<a id='comment:1'></a>\nattachment:trac_6465-chain_rule.patch adds support for disabling chain rule for symbolic functions. It depends on the new pynac package here:\n\nhttp://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.8.p2.spkg",
    "created_at": "2009-08-01T02:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57827",
    "user": "https://github.com/burcin"
}
```

<a id='comment:1'></a>
attachment:trac_6465-chain_rule.patch adds support for disabling chain rule for symbolic functions. It depends on the new pynac package here:

http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.8.p2.spkg



---

archive/issue_comments_057828.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-08-20T23:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57828",
    "user": "https://github.com/golam-m-hossain"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_057829.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,3 +7,28 @@\n sage: g.diff(x)\n D[0](integrate)(f(x), x)*D[0](f)(x) + D[1](integrate)(f(x), x)\n ```\n+\n+**Patches**:\n+\n+* Both patches should be applied in order (spkg is already included in sage-4.1.1).\n+\n+Apart from solving this bug it introduces couple\n+of new features (by moving it into new symbolics' SFunction sub-class)\n+\n+ (1) Stricter syntax:\n+\n+  http://groups.google.com/group/sage-devel/browse_thread/thread/3e98841311653d7a\n+\n+ (2) Numerical approximation using .n() method\n+\n+ (3) Updated \"integrate?\" docstring\n+ \n+ (4) Graceful handling of situations where integration is specified w.r.t. an expression\n+\n+  http://groups.google.com/group/sage-devel/browse_thread/thread/cd9f91338635ada9\n+\n+\n+\n+ (4) Behind the scene it provides a framework to hook up easily new integration algorithm written within sage.\n+\n+\n``````\n",
    "created_at": "2009-08-20T23:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57829",
    "user": "https://github.com/golam-m-hossain"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,3 +7,28 @@
 sage: g.diff(x)
 D[0](integrate)(f(x), x)*D[0](f)(x) + D[1](integrate)(f(x), x)
 ```
+
+**Patches**:
+
+* Both patches should be applied in order (spkg is already included in sage-4.1.1).
+
+Apart from solving this bug it introduces couple
+of new features (by moving it into new symbolics' SFunction sub-class)
+
+ (1) Stricter syntax:
+
+  http://groups.google.com/group/sage-devel/browse_thread/thread/3e98841311653d7a
+
+ (2) Numerical approximation using .n() method
+
+ (3) Updated "integrate?" docstring
+ 
+ (4) Graceful handling of situations where integration is specified w.r.t. an expression
+
+  http://groups.google.com/group/sage-devel/browse_thread/thread/cd9f91338635ada9
+
+
+
+ (4) Behind the scene it provides a framework to hook up easily new integration algorithm written within sage.
+
+
``````




---

archive/issue_comments_057830.json:
```json
{
    "body": "**Author:** Burcin Erocal, Golam Mortuza Hossain",
    "created_at": "2009-08-20T23:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57830",
    "user": "https://github.com/golam-m-hossain"
}
```

**Author:** Burcin Erocal, Golam Mortuza Hossain



---

archive/attachments_007647.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-moves-integration-into-sfunction-subclass.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-moves-integration-into-sfunction-subclass.patch",
    "created_at": "2009-08-21T17:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/golam-m-hossain"
}
```



---

archive/issue_comments_057831.json:
```json
{
    "body": "Should be applied after the chain-rule patch",
    "created_at": "2009-08-21T17:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57831",
    "user": "https://github.com/golam-m-hossain"
}
```

Should be applied after the chain-rule patch



---

archive/issue_comments_057832.json:
```json
{
    "body": "<a id='comment:3'></a>\nThere need to be deprecation warnings for things like \n\n```\nsage: integral(sin(x), pi, 2*pi)\nsage: integral(sin(x)^3\n```",
    "created_at": "2009-09-10T15:23:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57832",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>
There need to be deprecation warnings for things like 

```
sage: integral(sin(x), pi, 2*pi)
sage: integral(sin(x)^3
```



---

archive/issue_comments_057833.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2009-09-22T10:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57833",
    "user": "https://github.com/TimDumol"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_057834.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe sudden API change probably merits a deprecation warning, as kcrisman said. Also:\n\nDoctest failure:\n\n```\n\nsage -t -long devel/sage/sage/libs/ginac/decl.pxi         \n         [0.1 s]                                          \nsage -t -long devel/sage/sage/misc/functional.py          \n**********************************************************************\nFile \"/opt/sage-bin/devel/sage-deriv/sage/misc/functional.py\", line 412:\n    sage: integral(exp(-x), (x, 1, oo))                                 \nExpected:                                                               \n    e^(-1)                                                              \nGot:                                                                    \n    gamma_incomplete(1, 1)                                              \n**********************************************************************  \n1 items had failures:                                                   \n   1 of  15 in __main__.example_25                                      \n***Test Failed*** 1 failures.                                           \nFor whitespace errors, see the file /opt/sage-bin/tmp/.doctest_functional.py\n         [9.3 s]\n\n```",
    "created_at": "2009-09-22T10:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57834",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:4'></a>
The sudden API change probably merits a deprecation warning, as kcrisman said. Also:

Doctest failure:

```

sage -t -long devel/sage/sage/libs/ginac/decl.pxi         
         [0.1 s]                                          
sage -t -long devel/sage/sage/misc/functional.py          
**********************************************************************
File "/opt/sage-bin/devel/sage-deriv/sage/misc/functional.py", line 412:
    sage: integral(exp(-x), (x, 1, oo))                                 
Expected:                                                               
    e^(-1)                                                              
Got:                                                                    
    gamma_incomplete(1, 1)                                              
**********************************************************************  
1 items had failures:                                                   
   1 of  15 in __main__.example_25                                      
***Test Failed*** 1 failures.                                           
For whitespace errors, see the file /opt/sage-bin/tmp/.doctest_functional.py
         [9.3 s]

```



---

archive/issue_comments_057835.json:
```json
{
    "body": "**Reviewer:** Tim Dumol",
    "created_at": "2009-09-22T10:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57835",
    "user": "https://github.com/TimDumol"
}
```

**Reviewer:** Tim Dumol



---

archive/issue_comments_057836.json:
```json
{
    "body": "<a id='comment:5'></a>\nThat may be due to the Maxima upgrade - has it been patched elsewhere?  Just FYI, I'm not certain on this.",
    "created_at": "2009-09-22T12:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57836",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
That may be due to the Maxima upgrade - has it been patched elsewhere?  Just FYI, I'm not certain on this.



---

archive/issue_comments_057837.json:
```json
{
    "body": "**Upstream:** N/A",
    "created_at": "2009-11-30T08:37:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57837",
    "user": "https://github.com/TimDumol"
}
```

**Upstream:** N/A



---

archive/issue_comments_057838.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis patch needs to be rebased on #6816. The doctest failure persists, but gamma_incomplete(1, 1) is equivalent to e^(-1) anyways.",
    "created_at": "2009-11-30T08:37:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57838",
    "user": "https://github.com/TimDumol"
}
```

<a id='comment:6'></a>
This patch needs to be rebased on #6816. The doctest failure persists, but gamma_incomplete(1, 1) is equivalent to e^(-1) anyways.



---

archive/issue_comments_057839.json:
```json
{
    "body": "<a id='comment:7'></a>\nBoth patches need major rebase after #7490. I'll take a look at this when I find some time.\n\nThe problem with `gamma_incomplete` might be related to/fixed by #7748.",
    "created_at": "2009-12-22T22:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57839",
    "user": "https://github.com/burcin"
}
```

<a id='comment:7'></a>
Both patches need major rebase after #7490. I'll take a look at this when I find some time.

The problem with `gamma_incomplete` might be related to/fixed by #7748.



---

archive/issue_events_019731.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-12-22T22:46:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "milestone": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6465#event-19731"
}
```



---

archive/issue_comments_057840.json:
```json
{
    "body": "<a id='comment:8'></a>\n> The problem with `gamma_incomplete` might be related to/fixed by #7748.\n\n\nYes, I think so, as Maxima 5.20.1 now returns this for both integrate(exp(-x),x,1,inf) and integrate(1/%e^x,x,1,inf).  Note that \n\n```\nsage: gamma_inc(1,1)\n0.367...\n```\nrather than 1/e at this point, so it really is the symbolic piece, not just having translation from Maxima, that would be important.",
    "created_at": "2009-12-23T04:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57840",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
> The problem with `gamma_incomplete` might be related to/fixed by #7748.


Yes, I think so, as Maxima 5.20.1 now returns this for both integrate(exp(-x),x,1,inf) and integrate(1/%e^x,x,1,inf).  Note that 

```
sage: gamma_inc(1,1)
0.367...
```
rather than 1/e at this point, so it really is the symbolic piece, not just having translation from Maxima, that would be important.



---

archive/issue_comments_057841.json:
```json
{
    "body": "rebased to 4.3.rc0",
    "created_at": "2010-01-19T10:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57841",
    "user": "https://github.com/burcin"
}
```

rebased to 4.3.rc0



---

archive/attachments_007648.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-chain_rule.take2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-chain_rule.take2.patch",
    "created_at": "2010-01-19T10:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_057842.json:
```json
{
    "body": "rebased to 4.3.1.rc0",
    "created_at": "2010-01-19T10:21:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57842",
    "user": "https://github.com/burcin"
}
```

rebased to 4.3.1.rc0



---

archive/attachments_007649.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-moves-integration-into-sfunction-subclass.take2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-moves-integration-into-sfunction-subclass.take2.patch",
    "created_at": "2010-01-19T10:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_057843.json:
```json
{
    "body": "referee patch",
    "created_at": "2010-01-19T10:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57843",
    "user": "https://github.com/burcin"
}
```

referee patch



---

archive/attachments_007650.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-integral.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-integral.patch",
    "created_at": "2010-01-19T10:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_057844.json:
```json
{
    "body": "<a id='comment:9'></a>\nI uploaded new versions of the two old patches, rebased to 4.3.1.rc0, and a referee patch. I consider this ready now, though someone needs to review my changes.\n\nUnfortunately attachment:trac_6465-chain_rule.take2.patch depends on the next version of pynac. I will release that real soon now. :)\n\nThe patches should be applied in this order:\n* attachment:trac_6465-chain_rule.take2.patch\n* attachment:trac_6465-moves-integration-into-sfunction-subclass.take2.patch\n* attachment:trac_6465-integral.patch\n\nThey probably depend on other tickets. ATM, my queue contains: #7822, #6961, #7876, #7363, #7955, #7957, #7916 related to symbolics.",
    "created_at": "2010-01-19T10:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57844",
    "user": "https://github.com/burcin"
}
```

<a id='comment:9'></a>
I uploaded new versions of the two old patches, rebased to 4.3.1.rc0, and a referee patch. I consider this ready now, though someone needs to review my changes.

Unfortunately attachment:trac_6465-chain_rule.take2.patch depends on the next version of pynac. I will release that real soon now. :)

The patches should be applied in this order:
* attachment:trac_6465-chain_rule.take2.patch
* attachment:trac_6465-moves-integration-into-sfunction-subclass.take2.patch
* attachment:trac_6465-integral.patch

They probably depend on other tickets. ATM, my queue contains: #7822, #6961, #7876, #7363, #7955, #7957, #7916 related to symbolics.



---

archive/issue_comments_057845.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2010-01-19T14:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57845",
    "user": "https://github.com/burcin"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_057846.json:
```json
{
    "body": "<a id='comment:10'></a>\nNew pynac package available here:\n\nhttp://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.11.spkg\n\nThe patches here depend on #7822, #7876, #7363, #7955, #7957 and #7916 (in this order).\n\nThe patches should be applied in this order:\n\n* attachment:trac_6465-chain_rule.take2.patch Download\n* attachment:trac_6465-moves-integration-into-sfunction-subclass.take2.patch Download\n* attachment:trac_6465-integral.patch",
    "created_at": "2010-01-19T14:15:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57846",
    "user": "https://github.com/burcin"
}
```

<a id='comment:10'></a>
New pynac package available here:

http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.11.spkg

The patches here depend on #7822, #7876, #7363, #7955, #7957 and #7916 (in this order).

The patches should be applied in this order:

* attachment:trac_6465-chain_rule.take2.patch Download
* attachment:trac_6465-moves-integration-into-sfunction-subclass.take2.patch Download
* attachment:trac_6465-integral.patch



---

archive/issue_comments_057847.json:
```json
{
    "body": "<a id='comment:11'></a>\nThere is a reject on sage/symbolic/random_tests.py with the last patch.",
    "created_at": "2010-01-21T00:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57847",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:11'></a>
There is a reject on sage/symbolic/random_tests.py with the last patch.



---

archive/issue_comments_057848.json:
```json
{
    "body": "<a id='comment:12'></a>\nSee #6559 for the correct order of patches to avoid the reject.",
    "created_at": "2010-01-21T01:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57848",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:12'></a>
See #6559 for the correct order of patches to avoid the reject.



---

archive/issue_comments_057849.json:
```json
{
    "body": "<a id='comment:13'></a>\nI've applied every one of Burcin's patches I could find, and get only one type of doctest failure with all of them (when applied in the right order).  So so far so good!  Unfortunately, I can't review any of them for two reasons - my understanding of C++/Pynac is not reliable enough to do a good job, and there are so many failures until one applies *all* the patches that it's hard to separate out what's what.\n\nThe reason I say that here is that I do get a significant failure, in a few different files, for the _tderivative_ method, though the actual failure occurs as a RuntimeError in line 216 of sage/misc/derivative.pyx (with no error message, more's the pity).  For instance, in line 99 of sage/symbolic/integration/integral.py, \n\n```\nsage: f = function('f'); a,b = var('a,b')\nsage: h = indefinite_integral(f(x), x)\nsage: h.diff(x)\nRuntimeError\n```\nI hope this helps track it down.",
    "created_at": "2010-01-21T02:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57849",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'></a>
I've applied every one of Burcin's patches I could find, and get only one type of doctest failure with all of them (when applied in the right order).  So so far so good!  Unfortunately, I can't review any of them for two reasons - my understanding of C++/Pynac is not reliable enough to do a good job, and there are so many failures until one applies *all* the patches that it's hard to separate out what's what.

The reason I say that here is that I do get a significant failure, in a few different files, for the _tderivative_ method, though the actual failure occurs as a RuntimeError in line 216 of sage/misc/derivative.pyx (with no error message, more's the pity).  For instance, in line 99 of sage/symbolic/integration/integral.py, 

```
sage: f = function('f'); a,b = var('a,b')
sage: h = indefinite_integral(f(x), x)
sage: h.diff(x)
RuntimeError
```
I hope this helps track it down.



---

archive/issue_comments_057850.json:
```json
{
    "body": "<a id='comment:14'></a>\nCan you download the package file again and install it?\n\nI forgot to include a patch when I first put the release together. I fixed the spkg file once I realized the problem, assuming no one looked at it yet. You must have downloaded in that period.\n\nSorry for the inconvenience and many thanks for trying these patches out.",
    "created_at": "2010-01-21T07:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57850",
    "user": "https://github.com/burcin"
}
```

<a id='comment:14'></a>
Can you download the package file again and install it?

I forgot to include a patch when I first put the release together. I fixed the spkg file once I realized the problem, assuming no one looked at it yet. You must have downloaded in that period.

Sorry for the inconvenience and many thanks for trying these patches out.



---

archive/issue_comments_057851.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [burcin](#comment%3A14):\n> Can you download the package file again and install it?\n> \n> I forgot to include a patch when I first put the release together. I fixed the spkg file once I realized the problem, assuming no one looked at it yet. You must have downloaded in that period.\n\n\nI now get\n\n```\nsage: h.diff(x)\nf(x)\n```\n\nHowever, I now get some errors after applying all patches up to and including this set.  Some should also be marked # optional - requires Internet (the mathematica_free ones).  They all seem to be related to some extra keyword being passed to the DeprecatedSFunction constructor.\n\n```\nsage -t  \"devel/sage/sage/symbolic/integration/integration.py\"\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 29:\n    sage: from sage.symbolic.integration.integration import _maxima_integrator\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_1[2]>\", line 1, in <module>\n        from sage.symbolic.integration.integration import _maxima_integrator###line 29:\n    sage: from sage.symbolic.integration.integration import _maxima_integrator\n      File \"/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py\", line 316, in <module>\n        integral = SymbolicIntegration()\n      File \"/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py\", line 152, in __init__\n        SFunction.__init__(self, \"integrate\", *args, **kwds)\n      File \"function.pyx\", line 1059, in sage.symbolic.function.DeprecatedSFunction.__init__ (sage/symbolic/function.cpp:8588)\n    TypeError: __init__() got an unexpected keyword argument 'built_in_function'\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 30:\n    sage: _maxima_integrator(sin(x), x)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_1[3]>\", line 1, in <module>\n        _maxima_integrator(sin(x), x)###line 30:\n    sage: _maxima_integrator(sin(x), x)\n    NameError: name '_maxima_integrator' is not defined\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 33:\n    sage: _maxima_integrator(f(x), x)\nExpected:\n    Traceback (most recent call last):\n    ...\n    NotImplementedError: Maxima failed to integrate\nGot:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_1[5]>\", line 1, in <module>\n        _maxima_integrator(f(x), x)###line 33:\n    sage: _maxima_integrator(f(x), x)\n    NameError: name '_maxima_integrator' is not defined\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 293:\n    sage: from sage.symbolic.integration.integration import integral\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_10[2]>\", line 1, in <module>\n        from sage.symbolic.integration.integration import integral###line 293:\n    sage: from sage.symbolic.integration.integration import integral\n      File \"/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py\", line 316, in <module>\n        integral = SymbolicIntegration()\n      File \"/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py\", line 152, in __init__\n        SFunction.__init__(self, \"integrate\", *args, **kwds)\n      File \"function.pyx\", line 1059, in sage.symbolic.function.DeprecatedSFunction.__init__ (sage/symbolic/function.cpp:8588)\n    TypeError: __init__() got an unexpected keyword argument 'built_in_function'\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 294:\n    sage: _ilatex = integral._print_latex_\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_10[3]>\", line 1, in <module>\n        _ilatex = integral._print_latex_###line 294:\n    sage: _ilatex = integral._print_latex_\n    AttributeError: 'function' object has no attribute '_print_latex_'\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 298:\n    sage: _ilatex(f(x),x)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_10[6]>\", line 1, in <module>\n        _ilatex(f(x),x)###line 298:\n    sage: _ilatex(f(x),x)\n    NameError: name '_ilatex' is not defined\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 300:\n    sage: _ilatex(f(x),x,a,b)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_10[7]>\", line 1, in <module>\n        _ilatex(f(x),x,a,b)###line 300:\n    sage: _ilatex(f(x),x,a,b)\n    NameError: name '_ilatex' is not defined\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 51:\n    sage: from sage.symbolic.integration.integration import _sympy_integrator\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_2[2]>\", line 1, in <module>\n        from sage.symbolic.integration.integration import _sympy_integrator###line 51:\n    sage: from sage.symbolic.integration.integration import _sympy_integrator\n      File \"/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py\", line 316, in <module>\n        integral = SymbolicIntegration()\n      File \"/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py\", line 152, in __init__\n        SFunction.__init__(self, \"integrate\", *args, **kwds)\n      File \"function.pyx\", line 1059, in sage.symbolic.function.DeprecatedSFunction.__init__ (sage/symbolic/function.cpp:8588)\n    TypeError: __init__() got an unexpected keyword argument 'built_in_function'\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 52:\n    sage: _sympy_integrator(sin(x), x)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_2[3]>\", line 1, in <module>\n        _sympy_integrator(sin(x), x)###line 52:\n    sage: _sympy_integrator(sin(x), x)\n    NameError: name '_sympy_integrator' is not defined\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 55:\n    sage: _sympy_integrator(f(x), x)\nExpected:\n    Traceback (most recent call last):\n    ...\n    NotImplementedError: Sympy failed to integrate\nGot:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_2[5]>\", line 1, in <module>\n        _sympy_integrator(f(x), x)###line 55:\n    sage: _sympy_integrator(f(x), x)\n    NameError: name '_sympy_integrator' is not defined\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 76:\n    sage: from sage.symbolic.integration.integration import _mathematica_free_integrator\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[2]>\", line 1, in <module>\n        from sage.symbolic.integration.integration import _mathematica_free_integrator###line 76:\n    sage: from sage.symbolic.integration.integration import _mathematica_free_integrator\n      File \"/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py\", line 316, in <module>\n        integral = SymbolicIntegration()\n      File \"/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py\", line 152, in __init__\n        SFunction.__init__(self, \"integrate\", *args, **kwds)\n      File \"function.pyx\", line 1059, in sage.symbolic.function.DeprecatedSFunction.__init__ (sage/symbolic/function.cpp:8588)\n    TypeError: __init__() got an unexpected keyword argument 'built_in_function'\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 77:\n    sage: _mathematica_free_integrator(sin(x), x)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[3]>\", line 1, in <module>\n        _mathematica_free_integrator(sin(x), x)###line 77:\n    sage: _mathematica_free_integrator(sin(x), x)\n    NameError: name '_mathematica_free_integrator' is not defined\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 80:\n    sage: _mathematica_free_integrator(f(x), x)\nExpected:\n    Traceback (most recent call last):\n    ...\n    NotImplementedError: mathematica_free failed to integrate\nGot:\n    Traceback (most recent call last):\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/Users/.../sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_3[5]>\", line 1, in <module>\n        _mathematica_free_integrator(f(x), x)###line 80:\n    sage: _mathematica_free_integrator(f(x), x)\n    NameError: name '_mathematica_free_integrator' is not defined\n**********************************************************************\nFile \"/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py\", line 241:\n    sage: h.n()\nExpected:\n    0.472399177268953\nGot:\n    0.47239917726895253\n**********************************************************************\n5 items had failures:\n   3 of   6 in __main__.example_1\n   4 of   9 in __main__.example_10\n   3 of   6 in __main__.example_2\n   3 of   6 in __main__.example_3\n   1 of   4 in __main__.example_8\n***Test Failed*** 14 failures.\n\t [6.5 s]\n```\n\n> Sorry for the inconvenience and many thanks for trying these patches out.\n\n\nNo problem.  Although I *strongly* disagree with the removal of indefinite integration longterm without explicit variable, overall this set of changes will be a big improvement.  I am sorry again I cannot review much of the C++ related stuff, or the Pynac changes, though I am glad they are now up on [|pynac.sagemath.org] !",
    "created_at": "2010-01-28T21:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57851",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>
Replying to [burcin](#comment%3A14):
> Can you download the package file again and install it?
> 
> I forgot to include a patch when I first put the release together. I fixed the spkg file once I realized the problem, assuming no one looked at it yet. You must have downloaded in that period.


I now get

```
sage: h.diff(x)
f(x)
```

However, I now get some errors after applying all patches up to and including this set.  Some should also be marked # optional - requires Internet (the mathematica_free ones).  They all seem to be related to some extra keyword being passed to the DeprecatedSFunction constructor.

```
sage -t  "devel/sage/sage/symbolic/integration/integration.py"
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 29:
    sage: from sage.symbolic.integration.integration import _maxima_integrator
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_1[2]>", line 1, in <module>
        from sage.symbolic.integration.integration import _maxima_integrator###line 29:
    sage: from sage.symbolic.integration.integration import _maxima_integrator
      File "/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py", line 316, in <module>
        integral = SymbolicIntegration()
      File "/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py", line 152, in __init__
        SFunction.__init__(self, "integrate", *args, **kwds)
      File "function.pyx", line 1059, in sage.symbolic.function.DeprecatedSFunction.__init__ (sage/symbolic/function.cpp:8588)
    TypeError: __init__() got an unexpected keyword argument 'built_in_function'
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 30:
    sage: _maxima_integrator(sin(x), x)
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_1[3]>", line 1, in <module>
        _maxima_integrator(sin(x), x)###line 30:
    sage: _maxima_integrator(sin(x), x)
    NameError: name '_maxima_integrator' is not defined
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 33:
    sage: _maxima_integrator(f(x), x)
Expected:
    Traceback (most recent call last):
    ...
    NotImplementedError: Maxima failed to integrate
Got:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_1[5]>", line 1, in <module>
        _maxima_integrator(f(x), x)###line 33:
    sage: _maxima_integrator(f(x), x)
    NameError: name '_maxima_integrator' is not defined
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 293:
    sage: from sage.symbolic.integration.integration import integral
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_10[2]>", line 1, in <module>
        from sage.symbolic.integration.integration import integral###line 293:
    sage: from sage.symbolic.integration.integration import integral
      File "/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py", line 316, in <module>
        integral = SymbolicIntegration()
      File "/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py", line 152, in __init__
        SFunction.__init__(self, "integrate", *args, **kwds)
      File "function.pyx", line 1059, in sage.symbolic.function.DeprecatedSFunction.__init__ (sage/symbolic/function.cpp:8588)
    TypeError: __init__() got an unexpected keyword argument 'built_in_function'
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 294:
    sage: _ilatex = integral._print_latex_
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_10[3]>", line 1, in <module>
        _ilatex = integral._print_latex_###line 294:
    sage: _ilatex = integral._print_latex_
    AttributeError: 'function' object has no attribute '_print_latex_'
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 298:
    sage: _ilatex(f(x),x)
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_10[6]>", line 1, in <module>
        _ilatex(f(x),x)###line 298:
    sage: _ilatex(f(x),x)
    NameError: name '_ilatex' is not defined
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 300:
    sage: _ilatex(f(x),x,a,b)
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_10[7]>", line 1, in <module>
        _ilatex(f(x),x,a,b)###line 300:
    sage: _ilatex(f(x),x,a,b)
    NameError: name '_ilatex' is not defined
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 51:
    sage: from sage.symbolic.integration.integration import _sympy_integrator
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_2[2]>", line 1, in <module>
        from sage.symbolic.integration.integration import _sympy_integrator###line 51:
    sage: from sage.symbolic.integration.integration import _sympy_integrator
      File "/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py", line 316, in <module>
        integral = SymbolicIntegration()
      File "/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py", line 152, in __init__
        SFunction.__init__(self, "integrate", *args, **kwds)
      File "function.pyx", line 1059, in sage.symbolic.function.DeprecatedSFunction.__init__ (sage/symbolic/function.cpp:8588)
    TypeError: __init__() got an unexpected keyword argument 'built_in_function'
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 52:
    sage: _sympy_integrator(sin(x), x)
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_2[3]>", line 1, in <module>
        _sympy_integrator(sin(x), x)###line 52:
    sage: _sympy_integrator(sin(x), x)
    NameError: name '_sympy_integrator' is not defined
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 55:
    sage: _sympy_integrator(f(x), x)
Expected:
    Traceback (most recent call last):
    ...
    NotImplementedError: Sympy failed to integrate
Got:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_2[5]>", line 1, in <module>
        _sympy_integrator(f(x), x)###line 55:
    sage: _sympy_integrator(f(x), x)
    NameError: name '_sympy_integrator' is not defined
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 76:
    sage: from sage.symbolic.integration.integration import _mathematica_free_integrator
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[2]>", line 1, in <module>
        from sage.symbolic.integration.integration import _mathematica_free_integrator###line 76:
    sage: from sage.symbolic.integration.integration import _mathematica_free_integrator
      File "/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py", line 316, in <module>
        integral = SymbolicIntegration()
      File "/Users/.../sage-4.3.1/local/lib/python/site-packages/sage/symbolic/integration/integration.py", line 152, in __init__
        SFunction.__init__(self, "integrate", *args, **kwds)
      File "function.pyx", line 1059, in sage.symbolic.function.DeprecatedSFunction.__init__ (sage/symbolic/function.cpp:8588)
    TypeError: __init__() got an unexpected keyword argument 'built_in_function'
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 77:
    sage: _mathematica_free_integrator(sin(x), x)
Exception raised:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[3]>", line 1, in <module>
        _mathematica_free_integrator(sin(x), x)###line 77:
    sage: _mathematica_free_integrator(sin(x), x)
    NameError: name '_mathematica_free_integrator' is not defined
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 80:
    sage: _mathematica_free_integrator(f(x), x)
Expected:
    Traceback (most recent call last):
    ...
    NotImplementedError: mathematica_free failed to integrate
Got:
    Traceback (most recent call last):
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/Users/.../sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_3[5]>", line 1, in <module>
        _mathematica_free_integrator(f(x), x)###line 80:
    sage: _mathematica_free_integrator(f(x), x)
    NameError: name '_mathematica_free_integrator' is not defined
**********************************************************************
File "/Users/.../sage-4.3.1/devel/sage/sage/symbolic/integration/integration.py", line 241:
    sage: h.n()
Expected:
    0.472399177268953
Got:
    0.47239917726895253
**********************************************************************
5 items had failures:
   3 of   6 in __main__.example_1
   4 of   9 in __main__.example_10
   3 of   6 in __main__.example_2
   3 of   6 in __main__.example_3
   1 of   4 in __main__.example_8
***Test Failed*** 14 failures.
	 [6.5 s]
```

> Sorry for the inconvenience and many thanks for trying these patches out.


No problem.  Although I *strongly* disagree with the removal of indefinite integration longterm without explicit variable, overall this set of changes will be a big improvement.  I am sorry again I cannot review much of the C++ related stuff, or the Pynac changes, though I am glad they are now up on [|pynac.sagemath.org] !



---

archive/issue_comments_057852.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2010-01-28T21:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57852",
    "user": "https://github.com/kcrisman"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_057853.json:
```json
{
    "body": "**Changing reviewer** from \"Tim Dumol\" to \"Tim Dumol, Karl-Dieter Crisman\".",
    "created_at": "2010-01-28T21:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57853",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Tim Dumol" to "Tim Dumol, Karl-Dieter Crisman".



---

archive/attachments_007651.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-integral.take2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-integral.take2.patch",
    "created_at": "2010-01-31T21:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_057854.json:
```json
{
    "body": "new version",
    "created_at": "2010-01-31T21:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57854",
    "user": "https://github.com/burcin"
}
```

new version



---

archive/issue_comments_057855.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2010-01-31T21:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57855",
    "user": "https://github.com/burcin"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_057856.json:
```json
{
    "body": "<a id='comment:16'></a>\nattachment:trac_6465-integral.patch renames the file `sage/symbolic/integration/integration.py` to `sage/symbolic/integration/integral.py`. Are you sure you applied the patches correctly? Since these are git style diffs using `hg import` or `hg qimport` is recommended.\n\nI applied the whole batch of symbolics patches associated to pynac-0.11 to 4.3.2.alpha0, and tested the sage/{symbolic,calculus,functions} directories. The only doctest failure I got was in  `sage/symbolic/integration/external.py`. attachment:trac_6465-integral.take2.patch removes this dubious test.\n\nThe patches that need to be applied from this ticket are now:\n* attachment:trac_6465-chain_rule.take2.patch\n* attachment:trac_6465-moves-integration-into-sfunction-subclass.take2.patch\n* attachment:trac_6465-integral.take2.patch",
    "created_at": "2010-01-31T21:23:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57856",
    "user": "https://github.com/burcin"
}
```

<a id='comment:16'></a>
attachment:trac_6465-integral.patch renames the file `sage/symbolic/integration/integration.py` to `sage/symbolic/integration/integral.py`. Are you sure you applied the patches correctly? Since these are git style diffs using `hg import` or `hg qimport` is recommended.

I applied the whole batch of symbolics patches associated to pynac-0.11 to 4.3.2.alpha0, and tested the sage/{symbolic,calculus,functions} directories. The only doctest failure I got was in  `sage/symbolic/integration/external.py`. attachment:trac_6465-integral.take2.patch removes this dubious test.

The patches that need to be applied from this ticket are now:
* attachment:trac_6465-chain_rule.take2.patch
* attachment:trac_6465-moves-integration-into-sfunction-subclass.take2.patch
* attachment:trac_6465-integral.take2.patch



---

archive/issue_comments_057857.json:
```json
{
    "body": "fix numerical problems in doctests",
    "created_at": "2010-02-03T10:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57857",
    "user": "https://github.com/burcin"
}
```

fix numerical problems in doctests



---

archive/attachments_007652.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-integral.take3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-integral.take3.patch",
    "created_at": "2010-02-03T11:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_057858.json:
```json
{
    "body": "<a id='comment:17'></a>\nAfter testing on a 32-bit Debian box, I uploaded attachment:trac_6465-integral.take3.patch to replace attachment:trac_6465-integral.take2.patch. The only difference is the `...` used for the trailing digits of the numerical integral on line 188 of `sage/symbolic/integration/integral.py`.\n\nThe patches that need to be applied are: \n* attachment:trac_6465-chain_rule.take2.patch\n* attachment:trac_6465-moves-integration-into-sfunction-subclass.take2.patch\n* attachment:trac_6465-integral.take2.patch",
    "created_at": "2010-02-03T11:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57858",
    "user": "https://github.com/burcin"
}
```

<a id='comment:17'></a>
After testing on a 32-bit Debian box, I uploaded attachment:trac_6465-integral.take3.patch to replace attachment:trac_6465-integral.take2.patch. The only difference is the `...` used for the trailing digits of the numerical integral on line 188 of `sage/symbolic/integration/integral.py`.

The patches that need to be applied are: 
* attachment:trac_6465-chain_rule.take2.patch
* attachment:trac_6465-moves-integration-into-sfunction-subclass.take2.patch
* attachment:trac_6465-integral.take2.patch



---

archive/issue_comments_057859.json:
```json
{
    "body": "<a id='comment:18'></a>\nOops, the last patch to be applied is attachment:trac_6465-integral.take3.patch! That was a typo in the list above.",
    "created_at": "2010-02-04T09:13:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57859",
    "user": "https://github.com/burcin"
}
```

<a id='comment:18'></a>
Oops, the last patch to be applied is attachment:trac_6465-integral.take3.patch! That was a typo in the list above.



---

archive/attachments_007653.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-integral.take4.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-integral.take4.patch",
    "created_at": "2010-02-09T10:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_057860.json:
```json
{
    "body": "rebased to 4.3.2",
    "created_at": "2010-02-09T10:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57860",
    "user": "https://github.com/burcin"
}
```

rebased to 4.3.2



---

archive/issue_comments_057861.json:
```json
{
    "body": "rebased to 4.3.2",
    "created_at": "2010-02-09T10:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57861",
    "user": "https://github.com/burcin"
}
```

rebased to 4.3.2



---

archive/attachments_007654.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6465-moves-integration-into-sfunction-subclass.take3.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket6465/trac_6465-moves-integration-into-sfunction-subclass.take3.patch",
    "created_at": "2010-02-09T11:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_057862.json:
```json
{
    "body": "<a id='comment:19'></a>\nI rebased the patches to 4.3.2. Patches to be applied are now:\n\n* attachment:trac_6465-chain_rule.take2.patch\n* attachment:trac_6465-moves-integration-into-sfunction-subclass.take3.patch\n* attachment:trac_6465-integral.take4.patch",
    "created_at": "2010-02-09T11:01:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57862",
    "user": "https://github.com/burcin"
}
```

<a id='comment:19'></a>
I rebased the patches to 4.3.2. Patches to be applied are now:

* attachment:trac_6465-chain_rule.take2.patch
* attachment:trac_6465-moves-integration-into-sfunction-subclass.take3.patch
* attachment:trac_6465-integral.take4.patch



---

archive/issue_comments_057863.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe patch solves the stated problem without loss of functionality (at\nleast in the tests below). +1 for positive review.\n\n```\nsage: f(x) = function('f',x)\nsage: g = integrate(f(x),x)\nsage: g.diff(x)\nf(x)\nsage: integrate(f(x),x).diff(x)\nf(x)\n\nsage: h(x,y) = function('h',x,y)\nsage: kx = integrate(h(x,y),x)\nsage: kx\nintegrate(h(x, y), x)\nsage: kx.diff(x)\nh(x, y)\n\nsage: kxy = integrate( integrate(h(x,y),x), y)\nsage: kxy\nintegrate(integrate(h(x, y), x), y)\nsage: kxy.diff(y).diff(x)\nh(x, y)\nsage: kxy.diff(x).diff(y)\nh(x, y)\nsage: kxy.diff(x)\nintegrate(h(x, y), y)\n\nsage: integrate(1/(2*x+1)^2, x, 0, 1)\n1/3\n\nsage: loads(dumps(integrate(1/(2*x+1)^2, x, 0, 1))) == 1/3\nTrue\n\nsage: integrate(1/(2*x+1)^2, x, 0.0, 1.0)\n0.333333333333\n\nsage: integrate(1/(2*x+1)^2, x, 0, 1.0)\n0.333333333333\n\nsage: integrate(1/(2*x+1)^2, x, CC(0), 1.0)\n0.333333333333\n\nsage: integrate(x/(1+x^2),x)\n1/2*log(x^2 + 1)\n\nsage: integrate(tan(x),x)\nlog(sec(x))\n```\n\nThere is one issue (that is not necessarily a part of this ticket). \nI may be wrong but I'm reasonably sure that in general that \nintegrate( integrate(h(x,y),x), y).diff(y).diff(x) <>\nintegrate( integrate(h(x,y),x), y).diff(x).diff(y)\nBut the following seems to imply it is (both are equal to h(x, y) )\n\n```\nsage: kxy = integrate( integrate(h(x,y),x), y)\nsage: kxy\nintegrate(integrate(h(x, y), x), y)\nsage: kxy.diff(y).diff(x)\nh(x, y)\nsage: kxy.diff(x).diff(y)\nh(x, y)\n```",
    "created_at": "2010-02-18T14:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57863",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

<a id='comment:20'></a>
The patch solves the stated problem without loss of functionality (at
least in the tests below). +1 for positive review.

```
sage: f(x) = function('f',x)
sage: g = integrate(f(x),x)
sage: g.diff(x)
f(x)
sage: integrate(f(x),x).diff(x)
f(x)

sage: h(x,y) = function('h',x,y)
sage: kx = integrate(h(x,y),x)
sage: kx
integrate(h(x, y), x)
sage: kx.diff(x)
h(x, y)

sage: kxy = integrate( integrate(h(x,y),x), y)
sage: kxy
integrate(integrate(h(x, y), x), y)
sage: kxy.diff(y).diff(x)
h(x, y)
sage: kxy.diff(x).diff(y)
h(x, y)
sage: kxy.diff(x)
integrate(h(x, y), y)

sage: integrate(1/(2*x+1)^2, x, 0, 1)
1/3

sage: loads(dumps(integrate(1/(2*x+1)^2, x, 0, 1))) == 1/3
True

sage: integrate(1/(2*x+1)^2, x, 0.0, 1.0)
0.333333333333

sage: integrate(1/(2*x+1)^2, x, 0, 1.0)
0.333333333333

sage: integrate(1/(2*x+1)^2, x, CC(0), 1.0)
0.333333333333

sage: integrate(x/(1+x^2),x)
1/2*log(x^2 + 1)

sage: integrate(tan(x),x)
log(sec(x))
```

There is one issue (that is not necessarily a part of this ticket). 
I may be wrong but I'm reasonably sure that in general that 
integrate( integrate(h(x,y),x), y).diff(y).diff(x) <>
integrate( integrate(h(x,y),x), y).diff(x).diff(y)
But the following seems to imply it is (both are equal to h(x, y) )

```
sage: kxy = integrate( integrate(h(x,y),x), y)
sage: kxy
integrate(integrate(h(x, y), x), y)
sage: kxy.diff(y).diff(x)
h(x, y)
sage: kxy.diff(x).diff(y)
h(x, y)
```



---

archive/issue_comments_057864.json:
```json
{
    "body": "**Changing reviewer** from \"Tim Dumol, Karl-Dieter Crisman\" to \"Tim Dumol, Karl-Dieter Crisman, Ross Kyprianou\".",
    "created_at": "2010-02-18T14:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57864",
    "user": "https://trac.sagemath.org/admin/accounts/users/rossk"
}
```

**Changing reviewer** from "Tim Dumol, Karl-Dieter Crisman" to "Tim Dumol, Karl-Dieter Crisman, Ross Kyprianou".



---

archive/issue_comments_057865.json:
```json
{
    "body": "**Changing reviewer** from \"Tim Dumol, Karl-Dieter Crisman, Ross Kyprianou\" to \"Tim Dumol, Karl-Dieter Crisman, Ross Kyprianou, Minh Van Nguyen\".",
    "created_at": "2010-02-18T21:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57865",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing reviewer** from "Tim Dumol, Karl-Dieter Crisman, Ross Kyprianou" to "Tim Dumol, Karl-Dieter Crisman, Ross Kyprianou, Minh Van Nguyen".



---

archive/issue_comments_057866.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2010-02-18T21:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57866",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_057867.json:
```json
{
    "body": "<a id='comment:21'></a>\nThe rebase looks good. See #6961 for the order in which to apply patches.",
    "created_at": "2010-02-18T21:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57867",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:21'></a>
The rebase looks good. See #6961 for the order in which to apply patches.



---

archive/issue_comments_057868.json:
```json
{
    "body": "<a id='comment:22'></a>\nMerged in this order:\n\n1. [trac_6465-chain_rule.take2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/6465/trac_6465-chain_rule.take2.patch)\n2. [trac_6465-moves-integration-into-sfunction-subclass.take3.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/6465/trac_6465-moves-integration-into-sfunction-subclass.take3.patch)\n3. [trac_6465-integral.take4.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/6465/trac_6465-integral.take4.patch)",
    "created_at": "2010-02-18T21:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57868",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:22'></a>
Merged in this order:

1. [trac_6465-chain_rule.take2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/6465/trac_6465-chain_rule.take2.patch)
2. [trac_6465-moves-integration-into-sfunction-subclass.take3.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/6465/trac_6465-moves-integration-into-sfunction-subclass.take3.patch)
3. [trac_6465-integral.take4.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/6465/trac_6465-integral.take4.patch)



---

archive/issue_events_019732.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-02-18T21:51:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6465#event-19732"
}
```



---

archive/issue_comments_057869.json:
```json
{
    "body": "**Merged:** sage-4.3.3.alpha1",
    "created_at": "2010-02-18T21:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6465#issuecomment-57869",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Merged:** sage-4.3.3.alpha1
