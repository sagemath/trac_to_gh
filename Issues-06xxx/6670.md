# Issue 6670: Port group algebras to the current coercion system

archive/issues_006670.json:
```json
{
    "body": "This upgrades the group algebras to the current coercion system and fixes some issues of multiplication of group algebras A and B, satisfying A == B but not admitting coercion of elements.\nThis depends on #6669, which concerns homomorphisms from matrix group to other objects.\n\n**Apply:**\n1. [attachment:trac_6670-jhp.patch]\n2. [attachment:trac-6670-functors.patch]\n\n\n**Assignee:** mraum\n\n**Author:** Martin Raum, John Palmieri\n\n**Reviewer:** John Palmieri, Martin Raum\n\n**Merged:** sage-4.7.2.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/6670\n\n",
    "closed_at": "2011-08-18T22:01:43Z",
    "created_at": "2009-08-03T20:41:36Z",
    "labels": [
        "component: algebra",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.7.2",
    "title": "Port group algebras to the current coercion system",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/6670",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```
This upgrades the group algebras to the current coercion system and fixes some issues of multiplication of group algebras A and B, satisfying A == B but not admitting coercion of elements.
This depends on #6669, which concerns homomorphisms from matrix group to other objects.

**Apply:**
1. [attachment:trac_6670-jhp.patch]
2. [attachment:trac-6670-functors.patch]


**Assignee:** mraum

**Author:** Martin Raum, John Palmieri

**Reviewer:** John Palmieri, Martin Raum

**Merged:** sage-4.7.2.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/6670





---

archive/attachments_007984.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-6670-group_algebra.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac-6670-group_algebra.patch",
    "created_at": "2009-08-03T20:42:52Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```



---

archive/issue_comments_048185.json:
```json
{
    "body": "Attachment [trac-6670-group_algebra.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra.patch) by mraum created at 2009-08-03 20:42:52",
    "created_at": "2009-08-03T20:42:52Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48185",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Attachment [trac-6670-group_algebra.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra.patch) by mraum created at 2009-08-03 20:42:52



---

archive/attachments_007985.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-6670-group_algebra-2.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac-6670-group_algebra-2.patch",
    "created_at": "2009-10-22T16:46:17Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-2.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```



---

archive/issue_comments_048186.json:
```json
{
    "body": "Attachment [trac-6670-group_algebra-2.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-2.patch) by mraum created at 2009-10-22 16:46:17\n\nThis is a rebase to 4.1.2",
    "created_at": "2009-10-22T16:46:17Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48186",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Attachment [trac-6670-group_algebra-2.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-2.patch) by mraum created at 2009-10-22 16:46:17

This is a rebase to 4.1.2



---

archive/issue_events_044141.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2009-10-22T16:52:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44141"
}
```



---

archive/issue_events_044142.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2009-10-22T16:52:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44142"
}
```



---

archive/issue_comments_048187.json:
```json
{
    "body": "<a id='comment:1'></a>\nA patch for #6669 has been uploaded. This patch depends on it.",
    "created_at": "2009-10-22T16:52:04Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48187",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:1'></a>
A patch for #6669 has been uploaded. This patch depends on it.



---

archive/issue_comments_048188.json:
```json
{
    "body": "**Author:** Martin Raum",
    "created_at": "2009-11-15T09:32:00Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48188",
    "user": "https://github.com/aghitza"
}
```

**Author:** Martin Raum



---

archive/issue_events_044143.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2009-11-20T05:20:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44143"
}
```



---

archive/issue_events_044144.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2009-11-20T05:20:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44144"
}
```



---

archive/issue_comments_048189.json:
```json
{
    "body": "<a id='comment:3'></a>\nThere's a lot of new code here, but it all looks good, and the doctests are fine too. \n\nGiven the amount of category code that went into 4.3, we should make sure all tests pass when applied against that as well. (I tested against 4.2.)",
    "created_at": "2009-11-20T05:20:21Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48189",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:3'></a>
There's a lot of new code here, but it all looks good, and the doctests are fine too. 

Given the amount of category code that went into 4.3, we should make sure all tests pass when applied against that as well. (I tested against 4.2.)



---

archive/issue_events_044145.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2009-11-29T07:10:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44145"
}
```



---

archive/issue_events_044146.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2009-11-29T07:10:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44146"
}
```



---

archive/issue_comments_048190.json:
```json
{
    "body": "<a id='comment:4'></a>\nNeeds some work/rebasing for 4.3",
    "created_at": "2009-11-29T07:10:00Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48190",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:4'></a>
Needs some work/rebasing for 4.3



---

archive/attachments_007986.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-6670-group_algebra-3.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac-6670-group_algebra-3.patch",
    "created_at": "2009-12-01T16:46:12Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-3.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```



---

archive/issue_comments_048191.json:
```json
{
    "body": "Attachment [trac-6670-group_algebra-3.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-3.patch) by mraum created at 2009-12-01 16:46:12\n\nThis is a rebase to 4.3alpha0 .",
    "created_at": "2009-12-01T16:46:12Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48191",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Attachment [trac-6670-group_algebra-3.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-3.patch) by mraum created at 2009-12-01 16:46:12

This is a rebase to 4.3alpha0 .



---

archive/issue_events_044147.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2009-12-01T16:48:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44147"
}
```



---

archive/issue_events_044148.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2009-12-01T16:48:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44148"
}
```



---

archive/issue_comments_048192.json:
```json
{
    "body": "<a id='comment:6'></a>\n\n```\n\tsage -t  devel/sage-main/sage/modular/modsym/space.py # Segfault\n\tsage -t  devel/sage-main/sage/algebras/group_algebra.py # 5 doctests failed\n\tsage -t  devel/sage-main/sage/interfaces/sage0.py # 1 doctests failed\n```",
    "created_at": "2010-01-20T09:30:37Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48192",
    "user": "https://github.com/robertwb"
}
```

<a id='comment:6'></a>

```
	sage -t  devel/sage-main/sage/modular/modsym/space.py # Segfault
	sage -t  devel/sage-main/sage/algebras/group_algebra.py # 5 doctests failed
	sage -t  devel/sage-main/sage/interfaces/sage0.py # 1 doctests failed
```



---

archive/issue_events_044149.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2010-01-20T09:30:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44149"
}
```



---

archive/issue_events_044150.json:
```json
{
    "actor": "https://github.com/robertwb",
    "created_at": "2010-01-20T09:30:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44150"
}
```



---

archive/attachments_007987.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-6670-group_algebra-4.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac-6670-group_algebra-4.patch",
    "created_at": "2010-01-21T10:25:42Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-4.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```



---

archive/issue_comments_048193.json:
```json
{
    "body": "Attachment [trac-6670-group_algebra-4.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-4.patch) by mraum created at 2010-01-21 10:25:42\n\nThis applies cleanly to a fresh 4.3.1",
    "created_at": "2010-01-21T10:25:42Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48193",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Attachment [trac-6670-group_algebra-4.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-4.patch) by mraum created at 2010-01-21 10:25:42

This applies cleanly to a fresh 4.3.1



---

archive/issue_events_044151.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2010-01-21T10:26:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44151"
}
```



---

archive/issue_events_044152.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2010-01-21T10:26:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44152"
}
```



---

archive/issue_comments_048194.json:
```json
{
    "body": "<a id='comment:8'></a>\nI'm hoping to take a look at this, but if someone else has time soon and wants to beat me to it, go for it.",
    "created_at": "2010-02-15T19:56:48Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48194",
    "user": "https://github.com/roed314"
}
```

<a id='comment:8'></a>
I'm hoping to take a look at this, but if someone else has time soon and wants to beat me to it, go for it.



---

archive/issue_comments_048195.json:
```json
{
    "body": "<a id='comment:9'></a>\n-- This patch does not apply on sage 4.3.3. Mercurial error message :\n\napplying trac-6670-group_algebra-4.patch\npatching file sage/algebras/group_algebra.py\nHunk #1 FAILED at 27\nHunk #7 succeeded at 358 with fuzz 2 (offset 9 lines).\nHunk #8 FAILED at 361\n2 out of 10 hunks FAILED -- saving rejects to file sage/algebras/group_algebra.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac-6670-group_algebra-4.patch\n\n-- You may want to have a look at the following related bug :\n\nsage: G= SymmetricGroup(5); x, y= G.gens()\nsage: A= GroupAlgebra(G)\nsage: A( A(x) )\n\n...fails. This bug may or may not be automatically fixed by your patch.\n\n-- The docstring on line 367 of group_algebra.py mentions GroupAlgebra.__call__(), even though this method has been suppressed.",
    "created_at": "2010-02-26T17:42:03Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48195",
    "user": "https://trac.sagemath.org/admin/accounts/users/pierre"
}
```

<a id='comment:9'></a>
-- This patch does not apply on sage 4.3.3. Mercurial error message :

applying trac-6670-group_algebra-4.patch
patching file sage/algebras/group_algebra.py
Hunk #1 FAILED at 27
Hunk #7 succeeded at 358 with fuzz 2 (offset 9 lines).
Hunk #8 FAILED at 361
2 out of 10 hunks FAILED -- saving rejects to file sage/algebras/group_algebra.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac-6670-group_algebra-4.patch

-- You may want to have a look at the following related bug :

sage: G= SymmetricGroup(5); x, y= G.gens()
sage: A= GroupAlgebra(G)
sage: A( A(x) )

...fails. This bug may or may not be automatically fixed by your patch.

-- The docstring on line 367 of group_algebra.py mentions GroupAlgebra.__call__(), even though this method has been suppressed.



---

archive/issue_events_044153.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/pierre",
    "created_at": "2010-02-26T17:42:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44153"
}
```



---

archive/issue_events_044154.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/pierre",
    "created_at": "2010-02-26T17:42:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44154"
}
```



---

archive/issue_comments_048196.json:
```json
{
    "body": "**Work_Issues:** unpickling problems",
    "created_at": "2010-07-03T09:47:16Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48196",
    "user": "https://github.com/loefflerd"
}
```

**Work_Issues:** unpickling problems



---

archive/issue_comments_048197.json:
```json
{
    "body": "<a id='comment:10'></a>\nI spent quite a while rebasing this to 4.5.alpha1. I will upload the rebased patch; but I was disappointed to find that there is still a serious issue that needs to be addressed.\n\nThe problem is that unpickling elements of group algebras created using the old code fails; you can't replace a class name with a function name and expect it to unpickle seamlessly. It ends up expecting `sage.algebras.group_algebra.GroupAlgebraElement` to be a class which can just be filled in with the pickled `__dict__` values, not a callable. This is what I get if I pickle a group algebra element without the patch, apply the patch and try to unpickle:\n\n```\nsage: load(\"/home/masiao/gpalg.sobj\")\n---------------------------------------------------------------------------\nUnpicklingError                           Traceback (most recent call last)\n\n/storage/masiao/sage-4.5.alpha1/devel/sage-reviewing/sage/algebras/<ipython console> in <module>()\n\n/storage/masiao/sage-4.5.alpha1/local/lib/python2.6/site-packages/sage/structure/sage_object.so in sage.structure.sage_object.load (sage/structure/sage_object.c:7577)()\n\n/storage/masiao/sage-4.5.alpha1/local/lib/python2.6/site-packages/sage/structure/sage_object.so in sage.structure.sage_object.loads (sage/structure/sage_object.c:9175)()\n\nUnpicklingError: NEWOBJ class argument isn't a type object\n```",
    "created_at": "2010-07-03T09:47:16Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48197",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:10'></a>
I spent quite a while rebasing this to 4.5.alpha1. I will upload the rebased patch; but I was disappointed to find that there is still a serious issue that needs to be addressed.

The problem is that unpickling elements of group algebras created using the old code fails; you can't replace a class name with a function name and expect it to unpickle seamlessly. It ends up expecting `sage.algebras.group_algebra.GroupAlgebraElement` to be a class which can just be filled in with the pickled `__dict__` values, not a callable. This is what I get if I pickle a group algebra element without the patch, apply the patch and try to unpickle:

```
sage: load("/home/masiao/gpalg.sobj")
---------------------------------------------------------------------------
UnpicklingError                           Traceback (most recent call last)

/storage/masiao/sage-4.5.alpha1/devel/sage-reviewing/sage/algebras/<ipython console> in <module>()

/storage/masiao/sage-4.5.alpha1/local/lib/python2.6/site-packages/sage/structure/sage_object.so in sage.structure.sage_object.load (sage/structure/sage_object.c:7577)()

/storage/masiao/sage-4.5.alpha1/local/lib/python2.6/site-packages/sage/structure/sage_object.so in sage.structure.sage_object.loads (sage/structure/sage_object.c:9175)()

UnpicklingError: NEWOBJ class argument isn't a type object
```



---

archive/attachments_007988.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-6670-group_algebra-5.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac-6670-group_algebra-5.patch",
    "created_at": "2010-07-03T09:53:00Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-5.patch",
    "user": "https://github.com/loefflerd"
}
```



---

archive/issue_comments_048198.json:
```json
{
    "body": "Attachment [trac-6670-group_algebra-5.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-5.patch) by @loefflerd created at 2010-07-03 09:53:00\n\nApply only this -- rebased against 4.5.alpha1 and docstrings ReSTified",
    "created_at": "2010-07-03T09:53:00Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48198",
    "user": "https://github.com/loefflerd"
}
```

Attachment [trac-6670-group_algebra-5.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-5.patch) by @loefflerd created at 2010-07-03 09:53:00

Apply only this -- rebased against 4.5.alpha1 and docstrings ReSTified



---

archive/attachments_007989.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-6670-group_algebra-6.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac-6670-group_algebra-6.patch",
    "created_at": "2011-03-23T01:33:50Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-6.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```



---

archive/issue_comments_048199.json:
```json
{
    "body": "Attachment [trac-6670-group_algebra-6.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-6.patch) by mraum created at 2011-03-23 01:33:50",
    "created_at": "2011-03-23T01:33:50Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48199",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Attachment [trac-6670-group_algebra-6.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-6.patch) by mraum created at 2011-03-23 01:33:50



---

archive/attachments_007990.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-6670-group_algebra-7.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac-6670-group_algebra-7.patch",
    "created_at": "2011-03-23T01:34:04Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-7.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```



---

archive/issue_comments_048200.json:
```json
{
    "body": "Attachment [trac-6670-group_algebra-7.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-7.patch) by mraum created at 2011-03-23 01:34:04",
    "created_at": "2011-03-23T01:34:04Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48200",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

Attachment [trac-6670-group_algebra-7.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-group_algebra-7.patch) by mraum created at 2011-03-23 01:34:04



---

archive/issue_comments_048201.json:
```json
{
    "body": "<a id='comment:11'></a>\nI added a completely new file containing the new implementation. The old one is deprecated now, but it still exists and pickling works. William suggested to remove the old implementation in 5.0, which I will open a ticket for as soon as this ticket is merged.",
    "created_at": "2011-03-23T01:36:59Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48201",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:11'></a>
I added a completely new file containing the new implementation. The old one is deprecated now, but it still exists and pickling works. William suggested to remove the old implementation in 5.0, which I will open a ticket for as soon as this ticket is merged.



---

archive/issue_comments_048202.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,2 +1,6 @@\n This upgrades the group algebras to the current coercion system and fixes some issues of multiplication of group algebras A and B, satisfying A == B but not admitting coercion of elements.\n This depends on #6669, which concerns homomorphisms from matrix group to other objects.\n+\n+**Apply:**\n+1. [attachment:trac-6670-group_algebra-6.patch]\n+2. [attachment:trac-6670-group_algebra-7.patch]\n``````\n",
    "created_at": "2011-03-23T01:36:59Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48202",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,2 +1,6 @@
 This upgrades the group algebras to the current coercion system and fixes some issues of multiplication of group algebras A and B, satisfying A == B but not admitting coercion of elements.
 This depends on #6669, which concerns homomorphisms from matrix group to other objects.
+
+**Apply:**
+1. [attachment:trac-6670-group_algebra-6.patch]
+2. [attachment:trac-6670-group_algebra-7.patch]
``````




---

archive/issue_events_044155.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2011-03-23T01:36:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44155"
}
```



---

archive/issue_events_044156.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mraum",
    "created_at": "2011-03-23T01:36:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44156"
}
```



---

archive/issue_comments_048203.json:
```json
{
    "body": "**Changing work_issues** from \"unpickling problems\" to \"\".",
    "created_at": "2011-03-23T01:36:59Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48203",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Changing work_issues** from "unpickling problems" to "".



---

archive/issue_comments_048204.json:
```json
{
    "body": "<a id='comment:12'></a>\nFor the bot:\n\nApply trac-6670-group_algebra-6.patch, trac-6670-group_algebra-7.patch",
    "created_at": "2011-06-25T08:09:58Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48204",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:12'></a>
For the bot:

Apply trac-6670-group_algebra-6.patch, trac-6670-group_algebra-7.patch



---

archive/issue_events_044157.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-07-22T20:29:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44157"
}
```



---

archive/issue_events_044158.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-07-22T20:29:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44158"
}
```



---

archive/issue_comments_048205.json:
```json
{
    "body": "<a id='comment:13'></a>\nSome minor comments:\n\n- The first line of the new file is redundant: \"Group algebra of a group\".  Maybe it should just be \"Group algebras\"?\n- The new file should be added to the reference manual, by adding an appropriate line to `sage/doc/en/reference/algebras.rst`.\n\nMore interesting:\n\n- Can you implement coercion from R[H] to R[G] if H is a subgroup of G, or more generally from R[H] to S[G] if there is a coercion from H to G and from R to S?  Then coercing from the base ring R to R[G] would just be the special case where R=S and H is the trivial group.\n\nA more important issue: I'm not sure that I agree with the implementation.  I would have it inherit from `CombinatorialFreeModule`, and then unique representation is built in nicely so you don't have to cache the results as you do now.  You can also implement the Hopf algebra structure on the group algebra pretty easily.  For reference, you should look at the files\n\n- `sage/categories/examples/hopf_algebras_with_basis.py` for a simple (not very full-featured) implementation of group algebras.\n\n- `sage/algebras/steenrod/steenrod_algebra.py` for the implementation of the Steenrod algebra, including all of its Hopf algebra structure, inheriting from `CombinatorialFreeModule`.  This has a lot of things you don't need, but if you want to base the implementation on the first file, or if you want to modify the print representation of elements (which I recommend), you might be able to use this one to help fill in some details.",
    "created_at": "2011-07-22T20:29:55Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48205",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:13'></a>
Some minor comments:

- The first line of the new file is redundant: "Group algebra of a group".  Maybe it should just be "Group algebras"?
- The new file should be added to the reference manual, by adding an appropriate line to `sage/doc/en/reference/algebras.rst`.

More interesting:

- Can you implement coercion from R[H] to R[G] if H is a subgroup of G, or more generally from R[H] to S[G] if there is a coercion from H to G and from R to S?  Then coercing from the base ring R to R[G] would just be the special case where R=S and H is the trivial group.

A more important issue: I'm not sure that I agree with the implementation.  I would have it inherit from `CombinatorialFreeModule`, and then unique representation is built in nicely so you don't have to cache the results as you do now.  You can also implement the Hopf algebra structure on the group algebra pretty easily.  For reference, you should look at the files

- `sage/categories/examples/hopf_algebras_with_basis.py` for a simple (not very full-featured) implementation of group algebras.

- `sage/algebras/steenrod/steenrod_algebra.py` for the implementation of the Steenrod algebra, including all of its Hopf algebra structure, inheriting from `CombinatorialFreeModule`.  This has a lot of things you don't need, but if you want to base the implementation on the first file, or if you want to modify the print representation of elements (which I recommend), you might be able to use this one to help fill in some details.



---

archive/issue_comments_048206.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,5 +2,5 @@\n This depends on #6669, which concerns homomorphisms from matrix group to other objects.\n \n **Apply:**\n-1. [attachment:trac-6670-group_algebra-6.patch]\n-2. [attachment:trac-6670-group_algebra-7.patch]\n+1. [attachment:trac-6670-jhp.patch]\n+\n``````\n",
    "created_at": "2011-07-28T22:46:11Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48206",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,5 +2,5 @@
 This depends on #6669, which concerns homomorphisms from matrix group to other objects.
 
 **Apply:**
-1. [attachment:trac-6670-group_algebra-6.patch]
-2. [attachment:trac-6670-group_algebra-7.patch]
+1. [attachment:trac-6670-jhp.patch]
+
``````




---

archive/issue_comments_048207.json:
```json
{
    "body": "**Changing author** from \"Martin Raum\" to \"Martin Raum, John Palmieri\".",
    "created_at": "2011-07-28T22:46:11Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48207",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing author** from "Martin Raum" to "Martin Raum, John Palmieri".



---

archive/issue_comments_048208.json:
```json
{
    "body": "<a id='comment:14'></a>\nHere's a new version, which makes the changes I suggested, and also adds some documentation at the top of the file.  I think I preserved all of the tests from the previous version, so we're not losing any functionality.  There are some new things, like an antipode and a comultiplication for elements.",
    "created_at": "2011-07-28T22:46:11Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48208",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>
Here's a new version, which makes the changes I suggested, and also adds some documentation at the top of the file.  I think I preserved all of the tests from the previous version, so we're not losing any functionality.  There are some new things, like an antipode and a comultiplication for elements.



---

archive/issue_events_044159.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-07-28T22:46:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44159"
}
```



---

archive/issue_events_044160.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-07-28T22:46:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44160"
}
```



---

archive/attachments_007991.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6670-jhp.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac_6670-jhp.patch",
    "created_at": "2011-07-28T22:46:49Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac_6670-jhp.patch",
    "user": "https://github.com/jhpalmieri"
}
```



---

archive/issue_comments_048209.json:
```json
{
    "body": "<a id='comment:15'></a>\nAttachment [trac_6670-jhp.patch](https://github.com/sagemath/sage/files/ticket6670/trac_6670-jhp.patch) by @jhpalmieri created at 2011-07-28 22:46:49",
    "created_at": "2011-07-28T22:46:49Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48209",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:15'></a>
Attachment [trac_6670-jhp.patch](https://github.com/sagemath/sage/files/ticket6670/trac_6670-jhp.patch) by @jhpalmieri created at 2011-07-28 22:46:49



---

archive/issue_comments_048210.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,5 +2,5 @@\n This depends on #6669, which concerns homomorphisms from matrix group to other objects.\n \n **Apply:**\n-1. [attachment:trac-6670-jhp.patch]\n+1. [attachment:trac_6670-jhp.patch]\n \n``````\n",
    "created_at": "2011-07-28T22:46:49Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48210",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,5 +2,5 @@
 This depends on #6669, which concerns homomorphisms from matrix group to other objects.
 
 **Apply:**
-1. [attachment:trac-6670-jhp.patch]
+1. [attachment:trac_6670-jhp.patch]
 
``````




---

archive/issue_comments_048211.json:
```json
{
    "body": "<a id='comment:16'></a>\nI'm afraid the new version is quite similar to the original (though much better), so that I wouldn't be a legitimate reviewer. On the other hand, since the changes that you introduced are located in some function that you added I could review this part, as soon as I am back from holidays and you could review the other part. Do you think this is a legitimate solution?\n\nOne thing: The functor needs to be modified, using the new apply methods, that are available thanks to Simon's work. I will do this, if you don't do it first.",
    "created_at": "2011-07-29T16:54:14Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48211",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:16'></a>
I'm afraid the new version is quite similar to the original (though much better), so that I wouldn't be a legitimate reviewer. On the other hand, since the changes that you introduced are located in some function that you added I could review this part, as soon as I am back from holidays and you could review the other part. Do you think this is a legitimate solution?

One thing: The functor needs to be modified, using the new apply methods, that are available thanks to Simon's work. I will do this, if you don't do it first.



---

archive/issue_comments_048212.json:
```json
{
    "body": "<a id='comment:17'></a>\nI think it is important to note that on #11318 it is suggested unifying GroupAlgebra(G, A) and G.algebra(A). But I think we should still get this patch into Sage to have at least some more modern construction until we finally have the implementation anticipated in #11318.",
    "created_at": "2011-07-31T19:57:07Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48212",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:17'></a>
I think it is important to note that on #11318 it is suggested unifying GroupAlgebra(G, A) and G.algebra(A). But I think we should still get this patch into Sage to have at least some more modern construction until we finally have the implementation anticipated in #11318.



---

archive/issue_comments_048213.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,4 +3,5 @@\n \n **Apply:**\n 1. [attachment:trac_6670-jhp.patch]\n+2. [attachment:trac-6670-functors.patch]\n \n``````\n",
    "created_at": "2011-07-31T21:59:44Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48213",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,4 +3,5 @@
 
 **Apply:**
 1. [attachment:trac_6670-jhp.patch]
+2. [attachment:trac-6670-functors.patch]
 
``````




---

archive/attachments_007992.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac-6670-functors.patch",
    "asset_url": "tarball://root/attachments/ticket6670/trac-6670-functors.patch",
    "created_at": "2011-07-31T21:59:44Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6670/trac-6670-functors.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```



---

archive/issue_comments_048214.json:
```json
{
    "body": "<a id='comment:18'></a>\nAttachment [trac-6670-functors.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-functors.patch) by mraum created at 2011-07-31 21:59:44\n\nI attached a patch that changes the way functors are called.\n\nAlso I reviewed the parts that you implemented. That is, the transition to CombinatorialFreeModule. I would give this a positive review. So if you agree with the procedure that I described above and are fine with the rest of the code you can give this a positive review as a whole.",
    "created_at": "2011-07-31T21:59:44Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48214",
    "user": "https://trac.sagemath.org/admin/accounts/users/mraum"
}
```

<a id='comment:18'></a>
Attachment [trac-6670-functors.patch](https://github.com/sagemath/sage/files/ticket6670/trac-6670-functors.patch) by mraum created at 2011-07-31 21:59:44

I attached a patch that changes the way functors are called.

Also I reviewed the parts that you implemented. That is, the transition to CombinatorialFreeModule. I would give this a positive review. So if you agree with the procedure that I described above and are fine with the rest of the code you can give this a positive review as a whole.



---

archive/issue_comments_048215.json:
```json
{
    "body": "**Reviewer:** John Palmieri, Martin Raum",
    "created_at": "2011-08-02T16:55:51Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48215",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri, Martin Raum



---

archive/issue_events_044161.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-08-02T16:55:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44161"
}
```



---

archive/issue_events_044162.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-08-02T16:55:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "milestone": "sage-4.7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44162"
}
```



---

archive/issue_comments_048216.json:
```json
{
    "body": "<a id='comment:19'></a>\nLooks good to me.  The point about #11318 is a good one, although I don't like the way elements of `G.algebra(R)` are printed, compared to elements of `GroupAlgebra(G,R)`.",
    "created_at": "2011-08-02T16:55:51Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48216",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
Looks good to me.  The point about #11318 is a good one, although I don't like the way elements of `G.algebra(R)` are printed, compared to elements of `GroupAlgebra(G,R)`.



---

archive/issue_events_044163.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-08-02T16:55:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44163"
}
```



---

archive/issue_events_044164.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2011-08-02T16:55:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44164"
}
```



---

archive/issue_comments_048217.json:
```json
{
    "body": "**Merged:** sage-4.7.2.alpha2",
    "created_at": "2011-08-18T22:01:43Z",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6670#issuecomment-48217",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.2.alpha2



---

archive/issue_events_044165.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-18T22:01:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44165"
}
```



---

archive/issue_events_044166.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-08-18T22:01:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6670",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6670#event-44166"
}
```
