# Issue 6256: [with patch and package] bug in symbolic arithmetic with exp

archive/issues_006256.json:
```json
{
    "assignees": [
        "https://github.com/burcin"
    ],
    "body": "\n```\nsage: var('kappa')\nkappa\nsage: x = sqrt(kappa)\nsage: F = exp(x)\nsage: F\ne^sqrt(kappa)\nsage: F/F\ne^(2*sqrt(kappa))\nsage: 1/F\ne^(-sqrt(kappa))\nsage: (1/F) * F\ne^(2*sqrt(kappa))\n```\n\nCC:  @jasongrout\n\nComponent: **symbolics**\n\nAuthor: **Burcin Erocal**\n\nReviewer: **Nick Alexander**\n\nMerged: **4.0.2.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6256_\n\n",
    "closed_at": "2009-06-14T21:36:21Z",
    "created_at": "2009-06-10T08:48:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.0.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "[with patch and package] bug in symbolic arithmetic with exp",
    "type": "issue",
    "updated_at": "2009-06-14T21:36:21Z",
    "url": "https://github.com/sagemath/sage/issues/6256",
    "user": "https://github.com/burcin"
}
```

```
sage: var('kappa')
kappa
sage: x = sqrt(kappa)
sage: F = exp(x)
sage: F
e^sqrt(kappa)
sage: F/F
e^(2*sqrt(kappa))
sage: 1/F
e^(-sqrt(kappa))
sage: (1/F) * F
e^(2*sqrt(kappa))
```

CC:  @jasongrout

Component: **symbolics**

Author: **Burcin Erocal**

Reviewer: **Nick Alexander**

Merged: **4.0.2.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/6256_





---

archive/issue_events_075065.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-10T08:48:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "milestone_number": null,
    "milestone_title": "sage-4.0.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75065"
}
```



---

archive/issue_events_075066.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-10T08:48:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75066"
}
```



---

archive/issue_events_075067.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-10T08:48:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "label": "https://github.com/sagemath/sage/labels/p%3A%201%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p: 1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75067"
}
```



---

archive/issue_events_075068.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-10T08:48:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75068"
}
```



---

archive/issue_events_075069.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-10T08:48:57Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "subject": "https://github.com/burcin",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75069"
}
```



---

archive/issue_comments_041564.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHere is the fix for pynac:\n\n```\ndiff --git a/ginac/mul.cpp b/ginac/mul.cpp\n--- a/ginac/mul.cpp\n+++ b/ginac/mul.cpp\n@@ -1167,7 +1167,7 @@\n        if (cmpval != 0) {\n                return cmpval;\n        }\n-       if (seq.size() == 1 && overall_coeff.is_equal(_ex_1))\n+       if (seq.size() == 1 && overall_coeff.is_equal(_ex1))\n                return 0;\n        return 1;\n }\n```\n\nI'll post an updated spkg later together with a fix for #6244.",
    "created_at": "2009-06-13T22:23:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6256#issuecomment-41564",
    "user": "https://github.com/burcin"
}
```

<div id="comment:1" align="right">comment:1</div>

Here is the fix for pynac:

```
diff --git a/ginac/mul.cpp b/ginac/mul.cpp
--- a/ginac/mul.cpp
+++ b/ginac/mul.cpp
@@ -1167,7 +1167,7 @@
        if (cmpval != 0) {
                return cmpval;
        }
-       if (seq.size() == 1 && overall_coeff.is_equal(_ex_1))
+       if (seq.size() == 1 && overall_coeff.is_equal(_ex1))
                return 0;
        return 1;
 }
```

I'll post an updated spkg later together with a fix for #6244.



---

archive/issue_comments_041565.json:
```json
{
    "body": "Attachment: **[trac_6256-pynac_mul_compare_tests.patch.gz](https://github.com/sagemath/sage/files/ticket6256/trac_6256-pynac_mul_compare_tests.patch.gz)**\n\ndoctests",
    "created_at": "2009-06-14T20:51:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6256#issuecomment-41565",
    "user": "https://github.com/burcin"
}
```

Attachment: **[trac_6256-pynac_mul_compare_tests.patch.gz](https://github.com/sagemath/sage/files/ticket6256/trac_6256-pynac_mul_compare_tests.patch.gz)**

doctests



---

archive/issue_comments_041566.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNew pynac package fixes this:\n\nhttp://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.8.p0.spkg\n\nIt also contains fixes for #6244 and #6211, so doctests should be run with patches from those tickets applied.\n\n\nJason, can you review this?",
    "created_at": "2009-06-14T20:59:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6256#issuecomment-41566",
    "user": "https://github.com/burcin"
}
```

<div id="comment:2" align="right">comment:2</div>

New pynac package fixes this:

http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.8.p0.spkg

It also contains fixes for #6244 and #6211, so doctests should be run with patches from those tickets applied.


Jason, can you review this?



---

archive/issue_events_075070.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-14T20:59:32Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "title_is": "[with patch and package] bug in symbolic arithmetic with exp",
    "title_was": "bug in symbolic arithmetic with exp",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75070"
}
```



---

archive/issue_events_075071.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-14T20:59:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75071"
}
```



---

archive/issue_comments_041567.json:
```json
{
    "body": "Reviewer: **Nick Alexander**",
    "created_at": "2009-06-14T21:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6256#issuecomment-41567",
    "user": "https://github.com/ncalexan"
}
```

Reviewer: **Nick Alexander**



---

archive/issue_comments_041568.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nFine by me, works with new spkg.",
    "created_at": "2009-06-14T21:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6256#issuecomment-41568",
    "user": "https://github.com/ncalexan"
}
```

<div id="comment:3" align="right">comment:3</div>

Fine by me, works with new spkg.



---

archive/issue_events_075072.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2009-06-14T21:36:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75072"
}
```



---

archive/issue_events_075073.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2009-06-14T21:36:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75073"
}
```



---

archive/issue_comments_041569.json:
```json
{
    "body": "Merged: **4.0.2.alpha0**",
    "created_at": "2009-06-14T21:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6256#issuecomment-41569",
    "user": "https://github.com/ncalexan"
}
```

Merged: **4.0.2.alpha0**



---

archive/issue_comments_041570.json:
```json
{
    "body": "Author: **Burcin Erocal**",
    "created_at": "2009-06-14T21:36:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6256#issuecomment-41570",
    "user": "https://github.com/ncalexan"
}
```

Author: **Burcin Erocal**



---

archive/issue_events_075074.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2009-06-14T21:36:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75074"
}
```



---

archive/issue_events_075075.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2009-06-14T21:36:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6256",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6256#event-75075"
}
```
