# Issue 6344: Typesetting partial derivatives in new symbolics

archive/issues_006344.json:
```json
{
    "body": "New symbolics uses \"D\" format for derivatives instead of old \"diff\" format. \n\nSee the threads below for discussion on various related issues\n\n**[1]**  http://groups.google.com/group/sage-devel/browse_thread/thread/7479c3eeb96348a2\n\n**[2]**  http://groups.google.com/group/sage-devel/browse_thread/thread/2c8068f27c1fb642\n\nSome patches attached to #5711 also has code for this.\n \n\n\n**Assignee:** @burcin\n\n**CC:**  @jasongrout mvngu @robertwb @eviatarbach schymans @pjbruin @nbruin\n\n**Author:** Burcin Erocal\n\nIssue created by migration from https://trac.sagemath.org/ticket/6344\n\n",
    "closed_at": "2018-05-18T17:16:26Z",
    "created_at": "2009-06-16T23:47:36Z",
    "labels": [
        "component: symbolics",
        "enhancement",
        "wontfix"
    ],
    "title": "Typesetting partial derivatives in new symbolics",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/6344",
    "user": "https://github.com/golam-m-hossain"
}
```
New symbolics uses "D" format for derivatives instead of old "diff" format. 

See the threads below for discussion on various related issues

**[1]**  http://groups.google.com/group/sage-devel/browse_thread/thread/7479c3eeb96348a2

**[2]**  http://groups.google.com/group/sage-devel/browse_thread/thread/2c8068f27c1fb642

Some patches attached to #5711 also has code for this.
 


**Assignee:** @burcin

**CC:**  @jasongrout mvngu @robertwb @eviatarbach schymans @pjbruin @nbruin

**Author:** Burcin Erocal

Issue created by migration from https://trac.sagemath.org/ticket/6344





---

archive/issue_comments_043802.json:
```json
{
    "body": "an attempt at implementing the MMA style, for testing only",
    "created_at": "2009-06-24T21:43:19Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43802",
    "user": "https://github.com/burcin"
}
```

an attempt at implementing the MMA style, for testing only



---

archive/issue_comments_043803.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,8 +6,6 @@\n \n **[2]**  http://groups.google.com/group/sage-devel/browse_thread/thread/2c8068f27c1fb642\n \n-The purpose of this patch to decide the strategy: how to tackle the various issues while typesetting D derivative.\n-\n-Some part of the code from the patch #5711 should be taken out.\n+Some patches attached to #5711 also has code for this.\n  \n \n``````\n",
    "created_at": "2009-06-24T21:49:13Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43803",
    "user": "https://github.com/burcin"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,8 +6,6 @@
 
 **[2]**  http://groups.google.com/group/sage-devel/browse_thread/thread/2c8068f27c1fb642
 
-The purpose of this patch to decide the strategy: how to tackle the various issues while typesetting D derivative.
-
-Some part of the code from the patch #5711 should be taken out.
+Some patches attached to #5711 also has code for this.
  
 
``````




---

archive/issue_events_041339.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-24T21:49:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41339"
}
```



---

archive/issue_events_041340.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-06-24T21:49:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41340"
}
```



---

archive/attachments_007479.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6344-mma_style_attempt.patch",
    "asset_url": "tarball://root/attachments/ticket6344/trac_6344-mma_style_attempt.patch",
    "created_at": "2009-06-24T21:49:13Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6344/trac_6344-mma_style_attempt.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_043804.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [trac_6344-mma_style_attempt.patch](https://github.com/sagemath/sage/files/ticket6344/trac_6344-mma_style_attempt.patch) by @burcin created at 2009-06-24 21:49:13\n\nattachment:trac_6344-mma_style_attempt.patch implements an approximation to MMA style. It is just for testing, needs much more work for inclusion.\n\nIt doesn't look good in text only mode:\n\n```\nsage: f = function('f')\nsage: f(x).derivative(x,3)\nf^{(3)}(x)\n```",
    "created_at": "2009-06-24T21:49:13Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43804",
    "user": "https://github.com/burcin"
}
```

<a id='comment:1'></a>
Attachment [trac_6344-mma_style_attempt.patch](https://github.com/sagemath/sage/files/ticket6344/trac_6344-mma_style_attempt.patch) by @burcin created at 2009-06-24 21:49:13

attachment:trac_6344-mma_style_attempt.patch implements an approximation to MMA style. It is just for testing, needs much more work for inclusion.

It doesn't look good in text only mode:

```
sage: f = function('f')
sage: f(x).derivative(x,3)
f^{(3)}(x)
```



---

archive/issue_comments_043805.json:
```json
{
    "body": "<a id='comment:2'></a>\nI uploaded a new patch at attachment:trac_6344-symbolic_derivative_print.patch.\n\nThe new patch keeps the text mode printing similar to the old one, but changes the printed parameters to indicate how many times each argument is differentiated. E.g., old output:\n\n```\nsage: var('x,y')\nsage: f = function('f')\nsage: f(x).derivative(x)\nD[0](f)(x)\nsage: f(x,x).derivative(x,2)\nD[0, 0](f)(x, x) + 2*D[0, 1](f)(x, x) + D[1, 1](f)(x, x)\n```\n\nNew output:\n\n```\nsage: f(x).derivative(x)\nD[1](f)(x)\nsage: f(x,x).derivative(x,2)\nD[2, 0](f)(x, x) + 2*D[1, 1](f)(x, x) + D[0, 2](f)(x, x)\n```\n\nNew latex output:\n\n```\nsage: latex(f(x).derivative(x))\nf'\\left(x\\right)\nsage: latex(f(x,x).derivative(x,2))\nf^{(2,0)}\\left(x, x\\right) + 2 \\, f^{(1,1)}\\left(x, x\\right) + f^{(0,2)}\\left(x, x\\right)\n```\n\nIt would be better to add more documentation to explain the output, provide conversions to \"textbook style\" and fix other problems that pop up when printing derivatives:\n\n```\nsage: binomial(x,y).derivative(x)\n<boom>\nsage: latex(floor(x).derivative(x))\nD[0]\\left \\lfloor x \\right \\rfloor\nsage: latex(ceil(x).derivative(x))\nD[0]\\left \\lceil x \\right \\rceil\n```\n\nHowever, I think we should settle on an output style ASAP, without letting too many releases go by.\n\nJason, Minh, can one (or both) of you review this?",
    "created_at": "2009-07-14T21:39:10Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43805",
    "user": "https://github.com/burcin"
}
```

<a id='comment:2'></a>
I uploaded a new patch at attachment:trac_6344-symbolic_derivative_print.patch.

The new patch keeps the text mode printing similar to the old one, but changes the printed parameters to indicate how many times each argument is differentiated. E.g., old output:

```
sage: var('x,y')
sage: f = function('f')
sage: f(x).derivative(x)
D[0](f)(x)
sage: f(x,x).derivative(x,2)
D[0, 0](f)(x, x) + 2*D[0, 1](f)(x, x) + D[1, 1](f)(x, x)
```

New output:

```
sage: f(x).derivative(x)
D[1](f)(x)
sage: f(x,x).derivative(x,2)
D[2, 0](f)(x, x) + 2*D[1, 1](f)(x, x) + D[0, 2](f)(x, x)
```

New latex output:

```
sage: latex(f(x).derivative(x))
f'\left(x\right)
sage: latex(f(x,x).derivative(x,2))
f^{(2,0)}\left(x, x\right) + 2 \, f^{(1,1)}\left(x, x\right) + f^{(0,2)}\left(x, x\right)
```

It would be better to add more documentation to explain the output, provide conversions to "textbook style" and fix other problems that pop up when printing derivatives:

```
sage: binomial(x,y).derivative(x)
<boom>
sage: latex(floor(x).derivative(x))
D[0]\left \lfloor x \right \rfloor
sage: latex(ceil(x).derivative(x))
D[0]\left \lceil x \right \rceil
```

However, I think we should settle on an output style ASAP, without letting too many releases go by.

Jason, Minh, can one (or both) of you review this?



---

archive/issue_events_041341.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-07-14T21:39:10Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "rename": {
        "from": "Typesetting partial derivatives in new Symbolics",
        "to": "Typesetting partial derivatives in new symbolics"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41341"
}
```



---

archive/issue_events_041342.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-07-14T21:39:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41342"
}
```



---

archive/issue_events_041343.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-07-14T21:39:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41343"
}
```



---

archive/issue_comments_043806.json:
```json
{
    "body": "**Author:** Burcin Erocal",
    "created_at": "2009-07-14T21:39:10Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43806",
    "user": "https://github.com/burcin"
}
```

**Author:** Burcin Erocal



---

archive/issue_events_041344.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2009-07-14T21:39:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41344"
}
```



---

archive/issue_comments_043807.json:
```json
{
    "body": "**Assignee:** @burcin",
    "created_at": "2009-07-14T21:39:10Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43807",
    "user": "https://github.com/burcin"
}
```

**Assignee:** @burcin



---

archive/attachments_007480.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_6344-symbolic_derivative_print.patch",
    "asset_url": "tarball://root/attachments/ticket6344/trac_6344-symbolic_derivative_print.patch",
    "created_at": "2009-07-14T21:39:39Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket6344/trac_6344-symbolic_derivative_print.patch",
    "user": "https://github.com/burcin"
}
```



---

archive/issue_comments_043808.json:
```json
{
    "body": "Attachment [trac_6344-symbolic_derivative_print.patch](https://github.com/sagemath/sage/files/ticket6344/trac_6344-symbolic_derivative_print.patch) by @burcin created at 2009-07-14 21:39:39\n\nchange printing of symbolic derivatives",
    "created_at": "2009-07-14T21:39:39Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43808",
    "user": "https://github.com/burcin"
}
```

Attachment [trac_6344-symbolic_derivative_print.patch](https://github.com/sagemath/sage/files/ticket6344/trac_6344-symbolic_derivative_print.patch) by @burcin created at 2009-07-14 21:39:39

change printing of symbolic derivatives



---

archive/issue_comments_043809.json:
```json
{
    "body": "<a id='comment:3'></a>\nThis needs a slight rebasing to be applied and tested to Sage 4.2, in calculus/tests.py and symbolic/pynac.pyx.",
    "created_at": "2009-10-29T18:19:26Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43809",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>
This needs a slight rebasing to be applied and tested to Sage 4.2, in calculus/tests.py and symbolic/pynac.pyx.



---

archive/issue_events_041345.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2009-10-29T18:19:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41345"
}
```



---

archive/issue_events_041346.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41346"
}
```



---

archive/issue_events_041347.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41347"
}
```



---

archive/issue_events_041348.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41348"
}
```



---

archive/issue_events_041349.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41349"
}
```



---

archive/issue_comments_043810.json:
```json
{
    "body": "<a id='comment:10'></a>\n#14517 has a similar complaint.",
    "created_at": "2014-03-12T08:50:15Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43810",
    "user": "https://github.com/burcin"
}
```

<a id='comment:10'></a>
#14517 has a similar complaint.



---

archive/issue_events_041350.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41350"
}
```



---

archive/issue_events_041351.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41351"
}
```



---

archive/issue_events_041352.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41352"
}
```



---

archive/issue_events_041353.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41353"
}
```



---

archive/issue_comments_043811.json:
```json
{
    "body": "<a id='comment:13'></a>\nI tried to apply the most recent patch, but did not succeed. It is just too old and when looking at the diff I couldn't make any sense of it. I tried to implement differential notation myself, but got stuck, perhaps someone can help?\n\nAll I wanted to do is to change the `_latex_` representation of the FDerivativeOperator and added the following lines to src/sage/symbolic/operators.py:\n\n\n```\ndef _latex_(self):\n        \"\"\"\n            Return the LaTeX representation of X.\n\n            EXAMPLES::\n\n            sage: from sage.symbolic.operators import FDerivativeOperator\n            sage: var('x z')\n            sage: f = function('f', x, z)\n            sage: op = FDerivativeOperator(f, [0,1]); latex(op)\n            \\frac{\\partial \\frac{\\partial f }{\\partial x } }{\\partial z }\n        \"\"\"\n        fname = self._f.operator()\n        vars = self._f.operands()\n        difvars = self._parameter_set\n        str1 = str(fname)\n        for difvar in difvars:\n            str1 = '\\\\frac{\\partial '+str1+'}{\\partial '+str(vars[difvar])+'}'\n        return str1\n```\nUnfortunately, this does not have any effect on the latex representation of f.diff:\n\n```\nsage: f = function('f', x, z)\nsage: g = diff(f, x,z)\nsage: latex(g)\nD[0, 1]\\left(f\\right)\\left(x, z\\right)\n```\n\nDoes anyone have an idea what else I need to modify? Thanks in advance!",
    "created_at": "2014-12-03T21:41:12Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43811",
    "user": "https://trac.sagemath.org/admin/accounts/users/schymans"
}
```

<a id='comment:13'></a>
I tried to apply the most recent patch, but did not succeed. It is just too old and when looking at the diff I couldn't make any sense of it. I tried to implement differential notation myself, but got stuck, perhaps someone can help?

All I wanted to do is to change the `_latex_` representation of the FDerivativeOperator and added the following lines to src/sage/symbolic/operators.py:


```
def _latex_(self):
        """
            Return the LaTeX representation of X.

            EXAMPLES::

            sage: from sage.symbolic.operators import FDerivativeOperator
            sage: var('x z')
            sage: f = function('f', x, z)
            sage: op = FDerivativeOperator(f, [0,1]); latex(op)
            \frac{\partial \frac{\partial f }{\partial x } }{\partial z }
        """
        fname = self._f.operator()
        vars = self._f.operands()
        difvars = self._parameter_set
        str1 = str(fname)
        for difvar in difvars:
            str1 = '\\frac{\partial '+str1+'}{\partial '+str(vars[difvar])+'}'
        return str1
```
Unfortunately, this does not have any effect on the latex representation of f.diff:

```
sage: f = function('f', x, z)
sage: g = diff(f, x,z)
sage: latex(g)
D[0, 1]\left(f\right)\left(x, z\right)
```

Does anyone have an idea what else I need to modify? Thanks in advance!



---

archive/issue_comments_043812.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [schymans](#comment%3A13):\n> All I wanted to do is to change the `_latex_` representation of the FDerivativeOperator and added the following lines to src/sage/symbolic/operators.py:\n\n\nLooks like the wrong place to hook into this. For symbolic expressions. `self._latex_` invokes `SR._latex_element_` which calls straight into Pynac via ` GEx_to_str_latex(&x._gobj)`. Your experiment shows that this doesn't dispatch to `_latex_` methods on operators. Perhaps there's another hook?\n\nIncidentally, your code wouldn't work, because that's not how FDerivateOperators occur in code:\n\n```\nsage: var(\"x,y\")\n(x, y)\nsage: function('f',x,y)\nf(x, y)\nsage: g=diff(f(x,y),x,y)\nsage: g\nD[0, 1](f)(x, y)\nsage: g.operator()\nD[0, 1](f)\nsage: type(g.operator())\n<class 'sage.symbolic.operators.FDerivativeOperator'>\nsage: g.operator()._f\nf\n```\nAs you can see, there are no variable names to refer to. That's why this ticket has stalled: if you want to do this, you need to recognize on the level of `g` that the operator is an `FDerivativeOperator` and hence that, if the operands of `g` are distinct, simple symbolic variables, that the derivative could be written in Leibnitz notation.\n\nClearly, people haven't found the effort required worth the payoff.",
    "created_at": "2014-12-03T22:48:26Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43812",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:15'></a>
Replying to [schymans](#comment%3A13):
> All I wanted to do is to change the `_latex_` representation of the FDerivativeOperator and added the following lines to src/sage/symbolic/operators.py:


Looks like the wrong place to hook into this. For symbolic expressions. `self._latex_` invokes `SR._latex_element_` which calls straight into Pynac via ` GEx_to_str_latex(&x._gobj)`. Your experiment shows that this doesn't dispatch to `_latex_` methods on operators. Perhaps there's another hook?

Incidentally, your code wouldn't work, because that's not how FDerivateOperators occur in code:

```
sage: var("x,y")
(x, y)
sage: function('f',x,y)
f(x, y)
sage: g=diff(f(x,y),x,y)
sage: g
D[0, 1](f)(x, y)
sage: g.operator()
D[0, 1](f)
sage: type(g.operator())
<class 'sage.symbolic.operators.FDerivativeOperator'>
sage: g.operator()._f
f
```
As you can see, there are no variable names to refer to. That's why this ticket has stalled: if you want to do this, you need to recognize on the level of `g` that the operator is an `FDerivativeOperator` and hence that, if the operands of `g` are distinct, simple symbolic variables, that the derivative could be written in Leibnitz notation.

Clearly, people haven't found the effort required worth the payoff.



---

archive/issue_comments_043813.json:
```json
{
    "body": "<a id='comment:16'></a>\nThanks for the quick answer! From the user's perspective, the best way would be to have an option similar to derivative_func in the function definition, allowing to define the notation for derivatives. The efforts required seems indeed amazingly high. \n\nWouldn't it be possible to write some parsing code to convert something like D[0,1](f)(x,y) to any kind of notation? It should even be possible to convert it back to diff(f(x,y),x,y), as requested here: http://comments.gmane.org/gmane.comp.mathematics.sage.devel/58040",
    "created_at": "2014-12-04T00:40:08Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43813",
    "user": "https://trac.sagemath.org/admin/accounts/users/schymans"
}
```

<a id='comment:16'></a>
Thanks for the quick answer! From the user's perspective, the best way would be to have an option similar to derivative_func in the function definition, allowing to define the notation for derivatives. The efforts required seems indeed amazingly high. 

Wouldn't it be possible to write some parsing code to convert something like D[0,1](f)(x,y) to any kind of notation? It should even be possible to convert it back to diff(f(x,y),x,y), as requested here: http://comments.gmane.org/gmane.comp.mathematics.sage.devel/58040



---

archive/issue_comments_043814.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [schymans](#comment%3A16):\n> Wouldn't it be possible to write some parsing code to convert something like D[0,1](f)(x,y) to any kind of notation? It should even be possible to convert it back to diff(f(x,y),x,y), as requested here: http://comments.gmane.org/gmane.comp.mathematics.sage.devel/58040\n\n\nIt's really much easier to do on the expression tree than on a string. We do it for conversions already. See e.g. [https://github.com/sagemath/sage/blob/master/src/sage/interfaces/maxima_lib.py#L1564](https://github.com/sagemath/sage/blob/master/src/sage/interfaces/maxima_lib.py#L1564). The approach is straightforward. The hard work is that you need to reach into Pynac to make the change. So it takes someone conversant with Pynac who cares enough to do it. Doing it on strings afterwards is going to be horrible.\n\nIncidentally, watch out that an expression like\n\n```\nD[0,1](f)(x,x+1)\n```\nis almost impossible to write in Leibnitz notation unless you introduce auxiliary variables (which is what happens in the maxima_lib code). So you should probably just stick with operator notation for those cases (maple does).",
    "created_at": "2014-12-04T01:26:06Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43814",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:17'></a>
Replying to [schymans](#comment%3A16):
> Wouldn't it be possible to write some parsing code to convert something like D[0,1](f)(x,y) to any kind of notation? It should even be possible to convert it back to diff(f(x,y),x,y), as requested here: http://comments.gmane.org/gmane.comp.mathematics.sage.devel/58040


It's really much easier to do on the expression tree than on a string. We do it for conversions already. See e.g. [https://github.com/sagemath/sage/blob/master/src/sage/interfaces/maxima_lib.py#L1564](https://github.com/sagemath/sage/blob/master/src/sage/interfaces/maxima_lib.py#L1564). The approach is straightforward. The hard work is that you need to reach into Pynac to make the change. So it takes someone conversant with Pynac who cares enough to do it. Doing it on strings afterwards is going to be horrible.

Incidentally, watch out that an expression like

```
D[0,1](f)(x,x+1)
```
is almost impossible to write in Leibnitz notation unless you introduce auxiliary variables (which is what happens in the maxima_lib code). So you should probably just stick with operator notation for those cases (maple does).



---

archive/issue_comments_043815.json:
```json
{
    "body": "<a id='comment:18'></a>\nI see. Would it be easier to allow the user to define custom latex representations for just some standard differentials one anticipates when defining a function? For all others, the system could fall back to the D[0,1] (f)(x,z) notation. A simple replacement rule when latexing an expression could do it. \n\nBy the way, it took me a quite some time of digging in the code to understand the meaning of e.g. D[0,1](f)(x,z). Now that I have understood it, I see its use. I was expecting a description in the documentation of the diff() or differential() command, but I didn't find it there. Where is the right place to look?",
    "created_at": "2014-12-04T08:34:10Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43815",
    "user": "https://trac.sagemath.org/admin/accounts/users/schymans"
}
```

<a id='comment:18'></a>
I see. Would it be easier to allow the user to define custom latex representations for just some standard differentials one anticipates when defining a function? For all others, the system could fall back to the D[0,1] (f)(x,z) notation. A simple replacement rule when latexing an expression could do it. 

By the way, it took me a quite some time of digging in the code to understand the meaning of e.g. D[0,1](f)(x,z). Now that I have understood it, I see its use. I was expecting a description in the documentation of the diff() or differential() command, but I didn't find it there. Where is the right place to look?



---

archive/issue_comments_043816.json:
```json
{
    "body": "<a id='comment:19'></a>\n> By the way, it took me a quite some time of digging in the code to understand the meaning of e.g. D[0,1](f)(x,z). Now that I have understood it, I see its use. I was expecting a description in the documentation of the diff() or differential() command, but I didn't find it there. Where is the right place to look?\n\n\nIf anyone should know, I should, but I don't.  It would be *wonderful* to have some better documentation of that where it belongs - want to take a stab?  If so, open a ticket and cc: me.",
    "created_at": "2014-12-04T14:19:29Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43816",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:19'></a>
> By the way, it took me a quite some time of digging in the code to understand the meaning of e.g. D[0,1](f)(x,z). Now that I have understood it, I see its use. I was expecting a description in the documentation of the diff() or differential() command, but I didn't find it there. Where is the right place to look?


If anyone should know, I should, but I don't.  It would be *wonderful* to have some better documentation of that where it belongs - want to take a stab?  If so, open a ticket and cc: me.



---

archive/issue_comments_043817.json:
```json
{
    "body": "<a id='comment:20'></a>\nThanks, this is now http://trac.sagemath.org/ticket/17445\nThere, I mentioned some other, related tickets, which made me realise that I do not fully understand the meaning of the D-notation, so it wouldn't make much sense for me to write a documentation for it. Sorry!",
    "created_at": "2014-12-04T22:16:55Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43817",
    "user": "https://trac.sagemath.org/admin/accounts/users/schymans"
}
```

<a id='comment:20'></a>
Thanks, this is now http://trac.sagemath.org/ticket/17445
There, I mentioned some other, related tickets, which made me realise that I do not fully understand the meaning of the D-notation, so it wouldn't make much sense for me to write a documentation for it. Sorry!



---

archive/issue_comments_043818.json:
```json
{
    "body": "<a id='comment:21'></a>\nWow, after reading the threads in question I see that at this point Sage has existed about as long with this new format as it did with the previous one.  I'm reluctant to make this wontfix, at least the *option* as indicated there\n\n```\npsi(x) = function('psi',x)\ng = diff(psi(x),x)\nlatex(g)\n\\frac{d \\psi\\left(x\\right)}{d x}\n\n# Switch to D format\nsage.symbolic.pynac.typeset_d_as_diff=False\n\nlatex(g)\nD[0]\\psi\\left(x\\right)\n```\nshould exist, except of course the other way around for the default nowadays, I guess.  Maybe that piece of attachment:enhanced-symbolic-typesetting-rebased_to_4.0.1.patch:ticket:5711 should be implemented here instead?",
    "created_at": "2014-12-05T04:11:42Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43818",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:21'></a>
Wow, after reading the threads in question I see that at this point Sage has existed about as long with this new format as it did with the previous one.  I'm reluctant to make this wontfix, at least the *option* as indicated there

```
psi(x) = function('psi',x)
g = diff(psi(x),x)
latex(g)
\frac{d \psi\left(x\right)}{d x}

# Switch to D format
sage.symbolic.pynac.typeset_d_as_diff=False

latex(g)
D[0]\psi\left(x\right)
```
should exist, except of course the other way around for the default nowadays, I guess.  Maybe that piece of attachment:enhanced-symbolic-typesetting-rebased_to_4.0.1.patch:ticket:5711 should be implemented here instead?



---

archive/issue_comments_043819.json:
```json
{
    "body": "<a id='comment:22'></a>\n+1 from me! I was very sad to find out that this had not been implemented.",
    "created_at": "2014-12-05T09:27:35Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43819",
    "user": "https://trac.sagemath.org/admin/accounts/users/schymans"
}
```

<a id='comment:22'></a>
+1 from me! I was very sad to find out that this had not been implemented.



---

archive/issue_comments_043820.json:
```json
{
    "body": "<a id='comment:23'></a>\nNils and/or Peter, would you have objections to the following, based on code from #5711 (if possible)?\n\n```\npsi(x) = function('psi',x)\ng = diff(psi(x),x)\nlatex(g)\nD[0]\\psi\\left(x\\right)\n\n# Switch to D format\nsage.symbolic.pynac.typeset_d_as_diff=True\n\nlatex(g)\n\\frac{d \\psi\\left(x\\right)}{d x}\n```",
    "created_at": "2014-12-05T14:08:23Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43820",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:23'></a>
Nils and/or Peter, would you have objections to the following, based on code from #5711 (if possible)?

```
psi(x) = function('psi',x)
g = diff(psi(x),x)
latex(g)
D[0]\psi\left(x\right)

# Switch to D format
sage.symbolic.pynac.typeset_d_as_diff=True

latex(g)
\frac{d \psi\left(x\right)}{d x}
```



---

archive/issue_comments_043821.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [kcrisman](#comment%3A23):\n> Nils and/or Peter, would you have objections to the following, based on code from #5711 (if possible)?\n> \n> ```\n> ...\n> sage.symbolic.pynac.typeset_d_as_diff=True\n> \n> latex(g)\n> \\frac{d \\psi\\left(x\\right)}{d x}\n> ```\n\nOnly do that when the argument list consists only of distinct symbolic variables. Then you can even print \"diff\" for the normal rep. See links above for code that makes this distinction already. This is what Maple does too, by the way.",
    "created_at": "2014-12-05T17:39:38Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43821",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:24'></a>
Replying to [kcrisman](#comment%3A23):
> Nils and/or Peter, would you have objections to the following, based on code from #5711 (if possible)?
> 
> ```
> ...
> sage.symbolic.pynac.typeset_d_as_diff=True
> 
> latex(g)
> \frac{d \psi\left(x\right)}{d x}
> ```

Only do that when the argument list consists only of distinct symbolic variables. Then you can even print "diff" for the normal rep. See links above for code that makes this distinction already. This is what Maple does too, by the way.



---

archive/issue_comments_043822.json:
```json
{
    "body": "<a id='comment:25'></a>\nOh, so that's where the `t0` and friends come from.  Funny thing... what if those variables are already taken?  <ducks />",
    "created_at": "2014-12-05T17:52:15Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43822",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:25'></a>
Oh, so that's where the `t0` and friends come from.  Funny thing... what if those variables are already taken?  <ducks />



---

archive/issue_comments_043823.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [kcrisman](#comment%3A25):\n> Oh, so that's where the `t0` and friends come from.  Funny thing... what if those variables are already taken?\n\nThought about that, no problem. They get substituted right away.",
    "created_at": "2014-12-05T17:58:51Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43823",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:26'></a>
Replying to [kcrisman](#comment%3A25):
> Oh, so that's where the `t0` and friends come from.  Funny thing... what if those variables are already taken?

Thought about that, no problem. They get substituted right away.



---

archive/issue_comments_043824.json:
```json
{
    "body": "<a id='comment:27'></a>\n#21286 has dealt with with this. Close as duplicate/invalid ?",
    "created_at": "2018-03-22T01:28:35Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43824",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:27'></a>
#21286 has dealt with with this. Close as duplicate/invalid ?



---

archive/issue_events_041354.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2018-03-22T01:28:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41354"
}
```



---

archive/issue_events_041355.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2018-03-22T01:28:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41355"
}
```



---

archive/issue_events_041356.json:
```json
{
    "actor": "https://github.com/nbruin",
    "created_at": "2018-03-22T01:28:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41356"
}
```



---

archive/issue_events_041357.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-04-15T11:46:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41357"
}
```



---

archive/issue_events_041358.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-04-15T11:46:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41358"
}
```



---

archive/issue_events_041359.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-18T17:16:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41359"
}
```



---

archive/issue_comments_043825.json:
```json
{
    "body": "<a id='comment:29'></a>\nclosing positively reviewed duplicates",
    "created_at": "2018-05-18T17:16:26Z",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6344#issuecomment-43825",
    "user": "https://github.com/videlec"
}
```

<a id='comment:29'></a>
closing positively reviewed duplicates



---

archive/issue_events_041360.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-18T17:16:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41360"
}
```



---

archive/issue_events_041361.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2018-05-18T17:16:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6344",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6344#event-41361"
}
```
