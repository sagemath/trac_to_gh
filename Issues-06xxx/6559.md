# Issue 6559: Real domain for symbolic variables

archive/issues_006559.json:
```json
{
    "assignees": [],
    "body": "In new symbolics, the default symbolic variables are complex.\nHowever, sometime it is useful/desirable to make the domain of\nvariables to be real.\n\n\nCurrently, there are no way to specify the domain of variables\nin Sage although underlying Ginac allows it.  For example: following\nwould to be good to have.\n\n```\nsage: var('x,y,z', domain='real')\n```\n\n\n\n\nInstructions for installing these patches (sage-4.1.1)\n\n**(1) Pynac patch**   \n (a) Get the pynac spkg\n\n http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.8.p2.spkg\n\n (b) Apply the pynac patch for enhanced symbols\n\n http://www.math.unb.ca/~ghossain/texname-and-domain-of-symbols-pynac.patch\n\n (c) install the patched spkg in Sage.\n\n **OR** if you are feeling lazy, you can directly install my patched copy of pynac from here\n\n http://www.math.unb.ca/~ghossain/pynac-0.1.8.p2-symbols.spkg\n\n\n**(2) Sage patch:**\n\nApply the attached sage patch after modified pynac spkg is installed\n\n**Notes:**\n\n#6403 will also be resolved by this patch\n\n#6340 patch conflicts with this patch. This patch here should supersede the patch at #6340.\n\n\nComponent: **symbolics**\n\nKeywords: **pynac**\n\nAuthor: **Golam Mortuza Hossain, Burcin Erocal**\n\nReviewer: **Karl-Dieter Crisman, Ross Kyprianou, Minh Van Nguyen**\n\nMerged: **sage-4.3.3.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6559_\n\n",
    "closed_at": "2010-02-18T21:53:42Z",
    "created_at": "2009-07-19T11:10:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.3.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Real domain for symbolic variables",
    "type": "issue",
    "updated_at": "2010-02-18T21:53:42Z",
    "url": "https://github.com/sagemath/sage/issues/6559",
    "user": "https://github.com/golam-m-hossain"
}
```
In new symbolics, the default symbolic variables are complex.
However, sometime it is useful/desirable to make the domain of
variables to be real.


Currently, there are no way to specify the domain of variables
in Sage although underlying Ginac allows it.  For example: following
would to be good to have.

```
sage: var('x,y,z', domain='real')
```




Instructions for installing these patches (sage-4.1.1)

**(1) Pynac patch**   
 (a) Get the pynac spkg

 http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.8.p2.spkg

 (b) Apply the pynac patch for enhanced symbols

 http://www.math.unb.ca/~ghossain/texname-and-domain-of-symbols-pynac.patch

 (c) install the patched spkg in Sage.

 **OR** if you are feeling lazy, you can directly install my patched copy of pynac from here

 http://www.math.unb.ca/~ghossain/pynac-0.1.8.p2-symbols.spkg


**(2) Sage patch:**

Apply the attached sage patch after modified pynac spkg is installed

**Notes:**

#6403 will also be resolved by this patch

#6340 patch conflicts with this patch. This patch here should supersede the patch at #6340.


Component: **symbolics**

Keywords: **pynac**

Author: **Golam Mortuza Hossain, Burcin Erocal**

Reviewer: **Karl-Dieter Crisman, Ross Kyprianou, Minh Van Nguyen**

Merged: **sage-4.3.3.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/6559_





---

archive/issue_events_078731.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-07-19T11:10:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78731"
}
```



---

archive/issue_events_078732.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-07-19T11:10:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78732"
}
```



---

archive/issue_events_078733.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-07-19T11:10:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78733"
}
```



---

archive/issue_events_078734.json:
```json
{
    "actor": "https://github.com/golam-m-hossain",
    "created_at": "2009-07-19T11:10:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78734"
}
```



---

archive/issue_comments_045280.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\n#6802 is a duplicate of this ticket.",
    "created_at": "2009-08-22T14:17:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45280",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:1" align="right">comment:1</div>

#6802 is a duplicate of this ticket.



---

archive/issue_comments_045281.json:
```json
{
    "body": "Attachment: **[trac_6559-domain-and-latex_name-for-variable.patch.gz](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.patch.gz)**",
    "created_at": "2009-09-05T21:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45281",
    "user": "https://github.com/golam-m-hossain"
}
```

Attachment: **[trac_6559-domain-and-latex_name-for-variable.patch.gz](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.patch.gz)**



---

archive/issue_comments_045282.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,35 @@\n ```\n sage: var('x,y,z', domain='real')\n ```\n+\n+\n+\n+\n+Instructions for installing these patches (sage-4.1.1)\n+\n+**(1) Pynac patch**   \n+ (a) Get the pynac spkg\n+\n+ http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.8.p2.spkg\n+\n+ (b) Apply the pynac patch for enhanced symbols\n+\n+ http://www.math.unb.ca/~ghossain/texname-and-domain-of-symbols-pynac.patch\n+\n+ (c) install the patched spkg in Sage.\n+\n+ **OR** if you are feeling lazy, you can directly install my patched copy of pynac from here\n+\n+ http://www.math.unb.ca/~ghossain/pynac-0.1.8.p2-symbols.spkg\n+\n+\n+**(2) Sage patch:**\n+\n+Apply the attached sage patch after modified pynac spkg is installed\n+\n+**Notes:**\n+\n+#6403 will also be resolved by this patch\n+\n+#6340 patch conflicts with this patch. This patch here should supersede the patch at #6340.\n+\n``````\n",
    "created_at": "2009-09-05T21:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45282",
    "user": "https://github.com/golam-m-hossain"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,35 @@
 ```
 sage: var('x,y,z', domain='real')
 ```
+
+
+
+
+Instructions for installing these patches (sage-4.1.1)
+
+**(1) Pynac patch**   
+ (a) Get the pynac spkg
+
+ http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.8.p2.spkg
+
+ (b) Apply the pynac patch for enhanced symbols
+
+ http://www.math.unb.ca/~ghossain/texname-and-domain-of-symbols-pynac.patch
+
+ (c) install the patched spkg in Sage.
+
+ **OR** if you are feeling lazy, you can directly install my patched copy of pynac from here
+
+ http://www.math.unb.ca/~ghossain/pynac-0.1.8.p2-symbols.spkg
+
+
+**(2) Sage patch:**
+
+Apply the attached sage patch after modified pynac spkg is installed
+
+**Notes:**
+
+#6403 will also be resolved by this patch
+
+#6340 patch conflicts with this patch. This patch here should supersede the patch at #6340.
+
``````




---

archive/issue_comments_045283.json:
```json
{
    "body": "Author: **Golam Mortuza Hossain**",
    "created_at": "2009-09-05T21:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45283",
    "user": "https://github.com/golam-m-hossain"
}
```

Author: **Golam Mortuza Hossain**



---

archive/issue_comments_045284.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHow does this relate to pynac 0.1.9 which is in Sage 4.2.1? ~ Adam",
    "created_at": "2009-11-19T17:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45284",
    "user": "https://github.com/maxthemouse"
}
```

<div id="comment:3" align="right">comment:3</div>

How does this relate to pynac 0.1.9 which is in Sage 4.2.1? ~ Adam



---

archive/issue_comments_045285.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nApplied patch and the following errors were returned:\n\n```\napplying trac_6559-domain-and-latex_name-for-variable.patch\npatching file sage/calculus/var.pyx\nHunk #1 FAILED at 0\nHunk #2 FAILED at 8\nHunk #4 FAILED at 81\n3 out of 4 hunks FAILED -- saving rejects to file sage/calculus/var.pyx.rej\npatching file sage/symbolic/pynac.pyx\nHunk #1 FAILED at 454\nHunk #2 FAILED at 504\n2 out of 2 hunks FAILED -- saving rejects to file sage/symbolic/pynac.pyx.rej\npatching file sage/symbolic/ring.pyx\nHunk #6 succeeded at 769 with fuzz 1 (offset -2 lines).\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_6559-domain-and-latex_name-for-variable.patch\n```",
    "created_at": "2010-01-14T03:56:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45285",
    "user": "https://github.com/sagetrac-rossk"
}
```

<div id="comment:4" align="right">comment:4</div>

Applied patch and the following errors were returned:

```
applying trac_6559-domain-and-latex_name-for-variable.patch
patching file sage/calculus/var.pyx
Hunk #1 FAILED at 0
Hunk #2 FAILED at 8
Hunk #4 FAILED at 81
3 out of 4 hunks FAILED -- saving rejects to file sage/calculus/var.pyx.rej
patching file sage/symbolic/pynac.pyx
Hunk #1 FAILED at 454
Hunk #2 FAILED at 504
2 out of 2 hunks FAILED -- saving rejects to file sage/symbolic/pynac.pyx.rej
patching file sage/symbolic/ring.pyx
Hunk #6 succeeded at 769 with fuzz 1 (offset -2 lines).
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_6559-domain-and-latex_name-for-variable.patch
```



---

archive/issue_events_078735.json:
```json
{
    "actor": "https://github.com/sagetrac-rossk",
    "created_at": "2010-01-14T03:56:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78735"
}
```



---

archive/issue_events_078736.json:
```json
{
    "actor": "https://github.com/sagetrac-rossk",
    "created_at": "2010-01-14T03:56:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78736"
}
```



---

archive/issue_events_078737.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-18T02:43:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "milestone_number": null,
    "milestone_title": "sage-4.3.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78737"
}
```



---

archive/issue_events_078738.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-18T02:43:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78738"
}
```



---

archive/issue_events_078739.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-18T02:43:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78739"
}
```



---

archive/issue_comments_045286.json:
```json
{
    "body": "Work Issues: **needs rebase**",
    "created_at": "2010-01-18T02:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45286",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Work Issues: **needs rebase**



---

archive/issue_events_078740.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-18T02:44:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78740"
}
```



---

archive/issue_events_078741.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-01-18T02:44:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78741"
}
```



---

archive/issue_comments_045287.json:
```json
{
    "body": "Attachment: **[trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz)**\n\nrebased to 4.3.1.rc0",
    "created_at": "2010-01-19T13:56:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45287",
    "user": "https://github.com/burcin"
}
```

Attachment: **[trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz)**

rebased to 4.3.1.rc0



---

archive/issue_comments_045288.json:
```json
{
    "body": "Changed keywords from none to **pynac**",
    "created_at": "2010-01-19T14:38:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45288",
    "user": "https://github.com/burcin"
}
```

Changed keywords from none to **pynac**



---

archive/issue_comments_045289.json:
```json
{
    "body": "Changed work issues from **needs rebase** to none",
    "created_at": "2010-01-19T14:38:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45289",
    "user": "https://github.com/burcin"
}
```

Changed work issues from **needs rebase** to none



---

archive/issue_comments_045290.json:
```json
{
    "body": "Changed author from **Golam Mortuza Hossain** to **Golam Mortuza Hossain, Burcin Erocal**",
    "created_at": "2010-01-19T14:38:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45290",
    "user": "https://github.com/burcin"
}
```

Changed author from **Golam Mortuza Hossain** to **Golam Mortuza Hossain, Burcin Erocal**



---

archive/issue_comments_045291.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAttachment: **[trac_6559-referee.patch.gz](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.patch.gz)**\n\nI uploaded a revised version of Golam's patch at [attachment: trac_6559-domain-and-latex_name-for-variable.take2.3.patch,](https://github.com/sagemath/sage/files/ticket6559/678c7bbb14cedf8ebc36d8fa3152db0b.gz) and a referee patch at [attachment: trac_6559-referee.patch.](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.patch..gz)\n\nThe changes in the revised patch over Golam's version are\n* rebased to 4.3.rc0\n* removed `sage.symbolic.ring.SR.new_var()` and `sage.symbolic.ring.is_ComplexVariable()` functions. The first is same as `SR.symbol()` and I don't see a use for the second, since all variables are complex. :)\n* removed pickling changes in sage.symbolic.expression.Expression, since unpickling in this case could create a new variable with the same name as an existing one, but with a different domain. This would lead to rather confusing situations.\n\nThe referee patch reorganizes the new code a little to make it more efficient. Apparently the new variable creation is an important operation and being sloppy here greatly increases doctest timings. It also adds new methods like `_is_positive()`, `_is_real()` to the expression class to allow querying for more properties.\n\nOnly the patches \n* [attachment: trac_6559-domain-and-latex_name-for-variable.take2.3.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz) and\n* [attachment: trac_6559-referee.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.patch.gz) \nshould be applied.\n\nThis ticket depends on the new pynac package here:\n\nhttp://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.11.spkg\n\nwhich in turns depends on the patches at #7822, #7876, #7363, #7955, #7957, #7916 and #6465 (in that order).\n\nThe changes here seem to slow down the maxima interface dramatically, so I'm leaving this as needs work for now.",
    "created_at": "2010-01-19T14:38:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45291",
    "user": "https://github.com/burcin"
}
```

<div id="comment:7" align="right">comment:7</div>

Attachment: **[trac_6559-referee.patch.gz](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.patch.gz)**

I uploaded a revised version of Golam's patch at [attachment: trac_6559-domain-and-latex_name-for-variable.take2.3.patch,](https://github.com/sagemath/sage/files/ticket6559/678c7bbb14cedf8ebc36d8fa3152db0b.gz) and a referee patch at [attachment: trac_6559-referee.patch.](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.patch..gz)

The changes in the revised patch over Golam's version are
* rebased to 4.3.rc0
* removed `sage.symbolic.ring.SR.new_var()` and `sage.symbolic.ring.is_ComplexVariable()` functions. The first is same as `SR.symbol()` and I don't see a use for the second, since all variables are complex. :)
* removed pickling changes in sage.symbolic.expression.Expression, since unpickling in this case could create a new variable with the same name as an existing one, but with a different domain. This would lead to rather confusing situations.

The referee patch reorganizes the new code a little to make it more efficient. Apparently the new variable creation is an important operation and being sloppy here greatly increases doctest timings. It also adds new methods like `_is_positive()`, `_is_real()` to the expression class to allow querying for more properties.

Only the patches 
* [attachment: trac_6559-domain-and-latex_name-for-variable.take2.3.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz) and
* [attachment: trac_6559-referee.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.patch.gz) 
should be applied.

This ticket depends on the new pynac package here:

http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.11.spkg

which in turns depends on the patches at #7822, #7876, #7363, #7955, #7957, #7916 and #6465 (in that order).

The changes here seem to slow down the maxima interface dramatically, so I'm leaving this as needs work for now.



---

archive/issue_events_078742.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-01-20T04:11:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78742"
}
```



---

archive/issue_events_078743.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-01-20T04:11:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78743"
}
```



---

archive/issue_comments_045292.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAttachment: **[trac_6559-referee.take2.patch.gz](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.take2.patch.gz)**\n\nNew patches up, ready for review.\n\nApply only:\n* [attachment: trac_6559-domain-and-latex_name-for-variable.take2.3.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz)\n* [attachment: trac_6559-referee.take2.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.take2.patch.gz)\n\nDepends on the pynac package here:\n\nhttp://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.11.spkg\n\nand the tickets #7822, #7876, #7363, #7955, #7957, #7916 and #6465 (in that order).",
    "created_at": "2010-01-20T04:11:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45292",
    "user": "https://github.com/burcin"
}
```

<div id="comment:8" align="right">comment:8</div>

Attachment: **[trac_6559-referee.take2.patch.gz](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.take2.patch.gz)**

New patches up, ready for review.

Apply only:
* [attachment: trac_6559-domain-and-latex_name-for-variable.take2.3.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz)
* [attachment: trac_6559-referee.take2.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.take2.patch.gz)

Depends on the pynac package here:

http://sage.math.washington.edu/home/burcin/pynac/pynac-0.1.11.spkg

and the tickets #7822, #7876, #7363, #7955, #7957, #7916 and #6465 (in that order).



---

archive/issue_comments_045293.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI applied the patches in this order:\n\n```\n$ hg qseries\ntrac_7999-encoding.patch\ntrac_6961-psi.patch\ntrac_7822-py_log.take2.patch\ntrac_7876-pynac_print.take2.patch\ntrac_7363-mul_coeff.patch\ntrac_7955-integrate_latex.patch\ntrac_7957-pynac_exceptions.patch\ntrac_7916-same_name_method.take2.patch\ntrac_6465-chain_rule.take2.patch\ntrac_6465-moves-integration-into-sfunction-subclass.take2.patch\ntrac_6465-integral.patch\ntrac_6559-domain-and-latex_name-for-variable.take2.3.patch\ntrac_6559-referee.take2.patch\n```\n\nThere's only one failure (sage -tp, not long) in arith.py, which is a documentation thing and unrelated to this ticket.",
    "created_at": "2010-01-21T01:44:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45293",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:9" align="right">comment:9</div>

I applied the patches in this order:

```
$ hg qseries
trac_7999-encoding.patch
trac_6961-psi.patch
trac_7822-py_log.take2.patch
trac_7876-pynac_print.take2.patch
trac_7363-mul_coeff.patch
trac_7955-integrate_latex.patch
trac_7957-pynac_exceptions.patch
trac_7916-same_name_method.take2.patch
trac_6465-chain_rule.take2.patch
trac_6465-moves-integration-into-sfunction-subclass.take2.patch
trac_6465-integral.patch
trac_6559-domain-and-latex_name-for-variable.take2.3.patch
trac_6559-referee.take2.patch
```

There's only one failure (sage -tp, not long) in arith.py, which is a documentation thing and unrelated to this ticket.



---

archive/issue_comments_045294.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nIs it likely that the rebase referred to in #6961 might affect other patches than just that one?  Read that before refereeing, in any case.",
    "created_at": "2010-01-27T19:21:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45294",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:10" align="right">comment:10</div>

Is it likely that the rebase referred to in #6961 might affect other patches than just that one?  Read that before refereeing, in any case.



---

archive/issue_comments_045295.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI can't even begin to say where these are from... but \n\n```\nsage/misc/citation.pyx\", line 60:\n    sage: get_systems('integrate(x^2, x)')\nExpected:\n    ['ginac', 'Maxima']\nGot:\n    ['MPFI', 'ginac', 'Maxima']\n```\n\n```\nsage/symbolic/random_tests.py\", line 206:\n    sage: random_expr(5, verbose=True)\nExpected:\n    About to apply <built-in function add> to [v1, v1]\n    About to apply <built-in function div> to [-1/3, 2*v1]\n    -1/6/v1\nGot:\n    About to apply <built-in function add> to [v1, v1]\n    About to apply <built-in function div> to [94, 2*v1]\n    47/v1\n```\nseem to be related to just random changes in 4.3.1, while \n\n```\nsage/functions/generalized.py\", line 239:\n    sage: t.subs(x=1)\nExpected:\n    2\nGot:\n    heaviside(x) + 1\n```\nand a few friends seem to be related to something in pickling changing (I get no other errors with things like that).\n\nIn addition, I am getting quite a few segfaults when testing against 4.3.1. \n\n```\n Desktop/sage-4.3.1/sage -t devel/sage/sage/calculus/calculus.py devel/sage/sage/functions/piecewise.py devel/sage/sage/plot/plot.py devel/sage/sage/symbolic/expression.pyx devel/sage/sage/misc/functional.py devel/sage/sage/symbolic/relation.py devel/sage/sage/symbolic/assumptions.py devel/sage/sage/calculus/wester.py devel/sage/sage/calculus/functional.py \n``` \nall do. Probably I should not have applied all patches at once, but I was impatient :)",
    "created_at": "2010-01-27T20:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45295",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:11" align="right">comment:11</div>

I can't even begin to say where these are from... but 

```
sage/misc/citation.pyx", line 60:
    sage: get_systems('integrate(x^2, x)')
Expected:
    ['ginac', 'Maxima']
Got:
    ['MPFI', 'ginac', 'Maxima']
```

```
sage/symbolic/random_tests.py", line 206:
    sage: random_expr(5, verbose=True)
Expected:
    About to apply <built-in function add> to [v1, v1]
    About to apply <built-in function div> to [-1/3, 2*v1]
    -1/6/v1
Got:
    About to apply <built-in function add> to [v1, v1]
    About to apply <built-in function div> to [94, 2*v1]
    47/v1
```
seem to be related to just random changes in 4.3.1, while 

```
sage/functions/generalized.py", line 239:
    sage: t.subs(x=1)
Expected:
    2
Got:
    heaviside(x) + 1
```
and a few friends seem to be related to something in pickling changing (I get no other errors with things like that).

In addition, I am getting quite a few segfaults when testing against 4.3.1. 

```
 Desktop/sage-4.3.1/sage -t devel/sage/sage/calculus/calculus.py devel/sage/sage/functions/piecewise.py devel/sage/sage/plot/plot.py devel/sage/sage/symbolic/expression.pyx devel/sage/sage/misc/functional.py devel/sage/sage/symbolic/relation.py devel/sage/sage/symbolic/assumptions.py devel/sage/sage/calculus/wester.py devel/sage/sage/calculus/functional.py 
``` 
all do. Probably I should not have applied all patches at once, but I was impatient :)



---

archive/issue_comments_045296.json:
```json
{
    "body": "Reviewer: **Karl-Dieter Crisman**",
    "created_at": "2010-01-28T21:12:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45296",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **Karl-Dieter Crisman**



---

archive/issue_comments_045297.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nUpdate: None of the previous errors happen in this symbolics queue until I hit this ticket, so they are definitely due to this one.\n\nMore comments:  \n\n1. The original patch only causes the sage/functions/generalized.py doctest errors, not the other two.  It did not appear with all patches up through ticket #6465.\n\n2. The original patch does NOT cause massive slowdown or segfaults in doctesting sage/calculus/calculus.py.\n\nSo perhaps the referee patch has changed something weird?",
    "created_at": "2010-01-28T21:12:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45297",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:12" align="right">comment:12</div>

Update: None of the previous errors happen in this symbolics queue until I hit this ticket, so they are definitely due to this one.

More comments:  

1. The original patch only causes the sage/functions/generalized.py doctest errors, not the other two.  It did not appear with all patches up through ticket #6465.

2. The original patch does NOT cause massive slowdown or segfaults in doctesting sage/calculus/calculus.py.

So perhaps the referee patch has changed something weird?



---

archive/issue_comments_045298.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nFollowup:\n\nAdding the referee patch causes a number of segfaults in things relating to assumptions.  For example, the calculus/calculus.py doctest where it is assumed that abs(q)<1, and the one in calculus/wester.py where it is assumed that x>=y, y>=z, z>=x.    It is not consistent whether the assumption itself or the thing using the assumption causes the hang.  Is it possible that the _is_* methods or the info flags in ginac/decl.pxi are responsible?  This is a question out of ignorance; I don't see how they would interfere with Maxima or the use of it by (e.g.) symbolic_sum, but it's all I can think of.\n\nAlso, the citation.pyx and random_tests.py are repeatable.",
    "created_at": "2010-01-29T03:05:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45298",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:13" align="right">comment:13</div>

Followup:

Adding the referee patch causes a number of segfaults in things relating to assumptions.  For example, the calculus/calculus.py doctest where it is assumed that abs(q)<1, and the one in calculus/wester.py where it is assumed that x>=y, y>=z, z>=x.    It is not consistent whether the assumption itself or the thing using the assumption causes the hang.  Is it possible that the _is_* methods or the info flags in ginac/decl.pxi are responsible?  This is a question out of ignorance; I don't see how they would interfere with Maxima or the use of it by (e.g.) symbolic_sum, but it's all I can think of.

Also, the citation.pyx and random_tests.py are repeatable.



---

archive/issue_events_078744.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-01-29T03:05:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78744"
}
```



---

archive/issue_events_078745.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-01-29T03:05:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78745"
}
```



---

archive/issue_comments_045299.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI can't reproduce these problems on my 64-bit laptop with Sage 4.3.2.alpha0, gcc 4.3.4. I'll try on a 32-bit machine tomorrow.\n\nNote that the rebased patch on #6961 applies without problems to a clean 4.3.2.alpha0 here. Though my patch queue contains `trac_7822-py_log.take2.patch` before `trac_6961-psi.rebased.patch`. I tested the rest of the queue when I rebased the patch for #6961, there weren't any problems.\n\nIs it possible that the problems you report might be caused by the fact that your tree got messed up by the git style patches attached to #6465?",
    "created_at": "2010-01-31T21:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45299",
    "user": "https://github.com/burcin"
}
```

<div id="comment:14" align="right">comment:14</div>

I can't reproduce these problems on my 64-bit laptop with Sage 4.3.2.alpha0, gcc 4.3.4. I'll try on a 32-bit machine tomorrow.

Note that the rebased patch on #6961 applies without problems to a clean 4.3.2.alpha0 here. Though my patch queue contains `trac_7822-py_log.take2.patch` before `trac_6961-psi.rebased.patch`. I tested the rest of the queue when I rebased the patch for #6961, there weren't any problems.

Is it possible that the problems you report might be caused by the fact that your tree got messed up by the git style patches attached to #6465?



---

archive/issue_comments_045300.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI cannot reproduce these problems on a 32-bit Debian Lenny box after applying all the symbolics patches and updating pynac to version 0.11.",
    "created_at": "2010-02-03T11:59:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45300",
    "user": "https://github.com/burcin"
}
```

<div id="comment:15" align="right">comment:15</div>

I cannot reproduce these problems on a 32-bit Debian Lenny box after applying all the symbolics patches and updating pynac to version 0.11.



---

archive/issue_comments_045301.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n> Is it possible that the problems you report might be caused by the fact that your tree got messed up by the git style patches attached to #6465?\n\nPossibly, but wouldn't that have made everything not work, as opposed to just a few weird segfaults related to assumptions and a couple other things? \n\nAlso, when I say I applied them all at once, what I mean is I applied them one after the other using hg_sage.import_patch, which I believe is equivalent to hg import.",
    "created_at": "2010-02-04T03:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45301",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:16" align="right">comment:16</div>

> Is it possible that the problems you report might be caused by the fact that your tree got messed up by the git style patches attached to #6465?

Possibly, but wouldn't that have made everything not work, as opposed to just a few weird segfaults related to assumptions and a couple other things? 

Also, when I say I applied them all at once, what I mean is I applied them one after the other using hg_sage.import_patch, which I believe is equivalent to hg import.



---

archive/issue_comments_045302.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI tried once more with the patches downloaded from trac. I cannot reproduce any problems.\n\nHere is an easier way to test all the patches:\n\n* Make a fresh clone, called \"pynac\"\n* go to the source tree for the clone\n\n```\ncd $SAGE_ROOT/devel/sage-pynac\n```\n* download this tar file\n\n```\nwget http://boxen.math.washington.edu/home/burcin/pynac/pynac_patches.tar.bz2\n```\n* extract it to the queue repository\n\n```\ncd .hg\ntar jxvf ../pynac_patches.tar.bz2\ncd ..\n```\n* apply all the patches\n\n```\nhg qpush -a\n```\n\n* if the new pynac package is not already installed download and install it\n\n```\nhttp://boxen.math.washington.edu/home/burcin/pynac/pynac-0.1.11.spkg\n```\n\n* rebuild Sage\n\n```\n./sage -br\n```\n\n* run tests\n\n```\n./sage -tp 3 devel/sage-pynac/sage/{symbolic,calculus,functions}\n```",
    "created_at": "2010-02-04T09:25:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45302",
    "user": "https://github.com/burcin"
}
```

<div id="comment:17" align="right">comment:17</div>

I tried once more with the patches downloaded from trac. I cannot reproduce any problems.

Here is an easier way to test all the patches:

* Make a fresh clone, called "pynac"
* go to the source tree for the clone

```
cd $SAGE_ROOT/devel/sage-pynac
```
* download this tar file

```
wget http://boxen.math.washington.edu/home/burcin/pynac/pynac_patches.tar.bz2
```
* extract it to the queue repository

```
cd .hg
tar jxvf ../pynac_patches.tar.bz2
cd ..
```
* apply all the patches

```
hg qpush -a
```

* if the new pynac package is not already installed download and install it

```
http://boxen.math.washington.edu/home/burcin/pynac/pynac-0.1.11.spkg
```

* rebuild Sage

```
./sage -br
```

* run tests

```
./sage -tp 3 devel/sage-pynac/sage/{symbolic,calculus,functions}
```



---

archive/issue_events_078746.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-02-04T09:25:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78746"
}
```



---

archive/issue_events_078747.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-02-04T09:25:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78747"
}
```



---

archive/issue_comments_045303.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Ross Kyprianou**",
    "created_at": "2010-02-13T05:34:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45303",
    "user": "https://github.com/sagetrac-rossk"
}
```

Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Ross Kyprianou**



---

archive/issue_comments_045304.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\n\n```\napplying trac_7822-py_log.take2.patch\napplying trac_6961-psi.rebased.patch\napplying trac_7876-pynac_print.take2.patch\napplying trac_7363-mul_coeff.patch\napplying trac_7955-integrate_latex.patch\napplying trac_7957-pynac_exceptions.patch\napplying trac_7916-same_name_method.take2.patch\napplying trac_6465-chain_rule.take2.patch\napplying trac_6465-moves-integration-into-sfunction-subclass.take2.patch\npatching file sage/misc/functional.py\nHunk #1 FAILED at 662\n1 out of 2 hunks FAILED -- saving rejects to file sage/misc/functional.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_6465-moves-integration-into-sfunction-subclass.take2.patch\n```",
    "created_at": "2010-02-13T05:34:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45304",
    "user": "https://github.com/sagetrac-rossk"
}
```

<div id="comment:18" align="right">comment:18</div>


```
applying trac_7822-py_log.take2.patch
applying trac_6961-psi.rebased.patch
applying trac_7876-pynac_print.take2.patch
applying trac_7363-mul_coeff.patch
applying trac_7955-integrate_latex.patch
applying trac_7957-pynac_exceptions.patch
applying trac_7916-same_name_method.take2.patch
applying trac_6465-chain_rule.take2.patch
applying trac_6465-moves-integration-into-sfunction-subclass.take2.patch
patching file sage/misc/functional.py
Hunk #1 FAILED at 662
1 out of 2 hunks FAILED -- saving rejects to file sage/misc/functional.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_6465-moves-integration-into-sfunction-subclass.take2.patch
```



---

archive/issue_comments_045305.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nSee [#6465 comment:19](https://github.com/sagemath/sage/issues/6465#comment:19). Two patches on that ticket needed to be rebased to 4.3.2. Unfortunately, I didn't have time to update the patch tarball.\n\nYou can use `hg qdelete <patch_name>` to remove the offending patches from the queue, and `hg qimport` new ones. The specific list of command to be executed is:\n\n```\ncd $SAGE_ROOT/devel/sage-pynac\nhg qpop -a\nhg qdelete trac_6465-moves-integration-into-sfunction-subclass.take2.patch\nhg qdelete trac_6465-integral.take3.patch\nhg qgoto trac_6465-chain_rule.take2.patch\nhg qimport https://github.com/sagemath/sage/files/ticket6465/trac_6465-integral.take4.patch.gz\nhg qimport https://github.com/sagemath/sage/files/ticket6465/trac_6465-moves-integration-into-sfunction-subclass.take3.patch.gz\nhg qpush -a\n```\n\nThen rebuild sage, and proceed with the tests...\n\nMany thanks for looking at this.",
    "created_at": "2010-02-13T10:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45305",
    "user": "https://github.com/burcin"
}
```

<div id="comment:19" align="right">comment:19</div>

See [#6465 comment:19](https://github.com/sagemath/sage/issues/6465#comment:19). Two patches on that ticket needed to be rebased to 4.3.2. Unfortunately, I didn't have time to update the patch tarball.

You can use `hg qdelete <patch_name>` to remove the offending patches from the queue, and `hg qimport` new ones. The specific list of command to be executed is:

```
cd $SAGE_ROOT/devel/sage-pynac
hg qpop -a
hg qdelete trac_6465-moves-integration-into-sfunction-subclass.take2.patch
hg qdelete trac_6465-integral.take3.patch
hg qgoto trac_6465-chain_rule.take2.patch
hg qimport https://github.com/sagemath/sage/files/ticket6465/trac_6465-integral.take4.patch.gz
hg qimport https://github.com/sagemath/sage/files/ticket6465/trac_6465-moves-integration-into-sfunction-subclass.take3.patch.gz
hg qpush -a
```

Then rebuild sage, and proceed with the tests...

Many thanks for looking at this.



---

archive/issue_comments_045306.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThe hg qgoto didnt work. (And if its easier at any stage to blow away the pynac clone and start again, feel free to suggest that). \n\n```\nrossk@sage:/scratch/rossk/sage-4.3.3.alpha0-sage.math.washington.edu-x86_64-Linux/devel/sage-pynac$ hg qgoto trac_6465-chain_rule.take2.patch\napplying trac_7822-py_log.take2.patch\napplying trac_6961-psi.rebased.patch\napplying trac_7876-pynac_print.take2.patch\napplying trac_7363-mul_coeff.patch\napplying trac_7955-integrate_latex.patch\npatching file sage/calculus/calculus.py\nHunk #1 FAILED at 1710\nHunk #2 FAILED at 1719\nHunk #3 FAILED at 1742\nHunk #4 FAILED at 1771\nHunk #5 FAILED at 1781\nHunk #6 FAILED at 1790\n6 out of 6 hunks FAILED -- saving rejects to file sage/calculus/calculus.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_7955-integrate_latex.patch\n```",
    "created_at": "2010-02-13T12:13:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45306",
    "user": "https://github.com/sagetrac-rossk"
}
```

<div id="comment:20" align="right">comment:20</div>

The hg qgoto didnt work. (And if its easier at any stage to blow away the pynac clone and start again, feel free to suggest that). 

```
rossk@sage:/scratch/rossk/sage-4.3.3.alpha0-sage.math.washington.edu-x86_64-Linux/devel/sage-pynac$ hg qgoto trac_6465-chain_rule.take2.patch
applying trac_7822-py_log.take2.patch
applying trac_6961-psi.rebased.patch
applying trac_7876-pynac_print.take2.patch
applying trac_7363-mul_coeff.patch
applying trac_7955-integrate_latex.patch
patching file sage/calculus/calculus.py
Hunk #1 FAILED at 1710
Hunk #2 FAILED at 1719
Hunk #3 FAILED at 1742
Hunk #4 FAILED at 1771
Hunk #5 FAILED at 1781
Hunk #6 FAILED at 1790
6 out of 6 hunks FAILED -- saving rejects to file sage/calculus/calculus.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_7955-integrate_latex.patch
```



---

archive/issue_comments_045307.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nHi Ross,\n\nThe last output you posted doesn't make sense to me. Did you update to 4.3.3.alpha0 since [comment:18](#comment%3A18)? In [comment:18](#comment%3A18), the output shows that `trac_7955-integrate_latex.patch` applies cleanly. I don't see any other reason why it would fail now.\n\nI don't have a working copy of 4.3.3.alpha0 yet. Unfortunately, it will take me a couple of days update to that.",
    "created_at": "2010-02-13T13:26:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45307",
    "user": "https://github.com/burcin"
}
```

<div id="comment:21" align="right">comment:21</div>

Hi Ross,

The last output you posted doesn't make sense to me. Did you update to 4.3.3.alpha0 since [comment:18](#comment%3A18)? In [comment:18](#comment%3A18), the output shows that `trac_7955-integrate_latex.patch` applies cleanly. I don't see any other reason why it would fail now.

I don't have a working copy of 4.3.3.alpha0 yet. Unfortunately, it will take me a couple of days update to that.



---

archive/issue_comments_045308.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nYoure right - made a minor mistake so I had to start again and I could only find a version of 4.3.3.alpha0 easily and I used that (apologies). To get some testing done sooner than later Ill go back to 4.3.3 for now. Thanks.",
    "created_at": "2010-02-13T13:44:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45308",
    "user": "https://github.com/sagetrac-rossk"
}
```

<div id="comment:22" align="right">comment:22</div>

Youre right - made a minor mistake so I had to start again and I could only find a version of 4.3.3.alpha0 easily and I used that (apologies). To get some testing done sooner than later Ill go back to 4.3.3 for now. Thanks.



---

archive/issue_comments_045309.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n:) Ticket #7955 was merged in 4.3.3.alpha0, so it's natural that the patch fails. If you just do\n\n```\nhg qdelete trac_7955-integrate_latex.patch\n```\n\nthe rest of the patches should apply without problems.\n\nThanks again for your time.",
    "created_at": "2010-02-15T00:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45309",
    "user": "https://github.com/burcin"
}
```

<div id="comment:23" align="right">comment:23</div>

:) Ticket #7955 was merged in 4.3.3.alpha0, so it's natural that the patch fails. If you just do

```
hg qdelete trac_7955-integrate_latex.patch
```

the rest of the patches should apply without problems.

Thanks again for your time.



---

archive/issue_comments_045310.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nLooks good to me. See #6961 for the order in which to merge patches.",
    "created_at": "2010-02-18T21:31:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45310",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:24" align="right">comment:24</div>

Looks good to me. See #6961 for the order in which to merge patches.



---

archive/issue_comments_045311.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman, Ross Kyprianou** to **Karl-Dieter Crisman, Ross Kyprianou, Minh Van Nguyen**",
    "created_at": "2010-02-18T21:31:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45311",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Changed reviewer from **Karl-Dieter Crisman, Ross Kyprianou** to **Karl-Dieter Crisman, Ross Kyprianou, Minh Van Nguyen**



---

archive/issue_events_078748.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-02-18T21:31:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78748"
}
```



---

archive/issue_events_078749.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-02-18T21:31:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78749"
}
```



---

archive/issue_comments_045312.json:
```json
{
    "body": "Merged: **sage-4.3.3.alpha1**",
    "created_at": "2010-02-18T21:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45312",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Merged: **sage-4.3.3.alpha1**



---

archive/issue_events_078750.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-02-18T21:53:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78750"
}
```



---

archive/issue_events_078751.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-02-18T21:53:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6559#event-78751"
}
```



---

archive/issue_comments_045313.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nMerged in this order:\n\n1. [trac_6559-domain-and-latex_name-for-variable.take2.3.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz)\n2. [trac_6559-referee.take2.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.take2.patch.gz)",
    "created_at": "2010-02-18T21:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6559",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6559#issuecomment-45313",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:25" align="right">comment:25</div>

Merged in this order:

1. [trac_6559-domain-and-latex_name-for-variable.take2.3.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-domain-and-latex_name-for-variable.take2.3.patch.gz)
2. [trac_6559-referee.take2.patch](https://github.com/sagemath/sage/files/ticket6559/trac_6559-referee.take2.patch.gz)
