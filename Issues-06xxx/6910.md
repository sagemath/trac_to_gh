# Issue 6910: Singular should not build its version of NTL

archive/issues_006910.json:
```json
{
    "assignees": [],
    "body": "in singular-3-1-0-2-20090620.p0/spkg-install, it should say:\n\n                --disable-NTL \\\n\ninstead of:\n\n                --with-NTL \\\n\notherwise, things can get messed as libsingular.so will have the\nsame NTL symbols as libtnl.so. What can be very problematic, if\nsomething also links with the libntl.a generated by the singular\npackage.\n\nThis appears to be the root of some of the problems in my\nsagemath rpm packages, where some doctests would fail due to\nlibc aborting, and to make things worse, if running the doctest\nonly in the offending file, it would not crash, *or* if LD_PRELOAD'ing libntl.so.\n\n\n\nAssignee: **@sagetrac-mabshoff**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6910_\n\n",
    "closed_at": "2014-03-19T04:43:03Z",
    "created_at": "2009-09-09T23:49:04Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Singular should not build its version of NTL",
    "type": "issue",
    "updated_at": "2014-03-19T04:43:03Z",
    "url": "https://github.com/sagemath/sage/issues/6910",
    "user": "https://github.com/sagetrac-pcpa"
}
```
in singular-3-1-0-2-20090620.p0/spkg-install, it should say:

                --disable-NTL \

instead of:

                --with-NTL \

otherwise, things can get messed as libsingular.so will have the
same NTL symbols as libtnl.so. What can be very problematic, if
something also links with the libntl.a generated by the singular
package.

This appears to be the root of some of the problems in my
sagemath rpm packages, where some doctests would fail due to
libc aborting, and to make things worse, if running the doctest
only in the offending file, it would not crash, *or* if LD_PRELOAD'ing libntl.so.



Assignee: **@sagetrac-mabshoff**

_Issue created by migration from https://trac.sagemath.org/ticket/6910_





---

archive/issue_events_075883.json:
```json
{
    "actor": "https://github.com/sagetrac-pcpa",
    "created_at": "2009-09-09T23:49:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75883"
}
```



---

archive/issue_events_075884.json:
```json
{
    "actor": "https://github.com/sagetrac-pcpa",
    "created_at": "2009-09-09T23:49:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75884"
}
```



---

archive/issue_events_075885.json:
```json
{
    "actor": "https://github.com/sagetrac-pcpa",
    "created_at": "2009-09-09T23:49:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75885"
}
```



---

archive/issue_comments_050780.json:
```json
{
    "body": "Replying to [ticket:6910 pcpa]:\n> in singular-3-1-0-2-20090620.p0/spkg-install, it should say:\n> \n>                 --disable-NTL \\\n> \n> instead of:\n> \n>                 --with-NTL \\\n> \n> otherwise, things can get messed as libsingular.so will have the\n> same NTL symbols as libtnl.so. What can be very problematic, if\n> something also links with the libntl.a generated by the singular\n> package.\n> \n> This appears to be the root of some of the problems in my\n> sagemath rpm packages, where some doctests would fail due to\n> libc aborting, and to make things worse, if running the doctest\n> only in the offending file, it would not crash, *or* if LD_PRELOAD'ing libntl.so.\n\nThis bug is not really relevant, because singular-3-1-0-2-20090620.p0.spkg removes the ntl directory (as noticed in spkg-changes). I reported the problem after checking symbols in libsingular.so of a sage 4.1 install. But, by using the suggested patch, it is not required to remove the ntl directory.",
    "created_at": "2009-09-10T19:22:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6910#issuecomment-50780",
    "user": "https://github.com/sagetrac-pcpa"
}
```

Replying to [ticket:6910 pcpa]:
> in singular-3-1-0-2-20090620.p0/spkg-install, it should say:
> 
>                 --disable-NTL \
> 
> instead of:
> 
>                 --with-NTL \
> 
> otherwise, things can get messed as libsingular.so will have the
> same NTL symbols as libtnl.so. What can be very problematic, if
> something also links with the libntl.a generated by the singular
> package.
> 
> This appears to be the root of some of the problems in my
> sagemath rpm packages, where some doctests would fail due to
> libc aborting, and to make things worse, if running the doctest
> only in the offending file, it would not crash, *or* if LD_PRELOAD'ing libntl.so.

This bug is not really relevant, because singular-3-1-0-2-20090620.p0.spkg removes the ntl directory (as noticed in spkg-changes). I reported the problem after checking symbols in libsingular.so of a sage 4.1 install. But, by using the suggested patch, it is not required to remove the ntl directory.



---

archive/issue_events_075886.json:
```json
{
    "actor": "https://github.com/sagetrac-pcpa",
    "created_at": "2009-09-10T19:22:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75886"
}
```



---

archive/issue_events_075887.json:
```json
{
    "actor": "https://github.com/sagetrac-pcpa",
    "created_at": "2009-09-10T19:22:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75887"
}
```



---

archive/issue_events_075888.json:
```json
{
    "actor": "https://github.com/sagetrac-pcpa",
    "created_at": "2009-09-10T19:22:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75888"
}
```



---

archive/issue_events_075889.json:
```json
{
    "actor": "https://github.com/sagetrac-pcpa",
    "created_at": "2009-09-10T19:22:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/p5%20%E2%80%93%20trivial",
    "label_color": "fff9e5",
    "label_name": "p5 \u2013 trivial",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75889"
}
```



---

archive/issue_comments_050781.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI just tracked and corrected most, if not all, crashes in the new\nMandriva sagemath-4.7 rpm package by rebuilding singular but before\nthat, rm -rf'ing the ntl subdirectory.\n\nInterestingly I had noticed the issue long long ago, and forgot\nabout it, but the problem is that if not removing the ntl\nsubdirectory, it will still build the local ntl and/or link\nstatically to it, even when told to use the system ntl, with\nsomething like --with-ntl=/usr\n\nI had this issue because I did use pristine upstream tarball\nfor the singular package, and not make it based on the sage\nspkg tarball.",
    "created_at": "2011-06-01T11:03:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6910#issuecomment-50781",
    "user": "https://github.com/sagetrac-pcpa"
}
```

<div id="comment:2" align="right">Comment 2</div>

I just tracked and corrected most, if not all, crashes in the new
Mandriva sagemath-4.7 rpm package by rebuilding singular but before
that, rm -rf'ing the ntl subdirectory.

Interestingly I had noticed the issue long long ago, and forgot
about it, but the problem is that if not removing the ntl
subdirectory, it will still build the local ntl and/or link
statically to it, even when told to use the system ntl, with
something like --with-ntl=/usr

I had this issue because I did use pristine upstream tarball
for the singular package, and not make it based on the sage
spkg tarball.



---

archive/issue_events_075890.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-06T18:29:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75890"
}
```



---

archive/issue_comments_050782.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nSo if this is not (or no longer) a Sage issue, can we close this ticket?\n\nOr did I miss something?",
    "created_at": "2011-08-06T18:29:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6910#issuecomment-50782",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:3" align="right">Comment 3</div>

So if this is not (or no longer) a Sage issue, can we close this ticket?

Or did I miss something?



---

archive/issue_events_075891.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2014-03-15T17:11:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75891"
}
```



---

archive/issue_events_075892.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2014-03-15T17:11:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75892"
}
```



---

archive/issue_events_075893.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2014-03-15T17:11:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/p5%20%E2%80%93%20trivial",
    "label_color": "fff9e5",
    "label_name": "p5 \u2013 trivial",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75893"
}
```



---

archive/issue_events_075894.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2014-03-15T17:11:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75894"
}
```



---

archive/issue_events_075895.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-03-19T04:43:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75895"
}
```



---

archive/issue_events_075896.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-03-19T04:43:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6910",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6910#event-75896"
}
```
