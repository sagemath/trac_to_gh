# Issue 6185: Add SBox -> CNF Conversion

archive/issues_006185.json:
```json
{
    "assignees": [
        "https://github.com/malb"
    ],
    "body": "While not really complicated it is nice to have a direct conversion from S-Boxes to CNF since SAT-solves enjoy some attention right now in crypto.\n\nCC:  @sagetrac-mvngu @sagetrac-rpw @burcin\n\nKeywords: **cnf**\n\nComponent: **cryptography**\n\nAuthor: **Martin Albrecht**\n\nReviewer: **Yann Laigle-Chapuy**\n\nMerged: **4.0.2.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/6185_\n\n",
    "closed_at": "2009-06-13T20:43:33Z",
    "created_at": "2009-06-02T13:56:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20cryptography",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/c%3A%20cryptography"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.0.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add SBox -> CNF Conversion",
    "type": "issue",
    "updated_at": "2009-06-13T20:43:33Z",
    "url": "https://github.com/sagemath/sage/issues/6185",
    "user": "https://github.com/malb"
}
```
While not really complicated it is nice to have a direct conversion from S-Boxes to CNF since SAT-solves enjoy some attention right now in crypto.

CC:  @sagetrac-mvngu @sagetrac-rpw @burcin

Keywords: **cnf**

Component: **cryptography**

Author: **Martin Albrecht**

Reviewer: **Yann Laigle-Chapuy**

Merged: **4.0.2.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/6185_





---

archive/issue_events_073681.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-06-02T13:56:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "milestone_number": null,
    "milestone_title": "sage-4.0.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73681"
}
```



---

archive/issue_events_073682.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-06-02T13:56:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20cryptography",
    "label_color": "0000ff",
    "label_name": "c: cryptography",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73682"
}
```



---

archive/issue_events_073683.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-06-02T13:56:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73683"
}
```



---

archive/issue_events_073684.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-06-02T13:56:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73684"
}
```



---

archive/issue_events_073685.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-06-02T13:56:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20cryptography",
    "label_color": "0000ff",
    "label_name": "c: cryptography",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73685"
}
```



---

archive/issue_events_073686.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-06-02T13:56:38Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "subject": "https://github.com/malb",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73686"
}
```



---

archive/issue_events_073687.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2009-06-02T13:56:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73687"
}
```



---

archive/issue_comments_040892.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nMinh, can I ask you to review this ticket?",
    "created_at": "2009-06-02T13:57:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40892",
    "user": "https://github.com/malb"
}
```

<div id="comment:1" align="right">comment:1</div>

Minh, can I ask you to review this ticket?



---

archive/issue_comments_040893.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nReplying to [@malb](#comment:1):\n> Minh, can I ask you to review this ticket?\n\nHi Martin. Sorry for my simple question: Is there a reference or paper that describes the algorithm you use for converting an S-box to CNF? I only know about the application of SAT to cryptanalysis by reading this ticket. I usually find it much easier to understand code if I can access a reference somewhere that describes the algorithm.",
    "created_at": "2009-06-03T19:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40893",
    "user": "https://github.com/sagetrac-mvngu"
}
```

<div id="comment:2" align="right">comment:2</div>

Replying to [@malb](#comment:1):
> Minh, can I ask you to review this ticket?

Hi Martin. Sorry for my simple question: Is there a reference or paper that describes the algorithm you use for converting an S-box to CNF? I only know about the application of SAT to cryptanalysis by reading this ticket. I usually find it much easier to understand code if I can access a reference somewhere that describes the algorithm.



---

archive/issue_comments_040894.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHi Minh,\n\nthe standard reference for SAT-solvers in block cipher cryptanalysis is:\n\n   http://eprint.iacr.org/2007/024\n\nI've implemented a converter along those lines at\n\n   http://bitbucket.org/malb/algebraic_attacks/src/tip/anf2cnf.py\n\nwhich isn't ready for inclusion yet. This ticket follows a different approach and converts the S-Box directly. The algorithm used is the standard algorithm for computing CNF from a truth table, \n\ncf. `sage.sage.logic.boolformula`",
    "created_at": "2009-06-03T22:17:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40894",
    "user": "https://github.com/malb"
}
```

<div id="comment:3" align="right">comment:3</div>

Hi Minh,

the standard reference for SAT-solvers in block cipher cryptanalysis is:

   http://eprint.iacr.org/2007/024

I've implemented a converter along those lines at

   http://bitbucket.org/malb/algebraic_attacks/src/tip/anf2cnf.py

which isn't ready for inclusion yet. This ticket follows a different approach and converts the S-Box directly. The algorithm used is the standard algorithm for computing CNF from a truth table, 

cf. `sage.sage.logic.boolformula`



---

archive/issue_comments_040895.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHi Burcin, Ralf,\n\ncan I ask for this (hopefully) easy review?",
    "created_at": "2009-06-08T10:53:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40895",
    "user": "https://github.com/malb"
}
```

<div id="comment:4" align="right">comment:4</div>

Hi Burcin, Ralf,

can I ask for this (hopefully) easy review?



---

archive/issue_comments_040896.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nMy 2 cents:\n\n* the complexity is 'n * 2**m' (instead of 'm * 2**n'):\n\n```\n  for x in X:                        <-- 2^m\n      for output_bit in output_bits: <-- n\n```\n* typos:\n   * line 866: evaluate instead of evaulate\n   * line 840: endianness instead of endianess\n\n* maybe add an exception if xi or yi has wrong size\n\n* maybe (but as you like) construct x's on the fly:\n\n```\n  for e in xrange(2**m):\n      x = self.to_bits(e)\n```\notherwise seems good to me.",
    "created_at": "2009-06-11T07:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40896",
    "user": "https://github.com/sagetrac-ylchapuy"
}
```

<div id="comment:5" align="right">comment:5</div>

My 2 cents:

* the complexity is 'n * 2**m' (instead of 'm * 2**n'):

```
  for x in X:                        <-- 2^m
      for output_bit in output_bits: <-- n
```
* typos:
   * line 866: evaluate instead of evaulate
   * line 840: endianness instead of endianess

* maybe add an exception if xi or yi has wrong size

* maybe (but as you like) construct x's on the fly:

```
  for e in xrange(2**m):
      x = self.to_bits(e)
```
otherwise seems good to me.



---

archive/issue_comments_040897.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nAttachment: **[sbox_cnf.patch.gz](https://github.com/sagemath/sage/files/ticket6185/sbox_cnf.patch.gz)**\n\nThe attached updated patch addresses the reviewer's comments. Is that a positive review then?",
    "created_at": "2009-06-11T11:36:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40897",
    "user": "https://github.com/malb"
}
```

<div id="comment:6" align="right">comment:6</div>

Attachment: **[sbox_cnf.patch.gz](https://github.com/sagemath/sage/files/ticket6185/sbox_cnf.patch.gz)**

The attached updated patch addresses the reviewer's comments. Is that a positive review then?



---

archive/issue_events_073688.json:
```json
{
    "actor": "https://github.com/sagetrac-ylchapuy",
    "created_at": "2009-06-11T13:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73688"
}
```



---

archive/issue_comments_040898.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYes it is. Positive review.",
    "created_at": "2009-06-11T13:43:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40898",
    "user": "https://github.com/sagetrac-ylchapuy"
}
```

<div id="comment:7" align="right">comment:7</div>

Yes it is. Positive review.



---

archive/issue_comments_040899.json:
```json
{
    "body": "Reviewer: **Yann Laigle-Chapuy**",
    "created_at": "2009-06-11T13:46:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40899",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Reviewer: **Yann Laigle-Chapuy**



---

archive/issue_comments_040900.json:
```json
{
    "body": "Author: **Martin Albrecht**",
    "created_at": "2009-06-11T13:46:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40900",
    "user": "https://github.com/sagetrac-mvngu"
}
```

Author: **Martin Albrecht**



---

archive/issue_events_073689.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2009-06-13T20:43:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73689"
}
```



---

archive/issue_events_073690.json:
```json
{
    "actor": "https://github.com/ncalexan",
    "created_at": "2009-06-13T20:43:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/6185#event-73690"
}
```



---

archive/issue_comments_040901.json:
```json
{
    "body": "Merged: **4.0.2.alpha0**",
    "created_at": "2009-06-13T20:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/6185",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/6185#issuecomment-40901",
    "user": "https://github.com/ncalexan"
}
```

Merged: **4.0.2.alpha0**
