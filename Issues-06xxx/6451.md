# Issue 6451: Flint uses a non-portable option to 'cp' which fails on Solaris.

archive/issues_006451.json:
```json
{
    "body": "I noticed a problem when building 'sage-4.1.alpha2.spkg'. It complains\n\n```\nld: fatal: library -lflint: not found\n```\n\nBut the flint package indicates it was installed. However, when I tried to build flint again, I see this error message:\n\n```\nDeleting old FLINT\nInstalling new library file\ncp: illegal option -- a\nUsage: cp [-f] [-i] [-p] [-@] f1 f2\n        cp [-f] [-i] [-p] [-@] f1 ... fn d1\n        cp -r|-R [-H|-L|-P] [-f] [-i] [-p] [-@] d1 ... dn-1 dn\n```\n\nIt's clear flint is making use of some GNU-specific option to 'cp' The fact the copy fails means of course the library does not get installed.\n\nI'll post a fix later - it should be trivial \n\n\nAssignee: drkirkby\n\nKeywords: solaris GNUism\n\nResolution: fixed\n\nAuthor: David Kirkby\n\nReviewer: Bill Hart, John Cremona\n\nMerged: sage-4.1.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/6451\n\n",
    "closed_at": "2009-07-16T21:12:50Z",
    "created_at": "2009-06-30T16:16:14Z",
    "labels": [
        "component: porting: solaris",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1.1",
    "title": "Flint uses a non-portable option to 'cp' which fails on Solaris.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6451",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```
I noticed a problem when building 'sage-4.1.alpha2.spkg'. It complains

```
ld: fatal: library -lflint: not found
```

But the flint package indicates it was installed. However, when I tried to build flint again, I see this error message:

```
Deleting old FLINT
Installing new library file
cp: illegal option -- a
Usage: cp [-f] [-i] [-p] [-@] f1 f2
        cp [-f] [-i] [-p] [-@] f1 ... fn d1
        cp -r|-R [-H|-L|-P] [-f] [-i] [-p] [-@] d1 ... dn-1 dn
```

It's clear flint is making use of some GNU-specific option to 'cp' The fact the copy fails means of course the library does not get installed.

I'll post a fix later - it should be trivial 


Assignee: drkirkby

Keywords: solaris GNUism

Resolution: fixed

Author: David Kirkby

Reviewer: Bill Hart, John Cremona

Merged: sage-4.1.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/6451





---

archive/issue_comments_064092.json:
```json
{
    "body": "<a id='comment:1'></a>\nOne of the easier patches - it just needed one byte changed. In spkg-install:\n\n\n\n```\n  $CP -a libflint* \"$SAGE_LOCAL/lib/\"\n```\n\nwas changed to\n\n```\n  $CP -p libflint* \"$SAGE_LOCAL/lib/\"\n```\n\n\nSee http://sage.math.washington.edu/home/kirkby/Solaris-fixes/flint/",
    "created_at": "2009-06-30T17:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64092",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:1'></a>
One of the easier patches - it just needed one byte changed. In spkg-install:



```
  $CP -a libflint* "$SAGE_LOCAL/lib/"
```

was changed to

```
  $CP -p libflint* "$SAGE_LOCAL/lib/"
```


See http://sage.math.washington.edu/home/kirkby/Solaris-fixes/flint/



---

archive/issue_comments_064093.json:
```json
{
    "body": "Changing assignee from tbd to drkirkby.",
    "created_at": "2009-06-30T17:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64093",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing assignee from tbd to drkirkby.



---

archive/issue_comments_064094.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2009-06-30T17:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64094",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_064095.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2009-06-30T17:04:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64095",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from new to assigned.



---

archive/issue_comments_064096.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe patch posted here:\n\nhttp://sage.math.washington.edu/home/kirkby/Solaris-fixes/flint/spkg-install.patch\n\nchanges the -a option to cp to -p. I have checked that -a is exactly equivalent to -dpR. Here R is not relevant as only one file is copied and R is for recursive. The -d is not relevant as it is for symbolic links and is again not relevant for copying a single actual file.\n\nThe -p option is indeed available on Solaris and T2, so the patch is good. The patch is clearly conservative.\n\nNote this is not an issue with FLINT itself, but with the FLINT spkg installer.",
    "created_at": "2009-07-06T21:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64096",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

<a id='comment:2'></a>
The patch posted here:

http://sage.math.washington.edu/home/kirkby/Solaris-fixes/flint/spkg-install.patch

changes the -a option to cp to -p. I have checked that -a is exactly equivalent to -dpR. Here R is not relevant as only one file is copied and R is for recursive. The -d is not relevant as it is for symbolic links and is again not relevant for copying a single actual file.

The -p option is indeed available on Solaris and T2, so the patch is good. The patch is clearly conservative.

Note this is not an issue with FLINT itself, but with the FLINT spkg installer.



---

archive/issue_events_019533.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "rename": {
        "from": "Fint uses a non-portable option to 'cp' which fails on Solaris.",
        "to": "[with positive review] Fint uses a non-portable option to 'cp' which fails on Solaris."
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6451#event-19533"
}
```



---

archive/issue_events_019534.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "rename": {
        "from": "[with positive review] Fint uses a non-portable option to 'cp' which fails on Solaris.",
        "to": "[with positive review] Flint uses a non-portable option to 'cp' which fails on Solaris."
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6451#event-19534"
}
```



---

archive/issue_comments_064097.json:
```json
{
    "body": "Author: David Kirkby",
    "created_at": "2009-07-16T18:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64097",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Author: David Kirkby



---

archive/issue_comments_064098.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe spkg posted by David Kirkby didn't check in all changes. I've checked in the changes in David's name. The updated spkg is up at\n\nhttp://sage.math.washington.edu/home/mvngu/patch/flint-1.3.0.p2.spkg\n\nJust to let people know, the updated spkg has been merged in sage-4.1.1-alpha0. I can't close this ticket because I don't have the privilege to do so. Sorry, folks :-(",
    "created_at": "2009-07-16T18:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64098",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:4'></a>
The spkg posted by David Kirkby didn't check in all changes. I've checked in the changes in David's name. The updated spkg is up at

http://sage.math.washington.edu/home/mvngu/patch/flint-1.3.0.p2.spkg

Just to let people know, the updated spkg has been merged in sage-4.1.1-alpha0. I can't close this ticket because I don't have the privilege to do so. Sorry, folks :-(



---

archive/issue_comments_064099.json:
```json
{
    "body": "Reviewer: Bill Hart, John Cremona",
    "created_at": "2009-07-16T18:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64099",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Reviewer: Bill Hart, John Cremona



---

archive/issue_events_019535.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "rename": {
        "from": "[with positive review] Flint uses a non-portable option to 'cp' which fails on Solaris.",
        "to": "Flint uses a non-portable option to 'cp' which fails on Solaris."
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6451#event-19535"
}
```



---

archive/issue_comments_064100.json:
```json
{
    "body": "Changing status from new to positive_review.",
    "created_at": "2009-07-16T18:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64100",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing status from new to positive_review.



---

archive/issue_events_019536.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2009-07-16T21:12:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6451#event-19536"
}
```



---

archive/issue_comments_064101.json:
```json
{
    "body": "Merged: sage-4.1.1.alpha0",
    "created_at": "2009-07-16T21:12:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64101",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Merged: sage-4.1.1.alpha0



---

archive/issue_comments_064102.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-07-16T21:12:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6451",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6451#issuecomment-64102",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Resolution: fixed
