# Issue 6384: elliptic curve -- isogeny function is not robust -- it doesn't check validity of its input

archive/issues_006384.json:
```json
{
    "body": "First the docstring for E.isogeny? has a typo\n\n```\n(defaul:None)\n```\nNote the missing t.\n\nNext, I tried taking the elliptic curve 11a and one 5-torsion point P on it and trying to make the isogeny `E --> E/<P>`.  It seems that the result is a **total disaster in every imaginable way**.\n\n```\nsage: E = EllipticCurve('11a'); P = E.torsion_subgroup().gens()[0]; P\n(5 : 5 : 1)\nsage: phi = E.isogeny([P]); phi\nIsogeny of degree 1 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 560*x - 4277 over Rational Field\nsage: phi.codomain().conductor()\n530575705\nsage: phi.codomain().conductor().factor()\n5 * 11 * 1531 * 6301\n```\n\nNote that: \n\n* the two curves are not isogenous, since their conductors are different\n\n* the degree of the isogeny is reported to be 1, but it should be 5.\n\n \n\n**Assignee:** shumow\n\n**CC:**  shumow@gmail.com kohel @JohnCremona\n\n**Keywords:** elliptic curves, isogeny,\n\n**Resolution:** fixed\n\n**Author:** Chris Wuthrich\n\n**Reviewer:** John Cremona, Minh Van Nguyen\n\n**Merged:** Sage 4.1.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/6384\n\n",
    "closed_at": "2009-08-24T05:20:16Z",
    "created_at": "2009-06-21T23:44:06Z",
    "labels": [
        "component: elliptic curves",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1.2",
    "title": "elliptic curve -- isogeny function is not robust -- it doesn't check validity of its input",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6384",
    "user": "https://github.com/williamstein"
}
```
First the docstring for E.isogeny? has a typo

```
(defaul:None)
```
Note the missing t.

Next, I tried taking the elliptic curve 11a and one 5-torsion point P on it and trying to make the isogeny `E --> E/<P>`.  It seems that the result is a **total disaster in every imaginable way**.

```
sage: E = EllipticCurve('11a'); P = E.torsion_subgroup().gens()[0]; P
(5 : 5 : 1)
sage: phi = E.isogeny([P]); phi
Isogeny of degree 1 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 560*x - 4277 over Rational Field
sage: phi.codomain().conductor()
530575705
sage: phi.codomain().conductor().factor()
5 * 11 * 1531 * 6301
```

Note that: 

* the two curves are not isogenous, since their conductors are different

* the degree of the isogeny is reported to be 1, but it should be 5.

 

**Assignee:** shumow

**CC:**  shumow@gmail.com kohel @JohnCremona

**Keywords:** elliptic curves, isogeny,

**Resolution:** fixed

**Author:** Chris Wuthrich

**Reviewer:** John Cremona, Minh Van Nguyen

**Merged:** Sage 4.1.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/6384





---

archive/issue_comments_063002.json:
```json
{
    "body": "The problem is where you do:\n\n> sage: phi = E.isogeny([P]); phi\n\n\nThat is not the correct way to specify a kernel.  You are trying to specify the generator, and expecting the isogeny function to determine this.  (We could, at some point modify this to be the case in some sense.)  However, the correct way to specify an isogeny with a kernel list is to specify the whole kernel.  So, what you would need to do is this:\n\n> sage: phi = E.isogeny([E(0), P, 2*P, 3*P, 4*P]); phi\n\n\nYou have a good point about the typo in the docstring.\n\n\n\n\nReplying to [ticket:6384 was]:\n> First the docstring for E.isogeny? has a typo\n> \n> ```\n> (defaul:None)\n> ```\n> Note the missing t.\n> \n> Next, I tried taking the elliptic curve 11a and one 5-torsion point P on it and trying to make the isogeny `E --> E/<P>`.  It seems that the result is a **total disaster in every imaginable way**.\n> \n> \n> ```\n> sage: E = EllipticCurve('11a'); P = E.torsion_subgroup().gens()[0]; P\n> (5 : 5 : 1)\n> sage: phi = E.isogeny([P]); phi\n> Isogeny of degree 1 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 560*x - 4277 over Rational Field\n> sage: phi.codomain().conductor()\n> 530575705\n> sage: phi.codomain().conductor().factor()\n> 5 * 11 * 1531 * 6301\n> ```\n> \n> Note that: \n> \n> * the two curves are not isogenous, since their conductors are different\n> \n> * the degree of the isogeny is reported to be 1, but it should be 5.\n> \n\n>",
    "created_at": "2009-06-22T16:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63002",
    "user": "https://trac.sagemath.org/admin/accounts/users/shumow"
}
```

The problem is where you do:

> sage: phi = E.isogeny([P]); phi


That is not the correct way to specify a kernel.  You are trying to specify the generator, and expecting the isogeny function to determine this.  (We could, at some point modify this to be the case in some sense.)  However, the correct way to specify an isogeny with a kernel list is to specify the whole kernel.  So, what you would need to do is this:

> sage: phi = E.isogeny([E(0), P, 2*P, 3*P, 4*P]); phi


You have a good point about the typo in the docstring.




Replying to [ticket:6384 was]:
> First the docstring for E.isogeny? has a typo
> 
> ```
> (defaul:None)
> ```
> Note the missing t.
> 
> Next, I tried taking the elliptic curve 11a and one 5-torsion point P on it and trying to make the isogeny `E --> E/<P>`.  It seems that the result is a **total disaster in every imaginable way**.
> 
> 
> ```
> sage: E = EllipticCurve('11a'); P = E.torsion_subgroup().gens()[0]; P
> (5 : 5 : 1)
> sage: phi = E.isogeny([P]); phi
> Isogeny of degree 1 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 560*x - 4277 over Rational Field
> sage: phi.codomain().conductor()
> 530575705
> sage: phi.codomain().conductor().factor()
> 5 * 11 * 1531 * 6301
> ```
> 
> Note that: 
> 
> * the two curves are not isogenous, since their conductors are different
> 
> * the degree of the isogeny is reported to be 1, but it should be 5.
> 

>



---

archive/issue_comments_063003.json:
```json
{
    "body": "**Assignee:** shumow",
    "created_at": "2009-06-22T16:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63003",
    "user": "https://trac.sagemath.org/admin/accounts/users/shumow"
}
```

**Assignee:** shumow



---

archive/issue_comments_063004.json:
```json
{
    "body": "<a id='comment:2'></a>\nI've changed the description of this ticket to: \" isogeny function is not robust -- it doesn't check validity of its input\". \n\nThe first easy fix is that you must check that the input list of points is a subgroup and raise an error if it isn't. \n\nAn enhancement can be opened as a separate ticket that would allow for generators instead.  Of course, a better solution is to just create a \"finite subgroups of elliptic curves class\". \n\n -- William",
    "created_at": "2009-06-22T16:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63004",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:2'></a>
I've changed the description of this ticket to: " isogeny function is not robust -- it doesn't check validity of its input". 

The first easy fix is that you must check that the input list of points is a subgroup and raise an error if it isn't. 

An enhancement can be opened as a separate ticket that would allow for generators instead.  Of course, a better solution is to just create a "finite subgroups of elliptic curves class". 

 -- William



---

archive/issue_events_019325.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "rename": {
        "from": "elliptic curve -- isogeny function seems completely totally broken in first example I try",
        "to": "elliptic curve -- isogeny function is not robust -- it doesn't check validity of its input"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6384#event-19325"
}
```



---

archive/issue_comments_063005.json:
```json
{
    "body": "<a id='comment:3'></a>\nI would change the input to be as now, but if a list of points is given, the kernel is understood to be the subgroup **GENERATED** by these points.\n\nI guess one needs to check the following:\n\n* If a list of points is given that they are torsion.\n\n* If a polynomial of degree n is given that it divides the division_polynomial(2*n+1). Also the polynomial should be squarefree, i.e. define a reduced scheme.\n\nAm I right ?\n\nWhy is the kernel_polynomial a multivariable polynomial ?\n\nAlso as an enhancement we could have simply an integer to get the multiplication by n as an isogeny. And for curves over QQ, a codomain=label (and the degree can be read off the isogeny_class matrix).",
    "created_at": "2009-06-25T17:16:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63005",
    "user": "https://github.com/categorie"
}
```

<a id='comment:3'></a>
I would change the input to be as now, but if a list of points is given, the kernel is understood to be the subgroup **GENERATED** by these points.

I guess one needs to check the following:

* If a list of points is given that they are torsion.

* If a polynomial of degree n is given that it divides the division_polynomial(2*n+1). Also the polynomial should be squarefree, i.e. define a reduced scheme.

Am I right ?

Why is the kernel_polynomial a multivariable polynomial ?

Also as an enhancement we could have simply an integer to get the multiplication by n as an isogeny. And for curves over QQ, a codomain=label (and the degree can be read off the isogeny_class matrix).



---

archive/issue_comments_063006.json:
```json
{
    "body": "<a id='comment:4'></a>\nOK. I will work on it and post a patch within the next week.\nChris.",
    "created_at": "2009-06-26T17:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63006",
    "user": "https://github.com/categorie"
}
```

<a id='comment:4'></a>
OK. I will work on it and post a patch within the next week.
Chris.



---

archive/issue_comments_063007.json:
```json
{
    "body": "<a id='comment:5'></a>\nMoreover there is the following bug in the doctest:\n\n```\nsage: E = EllipticCurve(GF(31),[1,0,0,1,2])\nsage: phi = E.isogeny([14,27,4,1])\nsage: phi.degree()\n7\nsage: E.division_polynomial(7).factor()\n(7) * (x^24 + 2*x^23  + ... +  15*x + 22)\n```\n\nin other words there can not be an isogeny of degree 7 defined over the ground field. The given polynomial is a factor of the 3-division polynomial. But it can not define an isogeny of degree 3 as the kernel would have 6 elements.",
    "created_at": "2009-07-03T12:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63007",
    "user": "https://github.com/categorie"
}
```

<a id='comment:5'></a>
Moreover there is the following bug in the doctest:

```
sage: E = EllipticCurve(GF(31),[1,0,0,1,2])
sage: phi = E.isogeny([14,27,4,1])
sage: phi.degree()
7
sage: E.division_polynomial(7).factor()
(7) * (x^24 + 2*x^23  + ... +  15*x + 22)
```

in other words there can not be an isogeny of degree 7 defined over the ground field. The given polynomial is a factor of the 3-division polynomial. But it can not define an isogeny of degree 3 as the kernel would have 6 elements.



---

archive/issue_events_019326.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "label": "component: number theory",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6384#event-19326"
}
```



---

archive/issue_comments_063008.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2009-07-03T16:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63008",
    "user": "https://github.com/categorie"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_063009.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"elliptic curves, isogeny,\".",
    "created_at": "2009-07-03T16:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63009",
    "user": "https://github.com/categorie"
}
```

**Changing keywords** from "" to "elliptic curves, isogeny,".



---

archive/issue_comments_063010.json:
```json
{
    "body": "<a id='comment:7'></a>\nThe patch was exported agains 4.1.alpha3.\n\nIn the end it took my quite a lot of work to correct this due to the (unnecessary) complexity of this file. I changed\n\n* one can now give a single point or a list of points as the kernel argument. The isogeny has kernel generated by these points.\n* it checks now if the points are torsion points and, when a polynomial is given, that it divides the correct division polynomial.\n* and i changed the documentation slightly.",
    "created_at": "2009-07-03T16:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63010",
    "user": "https://github.com/categorie"
}
```

<a id='comment:7'></a>
The patch was exported agains 4.1.alpha3.

In the end it took my quite a lot of work to correct this due to the (unnecessary) complexity of this file. I changed

* one can now give a single point or a list of points as the kernel argument. The isogeny has kernel generated by these points.
* it checks now if the points are torsion points and, when a polynomial is given, that it divides the correct division polynomial.
* and i changed the documentation slightly.



---

archive/issue_comments_063011.json:
```json
{
    "body": "**Changing status** from needs_review to needs_work.",
    "created_at": "2009-07-16T06:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63011",
    "user": "https://trac.sagemath.org/admin/accounts/users/shumow"
}
```

**Changing status** from needs_review to needs_work.



---

archive/issue_comments_063012.json:
```json
{
    "body": "<a id='comment:8'></a>\nSo, over all, thanks for the thorough once over here.\n\n\nSorry I didn't look at this lately.  I have been very busy.  I work full time and I am finishing my master's thesis (which I wrote this class to do research for.)\n\n\nI changed this to \"needs work\", not because it is necessarily bad, but because I want to discuss it more.\n\n\n1)  I don't think you should remove the algorithm parameter, which defaults to none.  First off I was planning on adding another algorithm which is similar to the kohel from kernel polynomial variant, and that is the main reason why I had the parameter.  That, or someone smarter than me can come along and add a new algorithm, and add the parameter to make it easier to select the new version (or specify the old version for backward compatibility.)\n\n2)  I am fine with taking the input as a point (or a pair of points) to specify the generators of the kernel.  However, I do not think that this should replace the kernel list way of doing things.  First off, it unnecessarily breaks backwards compatibility.  Second off, there was a very good reason that I did not initially do the solution that you have here, generating the list of input points from generators is quite slow.  Specifically, as you have it coded here, you end up doing n**2 work inflating the kernel list.  Now, if someone knows the list of points in the kernel, (or knows that the kernel is cyclic) they have no choice but to allow the init to run a quadratic complexity algorithm, when it would have otherwise been linear.  This actually becomes the slowest part of the isogeny computation.  I see no reason to not have this new way of doing input work alongside the old way.\n\n3) When changing this to work side by side with the old way, obviously not all of the examples should be changed, as we still want to exercise the old way of doing things.\n\n\nI think that your general modification here is good, however, I would like to switch this to work along side the old way of doing things.  By detecting the type of the input.  If you prefer I make the change, that is fine, but it will need to wait until I file my ms thesis, so after next week.",
    "created_at": "2009-07-16T06:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63012",
    "user": "https://trac.sagemath.org/admin/accounts/users/shumow"
}
```

<a id='comment:8'></a>
So, over all, thanks for the thorough once over here.


Sorry I didn't look at this lately.  I have been very busy.  I work full time and I am finishing my master's thesis (which I wrote this class to do research for.)


I changed this to "needs work", not because it is necessarily bad, but because I want to discuss it more.


1)  I don't think you should remove the algorithm parameter, which defaults to none.  First off I was planning on adding another algorithm which is similar to the kohel from kernel polynomial variant, and that is the main reason why I had the parameter.  That, or someone smarter than me can come along and add a new algorithm, and add the parameter to make it easier to select the new version (or specify the old version for backward compatibility.)

2)  I am fine with taking the input as a point (or a pair of points) to specify the generators of the kernel.  However, I do not think that this should replace the kernel list way of doing things.  First off, it unnecessarily breaks backwards compatibility.  Second off, there was a very good reason that I did not initially do the solution that you have here, generating the list of input points from generators is quite slow.  Specifically, as you have it coded here, you end up doing n**2 work inflating the kernel list.  Now, if someone knows the list of points in the kernel, (or knows that the kernel is cyclic) they have no choice but to allow the init to run a quadratic complexity algorithm, when it would have otherwise been linear.  This actually becomes the slowest part of the isogeny computation.  I see no reason to not have this new way of doing input work alongside the old way.

3) When changing this to work side by side with the old way, obviously not all of the examples should be changed, as we still want to exercise the old way of doing things.


I think that your general modification here is good, however, I would like to switch this to work along side the old way of doing things.  By detecting the type of the input.  If you prefer I make the change, that is fine, but it will need to wait until I file my ms thesis, so after next week.



---

archive/issue_comments_063013.json:
```json
{
    "body": "<a id='comment:9'></a>\nHi.\n\nI agree that we may want to discuss this further ... and maybe eventually ask sage-nt for a vote on what should be done.\n\n1) Currently the parameter 'algorithm' is of no use at all. As you can not force the algorithm to be 'kohel' when a list of point is given. So this option - in the current version - is totally obsolete and I am against carrying it around for nothing. If someone really wants to force things, he can always import the function and work directly with them. A user who wants to create an isogeny will never want to choose this. If ever you implement further algorithms, we can add it again without problem.\n\nI agree that this \"breaks\" backward compatibility. But it is really nowhere used in sage and I do not think that any user apart from the two of us even noticed that it existed. I personally consider it a design error and not an option that we must keep compatible with. But other people may think differently about this.\n\n2) The same goes for the compatibility issue here. We should not carry a wrong initial design with us for the rest of all times, if no one has ever used it.\n\nOn the other hand I agree with your speed arguement. I may be wrong, but I think no one will ever want to use this function with n as large as it would matter. In characteristic 0, the typical degree is hardly ever bigger than 10. Over finite fields, I would think that the usual way of using this function for large n would be through 'kohel', but I might be wrong. Anyway, I think that we should not worry about the eventual slow down. In most cases the subgroup is not computed previously to the use of this function. \n\nFor both 1) and 2), I asked William Stein and David Kohel whether they would agree with changing this in Barcelona.\n\nChris.",
    "created_at": "2009-07-20T15:38:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63013",
    "user": "https://github.com/categorie"
}
```

<a id='comment:9'></a>
Hi.

I agree that we may want to discuss this further ... and maybe eventually ask sage-nt for a vote on what should be done.

1) Currently the parameter 'algorithm' is of no use at all. As you can not force the algorithm to be 'kohel' when a list of point is given. So this option - in the current version - is totally obsolete and I am against carrying it around for nothing. If someone really wants to force things, he can always import the function and work directly with them. A user who wants to create an isogeny will never want to choose this. If ever you implement further algorithms, we can add it again without problem.

I agree that this "breaks" backward compatibility. But it is really nowhere used in sage and I do not think that any user apart from the two of us even noticed that it existed. I personally consider it a design error and not an option that we must keep compatible with. But other people may think differently about this.

2) The same goes for the compatibility issue here. We should not carry a wrong initial design with us for the rest of all times, if no one has ever used it.

On the other hand I agree with your speed arguement. I may be wrong, but I think no one will ever want to use this function with n as large as it would matter. In characteristic 0, the typical degree is hardly ever bigger than 10. Over finite fields, I would think that the usual way of using this function for large n would be through 'kohel', but I might be wrong. Anyway, I think that we should not worry about the eventual slow down. In most cases the subgroup is not computed previously to the use of this function. 

For both 1) and 2), I asked William Stein and David Kohel whether they would agree with changing this in Barcelona.

Chris.



---

archive/issue_events_019327.json:
```json
{
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "label": "component: number theory",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6384#event-19327"
}
```



---

archive/issue_comments_063014.json:
```json
{
    "body": "<a id='comment:11'></a>\nI am updating here the patch. It is now based on sage-4.1.1 plus trac ticket #6672 .\n\nSince nothing seems to happen with this patch and I continue to insist that it should go in as it is, I allow myself to switch back to 'needs review'. If any reviewer is against it for the reasons mentioned eralier, then I would propose that this ticket goes in (as it fixes some serious bugs) and that the changes are made later to it. I recall the main changes :\n\n* one can now give a single point or a list of points as the kernel argument. The isogeny has kernel generated by these points. \n* it checks now if the points are torsion points and, when a polynomial is given, that it divides the correct division polynomial.\n* and it changes the documentation slightly.",
    "created_at": "2009-08-20T12:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63014",
    "user": "https://github.com/categorie"
}
```

<a id='comment:11'></a>
I am updating here the patch. It is now based on sage-4.1.1 plus trac ticket #6672 .

Since nothing seems to happen with this patch and I continue to insist that it should go in as it is, I allow myself to switch back to 'needs review'. If any reviewer is against it for the reasons mentioned eralier, then I would propose that this ticket goes in (as it fixes some serious bugs) and that the changes are made later to it. I recall the main changes :

* one can now give a single point or a list of points as the kernel argument. The isogeny has kernel generated by these points. 
* it checks now if the points are torsion points and, when a polynomial is given, that it divides the correct division polynomial.
* and it changes the documentation slightly.



---

archive/issue_comments_063015.json:
```json
{
    "body": "**Changing status** from needs_work to needs_review.",
    "created_at": "2009-08-20T12:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63015",
    "user": "https://github.com/categorie"
}
```

**Changing status** from needs_work to needs_review.



---

archive/issue_comments_063016.json:
```json
{
    "body": "Attachment [trac_6384.patch](tarball://root/attachments/some-uuid/ticket6384/trac_6384.patch) by @categorie created at 2009-08-20 12:10:52\n\nexported against 4.1.1 + patch #6672",
    "created_at": "2009-08-20T12:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63016",
    "user": "https://github.com/categorie"
}
```

Attachment [trac_6384.patch](tarball://root/attachments/some-uuid/ticket6384/trac_6384.patch) by @categorie created at 2009-08-20 12:10:52

exported against 4.1.1 + patch #6672



---

archive/issue_comments_063017.json:
```json
{
    "body": "<a id='comment:12'></a>\nThese are all things I wanted to change myself, after trying out the isogeny code, but I had not realised that it had been done.\n\nI'll do a proper review within a day or so, promise.",
    "created_at": "2009-08-21T20:44:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63017",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:12'></a>
These are all things I wanted to change myself, after trying out the isogeny code, but I had not realised that it had been done.

I'll do a proper review within a day or so, promise.



---

archive/issue_comments_063018.json:
```json
{
    "body": "<a id='comment:13'></a>\nI agree that this fixes some issues, and is important.  However, as I said before, I do not think that we should totally replace being able to specify the full list of points in the kernel.  Rather, I think specifying the generators should work *in addition to* the full list of kernel points.  Using Velu's algorithm here is mainly for pedagogical reasons anyway, as specifying the kernel polynomial is computationally much simpler and easy.  And as using Velu's algorithm requires the input be the full list of points, I think this is a reasonable input.\n\nI propose that we open new bugs for (1) the documentation issues that you fix and (2) an enhancement for being able to specify generators in addition to the full list of kernel points.\n\nOverall, The fixes in this patch are good, there are just many fixes in a patch that don't really fix *this bug*",
    "created_at": "2009-08-22T01:19:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63018",
    "user": "https://trac.sagemath.org/admin/accounts/users/shumow"
}
```

<a id='comment:13'></a>
I agree that this fixes some issues, and is important.  However, as I said before, I do not think that we should totally replace being able to specify the full list of points in the kernel.  Rather, I think specifying the generators should work *in addition to* the full list of kernel points.  Using Velu's algorithm here is mainly for pedagogical reasons anyway, as specifying the kernel polynomial is computationally much simpler and easy.  And as using Velu's algorithm requires the input be the full list of points, I think this is a reasonable input.

I propose that we open new bugs for (1) the documentation issues that you fix and (2) an enhancement for being able to specify generators in addition to the full list of kernel points.

Overall, The fixes in this patch are good, there are just many fixes in a patch that don't really fix *this bug*



---

archive/issue_comments_063019.json:
```json
{
    "body": "<a id='comment:14'></a>\nI have just read through the above discussions.  I think that by far the most common way people will create isgenies from kernels will be either from a kernel polynomial (in which case there definitely should be a check, as Chris implemented, that the polynomial given does define a valid subgroup), or by giving a point generating a cyclic kernel.  So I'm with Chris on this one.  It is very easy to convert a pint P of order n to a list of points in the subgroup generated by P, just use list(multiples(P,n))  --multiples() returned an iterator.    It will be very rare for non-cyclic isogenies to be needed, with the single exception of the multiplication-by-m map which we can already create using the division_polynomial(m).\n\nI don't think that backward compatibility is an important issue here, though I can see that it might be for Dan, since the isogeny code is so new, to the extent that I still consider it to be \"beta\" code, as I have not had a chance to use it much.\n\nDan, I cannot imagine it to be at all common for a user to have the points of a subgroup but not know the generator(s), so I think your comment about the complexity here is not a very serious one.\n\nI will now spend some time testing the patch;  if I don't find any problems I'll give this a positive review.",
    "created_at": "2009-08-22T11:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63019",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:14'></a>
I have just read through the above discussions.  I think that by far the most common way people will create isgenies from kernels will be either from a kernel polynomial (in which case there definitely should be a check, as Chris implemented, that the polynomial given does define a valid subgroup), or by giving a point generating a cyclic kernel.  So I'm with Chris on this one.  It is very easy to convert a pint P of order n to a list of points in the subgroup generated by P, just use list(multiples(P,n))  --multiples() returned an iterator.    It will be very rare for non-cyclic isogenies to be needed, with the single exception of the multiplication-by-m map which we can already create using the division_polynomial(m).

I don't think that backward compatibility is an important issue here, though I can see that it might be for Dan, since the isogeny code is so new, to the extent that I still consider it to be "beta" code, as I have not had a chance to use it much.

Dan, I cannot imagine it to be at all common for a user to have the points of a subgroup but not know the generator(s), so I think your comment about the complexity here is not a very serious one.

I will now spend some time testing the patch;  if I don't find any problems I'll give this a positive review.



---

archive/issue_events_019328.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "rename": {
        "from": "elliptic curve -- isogeny function is not robust -- it doesn't check validity of its input",
        "to": "[with positive review] elliptic curve -- isogeny function is not robust -- it doesn't check validity of its input"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6384#event-19328"
}
```



---

archive/issue_comments_063020.json:
```json
{
    "body": "<a id='comment:15'></a>\nHere's the positive review.  I tried out the curve on a whole lot of examples.\n\nIf there is still disagreement we could try for a vote on sage-devel or sage-nt!",
    "created_at": "2009-08-23T13:47:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63020",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:15'></a>
Here's the positive review.  I tried out the curve on a whole lot of examples.

If there is still disagreement we could try for a vote on sage-devel or sage-nt!



---

archive/issue_comments_063021.json:
```json
{
    "body": "**Author:** wuthrich",
    "created_at": "2009-08-23T13:47:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63021",
    "user": "https://github.com/JohnCremona"
}
```

**Author:** wuthrich



---

archive/issue_comments_063022.json:
```json
{
    "body": "**Reviewer:** cremona",
    "created_at": "2009-08-23T13:47:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63022",
    "user": "https://github.com/JohnCremona"
}
```

**Reviewer:** cremona



---

archive/issue_comments_063023.json:
```json
{
    "body": "<a id='comment:16'></a>\nPossible typo in the patch that touches `sage/schemes/elliptic_curves/ell_curve_isogeny.py`:\n\n```\n4036\t    - ``E2``        - an elliptic curve in short wWeierstrass form. \n```\nIt should be \"Weierstrass\" instead of \"wWeierstrass\".",
    "created_at": "2009-08-24T00:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63023",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:16'></a>
Possible typo in the patch that touches `sage/schemes/elliptic_curves/ell_curve_isogeny.py`:

```
4036	    - ``E2``        - an elliptic curve in short wWeierstrass form. 
```
It should be "Weierstrass" instead of "wWeierstrass".



---

archive/issue_events_019329.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "rename": {
        "from": "[with positive review] elliptic curve -- isogeny function is not robust -- it doesn't check validity of its input",
        "to": "elliptic curve -- isogeny function is not robust -- it doesn't check validity of its input"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6384#event-19329"
}
```



---

archive/issue_comments_063024.json:
```json
{
    "body": "**Changing status** from new to positive_review.",
    "created_at": "2009-08-24T00:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63024",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing status** from new to positive_review.



---

archive/issue_comments_063025.json:
```json
{
    "body": "Attachment [trac_6384-reviewer.patch](tarball://root/attachments/some-uuid/ticket6384/trac_6384-reviewer.patch) by mvngu created at 2009-08-24 04:51:48\n\nreviewer patch; apply after previous one",
    "created_at": "2009-08-24T04:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63025",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Attachment [trac_6384-reviewer.patch](tarball://root/attachments/some-uuid/ticket6384/trac_6384-reviewer.patch) by mvngu created at 2009-08-24 04:51:48

reviewer patch; apply after previous one



---

archive/issue_comments_063026.json:
```json
{
    "body": "<a id='comment:17'></a>\nThe patch `trac_6384-reviewer.patch` fixes the reported typo. It should be applied after `trac_6384.patch`.",
    "created_at": "2009-08-24T04:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63026",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:17'></a>
The patch `trac_6384-reviewer.patch` fixes the reported typo. It should be applied after `trac_6384.patch`.



---

archive/issue_comments_063027.json:
```json
{
    "body": "**Changing reviewer** from \"cremona\" to \"John Cremona, Minh Van Nguyen\".",
    "created_at": "2009-08-24T05:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63027",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing reviewer** from "cremona" to "John Cremona, Minh Van Nguyen".



---

archive/issue_comments_063028.json:
```json
{
    "body": "**Changing author** from \"wuthrich\" to \"Chris Wuthrich\".",
    "created_at": "2009-08-24T05:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63028",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Changing author** from "wuthrich" to "Chris Wuthrich".



---

archive/issue_comments_063029.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2009-08-24T05:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63029",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Resolution:** fixed



---

archive/issue_events_019330.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2009-08-24T05:20:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6384#event-19330"
}
```



---

archive/issue_comments_063030.json:
```json
{
    "body": "**Merged:** Sage 4.1.2.alpha0",
    "created_at": "2009-08-24T05:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63030",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

**Merged:** Sage 4.1.2.alpha0



---

archive/issue_comments_063031.json:
```json
{
    "body": "<a id='comment:19'></a>\nMerged both patches.",
    "created_at": "2009-08-24T05:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63031",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:19'></a>
Merged both patches.



---

archive/issue_comments_063032.json:
```json
{
    "body": "<a id='comment:20'></a>\nSee #6886 for an undesirable side-effect of the checking introduced here!",
    "created_at": "2009-09-04T08:59:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6384#issuecomment-63032",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:20'></a>
See #6886 for an undesirable side-effect of the checking introduced here!
