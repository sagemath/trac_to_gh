# Issue 6196: [with patch, positive review] mpmath support

archive/issues_006196.json:
```json
{
    "body": "Patch description:\n\nAdds sage.libs.mpmath which provides wrapper functions and\nmonkey patches some internal mpmath functions for speed. Mpmath\nfunctions can be called from Sage as follows (with forward\nand backward conversions handled automatically):\n\n```\nsage: import sage.libs.mpmath.all as a\nsage: a.call(a.hyp2f1, 2, 2/3, -1/2, 3+4*I)\n-0.111907858412569 - 0.536467867510390*I\nsage: a.call(a.hyp2f1, 2, 2/3, -1/2, 3+4*I, prec=100)\n-0.11190785841256900204178259859 - 0.53646786751038954277574814099*I\n```\n\nSome partial support for direct conversion from Sage -> mpmath\nis also implemented (this is not completely working yet).\n\nAlso providing a preliminary spkg (with current mpmath trunk) in this issue.\n\nAssignee: @mwhansen\n\nReviewer: Nick Alexander\n\nAuthor: Fredrik Johansson, Mike Hansen\n\nMerged: sage-4.1.rc0\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/6196\n\n",
    "closed_at": "2009-07-02T21:07:15Z",
    "created_at": "2009-06-03T17:32:58Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.1",
    "title": "[with patch, positive review] mpmath support",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6196",
    "user": "https://github.com/fredrik-johansson"
}
```
Patch description:

Adds sage.libs.mpmath which provides wrapper functions and
monkey patches some internal mpmath functions for speed. Mpmath
functions can be called from Sage as follows (with forward
and backward conversions handled automatically):

```
sage: import sage.libs.mpmath.all as a
sage: a.call(a.hyp2f1, 2, 2/3, -1/2, 3+4*I)
-0.111907858412569 - 0.536467867510390*I
sage: a.call(a.hyp2f1, 2, 2/3, -1/2, 3+4*I, prec=100)
-0.11190785841256900204178259859 - 0.53646786751038954277574814099*I
```

Some partial support for direct conversion from Sage -> mpmath
is also implemented (this is not completely working yet).

Also providing a preliminary spkg (with current mpmath trunk) in this issue.

Assignee: @mwhansen

Reviewer: Nick Alexander

Author: Fredrik Johansson, Mike Hansen

Merged: sage-4.1.rc0

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/6196





---

archive/issue_comments_053787.json:
```json
{
    "body": "<a id='comment:1'></a>\nAttachment [mpmath.patch](tarball://root/attachments/some-uuid/ticket6196/mpmath.patch) by @fredrik-johansson created at 2009-06-03 17:36:56",
    "created_at": "2009-06-03T17:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53787",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:1'></a>
Attachment [mpmath.patch](tarball://root/attachments/some-uuid/ticket6196/mpmath.patch) by @fredrik-johansson created at 2009-06-03 17:36:56



---

archive/issue_comments_053788.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,11 +5,15 @@\n functions can be called from Sage as follows (with forward\n and backward conversions handled automatically):\n \n+```\n sage: import sage.libs.mpmath.all as a\n sage: a.call(a.hyp2f1, 2, 2/3, -1/2, 3+4*I)\n -0.111907858412569 - 0.536467867510390*I\n sage: a.call(a.hyp2f1, 2, 2/3, -1/2, 3+4*I, prec=100)\n -0.11190785841256900204178259859 - 0.53646786751038954277574814099*I\n+```\n \n Some partial support for direct conversion from Sage -> mpmath\n is also implemented (this is not completely working yet).\n+\n+Also providing a preliminary spkg (with current mpmath trunk) in this issue.\n``````\n",
    "created_at": "2009-06-03T17:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53788",
    "user": "https://github.com/fredrik-johansson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,11 +5,15 @@
 functions can be called from Sage as follows (with forward
 and backward conversions handled automatically):
 
+```
 sage: import sage.libs.mpmath.all as a
 sage: a.call(a.hyp2f1, 2, 2/3, -1/2, 3+4*I)
 -0.111907858412569 - 0.536467867510390*I
 sage: a.call(a.hyp2f1, 2, 2/3, -1/2, 3+4*I, prec=100)
 -0.11190785841256900204178259859 - 0.53646786751038954277574814099*I
+```
 
 Some partial support for direct conversion from Sage -> mpmath
 is also implemented (this is not completely working yet).
+
+Also providing a preliminary spkg (with current mpmath trunk) in this issue.
``````




---

archive/issue_events_024849.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "rename": {
        "from": "mpmath support",
        "to": "[with patch; needs review] mpmath support"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6196#event-24849"
}
```



---

archive/issue_comments_053789.json:
```json
{
    "body": "<a id='comment:3'></a>\nI am interested in using mpmath for numerical integration, but unfortunately I get major build errors with 4.0.2.alpha0.  See http://pastebin.com/d13f03d03 for details.  Any thoughts?",
    "created_at": "2009-06-19T18:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53789",
    "user": "https://github.com/ncalexan"
}
```

<a id='comment:3'></a>
I am interested in using mpmath for numerical integration, but unfortunately I get major build errors with 4.0.2.alpha0.  See http://pastebin.com/d13f03d03 for details.  Any thoughts?



---

archive/issue_events_024850.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "rename": {
        "from": "[with patch; needs review] mpmath support",
        "to": "[with patch; needs work] mpmath support"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6196#event-24850"
}
```



---

archive/issue_comments_053790.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nick Alexander\"",
    "created_at": "2009-06-19T18:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53790",
    "user": "https://github.com/ncalexan"
}
```

Changing reviewer from "" to "Nick Alexander"



---

archive/issue_comments_053791.json:
```json
{
    "body": "Changing author from \"\" to \"Fredrik Johannson\"",
    "created_at": "2009-06-19T18:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53791",
    "user": "https://github.com/ncalexan"
}
```

Changing author from "" to "Fredrik Johannson"



---

archive/issue_comments_053792.json:
```json
{
    "body": "Changing assignee from mabshoff to @mwhansen.",
    "created_at": "2009-06-19T22:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53792",
    "user": "https://github.com/mwhansen"
}
```

Changing assignee from mabshoff to @mwhansen.



---

archive/issue_events_024851.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "rename": {
        "from": "[with patch; needs work] mpmath support",
        "to": "[with patch; needs review] mpmath support"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6196#event-24851"
}
```



---

archive/issue_comments_053793.json:
```json
{
    "body": "<a id='comment:4'></a>\nAttachment [trac_6196-review.patch](tarball://root/attachments/some-uuid/ticket6196/trac_6196-review.patch) by @mwhansen created at 2009-06-19 22:20:55\n\nI put an spkg at http://sage.math.washington.edu/home/mhansen/mpmath-0.12.spkg",
    "created_at": "2009-06-19T22:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53793",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:4'></a>
Attachment [trac_6196-review.patch](tarball://root/attachments/some-uuid/ticket6196/trac_6196-review.patch) by @mwhansen created at 2009-06-19 22:20:55

I put an spkg at http://sage.math.washington.edu/home/mhansen/mpmath-0.12.spkg



---

archive/issue_comments_053794.json:
```json
{
    "body": "Changing status from new to assigned.",
    "created_at": "2009-06-19T22:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53794",
    "user": "https://github.com/mwhansen"
}
```

Changing status from new to assigned.



---

archive/issue_comments_053795.json:
```json
{
    "body": "Changing author from \"Fredrik Johannson\" to \"Fredrik Johannson, Mike Hansen\"",
    "created_at": "2009-06-19T22:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53795",
    "user": "https://github.com/ncalexan"
}
```

Changing author from "Fredrik Johannson" to "Fredrik Johannson, Mike Hansen"



---

archive/issue_comments_053796.json:
```json
{
    "body": "<a id='comment:5'></a>\nApply all patches.",
    "created_at": "2009-06-19T22:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53796",
    "user": "https://github.com/ncalexan"
}
```

<a id='comment:5'></a>
Apply all patches.



---

archive/issue_comments_053797.json:
```json
{
    "body": "<a id='comment:6'></a>\nPositive review for me.  Change status after my tiny patch is refereed.",
    "created_at": "2009-06-19T22:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53797",
    "user": "https://github.com/ncalexan"
}
```

<a id='comment:6'></a>
Positive review for me.  Change status after my tiny patch is refereed.



---

archive/issue_comments_053798.json:
```json
{
    "body": "Attachment [trac_6196-ncalexan.patch](tarball://root/attachments/some-uuid/ticket6196/trac_6196-ncalexan.patch) by @ncalexan created at 2009-06-19 22:56:41",
    "created_at": "2009-06-19T22:56:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53798",
    "user": "https://github.com/ncalexan"
}
```

Attachment [trac_6196-ncalexan.patch](tarball://root/attachments/some-uuid/ticket6196/trac_6196-ncalexan.patch) by @ncalexan created at 2009-06-19 22:56:41



---

archive/issue_events_024852.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "rename": {
        "from": "[with patch; needs review] mpmath support",
        "to": "[with patch; positive review] mpmath support"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6196#event-24852"
}
```



---

archive/issue_comments_053799.json:
```json
{
    "body": "<a id='comment:7'></a>\nNick's changes look good.",
    "created_at": "2009-06-19T22:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53799",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:7'></a>
Nick's changes look good.



---

archive/issue_events_024853.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "rename": {
        "from": "[with patch; positive review] mpmath support",
        "to": "[with patch; needs work] mpmath support"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6196#event-24853"
}
```



---

archive/issue_comments_053800.json:
```json
{
    "body": "<a id='comment:8'></a>\nDoctest failures:\n\n```\n\nsage -t -long devel/sage/sage/rings/real_mpfr.pyx\n**********************************************************************\nFile \"/space/boothby/sage-4.0.3/devel/sage-main/sage/rings/real_mpfr.pyx\", line 2284:\n    sage: RR(-1.5)._mpmath_()\nException raised:\n    Traceback (most recent call last):\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_65[2]>\", line 1, in <module>\n        RR(-RealNumber('1.5'))._mpmath_()###line 2284:\n    sage: RR(-1.5)._mpmath_()\n      File \"real_mpfr.pyx\", line 2289, in sage.rings.real_mpfr.RealNumber._mpmath_ (sage/rings/real$\n        from sage.libs.mpmath.all import make_mpf\n      File \"/space/boothby/sage-4.0.3/local/lib/python2.5/site-packages/sage/libs/mpmath/all.py\", l$\n        import mpmath\n    ImportError: No module named mpmath\n**********************************************************************\n1 items had failures:\n   1 of   3 in __main__.example_65\n***Test Failed*** 1 failures.\n```\n\n```\nsage -t -long devel/sage/sage/rings/complex_number.pyx\n**********************************************************************\nFile \"/space/boothby/sage-4.0.3/devel/sage-main/sage/rings/complex_number.pyx\", line 484:\n    sage: CC(1,2)._mpmath_()\nException raised:\n    Traceback (most recent call last):\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_15[2]>\", line 1, in <module>\n        CC(Integer(1),Integer(2))._mpmath_()###line 484:\n    sage: CC(1,2)._mpmath_()\n      File \"complex_number.pyx\", line 489, in sage.rings.complex_number.ComplexNumber._mpmath_ (sag$\n        from sage.libs.mpmath.all import make_mpc\n      File \"/space/boothby/sage-4.0.3/local/lib/python2.5/site-packages/sage/libs/mpmath/all.py\", l$\n        import mpmath\n    ImportError: No module named mpmath\n**********************************************************************\n1 items had failures:\n   1 of   3 in __main__.example_15\n***Test Failed*** 1 failures.\n```\n\n```\nsage -t -long devel/sage/sage/structure/element.pyx\n**********************************************************************\nFile \"/space/boothby/sage-4.0.3/devel/sage-main/sage/structure/element.pyx\", line 426:\n    sage: from sage.libs.mpmath.all import mp, mpmathify\nException raised:\n    Traceback (most recent call last):\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_13[2]>\", line 1, in <module>\n        from sage.libs.mpmath.all import mp, mpmathify###line 426:\n    sage: from sage.libs.mpmath.all import mp, mpmathify\n      File \"/space/boothby/sage-4.0.3/local/lib/python2.5/site-packages/sage/libs/mpmath/all.py\", l$\n        import mpmath\n    ImportError: No module named mpmath\n**********************************************************************\nFile \"/space/boothby/sage-4.0.3/devel/sage-main/sage/structure/element.pyx\", line 427:\n    sage: mp.dps = 30\nException raised:\n    Traceback (most recent call last):\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_13[3]>\", line 1, in <module>\n        mp.dps = Integer(30)###line 427:\n    sage: mp.dps = 30\n    NameError: name 'mp' is not defined\n**********************************************************************\nFile \"/space/boothby/sage-4.0.3/devel/sage-main/sage/structure/element.pyx\", line 428:\n    sage: 25._mpmath_(53)\nException raised:\n    Traceback (most recent call last):\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n\n...\n```\n\n\n```\n\nsage -t -long devel/sage/sage/libs/mpmath/utils.pyx\n**********************************************************************\nFile \"/space/boothby/sage-4.0.3/devel/sage-main/sage/libs/mpmath/utils.pyx\", line 27:\n    sage: from mpmath.libmpf import from_man_exp\nException raised:\n    Traceback (most recent call last):\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[2]>\", line 1, in <module>\n        from mpmath.libmpf import from_man_exp###line 27:\n    sage: from mpmath.libmpf import from_man_exp\n    ImportError: No module named mpmath.libmpf\n**********************************************************************\nFile \"/space/boothby/sage-4.0.3/devel/sage-main/sage/libs/mpmath/utils.pyx\", line 28:\n    sage: from_man_exp(-6, -1)\nException raised:\n    Traceback (most recent call last):\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/space/boothby/sage-4.0.3/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n...\n```",
    "created_at": "2009-06-24T18:21:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53800",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

<a id='comment:8'></a>
Doctest failures:

```

sage -t -long devel/sage/sage/rings/real_mpfr.pyx
**********************************************************************
File "/space/boothby/sage-4.0.3/devel/sage-main/sage/rings/real_mpfr.pyx", line 2284:
    sage: RR(-1.5)._mpmath_()
Exception raised:
    Traceback (most recent call last):
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_65[2]>", line 1, in <module>
        RR(-RealNumber('1.5'))._mpmath_()###line 2284:
    sage: RR(-1.5)._mpmath_()
      File "real_mpfr.pyx", line 2289, in sage.rings.real_mpfr.RealNumber._mpmath_ (sage/rings/real$
        from sage.libs.mpmath.all import make_mpf
      File "/space/boothby/sage-4.0.3/local/lib/python2.5/site-packages/sage/libs/mpmath/all.py", l$
        import mpmath
    ImportError: No module named mpmath
**********************************************************************
1 items had failures:
   1 of   3 in __main__.example_65
***Test Failed*** 1 failures.
```

```
sage -t -long devel/sage/sage/rings/complex_number.pyx
**********************************************************************
File "/space/boothby/sage-4.0.3/devel/sage-main/sage/rings/complex_number.pyx", line 484:
    sage: CC(1,2)._mpmath_()
Exception raised:
    Traceback (most recent call last):
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_15[2]>", line 1, in <module>
        CC(Integer(1),Integer(2))._mpmath_()###line 484:
    sage: CC(1,2)._mpmath_()
      File "complex_number.pyx", line 489, in sage.rings.complex_number.ComplexNumber._mpmath_ (sag$
        from sage.libs.mpmath.all import make_mpc
      File "/space/boothby/sage-4.0.3/local/lib/python2.5/site-packages/sage/libs/mpmath/all.py", l$
        import mpmath
    ImportError: No module named mpmath
**********************************************************************
1 items had failures:
   1 of   3 in __main__.example_15
***Test Failed*** 1 failures.
```

```
sage -t -long devel/sage/sage/structure/element.pyx
**********************************************************************
File "/space/boothby/sage-4.0.3/devel/sage-main/sage/structure/element.pyx", line 426:
    sage: from sage.libs.mpmath.all import mp, mpmathify
Exception raised:
    Traceback (most recent call last):
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_13[2]>", line 1, in <module>
        from sage.libs.mpmath.all import mp, mpmathify###line 426:
    sage: from sage.libs.mpmath.all import mp, mpmathify
      File "/space/boothby/sage-4.0.3/local/lib/python2.5/site-packages/sage/libs/mpmath/all.py", l$
        import mpmath
    ImportError: No module named mpmath
**********************************************************************
File "/space/boothby/sage-4.0.3/devel/sage-main/sage/structure/element.pyx", line 427:
    sage: mp.dps = 30
Exception raised:
    Traceback (most recent call last):
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_13[3]>", line 1, in <module>
        mp.dps = Integer(30)###line 427:
    sage: mp.dps = 30
    NameError: name 'mp' is not defined
**********************************************************************
File "/space/boothby/sage-4.0.3/devel/sage-main/sage/structure/element.pyx", line 428:
    sage: 25._mpmath_(53)
Exception raised:
    Traceback (most recent call last):
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs

...
```


```

sage -t -long devel/sage/sage/libs/mpmath/utils.pyx
**********************************************************************
File "/space/boothby/sage-4.0.3/devel/sage-main/sage/libs/mpmath/utils.pyx", line 27:
    sage: from mpmath.libmpf import from_man_exp
Exception raised:
    Traceback (most recent call last):
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[2]>", line 1, in <module>
        from mpmath.libmpf import from_man_exp###line 27:
    sage: from mpmath.libmpf import from_man_exp
    ImportError: No module named mpmath.libmpf
**********************************************************************
File "/space/boothby/sage-4.0.3/devel/sage-main/sage/libs/mpmath/utils.pyx", line 28:
    sage: from_man_exp(-6, -1)
Exception raised:
    Traceback (most recent call last):
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/space/boothby/sage-4.0.3/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
...
```



---

archive/issue_comments_053801.json:
```json
{
    "body": "<a id='comment:9'></a>\nThere's an spkg; this looks a lot like you didn't install it.  I did *exactly* the same thing with malb's singular spkg update when I was release manager.  Maybe we need sage -merge to yell if it sees certain things, like spkgs?",
    "created_at": "2009-06-24T18:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53801",
    "user": "https://github.com/ncalexan"
}
```

<a id='comment:9'></a>
There's an spkg; this looks a lot like you didn't install it.  I did *exactly* the same thing with malb's singular spkg update when I was release manager.  Maybe we need sage -merge to yell if it sees certain things, like spkgs?



---

archive/issue_comments_053802.json:
```json
{
    "body": "<a id='comment:10'></a>\nOh damn.  Thanks, Nick.",
    "created_at": "2009-06-24T18:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53802",
    "user": "https://trac.sagemath.org/admin/accounts/users/boothby"
}
```

<a id='comment:10'></a>
Oh damn.  Thanks, Nick.



---

archive/issue_events_024854.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "rename": {
        "from": "[with patch; needs work] mpmath support",
        "to": "[with patch, positive review] mpmath support"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6196#event-24854"
}
```



---

archive/issue_events_024855.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-02T21:07:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6196#event-24855"
}
```



---

archive/issue_comments_053803.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.1.rc0\"",
    "created_at": "2009-07-02T21:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53803",
    "user": "https://github.com/rlmill"
}
```

Changing merged from "" to "sage-4.1.rc0"



---

archive/issue_comments_053804.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2009-07-02T21:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53804",
    "user": "https://github.com/rlmill"
}
```

Resolution: fixed



---

archive/issue_comments_053805.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe milestone for this ticket should be 4.1. I can't change it, since I don't have admin privileges on trac.",
    "created_at": "2009-07-12T10:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53805",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:13'></a>
The milestone for this ticket should be 4.1. I can't change it, since I don't have admin privileges on trac.



---

archive/issue_events_024856.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2009-07-12T18:55:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "milestone": "sage-4.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6196#event-24856"
}
```



---

archive/issue_comments_053806.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2016-04-15T12:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53806",
    "user": "https://github.com/fchapoton"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_comments_053807.json:
```json
{
    "body": "Changing author from \"Fredrik Johannson, Mike Hansen\" to \"Fredrik Johansson, Mike Hansen\"",
    "created_at": "2016-04-15T12:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6196#issuecomment-53807",
    "user": "https://github.com/fchapoton"
}
```

Changing author from "Fredrik Johannson, Mike Hansen" to "Fredrik Johansson, Mike Hansen"
