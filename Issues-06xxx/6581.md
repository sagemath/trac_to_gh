# Issue 6581: Groebner basis not working over symbolic ring

archive/issues_006581.json:
```json
{
    "body": "I'm not sure if this is a problem in the multivariate polynomials (which seem to raise the actual error) or somewhere in the symbolics.\n\n```\nsage: R2.<a,b> = SR[]\nsage: I2 = [a*b+a, a*a] * R2\nsage: G2 = I2.groebner_basis()\nverbose 0 (2247: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation.\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n...\nAttributeError: 'MPolynomialRing_polydict' object has no attribute 'monomial_divides'\nsage: \n```\n\n**Apply:**\n\n    [attachment:trac_6581_enable_more_ideals_for_toy_buchberger.patch]\n\nAssignee: tbd\n\nCC:  wstein @malb\n\nResolution: fixed\n\nAuthor: John Perry\n\nReviewer: Martin Albrecht\n\nMerged: sage-5.0.beta4\n\nIssue created by migration from https://trac.sagemath.org/ticket/6581\n\n",
    "closed_at": "2012-02-14T14:19:32Z",
    "created_at": "2009-07-21T17:11:12Z",
    "labels": [
        "component: commutative algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Groebner basis not working over symbolic ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/6581",
    "user": "https://github.com/rhinton"
}
```
I'm not sure if this is a problem in the multivariate polynomials (which seem to raise the actual error) or somewhere in the symbolics.

```
sage: R2.<a,b> = SR[]
sage: I2 = [a*b+a, a*a] * R2
sage: G2 = I2.groebner_basis()
verbose 0 (2247: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation.
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
...
AttributeError: 'MPolynomialRing_polydict' object has no attribute 'monomial_divides'
sage: 
```

**Apply:**

    [attachment:trac_6581_enable_more_ideals_for_toy_buchberger.patch]

Assignee: tbd

CC:  wstein @malb

Resolution: fixed

Author: John Perry

Reviewer: Martin Albrecht

Merged: sage-5.0.beta4

Issue created by migration from https://trac.sagemath.org/ticket/6581





---

archive/issue_comments_060586.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,13 @@\n I'm not sure if this is a problem in the multivariate polynomials (which seem to raise the actual error) or somewhere in the symbolics.\n \n+```\n sage: R2.<a,b> = SR[]\n sage: I2 = [a*b+a, a*a] * R2\n sage: G2 = I2.groebner_basis()\n verbose 0 (2247: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation.\n-\n----\n+---------------------------------------------------------------------------\n AttributeError                            Traceback (most recent call last)\n ...\n AttributeError: 'MPolynomialRing_polydict' object has no attribute 'monomial_divides'\n sage: \n-\n+```\n``````\n",
    "created_at": "2009-11-15T13:16:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60586",
    "user": "https://github.com/aghitza"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,13 @@
 I'm not sure if this is a problem in the multivariate polynomials (which seem to raise the actual error) or somewhere in the symbolics.
 
+```
 sage: R2.<a,b> = SR[]
 sage: I2 = [a*b+a, a*a] * R2
 sage: G2 = I2.groebner_basis()
 verbose 0 (2247: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation.
-
----
+---------------------------------------------------------------------------
 AttributeError                            Traceback (most recent call last)
 ...
 AttributeError: 'MPolynomialRing_polydict' object has no attribute 'monomial_divides'
 sage: 
-
+```
``````




---

archive/issue_comments_060587.json:
```json
{
    "body": "Changing component from algebra to commutative algebra.",
    "created_at": "2009-11-15T13:16:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60587",
    "user": "https://github.com/aghitza"
}
```

Changing component from algebra to commutative algebra.



---

archive/issue_comments_060588.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe failure is because the polynomials' parent is of type `MPolynomialRing_polydict`, but `MPolynomialRing_polydict_domain` is the type with the necessary methods `monomial_divides`, `monomial_pairwise_prime`, etc.\n\n* Should a polynomial ring in this case always initialize as `..._domain`?\n* If not, is there an easy option to create the ideal of such a ring? (in this case, at most a documentation change is necessary)\n* If no such method currently exists, what would be the best way to let the user do this?\n  a. Have the user create `R2` as above, then call a (new) function that makes it re-initialize as `..._domain`? or\n  b. Have a new creation mechanism for such rings, e.g., a symbolic ring `SD` that is a domain, and thus can be initialized as `..._domain`?",
    "created_at": "2012-01-26T20:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60588",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:2'></a>
The failure is because the polynomials' parent is of type `MPolynomialRing_polydict`, but `MPolynomialRing_polydict_domain` is the type with the necessary methods `monomial_divides`, `monomial_pairwise_prime`, etc.

* Should a polynomial ring in this case always initialize as `..._domain`?
* If not, is there an easy option to create the ideal of such a ring? (in this case, at most a documentation change is necessary)
* If no such method currently exists, what would be the best way to let the user do this?
  a. Have the user create `R2` as above, then call a (new) function that makes it re-initialize as `..._domain`? or
  b. Have a new creation mechanism for such rings, e.g., a symbolic ring `SD` that is a domain, and thus can be initialized as `..._domain`?



---

archive/issue_comments_060589.json:
```json
{
    "body": "Changing upstream from \"\" to \"N/A\"",
    "created_at": "2012-01-26T20:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60589",
    "user": "https://github.com/johnperry-math"
}
```

Changing upstream from "" to "N/A"



---

archive/issue_comments_060590.json:
```json
{
    "body": "<a id='comment:3'></a>\nI don't think GB computations over SR make sense. How do we compare with zero, e.g., this: `cos(x)^2 *X + sin(x)^2 * X - X`. How do we decide divisibility, e.g. is \"cos(x)\" zero?",
    "created_at": "2012-01-26T20:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60590",
    "user": "https://github.com/malb"
}
```

<a id='comment:3'></a>
I don't think GB computations over SR make sense. How do we compare with zero, e.g., this: `cos(x)^2 *X + sin(x)^2 * X - X`. How do we decide divisibility, e.g. is "cos(x)" zero?



---

archive/issue_comments_060591.json:
```json
{
    "body": "<a id='comment:4'></a>\nI've had situations where you can still compute a Groebner basis with some indeterminate coefficients. It's annoying to have to do all the work by hand, though. I can see implementing this with a warning that it may not make sense.",
    "created_at": "2012-01-26T21:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60591",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:4'></a>
I've had situations where you can still compute a Groebner basis with some indeterminate coefficients. It's annoying to have to do all the work by hand, though. I can see implementing this with a warning that it may not make sense.



---

archive/issue_comments_060592.json:
```json
{
    "body": "<a id='comment:5'></a>\nIf you only want symbolic variables, wouldn't this work:\n\n```\nsage: P.<a,b,c> = QQ[]\nsage: K = Frac(P)\nsage: P.<x,y> = PolynomialRing(K)\nsage: P\nMultivariate Polynomial Ring in x, y over Fraction Field of Multivariate Polynomial Ring in a, b, c over Rational Field\n```\n\nThis gets mapped to a Singular ring with parameters, i.e., to this one:\n\n```\n> ring r = (0,a,b,c),(x,y,z),dp;\n> r;\n//   characteristic : 0\n//   3 parameter    : a b c \n//   minpoly        : 0\n//   number of vars : 3\n//        block   1 : ordering dp\n//                  : names    x y z\n//        block   2 : ordering C\n```\n\nSo, this works:\n\n```\nsage: singular(P)\n//   characteristic : 0\n//   3 parameter    : a b c \n//   minpoly        : 0\n//   number of vars : 2\n//        block   1 : ordering dp\n//                  : names    x y\n//        block   2 : ordering C\nsage: I = Ideal([P.random_element(), P.random_element()])\nsage: %time gb = I.groebner_basis()\n```\n\nbut it's slow.",
    "created_at": "2012-01-26T22:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60592",
    "user": "https://github.com/malb"
}
```

<a id='comment:5'></a>
If you only want symbolic variables, wouldn't this work:

```
sage: P.<a,b,c> = QQ[]
sage: K = Frac(P)
sage: P.<x,y> = PolynomialRing(K)
sage: P
Multivariate Polynomial Ring in x, y over Fraction Field of Multivariate Polynomial Ring in a, b, c over Rational Field
```

This gets mapped to a Singular ring with parameters, i.e., to this one:

```
> ring r = (0,a,b,c),(x,y,z),dp;
> r;
//   characteristic : 0
//   3 parameter    : a b c 
//   minpoly        : 0
//   number of vars : 3
//        block   1 : ordering dp
//                  : names    x y z
//        block   2 : ordering C
```

So, this works:

```
sage: singular(P)
//   characteristic : 0
//   3 parameter    : a b c 
//   minpoly        : 0
//   number of vars : 2
//        block   1 : ordering dp
//                  : names    x y
//        block   2 : ordering C
sage: I = Ideal([P.random_element(), P.random_element()])
sage: %time gb = I.groebner_basis()
```

but it's slow.



---

archive/issue_comments_060593.json:
```json
{
    "body": "<a id='comment:6'></a>\nHere's a smaller example:\n\n```\nsage: P.<a> = QQ[]               \nsage: K = Frac(P)\nsage: P.<x,y,z> = PolynomialRing(K)\nsage: I = Ideal([P.random_element(), P.random_element(), P.random_element()])\nsage: I\nIdeal (((a^2 - 3/4*a - 1)/(a^2 + a))*y*z + ((2/3*a^2 - 5/3*a - 1)/(-9*a^2 + 5/6*a - 9/2))*z^2 + ((3/2*a^2 - a - 5/2)/(-1/20*a - 5/57))*x + ((2/3*a^2 - a - 1)/(-1/2*a^2 + 5*a + 7/4))*y + (7/3*a^2 - 5*a - 1)/(1/3*a^2 - 1/3*a + 3), ((1/2*a^2 - a - 1/2)/(-a^2 + 7))*x*y + ((-5/6*a^2 + 3*a - 1)/(-a^2 + 2/3*a - 1/4))*x*z + ((a^2 + 3/5*a + 1)/(-6*a^2 - a + 95))*y*z + ((-3*a^2 + 21/2)/(-a^2 - 1/5*a - 1))*z^2 + ((-1/3*a - 1/2)/(-1/3*a^2 - 1/8*a - 3))*z, ((a^2 + a)/(-3/2*a^2 - 1/3*a - 1))*x*y + 1/2*a*y^2 + ((1/31*a^2 - 1/8)/(-4*a^2 + 1/5*a - 2/3))*x*z + ((a^2 - a)/(a^2 - 1/20*a - 1/2))*z^2 + (-1/15*a^2 + 1/315*a + 7/15)*y) of Multivariate Polynomial Ring in x, y, z over Fraction Field of Univariate Polynomial Ring in a over Rational Field\nsage: %time gb = I.groebner_basis()\nCPU times: user 0.08 s, sys: 0.02 s, total: 0.09 s\nWall time: 0.33 s\nsage: gb[-1]\ny*z + ((-5472*a^4 + 8208*a^3 + 21888*a^2 + 8208*a)/(73872*a^4 - 62244*a^3 - 31806*a^2 - 20862*a - 36936))*z^2 + ((-2216160*a^4 - 738720*a^3 + 5171040*a^2 + 3693600*a)/(73872*a^3 + 74196*a^2 - 171072*a - 129600))*x + ((-98496*a^4 + 49248*a^3 + 295488*a^2 + 147744*a)/(73872*a^4 - 794124*a^3 + 221616*a^2 + 932634*a + 258552))*y + (517104*a^4 - 590976*a^3 - 1329696*a^2 - 221616*a)/(73872*a^4 - 129276*a^3 + 646380*a^2 - 424764*a - 664848)\n```",
    "created_at": "2012-01-26T22:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60593",
    "user": "https://github.com/malb"
}
```

<a id='comment:6'></a>
Here's a smaller example:

```
sage: P.<a> = QQ[]               
sage: K = Frac(P)
sage: P.<x,y,z> = PolynomialRing(K)
sage: I = Ideal([P.random_element(), P.random_element(), P.random_element()])
sage: I
Ideal (((a^2 - 3/4*a - 1)/(a^2 + a))*y*z + ((2/3*a^2 - 5/3*a - 1)/(-9*a^2 + 5/6*a - 9/2))*z^2 + ((3/2*a^2 - a - 5/2)/(-1/20*a - 5/57))*x + ((2/3*a^2 - a - 1)/(-1/2*a^2 + 5*a + 7/4))*y + (7/3*a^2 - 5*a - 1)/(1/3*a^2 - 1/3*a + 3), ((1/2*a^2 - a - 1/2)/(-a^2 + 7))*x*y + ((-5/6*a^2 + 3*a - 1)/(-a^2 + 2/3*a - 1/4))*x*z + ((a^2 + 3/5*a + 1)/(-6*a^2 - a + 95))*y*z + ((-3*a^2 + 21/2)/(-a^2 - 1/5*a - 1))*z^2 + ((-1/3*a - 1/2)/(-1/3*a^2 - 1/8*a - 3))*z, ((a^2 + a)/(-3/2*a^2 - 1/3*a - 1))*x*y + 1/2*a*y^2 + ((1/31*a^2 - 1/8)/(-4*a^2 + 1/5*a - 2/3))*x*z + ((a^2 - a)/(a^2 - 1/20*a - 1/2))*z^2 + (-1/15*a^2 + 1/315*a + 7/15)*y) of Multivariate Polynomial Ring in x, y, z over Fraction Field of Univariate Polynomial Ring in a over Rational Field
sage: %time gb = I.groebner_basis()
CPU times: user 0.08 s, sys: 0.02 s, total: 0.09 s
Wall time: 0.33 s
sage: gb[-1]
y*z + ((-5472*a^4 + 8208*a^3 + 21888*a^2 + 8208*a)/(73872*a^4 - 62244*a^3 - 31806*a^2 - 20862*a - 36936))*z^2 + ((-2216160*a^4 - 738720*a^3 + 5171040*a^2 + 3693600*a)/(73872*a^3 + 74196*a^2 - 171072*a - 129600))*x + ((-98496*a^4 + 49248*a^3 + 295488*a^2 + 147744*a)/(73872*a^4 - 794124*a^3 + 221616*a^2 + 932634*a + 258552))*y + (517104*a^4 - 590976*a^3 - 1329696*a^2 - 221616*a)/(73872*a^4 - 129276*a^3 + 646380*a^2 - 424764*a - 664848)
```



---

archive/issue_comments_060594.json:
```json
{
    "body": "<a id='comment:7'></a>\nWould this work when we place some assumptions on the variables; e.g., `a<sup>2+b</sup>2==1`? That was my particular situations, and I was under the impression that doing it in the way you suggest won't work for that.",
    "created_at": "2012-01-26T23:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60594",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:7'></a>
Would this work when we place some assumptions on the variables; e.g., `a<sup>2+b</sup>2==1`? That was my particular situations, and I was under the impression that doing it in the way you suggest won't work for that.



---

archive/issue_comments_060595.json:
```json
{
    "body": "<a id='comment:8'></a>\n(Sorry, I meant assumptions on the coefficients.)",
    "created_at": "2012-01-26T23:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60595",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:8'></a>
(Sorry, I meant assumptions on the coefficients.)



---

archive/issue_comments_060596.json:
```json
{
    "body": "<a id='comment:9'></a>\nThis might be naive, but can't you add `a<sup>2+b</sup>2 - 1` to your ideal?",
    "created_at": "2012-01-26T23:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60596",
    "user": "https://github.com/malb"
}
```

<a id='comment:9'></a>
This might be naive, but can't you add `a<sup>2+b</sup>2 - 1` to your ideal?



---

archive/issue_comments_060597.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [malb](#comment%3A9):\n> This might be naive, but can't you add `a<sup>2+b</sup>2 - 1` to your ideal?\n\n\nDoesn't that change the ideal? These are elements of the base ring.",
    "created_at": "2012-01-27T00:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60597",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:10'></a>
Replying to [malb](#comment%3A9):
> This might be naive, but can't you add `a<sup>2+b</sup>2 - 1` to your ideal?


Doesn't that change the ideal? These are elements of the base ring.



---

archive/issue_comments_060598.json:
```json
{
    "body": "<a id='comment:11'></a>\nHey, I got it to work.\n\n```\nsage: R.<a,b> = QQ[]\nsage: I = R.ideal(a^2+b^2-1)\nsage: R2 = QuotientRing(R,I)\nsage: K = Frac(R2)\nsage: P.<x,y,z> = K[]\nsage: f = (a^2+b^2)*x + 1\nsage: g = x + 1\nsage: f - g\n0\n```\nSorry -- I'm a bit slow sometimes. :-)\n\nOkay, so we should mark this as \"invalid/wontfix\" or something like that? Or do we wait to see if the original reporter has a scenario in mind that really does require `SR`?",
    "created_at": "2012-01-27T01:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60598",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:11'></a>
Hey, I got it to work.

```
sage: R.<a,b> = QQ[]
sage: I = R.ideal(a^2+b^2-1)
sage: R2 = QuotientRing(R,I)
sage: K = Frac(R2)
sage: P.<x,y,z> = K[]
sage: f = (a^2+b^2)*x + 1
sage: g = x + 1
sage: f - g
0
```
Sorry -- I'm a bit slow sometimes. :-)

Okay, so we should mark this as "invalid/wontfix" or something like that? Or do we wait to see if the original reporter has a scenario in mind that really does require `SR`?



---

archive/issue_comments_060599.json:
```json
{
    "body": "<a id='comment:12'></a>\nUnfortunately, your construction bombs out when we try to construct an actual ideal:\n\n```\nsage: R.<a,b> = QQ[]\nsage: I = R.ideal(a^2+b^2-1)\nsage: R2 = QuotientRing(R,I)\nsage: K = Frac(R2)\nsage: P.<x,y,z> = K[]\nsage: f = (a^2+b^2)*x + 1\nsage: g = x + 1\nsage: f - g\n0\nsage: Ideal([f,g])\nNotImplementedError\n```",
    "created_at": "2012-01-27T08:28:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60599",
    "user": "https://github.com/malb"
}
```

<a id='comment:12'></a>
Unfortunately, your construction bombs out when we try to construct an actual ideal:

```
sage: R.<a,b> = QQ[]
sage: I = R.ideal(a^2+b^2-1)
sage: R2 = QuotientRing(R,I)
sage: K = Frac(R2)
sage: P.<x,y,z> = K[]
sage: f = (a^2+b^2)*x + 1
sage: g = x + 1
sage: f - g
0
sage: Ideal([f,g])
NotImplementedError
```



---

archive/issue_comments_060600.json:
```json
{
    "body": "<a id='comment:13'></a>\nIt works (initially) if you do this:\n\n```\nsage: J = P.ideal([f,g])\n```\n...but then you can't do anything with `J`. The characteristic isn't set in `R2`. Curiously, I can still work with ideals in `R2`.\n\nLikewise,\n\n```\nsage: Z7 = QuotientRing(ZZ,7*ZZ)\nsage: Z7.characteristic()\n...\nNotImplementedError:\n```\nWow. We should probably look at that one day. `;-)`\n\nAnyway, do you know offhand why one needs the characteristic, but not the other?",
    "created_at": "2012-01-27T16:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60600",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:13'></a>
It works (initially) if you do this:

```
sage: J = P.ideal([f,g])
```
...but then you can't do anything with `J`. The characteristic isn't set in `R2`. Curiously, I can still work with ideals in `R2`.

Likewise,

```
sage: Z7 = QuotientRing(ZZ,7*ZZ)
sage: Z7.characteristic()
...
NotImplementedError:
```
Wow. We should probably look at that one day. `;-)`

Anyway, do you know offhand why one needs the characteristic, but not the other?



---

archive/issue_comments_060601.json:
```json
{
    "body": "<a id='comment:14'></a>\nNope, unfortunately, I don't.",
    "created_at": "2012-01-27T17:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60601",
    "user": "https://github.com/malb"
}
```

<a id='comment:14'></a>
Nope, unfortunately, I don't.



---

archive/issue_comments_060602.json:
```json
{
    "body": "<a id='comment:15'></a>\n> Anyway, do you know offhand why one needs the characteristic, but not the other?\n\n\nBingo. In lines 302--307 of `multi_polynomial_sequence.py` we encounter:\n\n```\n    if k.characteristic() != 2:\n        return PolynomialSequence_generic(parts, ring, immutable=immutable, cr=cr, cr_str=cr_str)\n    elif k.degree() == 1:\n        return PolynomialSequence_gf2(parts, ring, immutable=immutable, cr=cr, cr_str=cr_str)\n    elif k.degree() > 1:\n        return PolynomialSequence_gf2e(parts, ring, immutable=immutable, cr=cr, cr_str=cr_str)\n```\nI can make this work via judicious use of a `try`/`catch`. I found some other instances where it tried to compute a Singular representation of itself (the `reduce` function in `multi_polynomial_element`, for instance). That has allowed me to compute several Gr\u00f6bner bases successfully, including one similar to the ideal you couldn't get to work:\n\n```\nsage: J = R2.ideal([(a^2+b^2)*x + y, x+y])\nsage: J\nIdeal (x + y, x + y) of Multivariate Polynomial Ring in x, y over Fraction Field of\nQuotient of Multivariate Polynomial Ring in a, b over Rational Field by the ideal\n(a^2 + b^2 - 1)\nsage: J.groebner_basis()\nverbose 0 (2854: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to\nvery slow toy implementation.\n[x + y]\n```\nI think the patch is worth adding. However, I'm still not sure this is what the original requester wanted. Should I open a new ticket?",
    "created_at": "2012-01-28T05:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60602",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:15'></a>
> Anyway, do you know offhand why one needs the characteristic, but not the other?


Bingo. In lines 302--307 of `multi_polynomial_sequence.py` we encounter:

```
    if k.characteristic() != 2:
        return PolynomialSequence_generic(parts, ring, immutable=immutable, cr=cr, cr_str=cr_str)
    elif k.degree() == 1:
        return PolynomialSequence_gf2(parts, ring, immutable=immutable, cr=cr, cr_str=cr_str)
    elif k.degree() > 1:
        return PolynomialSequence_gf2e(parts, ring, immutable=immutable, cr=cr, cr_str=cr_str)
```
I can make this work via judicious use of a `try`/`catch`. I found some other instances where it tried to compute a Singular representation of itself (the `reduce` function in `multi_polynomial_element`, for instance). That has allowed me to compute several Gröbner bases successfully, including one similar to the ideal you couldn't get to work:

```
sage: J = R2.ideal([(a^2+b^2)*x + y, x+y])
sage: J
Ideal (x + y, x + y) of Multivariate Polynomial Ring in x, y over Fraction Field of
Quotient of Multivariate Polynomial Ring in a, b over Rational Field by the ideal
(a^2 + b^2 - 1)
sage: J.groebner_basis()
verbose 0 (2854: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to
very slow toy implementation.
[x + y]
```
I think the patch is worth adding. However, I'm still not sure this is what the original requester wanted. Should I open a new ticket?



---

archive/issue_comments_060603.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-02-02T01:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60603",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_060604.json:
```json
{
    "body": "<a id='comment:16'></a>\nI decided to upload the patch here. I didn't think a doctest was appropriate, but I can add one if desired.",
    "created_at": "2012-02-02T01:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60604",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:16'></a>
I decided to upload the patch here. I didn't think a doctest was appropriate, but I can add one if desired.



---

archive/issue_comments_060605.json:
```json
{
    "body": "<a id='comment:17'></a>\nWhoops -- the patch introduces doctest failures. I'll look into them.",
    "created_at": "2012-02-02T01:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60605",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:17'></a>
Whoops -- the patch introduces doctest failures. I'll look into them.



---

archive/issue_comments_060606.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-02-02T01:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60606",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_060607.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,3 +11,7 @@\n AttributeError: 'MPolynomialRing_polydict' object has no attribute 'monomial_divides'\n sage: \n ```\n+\n+**Apply:**\n+\n+    `trac_6581_enable_more_ideals_for_toy_buchberger.2.patch`\n``````\n",
    "created_at": "2012-02-02T02:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60607",
    "user": "https://github.com/johnperry-math"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,3 +11,7 @@
 AttributeError: 'MPolynomialRing_polydict' object has no attribute 'monomial_divides'
 sage: 
 ```
+
+**Apply:**
+
+    `trac_6581_enable_more_ideals_for_toy_buchberger.2.patch`
``````




---

archive/issue_comments_060608.json:
```json
{
    "body": "<a id='comment:18'></a>\nOkay, that was pretty dumb. Fixed now. Added a doctest while I was at it.",
    "created_at": "2012-02-02T02:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60608",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:18'></a>
Okay, that was pretty dumb. Fixed now. Added a doctest while I was at it.



---

archive/issue_comments_060609.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-02-02T02:03:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60609",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_060610.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,4 @@\n \n **Apply:**\n \n-    `trac_6581_enable_more_ideals_for_toy_buchberger.2.patch`\n+    [attachment:trac_6581_enable_more_ideals_for_toy_buchberger.2.patch]\n``````\n",
    "created_at": "2012-02-02T10:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60610",
    "user": "https://github.com/malb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,4 @@
 
 **Apply:**
 
-    `trac_6581_enable_more_ideals_for_toy_buchberger.2.patch`
+    [attachment:trac_6581_enable_more_ideals_for_toy_buchberger.2.patch]
``````




---

archive/issue_comments_060611.json:
```json
{
    "body": "Changing author from \"\" to \"John Perry\"",
    "created_at": "2012-02-02T10:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60611",
    "user": "https://github.com/malb"
}
```

Changing author from "" to "John Perry"



---

archive/issue_comments_060612.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-02-02T10:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60612",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_060613.json:
```json
{
    "body": "<a id='comment:19'></a>\nLooks good.",
    "created_at": "2012-02-02T10:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60613",
    "user": "https://github.com/malb"
}
```

<a id='comment:19'></a>
Looks good.



---

archive/issue_comments_060614.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Martin Albrecht\"",
    "created_at": "2012-02-02T10:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60614",
    "user": "https://github.com/malb"
}
```

Changing reviewer from "" to "Martin Albrecht"



---

archive/issue_comments_060615.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-02-05T11:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60615",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_060616.json:
```json
{
    "body": "<a id='comment:20'></a>\nYou should replace the line number in\n\n```\nverbose 0 (2854: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation\n```\nby \"...\" because the line number will change all the time.",
    "created_at": "2012-02-05T11:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60616",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
You should replace the line number in

```
verbose 0 (2854: multi_polynomial_ideal.py, groebner_basis) Warning: falling back to very slow toy implementation
```
by "..." because the line number will change all the time.



---

archive/issue_comments_060617.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-02-07T17:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60617",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_060618.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,4 +14,4 @@\n \n **Apply:**\n \n-    [attachment:trac_6581_enable_more_ideals_for_toy_buchberger.2.patch]\n+    [attachment:trac_6581_enable_more_ideals_for_toy_buchberger.patch]\n``````\n",
    "created_at": "2012-02-07T17:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60618",
    "user": "https://github.com/johnperry-math"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,4 +14,4 @@
 
 **Apply:**
 
-    [attachment:trac_6581_enable_more_ideals_for_toy_buchberger.2.patch]
+    [attachment:trac_6581_enable_more_ideals_for_toy_buchberger.patch]
``````




---

archive/issue_comments_060619.json:
```json
{
    "body": "<a id='comment:21'></a>\nSorry, I should have thought of that myself.\n\nI remembered this time to check the box to replace the file of the same name, so I've changed the directions (& link) on which patch to apply.",
    "created_at": "2012-02-07T17:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60619",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:21'></a>
Sorry, I should have thought of that myself.

I remembered this time to check the box to replace the file of the same name, so I've changed the directions (& link) on which patch to apply.



---

archive/issue_comments_060620.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-02-07T21:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60620",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_060621.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-02-11T00:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60621",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_060622.json:
```json
{
    "body": "<a id='comment:23'></a>\nPlease write a proper commit message for your patch, use `hg qrefresh -e` for this.",
    "created_at": "2012-02-11T00:29:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60622",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
Please write a proper commit message for your patch, use `hg qrefresh -e` for this.



---

archive/issue_comments_060623.json:
```json
{
    "body": "Attachment [trac_6581_enable_more_ideals_for_toy_buchberger.patch](tarball://root/attachments/some-uuid/ticket6581/trac_6581_enable_more_ideals_for_toy_buchberger.patch) by @johnperry-math created at 2012-02-11 15:23:15",
    "created_at": "2012-02-11T15:23:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60623",
    "user": "https://github.com/johnperry-math"
}
```

Attachment [trac_6581_enable_more_ideals_for_toy_buchberger.patch](tarball://root/attachments/some-uuid/ticket6581/trac_6581_enable_more_ideals_for_toy_buchberger.patch) by @johnperry-math created at 2012-02-11 15:23:15



---

archive/issue_comments_060624.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-02-11T15:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60624",
    "user": "https://github.com/johnperry-math"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_060625.json:
```json
{
    "body": "<a id='comment:24'></a>\nI should have thought of that, too. Sorry again...",
    "created_at": "2012-02-11T15:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60625",
    "user": "https://github.com/johnperry-math"
}
```

<a id='comment:24'></a>
I should have thought of that, too. Sorry again...



---

archive/issue_comments_060626.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-02-11T23:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60626",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_015522.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-14T14:19:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/6581#event-15522"
}
```



---

archive/issue_comments_060627.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.0.beta4\"",
    "created_at": "2012-02-14T14:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60627",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.0.beta4"



---

archive/issue_comments_060628.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-02-14T14:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/6581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/6581#issuecomment-60628",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
