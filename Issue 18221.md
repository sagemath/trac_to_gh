# Issue 18221: Upgrade latte_int (LattE integrale) package to version 1.7.3 for improved error reporting

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2015-05-19 22:31:46

CC:  chapoton bedutra vbraun ncohen vdelecroix dimpase

As I promised in the discussion of #18211,
we have made a new release of LattE, which gives an nonzero exit code on errors (this was a regression).

The package should be upgraded (https://www.math.ucdavis.edu/~latte/software.php),
and I suppose the code of sage.geometry.polyhedron.Polyhedron_ZZ::ehrhart_polynomial which worked around this could now be cleaned up.


---

Comment by mkoeppe created at 2015-05-20 00:43:51

I also note that the spkg-check of the current latte_int spkg fails. 

I think this is because the latte_int package, whose upstream tarball is called latte-int-VERSION.tar.gz unpacks to a directory called latte-int-VERSION; but sage-spkg seems to expect the source in latte_int-VERSION.


---

Comment by chapoton created at 2015-05-22 12:12:19

Changing keywords from "" to "latte".


---

Comment by chapoton created at 2015-05-22 12:12:19

New commits:


---

Comment by mkoeppe created at 2015-05-22 13:20:20

Replying to [comment:2 chapoton]:
> New commits:
> ||[a6c54a2](http://git.sagemath.org/sage.git/commit/?id=a6c54a25fec95e917b2ce2f94236e5047daea0b3)||`trac #18458 updating latte_int spkg`||

Your change to cd into directory latte-integrale suggests that you grabbed the wrong package. You need the package latte-int-1.7.3.tar.gz from https://www.math.ucdavis.edu/~latte/software/packages/latte_current/


---

Comment by git created at 2015-05-22 14:37:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-05-22 14:39:31

Ok, I redid the job for the correct spkg. I am now checking if it builds.


---

Comment by chapoton created at 2015-05-22 14:47:37

It seems that using the bad spkg has broken my sage..


---

Comment by dimpase created at 2015-05-22 14:58:00

Replying to [comment:6 chapoton]:
> It seems that using the bad spkg has broken my sage..

that's cause the full tarball packages some stuff that is also in sage...


---

Comment by chapoton created at 2015-05-22 15:01:33

Too bad. I am therefore not able to test now if the skpg works..


---

Comment by dimpase created at 2015-05-22 15:14:38

it builds, but `spkg-check` fails, i.e, running

```
$ SAGE_CHECK=yes ./sage -f latte_int
```

gives


```
...
make[2]: Leaving directory `/home/scratch/dimpase/sage/sage6.7/local/var/tmp/sage/build/latte_int-1.7.3/latte-int-1.7.3'
make[1]: Leaving directory `/home/scratch/dimpase/sage/sage6.7/local/var/tmp/sage/build/latte_int-1.7.3/latte-int-1.7.3'

real    0m10.385s
user    0m5.929s
sys     0m5.269s
Successfully installed latte_int-1.7.3
Running the test suite for latte_int-1.7.3...
Testing in /home/scratch/dimpase/sage/sage6.7/local/var/tmp/sage/build/latte_int-1.7.3/src
./spkg-check: line 21: cd: /home/scratch/dimpase/sage/sage6.7/local/var/tmp/sage/build/latte_int-1.7.3/src: No such file or directory
make: *** No rule to make target `check'.  Stop.
Error: tests failed
```

The working directory is not  `local/var/tmp/sage/build/latte_int-1.7.3/src`, but 
`local/var/tmp/sage/build/latte_int-1.7.3/latte-int-1.7.3`, which is probably due to that `latte-int` vs `latte_int` thing... 

The fix is on its way.


---

Comment by git created at 2015-05-22 15:15:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2015-05-22 15:17:25

please feel free to set it to positive review if you're OK with my change in the last commit.


---

Comment by mkoeppe created at 2015-05-22 17:42:26

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2015-05-22 17:42:43

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-05-23 19:53:41

Resolution: fixed


---

Comment by jdemeyer created at 2015-06-06 09:26:39

FYI: doctests don't pass, so the package was moved to experimental.
