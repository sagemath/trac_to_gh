# Issue 31583: Fix pickling of normaliz representation objects

Issue created by migration from https://trac.sagemath.org/ticket/31820

Original creator: @kliem

Original creation time: 2021-05-12 13:48:07

CC:  jipilab mkoeppe vbraun

The normaliz cone is recreated after loading a saved normaliz polyhedron. Unfortunatly, it is recreated from the representation objects and not from the corresponding vectors. This leads to circular dependencies that are not always successfully resolved:


```
sage: P = polytopes.cube(backend='normaliz')                                    
sage: v = P.Vrepresentation()[0]                                                
sage: v1 = loads(v.dumps())                                                     
Traceback (most recent call last)
...
~/Applications/sage/local/lib/python3.8/site-packages/sage/geometry/polyhedron/representation.py in __getitem__(self, i)
     83             2
     84         """
---> 85         return self._vector[i]
     86 
     87     def __hash__(self):

AttributeError: 'Vertex' object has no attribute '_vector'
```


We fix this by initialization of the cone from the vectors instead.


---

Comment by @kliem created at 2021-05-12 13:51:59

Changing status from new to needs_review.


---

Comment by @kliem created at 2021-05-12 13:51:59

New commits:


---

Comment by @kliem created at 2021-05-12 13:51:59

Changing keywords from "" to "normaliz, pickling".


---

Comment by mkoeppe created at 2021-05-12 15:07:18

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2021-05-12 20:58:50

Thank you.


---

Comment by mkoeppe created at 2021-07-24 18:57:02

Apparently this was merged as part of #31821.


---

Comment by mkoeppe created at 2021-07-24 18:57:02

Resolution: fixed
