# Issue 33384: fix "if"

Issue created by migration from https://trac.sagemath.org/ticket/33621

Original creator: lorenz

Original creation time: 2022-04-01 08:45:36

Sage's mathematical audience has long been plagued by the terrifying ambiguity of the recklessly named `if` keyword we've inherited from Python in an unfortunate series of events.

Here's an example of what I mean:

```python
if 0 == 1:
    set_computer_on_fire()
```


Apparently, there exist plenty of programmers who foolishly assume this code snippet to be completely harmless, arguing that the `if` branch will never be taken.

But can we be so sure? Nothing about this syntax even _suggests_ that the `set_computer_on_fire()` call cannot occur _despite_ the premise of the `if` being false; after all, `A ⇒ B` is widely known not to imply `¬A ⇒ ¬B`.

The good news is that we can easily fix this shortcoming and finally clarify the exact semantics of conditional branching in Sage by making use of the existing preparsing infrastructure.

Thus, without further ado, here's the same example as above, but after my patch:

```python
if and only if 0 == 1:
    set_computer_on_fire()
```


For users who prefer something less verbose, the shorthand `iff` is also supported:

```python
iff 0 == 1:
    set_computer_on_fire()
```


Moreover, we deprecate the support of `if` to prevent any further confusion caused by this design flaw.


---

Comment by lorenz created at 2022-04-01 08:46:39

This should be a no-brainer; I guess the only drawback is that some documentation will need updating...


---

Comment by lorenz created at 2022-04-01 08:46:39

Changing status from new to needs_review.


---

Comment by dimpase created at 2022-04-01 09:37:22

please, please, report this upstream! the whole Python universe might be crashing anytime without your fix...


---

Comment by tmonteil created at 2022-04-01 09:45:42

Let me update its priority to critical.


---

Comment by tmonteil created at 2022-04-01 09:45:42

Changing priority from major to critical.


---

Comment by @GMS103 created at 2022-04-01 09:50:17

I am not sure this covers all the cases.

What if just before one has `assume(1 == 0)`?


---

Comment by cremona created at 2022-04-01 10:15:18

Has no-one else noticed today's date?


---

Comment by cremona created at 2022-04-01 10:16:18

Which year was it when William announced that he was about to start converting all Sage code into Lisp?


---

Comment by nbruin created at 2022-04-01 14:58:22

We would need to take care of Python's conditional expression as well. Perhaps

```
a = 4a+1 only when a%1 !=0 and a//2 otherwise
```

Python has recently acquired a more powerful parser that can probably handle this. We'd have to carefully balance the binding affinity of the `otherwise` postfix part with the precedence of the `and` infix operator, though.


---

Comment by tmonteil created at 2022-04-01 15:27:00

As there might be no confusion with tuples, and since some PEP8-addict reviewers are typographically pretty picky, we could accept the use of `if, and only if,`, which would allow:


```
if, and only if, 0 == 1:
    set_computer_on_fire()
otherwise:
    set_computer_on_ice()
```


Such an enhancement could be part of a follow-up ticket.


---

Comment by slelievre created at 2022-04-02 09:24:08

Replying to [comment:6 cremona]:
> Which year was it when William announced that he was about to start converting all Sage code into Lisp?

That was 2009-04-01:

- https://groups.google.com/g/sage-devel/c/cBDQKchTP6g/m/ZmTbqdqxt1QJ


---

Comment by charpent created at 2022-04-02 11:00:50

Hmmmm...

What would happen if we implemented (at least !) Maxima's thee-valued logic `true`, `false`, `unknown`), shouldn't `iff` treat `unknown` in a way different from `if`'s ?

If so, which ?


---

Comment by @DaveWitteMorris created at 2022-04-02 15:47:11

Changing priority from critical to trivial.


---

Comment by @DaveWitteMorris created at 2022-04-02 15:47:11

I believe this was a joke for [April Fools' Day](https://en.wikipedia.org/wiki/April_Fools'_Day). Since the date is no longer April 1, I think we can close it as invalid.


---

Comment by klee created at 2022-04-05 00:40:25

Yes. It served its purpose. I read more than half of the ticket description seriously with increasing perplexity, just to realize that this is another "Lisp" :)


---

Comment by klee created at 2022-04-05 00:40:25

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2022-04-05 22:26:50

Resolution: wontfix
