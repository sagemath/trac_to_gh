# Issue 10944: Bad shell logic in root-spkg-install

Issue created by migration from https://trac.sagemath.org/ticket/11052

Original creator: jdemeyer

Original creation time: 2011-03-26 19:52:33

CC:  vbraun

Keywords: sage_root

The following piece of `root-spkg-install` doesn't work as intented, because the `$?` refers to the exit status of the first `if` instead of `hg incoming`:

```
    # Merge the repository, rather than overwrite changes that the
    # user may have made.
    hg incoming "$CUR" 1> /dev/null
    if [ $? -eq 1 ]; then
        # No changes to pull
        exit 0
    fi
    if [ $? -ne 0 ]; then
        echo "Error with Sage root repository: 'hg incoming' failed."
        exit 1
    fi
```



---

Attachment


---

Comment by jdemeyer created at 2011-03-26 19:55:48

Changing status from new to needs_review.


---

Comment by vbraun created at 2011-03-28 17:25:21

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2011-03-28 17:25:21

Good catch!


---

Comment by jdemeyer created at 2011-03-28 19:26:07

Resolution: fixed


---

Comment by jdemeyer created at 2011-03-28 19:26:07

Thanks Volker.
