# Issue 15960: provide function expansions of power series (from Pari)

archive/issues_015960.json:
```json
{
    "body": "Keywords: function, series expansion\n\nNot the same as `SR.taylor()`.\n\n```\nsage: R.<x> = PowerSeriesRing(ZZ)\nsage: sqrt(1-4*x^2)\n1 - 2*x^2 - 2*x^4 - 4*x^6 - 10*x^8 - 28*x^10 - 84*x^12 - 264*x^14 - 858*x^16 - 2860*x^18 + O(x^20)\nsage: sin(1+4*x^2)\n...\nTypeError: cannot coerce arguments: no canonical coercion from Power Series Ring in x over Integer Ring to Symbolic Ring\nsage: var('X')\nX\nsage: ex=sin(1+4*X^2)\nsage: ex.series()\n...\nTypeError: series() takes exactly 2 positional arguments (0 given)\n```\n\nWhat is missing and can be had from Pari:\n* `acos`, `acosh`, `agm`, `asin`, `asinh`, `atan`, `atanh`, `cos`, `cosh`, `cotanh`, `dilog`, `gamma`, `intformal`, `lngamma`, `psi`, `sin`, `sinh`, `tan`, `tanh`\nFor example:\n\n```\n? atan(4*x^2+1)\n%1 = 0.78539816339744830961566084581987572105 + 2*x^2 - 4*x^4 + 16/3*x^6 - 128/5*x^10 + 256/3*x^12 - 1024/7*x^14 + O(x^16)\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16197\n\n",
    "created_at": "2014-04-21T15:00:39Z",
    "labels": [
        "component: calculus"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "provide function expansions of power series (from Pari)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15960",
    "user": "https://github.com/rwst"
}
```
Keywords: function, series expansion

Not the same as `SR.taylor()`.

```
sage: R.<x> = PowerSeriesRing(ZZ)
sage: sqrt(1-4*x^2)
1 - 2*x^2 - 2*x^4 - 4*x^6 - 10*x^8 - 28*x^10 - 84*x^12 - 264*x^14 - 858*x^16 - 2860*x^18 + O(x^20)
sage: sin(1+4*x^2)
...
TypeError: cannot coerce arguments: no canonical coercion from Power Series Ring in x over Integer Ring to Symbolic Ring
sage: var('X')
X
sage: ex=sin(1+4*X^2)
sage: ex.series()
...
TypeError: series() takes exactly 2 positional arguments (0 given)
```

What is missing and can be had from Pari:
* `acos`, `acosh`, `agm`, `asin`, `asinh`, `atan`, `atanh`, `cos`, `cosh`, `cotanh`, `dilog`, `gamma`, `intformal`, `lngamma`, `psi`, `sin`, `sinh`, `tan`, `tanh`
For example:

```
? atan(4*x^2+1)
%1 = 0.78539816339744830961566084581987572105 + 2*x^2 - 4*x^4 + 16/3*x^6 - 128/5*x^10 + 256/3*x^12 - 1024/7*x^14 + O(x^16)
```


Issue created by migration from https://trac.sagemath.org/ticket/16197





---

archive/issue_comments_206846.json:
```json
{
    "body": "Similarly to my other comment on this, I don't know if we want `n(pi/4)` in here or not...\n\nAlso, the regular `SR` one works fine:\n\n```\nsage: ex.series(X,16)\n(sin(1)) + (4*cos(1))*X^2 + (-8*sin(1))*X^4 + (-32/3*cos(1))*X^6 + (32/3*sin(1))*X^8 + (128/15*cos(1))*X^10 + (-256/45*sin(1))*X^12 + (-1024/315*cos(1))*X^14 + Order(X^16)\n```\n\nso I'm not sure why you referenced it, though I agree that the error you get for power series rings is not ideal.   Is there a way to either use SR for this (perhaps not \"correct\" for power series rings though?) or to get Pari to return a symbolic constant term?\n\n```\nsage: atan(4*X^2+1)\narctan(4*X^2 + 1)\nsage: _.series(X,16)\n(1/4*pi) + 2*X^2 + (-4)*X^4 + 16/3*X^6 + (-128/5)*X^10 + 256/3*X^12 + (-1024/7)*X^14 + Order(X^16)\n```\n\nWhat if the coefficients weren't rationals?  Or integers?  Note that in your example there is a 16/3 coefficient, which presumably isn't in the power series ring over integers.  These may be dumb questions, but I'm just trying to explore what is really the desired behavior - certainly wrapping more Pari stuff is not a bad idea!",
    "created_at": "2014-04-21T15:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206846",
    "user": "https://github.com/kcrisman"
}
```

Similarly to my other comment on this, I don't know if we want `n(pi/4)` in here or not...

Also, the regular `SR` one works fine:

```
sage: ex.series(X,16)
(sin(1)) + (4*cos(1))*X^2 + (-8*sin(1))*X^4 + (-32/3*cos(1))*X^6 + (32/3*sin(1))*X^8 + (128/15*cos(1))*X^10 + (-256/45*sin(1))*X^12 + (-1024/315*cos(1))*X^14 + Order(X^16)
```

so I'm not sure why you referenced it, though I agree that the error you get for power series rings is not ideal.   Is there a way to either use SR for this (perhaps not "correct" for power series rings though?) or to get Pari to return a symbolic constant term?

```
sage: atan(4*X^2+1)
arctan(4*X^2 + 1)
sage: _.series(X,16)
(1/4*pi) + 2*X^2 + (-4)*X^4 + 16/3*X^6 + (-128/5)*X^10 + 256/3*X^12 + (-1024/7)*X^14 + Order(X^16)
```

What if the coefficients weren't rationals?  Or integers?  Note that in your example there is a 16/3 coefficient, which presumably isn't in the power series ring over integers.  These may be dumb questions, but I'm just trying to explore what is really the desired behavior - certainly wrapping more Pari stuff is not a bad idea!



---

archive/issue_comments_206847.json:
```json
{
    "body": "Pari's symblic is not up to this. I'd consider it a bug that there is no default precision to SR series results (like with `PowerSeries`), so yes, if your last example would work without the `16` this ticket would rather be about my example `sin(1+4*x^2)`---it should simply work like `series()` and give back one instead of SR.\n\nThe rest of the ticket concerns possibly missing functions and I will move this to another ticket.",
    "created_at": "2014-04-21T16:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206847",
    "user": "https://github.com/rwst"
}
```

Pari's symblic is not up to this. I'd consider it a bug that there is no default precision to SR series results (like with `PowerSeries`), so yes, if your last example would work without the `16` this ticket would rather be about my example `sin(1+4*x^2)`---it should simply work like `series()` and give back one instead of SR.

The rest of the ticket concerns possibly missing functions and I will move this to another ticket.



---

archive/issue_comments_206848.json:
```json
{
    "body": "> Pari's symblic is not up to this. I'd consider it a bug that there is no default precision to SR series results (like with `PowerSeries`), so yes, if your last example would work without the `16` this ticket would rather be about my example `sin(1+4*x^2)`---it should simply work like `series()` and give back one instead of SR.\nHmm, that's an interesting suggestion.  One could imagine it's a bug the other way around, but I have no vested interest in this - I think a default for either one could be useful, in principle, and (importantly) wouldn't be backward-incompatible.   But what would the default be?  It's hard to imagine one non-arbitrary... hmm.  What do Mathematica and/or Maple and/or Magma do with this?  If there is a standard one could use that.",
    "created_at": "2014-04-22T00:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206848",
    "user": "https://github.com/kcrisman"
}
```

> Pari's symblic is not up to this. I'd consider it a bug that there is no default precision to SR series results (like with `PowerSeries`), so yes, if your last example would work without the `16` this ticket would rather be about my example `sin(1+4*x^2)`---it should simply work like `series()` and give back one instead of SR.
Hmm, that's an interesting suggestion.  One could imagine it's a bug the other way around, but I have no vested interest in this - I think a default for either one could be useful, in principle, and (importantly) wouldn't be backward-incompatible.   But what would the default be?  It's hard to imagine one non-arbitrary... hmm.  What do Mathematica and/or Maple and/or Magma do with this?  If there is a standard one could use that.



---

archive/issue_comments_206849.json:
```json
{
    "body": "I wrote earlier:\n> The rest of the ticket concerns possibly missing functions and I will move this to another ticket.\nNothing missing there except the a.g.m., fortunately.\n\nReplying to [comment:3 kcrisman]:\n> Hmm, that's an interesting suggestion.  One could imagine it's a bug the other way around, but I have no vested interest in this - I think a default for either one could be useful, in principle, and (importantly) wouldn't be backward-incompatible.   But what would the default be?  It's hard to imagine one non-arbitrary... hmm.\nThis is now #16201\n> What do Mathematica and/or Maple and/or Magma do with this?  If there is a standard one could use that.\nIf I ask for \"cosine power series\" in Wolfram Alpha I get `1-x<sup>2/2+x</sup>4/24-x<sup>6/720+O(x</sup>7)`",
    "created_at": "2014-04-22T06:48:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206849",
    "user": "https://github.com/rwst"
}
```

I wrote earlier:
> The rest of the ticket concerns possibly missing functions and I will move this to another ticket.
Nothing missing there except the a.g.m., fortunately.

Replying to [comment:3 kcrisman]:
> Hmm, that's an interesting suggestion.  One could imagine it's a bug the other way around, but I have no vested interest in this - I think a default for either one could be useful, in principle, and (importantly) wouldn't be backward-incompatible.   But what would the default be?  It's hard to imagine one non-arbitrary... hmm.
This is now #16201
> What do Mathematica and/or Maple and/or Magma do with this?  If there is a standard one could use that.
If I ask for "cosine power series" in Wolfram Alpha I get `1-x<sup>2/2+x</sup>4/24-x<sup>6/720+O(x</sup>7)`



---

archive/issue_comments_206850.json:
```json
{
    "body": "Edit: my copy of another comment was unrelated so I deleted it",
    "created_at": "2014-04-22T16:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206850",
    "user": "https://github.com/rwst"
}
```

Edit: my copy of another comment was unrelated so I deleted it



---

archive/issue_comments_206851.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-20T09:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206851",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_206852.json:
```json
{
    "body": "Closing as wontfix since all issues mentioned have their own tickets.",
    "created_at": "2014-07-20T09:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206852",
    "user": "https://github.com/rwst"
}
```

Closing as wontfix since all issues mentioned have their own tickets.



---

archive/issue_comments_206853.json:
```json
{
    "body": "I only see one ticket mentioned.  Just for completeness, can you mention them (if there are others)?",
    "created_at": "2014-07-21T13:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206853",
    "user": "https://github.com/kcrisman"
}
```

I only see one ticket mentioned.  Just for completeness, can you mention them (if there are others)?



---

archive/issue_comments_206854.json:
```json
{
    "body": "Default symbolic expression series precision is #16201, and symbolic agm function is #16202.",
    "created_at": "2014-07-21T13:46:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206854",
    "user": "https://github.com/rwst"
}
```

Default symbolic expression series precision is #16201, and symbolic agm function is #16202.



---

archive/issue_comments_206855.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-21T13:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206855",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_015537.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2014-07-21T17:43:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15960#event-15537"
}
```



---

archive/issue_comments_206856.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2014-07-21T17:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15960",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15960#issuecomment-206856",
    "user": "https://github.com/vbraun"
}
```

Resolution: duplicate
