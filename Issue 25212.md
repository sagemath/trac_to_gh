# Issue 25212: Converting IntegerMod_int64 to IntegerMod_int

Issue created by migration from https://trac.sagemath.org/ticket/25449

Original creator: swewers

Original creation time: 2018-05-27 14:16:47

CC:  saraedum

The following code fails:

    sage: k = GF(55667)

    sage: F.<x> = FunctionField(k)

    sage: F._ring(x)(x)

    TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int


---

Comment by saraedum created at 2018-05-27 19:40:10

Changing type from PLEASE CHANGE to defect.


---

Comment by saraedum created at 2018-05-27 19:40:10

Changing component from PLEASE CHANGE to commutative algebra.


---

Comment by saraedum created at 2018-05-27 20:50:42

New commits:


---

Comment by saraedum created at 2018-05-27 20:51:42

Changing status from new to needs_review.


---

Comment by saraedum created at 2018-05-27 20:51:42

I have not run doctests. Let's see what the patchbots say.


---

Comment by git created at 2018-05-28 13:12:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-06-11 07:49:23

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-06-11 16:50:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-06-11 16:50:47

New commits:


---

Comment by saraedum created at 2018-06-11 16:50:47

Changing status from needs_work to needs_review.


---

Comment by sbrandhorst created at 2018-07-03 20:29:51

The patchbot complains that we are importing additional modules at start up. This is probably happening here:

```
+        from sage.rings.fraction_field_FpT import FpT
+        if p != 0 and R.is_prime_field() and 2 < p and p < FpT.INTEGER_LIMIT:
```

You could try to use a lazy_import instead?

Otherwise the code looks perfectly reasonable.


---

Comment by git created at 2018-07-04 15:55:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-07-04 15:56:21

I don't like lazy imports, so I just put the import into a nested if. It would be great if you could have another look now :)


---

Comment by sbrandhorst created at 2018-07-04 15:59:28

The patchbot also complains about:

```
File "src/sage/rings/polynomial/polynomial_ring.py", line 2187, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.fraction_field
Failed example:
    t(x)
Expected nothing
Got:
    x
```

Could that be related?


---

Comment by sbrandhorst created at 2018-07-04 18:51:43

Changing status from needs_review to needs_work.


---

Comment by sbrandhorst created at 2018-07-04 18:51:43

It is not working.

```
sage: k = GF(55667)
sage: F.<x> = FunctionField(k)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
...

AttributeError: 'NoneType' object has no attribute 'category'
```



---

Comment by sbrandhorst created at 2018-07-04 19:16:32

Ok the reason for some of the doctest failures on my machine (any maybe the patchbot)
is that

your extra if clause messes up the else clause. 
And there is an x after sage: t(x) missing .


---

Comment by git created at 2018-07-07 23:09:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2018-07-07 23:12:28

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2018-07-07 23:12:28

Thanks for having a look and sorry for that stupid error.


---

Comment by sbrandhorst created at 2018-07-13 19:31:27

The last bot has some failures. But I think they are unrelated. I kicked the patchbot. Lets see if the next one is green. Then I am definitely happy.


---

Comment by swewers created at 2018-07-21 07:55:31

Changing status from needs_review to positive_review.


---

Comment by swewers created at 2018-07-21 07:55:31

The patchbot is happy now.


---

Comment by vbraun created at 2018-08-05 08:18:12

Resolution: fixed
