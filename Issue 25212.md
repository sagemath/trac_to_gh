# Issue 25212: Converting IntegerMod_int64 to IntegerMod_int

archive/issues_025212.json:
```json
{
    "body": "CC:  saraedum\n\nThe following code fails:\n\n    sage: k = GF(55667)\n\n    sage: F.<x> = FunctionField(k)\n\n    sage: F._ring(x)(x)\n\n    TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int\n\nIssue created by migration from https://trac.sagemath.org/ticket/25449\n\n",
    "created_at": "2018-05-27T14:16:47Z",
    "labels": [
        "PLEASE CHANGE",
        "major"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Converting IntegerMod_int64 to IntegerMod_int",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25212",
    "user": "swewers"
}
```
CC:  saraedum

The following code fails:

    sage: k = GF(55667)

    sage: F.<x> = FunctionField(k)

    sage: F._ring(x)(x)

    TypeError: Cannot convert sage.rings.finite_rings.integer_mod.IntegerMod_int64 to sage.rings.finite_rings.integer_mod.IntegerMod_int

Issue created by migration from https://trac.sagemath.org/ticket/25449





---

archive/issue_comments_355153.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2018-05-27T19:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355153",
    "user": "saraedum"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_355154.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to commutative algebra.",
    "created_at": "2018-05-27T19:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355154",
    "user": "saraedum"
}
```

Changing component from PLEASE CHANGE to commutative algebra.



---

archive/issue_comments_355155.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-05-27T20:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355155",
    "user": "saraedum"
}
```

New commits:



---

archive/issue_comments_355156.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-27T20:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355156",
    "user": "saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_355157.json:
```json
{
    "body": "I have not run doctests. Let's see what the patchbots say.",
    "created_at": "2018-05-27T20:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355157",
    "user": "saraedum"
}
```

I have not run doctests. Let's see what the patchbots say.



---

archive/issue_comments_355158.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-05-28T13:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355158",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355159.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-06-11T07:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355159",
    "user": "saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_355160.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-11T16:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355160",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355161.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-06-11T16:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355161",
    "user": "saraedum"
}
```

New commits:



---

archive/issue_comments_355162.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-06-11T16:50:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355162",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_355163.json:
```json
{
    "body": "The patchbot complains that we are importing additional modules at start up. This is probably happening here:\n\n```\n+        from sage.rings.fraction_field_FpT import FpT\n+        if p != 0 and R.is_prime_field() and 2 < p and p < FpT.INTEGER_LIMIT:\n```\n\nYou could try to use a lazy_import instead?\n\nOtherwise the code looks perfectly reasonable.",
    "created_at": "2018-07-03T20:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355163",
    "user": "sbrandhorst"
}
```

The patchbot complains that we are importing additional modules at start up. This is probably happening here:

```
+        from sage.rings.fraction_field_FpT import FpT
+        if p != 0 and R.is_prime_field() and 2 < p and p < FpT.INTEGER_LIMIT:
```

You could try to use a lazy_import instead?

Otherwise the code looks perfectly reasonable.



---

archive/issue_comments_355164.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-04T15:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355164",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355165.json:
```json
{
    "body": "I don't like lazy imports, so I just put the import into a nested if. It would be great if you could have another look now :)",
    "created_at": "2018-07-04T15:56:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355165",
    "user": "saraedum"
}
```

I don't like lazy imports, so I just put the import into a nested if. It would be great if you could have another look now :)



---

archive/issue_comments_355166.json:
```json
{
    "body": "The patchbot also complains about:\n\n```\nFile \"src/sage/rings/polynomial/polynomial_ring.py\", line 2187, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.fraction_field\nFailed example:\n    t(x)\nExpected nothing\nGot:\n    x\n```\n\nCould that be related?",
    "created_at": "2018-07-04T15:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355166",
    "user": "sbrandhorst"
}
```

The patchbot also complains about:

```
File "src/sage/rings/polynomial/polynomial_ring.py", line 2187, in sage.rings.polynomial.polynomial_ring.PolynomialRing_commutative.fraction_field
Failed example:
    t(x)
Expected nothing
Got:
    x
```

Could that be related?



---

archive/issue_comments_355167.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-04T18:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355167",
    "user": "sbrandhorst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_355168.json:
```json
{
    "body": "It is not working.\n\n```\nsage: k = GF(55667)\nsage: F.<x> = FunctionField(k)\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n...\n\nAttributeError: 'NoneType' object has no attribute 'category'\n```\n",
    "created_at": "2018-07-04T18:51:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355168",
    "user": "sbrandhorst"
}
```

It is not working.

```
sage: k = GF(55667)
sage: F.<x> = FunctionField(k)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
...

AttributeError: 'NoneType' object has no attribute 'category'
```




---

archive/issue_comments_355169.json:
```json
{
    "body": "Ok the reason for some of the doctest failures on my machine (any maybe the patchbot)\nis that\n\nyour extra if clause messes up the else clause. \nAnd there is an x after sage: t(x) missing .",
    "created_at": "2018-07-04T19:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355169",
    "user": "sbrandhorst"
}
```

Ok the reason for some of the doctest failures on my machine (any maybe the patchbot)
is that

your extra if clause messes up the else clause. 
And there is an x after sage: t(x) missing .



---

archive/issue_comments_355170.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-07T23:09:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355170",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_355171.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-07-07T23:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355171",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_355172.json:
```json
{
    "body": "Thanks for having a look and sorry for that stupid error.",
    "created_at": "2018-07-07T23:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355172",
    "user": "saraedum"
}
```

Thanks for having a look and sorry for that stupid error.



---

archive/issue_comments_355173.json:
```json
{
    "body": "The last bot has some failures. But I think they are unrelated. I kicked the patchbot. Lets see if the next one is green. Then I am definitely happy.",
    "created_at": "2018-07-13T19:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355173",
    "user": "sbrandhorst"
}
```

The last bot has some failures. But I think they are unrelated. I kicked the patchbot. Lets see if the next one is green. Then I am definitely happy.



---

archive/issue_comments_355174.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-21T07:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355174",
    "user": "swewers"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_355175.json:
```json
{
    "body": "The patchbot is happy now.",
    "created_at": "2018-07-21T07:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355175",
    "user": "swewers"
}
```

The patchbot is happy now.



---

archive/issue_comments_355176.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25212",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25212#issuecomment-355176",
    "user": "vbraun"
}
```

Resolution: fixed
