# Issue 14787: Add Hankel functions and make spherical Bessel and Hankel functions symbolic

archive/issues_014787.json:
```json
{
    "body": "CC:  @burcin @fchapoton @paulmasson\n\nFor some reason Sage has spherical Hankel functions but not regular ones. This patch adds Hankel functions and makes spherical Hankel and Bessel functions symbolic, as well as adding arbitrary-precision numeric evaluation.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15024\n\n",
    "created_at": "2013-08-09T00:00:25Z",
    "labels": [
        "symbolics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Add Hankel functions and make spherical Bessel and Hankel functions symbolic",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14787",
    "user": "@eviatarbach"
}
```
CC:  @burcin @fchapoton @paulmasson

For some reason Sage has spherical Hankel functions but not regular ones. This patch adds Hankel functions and makes spherical Hankel and Bessel functions symbolic, as well as adding arbitrary-precision numeric evaluation.

Issue created by migration from https://trac.sagemath.org/ticket/15024





---

archive/issue_comments_188546.json:
```json
{
    "body": "Attachment [trac15024.patch](tarball://root/attachments/some-uuid/ticket15024/trac15024.patch) by @eviatarbach created at 2013-08-09 00:02:04",
    "created_at": "2013-08-09T00:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188546",
    "user": "@eviatarbach"
}
```

Attachment [trac15024.patch](tarball://root/attachments/some-uuid/ticket15024/trac15024.patch) by @eviatarbach created at 2013-08-09 00:02:04



---

archive/issue_comments_188547.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-08-09T00:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188547",
    "user": "@eviatarbach"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_188548.json:
```json
{
    "body": "Note that this also changes the LaTeX representation for the other Bessel functions by removing `\\operatorname`, since in all sources I've seen the function name is italicized.\n\nPatchbot apply trac15024.patch",
    "created_at": "2013-08-09T00:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188548",
    "user": "@eviatarbach"
}
```

Note that this also changes the LaTeX representation for the other Bessel functions by removing `\operatorname`, since in all sources I've seen the function name is italicized.

Patchbot apply trac15024.patch



---

archive/issue_comments_188549.json:
```json
{
    "body": "New patch gets coverage to 100%, adds `_latex_` methods (for getting a LaTeX representation for the function without arguments), and adds `\\left` and `\\right` to `_print_latex_`, which I forgot before.\n\nPatchbot apply trac15024_2.patch",
    "created_at": "2013-09-01T01:19:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188549",
    "user": "@eviatarbach"
}
```

New patch gets coverage to 100%, adds `_latex_` methods (for getting a LaTeX representation for the function without arguments), and adds `\left` and `\right` to `_print_latex_`, which I forgot before.

Patchbot apply trac15024_2.patch



---

archive/issue_comments_188550.json:
```json
{
    "body": "Attachment [trac15024_2.patch](tarball://root/attachments/some-uuid/ticket15024/trac15024_2.patch) by vbraun_spam created at 2014-01-30 21:20:52",
    "created_at": "2014-01-30T21:20:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188550",
    "user": "vbraun_spam"
}
```

Attachment [trac15024_2.patch](tarball://root/attachments/some-uuid/ticket15024/trac15024_2.patch) by vbraun_spam created at 2014-01-30 21:20:52



---

archive/issue_comments_188551.json:
```json
{
    "body": "Note also the Struve functions\n\n```\nstruve_h (v,z)                 Struve H function\nstruve_l (v,z)                 Struve L function\n```\n\nnoted at [the symbolics wiki on Trac](http://trac.sagemath.org/wiki/symbolics/functions), which seem to go with the Hankels...",
    "created_at": "2014-04-22T14:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188551",
    "user": "@kcrisman"
}
```

Note also the Struve functions

```
struve_h (v,z)                 Struve H function
struve_l (v,z)                 Struve L function
```

noted at [the symbolics wiki on Trac](http://trac.sagemath.org/wiki/symbolics/functions), which seem to go with the Hankels...



---

archive/issue_comments_188552.json:
```json
{
    "body": "Yeah, those should be easy to add, although maybe in another ticket.",
    "created_at": "2014-04-23T07:05:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188552",
    "user": "@eviatarbach"
}
```

Yeah, those should be easy to add, although maybe in another ticket.



---

archive/issue_comments_188553.json:
```json
{
    "body": "Sure, this is #16221 now.  By the way, do we really want the Hankel stuff in bessel.py?",
    "created_at": "2014-04-23T14:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188553",
    "user": "@kcrisman"
}
```

Sure, this is #16221 now.  By the way, do we really want the Hankel stuff in bessel.py?



---

archive/issue_comments_188554.json:
```json
{
    "body": "Made commit from patch, removed merge conflicts. However:\n\n```\nsage -t --long src/sage/functions/special.py  # 2 doctests failed\nsage -t --long src/sage/functions/bessel.py  # 12 doctests failed\n```\n\n\n----\nNew commits:",
    "created_at": "2014-05-12T08:40:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188554",
    "user": "@rwst"
}
```

Made commit from patch, removed merge conflicts. However:

```
sage -t --long src/sage/functions/special.py  # 2 doctests failed
sage -t --long src/sage/functions/bessel.py  # 12 doctests failed
```


----
New commits:



---

archive/issue_comments_188555.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-12T08:40:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188555",
    "user": "@rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_188556.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-17T14:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188556",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188557.json:
```json
{
    "body": "Please review. As to which category Hankel functions are in, if not \"bessel\", I would propose this hierarchy for orientation: special functions--->holonomic functions--->Bessel functions",
    "created_at": "2014-07-17T14:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188557",
    "user": "@rwst"
}
```

Please review. As to which category Hankel functions are in, if not "bessel", I would propose this hierarchy for orientation: special functions--->holonomic functions--->Bessel functions



---

archive/issue_comments_188558.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-17T14:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188558",
    "user": "@rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_188559.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-06T16:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188559",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188560.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-20T14:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188560",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188561.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-13T07:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188561",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188562.json:
```json
{
    "body": "Just to let you know: this conflicts with #17130.",
    "created_at": "2014-10-13T08:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188562",
    "user": "@jdemeyer"
}
```

Just to let you know: this conflicts with #17130.



---

archive/issue_comments_188563.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-11T14:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188563",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188564.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-23T16:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188564",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188565.json:
```json
{
    "body": "#18257 makes this ticket fail doctests.",
    "created_at": "2015-04-20T08:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188565",
    "user": "@rwst"
}
```

#18257 makes this ticket fail doctests.



---

archive/issue_comments_188566.json:
```json
{
    "body": "Possibly not a bug with *this* ticket but in Maxima (actually I think it's in our exponential integral), a branch cut difference between us and Mma in the integral:\n\n```\nsage: f(x) = Ei(-I*x) - 6*gamma(-1, I*x) - 15*gamma(-2, I*x) - 15*gamma(-3, I*x)\nsage: f(3)\nEi(-3*I) - 6*gamma(-1, 3*I) - 15*gamma(-2, 3*I) - 15*gamma(-3, 3*I)\nsage: f(3.)\n-0.529089163583971 - 3.36665821311941*I\nsage: g(x) = e^(-i*x)/x^3*(i*x^2+5*x-5*i)\nsage: g(3.)\n```\n\nAlso, the spherical Hankels don't make it into the top matter in the reference page - a very brief mention should suffice.",
    "created_at": "2015-05-22T12:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188566",
    "user": "@kcrisman"
}
```

Possibly not a bug with *this* ticket but in Maxima (actually I think it's in our exponential integral), a branch cut difference between us and Mma in the integral:

```
sage: f(x) = Ei(-I*x) - 6*gamma(-1, I*x) - 15*gamma(-2, I*x) - 15*gamma(-3, I*x)
sage: f(3)
Ei(-3*I) - 6*gamma(-1, 3*I) - 15*gamma(-2, 3*I) - 15*gamma(-3, 3*I)
sage: f(3.)
-0.529089163583971 - 3.36665821311941*I
sage: g(x) = e^(-i*x)/x^3*(i*x^2+5*x-5*i)
sage: g(3.)
```

Also, the spherical Hankels don't make it into the top matter in the reference page - a very brief mention should suffice.



---

archive/issue_comments_188567.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-22T12:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188567",
    "user": "@kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_188568.json:
```json
{
    "body": "[Wikipedia](http://en.wikipedia.org/wiki/Bessel_function#Spherical_Bessel_functions:_jn.2C_yn) and [DLMF](http://dlmf.nist.gov/10.51) agree that the derivative formulas for the various spherical functions only apply if the index is an integer.  I'm not sure how this connects to [W|A](http://www.wolframalpha.com/input/?i=derivative+of+spherical+bessel+j)'s solution to that.\n\nAlso\n\n```\nsage: integrate(spherical_bessel_J(1,x)^2,(x,0,oo))\n1/6*pi\nsage: integrate(spherical_bessel_Y(1,x)^2,(x,0,oo))\n-1/6*pi\n```\n\nis just too cool not to include.\n\nThis is very nicely put together and other than these comments mostly needs just pseudo-random testing that mpmath or whoever doesn't have any weird error spots.  'Needs work' for updating updating documentation, otherwise 'needs info' for the other points raised.",
    "created_at": "2015-05-22T12:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188568",
    "user": "@kcrisman"
}
```

[Wikipedia](http://en.wikipedia.org/wiki/Bessel_function#Spherical_Bessel_functions:_jn.2C_yn) and [DLMF](http://dlmf.nist.gov/10.51) agree that the derivative formulas for the various spherical functions only apply if the index is an integer.  I'm not sure how this connects to [W|A](http://www.wolframalpha.com/input/?i=derivative+of+spherical+bessel+j)'s solution to that.

Also

```
sage: integrate(spherical_bessel_J(1,x)^2,(x,0,oo))
1/6*pi
sage: integrate(spherical_bessel_Y(1,x)^2,(x,0,oo))
-1/6*pi
```

is just too cool not to include.

This is very nicely put together and other than these comments mostly needs just pseudo-random testing that mpmath or whoever doesn't have any weird error spots.  'Needs work' for updating updating documentation, otherwise 'needs info' for the other points raised.



---

archive/issue_comments_188569.json:
```json
{
    "body": "(By the way, I don't know if I want to make #18257 a prereq for adding more symbolic special functions; I totally agree that it should not be ignored, but in the meantime making that arbitrary `+100` bigger again seems better than waiting for someone to figure out a long-term solution to that and then holding various tickets hostage.)",
    "created_at": "2015-05-22T12:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188569",
    "user": "@kcrisman"
}
```

(By the way, I don't know if I want to make #18257 a prereq for adding more symbolic special functions; I totally agree that it should not be ignored, but in the meantime making that arbitrary `+100` bigger again seems better than waiting for someone to figure out a long-term solution to that and then holding various tickets hostage.)



---

archive/issue_comments_188570.json:
```json
{
    "body": "#18257 is good now.",
    "created_at": "2015-06-01T14:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188570",
    "user": "@kcrisman"
}
```

#18257 is good now.



---

archive/issue_comments_188571.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-02T07:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188571",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188572.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-07-02T07:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188572",
    "user": "@rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_188573.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-03T07:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188573",
    "user": "@rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_188574.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-03T07:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188574",
    "user": "@rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_188575.json:
```json
{
    "body": "The failing doctest is because with this ticket the expression returned by `random_expr(20, nvars=2)` suddenly contains the nonsymbolic `floor` function which triggers the fail via\n\n```\nsage: floor(x,hold=True)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-8-fc5809e0a430> in <module>()\n----> 1 floor(x,hold=True)\n\nTypeError: __call__() got an unexpected keyword argument 'hold'\n```\n\nSince this is completely unrelated I'll open a separate ticket. EDIT: See #19464.",
    "created_at": "2015-10-24T07:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188575",
    "user": "@rwst"
}
```

The failing doctest is because with this ticket the expression returned by `random_expr(20, nvars=2)` suddenly contains the nonsymbolic `floor` function which triggers the fail via

```
sage: floor(x,hold=True)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-8-fc5809e0a430> in <module>()
----> 1 floor(x,hold=True)

TypeError: __call__() got an unexpected keyword argument 'hold'
```

Since this is completely unrelated I'll open a separate ticket. EDIT: See #19464.



---

archive/issue_comments_188576.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-04-03T15:31:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188576",
    "user": "@rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_188577.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-03T15:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188577",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188578.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-04T07:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188578",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188579.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-04-04T07:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188579",
    "user": "@rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_188580.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-06-14T08:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188580",
    "user": "@rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_188581.json:
```json
{
    "body": "Symbolic `floor`currently accepts `hold=True`, as does `ceil`. Why is the ticket still dependent on #12121?\n\nAlso, in investigating inaccuracies in plotting spherical Bessel functions for arguments less than one I came across this error:\n\n\n```\nsage: spherical_bessel_J(3,.1)\n0.951851972086556*l - 5\n```\n\n\nThis was supposedly fixed in#2494 but it's back. Will it be fixed when this ticket is merged?\n\nI'd be happy to review this as soon as it's ready to go.",
    "created_at": "2016-07-05T00:46:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188581",
    "user": "@paulmasson"
}
```

Symbolic `floor`currently accepts `hold=True`, as does `ceil`. Why is the ticket still dependent on #12121?

Also, in investigating inaccuracies in plotting spherical Bessel functions for arguments less than one I came across this error:


```
sage: spherical_bessel_J(3,.1)
0.951851972086556*l - 5
```


This was supposedly fixed in#2494 but it's back. Will it be fixed when this ticket is merged?

I'd be happy to review this as soon as it's ready to go.



---

archive/issue_comments_188582.json:
```json
{
    "body": "Replying to [comment:37 paulmasson]:\n> Symbolic `floor`currently accepts `hold=True`, as does `ceil`. Why is the ticket still dependent on #12121?\n\nYou're right. That somehow changed in the meantime.\n\n> Also, in investigating inaccuracies in plotting spherical Bessel functions for arguments less than one I came across this error:\n> \n> {{{\n> sage: spherical_bessel_J(3,.1)\n> 0.951851972086556*l - 5\n> }}}\n\nI resolved merge conflicts and, based on beta6, I get\n\n```\nsage: spherical_bessel_J(3,.1)\n9.51851972086557e-6\n```\n",
    "created_at": "2016-07-05T06:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188582",
    "user": "@rwst"
}
```

Replying to [comment:37 paulmasson]:
> Symbolic `floor`currently accepts `hold=True`, as does `ceil`. Why is the ticket still dependent on #12121?

You're right. That somehow changed in the meantime.

> Also, in investigating inaccuracies in plotting spherical Bessel functions for arguments less than one I came across this error:
> 
> {{{
> sage: spherical_bessel_J(3,.1)
> 0.951851972086556*l - 5
> }}}

I resolved merge conflicts and, based on beta6, I get

```
sage: spherical_bessel_J(3,.1)
9.51851972086557e-6
```




---

archive/issue_comments_188583.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-05T07:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188583",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188584.json:
```json
{
    "body": "I also finally removed unused code in `special.py` and moved associated doctests to better locations. Hope it didn't increase your task too much.",
    "created_at": "2016-07-05T07:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188584",
    "user": "@rwst"
}
```

I also finally removed unused code in `special.py` and moved associated doctests to better locations. Hope it didn't increase your task too much.



---

archive/issue_comments_188585.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-05T07:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188585",
    "user": "@rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_188586.json:
```json
{
    "body": "Updating `special.py` is appropriate to this ticket. In response to a [comment](https://trac.sagemath.org/ticket/15024#comment:6) above, Hankel stuff most certainly belongs in bessel.py since they are Bessel functions.\n\nUnfortunately I'm now seeing changes to `airy.py` and `jacobi.py` that are not appropriate to this ticket. Please fix that.\n\nAlso, the branch is missing: can't checkout what's not there!",
    "created_at": "2016-07-05T20:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188586",
    "user": "@paulmasson"
}
```

Updating `special.py` is appropriate to this ticket. In response to a [comment](https://trac.sagemath.org/ticket/15024#comment:6) above, Hankel stuff most certainly belongs in bessel.py since they are Bessel functions.

Unfortunately I'm now seeing changes to `airy.py` and `jacobi.py` that are not appropriate to this ticket. Please fix that.

Also, the branch is missing: can't checkout what's not there!



---

archive/issue_comments_188587.json:
```json
{
    "body": "The apparently missing branch is due to server maintenance.",
    "created_at": "2016-07-05T20:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188587",
    "user": "@paulmasson"
}
```

The apparently missing branch is due to server maintenance.



---

archive/issue_comments_188588.json:
```json
{
    "body": "Replying to [comment:41 paulmasson]:\n> Unfortunately I'm now seeing changes to `airy.py` and `jacobi.py` that are not appropriate to this ticket. Please fix that.\n\nI was just moving doctests away from `special.py`. But I can add them to those files in another ticket, no problem, as long as you don't mind that I'm removing them in this ticket.",
    "created_at": "2016-07-06T05:30:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188588",
    "user": "@rwst"
}
```

Replying to [comment:41 paulmasson]:
> Unfortunately I'm now seeing changes to `airy.py` and `jacobi.py` that are not appropriate to this ticket. Please fix that.

I was just moving doctests away from `special.py`. But I can add them to those files in another ticket, no problem, as long as you don't mind that I'm removing them in this ticket.



---

archive/issue_comments_188589.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-06T13:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188589",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188590.json:
```json
{
    "body": "When running doctests I get the message\n\n\n```\nImportError: cannot import name meval\n```\n\n\nSimilar error when trying to build documentation. Sage crashes on startup, with message in crash log:\n\n\n```\n---> 56 from sage.functions.special import meval\n...\nImportError: cannot import name meval\n```\n",
    "created_at": "2016-07-07T01:32:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188590",
    "user": "@paulmasson"
}
```

When running doctests I get the message


```
ImportError: cannot import name meval
```


Similar error when trying to build documentation. Sage crashes on startup, with message in crash log:


```
---> 56 from sage.functions.special import meval
...
ImportError: cannot import name meval
```




---

archive/issue_comments_188591.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-07T05:37:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188591",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188592.json:
```json
{
    "body": "Oops, the change in `airy.pyx` is necessary because `meval` no longer exists.",
    "created_at": "2016-07-07T05:38:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188592",
    "user": "@rwst"
}
```

Oops, the change in `airy.pyx` is necessary because `meval` no longer exists.



---

archive/issue_comments_188593.json:
```json
{
    "body": "Doctests all pass. Documentation builds and has multiple preexisting issues, but that should be on a separate ticket.\n\nRandom numeric testing of new Hankel functions is accurate. Both functions plot. Symbolics behave as expected.\n\nPer #20496 we are now supposed to escape abbreviated first names in references. There are three instances in the current branch that don't do that. If you fix those then I think it's ready to go.\n\nThere are changes in here I was planning to make, so I'm glad I read your list of open symbolics tickets beforehand!",
    "created_at": "2016-07-08T01:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188593",
    "user": "@paulmasson"
}
```

Doctests all pass. Documentation builds and has multiple preexisting issues, but that should be on a separate ticket.

Random numeric testing of new Hankel functions is accurate. Both functions plot. Symbolics behave as expected.

Per #20496 we are now supposed to escape abbreviated first names in references. There are three instances in the current branch that don't do that. If you fix those then I think it's ready to go.

There are changes in here I was planning to make, so I'm glad I read your list of open symbolics tickets beforehand!



---

archive/issue_comments_188594.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-08T12:48:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188594",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188595.json:
```json
{
    "body": "Thanks for the review. It's good to see again someone is interested in special functions. I am motivated in having at least the most known holonomic functions implemented symbolically (for experimental symbolics) but had stopped because very few tickets were reviewed.\n----\nNew commits:",
    "created_at": "2016-07-08T12:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188595",
    "user": "@rwst"
}
```

Thanks for the review. It's good to see again someone is interested in special functions. I am motivated in having at least the most known holonomic functions implemented symbolically (for experimental symbolics) but had stopped because very few tickets were reviewed.
----
New commits:



---

archive/issue_comments_188596.json:
```json
{
    "body": "Positive review after cosmetic changes but there is now a merge conflict with 7.3.beta7.\n\nDo I need to review again after conflict is resolved? What's the protocol on this?",
    "created_at": "2016-07-08T17:53:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188596",
    "user": "@paulmasson"
}
```

Positive review after cosmetic changes but there is now a merge conflict with 7.3.beta7.

Do I need to review again after conflict is resolved? What's the protocol on this?



---

archive/issue_comments_188597.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-09T06:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188597",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188598.json:
```json
{
    "body": "Replying to [comment:52 paulmasson]:\n> Do I need to review again after conflict is resolved? What's the protocol on this?\n\nIn principle I could have introduced any possible change with it, so yes. But it is easy to check this, either per eyeball by skimming the diff again, or automatically (I just tried this the first time ever):\n\n```\ngit diff develop >diff1\ngit co 821c307        (the commit before the merge)\ngit diff 7.3.beta6 >diff2\ndiff -u diff2 diff1\n```\n\nThe output of the last diff should not contain lines that start with `++/+-/-+/--`. This way I found I somehow introduced some `orig` files into the branch so I'll delete those files. But as introducing and removing these files create completely unnecessary data I'll upload a new branch with an improved merge commit.",
    "created_at": "2016-07-09T06:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188598",
    "user": "@rwst"
}
```

Replying to [comment:52 paulmasson]:
> Do I need to review again after conflict is resolved? What's the protocol on this?

In principle I could have introduced any possible change with it, so yes. But it is easy to check this, either per eyeball by skimming the diff again, or automatically (I just tried this the first time ever):

```
git diff develop >diff1
git co 821c307        (the commit before the merge)
git diff 7.3.beta6 >diff2
diff -u diff2 diff1
```

The output of the last diff should not contain lines that start with `++/+-/-+/--`. This way I found I somehow introduced some `orig` files into the branch so I'll delete those files. But as introducing and removing these files create completely unnecessary data I'll upload a new branch with an improved merge commit.



---

archive/issue_comments_188599.json:
```json
{
    "body": "Doctests pass and documentation builds. Numerics look good. A few problems resulting from the merge conflict resolution:\n\n1) A line has been modified in `hypergeometric.py`. This modification appears to be inaccurate and has the wrong variable anyway. Please remove the condition `x>0` on `hypergeometric_U`.\n\n2) The definition of the spherical Bessel function of the second kind has been left behind in `special.py` after the definition of spherical harmonics. This one needs to be deleted since it's already in `bessel.py`.\n\n3) The evaluation of spherical harmonics has changed. I'm assuming this is because `meval` is gone, but please confirm. This change has no apparent problems.\n\n4) There are doctests added to the complete elliptic integral which are outside this ticket. Since they pass I'm fine leaving them here, but let me know that they are included just to avoid an extra ticket.\n\n----\nNew commits:",
    "created_at": "2016-07-10T04:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188599",
    "user": "@paulmasson"
}
```

Doctests pass and documentation builds. Numerics look good. A few problems resulting from the merge conflict resolution:

1) A line has been modified in `hypergeometric.py`. This modification appears to be inaccurate and has the wrong variable anyway. Please remove the condition `x>0` on `hypergeometric_U`.

2) The definition of the spherical Bessel function of the second kind has been left behind in `special.py` after the definition of spherical harmonics. This one needs to be deleted since it's already in `bessel.py`.

3) The evaluation of spherical harmonics has changed. I'm assuming this is because `meval` is gone, but please confirm. This change has no apparent problems.

4) There are doctests added to the complete elliptic integral which are outside this ticket. Since they pass I'm fine leaving them here, but let me know that they are included just to avoid an extra ticket.

----
New commits:



---

archive/issue_comments_188600.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-10T06:32:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188600",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_188601.json:
```json
{
    "body": "Replying to [comment:56 paulmasson]:\n> 3) The evaluation of spherical harmonics has changed. I'm assuming this is because `meval` is gone, but please confirm.\nYes.\n> 4) There are doctests added to the complete elliptic integral which are outside this ticket. Since they pass I'm fine leaving them here, but let me know that they are included just to avoid an extra ticket.\nI cannot avoid the extra ticket but would ask you to leave this part in for now.",
    "created_at": "2016-07-10T06:36:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188601",
    "user": "@rwst"
}
```

Replying to [comment:56 paulmasson]:
> 3) The evaluation of spherical harmonics has changed. I'm assuming this is because `meval` is gone, but please confirm.
Yes.
> 4) There are doctests added to the complete elliptic integral which are outside this ticket. Since they pass I'm fine leaving them here, but let me know that they are included just to avoid an extra ticket.
I cannot avoid the extra ticket but would ask you to leave this part in for now.



---

archive/issue_comments_188602.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-10T17:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188602",
    "user": "@paulmasson"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_188603.json:
```json
{
    "body": "Good to go.",
    "created_at": "2016-07-10T17:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188603",
    "user": "@paulmasson"
}
```

Good to go.



---

archive/issue_comments_188604.json:
```json
{
    "body": "Thanks for your patient work.",
    "created_at": "2016-07-11T08:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188604",
    "user": "@rwst"
}
```

Thanks for your patient work.



---

archive/issue_comments_188605.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-12T07:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14787#issuecomment-188605",
    "user": "@vbraun"
}
```

Resolution: fixed
