# Issue 21558: fpylll: Add cython to dependencies

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2016-11-01 22:01:14

CC:  jdemeyer malb embray dimpase




---

Comment by mkoeppe created at 2016-11-02 02:41:53

Also, should it perhaps be installed using pip instead of directly using `setup.py`?
----
New commits:


---

Comment by mkoeppe created at 2016-11-02 02:41:53

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2016-11-02 07:39:18

Changing priority from major to blocker.


---

Comment by jdemeyer created at 2016-11-02 07:39:18

You are still missing `cysignals` as dependency:

```
[fpylll-0.2.3dev] Found local metadata for fpylll-0.2.3dev
[fpylll-0.2.3dev] Using cached file /usr/local/src/sage-config/upstream/fpylll-0.2.3dev.tar.gz
[fpylll-0.2.3dev] fpylll-0.2.3dev
[fpylll-0.2.3dev] ====================================================
[fpylll-0.2.3dev] Setting up build directory for fpylll-0.2.3dev
[fpylll-0.2.3dev] Finished extraction
[fpylll-0.2.3dev] ****************************************************
[fpylll-0.2.3dev] Host system:
[fpylll-0.2.3dev] Linux tamiyo 3.17.7-gentoo #1 SMP PREEMPT Wed Dec 31 20:06:39 CET 2014 x86_64 Intel(R) Core(TM) i7-2640M CPU `@` 2.80GHz GenuineIntel GNU/Linux
[fpylll-0.2.3dev] ****************************************************
[fpylll-0.2.3dev] C compiler: gcc
[fpylll-0.2.3dev] C compiler version:
[fpylll-0.2.3dev] Using built-in specs.
[fpylll-0.2.3dev] COLLECT_GCC=/usr/x86_64-pc-linux-gnu/gcc-bin/4.9.3/gcc
[fpylll-0.2.3dev] COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-pc-linux-gnu/4.9.3/lto-wrapper
[fpylll-0.2.3dev] Target: x86_64-pc-linux-gnu
[fpylll-0.2.3dev] Configured with: /var/tmp/portage/sys-devel/gcc-4.9.3/work/gcc-4.9.3/configure --host=x86_64-pc-linux-gnu --build=x86_64-pc-linux-gnu --prefix=/usr --bindir=/usr/x86_64-pc-linux-gnu/gcc-bin/4.9.3 --includedir=/usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/include --datadir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3 --mandir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/man --infodir=/usr/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/info --with-gxx-include-dir=/usr/lib/gcc/x86_64-pc-linux-gnu/4.9.3/include/g++-v4 --with-python-dir=/share/gcc-data/x86_64-pc-linux-gnu/4.9.3/python --enable-languages=c,c++,fortran --enable-obsolete --enable-secureplt --disable-werror --with-system-zlib --enable-nls --without-included-gettext --enable-checking=release --with-bugurl=https://bugs.gentoo.org/ --with-pkgversion='Gentoo 4.9.3 p1.5, pie-0.6.4' --enable-libstdcxx-time --enable-shared --enable-threads=posix --enable-__cxa_atexit --enable-clocale=gnu --enable-multilib --with-multilib-list=m32,m64 --disable-altivec --disable-fixed-point --enable-targets=all --disable-libgcj --enable-libgomp --disable-libmudflap --disable-libssp --disable-libcilkrts --enable-lto --without-cloog --enable-libsanitizer
[fpylll-0.2.3dev] Thread model: posix
[fpylll-0.2.3dev] gcc version 4.9.3 (Gentoo 4.9.3 p1.5, pie-0.6.4) 
[fpylll-0.2.3dev] ****************************************************
[fpylll-0.2.3dev] Warning: Extension name 'gmp.pylong' does not match fully qualified name 'fpylll.gmp.pylong' of 'src/fpylll/gmp/pylong.pyx'
[fpylll-0.2.3dev] Warning: Extension name 'fplll.integer_matrix' does not match fully qualified name 'fpylll.fplll.integer_matrix' of 'src/fpylll/fplll/integer_matrix.pyx'
[fpylll-0.2.3dev] Traceback (most recent call last):
[fpylll-0.2.3dev]   File "setup.py", line 127, in <module>
[fpylll-0.2.3dev]     compiler_directives={'embedsignature': True}),
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 809, in cythonize
[fpylll-0.2.3dev]     aliases=aliases)
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 714, in create_extension_list
[fpylll-0.2.3dev]     kwds = deps.distutils_info(file, aliases, base).values
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 590, in distutils_info
[fpylll-0.2.3dev]     return (self.transitive_merge(filename, self.distutils_info0, DistutilsInfo.merge)
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 600, in transitive_merge
[fpylll-0.2.3dev]     node, extract, merge, seen, {}, self.cimported_files)[0]
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 605, in transitive_merge_helper
[fpylll-0.2.3dev]     deps = extract(node)
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 581, in distutils_info0
[fpylll-0.2.3dev]     externs = self.cimports_and_externs(filename)[1]
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Utils.py", line 44, in wrapper
[fpylll-0.2.3dev]     res = cache[args] = f(self, *args)
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 491, in cimports_and_externs
[fpylll-0.2.3dev]     for include in self.included_files(filename):
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Utils.py", line 44, in wrapper
[fpylll-0.2.3dev]     res = cache[args] = f(self, *args)
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Build/Dependencies.py", line 474, in included_files
[fpylll-0.2.3dev]     include_path = self.context.find_include_file(include, None)
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Compiler/Main.py", line 274, in find_include_file
[fpylll-0.2.3dev]     error(pos, "'%s' not found" % filename)
[fpylll-0.2.3dev]   File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/Cython/Compiler/Errors.py", line 177, in error
[fpylll-0.2.3dev]     raise InternalError(message)
[fpylll-0.2.3dev] Cython.Compiler.Errors.InternalError: Internal compiler error: 'cysignals/signals.pxi' not found
[fpylll-0.2.3dev] 
[fpylll-0.2.3dev] real  0m0.363s
[fpylll-0.2.3dev] user  0m0.344s
[fpylll-0.2.3dev] sys   0m0.304s
[fpylll-0.2.3dev] ************************************************************************
[fpylll-0.2.3dev] Error installing package fpylll-0.2.3dev
[fpylll-0.2.3dev] ************************************************************************
[fpylll-0.2.3dev] Please email sage-devel (http://groups.google.com/group/sage-devel)
[fpylll-0.2.3dev] explaining the problem and including the relevant part of the log file
[fpylll-0.2.3dev]   /usr/local/src/sage-config/logs/pkgs/fpylll-0.2.3dev.log
[fpylll-0.2.3dev] Describe your computer, operating system, etc.
[fpylll-0.2.3dev] If you want to try to fix the problem yourself, *don't* just cd to
[fpylll-0.2.3dev] /usr/local/src/sage-config/local/var/tmp/sage/build/fpylll-0.2.3dev and type 'make' or whatever is appropriate.
[fpylll-0.2.3dev] Instead, the following commands setup all environment variables
[fpylll-0.2.3dev] correctly and load a subshell for you to debug the error:
[fpylll-0.2.3dev]   (cd '/usr/local/src/sage-config/local/var/tmp/sage/build/fpylll-0.2.3dev' && '/usr/local/src/sage-config/sage' --sh)
[fpylll-0.2.3dev] When you are done debugging, you can type "exit" to leave the subshell.
[fpylll-0.2.3dev] ************************************************************************
```



---

Comment by jdemeyer created at 2016-11-02 07:39:18

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-11-02 19:02:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-11-02 19:03:35

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2016-11-02 20:20:16

Changing status from needs_review to positive_review.


---

Comment by embray created at 2016-11-07 13:41:06

Replying to [comment:2 mkoeppe]:
> Also, should it perhaps be installed using pip instead of directly using `setup.py`?

Yeah, I'm not sure why it isn't using pip.  If this package is switched to being installed with pip, then pip would also be added as an (order-only) dependency.  That said, it's mostly a separate issue.


---

Comment by vbraun created at 2016-11-07 18:27:24

Resolution: fixed
