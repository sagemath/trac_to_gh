# Issue 15421: CPLEX backenddoes not handle binary variables

Issue created by migration from Trac.

Original creator: azi

Original creation time: 2014-01-09 20:31:17

CC:  ncohen slani dcoudert

There is a problem with the CPLEX backend for MixedIntegerLinearProgram. Namely the fact that one specifies a variable to be binary gets ignored. I couldn't find the bug in the code (it looks like it handles this well) hence I am posting it here.



```
sage: M = MixedIntegerLinearProgram(solver='CPLEX')
sage: A = M.new_variable(binary=True, dim=2)
sage: M.add_constraint(A[0][1]+A[0][2] == 2)
sage: M.solve()
0.0
sage: M.get_values(A)
{0: {1: 2.0, 2: 0.0}}
```


Best,

Jernej


---

Comment by ncohen created at 2014-01-09 21:34:00

`:-/`

https://groups.google.com/d/topic/sage-support/WMIpYOwJsB0/discussion

Nathann


---

Comment by azi created at 2014-01-09 21:43:08

CLiff note is that we don't have a clue what's going on right ?:))


---

Comment by ncohen created at 2014-01-09 21:47:33

None. Except that upgrading CPLEX seems to solve it. But please tell me : if you version of Cplex is broken too, do the doctests in graph/ really pass ? `O_o`

Given the number of binary ILP in there...

Nathann


---

Comment by azi created at 2014-01-09 21:52:45

I have quite a recent version (if not latest) of CPLEX. I'll check that out though.

The tests of course do not pass, for example...


```
File "sage-5.13-linux-64bit-ubuntu_12.04.3_lts-x86_64-Linux/devel/sage-main/sage/graphs/generic_graph.py", line 4075, in sage.graphs.generic_graph.GenericGraph.blocks_and_cuts_tree
Failed example:
    T.vertices()
Expected:
    [('B', (0, 1, 2, 3, 4, 5, 6, 7, 8, 9))]
Got:
    []
```



---

Comment by ncohen created at 2014-01-09 21:53:40

`T_T`

Which version do you have ? Can you check if it is the same as the one reported on the sage-support thread ?

Nathann


---

Comment by azi created at 2014-01-09 22:01:44

I am running 12.5.1.0 and he is talking about 12.6.. So I guess that will do it.

I guess I'm gonna install this one make a general sage -t and then we see how it goes !


---

Comment by azi created at 2014-01-09 22:15:07

Same problem with the most recent version of CPLEX 12.6.0.0


---

Comment by ncohen created at 2014-01-10 08:57:10

Well... If you can find out where this comes from... Being unable to reproduce it makes it a bit hard for me. Which version of Sage do you use, btw ?

Nathann


---

Comment by ncohen created at 2014-01-10 16:38:41

Can you build a LP which returns something wrong, and type `p.show()` ? Because if THIS tells you that the variable is binary, that's totally because CPLEX is saying that the variable is binary and returns nonsense afterwards `:-/`

David Coudert just told me that he had the same problem on one of his machines `T_T`

Nathann


---

Comment by azi created at 2014-01-10 16:45:25

As far as the above error goes, CPLEX 12.6.0.0 fixes it. I am also doing a generic sage -t and will report the issues soon


---

Comment by jdemeyer created at 2014-08-05 06:24:50

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2014-08-05 06:24:50

Replying to [comment:10 azi]:
> As far as the above error goes, CPLEX 12.6.0.0 fixes it.
So this ticket can be closed then.


---

Comment by jdemeyer created at 2014-08-05 06:24:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-08-20 20:36:37

Resolution: fixed
