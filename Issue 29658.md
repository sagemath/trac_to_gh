# Issue 29658: move sage.misc.misc.*verbose* to new module sage.misc.verbose

Issue created by migration from https://trac.sagemath.org/ticket/29895

Original creator: mkoeppe

Original creation time: 2020-06-18 18:10:31

CC:  chapoton tscrim dkrenn @mwageringel

The "simple verbosity system" in `sage.misc.misc` has 2 global variables, `LEVEL` and `verbose_files`, which are meant to be internal.

Access is through functions `verbose`, `set_verbose`, `set_verbose_files`, `get_verbose_files`, `unset_verbose_files`, `get_verbose`, all of which are imported by `sage.misc.all`.

Only `verbose` is used in sagelib.
`set_verbose` is used in doctests of sagelib.

We move the functions to a new module `sage.misc.verbose`, with `lazy_import` and deprecation.



See also:
 - #21349: build verbose upon Python's logging module


---

Comment by mkoeppe created at 2020-06-18 20:05:54

We can reuse some of the commits of #21349 for this ticket.


---

Comment by mkoeppe created at 2020-06-19 00:03:18

The branch does not work yet because it the moved functions depend on `cputime` from `sage.misc.misc` and other missing imports
----
Last 10 new commits:


---

Comment by git created at 2020-06-19 04:31:23

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by mkoeppe created at 2020-06-19 05:03:41

Changing status from new to needs_review.


---

Comment by git created at 2020-06-20 17:21:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-06-21 18:00:15

The remaining patchbot plugin warnings are old news. Needs review.


---

Comment by tscrim created at 2020-06-22 05:31:50

LGTM.


---

Comment by tscrim created at 2020-06-22 05:31:50

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-06-22 05:47:12

Thank you!


---

Comment by git created at 2020-07-04 16:24:44

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2020-07-04 16:24:44

Changing status from positive_review to needs_review.


---

Comment by mkoeppe created at 2020-07-04 16:25:04

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-07-04 19:15:33

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2020-07-04 19:15:33

Merge conflict


---

Comment by git created at 2020-07-05 01:48:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-07-05 01:49:00

Trivial merge to resolve conflict


---

Comment by mkoeppe created at 2020-07-05 01:49:00

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2020-07-10 19:32:53

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2020-07-10 19:32:53


```
sage -t --long --warn-long 36.6 src/sage/algebras/splitting_algebra.py
**********************************************************************
File "src/sage/algebras/splitting_algebra.py", line 56, in sage.algebras.splitting_algebra.SplittingAlgebraElement
Failed example:
    CR6.<e6> = SplittingAlgebra(cp6)
Expected nothing
Got:
    doctest:warning
      File "/home/release/Sage/src/bin/sage-runtests", line 177, in <module>
        err = DC.run()
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 1207, in run
        self.run_doctests()
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/control.py", line 908, in run_doctests
        self.dispatcher.dispatch()
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2038, in dispatch
        self.parallel_dispatch()
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1933, in parallel_dispatch
        w.start()  # This might take some time
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2205, in start
        super(DocTestWorker, self).start()
      File "/home/release/Sage/local/lib/python3.7/multiprocessing/process.py", line 112, in start
        self._popen = self._Popen(self)
      File "/home/release/Sage/local/lib/python3.7/multiprocessing/context.py", line 223, in _Popen
        return _default_context.get_context().Process._Popen(process_obj)
      File "/home/release/Sage/local/lib/python3.7/multiprocessing/context.py", line 277, in _Popen
        return Popen(process_obj)
      File "/home/release/Sage/local/lib/python3.7/multiprocessing/popen_fork.py", line 20, in __init__
        self._launch(process_obj)
      File "/home/release/Sage/local/lib/python3.7/multiprocessing/popen_fork.py", line 74, in _launch
        code = process_obj._bootstrap()
      File "/home/release/Sage/local/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
        self.run()
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2177, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2506, in __call__
        doctests, extras = self._run(runner, options, results)
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2552, in _run
        result = runner.run(test)
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 905, in run
        return self._run(test, compileflags, out)
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 707, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1131, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.algebras.splitting_algebra.SplittingAlgebraElement[2]>", line 1, in <module>
        CR6 = SplittingAlgebra(cp6, names=('e6',)); (e6,) = CR6._first_ngens(1)
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/algebras/splitting_algebra.py", line 224, in __init__
        % (base_ring, monic_polynomial, iterate, warning))
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/misc/superseded.py", line 100, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/misc/superseded.py", line 146, in warning
        warn(message, warning_class, stacklevel)
      File "/home/release/Sage/local/lib/python3.7/warnings.py", line 110, in _showwarnmsg
        msg.file, msg.line)
    :
    DeprecationWarning: 
    Importing verbose from here is deprecated. If you need to use it, please import it directly from sage.misc.verbose
    See http://trac.sagemath.org/17815 for details.
**********************************************************************
1 item had failures:
   1 of   6 in sage.algebras.splitting_algebra.SplittingAlgebraElement
    [107 tests, 1 failure, 0.65 s]
----------------------------------------------------------------------
sage -t --long --warn-long 36.6 src/sage/algebras/splitting_algebra.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

Comment by git created at 2020-07-10 19:45:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-07-10 19:46:33

Changing status from needs_work to needs_review.


---

Comment by @mwageringel created at 2020-07-10 20:29:20

The fix looks good to me and the bot is green.


---

Comment by @mwageringel created at 2020-07-10 20:29:20

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-07-10 20:32:01

Thanks!


---

Comment by vbraun created at 2020-07-12 08:30:40

Resolution: fixed
