# Issue 19804: Shifted tableaux

Issue created by migration from https://trac.sagemath.org/ticket/20041

Original creator: zhamaker

Original creation time: 2016-02-11 18:37:44

Assignee: sage-combinat

CC:  sage-combinat tscrim darij andrew.mathas aschilling mantepse

Implement a class for standard shifted tableaux in SAGE. First features - enumeration, random generation, basic features.


---

Comment by zhamaker created at 2016-02-11 18:39:13

New commits:


---

Comment by tscrim created at 2016-02-12 20:27:38

New commits:


---

Comment by andrew.mathas created at 2016-06-30 09:09:26

Is anyone able to tell me what the status of this ticket is? I've recently become interested in shifted tableaux, so I'd be happy to contribute to finalising this. I have just checked and the code appears to work, after a rebase, on 7.3.beta5 and all doc-tests pass so I wondered what else needs to be done. Perhaps just the documentation?


---

Comment by tscrim created at 2016-06-30 22:38:21

Zach has told me that everything he wants is in there. So, yes, the only thing left is the documentation. Although we probably should copy over the code for `pp` from `Tableau` (well `_repr_diagram`).


---

Comment by tscrim created at 2016-07-01 06:23:12

Changing keywords from "" to "days78".


---

Comment by git created at 2016-07-20 16:37:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by andrew.mathas created at 2016-07-20 16:53:48

I have done a fairly major make-over of this code. I have tried to make to more consistent with the rest of the tableaux code by adding options, quite a few new methods as well as some more parent classes:

```sage
ShiftedTableaux_all
ShiftedTableaux_size
ShiftedTableaux_shape
```

I have also created a `StrictPartitions` class, with friends, in `partition.py` because the shape of shifted tableaux is always a strict partition. Currently the `StrictPartitions` class is not in the global namespace, but of course it could be.

Previously, the following worked:

```sage
sage: ShiftedTableau([[1,4,5]])
[[1, 4, 5]]
```

As `Shiftedtabelaux` returns what I would call "standard" shifted tableaux I thought that this was incorrect, so it now raises an error:

```sage
sage: ShiftedTableau([[1,4,5]])
Traceback (most recent call last):
...
ValueError: [[1, 4, 5]] is not an element of Shifted tableaux of shape [3].
```

Let me know if this is not what was intended.

Finally, I hope this is OK but I have taken some liberties with the code such as moving some of the helper functions into the `ShiftedTableaux_size` class. Perhaps more significantly, I have renamed the main file `tableau_shifted.py` as I think this is better organisationally (I know, `k_tableau.py` does not follow this pattern). 

Currently there is one failing doc text that I have not had time to sort out. I have also added more documentation, although I haven't checked it because to do this I'd need to do a `make doc-clean` and it's late...

My main motivation for doing this is that I want to implement "shaded shifted tableaux", but I haven't started on this yet.


---

Comment by git created at 2017-05-01 20:29:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-05-01 20:31:07

Rebased. Sorry Andrew, I completely lost track of this.

Related #22921.


---

Comment by andrew.mathas created at 2017-05-02 03:11:19

Replying to [comment:12 tscrim]:
> Rebased. Sorry Andrew, I completely lost track of this.
> 
> Related #22921.

Sorry, I forgot about this as well. There seems to be a recursion problem now in generating shifted tableaux - which I don't think happened earlier? I will see if I can fix this but I am swamped with teaching at the moment so it won't happen straight away.


---

Comment by chapoton created at 2017-05-02 09:58:02

please see my patchbot's report:

* use python3 syntax for print

* use python3 syntax for metaclass (search in sage code to see how this must be done now)

Plus many failing doctests, including an infinite recursion.


---

Comment by git created at 2017-05-03 02:56:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-05-03 03:01:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-05-03 03:11:19

Changing status from new to needs_review.


---

Comment by tscrim created at 2017-05-03 03:11:19

So there were a number of things that had changed in the backends that needed to be fixed here.

The first is what caused the infinite loop, which caused by `cardinality` -> `__iter__` -> `__len__` -> `cardinality`. I broke this by having a direct counting in `cardinality` using the faster iterator (which doesn't create an instance of the element class, avoiding extra overhead).

There was also some issues with how the facade parents were handled and there elements are constructed. Now `DisjointUnionEnumeratedSets` better handles facade parents, which exposed the issue. This wasn't too hard to clean up.

My other changes were some other small cleanup on the docstrings.

I don't have an idea about the `sage: ShiftedTableau([This is the Trac macro *1,4,5* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,4,5-macro))` change from comment:9. Anne, Zach, Darij, any objections/comments?

Otherwise, I think this is ready for review, so I am setting it as such.


---

Comment by zhamaker created at 2017-05-03 17:40:26

Sorry for being incommunicado for so long. I'll be back to working on this project in the near future.

> I don't have an idea about the `sage: ShiftedTableau([This is the Trac macro *1,4,5* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,4,5-macro))` change from comment:9. Anne, Zach, Darij, any objections/comments?

I think we should construct a separate class for `StandardShiftedTableau` (or should it be `ShiftedStandardTableau`?). In the near term, I plan to implement the various insertion algorithms, which require semi-standard tableaux.


---

Comment by andrew.mathas created at 2017-05-04 05:22:34

Replying to [comment:18 zhamaker]:

> I think we should construct a separate class for `StandardShiftedTableau` (or should it be `ShiftedStandardTableau`?). In the near term, I plan to implement the various insertion algorithms, which require semi-standard tableaux.

In that case, in order not to have to deprecate everything in the near future, this should be changed before the ticket is reviewed and the code is incorporated into sage. A quick fix would be to rename all of the existing classes so that they have "Standard" in their name. A proper fix would be to implement new base classes, following the current pattern in the file, and to have the standard versions inherit from them. I don't have time to do this at the moment, but both options should not be too hard to implement.


---

Comment by chapoton created at 2017-06-02 20:17:34

does not apply


---

Comment by chapoton created at 2017-06-02 20:17:34

Changing status from needs_review to needs_work.


---

Comment by git created at 2017-06-03 13:47:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mantepse created at 2017-09-20 07:11:58

I just had a look at this - are there any outstanding issues?

It would be nice to have `ascii_art` and `unicode_art` work, see `Tableau._ascii_art_`.

Observation: `StrictPartitions` is the same as `Partitions(n, max_slope=-1)`, except that `StrictPartitions` is much faster.

Question: `ShiftedTableau` inherits from `ClonableArray`, wheras `Tableau` inherits from `ClonableList`.  Is there a reason to this?


---

Comment by andrew.mathas created at 2017-10-09 13:05:20

Sorry for my slow reply!

Replying to [comment:22 mantepse]:
> I just had a look at this - are there any outstanding issues?

I am not currently able to compile sage due to a skylake issue, but the comments above suggest that the branch does not apply to the current sage beta. This is almost certainly due to some more recent changes to `partition.py`, so it shouldn't be hard to fix but will need to be done...

Secondly, there is the question/comment above about implementing a separate classes for`ShiftedStandardTableau` and `ShiftedStandardTableau`. Currently, the shifted tableaux are really shifted *stanbdard* tableaux, so this probably should be done. zhamaker suggested doing this but no one has done it yet.

> It would be nice to have `ascii_art` and `unicode_art` work, see `Tableau._ascii_art_`.

This is not something that I feed strongly about but, yes, it would be good to have. I made sure that the `latex` method works.
 
> Observation: `StrictPartitions` is the same as `Partitions(n, max_slope=-1)`, except that `StrictPartitions` is much faster.

I can't remember how `Partitions` generates this but as it is generic code it is not surprising that the code here, which from memory uses code from posets, is faster. It is possible that the code in `Partitions` could be made faster by using the same approach, but that should be done in a separate ticket, I think.

> Question: `ShiftedTableau` inherits from `ClonableArray`, whereas `Tableau` inherits from `ClonableList`.  Is there a reason to this?

Probably `ClonableList` should be used. I used `ClonableArray` because, for me, the entries of such tableaux are always integers but it is probably more sensible to allow the entries to be arbitrary objects, in which case `ClonableList` is better.


---

Comment by mantepse created at 2017-10-10 18:25:43

Replying to [comment:24 andrew.mathas]:

> Secondly, there is the question/comment above about implementing a separate classes for`ShiftedStandardTableau` and `ShiftedStandardTableau`. Currently, the shifted tableaux are really shifted *stanbdard* tableaux, so this probably should be done. zhamaker suggested doing this but no one has done it yet.

I guess this ticket needs coordinization with #22921, which implements `ShiftedPrimedTableaux`.

> > It would be nice to have `ascii_art` and `unicode_art` work, see `Tableau._ascii_art_`.
> 
> This is not something that I feed strongly about but, yes, it would be good to have. I made sure that the `latex` method works.

Note that the `ShiftedPrimedTableaux` class has this now.  I think it would be quite fruitful to factor out the common functionality into a separate class for "fillings-of-tableau-like-shapes', but I'm afraid that's work.

> > Question: `ShiftedTableau` inherits from `ClonableArray`, whereas `Tableau` inherits from `ClonableList`.  Is there a reason to this?
> 
> Probably `\ClobableList` should be used. I used `ClonableArray` because, for me, the entries of such tableaux are always integers but it is probably more sensible to allow the entries to be arbitrary objects, in which case `\ClobableList` is better.

I'm assuming that you mean `ClonableList`.  Travis argued at #22921#comment:32 that actually `Tableau` should use `ClonableArray`...


---

Comment by jessicapalencia created at 2018-03-14 02:40:51

Any progress on this? I'd be interested in using this class if it were in Sage.


---

Comment by tscrim created at 2018-03-14 05:34:59

What needs to be done now is using the implementation in #22921 as a basis for this and seeing what common functionality should be factored out. It's been a little too long since I looked at this to saying anything intelligent at this point, and I don't currently have time to make any more progress on this unfortunately.


---

Comment by git created at 2018-03-15 20:15:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-03-16 06:37:19

Branch pushed to git repo; I updated commit sha1. New commits:
