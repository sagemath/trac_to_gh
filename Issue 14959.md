# Issue 14959: Use mpmath for numerical evaluation of the beta function

Issue created by migration from Trac.

Original creator: eviatarbach

Original creation time: 2013-09-14 21:07:05

CC:  burcin paulmasson rws

Currently,


```
sage: beta(-1.3,-0.4)
NaN
sage: (gamma(-1.3) * gamma(-0.4)) / gamma(-1.3 - 0.4) # expected functionality
-4.92909641669610
```


This is because GiNaC uses `exp(log_gamma(-1.3)+log_gamma(-0.4)-log_gamma(-1.3-0.4))` to evaluate, and `log_gamma` is broken for some input (see #12521). Using mpmath is faster and avoids roundoff errors as well.


---

Comment by paulmasson created at 2016-07-10 17:50:41

Ralf, could you have a look at this issue? I noted in my review of [12521](https://trac.sagemath.org/ticket/12521#comment:34) that even after that fix there are still issues around poles of the beta function.


---

Comment by rws created at 2016-07-11 05:46:43

I will fix this in Pynac by using arb.


---

Comment by rws created at 2016-07-11 07:54:17

I will add a doctest to the Pynac upgrade ticket, so there is no more to do here.


---

Comment by paulmasson created at 2016-07-11 20:33:29

Adding [link](https://github.com/pynac/pynac/commit/af4f16d41c0433d6223ea46baa63cf74f36024f2) to Pynac commit for future reference.

What is arb?


---

Comment by rws created at 2016-07-12 07:31:37

Replying to [comment:8 paulmasson]:
> What is arb?

http://doc.sagemath.org/html/en/reference/rings_numerical/sage/rings/real_arb.html
http://doc.sagemath.org/html/en/reference/rings_numerical/sage/rings/complex_arb.html


---

Comment by paulmasson created at 2016-07-17 02:01:58

Waiting for pynac 0.6.8


---

Comment by paulmasson created at 2016-07-17 02:01:58

Changing status from new to needs_info.


---

Comment by rws created at 2016-07-17 06:30:47

Replying to [comment:10 paulmasson]:
> Waiting for pynac 0.6.8

Yes Yes 8-)) I was at it all the time but had to rewrite things.


---

Comment by rws created at 2016-07-17 06:30:47

Changing status from needs_info to needs_work.


---

Comment by paulmasson created at 2016-07-27 21:48:02

Changing status from needs_work to positive_review.


---

Comment by paulmasson created at 2016-07-27 21:48:02

Fixed in #21034


---

Comment by vbraun created at 2016-08-14 19:08:16

Resolution: duplicate
