# Issue 18980: Bugfix hyperbolic_arc and hyperbolic_polygon

archive/issues_018980.json:
```json
{
    "body": "CC:  @videlec\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/19217\n\n",
    "created_at": "2015-09-15T13:55:59Z",
    "labels": [
        "component: please change"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "Bugfix hyperbolic_arc and hyperbolic_polygon",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18980",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```
CC:  @videlec



Issue created by migration from https://trac.sagemath.org/ticket/19217





---

archive/issue_comments_260017.json:
```json
{
    "body": "Changing priority from major to trivial.",
    "created_at": "2015-09-15T14:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260017",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```

Changing priority from major to trivial.



---

archive/issue_comments_260018.json:
```json
{
    "body": "Changing keywords from \"\" to \"hyperbolic_arc, hyperbolic_polygon\".",
    "created_at": "2015-09-15T14:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260018",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```

Changing keywords from "" to "hyperbolic_arc, hyperbolic_polygon".



---

archive/issue_comments_260019.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to graphics.",
    "created_at": "2015-09-15T14:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260019",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```

Changing component from PLEASE CHANGE to graphics.



---

archive/issue_comments_260020.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2015-09-15T14:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260020",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_260021.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-15T14:37:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260021",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_260022.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-09-15T14:37:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260022",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```

New commits:



---

archive/issue_comments_260023.json:
```json
{
    "body": "Hello,\n\nWhy 10<sup>-3</sup>? Moreover it can be very wrong if the imaginary part is very small. Just try\n\n```\nsage: hyperbolic_triangle(0, 0.0001, 0.0001*I)\n```\n\nThe above example just works fine without your patch.\n\nVincent",
    "created_at": "2015-09-15T21:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260023",
    "user": "https://github.com/videlec"
}
```

Hello,

Why 10<sup>-3</sup>? Moreover it can be very wrong if the imaginary part is very small. Just try

```
sage: hyperbolic_triangle(0, 0.0001, 0.0001*I)
```

The above example just works fine without your patch.

Vincent



---

archive/issue_comments_260024.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-15T21:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260024",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_260025.json:
```json
{
    "body": "Hello Vincent,\n\nthanks for reviewing my first patch!\n\nWould a smaller boundary for the comparison be more eligible? Let's say 10<sup>-12</sup>? Of course, the analogue example of ours will still produce a wrong result:\n\n`g = hyperbolic_triangle(0, 10**(-12),10**(-12)*I);g`\n\nBut scaled to a larger region of hyperbolic geometry, it is quite hard to see:\n\n`g.set_axes_range(0,10**(-10),0,10**(-10));g`\n\nOr do you know a better way to compare a value to zero in sage? \n\nbest regards,\nStefan",
    "created_at": "2015-09-25T09:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260025",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```

Hello Vincent,

thanks for reviewing my first patch!

Would a smaller boundary for the comparison be more eligible? Let's say 10<sup>-12</sup>? Of course, the analogue example of ours will still produce a wrong result:

`g = hyperbolic_triangle(0, 10**(-12),10**(-12)*I);g`

But scaled to a larger region of hyperbolic geometry, it is quite hard to see:

`g.set_axes_range(0,10**(-10),0,10**(-10));g`

Or do you know a better way to compare a value to zero in sage? 

best regards,
Stefan



---

archive/issue_comments_260026.json:
```json
{
    "body": "Hello,\n\nPutting a smaller value would not solve anything. The main problem is that this subtelty should depend on the window parameters (i.e. `xmin`, `xmax`, `ymin`, `ymax`). Hence decided at the time you generate the image.\n\nI have no miracle to propose.\n\nVincent",
    "created_at": "2015-09-25T15:33:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260026",
    "user": "https://github.com/videlec"
}
```

Hello,

Putting a smaller value would not solve anything. The main problem is that this subtelty should depend on the window parameters (i.e. `xmin`, `xmax`, `ymin`, `ymax`). Hence decided at the time you generate the image.

I have no miracle to propose.

Vincent



---

archive/issue_comments_260027.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-28T15:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260027",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_260028.json:
```json
{
    "body": "Hello, \n\nI guess, something went wrong with git. I am sorry for this. Please let me know, if it does not work. \n\nI had a new idea, how to handle this issue: Instead of checking, whether the points are above each other, one could check, how much the line connecting the points differ by the circle through the points. A simple test for this is to look at the quotient of the length of the connecting line and the radius of the circle. If this quotient is smaller than 0.1, we choose a line. The parameter .1 was chosen by experiment. \n\nIn this version the reported bug does not appear and your examples work also. \n\nbest regards,\nStefan",
    "created_at": "2015-09-28T15:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260028",
    "user": "https://trac.sagemath.org/admin/accounts/users/skraemer"
}
```

Hello, 

I guess, something went wrong with git. I am sorry for this. Please let me know, if it does not work. 

I had a new idea, how to handle this issue: Instead of checking, whether the points are above each other, one could check, how much the line connecting the points differ by the circle through the points. A simple test for this is to look at the quotient of the length of the connecting line and the radius of the circle. If this quotient is smaller than 0.1, we choose a line. The parameter .1 was chosen by experiment. 

In this version the reported bug does not appear and your examples work also. 

best regards,
Stefan



---

archive/issue_comments_260029.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-10-05T22:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260029",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_260030.json:
```json
{
    "body": "Hello,\n\nSome trac administrative things:\n- Once you are done with some modification, you should switch the status to `needs review` (it was in `needs work`).\n- the `Authors` field should be with plain names (not the login)\nThis is fine for now.\n\nYour solution is great! I set to positive review and it will be soonly merge in the development release.\n\nVincent",
    "created_at": "2015-10-05T22:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260030",
    "user": "https://github.com/videlec"
}
```

Hello,

Some trac administrative things:
- Once you are done with some modification, you should switch the status to `needs review` (it was in `needs work`).
- the `Authors` field should be with plain names (not the login)
This is fine for now.

Your solution is great! I set to positive review and it will be soonly merge in the development release.

Vincent



---

archive/issue_events_018127.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2015-10-14T21:03:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18980#event-18127"
}
```



---

archive/issue_comments_260031.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-14T21:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18980",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18980#issuecomment-260031",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
