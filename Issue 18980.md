# Issue 18980: Bugfix hyperbolic_arc and hyperbolic_polygon

Issue created by migration from Trac.

Original creator: skraemer

Original creation time: 2015-09-15 13:55:59

CC:  vdelecroix




---

Comment by skraemer created at 2015-09-15 14:30:50

Changing priority from major to trivial.


---

Comment by skraemer created at 2015-09-15 14:30:50

Changing keywords from "" to "hyperbolic_arc, hyperbolic_polygon".


---

Comment by skraemer created at 2015-09-15 14:30:50

Changing component from PLEASE CHANGE to graphics.


---

Comment by skraemer created at 2015-09-15 14:30:50

Changing type from PLEASE CHANGE to defect.


---

Comment by skraemer created at 2015-09-15 14:37:51

Changing status from new to needs_review.


---

Comment by skraemer created at 2015-09-15 14:37:51

New commits:


---

Comment by vdelecroix created at 2015-09-15 21:22:07

Hello,

Why 10<sup>-3</sup>? Moreover it can be very wrong if the imaginary part is very small. Just try

```
sage: hyperbolic_triangle(0, 0.0001, 0.0001*I)
```

The above example just works fine without your patch.

Vincent


---

Comment by vdelecroix created at 2015-09-15 21:22:07

Changing status from needs_review to needs_work.


---

Comment by skraemer created at 2015-09-25 09:11:12

Hello Vincent,

thanks for reviewing my first patch!

Would a smaller boundary for the comparison be more eligible? Let's say 10<sup>-12</sup>? Of course, the analogue example of ours will still produce a wrong result:

`g = hyperbolic_triangle(0, 10**(-12),10**(-12)*I);g`

But scaled to a larger region of hyperbolic geometry, it is quite hard to see:

`g.set_axes_range(0,10**(-10),0,10**(-10));g`

Or do you know a better way to compare a value to zero in sage? 

best regards,
Stefan


---

Comment by vdelecroix created at 2015-09-25 15:33:31

Hello,

Putting a smaller value would not solve anything. The main problem is that this subtelty should depend on the window parameters (i.e. `xmin`, `xmax`, `ymin`, `ymax`). Hence decided at the time you generate the image.

I have no miracle to propose.

Vincent


---

Comment by git created at 2015-09-28 15:09:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by skraemer created at 2015-09-28 15:18:15

Hello, 

I guess, something went wrong with git. I am sorry for this. Please let me know, if it does not work. 

I had a new idea, how to handle this issue: Instead of checking, whether the points are above each other, one could check, how much the line connecting the points differ by the circle through the points. A simple test for this is to look at the quotient of the length of the connecting line and the radius of the circle. If this quotient is smaller than 0.1, we choose a line. The parameter .1 was chosen by experiment. 

In this version the reported bug does not appear and your examples work also. 

best regards,
Stefan


---

Comment by vdelecroix created at 2015-10-05 22:49:23

Changing status from needs_work to positive_review.


---

Comment by vdelecroix created at 2015-10-05 22:49:23

Hello,

Some trac administrative things:
 - Once you are done with some modification, you should switch the status to `needs review` (it was in `needs work`).
 - the `Authors` field should be with plain names (not the login)
This is fine for now.

Your solution is great! I set to positive review and it will be soonly merge in the development release.

Vincent


---

Comment by vbraun created at 2015-10-14 21:03:38

Resolution: fixed
