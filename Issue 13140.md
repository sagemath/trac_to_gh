# Issue 13140: polar method of polyhedra is incorrect

archive/issues_013140.json:
```json
{
    "body": "Assignee: mhampton\n\nCC:  @vbraun\n\nKeywords: polyhedra, polar\n\nThe .polar() method of the Polyhedron class is incorrect, currently it returns the inversion of the correct answer.  This should be an easy thing to fix.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13312\n\n",
    "created_at": "2012-07-31T13:34:10Z",
    "labels": [
        "component: geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.1",
    "title": "polar method of polyhedra is incorrect",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13140",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```
Assignee: mhampton

CC:  @vbraun

Keywords: polyhedra, polar

The .polar() method of the Polyhedron class is incorrect, currently it returns the inversion of the correct answer.  This should be an easy thing to fix.

Issue created by migration from https://trac.sagemath.org/ticket/13312





---

archive/issue_comments_159782.json:
```json
{
    "body": "Fixes the polar method of Polyhedron (was inverted)",
    "created_at": "2012-08-03T15:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159782",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Fixes the polar method of Polyhedron (was inverted)



---

archive/issue_comments_159783.json:
```json
{
    "body": "Attachment [trac_13312_fix_polar_method_polyhedron.patch](tarball://root/attachments/some-uuid/ticket13312/trac_13312_fix_polar_method_polyhedron.patch) by mhampton created at 2012-08-03 15:54:03",
    "created_at": "2012-08-03T15:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159783",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Attachment [trac_13312_fix_polar_method_polyhedron.patch](tarball://root/attachments/some-uuid/ticket13312/trac_13312_fix_polar_method_polyhedron.patch) by mhampton created at 2012-08-03 15:54:03



---

archive/issue_comments_159784.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-08-03T15:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159784",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_159785.json:
```json
{
    "body": "Fixes polar and scalar multiplication bugs",
    "created_at": "2012-08-04T16:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159785",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Fixes polar and scalar multiplication bugs



---

archive/issue_comments_159786.json:
```json
{
    "body": "Attachment [trac_13312_polyhedral_bugfixes_and_improvements.patch](tarball://root/attachments/some-uuid/ticket13312/trac_13312_polyhedral_bugfixes_and_improvements.patch) by mhampton created at 2012-08-04 16:29:31",
    "created_at": "2012-08-04T16:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159786",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Attachment [trac_13312_polyhedral_bugfixes_and_improvements.patch](tarball://root/attachments/some-uuid/ticket13312/trac_13312_polyhedral_bugfixes_and_improvements.patch) by mhampton created at 2012-08-04 16:29:31



---

archive/issue_comments_159787.json:
```json
{
    "body": "* rebased on top of #11763\n* added commit message\n* I'm against the `face_dual_descriptions` method. Never return lists (mutable), and never return integer indices into internal data structures if you can help it. Just return the actual object, its the same to Python (where objects are really references to objects anyways). But I understand that it would be desirable to access the faces without having to dig through the face lattice. I've replaced it with a new `faces(dim)` method that returns the faces in the given dimension. The docstring shows a one-liner to go from there to the old `face_dual_descriptions` method.",
    "created_at": "2012-08-04T22:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159787",
    "user": "https://github.com/vbraun"
}
```

* rebased on top of #11763
* added commit message
* I'm against the `face_dual_descriptions` method. Never return lists (mutable), and never return integer indices into internal data structures if you can help it. Just return the actual object, its the same to Python (where objects are really references to objects anyways). But I understand that it would be desirable to access the faces without having to dig through the face lattice. I've replaced it with a new `faces(dim)` method that returns the faces in the given dimension. The docstring shows a one-liner to go from there to the old `face_dual_descriptions` method.



---

archive/issue_comments_159788.json:
```json
{
    "body": "I'd really like to have the functionality of the face_dual_descriptions method.  I disagree that your docstring is really a one-liner, and I don't think that would be very easy for Sage/Python newbies to figure out.  I have talked to a couple of people who would like a platform for polyhedral computation who have tried Sage and find it very difficult to accomplish what they would like to do.  So I think perhaps we could add your faces(dim) method and an improved version of the face_dual_descriptions method which could return a tuple instead of a list if that makes you happier.",
    "created_at": "2012-08-07T18:46:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159788",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

I'd really like to have the functionality of the face_dual_descriptions method.  I disagree that your docstring is really a one-liner, and I don't think that would be very easy for Sage/Python newbies to figure out.  I have talked to a couple of people who would like a platform for polyhedral computation who have tried Sage and find it very difficult to accomplish what they would like to do.  So I think perhaps we could add your faces(dim) method and an improved version of the face_dual_descriptions method which could return a tuple instead of a list if that makes you happier.



---

archive/issue_comments_159789.json:
```json
{
    "body": "What do you and/or your colleagues actually want to do? I doubt that anybody *wants* tuples of tuples of tuples of nondescript integers thrown at them. This is both non-discoverable (no way to figure out what the integers mean) while at the same time very error-prone (accidentally use the index in the wrong list and you'll get hard-to-find bugs that yield the wrong result). Its arguably true that many students were harmed with such anti-patterns, but its never too late to to change.\n\nRight now the `PolyhedronFace` class isn't really complete, so presumably we need to flesh it more out so that you can get everything you need from the face.",
    "created_at": "2012-08-08T01:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159789",
    "user": "https://github.com/vbraun"
}
```

What do you and/or your colleagues actually want to do? I doubt that anybody *wants* tuples of tuples of tuples of nondescript integers thrown at them. This is both non-discoverable (no way to figure out what the integers mean) while at the same time very error-prone (accidentally use the index in the wrong list and you'll get hard-to-find bugs that yield the wrong result). Its arguably true that many students were harmed with such anti-patterns, but its never too late to to change.

Right now the `PolyhedronFace` class isn't really complete, so presumably we need to flesh it more out so that you can get everything you need from the face.



---

archive/issue_comments_159790.json:
```json
{
    "body": "OK, I am working on some sort of compromise patch and I noticed that your patch (trac_13312_polyhedral_neg_polar.patch) doesn't apply - it looks like it applies to some intermediate version you had - ?  \n\nI actually find the output of the function I wrote convenient of a number of purposes.  Here's a couple of examples of things I have wanted to do before (I can't really speak for others, I just know they find the present capabilities lacking):  Take all the facets of a polyhedron, and move them away from the center of the polyhedron (sort of explode it).  If the polyhedron is 3-dimensional, show these facets in different colors.  Or another example:  color all of the facets of a 3-d polyhedron whose outward normals satisfy some condition.",
    "created_at": "2012-08-26T22:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159790",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

OK, I am working on some sort of compromise patch and I noticed that your patch (trac_13312_polyhedral_neg_polar.patch) doesn't apply - it looks like it applies to some intermediate version you had - ?  

I actually find the output of the function I wrote convenient of a number of purposes.  Here's a couple of examples of things I have wanted to do before (I can't really speak for others, I just know they find the present capabilities lacking):  Take all the facets of a polyhedron, and move them away from the center of the polyhedron (sort of explode it).  If the polyhedron is 3-dimensional, show these facets in different colors.  Or another example:  color all of the facets of a 3-d polyhedron whose outward normals satisfy some condition.



---

archive/issue_comments_159791.json:
```json
{
    "body": "Patch applies to sage-5.3.beta1, I'm building sage-5.3.rc0 now to see if there is any issue.\n\nI thought about how to handle things and I'd like to\n* Not make PolyhedronFace derive from polyhedron - can be confusing as not every `Polyhedron` method makes sense.\n* The PolyhedronFace should have a `polyhedron()` method to get it as a polyhedron without reference to ambient\n* Other methods `outward_normal()` or `offset_polyhedron()` (exploded?), `plot(color)` to implement what you want.\nThoughts?",
    "created_at": "2012-08-27T03:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159791",
    "user": "https://github.com/vbraun"
}
```

Patch applies to sage-5.3.beta1, I'm building sage-5.3.rc0 now to see if there is any issue.

I thought about how to handle things and I'd like to
* Not make PolyhedronFace derive from polyhedron - can be confusing as not every `Polyhedron` method makes sense.
* The PolyhedronFace should have a `polyhedron()` method to get it as a polyhedron without reference to ambient
* Other methods `outward_normal()` or `offset_polyhedron()` (exploded?), `plot(color)` to implement what you want.
Thoughts?



---

archive/issue_comments_159792.json:
```json
{
    "body": "Updated patch",
    "created_at": "2012-10-23T21:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159792",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_comments_159793.json:
```json
{
    "body": "Attachment [trac_13312_polyhedral_neg_polar.patch](tarball://root/attachments/some-uuid/ticket13312/trac_13312_polyhedral_neg_polar.patch) by @vbraun created at 2012-10-23 21:49:11\n\nRebased for #11763",
    "created_at": "2012-10-23T21:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159793",
    "user": "https://github.com/vbraun"
}
```

Attachment [trac_13312_polyhedral_neg_polar.patch](tarball://root/attachments/some-uuid/ticket13312/trac_13312_polyhedral_neg_polar.patch) by @vbraun created at 2012-10-23 21:49:11

Rebased for #11763



---

archive/issue_comments_159794.json:
```json
{
    "body": "For the patchbot: \n\nApply trac_13312_polyhedral_neg_polar.patch",
    "created_at": "2012-11-06T21:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159794",
    "user": "https://github.com/vbraun"
}
```

For the patchbot: 

Apply trac_13312_polyhedral_neg_polar.patch



---

archive/issue_comments_159795.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-10-19T20:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159795",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_159796.json:
```json
{
    "body": "This needs to be rebased on 5.13.beta0.",
    "created_at": "2013-10-19T20:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159796",
    "user": "https://github.com/fchapoton"
}
```

This needs to be rebased on 5.13.beta0.



---

archive/issue_comments_159797.json:
```json
{
    "body": "Rebased\n----\nNew commits:",
    "created_at": "2013-10-19T20:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159797",
    "user": "https://github.com/vbraun"
}
```

Rebased
----
New commits:



---

archive/issue_comments_159798.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-10-19T20:54:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159798",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_159799.json:
```json
{
    "body": "Yooooooooooooo !!\n\nI agree with this patch, though I don't understand one bit : why this change in `.polar` ?\n\n\n```python\n-  verts = [list(v.vector() - self.center()) for v in self.vertex_generator()]\n+  verts = [list(self.center() - v.vector()) for v in self.vertex_generator()]\n```\n\n\nIf it is just to have your example of code work, shouldn't you change the constructor instead ?\n\nBy the way, running `polytopes.n_cube(3).show()` just gives me a black Jmol window. I mean, empty. It's like the world is missing a cube.\n\nNathann",
    "created_at": "2013-12-23T17:32:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159799",
    "user": "https://github.com/nathanncohen"
}
```

Yooooooooooooo !!

I agree with this patch, though I don't understand one bit : why this change in `.polar` ?


```python
-  verts = [list(v.vector() - self.center()) for v in self.vertex_generator()]
+  verts = [list(self.center() - v.vector()) for v in self.vertex_generator()]
```


If it is just to have your example of code work, shouldn't you change the constructor instead ?

By the way, running `polytopes.n_cube(3).show()` just gives me a black Jmol window. I mean, empty. It's like the world is missing a cube.

Nathann



---

archive/issue_comments_159800.json:
```json
{
    "body": "Probably caused by #14358",
    "created_at": "2013-12-23T18:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159800",
    "user": "https://github.com/vbraun"
}
```

Probably caused by #14358



---

archive/issue_comments_159801.json:
```json
{
    "body": "The sign change in `polar()` is what this ticket is about. Whats your question, and why should we change the unrelated ctor?",
    "created_at": "2013-12-23T18:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159801",
    "user": "https://github.com/vbraun"
}
```

The sign change in `polar()` is what this ticket is about. Whats your question, and why should we change the unrelated ctor?



---

archive/issue_comments_159802.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-12-23T18:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159802",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_159803.json:
```json
{
    "body": "Oh sorry. I thought that you just changed the result of this `.polar()` thing so that the two constructors would be equal, and not just isomorphic. I was saying that instead of changing the behaviour of this function to get this result, you should just multiply one of the two constructors by `-1` which would appear more correct `:-P`\n\nOkayokay, then if this def of `polar` is the good one, this patch is good to go as all other additions seem good too `;-)`\n\nNathann",
    "created_at": "2013-12-23T18:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159803",
    "user": "https://github.com/nathanncohen"
}
```

Oh sorry. I thought that you just changed the result of this `.polar()` thing so that the two constructors would be equal, and not just isomorphic. I was saying that instead of changing the behaviour of this function to get this result, you should just multiply one of the two constructors by `-1` which would appear more correct `:-P`

Okayokay, then if this def of `polar` is the good one, this patch is good to go as all other additions seem good too `;-)`

Nathann



---

archive/issue_comments_159804.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-12-26T14:50:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13140",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13140#issuecomment-159804",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
