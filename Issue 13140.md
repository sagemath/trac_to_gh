# Issue 13140: polar method of polyhedra is incorrect

Issue created by migration from https://trac.sagemath.org/ticket/13312

Original creator: mhampton

Original creation time: 2012-07-31 13:34:10

Assignee: mhampton

CC:  vbraun

Keywords: polyhedra, polar

The .polar() method of the Polyhedron class is incorrect, currently it returns the inversion of the correct answer.  This should be an easy thing to fix.


---

Comment by mhampton created at 2012-08-03 15:51:17

Fixes the polar method of Polyhedron (was inverted)


---

Attachment


---

Comment by mhampton created at 2012-08-03 15:54:22

Changing status from new to needs_review.


---

Comment by mhampton created at 2012-08-04 16:28:27

Fixes polar and scalar multiplication bugs


---

Attachment


---

Comment by vbraun created at 2012-08-04 22:59:17

* rebased on top of #11763
* added commit message
* I'm against the `face_dual_descriptions` method. Never return lists (mutable), and never return integer indices into internal data structures if you can help it. Just return the actual object, its the same to Python (where objects are really references to objects anyways). But I understand that it would be desirable to access the faces without having to dig through the face lattice. I've replaced it with a new `faces(dim)` method that returns the faces in the given dimension. The docstring shows a one-liner to go from there to the old `face_dual_descriptions` method.


---

Comment by mhampton created at 2012-08-07 18:46:56

I'd really like to have the functionality of the face_dual_descriptions method.  I disagree that your docstring is really a one-liner, and I don't think that would be very easy for Sage/Python newbies to figure out.  I have talked to a couple of people who would like a platform for polyhedral computation who have tried Sage and find it very difficult to accomplish what they would like to do.  So I think perhaps we could add your faces(dim) method and an improved version of the face_dual_descriptions method which could return a tuple instead of a list if that makes you happier.


---

Comment by vbraun created at 2012-08-08 01:05:03

What do you and/or your colleagues actually want to do? I doubt that anybody _wants_ tuples of tuples of tuples of nondescript integers thrown at them. This is both non-discoverable (no way to figure out what the integers mean) while at the same time very error-prone (accidentally use the index in the wrong list and you'll get hard-to-find bugs that yield the wrong result). Its arguably true that many students were harmed with such anti-patterns, but its never too late to to change.

Right now the `PolyhedronFace` class isn't really complete, so presumably we need to flesh it more out so that you can get everything you need from the face.


---

Comment by mhampton created at 2012-08-26 22:34:01

OK, I am working on some sort of compromise patch and I noticed that your patch (trac_13312_polyhedral_neg_polar.patch) doesn't apply - it looks like it applies to some intermediate version you had - ?  

I actually find the output of the function I wrote convenient of a number of purposes.  Here's a couple of examples of things I have wanted to do before (I can't really speak for others, I just know they find the present capabilities lacking):  Take all the facets of a polyhedron, and move them away from the center of the polyhedron (sort of explode it).  If the polyhedron is 3-dimensional, show these facets in different colors.  Or another example:  color all of the facets of a 3-d polyhedron whose outward normals satisfy some condition.


---

Comment by vbraun created at 2012-08-27 03:01:53

Patch applies to sage-5.3.beta1, I'm building sage-5.3.rc0 now to see if there is any issue.

I thought about how to handle things and I'd like to
  * Not make PolyhedronFace derive from polyhedron - can be confusing as not every `Polyhedron` method makes sense.
  * The PolyhedronFace should have a `polyhedron()` method to get it as a polyhedron without reference to ambient
  * Other methods `outward_normal()` or `offset_polyhedron()` (exploded?), `plot(color)` to implement what you want.
Thoughts?


---

Comment by vbraun created at 2012-10-23 21:48:03

Updated patch


---

Attachment

Rebased for #11763


---

Comment by vbraun created at 2012-11-06 21:11:38

For the patchbot: 

Apply trac_13312_polyhedral_neg_polar.patch


---

Comment by chapoton created at 2013-10-19 20:12:18

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2013-10-19 20:12:18

This needs to be rebased on 5.13.beta0.


---

Comment by vbraun created at 2013-10-19 20:54:25

Rebased
----
New commits:


---

Comment by vbraun created at 2013-10-19 20:54:25

Changing status from needs_work to needs_review.


---

Comment by ncohen created at 2013-12-23 17:32:16

Yooooooooooooo !!

I agree with this patch, though I don't understand one bit : why this change in `.polar` ?


```python
-  verts = [list(v.vector() - self.center()) for v in self.vertex_generator()]
+  verts = [list(self.center() - v.vector()) for v in self.vertex_generator()]
```


If it is just to have your example of code work, shouldn't you change the constructor instead ?

By the way, running `polytopes.n_cube(3).show()` just gives me a black Jmol window. I mean, empty. It's like the world is missing a cube.

Nathann


---

Comment by vbraun created at 2013-12-23 18:05:16

Probably caused by #14358


---

Comment by vbraun created at 2013-12-23 18:07:01

The sign change in `polar()` is what this ticket is about. Whats your question, and why should we change the unrelated ctor?


---

Comment by ncohen created at 2013-12-23 18:12:32

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2013-12-23 18:12:32

Oh sorry. I thought that you just changed the result of this `.polar()` thing so that the two constructors would be equal, and not just isomorphic. I was saying that instead of changing the behaviour of this function to get this result, you should just multiply one of the two constructors by `-1` which would appear more correct `:-P`

Okayokay, then if this def of `polar` is the good one, this patch is good to go as all other additions seem good too `;-)`

Nathann


---

Comment by vbraun created at 2013-12-26 14:50:09

Resolution: fixed
