# Issue 17011: Rewriting the method cardinality in the SetPartitions_setparts

Issue created by migration from Trac.

Original creator: g.chatel

Original creation time: 2014-10-28 23:25:05

Assignee: gchatel

CC:  vivianepons tscrim darij sage-combinat nthiery chapoton

Keywords: cardinality, set partitions

I have changed the cardinality method of the SetPartitions_setparts class. It used to list the set partitions and now it computes the cardinality using basic enumeration formulas.


---

Comment by g.chatel created at 2014-10-28 23:26:59

Changing status from new to needs_review.


---

Comment by git created at 2014-10-28 23:28:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-10-29 08:28:26

Instead of 2 variables `set_size` and `sum_subset_size`, you could use just one : `remaining_subset_size`, which is the difference.


---

Comment by vdelecroix created at 2014-10-29 13:22:02

Hello,

That's cool you worked on this!

1. To avoid the if/else inside your loop you can use the method `to_exp_dict` of partitions:

```
sage: S = SetPartitions(13, Partition([4,3,3,2,1]))
sage: p = S.parts; p
[4, 3, 3, 2, 1]
sage: d = p.to_exp_dict(); d
{1: 1, 2: 1, 3: 2, 4: 1}
```


2. Minor remark: if you write
  {{{
  a = 1
  }}}
  in the source code this is a Python integer. It is not bad to use it but it is confusing if you start to mix them with Sage integer which do not behave the same (especially with respect to division).

3. If you use only Sage integer, there is no need to import `factorial` and `binomial` as they are methods of Sage integers
  {{{
  sage: 10.factorial()
  3628800
  sage: 10.binomial(2)
  45
  }}}
  Using directly those will significantly improve the timings (the `import` takes time and the function in `sage.rings.arith` are much more complicated and ends in calling these methods).

4. It would be nice to have a test like the following:
  {{{
  sage: SetPartitions(13).cardinality()
  27644437
  sage: sage: sum(SetPartitions(13,p).cardinality() for p in Partitions(13))
  27644437
  }}}

Vincent


---

Comment by vdelecroix created at 2014-10-29 13:22:02

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-10-31 11:18:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by g.chatel created at 2014-10-31 11:21:11

Thanks a lot for your comments, It helps me a lot to learn how Sage works.

Do I need to modify the status of this ticket back to "needs review" ?


---

Comment by vdelecroix created at 2014-10-31 12:09:45

Replying to [comment:6 g.chatel]:
> Thanks a lot for your comments, It helps me a lot to learn how Sage works.
> 
> Do I need to modify the status of this ticket back to "needs review" ?

Yes. I did it. Basically the workflow is

 - author does modif
 - author puts in needs review
 - reviewer complains (and possibly provides commit) and set to needs work/needs info

and you repeat until agreement.

Vincent


---

Comment by vdelecroix created at 2014-10-31 12:09:45

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-10-31 14:12:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-10-31 14:13:07

I made a small review commit. If you agree with my changes, you can set this to positive review.


---

Comment by g.chatel created at 2014-10-31 14:26:17

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-11-15 16:22:20

Resolution: fixed
