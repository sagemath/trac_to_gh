# Issue 17011: Rewriting the method cardinality in the SetPartitions_setparts

archive/issues_017011.json:
```json
{
    "body": "Assignee: gchatel\n\nCC:  vivianepons @tscrim @darijgr sage-combinat @nthiery @fchapoton\n\nKeywords: cardinality, set partitions\n\nI have changed the cardinality method of the SetPartitions_setparts class. It used to list the set partitions and now it computes the cardinality using basic enumeration formulas.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17248\n\n",
    "created_at": "2014-10-28T23:25:05Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Rewriting the method cardinality in the SetPartitions_setparts",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17011",
    "user": "https://github.com/rodgzilla"
}
```
Assignee: gchatel

CC:  vivianepons @tscrim @darijgr sage-combinat @nthiery @fchapoton

Keywords: cardinality, set partitions

I have changed the cardinality method of the SetPartitions_setparts class. It used to list the set partitions and now it computes the cardinality using basic enumeration formulas.

Issue created by migration from https://trac.sagemath.org/ticket/17248





---

archive/issue_comments_225405.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-10-28T23:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225405",
    "user": "https://github.com/rodgzilla"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_225406.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-28T23:28:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225406",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_225407.json:
```json
{
    "body": "Instead of 2 variables `set_size` and `sum_subset_size`, you could use just one : `remaining_subset_size`, which is the difference.",
    "created_at": "2014-10-29T08:28:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225407",
    "user": "https://github.com/fchapoton"
}
```

Instead of 2 variables `set_size` and `sum_subset_size`, you could use just one : `remaining_subset_size`, which is the difference.



---

archive/issue_comments_225408.json:
```json
{
    "body": "Hello,\n\nThat's cool you worked on this!\n\n1. To avoid the if/else inside your loop you can use the method `to_exp_dict` of partitions:\n\n```\nsage: S = SetPartitions(13, Partition([4,3,3,2,1]))\nsage: p = S.parts; p\n[4, 3, 3, 2, 1]\nsage: d = p.to_exp_dict(); d\n{1: 1, 2: 1, 3: 2, 4: 1}\n```\n\n\n2. Minor remark: if you write\n   {{{\n   a = 1\n   }}}\n   in the source code this is a Python integer. It is not bad to use it but it is confusing if you start to mix them with Sage integer which do not behave the same (especially with respect to division).\n\n3. If you use only Sage integer, there is no need to import `factorial` and `binomial` as they are methods of Sage integers\n   {{{\n   sage: 10.factorial()\n   3628800\n   sage: 10.binomial(2)\n   45\n   }}}\n   Using directly those will significantly improve the timings (the `import` takes time and the function in `sage.rings.arith` are much more complicated and ends in calling these methods).\n\n4. It would be nice to have a test like the following:\n   {{{\n   sage: SetPartitions(13).cardinality()\n   27644437\n   sage: sage: sum(SetPartitions(13,p).cardinality() for p in Partitions(13))\n   27644437\n   }}}\n\nVincent",
    "created_at": "2014-10-29T13:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225408",
    "user": "https://github.com/videlec"
}
```

Hello,

That's cool you worked on this!

1. To avoid the if/else inside your loop you can use the method `to_exp_dict` of partitions:

```
sage: S = SetPartitions(13, Partition([4,3,3,2,1]))
sage: p = S.parts; p
[4, 3, 3, 2, 1]
sage: d = p.to_exp_dict(); d
{1: 1, 2: 1, 3: 2, 4: 1}
```


2. Minor remark: if you write
   {{{
   a = 1
   }}}
   in the source code this is a Python integer. It is not bad to use it but it is confusing if you start to mix them with Sage integer which do not behave the same (especially with respect to division).

3. If you use only Sage integer, there is no need to import `factorial` and `binomial` as they are methods of Sage integers
   {{{
   sage: 10.factorial()
   3628800
   sage: 10.binomial(2)
   45
   }}}
   Using directly those will significantly improve the timings (the `import` takes time and the function in `sage.rings.arith` are much more complicated and ends in calling these methods).

4. It would be nice to have a test like the following:
   {{{
   sage: SetPartitions(13).cardinality()
   27644437
   sage: sage: sum(SetPartitions(13,p).cardinality() for p in Partitions(13))
   27644437
   }}}

Vincent



---

archive/issue_comments_225409.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-10-29T13:22:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225409",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_225410.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-31T11:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225410",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_225411.json:
```json
{
    "body": "Thanks a lot for your comments, It helps me a lot to learn how Sage works.\n\nDo I need to modify the status of this ticket back to \"needs review\" ?",
    "created_at": "2014-10-31T11:21:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225411",
    "user": "https://github.com/rodgzilla"
}
```

Thanks a lot for your comments, It helps me a lot to learn how Sage works.

Do I need to modify the status of this ticket back to "needs review" ?



---

archive/issue_comments_225412.json:
```json
{
    "body": "Replying to [comment:6 g.chatel]:\n> Thanks a lot for your comments, It helps me a lot to learn how Sage works.\n> \n> Do I need to modify the status of this ticket back to \"needs review\" ?\n\nYes. I did it. Basically the workflow is\n\n   - author does modif\n   - author puts in needs review\n   - reviewer complains (and possibly provides commit) and set to needs work/needs info\n\nand you repeat until agreement.\n\nVincent",
    "created_at": "2014-10-31T12:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225412",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:6 g.chatel]:
> Thanks a lot for your comments, It helps me a lot to learn how Sage works.
> 
> Do I need to modify the status of this ticket back to "needs review" ?

Yes. I did it. Basically the workflow is

   - author does modif
   - author puts in needs review
   - reviewer complains (and possibly provides commit) and set to needs work/needs info

and you repeat until agreement.

Vincent



---

archive/issue_comments_225413.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-31T12:09:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225413",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_225414.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-31T14:12:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225414",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_225415.json:
```json
{
    "body": "I made a small review commit. If you agree with my changes, you can set this to positive review.",
    "created_at": "2014-10-31T14:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225415",
    "user": "https://github.com/fchapoton"
}
```

I made a small review commit. If you agree with my changes, you can set this to positive review.



---

archive/issue_comments_225416.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-31T14:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225416",
    "user": "https://github.com/rodgzilla"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049897.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-15T16:22:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17011#event-49897"
}
```



---

archive/issue_comments_225417.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-11-15T16:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17011",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17011#issuecomment-225417",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
