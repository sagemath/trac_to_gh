# Issue 12748: Decorators for sharing code between is_bar and _test_bar methods.

archive/issues_012748.json:
```json
{
    "body": "Assignee: mvngu\n\nCC:  sage-combinat\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/12920\n\n",
    "created_at": "2012-05-07T18:43:51Z",
    "labels": [
        "doctest",
        "major",
        "enhancement"
    ],
    "title": "Decorators for sharing code between is_bar and _test_bar methods.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12748",
    "user": "nthiery"
}
```
Assignee: mvngu

CC:  sage-combinat



Issue created by migration from https://trac.sagemath.org/ticket/12920





---

archive/issue_comments_152772.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-07T18:46:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12748#issuecomment-152772",
    "user": "nthiery"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_152773.json:
```json
{
    "body": "Changing keywords from \"\" to \"days38\".",
    "created_at": "2012-05-07T18:52:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12748#issuecomment-152773",
    "user": "nthiery"
}
```

Changing keywords from "" to "days38".



---

archive/issue_comments_152774.json:
```json
{
    "body": "Attachment",
    "created_at": "2013-03-28T23:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12748#issuecomment-152774",
    "user": "roed"
}
```

Attachment



---

archive/issue_comments_152775.json:
```json
{
    "body": "Changing component from doctest to doctest framework.",
    "created_at": "2013-03-28T23:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12748#issuecomment-152775",
    "user": "roed"
}
```

Changing component from doctest to doctest framework.



---

archive/issue_comments_152776.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-07-09T07:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12748#issuecomment-152776",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_152777.json:
```json
{
    "body": "Needs to rebase on 5-11.beta3 (reject on unittest.py).\n\nThe patch may definitely be useful. There are two things that I dislike.\n\n1) When you add the decorator the code does not correspond anymore to a is_X method (it does not return a boolean but raise an error or return a refined category). In other words, it is unreadable. Moreover, when you want to access the documentation (reusing your example)\n\n```\nsage: F = FiniteUnion([GF(2), GF(3)])\nsage: F.is_finite?\n```\n\nyou get something that you do not want to see here.\n\n2) the speed\n\n```\nsage: %timeit F.is_finite()\n10000 loops, best of 3: 27.2 us per loop\n```\n\njust to compare\n\n```\nsage: class P:\n....:     def is_finite(self):\n....:         return True\nsage: p = P()\nsage: %timeit p.is_finite()\n1000000 loops, best of 3: 218 ns per loop\n```\n\nwhich is how `is_finite` should be implemented for a finite set.",
    "created_at": "2013-07-09T07:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12748#issuecomment-152777",
    "user": "vdelecroix"
}
```

Needs to rebase on 5-11.beta3 (reject on unittest.py).

The patch may definitely be useful. There are two things that I dislike.

1) When you add the decorator the code does not correspond anymore to a is_X method (it does not return a boolean but raise an error or return a refined category). In other words, it is unreadable. Moreover, when you want to access the documentation (reusing your example)

```
sage: F = FiniteUnion([GF(2), GF(3)])
sage: F.is_finite?
```

you get something that you do not want to see here.

2) the speed

```
sage: %timeit F.is_finite()
10000 loops, best of 3: 27.2 us per loop
```

just to compare

```
sage: class P:
....:     def is_finite(self):
....:         return True
sage: p = P()
sage: %timeit p.is_finite()
1000000 loops, best of 3: 218 ns per loop
```

which is how `is_finite` should be implemented for a finite set.



---

archive/issue_comments_152778.json:
```json
{
    "body": "Changing component from doctest framework to misc.",
    "created_at": "2017-01-24T09:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12748",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12748#issuecomment-152778",
    "user": "jdemeyer"
}
```

Changing component from doctest framework to misc.
