# Issue 24331: Deprecate sage.rings.real_mpfr.RealNumber.__hex__

Issue created by migration from https://trac.sagemath.org/ticket/24568

Original creator: embray

Original creation time: 2018-01-19 13:34:55

This has more or less the same issue as #24514.  Even Python `float`s didn't implement `__hex__`, which it seems really only should be implemented for int-like classes.


---

Comment by embray created at 2018-01-19 13:45:38

New commits:


---

Comment by embray created at 2018-01-19 13:45:38

Changing status from new to needs_review.


---

Comment by git created at 2018-01-19 13:56:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-01-19 14:02:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-01-19 16:05:46

The deprecation doctest does not pass


---

Comment by embray created at 2018-01-22 13:49:28

Of course it doesn't--it's misindented :)  Feel free to set "needs work" if you notice an issue, otherwise I might not notice as readily.


---

Comment by embray created at 2018-01-22 13:49:28

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-01-22 14:15:47

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by embray created at 2018-01-22 14:17:02

Fixed the doctest.  This also conflicts with (and requires, to some extent) #24223 so I rebased on top of it.


---

Comment by embray created at 2018-01-22 14:17:02

Changing status from needs_work to needs_review.


---

Comment by vdelecroix created at 2018-01-22 20:14:38

`__hex__` should not be relevant to Python3 (https://docs.python.org/2/library/future_builtins.html#future_builtins.hex).


---

Comment by embray created at 2018-01-23 11:16:13

Yes, that's the point...


---

Comment by chapoton created at 2018-01-23 13:33:12

doctest not passing


---

Comment by chapoton created at 2018-01-23 13:33:12

Changing status from needs_review to needs_work.


---

Comment by embray created at 2018-01-23 16:55:32

https -> http


---

Comment by git created at 2018-01-23 16:57:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2018-01-24 15:33:24

needs review?


---

Comment by embray created at 2018-01-30 17:48:25

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-01-30 19:45:09

does not apply


---

Comment by chapoton created at 2018-01-30 19:45:55

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2018-02-12 14:15:53

New commits:


---

Comment by chapoton created at 2018-02-12 14:15:53

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-02-12 14:20:49

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2018-02-12 14:20:49

the branch is a mess..


---

Comment by embray created at 2018-02-12 14:41:09

Let me fix it.

Rebasing is much easier than merge when it's just applying a series of patches onto a new base commit.


---

Comment by embray created at 2018-02-12 15:06:48

Changing status from needs_work to needs_review.


---

Comment by embray created at 2018-02-12 15:07:32

New commits:


---

Comment by git created at 2018-02-12 15:08:20

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by embray created at 2018-02-12 15:08:46

Okay, definitely fixed up now.


---

Comment by jdemeyer created at 2018-02-12 19:47:37

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-02-12 23:26:45

Reviewer name...


---

Comment by vbraun created at 2018-02-12 23:26:45

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2018-02-13 06:21:03

Changing status from needs_work to positive_review.


---

Comment by embray created at 2018-02-14 16:56:02

It would seem almost easier to just...


---

Comment by fbissey created at 2018-02-14 22:38:52

There is a broken doctest on the buildbot and I have it too. I expect Volker to report back on it too.

```
sage -t --long --warn-long 72.3 /usr/lib64/python2.7/site-packages/sage/rings/real_mpfr.pyx                                                                                  
**********************************************************************                                                                                                       
File "/usr/lib64/python2.7/site-packages/sage/rings/real_mpfr.pyx", line 2087, in sage.rings.real_mpfr.RealNumber.__hex__                                                    
Failed example:                                                                                                                                                              
    hex(RR(-1/3))  # py2                                                                                                                                                     
Expected:                                                                                                                                                                    
    doctest:warning...:                                                                                                                                                      
    DeprecationWarning: use the method .hex instead                                                                                                                          
    See http://trac.sagemath.org/ticket/24568 for details.
    '-0x5.5555555555554p-4'
Got:
    doctest:warning
      File "/usr/lib/python-exec/python2.7/sage-runtests", line 105, in <module>
        err = DC.run()
      File "/usr/lib64/python2.7/site-packages/sage/doctest/control.py", line 1100, in run
        self.run_doctests()
      File "/usr/lib64/python2.7/site-packages/sage/doctest/control.py", line 829, in run_doctests
        self.dispatcher.dispatch()
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 1816, in dispatch
        self.parallel_dispatch()
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 1713, in parallel_dispatch
        w.start()  # This might take some time
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 1982, in start
        super(DocTestWorker, self).start()
      File "/usr/lib64/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/usr/lib64/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/usr/lib64/python2.7/multiprocessing/process.py", line 267, in _bootstrap
        self.run()
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 1955, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 2272, in __call__
        result = runner.run(test)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 708, in run
        return self._run(test, compileflags, out)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 530, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib64/python2.7/site-packages/sage/doctest/forker.py", line 933, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.real_mpfr.RealNumber.__hex__[0]>", line 1, in <module>
        hex(RR(-Integer(1)/Integer(3)))  # py2
      File "/usr/lib64/python2.7/site-packages/sage/misc/superseded.py", line 101, in deprecation
        warning(trac_number, message, DeprecationWarning, stacklevel)
      File "/usr/lib64/python2.7/site-packages/sage/misc/superseded.py", line 142, in warning
        warn(message, warning_class, stacklevel)
    :
    DeprecationWarning: use the method .hex instead
    See http://trac.sagemath.org/24568 for details.
    '-0x5.5555555555554p-4'
**********************************************************************
```



---

Comment by vbraun created at 2018-02-14 23:45:41

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2018-02-15 12:59:12

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2018-02-15 12:59:12

How did you get `http://trac.sagemath.org/ticket/24568` instead of `http://trac.sagemath.org/24568` in the deprecation message? Anyway, I fixed it now.
----
New commits:


---

Comment by vbraun created at 2018-02-16 23:38:48

Resolution: fixed
