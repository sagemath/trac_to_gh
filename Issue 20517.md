# Issue 20517: Full boost package

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2016-06-01 16:07:54

CC:  tscrim jhpalmieri




---

Comment by vbraun created at 2016-06-01 18:27:09

Changing status from new to needs_review.


---

Comment by vbraun created at 2016-06-01 18:27:09

Changing component from PLEASE CHANGE to packages: optional.


---

Comment by vbraun created at 2016-06-01 18:27:09

New commits:


---

Comment by vbraun created at 2016-06-01 18:27:09

Changing type from PLEASE CHANGE to enhancement.


---

Comment by tscrim created at 2016-06-02 08:09:48

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2016-06-02 08:19:42

This seems safer to me: don't delete the old headers until you're sure the new one has built successfully.

```diff
diff --git a/build/pkgs/boost/spkg-install b/build/pkgs/boost/spkg-install
index b79c700..4cdd24f 100755
--- a/build/pkgs/boost/spkg-install
+++ b/build/pkgs/boost/spkg-install
`@``@` -6,10 +6,6 `@``@` if [ "$SAGE_LOCAL" = "" ]; then
    exit 1
 fi
 
-echo "Clean out old boost headers and libraries"
-rm -rf "$SAGE_LOCAL"/include/boost
-rm -rf "$SAGE_LOCAL"/lib/libboost*
-
 cd src
 
 echo "Running boost bootstrap"
`@``@` -19,6 +15,18 `@``@` if [This is the Trac macro *$? -ne 0 * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#$? -ne 0 -macro); then
     exit 1
 fi
 
+echo "Building boost"
+./b2
+if [This is the Trac macro *$? -ne 0 * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#$? -ne 0 -macro); then
+    echo >&2 "Failed to build boost."
+    exit 1
+fi
+
+echo "Clean out old boost headers and libraries"
+rm -rf "$SAGE_LOCAL"/include/boost
+rm -rf "$SAGE_LOCAL"/lib/libboost*
+
+echo "Installing boost"
 ./b2 install --prefix="$SAGE_LOCAL"
 if [This is the Trac macro *$? -ne 0 * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#$? -ne 0 -macro); then
     echo >&2 "Failed to install boost."
```



---

Comment by jhpalmieri created at 2016-06-02 08:19:42

Changing status from positive_review to needs_work.


---

Comment by jhpalmieri created at 2016-06-02 08:22:32

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2016-06-02 08:22:32

New commits:


---

Comment by tscrim created at 2016-06-02 12:37:13

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-06-02 12:37:13

Good point. LGTM and setting a positive review.


---

Comment by tscrim created at 2016-06-02 12:37:35

Changing keywords from "" to "days74".


---

Comment by fbissey created at 2016-06-02 22:12:21

I am surprised no one had a look at #17966 first. I would note the following bit that I had to add but you haven't:

```
echo "Bootstraping boost"
# By default this is populated by a system value.
# If boost has been installed system wide it can cause interference.
# The build can fail purely and simply without much of an explanation.
export BOOST_BUILD_PATH="${SAGE_LOCAL}"/share/boost-build
./bootstrap.sh --with-toolset=gcc \
               --prefix="$SAGE_LOCAL"
```



---

Comment by jhpalmieri created at 2016-06-03 07:28:16

Changing status from positive_review to needs_info.


---

Comment by jhpalmieri created at 2016-06-03 07:28:16

Setting this to "Needs info" so we can think about Fran√ßois's comments.


---

Comment by vbraun created at 2016-06-03 16:11:19

Sorry, I missed #17966. Though for now I suggest we keep this ticket as-is and see if its really a conflict with system boost; I have system boost installed and didn't have a problem building. It might be fixed already?


---

Comment by vbraun created at 2016-06-03 21:49:28

Resolution: fixed


---

Comment by fbissey created at 2016-06-04 05:15:04

Follow up with explanations at #20776.
