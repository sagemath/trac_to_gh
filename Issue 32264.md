# Issue 32264: Meta-ticket: Clear out __init__.py files in preparation for namespace packages

Issue created by migration from https://trac.sagemath.org/ticket/32501

Original creator: mkoeppe

Original creation time: 2021-09-10 19:33:21

CC:  tscrim pbruin fbissey @kliem dcoudert

(Part of the modularization effort, #29705)

Whenever there are two distribution packages that provide modules with a common prefix of Python packages, that prefix needs to be a native namespace package, i.e., there cannot be an `__init__.py` file. 

For example, 
- `sagemath-tdlib` will provide `sage.graphs.graph_decompositions.tdlib`,
- `sagemath-rw` will provide `sage.graphs.graph_decompositions.rankwidth`,
- `sagemath-graphs` will provide all of the rest of `sage.graphs.graph_decompositions` (and most of `sage.graphs`).
Then, none of 
- `sage`, 
- `sage.graphs`, 
- `sage.graphs.graph_decomposition` 
can be an ordinary Python package (with `__init__.py` file), but rather each of them has to be a native namespace package (no `__init__.py` file).

In this meta-ticket, we make sure that all such `__init__.py` files are empty. (The actual removal of empty `__init__.py` files will be done in #28925.)

Not all `__init__.py` files need to be empty. For example, 
- all of `sage.cpython` and `sage.structure` is intended to be in one distribution package, `sagemath-objects`. Hence `sage.cpython` and `sage.structure` keep their nonempty `__init__.py` files, and we may even add a comment that documents that they are intended to stay ordinary packages. (#31420 clears `sage.__init__` and adds such a comment to `sage.cpython.__init__`
- `sage.libs.giac` is intended to be in one distribution package, `sagemath-giac`. Hence `sage.libs.giac` will keep its nonempty `__init__.py` file (but `sage.libs` will not).



```
$ find src/sage -name '__init__.py' | xargs wc -l | sort
...
       3 src/sage/dynamics/__init__.py
       3 src/sage/dynamics/cellular_automata/__init__.py
       3 src/sage/matroids/__init__.py
       3 src/sage/modular/arithgroup/__init__.py
       3 src/sage/modular/quatalg/__init__.py
       4 src/sage/repl/rich_output/__init__.py
       4 src/sage/sat/solvers/__init__.py
       5 src/sage/graphs/graph_decompositions/__init__.py
       7 src/sage/combinat/integer_lists/__init__.py
       9 src/sage/combinat/matrices/__init__.py
      10 src/sage/combinat/cluster_algebra_quiver/__init__.py
      10 src/sage/combinat/ncsym/__init__.py
      10 src/sage/modules/with_basis/__init__.py
      11 src/sage/combinat/ncsf_qsym/__init__.py
      11 src/sage/combinat/path_tableaux/__init__.py
      13 src/sage/combinat/chas/__init__.py
      29 src/sage/categories/__init__.py
      29 src/sage/combinat/crystals/__init__.py
      31 src/sage/combinat/sf/__init__.py
      35 src/sage/combinat/posets/__init__.py
      36 src/sage/combinat/rigged_configurations/__init__.py
      38 src/sage/combinat/designs/__init__.py
      42 src/sage/combinat/words/__init__.py
      49 src/sage/combinat/__init__.py
      51 src/sage/combinat/species/__init__.py
     107 src/sage/__init__.py                                     #31420/32479/#32489
     114 src/sage/rings/polynomial/pbori/__init__.py
     127 src/sage/combinat/root_system/__init__.py
     219 src/sage/libs/pari/__init__.py
     359 src/sage/libs/giac/__init__.py
     826 src/sage/features/__init__.py
```


Tickets:
- #31420/#32479/#32489 `sage`


---

Comment by mkoeppe created at 2021-09-13 06:19:51

A serious case:

```
$ cat src/sage/rings/polynomial/__init__.py
# Resolve a cyclic import
import sage.rings.convert.mpfi
```

We need to get rid of this one -- `sage.rings.polynomial` must become a namespace package


---

Comment by mkoeppe created at 2021-09-13 19:14:06

Replying to [comment:6 mkoeppe]:
> A serious case:
> {{{
> $ cat src/sage/rings/polynomial/__init__.py
> # Resolve a cyclic import
> import sage.rings.convert.mpfi
> }}}
> We need to get rid of this one -- `sage.rings.polynomial` must become a namespace package

This one was added it #25848 ("Some preparations for binding=True") for a stalled effort in #22747/#26254


---

Comment by mkoeppe created at 2021-10-20 17:41:24

We can close this meta-ticket because it only tracks one open ticket.


---

Comment by mkoeppe created at 2021-10-20 17:41:24

Changing status from new to needs_review.


---

Comment by tscrim created at 2021-10-20 23:53:15

I think it would be good to keep it open until the final ticket is done.


---

Comment by mjo created at 2021-12-01 01:33:10

Everything in the "Tickets:" list has been closed: fixed.


---

Comment by mjo created at 2021-12-01 01:33:10

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-12-01 02:46:14

Resolution: invalid
