# Issue 27882: Implement random triangulations of a polygon

archive/issues_027882.json:
```json
{
    "body": "CC:  @fchapoton\n\nThis will provide a fast almost uniform random generator for triangulations of polygons.\n\nThis will extend the functionality of `graphs.RandomTriangulation()` to choosing the degree of the outer face of the triangulation. Currently, only outer faces of degree 3 are provided.\n\nAs the current implementation, this will use the algorithm via a bijection with blossoming trees due to Schaeffer and Poulalhon (Optimal Coding and Sampling of Triangulations, Algorithmica 2006, https://link.springer.com/content/pdf/10.1007/s00453-006-0114-8.pdf).\n\nIssue created by migration from https://trac.sagemath.org/ticket/28119\n\n",
    "closed_at": "2019-08-08T21:24:36Z",
    "created_at": "2019-07-05T11:19:33Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Implement random triangulations of a polygon",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27882",
    "user": "https://github.com/hensc"
}
```
CC:  @fchapoton

This will provide a fast almost uniform random generator for triangulations of polygons.

This will extend the functionality of `graphs.RandomTriangulation()` to choosing the degree of the outer face of the triangulation. Currently, only outer faces of degree 3 are provided.

As the current implementation, this will use the algorithm via a bijection with blossoming trees due to Schaeffer and Poulalhon (Optimal Coding and Sampling of Triangulations, Algorithmica 2006, https://link.springer.com/content/pdf/10.1007/s00453-006-0114-8.pdf).

Issue created by migration from https://trac.sagemath.org/ticket/28119





---

archive/issue_comments_393345.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-07-30T10:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393345",
    "user": "https://github.com/hensc"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_393346.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-07-30T10:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393346",
    "user": "https://github.com/hensc"
}
```

New commits:



---

archive/issue_comments_393347.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-30T11:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393347",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393348.json:
```json
{
    "body": "failing doctests, see patchbot report",
    "created_at": "2019-07-30T15:36:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393348",
    "user": "https://github.com/fchapoton"
}
```

failing doctests, see patchbot report



---

archive/issue_comments_393349.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-30T17:20:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393349",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393350.json:
```json
{
    "body": "In the former implementation of `RandomTriangulation()` the resulting graph always had an edge `(-1,-2)`. Since this had not been part of the documentation of `RandomTriangulation()`, I did not recover this behavior but fixed the two places where this behavior was expected.",
    "created_at": "2019-07-30T17:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393350",
    "user": "https://github.com/hensc"
}
```

In the former implementation of `RandomTriangulation()` the resulting graph always had an edge `(-1,-2)`. Since this had not been part of the documentation of `RandomTriangulation()`, I did not recover this behavior but fixed the two places where this behavior was expected.



---

archive/issue_comments_393351.json:
```json
{
    "body": "Does the change in \"minimal_schnyder_wood\" mean that this function will need an argument \"root\" in order to work correctly ? If so, its doc and code must be changed accordingly.",
    "created_at": "2019-07-31T07:28:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393351",
    "user": "https://github.com/fchapoton"
}
```

Does the change in "minimal_schnyder_wood" mean that this function will need an argument "root" in order to work correctly ? If so, its doc and code must be changed accordingly.



---

archive/issue_comments_393352.json:
```json
{
    "body": "I did not change anything in `minimal_schnyder_wood()`. But it is correct that this function needs an argument `root` if the graph has no edge `(-1,-2)`. In the former implementation of `RandomTriangulation()` the vertices of the root edge of the resulting graph were labelled `-1` and `-2`. To me it seems quite random that these behaviors used to fit together, but now that I think about it, at least it makes sense to take the root edge as an outer edge of the Schnyder wood.\n\nTherefore, I will relabel the root edge vertices to `-1` and `-2` and add this to the documentation. I would prefer to return the root edge, but I think that's a to big change just for design reasons.\n\nLetting `minimal_schnyder_wood()` choose a random root edge if none is given should not be done in this ticket, I think.",
    "created_at": "2019-07-31T09:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393352",
    "user": "https://github.com/hensc"
}
```

I did not change anything in `minimal_schnyder_wood()`. But it is correct that this function needs an argument `root` if the graph has no edge `(-1,-2)`. In the former implementation of `RandomTriangulation()` the vertices of the root edge of the resulting graph were labelled `-1` and `-2`. To me it seems quite random that these behaviors used to fit together, but now that I think about it, at least it makes sense to take the root edge as an outer edge of the Schnyder wood.

Therefore, I will relabel the root edge vertices to `-1` and `-2` and add this to the documentation. I would prefer to return the root edge, but I think that's a to big change just for design reasons.

Letting `minimal_schnyder_wood()` choose a random root edge if none is given should not be done in this ticket, I think.



---

archive/issue_comments_393353.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-31T10:22:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393353",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393354.json:
```json
{
    "body": "This\n\n```\nk = (len(pendant_word)+4) / 2\n```\nshould rather use `//`, no ?\n\nI am getting 16 failures when testing with python3-built sage. Maybe all caused by the line above creating a float. \n\nPlease add before the line \n\n```\nfrom six.moves import range\n```\nanother line containing\n\n```\nfrom __future__ import print_function, division\n```\nso that the behaviour of division becomes py3-like.",
    "created_at": "2019-07-31T19:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393354",
    "user": "https://github.com/fchapoton"
}
```

This

```
k = (len(pendant_word)+4) / 2
```
should rather use `//`, no ?

I am getting 16 failures when testing with python3-built sage. Maybe all caused by the line above creating a float. 

Please add before the line 

```
from six.moves import range
```
another line containing

```
from __future__ import print_function, division
```
so that the behaviour of division becomes py3-like.



---

archive/issue_comments_393355.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-08-01T15:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393355",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_393356.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-02T18:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393356",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393357.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-08-02T18:03:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393357",
    "user": "https://github.com/hensc"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_393358.json:
```json
{
    "body": "Sorry, but this is breaking the following code (randomly, maybe once every 5 calls)\n\n```\nsage: T = TamariIntervalPosets(40)\nsage: T.random_element()  \n```\nI guess I should have documented more the expected behaviour..",
    "created_at": "2019-08-02T18:41:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393358",
    "user": "https://github.com/fchapoton"
}
```

Sorry, but this is breaking the following code (randomly, maybe once every 5 calls)

```
sage: T = TamariIntervalPosets(40)
sage: T.random_element()  
```
I guess I should have documented more the expected behaviour..



---

archive/issue_comments_393359.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-02T21:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393359",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393360.json:
```json
{
    "body": "I think I could fix the problem. In the function `from_minimal_schnyder_wood(g)` which is called in `TamariIntervalPosets.random_element()` they expect the list `g._embedding[-1]` to end with `-2`. I did not like the idea to require the output of `RandomTriangulation()` to have this property. Therefore I fixed it in `TamariIntervalPosets.random_element()`. In my opinion, the cleanest solution would be to remove this requirement from `from_minimal_schnyder_wood()`. But not in this ticket.",
    "created_at": "2019-08-02T21:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393360",
    "user": "https://github.com/hensc"
}
```

I think I could fix the problem. In the function `from_minimal_schnyder_wood(g)` which is called in `TamariIntervalPosets.random_element()` they expect the list `g._embedding[-1]` to end with `-2`. I did not like the idea to require the output of `RandomTriangulation()` to have this property. Therefore I fixed it in `TamariIntervalPosets.random_element()`. In my opinion, the cleanest solution would be to remove this requirement from `from_minimal_schnyder_wood()`. But not in this ticket.



---

archive/issue_comments_393361.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-03T10:11:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_393362.json:
```json
{
    "body": "I think this requirement makes sense for `minimal_schnyder_wood()`. Therefore now I prefer this solution.",
    "created_at": "2019-08-03T14:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393362",
    "user": "https://github.com/hensc"
}
```

I think this requirement makes sense for `minimal_schnyder_wood()`. Therefore now I prefer this solution.



---

archive/issue_comments_393363.json:
```json
{
    "body": "ok, let it be. Thanks for your contribution.",
    "created_at": "2019-08-05T14:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393363",
    "user": "https://github.com/fchapoton"
}
```

ok, let it be. Thanks for your contribution.



---

archive/issue_comments_393364.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-05T14:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393364",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_393365.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-08T21:24:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27882#issuecomment-393365",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_069785.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-08T21:24:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27882",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27882#event-69785"
}
```
