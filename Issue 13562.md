# Issue 13562: no conversion from unit group to number field

Issue created by migration from Trac.

Original creator: mderickx

Original creation time: 2012-11-27 23:40:24

Assignee: tbd

CC:  mstreng

Currently we have:

```
sage: L.<a>=CyclotomicField(7)
sage: a in L.unit_group()
False
```


This is because:

```
sage: a1=L.unit_group()(a)
sage: L(a1)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/maarten/Dropbox/Artikelen/MazurKamiennyDerickx/tex/<ipython console> in <module>()

/Applications/sage/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.__call__ (sage/structure/parent.c:6820)()

/Applications/sage/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3254)()

/Applications/sage/local/lib/python2.6/site-packages/sage/structure/coerce_maps.so in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (sage/structure/coerce_maps.c:3157)()

/Applications/sage/local/lib/python2.6/site-packages/sage/rings/number_field/number_field.pyc in _element_constructor_(self, x)
   6974             return self._coerce_from_str(x)
   6975         else:
-> 6976             return self._coerce_non_number_field_element_in(x)
   6977 
   6978     # TODO:

/Applications/sage/local/lib/python2.6/site-packages/sage/rings/number_field/number_field.pyc in _coerce_non_number_field_element_in(self, x)
   5064         except (TypeError, AttributeError), msg:
   5065             pass
-> 5066         raise TypeError, type(x)
   5067 
   5068     def _coerce_from_str(self, x):

TypeError: <class 'sage.groups.abelian_gps.abelian_group_element.AbelianGroupElement'>
```



---

Comment by mderickx created at 2012-11-27 23:41:00

Changing type from PLEASE CHANGE to defect.


---

Comment by mderickx created at 2012-11-27 23:41:00

Changing assignee from tbd to davidloeffler.


---

Comment by mderickx created at 2012-11-27 23:41:00

Changing component from PLEASE CHANGE to number fields.


---

Comment by robharron created at 2013-04-08 02:47:21

This works for me in sage 5.8. This ticket should be closed.


---

Comment by mderickx created at 2013-04-08 11:13:57

Indeed, I can confirm that it works now. I added a patch that contains a doctest in order to make sure this doesn't break in the future.


---

Comment by mderickx created at 2013-04-08 11:13:57

Changing status from new to needs_review.


---

Attachment


---

Comment by mstreng created at 2013-04-08 11:26:25

is there no such doctest in the patch that fixed this?


---

Comment by mderickx created at 2013-04-08 11:44:49

Well, I have no idea wich ticket fixed this. And I couldn't find a doctest which tests this somewhere.


---

Comment by mstreng created at 2013-04-08 12:38:38

Replying to [comment:7 mderickx]:
> Well, I have no idea wich ticket fixed this.

#13687

> And I couldn't find a doctest which tests this somewhere.

Coercion from the abstract unit group to the number field is tested by #13687.

```
sage: UK.gen(0) + K.one()   # coerce abstract generator into number field
```

Conversion the other way around already had a test.

```
sage: [UK(u) for u in (x^4-1).roots(K,multiplicities=False)]
```

The coercion framework will then make sure that "in" also works correctly. I don't think another test is necessary.

Enhancing the documentation by explaining that "in" works in this case is nice, but then make sure the English grammar is correct in the patch as well. And there are issues like the fact that `u0^6` may depend on the pari version, since any even exponent is correct, so this test will break later.

I propose to just close this ticket as duplicate instead :)


---

Comment by mderickx created at 2013-04-08 15:33:58

Changing status from needs_review to positive_review.


---

Comment by mderickx created at 2013-04-08 15:35:05

Ok, I changed it to duplicate/invalid/wontfix and gave it positive review status so that Jeroen can close this.


---

Comment by mstreng created at 2013-04-08 15:40:10

(just making it a bit clearer/easier for Jeroen)


---

Comment by jdemeyer created at 2013-04-10 08:12:47

Replying to [comment:11 mstreng]:
> (just making it a bit clearer/easier for Jeroen)
Absolutely, thanks!


---

Comment by jdemeyer created at 2013-04-10 08:12:47

Resolution: duplicate
