# Issue 26695: Upgrade to givaro-4.1.0 fflas-ffpack-2.4.0 linbox-1.6.0

archive/issues_026695.json:
```json
{
    "body": "CC:  @kiwifb @timokau\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/26932\n\n",
    "created_at": "2018-12-21T13:33:55Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.9",
    "title": "Upgrade to givaro-4.1.0 fflas-ffpack-2.4.0 linbox-1.6.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26695",
    "user": "https://github.com/ClementPernet"
}
```
CC:  @kiwifb @timokau



Issue created by migration from https://trac.sagemath.org/ticket/26932





---

archive/issue_events_066701.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-15T18:15:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26695#event-66701"
}
```



---

archive/issue_comments_374947.json:
```json
{
    "body": "Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.",
    "created_at": "2019-01-15T18:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374947",
    "user": "https://github.com/embray"
}
```

Retarging tickets optimistically to the next milestone.  If you are responsible for this ticket (either its reporter or owner) and don't believe you are likely to complete this ticket before the next release (8.7) please retarget this ticket's milestone to sage-pending or sage-wishlist.



---

archive/issue_comments_374948.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-21T16:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374948",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374949.json:
```json
{
    "body": "Tarballs of released packages (with appropriate names) can be found at:\n* https://ljk.imag.fr/membres/Clement.Pernet/soft/givaro-4.1.0rc0.tar.gz\n* https://ljk.imag.fr/membres/Clement.Pernet/soft/fflas_ffpack-2.4.0rc0.tar.bz2\n* https://ljk.imag.fr/membres/Clement.Pernet/soft/linbox-1.6.0rc0.tar.gz\n\nI'll release the 3 libraries soon, but I meant to check that they could be smoothly updating into sage before hand, therefore this ticket proposes to apply the rc0 versions temporarily. Once everything is in order, I'll cut the releases, and checksums accordingly in this branch.",
    "created_at": "2019-02-21T16:19:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374949",
    "user": "https://github.com/ClementPernet"
}
```

Tarballs of released packages (with appropriate names) can be found at:
* https://ljk.imag.fr/membres/Clement.Pernet/soft/givaro-4.1.0rc0.tar.gz
* https://ljk.imag.fr/membres/Clement.Pernet/soft/fflas_ffpack-2.4.0rc0.tar.bz2
* https://ljk.imag.fr/membres/Clement.Pernet/soft/linbox-1.6.0rc0.tar.gz

I'll release the 3 libraries soon, but I meant to check that they could be smoothly updating into sage before hand, therefore this ticket proposes to apply the rc0 versions temporarily. Once everything is in order, I'll cut the releases, and checksums accordingly in this branch.



---

archive/issue_comments_374950.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-05T09:45:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374950",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374951.json:
```json
{
    "body": "For the record, the branch currently breaks several doctests.\n\n```\n----------------------------------------------------------------------\nsage -t src/sage/algebras/free_algebra.py  # 2 doctests failed\nsage -t src/sage/algebras/letterplace/free_algebra_element_letterplace.pyx  # 9 doctests failed\nsage -t src/sage/algebras/letterplace/free_algebra_letterplace.pyx  # 3 doctests failed\nsage -t src/sage/coding/bch.py  # 2 doctests failed\nsage -t src/sage/coding/extended_code.py  # 1 doctest failed\nsage -t src/sage/dynamics/arithmetic_dynamics/generic_ds.py  # 4 doctests failed\nsage -t src/sage/schemes/elliptic_curves/isogeny_small_degree.py  # 1 doctest failed\nsage -t src/sage/schemes/elliptic_curves/ell_curve_isogeny.py  # 1 doctest failed\nsage -t src/sage/schemes/generic/scheme.py  # 2 doctests failed\nsage -t src/sage/schemes/curves/projective_curve.py  # 9 doctests failed\nsage -t src/sage/schemes/hyperelliptic_curves/hyperelliptic_finite_field.py  # 1 doctest failed\nsage -t src/sage/interfaces/sage0.py  # 1 doctest failed\nsage -t src/sage/rings/fraction_field.py  # 1 doctest failed\nsage -t src/sage/rings/polynomial/multi_polynomial.pyx  # 1 doctest failed\nsage -t src/sage/rings/polynomial/flatten.py  # 1 doctest failed\nsage -t src/sage/rings/polynomial/multi_polynomial_ideal.py  # 5 doctests failed\nsage -t src/sage/rings/polynomial/multi_polynomial_element.py  # 1 doctest failed\nsage -t src/sage/crypto/mq/rijndael_gf.py  # 73 doctests failed\n----------------------------------------------------------------------\n```\n\nGivaro::GFqDom seems to be the culprit. I'm working on it.",
    "created_at": "2019-03-05T13:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374951",
    "user": "https://github.com/ClementPernet"
}
```

For the record, the branch currently breaks several doctests.

```
----------------------------------------------------------------------
sage -t src/sage/algebras/free_algebra.py  # 2 doctests failed
sage -t src/sage/algebras/letterplace/free_algebra_element_letterplace.pyx  # 9 doctests failed
sage -t src/sage/algebras/letterplace/free_algebra_letterplace.pyx  # 3 doctests failed
sage -t src/sage/coding/bch.py  # 2 doctests failed
sage -t src/sage/coding/extended_code.py  # 1 doctest failed
sage -t src/sage/dynamics/arithmetic_dynamics/generic_ds.py  # 4 doctests failed
sage -t src/sage/schemes/elliptic_curves/isogeny_small_degree.py  # 1 doctest failed
sage -t src/sage/schemes/elliptic_curves/ell_curve_isogeny.py  # 1 doctest failed
sage -t src/sage/schemes/generic/scheme.py  # 2 doctests failed
sage -t src/sage/schemes/curves/projective_curve.py  # 9 doctests failed
sage -t src/sage/schemes/hyperelliptic_curves/hyperelliptic_finite_field.py  # 1 doctest failed
sage -t src/sage/interfaces/sage0.py  # 1 doctest failed
sage -t src/sage/rings/fraction_field.py  # 1 doctest failed
sage -t src/sage/rings/polynomial/multi_polynomial.pyx  # 1 doctest failed
sage -t src/sage/rings/polynomial/flatten.py  # 1 doctest failed
sage -t src/sage/rings/polynomial/multi_polynomial_ideal.py  # 5 doctests failed
sage -t src/sage/rings/polynomial/multi_polynomial_element.py  # 1 doctest failed
sage -t src/sage/crypto/mq/rijndael_gf.py  # 73 doctests failed
----------------------------------------------------------------------
```

Givaro::GFqDom seems to be the culprit. I'm working on it.



---

archive/issue_events_066702.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26695#event-66702"
}
```



---

archive/issue_events_066703.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-03-25T10:56:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26695#event-66703"
}
```



---

archive/issue_comments_374952.json:
```json
{
    "body": "Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)",
    "created_at": "2019-03-25T10:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374952",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed (if you don't believe this ticket is appropriate for the Sage 8.8 release please retarget manually)



---

archive/issue_comments_374953.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-04T16:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374953",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374954.json:
```json
{
    "body": "For the record, the source of the above-mentionned bugs has been identified to a change in givaro GFqDom interface. It has been fixed now, and we can move forward on this ticket.",
    "created_at": "2019-05-02T07:09:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374954",
    "user": "https://github.com/ClementPernet"
}
```

For the record, the source of the above-mentionned bugs has been identified to a change in givaro GFqDom interface. It has been fixed now, and we can move forward on this ticket.



---

archive/issue_comments_374955.json:
```json
{
    "body": "I don't suppose any of these are tested on Cygwin?  I'm happy to do so if not, I just wondered.",
    "created_at": "2019-05-02T14:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374955",
    "user": "https://github.com/embray"
}
```

I don't suppose any of these are tested on Cygwin?  I'm happy to do so if not, I just wondered.



---

archive/issue_comments_374956.json:
```json
{
    "body": "The 3 libraries are tested on cygwin. We currently have an unsolved bug of fflas-ffpack which seem to be cygwin specific: [https://github.com/linbox-team/fflas-ffpack/issues/248](https://github.com/linbox-team/fflas-ffpack/issues/248)\n\nHowever, I personnaly don't have a cygwin box on which I could test this ticket, so I appreciate your proposition to test the ticket once I put it in \"needs review\", or shortly before doing so.",
    "created_at": "2019-05-02T14:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374956",
    "user": "https://github.com/ClementPernet"
}
```

The 3 libraries are tested on cygwin. We currently have an unsolved bug of fflas-ffpack which seem to be cygwin specific: [https://github.com/linbox-team/fflas-ffpack/issues/248](https://github.com/linbox-team/fflas-ffpack/issues/248)

However, I personnaly don't have a cygwin box on which I could test this ticket, so I appreciate your proposition to test the ticket once I put it in "needs review", or shortly before doing so.



---

archive/issue_comments_374957.json:
```json
{
    "body": "Thanks Clement, will do.  I'll also have a look at that bug.",
    "created_at": "2019-05-03T14:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374957",
    "user": "https://github.com/embray"
}
```

Thanks Clement, will do.  I'll also have a look at that bug.



---

archive/issue_comments_374958.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-10T16:14:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374958",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374959.json:
```json
{
    "body": "I have just released the 3 libraries and updated the sage bindings accordingly.\nSage test suite passes on my box. The ticket is ready for review.\nI may post later on some benchmarks advertising the performance gain from this update.",
    "created_at": "2019-05-10T16:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374959",
    "user": "https://github.com/ClementPernet"
}
```

I have just released the 3 libraries and updated the sage bindings accordingly.
Sage test suite passes on my box. The ticket is ready for review.
I may post later on some benchmarks advertising the performance gain from this update.



---

archive/issue_comments_374960.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-05-10T16:16:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374960",
    "user": "https://github.com/ClementPernet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_374961.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-13T14:32:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374961",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374962.json:
```json
{
    "body": "Update: I realized that there was a mismatch between the tar.gz on github and the published md5, sha1 and cksum checks. I updated the tar.gz of the three libraries to their actual values on github. \n\nIn addition, we fixed some minor issues in the linbox-auto-install and the dependency version checking  system and therefore release 1.6.1 consequently. I have thus updated this ticket to linbox-1.6.1 accordingly.",
    "created_at": "2019-05-13T14:36:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374962",
    "user": "https://github.com/ClementPernet"
}
```

Update: I realized that there was a mismatch between the tar.gz on github and the published md5, sha1 and cksum checks. I updated the tar.gz of the three libraries to their actual values on github. 

In addition, we fixed some minor issues in the linbox-auto-install and the dependency version checking  system and therefore release 1.6.1 consequently. I have thus updated this ticket to linbox-1.6.1 accordingly.



---

archive/issue_comments_374963.json:
```json
{
    "body": "For what it's wroth the linbox 1.6.0 update broke the build *on nixos* for [darwin](https://nix-cache.s3.amazonaws.com/log/qjcscs69g4qayfadz8lagxa0nxjm0hc6-linbox-1.6.0.drv) and [aarch64](https://nix-cache.s3.amazonaws.com/log/ifhzq8jqhcrz81y75cvxz9rs6dws5hny-linbox-1.6.0.drv). That may be an issue for sage as well.",
    "created_at": "2019-05-13T17:37:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374963",
    "user": "https://github.com/timokau"
}
```

For what it's wroth the linbox 1.6.0 update broke the build *on nixos* for [darwin](https://nix-cache.s3.amazonaws.com/log/qjcscs69g4qayfadz8lagxa0nxjm0hc6-linbox-1.6.0.drv) and [aarch64](https://nix-cache.s3.amazonaws.com/log/ifhzq8jqhcrz81y75cvxz9rs6dws5hny-linbox-1.6.0.drv). That may be an issue for sage as well.



---

archive/issue_comments_374964.json:
```json
{
    "body": "Thanks for the feedback.\n- for the darwin bug, this is a bug in the test-suite file tests/test-qlup.C which I just fixed upstream. It does not have any impact on the main library itself.\n- for the aarch64 bug, it seems that some SIMD has been detected at configure time by reading hte CPUID (SSE2 enabled), but the definition of the `__m128i` type is absent. The header file with these definition should be included in `fflas-ffpack/utils/fflas_intrinsic.h` where I read that `arm_neon.h` gets included. However its seems that the intrinsics there are totally different from the intel/amd ones (I have no experience with ARM). I guess you will hit the same bugs building fflas-ffpack and givaro don't you? And they probably already existed with linbox-1.5.2 fflas-ffpack-2.3.2, givaro-4.0.4. As an easy fix I suggest to force disable these SIMD at configure time (`--disable-sse --disable-sse2`). If no-one with experience on ARM and SIMD can help enabling it, I will then auto-disable these simd in the configure scripts when ARM target is detected. Bug reported upstream https://github.com/linbox-team/linbox/issues/215",
    "created_at": "2019-05-14T14:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374964",
    "user": "https://github.com/ClementPernet"
}
```

Thanks for the feedback.
- for the darwin bug, this is a bug in the test-suite file tests/test-qlup.C which I just fixed upstream. It does not have any impact on the main library itself.
- for the aarch64 bug, it seems that some SIMD has been detected at configure time by reading hte CPUID (SSE2 enabled), but the definition of the `__m128i` type is absent. The header file with these definition should be included in `fflas-ffpack/utils/fflas_intrinsic.h` where I read that `arm_neon.h` gets included. However its seems that the intrinsics there are totally different from the intel/amd ones (I have no experience with ARM). I guess you will hit the same bugs building fflas-ffpack and givaro don't you? And they probably already existed with linbox-1.5.2 fflas-ffpack-2.3.2, givaro-4.0.4. As an easy fix I suggest to force disable these SIMD at configure time (`--disable-sse --disable-sse2`). If no-one with experience on ARM and SIMD can help enabling it, I will then auto-disable these simd in the configure scripts when ARM target is detected. Bug reported upstream https://github.com/linbox-team/linbox/issues/215



---

archive/issue_comments_374965.json:
```json
{
    "body": "Ok scratch what I said about the aarch64 problem. I got confused between the 2 logs and did not realized that no SIMD was detected with the aarch64 build. The bug is much simpler, and I think I fixed it upstream. As I can not test it on an aarch64 system, could you confirm that it is now fixed?\nI built a prerelease https://ljk.imag.fr/membres/Clement.Pernet/soft/linbox-1.6.2alpha0.tar.gz for you to test it. It should fix the two above issues.",
    "created_at": "2019-05-15T07:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374965",
    "user": "https://github.com/ClementPernet"
}
```

Ok scratch what I said about the aarch64 problem. I got confused between the 2 logs and did not realized that no SIMD was detected with the aarch64 build. The bug is much simpler, and I think I fixed it upstream. As I can not test it on an aarch64 system, could you confirm that it is now fixed?
I built a prerelease https://ljk.imag.fr/membres/Clement.Pernet/soft/linbox-1.6.2alpha0.tar.gz for you to test it. It should fix the two above issues.



---

archive/issue_comments_374966.json:
```json
{
    "body": "Thanks for looking into this!\n\nThe tarball you linked wasn't able to run tests (apparently some files are missing: `test-smith-form.h: No such file or directory`). Instead I'm testing the [latest](https://github.com/linbox-team/linbox/commit/dd17635a8676794fdaaafe060aaabb91f60bfac4) commit on github.\n\nThis is running on our CI right now (I don't have direct access to aarch64/darwin myself). You can see the status  in the \"checks\" on this [GitHub](GitHub) PR: https://github.com/NixOS/nixpkgs/pull/61535",
    "created_at": "2019-05-15T08:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374966",
    "user": "https://github.com/timokau"
}
```

Thanks for looking into this!

The tarball you linked wasn't able to run tests (apparently some files are missing: `test-smith-form.h: No such file or directory`). Instead I'm testing the [latest](https://github.com/linbox-team/linbox/commit/dd17635a8676794fdaaafe060aaabb91f60bfac4) commit on github.

This is running on our CI right now (I don't have direct access to aarch64/darwin myself). You can see the status  in the "checks" on this [GitHub](GitHub) PR: https://github.com/NixOS/nixpkgs/pull/61535



---

archive/issue_comments_374967.json:
```json
{
    "body": "I can't believe this one did not get caught earlier. I fixed it upstream and prepared https://ljk.imag.fr/membres/Clement.Pernet/soft/linbox-1.6.2alpha1.tar.gz accordingly in case it helps.",
    "created_at": "2019-05-15T08:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374967",
    "user": "https://github.com/ClementPernet"
}
```

I can't believe this one did not get caught earlier. I fixed it upstream and prepared https://ljk.imag.fr/membres/Clement.Pernet/soft/linbox-1.6.2alpha1.tar.gz accordingly in case it helps.



---

archive/issue_comments_374968.json:
```json
{
    "body": "We usually build from the git repository anyways, so it doesn't make much difference.\n\nThe aarch64 build succeeded, but darwin is still failing: https://logs.nix.ci/?key=nixos/nixpkgs.61535&attempt_id=da868da3-0fdc-45df-98b0-7cb18ed6f867",
    "created_at": "2019-05-15T09:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374968",
    "user": "https://github.com/timokau"
}
```

We usually build from the git repository anyways, so it doesn't make much difference.

The aarch64 build succeeded, but darwin is still failing: https://logs.nix.ci/?key=nixos/nixpkgs.61535&attempt_id=da868da3-0fdc-45df-98b0-7cb18ed6f867



---

archive/issue_comments_374969.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-05-24T08:24:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374969",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374970.json:
```json
{
    "body": "I released linbox-1.6.2 fixing the bugs raised by gh-timokau  and updated the branch accordingly.",
    "created_at": "2019-05-24T08:27:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374970",
    "user": "https://github.com/ClementPernet"
}
```

I released linbox-1.6.2 fixing the bugs raised by gh-timokau  and updated the branch accordingly.



---

archive/issue_comments_374971.json:
```json
{
    "body": "I can confirm that those are fixed, thank you!",
    "created_at": "2019-05-24T16:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374971",
    "user": "https://github.com/timokau"
}
```

I can confirm that those are fixed, thank you!



---

archive/issue_comments_374972.json:
```json
{
    "body": "Is someone who has already looked at it willing to set this to a positive review? Otherwise I will doublecheck things on my (ubuntu) machine and then flip it positive.",
    "created_at": "2019-05-30T00:06:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374972",
    "user": "https://github.com/tscrim"
}
```

Is someone who has already looked at it willing to set this to a positive review? Otherwise I will doublecheck things on my (ubuntu) machine and then flip it positive.



---

archive/issue_comments_374973.json:
```json
{
    "body": "Thanks!",
    "created_at": "2019-05-30T17:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374973",
    "user": "https://github.com/timokau"
}
```

Thanks!



---

archive/issue_comments_374974.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-05-30T17:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374974",
    "user": "https://github.com/timokau"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_374975.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-06-02T22:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374975",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066704.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-02T22:04:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26695#event-66704"
}
```



---

archive/issue_comments_374976.json:
```json
{
    "body": "I was going to report that I had this issue testing linbox in gentoo\n\n```\nx86_64-pc-linux-gnu-g++ -DHAVE_CONFIG_H -I. -I..  -DLinBoxTestOnly -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -g -DNDEBUG -U_LB_DEBUG -I.. -DARCH_X86_64=1 -DOPENBLAS___64BIT__=1 -DARCH_X86_64=1 -DOPENBLAS___64BIT__=1 -fopenmp -DFFLAS_COMPILED -DFFPACK_COMPILED -fabi-version=6 -I/usr/include/openblas        -march=native -O2 -pipe  -msse -msse2 -msse3 -mssse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -c -o test-serialization.o test-serialization.C\ntest-serialization.C:32:10: fatal error: linbox/util/serialization.h: No such file or directory\n   32 | #include \"linbox/util/serialization.h\"\n      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n```\nI see that a fix has been committed in linbox [https://github.com/linbox-team/linbox/commit/5a0aac2662969289c50fb9dec2fd2e597a276815](https://github.com/linbox-team/linbox/commit/5a0aac2662969289c50fb9dec2fd2e597a276815) unfortunately it requires a new tarball to be completely fixed since the problem is that some files have not been included in the 1.6.2 tarball [and earlier probably]. What is the ETA for that?",
    "created_at": "2019-06-03T22:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374976",
    "user": "https://github.com/kiwifb"
}
```

I was going to report that I had this issue testing linbox in gentoo

```
x86_64-pc-linux-gnu-g++ -DHAVE_CONFIG_H -I. -I..  -DLinBoxTestOnly -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -g -DNDEBUG -U_LB_DEBUG -I.. -DARCH_X86_64=1 -DOPENBLAS___64BIT__=1 -DARCH_X86_64=1 -DOPENBLAS___64BIT__=1 -fopenmp -DFFLAS_COMPILED -DFFPACK_COMPILED -fabi-version=6 -I/usr/include/openblas        -march=native -O2 -pipe  -msse -msse2 -msse3 -mssse3 -msse4.1 -msse4.2 -mavx -mavx2 -mfma -c -o test-serialization.o test-serialization.C
test-serialization.C:32:10: fatal error: linbox/util/serialization.h: No such file or directory
   32 | #include "linbox/util/serialization.h"
      |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
```
I see that a fix has been committed in linbox [https://github.com/linbox-team/linbox/commit/5a0aac2662969289c50fb9dec2fd2e597a276815](https://github.com/linbox-team/linbox/commit/5a0aac2662969289c50fb9dec2fd2e597a276815) unfortunately it requires a new tarball to be completely fixed since the problem is that some files have not been included in the 1.6.2 tarball [and earlier probably]. What is the ETA for that?



---

archive/issue_comments_374977.json:
```json
{
    "body": "These missing files do not impact the part of LinBox used in Sage. The compilation failure is in the test-suite.\nI can release v1.6.3 of LinBox very shortly if you think it should be fixed for the next sage release. \nI guess, it will happen in another ticket as this one is now closed.",
    "created_at": "2019-06-04T07:06:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374977",
    "user": "https://github.com/ClementPernet"
}
```

These missing files do not impact the part of LinBox used in Sage. The compilation failure is in the test-suite.
I can release v1.6.3 of LinBox very shortly if you think it should be fixed for the next sage release. 
I guess, it will happen in another ticket as this one is now closed.



---

archive/issue_comments_374978.json:
```json
{
    "body": "Replying to [comment:36 cpernet]:\n> These missing files do not impact the part of LinBox used in Sage. The compilation failure is in the test-suite.\n> I can release v1.6.3 of LinBox very shortly if you think it should be fixed for the next sage release. \n> I guess, it will happen in another ticket as this one is now closed.\n\n\nYes, I should have said it is in the test suite. I don't know, Volker may choose to re-open if it causes troubles with bots running `spkg-check` on packages.",
    "created_at": "2019-06-04T07:25:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374978",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:36 cpernet]:
> These missing files do not impact the part of LinBox used in Sage. The compilation failure is in the test-suite.
> I can release v1.6.3 of LinBox very shortly if you think it should be fixed for the next sage release. 
> I guess, it will happen in another ticket as this one is now closed.


Yes, I should have said it is in the test suite. I don't know, Volker may choose to re-open if it causes troubles with bots running `spkg-check` on packages.



---

archive/issue_comments_374979.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2019-06-04T22:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374979",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_events_066705.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-06-04T22:20:54Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26695#event-66705"
}
```



---

archive/issue_comments_374980.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2019-06-04T22:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374980",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_374981.json:
```json
{
    "body": "On 32-bit the sage library doesn't build:\n\n```\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp: In function \u2018long unsigned int __pyx_f_4sage_4libs_6linbox_22linbox_flint_interface_linbox_fmpz_mat_rank(fmpz_mat_struct*)\u2019:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: error: no matching function for call to \u2018rank(long unsigned int&, LinBox::DenseMatrix<Givaro::ZRing<Givaro::Integer> >&)\u2019\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:75:17: note: candidate: template<class Blackbox, class Method, class DomainCategory> size_t& LinBox::rank(size_t&, const Blackbox&, const DomainCategory&, const Method&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t &r, const Blackbox &A,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:75:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:92:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t &r, const Blackbox &A)\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:92:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   cannot convert \u2018__pyx_v_r\u2019 (type \u2018long unsigned int\u2019) to type \u2018size_t& {aka unsigned int&}\u2019\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:109:17: note: candidate: template<class Blackbox, class Method> size_t& LinBox::rank(size_t&, const Blackbox&, const Method&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t &r, const Blackbox &A,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:109:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 3 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:44:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Auto&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                    &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:44:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:60:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Elimination&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                     &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:60:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:75:17: note: candidate: template<class Field, class Vector> size_t& LinBox::rank(size_t&, const LinBox::SparseMatrix<_Field, _Storage>&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Elimination&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                      &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:75:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   \u2018LinBox::DenseMatrix<Givaro::ZRing<Givaro::Integer> > {aka LinBox::BlasMatrix<Givaro::ZRing<Givaro::Integer>, std::vector<Givaro::Integer> >}\u2019 is not derived from \u2018const LinBox::SparseMatrix<_Field, _Storage>\u2019\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:503:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Blackbox&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                     &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:503:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:93:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Wiedemann&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                     &res,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:93:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:388:17: note: candidate: template<class Field> size_t& LinBox::rank(size_t&, const LinBox::SparseMatrix<_Field, LinBox::SparseMatrixFormat::SparseSeq>&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::SparseElimination&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                       &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:388:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   \u2018LinBox::DenseMatrix<Givaro::ZRing<Givaro::Integer> > {aka LinBox::BlasMatrix<Givaro::ZRing<Givaro::Integer>, std::vector<Givaro::Integer> >}\u2019 is not derived from \u2018const LinBox::SparseMatrix<_Field, LinBox::SparseMatrixFormat::SparseSeq>\u2019\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:400:17: note: candidate: template<class Blackbox, class DomainCategory> size_t& LinBox::rank(size_t&, const Blackbox&, const DomainCategory&, const LinBox::Method::SparseElimination&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                       &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:400:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:413:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::DenseElimination&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                      &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:413:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:458:17: note: candidate: template<class Blackbox, class MyMethod> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::IntegerTag&, const MyMethod&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                     &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:458:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:468:17: note: candidate: template<class Blackbox, class Method> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::RationalTag&, const Method&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t                           &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:468:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n[sagelib-8.8.beta7]                                                   ^\n[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,\n[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:483:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::RationalTag&, const LinBox::Method::SparseElimination&)\n[sagelib-8.8.beta7]   inline size_t &rank (size_t           &r,\n[sagelib-8.8.beta7]                  ^~~~\n[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:483:17: note:   template argument deduction/substitution failed:\n[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided\n[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));\n```",
    "created_at": "2019-06-04T22:27:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374981",
    "user": "https://github.com/vbraun"
}
```

On 32-bit the sage library doesn't build:

```
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp: In function ‘long unsigned int __pyx_f_4sage_4libs_6linbox_22linbox_flint_interface_linbox_fmpz_mat_rank(fmpz_mat_struct*)’:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: error: no matching function for call to ‘rank(long unsigned int&, LinBox::DenseMatrix<Givaro::ZRing<Givaro::Integer> >&)’
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:75:17: note: candidate: template<class Blackbox, class Method, class DomainCategory> size_t& LinBox::rank(size_t&, const Blackbox&, const DomainCategory&, const Method&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t &r, const Blackbox &A,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:75:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:92:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t &r, const Blackbox &A)
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:92:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   cannot convert ‘__pyx_v_r’ (type ‘long unsigned int’) to type ‘size_t& {aka unsigned int&}’
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:109:17: note: candidate: template<class Blackbox, class Method> size_t& LinBox::rank(size_t&, const Blackbox&, const Method&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t &r, const Blackbox &A,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:109:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 3 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:44:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Auto&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                    &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:44:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:60:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Elimination&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                     &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:60:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:75:17: note: candidate: template<class Field, class Vector> size_t& LinBox::rank(size_t&, const LinBox::SparseMatrix<_Field, _Storage>&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Elimination&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                      &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:75:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   ‘LinBox::DenseMatrix<Givaro::ZRing<Givaro::Integer> > {aka LinBox::BlasMatrix<Givaro::ZRing<Givaro::Integer>, std::vector<Givaro::Integer> >}’ is not derived from ‘const LinBox::SparseMatrix<_Field, _Storage>’
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:503:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Blackbox&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                     &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:503:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:93:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::Wiedemann&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                     &res,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:93:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:388:17: note: candidate: template<class Field> size_t& LinBox::rank(size_t&, const LinBox::SparseMatrix<_Field, LinBox::SparseMatrixFormat::SparseSeq>&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::SparseElimination&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                       &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:388:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   ‘LinBox::DenseMatrix<Givaro::ZRing<Givaro::Integer> > {aka LinBox::BlasMatrix<Givaro::ZRing<Givaro::Integer>, std::vector<Givaro::Integer> >}’ is not derived from ‘const LinBox::SparseMatrix<_Field, LinBox::SparseMatrixFormat::SparseSeq>’
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:400:17: note: candidate: template<class Blackbox, class DomainCategory> size_t& LinBox::rank(size_t&, const Blackbox&, const DomainCategory&, const LinBox::Method::SparseElimination&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                       &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:400:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:413:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::ModularTag&, const LinBox::Method::DenseElimination&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                      &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:413:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:458:17: note: candidate: template<class Blackbox, class MyMethod> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::IntegerTag&, const MyMethod&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                     &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:458:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:468:17: note: candidate: template<class Blackbox, class Method> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::RationalTag&, const Method&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t                           &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:468:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
[sagelib-8.8.beta7]                                                   ^
[sagelib-8.8.beta7] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:131:0,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47,
[sagelib-8.8.beta7]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.8.beta7]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1233:
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:483:17: note: candidate: template<class Blackbox> size_t& LinBox::rank(size_t&, const Blackbox&, const LinBox::RingCategories::RationalTag&, const LinBox::Method::SparseElimination&)
[sagelib-8.8.beta7]   inline size_t &rank (size_t           &r,
[sagelib-8.8.beta7]                  ^~~~
[sagelib-8.8.beta7] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.inl:483:17: note:   template argument deduction/substitution failed:
[sagelib-8.8.beta7] build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:1792:50: note:   candidate expects 4 arguments, 2 provided
[sagelib-8.8.beta7]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_LBA[0])));
```



---

archive/issue_comments_374982.json:
```json
{
    "body": "You may as well get a linbox 1.6.3 in at the same time, me and the other distros that look at testsuite results would be very grateful to have a working testsuite.",
    "created_at": "2019-06-05T01:17:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374982",
    "user": "https://github.com/kiwifb"
}
```

You may as well get a linbox 1.6.3 in at the same time, me and the other distros that look at testsuite results would be very grateful to have a working testsuite.



---

archive/issue_comments_374983.json:
```json
{
    "body": "I am a little confused, the testsuite runs fine on nixos (64 bit). Is it maybe because we fetch directly from the github tag?\n\n---\nLast 10 new commits:",
    "created_at": "2019-06-05T08:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374983",
    "user": "https://github.com/timokau"
}
```

I am a little confused, the testsuite runs fine on nixos (64 bit). Is it maybe because we fetch directly from the github tag?

---
Last 10 new commits:



---

archive/issue_comments_374984.json:
```json
{
    "body": "Replying to [comment:42 gh-timokau]:\n> I am a little confused, the testsuite runs fine on nixos (64 bit). Is it maybe because we fetch directly from the github tag?\n\n\nYes. I am using the tarball generated by `make sdist` and which is the one linked in the ticket description. A git checkout will test fine but not the generated tarball.",
    "created_at": "2019-06-05T08:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374984",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:42 gh-timokau]:
> I am a little confused, the testsuite runs fine on nixos (64 bit). Is it maybe because we fetch directly from the github tag?


Yes. I am using the tarball generated by `make sdist` and which is the one linked in the ticket description. A git checkout will test fine but not the generated tarball.



---

archive/issue_comments_374985.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-07T14:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374985",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374986.json:
```json
{
    "body": "I just released new minor revisions of linbox (1.6.3) fflas-ffpack (2.4.1) and givaro (4.1.1), \n* taking into account the above problems and fixing other minor issues such as \n* including the README.md in the distro, \n* fixing fflas-ffpack API for parallel calls from [SageMath](SageMath) (in preparation of #27444).\nI updated the current branch and ticket accordingly, and it is now again ready for review.",
    "created_at": "2019-06-07T14:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374986",
    "user": "https://github.com/ClementPernet"
}
```

I just released new minor revisions of linbox (1.6.3) fflas-ffpack (2.4.1) and givaro (4.1.1), 
* taking into account the above problems and fixing other minor issues such as 
* including the README.md in the distro, 
* fixing fflas-ffpack API for parallel calls from [SageMath](SageMath) (in preparation of #27444).
I updated the current branch and ticket accordingly, and it is now again ready for review.



---

archive/issue_comments_374987.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-06-07T14:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374987",
    "user": "https://github.com/ClementPernet"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_374988.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-11T08:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374988",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374989.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-06-11T11:43:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374989",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374990.json:
```json
{
    "body": "I just did 2 last fixes of some bugs which shamelessly went through the prerelease testing.\nNo more fixes are expected, and the ticket is still open for review, with fflas-ffpack-2.4.3 version (I updated the branch and ticket description accordingly).",
    "created_at": "2019-06-11T11:48:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374990",
    "user": "https://github.com/ClementPernet"
}
```

I just did 2 last fixes of some bugs which shamelessly went through the prerelease testing.
No more fixes are expected, and the ticket is still open for review, with fflas-ffpack-2.4.3 version (I updated the branch and ticket description accordingly).



---

archive/issue_comments_374991.json:
```json
{
    "body": "Testsuite of givaro, fflas-ffpack, linbox passes for me on Linux-64, osx-64 on conda. Any chance we could get this ticket tested and reviewed soon?",
    "created_at": "2019-06-19T06:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374991",
    "user": "https://github.com/isuruf"
}
```

Testsuite of givaro, fflas-ffpack, linbox passes for me on Linux-64, osx-64 on conda. Any chance we could get this ticket tested and reviewed soon?



---

archive/issue_comments_374992.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-02T16:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374992",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_066706.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-03T06:53:22Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "milestone": "sage-8.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26695#event-66706"
}
```



---

archive/issue_events_066707.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-07-03T06:53:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26695#event-66707"
}
```



---

archive/issue_comments_374993.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-07-03T10:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374993",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_374994.json:
```json
{
    "body": "Doesn't build on 32-bit:\n\nDebian 10 32-bit:\n\n```\n[sagelib-8.9.beta0] [ 5/15] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I./sage/libs/flint -I./sage/cpython -I./sage/ext -I./sage/libs/ntl -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I./sage/rings -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/cypari2 -I./sage/rings/finite_rings -Isage/cpython -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/src -I/var/lib/buildbot/slave/sage_git/build/src/sage/ext -I/var/lib/buildbot/slave/sage_git/build/local/include/python2.7 -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -Ibuild/cythonized -I/var/lib/buildbot/slave/sage_git/build/local/include/python2.7 -c build/cythonized/sage/matrix/matrix_integer_dense.c -o build/temp.linux-i686-2.7/build/cythonized/sage/matrix/matrix_integer_dense.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99 -g -fPIC -Wall -O2 -mmmx -msse -msse2 -msse3 -I/var/lib/buildbot/slave/sage_git/build/local/include/m4ri -I/var/lib/buildbot/slave/sage_git/build/local/include\n[sagelib-8.9.beta0] In file included from /var/lib/buildbot/slave/sage_git/build/local/include/recint/ruint.h:53,\n[sagelib-8.9.beta0]                  from /var/lib/buildbot/slave/sage_git/build/local/include/givaro/modular-ruint.h:14,\n[sagelib-8.9.beta0]                  from /var/lib/buildbot/slave/sage_git/build/local/include/givaro/modular.h:26,\n[sagelib-8.9.beta0]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:722:\n[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h: In member function \u2018Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::Element& Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::init(Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::Element&, const Givaro::Integer&) const [with _Storage_t = RecInt::ruint<7>; _Compute_t = RecInt::ruint<8>]\u2019:\n[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:214:65: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta0]              udiv_qrnnd(q.Value, c, a2.Value, a1.Value, b1.Value);\n[sagelib-8.9.beta0]                                                                  ^\n[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:214:65: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta0]              udiv_qrnnd(q.Value, c, a2.Value, a1.Value, b1.Value);\n[sagelib-8.9.beta0]                                                                  ^\n[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta0]          umul_ppmm(d1, d0, q.Value, b0.Value);\n[sagelib-8.9.beta0]                                              ^\n[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta0]          umul_ppmm(d1, d0, q.Value, b0.Value);\n[sagelib-8.9.beta0]                                              ^\n[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta0] [ 6/15] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I./sage/cpython -I./sage/ext -I./sage/libs/flint -I./sage/libs/ntl -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -Isage/libs/flint -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/src -I/var/lib/buildbot/slave/sage_git/build/src/sage/ext -I/var/lib/buildbot/slave/sage_git/build/local/include/python2.7 -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -Ibuild/cythonized -I/var/lib/buildbot/slave/sage_git/build/local/include/python2.7 -c build/cythonized/sage/matrix/matrix_integer_sparse.cpp -o build/temp.linux-i686-2.7/build/cythonized/sage/matrix/matrix_integer_sparse.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -DFFLAS_COMPILED -DFFPACK_COMPILED -std=gnu++11 -mfpmath=sse -fabi-version=6 -I/var/lib/buildbot/slave/sage_git/build/local/include\n[sagelib-8.9.beta0] cc1plus: warning: SSE instruction set disabled, using 387 arithmetics\n[sagelib-8.9.beta0] error: command 'gcc' failed with exit status 1\n[sagelib-8.9.beta0] make[4]: *** [Makefile:33: sage] Error 1\n```\n\n\nDebian 8, 9 32-bit:\n\n```\n[sagelib-8.9.beta0] [ 6/13] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I./sage/cpython -I./sage/ext -I./sage/libs/flint -I./sage/libs/ntl -I/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -Isage/libs/flint -I/home/buildbot/slave/sage_git/build/local/include -I/home/buildbot/slave/sage_git/build/src -I/home/buildbot/slave/sage_git/build/src/sage/ext -I/home/buildbot/slave/sage_git/build/local/include/python2.7 -I/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -Ibuild/cythonized -I/home/buildbot/slave/sage_git/build/local/include/python2.7 -c build/cythonized/sage/matrix/matrix_integer_sparse.cpp -o build/temp.linux-i686-2.7/build/cythonized/sage/matrix/matrix_integer_sparse.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -DFFLAS_COMPILED -DFFPACK_COMPILED -fpermissive -std=gnu++11 -mfpmath=sse -fabi-version=6 -I/home/buildbot/slave/sage_git/build/local/include\n[sagelib-8.9.beta0] build/cythonized/sage/matrix/matrix_integer_sparse.cpp:1:0: warning: SSE instruction set disabled, using 387 arithmetics\n[sagelib-8.9.beta0]  /* Generated by Cython 0.29.10 */\n[sagelib-8.9.beta0]  ^\n[sagelib-8.9.beta0] build/cythonized/sage/matrix/matrix_integer_sparse.cpp: In function \u2018PyObject* __pyx_pf_4sage_6matrix_21matrix_integer_sparse_21Matrix_integer_sparse_30_rank_linbox(__pyx_obj_4sage_6matrix_21matrix_integer_sparse_Matrix_integer_sparse*)\u2019:\n[sagelib-8.9.beta0] build/cythonized/sage/matrix/matrix_integer_sparse.cpp:7765:48: error: no matching function for call to \u2018rank(long unsigned int&, LinBox::SparseMatrix<Givaro::ZRing<Givaro::Integer> >&)\u2019\n[sagelib-8.9.beta0]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_M[0])));\n[sagelib-8.9.beta0]                                                 ^\n[sagelib-8.9.beta0] build/cythonized/sage/matrix/matrix_integer_sparse.cpp:7765:48: note: candidates are:\n[sagelib-8.9.beta0] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47:0,\n[sagelib-8.9.beta0]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,\n[sagelib-8.9.beta0]                  from build/cythonized/sage/matrix/matrix_integer_sparse.cpp:4384:\n[sagelib-8.9.beta0] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:75:17: note: template<class Blackbox, class Method, class DomainCategory> size_t& LinBox::rank(size_t&, const Blackbox&, const DomainCategory&, const Method&)\n[sagelib-8.9.beta0]   inline size_t &rank (size_t &r, const Blackbox &A,\n[sagelib-8.9.beta0]                  ^\n```",
    "created_at": "2019-07-03T10:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374994",
    "user": "https://github.com/vbraun"
}
```

Doesn't build on 32-bit:

Debian 10 32-bit:

```
[sagelib-8.9.beta0] [ 5/15] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I./sage/libs/flint -I./sage/cpython -I./sage/ext -I./sage/libs/ntl -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I./sage/rings -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/cypari2 -I./sage/rings/finite_rings -Isage/cpython -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/src -I/var/lib/buildbot/slave/sage_git/build/src/sage/ext -I/var/lib/buildbot/slave/sage_git/build/local/include/python2.7 -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -Ibuild/cythonized -I/var/lib/buildbot/slave/sage_git/build/local/include/python2.7 -c build/cythonized/sage/matrix/matrix_integer_dense.c -o build/temp.linux-i686-2.7/build/cythonized/sage/matrix/matrix_integer_dense.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99 -g -fPIC -Wall -O2 -mmmx -msse -msse2 -msse3 -I/var/lib/buildbot/slave/sage_git/build/local/include/m4ri -I/var/lib/buildbot/slave/sage_git/build/local/include
[sagelib-8.9.beta0] In file included from /var/lib/buildbot/slave/sage_git/build/local/include/recint/ruint.h:53,
[sagelib-8.9.beta0]                  from /var/lib/buildbot/slave/sage_git/build/local/include/givaro/modular-ruint.h:14,
[sagelib-8.9.beta0]                  from /var/lib/buildbot/slave/sage_git/build/local/include/givaro/modular.h:26,
[sagelib-8.9.beta0]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:722:
[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h: In member function ‘Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::Element& Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::init(Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::Element&, const Givaro::Integer&) const [with _Storage_t = RecInt::ruint<7>; _Compute_t = RecInt::ruint<8>]’:
[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:214:65: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta0]              udiv_qrnnd(q.Value, c, a2.Value, a1.Value, b1.Value);
[sagelib-8.9.beta0]                                                                  ^
[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:214:65: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta0]              udiv_qrnnd(q.Value, c, a2.Value, a1.Value, b1.Value);
[sagelib-8.9.beta0]                                                                  ^
[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta0]          umul_ppmm(d1, d0, q.Value, b0.Value);
[sagelib-8.9.beta0]                                              ^
[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta0]          umul_ppmm(d1, d0, q.Value, b0.Value);
[sagelib-8.9.beta0]                                              ^
[sagelib-8.9.beta0] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta0] [ 6/15] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I./sage/cpython -I./sage/ext -I./sage/libs/flint -I./sage/libs/ntl -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -Isage/libs/flint -I/var/lib/buildbot/slave/sage_git/build/local/include -I/var/lib/buildbot/slave/sage_git/build/src -I/var/lib/buildbot/slave/sage_git/build/src/sage/ext -I/var/lib/buildbot/slave/sage_git/build/local/include/python2.7 -I/var/lib/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -Ibuild/cythonized -I/var/lib/buildbot/slave/sage_git/build/local/include/python2.7 -c build/cythonized/sage/matrix/matrix_integer_sparse.cpp -o build/temp.linux-i686-2.7/build/cythonized/sage/matrix/matrix_integer_sparse.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -DFFLAS_COMPILED -DFFPACK_COMPILED -std=gnu++11 -mfpmath=sse -fabi-version=6 -I/var/lib/buildbot/slave/sage_git/build/local/include
[sagelib-8.9.beta0] cc1plus: warning: SSE instruction set disabled, using 387 arithmetics
[sagelib-8.9.beta0] error: command 'gcc' failed with exit status 1
[sagelib-8.9.beta0] make[4]: *** [Makefile:33: sage] Error 1
```


Debian 8, 9 32-bit:

```
[sagelib-8.9.beta0] [ 6/13] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I./sage/cpython -I./sage/ext -I./sage/libs/flint -I./sage/libs/ntl -I/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -Isage/libs/flint -I/home/buildbot/slave/sage_git/build/local/include -I/home/buildbot/slave/sage_git/build/src -I/home/buildbot/slave/sage_git/build/src/sage/ext -I/home/buildbot/slave/sage_git/build/local/include/python2.7 -I/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -Ibuild/cythonized -I/home/buildbot/slave/sage_git/build/local/include/python2.7 -c build/cythonized/sage/matrix/matrix_integer_sparse.cpp -o build/temp.linux-i686-2.7/build/cythonized/sage/matrix/matrix_integer_sparse.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -O2 -Wall -g -DNDEBUG -U_LB_DEBUG -DDISABLE_COMMENTATOR -DFFLAS_COMPILED -DFFPACK_COMPILED -fpermissive -std=gnu++11 -mfpmath=sse -fabi-version=6 -I/home/buildbot/slave/sage_git/build/local/include
[sagelib-8.9.beta0] build/cythonized/sage/matrix/matrix_integer_sparse.cpp:1:0: warning: SSE instruction set disabled, using 387 arithmetics
[sagelib-8.9.beta0]  /* Generated by Cython 0.29.10 */
[sagelib-8.9.beta0]  ^
[sagelib-8.9.beta0] build/cythonized/sage/matrix/matrix_integer_sparse.cpp: In function ‘PyObject* __pyx_pf_4sage_6matrix_21matrix_integer_sparse_21Matrix_integer_sparse_30_rank_linbox(__pyx_obj_4sage_6matrix_21matrix_integer_sparse_Matrix_integer_sparse*)’:
[sagelib-8.9.beta0] build/cythonized/sage/matrix/matrix_integer_sparse.cpp:7765:48: error: no matching function for call to ‘rank(long unsigned int&, LinBox::SparseMatrix<Givaro::ZRing<Givaro::Integer> >&)’
[sagelib-8.9.beta0]    (void)(LinBox::rank(__pyx_v_r, (__pyx_v_M[0])));
[sagelib-8.9.beta0]                                                 ^
[sagelib-8.9.beta0] build/cythonized/sage/matrix/matrix_integer_sparse.cpp:7765:48: note: candidates are:
[sagelib-8.9.beta0] In file included from /home/buildbot/slave/sage_git/build/local/include/linbox/algorithms/bbcharpoly.h:47:0,
[sagelib-8.9.beta0]                  from /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/charpoly.h:34,
[sagelib-8.9.beta0]                  from build/cythonized/sage/matrix/matrix_integer_sparse.cpp:4384:
[sagelib-8.9.beta0] /home/buildbot/slave/sage_git/build/local/include/linbox/solutions/rank.h:75:17: note: template<class Blackbox, class Method, class DomainCategory> size_t& LinBox::rank(size_t&, const Blackbox&, const DomainCategory&, const Method&)
[sagelib-8.9.beta0]   inline size_t &rank (size_t &r, const Blackbox &A,
[sagelib-8.9.beta0]                  ^
```



---

archive/issue_comments_374995.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-04T12:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374995",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374996.json:
```json
{
    "body": "I pushed a fix to the second bug (size_t vs unsigned long in calling `LinBox::rank`). I'm still waiting for a build of sage on a 32 bit ubuntu to finish, to confirm that the bug is no longer there.\n\nAs for the first bug, do you confirm that it only shows up in Debian 10 ?\nI have no clue what is going on there, and can not reproduce it as I don't have a 32 bit Debian at hand. Looking at other instances of the bug, it seems related to asm code explicitly using some registers (like %ebx) that gcc reserves for PIC offsets. Altough the `umul_ppmm` indeed uses some asm code (in reclonglong.h) in does not use %ebx explicitly, and more surprisingly, the other error, for `udiv_qrnd` does not involve any asm code.\n\nThis part of givaro's code is not used in Sage, so an easy fix is to comment out line 26 of `givaro/src/kernel/ring/modular.h`.",
    "created_at": "2019-07-04T14:25:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374996",
    "user": "https://github.com/ClementPernet"
}
```

I pushed a fix to the second bug (size_t vs unsigned long in calling `LinBox::rank`). I'm still waiting for a build of sage on a 32 bit ubuntu to finish, to confirm that the bug is no longer there.

As for the first bug, do you confirm that it only shows up in Debian 10 ?
I have no clue what is going on there, and can not reproduce it as I don't have a 32 bit Debian at hand. Looking at other instances of the bug, it seems related to asm code explicitly using some registers (like %ebx) that gcc reserves for PIC offsets. Altough the `umul_ppmm` indeed uses some asm code (in reclonglong.h) in does not use %ebx explicitly, and more surprisingly, the other error, for `udiv_qrnd` does not involve any asm code.

This part of givaro's code is not used in Sage, so an easy fix is to comment out line 26 of `givaro/src/kernel/ring/modular.h`.



---

archive/issue_comments_374997.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-05T07:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374997",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_374998.json:
```json
{
    "body": "I added a fix to another size_t issue. I confirm that the current branch compiles and passes the test-suite on a 32 bit ubuntu xenial I could have access to.",
    "created_at": "2019-07-05T15:24:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374998",
    "user": "https://github.com/ClementPernet"
}
```

I added a fix to another size_t issue. I confirm that the current branch compiles and passes the test-suite on a 32 bit ubuntu xenial I could have access to.



---

archive/issue_comments_374999.json:
```json
{
    "body": "Yes, I get the error only on Debian 10 32-bit. Thats gcc 8.3.0. My guess would be that all sufficiently new compiler versions fail. The next oldest 32-bit machine is Ubuntu 18 / gcc 7.3.0 and that passes.\n\nI don't think the error is about EBX, you are free to use it in inline asm as long as you restore it (at least on gcc >=5 and as long as you don't make function calls / use the PLT).\n\nI haven't tried to figure out which of the many inline asm implementations is selected but various do specify constraints `\"=&r\" (sl)` which maybe be inconsistent (presumably meaning unsatisfyable).",
    "created_at": "2019-07-06T12:38:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-374999",
    "user": "https://github.com/vbraun"
}
```

Yes, I get the error only on Debian 10 32-bit. Thats gcc 8.3.0. My guess would be that all sufficiently new compiler versions fail. The next oldest 32-bit machine is Ubuntu 18 / gcc 7.3.0 and that passes.

I don't think the error is about EBX, you are free to use it in inline asm as long as you restore it (at least on gcc >=5 and as long as you don't make function calls / use the PLT).

I haven't tried to figure out which of the many inline asm implementations is selected but various do specify constraints `"=&r" (sl)` which maybe be inconsistent (presumably meaning unsatisfyable).



---

archive/issue_comments_375000.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-16T17:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375000",
    "user": "https://github.com/isuruf"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_375001.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-07-16T17:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375001",
    "user": "https://github.com/isuruf"
}
```

New commits:



---

archive/issue_comments_375002.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-16T22:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375002",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_375003.json:
```json
{
    "body": "Let's try it again.",
    "created_at": "2019-07-16T22:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375003",
    "user": "https://github.com/kiwifb"
}
```

Let's try it again.



---

archive/issue_comments_375004.json:
```json
{
    "body": "Ok, I finally got some time to get back to this problem. I doubt the fix above will work (I tried on a 32bit box and it still fails, as recint is also included in fflas-ffpack).\n\nThe problem is that two copies of the file longlong.h from GNU GMP are shipped: one in flint (longlong.h) and one in givaro (reclonglong.h). Flint has stripped down the file to a minimalistic set of definitions while givaro's version is the complete original one.\n\nThe problem is that these file define macros in the global namespace and conflict one with the other. I therefore added a `#ifdef add_ssaaaa` in givaro's reclonglong.h to yield whenever flint's longlong.h was already included.\n\nHowever, givaro's forces the NO_ASM macro which skips all ASM dependent defines and makes the calls to `umul_ppmm` and other also work on i386 even when passed 64 bits ints. However, flint longlong.h removed the NO_ASM section, and therefore compiles the ASM variants of these routines, thus triggering the compilation failure.\nI will fix givaro's `reclonglong.h` so that it undefs the symbols conflicting with flint and redefines them in its own way.",
    "created_at": "2019-07-17T15:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375004",
    "user": "https://github.com/ClementPernet"
}
```

Ok, I finally got some time to get back to this problem. I doubt the fix above will work (I tried on a 32bit box and it still fails, as recint is also included in fflas-ffpack).

The problem is that two copies of the file longlong.h from GNU GMP are shipped: one in flint (longlong.h) and one in givaro (reclonglong.h). Flint has stripped down the file to a minimalistic set of definitions while givaro's version is the complete original one.

The problem is that these file define macros in the global namespace and conflict one with the other. I therefore added a `#ifdef add_ssaaaa` in givaro's reclonglong.h to yield whenever flint's longlong.h was already included.

However, givaro's forces the NO_ASM macro which skips all ASM dependent defines and makes the calls to `umul_ppmm` and other also work on i386 even when passed 64 bits ints. However, flint longlong.h removed the NO_ASM section, and therefore compiles the ASM variants of these routines, thus triggering the compilation failure.
I will fix givaro's `reclonglong.h` so that it undefs the symbols conflicting with flint and redefines them in its own way.



---

archive/issue_comments_375005.json:
```json
{
    "body": "Fix doesn't work, for the record. Still fails with the \n\n```\n[sagelib-8.9.beta2] In file included from /var/lib/buildbot/slave/sage_git/build/local/include/recint/ruint.h:53:0,\n[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/givaro/modular-ruint.h:14,\n[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/givaro/modular.h:26,\n[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/field/field-traits.h:30,\n[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/field/gf2.h:40,\n[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/vector/stream-gf2.h:77,\n[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/vector/stream.h:872,\n[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/matrix/densematrix/blas-matrix.h:42,\n[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/matrix/dense-matrix.h:79,\n[sagelib-8.9.beta2]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:727:\n[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h: In member function \u2018Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::Element& Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::init(Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::Element&, const Givaro::Integer&) const [with _Storage_t = RecInt::ruint<7>; _Compute_t = RecInt::ruint<8>]\u2019:\n[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:214:65: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta2]              udiv_qrnnd(q.Value, c, a2.Value, a1.Value, b1.Value);\n[sagelib-8.9.beta2]                                                                  ^\n[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:214:65: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta2]              udiv_qrnnd(q.Value, c, a2.Value, a1.Value, b1.Value);\n[sagelib-8.9.beta2]                                                                  ^\n[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta2]          umul_ppmm(d1, d0, q.Value, b0.Value);\n[sagelib-8.9.beta2]                                              ^\n[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an \u2018asm\u2019\n[sagelib-8.9.beta2]          umul_ppmm(d1, d0, q.Value, b0.Value);\n[sagelib-8.9.beta2]                                              ^\n[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an \u2018asm\u2019\n```",
    "created_at": "2019-07-18T21:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375005",
    "user": "https://github.com/vbraun"
}
```

Fix doesn't work, for the record. Still fails with the 

```
[sagelib-8.9.beta2] In file included from /var/lib/buildbot/slave/sage_git/build/local/include/recint/ruint.h:53:0,
[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/givaro/modular-ruint.h:14,
[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/givaro/modular.h:26,
[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/field/field-traits.h:30,
[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/field/gf2.h:40,
[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/vector/stream-gf2.h:77,
[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/vector/stream.h:872,
[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/matrix/densematrix/blas-matrix.h:42,
[sagelib-8.9.beta2]                  from /var/lib/buildbot/slave/sage_git/build/local/include/linbox/matrix/dense-matrix.h:79,
[sagelib-8.9.beta2]                  from build/cythonized/sage/libs/linbox/linbox_flint_interface.cpp:727:
[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h: In member function ‘Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::Element& Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::init(Givaro::Modular<_Storage_t, _Compute_t, typename std::enable_if<(is_same_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value || is_smaller_ruint< <template-parameter-1-1>, <template-parameter-1-2> >::value)>::type>::Element&, const Givaro::Integer&) const [with _Storage_t = RecInt::ruint<7>; _Compute_t = RecInt::ruint<8>]’:
[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:214:65: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta2]              udiv_qrnnd(q.Value, c, a2.Value, a1.Value, b1.Value);
[sagelib-8.9.beta2]                                                                  ^
[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:214:65: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta2]              udiv_qrnnd(q.Value, c, a2.Value, a1.Value, b1.Value);
[sagelib-8.9.beta2]                                                                  ^
[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta2]          umul_ppmm(d1, d0, q.Value, b0.Value);
[sagelib-8.9.beta2]                                              ^
[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an ‘asm’
[sagelib-8.9.beta2]          umul_ppmm(d1, d0, q.Value, b0.Value);
[sagelib-8.9.beta2]                                              ^
[sagelib-8.9.beta2] /var/lib/buildbot/slave/sage_git/build/local/include/recint/rudiv.h:222:45: error: inconsistent operand constraints in an ‘asm’
```



---

archive/issue_comments_375006.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-07-18T21:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375006",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_375007.json:
```json
{
    "body": "I pushed a patch to givaro, which basically changes the name on givaro's side of all macros which definition where in conflict between flint (longlong.h) and givaro (reclonglong.h) by prefixing them with `recint_`.\n\nThis change solves the problem on the 32bit ubuntu machine where I could reproduce the bug.\n\n---\nNew commits:",
    "created_at": "2019-07-19T14:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375007",
    "user": "https://github.com/ClementPernet"
}
```

I pushed a patch to givaro, which basically changes the name on givaro's side of all macros which definition where in conflict between flint (longlong.h) and givaro (reclonglong.h) by prefixing them with `recint_`.

This change solves the problem on the 32bit ubuntu machine where I could reproduce the bug.

---
New commits:



---

archive/issue_comments_375008.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-19T14:38:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375008",
    "user": "https://github.com/ClementPernet"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_375009.json:
```json
{
    "body": "Thanks. `@`vbraun, can you review this?",
    "created_at": "2019-07-24T01:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375009",
    "user": "https://github.com/isuruf"
}
```

Thanks. `@`vbraun, can you review this?



---

archive/issue_comments_375010.json:
```json
{
    "body": "With this branch and using sagelib built against system libraries, I'm getting\n\n```\nFile \"/usr/lib/python2.7/site-packages/sage/matrix/matrix_double_dense.pyx\", line 2517, in sage.matrix.matrix_double_dense.Matrix_double_dense.is_unitary\nFailed example:\n    P.is_unitary(algorithm='orthonormal')\nExpected:\n    Traceback (most recent call last):\n    ...\n    error: ((lwork==-1)||(lwork >= MAX(1,2*n))) failed for 3rd keyword lwork: zgees:lwork=0\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/usr/lib/python2.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1105, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.matrix.matrix_double_dense.Matrix_double_dense.is_unitary[23]>\", line 1, in <module>\n        P.is_unitary(algorithm='orthonormal')\n      File \"sage/matrix/matrix_double_dense.pyx\", line 2568, in sage.matrix.matrix_double_dense.Matrix_double_dense.is_unitary (build/cythonized/sage/matrix/matrix_double_dense.c:16152)\n        _, T = self.schur(base_ring=sage.rings.complex_double.CDF)\n      File \"sage/matrix/matrix_double_dense.pyx\", line 3268, in sage.matrix.matrix_double_dense.Matrix_double_dense.schur (build/cythonized/sage/matrix/matrix_double_dense.c:19274)\n        T._matrix_numpy, Q._matrix_numpy = scipy.linalg.schur(self._matrix_numpy, output=format)\n      File \"/usr/lib/python2.7/site-packages/scipy/linalg/decomp_schur.py\", line 139, in schur\n        result = gees(lambda x: None, a1, lwork=-1)\n    ValueError: On entry to ZGEES parameter number 6 had an illegal value\n```\nAny ideas?",
    "created_at": "2019-07-24T14:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375010",
    "user": "https://github.com/antonio-rojas"
}
```

With this branch and using sagelib built against system libraries, I'm getting

```
File "/usr/lib/python2.7/site-packages/sage/matrix/matrix_double_dense.pyx", line 2517, in sage.matrix.matrix_double_dense.Matrix_double_dense.is_unitary
Failed example:
    P.is_unitary(algorithm='orthonormal')
Expected:
    Traceback (most recent call last):
    ...
    error: ((lwork==-1)||(lwork >= MAX(1,2*n))) failed for 3rd keyword lwork: zgees:lwork=0
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/usr/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/lib/python2.7/site-packages/sage/doctest/forker.py", line 1105, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.matrix.matrix_double_dense.Matrix_double_dense.is_unitary[23]>", line 1, in <module>
        P.is_unitary(algorithm='orthonormal')
      File "sage/matrix/matrix_double_dense.pyx", line 2568, in sage.matrix.matrix_double_dense.Matrix_double_dense.is_unitary (build/cythonized/sage/matrix/matrix_double_dense.c:16152)
        _, T = self.schur(base_ring=sage.rings.complex_double.CDF)
      File "sage/matrix/matrix_double_dense.pyx", line 3268, in sage.matrix.matrix_double_dense.Matrix_double_dense.schur (build/cythonized/sage/matrix/matrix_double_dense.c:19274)
        T._matrix_numpy, Q._matrix_numpy = scipy.linalg.schur(self._matrix_numpy, output=format)
      File "/usr/lib/python2.7/site-packages/scipy/linalg/decomp_schur.py", line 139, in schur
        result = gees(lambda x: None, a1, lwork=-1)
    ValueError: On entry to ZGEES parameter number 6 had an illegal value
```
Any ideas?



---

archive/issue_comments_375011.json:
```json
{
    "body": "Yes. It is not related to this ticket but to the way we sometimes package openblas in distro compared to sage. I have had this doctest failure for several months now. https://github.com/cschwan/sage-on-gentoo/commit/1a5fefec74c222ee5d0673bb439c6d5a3b0c6e1e#commitcomment-30999803 has some gory details if you get down in it. The culprit is not so much sage than it is scipy in a way. It is all down to the `xerbla` routine effectively used https://github.com/cschwan/sage-on-gentoo/commit/1a5fefec74c222ee5d0673bb439c6d5a3b0c6e1e#commitcomment-31035447 and after.\n\nIn any case this is not related to this ticket.",
    "created_at": "2019-07-24T20:42:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375011",
    "user": "https://github.com/kiwifb"
}
```

Yes. It is not related to this ticket but to the way we sometimes package openblas in distro compared to sage. I have had this doctest failure for several months now. https://github.com/cschwan/sage-on-gentoo/commit/1a5fefec74c222ee5d0673bb439c6d5a3b0c6e1e#commitcomment-30999803 has some gory details if you get down in it. The culprit is not so much sage than it is scipy in a way. It is all down to the `xerbla` routine effectively used https://github.com/cschwan/sage-on-gentoo/commit/1a5fefec74c222ee5d0673bb439c6d5a3b0c6e1e#commitcomment-31035447 and after.

In any case this is not related to this ticket.



---

archive/issue_comments_375012.json:
```json
{
    "body": "Replying to [comment:70 fbissey]:\n \n> In any case this is not related to this ticket.\n\n\nAfter some investigation, in my case this turned out to be caused by linking fflas-ffpack with --as-needed - apparently this strips a bit too many linked libs. I started linking with --as-needed with the 2.4.0 update so that made me think it was related to the upgrade.",
    "created_at": "2019-07-24T22:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375012",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:70 fbissey]:
 
> In any case this is not related to this ticket.


After some investigation, in my case this turned out to be caused by linking fflas-ffpack with --as-needed - apparently this strips a bit too many linked libs. I started linking with --as-needed with the 2.4.0 update so that made me think it was related to the upgrade.



---

archive/issue_comments_375013.json:
```json
{
    "body": "That's very strange because the failure above occurs during a call to a function in scipy. It is supposed to fail but the error message and the point it break is different depending on the version of `xerbla` (C or Fortran) used.",
    "created_at": "2019-07-24T22:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375013",
    "user": "https://github.com/kiwifb"
}
```

That's very strange because the failure above occurs during a call to a function in scipy. It is supposed to fail but the error message and the point it break is different depending on the version of `xerbla` (C or Fortran) used.



---

archive/issue_comments_375014.json:
```json
{
    "body": "I guess the linking may influence the order things are loaded in memory and privilege a call over another.",
    "created_at": "2019-07-24T22:04:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375014",
    "user": "https://github.com/kiwifb"
}
```

I guess the linking may influence the order things are loaded in memory and privilege a call over another.



---

archive/issue_comments_375015.json:
```json
{
    "body": "Numpy has a `python_xerbla.c` file and a `xerbla_` inside which is supposed to override the xerbla from BLAS and give a nice exception. We should create a new ticket for the xerbla issue",
    "created_at": "2019-07-24T22:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375015",
    "user": "https://github.com/isuruf"
}
```

Numpy has a `python_xerbla.c` file and a `xerbla_` inside which is supposed to override the xerbla from BLAS and give a nice exception. We should create a new ticket for the xerbla issue



---

archive/issue_comments_375016.json:
```json
{
    "body": "Replying to [comment:74 isuruf]:\n> Numpy has a `python_xerbla.c` file and a `xerbla_` inside which is supposed to override the xerbla from BLAS and give a nice exception. We should create a new ticket for the xerbla issue\n\n\nI didn't know that. In that case the over-ridding is obviously not working under some conditions. Is it a bug in sage, scipy or numpy? Digging this a bit more.",
    "created_at": "2019-07-24T22:15:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375016",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:74 isuruf]:
> Numpy has a `python_xerbla.c` file and a `xerbla_` inside which is supposed to override the xerbla from BLAS and give a nice exception. We should create a new ticket for the xerbla issue


I didn't know that. In that case the over-ridding is obviously not working under some conditions. Is it a bug in sage, scipy or numpy? Digging this a bit more.



---

archive/issue_comments_375017.json:
```json
{
    "body": "Actually, the numpy source file you are pointing to gives the error message we see in some sage-on-distros as opposed to the one seen in vanilla sage. The source file is in two places in numpy. Once in linalg/lapack_lite which seems to indicate that this is used when numpy is configured without an external lapack. The other copy is in core/src/common, it is unclear if it is always compiled or not at this stage.",
    "created_at": "2019-07-24T22:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375017",
    "user": "https://github.com/kiwifb"
}
```

Actually, the numpy source file you are pointing to gives the error message we see in some sage-on-distros as opposed to the one seen in vanilla sage. The source file is in two places in numpy. Once in linalg/lapack_lite which seems to indicate that this is used when numpy is configured without an external lapack. The other copy is in core/src/common, it is unclear if it is always compiled or not at this stage.



---

archive/issue_comments_375018.json:
```json
{
    "body": "I'd say `python_xerbla.c` is always compiled. This is from `core/src/common/setupy.py`\n\n```\n    blas_info = get_info('blas_opt', 0)\n    if blas_info and ('HAVE_CBLAS', None) in blas_info.get('define_macros', []):\n        extra_info = blas_info\n        # These files are also in MANIFEST.in so that they are always in\n        # the source distribution independently of HAVE_CBLAS.\n        common_src.extend([join('src', 'common', 'cblasfuncs.c'),\n                           join('src', 'common', 'python_xerbla.c'),\n                          ])\n        if uses_accelerate_framework(blas_info):\n            common_src.extend(get_sgemv_fix())\n    else:\n        extra_info = {}\n```\nFor those who don't know, numpy's build system sets `-DHAVE_CBLAS=NONE` when blas/lapack is found :) When no blas/lapack is provided found, `HAVE_CBLAS` is undefined.\n\nThe `xerbla_` symbol is inserted in `numpy/core/_multiarray_umath.so`. But from experience the scipy call that can give the differing messages never use that and must load a version from blas/lapack otherwise we would never see this difference.",
    "created_at": "2019-07-24T22:41:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375018",
    "user": "https://github.com/kiwifb"
}
```

I'd say `python_xerbla.c` is always compiled. This is from `core/src/common/setupy.py`

```
    blas_info = get_info('blas_opt', 0)
    if blas_info and ('HAVE_CBLAS', None) in blas_info.get('define_macros', []):
        extra_info = blas_info
        # These files are also in MANIFEST.in so that they are always in
        # the source distribution independently of HAVE_CBLAS.
        common_src.extend([join('src', 'common', 'cblasfuncs.c'),
                           join('src', 'common', 'python_xerbla.c'),
                          ])
        if uses_accelerate_framework(blas_info):
            common_src.extend(get_sgemv_fix())
    else:
        extra_info = {}
```
For those who don't know, numpy's build system sets `-DHAVE_CBLAS=NONE` when blas/lapack is found :) When no blas/lapack is provided found, `HAVE_CBLAS` is undefined.

The `xerbla_` symbol is inserted in `numpy/core/_multiarray_umath.so`. But from experience the scipy call that can give the differing messages never use that and must load a version from blas/lapack otherwise we would never see this difference.



---

archive/issue_comments_375019.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-07-30T05:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375019",
    "user": "https://github.com/isuruf"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_375020.json:
```json
{
    "body": "Putting this into positive review, so that it's tested again.",
    "created_at": "2019-07-30T05:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375020",
    "user": "https://github.com/isuruf"
}
```

Putting this into positive review, so that it's tested again.



---

archive/issue_comments_375021.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-08-01T22:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375021",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_066708.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-08-01T22:55:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/26695#event-66708"
}
```



---

archive/issue_comments_375022.json:
```json
{
    "body": "This released fixed\n\n```\nsage: m = diagonal_matrix(ZZ, [2] * 46)\nsage: m._det_linbox()\n70368744177664\nsage: m = diagonal_matrix(ZZ, [3] * 100)\nsage: m._det_linbox()\n515377520732011331036461129765621272702107522001\n```\nsee #28318",
    "created_at": "2019-08-03T13:58:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26695",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26695#issuecomment-375022",
    "user": "https://github.com/videlec"
}
```

This released fixed

```
sage: m = diagonal_matrix(ZZ, [2] * 46)
sage: m._det_linbox()
70368744177664
sage: m = diagonal_matrix(ZZ, [3] * 100)
sage: m._det_linbox()
515377520732011331036461129765621272702107522001
```
see #28318
