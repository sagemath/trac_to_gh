# Issue 14173: Move spkg logs to logs/pkgs

Issue created by migration from https://trac.sagemath.org/ticket/14377

Original creator: jdemeyer

Original creation time: 2013-03-29 03:49:39

Assignee: GeorgSWeber

CC:  ohanar ohanar

Save logs of package builds in `logs/pkgs` instead of `spkg/logs`.


---

Comment by jhpalmieri created at 2013-03-29 17:19:51

Here is an untested patch to the root repo, along with a change to the documentation.


---

Comment by jhpalmieri created at 2013-03-29 17:19:51

Changing status from new to needs_review.


---

Comment by ohanar created at 2013-03-30 23:27:02

other than maybe removing the line in `make distclean`, this looks good to me.


---

Comment by ohanar created at 2013-03-30 23:27:02

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2013-03-31 14:50:50

I think for the sake of upgrades, we should leave `make distclean` as is.


---

Comment by kcrisman created at 2013-04-01 13:07:49

Is this going to break anything?  There are probably at least a few "help" questions where spgk/logs is listed as the place to look.  I assume that no one wants it to be in both, of course.

Also, does `make test` still work, though, and put a log somewhere?  Is that still documented anywhere, or was the README the last place?  

Just checking in both cases, I presume by default these are silly questions.


---

Comment by jdemeyer created at 2013-04-01 13:12:21

Replying to [comment:5 kcrisman]:
> Is this going to break anything?  There are probably at least a few "help" questions where spgk/logs is listed as the place to look.  I assume that no one wants it to be in both, of course.
If anything, `logs/pkgs` should be easier to find than `spkg/logs`. And also, when building fails, the error message is now a lot more clear.

> Also, does `make test` still work, though, and put a log somewhere?
Yes, but see #14328 for this (it is unrelated to this ticket, which deals with logs of building packages).

> Is that still documented anywhere
Not that I know.


---

Attachment

root repo


---

Comment by jdemeyer created at 2013-04-01 15:48:18

Rebased to #14226 and added:

```diff
diff --git a/spkg/bin/sage-spkg b/spkg/bin/sage-spkg

Index: spkg/bin/sage-spkg
===================================================================
--- a/spkg/bin/sage-spkg
+++ b/spkg/bin/sage-spkg
@@ -64,13 +64,13 @@
 ************************************************************************
 Please email sage-devel (http://groups.google.com/group/sage-devel)
 explaining the problem and including the relevant part of the log file
-  $SAGE_ROOT/spkg/logs/$PKG_NAME.log
+  $SAGE_LOGS/$PKG_NAME.log
 Describe your computer, operating system, etc.
 If you want to try to fix the problem yourself, *don't* just cd to
 `pwd` and type '$2' or whatever is appropriate.
 Instead, the following commands setup all environment variables
 correctly and load a subshell for you to debug the error:
-  (cd '`pwd`' && '$SAGE_ROOT/sage' -sh)
+  (cd '`pwd`' && '$SAGE_ROOT/sage' --sh)
 When you are done debugging, you can type "exit" to leave the subshell.
 ************************************************************************
 MESSAGE
```



---

Comment by jhpalmieri created at 2013-04-01 16:29:54

Oh, and now I've added this to the Sage library patch:

```diff
diff --git a/sage/env.py b/sage/env.py
--- a/sage/env.py
+++ b/sage/env.py
@@ -41,7 +41,7 @@
         'SAGE_DATA'        : '$SAGE_SHARE',
         'SAGE_EXTCODE'     : opj('$SAGE_SHARE', 'sage', 'ext'),
         'SAGE_PACKAGES'    : opj('$SAGE_ROOT', 'spkg'),
-        'SAGE_LOGS'        : opj('$SAGE_ROOT', 'spkg', 'logs'),
+        'SAGE_LOGS'        : opj('$SAGE_ROOT', 'logs', 'pkgs'),
         'SAGE_SPKG_INST'   : opj('$SAGE_ROOT', 'spkg', 'installed'),
         'SAGE_DOC'         : opj('$SAGE_ROOT', 'devel', 'sage', 'doc'),
         'DOT_SAGE'         : opj(os.environ.get('HOME','$SAGE_ROOT'), '.sage'),
```



---

Comment by jhpalmieri created at 2013-04-01 16:31:38

documentation change (Sage library)


---

Comment by jdemeyer created at 2013-04-03 09:00:42

Changing priority from major to blocker.


---

Attachment


---

Comment by jdemeyer created at 2013-04-04 17:40:32

Resolution: fixed


---

Comment by leif created at 2013-04-07 11:24:42

When upgrading, it would probably make sense to move old spkg build logs to the new folder, and afterwards create a symlink from `spkg/logs` to `logs/pkg/`.


---

Comment by leif created at 2013-05-12 15:45:01

The odd thing is that this disturbs filename completion `$SAGE_ROOT/l...`; now one has to type three characters to disambiguate `local` from `logs`.

----

Also, why `pkgs`, rather than `spkgs`?  Or `log/[s]pkg[s]/`, which would be consistent (with e.g. `/var/log/`)?

[EDIT: Ooops.]
