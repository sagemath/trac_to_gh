# Issue 28053: remove some deprecated stuff in graphs and digraphs

Issue created by migration from https://trac.sagemath.org/ticket/28290

Original creator: chapoton

Original creation time: 2019-07-30 12:10:03

after #15706


---

Comment by chapoton created at 2019-07-30 12:10:50

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-07-30 12:10:50

New commits:


---

Comment by dcoudert created at 2019-07-30 16:56:32

I have 2 failing doctests

```
sage -t --long src/sage/graphs/base/static_dense_graph.pyx
**********************************************************************
File "src/sage/graphs/base/static_dense_graph.pyx", line 193, in sage.graphs.base.static_dense_graph.is_strongly_regular
Failed example:
    Graph([(1,1),(2,2)]).is_strongly_regular()
Expected:
    Traceback (most recent call last):
    ...
    ValueError: This method is not known to work on graphs with
    loops. Perhaps this method can be updated to handle them, but in the
    meantime if you want to use it please disallow loops using
    allow_loops().
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/dcoudert/sage3/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/dcoudert/sage3/sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1105, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.base.static_dense_graph.is_strongly_regular[14]>", line 1, in <module>
        Graph([(Integer(1),Integer(1)),(Integer(2),Integer(2))]).is_strongly_regular()
      File "/Users/dcoudert/sage3/sage/local/lib/python3.7/site-packages/sage/graphs/graph.py", line 1250, in __init__
        self.add_edges(data)
      File "/Users/dcoudert/sage3/sage/local/lib/python3.7/site-packages/sage/graphs/generic_graph.py", line 10850, in add_edges
        self._backend.add_edge(u, v, label, self._directed)
      File "sage/graphs/base/sparse_graph.pyx", line 1500, in sage.graphs.base.sparse_graph.SparseGraphBackend.add_edge (build/cythonized/sage/graphs/base/sparse_graph.c:17539)
        raise ValueError(f"cannot add edge from {u!r} to {v!r} in graph without loops")
    ValueError: cannot add edge from 1 to 1 in graph without loops
**********************************************************************
File "src/sage/graphs/base/static_dense_graph.pyx", line 200, in sage.graphs.base.static_dense_graph.is_strongly_regular
Failed example:
    Graph([(1,2),(1,2)]).is_strongly_regular()
Expected:
    Traceback (most recent call last):
    ...
    ValueError: This method is not known to work on graphs with
    multiedges. Perhaps this method can be updated to handle them, but in
    the meantime if you want to use it please disallow multiedges using
    allow_multiple_edges().
Got:
    False
```

In the first one, it suffices to change the message of the doctest. In the second one, the multiple edges are ignored by the Graph constructor, and we have

```
sage: G = Graph(multiedges=False)
sage: G.add_edge(1,2)
sage: G.add_edge(1,2)
sage:
```


Also, the default values for `loops` and `multiedges` should be changed to `False` instead of `None`.


---

Comment by dcoudert created at 2019-07-30 16:56:32

Changing status from needs_review to needs_work.


---

Comment by git created at 2019-07-30 18:26:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-07-30 18:27:19

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2019-07-30 18:27:19

I have fixed the doctests.

I would prefer to keep any further refactoring to another ticket, including the suggested change in the default values of loops and multiedges.


---

Comment by git created at 2019-07-31 06:39:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-07-31 06:39:47

fixed another doctest


---

Comment by dcoudert created at 2019-07-31 08:01:27

LGTM.


---

Comment by chapoton created at 2019-07-31 09:18:49

positive review ?


---

Comment by dcoudert created at 2019-07-31 09:19:41

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2019-07-31 09:19:41

oups, sorry.


---

Comment by dcoudert created at 2019-07-31 09:21:06

Changing status from positive_review to needs_work.


---

Comment by dcoudert created at 2019-07-31 09:21:06

actually no, you should remove the import `sage.misc.superseded.deprecation` to avoid pyflakes error.


---

Comment by git created at 2019-07-31 09:23:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-07-31 09:24:15

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2019-07-31 09:24:15

indeed, done


---

Comment by dcoudert created at 2019-07-31 09:26:24

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2019-07-31 09:26:24

OK.


---

Comment by vbraun created at 2019-08-03 08:49:25

Resolution: fixed
