# Issue 26379: Global function fields: places

Issue created by migration from https://trac.sagemath.org/ticket/26616

Original creator: klee

Original creation time: 2018-11-02 07:39:20

This is part of the meta-ticket #22982.

The goal of the present ticket is to add code for computing places of global function fields.



---

Comment by git created at 2018-11-02 07:41:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-11-03 03:13:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2018-11-03 03:16:12

Changing status from new to needs_review.


---

Comment by git created at 2018-11-03 03:20:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-11-04 06:44:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-11-09 06:09:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-11-28 00:28:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-11-28 06:59:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-12-13 06:39:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-12-24 06:24:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2019-01-17 02:38:14

Some comments:

- Perhaps it is my lack of understanding of the field, but is `place` common terminology for `valuation()`? It might be good to keep some indication about it being a prime element.
- What is the reason for `FunctionFieldElement_global.__cached_methods`?
- You should be able to replace `[place for place in self._places_finite(degree)]` with `list(self._places_finite(degree))`. Similarly for the `infinite`.
- I think there is a grammar issue here: `Return the unique place at infinite.` Should it be `Return the unique place at infinity.`?
- Instead of a ``@`cached_method` for `_gens_over_base`, I could consider making it a ``@`lazy_attribute`. (So you then use it as `self._gens_over_base` instead of `self._gens_over_base()`.)
- I am not sure about this change:
  {{{#!diff
-        norm = reduce(operator.mul, hnf.diagonal())
+        norm = 1
+        for e in hnf.diagonal():
+            norm *= e
  }}}
  as it might be slower. However, this is a minor thing (the new code is definitely more readable).
- I do not think you need the `lazy_import('sage.matrix.constructor', 'matrix')` in `sage/rings/function_field/valuation_ring.py`.

Otherwise it does what it says it does, so LGTM.


---

Comment by klee created at 2019-01-17 09:17:24

Replying to [comment:13 tscrim]:
> Some comments:
> 
> - Perhaps it is my lack of understanding of the field, but is `place` common terminology for `valuation()`? It might be good to keep some indication about it being a prime element.

"place" is established terminology in the function field theory. Places correspond, one-to-one, to (discrete) valuation rings of the function field, which  defines valuation of the elements of the function field. In a later stage, I will introduce "divisors", which are central objects in the function field theory. A divisor is defined to be a formal sum of places.  A place is not said to be prime, though "finite" places are in one-to-one correspondence with prime ideals of the "finite" maximal order.


> - What is the reason for `FunctionFieldElement_global.__cached_methods`?

I forgot :-) I removed it.

> - You should be able to replace `[place for place in self._places_finite(degree)]` with `list(self._places_finite(degree))`. Similarly for the `infinite`.

Done. Thanks.

> - I think there is a grammar issue here: `Return the unique place at infinite.` Should it be `Return the unique place at infinity.`?

Right. Fixed.

> - Instead of a ``@`cached_method` for `_gens_over_base`, I could consider making it a ``@`lazy_attribute`. (So you then use it as `self._gens_over_base` instead of `self._gens_over_base()`.)

Ok. Done. Thanks for a good tip.

> - I am not sure about this change:
>   {{{#!diff
> -        norm = reduce(operator.mul, hnf.diagonal())
> +        norm = 1
> +        for e in hnf.diagonal():
> +            norm *= e
>   }}}
>   as it might be slower. However, this is a minor thing (the new code is definitely more readable).

I guess Guido did not remove `reduce` in python3 for no reason. I did a simple experiment (with ints) in python3 and both take the same time. I would prefer to remove `reduce`. 
> - I do not think you need the `lazy_import('sage.matrix.constructor', 'matrix')` in `sage/rings/function_field/valuation_ring.py`.

Removed.

Thank you for giving attention!!


---

Comment by git created at 2019-01-17 09:19:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-01-17 09:22:00

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by klee created at 2019-01-17 09:22:40

Squashed and rebased to sage 8.6.


---

Comment by tscrim created at 2019-01-17 16:39:22

Thank you for the explanation about the definition of a `place`. I learned something new. `<sup>_</sup>`

Do you think you could add that or some variant to `place.py`, either at the module-level or in some key class-level doc? Maybe also with a standard reference for the subject? Once that is done, positive review.

I forgot that `reduce` was moved to `functools`. Thanks for the reminder.


---

Comment by git created at 2019-01-18 03:23:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2019-01-18 05:28:26

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2019-01-18 05:28:26

Thank you.


---

Comment by vbraun created at 2019-01-24 18:18:00

Resolution: fixed
