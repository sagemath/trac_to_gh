# Issue 31291: Cleanup spkg-configure.m4 files that mix tabs and spaces

Issue created by migration from https://trac.sagemath.org/ticket/31528

Original creator: slelievre

Original creation time: 2021-03-20 13:15:39

CC:  dimpase embray mjo mkoeppe slelievre

The spkg-configure files for the following packages
mix tabs and spaces:
arb brial cmake flint gcc gfortran git gmp iml ninja_build pari patch pcre ppl python3 symmetrica.

This ticket is to make them use spaces only.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.


---

Comment by slelievre created at 2021-05-11 13:22:07

Previous related tickets:

- #15436: Cksum uses tabs instead of spaces, breaking sage-spkg's regex
- #13899: Don't use TAB characters for indentation
- #13146: Removing tabs in .rst, .tex and .pxi files

This shell command spots files with tabs
when run from the Sage root folder:

```bash
$ git grep $'\t' . | cut -f 1 -d ":" | uniq \
  | grep -v Make | grep -v -e '^Binary' | grep -v patches
```

In Sage 9.3 it reveals:

```
bootstrap
build/bin/write-dockerfile.sh
build/pkgs/_prereq/distros/freebsd.txt
build/pkgs/arb/spkg-configure.m4
build/pkgs/brial/spkg-configure.m4
build/pkgs/bzip2/spkg-configure.m4
build/pkgs/cmake/spkg-configure.m4
build/pkgs/cvxopt/spkg-install.in
build/pkgs/ecm/spkg-install.in
build/pkgs/flint/spkg-configure.m4
build/pkgs/gcc/spkg-configure.m4
build/pkgs/gfortran/spkg-configure.m4
build/pkgs/git/spkg-configure.m4
build/pkgs/gmp/spkg-configure.m4
build/pkgs/iml/spkg-configure.m4
build/pkgs/ninja_build/spkg-configure.m4
build/pkgs/pari/spkg-configure.m4
build/pkgs/patch/spkg-configure.m4
build/pkgs/pcre/spkg-configure.m4
build/pkgs/ppl/spkg-configure.m4
build/pkgs/python3/spkg-configure.m4
build/pkgs/symmetrica/spkg-configure.m4
m4/ax_absolute_header.m4
m4/ax_compiler_vendor.m4
m4/ax_gcc_option.m4
m4/ax_gxx_option.m4
m4/ax_prog_perl_modules.m4
src/.relint.yml
src/doc/en/developer/portability_testing.rst
src/doc/en/reference/parallel/media/map_reduce_arch.fig
src/sage/ext_data/graphs/graph_plot_js.html
src/sage/ext_data/magma/latex/latex.m
src/sage/ext_data/pari/simon/ell.gp
src/sage/graphs/cliquer/cl.c
src/sage/groups/perm_gps/partn_ref2/refinement_generic.h
src/sage/modular/arithgroup/farey.cpp
src/sage/modular/arithgroup/farey.hpp
src/sage/modular/arithgroup/sl2z.hpp
src/sage/rings/polynomial/weil/power_sums.c
src/sage/rings/polynomial/weil/power_sums.h
```



---

Comment by chapoton created at 2021-08-21 08:16:28

here is a branch
----
New commits:


---

Comment by chapoton created at 2021-08-21 08:16:28

Changing status from new to needs_review.


---

Comment by git created at 2021-08-21 08:20:36

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2021-08-21 08:21:31

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by slelievre created at 2021-08-21 10:22:37

Thanks Frédéric for this branch.

Would someone who knows about spkg-configure.m4
files give the green light on this?


---

Comment by mjo created at 2021-08-21 15:43:09

The m4 and C-language changes all look fine to me at first glance. I'm probably responsible for a few of the tabs in spkg-configure.m4, but I do indeed prefer spaces when I'm paying attention.

Are magma and GP whitespace-insensitive too?


---

Comment by chapoton created at 2021-08-21 16:02:39

> Are magma and GP whitespace-insensitive too?

I think that gp does not care. No idea about magma, but it certainly does not require TABs.


---

Comment by mjo created at 2021-08-21 22:30:28

I took a closer look and added two commits to fix the indentation where it was weird. There are still others, but I don't have time to go through and fix them all. They're not new issues.

The GP change is OK too. I have no way to run the magma code, but since there are already spaces in that file, I guess it's unlikely that changing some existing tabs into more spaces will cause a problem.

If someone can double-check my two new commits (which should contain only whitespace changes), please set to positive review after.


---

Comment by slelievre created at 2021-08-21 22:48:21

Replying to [comment:10 mjo]:
> If someone can double-check my two new commits
> (which should contain only whitespace changes),
> please set to positive review after.

In `build/pkgs/iml/spkg-configure.m4`, besides
fixing indentation, you remove two lines.

Is that intended?


---

Comment by mjo created at 2021-08-21 23:05:19

Replying to [comment:11 slelievre]:
> 
> In `build/pkgs/iml/spkg-configure.m4`, besides
> fixing indentation, you remove two lines.
> 
> Is that intended?

The "dnl" lines? Yeah, those were comments, believe it or not.


---

Comment by dimpase created at 2021-08-25 12:13:30

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2021-08-25 12:13:30

lgtm


---

Comment by slelievre created at 2021-08-28 09:07:34

Setting to critical as this conditions work on
spkg-configure files in other tickets.


---

Comment by slelievre created at 2021-08-28 09:07:34

Changing priority from major to critical.


---

Comment by vbraun created at 2021-08-31 22:01:03

Resolution: fixed
