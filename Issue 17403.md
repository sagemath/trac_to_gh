# Issue 17403: Error in function Graph.odd_girth()

Issue created by migration from https://trac.sagemath.org/ticket/17640

Original creator: ffoucaud

Original creation time: 2015-01-16 07:43:13

Hi,
I'm doing some computations based on enumerating graphs via "nauty_geng()". There, I test the odd girth of the generated graphs, and after several hours of graph enumeration, the computations stop ith errors. The errors seem to come from the function "odd_girth()" associated to the "Graph" class, with, according to the error message, a possible relation with matrices and primes (see below).

Note: I realise that I am using the precompiled version 5.8 of sage that comes with the ubuntu repository (ubuntu 12.04). So maybe this is fixed in newer versions... In any case I will now use the latest release.

Here is my code:


```
def OG7_NOhomC5(begin,end):
    F=[]
    C5=graphs.CycleGraph(5)
    for n in [begin .. end]: #range for orders
        for g in graphs.nauty_geng("%s -c -t -d2 -D6"%n):
            if g.girth()==4 and g.odd_girth()>=7:
                maps=g.has_homomorphism_to(C5)
                if maps == False:
                    F += [(g.graph6_string())]
                    print ' found :-)',F

OG7_NOhomC5(14,14)
```




And here are 2 different tracebacks, both with an error located in "odd_girth()":


```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_3.py", line 10, in <module>
    exec compile(u'open("___code___.py","w").write("# -*- coding: utf-8 -*-\\n" + _support_.preparse_worksheet_cell(base64.b64decode("T0c3X05PaG9tQzUoMTQsMTQp"),globals())+"\\n"); execfile(os.path.abspath("___code___.py"))
  File "", line 1, in <module>
    
  File "/tmp/tmpPMZ4j_/___code___.py", line 3, in <module>
    exec compile(u'OG7_NOhomC5(_sage_const_14 ,_sage_const_14 )
  File "", line 1, in <module>
    
  File "/tmp/tmp1XHck_/___code___.py", line 10, in OG7_NOhomC5
    if g.girth()==_sage_const_4  and g.odd_girth()>=_sage_const_7 :
  File "/usr/lib/sagemath/local/lib/python2.7/site-packages/sage/graphs/graph.py", line 2388, in odd_girth
    ch = ((self.am()).charpoly()).coeffs()
  File "matrix_integer_dense.pyx", line 1042, in sage.matrix.matrix_integer_dense.Matrix_integer_dense.charpoly (sage/matrix/matrix_integer_dense.c:11571)
  File "matrix_integer_dense.pyx", line 1099, in sage.matrix.matrix_integer_dense.Matrix_integer_dense._charpoly_linbox (sage/matrix/matrix_integer_dense.c:12253)
  File "matrix_integer_dense.pyx", line 1121, in sage.matrix.matrix_integer_dense.Matrix_integer_dense._poly_linbox (sage/matrix/matrix_integer_dense.c:12534)
RuntimeError: Segmentation fault
```




```
you are running out of primes. 1000 coprime primes foundTraceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_4.py", line 10, in <module>
    exec compile(u'open("___code___.py","w").write("# -*- coding: utf-8 -*-\\n" + _support_.preparse_worksheet_cell(base64.b64decode("T0c3X05PaG9tQzUoMTMsMTMp"),globals())+"\\n"); execfile(os.path.abspath("___code___.py"))
  File "", line 1, in <module>
    
  File "/tmp/tmpRfy2qw/___code___.py", line 3, in <module>
    exec compile(u'OG7_NOhomC5(_sage_const_13 ,_sage_const_13 )
  File "", line 1, in <module>
    
  File "/tmp/tmp1inrim/___code___.py", line 10, in OG7_NOhomC5
    if g.girth()==_sage_const_4  and g.odd_girth()>=_sage_const_7 :
  File "/usr/lib/sagemath/local/lib/python2.7/site-packages/sage/graphs/graph.py", line 2392, in odd_girth
    if ch[i] != 0:
IndexError: list index out of range
```



---

Comment by ncohen created at 2015-01-16 08:23:08

Changing status from new to needs_info.


---

Comment by ncohen created at 2015-01-16 08:23:08

Could you provide an instruction that triggers that bug ? We cannot do much with a function when we do not know how it should be called. Also, you cannot ask us to 'run computations for hours' in order to check it. Thanks for your understanding,

Nathann


---

Comment by ffoucaud created at 2015-01-16 08:39:21

Replying to [comment:1 ncohen]:
> Could you provide an instruction that triggers that bug ? We cannot do much with a function when we do not know how it should be called. Also, you cannot ask us to 'run computations for hours' in order to check it. Thanks for your understanding,

I clarified my text, is it more clear now?


---

Comment by ncohen created at 2015-01-16 08:40:55

Yes, thanks. Could you give us the graphs `g` that your code found such that `g.odd_girth` produces a bug ?

Nathann


---

Comment by ffoucaud created at 2015-01-16 08:52:02

Replying to [comment:4 ncohen]:
> Yes, thanks. Could you give us the graphs `g` that your code found such that `g.odd_girth` produces a bug ?

OK, so here is one graph of order 15 for which there was an error:
`:NqA?PRGSqgbG\AWbIWyGaESp~`

And another one of order 14 (for this one, I got the "running out of prime" error):
`:MoAG`oAQ`@`RFR?PAecKhbg`

Edit: a third one, of order 13 this time: `:Lm?K`@`RHGhbrGS{PdKb`

For all of them, calling odd_girth() is not a problem. Note that they all have odd girth 5. Maybe this is a problem with the amount of calls to "odd_girth()" that are done?


---

Comment by ncohen created at 2015-01-16 14:47:40

This seems related to #15535 and #12883


---

Comment by ncohen created at 2015-01-16 14:50:14

Yeah it sees related to the number of calls, as other persons seem to have met the same problem when computing many characteristic polynomials `:-/`

Nathann


---

Comment by ffoucaud created at 2015-01-16 15:31:07

OK, thanks... At least it seems to be a known bug.


---

Comment by ncohen created at 2015-01-18 18:59:33

Changing status from needs_info to positive_review.


---

Comment by ncohen created at 2015-01-18 18:59:33

This ticket corresponds to the bug reported at #15535. Should be closed as a 'duplicate'.

Nathann


---

Comment by vbraun created at 2015-01-25 12:55:50

Resolution: duplicate
