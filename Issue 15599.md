# Issue 15599: BasisMatroid.circuits() returns a malformed SetSystem when called on the empty matroid

Issue created by migration from https://trac.sagemath.org/ticket/15836

Original creator: Rudi

Original creation time: 2014-02-19 09:12:51

CC:  stefan yomcat

The following produces an error:

```
from sage.matroids.advanced import *
M=Basismatroid(groundset=[], rank =0)
for C in M.circuits(): print C
```

Also, len(M.circuits()) is reported to be 1, whereas len(M.cocircuits()) is 0 and the latter is not malformed.
  
It is a bit of a theological issue, but I think we agree that the matroid on zero elements has circuits nor cocircuits:
 in general a matroid of rank 0 on k elements has k circuits and no cocircuits.
 
So I want to make sure that M.circuits() returns that empty SetSystem (easy enough) but I also want to find out how it is possible that the SetSystem becomes malformed in this case. 



---

Comment by Rudi created at 2014-02-20 10:04:19

The problem here is essentially due to the fact that one cannot create a bitset of length 0. To adjust for this, I worked with bitsets of length 1 in the exceptional case of a BasisExchangeMatroid (or SetSystem) with an empty ground set. But then bitset_complement() does not precisely do what it should do, and may create a set containing an element index pointing outside the ground set. 

So what I did now is catch the possibility of an empty ground set in several enumerative functions. I will go on to have a look at the more low-level functions. I hope that they simply work, because I would hate to incur a speed penalty to repair a problem that arises only for the empty matroid. 
----
New commits:


---

Comment by Rudi created at 2014-02-20 10:04:19

Set assignee to Rudi.


---

Comment by Rudi created at 2014-02-20 13:27:19

Changing status from new to needs_review.


---

Comment by Rudi created at 2014-02-20 13:27:19

The other functions seem to be safe from this bitset problem. Ready for a review.


---

Comment by Jayant created at 2014-04-11 21:49:10

The error no longer occurs because of ground set size checks added. 

On an unrelated note, I noticed that if one gives bad input e.g. asking for size 9 independent sets of (ground set size 8) vamos matroid: 


```
from sage.matroids.advanced import *
M = BasisMatroid(matroids.named_matroids.Vamos())
len(M.independent_r_sets(9))
```


creates a segfault. There is a check in code for negative numbers passed but not for positive numbers strictly greater than ground set size. I suppose making the code stupid-proof would be a different ticket by itself.


---

Comment by Jayant created at 2014-04-11 21:49:10

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-04-12 07:35:54

author/reviewer names


---

Comment by Rudi created at 2014-04-12 09:38:44

Thanks Jayant for reviewing this ticket! Will you create a new ticket for that other issue?

Added author and reviewer.


---

Comment by vbraun created at 2014-04-14 19:57:24

Resolution: fixed
