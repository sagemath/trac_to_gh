# Issue 11278: Updates to BooleanFunction class

Issue created by migration from Trac.

Original creator: jpflori

Original creation time: 2011-06-08 15:41:43

Assignee: mvngu

CC:  jpflori ruhm asante

Keywords: boolean function, cryptography, walsh hadamard transform

I've commited several changes to the BooleanFunction class:

1. The walsh hadamard transform compute the transform of the opposite, I corrected it

2. A lot of computation were made using ints, I change most of them to longs, also adding a warning when computations will overflow. I changed the code to compute the hamming weight to deal with 64 bits integers.

3. I typed some variables and now store the result of walsh hdamard transform and autocorrelation in c arrays for faster computations, because of that I deleted the _compute_walsh_hadamard_cached method. Of course everything still gets resetted when one modifies the boolean function.

4. I added sig_on/sig_off around some c loops.


---

Attachment

Fixes and optimizations.


---

Comment by jpflori created at 2011-06-14 21:13:30

I must acknowledge that this patch could be considered temporary, but IMHO gives better results on modern computers currently.

A more complete solution should involve (transparently) different implementations according to the lenth of integers involved as is done e.g.for integer_mod, i.e. use fixed length integer or gmp/mpir according to the the length of integers involved.


---

Comment by jpflori created at 2013-06-11 22:32:33

This surely needs more work, especially on 32 bits.


---

Comment by jpflori created at 2017-05-17 12:41:45

Some parts of this old patch could be integrated.
Especially fixing the sign of the walsh-hadamard transform.
The rest is more discussable.


---

Comment by asante created at 2017-05-17 13:40:14

Maybe this should also be split up in several commits -- at the moment it looks a bit like a patchbomb.

I looked at the attached patch and at least in the comments it says the Walsh(-Hadamard)-Transform of f is `f(\alpha) = \sum_{x \in \GF(2)^n} f(x) \cdot {-1}^{\langle \alpha, x \rangle`} (line 61 vs 70) - in the literature this seems to not be used consistently. In Claude Carlets chapters on boolean functions from "Boolean Models and Methods in Mathematics, Computer Science, and Engineering" this definition is for the Fourier-Transform where the Walsh-Transform is the Fourier-Transform of the sign function of f (what equals the old line). I think the code also computes the Walsh-Transform, but I'll check this again.


---

Comment by jpflori created at 2017-05-17 13:43:51

Sure the patch cannot be used as is.


---

Comment by jpflori created at 2017-05-17 13:54:14

As far as the WH is concerned, I'd say it's the fourier transform of the "sign" function.
As stated in the doc it is

```
sum_{i\in\{0,1\}^n} (-1)^{f(i)\oplus i \cdot j}
```

(apart from a bizarre wrong change in the patch.)

But the code uses for the sign function:

```
(bitset_in(self._truth_table,i)<<1)-1
```

that is

```
2*f(i)-1 = -(-1)^f(i)
```


For crypto applications it changes nothing and it also could be valid mathematically, but still this additional minus is not so natural.


---

Comment by ruhm created at 2017-05-17 14:06:58

A ticket of 6-years ago :-o

+1 for fixing the sign in Walsh-Hadamard transform. And as far as I know, in the context of Boolean function for cryptography, the Walsh-Hadamard transform is a Fourier transform of the sign function.

The fix for the sign must also be applied in the implementation of linear approximation matrix of SBox (see https://github.com/sagemath/sage/blob/master/src/sage/crypto/mq/sbox.py#L483). Its just a matter of removing the "negative" sign when calling A.transpose() in line 535.

I suggest this ticket can be changed into a meta-ticket. Then create separate sub-tickets for each issue addressed in the description.


---

Comment by jpflori created at 2017-05-17 14:16:28

We can also just close this ticket as wontfix.

I just wanted to draw your attention on the changes I proposed here a long time ago as you seem to be interested in this topic.


---

Comment by ruhm created at 2017-05-17 14:45:15

Replying to [comment:12 jpflori]:
> We can also just close this ticket as wontfix.
> 

Yes, thats also possible.

> I just wanted to draw your attention on the changes I proposed here a long time ago as you seem to be interested in this topic.

Yes, I am :-) and I do think these changes are important. I never notice this ticket before. Now I know why.

Regards,
Rusydi


---

Comment by asante created at 2018-07-02 14:13:11

Changing keywords from "boolean function, cryptography, walsh hadamard transform" to "boolean function, cryptography, walsh hadamard transform, days94".


---

Comment by asante created at 2018-07-02 14:13:11

OK, so in order to make this a meta ticket, I guess we should split it in some new tickets and put them as dependencies for this ticket?

We have the following things in this ticket:

    1. The walsh hadamard transform compute the transform of the opposite, I corrected it 
        this is already fixed

    2. A lot of computation were made using ints, I change most of them to longs, also adding a warning when computations will overflow. I changed the code to compute the hamming weight to deal with 64 bits integers. 
        change to 64-bit integers - ticket: #25742

    3. I typed some variables and now store the result of walsh hdamard transform and autocorrelation in c arrays for faster computations, because of that I deleted the _compute_walsh_hadamard_cached method. Of course everything still gets resetted when one modifies the boolean function.
        type variables in cython code - ticket: #25740

    4. I added sig_on/sig_off around some c loops. 
        sig_check in c loops - ticket: #25739


---

Comment by asante created at 2018-07-02 14:13:11

Changing assignee from mvngu to asante.
