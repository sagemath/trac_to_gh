# Issue 10263: Doctest for r.chdir() should use realpath

Issue created by migration from https://trac.sagemath.org/ticket/10264

Original creator: jdemeyer

Original creation time: 2010-11-14 15:31:55

Assignee: mvngu

CC:  mpatel

This breaks when `/tmp` is a symbolic link:

```
        EXAMPLES::

            sage: import tempfile
            sage: tmpdir = tempfile.mkdtemp()
            sage: r.chdir(tmpdir)

        On Linux, we could use ``tmpdir == sageobj(r.getwd())``
        to test this, but Mac prepends ``/private/`` to such
        directories, so we check that the directory name string
        is in the working directory string instead::

            sage: tmpdir in sageobj(r.getwd())
            True
```



---

Comment by jdemeyer created at 2010-11-14 15:41:19

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2010-11-14 15:41:19

Tested on Linux with

```
$ sudo ln -s /tmp /special
$ env TMPDIR=/special sage -t sage/interfaces/r.py
```


Tested on OS X 10.4 (where `/tmp` is a symlink to `/private/tmp`) with

```
$ sage -t sage/interfaces/r.py
```



---

Attachment


---

Comment by mpatel created at 2010-11-15 09:08:33

Ticket #9970 is a duplicate, I think.


---

Comment by mpatel created at 2010-11-15 09:17:55

Replying to [comment:3 mpatel]:
> Ticket #9970 is a duplicate, I think.

Or a different problem with the same doctest.


---

Comment by jdemeyer created at 2010-11-16 18:24:10

Mitesh, can you review this?


---

Comment by mpatel created at 2010-11-17 07:02:27

The patch looks good.  I tested it successfully on bsd.math (OS X 10.6), sage.math (Ubuntu 8.04.4 LTS), and fulvia.skynet (SunOS 5.10) with `TMPDIR` unset, set to a path with no symbolic links, and set to a path with a link.


---

Comment by mpatel created at 2010-11-17 07:02:27

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2010-11-17 08:24:03

Resolution: fixed
