# Issue 17347: Simplify numpy import in vectors

Issue created by migration from https://trac.sagemath.org/ticket/17584

Original creator: jdemeyer

Original creation time: 2015-01-05 13:29:21

In `src/sage/modules/vector_double_dense.pyx` there is a lot of code like

```
        global numpy
        if numpy is None:
            import numpy
```


However, since the whole module is not imported at startup, we might as well just put a global

```
cimport numpy
```

and be done with it.


---

Comment by jdemeyer created at 2015-01-05 14:44:10

New commits:


---

Comment by jdemeyer created at 2015-01-05 14:44:10

Changing status from new to needs_review.


---

Comment by git created at 2015-02-14 09:50:47

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by robertwb created at 2015-02-14 10:45:31

Changing status from needs_review to positive_review.


---

Comment by robertwb created at 2015-02-14 10:45:31

Looks good to me. Note that cimporting numpy will (indirectly) import it anyway to get the numpy.ndarray type. 

I am curious about the commend that the numpy method must be last... do you have a minimal example for that bug?


---

Comment by jdemeyer created at 2015-02-14 17:51:23

Replying to [comment:6 robertwb]:
> I am curious about the commend that the numpy method must be last... do you have a minimal example for that bug?


```
cimport numpy
cdef class numpy_test:
    def numpy(self):
        pass
    cdef foo(self, numpy.dtype dtype):
        pass
```

gives

```
Error compiling Cython file:
------------------------------------------------------------
...
cimport numpy
cdef class numpy_test:
    def numpy(self):
        pass
    cdef foo(self, numpy.dtype dtype):
                  ^
------------------------------------------------------------

sage/modules/vector_double_dense_test.pyx:5:19: 'numpy' is not a cimported module
```


Is this a bug?


---

Comment by robertwb created at 2015-02-14 18:41:42

Yes, that's a bug.


---

Comment by jdemeyer created at 2015-02-15 13:00:06

Could you report the bug, it would be nice to reference the bug in the Sage code.


---

Comment by vbraun created at 2015-02-18 08:53:19

Resolution: fixed
