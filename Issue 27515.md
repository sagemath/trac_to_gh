# Issue 27515: Jupyter textual interact input does not wait to be evaluated

archive/issues_027515.json:
```json
{
    "body": "CC:  jdemeyer slelievre vklein zerline\n\nIn #27735 it was discovered that, unlike sagenb or Sage cell, text input in `@`interacts in Jupyter apparently immediately re-evaluate even before 'enter' is pressed.  jdemeyer explains:\n\n> It's a general \"problem\" (arguable, since one could call it a feature) with all interacts that have some kind of textual input which is evaluated.\n\nHowever, because this is different from the behavior of other interact implementations (does anyone know about .sagews CoCalc sheets?), probably this should be fixed.  Among other things, if the interact involves significant computation time (> 1 ms, especially a problem with anything involving graphics), it can slow down usage of interacts dramatically, which sort of defeats the purpose of `@`interacts.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27752\n\n",
    "created_at": "2019-04-30T13:10:31Z",
    "labels": [
        "notebook",
        "critical",
        "bug"
    ],
    "title": "Jupyter textual interact input does not wait to be evaluated",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27515",
    "user": "kcrisman"
}
```
CC:  jdemeyer slelievre vklein zerline

In #27735 it was discovered that, unlike sagenb or Sage cell, text input in `@`interacts in Jupyter apparently immediately re-evaluate even before 'enter' is pressed.  jdemeyer explains:

> It's a general "problem" (arguable, since one could call it a feature) with all interacts that have some kind of textual input which is evaluated.

However, because this is different from the behavior of other interact implementations (does anyone know about .sagews CoCalc sheets?), probably this should be fixed.  Among other things, if the interact involves significant computation time (> 1 ms, especially a problem with anything involving graphics), it can slow down usage of interacts dramatically, which sort of defeats the purpose of `@`interacts.

Issue created by migration from https://trac.sagemath.org/ticket/27752





---

archive/issue_comments_388016.json:
```json
{
    "body": "I should note that the implementation of ``@`interact` itself is really done by upstream. Three packages (all under the Jupyter umbrella) play an important role:\n\n1. ipywidgets: Python package dealing with widgets and where the actual `interact` object is defined.\n2. widgetsnbextension: JavaScript code for working with widgets in the browser.\n3. traitlets: low-level Python library dealing with the callback mechanism (changing the value of a widget triggers evaluation of the interact function).\n\nThere are Sage customizations to the standard ``@`interact` (see `src/sage/repl/ipython_kernel/interact.py`), but those do not fundamentally change the way how interacts work.\n\nSo either we need to fix something upstream, or we add a workaround in Sage, or we become happy with the status-quo.",
    "created_at": "2019-04-30T13:27:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27515#issuecomment-388016",
    "user": "jdemeyer"
}
```

I should note that the implementation of ``@`interact` itself is really done by upstream. Three packages (all under the Jupyter umbrella) play an important role:

1. ipywidgets: Python package dealing with widgets and where the actual `interact` object is defined.
2. widgetsnbextension: JavaScript code for working with widgets in the browser.
3. traitlets: low-level Python library dealing with the callback mechanism (changing the value of a widget triggers evaluation of the interact function).

There are Sage customizations to the standard ``@`interact` (see `src/sage/repl/ipython_kernel/interact.py`), but those do not fundamentally change the way how interacts work.

So either we need to fix something upstream, or we add a workaround in Sage, or we become happy with the status-quo.



---

archive/issue_comments_388017.json:
```json
{
    "body": "> 1. ipywidgets: Python package dealing with widgets and where the actual `interact` object is defined.\n> 2. widgetsnbextension: JavaScript code for working with widgets in the browser.\n> 3. traitlets: low-level Python library dealing with the callback mechanism (changing the value of a widget triggers evaluation of the interact function).\n\nWhich of these is the one that is most likely to be causing the immediate change with regard to the text boxes?  I think the real problem is that different implementations work differently, and it surprises me that there is such immediate response in Jupyter - you'd think it would be \"easier\" not to poll the Sage kernel with more computation so often, but of course I don't know much about the specific technicalities.",
    "created_at": "2019-04-30T17:26:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27515#issuecomment-388017",
    "user": "kcrisman"
}
```

> 1. ipywidgets: Python package dealing with widgets and where the actual `interact` object is defined.
> 2. widgetsnbextension: JavaScript code for working with widgets in the browser.
> 3. traitlets: low-level Python library dealing with the callback mechanism (changing the value of a widget triggers evaluation of the interact function).

Which of these is the one that is most likely to be causing the immediate change with regard to the text boxes?  I think the real problem is that different implementations work differently, and it surprises me that there is such immediate response in Jupyter - you'd think it would be "easier" not to poll the Sage kernel with more computation so often, but of course I don't know much about the specific technicalities.



---

archive/issue_comments_388018.json:
```json
{
    "body": "Replying to [comment:3 kcrisman]:\n> Which of these is the one that is most likely to be causing the immediate change with regard to the text boxes?\n\nIt's really a combination, that's why I mentioned the various packages: whenever the user types something in a text box, `widgetsnbextension` sends an event to the Jupyter kernel. `ipywidgets` then changes the `.value` attribute of the text box. `traitlets` notices that this attribute has changed and calls a callback function for the interact (implemented by `ipywidgets`). This callback then updates the interact.",
    "created_at": "2019-04-30T17:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27515#issuecomment-388018",
    "user": "jdemeyer"
}
```

Replying to [comment:3 kcrisman]:
> Which of these is the one that is most likely to be causing the immediate change with regard to the text boxes?

It's really a combination, that's why I mentioned the various packages: whenever the user types something in a text box, `widgetsnbextension` sends an event to the Jupyter kernel. `ipywidgets` then changes the `.value` attribute of the text box. `traitlets` notices that this attribute has changed and calls a callback function for the interact (implemented by `ipywidgets`). This callback then updates the interact.



---

archive/issue_comments_388019.json:
```json
{
    "body": "Changing keywords from \"\" to \"interact, jupyter\".",
    "created_at": "2019-05-05T21:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27515#issuecomment-388019",
    "user": "slelievre"
}
```

Changing keywords from "" to "interact, jupyter".



---

archive/issue_comments_388020.json:
```json
{
    "body": "Moving open critical and blocker issues to the next release milestone (optimistically).",
    "created_at": "2019-07-03T11:39:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27515#issuecomment-388020",
    "user": "embray"
}
```

Moving open critical and blocker issues to the next release milestone (optimistically).



---

archive/issue_comments_388021.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2019-12-30T14:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27515#issuecomment-388021",
    "user": "embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_388022.json:
```json
{
    "body": "Moving to 9.4, as 9.3 has been released.",
    "created_at": "2021-05-10T17:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27515",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27515#issuecomment-388022",
    "user": "mkoeppe"
}
```

Moving to 9.4, as 9.3 has been released.
