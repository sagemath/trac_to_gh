# Issue 30838: Add configuration and documentation for code formatter "black"

archive/issues_030838.json:
```json
{
    "body": "CC:  mkoeppe chapoton\n\nThe code formatter \"black\" is probably the most popular one for Python. We add basic configuration and documentation for it.\n\nI would actually propose to reformat the whole code base with black, and then require that people use it before checkin their code (checked via the official github action). In this way one could get rid of all the formatting problems once and for all. This global reformat probably needs to be done by the release manager to prevent merge conflicts.\n\nIssue created by migration from https://trac.sagemath.org/ticket/31075\n\n",
    "created_at": "2020-12-18T14:23:31Z",
    "labels": [
        "build",
        "major",
        "enhancement"
    ],
    "title": "Add configuration and documentation for code formatter \"black\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30838",
    "user": "@tobiasdiez"
}
```
CC:  mkoeppe chapoton

The code formatter "black" is probably the most popular one for Python. We add basic configuration and documentation for it.

I would actually propose to reformat the whole code base with black, and then require that people use it before checkin their code (checked via the official github action). In this way one could get rid of all the formatting problems once and for all. This global reformat probably needs to be done by the release manager to prevent merge conflicts.

Issue created by migration from https://trac.sagemath.org/ticket/31075





---

archive/issue_comments_440747.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-18T14:23:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440747",
    "user": "@tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_440748.json:
```json
{
    "body": "The section in the documentation should probably mention how to run it through `sage -tox`. In this case, no installation with pip is necessary - pip takes care of it",
    "created_at": "2020-12-18T18:46:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440748",
    "user": "mkoeppe"
}
```

The section in the documentation should probably mention how to run it through `sage -tox`. In this case, no installation with pip is necessary - pip takes care of it



---

archive/issue_comments_440749.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-18T21:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440749",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_440750.json:
```json
{
    "body": "Replying to [comment:2 mkoeppe]:\n> The section in the documentation should probably mention how to run it through `sage -tox`. In this case, no installation with pip is necessary - pip takes care of it\n\nGood idea. Added, also for pycodestyle.",
    "created_at": "2020-12-18T21:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440750",
    "user": "@tobiasdiez"
}
```

Replying to [comment:2 mkoeppe]:
> The section in the documentation should probably mention how to run it through `sage -tox`. In this case, no installation with pip is necessary - pip takes care of it

Good idea. Added, also for pycodestyle.



---

archive/issue_comments_440751.json:
```json
{
    "body": "Perhaps `@`chapoton could comment on the current status and plans regarding code style in sagelib.  There seems to be a plan but I don't know if it is written anywhere.",
    "created_at": "2020-12-19T17:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440751",
    "user": "mkoeppe"
}
```

Perhaps `@`chapoton could comment on the current status and plans regarding code style in sagelib.  There seems to be a plan but I don't know if it is written anywhere.



---

archive/issue_comments_440752.json:
```json
{
    "body": "Comments concerning a plan how to proceed with the code style are welcome indeed.",
    "created_at": "2021-01-06T12:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440752",
    "user": "@tobiasdiez"
}
```

Comments concerning a plan how to proceed with the code style are welcome indeed.



---

archive/issue_comments_440753.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440753",
    "user": "mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_440754.json:
```json
{
    "body": "I think requiring black's code formatting style should be discussed on sage-devel.  I'm personally against various choices they make (mainly the excessive newlines).",
    "created_at": "2021-04-28T08:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440754",
    "user": "roed"
}
```

I think requiring black's code formatting style should be discussed on sage-devel.  I'm personally against various choices they make (mainly the excessive newlines).



---

archive/issue_comments_440755.json:
```json
{
    "body": "`@`mkoeppe, chapoton, how should we proceed with this?",
    "created_at": "2021-05-18T07:38:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440755",
    "user": "@tobiasdiez"
}
```

`@`mkoeppe, chapoton, how should we proceed with this?



---

archive/issue_comments_440756.json:
```json
{
    "body": "from me, a **strong negative vote** on using black",
    "created_at": "2021-05-18T07:46:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440756",
    "user": "chapoton"
}
```

from me, a **strong negative vote** on using black



---

archive/issue_comments_440757.json:
```json
{
    "body": "I agree: I would prefer not to use black as a commit hook.  I find that it adds a lot of unnecessary whitespace.  As an example, here's a diff produced by black that I find makes the code less readable:\n\n\n```\n-verbose(\"Approximants of %r on %r towards %r\"%(self, self.domain(), G), level=3)\n+verbose(\n+    \"Approximants of %r on %r towards %r\" % (self, self.domain(), G), level=3\n+)\n```\n\n\nI also don't think it's worth making a change across Sage that will break everyone's outstanding branches.",
    "created_at": "2021-05-18T20:24:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440757",
    "user": "roed"
}
```

I agree: I would prefer not to use black as a commit hook.  I find that it adds a lot of unnecessary whitespace.  As an example, here's a diff produced by black that I find makes the code less readable:


```
-verbose("Approximants of %r on %r towards %r"%(self, self.domain(), G), level=3)
+verbose(
+    "Approximants of %r on %r towards %r" % (self, self.domain(), G), level=3
+)
```


I also don't think it's worth making a change across Sage that will break everyone's outstanding branches.



---

archive/issue_comments_440758.json:
```json
{
    "body": "Also, the branch on this ticket gives a merge failure.",
    "created_at": "2021-05-18T20:26:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440758",
    "user": "roed"
}
```

Also, the branch on this ticket gives a merge failure.



---

archive/issue_comments_440759.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-05-20T15:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440759",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_440760.json:
```json
{
    "body": "red branch => needs work",
    "created_at": "2021-05-20T15:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30838",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30838#issuecomment-440760",
    "user": "chapoton"
}
```

red branch => needs work
