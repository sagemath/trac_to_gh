# Issue 19745: phi0 and epsilon0 of KR higher spin crystal of type Dn twisted not correct

Issue created by migration from https://trac.sagemath.org/ticket/19982

Original creator: tscrim

Original creation time: 2016-01-29 02:20:12

Assignee: tscrim

CC:  sage-combinat aschilling bsalisbury1

For type D<sub>n+1</sub><sup>(2)</sup>, the crystals B<sup>n,s</sup> for s > 1 do not have the correct result for `epsilon0` and `phi0` as they should be regular crystals. Explicitly, we have

```
sage: K2 = crystals.KirillovReshetikhin(['D',3,2], 2,2)
sage: def phi0_defn(elt):
....:     x = elt.f(0)
....:     phi = 0
....:     while x is not None:
....:         x = x.f(0)
....:         phi = phi + 1
....:     return phi
sage: all(phi_defn(x) == x.phi0() for x in K2)
False
```

and similarly for `epsilon0`.

It appears that `e0` and `f0` are correct for this example.


---

Comment by tscrim created at 2016-01-29 02:46:50

Changing status from new to needs_review.


---

Comment by tscrim created at 2016-01-29 02:46:50

We need to divide `l4` by 2. This comes from the fact that change it by 2 each time we apply e<sub>0</sub> and f<sub>0</sub>.
----
New commits:


---

Comment by tscrim created at 2016-01-29 03:02:07

Changing priority from blocker to critical.


---

Comment by chapoton created at 2016-02-04 19:11:50

ok, good to go


---

Comment by chapoton created at 2016-02-04 19:11:50

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-05 19:33:10

Resolution: fixed
