# Issue 30841: Replace __call__() by _element_class_() in MatrixSpace

archive/issues_030841.json:
```json
{
    "body": "The `MatrixSpace` class still has a `__call__()` method instead of `_element_constructor_()`.  This is relatively easy to change, and has the benefit that if `M` is a matrix space and `m` an element of `M`, then `M(m)` simply returns `m`.  This can be viewed as a small addendum to #23719.\n\nOne side effect of the attached branch is that the first argument (`entries`) is now effectively a mandatory non-keyword argument, and `copy` and `coerce` are keyword-only arguments.  This is probably a good thing for readability, though.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/31078\n\n",
    "created_at": "2020-12-18T19:42:31Z",
    "labels": [
        "component: coercion",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Replace __call__() by _element_class_() in MatrixSpace",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30841",
    "user": "https://github.com/pjbruin"
}
```
The `MatrixSpace` class still has a `__call__()` method instead of `_element_constructor_()`.  This is relatively easy to change, and has the benefit that if `M` is a matrix space and `m` an element of `M`, then `M(m)` simply returns `m`.  This can be viewed as a small addendum to #23719.

One side effect of the attached branch is that the first argument (`entries`) is now effectively a mandatory non-keyword argument, and `copy` and `coerce` are keyword-only arguments.  This is probably a good thing for readability, though.


Issue created by migration from https://trac.sagemath.org/ticket/31078





---

archive/issue_comments_440323.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-18T19:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440323",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_440324.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-19T19:07:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440324",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_440325.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440325",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_081143.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30841#event-81143"
}
```



---

archive/issue_comments_440326.json:
```json
{
    "body": "Looks good to me.  Most recent test failure is spurious.",
    "created_at": "2021-05-10T19:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440326",
    "user": "https://github.com/roed314"
}
```

Looks good to me.  Most recent test failure is spurious.



---

archive/issue_comments_440327.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-10T19:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440327",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_440328.json:
```json
{
    "body": "One thing that we might want to be slightly cautious about that this breaks backwards compatibility for anyone who has inputs `MS(entries, False)` or `MS(entries, False, True)`. This might also have a speed impact as matrices are used a lot of places in Sage as it adds some extra indirection, but I am a little less concerned about that since this should mostly be coming from user input (if there is a slight regression).",
    "created_at": "2021-05-10T23:28:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440328",
    "user": "https://github.com/tscrim"
}
```

One thing that we might want to be slightly cautious about that this breaks backwards compatibility for anyone who has inputs `MS(entries, False)` or `MS(entries, False, True)`. This might also have a speed impact as matrices are used a lot of places in Sage as it adds some extra indirection, but I am a little less concerned about that since this should mostly be coming from user input (if there is a slight regression).



---

archive/issue_comments_440329.json:
```json
{
    "body": "```\n**********************************************************************\nFile \"src/sage/combinat/k_regular_sequence.py\", line 1694, in sage.combinat.k_regular_sequence.RecurrenceParser.matrix\nFailed example:\n    RP.matrix(UB_rules, 1)\nExpected:\n    [ 0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0]\n    [ 0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0]\n    [ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]\n    [ 0  0  0  0  0  2  0  0  0  0  0  0  0 -2  0  0]\n    [ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]\n    [ 0  0  0  0 -1  1  1  0  0  0  0  0  0  2  2  0]\n    [ 0  0  0  0  2  0  1  0  0  0  0  0  0 -8 -4 -4]\n    [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]\n    [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0]\n    [ 0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  0]\n    [ 0  0  0  0  0  0  0  0 -1  1  0  0  0  2  0  0]\n    [ 0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0]\n    [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0]\n    [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]\n    [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0]\n    [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]\nGot:\n    [ 0  0  1  0  0  0  0  0  0  0  0  0  0| 0  0  0]\n    [ 0  0  0  0  0  1  0  0  0  0  0  0  0| 0  0  0]\n    [ 0  0  0  0  0  0  1  0  0  0  0  0  0| 0  0  0]\n    [ 0  0  0  0  0  2  0  0  0  0  0  0  0|-2  0  0]\n    [ 0  0  0  0  0  0  1  0  0  0  0  0  0| 0  0  0]\n    [ 0  0  0  0 -1  1  1  0  0  0  0  0  0| 2  2  0]\n    [ 0  0  0  0  2  0  1  0  0  0  0  0  0|-8 -4 -4]\n    [ 0  0  0  0  0  0  0  2  0  0  0  0  0| 0  0  0]\n    [ 0  0  0  0  0  0  0  0  1  0  0  0  0| 0  0  0]\n    [ 0  0  0  0  0  0  0  0  1  0  1  0  0| 0  0  0]\n    [ 0  0  0  0  0  0  0  0 -1  1  0  0  0| 2  0  0]\n    [ 0  0  0  0  0  0  0  0  0  2  0  0  0| 0  0  0]\n    [ 0  0  0  0  0  0  0  0  0  0  1  0  0| 0  0  0]\n    [--------------------------------------+--------]\n    [ 0  0  0  0  0  0  0  0  0  0  0  0  0| 0  0  0]\n    [ 0  0  0  0  0  0  0  0  0  0  0  0  0| 1  0  0]\n    [ 0  0  0  0  0  0  0  0  0  0  0  0  0| 0  0  0]\n**********************************************************************\n1 item had failures:\n   2 of  16 in sage.combinat.k_regular_sequence.RecurrenceParser.matrix\n    [176 tests, 2 failures, 5.00 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 46.7 --random-seed=0 src/sage/combinat/k_regular_sequence.py  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2021-07-25T08:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440329",
    "user": "https://github.com/vbraun"
}
```

```
**********************************************************************
File "src/sage/combinat/k_regular_sequence.py", line 1694, in sage.combinat.k_regular_sequence.RecurrenceParser.matrix
Failed example:
    RP.matrix(UB_rules, 1)
Expected:
    [ 0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0]
    [ 0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
    [ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
    [ 0  0  0  0  0  2  0  0  0  0  0  0  0 -2  0  0]
    [ 0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
    [ 0  0  0  0 -1  1  1  0  0  0  0  0  0  2  2  0]
    [ 0  0  0  0  2  0  1  0  0  0  0  0  0 -8 -4 -4]
    [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0]
    [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
    [ 0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  0]
    [ 0  0  0  0  0  0  0  0 -1  1  0  0  0  2  0  0]
    [ 0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0]
    [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
    [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
    [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0]
    [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
Got:
    [ 0  0  1  0  0  0  0  0  0  0  0  0  0| 0  0  0]
    [ 0  0  0  0  0  1  0  0  0  0  0  0  0| 0  0  0]
    [ 0  0  0  0  0  0  1  0  0  0  0  0  0| 0  0  0]
    [ 0  0  0  0  0  2  0  0  0  0  0  0  0|-2  0  0]
    [ 0  0  0  0  0  0  1  0  0  0  0  0  0| 0  0  0]
    [ 0  0  0  0 -1  1  1  0  0  0  0  0  0| 2  2  0]
    [ 0  0  0  0  2  0  1  0  0  0  0  0  0|-8 -4 -4]
    [ 0  0  0  0  0  0  0  2  0  0  0  0  0| 0  0  0]
    [ 0  0  0  0  0  0  0  0  1  0  0  0  0| 0  0  0]
    [ 0  0  0  0  0  0  0  0  1  0  1  0  0| 0  0  0]
    [ 0  0  0  0  0  0  0  0 -1  1  0  0  0| 2  0  0]
    [ 0  0  0  0  0  0  0  0  0  2  0  0  0| 0  0  0]
    [ 0  0  0  0  0  0  0  0  0  0  1  0  0| 0  0  0]
    [--------------------------------------+--------]
    [ 0  0  0  0  0  0  0  0  0  0  0  0  0| 0  0  0]
    [ 0  0  0  0  0  0  0  0  0  0  0  0  0| 1  0  0]
    [ 0  0  0  0  0  0  0  0  0  0  0  0  0| 0  0  0]
**********************************************************************
1 item had failures:
   2 of  16 in sage.combinat.k_regular_sequence.RecurrenceParser.matrix
    [176 tests, 2 failures, 5.00 s]
----------------------------------------------------------------------
sage -t --long --warn-long 46.7 --random-seed=0 src/sage/combinat/k_regular_sequence.py  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_comments_440330.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-07-25T08:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440330",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_440331.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-07-26T07:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440331",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_440332.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2021-07-26T07:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440332",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_081144.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30841#event-81144"
}
```



---

archive/issue_events_081145.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30841#event-81145"
}
```



---

archive/issue_events_081146.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-09-19T09:57:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30841#event-81146"
}
```



---

archive/issue_comments_440333.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-09-19T09:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30841#issuecomment-440333",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
