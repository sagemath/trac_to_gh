# Issue 22874: Remove is_distributive_lattice() from hasse_diagram.py

archive/issues_022874.json:
```json
{
    "body": "CC:  @tscrim\n\nThis patch removes a useless function. (Testing for distributivity can be done much faster.)\n\nHopefully someday I (or someone other) will do #17173.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23111\n\n",
    "created_at": "2017-05-31T10:35:23Z",
    "labels": [
        "combinatorics",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Remove is_distributive_lattice() from hasse_diagram.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22874",
    "user": "@jm58660"
}
```
CC:  @tscrim

This patch removes a useless function. (Testing for distributivity can be done much faster.)

Hopefully someday I (or someone other) will do #17173.

Issue created by migration from https://trac.sagemath.org/ticket/23111





---

archive/issue_comments_319882.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-05-31T10:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319882",
    "user": "@jm58660"
}
```

New commits:



---

archive/issue_comments_319883.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-31T10:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319883",
    "user": "@jm58660"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_319884.json:
```json
{
    "body": "Until there is an alternative, I propose we leave this in. Better to have some implementation than none at all. If you do really want to remove this function, then please justify it a little more and deprecate it.",
    "created_at": "2017-05-31T15:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319884",
    "user": "@tscrim"
}
```

Until there is an alternative, I propose we leave this in. Better to have some implementation than none at all. If you do really want to remove this function, then please justify it a little more and deprecate it.



---

archive/issue_comments_319885.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2017-05-31T15:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319885",
    "user": "@tscrim"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_319886.json:
```json
{
    "body": "We still have `.is_distributive` for lattices. But one first need to check if the poset is a lattice. I have not compared the speeds.",
    "created_at": "2017-05-31T15:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319886",
    "user": "@fchapoton"
}
```

We still have `.is_distributive` for lattices. But one first need to check if the poset is a lattice. I have not compared the speeds.



---

archive/issue_comments_319887.json:
```json
{
    "body": "Replying to [comment:4 chapoton]:\n> We still have `.is_distributive` for lattices. But one first need to check if the poset is a lattice. I have not compared the speeds.\n\nIt is clear that the function I suggest to remove is slowest.\n\nFirst, it checks if a poset is a lattice by computing meet- and join-matrices; only other is needed, if the poset is bounded.\n\nSecond, this is the most trivial implementation. It is much faster to just check `|Ji(L)|=Mi(L)=h(L)` and `L` is graded.",
    "created_at": "2017-05-31T17:12:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319887",
    "user": "@jm58660"
}
```

Replying to [comment:4 chapoton]:
> We still have `.is_distributive` for lattices. But one first need to check if the poset is a lattice. I have not compared the speeds.

It is clear that the function I suggest to remove is slowest.

First, it checks if a poset is a lattice by computing meet- and join-matrices; only other is needed, if the poset is bounded.

Second, this is the most trivial implementation. It is much faster to just check `|Ji(L)|=Mi(L)=h(L)` and `L` is graded.



---

archive/issue_comments_319888.json:
```json
{
    "body": "Btw, a dismantlable and bounded poset is actually a dismantlable lattice. Do we want functions `is_*_lattice()` to `posets.py` in general? I do not know if there is, say, faster `is_relatively_complemented_lattice()` than just trying `LatticePoset(P).is_relatively_complemented()`.",
    "created_at": "2017-06-01T06:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319888",
    "user": "@jm58660"
}
```

Btw, a dismantlable and bounded poset is actually a dismantlable lattice. Do we want functions `is_*_lattice()` to `posets.py` in general? I do not know if there is, say, faster `is_relatively_complemented_lattice()` than just trying `LatticePoset(P).is_relatively_complemented()`.



---

archive/issue_comments_319889.json:
```json
{
    "body": "On one had, you have to check it is a lattice by converting to a lattice, which I believe is somewhat expensive. However, you may not always have lattices in some set of posets, so having such a method at the higher level is good. A split the difference approach would be to have methods with more general checks for posets at the poset level, but this would make things inconsistent in a way. However, this is not a good reason as the `HasseDiagram` is considered (IMO) an implementation detail, and essentially hidden from the user. So, it makes sense to have methods that do not need a general checks for lattice-ness.\n\nI guess in this case I have just convinced myself that removing this method is the proper thing to do. However, because it is part of the public API of `HasseDiagram`, we still need to deprecate it.",
    "created_at": "2017-06-01T08:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319889",
    "user": "@tscrim"
}
```

On one had, you have to check it is a lattice by converting to a lattice, which I believe is somewhat expensive. However, you may not always have lattices in some set of posets, so having such a method at the higher level is good. A split the difference approach would be to have methods with more general checks for posets at the poset level, but this would make things inconsistent in a way. However, this is not a good reason as the `HasseDiagram` is considered (IMO) an implementation detail, and essentially hidden from the user. So, it makes sense to have methods that do not need a general checks for lattice-ness.

I guess in this case I have just convinced myself that removing this method is the proper thing to do. However, because it is part of the public API of `HasseDiagram`, we still need to deprecate it.



---

archive/issue_comments_319890.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2017-06-01T08:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319890",
    "user": "@tscrim"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_319891.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-06-01T10:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319891",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_319892.json:
```json
{
    "body": "Replying to [comment:7 tscrim]:\n\n> I guess in this case I have just convinced myself that removing this method is the proper thing to do. However, because it is part of the public API of `HasseDiagram`, we still need to deprecate it.\n\nThen it is easier just to make this faster.\n\nUncomplied code committed, not ready for review.",
    "created_at": "2017-06-01T10:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319892",
    "user": "@jm58660"
}
```

Replying to [comment:7 tscrim]:

> I guess in this case I have just convinced myself that removing this method is the proper thing to do. However, because it is part of the public API of `HasseDiagram`, we still need to deprecate it.

Then it is easier just to make this faster.

Uncomplied code committed, not ready for review.



---

archive/issue_comments_319893.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-09-19T11:19:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319893",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_319894.json:
```json
{
    "body": "Getting back to this one... Is this the right way to start deprecating?",
    "created_at": "2017-09-19T11:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319894",
    "user": "@jm58660"
}
```

Getting back to this one... Is this the right way to start deprecating?



---

archive/issue_comments_319895.json:
```json
{
    "body": "Almost. You should still have a doctest showing the deprecation.",
    "created_at": "2017-09-19T15:29:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319895",
    "user": "@tscrim"
}
```

Almost. You should still have a doctest showing the deprecation.



---

archive/issue_comments_319896.json:
```json
{
    "body": "Replying to [comment:12 tscrim]:\n> Almost. You should still have a doctest showing the deprecation.\n\nBut the devel manual says \"It will display the message of your choice (and interact properly with the doctest framework)\", i.e. if I just left the `EXAMPLES` block as it is, it will pass the doctest. Hence I don't know what to do.",
    "created_at": "2017-09-21T08:56:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319896",
    "user": "@jm58660"
}
```

Replying to [comment:12 tscrim]:
> Almost. You should still have a doctest showing the deprecation.

But the devel manual says "It will display the message of your choice (and interact properly with the doctest framework)", i.e. if I just left the `EXAMPLES` block as it is, it will pass the doctest. Hence I don't know what to do.



---

archive/issue_comments_319897.json:
```json
{
    "body": "No, the unchanged doctest will not pass. Just keep one simple doctest, looking like that\n\n```\n             sage: p = MixedIntegerLinearProgram(solver='GLPK')\n             sage: p.linear_function({1:3, 4:5})\n             doctest:...: DeprecationWarning:...linear_function...deprecated...\n             3*x_1 + 5*x_4\n```\n",
    "created_at": "2017-09-21T11:32:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319897",
    "user": "@fchapoton"
}
```

No, the unchanged doctest will not pass. Just keep one simple doctest, looking like that

```
             sage: p = MixedIntegerLinearProgram(solver='GLPK')
             sage: p.linear_function({1:3, 4:5})
             doctest:...: DeprecationWarning:...linear_function...deprecated...
             3*x_1 + 5*x_4
```




---

archive/issue_comments_319898.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-21T11:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319898",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_319899.json:
```json
{
    "body": "Strange... I must have tested this without compiling first...\n\nAnyways, now there is a test.",
    "created_at": "2017-09-21T11:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319899",
    "user": "@jm58660"
}
```

Strange... I must have tested this without compiling first...

Anyways, now there is a test.



---

archive/issue_comments_319900.json:
```json
{
    "body": "Triple quote is over-indented. Once fixed, you can set a positive review on my behalf.",
    "created_at": "2017-09-24T07:33:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319900",
    "user": "@tscrim"
}
```

Triple quote is over-indented. Once fixed, you can set a positive review on my behalf.



---

archive/issue_comments_319901.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-25T05:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319901",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_319902.json:
```json
{
    "body": "Replying to [comment:17 tscrim]:\n> Triple quote is over-indented. Once fixed, you can set a positive review on my behalf.\n\nDone this.",
    "created_at": "2017-09-25T05:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319902",
    "user": "@jm58660"
}
```

Replying to [comment:17 tscrim]:
> Triple quote is over-indented. Once fixed, you can set a positive review on my behalf.

Done this.



---

archive/issue_comments_319903.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-09-25T05:01:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319903",
    "user": "@jm58660"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_319904.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-26T06:57:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22874",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22874#issuecomment-319904",
    "user": "@vbraun"
}
```

Resolution: fixed
