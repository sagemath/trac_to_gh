# Issue 19429: Guruswami-Sudan decoder for GRS codes

Issue created by migration from https://trac.sagemath.org/ticket/19666

Original creator: dlucas

Original creation time: 2015-12-03 20:37:11

CC:  jsrn

This ticket introduces a new decoder for GRS codes, the Guruswami-Sudan list decoder.
The code proposed here relies extensively on the code written by Johan Nielsen in [codinglib](https://bitbucket.org/jsrn/codinglib/). He wrote all the algorithms and mathematical 
content.

Alongside with the decoder itself, this ticket introduces a root-finding algorithm based using Roth-Ruckenstein algorithm and an interpolation algorithm using linear algebra to solve a linear system of equations.


---

Comment by dlucas created at 2015-12-03 20:41:51

First of all, I set it to `needs_review` because I can't set it to `needs_work`, but it still lacks a small enhancement before being open for review.

I already added myself as a reviewer because I read Johan's code while porting it.
Of course, I'll need someone to review my changes and documentation `;)`
----
Last 10 new commits:


---

Comment by dlucas created at 2015-12-03 20:41:51

Changing status from new to needs_review.


---

Comment by dlucas created at 2015-12-03 20:42:03

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-12-04 10:30:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2015-12-04 10:32:17

Changing status from needs_work to needs_review.


---

Comment by dlucas created at 2015-12-04 10:32:17

I removed dependency in #19653, enhanced the documentation, added an `Author` and a copyright block in the new files and there's a new method to compute `maxd`.

This is now officially open for review.


---

Comment by git created at 2015-12-04 14:40:19

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by dlucas created at 2015-12-04 14:41:16

I merged latest branch from #18928 and added this ticket as a dependency.


---

Comment by jsrn created at 2015-12-15 12:59:39

While working on a review, I fixed a number of smallish things. Since I interrupted the review, and I'm not sure when I'll get back to it right now, I pushed those changes here. Consider them RFCs.
----
New commits:


---

Comment by dlucas created at 2015-12-16 10:33:19

I agree with your changes, which I integrated to my branch. On my side, I also fixed some typos and bugs, rewrote some documentation and renamed a few methods.
----
New commits:


---

Comment by git created at 2015-12-17 16:00:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2015-12-17 16:01:17

I updated this ticket to latest beta, and fixed a bug I found, it's still open for review.


---

Comment by git created at 2015-12-18 09:04:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-01-13 09:08:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-01-13 09:08:42

Updated to latest beta, still open for review.


---

Comment by git created at 2016-02-16 10:19:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-02-16 10:22:22

I'm dusting a bit this ticket: I updated it to latest beta, fixed broken doctests.
I noticed that some class parameters names were not prefixed by an underscore, which I fixed.

David


---

Comment by jsrn created at 2016-02-17 15:18:02

A trivial test seems to be failing in the thematic tutorial.


---

Comment by git created at 2016-02-17 15:26:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-02-17 15:27:24

> A trivial test seems to be failing in the thematic tutorial.

Oops, sorry. Fixed now.


---

Comment by jsrn created at 2016-02-23 16:48:30

I've reviewed the code by hand now, and modified a bunch of stuff, most of it related to docs and doc-tests. Please look through my changes and see if you agree.

Tomorrow, I'll do some blackbox-testing of the code. Then the green light should come (if you accept my modifications).

(note that there are more commits than the 10 listed below)

Best,
Johan
----
Last 10 new commits:


---

Comment by jsrn created at 2016-02-24 13:04:41

This is not necessarily a bug but more a discussion: if there are no nearby codewords this implementation is going to return an empty list. If `s = ell = 1` then the Guruswami-Sudan algorithm is mathematically equivalent to the Berlekamp-Welch, see #19653. If there are no nearby codewords (i.e. with `d/2` radius), then *that* implementation will throw a `DecodingError`. But this implementation will just return `[]`.

I'm not saying that's necessarily wrong. Having a list decoder, you'd like to use `[]` as a valid response. It just means that the algorithm finished completely as it should, and there were no nearby codewords. I just want to be sure that we take this decision with open eyes, and that we possibly document it somewhere.


---

Comment by git created at 2016-02-24 13:46:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jsrn created at 2016-02-24 13:48:46

OK, so I've made one last modification to the docs, and I've black-box tested the decoder some more. I give the green light to your porting of my code. So now you just need to green light my modifications the last two days.

Best,
Johan


---

Comment by dlucas created at 2016-02-25 10:18:07

I read all your changes, and I agree with most, I made a few small changes by myself:

- There was an typo in `decode_to_message`'s doctest because of which the test failed. I fixed it.

- `_flatten_once` doctest had the flag `#random` while its output is not random, thus I removed this flag.

One remark: In #19653, I changed all my hardcoded doctests related to `decode_to_*` methods by examples looking like this:


```
build the code, say C
build the decoder, say D
generate a random element of the code, say c
create a channel which creates as many errors as the decoder's decoding radius
transmit c to get y
check if c == D.decode_to_code(y) [resp. D.connected_encoder().unencode(c) == D.decode_to_message(y)]
```


which I think is a bit better. For instance, it allows us to pick larger codes for tests as you don't have to write the codewords...

Here, I noticed you picked your examples so you get a list of `size > 1`, which I think is a good idea. I don't see a way to use this kind of tests AND guarantee that list size will be at least two though...

Also, I don't really like the new title of `interpolation.py` module as it appears in the index of modules: 

> Finding F[x]-roots, or modular F[x] roots, in polynomials over F[x][y], where F is a (finite) field.

With such a title, one does not immediately see how this module refers to codes/decoding imho.
It's a matter of taste I guess, so I'm not asking to change it, I'm just pointing it.

On my side, I give the greenlight to all your changes. If you agree with mine, I think we're good to go.

David


---

Comment by jsrn created at 2016-02-25 10:49:59

> - There was an typo in `decode_to_message`'s doctest because of which the test failed. I fixed it.
> 
> - `_flatten_once` doctest had the flag `#random` while its output is not random, thus I removed this flag.

OK.

> Here, I noticed you picked your examples so you get a list of `size > 1`, which I think is a good idea. I don't see a way to use this kind of tests AND guarantee that list size will be at least two though...

Well, there is a way to autogenerate received words with a list size > 1, but I think that would be total overkill. I vote for keeping the hard-coded decoding example here to demonstrate the list size >1 while keeping simplicity. But I understand why you changed the format of the other tests, and it makes sense.

> Also, I don't really like the new title of `interpolation.py` module as it appears in the index of modules: 
> 
> > Finding F[x]-roots, or modular F[x] roots, in polynomials over F[x][y], where F is a (finite) field.
> 
> With such a title, one does not immediately see how this module refers to codes/decoding imho.
> It's a matter of taste I guess, so I'm not asking to change it, I'm just pointing it.

Fair point. I guess I was exactly thinking about the modules' potential outside coding theory. Can we strike a balance:

   Finding F[x] roots for (F[x])[y] polynomials, with F a (finite) field, as used in the Guruswami-Sudan decoding algorithm.


> On my side, I give the greenlight to all your changes. If you agree with mine, I think we're good to go.

Cool. Let's agree on the above title and then ship it.
----
New commits:


---

Comment by git created at 2016-02-25 12:06:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-02-25 12:07:56

I changed the title to what you suggested. It's good for me, but I leave you the final word on it.

David


---

Comment by jsrn created at 2016-02-25 12:36:19

Changing status from needs_review to positive_review.


---

Comment by jsrn created at 2016-02-25 12:36:19

Cool.


---

Comment by vbraun created at 2016-02-25 20:08:50

Resolution: fixed
