# Issue 23039: SIGABRT from GF(2^128)(0)^-1

archive/issues_023039.json:
```json
{
    "body": "CC:  @jdemeyer @malb\n\nThis apparently comes from a missing signon/off in NTL interface.\nAs [reported on sage-devel](https://groups.google.com/d/msg/sage-devel/u7oHHEaf-nM/Fkn59rPnAwAJ).\n\nIssue created by migration from https://trac.sagemath.org/ticket/23276\n\n",
    "created_at": "2017-06-19T09:43:16Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "SIGABRT from GF(2^128)(0)^-1",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23039",
    "user": "https://github.com/dimpase"
}
```
CC:  @jdemeyer @malb

This apparently comes from a missing signon/off in NTL interface.
As [reported on sage-devel](https://groups.google.com/d/msg/sage-devel/u7oHHEaf-nM/Fkn59rPnAwAJ).

Issue created by migration from https://trac.sagemath.org/ticket/23276





---

archive/issue_comments_321859.json:
```json
{
    "body": "Attachment [crash_y4N6pl.log](tarball://root/attachments/some-uuid/ticket23276/crash_y4N6pl.log) by @dimpase created at 2017-06-19 09:47:30\n\nbacktrace",
    "created_at": "2017-06-19T09:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321859",
    "user": "https://github.com/dimpase"
}
```

Attachment [crash_y4N6pl.log](tarball://root/attachments/some-uuid/ticket23276/crash_y4N6pl.log) by @dimpase created at 2017-06-19 09:47:30

backtrace



---

archive/issue_comments_321860.json:
```json
{
    "body": "\n```\nsage: GF(2^128)(0)^-1\n------------------------------------------------------------------------\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/cysignals/signals.so(+0x59f8)[0x7fd96c97e9f8]\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/cysignals/signals.so(+0x5a65)[0x7fd96c97ea65]\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/cysignals/signals.so(+0x89ca)[0x7fd96c9819ca]\n/lib64/libpthread.so.0(+0x11040)[0x7fd97c5a2040]\n/lib64/libc.so.6(gsignal+0x104)[0x7fd97bb2b074]\n/lib64/libc.so.6(abort+0x16a)[0x7fd97bb2c4da]\n/home/dima/Sage/sage-dev/local/lib/libntl.so.33(_ZN3NTL13TerminalErrorEPKc+0x2b)[0x7fd95fdffd3b]\n/home/dima/Sage/sage-dev/local/lib/libntl.so.33(_ZN3NTL6InvModERNS_4GF2XERKS0_S3_+0x84)[0x7fd95fccf534]\n/home/dima/Sage/sage-dev/local/lib/libntl.so.33(_ZN3NTL8PowerModERNS_4GF2XERKS0_RKNS_2ZZERKNS_11GF2XModulusE+0x110)[0x7fd95fccf790]\n/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/rings/finite_rings/element_ntl_gf2e.so(+0x19fd5)[0x7fd70e010fd5]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyNumber_Power+0x1de)[0x7fd97c7fc4ce]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x45f8)[0x7fd97c8b9ce8]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7fd97c8bf0c9]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6551)[0x7fd97c8bbc41]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7fd97c8bf0c9]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x8a)[0x7fd97c8e39da]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xe7)[0x7fd97c8e4ed7]\n/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(Py_Main+0xcc1)[0x7fd97c8fbaa1]\n/lib64/libc.so.6(__libc_start_main+0xf0)[0x7fd97bb181e0]\npython(_start+0x2a)[0x40065a]\n------------------------------------------------------------------------\nAttaching gdb to process id 8113.\n...\n```\n",
    "created_at": "2017-06-19T09:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321860",
    "user": "https://github.com/dimpase"
}
```


```
sage: GF(2^128)(0)^-1
------------------------------------------------------------------------
/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/cysignals/signals.so(+0x59f8)[0x7fd96c97e9f8]
/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/cysignals/signals.so(+0x5a65)[0x7fd96c97ea65]
/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/cysignals/signals.so(+0x89ca)[0x7fd96c9819ca]
/lib64/libpthread.so.0(+0x11040)[0x7fd97c5a2040]
/lib64/libc.so.6(gsignal+0x104)[0x7fd97bb2b074]
/lib64/libc.so.6(abort+0x16a)[0x7fd97bb2c4da]
/home/dima/Sage/sage-dev/local/lib/libntl.so.33(_ZN3NTL13TerminalErrorEPKc+0x2b)[0x7fd95fdffd3b]
/home/dima/Sage/sage-dev/local/lib/libntl.so.33(_ZN3NTL6InvModERNS_4GF2XERKS0_S3_+0x84)[0x7fd95fccf534]
/home/dima/Sage/sage-dev/local/lib/libntl.so.33(_ZN3NTL8PowerModERNS_4GF2XERKS0_RKNS_2ZZERKNS_11GF2XModulusE+0x110)[0x7fd95fccf790]
/home/dima/Sage/sage-dev/local/lib/python2.7/site-packages/sage/rings/finite_rings/element_ntl_gf2e.so(+0x19fd5)[0x7fd70e010fd5]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyNumber_Power+0x1de)[0x7fd97c7fc4ce]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x45f8)[0x7fd97c8b9ce8]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7fd97c8bf0c9]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x6551)[0x7fd97c8bbc41]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7e96)[0x7fd97c8bd586]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7fd97c8befac]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7fd97c8bf0c9]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x8a)[0x7fd97c8e39da]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xe7)[0x7fd97c8e4ed7]
/home/dima/Sage/sage-dev/local/lib/libpython2.7.so.1.0(Py_Main+0xcc1)[0x7fd97c8fbaa1]
/lib64/libc.so.6(__libc_start_main+0xf0)[0x7fd97bb181e0]
python(_start+0x2a)[0x40065a]
------------------------------------------------------------------------
Attaching gdb to process id 8113.
...
```




---

archive/issue_comments_321861.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-19T13:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321861",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_321862.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-06-19T13:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321862",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_321863.json:
```json
{
    "body": "Changing component from interfaces to basic arithmetic.",
    "created_at": "2017-06-19T13:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321863",
    "user": "https://github.com/jdemeyer"
}
```

Changing component from interfaces to basic arithmetic.



---

archive/issue_comments_321864.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-06-19T13:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321864",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_321865.json:
```json
{
    "body": "I get exactly the same error as before with this patch.\nHow about adding a doctest that does exactly this:\n\n```\nsage: GF(2^128)(0)^-1\n```\n",
    "created_at": "2017-06-19T13:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321865",
    "user": "https://github.com/dimpase"
}
```

I get exactly the same error as before with this patch.
How about adding a doctest that does exactly this:

```
sage: GF(2^128)(0)^-1
```




---

archive/issue_comments_321866.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-06-19T13:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321866",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_321867.json:
```json
{
    "body": "Note that it works for `GF(2<sup>k)(0)</sup>-1` with `k<16`, but dumps code as soon as `k` is `16` or bigger.\n\nAt this point one stops using givaro and and starts using NTL, so that's why it is different.",
    "created_at": "2017-06-19T13:51:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321867",
    "user": "https://github.com/dimpase"
}
```

Note that it works for `GF(2<sup>k)(0)</sup>-1` with `k<16`, but dumps code as soon as `k` is `16` or bigger.

At this point one stops using givaro and and starts using NTL, so that's why it is different.



---

archive/issue_comments_321868.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-06-19T14:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321868",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_321869.json:
```json
{
    "body": "Right, there were **two** bugs (one in `__invert__` and one in `__pow__`). This should fix both of them. It also makes some unrelated changes to fix compiler warnings.",
    "created_at": "2017-06-19T14:56:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321869",
    "user": "https://github.com/jdemeyer"
}
```

Right, there were **two** bugs (one in `__invert__` and one in `__pow__`). This should fix both of them. It also makes some unrelated changes to fix compiler warnings.



---

archive/issue_comments_321870.json:
```json
{
    "body": "OK, looks good. For consistency, could you perhaps add to `raise ZeroDivisionError`\nin `sage/rings/finite_rings/element_givaro` (and perhaps in the other places there) the same message `'division by zero in finite field'` as you do in `element_ntl_gf2e`?",
    "created_at": "2017-06-19T15:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321870",
    "user": "https://github.com/dimpase"
}
```

OK, looks good. For consistency, could you perhaps add to `raise ZeroDivisionError`
in `sage/rings/finite_rings/element_givaro` (and perhaps in the other places there) the same message `'division by zero in finite field'` as you do in `element_ntl_gf2e`?



---

archive/issue_comments_321871.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-20T09:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321871",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321872.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-20T09:27:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321872",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_321873.json:
```json
{
    "body": "LGTM",
    "created_at": "2017-06-20T10:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321873",
    "user": "https://github.com/dimpase"
}
```

LGTM



---

archive/issue_comments_321874.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-20T10:02:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321874",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_059984.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-22T07:23:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23039#event-59984"
}
```



---

archive/issue_comments_321875.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-22T07:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23039",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23039#issuecomment-321875",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
