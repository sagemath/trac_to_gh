# Issue 21426: Allow singular_ring_delete(NULL)

archive/issues_021426.json:
```json
{
    "body": "CC:  jpflori\n\nWe should allow `singular_ring_delete(NULL)` and simply do nothing. This is analogous to `free(NULL)` which is also explicitly allowed as doing nothing.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21663\n\n",
    "created_at": "2016-10-07T13:53:27Z",
    "labels": [
        "basic arithmetic",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "Allow singular_ring_delete(NULL)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21426",
    "user": "jdemeyer"
}
```
CC:  jpflori

We should allow `singular_ring_delete(NULL)` and simply do nothing. This is analogous to `free(NULL)` which is also explicitly allowed as doing nothing.

Issue created by migration from https://trac.sagemath.org/ticket/21663





---

archive/issue_comments_297407.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-10-07T14:00:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297407",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_297408.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-10-07T14:00:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297408",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_297409.json:
```json
{
    "body": "Could you just document why this is needed?\nTo mimick `free` or did you actually needed it?",
    "created_at": "2016-10-07T14:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297409",
    "user": "jpflori"
}
```

Could you just document why this is needed?
To mimick `free` or did you actually needed it?



---

archive/issue_comments_297410.json:
```json
{
    "body": "\n```\nsage: t = type(QQ['x','y'].zero())\nsage: t.__new__(t);\nsingular_ring_delete(ring*) called with NULL pointer.\n  File \"/usr/local/src/sage-config/src/bin/sage-ipython\", line 11, in <module>\n    app.start()\n  File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/terminal/ipapp.py\", line 348, in start\n    self.shell.mainloop()\n  File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/terminal/interactiveshell.py\", line 402, in mainloop\n    self.interact()\n  File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/terminal/interactiveshell.py\", line 393, in interact\n    self.run_cell(code, store_history=True)\n  File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2705, in run_cell\n    interactivity=interactivity, compiler=compiler, result=result)\n  File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2815, in run_ast_nodes\n    if self.run_code(code, result):\n  File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py\", line 2869, in run_code\n    exec(code_obj, self.user_global_ns, self.user_ns)\n  File \"<ipython-input-16-61c9f5032c44>\", line 1, in <module>\n    t.__new__(t);\nException KeyError: (The ring pointer 0x0,) in 'sage.libs.singular.ring.singular_ring_delete' ignored\n```\n",
    "created_at": "2016-10-07T14:48:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297410",
    "user": "jdemeyer"
}
```


```
sage: t = type(QQ['x','y'].zero())
sage: t.__new__(t);
singular_ring_delete(ring*) called with NULL pointer.
  File "/usr/local/src/sage-config/src/bin/sage-ipython", line 11, in <module>
    app.start()
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/terminal/ipapp.py", line 348, in start
    self.shell.mainloop()
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/terminal/interactiveshell.py", line 402, in mainloop
    self.interact()
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/terminal/interactiveshell.py", line 393, in interact
    self.run_cell(code, store_history=True)
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py", line 2705, in run_cell
    interactivity=interactivity, compiler=compiler, result=result)
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py", line 2815, in run_ast_nodes
    if self.run_code(code, result):
  File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/core/interactiveshell.py", line 2869, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-16-61c9f5032c44>", line 1, in <module>
    t.__new__(t);
Exception KeyError: (The ring pointer 0x0,) in 'sage.libs.singular.ring.singular_ring_delete' ignored
```




---

archive/issue_comments_297411.json:
```json
{
    "body": "Replying to [comment:3 jpflori]:\n> To mimick `free` or did you actually needed it?\n\nAnd yes, apart from #21658 it is typical behaviour that freeing an object can be safely done if that object contains only zero bytes. This is true for `free()` and `delete` in C++ but also `bitset_free()` in Sage and `mpz_clear()` in GMP/MPIR for example.",
    "created_at": "2016-10-08T08:22:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297411",
    "user": "jdemeyer"
}
```

Replying to [comment:3 jpflori]:
> To mimick `free` or did you actually needed it?

And yes, apart from #21658 it is typical behaviour that freeing an object can be safely done if that object contains only zero bytes. This is true for `free()` and `delete` in C++ but also `bitset_free()` in Sage and `mpz_clear()` in GMP/MPIR for example.



---

archive/issue_comments_297412.json:
```json
{
    "body": "**ping**\n\nJean-Pierre, what do you think?",
    "created_at": "2016-10-12T10:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297412",
    "user": "jdemeyer"
}
```

**ping**

Jean-Pierre, what do you think?



---

archive/issue_comments_297413.json:
```json
{
    "body": "Euh, argh, I was onto other stuff.\nThis makes sense and I don't see how it could hurt.",
    "created_at": "2016-10-12T10:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297413",
    "user": "jpflori"
}
```

Euh, argh, I was onto other stuff.
This makes sense and I don't see how it could hurt.



---

archive/issue_comments_297414.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-10-12T10:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297414",
    "user": "jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_297415.json:
```json
{
    "body": "Thanks!",
    "created_at": "2016-10-12T10:08:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297415",
    "user": "jdemeyer"
}
```

Thanks!



---

archive/issue_comments_297416.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-10-29T14:28:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21426",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21426#issuecomment-297416",
    "user": "vbraun"
}
```

Resolution: fixed
