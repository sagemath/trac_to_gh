# Issue 33845: Add an option up_to_isomorphism for is_subgraph

Issue created by migration from https://trac.sagemath.org/ticket/34082

Original creator: vdelecroix

Original creation time: 2022-06-25 21:16:56

CC:  dcoudert

We introduce an option `up_to_isomorphism` to the graph method `is_subgraph`. Also, we add a `_scream_if_not_simple` because the answer is completely wrong for looped or multigraphs.


---

Comment by vdelecroix created at 2022-06-25 21:19:20

New commits:


---

Comment by vdelecroix created at 2022-06-25 21:19:20

Changing status from new to needs_review.


---

Comment by dcoudert created at 2022-06-26 08:44:16

This looks good to me and can be useful. Just a few details.

- I'm not sure of the ordering of the tests. Why not

```
        if up_to_isomorphism:
            return other.subgraph_search(self, induced=induced) is not None

        if any(not other.has_vertex(v) for v in self.vertex_iterator()):
            return False

        self._scream_if_not_simple()
        other._scream_if_not_simple()
        ...
```




- Don't forget to align the comments on 80 columns

- You should add this test and corresponding doctests.

```diff
-         if self.num_verts() > other.num_verts():
+         if self.num_verts() > other.num_verts() or self.size() > other.size():
             return False
```


- also

```diff
-        - ``up_to_isomorphism`` - boolean (default: ``False``); if set to ``True``
+        - ``up_to_isomorphism`` -- boolean (default: ``False``); if set to ``True``
```



---

Comment by vdelecroix created at 2022-06-26 15:33:51

I did update the branch. However, the commits did not appear in comments.
----
New commits:


---

Comment by dcoudert created at 2022-06-26 16:35:04

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2022-06-26 16:35:04

LGTM.


---

Comment by vbraun created at 2022-07-09 22:32:50

Resolution: fixed
