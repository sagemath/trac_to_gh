# Issue 15822: Equality vs hash for braid groups

Issue created by migration from https://trac.sagemath.org/ticket/16059

Original creator: tmonteil

Original creation time: 2014-04-04 11:44:01

Keywords: braid group, hash, Caylay graph

Playing with braid groups for a demo today, i want to see its Caylay graph in a neighbourhood of the neutral element:


```

ball = set()
ball.add(B.one())
for length in range(1,4):
    for w in Words(alphabet=B.gens(), length=length):
        ball.add(prod(w))
G = B.cayley_graph(elements=ball, generators=B.gens()
G.plot()

```


Hmmm, it looks locally like the free group, as if there was no relation !

`s0 * s2` is a different vertex as `s2 * s0`, while:


```
sage: s0 * s2 == s2 * s0
True
```


Indeed:


```
sage: hash(s0 * s2)
954209079
sage: hash(s2 * s0)
1883627875
```


There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `caylay_graph` answers something wrong !


---

Comment by chapoton created at 2014-04-07 19:48:38

Changing keywords from "braid group, hash, Caylay graph" to "braid group, hash, Cayley graph".


---

Attachment


---

Attachment


---

Comment by tmonteil created at 2014-04-14 13:57:01

Changing status from new to needs_review.


---

Comment by tscrim created at 2014-04-14 14:52:43

Could you add an `is_isomorphic()` check to the Cayley graph of the corresponding free group (or some other way of showing it's not the Cayley graph of the free group)? Once that is done, you can set a positive review on my behalf.


---

Comment by tmonteil created at 2014-04-14 18:19:37

Actually, there is already an indirect check when `G` answers `Digraph on 31 vertices` (to be compared to `Digraph on 40 vertices` for the free group, some vertices are merged). Is it enough ?

Otherwise, i do not know a short way to represent directed graphs in Sage, but i could add a test for the undirected version of the graph using `sparse6_string` representation along the following lines just after the previous example, though i am not sure it is easy to read:


```
sage: graph_string = ':^_`aa`ddd`aHhh_lmmmfLqqlStt_HjWxxvW{{'
sage: G.to_undirected().is_isomorphic(Graph(graph_string))
True
```


What do you think ?


---

Comment by chapoton created at 2014-05-10 07:44:32


```
sage -t --long src/sage/groups/braid.py  # 1 doctest failed
```



---

Comment by chapoton created at 2014-05-10 07:44:32

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-05-11 15:06:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-05-17 17:52:22

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2014-05-17 17:52:22

Sorry for letting this slip away. I've added an extra doctest which makes the fix more explicit (at least to those of us who don't know how big the a 4 ball of a free group is `:p`). If you're happy with this, then positive review.
----
New commits:


---

Comment by tmonteil created at 2014-05-19 22:44:33

`@`tscrim : now i get your point. I have merged the two Cayley graph doctests in a single one to avoid repetitions, with a sentence to explain the difference with the free group.

`@`chapoton : i removed the direct hash test whose output depends on the architecture.


---

Comment by tscrim created at 2014-05-21 04:53:54

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2014-05-21 04:53:54

I like this doctest better. Positive review. Thanks.


---

Comment by vbraun created at 2014-05-21 15:33:33

Resolution: fixed
