# Issue 15822: Equality vs hash for braid groups

archive/issues_015822.json:
```json
{
    "body": "Keywords: braid group, hash, Caylay graph\n\nPlaying with braid groups for a demo today, i want to see its Caylay graph in a neighbourhood of the neutral element:\n\n\n```\n\nball = set()\nball.add(B.one())\nfor length in range(1,4):\n    for w in Words(alphabet=B.gens(), length=length):\n        ball.add(prod(w))\nG = B.cayley_graph(elements=ball, generators=B.gens()\nG.plot()\n\n```\n\n\nHmmm, it looks locally like the free group, as if there was no relation !\n\n`s0 * s2` is a different vertex as `s2 * s0`, while:\n\n\n```\nsage: s0 * s2 == s2 * s0\nTrue\n```\n\n\nIndeed:\n\n\n```\nsage: hash(s0 * s2)\n954209079\nsage: hash(s2 * s0)\n1883627875\n```\n\n\nThere should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `caylay_graph` answers something wrong !\n\nIssue created by migration from https://trac.sagemath.org/ticket/16059\n\n",
    "created_at": "2014-04-04T11:44:01Z",
    "labels": [
        "group theory",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Equality vs hash for braid groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15822",
    "user": "tmonteil"
}
```
Keywords: braid group, hash, Caylay graph

Playing with braid groups for a demo today, i want to see its Caylay graph in a neighbourhood of the neutral element:


```

ball = set()
ball.add(B.one())
for length in range(1,4):
    for w in Words(alphabet=B.gens(), length=length):
        ball.add(prod(w))
G = B.cayley_graph(elements=ball, generators=B.gens()
G.plot()

```


Hmmm, it looks locally like the free group, as if there was no relation !

`s0 * s2` is a different vertex as `s2 * s0`, while:


```
sage: s0 * s2 == s2 * s0
True
```


Indeed:


```
sage: hash(s0 * s2)
954209079
sage: hash(s2 * s0)
1883627875
```


There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `caylay_graph` answers something wrong !

Issue created by migration from https://trac.sagemath.org/ticket/16059





---

archive/issue_comments_205309.json:
```json
{
    "body": "Changing keywords from \"braid group, hash, Caylay graph\" to \"braid group, hash, Cayley graph\".",
    "created_at": "2014-04-07T19:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205309",
    "user": "chapoton"
}
```

Changing keywords from "braid group, hash, Caylay graph" to "braid group, hash, Cayley graph".



---

archive/issue_comments_205310.json:
```json
{
    "body": "Attachment [Cayley_before.png](tarball://root/attachments/some-uuid/ticket16059/Cayley_before.png) by tmonteil created at 2014-04-14 13:53:17",
    "created_at": "2014-04-14T13:53:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205310",
    "user": "tmonteil"
}
```

Attachment [Cayley_before.png](tarball://root/attachments/some-uuid/ticket16059/Cayley_before.png) by tmonteil created at 2014-04-14 13:53:17



---

archive/issue_comments_205311.json:
```json
{
    "body": "Attachment [Cayley_after.png](tarball://root/attachments/some-uuid/ticket16059/Cayley_after.png) by tmonteil created at 2014-04-14 13:57:01",
    "created_at": "2014-04-14T13:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205311",
    "user": "tmonteil"
}
```

Attachment [Cayley_after.png](tarball://root/attachments/some-uuid/ticket16059/Cayley_after.png) by tmonteil created at 2014-04-14 13:57:01



---

archive/issue_comments_205312.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-14T13:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205312",
    "user": "tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_205313.json:
```json
{
    "body": "Could you add an `is_isomorphic()` check to the Cayley graph of the corresponding free group (or some other way of showing it's not the Cayley graph of the free group)? Once that is done, you can set a positive review on my behalf.",
    "created_at": "2014-04-14T14:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205313",
    "user": "tscrim"
}
```

Could you add an `is_isomorphic()` check to the Cayley graph of the corresponding free group (or some other way of showing it's not the Cayley graph of the free group)? Once that is done, you can set a positive review on my behalf.



---

archive/issue_comments_205314.json:
```json
{
    "body": "Actually, there is already an indirect check when `G` answers `Digraph on 31 vertices` (to be compared to `Digraph on 40 vertices` for the free group, some vertices are merged). Is it enough ?\n\nOtherwise, i do not know a short way to represent directed graphs in Sage, but i could add a test for the undirected version of the graph using `sparse6_string` representation along the following lines just after the previous example, though i am not sure it is easy to read:\n\n\n```\nsage: graph_string = ':^_`aa`ddd`aHhh_lmmmfLqqlStt_HjWxxvW{{'\nsage: G.to_undirected().is_isomorphic(Graph(graph_string))\nTrue\n```\n\n\nWhat do you think ?",
    "created_at": "2014-04-14T18:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205314",
    "user": "tmonteil"
}
```

Actually, there is already an indirect check when `G` answers `Digraph on 31 vertices` (to be compared to `Digraph on 40 vertices` for the free group, some vertices are merged). Is it enough ?

Otherwise, i do not know a short way to represent directed graphs in Sage, but i could add a test for the undirected version of the graph using `sparse6_string` representation along the following lines just after the previous example, though i am not sure it is easy to read:


```
sage: graph_string = ':^_`aa`ddd`aHhh_lmmmfLqqlStt_HjWxxvW{{'
sage: G.to_undirected().is_isomorphic(Graph(graph_string))
True
```


What do you think ?



---

archive/issue_comments_205315.json:
```json
{
    "body": "\n```\nsage -t --long src/sage/groups/braid.py  # 1 doctest failed\n```\n",
    "created_at": "2014-05-10T07:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205315",
    "user": "chapoton"
}
```


```
sage -t --long src/sage/groups/braid.py  # 1 doctest failed
```




---

archive/issue_comments_205316.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-10T07:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205316",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_205317.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-11T15:06:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205317",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_205318.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-17T17:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205318",
    "user": "tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_205319.json:
```json
{
    "body": "Sorry for letting this slip away. I've added an extra doctest which makes the fix more explicit (at least to those of us who don't know how big the a 4 ball of a free group is `:p`). If you're happy with this, then positive review.\n----\nNew commits:",
    "created_at": "2014-05-17T17:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205319",
    "user": "tscrim"
}
```

Sorry for letting this slip away. I've added an extra doctest which makes the fix more explicit (at least to those of us who don't know how big the a 4 ball of a free group is `:p`). If you're happy with this, then positive review.
----
New commits:



---

archive/issue_comments_205320.json:
```json
{
    "body": "`@`tscrim : now i get your point. I have merged the two Cayley graph doctests in a single one to avoid repetitions, with a sentence to explain the difference with the free group.\n\n`@`chapoton : i removed the direct hash test whose output depends on the architecture.",
    "created_at": "2014-05-19T22:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205320",
    "user": "tmonteil"
}
```

`@`tscrim : now i get your point. I have merged the two Cayley graph doctests in a single one to avoid repetitions, with a sentence to explain the difference with the free group.

`@`chapoton : i removed the direct hash test whose output depends on the architecture.



---

archive/issue_comments_205321.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-21T04:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205321",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_205322.json:
```json
{
    "body": "I like this doctest better. Positive review. Thanks.",
    "created_at": "2014-05-21T04:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205322",
    "user": "tscrim"
}
```

I like this doctest better. Positive review. Thanks.



---

archive/issue_comments_205323.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-21T15:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15822#issuecomment-205323",
    "user": "vbraun"
}
```

Resolution: fixed
