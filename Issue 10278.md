# Issue 10278: Bug in factor of polynomials over number fields

Issue created by migration from Trac.

Original creator: lftabera

Original creation time: 2010-11-16 10:08:38

Assignee: tbd

CC:  jdemeyer

Keywords: pari, factor, number field

Bug raised in sage-devel by Niels Lubbes

[http://groups.google.com/group/sage-devel/browse_thread/thread/33aa40a7685f37aa/d6a6230ee023fd06?show_docid=d6a6230ee023fd06](http://groups.google.com/group/sage-devel/browse_thread/thread/33aa40a7685f37aa/d6a6230ee023fd06?show_docid=d6a6230ee023fd06)


```
 sage: R = PolynomialRing( QQ, var( 't' ), order = 'lex' ) 
 sage: t = R.gens()[0] 
 sage: f = t^4 - t^2 + 1 
 sage: T = NumberFieldTower( [f], 'a0' ) 
 sage: R1 = R.change_ring( T ) 
 sage: a0 = T.gens()[0] 
 sage: t = R1.gens()[0] 
 sage: poly = t^3 + (-4*a0^3 + 2*a0)*t^2 - 11/3*a0^2*t + 2/3*a0^3 - 4/3*a0 
 sage: poly.factor() 
 (t - 2*a0^3 + a0) * (t^2 + (-2*a0^3 + a0)*t - 2/3*a0^2) 
 sage: fact = poly.factor()[1][0] 
 sage: fact.factor() 
 (t - 4/3*a0^3 + 2/3*a0) * (t - 2/3*a0^3 + 1/3*a0) 
```


As Jeroen Demeyer points, it is a bug in Pari.


```
 gp> t; nf = nfinit(a^4 - a^2 + 1); 
 gp> poly = t^3 + (-4*a^3 + 2*a)*t^2 - 11/3*a^2*t + 2/3*a^3 - 4/3*a 
 %1 = t^3 + (-4*a^3 + 2*a)*t^2 - 11/3*a^2*t + (2/3*a^3 - 4/3*a) 
 gp> F = nffactor(nf, poly) 
 %2 = 
 [t + Mod(-2*a^3 + a, a^4 - a^2 + 1) 1] 
 
 [t^2 + Mod(-2*a^3 + a, a^4 - a^2 + 1)*t + Mod(-2/3*a^2, a^4 - a^2 + 1) 1] 
 
 gp> nffactor(nf, F[2,1]) 
 %3 = 
 [t + Mod(-4/3*a^3 + 2/3*a, a^4 - a^2 + 1) 1] 
 
 [t + Mod(-2/3*a^3 + 1/3*a, a^4 - a^2 + 1) 1] 
```



---

Comment by lftabera created at 2010-11-16 10:09:05

upstream bug reference

[http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1132](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1132)


---

Comment by jdemeyer created at 2010-11-18 09:48:59

Changing assignee from tbd to davidloeffler.


---

Comment by jdemeyer created at 2010-11-18 09:48:59

Changing component from factorization to number fields.


---

Comment by jdemeyer created at 2010-12-10 12:50:11

See #10430


---

Comment by jdemeyer created at 2010-12-10 12:50:11

Changing status from new to needs_review.


---

Comment by davidloeffler created at 2010-12-10 13:08:12

I suggest we keep this ticket open until the new Pari is in, and then we can add a doctest to prove that it is fixed. Otherwise there is a danger that we forget to add such a doctest and the bug reappears at a later date.


---

Comment by jdemeyer created at 2010-12-10 13:24:59

Replying to [comment:5 davidloeffler]:
> I suggest we keep this ticket open until the new Pari is in, and then we can add a doctest to prove that it is fixed. Otherwise there is a danger that we forget to add such a doctest and the bug reappears at a later date.

Agreed!


---

Comment by lftabera created at 2010-12-15 12:40:58

This is a trivial doctest patch. The patch applies cleanly and adds a relevant doctest. Once #10430 is merged this will go along. Positive review.


---

Comment by lftabera created at 2010-12-15 12:40:58

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-01-19 22:22:32

Resolution: fixed


---

Comment by jdemeyer created at 2011-01-20 09:10:50

Resolution changed from fixed to 


---

Comment by jdemeyer created at 2011-01-20 09:10:50

Changing status from closed to new.


---

Comment by jdemeyer created at 2011-01-20 09:11:01

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2011-01-20 09:11:13

Changing status from needs_review to positive_review.


---

Attachment


---

Comment by jdemeyer created at 2011-01-25 08:15:15

Resolution: fixed
