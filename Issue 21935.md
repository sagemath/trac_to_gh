# Issue 21935: faster coercion from Python ints to ℚ(√a)

Issue created by migration from Trac.

Original creator: mmezzarobba

Original creation time: 2017-01-11 18:29:23

CC:  vdelecroix

Via the fast conversions int → ℤ → ℚ(√a)


---

Comment by mmezzarobba created at 2017-01-11 19:44:33

Changing status from new to needs_review.


---

Comment by tscrim created at 2017-01-12 02:25:45

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-01-12 02:25:45

LGTM:

```
sage: R.<p> = QQ[]
sage: K.<a> = NumberField(p^2-2)
sage: phi = K.coerce_map_from(int)
sage: phi
Composite map:
  From: Set of Python objects of type 'int'
  To:   Number Field in a with defining polynomial p^2 - 2
  Defn:   Native morphism:
          From: Set of Python objects of type 'int'
          To:   Integer Ring
        then
          Natural morphism:
          From: Integer Ring
          To:   Number Field in a with defining polynomial p^2 - 2
sage: z = int(5)
sage: %timeit phi(z)
The slowest run took 16.55 times longer than the fastest. This could mean that an intermediate result is being cached.
1000000 loops, best of 3: 1.51 µs per loop
sage: %timeit phi(z)
The slowest run took 15.68 times longer than the fastest. This could mean that an intermediate result is being cached.
1000000 loops, best of 3: 1.47 µs per loop
```

vs old

```
sage: R.<p> = QQ[]
sage: K.<a> = NumberField(p^2-2)
sage: phi = K.coerce_map_from(int)
sage: phi
Conversion map:
  From: Set of Python objects of type 'int'
  To:   Number Field in a with defining polynomial p^2 - 2
sage: z = int(5)
sage: %timeit phi(z)
The slowest run took 10.42 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 6.82 µs per loop
sage: %timeit phi(z)
The slowest run took 9.33 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 6.85 µs per loop
```



---

Comment by mmezzarobba created at 2017-01-12 08:22:26

Thanks for the review!


---

Comment by vbraun created at 2017-01-28 17:03:31

Resolution: fixed
