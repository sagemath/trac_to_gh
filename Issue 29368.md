# Issue 29368: plotting function for forests

archive/issues_029368.json:
```json
{
    "body": "Keywords: graph plotting forest\n\nCurrently, it is not possible to plot forests using the `layout_tree` algorithm. : `layout_tree` raises an exception when the input graph is not a tree.\n\nThis ticket introduces the `layout_forest` function, which plots forests using `layout_tree` on each connected component, via the `layout_split` function introduced in ticket #29522 to deal with disconnected graphs. The function is very simple, it is basically a wrapper for `layout_split`.\n\nOther things changed in this ticket:\n- Minor changes in `layout_split` to deal with the layout options.\n- Returning a dict of lists of size 2 (positions of the vertices) in `layout_tree` instead of a dict of pairs. This is to match the behavior of the other graph layout functions (useful here as `layout_split` should work with all layout functions).\n- Checking whether the input graph is empty and if so returning the appropriate result in `layout_tree` (otherwise, the result is an exception saying that the graph is not a tree).\n\nIssue created by migration from https://trac.sagemath.org/ticket/29605\n\n",
    "created_at": "2020-04-27T18:42:59Z",
    "labels": [
        "component: graph theory",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "plotting function for forests",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29368",
    "user": "https://github.com/jfraymond"
}
```
Keywords: graph plotting forest

Currently, it is not possible to plot forests using the `layout_tree` algorithm. : `layout_tree` raises an exception when the input graph is not a tree.

This ticket introduces the `layout_forest` function, which plots forests using `layout_tree` on each connected component, via the `layout_split` function introduced in ticket #29522 to deal with disconnected graphs. The function is very simple, it is basically a wrapper for `layout_split`.

Other things changed in this ticket:
- Minor changes in `layout_split` to deal with the layout options.
- Returning a dict of lists of size 2 (positions of the vertices) in `layout_tree` instead of a dict of pairs. This is to match the behavior of the other graph layout functions (useful here as `layout_split` should work with all layout functions).
- Checking whether the input graph is empty and if so returning the appropriate result in `layout_tree` (otherwise, the result is an exception saying that the graph is not a tree).

Issue created by migration from https://trac.sagemath.org/ticket/29605





---

archive/issue_comments_415972.json:
```json
{
    "body": "When I was looking for places where `layout_tree` (from `GenericGraph`) is used I found an other `layout_tree` function in `graph_plot.py`. It seems to be the same function (some parts of the code are identical) with less options.\nAlso it is unclear from the [documentation](https://doc.sagemath.org/html/en/reference/graphs/sage/graphs/graph_plot.html#sage.graphs.graph_plot.GraphPlot.layout_tree) what is the purpose of having this function here while the same result can be achieved with `layout_tree` from `GenericGraph`).\nIs it something that somebody planned to remove but forgot?\n\nSecond question:\nthe only failing doctest I got is the following:\n\n```python\nsage: g = graphs.LadderGraph(3) #TODO!!!!\nsage: g.layout_spring()\n{0: [0.73..., -0.29...],\n1: [1.37..., 0.30...],\n2: [2.08..., 0.89...],\n3: [1.23..., -0.83...],\n4: [1.88..., -0.30...],\n5: [2.53..., 0.22...]}\n```\n\n(\"TODO!!!!\" is not mine)\n\nIt is quite surprising as I did not touch this function and tests passed on the branch on which this one is based (that of #29522).\nAlso, I always get different results when I run the following\n\n```python\nsage: g = graphs.LadderGraph(3)\nsage: g.layout_spring()\n```\n\neven on the `develop` branch. (So I do not even see how the tests can pass on this branch.) Any idea?",
    "created_at": "2020-04-27T19:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415972",
    "user": "https://github.com/jfraymond"
}
```

When I was looking for places where `layout_tree` (from `GenericGraph`) is used I found an other `layout_tree` function in `graph_plot.py`. It seems to be the same function (some parts of the code are identical) with less options.
Also it is unclear from the [documentation](https://doc.sagemath.org/html/en/reference/graphs/sage/graphs/graph_plot.html#sage.graphs.graph_plot.GraphPlot.layout_tree) what is the purpose of having this function here while the same result can be achieved with `layout_tree` from `GenericGraph`).
Is it something that somebody planned to remove but forgot?

Second question:
the only failing doctest I got is the following:

```python
sage: g = graphs.LadderGraph(3) #TODO!!!!
sage: g.layout_spring()
{0: [0.73..., -0.29...],
1: [1.37..., 0.30...],
2: [2.08..., 0.89...],
3: [1.23..., -0.83...],
4: [1.88..., -0.30...],
5: [2.53..., 0.22...]}
```

("TODO!!!!" is not mine)

It is quite surprising as I did not touch this function and tests passed on the branch on which this one is based (that of #29522).
Also, I always get different results when I run the following

```python
sage: g = graphs.LadderGraph(3)
sage: g.layout_spring()
```

even on the `develop` branch. (So I do not even see how the tests can pass on this branch.) Any idea?



---

archive/issue_comments_415973.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-04-28T08:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415973",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415974.json:
```json
{
    "body": "Problem 2 solved: The result of `layout_spring` was different because I changed the definition of the variable `buffer` in `layout_split`, which is used by `layout_spring` (even when the graph is connected).\nSo I fixed the failing doctest by changing the expected layout in the docstring for what sage got when running the tests, even though it is still a mystery for me why the test pass now for such a function that return different results every time I run it.",
    "created_at": "2020-04-28T08:55:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415974",
    "user": "https://github.com/jfraymond"
}
```

Problem 2 solved: The result of `layout_spring` was different because I changed the definition of the variable `buffer` in `layout_split`, which is used by `layout_spring` (even when the graph is connected).
So I fixed the failing doctest by changing the expected layout in the docstring for what sage got when running the tests, even though it is still a mystery for me why the test pass now for such a function that return different results every time I run it.



---

archive/issue_comments_415975.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-04-28T09:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415975",
    "user": "https://github.com/jfraymond"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_415976.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-01T08:31:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415976",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415977.json:
```json
{
    "body": "Please fix the patchbot warning\n\n```\n+src/sage/graphs/graph_plot.py:596:41: E701 multiple statements on one line (colon)\n```\n\neven if it's not your fault.",
    "created_at": "2020-05-02T06:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415977",
    "user": "https://github.com/fchapoton"
}
```

Please fix the patchbot warning

```
+src/sage/graphs/graph_plot.py:596:41: E701 multiple statements on one line (colon)
```

even if it's not your fault.



---

archive/issue_comments_415978.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-02T09:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415978",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415979.json:
```json
{
    "body": "red branch",
    "created_at": "2020-06-03T16:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415979",
    "user": "https://github.com/fchapoton"
}
```

red branch



---

archive/issue_comments_415980.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-06-03T16:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415980",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_415981.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-06-20T07:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415981",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_415982.json:
```json
{
    "body": "I rebased the ticket on 9.2.beta1, fixed merge conflicts and added a missing doctest.\n----\nNew commits:",
    "created_at": "2020-06-20T07:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415982",
    "user": "https://github.com/dcoudert"
}
```

I rebased the ticket on 9.2.beta1, fixed merge conflicts and added a missing doctest.
----
New commits:



---

archive/issue_comments_415983.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-20T08:02:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415983",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415984.json:
```json
{
    "body": "Thanks!",
    "created_at": "2020-06-23T14:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415984",
    "user": "https://github.com/jfraymond"
}
```

Thanks!



---

archive/issue_comments_415985.json:
```json
{
    "body": "If you are OK, you can set this ticket to positive review on my behalf.",
    "created_at": "2020-06-23T15:18:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415985",
    "user": "https://github.com/dcoudert"
}
```

If you are OK, you can set this ticket to positive review on my behalf.



---

archive/issue_comments_415986.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-23T16:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415986",
    "user": "https://github.com/jfraymond"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_415987.json:
```json
{
    "body": "Done. Thanks!",
    "created_at": "2020-06-23T16:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415987",
    "user": "https://github.com/jfraymond"
}
```

Done. Thanks!



---

archive/issue_events_075591.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-07-08T19:32:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29368#event-75591"
}
```



---

archive/issue_comments_415988.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-07-08T19:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29368",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29368#issuecomment-415988",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
