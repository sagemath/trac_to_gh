# Issue 17761: is_dominant methods of weight lattices should ignore vectors orthogonal to coroots

Issue created by migration from https://trac.sagemath.org/ticket/17998

Original creator: bump

Original creation time: 2015-03-19 15:06:19

Assignee: bump

CC:  sage-combinat aschilling nthiery mshimo tscrim

Keywords: dominant, days64

Weight lattices have definitions in `root_lattice_realizations.py` and in `weight_space.py`. Adding a vector that is orthogonal to the simple coroots should not affect whether a weight is dominant.  Furthermore there is a separate function called is_dominant_weight defined in root_lattice_realizations. There are reasons for having separate implementations: the realization in weight_space.py is more efficient since it avoids taking scalar products. Instead, it just looks at the coefficients to see if they are positive. But this method only works if the basis consists of the fundamental weights. Moreover in an extended affine weight lattice the basis consists of the fundamental weights plus the null root 'delta'. The coefficient of  'delta' should be ignored, so currently this method can give wrong results.


```
sage: P=RootSystem(['A',2,1]).weight_lattice(extended=true)
sage: delta=P.null_root(); delta
delta
sage: Lam = P.fundamental_weights()
sage: Lam[0].is_dominant()
True
sage: (Lam[0]-delta).is_dominant()
False
```


Consequently we need to revise a remark in the docstring for is_dominant_weight, and refine the definition in `weight_lattice.py` to ignore the coefficient of `'delta'`


---

Comment by bump created at 2015-03-19 17:01:00

New commits:


---

Comment by git created at 2015-03-19 17:09:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-03-19 18:02:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by bump created at 2015-03-19 18:13:43

Changing status from new to needs_review.


---

Comment by git created at 2015-03-19 19:14:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aschilling created at 2015-03-19 19:20:51

Looks good to me! Perhaps a reference to Kac should be added?


---

Comment by git created at 2015-03-19 19:31:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by aschilling created at 2015-03-19 19:47:59

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-03-19 23:39:45

Resolution: fixed
