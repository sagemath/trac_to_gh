# Issue 34286: Add dummy package github_cli

Issue created by migration from https://trac.sagemath.org/ticket/34523

Original creator: mkoeppe

Original creation time: 2022-09-12 15:08:50

CC:  @tobiasdiez klee slelievre dimpase jhpalmieri

https://github.com/cli/cli#installation


---

Comment by mkoeppe created at 2022-09-12 15:27:49

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2022-09-12 15:27:49

New commits:


---

Comment by git created at 2022-09-12 16:10:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @tobiasdiez created at 2022-09-12 21:29:33

+1 for adding the github cli to the documentation to increase awareness of devs that such a tool exist, but -1 for recommending that every (potential) developer installs it, especially for a system-wide install. In my opinion, its okay to preinstall it in the dev containers (.devcontainer, gitpod, maybe conda) since its somewhat awkward to install new tools there. But it feels like an overkill to add it to the sage's package infrastructure. Otherwise we end up with a huge list of tools that might be helpful in certain situations, but in the end come down to the preference to each dev (or do you also want to add say the github desktop app or even vscode?).


---

Comment by mkoeppe created at 2022-09-12 22:24:31

Replying to [comment:5 Tobias Diez]:
> it feels like an overkill to add it to the sage's package infrastructure

It's an appropriate use of our infrastructure as it is designed. Dummy script packages serve exactly this purpose: Advertising software and how to obtain it on different systems, in a way that it serves both documentation purposes and provisions executable environments.


---

Comment by @tobiasdiez created at 2022-09-13 15:44:46

https://5fe7a6ecba88acf2ab7cc9dccf9bc1f1775a922c--sagemath-tobias.netlify.app/installation/source.html?highlight=buster#debian-ubuntu-prerequisite-installation now says that "If you wish to do Sage development, additionally install the following: ... gh". But the github cli is definitely not needed for the development nor does this section contains any discussion about its merits.


---

Comment by @tobiasdiez created at 2022-09-13 15:44:46

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2022-09-13 15:57:54

Do you have a suggestion on improving this?


---

Comment by @tobiasdiez created at 2022-09-13 16:20:01

Removing it there and in the to-be-written "Contributing (via Github)" guide mention it as a side note: "If you prefer, you can also use the Github CLI".


---

Comment by mkoeppe created at 2022-09-13 16:33:50

Doesn't sound like an improvement to me.

Note that this section has long lists of packages that we *recommend* people install. 
These are not the minimal prerequisites, which would be a shorter list of packages.

I'll take a stab at clarifying this.


---

Comment by mkoeppe created at 2022-09-13 19:24:21

... in #34528.


---

Comment by @dimpase created at 2022-09-14 21:47:13

by the way, gh/cli is extendable - see https://cli.github.com/manual/gh_extension

There is a list of ones promoted (?) by github: https://github.com/topics/gh-extension

So we can potentially script what's needed to make `gh` better suited for our worksflows (or find what's needed there)


---

Comment by jhpalmieri created at 2022-09-19 20:13:39

I think that the changes in #34528 address the concerns (changing the language from "If you wish to do Sage development, additionally install the following" to "If you wish to do Sage development, we recommend that you additionally install the following:").

Is this branch ready for review?


---

Comment by mkoeppe created at 2022-09-19 20:33:16

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2022-09-19 20:35:15

I think this is ready. Any objections to a positive review, given the proposed changes in #34528?


---

Comment by @tobiasdiez created at 2022-09-19 22:30:39

It should wait until the move to gh is decided, or not?

I still question if a "general recommendation" is a good idea. For me the gh cli falls in the same preference category as IDEs (since it is essentially a different view on the gh web interface). There are few other tools that provide similar functionality, are as officially supported (e.g. https://desktop.github.com/) and some devs might prefer one over the other. 

Just to make this clear: I'm not objecting that we recommend the gh cli, just that it should be accompanied with a disclaimer explaining when to install it.


---

Comment by mkoeppe created at 2022-09-19 22:32:30

Replying to [comment:18 Tobias Diez]:
> It should wait until the move to gh is decided, or not?

No, it's also useful for development of various packages that are already maintained on GitHub


---

Comment by jhpalmieri created at 2022-09-19 22:55:39

Is it analogous to `git-trac`, a package that we almost but don't quite recommend? Or is it likely to be more widely used than `git-trac`?


---

Comment by mkoeppe created at 2022-09-19 23:36:45

Pretty sure that we used to quite forcefully recommend `git-trac` to developers (before we de-emphasized it in #33648 in favor of first introducing plain `git`).


---

Comment by @tobiasdiez created at 2022-09-20 06:29:04

Replying to [comment:20 John Palmieri]:
> Is it analogous to `git-trac`, a package that we almost but don't quite recommend? Or is it likely to be more widely used than `git-trac`?

Given that there are powerful alternatives, in my opinion, gh-cli will be considerably less used than even git-trac. But maybe wait until we migrate to gh and people tried different tools, to see what fits into the workflow of most people.


---

Comment by @tobiasdiez created at 2022-09-20 06:29:30

The installation in the devcontainers should use https://github.com/devcontainers/features/tree/main/src/github-cli


---

Comment by @tobiasdiez created at 2022-09-20 06:29:30

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2022-09-20 16:34:42

Replying to [comment:23 Tobias Diez]:
> The installation in the devcontainers should use https://github.com/devcontainers/features/tree/main/src/github-cli

Yes, this is one option how to install it. You'll have to explain where the "should" comes from.


---

Comment by jhpalmieri created at 2022-09-20 16:56:52

I don't see the harm in recommending installation of this package. It's not like we're recommending `vi` when we all know that `emacs` is a better option. It's also not like recommending `TeX-Live` which is quite large (a few gigabytes). People are free to ignore the suggestion, or they can install it (since it's quick to install and doesn't take up that much space) and then end up not using it.


---

Comment by mkoeppe created at 2022-09-20 17:06:53

Replying to [comment:22 Tobias Diez]:
> Given that there are powerful alternatives, 

Well, I don't see us documenting use of GitHub Desktop in our manuals.
The official command-line interface does have special standing.

> in my opinion, gh-cli will be considerably less used than even git-trac.

Documenting use of the github-cli has an important function for the proposed transition to GitHub: To alleviate concerns that developers are "forced" to interact with a website.


---

Comment by mkoeppe created at 2022-09-20 17:07:20

Changing status from needs_work to needs_review.


---

Comment by @tobiasdiez created at 2022-09-21 07:08:54

Changing status from needs_review to needs_work.


---

Comment by @tobiasdiez created at 2022-09-21 07:08:54

The auto-generated command from https://5fe7a6ecba88acf2ab7cc9dccf9bc1f1775a922c--sagemath-tobias.netlify.app/installation/source.html does not work on gitpod (ubuntu):

```
sudo apt-get install  autoconf automake gh git gpgconf libtool openssh openssh-client pkg-config
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package gh
E: Unable to locate package openssh
```


Also the installation instructions at https://github.com/cli/cli/blob/trunk/docs/install_linux.md#debian-ubuntu-linux-raspberry-pi-os-apt include a few additional steps that are missing.


---

Comment by @tobiasdiez created at 2022-09-21 07:11:15

Replying to [comment:24 Matthias Köppe]:
> Replying to [comment:23 Tobias Diez]:
> > The installation in the devcontainers should use https://github.com/devcontainers/features/tree/main/src/github-cli
> 
> Yes, this is one option how to install it. You'll have to explain where the "should" comes from.

You can have a look at the installation script there to see all the reasons. But mainly because github had/has issues with their gpg signing: https://github.com/cli/cli/issues/6175 and this is taken care of by the devcontainer feature.


---

Comment by @tobiasdiez created at 2022-09-21 07:31:13

Moreover, I don't see why sagemath needs and wants to maintains ways on how to install the github cli on different sources. Just link to https://github.com/cli/cli#installation and let github do the work. For example, if/when they stop their debian packaging (https://github.com/cli/cli/issues/5941) these instructions are automatically updated, no extra work on our part.

Same thing with the devcontainer feature. Its the officially supported way of installing gh in a devcontainer and it is tested and improved by many devs. I think what needs to be justified is why to not use it.


---

Comment by mkoeppe created at 2022-09-21 15:28:39

Replying to [comment:30 Tobias Diez]:
> For example, if/when they stop their debian packaging 

The Debian package `gh` is a Debian package, it's not maintained by upstream.


---

Comment by mkoeppe created at 2022-09-21 15:30:17

Replying to [comment:30 Tobias Diez]:
> Moreover, I don't see why sagemath needs and wants to maintains ways on how to install the github cli on different sources.

Because it will be more convenient for people to install it as part of the long commands that we prepare for them that install everything else -- instead of having to follow the link to the documentation, read the installation instructions, and do the installation.


---

Comment by mkoeppe created at 2022-09-21 15:31:22

Replying to [comment:28 Tobias Diez]:
> The auto-generated command from https://5fe7a6ecba88acf2ab7cc9dccf9bc1f1775a922c--sagemath-tobias.netlify.app/installation/source.html does not work on gitpod (ubuntu):
> {{{
> sudo apt-get install  autoconf automake gh git gpgconf libtool openssh openssh-client pkg-config
> Reading package lists... Done
> Building dependency tree       
> Reading state information... Done
> E: Unable to locate package gh
> E: Unable to locate package openssh
> }}}

Yes, gh is only in debian-sid as of now.

openssh is a bug that will be fixed in #34561.


---

Comment by mkoeppe created at 2022-09-21 15:33:37

Replying to [comment:28 Tobias Diez]:
> Also the installation instructions at https://github.com/cli/cli/blob/trunk/docs/install_linux.md#debian-ubuntu-linux-raspberry-pi-os-apt include a few additional steps that are missing.

These are the instructions for using upstream's Debian packages, not the Debian package `gh`.


---

Comment by git created at 2022-09-23 17:47:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-09-23 17:49:40

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2022-09-23 19:36:51

I'm happy with this now.


---

Comment by jhpalmieri created at 2022-09-23 19:37:22

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2022-09-23 19:37:50

Sorry, wrong ticket.


---

Comment by jhpalmieri created at 2022-09-23 19:37:50

Changing status from positive_review to needs_review.


---

Comment by @tobiasdiez created at 2022-09-23 20:33:59

As far as I can see comment:33 is still not addressed, i.e. the generated command does not work on Ubuntu.

Please also extend the description a bit. In particular, at which places do we see consequences of this change.


---

Comment by mkoeppe created at 2022-09-23 20:39:29

Replying to [comment:41 Tobias Diez]:
> As far as I can see comment:33 is still not addressed, i.e. the generated command does not work on Ubuntu.

No, that was take care of by #34561.

`ubuntu-jammy` and `ubuntu-kinetic` have the package, see https://repology.org/project/github-cli/versions


---

Comment by git created at 2022-09-23 20:47:32

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by @tobiasdiez created at 2022-09-24 10:25:49

Replying to [comment:42 Matthias Köppe]:
> Replying to [comment:41 Tobias Diez]:
> > As far as I can see comment:33 is still not addressed, i.e. the generated command does not work on Ubuntu.
> 
> No, that was take care of by #34561.

That takes care of the openssh issue, but not the failing gh.

> 
> `ubuntu-jammy` and `ubuntu-kinetic` have the package, see https://repology.org/project/github-cli/versions

But sage also offically supports older ubuntu versions... Thus, I suggest to add the commands from https://github.com/cli/cli/blob/trunk/docs/install_linux.md#debian-ubuntu-linux-raspberry-pi-os-apt before the autogenerated `apt-get install ...` line.


---

Comment by mkoeppe created at 2022-09-24 15:35:44

Replying to [comment:47 Tobias Diez]:
> > `ubuntu-jammy` and `ubuntu-kinetic` have the package, see https://repology.org/project/github-cli/versions
> 
> But sage also offically supports older ubuntu versions... 

None of this is specific to the `gh` package. Whenever we add a new package, it may not be available on older versions.


---

Comment by klee created at 2022-10-19 06:45:29

Replying to [comment:22 Tobias Diez]:
> Replying to [comment:20 John Palmieri]:
> > Is it analogous to `git-trac`, a package that we almost but don't quite recommend? Or is it likely to be more widely used than `git-trac`?
> 
> Given that there are powerful alternatives, in my opinion, gh-cli will be considerably less used than even git-trac. But maybe wait until we migrate to gh and people tried different tools, to see what fits into the workflow of most people.

I started using `gh` only recently, and still don't know about those powerful alternatives except github web interface (I don't feel like searching for them, yet).

Promoting `gh` as a development prerequisite seems too much to me. But as  `gh`, along with `git`, will be the official tool (I hope) with which we document the development workflow with github, it seems appropriate to advertise `gh` and offer an installation guide. So

+1 to adding dummy package `github-cli`.

+1 to removing `github-cli` from `_develop/dependencies`. 

We may add a new dummy package `_develop_extras` and add `github-cli` to it.


---

Comment by dimpase created at 2022-10-19 13:22:01

I agree: having `gh` as a "hard" dependency is too much.


---

Comment by mkoeppe created at 2022-10-19 17:29:33

Note that

```
cat build/pkgs/_develop/SPKG.rst 
\_develop: Represents system packages recommended for development
=================================================================

Description
-----------

Script package representing a list of system packages recommended for developers.
```


A "hard dependency" of a package that collects recommendations is merely a recommendation.


---

Comment by klee created at 2022-10-19 22:50:27

From

https://3b45534b5b3352783037dfc8b44a6590deca8100--sagemath-tobias.netlify.app/installation/source.html

we read

```
If you wish to do Sage development, we recommend that you additionally install the following:

$ sudo apt-get install autoconf automake gh git gpgconf libtool openssh-client pkg-config
```

Of the packages in the list, `git` is really not an option for sage development. Likewise, other packages look "mandatory for sage development" to me (a typical sage developer not versed in the build system). The question is whether `gh` deserves to be in the list. I take `gh` as `git-trac` replacement. For a long time, I only used `git` for sage development. Relatively recently, I found that `git-trac` is very useful. We did not put `git-trac` in the above list. Then why `gh`?


---

Comment by mkoeppe created at 2022-10-19 22:52:47

Replying to [comment:52 Kwankyu Lee]:
> We did not put `git-trac` in the above list. 

It would have been added in #34524


---

Comment by git created at 2022-10-20 04:09:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2022-10-20 04:09:42

rebased


---

Comment by dimpase created at 2022-10-20 11:06:45

lgtm


---

Comment by dimpase created at 2022-10-20 11:06:45

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2022-10-23 20:49:28

Resolution: fixed
