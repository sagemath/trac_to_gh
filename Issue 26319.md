# Issue 26319: multiplicative order for square matrices over ZZ

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2018-10-25 19:16:02

CC:  vdelecroix cpernet tscrim

references:

https://magma.maths.usyd.edu.au/magma/handbook/text/659

and https://www.jstor.org/stable/2695329


---

Comment by chapoton created at 2018-10-25 19:16:31

New commits:


---

Comment by chapoton created at 2018-10-25 19:16:31

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-10-26 01:43:19

I am not sure it makes sense to test twice if the base ring is finite. Why not do

```
if K in Fields.Finite:
    ...
elif K is ZZ:
    ...
else:
    raise NotImplementedError
```

(note that you do not have to actually construct the instance of the category to check containment).

Also, in `impossible_order`, should it be `GL_n(ZZ)`?

I might be too much an iterative programmer, but I don't see the point of having the `impossible_order` as a separate function, I don't see much benefit to not doing

```python
            # Check if o1 can be an order of a matrix in GL_n(QQ)
            # Uses Thm 2.7 [KuPa2002]
            fac = o1.factor()
            S = sum((pi - 1) * pi**(ei - 1) for pi, ei in fac)
            if S > n + int(fac[0] == (2, 1)):
                return Infinity
```



---

Comment by git created at 2018-10-26 06:51:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2018-10-26 07:05:00

curiosity: why is that valid?

```
if o1 != o2:
    return Infinity
```



---

Comment by chapoton created at 2018-10-26 07:15:27

According to the given reference (Jstor) and magma doc, the projection of every finite subgroup  of GL_n(QQ) modulo any odd prime number is injective. So if we find two different orders for a matrix modulo two different primes, the original matrix cannot have finite order.


---

Comment by git created at 2018-10-26 14:19:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2018-10-26 15:19:23

The doctests in `f829c4e` is likely to test only infinite order examples (a random matrix has infinite order). You would better add some known finite order examples (and also test conjugates).


---

Comment by chapoton created at 2018-10-26 15:20:20

Replying to [comment:7 vdelecroix]:
> The doctests in `f829c4e` is likely to test only infinite order examples (a random matrix has infinite order). You would better add some known finite order examples (and also test conjugates).

No, it does also provide a few finite order examples..


---

Comment by git created at 2018-10-26 15:37:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-10-26 15:38:35

I have added another doctest, a matrix of size 8 and order 24, conjugated at random.


---

Comment by tscrim created at 2018-10-27 02:30:12

Vincent, any other comments? Otherwise I will set a positive review.


---

Comment by vdelecroix created at 2018-10-27 08:28:43

Good for me.


---

Comment by tscrim created at 2018-10-27 13:08:50

Thank you.


---

Comment by tscrim created at 2018-10-27 13:08:50

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-10-28 20:26:16

Resolution: fixed
