# Issue 27445: upgrade normaliz to 3.7.0

archive/issues_027445.json:
```json
{
    "body": "CC:  winfried jipilab @sebasguts mkoeppe\n\nNew release of Normaliz is available.\n\nIt depends on an additional library e-antic that is packaged in this ticket.\n\nTarballs:\n\n- https://github.com/Normaliz/Normaliz/archive/v3.7.0.tar.gz (to be renamed `normaliz-3.7.0.tar.gz`)\n- http://www.labri.fr/perso/vdelecro/e-antic/e-antic-0.1.2.tar.gz\n\nIssue created by migration from https://trac.sagemath.org/ticket/27682\n\n",
    "created_at": "2019-04-16T19:55:55Z",
    "labels": [
        "packages: optional",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "upgrade normaliz to 3.7.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27445",
    "user": "vdelecroix"
}
```
CC:  winfried jipilab @sebasguts mkoeppe

New release of Normaliz is available.

It depends on an additional library e-antic that is packaged in this ticket.

Tarballs:

- https://github.com/Normaliz/Normaliz/archive/v3.7.0.tar.gz (to be renamed `normaliz-3.7.0.tar.gz`)
- http://www.labri.fr/perso/vdelecro/e-antic/e-antic-0.1.2.tar.gz

Issue created by migration from https://trac.sagemath.org/ticket/27682





---

archive/issue_comments_386919.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-16T20:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386919",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_386920.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-16T20:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386920",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_386921.json:
```json
{
    "body": "So far, both packages install without issues on debian stretch with gcc 6.3.0. Waiting for the tarball for the new version of pynormaliz.",
    "created_at": "2019-04-17T07:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386921",
    "user": "jipilab"
}
```

So far, both packages install without issues on debian stretch with gcc 6.3.0. Waiting for the tarball for the new version of pynormaliz.



---

archive/issue_comments_386922.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-17T13:17:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386922",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_386923.json:
```json
{
    "body": "After a `make distclean` and proper reinstall as the ticket description, I got everything back in order and all tests pass in the folder `polyhedron`.",
    "created_at": "2019-04-22T15:58:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386923",
    "user": "jipilab"
}
```

After a `make distclean` and proper reinstall as the ticket description, I got everything back in order and all tests pass in the folder `polyhedron`.



---

archive/issue_comments_386924.json:
```json
{
    "body": "Replying to [comment:12 jipilab]:\n> After a `make distclean` and proper reinstall as the ticket description, I got everything back in order and all tests pass in the folder `polyhedron`.\n\nThen could you try to reproduce [#22](https://github.com/Normaliz/PyNormaliz/issues/22), [#23](https://github.com/Normaliz/PyNormaliz/issues/23), [#26](https://github.com/Normaliz/PyNormaliz/issues/26), [#27](https://github.com/Normaliz/PyNormaliz/issues/27)? (and report back on the github issues)",
    "created_at": "2019-04-22T19:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386924",
    "user": "vdelecroix"
}
```

Replying to [comment:12 jipilab]:
> After a `make distclean` and proper reinstall as the ticket description, I got everything back in order and all tests pass in the folder `polyhedron`.

Then could you try to reproduce [#22](https://github.com/Normaliz/PyNormaliz/issues/22), [#23](https://github.com/Normaliz/PyNormaliz/issues/23), [#26](https://github.com/Normaliz/PyNormaliz/issues/26), [#27](https://github.com/Normaliz/PyNormaliz/issues/27)? (and report back on the github issues)



---

archive/issue_comments_386925.json:
```json
{
    "body": "Replying to [comment:13 vdelecroix]:\n> Replying to [comment:12 jipilab]:\n> > After a `make distclean` and proper reinstall as the ticket description, I got everything back in order and all tests pass in the folder `polyhedron`.\n> \n> Then could you try to reproduce [#22](https://github.com/Normaliz/PyNormaliz/issues/22), [#23](https://github.com/Normaliz/PyNormaliz/issues/23), [#26](https://github.com/Normaliz/PyNormaliz/issues/26), [#27](https://github.com/Normaliz/PyNormaliz/issues/27)? (and report back on the github issues)\n\nJust to confirm: all 4 issues are now solved in sage (some of them had different traces inside of sage...).\n\nand\n\n\n```\n$ sage -t *.py --optional=dochtml,e_antic,gfortran,memlimit,mpir,normaliz,python2,sage,pynormaliz\nUsing --optional=dochtml,e_antic,gfortran,memlimit,mpir,normaliz,pynormaliz,python2,sage\nDoctesting 25 files.\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```\n",
    "created_at": "2019-04-23T12:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386925",
    "user": "jipilab"
}
```

Replying to [comment:13 vdelecroix]:
> Replying to [comment:12 jipilab]:
> > After a `make distclean` and proper reinstall as the ticket description, I got everything back in order and all tests pass in the folder `polyhedron`.
> 
> Then could you try to reproduce [#22](https://github.com/Normaliz/PyNormaliz/issues/22), [#23](https://github.com/Normaliz/PyNormaliz/issues/23), [#26](https://github.com/Normaliz/PyNormaliz/issues/26), [#27](https://github.com/Normaliz/PyNormaliz/issues/27)? (and report back on the github issues)

Just to confirm: all 4 issues are now solved in sage (some of them had different traces inside of sage...).

and


```
$ sage -t *.py --optional=dochtml,e_antic,gfortran,memlimit,mpir,normaliz,python2,sage,pynormaliz
Using --optional=dochtml,e_antic,gfortran,memlimit,mpir,normaliz,pynormaliz,python2,sage
Doctesting 25 files.
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```




---

archive/issue_comments_386926.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-25T08:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386926",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_386927.json:
```json
{
    "body": "Please no force pushs... I'm merging this ticket in #25097...",
    "created_at": "2019-04-25T08:33:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386927",
    "user": "mkoeppe"
}
```

Please no force pushs... I'm merging this ticket in #25097...



---

archive/issue_comments_386928.json:
```json
{
    "body": "sorry... won't do anymore.",
    "created_at": "2019-04-25T08:36:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386928",
    "user": "vdelecroix"
}
```

sorry... won't do anymore.



---

archive/issue_comments_386929.json:
```json
{
    "body": "On the other hand, it does not make much sense to merge anywhere. Normaliz and e-antic needs upgrade and PyNormaliz needs to be fixed and released.",
    "created_at": "2019-04-25T08:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386929",
    "user": "vdelecroix"
}
```

On the other hand, it does not make much sense to merge anywhere. Normaliz and e-antic needs upgrade and PyNormaliz needs to be fixed and released.



---

archive/issue_comments_386930.json:
```json
{
    "body": "Yes, of course I'm waiting for these upgrades.",
    "created_at": "2019-04-25T10:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386930",
    "user": "mkoeppe"
}
```

Yes, of course I'm waiting for these upgrades.



---

archive/issue_comments_386931.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-25T15:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386931",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_386932.json:
```json
{
    "body": "Updated. Builds and tests OK on macOS Mojave\n----\nNew commits:",
    "created_at": "2019-04-25T15:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386932",
    "user": "mkoeppe"
}
```

Updated. Builds and tests OK on macOS Mojave
----
New commits:



---

archive/issue_comments_386933.json:
```json
{
    "body": "Builds and tests (`polyhedron` and `thematic_tutorial` folders) Oll Korrekt on debian stretch.",
    "created_at": "2019-04-25T15:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386933",
    "user": "jipilab"
}
```

Builds and tests (`polyhedron` and `thematic_tutorial` folders) Oll Korrekt on debian stretch.



---

archive/issue_comments_386934.json:
```json
{
    "body": "It passes all tests for me (in particular, in the folder I care about: `combinat/rigged_configurations` `;)`). I am also getting around a 5-10% speedup in my tests:\n\n```\nsage: RC = RiggedConfigurations(['E',8,1], [[4,1]])\nsage: %time len(RC.kleber_tree())\nCPU times: user 2.29 s, sys: 8.24 ms, total: 2.3 s\nWall time: 352 ms\n87\nsage: RC = RiggedConfigurations(['E',8,1], [[4,1],[2,1]])\nsage: %time len(RC.kleber_tree())\nCPU times: user 53.4 s, sys: 52.1 ms, total: 53.5 s\nWall time: 7.68 s\n2137\nsage: RC = RiggedConfigurations(['F',4,1], [[3,2],[2,2]])\nsage: %time len(RC.kleber_tree())\nCPU times: user 9.18 s, sys: 20.3 ms, total: 9.2 s\nWall time: 1.85 s\n1257\n```\n\nvs before\n\n```\nsage: RC = RiggedConfigurations(['E',8,1], [[4,1]])\nsage: %time len(RC.kleber_tree())\nCPU times: user 2.29 s, sys: 7.74 ms, total: 2.29 s\nWall time: 360 ms\n87\nsage: RC = RiggedConfigurations(['E',8,1], [[4,1],[2,1]])\nsage: %time len(RC.kleber_tree())\nCPU times: user 55.7 s, sys: 59.4 ms, total: 55.8 s\nWall time: 8.23 s\n2137\nsage: RC = RiggedConfigurations(['F',4,1], [[3,2],[2,2]])\nsage: %time len(RC.kleber_tree())\nCPU times: user 9.43 s, sys: 24 ms, total: 9.45 s\nWall time: 1.92 s\n1257\n```\n",
    "created_at": "2019-04-25T22:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386934",
    "user": "tscrim"
}
```

It passes all tests for me (in particular, in the folder I care about: `combinat/rigged_configurations` `;)`). I am also getting around a 5-10% speedup in my tests:

```
sage: RC = RiggedConfigurations(['E',8,1], [[4,1]])
sage: %time len(RC.kleber_tree())
CPU times: user 2.29 s, sys: 8.24 ms, total: 2.3 s
Wall time: 352 ms
87
sage: RC = RiggedConfigurations(['E',8,1], [[4,1],[2,1]])
sage: %time len(RC.kleber_tree())
CPU times: user 53.4 s, sys: 52.1 ms, total: 53.5 s
Wall time: 7.68 s
2137
sage: RC = RiggedConfigurations(['F',4,1], [[3,2],[2,2]])
sage: %time len(RC.kleber_tree())
CPU times: user 9.18 s, sys: 20.3 ms, total: 9.2 s
Wall time: 1.85 s
1257
```

vs before

```
sage: RC = RiggedConfigurations(['E',8,1], [[4,1]])
sage: %time len(RC.kleber_tree())
CPU times: user 2.29 s, sys: 7.74 ms, total: 2.29 s
Wall time: 360 ms
87
sage: RC = RiggedConfigurations(['E',8,1], [[4,1],[2,1]])
sage: %time len(RC.kleber_tree())
CPU times: user 55.7 s, sys: 59.4 ms, total: 55.8 s
Wall time: 8.23 s
2137
sage: RC = RiggedConfigurations(['F',4,1], [[3,2],[2,2]])
sage: %time len(RC.kleber_tree())
CPU times: user 9.43 s, sys: 24 ms, total: 9.45 s
Wall time: 1.92 s
1257
```




---

archive/issue_comments_386935.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-25T22:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386935",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_386936.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-29T12:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27445",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27445#issuecomment-386936",
    "user": "vbraun"
}
```

Resolution: fixed
