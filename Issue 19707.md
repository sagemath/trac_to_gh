# Issue 19707: asymptotic expansions: singularity analysis

Issue created by migration from https://trac.sagemath.org/ticket/19944

Original creator: behackl

Original creation time: 2016-01-23 02:05:28

CC:  dkrenn cheuberg

This ticket aims to implement singularity analysis as a callable method of asymptotic rings.


---

Comment by behackl created at 2016-01-23 02:07:52

Last 10 new commits:


---

Comment by cheuberg created at 2016-01-23 05:40:34

_Rebased_ on top of #19532 instead of #17601.
----
New commits:


---

Comment by git created at 2016-01-23 06:49:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-01-23 07:28:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-01-23 08:55:49

Changing status from new to needs_review.


---

Comment by cheuberg created at 2016-01-23 08:55:49

Once #19947 is done, input could also be as a symbolic expression plus a variable, which would probably be friendlier.


---

Comment by cheuberg created at 2016-01-25 20:26:25

Adapt to new version of #19532 and doctest OZero condition.


---

Comment by cheuberg created at 2016-01-25 20:26:25

Changing status from needs_review to needs_work.


---

Comment by behackl created at 2016-01-26 20:56:44

Replying to [comment:6 cheuberg]:
> Adapt to new version of #19532 and doctest OZero condition.

Done.
----
Last 10 new commits:


---

Comment by behackl created at 2016-01-26 20:56:44

Changing status from needs_work to needs_review.


---

Comment by dkrenn created at 2016-01-27 12:46:26

I've reviewed the patch and have the following comments:

1. `result.exact_part() == result`: Maybe create a follow up ticket implementing `is_exact`.

2. The code

```
            if isinstance(summand, ExactTerm):
                expansion = asymptotic_expansions.\
                    SingularityAnalysis('Z', alpha=alpha, zeta=singularity,
                                        precision=precision).subs(Z=self.gen())
                return summand.coefficient * expansion
            elif isinstance(summand, OTerm):
                return (self.gen() ** (alpha - 1)).O()
```

    is not ideal. It looks like the singularity analysis should be done by the terms themselves and eventually by the growth groups (since they know what they are).

3. `(self.gen() ** (alpha - 1)).O()` should depend on the singularity.

4. In some sense the transfer term `(self.gen() ** (alpha - 1)).O()` has the same status as the expansion `asymptotic_expansions.SingularityAnalysis`. So a generation in the generations would be an option. However, I understand, that it is much simpler, so I do *not* have a strong preference for this.

5. Parameter description `function`: mentioned the word "callable"(?) Say that it is a function in one variable.

6. Parameter `return_singular_expansions`: in an ideal world, there would not be a different kind of output (asymptotic expansions vs. named tuple). However, I understand it is as it is; it seems that there is no other satisfying solution to this. Am I right?
----
New commits:


---

Comment by dkrenn created at 2016-01-27 12:46:26

Changing status from needs_review to needs_work.


---

Comment by cheuberg created at 2016-01-27 15:19:21

A few thoughts on your comments:

* `asymptotic_expansions.SingularityAnalysis` with `precision=0` could very well return the transfer error term; I think that this would be consistent with `precision=0`. And `precision=0` does not work anyway at the moment.
* Then, indeed, an ExactTerm could do singularity analysis by calling singularity analysis on the growth element and multiply by its coefficient; and an OTerm could do singularity analysis by calling singularity analysis on the growth element with `precision=0`.
* A monomial growth group would do singularity analysis by checking whether it is a growth group in `T` (then call the generator with `alpha=...` and `beta=0`) or a growth group in `log(T)` (call a yet to be written generator for `(1-z)^alpha (log(1-u))^beta`)
* A cartesian growth group would restrict its attention to cases where all non-trivial contributions come from one factor (hand the question down to the factor) or from two factors (in that case, the cartesian growth group has to do the job on its own calling the above mentioned generator).


---

Comment by cheuberg created at 2016-02-08 18:02:07

I started rewriting this branch by introducing a method `_singularity_analysis_` for growth groups.
----
Last 10 new commits:


---

Comment by git created at 2016-02-09 17:57:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-02-09 18:04:16

The method is now completely rewritten; `7.1.beta1` has been merged implicitly by merging #19981.

Replying to [comment:9 dkrenn]:
> 1. `result.exact_part() == result`: Maybe create a follow up ticket implementing `is_exact`.

done (#19981)


> 2. The code ...
>     is not ideal. It looks like the singularity analysis should be done by the terms themselves and eventually by the growth groups (since they know what they are).

Done.

> 3. `(self.gen() ** (alpha - 1)).O()` should depend on the singularity.

Implicitly done by 2.

> 4. In some sense the transfer term `(self.gen() ** (alpha - 1)).O()` has the same status as the expansion `asymptotic_expansions.SingularityAnalysis`. So a generation in the generations would be an option. However, I understand, that it is much simpler, so I do *not* have a strong preference for this.

Done (via `precision=0`).

> 5. Parameter description `function`: mentioned the word "callable"(?) Say that it is a function in one variable.

Done.

> 6. Parameter `return_singular_expansions`: in an ideal world, there would not be a different kind of output (asymptotic expansions vs. named tuple). However, I understand it is as it is; it seems that there is no other satisfying solution to this. Am I right?

No better solution found.


---

Comment by cheuberg created at 2016-02-09 18:04:16

Changing status from needs_work to needs_review.


---

Comment by cheuberg created at 2016-02-12 18:05:24

cross-reviewed your changes.
----
Last 10 new commits:


---

Comment by git created at 2016-02-13 19:48:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2016-02-14 11:09:28

Thanks you for your rewrite; it is much better and cleaner now; I consider the code as positively reviewed. However, please cross-review my minor changes and the following two documentation issues should be discussed (both concerning the private `_singularity_analysis_`-mathods:

1. Is `(1-z\zeta) \to 0` correct or should it be `(1-z/\zeta) \to 0`? Maybe using `z\to\zeta` instead of `(1-z/\zeta) \to 0`? (I don't have a strong preference for changing, but from an outside view, this would be easier to understand.

2. Should it be mentioned that (in terms and growth groups) a variable (`_var_` of the parent) represents/equals `1 / (1-z/\zeta)` ?


---

Comment by dkrenn created at 2016-02-14 11:55:16

There is an inconsistency in the order of the parameters: in the generators we have `var, zeta=1, ...`, but in all the `_singularity_analysis_` we have `zeta, var`.


---

Comment by dkrenn created at 2016-02-14 11:57:50

...and maybe (but really, maybe): name argument precision in the doctests to make them better readable; e.g. `_singularity_analysis_('n', 1/2, precision=5)'.


---

Comment by cheuberg created at 2016-02-14 12:27:09

Replying to [comment:18 dkrenn]:
> please cross-review my minor changes

done.

> 1. Is `(1-z\zeta) \to 0` correct or should it be `(1-z/\zeta) \to 0`? Maybe using `z\to\zeta` instead of `(1-z/\zeta) \to 0`? (I don't have a strong preference for changing, but from an outside view, this would be easier to understand.

I prefer `(1-z/\zeta) \to 0` or perhaps `T = 1/(1-z/\zeta) \to \infty`.

> 2. Should it be mentioned that (in terms and growth groups) a variable (`_var_` of the parent) represents/equals `1 / (1-z/\zeta)` ? 

This should change once asymptotics `z->z_0` are implemented.

What about  "`T = 1/(1-z/\zeta) \to \infty` where this element is a growth element (resp. monomial) in `T`"?


---

Comment by cheuberg created at 2016-02-14 12:35:48

Replying to [comment:19 dkrenn]:
> There is an inconsistency in the order of the parameters: in the generators we have `var, zeta=1, ...`, but in all the `_singularity_analysis_` we have `zeta, var`.

OK, I'll change the `_singularity_analysis_` routines.

Once we have #20050, the parameter `zeta` will be removed.


---

Comment by cheuberg created at 2016-02-14 12:36:28

Replying to [comment:20 dkrenn]:
> ...and maybe (but really, maybe): name argument precision in the doctests to make them better readable; e.g. `_singularity_analysis_('n', 1/2, precision=5)'.

I will do that.


---

Comment by cheuberg created at 2016-02-14 12:47:41

Replying to [comment:22 cheuberg]:
> Replying to [comment:19 dkrenn]:
> > There is an inconsistency in the order of the parameters: in the generators we have `var, zeta=1, ...`, but in all the `_singularity_analysis_` we have `zeta, var`.
> 
> OK, I'll change the `_singularity_analysis_` routines.
Done.
----
New commits:


---

Comment by cheuberg created at 2016-02-14 12:47:59

Replying to [comment:23 cheuberg]:
> Replying to [comment:20 dkrenn]:
> > ...and maybe (but really, maybe): name argument precision in the doctests to make them better readable; e.g. `_singularity_analysis_('n', 1/2, precision=5)'.
> 
> I will do that.
done.


---

Comment by cheuberg created at 2016-02-14 13:00:53

Changing status from needs_review to needs_work.


---

Comment by cheuberg created at 2016-02-14 13:00:53

Replying to [comment:25 cheuberg]:
> Done.
> ----
> New commits:
> ||[9ce7b35](http://git.sagemath.org/sage.git/commit/?id=9ce7b354e32efbbb775157bf7c8232fd5df01cb5)||`Trac #19944: exchange order of parameters var and zeta in _singularity_analysis_`||

I forgot to change the docstrings. I will do so now.


---

Comment by git created at 2016-02-14 13:04:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-02-14 13:06:40

Replying to [comment:28 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[c79a6f7](http://git.sagemath.org/sage.git/commit/?id=c79a6f7bbb3f17454a1c6238193696e525a8c0ec)||`Trac #19944: exchange zeta and var in docstrings`||
Done.


---

Comment by cheuberg created at 2016-02-14 13:06:40

Changing status from needs_work to needs_review.


---

Comment by dkrenn created at 2016-02-14 13:23:06

Replying to [comment:21 cheuberg]:
> Replying to [comment:18 dkrenn]:
> > 1. Is `(1-z\zeta) \to 0` correct or should it be `(1-z/\zeta) \to 0`? Maybe using `z\to\zeta` instead of `(1-z/\zeta) \to 0`? (I don't have a strong preference for changing, but from an outside view, this would be easier to understand.
> 
> I prefer `(1-z/\zeta) \to 0` or perhaps `T = 1/(1-z/\zeta) \to \infty`.
> 
> > 2. Should it be mentioned that (in terms and growth groups) a variable (`_var_` of the parent) represents/equals `1 / (1-z/\zeta)` ? 
> 
> This should change once asymptotics `z->z_0` are implemented.
> 
> What about  "`T = 1/(1-z/\zeta) \to \infty` where this element is a growth element (resp. monomial) in `T`"?

I'm happy with this formulation.

All the other changes are positivly reviewed form my side.


---

Comment by git created at 2016-02-14 14:11:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-02-14 14:12:06

Replying to [comment:30 dkrenn]:
> > What about  "`T = 1/(1-z/\zeta) \to \infty` where this element is a growth element (resp. monomial) in `T`"?
> 
> I'm happy with this formulation.

done. needs review.


---

Comment by dkrenn created at 2016-02-14 15:17:41

Changing status from needs_review to positive_review.


---

Comment by dkrenn created at 2016-02-14 15:17:41

Replying to [comment:32 cheuberg]:
> Replying to [comment:30 dkrenn]:
> > > What about  "`T = 1/(1-z/\zeta) \to \infty` where this element is a growth element (resp. monomial) in `T`"?
> > 
> > I'm happy with this formulation.
> 
> done. needs review.

Fine.


---

Comment by vbraun created at 2016-02-16 17:05:56

Resolution: fixed
