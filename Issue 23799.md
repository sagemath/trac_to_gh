# Issue 23799: Orthogonal groups for IntegralLattices

Issue created by migration from Trac.

Original creator: sbrandhorst

Original creation time: 2017-10-13 15:16:29

Implement a class for the orthogonal group of integral lattices.
Its elements are isometries of the ambient spaces which preserve the lattice. 

As functionality:
- Its elements have an action on elements of the ambient space and the lattice
- action on the dual lattice
- It is be a matrix group
- Compute generators in case the lattice is positive definite. One can use `QuadraticForm.automorphisms()` for that.
- It should also work for indefinite lattices. Just have some not implemented errors - like the generators.


---

Comment by sbrandhorst created at 2017-10-13 15:16:46

Changing component from PLEASE CHANGE to linear algebra.


---

Comment by sbrandhorst created at 2017-10-13 15:16:46

Changing type from PLEASE CHANGE to enhancement.


---

Comment by git created at 2017-11-08 08:00:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-11-10 14:07:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2017-11-10 14:09:14

We still need to make sure that the actions are working.
In particular on the discriminantGroup.


---

Comment by git created at 2017-11-25 10:07:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-11-25 16:55:34

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2017-12-08 10:21:25

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2017-12-08 16:55:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2017-12-08 16:57:55

Changing status from new to needs_review.


---

Comment by git created at 2017-12-09 14:57:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-12-14 07:44:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-01-19 16:37:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-01-19 16:38:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-01-19 16:54:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2018-01-19 16:55:45

The documentation builds and seems to look O.K. 
Tests pass too. Still waiting for patchbot. 

One might want to consider moving the code to a different file to improve documentation?


---

Comment by git created at 2018-01-23 14:03:28

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-01-24 08:23:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-01-28 08:49:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-09 14:15:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-02-10 12:27:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2018-02-26 12:47:10

Changing status from needs_review to needs_work.


---

Comment by roed created at 2018-02-26 12:47:10

Some comment:

* The line `submodule -- an invariant submodule` in `GroupActionOnQuotientModule` needs to be changed from submodule to quotient.
* The actions allow `is_left=True` but then ignore it in the implementation of `_call_`.
* There is no check that the invariant submodule and quotient module passed into the `__init__` method of `GroupOfIsometries` are actually invariant.
* In `/src/sage/groups/matrix_gps/orthogonal.py`, you say that you add `OrthogonalMatrixGroup_with_gap` but don't, and you import `FinitelyGeneratedMatrixGroup_gap` and `Action` but don't use them.
* It's better to use `gens is None` rather than `gens == None`
* The `is_finite` keyword on the `orthogonal_group` method should be documented better (or removed).
* Should `orthogonal_group` be a cached method?


---

Comment by git created at 2018-02-26 13:46:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2018-02-26 13:49:33

You wrote:
Should orthogonal_group be a cached method? 

I would like that. But sometimes the input (=a list of generators) may be non-hashable and then
`@`cashed method throws an error. Is there an easy way around?


---

Comment by sbrandhorst created at 2018-02-26 13:51:05

Changing status from needs_work to needs_review.


---

Comment by git created at 2018-02-26 14:32:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by sbrandhorst created at 2018-02-26 14:34:25

Doc builds now.


---

Comment by roed created at 2018-02-27 14:05:49

Replying to [comment:26 sbrandhorst]:
> You wrote:
> Should orthogonal_group be a cached method? 
> 
> I would like that. But sometimes the input (=a list of generators) may be non-hashable and then
> ``@`cached_method` throws an error. Is there an easy way around?

Yeah, ``@`cached_method` supports a key to normalize the input, which you can use to make it hashable.  From the docstring for `cached_method`,

```
    The parameter ``key`` can be used to pass a function which creates a
    custom cache key for inputs. In the following example, this parameter is
    used to ignore the ``algorithm`` keyword for caching::

        sage: class A(object):
        ....:     def _f_normalize(self, x, algorithm): return x
        ....:     `@`cached_method(key=_f_normalize)
        ....:     def f(self, x, algorithm='default'): return x
        sage: a = A()
        sage: a.f(1, algorithm="default") is a.f(1) is a.f(1, algorithm="algorithm")
        True
```



---

Comment by roed created at 2018-02-27 14:09:09

Changing status from needs_review to positive_review.


---

Comment by roed created at 2018-02-27 14:09:09

But you can leave that for another ticket.  This looks good to me.


---

Comment by vbraun created at 2018-03-04 23:29:07

Resolution: fixed
