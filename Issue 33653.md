# Issue 33653: dot2tex errors : No such file or directory: '/tmp/dot2texXXXXXX/dot2tex.log'

archive/issues_033653.json:
```json
{
    "body": "CC:  @jhpalmieri\n\nI have the following issue with dot2tex on Sage 9.6, on Debian GNU/Linux, many doctests involving `dot2tex` fail, here is a typical example:\n\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 9.6, Release Date: 2022-05-15                     \u2502\n\u2502 Using Python 3.10.3. Type \"help()\" for help.                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nsage: P = Poset(([1,2], [[1,2]]), cover_relations = True)\nsage: print(P._latex_())\n---------------------------------------------------------------------------\nFileNotFoundError                         Traceback (most recent call last)\n<ipython-input-2-29f954c10b99> in <module>\n----> 1 print(P._latex_())\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/combinat/posets/posets.py in _latex_(self)\n   1375             \\end{tikzpicture}\n   1376         \"\"\"\n-> 1377         return self.hasse_diagram()._latex_()\n   1378 \n   1379     def _repr_(self):\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/graphs/generic_graph.py in _latex_(self)\n    869         setup_latex_preamble()\n    870 \n--> 871         return self.latex_options().latex()\n    872 \n    873     def _matrix_(self, R=None, vertices=None):\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/graphs/graph_latex.py in latex(self)\n   1347             return self.tkz_picture()\n   1348         elif format == \"dot2tex\":\n-> 1349             return self.dot2tex_picture()\n   1350 \n   1351     def dot2tex_picture(self):\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/graphs/graph_latex.py in dot2tex_picture(self)\n   1427         dotdata = self._graph.graphviz_string(labels=\"latex\", **options)\n   1428         import dot2tex\n-> 1429         return dot2tex.dot2tex(dotdata,\n   1430                                format='tikz',\n   1431                                autosize=True,\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/__init__.py in dot2tex(dotsource, **kwargs)\n     60 \n     61     \"\"\"\n---> 62     return d2t.convert_graph(dotsource, **kwargs)\n     63 \n     64 \n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in convert_graph(dotsource, **kwargs)\n   3123 \n   3124     options.__dict__.update(kwargs)\n-> 3125     tex = main(True, dotsource, options)\n   3126     return tex\n   3127 \n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in main(run_as_module, dotdata, options)\n   3073         sys.exit(1)\n   3074     try:\n-> 3075         s = conv.convert(dotdata)\n   3076         log.debug('Output:\\n%s', s)\n   3077         if options.autosize:\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in convert(self, dotdata)\n    798 \n    799         if self.dopreproc:\n--> 800             return self.do_preview_preproc()\n    801 \n    802         # Remove annoying square\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in do_preview_preproc(self)\n   1051             usedgraphs[name] = graph\n   1052 \n-> 1053         ok = pp.process()\n   1054 \n   1055         if not ok:\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in process(self)\n   2643             s = f.read()\n   2644         log.debug('Code written to %s\\n' % self.tempfilename + s)\n-> 2645         self.parse_log_file()\n   2646         shutil.rmtree(self.tempdir)\n   2647         log.debug('Temporary directory and files deleted')\n\n/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in parse_log_file(self)\n   2679         p.wait()\n   2680 \n-> 2681         with open(logfilename, 'r') as f:\n   2682             logdata = f.read()\n   2683         log.debug('Logfile from LaTeX run: \\n' + logdata)\n\nFileNotFoundError: [Errno 2] No such file or directory: '/tmp/dot2texffi4ywvd/dot2tex.log'\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/33890\n\n",
    "created_at": "2022-05-24T09:30:50Z",
    "labels": [
        "component: packages: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "dot2tex errors : No such file or directory: '/tmp/dot2texXXXXXX/dot2tex.log'",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33653",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```
CC:  @jhpalmieri

I have the following issue with dot2tex on Sage 9.6, on Debian GNU/Linux, many doctests involving `dot2tex` fail, here is a typical example:


```
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 9.6, Release Date: 2022-05-15                     │
│ Using Python 3.10.3. Type "help()" for help.                       │
└────────────────────────────────────────────────────────────────────┘
sage: P = Poset(([1,2], [[1,2]]), cover_relations = True)
sage: print(P._latex_())
---------------------------------------------------------------------------
FileNotFoundError                         Traceback (most recent call last)
<ipython-input-2-29f954c10b99> in <module>
----> 1 print(P._latex_())

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/combinat/posets/posets.py in _latex_(self)
   1375             \end{tikzpicture}
   1376         """
-> 1377         return self.hasse_diagram()._latex_()
   1378 
   1379     def _repr_(self):

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/graphs/generic_graph.py in _latex_(self)
    869         setup_latex_preamble()
    870 
--> 871         return self.latex_options().latex()
    872 
    873     def _matrix_(self, R=None, vertices=None):

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/graphs/graph_latex.py in latex(self)
   1347             return self.tkz_picture()
   1348         elif format == "dot2tex":
-> 1349             return self.dot2tex_picture()
   1350 
   1351     def dot2tex_picture(self):

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/sage/graphs/graph_latex.py in dot2tex_picture(self)
   1427         dotdata = self._graph.graphviz_string(labels="latex", **options)
   1428         import dot2tex
-> 1429         return dot2tex.dot2tex(dotdata,
   1430                                format='tikz',
   1431                                autosize=True,

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/__init__.py in dot2tex(dotsource, **kwargs)
     60 
     61     """
---> 62     return d2t.convert_graph(dotsource, **kwargs)
     63 
     64 

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in convert_graph(dotsource, **kwargs)
   3123 
   3124     options.__dict__.update(kwargs)
-> 3125     tex = main(True, dotsource, options)
   3126     return tex
   3127 

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in main(run_as_module, dotdata, options)
   3073         sys.exit(1)
   3074     try:
-> 3075         s = conv.convert(dotdata)
   3076         log.debug('Output:\n%s', s)
   3077         if options.autosize:

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in convert(self, dotdata)
    798 
    799         if self.dopreproc:
--> 800             return self.do_preview_preproc()
    801 
    802         # Remove annoying square

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in do_preview_preproc(self)
   1051             usedgraphs[name] = graph
   1052 
-> 1053         ok = pp.process()
   1054 
   1055         if not ok:

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in process(self)
   2643             s = f.read()
   2644         log.debug('Code written to %s\n' % self.tempfilename + s)
-> 2645         self.parse_log_file()
   2646         shutil.rmtree(self.tempdir)
   2647         log.debug('Temporary directory and files deleted')

/opt/sagemath/sage-9.6/local/var/lib/sage/venv-python3.10.3/lib/python3.10/site-packages/dot2tex/dot2tex.py in parse_log_file(self)
   2679         p.wait()
   2680 
-> 2681         with open(logfilename, 'r') as f:
   2682             logdata = f.read()
   2683         log.debug('Logfile from LaTeX run: \n' + logdata)

FileNotFoundError: [Errno 2] No such file or directory: '/tmp/dot2texffi4ywvd/dot2tex.log'
```


Issue created by migration from https://trac.sagemath.org/ticket/33890





---

archive/issue_comments_478461.json:
```json
{
    "body": "I can't reproduce this on OS X or on an Ubuntu virtual machine. I'll try a little bit more.",
    "created_at": "2022-08-05T22:17:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33653",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33653#issuecomment-478461",
    "user": "https://github.com/jhpalmieri"
}
```

I can't reproduce this on OS X or on an Ubuntu virtual machine. I'll try a little bit more.
