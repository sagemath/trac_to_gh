# Issue 14815: plot_field crashes if if self.options() is called for an object with an unknown option

Issue created by migration from https://trac.sagemath.org/ticket/15052

Original creator: twch

Original creation time: 2013-08-16 22:05:06

Consider the following example:


```
sage: x,y=var('x,y')
sage: P=plot_vector_field((sin(x), cos(y)), (x,-3,3), (y,-3,3), wrong_option='nonsense')
sage: P[0].options()['plot_points']
```


One would expect that this returns the value of plot_points together with a warning that a unknown option is set. Instead it enters an infinite loop and crashes


---

Comment by twch created at 2013-08-16 22:06:25

I'll provide a patch which hopefully fixes this within the next days...


---

Comment by ppurka created at 2013-08-17 03:14:29

When you fix this, please put a comment near your fix that in general the ticket #15002 should be fixed.


---

Comment by twch created at 2013-08-22 07:11:18

Changing status from new to needs_review.


---

Comment by ppurka created at 2013-10-12 07:49:09

Hello, the patch looks ok to me except for the formatting of the trac ticket.

1. Trac reference like `trac #15052` should be [formatted as](http://www.sagemath.org/doc/developer/sage_manuals.html#chapter-sage-manuals-links) `:trac:`15052``.

2. The doctest should not contain the actual line numbers because they will change on every edit of the file. So, statements like `verbose 0 (152: primitive.py` should be written as `verbose 0 (...: primitive.py`.


---

Attachment


---

Comment by ncohen created at 2014-01-14 15:28:06

ping ?


---

Comment by twch created at 2014-01-14 15:47:04

I tried to improve the two points of metioned by ppurka in the last patch and was waiting for a review.

Is it still possible to merge these patches now that we moved to git?


---

Comment by ncohen created at 2014-01-14 15:49:20

Hello !

> I tried to improve the two points of metioned by ppurka in the last patch and was waiting for a review.

Indeed, but just uploading a patch does not trigger emails, and Basu (ppurka) may not have noticed.

> Is it still possible to merge these patches now that we moved to git?

Yep, no problem ! You can even convert it to a git branch if you have not tried it already : 

`./sage -dev import-patch --url <patch_url>` 

does exactly that.

Nathann


---

Comment by twch created at 2014-01-14 15:53:24

Replying to [comment:8 ncohen]:
> Hello !
> 
> > I tried to improve the two points of metioned by ppurka in the last patch and was waiting for a review.
> 
> Indeed, but just uploading a patch does not trigger emails, and Basu (ppurka) may not have noticed.
Ahh sorry I wasn't aware of this and expected Basu to be busy with other things.
Sorry for that!


---

Comment by ppurka created at 2014-01-14 20:53:25

Indeed. This is good to go. I never realized that the patch was corrected and uploaded here. As Nathann said, just uploading a patch doesn't trigger emails. :)


---

Comment by ppurka created at 2014-01-14 21:32:19

The following are the steps I followed in order to create the git sage and set up trac.

1. First install the sage git
2. Then ask sage to create a trac account, etc. This can be found in the [quick start git](http://trac.sagemath.org/wiki/QuickStartSageGit) guide -- the PDF for the Sage Days 53.
3. In that pdf, follow the guidelines in page 20 to set up your git username and email. This will be autofilled in the patch username/email fields. You can also follow [this guide](http://sagemath.github.io/git-developer-guide/git_setup.html).
4. Create a ssh key and upload it using the sage dev scripts. You can follow [this guide](http://sagemath.github.io/git-developer-guide/trac.html). If you have a different ssh key for trac, say `trac` and `trac.pub` (like I do), then you need to use the following command `./sage --dev upload-ssh-key --public-key ~/.ssh/trac.pub` and then you can add the following to your `~/.ssh/config`:

```
Host trac.sagemath.org
    HostName             trac.sagemath.org
    User                 twch
    IdentityFile         ~/.ssh/trac
    PreferredAuthentications publickey
```



Now you are all set to interact with trac. So, here are the commands I used to create the branch.

```
$ ./sage --dev checkout --ticket 15052 # Creates a branch called ticket/15052 and makes it current
$ git rebase origin/develop # This makes the current branch based off develop (sage-6.1.beta4)
$ ./sage --dev import-patch --url http://trac.sagemath.org/raw-attachment/ticket/15052/trac_15052_fixes_infinite_loop.patch
$ git diff origin/develop ticket/15052 # check the patch. There is also a ./sage --dev diff
$ ./sage --dev push # Upload the patch
```


Nathann, thanks for the `ping ?`!
----
New commits:


---

Comment by ppurka created at 2014-01-14 21:32:19

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2014-01-15 09:25:30

> Nathann, thanks for the `ping ?`!

http://goo.gl/2vkrfQ

Nathann


---

Comment by vbraun created at 2014-02-08 17:04:08

Resolution: fixed
