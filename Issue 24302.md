# Issue 24302: fraction_field: missing format in exception

archive/issues_024302.json:
```json
{
    "body": "CC:  mmezzarobba\n\n\n```\nsage: var('tau')\nsage: R = PolynomialRing(CyclotomicField(2), 'tau').fraction_field()(\n....:     tau/(1+tau))\nTraceback (most recent call last):\n...\nTypeError: ('cannot convert {!r}/{!r} to an element of {}', tau/(tau + 1), 1, Fraction Field of Univariate Polynomial Ring in tau over Cyclotomic Field of order 2 and degree 1)\n```\n\n\nThere is a `.format` missing in the error message.\n\n(and in fact, I'd prefer that a conversion exists, but only one step at a time ...).\n\nIssue created by migration from https://trac.sagemath.org/ticket/24539\n\n",
    "created_at": "2018-01-14T11:11:36Z",
    "labels": [
        "algebra",
        "trivial",
        "bug"
    ],
    "title": "fraction_field: missing format in exception",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/24302",
    "user": "cheuberg"
}
```
CC:  mmezzarobba


```
sage: var('tau')
sage: R = PolynomialRing(CyclotomicField(2), 'tau').fraction_field()(
....:     tau/(1+tau))
Traceback (most recent call last):
...
TypeError: ('cannot convert {!r}/{!r} to an element of {}', tau/(tau + 1), 1, Fraction Field of Univariate Polynomial Ring in tau over Cyclotomic Field of order 2 and degree 1)
```


There is a `.format` missing in the error message.

(and in fact, I'd prefer that a conversion exists, but only one step at a time ...).

Issue created by migration from https://trac.sagemath.org/ticket/24539





---

archive/issue_comments_340250.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-01-14T11:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340250",
    "user": "cheuberg"
}
```

New commits:



---

archive/issue_comments_340251.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-01-14T11:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340251",
    "user": "cheuberg"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_340252.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-01-14T14:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340252",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_340253.json:
```json
{
    "body": "The test that you added would be more clear if you didn't use the name `\"tau\"` twice. When I first saw the test, I couldn't figure it why it was raising an exception in the first place.",
    "created_at": "2018-01-14T14:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340253",
    "user": "jdemeyer"
}
```

The test that you added would be more clear if you didn't use the name `"tau"` twice. When I first saw the test, I couldn't figure it why it was raising an exception in the first place.



---

archive/issue_comments_340254.json:
```json
{
    "body": "If I do not use `tau` twice, then another error arises:c\n\n```\nsage: var('tau')\nsage: R = PolynomialRing(CyclotomicField(2), 'z').fraction_field()(\n....:    tau/(1+tau))\nTraceback (most recent call last):\n...\nNotImplementedError: symbol\n```\n\n\nNote that it is also essential for triggering the incorrect error message to take `CyclotomicField(2)` and not `QQ`:\n\n```\nsage: var('tau')\nsage: PolynomialRing(QQ, 'tau').fraction_field()(\n....:    tau/(1+tau))\ntau/(tau + 1)\n```\n\n\nSo IMHO there some problem in the conversion somewhere which I do not have time to investigate right away. So I decided to at least fix the formating issue and hope that somebody else who knows this code better than me will take care of the rest.",
    "created_at": "2018-01-14T16:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340254",
    "user": "cheuberg"
}
```

If I do not use `tau` twice, then another error arises:c

```
sage: var('tau')
sage: R = PolynomialRing(CyclotomicField(2), 'z').fraction_field()(
....:    tau/(1+tau))
Traceback (most recent call last):
...
NotImplementedError: symbol
```


Note that it is also essential for triggering the incorrect error message to take `CyclotomicField(2)` and not `QQ`:

```
sage: var('tau')
sage: PolynomialRing(QQ, 'tau').fraction_field()(
....:    tau/(1+tau))
tau/(tau + 1)
```


So IMHO there some problem in the conversion somewhere which I do not have time to investigate right away. So I decided to at least fix the formating issue and hope that somebody else who knows this code better than me will take care of the rest.



---

archive/issue_comments_340255.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-01-14T16:42:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340255",
    "user": "cheuberg"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_340256.json:
```json
{
    "body": "OK, but in that case at least add some explanation in the doctest. You could maybe also add the doctest with the non-matching variable name.",
    "created_at": "2018-01-14T20:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340256",
    "user": "jdemeyer"
}
```

OK, but in that case at least add some explanation in the doctest. You could maybe also add the doctest with the non-matching variable name.



---

archive/issue_comments_340257.json:
```json
{
    "body": "you could use instead\n\n```\nsage: tau=polygen(QQ,'tau')\nsage: R = PolynomialRing(CyclotomicField(2), 'z').fraction_field()(\n....:     tau/(1+tau))\n```\n",
    "created_at": "2018-01-15T09:53:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340257",
    "user": "chapoton"
}
```

you could use instead

```
sage: tau=polygen(QQ,'tau')
sage: R = PolynomialRing(CyclotomicField(2), 'z').fraction_field()(
....:     tau/(1+tau))
```




---

archive/issue_comments_340258.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-01-17T19:56:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340258",
    "user": "chapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_340259.json:
```json
{
    "body": "given the trivial nature of the ticket, I allow myself to set to positive after my ownn small changes\n----\nNew commits:",
    "created_at": "2018-01-17T19:56:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340259",
    "user": "chapoton"
}
```

given the trivial nature of the ticket, I allow myself to set to positive after my ownn small changes
----
New commits:



---

archive/issue_comments_340260.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-01-20T10:42:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/24302",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/24302#issuecomment-340260",
    "user": "vbraun"
}
```

Resolution: fixed
