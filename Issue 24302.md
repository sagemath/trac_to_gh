# Issue 24302: fraction_field: missing format in exception

Issue created by migration from Trac.

Original creator: cheuberg

Original creation time: 2018-01-14 11:11:36

CC:  mmezzarobba


```
sage: var('tau')
sage: R = PolynomialRing(CyclotomicField(2), 'tau').fraction_field()(
....:     tau/(1+tau))
Traceback (most recent call last):
...
TypeError: ('cannot convert {!r}/{!r} to an element of {}', tau/(tau + 1), 1, Fraction Field of Univariate Polynomial Ring in tau over Cyclotomic Field of order 2 and degree 1)
```


There is a `.format` missing in the error message.

(and in fact, I'd prefer that a conversion exists, but only one step at a time ...).


---

Comment by cheuberg created at 2018-01-14 11:20:11

New commits:


---

Comment by cheuberg created at 2018-01-14 11:20:11

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2018-01-14 14:45:09

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2018-01-14 14:45:09

The test that you added would be more clear if you didn't use the name `"tau"` twice. When I first saw the test, I couldn't figure it why it was raising an exception in the first place.


---

Comment by cheuberg created at 2018-01-14 16:42:18

If I do not use `tau` twice, then another error arises:c

```
sage: var('tau')
sage: R = PolynomialRing(CyclotomicField(2), 'z').fraction_field()(
....:    tau/(1+tau))
Traceback (most recent call last):
...
NotImplementedError: symbol
```


Note that it is also essential for triggering the incorrect error message to take `CyclotomicField(2)` and not `QQ`:

```
sage: var('tau')
sage: PolynomialRing(QQ, 'tau').fraction_field()(
....:    tau/(1+tau))
tau/(tau + 1)
```


So IMHO there some problem in the conversion somewhere which I do not have time to investigate right away. So I decided to at least fix the formating issue and hope that somebody else who knows this code better than me will take care of the rest.


---

Comment by cheuberg created at 2018-01-14 16:42:18

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2018-01-14 20:40:25

OK, but in that case at least add some explanation in the doctest. You could maybe also add the doctest with the non-matching variable name.


---

Comment by chapoton created at 2018-01-15 09:53:15

you could use instead

```
sage: tau=polygen(QQ,'tau')
sage: R = PolynomialRing(CyclotomicField(2), 'z').fraction_field()(
....:     tau/(1+tau))
```



---

Comment by chapoton created at 2018-01-17 19:56:09

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-01-17 19:56:09

given the trivial nature of the ticket, I allow myself to set to positive after my ownn small changes
----
New commits:


---

Comment by vbraun created at 2018-01-20 10:42:36

Resolution: fixed
