# Issue 18823: Fix gauss_sum() for Dirichlet characters over cyclotomic fields

Issue created by migration from https://trac.sagemath.org/ticket/19060

Original creator: pbruin

Original creation time: 2015-08-20 11:25:42

Keywords: Dirichlet character Gauss sum

In SageMath 6.9.beta2:

```
sage: K.<z> = CyclotomicField(8)
sage: G = DirichletGroup(13, K)
sage: chi = G([z^2])
sage: chi.gauss_sum()
Traceback (most recent call last):
...
TypeError: Cannot coerce zeta52 into Cyclotomic Field of order 8 and degree 4
```

This arises because `chi` is actually defined over a smaller cyclotomic field.  It can be fixed by letting `gauss_sum()` minimize the base ring.


---

Comment by pbruin created at 2015-08-20 11:39:53

Changing status from new to needs_review.


---

Comment by git created at 2015-08-20 13:22:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-08-21 14:23:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2015-08-21 14:24:30

Added #19056 as a dependency because it has positive review and there is a merge conflict.


---

Comment by chapoton created at 2015-08-22 18:36:06

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2015-08-22 18:36:06

two failing doctest, problem of complex conjugate


---

Comment by git created at 2015-08-22 18:48:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2015-08-22 18:52:37

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2015-08-22 18:57:02

Hmm. Precision seems too high to me.. Maybe 1e-15 would be better ?

and maybe replace the very small imaginary part in the doctest by 0.0*I ?


---

Comment by git created at 2015-08-22 19:37:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2015-08-22 19:39:33

Replying to [comment:8 chapoton]:
> Hmm. Precision seems too high to me.. Maybe 1e-15 would be better ?
You are right, done.
> and maybe replace the very small imaginary part in the doctest by 0.0*I ?
I prefer to have the doctest output reflect the actual output (on some system) as closely as possible, and I have never seen `0.0*I` in these tests (of course it would be the ideal answer).


---

Comment by chapoton created at 2015-09-01 07:47:43

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2015-09-01 07:47:43

one failing doctest, need to relax the tolerance a little bit, see patchbot report


---

Comment by git created at 2015-09-01 08:28:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2015-09-01 08:28:31

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2015-09-13 16:14:11

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2015-09-13 16:14:11

ok, looks good to me


---

Comment by vbraun created at 2015-09-13 22:13:16

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2015-09-13 22:13:16

Reviewer name missing


---

Comment by chapoton created at 2015-09-14 07:28:37

sorry for that.


---

Comment by chapoton created at 2015-09-14 07:28:37

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2015-09-15 07:52:21

Resolution: fixed
