# Issue 19889: QEPCAD does not pass optional "memcells" to the constructor

Issue created by migration from Trac.

Original creator: yzh

Original creation time: 2016-02-26 18:27:26

CC:  mkoeppe rws tmonteil dimpase

Keywords: QEPCAD

In the following problem of simplifying quantifier free formulas, QEPCAD crashed with the failure "Too few cells reclaimed."

```
sage: var('x,y,z')
(x, y, z)
sage: conds = [-z < 0, -y + z < 0, x^2 + x*y + 2*x*z + 2*y*z - x < 0, \
               x^2 + x*y + 3*x*z + 2*y*z + 2*z^2 - x - z < 0, \
               -2*x + 1 < 0, -x*y - x*z - 2*y*z - 2*z^2 + z < 0, \
               x + 3*y + 3*z - 1 < 0]
sage: qepcad(conds)
Qepcad crashed -- automatically restarting.
sage: qe = qepcad(conds, interact=True)
sage: qe.go()
QEPCAD object has moved to phase 'Before Projection (z)'
sage: qe.go()
QEPCAD object has moved to phase 'Before Choice'
sage: qe.go()
** 90355 cells, 19999 arrays in 17 milliseconds.
Failure occurred in:    GCSI (final check)
Reason for the failure: Too few cells reclaimed.
N   = 90355
NU  = 1000000
RHO = 10
Now the FAIL handler is aborting the program ...
```


This could be solved by augmenting `memcells` to 200000. One excepts that

```
sage: qepcad(conds, memcells=2000000)
2 x - 1 > 0 /\ z > 0 /\ z - y < 0 /\ 3 z + 3 y + x - 1 < 0
```

However, the current Sage interface to QEPCAD forgets to pass `memcells` to the constructor of QEPCAD.


---

Comment by yzh created at 2016-02-26 18:41:26

Changing status from new to needs_review.


---

Comment by dimpase created at 2016-03-05 14:55:35

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2016-03-05 14:55:35

OK, please add the doctest

```
sage: ... # set vars and conds
sage: qepcad(conds, memcells=2000000) # optional - qepcad
2 x - 1 > 0 /\ z > 0 /\ z - y < 0 /\ 3 z + 3 y + x - 1 < 0
```


then I will be happy to give it positive review.


---

Comment by git created at 2016-03-05 19:55:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by yzh created at 2016-03-05 20:01:24

I added the doctest above. However, I failed to run `sage -t` on qepcad.py due to #20128; it caused 91 doctests failed.


---

Comment by dimpase created at 2016-03-05 20:32:08

Changing status from needs_work to positive_review.


---

Comment by dimpase created at 2016-03-05 20:32:08

Replying to [comment:6 yzh]:
> I added the doctest above. However, I failed to run `sage -t` on qepcad.py due to #20128; it caused 91 doctests failed.

it works for me on Linux and on OSX 10.11 just fine. Positive review.


---

Comment by yzh created at 2016-03-05 20:35:56

Thank you! :)


---

Comment by vbraun created at 2016-03-06 10:03:14

Resolution: fixed
