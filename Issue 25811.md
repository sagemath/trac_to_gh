# Issue 25811: Implement the universal Askey-Wilson algebra

archive/issues_025811.json:
```json
{
    "body": "Keywords: askey wilson\n\nBecause math physicists like it and it is connected with Askey-Wilson polynomials.\n\nIssue created by migration from https://trac.sagemath.org/ticket/26048\n\n",
    "created_at": "2018-08-11T23:23:56Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Implement the universal Askey-Wilson algebra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25811",
    "user": "https://github.com/tscrim"
}
```
Keywords: askey wilson

Because math physicists like it and it is connected with Askey-Wilson polynomials.

Issue created by migration from https://trac.sagemath.org/ticket/26048





---

archive/issue_comments_363909.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-11T23:24:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363909",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_363910.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-08-11T23:24:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363910",
    "user": "https://github.com/tscrim"
}
```

New commits:



---

archive/issue_comments_363911.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-09-15T16:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363911",
    "user": "https://github.com/soehms"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_363912.json:
```json
{
    "body": "1) Terwilliger assumes `q^4 != 1, q != 0` and the base ring to be a field. You don't check this, maybe since this seems not to be essential for the definition (except `q=0`):\n\n```\nsage: AW = algebras.AskeyWilson(ZZ, q=-1)\nsage: AW.inject_variables()\nDefining A, B, C, a, b, g\nsage: B*A\nA*B\nsage: AW = algebras.AskeyWilson(QQ, q=0)\nsage: AW.inject_variables()\nDefining A, B, C, a, b, g\nsage: B*A\nTraceback (most recent call last):\n...\nValueError: libGAP: Error, Rational operations: <divisor> must not be zero\n```\n\nBut, since the violation of these assumption may effect Terwilliger's results, you should give at least a warning here.\n\n2) Furthermore, I would replace the generator name `g` by `c`, since `g` might cause some confusion as in your own example:\n\n```\nsage: all(x * g == g * x for g in AW.algebra_generators() for x in [a,b,g])\nTrue\n```\n\nThe names `(a, b, c)` would coincide with the notion used in [Terwilliger2011]_ for the specialization of `alpha, beta` and `gamma`, as well. If you don't like to change the generator name you should at least change the example:\n \n```\nsage: all(x * f == f * x for f in AW.algebra_generators() for x in [a,b,g])\nTrue\n```\n\nsince:\n\n```\nsage: [ (g,x) for g in AW.algebra_generators() for x in [a,b,g]]\n[(A, a),\n (A, b),\n (A, A),\n....\n (g, g)]\n```\n\n\n3) Surely, your `product on basis` method can be completely understood from the code. But for such people as me it would be nicer to have some additional comments explaining the intentions. For example a headline above the first block saying something like \"First commute the central part of the monomial to the right\". Than explain that recursion is used which must terminate by degree reduction ...\n\n4) As you know, I appreciate to have the possibility of a more familiar view on abstract elements. Using your `AlgebraMorphism` class it is not difficult to have Terwilliger's map `pi` (Lemma 3.11) implemented. I think, it would be helpful to have it included in the class (even though not injective).\n\n\n5) Finally, I was not able to build the documentation\n\n```\n[algebras ] /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:52: WARNING: citation not found: Zhedanov1991\n[algebras ] /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:116: WARNING: citation not found: Terwilliger2011\n[algebras ] /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:127: WARNING: citation not found: Terwilliger2011\n[algebras ] /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:168: WARNING: citation not found: Terwilliger2011\n[algebras ] The HTML pages are in local/share/doc/sage/html/en/reference/algebras.\nError building the documentation.\nTraceback (most recent call last):\n...\nOSError: /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:52: WARNING: citation not found: Zhedanov1991\n```\n\neven though the citations where supplied in `src/doc/en/reference/references/index.rst`. What did I do wrong?",
    "created_at": "2018-09-15T16:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363912",
    "user": "https://github.com/soehms"
}
```

1) Terwilliger assumes `q^4 != 1, q != 0` and the base ring to be a field. You don't check this, maybe since this seems not to be essential for the definition (except `q=0`):

```
sage: AW = algebras.AskeyWilson(ZZ, q=-1)
sage: AW.inject_variables()
Defining A, B, C, a, b, g
sage: B*A
A*B
sage: AW = algebras.AskeyWilson(QQ, q=0)
sage: AW.inject_variables()
Defining A, B, C, a, b, g
sage: B*A
Traceback (most recent call last):
...
ValueError: libGAP: Error, Rational operations: <divisor> must not be zero
```

But, since the violation of these assumption may effect Terwilliger's results, you should give at least a warning here.

2) Furthermore, I would replace the generator name `g` by `c`, since `g` might cause some confusion as in your own example:

```
sage: all(x * g == g * x for g in AW.algebra_generators() for x in [a,b,g])
True
```

The names `(a, b, c)` would coincide with the notion used in [Terwilliger2011]_ for the specialization of `alpha, beta` and `gamma`, as well. If you don't like to change the generator name you should at least change the example:
 
```
sage: all(x * f == f * x for f in AW.algebra_generators() for x in [a,b,g])
True
```

since:

```
sage: [ (g,x) for g in AW.algebra_generators() for x in [a,b,g]]
[(A, a),
 (A, b),
 (A, A),
....
 (g, g)]
```


3) Surely, your `product on basis` method can be completely understood from the code. But for such people as me it would be nicer to have some additional comments explaining the intentions. For example a headline above the first block saying something like "First commute the central part of the monomial to the right". Than explain that recursion is used which must terminate by degree reduction ...

4) As you know, I appreciate to have the possibility of a more familiar view on abstract elements. Using your `AlgebraMorphism` class it is not difficult to have Terwilliger's map `pi` (Lemma 3.11) implemented. I think, it would be helpful to have it included in the class (even though not injective).


5) Finally, I was not able to build the documentation

```
[algebras ] /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:52: WARNING: citation not found: Zhedanov1991
[algebras ] /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:116: WARNING: citation not found: Terwilliger2011
[algebras ] /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:127: WARNING: citation not found: Terwilliger2011
[algebras ] /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:168: WARNING: citation not found: Terwilliger2011
[algebras ] The HTML pages are in local/share/doc/sage/html/en/reference/algebras.
Error building the documentation.
Traceback (most recent call last):
...
OSError: /home/sebastian/develop/sage/local/lib/python2.7/site-packages/sage/algebras/askey_wilson.py:docstring of sage.algebras.askey_wilson.AskeyWilsonAlgebra:52: WARNING: citation not found: Zhedanov1991
```

even though the citations where supplied in `src/doc/en/reference/references/index.rst`. What did I do wrong?



---

archive/issue_comments_363913.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-15T23:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363913",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_363914.json:
```json
{
    "body": "Thank you for taking a look at this.\n\nReplying to [comment:2 soehms]:\n> 1) Terwilliger assumes `q^4 != 1, q != 0` and the base ring to be a field. You don't check this, maybe since this seems not to be essential for the definition (except `q=0`):\n\n\nThe q = 0 case now raises and error (along if the base ring is not commutative).\n\n> But, since the violation of these assumption may effect Terwilliger's results, you should give at least a warning here.\n\n\nI added a `.. NOTE::` about this in the documentation, but as far as I can tell, nothing requires `R` to be a field and the q not a (fourth) root of unity does not seem to violate the algebra aspects of it.\n\n> 2) Furthermore, I would replace the generator name `g` by `c`, since `g` might cause some confusion as in your own example:\n\n\nThat is a good point. I changed all of those `g`'s to `gen`'s.\n\n> The names `(a, b, c)` would coincide with the notion used in [Terwilliger2011]_ for the specialization of `alpha, beta` and `gamma`, as well. If you don't like to change the generator name you should at least change the example:\n\n\nI called it `g` for `gamma` instead of `c` because `a,b,c` are for the specialized universal AW algebra. I can change it, but I prefer the `g` to keep the association with `gamma`.\n\n> 3) Surely, your `product on basis` method can be completely understood from the code. But for such people as me it would be nicer to have some additional comments explaining the intentions. For example a headline above the first block saying something like \"First commute the central part of the monomial to the right\". Than explain that recursion is used which must terminate by degree reduction ...\n\n\nI added a few more comments about this.\n\n> 4) As you know, I appreciate to have the possibility of a more familiar view on abstract elements. Using your `AlgebraMorphism` class it is not difficult to have Terwilliger's map `pi` (Lemma 3.11) implemented. I think, it would be helpful to have it included in the class (even though not injective).\n\n\nThat is a good idea. I have added this and gave this representation of the AW an explicit name.\n\n> 5) Finally, I was not able to build the documentation\n\n>\n> even though the citations where supplied in `src/doc/en/reference/references/index.rst`. What did I do wrong?\n\n\nWere you using `make doc`? I am guessing that you ran `sage --docbuild reference html`. The patchbots were able to build the doc as well, so it seems like something local to you.",
    "created_at": "2018-09-15T23:45:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363914",
    "user": "https://github.com/tscrim"
}
```

Thank you for taking a look at this.

Replying to [comment:2 soehms]:
> 1) Terwilliger assumes `q^4 != 1, q != 0` and the base ring to be a field. You don't check this, maybe since this seems not to be essential for the definition (except `q=0`):


The q = 0 case now raises and error (along if the base ring is not commutative).

> But, since the violation of these assumption may effect Terwilliger's results, you should give at least a warning here.


I added a `.. NOTE::` about this in the documentation, but as far as I can tell, nothing requires `R` to be a field and the q not a (fourth) root of unity does not seem to violate the algebra aspects of it.

> 2) Furthermore, I would replace the generator name `g` by `c`, since `g` might cause some confusion as in your own example:


That is a good point. I changed all of those `g`'s to `gen`'s.

> The names `(a, b, c)` would coincide with the notion used in [Terwilliger2011]_ for the specialization of `alpha, beta` and `gamma`, as well. If you don't like to change the generator name you should at least change the example:


I called it `g` for `gamma` instead of `c` because `a,b,c` are for the specialized universal AW algebra. I can change it, but I prefer the `g` to keep the association with `gamma`.

> 3) Surely, your `product on basis` method can be completely understood from the code. But for such people as me it would be nicer to have some additional comments explaining the intentions. For example a headline above the first block saying something like "First commute the central part of the monomial to the right". Than explain that recursion is used which must terminate by degree reduction ...


I added a few more comments about this.

> 4) As you know, I appreciate to have the possibility of a more familiar view on abstract elements. Using your `AlgebraMorphism` class it is not difficult to have Terwilliger's map `pi` (Lemma 3.11) implemented. I think, it would be helpful to have it included in the class (even though not injective).


That is a good idea. I have added this and gave this representation of the AW an explicit name.

> 5) Finally, I was not able to build the documentation

>
> even though the citations where supplied in `src/doc/en/reference/references/index.rst`. What did I do wrong?


Were you using `make doc`? I am guessing that you ran `sage --docbuild reference html`. The patchbots were able to build the doc as well, so it seems like something local to you.



---

archive/issue_comments_363915.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-09-15T23:45:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363915",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_363916.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-16T10:36:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_363917.json:
```json
{
    "body": "I did some minor corrections in the documentation layout (one missing & and two overfull h-boxes). If you agree with these changes, you may switch to positive review!",
    "created_at": "2018-09-16T10:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363917",
    "user": "https://github.com/soehms"
}
```

I did some minor corrections in the documentation layout (one missing & and two overfull h-boxes). If you agree with these changes, you may switch to positive review!



---

archive/issue_comments_363918.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-16T11:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363918",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_363919.json:
```json
{
    "body": "Thank you.",
    "created_at": "2018-09-16T11:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363919",
    "user": "https://github.com/tscrim"
}
```

Thank you.



---

archive/issue_events_065047.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-19T08:09:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25811#event-65047"
}
```



---

archive/issue_comments_363920.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-19T08:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363920",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_363921.json:
```json
{
    "body": "how about Askey-Wilson polynomials? I need them, they appear in theory of distance-regular graphs.",
    "created_at": "2021-04-13T17:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363921",
    "user": "https://github.com/dimpase"
}
```

how about Askey-Wilson polynomials? I need them, they appear in theory of distance-regular graphs.



---

archive/issue_comments_363922.json:
```json
{
    "body": "This won't immediately generate them as it is related to the representation theory of this algebra (see http://www.scholarpedia.org/article/Askey-Wilson_polynomial). They are probably best implemented using the 3-term recurrence using p<sub>-1</sub>(x) = 0 and p<sub>0</sub>(x) = 1.",
    "created_at": "2021-04-14T00:27:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25811#issuecomment-363922",
    "user": "https://github.com/tscrim"
}
```

This won't immediately generate them as it is related to the representation theory of this algebra (see http://www.scholarpedia.org/article/Askey-Wilson_polynomial). They are probably best implemented using the 3-term recurrence using p<sub>-1</sub>(x) = 0 and p<sub>0</sub>(x) = 1.
