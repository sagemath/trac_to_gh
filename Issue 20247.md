# Issue 20247: Use the cythonized versions of has_descent, first_descent, descents for reflection groups

Issue created by migration from Trac.

Original creator: stumpc5

Original creation time: 2016-04-22 06:51:28

CC:  tscrim chapoton nthiery vripoll

These methods are already included in #20445 and should be factored out. That will in particular speed subword complexes a lot, see #20402.


---

Comment by stumpc5 created at 2016-04-25 09:14:08

For the record: subword complexes would appreciate fast `apply_simple_reflection_left` and `has_left_descent`, see


```
sage:W = ReflectionGroup(['A',8])
sage: c = W.index_set(); Q = c + tuple(W.w0.coxeter_sorting_word(c))
sage: %prun SC = SubwordComplex(Q,W.w0)

4679142 function calls (4679130 primitive calls) in 8.222 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
   772419    2.634    0.000    3.119    0.000 complex_reflection_or_generalized_coxeter_groups.py:831(apply_simple_reflection_left)
  1163569    2.464    0.000    2.648    0.000 reflection_group_real.py:771(has_left_descent)
        1    2.229    2.229    7.997    7.997 {sage.combinat.subword_complex_c._construct_facets_c}
```



---

Comment by stumpc5 created at 2016-04-25 09:16:01

And also:

```
sage:W = ReflectionGroup(['A',7])
sage: c = W.index_set(); Q = c + tuple(W.w0.coxeter_sorting_word(c))
sage: %prun SC = SubwordComplex(Q,W.w0,algorithm="greedy")

         4605779 function calls (4605355 primitive calls) in 8.236 seconds

   Ordered by: internal time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
   560742    1.870    0.000    4.946    0.000 reflection_group_real.py:790(has_descent)
   560742    1.363    0.000    2.774    0.000 coxeter_groups.py:717(has_right_descent)
   560770    1.321    0.000    1.412    0.000 reflection_group_real.py:771(has_left_descent)
   178698    0.744    0.000    5.690    0.000 coxeter_groups.py:763(first_descent)
```



---

Comment by chapoton created at 2016-09-20 15:56:24

I just made a branch. Not having chevie, I have no way to tell if this is faster than before.
----
New commits:


---

Comment by tscrim created at 2018-05-28 08:11:21

This was (mostly) taken care of indirectly on #22600.


---

Comment by tscrim created at 2018-05-28 08:11:33

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-05-28 08:11:59

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-05-28 08:11:59

Christian over my laptop concurs.


---

Comment by chapoton created at 2018-05-28 08:16:18

Sind Sie in Berlin ?

Would you guys have a little time to look at the failures in the python3-docbuild that are related to crystals ? See there for the log (search for `Error:` and `AttributeError: 'RootSystem' object has no attribute 'dual'`)

https://patchbot.sagemath.org/log/0/Ubuntu/18.04/x86_64/4.15.0-20-generic/petitbonum/2018-05-27%2021:55:21?plugin=docbuild


---

Comment by chapoton created at 2018-05-31 05:54:00

the branch is red..


---

Comment by tscrim created at 2018-05-31 06:02:09

See comment:4


---

Comment by embray created at 2019-02-26 13:58:00

Resolution: invalid


---

Comment by embray created at 2019-02-26 13:58:00

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.
