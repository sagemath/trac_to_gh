# Issue 34300: Prepare for pari 2.15

archive/issues_034300.json:
```json
{
    "body": "CC:  @antonio-rojas @collares @JohnCremona\n\nPARI/GP is about to release a new version\n\nIssue created by migration from https://trac.sagemath.org/ticket/34537\n\n",
    "created_at": "2022-09-15T08:21:09Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Prepare for pari 2.15",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/34300",
    "user": "https://github.com/videlec"
}
```
CC:  @antonio-rojas @collares @JohnCremona

PARI/GP is about to release a new version

Issue created by migration from https://trac.sagemath.org/ticket/34537





---

archive/issue_comments_485824.json:
```json
{
    "body": "Attachment [giac-1.9.0.15p0.log](tarball://root/attachments/some-uuid/ticket34537/giac-1.9.0.15p0.log) by @videlec created at 2022-09-15 09:20:41",
    "created_at": "2022-09-15T09:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485824",
    "user": "https://github.com/videlec"
}
```

Attachment [giac-1.9.0.15p0.log](tarball://root/attachments/some-uuid/ticket34537/giac-1.9.0.15p0.log) by @videlec created at 2022-09-15 09:20:41



---

archive/issue_comments_485825.json:
```json
{
    "body": "Indeed, according to Bill Allombert `ANYARG` is gone in PARI/GP 2.15.0.",
    "created_at": "2022-09-15T09:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485825",
    "user": "https://github.com/videlec"
}
```

Indeed, according to Bill Allombert `ANYARG` is gone in PARI/GP 2.15.0.



---

archive/issue_comments_485826.json:
```json
{
    "body": "a solution\n\n```\n#ifdef __cplusplus\n#  define ANYARG ...\n#else\n#  define ANYARG\n#endif\n```",
    "created_at": "2022-09-15T09:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485826",
    "user": "https://github.com/videlec"
}
```

a solution

```
#ifdef __cplusplus
#  define ANYARG ...
#else
#  define ANYARG
#endif
```



---

archive/issue_comments_485827.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-09-15T10:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485827",
    "user": "https://github.com/videlec"
}
```

New commits:



---

archive/issue_comments_485828.json:
```json
{
    "body": "Attachment [testall.log](tarball://root/attachments/some-uuid/ticket34537/testall.log) by @videlec created at 2022-09-15 18:50:52",
    "created_at": "2022-09-15T18:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485828",
    "user": "https://github.com/videlec"
}
```

Attachment [testall.log](tarball://root/attachments/some-uuid/ticket34537/testall.log) by @videlec created at 2022-09-15 18:50:52



---

archive/issue_comments_485829.json:
```json
{
    "body": "For the complete log, see [testall.log](https://trac.sagemath.org/raw-attachment/ticket/34537/testall.log)\n\n```\ngeometry/polyhedron/backend_normaliz.py  # 1 doctest failed\ngeometry/polyhedron/backend_field.py  # 2 doctests failed\ndynamics/arithmetic_dynamics/projective_ds.py  # 1 doctest failed\narith/misc.py  # 4 doctests failed\nlibs/pari/tests.py  # 2 doctests failed\ndoctest/forker.py  # 1 doctest failed\ndoctest/sources.py  # 1 doctest failed\nmodular/cusps_nf.py  # 1 doctest failed\nmodular/modform/l_series_gross_zagier.py  # 1 doctest failed\nmodular/modsym/p1list_nf.py  # 3 doctests failed\nmodular/modform_hecketriangle/hecke_triangle_group_element.py  # 1 doctest failed\ninterfaces/genus2reduction.py  # 15 doctests failed\nplot/plot3d/index_face_set.pyx  # Timed out\nmodules/free_quadratic_module_integer_symmetric.py  # 6 doctests failed\nlfunctions/pari.py  # 1 doctest failed\nlfunctions/dokchitser.py  # 4 doctests failed\nrings/qqbar.py  # 28 doctests failed\nrings/function_field/function_field.py  # 1 doctest failed\nrings/number_field/selmer_group.py  # 1 doctest failed\nrings/number_field/class_group.py  # 3 doctests failed\nrings/number_field/number_field_ideal_rel.py  # 3 doctests failed\nrings/number_field/bdd_height.py  # 1 doctest failed\nrings/number_field/order.py  # 1 doctest failed\nrings/number_field/S_unit_solver.py  # 4 doctests failed\nrings/number_field/number_field.py  # 20 doctests failed\nrings/number_field/number_field_rel.py  # 2 doctests failed\nrings/number_field/number_field_ideal.py  # 1 doctest failed\nrings/number_field/number_field_element.pyx  # 3 doctests failed\nrings/number_field/galois_group.py  # 1 doctest failed\nrings/finite_rings/finite_field_prime_modn.py  # 1 doctest failed\nrings/finite_rings/residue_field.pyx  # 12 doctests failed\nrings/polynomial/polynomial_quotient_ring.py  # 1 doctest failed\nrings/polynomial/polynomial_element.pyx  # 2 doctests failed\nrings/polynomial/polynomial_number_field.pyx  # 1 doctest failed\ngroups/fqf_orthogonal.py  # 1 doctest failed\ngroups/matrix_gps/isometries.py  # 1 doctest failed\nschemes/curves/affine_curve.py  # 3 doctests failed\nschemes/plane_conics/con_rational_function_field.py  # 3 doctests failed\nschemes/elliptic_curves/gal_reps_number_field.py  # 2 doctests failed\nschemes/elliptic_curves/ell_rational_field.py  # 17 doctests failed\nschemes/elliptic_curves/isogeny_small_degree.py  # 1 doctest failed\nschemes/elliptic_curves/gp_simon.py  # 1 doctest failed\nschemes/elliptic_curves/modular_parametrization.py  # 3 doctests failed\nschemes/elliptic_curves/BSD.py  # 3 doctests failed\nschemes/elliptic_curves/ell_generic.py  # 1 doctest failed\nschemes/elliptic_curves/heegner.py  # 181 doctests failed\nschemes/elliptic_curves/ell_field.py  # 1 doctest failed\nschemes/elliptic_curves/ell_number_field.py  # 6 doctests failed\nschemes/hyperelliptic_curves/jacobian_endomorphism_utils.py  # 4 doctests failed\nschemes/hyperelliptic_curves/jacobian_generic.py  # 10 doctests failed\nschemes/affine/affine_morphism.py  # 1 doctest failed\nquadratic_forms/binary_qf.py  # 25 doctests failed\nquadratic_forms/quadratic_form__automorphisms.py  # 1 doctest failed\nquadratic_forms/qfsolve.py  # 1 doctest failed\nquadratic_forms/genera/genus.py  # 5 doctests failed\n```",
    "created_at": "2022-09-15T18:54:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485829",
    "user": "https://github.com/videlec"
}
```

For the complete log, see [testall.log](https://trac.sagemath.org/raw-attachment/ticket/34537/testall.log)

```
geometry/polyhedron/backend_normaliz.py  # 1 doctest failed
geometry/polyhedron/backend_field.py  # 2 doctests failed
dynamics/arithmetic_dynamics/projective_ds.py  # 1 doctest failed
arith/misc.py  # 4 doctests failed
libs/pari/tests.py  # 2 doctests failed
doctest/forker.py  # 1 doctest failed
doctest/sources.py  # 1 doctest failed
modular/cusps_nf.py  # 1 doctest failed
modular/modform/l_series_gross_zagier.py  # 1 doctest failed
modular/modsym/p1list_nf.py  # 3 doctests failed
modular/modform_hecketriangle/hecke_triangle_group_element.py  # 1 doctest failed
interfaces/genus2reduction.py  # 15 doctests failed
plot/plot3d/index_face_set.pyx  # Timed out
modules/free_quadratic_module_integer_symmetric.py  # 6 doctests failed
lfunctions/pari.py  # 1 doctest failed
lfunctions/dokchitser.py  # 4 doctests failed
rings/qqbar.py  # 28 doctests failed
rings/function_field/function_field.py  # 1 doctest failed
rings/number_field/selmer_group.py  # 1 doctest failed
rings/number_field/class_group.py  # 3 doctests failed
rings/number_field/number_field_ideal_rel.py  # 3 doctests failed
rings/number_field/bdd_height.py  # 1 doctest failed
rings/number_field/order.py  # 1 doctest failed
rings/number_field/S_unit_solver.py  # 4 doctests failed
rings/number_field/number_field.py  # 20 doctests failed
rings/number_field/number_field_rel.py  # 2 doctests failed
rings/number_field/number_field_ideal.py  # 1 doctest failed
rings/number_field/number_field_element.pyx  # 3 doctests failed
rings/number_field/galois_group.py  # 1 doctest failed
rings/finite_rings/finite_field_prime_modn.py  # 1 doctest failed
rings/finite_rings/residue_field.pyx  # 12 doctests failed
rings/polynomial/polynomial_quotient_ring.py  # 1 doctest failed
rings/polynomial/polynomial_element.pyx  # 2 doctests failed
rings/polynomial/polynomial_number_field.pyx  # 1 doctest failed
groups/fqf_orthogonal.py  # 1 doctest failed
groups/matrix_gps/isometries.py  # 1 doctest failed
schemes/curves/affine_curve.py  # 3 doctests failed
schemes/plane_conics/con_rational_function_field.py  # 3 doctests failed
schemes/elliptic_curves/gal_reps_number_field.py  # 2 doctests failed
schemes/elliptic_curves/ell_rational_field.py  # 17 doctests failed
schemes/elliptic_curves/isogeny_small_degree.py  # 1 doctest failed
schemes/elliptic_curves/gp_simon.py  # 1 doctest failed
schemes/elliptic_curves/modular_parametrization.py  # 3 doctests failed
schemes/elliptic_curves/BSD.py  # 3 doctests failed
schemes/elliptic_curves/ell_generic.py  # 1 doctest failed
schemes/elliptic_curves/heegner.py  # 181 doctests failed
schemes/elliptic_curves/ell_field.py  # 1 doctest failed
schemes/elliptic_curves/ell_number_field.py  # 6 doctests failed
schemes/hyperelliptic_curves/jacobian_endomorphism_utils.py  # 4 doctests failed
schemes/hyperelliptic_curves/jacobian_generic.py  # 10 doctests failed
schemes/affine/affine_morphism.py  # 1 doctest failed
quadratic_forms/binary_qf.py  # 25 doctests failed
quadratic_forms/quadratic_form__automorphisms.py  # 1 doctest failed
quadratic_forms/qfsolve.py  # 1 doctest failed
quadratic_forms/genera/genus.py  # 5 doctests failed
```



---

archive/issue_comments_485830.json:
```json
{
    "body": "Pushed fixes for test failures caused by different choice of generators and syntax changes so we have a clear picture of the actual issues. Remaining failures:\n\n```\nsage -t --long /usr/lib/python3.10/site-packages/sage/quadratic_forms/qfsolve.py  # 1 doctest failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/quadratic_forms/binary_qf.py  # 25 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/quadratic_forms/genera/genus.py  # 4 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/modular/modform/l_series_gross_zagier.py  # 1 doctest failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/plane_conics/con_rational_function_field.py  # 3 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/curves/affine_curve.py  # 3 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/heegner.py  # 181 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py  # 17 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/BSD.py  # 3 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/modular_parametrization.py  # 3 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/gp_simon.py  # 1 doctest failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/jacobian_generic.py  # 10 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/jacobian_endomorphism_utils.py  # 4 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/modules/free_quadratic_module_integer_symmetric.py  # 1 doctest failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/lfunctions/dokchitser.py  # 4 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/groups/fqf_orthogonal.py  # 1 doctest failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/rings/number_field/number_field.py  # 11 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/rings/number_field/number_field_element.pyx  # 1 doctest failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/rings/polynomial/polynomial_element.pyx  # 2 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/rings/polynomial/polynomial_number_field.pyx  # 1 doctest failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/rings/function_field/function_field.py  # 1 doctest failed\n```\n\n---\nNew commits:",
    "created_at": "2022-09-20T19:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485830",
    "user": "https://github.com/antonio-rojas"
}
```

Pushed fixes for test failures caused by different choice of generators and syntax changes so we have a clear picture of the actual issues. Remaining failures:

```
sage -t --long /usr/lib/python3.10/site-packages/sage/quadratic_forms/qfsolve.py  # 1 doctest failed
sage -t --long /usr/lib/python3.10/site-packages/sage/quadratic_forms/binary_qf.py  # 25 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/quadratic_forms/genera/genus.py  # 4 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/modular/modform/l_series_gross_zagier.py  # 1 doctest failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/plane_conics/con_rational_function_field.py  # 3 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/curves/affine_curve.py  # 3 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/heegner.py  # 181 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/ell_rational_field.py  # 17 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/BSD.py  # 3 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/modular_parametrization.py  # 3 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/elliptic_curves/gp_simon.py  # 1 doctest failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/jacobian_generic.py  # 10 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/jacobian_endomorphism_utils.py  # 4 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/modules/free_quadratic_module_integer_symmetric.py  # 1 doctest failed
sage -t --long /usr/lib/python3.10/site-packages/sage/lfunctions/dokchitser.py  # 4 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/groups/fqf_orthogonal.py  # 1 doctest failed
sage -t --long /usr/lib/python3.10/site-packages/sage/rings/number_field/number_field.py  # 11 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/rings/number_field/number_field_element.pyx  # 1 doctest failed
sage -t --long /usr/lib/python3.10/site-packages/sage/rings/polynomial/polynomial_element.pyx  # 2 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/rings/polynomial/polynomial_number_field.pyx  # 1 doctest failed
sage -t --long /usr/lib/python3.10/site-packages/sage/rings/function_field/function_field.py  # 1 doctest failed
```

---
New commits:



---

archive/issue_comments_485831.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-20T20:26:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485831",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485832.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-20T21:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485832",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485833.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T06:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485833",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485834.json:
```json
{
    "body": "Upstream report for the failures in `schemes.curves.affine_curve` and `rings.number_field.number_field`:\n\nhttps://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2414",
    "created_at": "2022-09-21T08:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485834",
    "user": "https://github.com/antonio-rojas"
}
```

Upstream report for the failures in `schemes.curves.affine_curve` and `rings.number_field.number_field`:

https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2414



---

archive/issue_comments_485835.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T08:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485835",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485836.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-21T08:14:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485836",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485837.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-22T15:41:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485837",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485838.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-22T18:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485838",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485839.json:
```json
{
    "body": "Only two remaining issues that are going to need more help from experts:\n\n```\nsage -t --long /usr/lib/python3.10/site-packages/sage/interfaces/genus2reduction.py  # 15 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/jacobian_generic.py  # 10 doctests failed\nsage -t --long /usr/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/jacobian_endomorphism_utils.py  # 4 doctests failed\n```\nThese are caused by the changes in gp's `genus2red` output from https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=a41e4fa95925eae42830217313583efc80628763\n\nSage's `genus2reduction.py` needs to be adapted to those changes.\n\n```\nsage -t --long /usr/lib/python3.10/site-packages/sage/groups/fqf_orthogonal.py  # 1 doctest failed\n```\n\nThis is a weird issue that involves pari and gap code. Needs further investigation.",
    "created_at": "2022-09-22T18:15:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485839",
    "user": "https://github.com/antonio-rojas"
}
```

Only two remaining issues that are going to need more help from experts:

```
sage -t --long /usr/lib/python3.10/site-packages/sage/interfaces/genus2reduction.py  # 15 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/jacobian_generic.py  # 10 doctests failed
sage -t --long /usr/lib/python3.10/site-packages/sage/schemes/hyperelliptic_curves/jacobian_endomorphism_utils.py  # 4 doctests failed
```
These are caused by the changes in gp's `genus2red` output from https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=a41e4fa95925eae42830217313583efc80628763

Sage's `genus2reduction.py` needs to be adapted to those changes.

```
sage -t --long /usr/lib/python3.10/site-packages/sage/groups/fqf_orthogonal.py  # 1 doctest failed
```

This is a weird issue that involves pari and gap code. Needs further investigation.



---

archive/issue_comments_485840.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-23T14:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485840",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485841.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-23T17:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485841",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485842.json:
```json
{
    "body": "Replying to [comment:11 Antonio Rojas]:\n> Upstream report for the failures in `schemes.curves.affine_curve` and `rings.number_field.number_field`:\n> \n> https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2414\n\n\nThe bug was fixed upstream, but we may want to keep the workaround. It's not particularly hackish and will allow to use an unpatched system pari 2.15.0",
    "created_at": "2022-09-24T21:26:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485842",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:11 Antonio Rojas]:
> Upstream report for the failures in `schemes.curves.affine_curve` and `rings.number_field.number_field`:
> 
> https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2414


The bug was fixed upstream, but we may want to keep the workaround. It's not particularly hackish and will allow to use an unpatched system pari 2.15.0



---

archive/issue_comments_485843.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-09-25T01:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485843",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_485844.json:
```json
{
    "body": "Is this ready to go, or should we put the giac build fix on a separate ticket?",
    "created_at": "2022-09-25T01:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485844",
    "user": "https://github.com/mkoeppe"
}
```

Is this ready to go, or should we put the giac build fix on a separate ticket?



---

archive/issue_comments_485845.json:
```json
{
    "body": "It's not ready, see comment:16",
    "created_at": "2022-09-25T06:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485845",
    "user": "https://github.com/antonio-rojas"
}
```

It's not ready, see comment:16



---

archive/issue_comments_485846.json:
```json
{
    "body": "That's now #34586",
    "created_at": "2022-09-25T19:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485846",
    "user": "https://github.com/mkoeppe"
}
```

That's now #34586



---

archive/issue_comments_485847.json:
```json
{
    "body": "Instead of using the `ellQ_ellrank` from Denis Simon script we should be using the `ellrank` from PARI/GP (available from version 2.15). Though, the latter only works over rational numbers.",
    "created_at": "2022-09-29T09:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485847",
    "user": "https://github.com/videlec"
}
```

Instead of using the `ellQ_ellrank` from Denis Simon script we should be using the `ellrank` from PARI/GP (available from version 2.15). Though, the latter only works over rational numbers.



---

archive/issue_comments_485848.json:
```json
{
    "body": "Replying to [comment:25 Vincent Delecroix]:\n> Instead of using the `ellQ_ellrank` from Denis Simon script we should be using the `ellrank` from PARI/GP (available from version 2.15). Though, the latter only works over rational numbers.\n\n\nThat should go in a follow-up ticket, I think. The branch is already big enough.",
    "created_at": "2022-09-29T09:30:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485848",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:25 Vincent Delecroix]:
> Instead of using the `ellQ_ellrank` from Denis Simon script we should be using the `ellrank` from PARI/GP (available from version 2.15). Though, the latter only works over rational numbers.


That should go in a follow-up ticket, I think. The branch is already big enough.



---

archive/issue_comments_485849.json:
```json
{
    "body": "Replying to [comment:26 Antonio Rojas]:\n> Replying to [comment:25 Vincent Delecroix]:\n> > Instead of using the `ellQ_ellrank` from Denis Simon script we should be using the `ellrank` from PARI/GP (available from version 2.15). Though, the latter only works over rational numbers.\n\n> \n> That should go in a follow-up ticket, I think. The branch is already big enough.\n\n\nSure: #34608",
    "created_at": "2022-09-29T09:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485849",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:26 Antonio Rojas]:
> Replying to [comment:25 Vincent Delecroix]:
> > Instead of using the `ellQ_ellrank` from Denis Simon script we should be using the `ellrank` from PARI/GP (available from version 2.15). Though, the latter only works over rational numbers.

> 
> That should go in a follow-up ticket, I think. The branch is already big enough.


Sure: #34608



---

archive/issue_comments_485850.json:
```json
{
    "body": "I am with Bill. I will push a fix for the genus 2 reduction.",
    "created_at": "2022-09-29T09:42:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485850",
    "user": "https://github.com/videlec"
}
```

I am with Bill. I will push a fix for the genus 2 reduction.



---

archive/issue_comments_485851.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-09-29T10:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485851",
    "user": "https://github.com/videlec"
}
```

New commits:



---

archive/issue_comments_485852.json:
```json
{
    "body": "The modifications I have done are incompatible with PARI < 2.15. I think it would be simpler to enforce PARI >= 2.15 in the next sage version.",
    "created_at": "2022-09-29T10:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485852",
    "user": "https://github.com/videlec"
}
```

The modifications I have done are incompatible with PARI < 2.15. I think it would be simpler to enforce PARI >= 2.15 in the next sage version.



---

archive/issue_comments_485853.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-30T06:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485853",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485854.json:
```json
{
    "body": "Replying to [comment:30 Vincent Delecroix]:\n> I think it would be simpler to enforce PARI >= 2.15 in the next sage version.\n\n\nIf done, this would simplify the patch at #33360, which currently chooses from two distinct implementations depending on the PARI version.",
    "created_at": "2022-09-30T07:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485854",
    "user": "https://github.com/yyyyx4"
}
```

Replying to [comment:30 Vincent Delecroix]:
> I think it would be simpler to enforce PARI >= 2.15 in the next sage version.


If done, this would simplify the patch at #33360, which currently chooses from two distinct implementations depending on the PARI version.



---

archive/issue_comments_485855.json:
```json
{
    "body": "Meanwhile, please see #34496 - to forbid system Pari 2.15 and newer, until we're done here.",
    "created_at": "2022-09-30T12:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485855",
    "user": "https://github.com/dimpase"
}
```

Meanwhile, please see #34496 - to forbid system Pari 2.15 and newer, until we're done here.



---

archive/issue_comments_485856.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-30T13:18:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485856",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485857.json:
```json
{
    "body": "This is almost ready, just needs someone to figure out the failure in `sage/groups/fqf_orthogonal.py`",
    "created_at": "2022-09-30T13:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485857",
    "user": "https://github.com/antonio-rojas"
}
```

This is almost ready, just needs someone to figure out the failure in `sage/groups/fqf_orthogonal.py`



---

archive/issue_comments_485858.json:
```json
{
    "body": "The test in `fqf_orthogonal.py` does not make much sense as `Oq` and `OL` are different groups.",
    "created_at": "2022-09-30T14:31:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485858",
    "user": "https://github.com/videlec"
}
```

The test in `fqf_orthogonal.py` does not make much sense as `Oq` and `OL` are different groups.



---

archive/issue_comments_485859.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-30T14:31:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485859",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485860.json:
```json
{
    "body": "Replying to [comment:35 Antonio Rojas]:\n> This is almost ready, just needs someone to figure out the failure in `sage/groups/fqf_orthogonal.py`\n\n\nOK, from a closer look it looks like this is just caused by a different choice of generators for the orthogonal group. Replacing\n\n```\nsage: assert Oq(OL.0) == Oq(OL.0.matrix())\n```\nwith\n\n```\nsage: assert Oq(OL.1) == Oq(OL.1.matrix())\n```\ngives the same failure with pari 2.13. So, even though this looks like an actual issue, it is not a regression from the pari update, it just happened to work by chance before due to a different matrix being tested. I think we should just flag this as known bug and proceed with this.\n\n---\nNew commits:",
    "created_at": "2022-09-30T14:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485860",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:35 Antonio Rojas]:
> This is almost ready, just needs someone to figure out the failure in `sage/groups/fqf_orthogonal.py`


OK, from a closer look it looks like this is just caused by a different choice of generators for the orthogonal group. Replacing

```
sage: assert Oq(OL.0) == Oq(OL.0.matrix())
```
with

```
sage: assert Oq(OL.1) == Oq(OL.1.matrix())
```
gives the same failure with pari 2.13. So, even though this looks like an actual issue, it is not a regression from the pari update, it just happened to work by chance before due to a different matrix being tested. I think we should just flag this as known bug and proceed with this.

---
New commits:



---

archive/issue_comments_485861.json:
```json
{
    "body": "I pushed a \"fix\" in 48ea610. I do not think there is anything deep about generators that is tested here. Otherwise this should have been documented!",
    "created_at": "2022-09-30T14:34:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485861",
    "user": "https://github.com/videlec"
}
```

I pushed a "fix" in 48ea610. I do not think there is anything deep about generators that is tested here. Otherwise this should have been documented!



---

archive/issue_comments_485862.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-09-30T14:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485862",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_485863.json:
```json
{
    "body": "Antonio, if you don't like my last commit feel free to replace with \"known bug\".",
    "created_at": "2022-09-30T14:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485863",
    "user": "https://github.com/videlec"
}
```

Antonio, if you don't like my last commit feel free to replace with "known bug".



---

archive/issue_comments_485864.json:
```json
{
    "body": "Should we enforce pari 2.15 at configure step?",
    "created_at": "2022-09-30T14:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485864",
    "user": "https://github.com/videlec"
}
```

Should we enforce pari 2.15 at configure step?



---

archive/issue_comments_485865.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2022-09-30T14:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485865",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_485866.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-30T14:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485867.json:
```json
{
    "body": "Replying to [comment:42 Vincent Delecroix]:\n> Should we enforce pari 2.15 at configure step?\n\n\nWas just doing that. Since there are backwards-incompatible changes, we should",
    "created_at": "2022-09-30T14:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485867",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:42 Vincent Delecroix]:
> Should we enforce pari 2.15 at configure step?


Was just doing that. Since there are backwards-incompatible changes, we should



---

archive/issue_comments_485868.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2022-09-30T14:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485868",
    "user": "https://github.com/antonio-rojas"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_485869.json:
```json
{
    "body": "see the rationale for putting #34496 into dependencies in #34496",
    "created_at": "2022-09-30T15:11:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485869",
    "user": "https://github.com/dimpase"
}
```

see the rationale for putting #34496 into dependencies in #34496



---

archive/issue_comments_485870.json:
```json
{
    "body": "Also `m4_pushdef([SAGE_PARI_MINVER],[\"134912\"])` is not right. This is pari 2.15.0, but without a patch it won't work. So this has to be a bigger value.",
    "created_at": "2022-09-30T15:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485870",
    "user": "https://github.com/dimpase"
}
```

Also `m4_pushdef([SAGE_PARI_MINVER],["134912"])` is not right. This is pari 2.15.0, but without a patch it won't work. So this has to be a bigger value.



---

archive/issue_comments_485871.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2022-09-30T15:23:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485871",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_485872.json:
```json
{
    "body": "I've rebased over the branch of #34496 and bumped SAGE_PARI_MIN/MAXVER accordingly.",
    "created_at": "2022-09-30T15:24:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485872",
    "user": "https://github.com/dimpase"
}
```

I've rebased over the branch of #34496 and bumped SAGE_PARI_MIN/MAXVER accordingly.



---

archive/issue_comments_485873.json:
```json
{
    "body": "Replying to [comment:46 Dima Pasechnik]:\n> Also `m4_pushdef([SAGE_PARI_MINVER],[\"134912\"])` is not right. This is pari 2.15.0, but without a patch it won't work. So this has to be a bigger value.\n\n\nWhich patch? This works fine with plain 2.15.0",
    "created_at": "2022-09-30T15:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485873",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:46 Dima Pasechnik]:
> Also `m4_pushdef([SAGE_PARI_MINVER],["134912"])` is not right. This is pari 2.15.0, but without a patch it won't work. So this has to be a bigger value.


Which patch? This works fine with plain 2.15.0



---

archive/issue_comments_485874.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-30T15:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485874",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485875.json:
```json
{
    "body": "OK, right, I didn't pay attention. It's giac's patch, not pari's. Fixed.",
    "created_at": "2022-09-30T15:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485875",
    "user": "https://github.com/dimpase"
}
```

OK, right, I didn't pay attention. It's giac's patch, not pari's. Fixed.



---

archive/issue_comments_485876.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-09-30T16:01:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485876",
    "user": "https://github.com/antonio-rojas"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_485877.json:
```json
{
    "body": "Looks like the force push reverted part of the 9.8.beta1 rebase. The changes in `sage/geometry/polyhedron/backend_normaliz.py` shouldn't be there, and the pycodestyle changes from #34522 in `src/sage/lfunctions/pari.py` are missing.",
    "created_at": "2022-09-30T16:01:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485877",
    "user": "https://github.com/antonio-rojas"
}
```

Looks like the force push reverted part of the 9.8.beta1 rebase. The changes in `sage/geometry/polyhedron/backend_normaliz.py` shouldn't be there, and the pycodestyle changes from #34522 in `src/sage/lfunctions/pari.py` are missing.



---

archive/issue_comments_485878.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-09-30T16:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485878",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_485879.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-09-30T16:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485879",
    "user": "https://github.com/antonio-rojas"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_485880.json:
```json
{
    "body": "tests good on macOS with Homebrew's pari 2.15.0",
    "created_at": "2022-10-01T07:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485880",
    "user": "https://github.com/dimpase"
}
```

tests good on macOS with Homebrew's pari 2.15.0



---

archive/issue_comments_485881.json:
```json
{
    "body": "I suppose this needs a round of testing on GH Actions.",
    "created_at": "2022-10-01T07:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485881",
    "user": "https://github.com/dimpase"
}
```

I suppose this needs a round of testing on GH Actions.



---

archive/issue_comments_485882.json:
```json
{
    "body": "I've started https://github.com/sagemath/sagetrac-mirror/actions/runs/3164081241\nI see the CI has been refactored, not sure how to run more tests.",
    "created_at": "2022-10-01T09:53:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485882",
    "user": "https://github.com/dimpase"
}
```

I've started https://github.com/sagemath/sagetrac-mirror/actions/runs/3164081241
I see the CI has been refactored, not sure how to run more tests.



---

archive/issue_comments_485883.json:
```json
{
    "body": "Replying to [comment:57 Dima Pasechnik]:\n> I've started https://github.com/sagemath/sagetrac-mirror/actions/runs/3164081241\n> I see the CI has been refactored, not sure how to run more tests.\n\n\nUse https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-linux.yml?query=branch%3Apublic%2F34537 and push \"Run workflow\"\n\nor https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-macos.yml?query=branch%3Apublic%2F34537 and push \"Run workflow\"",
    "created_at": "2022-10-01T16:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485883",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:57 Dima Pasechnik]:
> I've started https://github.com/sagemath/sagetrac-mirror/actions/runs/3164081241
> I see the CI has been refactored, not sure how to run more tests.


Use https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-linux.yml?query=branch%3Apublic%2F34537 and push "Run workflow"

or https://github.com/sagemath/sagetrac-mirror/actions/workflows/ci-macos.yml?query=branch%3Apublic%2F34537 and push "Run workflow"



---

archive/issue_comments_485884.json:
```json
{
    "body": "started \n\nhttps://github.com/sagemath/sagetrac-mirror/actions/runs/3167926282\n\nand \n\nhttps://github.com/sagemath/sagetrac-mirror/actions/runs/3167930205\n\nBy the way, with such urls as you provided, it's not sufficent to just push \"Run workflow\", as this widget still has \"develop\" as a branch to run - so the branch still had to manually selected.",
    "created_at": "2022-10-02T08:50:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485884",
    "user": "https://github.com/dimpase"
}
```

started 

https://github.com/sagemath/sagetrac-mirror/actions/runs/3167926282

and 

https://github.com/sagemath/sagetrac-mirror/actions/runs/3167930205

By the way, with such urls as you provided, it's not sufficent to just push "Run workflow", as this widget still has "develop" as a branch to run - so the branch still had to manually selected.



---

archive/issue_comments_485885.json:
```json
{
    "body": "works on M1 mac with Homebrew, too.",
    "created_at": "2022-10-03T07:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485885",
    "user": "https://github.com/dimpase"
}
```

works on M1 mac with Homebrew, too.



---

archive/issue_comments_485886.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-10-03T15:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485886",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485887.json:
```json
{
    "body": "there were errors with many CI runs on macOS, but I think it's not because of this. LGTM",
    "created_at": "2022-10-03T15:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485887",
    "user": "https://github.com/dimpase"
}
```

there were errors with many CI runs on macOS, but I think it's not because of this. LGTM



---

archive/issue_comments_485888.json:
```json
{
    "body": "I spoke too soon. While Sage tests all pass, some of giac's selftests fail (this is on macOS M1 machine)\n\n```\n[giac-1.9.0.15p0] make  check-TESTS\n[giac-1.9.0.15p0] PASS: chk_partfrac\n[giac-1.9.0.15p0] PASS: chk_factor\n[giac-1.9.0.15p0] PASS: chk_integrate\n[giac-1.9.0.15p0] PASS: chk_geo\n[giac-1.9.0.15p0] FAIL: chk_fhan2\n[giac-1.9.0.15p0] PASS: chk_cas\n[giac-1.9.0.15p0] PASS: chk_fhan3\n[giac-1.9.0.15p0] FAIL: chk_fhan4\n[giac-1.9.0.15p0] PASS: chk_xavier\n[giac-1.9.0.15p0] PASS: chk_morley_demo\n[giac-1.9.0.15p0] FAIL: chk_fhan6\n[giac-1.9.0.15p0] PASS: chk_limit\n[giac-1.9.0.15p0] FAIL: chk_fhan8\n[giac-1.9.0.15p0] PASS: chk_fhan5\n[giac-1.9.0.15p0] PASS: chk_fhan0\n[giac-1.9.0.15p0] PASS: chk_normalize\n[giac-1.9.0.15p0] FAIL: chk_fhan13\n[giac-1.9.0.15p0] FAIL: chk_fhan12\n[giac-1.9.0.15p0] PASS: chk_fhan14\n[giac-1.9.0.15p0] PASS: chk_fhan1\n[giac-1.9.0.15p0] PASS: chk_fhan15\n[giac-1.9.0.15p0] FAIL: chk_fhan11\n[giac-1.9.0.15p0] PASS: chk_fhan17\n[giac-1.9.0.15p0] PASS: chk_fhan16\n[giac-1.9.0.15p0] PASS: chk_fhan20\n[giac-1.9.0.15p0] PASS: chk_fhan19\n[giac-1.9.0.15p0] PASS: chk_fhan21\n[giac-1.9.0.15p0] FAIL: chk_fhan9\n[giac-1.9.0.15p0] PASS: chk_fhan18\n[giac-1.9.0.15p0] PASS: chk_fhan7\n[giac-1.9.0.15p0] ============================================================================\n[giac-1.9.0.15p0] Testsuite summary for giac 1.9.0\n[giac-1.9.0.15p0] ============================================================================\n[giac-1.9.0.15p0] # TOTAL: 30\n[giac-1.9.0.15p0] # PASS:  22\n[giac-1.9.0.15p0] # SKIP:  0\n[giac-1.9.0.15p0] # XFAIL: 0\n[giac-1.9.0.15p0] # FAIL:  8\n[giac-1.9.0.15p0] # XPASS: 0\n```\n\nhopefully it's just formatting, but needs investigation",
    "created_at": "2022-10-04T10:12:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485888",
    "user": "https://github.com/dimpase"
}
```

I spoke too soon. While Sage tests all pass, some of giac's selftests fail (this is on macOS M1 machine)

```
[giac-1.9.0.15p0] make  check-TESTS
[giac-1.9.0.15p0] PASS: chk_partfrac
[giac-1.9.0.15p0] PASS: chk_factor
[giac-1.9.0.15p0] PASS: chk_integrate
[giac-1.9.0.15p0] PASS: chk_geo
[giac-1.9.0.15p0] FAIL: chk_fhan2
[giac-1.9.0.15p0] PASS: chk_cas
[giac-1.9.0.15p0] PASS: chk_fhan3
[giac-1.9.0.15p0] FAIL: chk_fhan4
[giac-1.9.0.15p0] PASS: chk_xavier
[giac-1.9.0.15p0] PASS: chk_morley_demo
[giac-1.9.0.15p0] FAIL: chk_fhan6
[giac-1.9.0.15p0] PASS: chk_limit
[giac-1.9.0.15p0] FAIL: chk_fhan8
[giac-1.9.0.15p0] PASS: chk_fhan5
[giac-1.9.0.15p0] PASS: chk_fhan0
[giac-1.9.0.15p0] PASS: chk_normalize
[giac-1.9.0.15p0] FAIL: chk_fhan13
[giac-1.9.0.15p0] FAIL: chk_fhan12
[giac-1.9.0.15p0] PASS: chk_fhan14
[giac-1.9.0.15p0] PASS: chk_fhan1
[giac-1.9.0.15p0] PASS: chk_fhan15
[giac-1.9.0.15p0] FAIL: chk_fhan11
[giac-1.9.0.15p0] PASS: chk_fhan17
[giac-1.9.0.15p0] PASS: chk_fhan16
[giac-1.9.0.15p0] PASS: chk_fhan20
[giac-1.9.0.15p0] PASS: chk_fhan19
[giac-1.9.0.15p0] PASS: chk_fhan21
[giac-1.9.0.15p0] FAIL: chk_fhan9
[giac-1.9.0.15p0] PASS: chk_fhan18
[giac-1.9.0.15p0] PASS: chk_fhan7
[giac-1.9.0.15p0] ============================================================================
[giac-1.9.0.15p0] Testsuite summary for giac 1.9.0
[giac-1.9.0.15p0] ============================================================================
[giac-1.9.0.15p0] # TOTAL: 30
[giac-1.9.0.15p0] # PASS:  22
[giac-1.9.0.15p0] # SKIP:  0
[giac-1.9.0.15p0] # XFAIL: 0
[giac-1.9.0.15p0] # FAIL:  8
[giac-1.9.0.15p0] # XPASS: 0
```

hopefully it's just formatting, but needs investigation



---

archive/issue_comments_485889.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2022-10-04T10:12:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485889",
    "user": "https://github.com/dimpase"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_485890.json:
```json
{
    "body": "I'm seeing just one failure, which is a segfault\n\n```\n  ***   the thread stack overflows !\n  current stack size: 1024000 (0.977 Mbytes)\n  [hint] set 'threadsizemax' to a nonzero value in your GPRC\n  *** matdet: Warning: increasing stack size to 2048000.\n  ***   at top-level: matdet([-10,-7,6,-7,1,4,-1,-2,-2,-5,1,7,-6,7,-\n  ***                 ^----------------------------------------------\n  *** matdet: the thread stack overflows !\n  current stack size: 1024000 (0.977 Mbytes)\n  [hint] set 'threadsizemax' to a nonzero value in your GPRC\nError in PARI subsystem\n./chk_fhan4: line 3: 21708 Segmentation fault      (core dumped) ../src/icas TP04-sol.cas > TP04.tst\n```\ncaused by the garbage collection changes in https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=259f62c17c101c380cfed56d303304a13e21ec1e",
    "created_at": "2022-10-04T21:05:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485890",
    "user": "https://github.com/antonio-rojas"
}
```

I'm seeing just one failure, which is a segfault

```
  ***   the thread stack overflows !
  current stack size: 1024000 (0.977 Mbytes)
  [hint] set 'threadsizemax' to a nonzero value in your GPRC
  *** matdet: Warning: increasing stack size to 2048000.
  ***   at top-level: matdet([-10,-7,6,-7,1,4,-1,-2,-2,-5,1,7,-6,7,-
  ***                 ^----------------------------------------------
  *** matdet: the thread stack overflows !
  current stack size: 1024000 (0.977 Mbytes)
  [hint] set 'threadsizemax' to a nonzero value in your GPRC
Error in PARI subsystem
./chk_fhan4: line 3: 21708 Segmentation fault      (core dumped) ../src/icas TP04-sol.cas > TP04.tst
```
caused by the garbage collection changes in https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commitdiff;h=259f62c17c101c380cfed56d303304a13e21ec1e



---

archive/issue_comments_485891.json:
```json
{
    "body": "I see this segfault too. Does setting `threadsizemax` in `~/.gprc` help?",
    "created_at": "2022-10-04T21:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485891",
    "user": "https://github.com/dimpase"
}
```

I see this segfault too. Does setting `threadsizemax` in `~/.gprc` help?



---

archive/issue_comments_485892.json:
```json
{
    "body": "Dima, as noted at #32785#comment:7, it is not new that `giac` fails its test suite, at least on OS X machines. On Intel (old version of `giac` and `pari`):\n\n```\nPASS: chk_partfrac\nPASS: chk_fhan3\nPASS: chk_factor\nFAIL: chk_fhan2\nPASS: chk_geo\nPASS: chk_integrate\nPASS: chk_fhan0\nPASS: chk_cas\nPASS: chk_fhan5\nPASS: chk_fhan13\nPASS: chk_fhan12\nPASS: chk_fhan14\nPASS: chk_fhan15\nPASS: chk_fhan17\nPASS: chk_fhan6\nPASS: chk_fhan19\nPASS: chk_fhan16\nPASS: chk_fhan20\nPASS: chk_fhan21\nFAIL: chk_fhan9\nPASS: chk_fhan18\nPASS: chk_fhan7\nPASS: chk_xavier\nPASS: chk_morley_demo\nPASS: chk_limit\nPASS: chk_fhan11\nPASS: chk_fhan8\nPASS: chk_fhan4\nPASS: chk_fhan1\nPASS: chk_normalize\n```\nI'll try on an m2 machine later, to see what failures I get.",
    "created_at": "2022-10-04T21:59:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485892",
    "user": "https://github.com/jhpalmieri"
}
```

Dima, as noted at #32785#comment:7, it is not new that `giac` fails its test suite, at least on OS X machines. On Intel (old version of `giac` and `pari`):

```
PASS: chk_partfrac
PASS: chk_fhan3
PASS: chk_factor
FAIL: chk_fhan2
PASS: chk_geo
PASS: chk_integrate
PASS: chk_fhan0
PASS: chk_cas
PASS: chk_fhan5
PASS: chk_fhan13
PASS: chk_fhan12
PASS: chk_fhan14
PASS: chk_fhan15
PASS: chk_fhan17
PASS: chk_fhan6
PASS: chk_fhan19
PASS: chk_fhan16
PASS: chk_fhan20
PASS: chk_fhan21
FAIL: chk_fhan9
PASS: chk_fhan18
PASS: chk_fhan7
PASS: chk_xavier
PASS: chk_morley_demo
PASS: chk_limit
PASS: chk_fhan11
PASS: chk_fhan8
PASS: chk_fhan4
PASS: chk_fhan1
PASS: chk_normalize
```
I'll try on an m2 machine later, to see what failures I get.



---

archive/issue_comments_485893.json:
```json
{
    "body": "ok, thus it is not much of a regression.",
    "created_at": "2022-10-04T22:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485893",
    "user": "https://github.com/dimpase"
}
```

ok, thus it is not much of a regression.



---

archive/issue_comments_485894.json:
```json
{
    "body": "By the way, should #34496 really be a dependency, or is the point of this ticket to be able to bypass the problem of building with the newest `pari`?",
    "created_at": "2022-10-04T23:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485894",
    "user": "https://github.com/jhpalmieri"
}
```

By the way, should #34496 really be a dependency, or is the point of this ticket to be able to bypass the problem of building with the newest `pari`?



---

archive/issue_comments_485895.json:
```json
{
    "body": "Replying to [comment:67 John Palmieri]:\n> By the way, should #34496 really be a dependency, or is the point of this ticket to be able to bypass the problem of building with the newest `pari`?\n\n\n#34496 added a useful tweak to spkg-configure of pari, and so we build up on it.",
    "created_at": "2022-10-05T10:28:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485895",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:67 John Palmieri]:
> By the way, should #34496 really be a dependency, or is the point of this ticket to be able to bypass the problem of building with the newest `pari`?


#34496 added a useful tweak to spkg-configure of pari, and so we build up on it.



---

archive/issue_comments_485896.json:
```json
{
    "body": "I'm not going to be able to check test suite failures with the old `pari`/`giac` on Apple M2 until Friday.",
    "created_at": "2022-10-05T15:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485896",
    "user": "https://github.com/jhpalmieri"
}
```

I'm not going to be able to check test suite failures with the old `pari`/`giac` on Apple M2 until Friday.



---

archive/issue_comments_485897.json:
```json
{
    "body": "On Apple M2, the old pari and the old giac give these results in giac's test suite:\n\n```\nmake  check-TESTS\nPASS: chk_partfrac\nPASS: chk_factor\nPASS: chk_integrate\nPASS: chk_geo\nPASS: chk_cas\nPASS: chk_limit\nFAIL: chk_fhan2\nPASS: chk_xavier\nPASS: chk_morley_demo\nPASS: chk_fhan3\nPASS: chk_normalize\nFAIL: chk_fhan4\nFAIL: chk_fhan6\nFAIL: chk_fhan8\nPASS: chk_fhan5\nPASS: chk_fhan0\nFAIL: chk_fhan13\nFAIL: chk_fhan12\nPASS: chk_fhan1\nPASS: chk_fhan14\nPASS: chk_fhan15\nFAIL: chk_fhan11\nPASS: chk_fhan17\nPASS: chk_fhan16\nPASS: chk_fhan20\nPASS: chk_fhan19\nPASS: chk_fhan21\nFAIL: chk_fhan9\nPASS: chk_fhan18\nPASS: chk_fhan7\n```",
    "created_at": "2022-10-07T21:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485897",
    "user": "https://github.com/jhpalmieri"
}
```

On Apple M2, the old pari and the old giac give these results in giac's test suite:

```
make  check-TESTS
PASS: chk_partfrac
PASS: chk_factor
PASS: chk_integrate
PASS: chk_geo
PASS: chk_cas
PASS: chk_limit
FAIL: chk_fhan2
PASS: chk_xavier
PASS: chk_morley_demo
PASS: chk_fhan3
PASS: chk_normalize
FAIL: chk_fhan4
FAIL: chk_fhan6
FAIL: chk_fhan8
PASS: chk_fhan5
PASS: chk_fhan0
FAIL: chk_fhan13
FAIL: chk_fhan12
PASS: chk_fhan1
PASS: chk_fhan14
PASS: chk_fhan15
FAIL: chk_fhan11
PASS: chk_fhan17
PASS: chk_fhan16
PASS: chk_fhan20
PASS: chk_fhan19
PASS: chk_fhan21
FAIL: chk_fhan9
PASS: chk_fhan18
PASS: chk_fhan7
```



---

archive/issue_comments_485898.json:
```json
{
    "body": "Looks like the same failures that Dima saw, so not a regression. I don't think it should be an obstacle to this ticket.",
    "created_at": "2022-10-07T21:56:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485898",
    "user": "https://github.com/jhpalmieri"
}
```

Looks like the same failures that Dima saw, so not a regression. I don't think it should be an obstacle to this ticket.



---

archive/issue_comments_485899.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2022-10-08T20:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485899",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_485900.json:
```json
{
    "body": "OK, thanks. Back to positive.",
    "created_at": "2022-10-08T20:28:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485900",
    "user": "https://github.com/dimpase"
}
```

OK, thanks. Back to positive.



---

archive/issue_comments_485901.json:
```json
{
    "body": "The cypari testsuite fails on OSX (intel), worked before\n\n```\nSuccessfully installed cypari2-2.1.2\n\nreal    1m45.872s\nuser    1m35.524s\nsys     0m9.197s\nCopying package files from temporary location /Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/var/tmp/sage/build/cypari-2.1.2/inst to /Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5\nRunning the test suite for cypari-2.1.2...\nulimit -s 8192; python3 -u tests/rundoctest.py\n================================================================================\nTesting cypari2.closure\n**********************************************************************\nFile \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/lib/python3.10/site-packages/cypari2/closure.cpython-310-darwin.so\", line ?, in cypari2.closure.__test__.objtoclosure (line 145)\nFailed example:\n    mul([1], [2])\nDifferences (ndiff with -expected +actual):\n      Traceback (most recent call last):\n    - ...\n    - PariError: call_python: forbidden multiplication t_VEC (1 elts) * t_VEC (1 elts)\n    +   File \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/lib/python3.10/doctest.py\", line 1350, in __run\n    +     exec(compile(example.source, filename, \"single\",\n    +   File \"<doctest cypari2.closure.__test__.objtoclosure (line 145)[18]>\", line 1, in <module>\n    +     mul([1], [2])\n    +   File \"cypari2/gen.pyx\", line 4110, in cypari2.gen.Gen.__call__\n    +     sig_on()\n    +   File \"cypari2/handle_error.pyx\", line 213, in cypari2.handle_error._pari_err_handle\n    +     raise PariError(errnum, pari_error_string, clone_gen_noclear(E))\n    + PariError: call_python: incorrect type in qfbcomp (t_VEC)\n**********************************************************************\nFile \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/lib/python3.10/site-packages/cypari2/closure.cpython-310-darwin.so\", line ?, in cypari2.closure.objtoclosure\nFailed example:\n    mul([1], [2])\nDifferences (ndiff with -expected +actual):\n      Traceback (most recent call last):\n    - ...\n    - PariError: call_python: forbidden multiplication t_VEC (1 elts) * t_VEC (1 elts)\n    +   File \"/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/lib/python3.10/doctest.py\", line 1350, in __run\n    +     exec(compile(example.source, filename, \"single\",\n    +   File \"<doctest cypari2.closure.objtoclosure[18]>\", line 1, in <module>\n    +     mul([1], [2])\n    +   File \"cypari2/gen.pyx\", line 4110, in cypari2.gen.Gen.__call__\n    +     sig_on()\n    +   File \"cypari2/handle_error.pyx\", line 213, in cypari2.handle_error._pari_err_handle\n    +     raise PariError(errnum, pari_error_string, clone_gen_noclear(E))\n    + PariError: call_python: incorrect type in qfbcomp (t_VEC)\n**********************************************************************\n```",
    "created_at": "2022-10-10T22:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485901",
    "user": "https://github.com/vbraun"
}
```

The cypari testsuite fails on OSX (intel), worked before

```
Successfully installed cypari2-2.1.2

real    1m45.872s
user    1m35.524s
sys     0m9.197s
Copying package files from temporary location /Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/var/tmp/sage/build/cypari-2.1.2/inst to /Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5
Running the test suite for cypari-2.1.2...
ulimit -s 8192; python3 -u tests/rundoctest.py
================================================================================
Testing cypari2.closure
**********************************************************************
File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/lib/python3.10/site-packages/cypari2/closure.cpython-310-darwin.so", line ?, in cypari2.closure.__test__.objtoclosure (line 145)
Failed example:
    mul([1], [2])
Differences (ndiff with -expected +actual):
      Traceback (most recent call last):
    - ...
    - PariError: call_python: forbidden multiplication t_VEC (1 elts) * t_VEC (1 elts)
    +   File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/lib/python3.10/doctest.py", line 1350, in __run
    +     exec(compile(example.source, filename, "single",
    +   File "<doctest cypari2.closure.__test__.objtoclosure (line 145)[18]>", line 1, in <module>
    +     mul([1], [2])
    +   File "cypari2/gen.pyx", line 4110, in cypari2.gen.Gen.__call__
    +     sig_on()
    +   File "cypari2/handle_error.pyx", line 213, in cypari2.handle_error._pari_err_handle
    +     raise PariError(errnum, pari_error_string, clone_gen_noclear(E))
    + PariError: call_python: incorrect type in qfbcomp (t_VEC)
**********************************************************************
File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/lib/python3.10/site-packages/cypari2/closure.cpython-310-darwin.so", line ?, in cypari2.closure.objtoclosure
Failed example:
    mul([1], [2])
Differences (ndiff with -expected +actual):
      Traceback (most recent call last):
    - ...
    - PariError: call_python: forbidden multiplication t_VEC (1 elts) * t_VEC (1 elts)
    +   File "/Users/buildbot-sage/worker/sage_git/build/local/var/lib/sage/venv-python3.10.5/lib/python3.10/doctest.py", line 1350, in __run
    +     exec(compile(example.source, filename, "single",
    +   File "<doctest cypari2.closure.objtoclosure[18]>", line 1, in <module>
    +     mul([1], [2])
    +   File "cypari2/gen.pyx", line 4110, in cypari2.gen.Gen.__call__
    +     sig_on()
    +   File "cypari2/handle_error.pyx", line 213, in cypari2.handle_error._pari_err_handle
    +     raise PariError(errnum, pari_error_string, clone_gen_noclear(E))
    + PariError: call_python: incorrect type in qfbcomp (t_VEC)
**********************************************************************
```



---

archive/issue_comments_485902.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-10-10T22:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485902",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_485903.json:
```json
{
    "body": "Replying to [comment:74 Volker Braun]:\n> The cypari testsuite fails on OSX (intel), worked before\n> \n> ```\n> ...\n> ```\n\n\nThe error message indeed changed in PARI 2.15. Should that really block this ticket? Otherwise, we do have to upgrade cypari2 at the same time.",
    "created_at": "2022-10-10T22:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485903",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:74 Volker Braun]:
> The cypari testsuite fails on OSX (intel), worked before
> 
> ```
> ...
> ```


The error message indeed changed in PARI 2.15. Should that really block this ticket? Otherwise, we do have to upgrade cypari2 at the same time.



---

archive/issue_comments_485904.json:
```json
{
    "body": "The (cy)pari testsuite is generally pretty solid so I'd hate to have to permanently disable it on the buildbot",
    "created_at": "2022-10-11T09:14:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485904",
    "user": "https://github.com/vbraun"
}
```

The (cy)pari testsuite is generally pretty solid so I'd hate to have to permanently disable it on the buildbot



---

archive/issue_comments_485905.json:
```json
{
    "body": "Here is an explanation for the cypari error:\nhttps://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1020456#10",
    "created_at": "2022-10-14T17:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485905",
    "user": "https://github.com/tobihan"
}
```

Here is an explanation for the cypari error:
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1020456#10



---

archive/issue_comments_485906.json:
```json
{
    "body": "Replying to [comment:77 Tobias Hansen]:\n> Here is an explanation for the cypari error:\n> https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1020456#10\n\nreport to upstream:  https://github.com/sagemath/cypari2/issues/122",
    "created_at": "2022-10-17T10:53:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485906",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:77 Tobias Hansen]:
> Here is an explanation for the cypari error:
> https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1020456#10

report to upstream:  https://github.com/sagemath/cypari2/issues/122



---

archive/issue_comments_485907.json:
```json
{
    "body": "I have cypari2 pass all tests on pari-2.15 using\n- patch on pari: https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commit;h=9c4bcd3f497f30f757c8eecadc9b45b33754a540 (just remove the first hunk patching the file `CHANGES` since it will not apply otherwise)\n- patch on cypari2: https://github.com/sagemath/cypari2/pull/123",
    "created_at": "2022-10-30T21:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485907",
    "user": "https://github.com/tornaria"
}
```

I have cypari2 pass all tests on pari-2.15 using
- patch on pari: https://pari.math.u-bordeaux.fr/cgi-bin/gitweb.cgi?p=pari.git;a=commit;h=9c4bcd3f497f30f757c8eecadc9b45b33754a540 (just remove the first hunk patching the file `CHANGES` since it will not apply otherwise)
- patch on cypari2: https://github.com/sagemath/cypari2/pull/123



---

archive/issue_comments_485908.json:
```json
{
    "body": "pari 2.15.1 is out, see https://pari.math.u-bordeaux.fr/archives/pari-announce-22/msg00002.html",
    "created_at": "2022-11-10T23:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485908",
    "user": "https://github.com/dimpase"
}
```

pari 2.15.1 is out, see https://pari.math.u-bordeaux.fr/archives/pari-announce-22/msg00002.html



---

archive/issue_comments_485909.json:
```json
{
    "body": "Replying to [comment:80 Dima Pasechnik]:\n> pari 2.15.1 is out, see https://pari.math.u-bordeaux.fr/archives/pari-announce-22/msg00002.html\n\n\nPari 2.15.1 includes the fix I cherry picked in my last comment.\n\nThe current HEAD of cypari2 already fied testsuite passes on pari 2.15, and Vincent said he will do a release soon.\n\nIt would be very nice if this can be merged for 9.8.",
    "created_at": "2022-11-10T23:55:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485909",
    "user": "https://github.com/tornaria"
}
```

Replying to [comment:80 Dima Pasechnik]:
> pari 2.15.1 is out, see https://pari.math.u-bordeaux.fr/archives/pari-announce-22/msg00002.html


Pari 2.15.1 includes the fix I cherry picked in my last comment.

The current HEAD of cypari2 already fied testsuite passes on pari 2.15, and Vincent said he will do a release soon.

It would be very nice if this can be merged for 9.8.



---

archive/issue_comments_485910.json:
```json
{
    "body": "Also, giac 1.9.0.29 builds fine against 2.15 without patching.",
    "created_at": "2022-11-11T06:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485910",
    "user": "https://github.com/antonio-rojas"
}
```

Also, giac 1.9.0.29 builds fine against 2.15 without patching.



---

archive/issue_comments_485911.json:
```json
{
    "body": "Replying to [comment:82 Antonio Rojas]:\n> Also, giac 1.9.0.29 builds fine against 2.15 without patching.\n\n\ndo you want giac updated here, or on another ticket?",
    "created_at": "2022-11-11T15:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485911",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:82 Antonio Rojas]:
> Also, giac 1.9.0.29 builds fine against 2.15 without patching.


do you want giac updated here, or on another ticket?



---

archive/issue_comments_485912.json:
```json
{
    "body": "cypari2 upgrade in #33878",
    "created_at": "2022-11-11T18:53:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485912",
    "user": "https://github.com/mkoeppe"
}
```

cypari2 upgrade in #33878



---

archive/issue_comments_485913.json:
```json
{
    "body": "Replying to [comment:83 Dima Pasechnik]:\n> do you want giac updated here, or on another ticket?\n\n\nI don't personally mind, was just pointing out the possibility of updating giac instead of patching. Can this go back to needs_review now?",
    "created_at": "2022-11-24T21:13:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485913",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:83 Dima Pasechnik]:
> do you want giac updated here, or on another ticket?


I don't personally mind, was just pointing out the possibility of updating giac instead of patching. Can this go back to needs_review now?



---

archive/issue_comments_485914.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-11-24T21:33:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485914",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_485915.json:
```json
{
    "body": "The title of the ticket says that we're upgrading to 2.15.1, but the branch only goes to 2.15.0.",
    "created_at": "2022-11-29T19:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485915",
    "user": "https://github.com/jhpalmieri"
}
```

The title of the ticket says that we're upgrading to 2.15.1, but the branch only goes to 2.15.0.



---

archive/issue_comments_485916.json:
```json
{
    "body": "Oh, right, I tested with Homebrew's pari, and Gentoo's pari (they are both 2.15.1), and forgot to bump this branch.",
    "created_at": "2022-11-29T20:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485916",
    "user": "https://github.com/dimpase"
}
```

Oh, right, I tested with Homebrew's pari, and Gentoo's pari (they are both 2.15.1), and forgot to bump this branch.



---

archive/issue_comments_485917.json:
```json
{
    "body": "OK, readly now\n\n---\nLast 10 new commits:",
    "created_at": "2022-11-29T20:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485917",
    "user": "https://github.com/dimpase"
}
```

OK, readly now

---
Last 10 new commits:



---

archive/issue_comments_485918.json:
```json
{
    "body": "rebased over 9.8.beta4",
    "created_at": "2022-11-29T20:34:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485918",
    "user": "https://github.com/dimpase"
}
```

rebased over 9.8.beta4



---

archive/issue_comments_485919.json:
```json
{
    "body": "On OS X Intel, the basic functionality is there (i.e., Sage builds and `make ptestlong` works), but the test suite for pari hangs. I see this in the log file, with no changes in more than an hour:\n\n```\n: gp-sta\n* Testing addprimes        gp-sta..TIME=    8   gp-dyn..TIME=    8   \n* Testing agm              gp-sta..TIME=   65   gp-dyn..TIME=   59   \n* Testing algebras         gp-sta..TIME= 1490   gp-dyn..TIME= 1481   \n* Testing alggroup         gp-sta..TIME=  661   gp-dyn..TIME=  651   \n* Testing alghasse         gp-sta..TIME= 2701   gp-dyn..TIME= 2523   \n* Testing alglattices      gp-sta..TIME= 1153   gp-dyn..TIME= 1150   \n* Testing algsplit         gp-sta..TIME=  946   gp-dyn..TIME= 1139   \n* Testing analyz           gp-sta..TIME=   22   gp-dyn..TIME=   20   \n* Testing apply            gp-sta..TIME=    1   gp-dyn..TIME=    1   \n* Testing arith            gp-sta..TIME=    0   gp-dyn..TIME=    0   \n* Testing asymp            gp-sta..TIME=  129   gp-dyn..TIME=  117   \n* Testing aurifeuille      gp-sta..TIME=    1   gp-dyn..TIME=    1   \n* Testing bbhnf            gp-sta..TIME=  959   gp-dyn..TIME=  918   \n* Testing bern             gp-sta..TIME=13627   gp-dyn..TIME=13270   \n* Testing bessel           gp-sta..TIME=  177   gp-dyn..TIME=  170   \n* Testing bestappr         gp-sta..TIME=    1   gp-dyn..TIME=    1   \n* Testing binomial         gp-sta..TIME=  240   gp-dyn..TIME=  243   \n* Testing bit              gp-sta..TIME=    1   gp-dyn..TIME=    1   \n* Testing bnf              gp-sta..TIME=31168   gp-dyn..TIME=31762   \n* Testing bnfisintnorm     gp-sta..TIME=  504   gp-dyn..TIME=  506   \n* Testing bnflog           \n```\nThis is after running `export SAGE_CHECK=yes` and `make pari`.",
    "created_at": "2022-11-30T00:47:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485919",
    "user": "https://github.com/jhpalmieri"
}
```

On OS X Intel, the basic functionality is there (i.e., Sage builds and `make ptestlong` works), but the test suite for pari hangs. I see this in the log file, with no changes in more than an hour:

```
: gp-sta
* Testing addprimes        gp-sta..TIME=    8   gp-dyn..TIME=    8   
* Testing agm              gp-sta..TIME=   65   gp-dyn..TIME=   59   
* Testing algebras         gp-sta..TIME= 1490   gp-dyn..TIME= 1481   
* Testing alggroup         gp-sta..TIME=  661   gp-dyn..TIME=  651   
* Testing alghasse         gp-sta..TIME= 2701   gp-dyn..TIME= 2523   
* Testing alglattices      gp-sta..TIME= 1153   gp-dyn..TIME= 1150   
* Testing algsplit         gp-sta..TIME=  946   gp-dyn..TIME= 1139   
* Testing analyz           gp-sta..TIME=   22   gp-dyn..TIME=   20   
* Testing apply            gp-sta..TIME=    1   gp-dyn..TIME=    1   
* Testing arith            gp-sta..TIME=    0   gp-dyn..TIME=    0   
* Testing asymp            gp-sta..TIME=  129   gp-dyn..TIME=  117   
* Testing aurifeuille      gp-sta..TIME=    1   gp-dyn..TIME=    1   
* Testing bbhnf            gp-sta..TIME=  959   gp-dyn..TIME=  918   
* Testing bern             gp-sta..TIME=13627   gp-dyn..TIME=13270   
* Testing bessel           gp-sta..TIME=  177   gp-dyn..TIME=  170   
* Testing bestappr         gp-sta..TIME=    1   gp-dyn..TIME=    1   
* Testing binomial         gp-sta..TIME=  240   gp-dyn..TIME=  243   
* Testing bit              gp-sta..TIME=    1   gp-dyn..TIME=    1   
* Testing bnf              gp-sta..TIME=31168   gp-dyn..TIME=31762   
* Testing bnfisintnorm     gp-sta..TIME=  504   gp-dyn..TIME=  506   
* Testing bnflog           
```
This is after running `export SAGE_CHECK=yes` and `make pari`.



---

archive/issue_comments_485920.json:
```json
{
    "body": "I seem to get the same thing with the previous version of `pari`. I'm trying again and I will update later.",
    "created_at": "2022-11-30T06:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485920",
    "user": "https://github.com/jhpalmieri"
}
```

I seem to get the same thing with the previous version of `pari`. I'm trying again and I will update later.



---

archive/issue_comments_485921.json:
```json
{
    "body": "perhaps upstream does not test with macOS at all, or perhaps only with old versions, and not 13.0 ?",
    "created_at": "2022-11-30T07:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485921",
    "user": "https://github.com/dimpase"
}
```

perhaps upstream does not test with macOS at all, or perhaps only with old versions, and not 13.0 ?



---

archive/issue_comments_485922.json:
```json
{
    "body": "Right, I get the same with the previous version of `pari`, so this failure should not hold up this ticket.",
    "created_at": "2022-11-30T16:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485922",
    "user": "https://github.com/jhpalmieri"
}
```

Right, I get the same with the previous version of `pari`, so this failure should not hold up this ticket.



---

archive/issue_comments_485923.json:
```json
{
    "body": "On Apple Silicon, both the old and new `pari` pass their test suites.",
    "created_at": "2022-11-30T17:32:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485923",
    "user": "https://github.com/jhpalmieri"
}
```

On Apple Silicon, both the old and new `pari` pass their test suites.



---

archive/issue_comments_485924.json:
```json
{
    "body": "Many of the changes in doctests look fine to me, but I can't vouch for all of them. Can other people check them? (One example is the change in sage/schemes/elliptic_curves/ell_field.py, although there are others. Looks plausible but I don't know the details.)",
    "created_at": "2022-11-30T19:20:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485924",
    "user": "https://github.com/jhpalmieri"
}
```

Many of the changes in doctests look fine to me, but I can't vouch for all of them. Can other people check them? (One example is the change in sage/schemes/elliptic_curves/ell_field.py, although there are others. Looks plausible but I don't know the details.)



---

archive/issue_comments_485925.json:
```json
{
    "body": "John C., can you have a look ?",
    "created_at": "2022-12-07T18:01:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485925",
    "user": "https://github.com/dimpase"
}
```

John C., can you have a look ?



---

archive/issue_comments_485926.json:
```json
{
    "body": "Replying to [comment:97 Dima Pasechnik]:\n> John C., can you have a look ?\n\nSorry, only jut noticed this -- will do today.",
    "created_at": "2022-12-09T11:25:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485926",
    "user": "https://github.com/JohnCremona"
}
```

Replying to [comment:97 Dima Pasechnik]:
> John C., can you have a look ?

Sorry, only jut noticed this -- will do today.



---

archive/issue_comments_485927.json:
```json
{
    "body": "genus2reduction: makes sense for our doctests to just have y^2 = ... since these reductions are not unique. The most important thing is for the minimal discriminant to be correct which we do check.\n\ncusps_nf: OK\n\nlfunctions/*: OK\n\nlibs/pari/tests: OK\n\nS_unit_solver: OK\n\nnumber_field/*: OK\n\npolynomial/*: OK\n\nQQbar: looks reasonable, would take ages to rigorously check everything\n\nelliptic_curves/\nell_field: OK (the two fields are isomorphic)\nell_generic: OK (0 is displayed differently)\n\nell_number_field: (1) the first simon_two_descent test in the diffs is strange as E is defined by EllipticCurve(K, '37') where K is a number field; the resulting curve is the one with label '37a1'.  Would you believe tat I had never noticed that the function parse_cremona_label() was happy both to have the curve number default to 1 (which I knew) and also the isogeny class letter code default to 'a'?  Fine, it is documented, but one day I'll change that '37' to '37a1' to be less obscure.\n(2) the different matrices are OK since the rows/cols will be permuted if the curves in the class are sorted differently; the docstring (written by me) says \"The curves in the class are sorted first by CM discriminant (then lexicographically using\na-invariants)\" which can lead to differences, either because the field generator changes or because the choice of minimal reduced model (and hence the a-invariants) is not deterministic.  One day I'll implement the LMFDB way of sorting curves in the class.\n\nThe rest of the elliptic curves stuff is fine.\n\nNote that we no longer need, and could deprecate, the simon_two_descent() method for curves over QQ, since the pari ellrank() function will always be better (being a C implementation with a lot of extra geatures of the same underlying theory).  But this is *not* the case for that methof for curves over number fields, at present.  And for a similar reason the rank() method for elliptic curves over Q (and related methods such as gens()) should definitely now have an 'algorithm=pari' option now which calls ellrank().  It's also probably true that it should be the default, for curves not in the database, as it is extremely good (=fast and good at finding generators).  But not on this ticket.\n\nI looked at mst of the files, and all the ones where I thought my expertise would be helpful.  Looks good!",
    "created_at": "2022-12-09T12:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485927",
    "user": "https://github.com/JohnCremona"
}
```

genus2reduction: makes sense for our doctests to just have y^2 = ... since these reductions are not unique. The most important thing is for the minimal discriminant to be correct which we do check.

cusps_nf: OK

lfunctions/*: OK

libs/pari/tests: OK

S_unit_solver: OK

number_field/*: OK

polynomial/*: OK

QQbar: looks reasonable, would take ages to rigorously check everything

elliptic_curves/
ell_field: OK (the two fields are isomorphic)
ell_generic: OK (0 is displayed differently)

ell_number_field: (1) the first simon_two_descent test in the diffs is strange as E is defined by EllipticCurve(K, '37') where K is a number field; the resulting curve is the one with label '37a1'.  Would you believe tat I had never noticed that the function parse_cremona_label() was happy both to have the curve number default to 1 (which I knew) and also the isogeny class letter code default to 'a'?  Fine, it is documented, but one day I'll change that '37' to '37a1' to be less obscure.
(2) the different matrices are OK since the rows/cols will be permuted if the curves in the class are sorted differently; the docstring (written by me) says "The curves in the class are sorted first by CM discriminant (then lexicographically using
a-invariants)" which can lead to differences, either because the field generator changes or because the choice of minimal reduced model (and hence the a-invariants) is not deterministic.  One day I'll implement the LMFDB way of sorting curves in the class.

The rest of the elliptic curves stuff is fine.

Note that we no longer need, and could deprecate, the simon_two_descent() method for curves over QQ, since the pari ellrank() function will always be better (being a C implementation with a lot of extra geatures of the same underlying theory).  But this is *not* the case for that methof for curves over number fields, at present.  And for a similar reason the rank() method for elliptic curves over Q (and related methods such as gens()) should definitely now have an 'algorithm=pari' option now which calls ellrank().  It's also probably true that it should be the default, for curves not in the database, as it is extremely good (=fast and good at finding generators).  But not on this ticket.

I looked at mst of the files, and all the ones where I thought my expertise would be helpful.  Looks good!



---

archive/issue_comments_485928.json:
```json
{
    "body": "Thanks John, I take your long review as OK.",
    "created_at": "2022-12-09T13:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485928",
    "user": "https://github.com/dimpase"
}
```

Thanks John, I take your long review as OK.



---

archive/issue_comments_485929.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-12-09T13:00:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485929",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_485930.json:
```json
{
    "body": "Replying to [comment:100 Dima Pasechnik]:\n> Thanks John, I take your long review as OK.\n\n\nyes!",
    "created_at": "2022-12-09T14:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485930",
    "user": "https://github.com/JohnCremona"
}
```

Replying to [comment:100 Dima Pasechnik]:
> Thanks John, I take your long review as OK.


yes!



---

archive/issue_comments_485931.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-12-18T11:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485931",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_485932.json:
```json
{
    "body": "There are a bunch of numerical noise issues on 32-bit:\n\n```\n**********************************************************************\nFile \"src/sage/calculus/calculus.py\", line 242, in sage.calculus.calculus\nFailed example:\n    float(z)\nExpected:\n    4.646783762432936\nGot:\n    4.646783762432935\n**********************************************************************\nFile \"src/sage/calculus/calculus.py\", line 772, in sage.calculus.calculus.?\nFailed example:\n    float(f)\nExpected:\n    -480.0\nGot:\n    -2336.0\n**********************************************************************\nFile \"src/sage/calculus/calculus.py\", line 784, in sage.calculus.calculus.?\nFailed example:\n    f.nintegrate(x,0,1)\nExpected:\n    (-480.0000000000001, 5.32907051820075...e-12, 21, 0)\nGot:\n    (-831.9999999999999, 9.237055564881304e-12, 21, 0)\n**********************************************************************\n2 items had failures:\n   1 of 118 in sage.calculus.calculus\n   2 of  15 in sage.calculus.calculus.?\n    [457 tests, 3 failures, 19.44 s]\n**********************************************************************\nFile \"src/sage/calculus/wester.py\", line 283, in sage.calculus.wester\nFailed example:\n    float(a)\nExpected:\n    1.1368683772...e-13\nGot:\n    0.0\n**********************************************************************\n1 item had failures:\n   1 of 202 in sage.calculus.wester\n    [201 tests, 1 failure, 2.45 s]\n**********************************************************************\nFile \"src/sage/categories/finite_coxeter_groups.py\", line 705, in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron\nFailed example:\n    W.permutahedron()\nException raised:\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/doctest/forker.py\", line 695, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/doctest/forker.py\", line 1093, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron[1]>\", line 1, in <module>\n        W.permutahedron()\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/categories/finite_coxeter_groups.py\", line 755, in permutahedron\n        return Polyhedron(vertices=vertices, base_ring=base_ring)\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/constructor.py\", line 759, in Polyhedron\n        return parent(Vrep, Hrep, convert=convert, verbose=verbose, mutable=mutable)\n      File \"sage/structure/parent.pyx\", line 898, in sage.structure.parent.Parent.__call__\n        return mor._call_with_args(x, args, kwds)\n      File \"sage/structure/coerce_maps.pyx\", line 180, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_with_args\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 175, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_with_args\n        return C._element_constructor(x, *args, **kwds)\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/parent.py\", line 684, in _element_constructor_\n        return self.element_class(self, Vrep, Hrep, **kwds)\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/backend_cdd_rdf.py\", line 98, in __init__\n        Polyhedron_cdd.__init__(self, parent, Vrep, Hrep, **kwds)\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/base0.py\", line 174, in __init__\n        self._init_from_Vrepresentation(vertices, rays, lines, **kwds)\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/backend_cdd.py\", line 65, in _init_from_Vrepresentation\n        s = self._run_cdd(s, '--repall', verbose=verbose)\n      File \"/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/backend_cdd.py\", line 172, in _run_cdd\n        raise ValueError(ans.strip())\n    ValueError: *Error: Numerical inconsistency is found.  Use the GMP exact arithmetic.\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron\n    [151 tests, 1 failure, 4.74 s]\n**********************************************************************\nFile \"src/sage/dynamics/complex_dynamics/mandel_julia_helper.pyx\", line 219, in sage.dynamics.complex_dynamics.mandel_julia_helper.?\nFailed example:\n    fast_external_ray(0,S=1,D=1)\nExpected:\n    [(100.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\n      0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),\n     (9.51254777713729174697578576623132297117784691109499464854806785133621315075854778426714908,\n      0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)]\nGot:\n    [(100.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,\n      0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),\n     (9.51254777713729032775694689466896914675974929808733306327787458869355202130788654602053071,\n      0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)]\n**********************************************************************\nFile \"src/sage/dynamics/complex_dynamics/mandel_julia_helper.pyx\", line 229, in sage.dynamics.complex_dynamics.mandel_julia_helper.?\nFailed example:\n    fast_external_ray(1/3,S=1,D=1)\nExpected:\n    [(-49.9999999999999786837179271969944238662719726562500000000000000000000000000000000000000000,\n      86.6025403784438765342201804742217063903808593750000000000000000000000000000000000000000000),\n     (-5.50628047023173006234970878097113901879832542655926629309001652388544528575532346900138516,\n      8.64947510053972513843999918917106032664030380426885745306040284140385975750462108180377187)]\nGot:\n    [(-49.9999999999999786837179271969944238662719726562500000000000000000000000000000000000000000,\n      86.6025403784438765342201804742217063903808593750000000000000000000000000000000000000000000),\n     (-5.50628047023172980317558651097220813419960642675275525034690583138202683104446159128356526,\n      8.64947510053972416699388454766038069022656677613412868926274778156654918224636699020909555)]\n**********************************************************************\nFile \"src/sage/dynamics/complex_dynamics/mandel_julia_helper.pyx\", line 238, in sage.dynamics.complex_dynamics.mandel_julia_helper.?\nFailed example:\n    fast_external_ray(0.75234,S=1,D=1)\nExpected:\n    [(1.47021239172637052661229972727596759796142578125000000000000000000000000000000000000000000,\n      -99.9891917935294287644865107722580432891845703125000000000000000000000000000000000000000000),\n     (-0.352790406744857508500937144524776555433184352559852962308757189778284058275081335121601384,\n      -9.98646630765023514178761177926164047797465369576787921409326037870837930920646860774032363)]\nGot:\n    [(1.47021239172637052661229972727596759796142578125000000000000000000000000000000000000000000,\n      -99.9891917935294287644865107722580432891845703125000000000000000000000000000000000000000000),\n     (-0.352790406744857531982226711825539675074733886273844201352581335945053660908669195067107961,\n      -9.98646630765023371851343140849138176796542428333725755653082848714206880231557255794864137)]\n**********************************************************************\n1 item had failures:\n   3 of  42 in sage.dynamics.complex_dynamics.mandel_julia_helper.?\n    [43 tests, 3 failures, 5.81 s]\n**********************************************************************\nFile \"src/sage/functions/log.py\", line 45, in sage.functions.log.Function_exp\nFailed example:\n    exp(float(2.5))\nExpected:\n    12.182493960703473\nGot:\n    12.182493960703475\n**********************************************************************\nFile \"src/sage/functions/log.py\", line 47, in sage.functions.log.Function_exp\nFailed example:\n    exp(RDF('2.5'))\nExpected:\n    12.182493960703473\nGot:\n    12.182493960703475\n**********************************************************************\n1 item had failures:\n   2 of  41 in sage.functions.log.Function_exp\n    [281 tests, 2 failures, 4.10 s]\n**********************************************************************\nFile \"src/sage/functions/trig.py\", line 608, in sage.functions.trig.Function_arccos.__init__\nFailed example:\n    acos(complex(1,1))\nExpected:\n    (0.9045568943023814-1.0612750619050357j)\nGot:\n    (0.9045568943023815-1.0612750619050357j)\n**********************************************************************\n1 item had failures:\n   1 of  18 in sage.functions.trig.Function_arccos.__init__\n    [261 tests, 1 failure, 2.37 s]\n**********************************************************************\nFile \"src/sage/geometry/hyperbolic_space/hyperbolic_geodesic.py\", line 2384, in sage.geometry.hyperbolic_space.hyperbolic_geodesic.HyperbolicGeodesicHM._plot_vertices\nFailed example:\n    g._plot_vertices(5)\nExpected:\n    [(4.0, -4.0, 5.744562...),\n     (1.363213..., -1.637073..., 2.353372...),\n     (0.138568..., -0.969980..., 1.400022...),\n     (-0.942533..., -1.307681..., 1.896945...),\n     (-3.0, -3.0, 4.358898...)]\nGot:\n    [(4.0, -4.0, 5.744562646538029),\n     (1.3632131724692087, -1.6370738298435317, 2.3533722353151303),\n     (0.1385685838744788, -0.9699800871213657, 1.4000223647674161),\n     (-0.942533854284406, -1.3076813974501604, 1.8969450977056255),\n     (-3.0, -3.000000000000014, 4.35889894354068)]\n**********************************************************************\n1 item had failures:\n   1 of   6 in sage.geometry.hyperbolic_space.hyperbolic_geodesic.HyperbolicGeodesicHM._plot_vertices\n    [447 tests, 1 failure, 8.67 s]\n**********************************************************************\nFile \"src/sage/interacts/test_jupyter.rst\", line 120, in sage.interacts.test_jupyter\nFailed example:\n    test(interacts.calculus.newton_method)\nExpected:\n    ...Interactive function <function newton_method at ...> with 7 widgets\n      title: HTMLText(value='<h2>Newton method</h2>')\n      f: EvalText(value='x^2 - 2', description='f', layout=Layout(max_width='81em'))\n      c: IntSlider(value=6, description='Start ($x$)', max=10, min=-10)\n      d: IntSlider(value=3, description='$10^{-d}$ precision', max=16, min=1)\n      maxn: IntSlider(value=10, description='max iterations', max=15)\n      interval: IntRangeSlider(value=(0, 6), description='Interval', max=10, min=-10)\n      list_steps: Checkbox(value=False, description='List steps')\n    \\(\\text{Precision } 2h = 0.001\\)\n    \\({c = }1.4142141576301823\\)\n    \\({f(c) = }1.6836416460996873 \\times 10^{-06}\\)\n    \\(6 \\text{ iterations}\\)\nGot:\n    <CSI-2K>\n<CSI-2K>\n\\(\\text{Precision } 2h = 0.0010000000000000002\\)\n    \\({c = }1.4142141576301823\\)\n    \\({f(c) = }1.6836416460996873 \\times 10^{-06}\\)\n    \\(6 \\text{ iterations}\\)\n    Interactive function <function newton_method at 0xa6a181d8> with 7 widgets\n      title: HTMLText(value='<h2>Newton method</h2>')\n      f: EvalText(value='x^2 - 2', description='f', layout=Layout(max_width='81em'))\n      c: IntSlider(value=6, description='Start ($x$)', max=10, min=-10)\n      d: IntSlider(value=3, description='$10^{-d}$ precision', max=16, min=1)\n      maxn: IntSlider(value=10, description='max iterations', max=15)\n      interval: IntRangeSlider(value=(0, 6), description='Interval', max=10, min=-10)\n      list_steps: Checkbox(value=False, description='List steps')\n    \\(\\text{Precision } 2h = 0.0010000000000000002\\)\n    \\({c = }1.4142141576301823\\)\n    \\({f(c) = }1.6836416460996873 \\times 10^{-06}\\)\n    \\(6 \\text{ iterations}\\)\n**********************************************************************\n1 item had failures:\n   1 of  30 in sage.interacts.test_jupyter\n    [29 tests, 1 failure, 70.30 s]\n**********************************************************************\nFile \"src/sage/matrix/matrix_double_dense.pyx\", line 1624, in sage.matrix.matrix_double_dense.Matrix_double_dense.right_eigenvectors\nFailed example:\n    spectrum[3]  # tol 1e-13\nExpected:\n    (-1.0, [(1.0, -0.5, 2.0, 0.5)], 1)\nGot:\n    (-1.0000000000000828,\n     [(1.0, -0.4999999999999238, 1.9999999999997218, 0.4999999999999161)],\n     1)\nTolerance exceeded in 3 of 6:\n    -0.5 vs -0.4999999999999238, tolerance 2e-13 > 1e-13\n    2.0 vs 1.9999999999997218, tolerance 2e-13 > 1e-13\n    0.5 vs 0.4999999999999161, tolerance 2e-13 > 1e-13\n**********************************************************************\n1 item had failures:\n   1 of  24 in sage.matrix.matrix_double_dense.Matrix_double_dense.right_eigenvectors\n    [611 tests, 1 failure, 0.92 s]\n**********************************************************************\nFile \"src/sage/matrix/matrix_symbolic_dense.pyx\", line 441, in sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense.exp\nFailed example:\n    exp(matrix(SR, [[1.2, 5.6], [3,4]])).change_ring(RDF)  # rel tol 1e-15\nExpected:\n    [ 346.5574872980695  661.7345909344504]\n    [354.50067371488416  677.4247827652946]\nGot:\n    [346.55748729806896  661.7345909344492]\n    [354.50067371488353  677.4247827652937]\nTolerance exceeded in 4 of 4:\n    346.5574872980695 vs 346.55748729806896, tolerance 2e-15 > 1e-15\n    661.7345909344504 vs 661.7345909344492, tolerance 2e-15 > 1e-15\n    354.50067371488416 vs 354.50067371488353, tolerance 2e-15 > 1e-15\n    677.4247827652946 vs 677.4247827652937, tolerance 2e-15 > 1e-15\n**********************************************************************\n1 item had failures:\n   1 of  17 in sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense.exp\n    [224 tests, 1 failure, 5.48 s]\n**********************************************************************\nFile \"src/sage/modules/free_module_element.pyx\", line 1687, in sage.modules.free_module_element.FreeModuleElement.norm\nFailed example:\n    v.norm(5)\nExpected:\n    3.077384885394063\nGot:\n    3.0773848853940633\n**********************************************************************\n1 item had failures:\n   1 of  24 in sage.modules.free_module_element.FreeModuleElement.norm\n    [1081 tests, 1 failure, 5.08 s]\n**********************************************************************\nFile \"src/sage/modules/vector_real_double_dense.pyx\", line 7, in sage.modules.vector_real_double_dense\nFailed example:\n    v\nExpected:\n    (1.0, 3.141592653589793, 1.414213562373095)\nGot:\n    (1.0, 3.141592653589793, 1.4142135623730951)\n**********************************************************************\nFile \"src/sage/modules/vector_real_double_dense.pyx\", line 14, in sage.modules.vector_real_double_dense\nFailed example:\n    v\nExpected:\n    (5.0, 3.141592653589793, 1.414213562373095)\nGot:\n    (5.0, 3.141592653589793, 1.4142135623730951)\n**********************************************************************\n1 item had failures:\n   2 of   8 in sage.modules.vector_real_double_dense\n    [19 tests, 2 failures, 10.89 s]\n**********************************************************************\nFile \"src/sage/rings/complex_double.pyx\", line 1136, in sage.rings.complex_double.ComplexDoubleElement._latex_\nFailed example:\n    z._latex_()\nExpected:\n    '-6.443164690985956 \\\\times 10^{34} - 6.113241307762409 \\\\times 10^{34}i'\nGot:\n    '-6.443164690985963 \\\\times 10^{34} - 6.113241307762415 \\\\times 10^{34}i'\n**********************************************************************\nFile \"src/sage/rings/complex_double.pyx\", line 1685, in sage.rings.complex_double.ComplexDoubleElement._pow_\nFailed example:\n    CDF(-0.26319743704743886) ^ -2\nExpected:\n    14.435661446561994\nGot:\n    14.435661446561992\n**********************************************************************\nFile \"src/sage/rings/complex_double.pyx\", line 1936, in sage.rings.complex_double.ComplexDoubleElement.arccos\nFailed example:\n    CDF(1,1).arccos()\nExpected:\n    0.9045568943023814 - 1.0612750619050357*I\nGot:\n    0.9045568943023815 - 1.0612750619050357*I\n**********************************************************************\nFile \"src/sage/rings/complex_double.pyx\", line 2115, in sage.rings.complex_double.ComplexDoubleElement.arccosh\nFailed example:\n    CDF(1,1).arccosh()\nExpected:\n    1.0612750619050357 + 0.9045568943023814*I\nGot:\n    1.0612750619050357 + 0.9045568943023815*I\n**********************************************************************\n4 items had failures:\n   1 of   4 in sage.rings.complex_double.ComplexDoubleElement._latex_\n   1 of  19 in sage.rings.complex_double.ComplexDoubleElement._pow_\n   1 of   2 in sage.rings.complex_double.ComplexDoubleElement.arccos\n   1 of   2 in sage.rings.complex_double.ComplexDoubleElement.arccosh\n    [341 tests, 4 failures, 0.27 s]\n**********************************************************************\nFile \"src/sage/rings/complex_mpc.pyx\", line 1524, in sage.rings.complex_mpc.MPComplexNumber.__abs__\nFailed example:\n    float(sqrt(2^2 + 1^1))\nExpected:\n    2.23606797749979\nGot:\n    2.2360679774997894\n**********************************************************************\n1 item had failures:\n   1 of  10 in sage.rings.complex_mpc.MPComplexNumber.__abs__\n    [410 tests, 1 failure, 0.21 s]\n**********************************************************************\nFile \"src/sage/rings/complex_mpfr.pyx\", line 1885, in sage.rings.complex_mpfr.ComplexNumber.__abs__\nFailed example:\n    float(sqrt(2^2 + 1^1))\nExpected:\n    2.23606797749979\nGot:\n    2.2360679774997894\n**********************************************************************\n1 item had failures:\n   1 of   9 in sage.rings.complex_mpfr.ComplexNumber.__abs__\n    [539 tests, 1 failure, 1.78 s]\n**********************************************************************\nFile \"src/sage/rings/number_field/number_field_element.pyx\", line 1640, in sage.rings.number_field.number_field_element.NumberFieldElement.is_norm\nFailed example:\n    t = (-a).is_norm(L, element=True); t\nExpected:\n    (True, -b^3 - 1)\nGot:\n    (True, b^3 - 1)\n**********************************************************************\nFile \"src/sage/rings/number_field/number_field_element.pyx\", line 1755, in sage.rings.number_field.number_field_element.NumberFieldElement._rnfisnorm\nFailed example:\n    t = (-a)._rnfisnorm(L); t\nExpected:\n    (-b^3 - 1, 1)\nGot:\n    (b^3 - 1, 1)\n**********************************************************************\nFile \"src/sage/rings/number_field/number_field_element.pyx\", line 1759, in sage.rings.number_field.number_field_element.NumberFieldElement._rnfisnorm\nFailed example:\n    t = K(3)._rnfisnorm(L); t\nExpected:\n    (b^3 + a*b^2 + a^2*b - 1, 3*a^2 - 3*a + 6)\nGot:\n    (-b^3 + a*b^2 - a^2*b - 1, 3*a^2 - 3*a + 6)\n**********************************************************************\n2 items had failures:\n   2 of  27 in sage.rings.number_field.number_field_element.NumberFieldElement._rnfisnorm\n   1 of  28 in sage.rings.number_field.number_field_element.NumberFieldElement.is_norm\n    [1168 tests, 3 failures, 14.02 s]\ndoctest:warning\n  File \"/var/lib/buildbot/worker/sage_git/build/local/var/lib/sage/venv-python3.10.8/lib/python3.10/threading.py\", line 973, in _bootstrap\n    self._bootstrap_inner()\n  File \"/var/lib/buildbot/worker/sage_git/build/local/var/lib/sage/venv-python3.10.8/lib/python3.10/threading.py\", line 1002, in _bootstrap_inner\n    self._set_tstate_lock()\n  File \"/var/lib/buildbot/worker/sage_git/build/local/var/lib/sage/venv-python3.10.8/lib/python3.10/threading.py\", line 991, in _set_tstate_lock\n    self._tstate_lock = _set_sentinel()\n  File \"/var/lib/buildbot/worker/sage_git/build/local/var/lib/sage/venv-python3.10.8/lib/python3.10/warnings.py\", line 109, in _showwarnmsg\n    sw(msg.message, msg.category, msg.filename, msg.lineno,\n:\nRuntimeWarning: cypari2 leaked 4032445012 bytes on the PARI stack\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 154, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int\nFailed example:\n    base._pow_int(2^57)\nExpected:\n    78962960182680.42\nGot:\n    78962960182680.27\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 156, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int\nFailed example:\n    base._pow_int(2^57 + 1)\nExpected:\n    78962960182680.42\nGot:\n    78962960182680.27\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 170, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int\nFailed example:\n    base._pow_int(2^57)\nExpected:\n    78962960182680.42\nGot:\n    78962960182680.27\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 172, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int\nFailed example:\n    base._pow_int(2^57 + 1)\nExpected:\n    -78962960182680.42\nGot:\n    -78962960182680.27\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 195, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_long\nFailed example:\n    base ^ (2^57)\nExpected:\n    78962960182680.42\nGot:\n    78962960182680.27\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 197, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_long\nFailed example:\n    base ^ RDF(2^57)\nExpected:\n    78962960182680.42\nGot:\n    78962960182680.27\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 384, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp\nFailed example:\n    a = r.exp(); a\nExpected:\n    106588847274864.47\nGot:\n    106588847274864.22\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 392, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp\nFailed example:\n    r.exp()\nExpected:\n    9.381844588498685e-15\nGot:\n    9.381844588498707e-15\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 418, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp2\nFailed example:\n    r.exp2()\nExpected:\n    4294967295.9999967\nGot:\n    4294967296.0\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 424, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp2\nFailed example:\n    r.exp2()\nExpected:\n    1.8911724825302065e-10\nGot:\n    1.8911724825302072e-10\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 445, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp10\nFailed example:\n    r.exp10()\nExpected:\n    1.0000000000000069e+32\nGot:\n    1.0000000000000062e+32\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 451, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp10\nFailed example:\n    r.exp10()\nExpected:\n    5.011872336272702e-33\nGot:\n    5.011872336272695e-33\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 651, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.acosh\nFailed example:\n    i = q.cosh(); i\nExpected:\n    2.5091784786580567\nGot:\n    2.509178478658056\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 665, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arcsinh\nFailed example:\n    i = q.sinh(); i\nExpected:\n    2.3012989023072947\nGot:\n    2.3012989023072943\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 679, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arctanh\nFailed example:\n    i = q.tanh(); i\nExpected:\n    0.9171523356672744\nGot:\n    0.9171523356672743\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 681, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arctanh\nFailed example:\n    i.arctanh() - q  # rel tol 1\nExpected:\n    4.440892098500626e-16\nGot:\n    -4.440892098500626e-16\nTolerance exceeded:\n    4.440892098500626e-16 vs -4.440892098500626e-16, tolerance 3e0 > 1e0\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 692, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.sech\nFailed example:\n    RDF(pi).sech()\nExpected:\n    0.08626673833405443\nGot:\n    0.08626673833405446\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 694, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.sech\nFailed example:\n    CDF(pi).sech()\nExpected:\n    0.08626673833405443\nGot:\n    0.08626673833405446\n**********************************************************************\nFile \"src/sage/rings/real_double_element_gsl.pyx\", line 705, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.csch\nFailed example:\n    RDF(pi).csch()\nExpected:\n    0.08658953753004694\nGot:\n    0.08658953753004697\n**********************************************************************\n10 items had failures:\n   4 of  23 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int\n   2 of   8 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_long\n   1 of   4 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.acosh\n   1 of   4 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arcsinh\n   2 of   4 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arctanh\n   1 of   3 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.csch\n   2 of   9 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp\n   2 of   7 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp10\n   2 of   7 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp2\n   2 of   3 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.sech\n    [145 tests, 19 failures, 0.06 s]\n**********************************************************************\nFile \"src/sage/stats/hmm/hmm.pyx\", line 596, in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel._forward_scale\nFailed example:\n    m._forward_scale(stats.IntList([0,1]*10))\nExpected:\n    -14.378663512219454\nGot:\n    -14.378663512219456\n**********************************************************************\nFile \"src/sage/stats/hmm/hmm.pyx\", line 601, in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel._forward_scale\nFailed example:\n    m.log_likelihood(stats.IntList([0,1]*10))\nExpected:\n    -14.378663512219454\nGot:\n    -14.378663512219456\n**********************************************************************\n1 item had failures:\n   2 of   8 in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel._forward_scale\n    [121 tests, 2 failures, 0.67 s]\n**********************************************************************\nFile \"src/sage/structure/element.pyx\", line 2016, in sage.structure.element.Element.__pow__\nFailed example:\n    complex(1,2)**(1/2)\nExpected:\n    (1.272019649514069+0.786151377757423...j)\nGot:\n    (1.2720196495140692+0.7861513777574234j)\n**********************************************************************\n1 item had failures:\n   1 of  24 in sage.structure.element.Element.__pow__\n    [756 tests, 1 failure, 12.71 s]\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 1659, in sage.symbolic.expression.Expression._convert\nFailed example:\n    f._convert({'parent':RDF})\nExpected:\n    -1.40006081533995\nGot:\n    -1.4000608153399503\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 7581, in sage.symbolic.expression.Expression.polynomial\nFailed example:\n    f.polynomial(CDF)   # abs tol 5e-16\nExpected:\n    54.598150033144236*x^4 - 20.085536923187668*I*x^3 - 7.38905609893065*x^2 + 2.718281828459045*I*x + 1.0\nGot:\n    54.598150033144236*x^4 - 20.08553692318767*I*x^3 - 7.38905609893065*x^2 + 2.718281828459045*I*x + 1.0\nTolerance exceeded in 1 of 8:\n    - 20.085536923187668 vs - 20.08553692318767, tolerance 3e-15 > 5e-16\n**********************************************************************\n2 items had failures:\n   1 of  18 in sage.symbolic.expression.Expression._convert\n   1 of  31 in sage.symbolic.expression.Expression.polynomial\n    [3077 tests, 2 failures, 38.85 s]\n**********************************************************************\nFile \"src/sage_setup/autogen/interpreters/specs/cdf.py\", line 57, in sage_setup.autogen.interpreters.specs.cdf.CDFInterpreter.__init__\nFailed example:\n    f(CDF(1+2j))  # rel tol 4e-16\nExpected:\n    -10391778.999999996 + 3349659.499999962*I\nGot:\n    -10391779.000000013 + 3349659.4999999646*I\nTolerance exceeded in 2 of 2:\n    -10391778.999999996 vs -10391779.000000013, tolerance 2e-15 > 4e-16\n    + 3349659.499999962 vs + 3349659.4999999646, tolerance 8e-16 > 4e-16\n**********************************************************************\n1 item had failures:\n   1 of  20 in sage_setup.autogen.interpreters.specs.cdf.CDFInterpreter.__init__\n    [19 tests, 1 failure, 0.08 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=0 src/sage/calculus/calculus.py  # 3 doctests failed\nsage -t --long --random-seed=0 src/sage/calculus/wester.py  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/categories/finite_coxeter_groups.py  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/dynamics/complex_dynamics/mandel_julia_helper.pyx  # 3 doctests failed\nsage -t --long --random-seed=0 src/sage/functions/log.py  # 2 doctests failed\nsage -t --long --random-seed=0 src/sage/functions/trig.py  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/geometry/hyperbolic_space/hyperbolic_geodesic.py  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/interacts/test_jupyter.rst  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/matrix/matrix_double_dense.pyx  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/matrix/matrix_symbolic_dense.pyx  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/modules/free_module_element.pyx  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/modules/vector_real_double_dense.pyx  # 2 doctests failed\nsage -t --long --random-seed=0 src/sage/rings/complex_double.pyx  # 4 doctests failed\nsage -t --long --random-seed=0 src/sage/rings/complex_mpc.pyx  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/rings/complex_mpfr.pyx  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/rings/number_field/number_field_element.pyx  # 3 doctests failed\nsage -t --long --random-seed=0 src/sage/rings/real_double_element_gsl.pyx  # 19 doctests failed\nsage -t --long --random-seed=0 src/sage/stats/hmm/hmm.pyx  # 2 doctests failed\nsage -t --long --random-seed=0 src/sage/structure/element.pyx  # 1 doctest failed\nsage -t --long --random-seed=0 src/sage/symbolic/expression.pyx  # 2 doctests failed\nsage -t --long --random-seed=0 src/sage_setup/autogen/interpreters/specs/cdf.py  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 7092.1 seconds\n    cpu time: 12138.2 seconds\n    cumulative wall time: 12442.3 seconds\n```\nFull log: http://build.sagemath.org/#/builders/47/builds/14/steps/14/logs/stdio",
    "created_at": "2022-12-18T11:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485932",
    "user": "https://github.com/vbraun"
}
```

There are a bunch of numerical noise issues on 32-bit:

```
**********************************************************************
File "src/sage/calculus/calculus.py", line 242, in sage.calculus.calculus
Failed example:
    float(z)
Expected:
    4.646783762432936
Got:
    4.646783762432935
**********************************************************************
File "src/sage/calculus/calculus.py", line 772, in sage.calculus.calculus.?
Failed example:
    float(f)
Expected:
    -480.0
Got:
    -2336.0
**********************************************************************
File "src/sage/calculus/calculus.py", line 784, in sage.calculus.calculus.?
Failed example:
    f.nintegrate(x,0,1)
Expected:
    (-480.0000000000001, 5.32907051820075...e-12, 21, 0)
Got:
    (-831.9999999999999, 9.237055564881304e-12, 21, 0)
**********************************************************************
2 items had failures:
   1 of 118 in sage.calculus.calculus
   2 of  15 in sage.calculus.calculus.?
    [457 tests, 3 failures, 19.44 s]
**********************************************************************
File "src/sage/calculus/wester.py", line 283, in sage.calculus.wester
Failed example:
    float(a)
Expected:
    1.1368683772...e-13
Got:
    0.0
**********************************************************************
1 item had failures:
   1 of 202 in sage.calculus.wester
    [201 tests, 1 failure, 2.45 s]
**********************************************************************
File "src/sage/categories/finite_coxeter_groups.py", line 705, in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron
Failed example:
    W.permutahedron()
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron[1]>", line 1, in <module>
        W.permutahedron()
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/categories/finite_coxeter_groups.py", line 755, in permutahedron
        return Polyhedron(vertices=vertices, base_ring=base_ring)
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/constructor.py", line 759, in Polyhedron
        return parent(Vrep, Hrep, convert=convert, verbose=verbose, mutable=mutable)
      File "sage/structure/parent.pyx", line 898, in sage.structure.parent.Parent.__call__
        return mor._call_with_args(x, args, kwds)
      File "sage/structure/coerce_maps.pyx", line 180, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_with_args
        raise
      File "sage/structure/coerce_maps.pyx", line 175, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_with_args
        return C._element_constructor(x, *args, **kwds)
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/parent.py", line 684, in _element_constructor_
        return self.element_class(self, Vrep, Hrep, **kwds)
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/backend_cdd_rdf.py", line 98, in __init__
        Polyhedron_cdd.__init__(self, parent, Vrep, Hrep, **kwds)
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/base0.py", line 174, in __init__
        self._init_from_Vrepresentation(vertices, rays, lines, **kwds)
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/backend_cdd.py", line 65, in _init_from_Vrepresentation
        s = self._run_cdd(s, '--repall', verbose=verbose)
      File "/var/lib/buildbot/worker/sage_git/build/src/sage/geometry/polyhedron/backend_cdd.py", line 172, in _run_cdd
        raise ValueError(ans.strip())
    ValueError: *Error: Numerical inconsistency is found.  Use the GMP exact arithmetic.
**********************************************************************
1 item had failures:
   1 of   6 in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.permutahedron
    [151 tests, 1 failure, 4.74 s]
**********************************************************************
File "src/sage/dynamics/complex_dynamics/mandel_julia_helper.pyx", line 219, in sage.dynamics.complex_dynamics.mandel_julia_helper.?
Failed example:
    fast_external_ray(0,S=1,D=1)
Expected:
    [(100.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
      0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),
     (9.51254777713729174697578576623132297117784691109499464854806785133621315075854778426714908,
      0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)]
Got:
    [(100.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
      0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000),
     (9.51254777713729032775694689466896914675974929808733306327787458869355202130788654602053071,
      0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000)]
**********************************************************************
File "src/sage/dynamics/complex_dynamics/mandel_julia_helper.pyx", line 229, in sage.dynamics.complex_dynamics.mandel_julia_helper.?
Failed example:
    fast_external_ray(1/3,S=1,D=1)
Expected:
    [(-49.9999999999999786837179271969944238662719726562500000000000000000000000000000000000000000,
      86.6025403784438765342201804742217063903808593750000000000000000000000000000000000000000000),
     (-5.50628047023173006234970878097113901879832542655926629309001652388544528575532346900138516,
      8.64947510053972513843999918917106032664030380426885745306040284140385975750462108180377187)]
Got:
    [(-49.9999999999999786837179271969944238662719726562500000000000000000000000000000000000000000,
      86.6025403784438765342201804742217063903808593750000000000000000000000000000000000000000000),
     (-5.50628047023172980317558651097220813419960642675275525034690583138202683104446159128356526,
      8.64947510053972416699388454766038069022656677613412868926274778156654918224636699020909555)]
**********************************************************************
File "src/sage/dynamics/complex_dynamics/mandel_julia_helper.pyx", line 238, in sage.dynamics.complex_dynamics.mandel_julia_helper.?
Failed example:
    fast_external_ray(0.75234,S=1,D=1)
Expected:
    [(1.47021239172637052661229972727596759796142578125000000000000000000000000000000000000000000,
      -99.9891917935294287644865107722580432891845703125000000000000000000000000000000000000000000),
     (-0.352790406744857508500937144524776555433184352559852962308757189778284058275081335121601384,
      -9.98646630765023514178761177926164047797465369576787921409326037870837930920646860774032363)]
Got:
    [(1.47021239172637052661229972727596759796142578125000000000000000000000000000000000000000000,
      -99.9891917935294287644865107722580432891845703125000000000000000000000000000000000000000000),
     (-0.352790406744857531982226711825539675074733886273844201352581335945053660908669195067107961,
      -9.98646630765023371851343140849138176796542428333725755653082848714206880231557255794864137)]
**********************************************************************
1 item had failures:
   3 of  42 in sage.dynamics.complex_dynamics.mandel_julia_helper.?
    [43 tests, 3 failures, 5.81 s]
**********************************************************************
File "src/sage/functions/log.py", line 45, in sage.functions.log.Function_exp
Failed example:
    exp(float(2.5))
Expected:
    12.182493960703473
Got:
    12.182493960703475
**********************************************************************
File "src/sage/functions/log.py", line 47, in sage.functions.log.Function_exp
Failed example:
    exp(RDF('2.5'))
Expected:
    12.182493960703473
Got:
    12.182493960703475
**********************************************************************
1 item had failures:
   2 of  41 in sage.functions.log.Function_exp
    [281 tests, 2 failures, 4.10 s]
**********************************************************************
File "src/sage/functions/trig.py", line 608, in sage.functions.trig.Function_arccos.__init__
Failed example:
    acos(complex(1,1))
Expected:
    (0.9045568943023814-1.0612750619050357j)
Got:
    (0.9045568943023815-1.0612750619050357j)
**********************************************************************
1 item had failures:
   1 of  18 in sage.functions.trig.Function_arccos.__init__
    [261 tests, 1 failure, 2.37 s]
**********************************************************************
File "src/sage/geometry/hyperbolic_space/hyperbolic_geodesic.py", line 2384, in sage.geometry.hyperbolic_space.hyperbolic_geodesic.HyperbolicGeodesicHM._plot_vertices
Failed example:
    g._plot_vertices(5)
Expected:
    [(4.0, -4.0, 5.744562...),
     (1.363213..., -1.637073..., 2.353372...),
     (0.138568..., -0.969980..., 1.400022...),
     (-0.942533..., -1.307681..., 1.896945...),
     (-3.0, -3.0, 4.358898...)]
Got:
    [(4.0, -4.0, 5.744562646538029),
     (1.3632131724692087, -1.6370738298435317, 2.3533722353151303),
     (0.1385685838744788, -0.9699800871213657, 1.4000223647674161),
     (-0.942533854284406, -1.3076813974501604, 1.8969450977056255),
     (-3.0, -3.000000000000014, 4.35889894354068)]
**********************************************************************
1 item had failures:
   1 of   6 in sage.geometry.hyperbolic_space.hyperbolic_geodesic.HyperbolicGeodesicHM._plot_vertices
    [447 tests, 1 failure, 8.67 s]
**********************************************************************
File "src/sage/interacts/test_jupyter.rst", line 120, in sage.interacts.test_jupyter
Failed example:
    test(interacts.calculus.newton_method)
Expected:
    ...Interactive function <function newton_method at ...> with 7 widgets
      title: HTMLText(value='<h2>Newton method</h2>')
      f: EvalText(value='x^2 - 2', description='f', layout=Layout(max_width='81em'))
      c: IntSlider(value=6, description='Start ($x$)', max=10, min=-10)
      d: IntSlider(value=3, description='$10^{-d}$ precision', max=16, min=1)
      maxn: IntSlider(value=10, description='max iterations', max=15)
      interval: IntRangeSlider(value=(0, 6), description='Interval', max=10, min=-10)
      list_steps: Checkbox(value=False, description='List steps')
    \(\text{Precision } 2h = 0.001\)
    \({c = }1.4142141576301823\)
    \({f(c) = }1.6836416460996873 \times 10^{-06}\)
    \(6 \text{ iterations}\)
Got:
    <CSI-2K>
<CSI-2K>
\(\text{Precision } 2h = 0.0010000000000000002\)
    \({c = }1.4142141576301823\)
    \({f(c) = }1.6836416460996873 \times 10^{-06}\)
    \(6 \text{ iterations}\)
    Interactive function <function newton_method at 0xa6a181d8> with 7 widgets
      title: HTMLText(value='<h2>Newton method</h2>')
      f: EvalText(value='x^2 - 2', description='f', layout=Layout(max_width='81em'))
      c: IntSlider(value=6, description='Start ($x$)', max=10, min=-10)
      d: IntSlider(value=3, description='$10^{-d}$ precision', max=16, min=1)
      maxn: IntSlider(value=10, description='max iterations', max=15)
      interval: IntRangeSlider(value=(0, 6), description='Interval', max=10, min=-10)
      list_steps: Checkbox(value=False, description='List steps')
    \(\text{Precision } 2h = 0.0010000000000000002\)
    \({c = }1.4142141576301823\)
    \({f(c) = }1.6836416460996873 \times 10^{-06}\)
    \(6 \text{ iterations}\)
**********************************************************************
1 item had failures:
   1 of  30 in sage.interacts.test_jupyter
    [29 tests, 1 failure, 70.30 s]
**********************************************************************
File "src/sage/matrix/matrix_double_dense.pyx", line 1624, in sage.matrix.matrix_double_dense.Matrix_double_dense.right_eigenvectors
Failed example:
    spectrum[3]  # tol 1e-13
Expected:
    (-1.0, [(1.0, -0.5, 2.0, 0.5)], 1)
Got:
    (-1.0000000000000828,
     [(1.0, -0.4999999999999238, 1.9999999999997218, 0.4999999999999161)],
     1)
Tolerance exceeded in 3 of 6:
    -0.5 vs -0.4999999999999238, tolerance 2e-13 > 1e-13
    2.0 vs 1.9999999999997218, tolerance 2e-13 > 1e-13
    0.5 vs 0.4999999999999161, tolerance 2e-13 > 1e-13
**********************************************************************
1 item had failures:
   1 of  24 in sage.matrix.matrix_double_dense.Matrix_double_dense.right_eigenvectors
    [611 tests, 1 failure, 0.92 s]
**********************************************************************
File "src/sage/matrix/matrix_symbolic_dense.pyx", line 441, in sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense.exp
Failed example:
    exp(matrix(SR, [[1.2, 5.6], [3,4]])).change_ring(RDF)  # rel tol 1e-15
Expected:
    [ 346.5574872980695  661.7345909344504]
    [354.50067371488416  677.4247827652946]
Got:
    [346.55748729806896  661.7345909344492]
    [354.50067371488353  677.4247827652937]
Tolerance exceeded in 4 of 4:
    346.5574872980695 vs 346.55748729806896, tolerance 2e-15 > 1e-15
    661.7345909344504 vs 661.7345909344492, tolerance 2e-15 > 1e-15
    354.50067371488416 vs 354.50067371488353, tolerance 2e-15 > 1e-15
    677.4247827652946 vs 677.4247827652937, tolerance 2e-15 > 1e-15
**********************************************************************
1 item had failures:
   1 of  17 in sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense.exp
    [224 tests, 1 failure, 5.48 s]
**********************************************************************
File "src/sage/modules/free_module_element.pyx", line 1687, in sage.modules.free_module_element.FreeModuleElement.norm
Failed example:
    v.norm(5)
Expected:
    3.077384885394063
Got:
    3.0773848853940633
**********************************************************************
1 item had failures:
   1 of  24 in sage.modules.free_module_element.FreeModuleElement.norm
    [1081 tests, 1 failure, 5.08 s]
**********************************************************************
File "src/sage/modules/vector_real_double_dense.pyx", line 7, in sage.modules.vector_real_double_dense
Failed example:
    v
Expected:
    (1.0, 3.141592653589793, 1.414213562373095)
Got:
    (1.0, 3.141592653589793, 1.4142135623730951)
**********************************************************************
File "src/sage/modules/vector_real_double_dense.pyx", line 14, in sage.modules.vector_real_double_dense
Failed example:
    v
Expected:
    (5.0, 3.141592653589793, 1.414213562373095)
Got:
    (5.0, 3.141592653589793, 1.4142135623730951)
**********************************************************************
1 item had failures:
   2 of   8 in sage.modules.vector_real_double_dense
    [19 tests, 2 failures, 10.89 s]
**********************************************************************
File "src/sage/rings/complex_double.pyx", line 1136, in sage.rings.complex_double.ComplexDoubleElement._latex_
Failed example:
    z._latex_()
Expected:
    '-6.443164690985956 \\times 10^{34} - 6.113241307762409 \\times 10^{34}i'
Got:
    '-6.443164690985963 \\times 10^{34} - 6.113241307762415 \\times 10^{34}i'
**********************************************************************
File "src/sage/rings/complex_double.pyx", line 1685, in sage.rings.complex_double.ComplexDoubleElement._pow_
Failed example:
    CDF(-0.26319743704743886) ^ -2
Expected:
    14.435661446561994
Got:
    14.435661446561992
**********************************************************************
File "src/sage/rings/complex_double.pyx", line 1936, in sage.rings.complex_double.ComplexDoubleElement.arccos
Failed example:
    CDF(1,1).arccos()
Expected:
    0.9045568943023814 - 1.0612750619050357*I
Got:
    0.9045568943023815 - 1.0612750619050357*I
**********************************************************************
File "src/sage/rings/complex_double.pyx", line 2115, in sage.rings.complex_double.ComplexDoubleElement.arccosh
Failed example:
    CDF(1,1).arccosh()
Expected:
    1.0612750619050357 + 0.9045568943023814*I
Got:
    1.0612750619050357 + 0.9045568943023815*I
**********************************************************************
4 items had failures:
   1 of   4 in sage.rings.complex_double.ComplexDoubleElement._latex_
   1 of  19 in sage.rings.complex_double.ComplexDoubleElement._pow_
   1 of   2 in sage.rings.complex_double.ComplexDoubleElement.arccos
   1 of   2 in sage.rings.complex_double.ComplexDoubleElement.arccosh
    [341 tests, 4 failures, 0.27 s]
**********************************************************************
File "src/sage/rings/complex_mpc.pyx", line 1524, in sage.rings.complex_mpc.MPComplexNumber.__abs__
Failed example:
    float(sqrt(2^2 + 1^1))
Expected:
    2.23606797749979
Got:
    2.2360679774997894
**********************************************************************
1 item had failures:
   1 of  10 in sage.rings.complex_mpc.MPComplexNumber.__abs__
    [410 tests, 1 failure, 0.21 s]
**********************************************************************
File "src/sage/rings/complex_mpfr.pyx", line 1885, in sage.rings.complex_mpfr.ComplexNumber.__abs__
Failed example:
    float(sqrt(2^2 + 1^1))
Expected:
    2.23606797749979
Got:
    2.2360679774997894
**********************************************************************
1 item had failures:
   1 of   9 in sage.rings.complex_mpfr.ComplexNumber.__abs__
    [539 tests, 1 failure, 1.78 s]
**********************************************************************
File "src/sage/rings/number_field/number_field_element.pyx", line 1640, in sage.rings.number_field.number_field_element.NumberFieldElement.is_norm
Failed example:
    t = (-a).is_norm(L, element=True); t
Expected:
    (True, -b^3 - 1)
Got:
    (True, b^3 - 1)
**********************************************************************
File "src/sage/rings/number_field/number_field_element.pyx", line 1755, in sage.rings.number_field.number_field_element.NumberFieldElement._rnfisnorm
Failed example:
    t = (-a)._rnfisnorm(L); t
Expected:
    (-b^3 - 1, 1)
Got:
    (b^3 - 1, 1)
**********************************************************************
File "src/sage/rings/number_field/number_field_element.pyx", line 1759, in sage.rings.number_field.number_field_element.NumberFieldElement._rnfisnorm
Failed example:
    t = K(3)._rnfisnorm(L); t
Expected:
    (b^3 + a*b^2 + a^2*b - 1, 3*a^2 - 3*a + 6)
Got:
    (-b^3 + a*b^2 - a^2*b - 1, 3*a^2 - 3*a + 6)
**********************************************************************
2 items had failures:
   2 of  27 in sage.rings.number_field.number_field_element.NumberFieldElement._rnfisnorm
   1 of  28 in sage.rings.number_field.number_field_element.NumberFieldElement.is_norm
    [1168 tests, 3 failures, 14.02 s]
doctest:warning
  File "/var/lib/buildbot/worker/sage_git/build/local/var/lib/sage/venv-python3.10.8/lib/python3.10/threading.py", line 973, in _bootstrap
    self._bootstrap_inner()
  File "/var/lib/buildbot/worker/sage_git/build/local/var/lib/sage/venv-python3.10.8/lib/python3.10/threading.py", line 1002, in _bootstrap_inner
    self._set_tstate_lock()
  File "/var/lib/buildbot/worker/sage_git/build/local/var/lib/sage/venv-python3.10.8/lib/python3.10/threading.py", line 991, in _set_tstate_lock
    self._tstate_lock = _set_sentinel()
  File "/var/lib/buildbot/worker/sage_git/build/local/var/lib/sage/venv-python3.10.8/lib/python3.10/warnings.py", line 109, in _showwarnmsg
    sw(msg.message, msg.category, msg.filename, msg.lineno,
:
RuntimeWarning: cypari2 leaked 4032445012 bytes on the PARI stack
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 154, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int
Failed example:
    base._pow_int(2^57)
Expected:
    78962960182680.42
Got:
    78962960182680.27
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 156, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int
Failed example:
    base._pow_int(2^57 + 1)
Expected:
    78962960182680.42
Got:
    78962960182680.27
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 170, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int
Failed example:
    base._pow_int(2^57)
Expected:
    78962960182680.42
Got:
    78962960182680.27
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 172, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int
Failed example:
    base._pow_int(2^57 + 1)
Expected:
    -78962960182680.42
Got:
    -78962960182680.27
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 195, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_long
Failed example:
    base ^ (2^57)
Expected:
    78962960182680.42
Got:
    78962960182680.27
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 197, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_long
Failed example:
    base ^ RDF(2^57)
Expected:
    78962960182680.42
Got:
    78962960182680.27
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 384, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp
Failed example:
    a = r.exp(); a
Expected:
    106588847274864.47
Got:
    106588847274864.22
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 392, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp
Failed example:
    r.exp()
Expected:
    9.381844588498685e-15
Got:
    9.381844588498707e-15
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 418, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp2
Failed example:
    r.exp2()
Expected:
    4294967295.9999967
Got:
    4294967296.0
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 424, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp2
Failed example:
    r.exp2()
Expected:
    1.8911724825302065e-10
Got:
    1.8911724825302072e-10
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 445, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp10
Failed example:
    r.exp10()
Expected:
    1.0000000000000069e+32
Got:
    1.0000000000000062e+32
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 451, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp10
Failed example:
    r.exp10()
Expected:
    5.011872336272702e-33
Got:
    5.011872336272695e-33
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 651, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.acosh
Failed example:
    i = q.cosh(); i
Expected:
    2.5091784786580567
Got:
    2.509178478658056
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 665, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arcsinh
Failed example:
    i = q.sinh(); i
Expected:
    2.3012989023072947
Got:
    2.3012989023072943
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 679, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arctanh
Failed example:
    i = q.tanh(); i
Expected:
    0.9171523356672744
Got:
    0.9171523356672743
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 681, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arctanh
Failed example:
    i.arctanh() - q  # rel tol 1
Expected:
    4.440892098500626e-16
Got:
    -4.440892098500626e-16
Tolerance exceeded:
    4.440892098500626e-16 vs -4.440892098500626e-16, tolerance 3e0 > 1e0
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 692, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.sech
Failed example:
    RDF(pi).sech()
Expected:
    0.08626673833405443
Got:
    0.08626673833405446
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 694, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.sech
Failed example:
    CDF(pi).sech()
Expected:
    0.08626673833405443
Got:
    0.08626673833405446
**********************************************************************
File "src/sage/rings/real_double_element_gsl.pyx", line 705, in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.csch
Failed example:
    RDF(pi).csch()
Expected:
    0.08658953753004694
Got:
    0.08658953753004697
**********************************************************************
10 items had failures:
   4 of  23 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_int
   2 of   8 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl._pow_long
   1 of   4 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.acosh
   1 of   4 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arcsinh
   2 of   4 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.arctanh
   1 of   3 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.csch
   2 of   9 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp
   2 of   7 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp10
   2 of   7 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.exp2
   2 of   3 in sage.rings.real_double_element_gsl.RealDoubleElement_gsl.sech
    [145 tests, 19 failures, 0.06 s]
**********************************************************************
File "src/sage/stats/hmm/hmm.pyx", line 596, in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel._forward_scale
Failed example:
    m._forward_scale(stats.IntList([0,1]*10))
Expected:
    -14.378663512219454
Got:
    -14.378663512219456
**********************************************************************
File "src/sage/stats/hmm/hmm.pyx", line 601, in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel._forward_scale
Failed example:
    m.log_likelihood(stats.IntList([0,1]*10))
Expected:
    -14.378663512219454
Got:
    -14.378663512219456
**********************************************************************
1 item had failures:
   2 of   8 in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel._forward_scale
    [121 tests, 2 failures, 0.67 s]
**********************************************************************
File "src/sage/structure/element.pyx", line 2016, in sage.structure.element.Element.__pow__
Failed example:
    complex(1,2)**(1/2)
Expected:
    (1.272019649514069+0.786151377757423...j)
Got:
    (1.2720196495140692+0.7861513777574234j)
**********************************************************************
1 item had failures:
   1 of  24 in sage.structure.element.Element.__pow__
    [756 tests, 1 failure, 12.71 s]
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 1659, in sage.symbolic.expression.Expression._convert
Failed example:
    f._convert({'parent':RDF})
Expected:
    -1.40006081533995
Got:
    -1.4000608153399503
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 7581, in sage.symbolic.expression.Expression.polynomial
Failed example:
    f.polynomial(CDF)   # abs tol 5e-16
Expected:
    54.598150033144236*x^4 - 20.085536923187668*I*x^3 - 7.38905609893065*x^2 + 2.718281828459045*I*x + 1.0
Got:
    54.598150033144236*x^4 - 20.08553692318767*I*x^3 - 7.38905609893065*x^2 + 2.718281828459045*I*x + 1.0
Tolerance exceeded in 1 of 8:
    - 20.085536923187668 vs - 20.08553692318767, tolerance 3e-15 > 5e-16
**********************************************************************
2 items had failures:
   1 of  18 in sage.symbolic.expression.Expression._convert
   1 of  31 in sage.symbolic.expression.Expression.polynomial
    [3077 tests, 2 failures, 38.85 s]
**********************************************************************
File "src/sage_setup/autogen/interpreters/specs/cdf.py", line 57, in sage_setup.autogen.interpreters.specs.cdf.CDFInterpreter.__init__
Failed example:
    f(CDF(1+2j))  # rel tol 4e-16
Expected:
    -10391778.999999996 + 3349659.499999962*I
Got:
    -10391779.000000013 + 3349659.4999999646*I
Tolerance exceeded in 2 of 2:
    -10391778.999999996 vs -10391779.000000013, tolerance 2e-15 > 4e-16
    + 3349659.499999962 vs + 3349659.4999999646, tolerance 8e-16 > 4e-16
**********************************************************************
1 item had failures:
   1 of  20 in sage_setup.autogen.interpreters.specs.cdf.CDFInterpreter.__init__
    [19 tests, 1 failure, 0.08 s]
----------------------------------------------------------------------
sage -t --long --random-seed=0 src/sage/calculus/calculus.py  # 3 doctests failed
sage -t --long --random-seed=0 src/sage/calculus/wester.py  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/categories/finite_coxeter_groups.py  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/dynamics/complex_dynamics/mandel_julia_helper.pyx  # 3 doctests failed
sage -t --long --random-seed=0 src/sage/functions/log.py  # 2 doctests failed
sage -t --long --random-seed=0 src/sage/functions/trig.py  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/geometry/hyperbolic_space/hyperbolic_geodesic.py  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/interacts/test_jupyter.rst  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/matrix/matrix_double_dense.pyx  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/matrix/matrix_symbolic_dense.pyx  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/modules/free_module_element.pyx  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/modules/vector_real_double_dense.pyx  # 2 doctests failed
sage -t --long --random-seed=0 src/sage/rings/complex_double.pyx  # 4 doctests failed
sage -t --long --random-seed=0 src/sage/rings/complex_mpc.pyx  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/rings/complex_mpfr.pyx  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/rings/number_field/number_field_element.pyx  # 3 doctests failed
sage -t --long --random-seed=0 src/sage/rings/real_double_element_gsl.pyx  # 19 doctests failed
sage -t --long --random-seed=0 src/sage/stats/hmm/hmm.pyx  # 2 doctests failed
sage -t --long --random-seed=0 src/sage/structure/element.pyx  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/symbolic/expression.pyx  # 2 doctests failed
sage -t --long --random-seed=0 src/sage_setup/autogen/interpreters/specs/cdf.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 7092.1 seconds
    cpu time: 12138.2 seconds
    cumulative wall time: 12442.3 seconds
```
Full log: http://build.sagemath.org/#/builders/47/builds/14/steps/14/logs/stdio



---

archive/issue_comments_485933.json:
```json
{
    "body": "Many of these numerical noises do not involve PARI/GP at all!",
    "created_at": "2022-12-18T13:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485933",
    "user": "https://github.com/videlec"
}
```

Many of these numerical noises do not involve PARI/GP at all!



---

archive/issue_comments_485934.json:
```json
{
    "body": "Indeed, e.g.\n\n```\nFile \"src/sage/calculus/calculus.py\", line 772, in sage.calculus.calculus.?\nFailed example:\n    float(f)\nExpected:\n    -480.0\nGot:\n    -2336.0\n```\nand ensuing error in this file have nothing to do with Pari.\nAre we still supporting 32-bit seriously? \nIndeed, these 32-bit errors should have been caught elsewhere.\n\n\nI wonder whether Pari 2.15.1 passes its selftests on 32-bit, too.",
    "created_at": "2022-12-18T13:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485934",
    "user": "https://github.com/dimpase"
}
```

Indeed, e.g.

```
File "src/sage/calculus/calculus.py", line 772, in sage.calculus.calculus.?
Failed example:
    float(f)
Expected:
    -480.0
Got:
    -2336.0
```
and ensuing error in this file have nothing to do with Pari.
Are we still supporting 32-bit seriously? 
Indeed, these 32-bit errors should have been caught elsewhere.


I wonder whether Pari 2.15.1 passes its selftests on 32-bit, too.



---

archive/issue_comments_485935.json:
```json
{
    "body": "Fix:\nhttps://github.com/void-linux/void-packages/blob/master/srcpkgs/pari/patches/float32.patch\n\nAll tests pass on void linux i686 (using that patch on pari).",
    "created_at": "2022-12-18T14:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485935",
    "user": "https://github.com/tornaria"
}
```

Fix:
https://github.com/void-linux/void-packages/blob/master/srcpkgs/pari/patches/float32.patch

All tests pass on void linux i686 (using that patch on pari).



---

archive/issue_comments_485936.json:
```json
{
    "body": "BTW, I've just submitted a report upstream to the pari bug tracker, which I had neglected to do before.",
    "created_at": "2022-12-18T14:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485936",
    "user": "https://github.com/tornaria"
}
```

BTW, I've just submitted a report upstream to the pari bug tracker, which I had neglected to do before.



---

archive/issue_comments_485937.json:
```json
{
    "body": "Replying to [comment:103 Vincent Delecroix]:\n> Many of these numerical noises do not involve PARI/GP at all!\n\n\ntests run fine without this ticket tho...",
    "created_at": "2022-12-18T16:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485937",
    "user": "https://github.com/vbraun"
}
```

Replying to [comment:103 Vincent Delecroix]:
> Many of these numerical noises do not involve PARI/GP at all!


tests run fine without this ticket tho...



---

archive/issue_comments_485938.json:
```json
{
    "body": "Replying to [comment:107 Volker Braun]:\n> Replying to [comment:103 Vincent Delecroix]:\n> > Many of these numerical noises do not involve PARI/GP at all!\n\n> \n> tests run fine without this ticket tho...\n\n\nThe offending Pari commit, reverted by Gonzalo's patch, is not in 2.13.3, but is in 2.15.1.\nMaybe it flips FPU switches somewhere...",
    "created_at": "2022-12-18T18:55:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485938",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:107 Volker Braun]:
> Replying to [comment:103 Vincent Delecroix]:
> > Many of these numerical noises do not involve PARI/GP at all!

> 
> tests run fine without this ticket tho...


The offending Pari commit, reverted by Gonzalo's patch, is not in 2.13.3, but is in 2.15.1.
Maybe it flips FPU switches somewhere...



---

archive/issue_comments_485939.json:
```json
{
    "body": "Replying to [comment:108 Dima Pasechnik]:\n> Replying to [comment:107 Volker Braun]:\n> > Replying to [comment:103 Vincent Delecroix]:\n> > > Many of these numerical noises do not involve PARI/GP at all!\n\n> > \n> > tests run fine without this ticket tho...\n\n> \n> The offending Pari commit, reverted by Gonzalo's patch, is not in 2.13.3, but is in 2.15.1.\n> Maybe it flips FPU switches somewhere...\n\n\nPrecisely. The 387 fpu has a switch to choose between 64-bit (double) and 80-bit (long double) arithmetic. The problem is that transcendental functions depend on 80 bit arithmetic to give accurate 64 bit results \ud83e\udd26\u200d\u2642\ufe0f\n\nJust linking to pari (without even initializing it) will affect a program, as demonstrated in the test program in my commit message (https://github.com/void-linux/void-packages/blob/master/srcpkgs/pari/patches/float32.patch).\n\nMaybe it is possible to override the -mpc64 setting in pari library by explicitly adding -mpc80 to the linking step of sage. Or adding code in sage init to explicitly initialize the FPU to a safe mode.\n\nBe warned that removing the `-mpc64` flag in pari might result in some numerical differences on pari itself due to 80 bit precission. In void linux we compile pari with `-ffloat-store` which avoids this issue.",
    "created_at": "2022-12-18T19:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485939",
    "user": "https://github.com/tornaria"
}
```

Replying to [comment:108 Dima Pasechnik]:
> Replying to [comment:107 Volker Braun]:
> > Replying to [comment:103 Vincent Delecroix]:
> > > Many of these numerical noises do not involve PARI/GP at all!

> > 
> > tests run fine without this ticket tho...

> 
> The offending Pari commit, reverted by Gonzalo's patch, is not in 2.13.3, but is in 2.15.1.
> Maybe it flips FPU switches somewhere...


Precisely. The 387 fpu has a switch to choose between 64-bit (double) and 80-bit (long double) arithmetic. The problem is that transcendental functions depend on 80 bit arithmetic to give accurate 64 bit results 

Just linking to pari (without even initializing it) will affect a program, as demonstrated in the test program in my commit message (https://github.com/void-linux/void-packages/blob/master/srcpkgs/pari/patches/float32.patch).

Maybe it is possible to override the -mpc64 setting in pari library by explicitly adding -mpc80 to the linking step of sage. Or adding code in sage init to explicitly initialize the FPU to a safe mode.

Be warned that removing the `-mpc64` flag in pari might result in some numerical differences on pari itself due to 80 bit precission. In void linux we compile pari with `-ffloat-store` which avoids this issue.



---

archive/issue_comments_485940.json:
```json
{
    "body": "https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2435",
    "created_at": "2022-12-18T19:18:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485940",
    "user": "https://github.com/tornaria"
}
```

https://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=2435



---

archive/issue_comments_485941.json:
```json
{
    "body": "should we proceed with the Gonzalo's patch ? \n\nthe upstream is clearly wrong in applying this change unconditionally, IMHO",
    "created_at": "2022-12-21T09:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/34300",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/34300#issuecomment-485941",
    "user": "https://github.com/dimpase"
}
```

should we proceed with the Gonzalo's patch ? 

the upstream is clearly wrong in applying this change unconditionally, IMHO
