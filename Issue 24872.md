# Issue 24872: Upgrade cmake to 3.11.0

Issue created by migration from Trac.

Original creator: vklein

Original creation time: 2018-04-06 15:22:38

CC:  fbissey vdelecroix moritz mkoeppe

Keywords: cmake

Note: primecount package can't be intalled with the current cmake version.


---

Comment by vdelecroix created at 2018-04-06 17:03:05

It would be nice if `cmake` installation would be dependent of the system (as is `gcc`, `yasm` or `curl`).


---

Comment by vklein created at 2018-04-09 09:19:38

Replying to [comment:3 vdelecroix]:
> It would be nice if `cmake` installation would be dependent of the system (as is `gcc`, `yasm` or `curl`).

It is via `bootstrap` file. What is missing exactly ?


---

Comment by vklein created at 2018-04-09 09:35:35

Set assignee to vklein.


---

Comment by fbissey created at 2018-04-09 09:38:24

You have to touch configure.ac if you want to test whether there is a system wide install. But we don't do that for real "optional" packages (as in we always need gcc, yasm and curl anyway). So there would be a bit of a challenge there.


---

Comment by vklein created at 2018-04-09 14:21:38

Replying to [comment:7 fbissey]:
> You have to touch configure.ac if you want to test whether there is a system wide install. But we don't do that for real "optional" packages (as in we always need gcc, yasm and curl anyway). So there would be a bit of a challenge there.

\\
I don't really see how to do this. What do we want exactly ?\\

If `cmake` is already installed (system wide) and is a dependencie of another sage package we don't want `cmake` sage package to be installed.\\

But in the case above should `sage -i cmake` still work ? 
----
New commits:


---

Comment by vdelecroix created at 2018-04-12 17:00:59

Replying to [comment:9 vklein]:
> Replying to [comment:7 fbissey]:
> > You have to touch configure.ac if you want to test whether there is a system wide install. But we don't do that for real "optional" packages (as in we always need gcc, yasm and curl anyway). So there would be a bit of a challenge there.
>  
> I don't really see how to do this.

Nobody does (yet).

> What do we want exactly ?
> 
> If `cmake` is already installed (system wide) and is a dependencie of another sage package we don't want `cmake` sage package to be installed.

Yes, this is what we want.

> But in the case above should `sage -i cmake` still work ? 

Yes, as `sage -i gcc`.


---

Comment by fbissey created at 2018-04-12 21:07:34

I think the only way to achieve that is to put a fake file in `SAGE_LOCAL/var/lib/sage/installed/` but that would mean creating the folder at configure time. On a side note if you want to do a similar thing (but not completely) in gentoo you need to list the package provided some other way in a special file (`/etc/portage/package.provided`) - but then the only way to install the gentoo version is to remove their entry from that file. 

What you want here is quite hard to achieve.


---

Comment by vklein created at 2018-04-13 07:59:54

The 'Installation system dependant' aspect has been moved in #25158.


---

Comment by vklein created at 2018-04-13 07:59:54

Changing status from new to needs_review.


---

Comment by fbissey created at 2018-04-13 08:17:32

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2018-04-13 08:17:32

Looks good to me.


---

Comment by vbraun created at 2018-05-12 11:46:20

Resolution: fixed
