# Issue 18513: Make sure indices converted into the index set of the basis for a CombinatorialFreeModule

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2015-06-20 20:43:50

Assignee: sage-combinat

CC:  mjo sage-combinat nthiery ghseeli @louisng114

Keywords: combinatorial free module

The following is unexpected:

```
sage: s = SymmetricFunctions(QQ).s()
sage: s.basis()[(3,1,1)]
s(3, 1, 1)
sage: type(_.support()[0])
<type 'tuple'>
sage: s.basis()[(3,1,1)]
s(3, 1, 1)
```

We should make sure that we always have the support of an element of the indexing set for a `CombinatorialFreeModule`.


---

Comment by tscrim created at 2015-06-20 21:02:26

We loose about half a microsecond each time this is called, but which can add a little bit of slowdown. However I think this is one which we must accept (and will typically be negligible due to caching or other parts of the computation). Although in these examples, we seem to achieve a marginal net speedup. So I think this is a good solution (but I haven't done extensive testing).

With:

```
sage: s = SymmetricFunctions(QQ).s()
sage: %timeit s[5,3,1,1] * s[3,3,2]
100 loops, best of 3: 15.2 ms per loop
sage: I = DescentAlgebra(QQ, 4).I()
sage: timeit('I[3,1] * I[2,2]', number=10)
10 loops, best of 3: 223 ms per loop
```

Before:

```
sage: s = SymmetricFunctions(QQ).s()
sage: %timeit s[5,3,1,1] * s[3,3,2]
100 loops, best of 3: 15.7 ms per loop
sage: I = DescentAlgebra(QQ, 4).I()
sage: timeit('I[3,1] * I[2,2]', number=10)
10 loops, best of 3: 225 ms per loop
```

----
New commits:


---

Comment by tscrim created at 2015-06-20 21:02:26

Changing status from new to needs_review.


---

Comment by tscrim created at 2015-06-22 04:23:02

Hmmm...this approach doesn't work when the index set is not callable/parent-with-elements. I'd prefer not to change the logic of `Family`, but I'm wondering if that's what we have to do...


---

Comment by tscrim created at 2015-06-22 04:23:02

Changing status from needs_review to needs_work.


---

Comment by nthiery created at 2015-06-22 11:20:16

Very briefly for now: +1 to improving term/monomial in this direction (with a check=True/False additional argument).

Cheers,


---

Comment by git created at 2016-05-26 10:39:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.
