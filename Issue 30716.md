# Issue 30716: Implicit line continuation in callable symbolic expression

archive/issues_030716.json:
```json
{
    "body": "CC:  @strogdon @egourgoulhon @kliem @slel\n\nKeywords: line continuation symbolic expression preparser parentheses\n\nReported in comment:19:ticket:30928\n\n\n```python\nsage: f(x) = (x +  \n....:         1)                                                                                    \n  File \"<ipython-input-10-ae23cb631161>\", line 1\n    __tmp__=var(\"x\"); f = symbolic_expression((x + ).function(x)\n                                                   ^\nSyntaxError: invalid syntax\n```\n\n\n`sage.repl.preparse.preparse_calculus` needs to be modified to accommodate implicit line continuations such as inside parentheses, brackets, and braces.\n\nIssue created by migration from https://trac.sagemath.org/ticket/30953\n\n",
    "created_at": "2020-11-23T18:12:17Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Implicit line continuation in callable symbolic expression",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30716",
    "user": "https://github.com/jcamp0x2a"
}
```
CC:  @strogdon @egourgoulhon @kliem @slel

Keywords: line continuation symbolic expression preparser parentheses

Reported in comment:19:ticket:30928


```python
sage: f(x) = (x +  
....:         1)                                                                                    
  File "<ipython-input-10-ae23cb631161>", line 1
    __tmp__=var("x"); f = symbolic_expression((x + ).function(x)
                                                   ^
SyntaxError: invalid syntax
```


`sage.repl.preparse.preparse_calculus` needs to be modified to accommodate implicit line continuations such as inside parentheses, brackets, and braces.

Issue created by migration from https://trac.sagemath.org/ticket/30953





---

archive/issue_comments_438640.json:
```json
{
    "body": "I've just been struck by a silent failure (!) version of this bug. A minimal version is\n\n```\nsage: f(x) = 1/2*(1 + x \n....:             + x^2)                                                                            \nsage: f                                                                                             \nx |--> x^2 + 1/2*x + 1/2\n```\n\nThis issue is present in Sage 9.1, 9.2 and 9.3.beta3.",
    "created_at": "2020-12-14T20:20:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438640",
    "user": "https://github.com/egourgoulhon"
}
```

I've just been struck by a silent failure (!) version of this bug. A minimal version is

```
sage: f(x) = 1/2*(1 + x 
....:             + x^2)                                                                            
sage: f                                                                                             
x |--> x^2 + 1/2*x + 1/2
```

This issue is present in Sage 9.1, 9.2 and 9.3.beta3.



---

archive/issue_comments_438641.json:
```json
{
    "body": "Because this is a silent failure in an elementary operation.",
    "created_at": "2020-12-14T20:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438641",
    "user": "https://github.com/egourgoulhon"
}
```

Because this is a silent failure in an elementary operation.



---

archive/issue_comments_438642.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2020-12-14T20:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438642",
    "user": "https://github.com/egourgoulhon"
}
```

Changing priority from major to critical.



---

archive/issue_comments_438643.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-09-16T14:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438643",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_438644.json:
```json
{
    "body": "Only works in the interactive shell so far and not when parsing `*.sage` files.\n----\nNew commits:",
    "created_at": "2021-09-16T14:49:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438644",
    "user": "https://github.com/kliem"
}
```

Only works in the interactive shell so far and not when parsing `*.sage` files.
----
New commits:



---

archive/issue_comments_438645.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-09-21T15:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438645",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_438646.json:
```json
{
    "body": "I'm reworking the entire `preparse` now.\n\nThere is so much basic stuff that is just not working, e.g. line continuation for\n\n\n```\nsage: def foo():\n....:     a = 2312334432134.factor()\n```\n",
    "created_at": "2021-09-21T15:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438646",
    "user": "https://github.com/kliem"
}
```

I'm reworking the entire `preparse` now.

There is so much basic stuff that is just not working, e.g. line continuation for


```
sage: def foo():
....:     a = 2312334432134.factor()
```




---

archive/issue_comments_438647.json:
```json
{
    "body": "In #31951#comment:42 I suggest a simple fix for #31951 and doing the more elaborate work here.\n----\nNew commits:",
    "created_at": "2021-09-27T21:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438647",
    "user": "https://github.com/kliem"
}
```

In #31951#comment:42 I suggest a simple fix for #31951 and doing the more elaborate work here.
----
New commits:



---

archive/issue_comments_438648.json:
```json
{
    "body": "Renamed the branch and added to commits.\n----\nNew commits:",
    "created_at": "2021-09-27T21:56:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438648",
    "user": "https://github.com/kliem"
}
```

Renamed the branch and added to commits.
----
New commits:



---

archive/issue_comments_438649.json:
```json
{
    "body": "Fixed in #31951.",
    "created_at": "2021-09-28T16:19:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438649",
    "user": "https://github.com/kwankyu"
}
```

Fixed in #31951.



---

archive/issue_comments_438650.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-09-28T16:19:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438650",
    "user": "https://github.com/kwankyu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_438651.json:
```json
{
    "body": "This is fixed by #31951.",
    "created_at": "2021-10-01T06:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438651",
    "user": "https://github.com/kliem"
}
```

This is fixed by #31951.



---

archive/issue_comments_438652.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-10-01T06:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438652",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_438653.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-10-04T23:44:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30716",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30716#issuecomment-438653",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
