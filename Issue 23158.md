# Issue 23158: Use singular for quo_rem  of multivariate polynomial over the integers

Issue created by migration from Trac.

Original creator: mmarco

Original creation time: 2017-07-10 11:50:51

CC:  vdelecroix rws

Currently the quo_rem method of multipolynomial_libsingular only relies on Singular if the base ring is a field.

For the case of integers, it falls back to a very slow python implementation. However, Singular can handle that case too.


---

Comment by chapoton created at 2017-07-10 16:46:02

forgot to push ?


---

Comment by git created at 2017-07-10 17:05:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmarco created at 2017-07-10 17:05:58

Actually i forgot to commit ;)


---

Comment by chapoton created at 2017-07-11 06:14:40

is this needs review ? patchbot is green.


---

Comment by mmarco created at 2017-07-11 08:20:42

I guess so.


---

Comment by mmarco created at 2017-07-11 08:20:42

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-07-11 08:24:01

Maybe you can provide some timings (before / after) ?


---

Comment by mmarco created at 2017-07-11 08:52:30

With simple cases the differences are not significant. But when we go to slightly larger cases, we have a huge improvement.

With an example taken from [1].

Before:

```
sage: R.<x,y,z,t,u> = PolynomialRing(ZZ)
sage: f = (1 + x + y + 2*z^2 + 3*t^3 + 5*u^5)^5
sage: g = (1 + u + t + 2*z^2 + 3*y^3 + 5*x^5)^5
sage: p = f*g
sage: %time _ = p.quo_rem(f)
CPU times: user 5.69 s, sys: 5 ms, total: 5.69 s
Wall time: 5.71 s
```


After:


```
sage: R.<x,y,z,t,u> = PolynomialRing(ZZ)
sage: f = (1 + x + y + 2*z^2 + 3*t^3 + 5*u^5)^5
sage: g = (1 + u + t + 2*z^2 + 3*y^3 + 5*x^5)^5
sage: p = f*g
sage: %time _ = p.quo_rem(f)
CPU times: user 79 ms, sys: 0 ns, total: 79 ms
Wall time: 79.3 ms
```


If we raise the exponent of f and g to 6, according to [1] the previous implementation goes to more than 100 seconds. The singular one gets about half a second.



[https://wbhart.blogspot.com.es/2017/07/update-on-fast-multivariate-polynomial.html](https://wbhart.blogspot.com.es/2017/07/update-on-fast-multivariate-polynomial.html)


---

Comment by vdelecroix created at 2017-07-14 13:57:12

Wouldn't make sense to have an `algorithm` option?


---

Comment by kedlaya created at 2017-08-22 22:20:49

Replying to [comment:10 vdelecroix]:
> Wouldn't make sense to have an `algorithm` option?

Yes, perhaps soon `algorithm="FLINT"` might become an option!


---

Comment by jpflori created at 2017-08-23 23:03:47

Changing status from needs_review to positive_review.


---

Comment by jpflori created at 2017-08-23 23:03:47

I guess we would like to have a completely new class for multivariate polynomials using flint, not just using the division from flint.
So let's get this in already.


---

Comment by vbraun created at 2017-08-29 19:51:01

Resolution: fixed
