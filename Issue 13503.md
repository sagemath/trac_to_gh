# Issue 13503: word string representation is sometimes ambigous

Issue created by migration from Trac.

Original creator: slabbe

Original creation time: 2012-11-13 11:18:10

Assignee: slabbe

CC:  slelievre vdelecroix slabbe

Again reported to me by Timo Jolivet, sometimes the string representation is ambiguous:


```
sage: a = WordMorphism({1:[1,2],2:[12],12:[1,2]})
sage: print a
WordMorphism: 1->12, 12->12, 2->12
```



---

Comment by slelievre created at 2022-03-11 14:22:24

Changing keywords from "" to "word, string, repr, print, comma".


---

Comment by DavidLowry created at 2022-03-16 22:28:07

I just pushed a commit with one possible resolution. Roughly, I think that any resolution of this ambiguity should be along these lines. My logic was that potential ambiguities are more likely when the domain letters have length larger than 1. Whenever this occurs, the string representation should always use the letter separator (as defined in `WordOptions(letter_separator=',')`).

Now the behavior would be like

```
    sage: a = WordMorphism({1: [1, 2], 2: [12], 12:[1, 2]})
    sage: print(a)
    1->1,2, 12->1,2, 2->12
    sage: WordOptions(letter_separator=":")
    sage: print(a)
    1->1:2, 12->1:2, 2->12
```


I note however that this is not a very sophisticated idea. For example, we would also have

```
    sage: a = WordMorphism({1: [1, 3], 2: [12], 12:[1, 3], 3:1})
    sage: print(a)
    1->1,3, 12->1,3, 2->12, 3->1
```

even though it is technically possible to realize that there wouldn't be any ambiguities even without the additional separators. This affects three current examples in the documentation. These are

```diff
diff /src/sage/combinat/words/morphism.py
`@``@` -353,7 +395,7 `@``@` class WordMorphism(SageObject):
             sage: WordMorphism({2:[4,5,6], 3:123})
-            WordMorphism: 2->456, 3->123
+            WordMorphism: 2->4,5,6, 3->123

`@``@` -366,7 +408,7 `@``@` class WordMorphism(SageObject):
             sage: WordMorphism({(1,2):'ab', 'a': ['c', (1,2), 'a']})
-            WordMorphism: (1, 2)->ab, a->c,(1, 2),a
+            WordMorphism: (1, 2)->a,b, a->c,(1, 2),a

diff /src/sage/combinat/e_one_star.py
`@``@` -178,7 +178,7 `@``@`
     sage: sigma = WordMorphism({1:[1,2],2:[1,3],3:[1,4],4:[1,5],5:[1,6],6:[1,7],7:[1,8],8:[1,9],9:[1,10],10:[1,11],11:
[1,12],12:[1]})
     sage: E = E1Star(sigma)
     sage: E
-    E_1^*(1->12, 10->1,11, 11->1,12, 12->1, 2->13, 3->14, 4->15, 5->16, 6->17, 7->18, 8->19, 9->1,10)
+    E_1^*(1->1,2, 10->1,11, 11->1,12, 12->1, 2->1,3, 3->1,4, 4->1,5, 5->1,6, 6->1,7, 7->1,8, 8->1,9, 9->1,10)
```


Of these, the first two aren't __technically__ ambiguous, but the last one is. I don't think it's worth trying to recognize when the output is or isn't technically ambiguous, and instead be safe.
----
New commits:


---

Comment by DavidLowry created at 2022-03-16 22:28:07

Changing status from new to needs_review.


---

Comment by tscrim created at 2022-03-18 01:35:27

Changing status from needs_review to needs_work.


---

Comment by tscrim created at 2022-03-18 01:35:27

+1 on fixing this. I don't think it is worth the trouble of being more precise about what could not be ambiguous. Although the ambiguity actually comes from higher up with printing the words:

```
sage: a(1)
word: 12
sage: a(2)
word: 12
sage: list(a(1))
[1, 2]
sage: list(a(2))
[12]
```

So I think it should be changed in printing the word to resolve ambiguities there.
