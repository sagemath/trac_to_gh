# Issue 12841: Update to python-2.7.3

archive/issues_012841.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  fbissey novoselt\n\nPython 2.7.2 distutils have a bug on ext4 or other filesystems with sub-second resolution. The result is that some source files are copied unnecessarily. This is somewhat annoying in `sage -b`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13013\n\n",
    "created_at": "2012-05-25T17:55:20Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0.1",
    "title": "Update to python-2.7.3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12841",
    "user": "vbraun"
}
```
Assignee: tbd

CC:  fbissey novoselt

Python 2.7.2 distutils have a bug on ext4 or other filesystems with sub-second resolution. The result is that some source files are copied unnecessarily. This is somewhat annoying in `sage -b`.

Issue created by migration from https://trac.sagemath.org/ticket/13013





---

archive/issue_comments_154321.json:
```json
{
    "body": "Our `setup.py` needed some fixes to work with the new python, most notably you need to tell it to have at least one thread. Also fixed some other warts that annoyed me, like the \n\n```\nsetup.py:644: UserWarning: could not find dependency <vector> included in /home/vbraun/opt/sage-5.0/local/lib/python/site-packages/Cython/Includes/libcpp/vector.pxd. I will assume it is a system C/C++ header.\n```\n",
    "created_at": "2012-05-25T19:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154321",
    "user": "vbraun"
}
```

Our `setup.py` needed some fixes to work with the new python, most notably you need to tell it to have at least one thread. Also fixed some other warts that annoyed me, like the 

```
setup.py:644: UserWarning: could not find dependency <vector> included in /home/vbraun/opt/sage-5.0/local/lib/python/site-packages/Cython/Includes/libcpp/vector.pxd. I will assume it is a system C/C++ header.
```




---

archive/issue_comments_154322.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-25T19:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154322",
    "user": "vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_154323.json:
```json
{
    "body": "spkg diff for review purposes only",
    "created_at": "2012-05-25T19:30:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154323",
    "user": "vbraun"
}
```

spkg diff for review purposes only



---

archive/issue_comments_154324.json:
```json
{
    "body": "Attachment [python-spkg.diff](tarball://root/attachments/some-uuid/ticket13013/python-spkg.diff) by fbissey created at 2012-05-25 20:11:07\n\nI think one doctest may need fixing, I don't have the particular at hand because my work computer is switched off.",
    "created_at": "2012-05-25T20:11:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154324",
    "user": "fbissey"
}
```

Attachment [python-spkg.diff](tarball://root/attachments/some-uuid/ticket13013/python-spkg.diff) by fbissey created at 2012-05-25 20:11:07

I think one doctest may need fixing, I don't have the particular at hand because my work computer is switched off.



---

archive/issue_comments_154325.json:
```json
{
    "body": "I am getting\n\n```\nsage -t -long devel/sage-main/sage/misc/prandom.py\n**********************************************************************\nFile \"/tmp/sage-5.0/devel/sage-main/sage/misc/prandom.py\", line 211:\n    sage: [expovariate(0.001) for i in range(3)]\nExpected:\n    [2194.27528710212, 664.856145830767, 3108.01255906546]\nGot:\n    [118.152309288166, 722.261959038118, 45.7190543690470]\n**********************************************************************\nFile \"/tmp/sage-5.0/devel/sage-main/sage/misc/prandom.py\", line 213:\n    sage: [expovariate(1.0) for i in range(3)]\nExpected:\n    [1.10114367058632, 0.652772818610748, 1.69983589896220]\nGot:\n    [0.404201816061304, 0.735220464997051, 0.201765578600627]\n**********************************************************************\nFile \"/tmp/sage-5.0/devel/sage-main/sage/misc/prandom.py\", line 215:\n    sage: [expovariate(1000) for i in range(3)]\nExpected:\n    [0.0003554358393809391, 0.0025254102812587195, 0.0001175899408167489]\nGot:\n    [0.0012068700332283973, 8.340929747302108e-05, 0.00219877067980605]\n**********************************************************************\n1 items had failures:\n   3 of   6 in __main__.example_11\n***Test Failed*** 3 failures.\n```\n",
    "created_at": "2012-05-25T23:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154325",
    "user": "novoselt"
}
```

I am getting

```
sage -t -long devel/sage-main/sage/misc/prandom.py
**********************************************************************
File "/tmp/sage-5.0/devel/sage-main/sage/misc/prandom.py", line 211:
    sage: [expovariate(0.001) for i in range(3)]
Expected:
    [2194.27528710212, 664.856145830767, 3108.01255906546]
Got:
    [118.152309288166, 722.261959038118, 45.7190543690470]
**********************************************************************
File "/tmp/sage-5.0/devel/sage-main/sage/misc/prandom.py", line 213:
    sage: [expovariate(1.0) for i in range(3)]
Expected:
    [1.10114367058632, 0.652772818610748, 1.69983589896220]
Got:
    [0.404201816061304, 0.735220464997051, 0.201765578600627]
**********************************************************************
File "/tmp/sage-5.0/devel/sage-main/sage/misc/prandom.py", line 215:
    sage: [expovariate(1000) for i in range(3)]
Expected:
    [0.0003554358393809391, 0.0025254102812587195, 0.0001175899408167489]
Got:
    [0.0012068700332283973, 8.340929747302108e-05, 0.00219877067980605]
**********************************************************************
1 items had failures:
   3 of   6 in __main__.example_11
***Test Failed*** 3 failures.
```




---

archive/issue_comments_154326.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd40.5\".",
    "created_at": "2012-05-26T02:04:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154326",
    "user": "vbraun"
}
```

Changing keywords from "" to "sd40.5".



---

archive/issue_comments_154327.json:
```json
{
    "body": "That's the one I got in sage-on-gentoo when we did move to 2.7.3. I think that's the exact same value but that's a memory from 3 weeks ago. We also need to check if it is platform dependent.",
    "created_at": "2012-05-26T02:07:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154327",
    "user": "fbissey"
}
```

That's the one I got in sage-on-gentoo when we did move to 2.7.3. I think that's the exact same value but that's a memory from 3 weeks ago. We also need to check if it is platform dependent.



---

archive/issue_comments_154328.json:
```json
{
    "body": "This is the upstream change http://hg.python.org/releasing/2.7.3/rev/4970fa3c4a0b\n\nOn the plus side, its as platform-independent as it was before.",
    "created_at": "2012-05-26T05:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154328",
    "user": "vbraun"
}
```

This is the upstream change http://hg.python.org/releasing/2.7.3/rev/4970fa3c4a0b

On the plus side, its as platform-independent as it was before.



---

archive/issue_comments_154329.json:
```json
{
    "body": "Attachment [trac_13013_setup_deps.patch](tarball://root/attachments/some-uuid/ticket13013/trac_13013_setup_deps.patch) by vbraun created at 2012-05-26 06:16:20\n\nUpdated patch",
    "created_at": "2012-05-26T06:16:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154329",
    "user": "vbraun"
}
```

Attachment [trac_13013_setup_deps.patch](tarball://root/attachments/some-uuid/ticket13013/trac_13013_setup_deps.patch) by vbraun created at 2012-05-26 06:16:20

Updated patch



---

archive/issue_comments_154330.json:
```json
{
    "body": "All doctests pass now...",
    "created_at": "2012-05-26T06:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154330",
    "user": "vbraun"
}
```

All doctests pass now...



---

archive/issue_comments_154331.json:
```json
{
    "body": "I'll have a look.",
    "created_at": "2012-05-26T16:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154331",
    "user": "jdemeyer"
}
```

I'll have a look.



---

archive/issue_comments_154332.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-26T18:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154332",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_154333.json:
```json
{
    "body": "Looks good to me.  The package works and the changes to `setup.py` make sense.",
    "created_at": "2012-05-26T18:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154333",
    "user": "jdemeyer"
}
```

Looks good to me.  The package works and the changes to `setup.py` make sense.



---

archive/issue_comments_154334.json:
```json
{
    "body": "Many files in `src/` are not world-readable.  This should be fixed to be safe.",
    "created_at": "2012-05-29T00:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154334",
    "user": "jdemeyer"
}
```

Many files in `src/` are not world-readable.  This should be fixed to be safe.



---

archive/issue_comments_154335.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-05-29T00:25:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154335",
    "user": "jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_154336.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-05-29T03:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154336",
    "user": "jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_154337.json:
```json
{
    "body": "Permissions fixed.",
    "created_at": "2012-05-29T03:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154337",
    "user": "jdemeyer"
}
```

Permissions fixed.



---

archive/issue_comments_154338.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-05-31T13:41:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12841",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12841#issuecomment-154338",
    "user": "jdemeyer"
}
```

Resolution: fixed
