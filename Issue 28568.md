# Issue 28568: Remove sagenb from DOC_DEPENDENCIES

Issue created by migration from https://trac.sagemath.org/ticket/28805

Original creator: fbissey

Original creation time: 2019-11-25 22:56:14

CC:  jhpalmieri embray isuruf @timokau

We took care of removing all the dependencies to sagenb during build, in particular, the build of documentation. We also have switched to python3 by default but sagenb is still installed in python3 builds because of its presence in `DOC_DEPENDENCIES`. It should be removed.


---

Comment by fbissey created at 2019-11-25 23:03:09

Changing status from new to needs_review.


---

Comment by fbissey created at 2019-11-25 23:03:09

And with this commit `sagenb` is well and truly optional. Its installation will require manual intervention.
----
New commits:


---

Comment by jhpalmieri created at 2019-11-26 04:44:31

I'm seeing doctest failures in `tests/cmdline.py` because the script `sage-rst2txt` tries to import `sagenb`. I guess that test should be tagged `# py2`. Actually, should many of the `py2` tags in that file be changed to `optional: sagenb`?

Maybe it's better to keep them as `py2` so that we can find them and delete them more easily, once we drop support for Python 2.


---

Comment by fbissey created at 2019-11-26 05:17:32

Actually I removed all those from sage-on-gentoo. I was wondering why I was the only one seemingly seeing these failures.
----
New commits:


---

Comment by chapoton created at 2019-11-27 08:22:02

looks good to me. Any other opinion ?


---

Comment by jhpalmieri created at 2019-11-27 17:05:39

It works for me. I'm happy with the basic setup, so someone should review my commit.


---

Comment by dimpase created at 2019-11-27 18:27:15

does `rst2txt` need Pyhton2, or sagenb? and if yes, why?


---

Comment by jhpalmieri created at 2019-11-27 18:32:30

The script `sage-rst2txt` contains the line

```
from sagenb.notebook.docHTMLProcessor import docutilsHTMLProcessor
```

and that import is in fact used.

As I said in comment:2, we could tag the relevant tests as `# optional - sagenb`, but I think we will eventually want to delete tests marked `# py2`, and then we might forget to deal with tests marked with `sagenb` instead.


---

Comment by dimpase created at 2019-11-27 19:48:50

`docutilsHTMLProcessor` can be trivially pulled out of sagenb. I don't know whether it's of any use though, but still...


---

Comment by jhpalmieri created at 2019-11-27 20:12:20

Replying to [comment:9 dimpase]:
> `docutilsHTMLProcessor` can be trivially pulled out of sagenb. I don't know whether it's of any use though, but still...

The purpose of `sage-rst2txt` is "Translate a rst file into a worksheet txt file." I'm not sure what a "worksheet txt file" is, but I think it's for SageNB. So I don't see the point of separating `sage-rst2txt` from `sagenb`.


---

Comment by dimpase created at 2019-11-27 20:18:15

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2019-11-27 20:18:15

OK, fine, I should have read the output of `sage --rst2txt`, sorry. Thanks.


---

Comment by vbraun created at 2019-11-29 23:57:41

Resolution: fixed
