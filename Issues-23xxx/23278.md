# Issue 23278: Initial bounds for solutions to S-unit equation

archive/issues_023278.json:
```json
{
    "body": "CC:  malmskog\n\nKeywords: S-unit equation, sd87, days94\n\nThe following functions are used to determine initial bounds for the exponents of solutions to the S-unit equation.  Those bounds are specifically K_0 and K_1.  These will later be refined using LLL methods.\n\ncolumn_log,\nc3_func,\nc4_func,\nbeta_k,\nmus,\nc8_c9_func,\nc11_func,\nc13_func,\nK0_func,\nK1_func\n\nIssue created by migration from https://trac.sagemath.org/ticket/23515\n\n",
    "closed_at": "2018-08-29T22:27:42Z",
    "created_at": "2017-07-22T11:58:09Z",
    "labels": [
        "component: number fields",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "Initial bounds for solutions to S-unit equation",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23278",
    "user": "https://github.com/mckenziewest"
}
```
CC:  malmskog

Keywords: S-unit equation, sd87, days94

The following functions are used to determine initial bounds for the exponents of solutions to the S-unit equation.  Those bounds are specifically K_0 and K_1.  These will later be refined using LLL methods.

column_log,
c3_func,
c4_func,
beta_k,
mus,
c8_c9_func,
c11_func,
c13_func,
K0_func,
K1_func

Issue created by migration from https://trac.sagemath.org/ticket/23515





---

archive/issue_comments_325384.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-07T15:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325384",
    "user": "https://github.com/mckenziewest"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_325385.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-08-07T15:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325385",
    "user": "https://github.com/mckenziewest"
}
```

New commits:



---

archive/issue_comments_325386.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-07T16:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325386",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325387.json:
```json
{
    "body": "All tests pass and it looks pretty reasonable, so let's get this in!\n\n* You should use `R.pi()` rather than the `pi` from `math`.\n* You import numpy but don't use it; is it used in a followup ticket?\n* There are various points where you refer to `pair[0]` and `pair[1]` explicitly; I find it easier to read if you instead use Python's ability to assign to tuples.  Also, there are points where you use a list with two elements when a tuple would be more appropriate.  For example, you could change the definition of `mus` from\n\n```\nbetas = SUK.fundamental_units()\nbeta_and_ns = [[beta,beta.valuation(v)] for beta in betas]\nif all(pair[1]==0 for pair in beta_and_ns):\n    return betas\nelse:\n    good_pair = beta_k(beta_and_ns)\n    temp = [(beta[0]**good_pair[1])*(good_pair[0]**(-beta[1])) for beta in beta_and_ns]\n    temp.remove(1)\n    return temp\n```\nto\n\n```\nbetas = SUK.fundamental_units()\nbeta_and_ns = [(beta,beta.valuation(v)) for beta in betas]\nif all(v==0 for beta, v in beta_and_ns):\n    return betas\nelse:\n    good_beta, good_v = beta_k(beta_and_ns)\n    temp = [(beta**good_v)*(good_beta**(-v)) for beta, v in beta_and_ns]\n    temp.remove(1)\n    return temp\n```\n* You still have some dollar signs, which should be backticks.\n* I find the `NOTE` in the docstring for `possible_mu0s` confusing; is there an error there of some kind?  Wouldn't `|\\alpha_d \\tau_d|_v = 0` imply `\\alpha_d = 0` or `\\tau_d = 0`?\n* While you're fixing things, there's a missing space in `=106`.\n* In Python, explicit numbers are ints, not Sage integers.  This can have some bad effects: `36**num_mus` is probably not as efficient as you might like, `(45/2)` may be `22`\n* `log(p)` is symbolic, which is probably not what you want.  Better would be `R(p).log()`.  Using the `log` method will also save you some `imports`.  Similarly, used `blah.sqrt()` rather than `sqrt(blah)`.\n* For passing doctests, it's good to add a bit of tolerance to your numerical outputs. So, for example, use\n\n```\nsage: c11_func(SUK,phi_real,A) # abs tol 1e-29\n3.255848343572896153455615423662\n```\nthough I think Sage won't actually check that the result is accurate to 29 digits since it uses `RealIntervalField(64)` in the doctest framework and the 64 there is hardcoded....\n* In `c13_func`, if a user passes in a finite place it will implicitly assume that it's complex.  It might be better to check if it's a complex place.\n\n\nFinally, I haven't gone through and checked all of your formulas in detail, compared with the references, etc.  Are there any tests that you could add that would help ensure that you haven't made typos?  There's a lot of detail here that could get messed up.",
    "created_at": "2017-09-08T06:09:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325387",
    "user": "https://github.com/roed314"
}
```

All tests pass and it looks pretty reasonable, so let's get this in!

* You should use `R.pi()` rather than the `pi` from `math`.
* You import numpy but don't use it; is it used in a followup ticket?
* There are various points where you refer to `pair[0]` and `pair[1]` explicitly; I find it easier to read if you instead use Python's ability to assign to tuples.  Also, there are points where you use a list with two elements when a tuple would be more appropriate.  For example, you could change the definition of `mus` from

```
betas = SUK.fundamental_units()
beta_and_ns = [[beta,beta.valuation(v)] for beta in betas]
if all(pair[1]==0 for pair in beta_and_ns):
    return betas
else:
    good_pair = beta_k(beta_and_ns)
    temp = [(beta[0]**good_pair[1])*(good_pair[0]**(-beta[1])) for beta in beta_and_ns]
    temp.remove(1)
    return temp
```
to

```
betas = SUK.fundamental_units()
beta_and_ns = [(beta,beta.valuation(v)) for beta in betas]
if all(v==0 for beta, v in beta_and_ns):
    return betas
else:
    good_beta, good_v = beta_k(beta_and_ns)
    temp = [(beta**good_v)*(good_beta**(-v)) for beta, v in beta_and_ns]
    temp.remove(1)
    return temp
```
* You still have some dollar signs, which should be backticks.
* I find the `NOTE` in the docstring for `possible_mu0s` confusing; is there an error there of some kind?  Wouldn't `|\alpha_d \tau_d|_v = 0` imply `\alpha_d = 0` or `\tau_d = 0`?
* While you're fixing things, there's a missing space in `=106`.
* In Python, explicit numbers are ints, not Sage integers.  This can have some bad effects: `36**num_mus` is probably not as efficient as you might like, `(45/2)` may be `22`
* `log(p)` is symbolic, which is probably not what you want.  Better would be `R(p).log()`.  Using the `log` method will also save you some `imports`.  Similarly, used `blah.sqrt()` rather than `sqrt(blah)`.
* For passing doctests, it's good to add a bit of tolerance to your numerical outputs. So, for example, use

```
sage: c11_func(SUK,phi_real,A) # abs tol 1e-29
3.255848343572896153455615423662
```
though I think Sage won't actually check that the result is accurate to 29 digits since it uses `RealIntervalField(64)` in the doctest framework and the 64 there is hardcoded....
* In `c13_func`, if a user passes in a finite place it will implicitly assume that it's complex.  It might be better to check if it's a complex place.


Finally, I haven't gone through and checked all of your formulas in detail, compared with the references, etc.  Are there any tests that you could add that would help ensure that you haven't made typos?  There's a lot of detail here that could get messed up.



---

archive/issue_comments_325388.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-08T06:12:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325388",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_325389.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-29T01:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325389",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325390.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-09T16:55:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325391.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-10T15:51:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325391",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325392.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-03-27T20:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325392",
    "user": "https://trac.sagemath.org/admin/accounts/users/malmskog"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_325393.json:
```json
{
    "body": "All changes have been made and it is working with the latest version of Sage.",
    "created_at": "2018-03-27T20:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325393",
    "user": "https://trac.sagemath.org/admin/accounts/users/malmskog"
}
```

All changes have been made and it is working with the latest version of Sage.



---

archive/issue_comments_325394.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-03-30T19:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325394",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325395.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-28T10:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325395",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325396.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-28T12:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325396",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325397.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-28T17:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325397",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325398.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-28T18:31:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325398",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325399.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-28T18:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325399",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325400.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-28T20:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325400",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325401.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-29T08:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325401",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325402.json:
```json
{
    "body": "Changing keywords from \"S-unit equation, sd87\" to \"S-unit equation, sd87, days94\".",
    "created_at": "2018-06-29T13:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325402",
    "user": "https://github.com/mckenziewest"
}
```

Changing keywords from "S-unit equation, sd87" to "S-unit equation, sd87, days94".



---

archive/issue_comments_325403.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-30T15:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325403",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325404.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-06-30T15:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325404",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325405.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-02T13:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325406.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-09T21:06:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325406",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_325407.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-23T14:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325407",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_325408.json:
```json
{
    "body": "Looks good to me!",
    "created_at": "2018-08-23T14:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325408",
    "user": "https://github.com/roed314"
}
```

Looks good to me!



---

archive/issue_events_060292.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-08-26T06:21:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23278#event-60292"
}
```



---

archive/issue_events_060293.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-08-29T22:27:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23278#event-60293"
}
```



---

archive/issue_comments_325409.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-29T22:27:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23278",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23278#issuecomment-325409",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
