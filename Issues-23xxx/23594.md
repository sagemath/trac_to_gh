# Issue 23594: Upgrade scipy to 0.19.1

archive/issues_023357.json:
```json
{
    "assignees": [],
    "body": "Routine upgrade. I have enough of seeing various doctests failing in sage-on-gentoo when using this version. \n\ntarball: [https://pypi.python.org/packages/52/67/d9ef9b5058d4a9e3f0ae641ec151790622cbeb37f157de5773358e2bf3da/scipy-0.19.1.tar.gz](https://pypi.python.org/packages/52/67/d9ef9b5058d4a9e3f0ae641ec151790622cbeb37f157de5773358e2bf3da/scipy-0.19.1.tar.gz)\n\nBranch: **[`88d70c6`](https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e)**\n\nReviewer: **Vincent Delecroix, Jean-Pierre Flori**\n\nAuthor: **Fran\u00e7ois Bissey**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23594_\n\n",
    "closed_at": "2017-09-04T06:10:46Z",
    "created_at": "2017-08-07T23:54:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade scipy to 0.19.1",
    "type": "issue",
    "updated_at": "2017-10-13T17:34:15Z",
    "url": "https://github.com/sagemath/sage/issues/23594",
    "user": "https://github.com/kiwifb"
}
```
Routine upgrade. I have enough of seeing various doctests failing in sage-on-gentoo when using this version. 

tarball: [https://pypi.python.org/packages/52/67/d9ef9b5058d4a9e3f0ae641ec151790622cbeb37f157de5773358e2bf3da/scipy-0.19.1.tar.gz](https://pypi.python.org/packages/52/67/d9ef9b5058d4a9e3f0ae641ec151790622cbeb37f157de5773358e2bf3da/scipy-0.19.1.tar.gz)

Branch: **[`88d70c6`](https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e)**

Reviewer: **Vincent Delecroix, Jean-Pierre Flori**

Author: **François Bissey**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/23594_





---

archive/issue_events_325366.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-07T23:54:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325366"
}
```



---

archive/issue_events_325367.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-07T23:54:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325367"
}
```



---

archive/issue_events_325368.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-07T23:54:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325368"
}
```



---

archive/issue_comments_355020.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n Routine upgrade. I have enough of seeing various doctests failing in sage-on-gentoo when using this version. \n+\n+tarball: [https://pypi.python.org/packages/52/67/d9ef9b5058d4a9e3f0ae641ec151790622cbeb37f157de5773358e2bf3da/scipy-0.19.1.tar.gz](https://pypi.python.org/packages/52/67/d9ef9b5058d4a9e3f0ae641ec151790622cbeb37f157de5773358e2bf3da/scipy-0.19.1.tar.gz)\n``````\n",
    "created_at": "2017-08-08T01:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355020",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 Routine upgrade. I have enough of seeing various doctests failing in sage-on-gentoo when using this version. 
+
+tarball: [https://pypi.python.org/packages/52/67/d9ef9b5058d4a9e3f0ae641ec151790622cbeb37f157de5773358e2bf3da/scipy-0.19.1.tar.gz](https://pypi.python.org/packages/52/67/d9ef9b5058d4a9e3f0ae641ec151790622cbeb37f157de5773358e2bf3da/scipy-0.19.1.tar.gz)
``````




---

archive/issue_events_325369.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-08T01:54:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325369"
}
```



---

archive/issue_comments_355021.json:
```json
{
    "body": "Commit: **[`7c600a7`](https://github.com/sagemath/sagetrac-mirror/commit/7c600a76e9003ead3ccfe7377a56a6b6dfb51ce5)**",
    "created_at": "2017-08-08T01:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355021",
    "user": "https://github.com/kiwifb"
}
```

Commit: **[`7c600a7`](https://github.com/sagemath/sagetrac-mirror/commit/7c600a76e9003ead3ccfe7377a56a6b6dfb51ce5)**



---

archive/issue_comments_355022.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/24befd26053e1e3518a0419f8b05cfe408b53613\"><code>24befd2</code></a></td><td><code>changing version number</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbc3a9bc28f523de50d7173b870f5b2a22de70a2\"><code>dbc3a9b</code></a></td><td><code>Merge branch 'develop' into scipy0.19.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1fde6ae05a6aa8781b8df126f68c4702c61d6e20\"><code>1fde6ae</code></a></td><td><code>fix checksums</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49485cde0a359147ac75ec5b887a6595d22e3bb0\"><code>49485cd</code></a></td><td><code>Fixing easy to fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c600a76e9003ead3ccfe7377a56a6b6dfb51ce5\"><code>7c600a7</code></a></td><td><code>Fix optimize doctest after checking that it still does what it supposed to do. Results are more consistent between methods overall.</code></td></tr></table>\n",
    "created_at": "2017-08-08T01:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355022",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/24befd26053e1e3518a0419f8b05cfe408b53613"><code>24befd2</code></a></td><td><code>changing version number</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbc3a9bc28f523de50d7173b870f5b2a22de70a2"><code>dbc3a9b</code></a></td><td><code>Merge branch 'develop' into scipy0.19.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1fde6ae05a6aa8781b8df126f68c4702c61d6e20"><code>1fde6ae</code></a></td><td><code>fix checksums</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49485cde0a359147ac75ec5b887a6595d22e3bb0"><code>49485cd</code></a></td><td><code>Fixing easy to fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c600a76e9003ead3ccfe7377a56a6b6dfb51ce5"><code>7c600a7</code></a></td><td><code>Fix optimize doctest after checking that it still does what it supposed to do. Results are more consistent between methods overall.</code></td></tr></table>




---

archive/issue_comments_355023.json:
```json
{
    "body": "Branch: **[u/fbissey/scipy0.19.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/scipy0.19.1)**",
    "created_at": "2017-08-08T01:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355023",
    "user": "https://github.com/kiwifb"
}
```

Branch: **[u/fbissey/scipy0.19.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/scipy0.19.1)**



---

archive/issue_comments_355024.json:
```json
{
    "body": "Author: **Francois Bissey**",
    "created_at": "2017-08-08T02:21:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355024",
    "user": "https://github.com/kiwifb"
}
```

Author: **Francois Bissey**



---

archive/issue_comments_355025.json:
```json
{
    "body": "Changed author from **Francois Bissey** to **Fran\u00e7ois Bissey**",
    "created_at": "2017-08-08T21:55:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355025",
    "user": "https://github.com/kiwifb"
}
```

Changed author from **Francois Bissey** to **François Bissey**



---

archive/issue_comments_355026.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWouldn't it be better to set some numerical tolerance in `sage/numerical/optimize.py` instead of changing `1.0` into `0.9999999`?",
    "created_at": "2017-08-09T17:05:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355026",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">comment:4</div>

Wouldn't it be better to set some numerical tolerance in `sage/numerical/optimize.py` instead of changing `1.0` into `0.9999999`?



---

archive/issue_comments_355027.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@videlec](#comment:4):\n> Wouldn't it be better to set some numerical tolerance in `sage/numerical/optimize.py` instead of changing `1.0` into `0.9999999`?\n\nI thought of that. At the moment I kept things consistent with other doctests giving the same results. So if using tolerance I think \n* we need to go back to the whole series of doctests not just the ones broken by this upgrade\n* You can you only set one tolerance for one result so you need to align things not with `0.9999999` but with `0.999999` (one less `9`)\n\nThat being said there is already inconsistency in the number of decimals quoted for the results starting with `1.` compared to the one starting with `0.9`. Harmonizing all of this would probably be a good thing.\n\nWould you support touching the other doctest giving similar results to the ones broken by the upgrade?",
    "created_at": "2017-08-09T21:36:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355027",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@videlec](#comment:4):
> Wouldn't it be better to set some numerical tolerance in `sage/numerical/optimize.py` instead of changing `1.0` into `0.9999999`?

I thought of that. At the moment I kept things consistent with other doctests giving the same results. So if using tolerance I think 
* we need to go back to the whole series of doctests not just the ones broken by this upgrade
* You can you only set one tolerance for one result so you need to align things not with `0.9999999` but with `0.999999` (one less `9`)

That being said there is already inconsistency in the number of decimals quoted for the results starting with `1.` compared to the one starting with `0.9`. Harmonizing all of this would probably be a good thing.

Would you support touching the other doctest giving similar results to the ones broken by the upgrade?



---

archive/issue_comments_355028.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@kiwifb](#comment:5):\n> Replying to [@videlec](#comment:4):\n> > Wouldn't it be better to set some numerical tolerance in `sage/numerical/optimize.py` instead of changing `1.0` into `0.9999999`?\n\n>\n> Would you support touching the other doctest giving similar results to the ones broken by the upgrade?\n>\n\nI will.",
    "created_at": "2017-08-10T08:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355028",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@kiwifb](#comment:5):
> Replying to [@videlec](#comment:4):
> > Wouldn't it be better to set some numerical tolerance in `sage/numerical/optimize.py` instead of changing `1.0` into `0.9999999`?

>
> Would you support touching the other doctest giving similar results to the ones broken by the upgrade?
>

I will.



---

archive/issue_comments_355029.json:
```json
{
    "body": "Changed commit from **[`7c600a7`](https://github.com/sagemath/sagetrac-mirror/commit/7c600a76e9003ead3ccfe7377a56a6b6dfb51ce5)** to **[`cbe2690`](https://github.com/sagemath/sagetrac-mirror/commit/cbe2690f4b4fa7bbb6cca1d263be5d90ea69f9e4)**",
    "created_at": "2017-08-20T23:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355029",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7c600a7`](https://github.com/sagemath/sagetrac-mirror/commit/7c600a76e9003ead3ccfe7377a56a6b6dfb51ce5)** to **[`cbe2690`](https://github.com/sagemath/sagetrac-mirror/commit/cbe2690f4b4fa7bbb6cca1d263be5d90ea69f9e4)**



---

archive/issue_comments_355030.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbe2690f4b4fa7bbb6cca1d263be5d90ea69f9e4\"><code>cbe2690</code></a></td><td><code>Use tolerance as much as possible in minimize</code></td></tr></table>\n",
    "created_at": "2017-08-20T23:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355030",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbe2690f4b4fa7bbb6cca1d263be5d90ea69f9e4"><code>cbe2690</code></a></td><td><code>Use tolerance as much as possible in minimize</code></td></tr></table>




---

archive/issue_comments_355031.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nDone! Note that I didn't convert this to use tolerance\n\n```\n    We get additional convergence information with the `verbose` option::\n\n        sage: minimize(f, [.1, .3, .4], algorithm=\"ncg\", verbose=True)\n        Optimization terminated successfully.\n        ...\n        (0.9999999..., 0.999999..., 0.999999...)\n```\nbecause the verbose output message is already caught by `...` and you cannot mix that with `tol`. It just fails, you cannot use `...` and `tol` at the same time.",
    "created_at": "2017-08-20T23:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355031",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:8" align="right">comment:8</div>

Done! Note that I didn't convert this to use tolerance

```
    We get additional convergence information with the `verbose` option::

        sage: minimize(f, [.1, .3, .4], algorithm="ncg", verbose=True)
        Optimization terminated successfully.
        ...
        (0.9999999..., 0.999999..., 0.999999...)
```
because the verbose output message is already caught by `...` and you cannot mix that with `tol`. It just fails, you cannot use `...` and `tol` at the same time.



---

archive/issue_comments_355032.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSomething on this branch was meant for another completely unrelated one. I'll try to fix it before putting it back to review.",
    "created_at": "2017-08-20T23:40:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355032",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

Something on this branch was meant for another completely unrelated one. I'll try to fix it before putting it back to review.



---

archive/issue_events_325370.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-20T23:40:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325370"
}
```



---

archive/issue_events_325371.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-20T23:40:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325371"
}
```



---

archive/issue_comments_355033.json:
```json
{
    "body": "Changed commit from **[`cbe2690`](https://github.com/sagemath/sagetrac-mirror/commit/cbe2690f4b4fa7bbb6cca1d263be5d90ea69f9e4)** to **[`5cb42f1`](https://github.com/sagemath/sagetrac-mirror/commit/5cb42f1b8e0d6daf45078586e19a7cded50c2d9b)**",
    "created_at": "2017-08-20T23:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355033",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cbe2690`](https://github.com/sagemath/sagetrac-mirror/commit/cbe2690f4b4fa7bbb6cca1d263be5d90ea69f9e4)** to **[`5cb42f1`](https://github.com/sagemath/sagetrac-mirror/commit/5cb42f1b8e0d6daf45078586e19a7cded50c2d9b)**



---

archive/issue_comments_355034.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5cb42f1b8e0d6daf45078586e19a7cded50c2d9b\"><code>5cb42f1</code></a></td><td><code>remove documentation changes meant for another ticket</code></td></tr></table>\n",
    "created_at": "2017-08-20T23:45:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355034",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5cb42f1b8e0d6daf45078586e19a7cded50c2d9b"><code>5cb42f1</code></a></td><td><code>remove documentation changes meant for another ticket</code></td></tr></table>




---

archive/issue_comments_355035.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI am actually glad to have found that bit. I thought I had lost it.",
    "created_at": "2017-08-20T23:46:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355035",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

I am actually glad to have found that bit. I thought I had lost it.



---

archive/issue_events_325372.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-20T23:46:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325372"
}
```



---

archive/issue_events_325373.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-20T23:46:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325373"
}
```



---

archive/issue_comments_355036.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@sagetrac-git](#comment:7):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n\n|                                                                                                                                                 |                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[cbe2690](https://github.com/sagemath/sagetrac-mirror/commit/cbe2690f4b4fa7bbb6cca1d263be5d90ea69f9e4)|`Use tolerance as much as possible in minimize`|\nCould you do the same for the other numerical values you truncated with `...` or does it make no sense?",
    "created_at": "2017-08-21T17:48:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355036",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@sagetrac-git](#comment:7):
> Branch pushed to git repo; I updated commit sha1. New commits:

|                                                                                                                                                 |                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[cbe2690](https://github.com/sagemath/sagetrac-mirror/commit/cbe2690f4b4fa7bbb6cca1d263be5d90ea69f9e4)|`Use tolerance as much as possible in minimize`|
Could you do the same for the other numerical values you truncated with `...` or does it make no sense?



---

archive/issue_comments_355037.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYou mean in the other files? It can be done, but in that case I will only touch those particular tests. In optimize.py we had a whole family of tests that I kept coherent as much as possible - including the ones that weren't affected by the upgrade.",
    "created_at": "2017-08-21T21:21:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355037",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:13" align="right">comment:13</div>

You mean in the other files? It can be done, but in that case I will only touch those particular tests. In optimize.py we had a whole family of tests that I kept coherent as much as possible - including the ones that weren't affected by the upgrade.



---

archive/issue_comments_355038.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix, Jean-Pierre Flori**",
    "created_at": "2017-08-21T21:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355038",
    "user": "https://github.com/jpflori"
}
```

Reviewer: **Vincent Delecroix, Jean-Pierre Flori**



---

archive/issue_events_325374.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2017-08-21T21:31:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325374"
}
```



---

archive/issue_events_325375.json:
```json
{
    "actor": "https://github.com/jpflori",
    "created_at": "2017-08-21T21:31:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325375"
}
```



---

archive/issue_comments_355039.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nNah, that's ok as it is.\nLGTM.",
    "created_at": "2017-08-21T21:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355039",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:14" align="right">comment:14</div>

Nah, that's ok as it is.
LGTM.



---

archive/issue_events_325376.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-25T23:12:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325376"
}
```



---

archive/issue_events_325377.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-25T23:12:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325377"
}
```



---

archive/issue_comments_355040.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n\n```\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/numerical_sage/weave.rst\", line 13, in doc.en.thematic_tutorials.numerical_sage.weave\nFailed example:\n    from scipy import weave\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 515, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 885, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest doc.en.thematic_tutorials.numerical_sage.weave[0]>\", line 1, in <module>\n        from scipy import weave\n    ImportError: cannot import name weave\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/numerical_sage/weave.rst\", line 15, in doc.en.thematic_tutorials.numerical_sage.weave\nFailed example:\n    from scipy.weave import converters\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 515, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 885, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest doc.en.thematic_tutorials.numerical_sage.weave[1]>\", line 1, in <module>\n        from scipy.weave import converters\n    ImportError: No module named weave\n**********************************************************************\n1 item had failures:\n   2 of   3 in doc.en.thematic_tutorials.numerical_sage.weave\n    [2 tests, 2 failures, 0.21 s]\n----------------------------------------------------------------------\nsage -t --long src/doc/en/thematic_tutorials/numerical_sage/weave.rst  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2017-08-25T23:12:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355040",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>


```
**********************************************************************
File "src/doc/en/thematic_tutorials/numerical_sage/weave.rst", line 13, in doc.en.thematic_tutorials.numerical_sage.weave
Failed example:
    from scipy import weave
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.numerical_sage.weave[0]>", line 1, in <module>
        from scipy import weave
    ImportError: cannot import name weave
**********************************************************************
File "src/doc/en/thematic_tutorials/numerical_sage/weave.rst", line 15, in doc.en.thematic_tutorials.numerical_sage.weave
Failed example:
    from scipy.weave import converters
Exception raised:
    Traceback (most recent call last):
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 515, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 885, in compile_and_execute
        exec(compiled, globs)
      File "<doctest doc.en.thematic_tutorials.numerical_sage.weave[1]>", line 1, in <module>
        from scipy.weave import converters
    ImportError: No module named weave
**********************************************************************
1 item had failures:
   2 of   3 in doc.en.thematic_tutorials.numerical_sage.weave
    [2 tests, 2 failures, 0.21 s]
----------------------------------------------------------------------
sage -t --long src/doc/en/thematic_tutorials/numerical_sage/weave.rst  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_comments_355041.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nNot sure how it escaped me yet. Or the _reviewers_. After digging upstream, `weave` has been deprecated for some time. The plan has been to remove it before `1.0` (whenever that happens) for a while. It was also the only module not to have a python 3 version. Now it's gone (I think 0.18.x was the latest version to include it).\n\nIn that light, I plan to surgically remove all instances of `weave` in sage, which apparently doesn't extend further than the documentation. Opinions?",
    "created_at": "2017-08-26T05:58:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355041",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:16" align="right">comment:16</div>

Not sure how it escaped me yet. Or the _reviewers_. After digging upstream, `weave` has been deprecated for some time. The plan has been to remove it before `1.0` (whenever that happens) for a while. It was also the only module not to have a python 3 version. Now it's gone (I think 0.18.x was the latest version to include it).

In that light, I plan to surgically remove all instances of `weave` in sage, which apparently doesn't extend further than the documentation. Opinions?



---

archive/issue_comments_355042.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI vote for: just remove completely the offending file\n\nsrc/doc/en/thematic_tutorials/numerical_sage/weave.rst",
    "created_at": "2017-08-26T13:49:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355042",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

I vote for: just remove completely the offending file

src/doc/en/thematic_tutorials/numerical_sage/weave.rst



---

archive/issue_comments_355043.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThere are a few extra references in other files (all in the doc) but I guess your vote covers that.",
    "created_at": "2017-08-26T20:02:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355043",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:18" align="right">comment:18</div>

There are a few extra references in other files (all in the doc) but I guess your vote covers that.



---

archive/issue_comments_355044.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e\"><code>88d70c6</code></a></td><td><code>Remove references to weave now that it is gone from scipy.</code></td></tr></table>\n",
    "created_at": "2017-08-28T02:30:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355044",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e"><code>88d70c6</code></a></td><td><code>Remove references to weave now that it is gone from scipy.</code></td></tr></table>




---

archive/issue_comments_355045.json:
```json
{
    "body": "Changed commit from **[`5cb42f1`](https://github.com/sagemath/sagetrac-mirror/commit/5cb42f1b8e0d6daf45078586e19a7cded50c2d9b)** to **[`88d70c6`](https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e)**",
    "created_at": "2017-08-28T02:30:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355045",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5cb42f1`](https://github.com/sagemath/sagetrac-mirror/commit/5cb42f1b8e0d6daf45078586e19a7cded50c2d9b)** to **[`88d70c6`](https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e)**



---

archive/issue_events_325378.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-28T02:33:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325378"
}
```



---

archive/issue_events_325379.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-08-28T02:33:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325379"
}
```



---

archive/issue_comments_355046.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nOk, back into review. I removed the offending documentation file and removed references to `weave` in the other files in the numerical_sage section. Please do a proof read to make sure it makes sense.",
    "created_at": "2017-08-28T02:33:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355046",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:20" align="right">comment:20</div>

Ok, back into review. I removed the offending documentation file and removed references to `weave` in the other files in the numerical_sage section. Please do a proof read to make sure it makes sense.



---

archive/issue_comments_355047.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAnyone for moving this back on track?",
    "created_at": "2017-08-31T05:40:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355047",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:21" align="right">comment:21</div>

Anyone for moving this back on track?



---

archive/issue_comments_355048.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nrunning the tests now",
    "created_at": "2017-08-31T15:46:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355048",
    "user": "https://github.com/videlec"
}
```

<div id="comment:22" align="right">comment:22</div>

running the tests now



---

archive/issue_comments_355049.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\npass!",
    "created_at": "2017-08-31T17:27:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355049",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">comment:23</div>

pass!



---

archive/issue_events_325380.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-08-31T17:27:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325380"
}
```



---

archive/issue_events_325381.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-08-31T17:27:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325381"
}
```



---

archive/issue_comments_355050.json:
```json
{
    "body": "Changed branch from **[u/fbissey/scipy0.19.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/scipy0.19.1)** to **[`88d70c6`](https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e)**",
    "created_at": "2017-09-04T06:10:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355050",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/fbissey/scipy0.19.1](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/scipy0.19.1)** to **[`88d70c6`](https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e)**



---

archive/issue_events_325382.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-04T06:10:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325382"
}
```



---

archive/issue_events_325383.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0f561d6264a42de3935b5b470dc5551b8e25300f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-09-04T06:10:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23594#event-325383"
}
```



---

archive/issue_comments_355051.json:
```json
{
    "body": "Changed commit from **[`88d70c6`](https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e)** to none",
    "created_at": "2017-10-13T17:34:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355051",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`88d70c6`](https://github.com/sagemath/sagetrac-mirror/commit/88d70c68fbd6ba1fda52217b81a45c906aaf390e)** to none



---

archive/issue_comments_355052.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThis update does not quite work on FreeBSD, as illustrated by the following ugly\ncrash in plain Sage python (as well as in Sage code that uses `Voronoi`, such as \n`RiemannSurface` one).\n\n```\n>>> import numpy as np\n>>> points = np.array([[0, 0], [0, 1], [0, 2], [1, 0], [1, 1], [1, 2],[2, 0], [2, 1], [2, 2]])\n>>> from scipy.spatial import Voronoi\n>>> Voronoi(points)\nSegmentation fault (core dumped)\n```\n\n```\nsage: R.<x,y>=QQ[] \nsage: C=Curve(x^3+3*y^3+5) \nsage: C.riemann_surface() \n...\nUnhandled SIGSEGV: A segmentation fault occurred.\n```",
    "created_at": "2017-10-13T17:34:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23594",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23594#issuecomment-355052",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">comment:25</div>

This update does not quite work on FreeBSD, as illustrated by the following ugly
crash in plain Sage python (as well as in Sage code that uses `Voronoi`, such as 
`RiemannSurface` one).

```
>>> import numpy as np
>>> points = np.array([[0, 0], [0, 1], [0, 2], [1, 0], [1, 1], [1, 2],[2, 0], [2, 1], [2, 2]])
>>> from scipy.spatial import Voronoi
>>> Voronoi(points)
Segmentation fault (core dumped)
```

```
sage: R.<x,y>=QQ[] 
sage: C=Curve(x^3+3*y^3+5) 
sage: C.riemann_surface() 
...
Unhandled SIGSEGV: A segmentation fault occurred.
```
