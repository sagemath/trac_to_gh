# Issue 23238: New syntax for GlobalOptions

archive/issues_023001.json:
```json
{
    "assignees": [],
    "body": "Rethink the syntax of `GlobalOptions`. This is mainly meant to address the problem that the `doc` and `end_doc` attributes of a `GlobalOptions` object are not doctested (see #16693 and #18051 which were closed as duplicate of #14272 but which would better be fixed independently).\n\nI am thinking of replacing\n\n```\noptions = GlobalOptions('menu',\n    doc='Fancy documentation\\n'+'-'*19, end_doc='The END!',\n    entree=dict(...), ...)\n```\nby\n\n```\nclass options(GlobalOptions):\n    \"\"\"\n    Fancy documentation\n    -------------------\n\n    @OPTIONS@\n\n    The END!\n    \"\"\"\n    name = \"menu\"\n    entree = dict(...)\n```\n\nIn other words, to use the `class` statement purely as a custom syntax, but without actually creating a class. The main advantage of this syntax is that doctests are just ordinary doctests, there is no need for `doc=` and `end_doc=` arguments.\n\nThis ticket is about enabling the new syntax in addition to the old syntax. Converting the existing use-cases of `GlobalOptions` will be delegated to follow-up tickets.\n\nCC:  @darijgr @dkrenn @AndrewAtLarge @tscrim\n\nBranch/Commit: **[94807eb](https://github.com/sagemath/sagetrac-mirror/commit/94807eb80a66f843222be674a47965ddc9dec798)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **misc**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23238_\n\n",
    "closed_at": "2017-07-26T22:13:13Z",
    "created_at": "2017-06-14T12:03:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "New syntax for GlobalOptions",
    "type": "issue",
    "updated_at": "2017-07-26T22:13:13Z",
    "url": "https://github.com/sagemath/sage/issues/23238",
    "user": "https://github.com/jdemeyer"
}
```
Rethink the syntax of `GlobalOptions`. This is mainly meant to address the problem that the `doc` and `end_doc` attributes of a `GlobalOptions` object are not doctested (see #16693 and #18051 which were closed as duplicate of #14272 but which would better be fixed independently).

I am thinking of replacing

```
options = GlobalOptions('menu',
    doc='Fancy documentation\n'+'-'*19, end_doc='The END!',
    entree=dict(...), ...)
```
by

```
class options(GlobalOptions):
    """
    Fancy documentation
    -------------------

    @OPTIONS@

    The END!
    """
    name = "menu"
    entree = dict(...)
```

In other words, to use the `class` statement purely as a custom syntax, but without actually creating a class. The main advantage of this syntax is that doctests are just ordinary doctests, there is no need for `doc=` and `end_doc=` arguments.

This ticket is about enabling the new syntax in addition to the old syntax. Converting the existing use-cases of `GlobalOptions` will be delegated to follow-up tickets.

CC:  @darijgr @dkrenn @AndrewAtLarge @tscrim

Branch/Commit: **[94807eb](https://github.com/sagemath/sagetrac-mirror/commit/94807eb80a66f843222be674a47965ddc9dec798)**

Reviewer: **Travis Scrimshaw**

Author: **Jeroen Demeyer**

Component: **misc**

_Issue created by migration from https://trac.sagemath.org/ticket/23238_





---

archive/issue_events_323794.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-14T12:03:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323794"
}
```



---

archive/issue_events_323795.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-14T12:03:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323795"
}
```



---

archive/issue_events_323796.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-14T12:03:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323796"
}
```



---

archive/issue_comments_348894.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,26 @@\n Rethink the syntax of `GlobalOptions`. This is mainly meant to address the problem that the `doc` and `end_doc` attributes of a `GlobalOptions` object are not doctested (see #16693 and #18051 which were closed as duplicate of #14272 but which would better be fixed independently).\n+\n+I am thinking of replacing\n+\n+```\n+options = GlobalOptions('menu',\n+    doc='Fancy documentation\\n'+'-'*19, end_doc='The END!',\n+    entree=dict(...), ...)\n+```\n+by\n+\n+```\n+class options(GlobalOptions):\n+    \"\"\"\n+    Fancy documentation\n+    -------------------\n+\n+    @OPTIONS@\n+\n+    The END!\n+    \"\"\"\n+    name = \"menu\"\n+    entree=dict(...)\n+```\n+\n+In other words, to use the `class` statement essentially as a namespace.\n``````\n",
    "created_at": "2017-06-14T12:09:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348894",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,26 @@
 Rethink the syntax of `GlobalOptions`. This is mainly meant to address the problem that the `doc` and `end_doc` attributes of a `GlobalOptions` object are not doctested (see #16693 and #18051 which were closed as duplicate of #14272 but which would better be fixed independently).
+
+I am thinking of replacing
+
+```
+options = GlobalOptions('menu',
+    doc='Fancy documentation\n'+'-'*19, end_doc='The END!',
+    entree=dict(...), ...)
+```
+by
+
+```
+class options(GlobalOptions):
+    """
+    Fancy documentation
+    -------------------
+
+    @OPTIONS@
+
+    The END!
+    """
+    name = "menu"
+    entree=dict(...)
+```
+
+In other words, to use the `class` statement essentially as a namespace.
``````




---

archive/issue_comments_348895.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,7 +20,7 @@\n     The END!\n     \"\"\"\n     name = \"menu\"\n-    entree=dict(...)\n+    entree = dict(...)\n ```\n \n In other words, to use the `class` statement essentially as a namespace.\n``````\n",
    "created_at": "2017-06-14T12:14:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348895",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,7 +20,7 @@
     The END!
     """
     name = "menu"
-    entree=dict(...)
+    entree = dict(...)
 ```
 
 In other words, to use the `class` statement essentially as a namespace.
``````




---

archive/issue_comments_348896.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nNot having the global options doc-tested seems to be causing problems, and all documentation should be doc-tested, so I think that this is a good idea. This said, I am surprised that there is testable code hidden in the global options that is not doc-tested elsewhere: tests for all methods should be given in the methods.\n\nFor what it's worth, my initial plan was to write the options as a class but one of the people I discussed this with thought that creating a class for each set of options was a little OTT.",
    "created_at": "2017-06-15T01:12:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348896",
    "user": "https://github.com/AndrewAtLarge"
}
```

<div id="comment:4" align="right">comment:4</div>

Not having the global options doc-tested seems to be causing problems, and all documentation should be doc-tested, so I think that this is a good idea. This said, I am surprised that there is testable code hidden in the global options that is not doc-tested elsewhere: tests for all methods should be given in the methods.

For what it's worth, my initial plan was to write the options as a class but one of the people I discussed this with thought that creating a class for each set of options was a little OTT.



---

archive/issue_comments_348897.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,3 +24,5 @@\n ```\n \n In other words, to use the `class` statement essentially as a namespace.\n+\n+This ticket is about enabling the new syntax in addition to the old syntax. Converting the existing use-cases of `GlobalOptions` will be delegated to follow-up tickets.\n``````\n",
    "created_at": "2017-06-16T12:22:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348897",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,3 +24,5 @@
 ```
 
 In other words, to use the `class` statement essentially as a namespace.
+
+This ticket is about enabling the new syntax in addition to the old syntax. Converting the existing use-cases of `GlobalOptions` will be delegated to follow-up tickets.
``````




---

archive/issue_events_323797.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-16T12:22:53Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "title_is": "New syntax for GlobalOptions",
    "title_was": "Change syntax of GlobalOptions",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323797"
}
```



---

archive/issue_comments_348898.json:
```json
{
    "body": "Branch: **[u/jdemeyer/change_syntax_of_globaloptions](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/change_syntax_of_globaloptions)**",
    "created_at": "2017-06-16T13:29:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348898",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/change_syntax_of_globaloptions](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/change_syntax_of_globaloptions)**



---

archive/issue_comments_348899.json:
```json
{
    "body": "Commit: **[c17cbe3](https://github.com/sagemath/sagetrac-mirror/commit/c17cbe3f345960289c7d0ba90f2b23b3e29e8430)**",
    "created_at": "2017-06-16T13:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348899",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[c17cbe3](https://github.com/sagemath/sagetrac-mirror/commit/c17cbe3f345960289c7d0ba90f2b23b3e29e8430)**



---

archive/issue_comments_348900.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThis is an early prototype. Pickling is not yet supported and it needs a lot more tests and docs.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c17cbe3f345960289c7d0ba90f2b23b3e29e8430\">c17cbe3</a></td><td><code>New class syntax for GlobalOptions</code></td></tr></table>\n",
    "created_at": "2017-06-16T13:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348900",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

This is an early prototype. Pickling is not yet supported and it needs a lot more tests and docs.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c17cbe3f345960289c7d0ba90f2b23b3e29e8430">c17cbe3</a></td><td><code>New class syntax for GlobalOptions</code></td></tr></table>




---

archive/issue_comments_348901.json:
```json
{
    "body": "Dependencies: **#23277**",
    "created_at": "2017-06-19T14:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348901",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#23277**



---

archive/issue_comments_348902.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3be0ac270e35238fceeba24e63edd37010519412\">3be0ac2</a></td><td><code>InstanceDocDescriptor: support `__doc__` attribute on instance</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8c1c2ffd2f0a9433ed0c7ea7792bd7ddee3e8c5\">d8c1c2f</a></td><td><code>New class syntax for GlobalOptions</code></td></tr></table>\n",
    "created_at": "2017-06-19T15:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348902",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3be0ac270e35238fceeba24e63edd37010519412">3be0ac2</a></td><td><code>InstanceDocDescriptor: support `__doc__` attribute on instance</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8c1c2ffd2f0a9433ed0c7ea7792bd7ddee3e8c5">d8c1c2f</a></td><td><code>New class syntax for GlobalOptions</code></td></tr></table>




---

archive/issue_comments_348903.json:
```json
{
    "body": "Changed commit from **[c17cbe3](https://github.com/sagemath/sagetrac-mirror/commit/c17cbe3f345960289c7d0ba90f2b23b3e29e8430)** to **[d8c1c2f](https://github.com/sagemath/sagetrac-mirror/commit/d8c1c2ffd2f0a9433ed0c7ea7792bd7ddee3e8c5)**",
    "created_at": "2017-06-19T15:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348903",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c17cbe3](https://github.com/sagemath/sagetrac-mirror/commit/c17cbe3f345960289c7d0ba90f2b23b3e29e8430)** to **[d8c1c2f](https://github.com/sagemath/sagetrac-mirror/commit/d8c1c2ffd2f0a9433ed0c7ea7792bd7ddee3e8c5)**



---

archive/issue_comments_348904.json:
```json
{
    "body": "Changed commit from **[d8c1c2f](https://github.com/sagemath/sagetrac-mirror/commit/d8c1c2ffd2f0a9433ed0c7ea7792bd7ddee3e8c5)** to **[84a2363](https://github.com/sagemath/sagetrac-mirror/commit/84a23634841d84093b6e6619b3b4544f1bb03ce3)**",
    "created_at": "2017-06-20T13:27:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348904",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d8c1c2f](https://github.com/sagemath/sagetrac-mirror/commit/d8c1c2ffd2f0a9433ed0c7ea7792bd7ddee3e8c5)** to **[84a2363](https://github.com/sagemath/sagetrac-mirror/commit/84a23634841d84093b6e6619b3b4544f1bb03ce3)**



---

archive/issue_comments_348905.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84a23634841d84093b6e6619b3b4544f1bb03ce3\">84a2363</a></td><td><code>New class syntax for GlobalOptions</code></td></tr></table>\n",
    "created_at": "2017-06-20T13:27:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348905",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84a23634841d84093b6e6619b3b4544f1bb03ce3">84a2363</a></td><td><code>New class syntax for GlobalOptions</code></td></tr></table>




---

archive/issue_comments_348906.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,6 +23,6 @@\n     entree = dict(...)\n ```\n \n-In other words, to use the `class` statement essentially as a namespace.\n+In other words, to use the `class` statement purely as a custom syntax, but without actually creating a class.\n \n This ticket is about enabling the new syntax in addition to the old syntax. Converting the existing use-cases of `GlobalOptions` will be delegated to follow-up tickets.\n``````\n",
    "created_at": "2017-06-20T13:38:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348906",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,6 +23,6 @@
     entree = dict(...)
 ```
 
-In other words, to use the `class` statement essentially as a namespace.
+In other words, to use the `class` statement purely as a custom syntax, but without actually creating a class.
 
 This ticket is about enabling the new syntax in addition to the old syntax. Converting the existing use-cases of `GlobalOptions` will be delegated to follow-up tickets.
``````




---

archive/issue_comments_348907.json:
```json
{
    "body": "Changed dependencies from **#23277** to none",
    "created_at": "2017-06-20T13:38:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348907",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#23277** to none



---

archive/issue_events_323798.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-20T14:57:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323798"
}
```



---

archive/issue_comments_348908.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -23,6 +23,6 @@\n     entree = dict(...)\n ```\n \n-In other words, to use the `class` statement purely as a custom syntax, but without actually creating a class.\n+In other words, to use the `class` statement purely as a custom syntax, but without actually creating a class. The main advantage of this syntax is that doctests are just ordinary doctests, there is no need for `doc=` and `end_doc=` arguments.\n \n This ticket is about enabling the new syntax in addition to the old syntax. Converting the existing use-cases of `GlobalOptions` will be delegated to follow-up tickets.\n``````\n",
    "created_at": "2017-06-22T08:13:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348908",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -23,6 +23,6 @@
     entree = dict(...)
 ```
 
-In other words, to use the `class` statement purely as a custom syntax, but without actually creating a class.
+In other words, to use the `class` statement purely as a custom syntax, but without actually creating a class. The main advantage of this syntax is that doctests are just ordinary doctests, there is no need for `doc=` and `end_doc=` arguments.
 
 This ticket is about enabling the new syntax in addition to the old syntax. Converting the existing use-cases of `GlobalOptions` will be delegated to follow-up tickets.
``````




---

archive/issue_comments_348909.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nOverall I like the improved way to create global options as classes. However, I do not like how `name` is treated as a special input; it looks too much like an option and someone could want an option called `name`. While this was not previously supported, it was clear from the class signature that this could not be an option. However, with the new format, it looks more like (black) magic that `name` is and should be treated differently. Perhaps just call it `_name` instead as that is the ultimate attribute it is suppose to be called. Moreover, Python does not distinguish between classes and instances (and global options are suppose to be unique class level attributes). At least, this feels a little more natural to me, even if it breaks encapsulation in a way.\n\nI would prefer `\"\"\"` instead of `'''`, but I guess we cannot change that because of it being inside of a `\"\"\"` string and the doctesting framework (so we can't add an escape `\\`).\n\nI'm also not sure about the change to actually print the `__doc__` as tests. I agree that it should be tested, but having to add all of those `<BLANKLINE>` takes away from the instructional value of the documentation.",
    "created_at": "2017-07-01T14:56:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348909",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

Overall I like the improved way to create global options as classes. However, I do not like how `name` is treated as a special input; it looks too much like an option and someone could want an option called `name`. While this was not previously supported, it was clear from the class signature that this could not be an option. However, with the new format, it looks more like (black) magic that `name` is and should be treated differently. Perhaps just call it `_name` instead as that is the ultimate attribute it is suppose to be called. Moreover, Python does not distinguish between classes and instances (and global options are suppose to be unique class level attributes). At least, this feels a little more natural to me, even if it breaks encapsulation in a way.

I would prefer `"""` instead of `'''`, but I guess we cannot change that because of it being inside of a `"""` string and the doctesting framework (so we can't add an escape `\`).

I'm also not sure about the change to actually print the `__doc__` as tests. I agree that it should be tested, but having to add all of those `<BLANKLINE>` takes away from the instructional value of the documentation.



---

archive/issue_events_323799.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-01T14:56:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323799"
}
```



---

archive/issue_events_323800.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-01T14:56:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323800"
}
```



---

archive/issue_comments_348910.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@tscrim](#comment:14):\n> Moreover, Python does not distinguish between classes and instances (and global options are suppose to be unique class level attributes). At least, this feels a little more natural to me, even if it breaks encapsulation in a way.\n\nI don't get what you mean with this.\n\n> I would prefer `\"\"\"` instead of `'''`, but I guess we cannot change that because of it being inside of a `\"\"\"` string and the doctesting framework (so we can't add an escape `\\`).\n\nWe could escape `\\\"\\\"\\\"` I guess but that looks even uglier than `'''`.\n\n> I'm also not sure about the change to actually print the `__doc__` as tests. I agree that it should be tested, but having to add all of those `<BLANKLINE>` takes away from the instructional value of the documentation.\n\nRight. So maybe keep the doc as before but add tests too.",
    "created_at": "2017-07-02T08:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348910",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@tscrim](#comment:14):
> Moreover, Python does not distinguish between classes and instances (and global options are suppose to be unique class level attributes). At least, this feels a little more natural to me, even if it breaks encapsulation in a way.

I don't get what you mean with this.

> I would prefer `"""` instead of `'''`, but I guess we cannot change that because of it being inside of a `"""` string and the doctesting framework (so we can't add an escape `\`).

We could escape `\"\"\"` I guess but that looks even uglier than `'''`.

> I'm also not sure about the change to actually print the `__doc__` as tests. I agree that it should be tested, but having to add all of those `<BLANKLINE>` takes away from the instructional value of the documentation.

Right. So maybe keep the doc as before but add tests too.



---

archive/issue_comments_348911.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@jdemeyer](#comment:15):\n> Replying to [@tscrim](#comment:14):\n> > Moreover, Python does not distinguish between classes and instances (and global options are suppose to be unique class level attributes). At least, this feels a little more natural to me, even if it breaks encapsulation in a way.\n\n> \n> I don't get what you mean with this.\n\nClass attributes and instance attributes behave in exactly the same way:\n\n```sage\nsage: class Foo(object):\n....:     bar = 5\n....:     def __init__(self):\n....:         self.var = -1\nsage: f = Foo()\nsage: f.bar\n5\nsage: f.var\n-1\nsage: f.bar = 2\nsage: f2 = Foo()\nsage: f2.bar\n5\nsage: f.bar\n2\n```\nSo having the class level attribute of `_name` is the same as setting `_name` in the `__init__` (as far as the object is concerned). So it feels much more natural to me to be setting the name by using `_name`.\n\n> > I would prefer `\"\"\"` instead of `'''`, but I guess we cannot change that because of it being inside of a `\"\"\"` string and the doctesting framework (so we can't add an escape `\\`).\n\n> We could escape `\\\"\\\"\\\"` I guess but that looks even uglier than `'''`.\n\nExactly my conclusion. This comment ended up being more of a conversion with myself. Sorry, I should've added that I don't think we should change anything.\n\n> > I'm also not sure about the change to actually print the `__doc__` as tests. I agree that it should be tested, but having to add all of those `<BLANKLINE>` takes away from the instructional value of the documentation.\n\n> \n> Right. So maybe keep the doc as before but add tests too.\n\nI think this is the best way forward.",
    "created_at": "2017-07-02T10:14:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348911",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@jdemeyer](#comment:15):
> Replying to [@tscrim](#comment:14):
> > Moreover, Python does not distinguish between classes and instances (and global options are suppose to be unique class level attributes). At least, this feels a little more natural to me, even if it breaks encapsulation in a way.

> 
> I don't get what you mean with this.

Class attributes and instance attributes behave in exactly the same way:

```sage
sage: class Foo(object):
....:     bar = 5
....:     def __init__(self):
....:         self.var = -1
sage: f = Foo()
sage: f.bar
5
sage: f.var
-1
sage: f.bar = 2
sage: f2 = Foo()
sage: f2.bar
5
sage: f.bar
2
```
So having the class level attribute of `_name` is the same as setting `_name` in the `__init__` (as far as the object is concerned). So it feels much more natural to me to be setting the name by using `_name`.

> > I would prefer `"""` instead of `'''`, but I guess we cannot change that because of it being inside of a `"""` string and the doctesting framework (so we can't add an escape `\`).

> We could escape `\"\"\"` I guess but that looks even uglier than `'''`.

Exactly my conclusion. This comment ended up being more of a conversion with myself. Sorry, I should've added that I don't think we should change anything.

> > I'm also not sure about the change to actually print the `__doc__` as tests. I agree that it should be tested, but having to add all of those `<BLANKLINE>` takes away from the instructional value of the documentation.

> 
> Right. So maybe keep the doc as before but add tests too.

I think this is the best way forward.



---

archive/issue_comments_348912.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@tscrim](#comment:16):\n> So having the class level attribute of `_name` is the same as setting `_name` in the `__init__` (as far as the object is concerned).\n\nI see what you mean but I don't see the relevance to this ticket.\n\n> So it feels much more natural to me to be setting the name by using `_name`.\n\nTo me, the `_name` attribute on the instance is an implementation detail which is unrelated to the construction of the object. So I don't see it as an argument in favour of `_name` (but also not against it, it's just not relevant in my opinion).\n\nI have also been considering `NAME` in all capitals. What do you think?",
    "created_at": "2017-07-03T09:40:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348912",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@tscrim](#comment:16):
> So having the class level attribute of `_name` is the same as setting `_name` in the `__init__` (as far as the object is concerned).

I see what you mean but I don't see the relevance to this ticket.

> So it feels much more natural to me to be setting the name by using `_name`.

To me, the `_name` attribute on the instance is an implementation detail which is unrelated to the construction of the object. So I don't see it as an argument in favour of `_name` (but also not against it, it's just not relevant in my opinion).

I have also been considering `NAME` in all capitals. What do you think?



---

archive/issue_comments_348913.json:
```json
{
    "body": "Changed commit from **[84a2363](https://github.com/sagemath/sagetrac-mirror/commit/84a23634841d84093b6e6619b3b4544f1bb03ce3)** to **[aff9ee6](https://github.com/sagemath/sagetrac-mirror/commit/aff9ee6a8cd550d76ff6bb6727960a25435f571f)**",
    "created_at": "2017-07-03T14:48:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348913",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[84a2363](https://github.com/sagemath/sagetrac-mirror/commit/84a23634841d84093b6e6619b3b4544f1bb03ce3)** to **[aff9ee6](https://github.com/sagemath/sagetrac-mirror/commit/aff9ee6a8cd550d76ff6bb6727960a25435f571f)**



---

archive/issue_comments_348914.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aff9ee6a8cd550d76ff6bb6727960a25435f571f\">aff9ee6</a></td><td><code>Separate `__doc__` examples and tests</code></td></tr></table>\n",
    "created_at": "2017-07-03T14:48:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348914",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aff9ee6a8cd550d76ff6bb6727960a25435f571f">aff9ee6</a></td><td><code>Separate `__doc__` examples and tests</code></td></tr></table>




---

archive/issue_comments_348915.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@jdemeyer](#comment:17):\n> Replying to [@tscrim](#comment:16):\n> > So having the class level attribute of `_name` is the same as setting `_name` in the `__init__` (as far as the object is concerned).\n\n> \n> I see what you mean but I don't see the relevance to this ticket.\n\nSince this ticket is about setting the API for `GlobalOptions` and this will be used as part of the API, so I feel it is relevant.\n\n> > So it feels much more natural to me to be setting the name by using `_name`.\n\n> \n> To me, the `_name` attribute on the instance is an implementation detail which is unrelated to the construction of the object. So I don't see it as an argument in favour of `_name` (but also not against it, it's just not relevant in my opinion).\n\nWell, this goes to the statement I made about breaking encapsulation, but I want to make it part of the API in a way. At least since we don't have an `__init__` with a set signature (well, as much as Python can give).\n\n> I have also been considering `NAME` in all capitals. What do you think?\n\nThis also is good for me as it is clear it is special. I have a very mild preference for `_name` over `NAME`, but my opinion is not very strong (other than it not being `name`).",
    "created_at": "2017-07-03T14:52:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348915",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@jdemeyer](#comment:17):
> Replying to [@tscrim](#comment:16):
> > So having the class level attribute of `_name` is the same as setting `_name` in the `__init__` (as far as the object is concerned).

> 
> I see what you mean but I don't see the relevance to this ticket.

Since this ticket is about setting the API for `GlobalOptions` and this will be used as part of the API, so I feel it is relevant.

> > So it feels much more natural to me to be setting the name by using `_name`.

> 
> To me, the `_name` attribute on the instance is an implementation detail which is unrelated to the construction of the object. So I don't see it as an argument in favour of `_name` (but also not against it, it's just not relevant in my opinion).

Well, this goes to the statement I made about breaking encapsulation, but I want to make it part of the API in a way. At least since we don't have an `__init__` with a set signature (well, as much as Python can give).

> I have also been considering `NAME` in all capitals. What do you think?

This also is good for me as it is clear it is special. I have a very mild preference for `_name` over `NAME`, but my opinion is not very strong (other than it not being `name`).



---

archive/issue_comments_348916.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@tscrim](#comment:19):\n> Well, this goes to the statement I made about breaking encapsulation, but I want to make it part of the API in a way.\n\nThe `_name` attribute on the instance is a private implementation detail and explicitly *not* part of the API. This is compatible with the Python philosophy that names starting with underscores are private. Actually, thinking more about it, this is an argument *against* `_name`: the `name`/`_name`/`NAME` attribute when creating the class should be part of the API, so it should not start with an underscore.\n\nEven if you consider the `_name` attribute on the instance as part of the API, most users won't care. So I don't see this as a reason to use the same name `_name` for constructing the class.\n\n> This also is good for me as it is clear it is special. I have a very mild preference for `_name` over `NAME`, but my opinion is not very strong (other than it not being `name`).\n\nIn that case I will use `NAME`.",
    "created_at": "2017-07-03T15:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348916",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@tscrim](#comment:19):
> Well, this goes to the statement I made about breaking encapsulation, but I want to make it part of the API in a way.

The `_name` attribute on the instance is a private implementation detail and explicitly *not* part of the API. This is compatible with the Python philosophy that names starting with underscores are private. Actually, thinking more about it, this is an argument *against* `_name`: the `name`/`_name`/`NAME` attribute when creating the class should be part of the API, so it should not start with an underscore.

Even if you consider the `_name` attribute on the instance as part of the API, most users won't care. So I don't see this as a reason to use the same name `_name` for constructing the class.

> This also is good for me as it is clear it is special. I have a very mild preference for `_name` over `NAME`, but my opinion is not very strong (other than it not being `name`).

In that case I will use `NAME`.



---

archive/issue_comments_348917.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94807eb80a66f843222be674a47965ddc9dec798\">94807eb</a></td><td><code>Use \"NAME\" instead of \"name\"</code></td></tr></table>\n",
    "created_at": "2017-07-03T15:33:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348917",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94807eb80a66f843222be674a47965ddc9dec798">94807eb</a></td><td><code>Use "NAME" instead of "name"</code></td></tr></table>




---

archive/issue_comments_348918.json:
```json
{
    "body": "Changed commit from **[aff9ee6](https://github.com/sagemath/sagetrac-mirror/commit/aff9ee6a8cd550d76ff6bb6727960a25435f571f)** to **[94807eb](https://github.com/sagemath/sagetrac-mirror/commit/94807eb80a66f843222be674a47965ddc9dec798)**",
    "created_at": "2017-07-03T15:33:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348918",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[aff9ee6](https://github.com/sagemath/sagetrac-mirror/commit/aff9ee6a8cd550d76ff6bb6727960a25435f571f)** to **[94807eb](https://github.com/sagemath/sagetrac-mirror/commit/94807eb80a66f843222be674a47965ddc9dec798)**



---

archive/issue_events_323801.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-07-03T15:33:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323801"
}
```



---

archive/issue_events_323802.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-07-03T15:33:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323802"
}
```



---

archive/issue_comments_348919.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2017-07-04T00:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348919",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_348920.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nLGTM. Thank you.",
    "created_at": "2017-07-04T00:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348920",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:23" align="right">comment:23</div>

LGTM. Thank you.



---

archive/issue_events_323803.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-04T00:42:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323803"
}
```



---

archive/issue_events_323804.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-04T00:42:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323804"
}
```



---

archive/issue_comments_348921.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/change_syntax_of_globaloptions](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/change_syntax_of_globaloptions)** to **[94807eb](https://github.com/sagemath/sagetrac-mirror/commit/94807eb80a66f843222be674a47965ddc9dec798)**",
    "created_at": "2017-07-26T22:13:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23238#issuecomment-348921",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/change_syntax_of_globaloptions](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/change_syntax_of_globaloptions)** to **[94807eb](https://github.com/sagemath/sagetrac-mirror/commit/94807eb80a66f843222be674a47965ddc9dec798)**



---

archive/issue_events_323805.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-07-26T22:13:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323805"
}
```



---

archive/issue_events_323806.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "8cddabaad4b03ef9a6ec54bb4231c22b26f3e46d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-07-26T22:13:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23238",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23238#event-323806"
}
```
