# Issue 23808: Keep embedding info when converting algebraics to number field in projective morphism

archive/issues_023571.json:
```json
{
    "body": "Given a map or point defined over QQbar, you can call _numberfield_from_algebraics to return a map over a number field. However, the resulting object cannot be converted back to QQbar since the embedding information is lost.\n\nCC:  @bhutz\n\nBranch/Commit: 693578ca32ded36f9252988917b67aebf0d2dfcc\n\nReviewer: David Roe, Ben Hutz\n\nAuthor: Paul Fili\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23808\n\n",
    "closed_at": "2017-09-11T13:46:53Z",
    "created_at": "2017-09-08T16:23:45Z",
    "labels": [
        "component: algebraic geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Keep embedding info when converting algebraics to number field in projective morphism",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23808",
    "user": "https://github.com/pfili"
}
```
Given a map or point defined over QQbar, you can call _numberfield_from_algebraics to return a map over a number field. However, the resulting object cannot be converted back to QQbar since the embedding information is lost.

CC:  @bhutz

Branch/Commit: 693578ca32ded36f9252988917b67aebf0d2dfcc

Reviewer: David Roe, Ben Hutz

Author: Paul Fili

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23808





---

archive/issue_comments_449201.json:
```json
{
    "body": "Changing branch from \"\" to \"u/paulfili/keep_embedding_info_when_converting_algebraics_to_number_field_in_projective_morphism\"",
    "created_at": "2017-09-08T16:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449201",
    "user": "https://github.com/pfili"
}
```

Changing branch from "" to "u/paulfili/keep_embedding_info_when_converting_algebraics_to_number_field_in_projective_morphism"



---

archive/issue_comments_449202.json:
```json
{
    "body": "<a id='comment:2'></a>The following code used to fail:\n\n```python\nR.<t>=PolynomialRing(QQ)\ns = (t^3+t+1).roots(QQbar)[0][0]\nP.<x,y>=ProjectiveSpace(QQbar,1)\nH = Hom(P,P)\nf = H([s*x^3-13*y^3, y^3-15*y^3])\nf_alg = f._number_field_from_algebraics()\nf_alg.change_ring(QQbar) # Used to fail\n```\n\nThe problem was that the number field being defined over which f_alg was defined should include an embedding, telling Sage where to send the generator in the real/complex numbers. (After all, QQbar elements all have this embedding information.) This information was present but was not being used when defining the number field (possibly due to a quirk in the code from qqbar.py). The fix now updates the code to specify this embedding when creating the number field. \n\n---\nNew commits:",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449202",
    "user": "https://github.com/pfili"
}
```

<a id='comment:2'></a>The following code used to fail:

```python
R.<t>=PolynomialRing(QQ)
s = (t^3+t+1).roots(QQbar)[0][0]
P.<x,y>=ProjectiveSpace(QQbar,1)
H = Hom(P,P)
f = H([s*x^3-13*y^3, y^3-15*y^3])
f_alg = f._number_field_from_algebraics()
f_alg.change_ring(QQbar) # Used to fail
```

The problem was that the number field being defined over which f_alg was defined should include an embedding, telling Sage where to send the generator in the real/complex numbers. (After all, QQbar elements all have this embedding information.) This information was present but was not being used when defining the number field (possibly due to a quirk in the code from qqbar.py). The fix now updates the code to specify this embedding when creating the number field. 

---
New commits:



---

archive/issue_comments_449203.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449203",
    "user": "https://github.com/pfili"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_449204.json:
```json
{
    "body": "Changing author from \"\" to \"paulfili\"",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449204",
    "user": "https://github.com/pfili"
}
```

Changing author from "" to "paulfili"



---

archive/issue_comments_449205.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449205",
    "user": "https://github.com/pfili"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_449206.json:
```json
{
    "body": "Changing commit from \"\" to \"6c283cfa555f0f29b2638bb7c4b35f7476b5fa13\"",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449206",
    "user": "https://github.com/pfili"
}
```

Changing commit from "" to "6c283cfa555f0f29b2638bb7c4b35f7476b5fa13"



---

archive/issue_comments_449207.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to algebraic geometry.",
    "created_at": "2017-09-08T16:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449207",
    "user": "https://github.com/pfili"
}
```

Changing component from PLEASE CHANGE to algebraic geometry.



---

archive/issue_comments_449208.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Roe\"",
    "created_at": "2017-09-08T21:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449208",
    "user": "https://github.com/roed314"
}
```

Changing reviewer from "" to "David Roe"



---

archive/issue_comments_449209.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-08T21:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449209",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_449210.json:
```json
{
    "body": "<a id='comment:3'></a>You should add a test to show that the bug has been fixed.  You can use\n\n```\n:trac:`23808`\n```\nto refer to this ticket in the docstring.",
    "created_at": "2017-09-08T21:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449210",
    "user": "https://github.com/roed314"
}
```

<a id='comment:3'></a>You should add a test to show that the bug has been fixed.  You can use

```
:trac:`23808`
```
to refer to this ticket in the docstring.



---

archive/issue_comments_449211.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-08T23:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449211",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449212.json:
```json
{
    "body": "Changing commit from \"6c283cfa555f0f29b2638bb7c4b35f7476b5fa13\" to \"85484263dbc54db00819386193c8784fff284b01\"",
    "created_at": "2017-09-08T23:05:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449212",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6c283cfa555f0f29b2638bb7c4b35f7476b5fa13" to "85484263dbc54db00819386193c8784fff284b01"



---

archive/issue_comments_449213.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [roed](#comment%3A3):\n> You should add a test to show that the bug has been fixed.  You can use\n> \n> ```\n> :trac:`23808`\n> ```\n> to refer to this ticket in the docstring.\n\n\nThanks, David, I added the example.",
    "created_at": "2017-09-08T23:08:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449213",
    "user": "https://github.com/pfili"
}
```

<a id='comment:5'></a>Replying to [roed](#comment%3A3):
> You should add a test to show that the bug has been fixed.  You can use
> 
> ```
> :trac:`23808`
> ```
> to refer to this ticket in the docstring.


Thanks, David, I added the example.



---

archive/issue_comments_449214.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-08T23:08:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449214",
    "user": "https://github.com/pfili"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_449215.json:
```json
{
    "body": "<a id='comment:7'></a>You should change `print f` to just `f` for Python 3 compatibility.  Other than that, looks good and positive review once patchbot approves.",
    "created_at": "2017-09-09T00:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449215",
    "user": "https://github.com/roed314"
}
```

<a id='comment:7'></a>You should change `print f` to just `f` for Python 3 compatibility.  Other than that, looks good and positive review once patchbot approves.



---

archive/issue_comments_449216.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-09T00:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449216",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_449217.json:
```json
{
    "body": "<a id='comment:8'></a>Also, note that there is a similar function for points that should be modified at the same time.",
    "created_at": "2017-09-09T15:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449217",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:8'></a>Also, note that there is a similar function for points that should be modified at the same time.



---

archive/issue_comments_449218.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-09T16:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449218",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_449219.json:
```json
{
    "body": "Changing commit from \"85484263dbc54db00819386193c8784fff284b01\" to \"693578ca32ded36f9252988917b67aebf0d2dfcc\"",
    "created_at": "2017-09-09T16:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449219",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "85484263dbc54db00819386193c8784fff284b01" to "693578ca32ded36f9252988917b67aebf0d2dfcc"



---

archive/issue_comments_449220.json:
```json
{
    "body": "Changing author from \"paulfili\" to \"Paul Fili\"",
    "created_at": "2017-09-09T16:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449220",
    "user": "https://github.com/pfili"
}
```

Changing author from "paulfili" to "Paul Fili"



---

archive/issue_comments_449221.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-09T16:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449221",
    "user": "https://github.com/pfili"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_449222.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [roed](#comment%3A7):\n> You should change `print f` to just `f` for Python 3 compatibility.  Other than that, looks good and positive review once patchbot approves.\n\n\nThanks, David, I have changed that as well.",
    "created_at": "2017-09-09T16:45:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449222",
    "user": "https://github.com/pfili"
}
```

<a id='comment:11'></a>Replying to [roed](#comment%3A7):
> You should change `print f` to just `f` for Python 3 compatibility.  Other than that, looks good and positive review once patchbot approves.


Thanks, David, I have changed that as well.



---

archive/issue_comments_449223.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-09T17:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449223",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_449224.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Given a map or point defined over QQbar, you can call _numberfield_from_algebraics to return a map over a number field. However, the resulting object cannot be converted back to QQbar since the embedding information is lost.\n``````\n",
    "created_at": "2017-09-09T17:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449224",
    "user": "https://github.com/bhutz"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Given a map or point defined over QQbar, you can call _numberfield_from_algebraics to return a map over a number field. However, the resulting object cannot be converted back to QQbar since the embedding information is lost.
``````




---

archive/issue_comments_449225.json:
```json
{
    "body": "Changing reviewer from \"David Roe\" to \"David Roe, Ben Hutz\"",
    "created_at": "2017-09-09T17:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449225",
    "user": "https://github.com/bhutz"
}
```

Changing reviewer from "David Roe" to "David Roe, Ben Hutz"



---

archive/issue_comments_449226.json:
```json
{
    "body": "<a id='comment:12'></a>This looks fine to me. I also added a description.",
    "created_at": "2017-09-09T17:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449226",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:12'></a>This looks fine to me. I also added a description.



---

archive/issue_comments_449227.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-11T13:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449227",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_449228.json:
```json
{
    "body": "Changing branch from \"u/paulfili/keep_embedding_info_when_converting_algebraics_to_number_field_in_projective_morphism\" to \"693578ca32ded36f9252988917b67aebf0d2dfcc\"",
    "created_at": "2017-09-11T13:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23808#issuecomment-449228",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/paulfili/keep_embedding_info_when_converting_algebraics_to_number_field_in_projective_morphism" to "693578ca32ded36f9252988917b67aebf0d2dfcc"



---

archive/issue_events_060706.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-11T13:46:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23808",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23808#event-60706"
}
```
