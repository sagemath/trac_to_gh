# Issue 23958: allow inner products of free modules to take values in rings different from the base ring.

archive/issues_023721.json:
```json
{
    "assignees": [],
    "body": "Inner products / bilinear forms  like\n\n`ZZ x ZZ --> CC , RR, QQ`\n\netc. make sense.\n\nMore general, let `M` be a free module over `R` and let `B` be a ring containing `R` then inner products\n`M x M --> B` make sense and can be allowed. \n\nDepends on #23978\n\nCC:  @roed314\n\nComponent: **linear algebra**\n\nKeywords: **sd91**\n\nAuthor: **Simon Brandhorst**\n\nBranch/Commit: **[u/sbrandhorst/allow_rational_inner_products_for_free_quadratic_zz_modules](https://github.com/sagemath/sagetrac-mirror/tree/u/sbrandhorst/allow_rational_inner_products_for_free_quadratic_zz_modules) @ [`80e144c`](https://github.com/sagemath/sagetrac-mirror/commit/80e144cc2532e88d9c19792c37c7d972e11aec4c)**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23958_\n\n",
    "created_at": "2017-10-02T23:08:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "allow inner products of free modules to take values in rings different from the base ring.",
    "type": "issue",
    "updated_at": "2022-08-31T02:51:13Z",
    "url": "https://github.com/sagemath/sage/issues/23958",
    "user": "https://github.com/simonbrandhorst"
}
```
Inner products / bilinear forms  like

`ZZ x ZZ --> CC , RR, QQ`

etc. make sense.

More general, let `M` be a free module over `R` and let `B` be a ring containing `R` then inner products
`M x M --> B` make sense and can be allowed. 

Depends on #23978

CC:  @roed314

Component: **linear algebra**

Keywords: **sd91**

Author: **Simon Brandhorst**

Branch/Commit: **[u/sbrandhorst/allow_rational_inner_products_for_free_quadratic_zz_modules](https://github.com/sagemath/sagetrac-mirror/tree/u/sbrandhorst/allow_rational_inner_products_for_free_quadratic_zz_modules) @ [`80e144c`](https://github.com/sagemath/sagetrac-mirror/commit/80e144cc2532e88d9c19792c37c7d972e11aec4c)**

_Issue created by migration from https://trac.sagemath.org/ticket/23958_





---

archive/issue_events_329809.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2017-10-02T23:08:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329809"
}
```



---

archive/issue_events_329810.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2017-10-02T23:08:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329810"
}
```



---

archive/issue_events_329811.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2017-10-02T23:08:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329811"
}
```



---

archive/issue_events_329812.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2017-10-02T23:08:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329812"
}
```



---

archive/issue_comments_361622.json:
```json
{
    "body": "Branch: **[u/sbrandhorst/allow_rational_inner_products_for_free_quadratic_zz_modules](https://github.com/sagemath/sagetrac-mirror/tree/u/sbrandhorst/allow_rational_inner_products_for_free_quadratic_zz_modules)**",
    "created_at": "2017-10-03T09:26:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361622",
    "user": "https://github.com/simonbrandhorst"
}
```

Branch: **[u/sbrandhorst/allow_rational_inner_products_for_free_quadratic_zz_modules](https://github.com/sagemath/sagetrac-mirror/tree/u/sbrandhorst/allow_rational_inner_products_for_free_quadratic_zz_modules)**



---

archive/issue_events_329813.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2017-10-04T10:17:39Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "title_is": "allow inner products of free modules to take values in rings different from the base ring.",
    "title_was": "Allow rational inner_products for free quadratic ZZ-modules",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329813"
}
```



---

archive/issue_comments_361623.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87db5c08843acbfe05e49be1ad6dac515cd86672\"><code>87db5c0</code></a></td><td><code>Inner product rings can now be specified.</code></td></tr></table>\n",
    "created_at": "2017-10-04T10:17:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361623",
    "user": "https://github.com/simonbrandhorst"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87db5c08843acbfe05e49be1ad6dac515cd86672"><code>87db5c0</code></a></td><td><code>Inner product rings can now be specified.</code></td></tr></table>




---

archive/issue_comments_361624.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,8 @@\n-FreeQuadraticModule(ZZ,1,matrix([1/2])\n-should work.\n+Inner products / bilinear forms  like\n+\n+ZZ x ZZ --> CC , RR, QQ, GF(q)\n+\n+etc. make sense.\n+\n+More general let M be a free module over R and let B be a ring which has a coercion morphisms R --> B, then inner products\n+M x M --> B make sense and should be allowed. \n``````\n",
    "created_at": "2017-10-04T10:17:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361624",
    "user": "https://github.com/simonbrandhorst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,8 @@
-FreeQuadraticModule(ZZ,1,matrix([1/2])
-should work.
+Inner products / bilinear forms  like
+
+ZZ x ZZ --> CC , RR, QQ, GF(q)
+
+etc. make sense.
+
+More general let M be a free module over R and let B be a ring which has a coercion morphisms R --> B, then inner products
+M x M --> B make sense and should be allowed. 
``````




---

archive/issue_comments_361625.json:
```json
{
    "body": "Commit: **[`87db5c0`](https://github.com/sagemath/sagetrac-mirror/commit/87db5c08843acbfe05e49be1ad6dac515cd86672)**",
    "created_at": "2017-10-04T10:17:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361625",
    "user": "https://github.com/simonbrandhorst"
}
```

Commit: **[`87db5c0`](https://github.com/sagemath/sagetrac-mirror/commit/87db5c08843acbfe05e49be1ad6dac515cd86672)**



---

archive/issue_events_329814.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2017-10-04T10:17:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329814"
}
```



---

archive/issue_events_329815.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2017-10-06T17:49:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329815"
}
```



---

archive/issue_events_329816.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2017-10-06T17:49:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329816"
}
```



---

archive/issue_comments_361626.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nIf we bring the inner_product_ring into play, we have to use it for comparison as well.\nSo first we should implement #23978",
    "created_at": "2017-10-06T17:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361626",
    "user": "https://github.com/simonbrandhorst"
}
```

<div id="comment:3" align="right">comment:3</div>

If we bring the inner_product_ring into play, we have to use it for comparison as well.
So first we should implement #23978



---

archive/issue_comments_361627.json:
```json
{
    "body": "Dependencies: **#23978**",
    "created_at": "2017-10-06T17:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361627",
    "user": "https://github.com/simonbrandhorst"
}
```

Dependencies: **#23978**



---

archive/issue_comments_361628.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8f2172df17d33e2378cfab2915a276f009cf7eef\"><code>8f2172d</code></a></td><td><code>Merge branch 'develop' into t/23958/allow_rational_inner_products_for_free_quadratic_zz_modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da0efa3cbd28c6afcc2ea6b0bf2e29debc159a7b\"><code>da0efa3</code></a></td><td><code>Added inner_product_ring</code></td></tr></table>\n",
    "created_at": "2018-02-20T06:50:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361628",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8f2172df17d33e2378cfab2915a276f009cf7eef"><code>8f2172d</code></a></td><td><code>Merge branch 'develop' into t/23958/allow_rational_inner_products_for_free_quadratic_zz_modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da0efa3cbd28c6afcc2ea6b0bf2e29debc159a7b"><code>da0efa3</code></a></td><td><code>Added inner_product_ring</code></td></tr></table>




---

archive/issue_comments_361629.json:
```json
{
    "body": "Changed commit from **[`87db5c0`](https://github.com/sagemath/sagetrac-mirror/commit/87db5c08843acbfe05e49be1ad6dac515cd86672)** to **[`da0efa3`](https://github.com/sagemath/sagetrac-mirror/commit/da0efa3cbd28c6afcc2ea6b0bf2e29debc159a7b)**",
    "created_at": "2018-02-20T06:50:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361629",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`87db5c0`](https://github.com/sagemath/sagetrac-mirror/commit/87db5c08843acbfe05e49be1ad6dac515cd86672)** to **[`da0efa3`](https://github.com/sagemath/sagetrac-mirror/commit/da0efa3cbd28c6afcc2ea6b0bf2e29debc159a7b)**



---

archive/issue_comments_361630.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1182776c2fcb849fa47b184569804f4ccb426403\"><code>1182776</code></a></td><td><code>Changed printing. restriced inner_product_ring</code></td></tr></table>\n",
    "created_at": "2018-02-20T18:17:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361630",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1182776c2fcb849fa47b184569804f4ccb426403"><code>1182776</code></a></td><td><code>Changed printing. restriced inner_product_ring</code></td></tr></table>




---

archive/issue_comments_361631.json:
```json
{
    "body": "Changed commit from **[`da0efa3`](https://github.com/sagemath/sagetrac-mirror/commit/da0efa3cbd28c6afcc2ea6b0bf2e29debc159a7b)** to **[`1182776`](https://github.com/sagemath/sagetrac-mirror/commit/1182776c2fcb849fa47b184569804f4ccb426403)**",
    "created_at": "2018-02-20T18:17:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361631",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`da0efa3`](https://github.com/sagemath/sagetrac-mirror/commit/da0efa3cbd28c6afcc2ea6b0bf2e29debc159a7b)** to **[`1182776`](https://github.com/sagemath/sagetrac-mirror/commit/1182776c2fcb849fa47b184569804f4ccb426403)**



---

archive/issue_events_329817.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-02-20T18:19:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329817"
}
```



---

archive/issue_events_329818.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-02-20T18:19:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329818"
}
```



---

archive/issue_comments_361632.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n Inner products / bilinear forms  like\n \n-ZZ x ZZ --> CC , RR, QQ, GF(q)\n+`ZZ x ZZ --> CC , RR, QQ`\n \n etc. make sense.\n \n-More general let M be a free module over R and let B be a ring which has a coercion morphisms R --> B, then inner products\n-M x M --> B make sense and should be allowed. \n+More general, let `M` be a free module over `R` and let `B` be a ring containing `R` then inner products\n+`M x M --> B` make sense and can be allowed. \n``````\n",
    "created_at": "2018-02-20T18:19:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361632",
    "user": "https://github.com/simonbrandhorst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
 Inner products / bilinear forms  like
 
-ZZ x ZZ --> CC , RR, QQ, GF(q)
+`ZZ x ZZ --> CC , RR, QQ`
 
 etc. make sense.
 
-More general let M be a free module over R and let B be a ring which has a coercion morphisms R --> B, then inner products
-M x M --> B make sense and should be allowed. 
+More general, let `M` be a free module over `R` and let `B` be a ring containing `R` then inner products
+`M x M --> B` make sense and can be allowed. 
``````




---

archive/issue_comments_361633.json:
```json
{
    "body": "Changed commit from **[`1182776`](https://github.com/sagemath/sagetrac-mirror/commit/1182776c2fcb849fa47b184569804f4ccb426403)** to **[`490980c`](https://github.com/sagemath/sagetrac-mirror/commit/490980cafa15c02f435cf5d554211ba7e1312d13)**",
    "created_at": "2018-03-20T11:06:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361633",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1182776`](https://github.com/sagemath/sagetrac-mirror/commit/1182776c2fcb849fa47b184569804f4ccb426403)** to **[`490980c`](https://github.com/sagemath/sagetrac-mirror/commit/490980cafa15c02f435cf5d554211ba7e1312d13)**



---

archive/issue_comments_361634.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/490980cafa15c02f435cf5d554211ba7e1312d13\"><code>490980c</code></a></td><td><code>Merge branch 'develop' into t/23958/allow_rational_inner_products_for_free_quadratic_zz_modules</code></td></tr></table>\n",
    "created_at": "2018-03-20T11:06:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361634",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/490980cafa15c02f435cf5d554211ba7e1312d13"><code>490980c</code></a></td><td><code>Merge branch 'develop' into t/23958/allow_rational_inner_products_for_free_quadratic_zz_modules</code></td></tr></table>




---

archive/issue_events_329819.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-03-20T11:10:28Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329819"
}
```



---

archive/issue_events_329820.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-03-20T11:10:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329820"
}
```



---

archive/issue_comments_361635.json:
```json
{
    "body": "Author: **Simon Brandhorst**",
    "created_at": "2018-03-20T11:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361635",
    "user": "https://github.com/simonbrandhorst"
}
```

Author: **Simon Brandhorst**



---

archive/issue_comments_361636.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI don't think this is scaling well. IMO, it would be better to have a class for inner products that holds its (co)domains and takes that into account for comparisons. This would have better separation-of-concerns and make the code easier to maintain.\n\nAddendum: I might also have a use for such a class; plus it would allow you to use coercions.",
    "created_at": "2018-05-05T23:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361636",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

I don't think this is scaling well. IMO, it would be better to have a class for inner products that holds its (co)domains and takes that into account for comparisons. This would have better separation-of-concerns and make the code easier to maintain.

Addendum: I might also have a use for such a class; plus it would allow you to use coercions.



---

archive/issue_comments_361637.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nMaybe you are right. I guess calling the coercion model each time you compute the inner\nproduct is too slow. So explicitly saving the ring might be better.\nThough it might be a while till I have time for this.",
    "created_at": "2018-05-10T21:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361637",
    "user": "https://github.com/simonbrandhorst"
}
```

<div id="comment:10" align="right">comment:10</div>

Maybe you are right. I guess calling the coercion model each time you compute the inner
product is too slow. So explicitly saving the ring might be better.
Though it might be a while till I have time for this.



---

archive/issue_events_329821.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-05-10T21:27:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329821"
}
```



---

archive/issue_events_329822.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-05-10T21:27:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329822"
}
```



---

archive/issue_comments_361638.json:
```json
{
    "body": "Changed commit from **[`490980c`](https://github.com/sagemath/sagetrac-mirror/commit/490980cafa15c02f435cf5d554211ba7e1312d13)** to **[`80e144c`](https://github.com/sagemath/sagetrac-mirror/commit/80e144cc2532e88d9c19792c37c7d972e11aec4c)**",
    "created_at": "2018-05-18T15:18:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361638",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`490980c`](https://github.com/sagemath/sagetrac-mirror/commit/490980cafa15c02f435cf5d554211ba7e1312d13)** to **[`80e144c`](https://github.com/sagemath/sagetrac-mirror/commit/80e144cc2532e88d9c19792c37c7d972e11aec4c)**



---

archive/issue_comments_361639.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06e28a52441b6b49b07975ea4f670d2c33ea89cf\"><code>06e28a5</code></a></td><td><code>Merge branch 'develop' into t/23958/allow_rational_inner_products_for_free_quadratic_zz_modules</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/80e144cc2532e88d9c19792c37c7d972e11aec4c\"><code>80e144c</code></a></td><td><code>inner_product_ring as attribute</code></td></tr></table>\n",
    "created_at": "2018-05-18T15:18:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361639",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06e28a52441b6b49b07975ea4f670d2c33ea89cf"><code>06e28a5</code></a></td><td><code>Merge branch 'develop' into t/23958/allow_rational_inner_products_for_free_quadratic_zz_modules</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/80e144cc2532e88d9c19792c37c7d972e11aec4c"><code>80e144c</code></a></td><td><code>inner_product_ring as attribute</code></td></tr></table>




---

archive/issue_comments_361640.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nIs this what you had in mind?",
    "created_at": "2018-05-18T15:19:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361640",
    "user": "https://github.com/simonbrandhorst"
}
```

<div id="comment:13" align="right">comment:13</div>

Is this what you had in mind?



---

archive/issue_events_329823.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-05-18T15:19:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329823"
}
```



---

archive/issue_events_329824.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-05-18T15:19:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329824"
}
```



---

archive/issue_comments_361641.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSomewhat. I was thinking of having a full class for bilinear forms along the lines of:\n\n```python\nclass BilinearForm(object):\n    def __init__(self, V, W, R, matrix):\n        self._matrix = matrix\n        self._V = V\n        self._W = W\n        self._codomain = R\n\n    def __call__(self, v, w):\n        v = self._V(v)\n        w = self._W(w)\n        return self._codomain(dot_product_wrt_matrix(v, w))\n\n    def codomain(self):\n        return self._codomain\n```\nIdeally it would inherit from `Morphism`, but we don't have tensor products of `FreeModule`s.\n\nAlso, I believe only the first check for a coercion between two objects should be slow and all other subsequent coercion checks between the same two parents are cached.",
    "created_at": "2018-05-18T15:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361641",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

Somewhat. I was thinking of having a full class for bilinear forms along the lines of:

```python
class BilinearForm(object):
    def __init__(self, V, W, R, matrix):
        self._matrix = matrix
        self._V = V
        self._W = W
        self._codomain = R

    def __call__(self, v, w):
        v = self._V(v)
        w = self._W(w)
        return self._codomain(dot_product_wrt_matrix(v, w))

    def codomain(self):
        return self._codomain
```
Ideally it would inherit from `Morphism`, but we don't have tensor products of `FreeModule`s.

Also, I believe only the first check for a coercion between two objects should be slow and all other subsequent coercion checks between the same two parents are cached.



---

archive/issue_comments_361642.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThis sounds like an almost complete rewrite of the `FreeQuadraticModule` class?",
    "created_at": "2018-05-20T05:40:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361642",
    "user": "https://github.com/simonbrandhorst"
}
```

<div id="comment:15" align="right">comment:15</div>

This sounds like an almost complete rewrite of the `FreeQuadraticModule` class?



---

archive/issue_comments_361643.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@simonbrandhorst](#comment%3A15):\n> This sounds like an almost complete rewrite of the `FreeQuadraticModule` class?\n\nIt shouldn't be. It is just extracting out one component: the bilinear form (matrix). However, you are putting more and more into one class that is not purely a concern for that class. Does the `FreeQuadraticModule` class care about the inner product ring or is that really a concern of the bilinear form? Think about it this way, mathematically you first define a bilinear form, then you define the quadratic module, correct?\n\nAlso, it would make it easier for other code that uses inner products to take advantage. In principle, all you should be doing is just wrapping the `inner_product_matrix` object, so there should be minimal change beyond that (maybe a few other redirects).",
    "created_at": "2018-05-21T04:49:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361643",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@simonbrandhorst](#comment%3A15):
> This sounds like an almost complete rewrite of the `FreeQuadraticModule` class?

It shouldn't be. It is just extracting out one component: the bilinear form (matrix). However, you are putting more and more into one class that is not purely a concern for that class. Does the `FreeQuadraticModule` class care about the inner product ring or is that really a concern of the bilinear form? Think about it this way, mathematically you first define a bilinear form, then you define the quadratic module, correct?

Also, it would make it easier for other code that uses inner products to take advantage. In principle, all you should be doing is just wrapping the `inner_product_matrix` object, so there should be minimal change beyond that (maybe a few other redirects).



---

archive/issue_comments_361644.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nGuess you are right. Though in the near future I will not have time for it.",
    "created_at": "2018-10-02T10:22:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361644",
    "user": "https://github.com/simonbrandhorst"
}
```

<div id="comment:17" align="right">comment:17</div>

Guess you are right. Though in the near future I will not have time for it.



---

archive/issue_events_329825.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-10-02T10:22:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329825"
}
```



---

archive/issue_events_329826.json:
```json
{
    "actor": "https://github.com/simonbrandhorst",
    "created_at": "2018-10-02T10:22:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329826"
}
```



---

archive/issue_events_329827.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-04T05:33:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329827"
}
```



---

archive/issue_events_329828.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-07-04T05:33:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329828"
}
```



---

archive/issue_events_329829.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329829"
}
```



---

archive/issue_events_329830.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-13T17:11:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329830"
}
```



---

archive/issue_comments_361645.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361645",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:20" align="right">comment:20</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_329831.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329831"
}
```



---

archive/issue_events_329832.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329832"
}
```



---

archive/issue_events_329833.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329833"
}
```



---

archive/issue_events_329834.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T00:44:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329834"
}
```



---

archive/issue_comments_361646.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nSetting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23958#issuecomment-361646",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:21" align="right">comment:21</div>

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_events_329835.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329835"
}
```



---

archive/issue_events_329836.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:24:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329836"
}
```



---

archive/issue_events_329837.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329837"
}
```



---

archive/issue_events_329838.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T20:27:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329838"
}
```



---

archive/issue_events_329839.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329839"
}
```



---

archive/issue_events_329840.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23958",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23958#event-329840"
}
```
