# Issue 23355: affine hull of one point polyhedron

archive/issues_023118.json:
```json
{
    "body": "When using the orthogonal/orthonormal feature of the affine hull function of a polyhedron (introduced in #22804), there is a problem with the one point polyhedron:\n\n\n```\nsage: P = Polyhedron([[7]])\nsage: P\nA 0-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex\nsage: P.affine_hull()\nA 0-dimensional polyhedron in ZZ^0 defined as the convex hull of 1 verte\nsage: P.affine_hull(orthogonal='True')\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: unsupported operand parent(s) for *: 'Full MatrixSpace of 0 by 0 dense matrices over Integer Ring' and 'Ambient free module of rank 1 over the principal ideal domain Integer Ring'\nsage: P.affine_hull(orthonormal='True')\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: unsupported operand parent(s) for *: 'Full MatrixSpace of 0 by 0 dense matrices over Integer Ring' and 'Ambient free module of rank 1 over the principal ideal domain Integer Ring'\n```\n\nThis is how it should be:\n\n```\nsage: P = Polyhedron([[7]]); P\nA 0-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex\nsage: P.affine_hull()\nA 0-dimensional polyhedron in ZZ^0 defined as the convex hull of 1 vertex\nsage: P.affine_hull(orthonormal='True')\nA 0-dimensional polyhedron in QQ^0 defined as the convex hull of 1 vertex\nsage: P.affine_hull(orthogonal='True')\nA 0-dimensional polyhedron in QQ^0 defined as the convex hull of 1 vertex\n```\n\nCC:  @videlec @jplab\n\nKeywords: polyhedron\n\nReviewer: Jean-Philippe Labb\u00e9\n\nAuthor: Moritz Firsching\n\nBranch: 9fccf4ed8fd21d8500ad78cbcfac142847cffccd\n\nDependencies: #22804\n\nCommit: 9fccf4ed8fd21d8500ad78cbcfac142847cffccd\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23355\n\n",
    "closed_at": "2017-08-03T22:11:19Z",
    "created_at": "2017-07-03T09:11:58Z",
    "labels": [
        "component: geometry",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "affine hull of one point polyhedron",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23355",
    "user": "https://github.com/mo271"
}
```
When using the orthogonal/orthonormal feature of the affine hull function of a polyhedron (introduced in #22804), there is a problem with the one point polyhedron:


```
sage: P = Polyhedron([[7]])
sage: P
A 0-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex
sage: P.affine_hull()
A 0-dimensional polyhedron in ZZ^0 defined as the convex hull of 1 verte
sage: P.affine_hull(orthogonal='True')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: unsupported operand parent(s) for *: 'Full MatrixSpace of 0 by 0 dense matrices over Integer Ring' and 'Ambient free module of rank 1 over the principal ideal domain Integer Ring'
sage: P.affine_hull(orthonormal='True')
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: unsupported operand parent(s) for *: 'Full MatrixSpace of 0 by 0 dense matrices over Integer Ring' and 'Ambient free module of rank 1 over the principal ideal domain Integer Ring'
```

This is how it should be:

```
sage: P = Polyhedron([[7]]); P
A 0-dimensional polyhedron in ZZ^1 defined as the convex hull of 1 vertex
sage: P.affine_hull()
A 0-dimensional polyhedron in ZZ^0 defined as the convex hull of 1 vertex
sage: P.affine_hull(orthonormal='True')
A 0-dimensional polyhedron in QQ^0 defined as the convex hull of 1 vertex
sage: P.affine_hull(orthogonal='True')
A 0-dimensional polyhedron in QQ^0 defined as the convex hull of 1 vertex
```

CC:  @videlec @jplab

Keywords: polyhedron

Reviewer: Jean-Philippe Labb√©

Author: Moritz Firsching

Branch: 9fccf4ed8fd21d8500ad78cbcfac142847cffccd

Dependencies: #22804

Commit: 9fccf4ed8fd21d8500ad78cbcfac142847cffccd

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23355





---

archive/issue_comments_323055.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-03T09:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23355#issuecomment-323055",
    "user": "https://github.com/mo271"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_323056.json:
```json
{
    "body": "<a id='comment:2'></a>The reason why this didn't work properly is the fact that if a Matrix is generated from a list it cannot correctly guess its dimensions if the list is empty. The whole fix is simply to exchange the line\n\n```\nM = matrix(self.base_ring(), [list(w) for w in itertools.islice(v.neighbors(), self.dim())])\n``` \nby\n\n```\nM = matrix(self.base_ring(), self.dim(), self.ambient_dim(), [list(w) for w in itertools.islice(v.neighbors(), self.dim())])\n``` \ngiving the dimensions explicitly. I also added a doctest (under the section TESTS) documenting that the bug is fixed.\n\n---\nNew commits:",
    "created_at": "2017-07-03T09:18:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23355#issuecomment-323056",
    "user": "https://github.com/mo271"
}
```

<a id='comment:2'></a>The reason why this didn't work properly is the fact that if a Matrix is generated from a list it cannot correctly guess its dimensions if the list is empty. The whole fix is simply to exchange the line

```
M = matrix(self.base_ring(), [list(w) for w in itertools.islice(v.neighbors(), self.dim())])
``` 
by

```
M = matrix(self.base_ring(), self.dim(), self.ambient_dim(), [list(w) for w in itertools.islice(v.neighbors(), self.dim())])
``` 
giving the dimensions explicitly. I also added a doctest (under the section TESTS) documenting that the bug is fixed.

---
New commits:



---

archive/issue_comments_323057.json:
```json
{
    "body": "<a id='comment:3'></a>Hi Moritz,\n\nCould you add a reference to this ticket just before the tests you added?\n\nApart from that it looks good to me! You can set it to positive review on my behalf once this is done!",
    "created_at": "2017-07-12T08:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23355#issuecomment-323057",
    "user": "https://github.com/jplab"
}
```

<a id='comment:3'></a>Hi Moritz,

Could you add a reference to this ticket just before the tests you added?

Apart from that it looks good to me! You can set it to positive review on my behalf once this is done!



---

archive/issue_comments_323058.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-13T16:39:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23355#issuecomment-323058",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323059.json:
```json
{
    "body": "<a id='comment:6'></a>thanks for the review, JP!\n\nI added the desired reference and will put it on 'positive review' as you suggested",
    "created_at": "2017-07-13T16:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23355#issuecomment-323059",
    "user": "https://github.com/mo271"
}
```

<a id='comment:6'></a>thanks for the review, JP!

I added the desired reference and will put it on 'positive review' as you suggested



---

archive/issue_comments_323060.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-13T16:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23355#issuecomment-323060",
    "user": "https://github.com/mo271"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_323061.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-03T22:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23355",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23355#issuecomment-323061",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_060106.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-03T22:11:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23355",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23355#event-60106"
}
```
