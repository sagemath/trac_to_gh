# Issue 23210: immediate dominators and strong articulation points

archive/issues_022973.json:
```json
{
    "body": "Adds methods `immediate_dominators` and `strong_articulation_points` for directed graphs.\n* The `immediate_dominators` is essentially the same as the NetworkX method. I tried to implement more recent algorithms [1], but the running times were not so good.\n* The `strong_articulation_points` is as presented in [2].\n\nI let the `strong_bridges` method for another ticket.\n\n---\n\n[1] Loukas Georgiadis. Linear-Time Algorithms for Dominators and Related Problems, PhD thesis, Princetown University, (2005). ftp://ftp.cs.princeton.edu/reports/2005/737.pdf\n\n[2] Giuseppe F. Italiano, Luigi Laura, and Federico Santaroni. Finding strong bridges and strong articulation points in linear time. Theoretical Computer Science, 447, 74\u201384 (2012).\n\nBranch/Commit: cb1811a160fb92426feed3ab093ed93973fbd06e\n\nReviewer: Travis Scrimshaw\n\nAuthor: David Coudert\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23210\n\n",
    "closed_at": "2017-08-13T09:44:52Z",
    "created_at": "2017-06-10T17:58:56Z",
    "labels": [
        "component: graph theory",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "immediate dominators and strong articulation points",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23210",
    "user": "https://github.com/dcoudert"
}
```
Adds methods `immediate_dominators` and `strong_articulation_points` for directed graphs.
* The `immediate_dominators` is essentially the same as the NetworkX method. I tried to implement more recent algorithms [1], but the running times were not so good.
* The `strong_articulation_points` is as presented in [2].

I let the `strong_bridges` method for another ticket.

---

[1] Loukas Georgiadis. Linear-Time Algorithms for Dominators and Related Problems, PhD thesis, Princetown University, (2005). ftp://ftp.cs.princeton.edu/reports/2005/737.pdf

[2] Giuseppe F. Italiano, Luigi Laura, and Federico Santaroni. Finding strong bridges and strong articulation points in linear time. Theoretical Computer Science, 447, 74–84 (2012).

Branch/Commit: cb1811a160fb92426feed3ab093ed93973fbd06e

Reviewer: Travis Scrimshaw

Author: David Coudert

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23210





---

archive/issue_comments_435848.json:
```json
{
    "body": "Changing branch from \"\" to \"u/dcoudert/23210\"",
    "created_at": "2017-06-10T18:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435848",
    "user": "https://github.com/dcoudert"
}
```

Changing branch from "" to "u/dcoudert/23210"



---

archive/issue_comments_435849.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2017-06-10T18:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435849",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_435850.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n Adds methods `immediate_dominators` and `strong_articulation_points` for directed graphs.\n+* The `immediate_dominators` is essentially the same as the NetworkX method. I tried to implement more recent algorithms [1], but the running times were not so good.\n+* The `strong_articulation_points` is as presented in [2].\n+\n+I have not included the `strong_bridges` method.\n+\n+---\n+\n+[1] Loukas Georgiadis. Linear-Time Algorithms for Dominators and Related Problems, PhD thesis, Princetown University, (2005). ftp://ftp.cs.princeton.edu/reports/2005/737.pdf\n+\n+[2] Giuseppe F. Italiano, Luigi Laura, and Federico Santaroni. Finding strong bridges and strong articulation points in linear time. Theoretical Computer Science, 447, 74\u201384 (2012).\n \n Author: David Coudert\n \n``````\n",
    "created_at": "2017-06-10T18:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435850",
    "user": "https://github.com/dcoudert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
 Adds methods `immediate_dominators` and `strong_articulation_points` for directed graphs.
+* The `immediate_dominators` is essentially the same as the NetworkX method. I tried to implement more recent algorithms [1], but the running times were not so good.
+* The `strong_articulation_points` is as presented in [2].
+
+I have not included the `strong_bridges` method.
+
+---
+
+[1] Loukas Georgiadis. Linear-Time Algorithms for Dominators and Related Problems, PhD thesis, Princetown University, (2005). ftp://ftp.cs.princeton.edu/reports/2005/737.pdf
+
+[2] Giuseppe F. Italiano, Luigi Laura, and Federico Santaroni. Finding strong bridges and strong articulation points in linear time. Theoretical Computer Science, 447, 74–84 (2012).
 
 Author: David Coudert
 
``````




---

archive/issue_comments_435851.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-10T18:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435851",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_435852.json:
```json
{
    "body": "Changing commit from \"\" to \"e054cdde472974fc554dd1779a95ef17589ed89c\"",
    "created_at": "2017-06-10T18:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435852",
    "user": "https://github.com/dcoudert"
}
```

Changing commit from "" to "e054cdde472974fc554dd1779a95ef17589ed89c"



---

archive/issue_comments_435853.json:
```json
{
    "body": "Changing commit from \"e054cdde472974fc554dd1779a95ef17589ed89c\" to \"43b3970232fe9ab49fb75a28b4aefc0c966a7c19\"",
    "created_at": "2017-06-11T07:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435853",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e054cdde472974fc554dd1779a95ef17589ed89c" to "43b3970232fe9ab49fb75a28b4aefc0c966a7c19"



---

archive/issue_comments_435854.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-11T07:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435854",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435855.json:
```json
{
    "body": "<a id='comment:3'></a>Quick comments:\n\n- Use `r` instead of `root` in the doc as it gives better latex.\n- No period (full stop) at the end here:\n  {{{\n        - ``root`` -- a vertex of the digraph, the root of the\n          immediate dominators tree.\n  }}}\n- ~if not root in self:` to ` if root not in self:`.\n- Stylistic, but I prefer `SAP = []` to `SAP = list()` as it is shorter (and IMO, cleaner)\n- How difficult would it be to modify `immediate_dominators` to have an argument to handle the reversed case? This would make it so you do not have to construct the reversed `DiGraph`, which could be very costly in terms of time/memory. At least, this seems like it would be straightforward to do.\n\nI will give more detailed comments later.",
    "created_at": "2017-06-11T23:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435855",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>Quick comments:

- Use `r` instead of `root` in the doc as it gives better latex.
- No period (full stop) at the end here:
  {{{
        - ``root`` -- a vertex of the digraph, the root of the
          immediate dominators tree.
  }}}
- ~if not root in self:` to ` if root not in self:`.
- Stylistic, but I prefer `SAP = []` to `SAP = list()` as it is shorter (and IMO, cleaner)
- How difficult would it be to modify `immediate_dominators` to have an argument to handle the reversed case? This would make it so you do not have to construct the reversed `DiGraph`, which could be very costly in terms of time/memory. At least, this seems like it would be straightforward to do.

I will give more detailed comments later.



---

archive/issue_comments_435856.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-12T07:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435856",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435857.json:
```json
{
    "body": "Changing commit from \"43b3970232fe9ab49fb75a28b4aefc0c966a7c19\" to \"6ce69d316c261a00797b5c1a2c3621ea70a1a837\"",
    "created_at": "2017-06-12T07:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435857",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "43b3970232fe9ab49fb75a28b4aefc0c966a7c19" to "6ce69d316c261a00797b5c1a2c3621ea70a1a837"



---

archive/issue_comments_435858.json:
```json
{
    "body": "<a id='comment:5'></a>Thank you for your comments. \n\nTo handle the reversed case in `immediate_dominators`, we need a reversed (or backward) depth first search. This is currently implemented only for the `c_graph` backend.\nWhat I can do is to check in `immediate_dominators` if the backend is `c_graph` and raise an error if it is not the case and the reverse parameter is True. Then, in the `strong_articulation_points` method, I can make a copy of the digraph using the `c_graph` backend if self uses a different backend.\nI will also have to check the backend used in `strongly_connected_component_subgraphs`.\n\nDo you have other suggestions?",
    "created_at": "2017-06-12T07:13:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435858",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:5'></a>Thank you for your comments. 

To handle the reversed case in `immediate_dominators`, we need a reversed (or backward) depth first search. This is currently implemented only for the `c_graph` backend.
What I can do is to check in `immediate_dominators` if the backend is `c_graph` and raise an error if it is not the case and the reverse parameter is True. Then, in the `strong_articulation_points` method, I can make a copy of the digraph using the `c_graph` backend if self uses a different backend.
I will also have to check the backend used in `strongly_connected_component_subgraphs`.

Do you have other suggestions?



---

archive/issue_comments_435859.json:
```json
{
    "body": "<a id='comment:6'></a>Another issue: the current code is not working with immutable graphs...",
    "created_at": "2017-06-12T09:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435859",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>Another issue: the current code is not working with immutable graphs...



---

archive/issue_comments_435860.json:
```json
{
    "body": "<a id='comment:7'></a>Ah, right, reversing a dfs is not the same thing on the reverse graph. Then don't worry about it; premature optimization, root of all evil, and whatnot.",
    "created_at": "2017-06-12T12:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435860",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>Ah, right, reversing a dfs is not the same thing on the reverse graph. Then don't worry about it; premature optimization, root of all evil, and whatnot.



---

archive/issue_comments_435861.json:
```json
{
    "body": "<a id='comment:8'></a>Since I have to take care of 1) immutable graphs and 2) that I should not modify the input graph (I'm currently removing/adding edges to test if `r` is a SAP, I must:\n- if the input graph is strongly connected: make a mutable copy, preferably using a backend with the reverse DFS option\n- for each strongly connected component, get a mutable subgraph, preferably using the good backend\n\nThen in method `immediate_dominators`, I could add a parameter `reverse` that could be used only if the backend has the desirable method (otherwise raise an error).\n\ndo you have other suggestions before I start modifying the code?",
    "created_at": "2017-06-12T13:01:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435861",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:8'></a>Since I have to take care of 1) immutable graphs and 2) that I should not modify the input graph (I'm currently removing/adding edges to test if `r` is a SAP, I must:
- if the input graph is strongly connected: make a mutable copy, preferably using a backend with the reverse DFS option
- for each strongly connected component, get a mutable subgraph, preferably using the good backend

Then in method `immediate_dominators`, I could add a parameter `reverse` that could be used only if the backend has the desirable method (otherwise raise an error).

do you have other suggestions before I start modifying the code?



---

archive/issue_comments_435862.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-12T15:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435862",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435863.json:
```json
{
    "body": "Changing commit from \"6ce69d316c261a00797b5c1a2c3621ea70a1a837\" to \"08a35a9824ddde635d742c7e57797618c5eaa5a9\"",
    "created_at": "2017-06-12T15:49:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435863",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6ce69d316c261a00797b5c1a2c3621ea70a1a837" to "08a35a9824ddde635d742c7e57797618c5eaa5a9"



---

archive/issue_comments_435864.json:
```json
{
    "body": "<a id='comment:10'></a>This should solve our issues.",
    "created_at": "2017-06-12T15:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435864",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:10'></a>This should solve our issues.



---

archive/issue_comments_435865.json:
```json
{
    "body": "<a id='comment:11'></a>Ready to review",
    "created_at": "2017-07-07T03:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435865",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:11'></a>Ready to review



---

archive/issue_comments_435866.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-11T11:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_435867.json:
```json
{
    "body": "Changing commit from \"08a35a9824ddde635d742c7e57797618c5eaa5a9\" to \"cb1811a160fb92426feed3ab093ed93973fbd06e\"",
    "created_at": "2017-08-11T11:14:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435867",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "08a35a9824ddde635d742c7e57797618c5eaa5a9" to "cb1811a160fb92426feed3ab093ed93973fbd06e"



---

archive/issue_events_059895.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2017-08-11T11:15:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23210#event-59895"
}
```



---

archive/issue_comments_435868.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+Adds methods `immediate_dominators` and `strong_articulation_points` for directed graphs.\n+* The `immediate_dominators` is essentially the same as the NetworkX method. I tried to implement more recent algorithms [1], but the running times were not so good.\n+* The `strong_articulation_points` is as presented in [2].\n \n+I let the `strong_bridges` method for another ticket.\n+\n+---\n+\n+[1] Loukas Georgiadis. Linear-Time Algorithms for Dominators and Related Problems, PhD thesis, Princetown University, (2005). ftp://ftp.cs.princeton.edu/reports/2005/737.pdf\n+\n+[2] Giuseppe F. Italiano, Luigi Laura, and Federico Santaroni. Finding strong bridges and strong articulation points in linear time. Theoretical Computer Science, 447, 74\u201384 (2012).\n \n Author: David Coudert\n \n``````\n",
    "created_at": "2017-08-11T11:15:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435868",
    "user": "https://github.com/dcoudert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
+Adds methods `immediate_dominators` and `strong_articulation_points` for directed graphs.
+* The `immediate_dominators` is essentially the same as the NetworkX method. I tried to implement more recent algorithms [1], but the running times were not so good.
+* The `strong_articulation_points` is as presented in [2].
 
+I let the `strong_bridges` method for another ticket.
+
+---
+
+[1] Loukas Georgiadis. Linear-Time Algorithms for Dominators and Related Problems, PhD thesis, Princetown University, (2005). ftp://ftp.cs.princeton.edu/reports/2005/737.pdf
+
+[2] Giuseppe F. Italiano, Luigi Laura, and Federico Santaroni. Finding strong bridges and strong articulation points in linear time. Theoretical Computer Science, 447, 74–84 (2012).
 
 Author: David Coudert
 
``````




---

archive/issue_comments_435869.json:
```json
{
    "body": "<a id='comment:14'></a>Sorry for letting this drop off my radar. LGTM.",
    "created_at": "2017-08-11T15:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435869",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>Sorry for letting this drop off my radar. LGTM.



---

archive/issue_comments_435870.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2017-08-11T15:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435870",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_435871.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-11T15:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435871",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_435872.json:
```json
{
    "body": "<a id='comment:15'></a>Thank you Travis.",
    "created_at": "2017-08-11T15:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435872",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:15'></a>Thank you Travis.



---

archive/issue_comments_435873.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-13T09:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435873",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_059896.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-13T09:44:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23210#event-59896"
}
```



---

archive/issue_comments_435874.json:
```json
{
    "body": "Changing branch from \"u/dcoudert/23210\" to \"cb1811a160fb92426feed3ab093ed93973fbd06e\"",
    "created_at": "2017-08-13T09:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23210",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23210#issuecomment-435874",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/dcoudert/23210" to "cb1811a160fb92426feed3ab093ed93973fbd06e"
