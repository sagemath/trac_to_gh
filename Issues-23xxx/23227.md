# Issue 23227: Add cpdef declarations in pxd files when overwriting a cdef method

archive/issues_022990.json:
```json
{
    "body": "See https://github.com/cython/cython/issues/1732.\n\nCC:  @saraedum\n\nBranch/Commit: 919de01b8f0d0a5a2ee32d722d4c5ff8b018880a\n\nUpstream: Fixed upstream, but not in a stable release.\n\nReviewer: Jeroen Demeyer\n\nAuthor: David Roe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23227\n\n",
    "closed_at": "2017-08-11T18:18:03Z",
    "created_at": "2017-06-13T06:11:00Z",
    "labels": [
        "component: cython",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Add cpdef declarations in pxd files when overwriting a cdef method",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23227",
    "user": "https://github.com/roed314"
}
```
See https://github.com/cython/cython/issues/1732.

CC:  @saraedum

Branch/Commit: 919de01b8f0d0a5a2ee32d722d4c5ff8b018880a

Upstream: Fixed upstream, but not in a stable release.

Reviewer: Jeroen Demeyer

Author: David Roe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23227





---

archive/issue_comments_438908.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. No feedback yet.\"",
    "created_at": "2017-06-13T06:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438908",
    "user": "https://github.com/roed314"
}
```

Changing upstream from "N/A" to "Reported upstream. No feedback yet."



---

archive/issue_comments_438909.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n See https://github.com/cython/cython/issues/1732\n \n-This affects `Polynomial_generic_dense` at least.\n+See https://gist.github.com/roed314/d00b5cf5e0c1134dd381f47f5d828168 for a list of potential problems.\n``````\n",
    "created_at": "2017-06-13T07:35:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438909",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 See https://github.com/cython/cython/issues/1732
 
-This affects `Polynomial_generic_dense` at least.
+See https://gist.github.com/roed314/d00b5cf5e0c1134dd381f47f5d828168 for a list of potential problems.
``````




---

archive/issue_comments_438910.json:
```json
{
    "body": "<a id='comment:3'></a>\nHow did you come up with this? Is there a specific concrete problem or just a theoretical bug?\n\nBy the way, the gist link talks about \"`cpdef`'d without a corresponding entry in their pxd file\" while the Cython bug talks about \"`cpdef` override of a `cdef` method\". These are obviously different things, so what is the problem exactly? If the problem is only `cpdef` overrides of `cdef` methods, I guess that a large majority of the entries in the gist link are false positives, making that link not very informative.",
    "created_at": "2017-06-13T18:40:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438910",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:3'></a>
How did you come up with this? Is there a specific concrete problem or just a theoretical bug?

By the way, the gist link talks about "`cpdef`'d without a corresponding entry in their pxd file" while the Cython bug talks about "`cpdef` override of a `cdef` method". These are obviously different things, so what is the problem exactly? If the problem is only `cpdef` overrides of `cdef` methods, I guess that a large majority of the entries in the gist link are false positives, making that link not very informative.



---

archive/issue_comments_438911.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [jdemeyer](#comment%3A3):\n> How did you come up with this? Is there a specific concrete problem or just a theoretical bug?\n\n\nYeah, this caused a segfault that saraedum and I spent 10 hours yesterday debugging, while working on #23218.  Because the vtable is screwed up, function calls behave unpredictably.\n \n> By the way, the gist link talks about \"`cpdef`'d without a corresponding entry in their pxd file\" while the Cython bug talks about \"`cpdef` override of a `cdef` method\". These are obviously different things, so what is the problem exactly? If the problem is only `cpdef` overrides of `cdef` methods, I guess that a large majority of the entries in the gist link are false positives, making that link not very informative.\n\n\nYeah, I agree that the link is not that informative.  I wrote something easy to try to get an idea of the scope of the problem, then determined that it wasn't easy to actually find the cases where the problem actually occurs (which is, indeed, where a cdef method is overwritten by a cpdef method without a corresponding entry in the pxd file).  I decided that I wanted to move on and work on other stuff, so I uploaded the gist as a place to start looking.",
    "created_at": "2017-06-13T19:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438911",
    "user": "https://github.com/roed314"
}
```

<a id='comment:4'></a>
Replying to [jdemeyer](#comment%3A3):
> How did you come up with this? Is there a specific concrete problem or just a theoretical bug?


Yeah, this caused a segfault that saraedum and I spent 10 hours yesterday debugging, while working on #23218.  Because the vtable is screwed up, function calls behave unpredictably.
 
> By the way, the gist link talks about "`cpdef`'d without a corresponding entry in their pxd file" while the Cython bug talks about "`cpdef` override of a `cdef` method". These are obviously different things, so what is the problem exactly? If the problem is only `cpdef` overrides of `cdef` methods, I guess that a large majority of the entries in the gist link are false positives, making that link not very informative.


Yeah, I agree that the link is not that informative.  I wrote something easy to try to get an idea of the scope of the problem, then determined that it wasn't easy to actually find the cases where the problem actually occurs (which is, indeed, where a cdef method is overwritten by a cpdef method without a corresponding entry in the pxd file).  I decided that I wanted to move on and work on other stuff, so I uploaded the gist as a place to start looking.



---

archive/issue_comments_438912.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [roed](#comment%3A4):\n> Replying to [jdemeyer](#comment%3A3):\n> > How did you come up with this? Is there a specific concrete problem or just a theoretical bug?\n\n> \n> Yeah, this caused a segfault that saraedum and I spent 10 hours yesterday debugging, while working on #23218.  Because the vtable is screwed up, function calls behave unpredictably.\n\n\nIn particular, we noticed the problem for `Polynomial_generic_dense`, where `_add_`, `_mul_` and `_floordiv_` have this issue.",
    "created_at": "2017-06-13T19:15:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438912",
    "user": "https://github.com/roed314"
}
```

<a id='comment:5'></a>
Replying to [roed](#comment%3A4):
> Replying to [jdemeyer](#comment%3A3):
> > How did you come up with this? Is there a specific concrete problem or just a theoretical bug?

> 
> Yeah, this caused a segfault that saraedum and I spent 10 hours yesterday debugging, while working on #23218.  Because the vtable is screwed up, function calls behave unpredictably.


In particular, we noticed the problem for `Polynomial_generic_dense`, where `_add_`, `_mul_` and `_floordiv_` have this issue.



---

archive/issue_comments_438913.json:
```json
{
    "body": "<a id='comment:6'></a>\nHonestly, I don't think it is realistic to fix the general problem in Sage since the underlying problem is in upstream Cython. Of course, we can fix specific cases like the `Polynomial_generic_dense` that you mentioned.",
    "created_at": "2017-06-13T19:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438913",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>
Honestly, I don't think it is realistic to fix the general problem in Sage since the underlying problem is in upstream Cython. Of course, we can fix specific cases like the `Polynomial_generic_dense` that you mentioned.



---

archive/issue_comments_438914.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [jdemeyer](#comment%3A6):\n> Honestly, I don't think it is realistic to fix the general problem in Sage since the underlying problem is in upstream Cython. Of course, we can fix specific cases like the `Polynomial_generic_dense` that you mentioned.\n\n\nSure, and I'm fine waiting to see what Cython does.  But one possible thing for them to do is to require a cpdef declaration in the pxd file, in which case this ticket can track those additions.",
    "created_at": "2017-06-13T19:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438914",
    "user": "https://github.com/roed314"
}
```

<a id='comment:7'></a>
Replying to [jdemeyer](#comment%3A6):
> Honestly, I don't think it is realistic to fix the general problem in Sage since the underlying problem is in upstream Cython. Of course, we can fix specific cases like the `Polynomial_generic_dense` that you mentioned.


Sure, and I'm fine waiting to see what Cython does.  But one possible thing for them to do is to require a cpdef declaration in the pxd file, in which case this ticket can track those additions.



---

archive/issue_comments_438915.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [roed](#comment%3A7):\n> Replying to [jdemeyer](#comment%3A6):\n> > Honestly, I don't think it is realistic to fix the general problem in Sage since the underlying problem is in upstream Cython. Of course, we can fix specific cases like the `Polynomial_generic_dense` that you mentioned.\n\n> \n> Sure, and I'm fine waiting to see what Cython does.  But one possible thing for them to do is to require a cpdef declaration in the pxd file, in which case this ticket can track those additions.\n\n\nCython will soon raise an error in these cases.  I think the best thing to do is to wait until we update to a new version of Cython and change these pxd files then.  I think it's worth leaving this ticket open until that point in case someone else runs into a similar problem.",
    "created_at": "2017-06-15T06:27:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438915",
    "user": "https://github.com/roed314"
}
```

<a id='comment:8'></a>
Replying to [roed](#comment%3A7):
> Replying to [jdemeyer](#comment%3A6):
> > Honestly, I don't think it is realistic to fix the general problem in Sage since the underlying problem is in upstream Cython. Of course, we can fix specific cases like the `Polynomial_generic_dense` that you mentioned.

> 
> Sure, and I'm fine waiting to see what Cython does.  But one possible thing for them to do is to require a cpdef declaration in the pxd file, in which case this ticket can track those additions.


Cython will soon raise an error in these cases.  I think the best thing to do is to wait until we update to a new version of Cython and change these pxd files then.  I think it's worth leaving this ticket open until that point in case someone else runs into a similar problem.



---

archive/issue_comments_438916.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"Fixed upstream, but not in a stable release.\"",
    "created_at": "2017-06-15T20:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438916",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "Fixed upstream, but not in a stable release."



---

archive/issue_comments_438917.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2017-06-15T20:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438917",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_438918.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [roed](#comment%3A8):\n> Cython will soon raise an error in these cases.\n\n\nI convinced Cython upstream to downgrade this to a warning for now. That will make our life easier, since we can first upgrade to Cython 0.26 (in beta now) and then fix this gradually.",
    "created_at": "2017-07-05T14:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438918",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
Replying to [roed](#comment%3A8):
> Cython will soon raise an error in these cases.


I convinced Cython upstream to downgrade this to a warning for now. That will make our life easier, since we can first upgrade to Cython 0.26 (in beta now) and then fix this gradually.



---

archive/issue_comments_438919.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#23360\"",
    "created_at": "2017-07-22T07:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438919",
    "user": "https://github.com/roed314"
}
```

Changing dependencies from "" to "#23360"



---

archive/issue_comments_438920.json:
```json
{
    "body": "Changing branch from \"\" to \"u/roed/fix_cpdef\"",
    "created_at": "2017-08-03T16:52:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438920",
    "user": "https://github.com/roed314"
}
```

Changing branch from "" to "u/roed/fix_cpdef"



---

archive/issue_comments_438921.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|\n|[99b1e3e](https://github.com/sagemath/sagetrac-mirror/commit/99b1e3eb9e6c30eb97072a628594cca88a2ca097)|`Add cpdef _add_(self, other) and cpdef _mul_(self, other) all over`|",
    "created_at": "2017-08-03T16:54:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438921",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
|[99b1e3e](https://github.com/sagemath/sagetrac-mirror/commit/99b1e3eb9e6c30eb97072a628594cca88a2ca097)|`Add cpdef _add_(self, other) and cpdef _mul_(self, other) all over`|



---

archive/issue_comments_438922.json:
```json
{
    "body": "Changing commit from \"\" to \"99b1e3eb9e6c30eb97072a628594cca88a2ca097\"",
    "created_at": "2017-08-03T16:54:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438922",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "99b1e3eb9e6c30eb97072a628594cca88a2ca097"



---

archive/issue_comments_438923.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer\" to \"David Roe\"",
    "created_at": "2017-08-07T10:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438923",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "Jeroen Demeyer" to "David Roe"



---

archive/issue_comments_438924.json:
```json
{
    "body": "<a id='comment:14'></a>\nReady for review?",
    "created_at": "2017-08-07T10:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438924",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Ready for review?



---

archive/issue_comments_438925.json:
```json
{
    "body": "<a id='comment:15'></a>\nWhy restrict to `_add_` and `_mul_`? (edit: you are not doing that, it's just the commit message implying that you do)",
    "created_at": "2017-08-07T10:04:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438925",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Why restrict to `_add_` and `_mul_`? (edit: you are not doing that, it's just the commit message implying that you do)



---

archive/issue_comments_438926.json:
```json
{
    "body": "<a id='comment:16'></a>\nYeah, I just got lazy going through and figuring out all the functions that I'd actually changed.  I used the log of warnings to find the places to edit, so I think I got them all, but I haven't rebuilt from scratch to check.",
    "created_at": "2017-08-07T17:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438926",
    "user": "https://github.com/roed314"
}
```

<a id='comment:16'></a>
Yeah, I just got lazy going through and figuring out all the functions that I'd actually changed.  I used the log of warnings to find the places to edit, so I think I got them all, but I haven't rebuilt from scratch to check.



---

archive/issue_comments_438927.json:
```json
{
    "body": "<a id='comment:17'></a>\nYeah, I think this is ready for review.  I don't have anything else to add to it.",
    "created_at": "2017-08-07T17:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438927",
    "user": "https://github.com/roed314"
}
```

<a id='comment:17'></a>
Yeah, I think this is ready for review.  I don't have anything else to add to it.



---

archive/issue_comments_438928.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-07T17:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438928",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_438929.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [roed](#comment%3A16):\n> Yeah, I just got lazy going through and figuring out all the functions that I'd actually changed.  I used the log of warnings to find the places to edit, so I think I got them all, but I haven't rebuilt from scratch to check.\n\n\nEven if you didn't catch them all, that's not really a problem.",
    "created_at": "2017-08-08T07:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438929",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [roed](#comment%3A16):
> Yeah, I just got lazy going through and figuring out all the functions that I'd actually changed.  I used the log of warnings to find the places to edit, so I think I got them all, but I haven't rebuilt from scratch to check.


Even if you didn't catch them all, that's not really a problem.



---

archive/issue_comments_438930.json:
```json
{
    "body": "Changing branch from \"u/roed/fix_cpdef\" to \"u/jdemeyer/fix_cpdef\"",
    "created_at": "2017-08-08T08:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438930",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/roed/fix_cpdef" to "u/jdemeyer/fix_cpdef"



---

archive/issue_comments_438931.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2017-08-08T08:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438931",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_438932.json:
```json
{
    "body": "<a id='comment:20'></a>\nRebased to 8.1.beta1\n\n---\nNew commits:\n|                                                                                                                                          |                                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|\n|[e6f5cc5](https://github.com/sagemath/sagetrac-mirror/commit/e6f5cc5c4d50fdbe8d97e22e38c27118a29cc8be)|`Add cpdef _add_(self, other) and cpdef _mul_(self, other) all over`|",
    "created_at": "2017-08-08T08:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438932",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Rebased to 8.1.beta1

---
New commits:
|                                                                                                                                          |                                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------|
|[e6f5cc5](https://github.com/sagemath/sagetrac-mirror/commit/e6f5cc5c4d50fdbe8d97e22e38c27118a29cc8be)|`Add cpdef _add_(self, other) and cpdef _mul_(self, other) all over`|



---

archive/issue_comments_438933.json:
```json
{
    "body": "Changing commit from \"99b1e3eb9e6c30eb97072a628594cca88a2ca097\" to \"e6f5cc5c4d50fdbe8d97e22e38c27118a29cc8be\"",
    "created_at": "2017-08-08T08:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438933",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "99b1e3eb9e6c30eb97072a628594cca88a2ca097" to "e6f5cc5c4d50fdbe8d97e22e38c27118a29cc8be"



---

archive/issue_comments_438934.json:
```json
{
    "body": "<a id='comment:21'></a>\nWhy this?\n\n```diff\n-    cpdef normalize(self)\n+    cpdef normalize(self, include_zeroth_moment = *)\n```",
    "created_at": "2017-08-08T08:02:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438934",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Why this?

```diff
-    cpdef normalize(self)
+    cpdef normalize(self, include_zeroth_moment = *)
```



---

archive/issue_comments_438935.json:
```json
{
    "body": "<a id='comment:22'></a>\nIn some cases, I am wondering whether it is better to add \"abstract\" `_add_` and `_mul_` methods on a lower level. For example, instead of adding those functions to `QuaternionAlgebraElement_generic`, `QuaternionAlgebraElement_number_field` and `QuaternionAlgebraElement_rational_field`, add them to `QuaternionAlgebraElement_abstract` raising `NotImplementedError`.\n\nConcretely for this ticket, I would like to fix only the totally uncontroversial cases (for example, undoing the changes to quaternion algebra elements) and leave the rest for a follow-up.",
    "created_at": "2017-08-08T08:10:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438935",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
In some cases, I am wondering whether it is better to add "abstract" `_add_` and `_mul_` methods on a lower level. For example, instead of adding those functions to `QuaternionAlgebraElement_generic`, `QuaternionAlgebraElement_number_field` and `QuaternionAlgebraElement_rational_field`, add them to `QuaternionAlgebraElement_abstract` raising `NotImplementedError`.

Concretely for this ticket, I would like to fix only the totally uncontroversial cases (for example, undoing the changes to quaternion algebra elements) and leave the rest for a follow-up.



---

archive/issue_comments_438936.json:
```json
{
    "body": "Changing commit from \"e6f5cc5c4d50fdbe8d97e22e38c27118a29cc8be\" to \"919de01b8f0d0a5a2ee32d722d4c5ff8b018880a\"",
    "created_at": "2017-08-08T08:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438936",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e6f5cc5c4d50fdbe8d97e22e38c27118a29cc8be" to "919de01b8f0d0a5a2ee32d722d4c5ff8b018880a"



---

archive/issue_comments_438937.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[919de01](https://github.com/sagemath/sagetrac-mirror/commit/919de01b8f0d0a5a2ee32d722d4c5ff8b018880a)|`Add declarations for cpdef arithmetic functions in .pxd files`|",
    "created_at": "2017-08-08T08:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438937",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[919de01](https://github.com/sagemath/sagetrac-mirror/commit/919de01b8f0d0a5a2ee32d722d4c5ff8b018880a)|`Add declarations for cpdef arithmetic functions in .pxd files`|



---

archive/issue_comments_438938.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-08T12:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438938",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_438939.json:
```json
{
    "body": "<a id='comment:24'></a>\npositive_review to this strict subset of the original patch.",
    "created_at": "2017-08-08T12:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438939",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>
positive_review to this strict subset of the original patch.



---

archive/issue_comments_438940.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n-See https://github.com/cython/cython/issues/1732\n-\n-See https://gist.github.com/roed314/d00b5cf5e0c1134dd381f47f5d828168 for a list of potential problems.\n+See https://github.com/cython/cython/issues/1732.\n``````\n",
    "created_at": "2017-08-08T20:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438940",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1 @@
-See https://github.com/cython/cython/issues/1732
-
-See https://gist.github.com/roed314/d00b5cf5e0c1134dd381f47f5d828168 for a list of potential problems.
+See https://github.com/cython/cython/issues/1732.
``````




---

archive/issue_comments_438941.json:
```json
{
    "body": "<a id='comment:26'></a>\nSee #23600 for the followup.",
    "created_at": "2017-08-08T21:28:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438941",
    "user": "https://github.com/roed314"
}
```

<a id='comment:26'></a>
See #23600 for the followup.



---

archive/issue_comments_438942.json:
```json
{
    "body": "Changing dependencies from \"#23360\" to \"\"",
    "created_at": "2017-08-09T09:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438942",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#23360" to ""



---

archive/issue_comments_438943.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/fix_cpdef\" to \"919de01b8f0d0a5a2ee32d722d4c5ff8b018880a\"",
    "created_at": "2017-08-11T18:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438943",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/fix_cpdef" to "919de01b8f0d0a5a2ee32d722d4c5ff8b018880a"



---

archive/issue_comments_438944.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-11T18:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23227#issuecomment-438944",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_068143.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-11T18:18:03Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23227",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23227#event-68143"
}
```
