# Issue 23102: Support __richcmp__ in Python classes

archive/issues_022865.json:
```json
{
    "body": "Sage has a lot of functionality to deal with \"rich comparisons\" using `__richcmp__` in Cython or `_richcmp_` in Python or Cython for subclasses of `Element`. However, we are still missing rich comparison support for Python classes which are not subclasses from `Element`.\n\nA good example of this is `RealSet` in `src/sage/sets/real_set.py`. Currently, comparison is implemented using `__cmp__`. Changing this to Python 3 comparisons would normally require 6 methods (`__eq__`, `__ne__`, `__lt__`, `__le__`, `__gt__`, `__ge__`). It would be convenient to support this with just one `__richcmp__` method like in Cython.\n\nThis ticket proposes:\n\n1. Add a decorator `richcmp_method` which adds support for `__richcmp__` to a Python class.\n\n2. Implement `RealSet.__richcmp__` using this.\n\nCC:  @fchapoton @tscrim @embray\n\nBranch/Commit: 4d1021b1e2ccd1e811549aeb1e451b9a08cc6251\n\nReviewer: Travis Scrimshaw, Erik Bray\n\nAuthor: Jeroen Demeyer\n\nDependencies: #23103\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23102\n\n",
    "closed_at": "2017-06-22T07:24:28Z",
    "created_at": "2017-05-30T08:25:08Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Support __richcmp__ in Python classes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23102",
    "user": "https://github.com/jdemeyer"
}
```
Sage has a lot of functionality to deal with "rich comparisons" using `__richcmp__` in Cython or `_richcmp_` in Python or Cython for subclasses of `Element`. However, we are still missing rich comparison support for Python classes which are not subclasses from `Element`.

A good example of this is `RealSet` in `src/sage/sets/real_set.py`. Currently, comparison is implemented using `__cmp__`. Changing this to Python 3 comparisons would normally require 6 methods (`__eq__`, `__ne__`, `__lt__`, `__le__`, `__gt__`, `__ge__`). It would be convenient to support this with just one `__richcmp__` method like in Cython.

This ticket proposes:

1. Add a decorator `richcmp_method` which adds support for `__richcmp__` to a Python class.

2. Implement `RealSet.__richcmp__` using this.

CC:  @fchapoton @tscrim @embray

Branch/Commit: 4d1021b1e2ccd1e811549aeb1e451b9a08cc6251

Reviewer: Travis Scrimshaw, Erik Bray

Author: Jeroen Demeyer

Dependencies: #23103

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23102





---

archive/issue_comments_433069.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Sage has a lot of functionality to deal with \"rich comparisons\" using `__richcmp__` in Cython or `_richcmp_` in Python/Cython for subclasses of `Element`. However, we are still missing rich comparison support for Python classes which are not subclasses from `Element`.\n+Sage has a lot of functionality to deal with \"rich comparisons\" using `__richcmp__` in Cython or `_richcmp_` in Python or Cython for subclasses of `Element`. However, we are still missing rich comparison support for Python classes which are not subclasses from `Element`.\n \n A good example of this is `RealSet` in `src/sage/sets/real_set.py`. Currently, comparison is implement using `__cmp__`. Changing this to Python 3 comparisons would normally require 6 methods (`__eq__`, `__ne__`, `__lt__`, `__le__`, `__gt__`, `__ge__`). It would be convenient to support this with just one `__richcmp__` method like in Cython.\n \n``````\n",
    "created_at": "2017-05-30T08:25:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433069",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Sage has a lot of functionality to deal with "rich comparisons" using `__richcmp__` in Cython or `_richcmp_` in Python/Cython for subclasses of `Element`. However, we are still missing rich comparison support for Python classes which are not subclasses from `Element`.
+Sage has a lot of functionality to deal with "rich comparisons" using `__richcmp__` in Cython or `_richcmp_` in Python or Cython for subclasses of `Element`. However, we are still missing rich comparison support for Python classes which are not subclasses from `Element`.
 
 A good example of this is `RealSet` in `src/sage/sets/real_set.py`. Currently, comparison is implement using `__cmp__`. Changing this to Python 3 comparisons would normally require 6 methods (`__eq__`, `__ne__`, `__lt__`, `__le__`, `__gt__`, `__ge__`). It would be convenient to support this with just one `__richcmp__` method like in Cython.
 
``````




---

archive/issue_comments_433070.json:
```json
{
    "body": "<a id='comment:2'></a>What about using ``@`total_ordering` to reduce the number of rich comparison methods? I know this is an abuse of terminology, but it does mean we only need to define `__eq__` and `__lt__`. However, I generally do like the idea of having a consistent API.",
    "created_at": "2017-05-30T14:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433070",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>What about using ``@`total_ordering` to reduce the number of rich comparison methods? I know this is an abuse of terminology, but it does mean we only need to define `__eq__` and `__lt__`. However, I generally do like the idea of having a consistent API.



---

archive/issue_comments_433071.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/ticket/23102\"",
    "created_at": "2017-05-30T14:57:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433071",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/ticket/23102"



---

archive/issue_comments_433072.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:2 tscrim]:\n> What about using ``@`total_ordering` to reduce the number of rich comparison methods?\n\n\n1. ``@`total_ordering` reduces the number of rich comparison methods from 6 to 2. This ticket reduces it from 6 to 1.\n\n2. ``@`total_ordering` is less efficient (if you only have `==` and `<`, you might need two calls to determine `<=`)\n  \n---\nNew commits:",
    "created_at": "2017-05-30T15:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433072",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>Replying to [comment:2 tscrim]:
> What about using ``@`total_ordering` to reduce the number of rich comparison methods?


1. ``@`total_ordering` reduces the number of rich comparison methods from 6 to 2. This ticket reduces it from 6 to 1.

2. ``@`total_ordering` is less efficient (if you only have `==` and `<`, you might need two calls to determine `<=`)
  
---
New commits:



---

archive/issue_comments_433073.json:
```json
{
    "body": "Changing commit from \"\" to \"47f97ec88f373697faafeb84579becb064213dc1\"",
    "created_at": "2017-05-30T15:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433073",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "47f97ec88f373697faafeb84579becb064213dc1"



---

archive/issue_comments_433074.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-05-30T15:01:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433074",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_433075.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#23103\"",
    "created_at": "2017-05-30T15:01:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433075",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#23103"



---

archive/issue_comments_433076.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Sage has a lot of functionality to deal with \"rich comparisons\" using `__richcmp__` in Cython or `_richcmp_` in Python or Cython for subclasses of `Element`. However, we are still missing rich comparison support for Python classes which are not subclasses from `Element`.\n \n-A good example of this is `RealSet` in `src/sage/sets/real_set.py`. Currently, comparison is implement using `__cmp__`. Changing this to Python 3 comparisons would normally require 6 methods (`__eq__`, `__ne__`, `__lt__`, `__le__`, `__gt__`, `__ge__`). It would be convenient to support this with just one `__richcmp__` method like in Cython.\n+A good example of this is `RealSet` in `src/sage/sets/real_set.py`. Currently, comparison is implemented using `__cmp__`. Changing this to Python 3 comparisons would normally require 6 methods (`__eq__`, `__ne__`, `__lt__`, `__le__`, `__gt__`, `__ge__`). It would be convenient to support this with just one `__richcmp__` method like in Cython.\n \n This ticket proposes:\n \n``````\n",
    "created_at": "2017-05-30T15:19:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433076",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Sage has a lot of functionality to deal with "rich comparisons" using `__richcmp__` in Cython or `_richcmp_` in Python or Cython for subclasses of `Element`. However, we are still missing rich comparison support for Python classes which are not subclasses from `Element`.
 
-A good example of this is `RealSet` in `src/sage/sets/real_set.py`. Currently, comparison is implement using `__cmp__`. Changing this to Python 3 comparisons would normally require 6 methods (`__eq__`, `__ne__`, `__lt__`, `__le__`, `__gt__`, `__ge__`). It would be convenient to support this with just one `__richcmp__` method like in Cython.
+A good example of this is `RealSet` in `src/sage/sets/real_set.py`. Currently, comparison is implemented using `__cmp__`. Changing this to Python 3 comparisons would normally require 6 methods (`__eq__`, `__ne__`, `__lt__`, `__le__`, `__gt__`, `__ge__`). It would be convenient to support this with just one `__richcmp__` method like in Cython.
 
 This ticket proposes:
 
``````




---

archive/issue_comments_433077.json:
```json
{
    "body": "<a id='comment:8'></a>Note that from #22828, there is\n\n```\ndef richcmp_by_eq_and_lt(left, right, op):\n```\nin\n\n```\nsrc/sage/rings/asymptotic/misc.py\n```\nthat should also be moved to the common new place.",
    "created_at": "2017-05-31T06:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433077",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>Note that from #22828, there is

```
def richcmp_by_eq_and_lt(left, right, op):
```
in

```
src/sage/rings/asymptotic/misc.py
```
that should also be moved to the common new place.



---

archive/issue_comments_433078.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 chapoton]:\n> Note that from #22828, there is\n> \n> ```\n> def richcmp_by_eq_and_lt(left, right, op):\n> ```\n> in\n> \n> ```\n> src/sage/rings/asymptotic/misc.py\n> ```\n> that should also be moved to the common new place.\n\n\nMakes sense. I created #23109 for that.",
    "created_at": "2017-05-31T07:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433078",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>Replying to [comment:8 chapoton]:
> Note that from #22828, there is
> 
> ```
> def richcmp_by_eq_and_lt(left, right, op):
> ```
> in
> 
> ```
> src/sage/rings/asymptotic/misc.py
> ```
> that should also be moved to the common new place.


Makes sense. I created #23109 for that.



---

archive/issue_comments_433079.json:
```json
{
    "body": "<a id='comment:10'></a>Typo in `richcmp_method`: `mtehod`. Have you run some timings to compare how this works versus direct implementation versus ``@`total_ordering` in Python classes? I can do this, but not for 2-3 days because I will be traveling.",
    "created_at": "2017-06-01T05:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433079",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>Typo in `richcmp_method`: `mtehod`. Have you run some timings to compare how this works versus direct implementation versus ``@`total_ordering` in Python classes? I can do this, but not for 2-3 days because I will be traveling.



---

archive/issue_comments_433080.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 tscrim]:\n> Have you run some timings to compare how this works versus direct implementation versus ``@`total_ordering` in Python classes? I can do this, but not for 2-3 days because I will be traveling.\n\n\nI just did that, see [attachment:cmp-timing.py]\n\nFirst of all, for a plain equality check (``@`total_ordering` is not involved in this), the timing is almost the same for `__eq__` and `__richcmp__`, the latter being just slightly slower:\n\n```\nsage: load(\"cmp-timing.py\")\nsage: timeit('A1 == A2', number=1000000, repeat=100)\n1000000 loops, best of 100: 281 ns per loop\nsage: timeit('B1 == B2', number=1000000, repeat=100)\n1000000 loops, best of 100: 293 ns per loop\n```\n\nNow, comparisons involving ``@`total_ordering` take almost twice or three times as much time:\n\n```\nsage: load(\"cmp-timing.py\")\nsage: timeit('A1 > A2', number=1000000, repeat=20)   # calls A2.__lt__(A1)\n1000000 loops, best of 20: 557 ns per loop\nsage: timeit('B1 > B2', number=1000000, repeat=20)\n1000000 loops, best of 20: 292 ns per loop\n```\n\n```\nsage: load(\"cmp-timing.py\")\nsage: timeit('A2 <= A1', number=1000000, repeat=20)  # Calls A2.__lt__(A1) and A2.__eq__(A1)\n1000000 loops, best of 20: 820 ns per loop\nsage: timeit('B2 <= B1', number=1000000, repeat=20)\n1000000 loops, best of 20: 293 ns per loop\n```\nAs one might expect, the time is roughly linear in the number of Python method calls.",
    "created_at": "2017-06-01T08:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433080",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>Replying to [comment:10 tscrim]:
> Have you run some timings to compare how this works versus direct implementation versus ``@`total_ordering` in Python classes? I can do this, but not for 2-3 days because I will be traveling.


I just did that, see [attachment:cmp-timing.py]

First of all, for a plain equality check (``@`total_ordering` is not involved in this), the timing is almost the same for `__eq__` and `__richcmp__`, the latter being just slightly slower:

```
sage: load("cmp-timing.py")
sage: timeit('A1 == A2', number=1000000, repeat=100)
1000000 loops, best of 100: 281 ns per loop
sage: timeit('B1 == B2', number=1000000, repeat=100)
1000000 loops, best of 100: 293 ns per loop
```

Now, comparisons involving ``@`total_ordering` take almost twice or three times as much time:

```
sage: load("cmp-timing.py")
sage: timeit('A1 > A2', number=1000000, repeat=20)   # calls A2.__lt__(A1)
1000000 loops, best of 20: 557 ns per loop
sage: timeit('B1 > B2', number=1000000, repeat=20)
1000000 loops, best of 20: 292 ns per loop
```

```
sage: load("cmp-timing.py")
sage: timeit('A2 <= A1', number=1000000, repeat=20)  # Calls A2.__lt__(A1) and A2.__eq__(A1)
1000000 loops, best of 20: 820 ns per loop
sage: timeit('B2 <= B1', number=1000000, repeat=20)
1000000 loops, best of 20: 293 ns per loop
```
As one might expect, the time is roughly linear in the number of Python method calls.



---

archive/issue_comments_433081.json:
```json
{
    "body": "Attachment [cmp-timing.py](tarball://root/attachments/some-uuid/ticket23102/cmp-timing.py) by @jdemeyer created at 2017-06-01 08:23:13\n\nSmall script to test timing",
    "created_at": "2017-06-01T08:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433081",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [cmp-timing.py](tarball://root/attachments/some-uuid/ticket23102/cmp-timing.py) by @jdemeyer created at 2017-06-01 08:23:13

Small script to test timing



---

archive/issue_comments_433082.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2017-06-01T08:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433082",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Travis Scrimshaw"



---

archive/issue_comments_433083.json:
```json
{
    "body": "<a id='comment:12'></a>Thank you for running those timings. That is more than enough to convince me. If tests pass, you can set a positive review on my behalf. Sleepy time for me now. :)",
    "created_at": "2017-06-01T08:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433083",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:12'></a>Thank you for running those timings. That is more than enough to convince me. If tests pass, you can set a positive review on my behalf. Sleepy time for me now. :)



---

archive/issue_comments_433084.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-01T09:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433084",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433085.json:
```json
{
    "body": "Changing commit from \"47f97ec88f373697faafeb84579becb064213dc1\" to \"acfd0aaea4de51b64c21fdd1a7a8d6e9174448de\"",
    "created_at": "2017-06-01T09:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433085",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "47f97ec88f373697faafeb84579becb064213dc1" to "acfd0aaea4de51b64c21fdd1a7a8d6e9174448de"



---

archive/issue_comments_433086.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-01T09:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433086",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_433087.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/23102\" to \"acfd0aaea4de51b64c21fdd1a7a8d6e9174448de\"",
    "created_at": "2017-06-07T20:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433087",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/ticket/23102" to "acfd0aaea4de51b64c21fdd1a7a8d6e9174448de"



---

archive/issue_events_059760.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-07T20:13:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23102#event-59760"
}
```



---

archive/issue_comments_433088.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-07T20:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433088",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_433089.json:
```json
{
    "body": "Changing commit from \"acfd0aaea4de51b64c21fdd1a7a8d6e9174448de\" to \"\"",
    "created_at": "2017-06-09T18:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433089",
    "user": "https://github.com/vbraun"
}
```

Changing commit from "acfd0aaea4de51b64c21fdd1a7a8d6e9174448de" to ""



---

archive/issue_comments_433090.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2017-06-09T18:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433090",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_433091.json:
```json
{
    "body": "<a id='comment:16'></a>This happened randomly:\n\n```\nsage -t --long src/sage/sets/real_set.py\n**********************************************************************\nFile \"src/sage/sets/real_set.py\", line 701, in sage.sets.real_set.RealSet.__richcmp__\nFailed example:\n    cmp(I1, I2)\nExpected:\n    1\nGot:\n    -1\n**********************************************************************\nFile \"src/sage/sets/real_set.py\", line 703, in sage.sets.real_set.RealSet.__richcmp__\nFailed example:\n    sorted([I1, I2])\nExpected:\n    [(0, 5], (1, 3]]\nGot:\n    [(1, 3], (0, 5]]\n**********************************************************************\n1 item had failures:\n   2 of   6 in sage.sets.real_set.RealSet.__richcmp__\n    [203 tests, 2 failures, 0.55 s]\n```",
    "created_at": "2017-06-09T18:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433091",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'></a>This happened randomly:

```
sage -t --long src/sage/sets/real_set.py
**********************************************************************
File "src/sage/sets/real_set.py", line 701, in sage.sets.real_set.RealSet.__richcmp__
Failed example:
    cmp(I1, I2)
Expected:
    1
Got:
    -1
**********************************************************************
File "src/sage/sets/real_set.py", line 703, in sage.sets.real_set.RealSet.__richcmp__
Failed example:
    sorted([I1, I2])
Expected:
    [(0, 5], (1, 3]]
Got:
    [(1, 3], (0, 5]]
**********************************************************************
1 item had failures:
   2 of   6 in sage.sets.real_set.RealSet.__richcmp__
    [203 tests, 2 failures, 0.55 s]
```



---

archive/issue_comments_433092.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2017-06-09T18:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433092",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_events_059761.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-09T18:37:06Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23102#event-59761"
}
```



---

archive/issue_comments_433093.json:
```json
{
    "body": "<a id='comment:17'></a>Confirmed. It seems that the category framework gets in the way. Commenting out this line fixes the problem\n\n```\nParent.__init__(self, category = Sets())\n```",
    "created_at": "2017-06-12T13:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433093",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>Confirmed. It seems that the category framework gets in the way. Commenting out this line fixes the problem

```
Parent.__init__(self, category = Sets())
```



---

archive/issue_comments_433094.json:
```json
{
    "body": "<a id='comment:18'></a>I really would not want to go backwards in category initalization for parents. Although the category methods should not be interfering. I don't see how they would cause problems...",
    "created_at": "2017-06-12T13:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433094",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>I really would not want to go backwards in category initalization for parents. Although the category methods should not be interfering. I don't see how they would cause problems...



---

archive/issue_comments_433095.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:18 tscrim]:\n> I really would not want to go backwards in category initalization for parents.\n\n\nSorry, I didn't say that we should remove that line. Just that removing that line fixes this specific problem that `__richcmp__` doesn't work.",
    "created_at": "2017-06-12T13:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433095",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>Replying to [comment:18 tscrim]:
> I really would not want to go backwards in category initalization for parents.


Sorry, I didn't say that we should remove that line. Just that removing that line fixes this specific problem that `__richcmp__` doesn't work.



---

archive/issue_comments_433096.json:
```json
{
    "body": "<a id='comment:20'></a>OK, the real problem is that the `richcmp_method` decorator doesn't work with subclassing. It only works on the class where it is defined, not on subclasses. Given that the category framework creates a `RealSet_with_category` subclass, this breaks.",
    "created_at": "2017-06-12T13:46:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433096",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>OK, the real problem is that the `richcmp_method` decorator doesn't work with subclassing. It only works on the class where it is defined, not on subclasses. Given that the category framework creates a `RealSet_with_category` subclass, this breaks.



---

archive/issue_comments_433097.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:19 jdemeyer]:\n> Replying to [comment:18 tscrim]:\n> > I really would not want to go backwards in category initalization for parents.\n\n> \n> Sorry, I didn't say that we should remove that line. Just that removing that line fixes this specific problem that `__richcmp__` doesn't work.\n\n\nI didn't mean to imply you were. I just wanted to make it clear that we didn't want to do this in case someone else came along and saw this.",
    "created_at": "2017-06-12T13:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433097",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:21'></a>Replying to [comment:19 jdemeyer]:
> Replying to [comment:18 tscrim]:
> > I really would not want to go backwards in category initalization for parents.

> 
> Sorry, I didn't say that we should remove that line. Just that removing that line fixes this specific problem that `__richcmp__` doesn't work.


I didn't mean to imply you were. I just wanted to make it clear that we didn't want to do this in case someone else came along and saw this.



---

archive/issue_comments_433098.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:20 jdemeyer]:\n> OK, the real problem is that the `richcmp_method` decorator doesn't work with subclassing. It only works on the class where it is defined, not on subclasses. Given that the category framework creates a `RealSet_with_category` subclass, this breaks.\n\n\nPerhaps the way to go would be to bind `__eq__` and friends to a particular class that compare with the `__richcmp__`?",
    "created_at": "2017-06-12T14:07:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433098",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:22'></a>Replying to [comment:20 jdemeyer]:
> OK, the real problem is that the `richcmp_method` decorator doesn't work with subclassing. It only works on the class where it is defined, not on subclasses. Given that the category framework creates a `RealSet_with_category` subclass, this breaks.


Perhaps the way to go would be to bind `__eq__` and friends to a particular class that compare with the `__richcmp__`?



---

archive/issue_comments_433099.json:
```json
{
    "body": "<a id='comment:23'></a>OK, I think the problem is that my trick doesn't add slot wrappers (attributes like `__eq__` on the class). I'll try to add those wrappers and see if that works.",
    "created_at": "2017-06-12T15:10:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433099",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>OK, I think the problem is that my trick doesn't add slot wrappers (attributes like `__eq__` on the class). I'll try to add those wrappers and see if that works.



---

archive/issue_comments_433100.json:
```json
{
    "body": "Changing branch from \"acfd0aaea4de51b64c21fdd1a7a8d6e9174448de\" to \"u/jdemeyer/acfd0aaea4de51b64c21fdd1a7a8d6e9174448de\"",
    "created_at": "2017-06-14T08:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433100",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "acfd0aaea4de51b64c21fdd1a7a8d6e9174448de" to "u/jdemeyer/acfd0aaea4de51b64c21fdd1a7a8d6e9174448de"



---

archive/issue_comments_433101.json:
```json
{
    "body": "<a id='comment:25'></a>New commits:",
    "created_at": "2017-06-14T08:33:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433101",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>New commits:



---

archive/issue_comments_433102.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-14T08:33:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433102",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_433103.json:
```json
{
    "body": "Changing commit from \"\" to \"f52d5c341e965716f799530424cf242c6a5547c2\"",
    "created_at": "2017-06-14T08:33:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433103",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "f52d5c341e965716f799530424cf242c6a5547c2"



---

archive/issue_comments_433104.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-14T12:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433104",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_433105.json:
```json
{
    "body": "<a id='comment:26'></a>If I understand correctly what is going on, then yes, this should work in general. So I'm going to set it to a positive review since it works AFAIK.\n\nErik, I'm cc-ing you in case you know something about the inner workings of Python and can confirm the code looks proper. If you don't, then no need to respond.",
    "created_at": "2017-06-14T12:18:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433105",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:26'></a>If I understand correctly what is going on, then yes, this should work in general. So I'm going to set it to a positive review since it works AFAIK.

Erik, I'm cc-ing you in case you know something about the inner workings of Python and can confirm the code looks proper. If you don't, then no need to respond.



---

archive/issue_comments_433106.json:
```json
{
    "body": "<a id='comment:27'></a>Of course, none of this slot stuff is documented anywhere in the Python docs... the only way to figure it out is to read the Python source code.",
    "created_at": "2017-06-14T12:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433106",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>Of course, none of this slot stuff is documented anywhere in the Python docs... the only way to figure it out is to read the Python source code.



---

archive/issue_comments_433107.json:
```json
{
    "body": "<a id='comment:28'></a>Why\n\n```\nif type(slotwrapper).__name__ != 'wrapper_descriptor':\n```\n\nand not explicitly something like\n\n```\nif type(slotwrapper) != PyWrapperDescr_Type:\n```\n?",
    "created_at": "2017-06-15T08:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433107",
    "user": "https://github.com/embray"
}
```

<a id='comment:28'></a>Why

```
if type(slotwrapper).__name__ != 'wrapper_descriptor':
```

and not explicitly something like

```
if type(slotwrapper) != PyWrapperDescr_Type:
```
?



---

archive/issue_comments_433108.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2017-06-15T08:44:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433108",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_433109.json:
```json
{
    "body": "<a id='comment:29'></a>One other minor concern:  If a class has both `__richcmp__` and, say, `__lt__`, this will just silently override the `__lt__`.  For consistency with Cython, I'd say having both should be an outright error (with Cython it will just raise a compiler error if you try to define `__lt__` in a `cdef` class).  So maybe it should raise a `RuntimeError` if a class tries to define both.\n\nBut that also raises the question of what to do with subclasses.  If you subclass a class with `__richcmp__` and add an `__lt__` in the subclass, the subclass's `__lt__` should take over.  I *think* that's what will happen anyways.\n\nBut what if you subclass a class that has `__lt__` and add `__richcmp__` in the subclass?",
    "created_at": "2017-06-15T09:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433109",
    "user": "https://github.com/embray"
}
```

<a id='comment:29'></a>One other minor concern:  If a class has both `__richcmp__` and, say, `__lt__`, this will just silently override the `__lt__`.  For consistency with Cython, I'd say having both should be an outright error (with Cython it will just raise a compiler error if you try to define `__lt__` in a `cdef` class).  So maybe it should raise a `RuntimeError` if a class tries to define both.

But that also raises the question of what to do with subclasses.  If you subclass a class with `__richcmp__` and add an `__lt__` in the subclass, the subclass's `__lt__` should take over.  I *think* that's what will happen anyways.

But what if you subclass a class that has `__lt__` and add `__richcmp__` in the subclass?



---

archive/issue_comments_433110.json:
```json
{
    "body": "<a id='comment:30'></a>> But what if you subclass a class that has `__lt__` and add `__richcmp__` in the subclass?\n\n\nTo answer my own question, this wouldn't be a concern I guess since this will just override the parent class's `__lt__` and that's to be expected.\n\nIt would be good to have a test of subclassing and overriding one of the comparison operators though.",
    "created_at": "2017-06-15T09:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433110",
    "user": "https://github.com/embray"
}
```

<a id='comment:30'></a>> But what if you subclass a class that has `__lt__` and add `__richcmp__` in the subclass?


To answer my own question, this wouldn't be a concern I guess since this will just override the parent class's `__lt__` and that's to be expected.

It would be good to have a test of subclassing and overriding one of the comparison operators though.



---

archive/issue_comments_433111.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-15T16:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433111",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_433112.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/acfd0aaea4de51b64c21fdd1a7a8d6e9174448de\" to \"f52d5c341e965716f799530424cf242c6a5547c2\"",
    "created_at": "2017-06-15T16:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433112",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/acfd0aaea4de51b64c21fdd1a7a8d6e9174448de" to "f52d5c341e965716f799530424cf242c6a5547c2"



---

archive/issue_events_059762.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-15T16:45:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23102#event-59762"
}
```



---

archive/issue_comments_433113.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2017-06-15T16:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433113",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_433114.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2017-06-15T16:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433114",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_events_059763.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-15T16:52:30Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23102#event-59763"
}
```



---

archive/issue_comments_433115.json:
```json
{
    "body": "<a id='comment:32'></a>ready to merge == positive review != let somebody else look at it first, Travis",
    "created_at": "2017-06-15T16:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433115",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:32'></a>ready to merge == positive review != let somebody else look at it first, Travis



---

archive/issue_comments_433116.json:
```json
{
    "body": "Changing commit from \"f52d5c341e965716f799530424cf242c6a5547c2\" to \"\"",
    "created_at": "2017-06-15T16:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433116",
    "user": "https://github.com/vbraun"
}
```

Changing commit from "f52d5c341e965716f799530424cf242c6a5547c2" to ""



---

archive/issue_comments_433117.json:
```json
{
    "body": "<a id='comment:33'></a>So, is it merged or not? I think Erik's comments make sense, but they could easily be addressed in a follow-up ticket.",
    "created_at": "2017-06-15T19:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433117",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>So, is it merged or not? I think Erik's comments make sense, but they could easily be addressed in a follow-up ticket.



---

archive/issue_comments_433118.json:
```json
{
    "body": "<a id='comment:34'></a>Not merged",
    "created_at": "2017-06-15T22:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433118",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'></a>Not merged



---

archive/issue_comments_433119.json:
```json
{
    "body": "<a id='comment:35'></a>They could definitely be addressed in a followup ticket (if indeed my comments need addressing at all).",
    "created_at": "2017-06-16T08:07:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433119",
    "user": "https://github.com/embray"
}
```

<a id='comment:35'></a>They could definitely be addressed in a followup ticket (if indeed my comments need addressing at all).



---

archive/issue_comments_433120.json:
```json
{
    "body": "<a id='comment:36'></a>As an aside, I wonder if there's ever been a proposal to actually support `__richcmp__` in user-defined classes (in a manner similar to this, such that it would automatically implment the individual comparison methods).  And if it has been proposed I wonder why it was rejected.  I'm going to search around a bit for answers...",
    "created_at": "2017-06-16T08:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433120",
    "user": "https://github.com/embray"
}
```

<a id='comment:36'></a>As an aside, I wonder if there's ever been a proposal to actually support `__richcmp__` in user-defined classes (in a manner similar to this, such that it would automatically implment the individual comparison methods).  And if it has been proposed I wonder why it was rejected.  I'm going to search around a bit for answers...



---

archive/issue_comments_433121.json:
```json
{
    "body": "<a id='comment:37'></a>A close reading of PEP-207 reveals:\n\n> The choice of six special methods was made over a single (e.g. `__richcmp__`) method to allow the dispatching on the opcode to be performed at the level of the C implementation rather than the user-defined method.\n\n\nwhich makes perfect sense. But, if as Sage demonstrates, there's a usecase for a single user-defined `__richcmp__` I don't see why it shouldn't be an option...",
    "created_at": "2017-06-16T08:23:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433121",
    "user": "https://github.com/embray"
}
```

<a id='comment:37'></a>A close reading of PEP-207 reveals:

> The choice of six special methods was made over a single (e.g. `__richcmp__`) method to allow the dispatching on the opcode to be performed at the level of the C implementation rather than the user-defined method.


which makes perfect sense. But, if as Sage demonstrates, there's a usecase for a single user-defined `__richcmp__` I don't see why it shouldn't be an option...



---

archive/issue_comments_433122.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2017-06-16T13:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433122",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_433123.json:
```json
{
    "body": "<a id='comment:38'></a>As Jeroen and Erik said, I felt it could be merged into Sage and further changes could be handled on followup tickets.\n\n---\nNew commits:",
    "created_at": "2017-06-16T13:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433123",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:38'></a>As Jeroen and Erik said, I felt it could be merged into Sage and further changes could be handled on followup tickets.

---
New commits:



---

archive/issue_comments_433124.json:
```json
{
    "body": "Changing commit from \"\" to \"acfd0aaea4de51b64c21fdd1a7a8d6e9174448de\"",
    "created_at": "2017-06-16T13:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433124",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "acfd0aaea4de51b64c21fdd1a7a8d6e9174448de"



---

archive/issue_comments_433125.json:
```json
{
    "body": "Changing branch from \"f52d5c341e965716f799530424cf242c6a5547c2\" to \"u/jdemeyer/ticket/23102\"",
    "created_at": "2017-06-16T13:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433125",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "f52d5c341e965716f799530424cf242c6a5547c2" to "u/jdemeyer/ticket/23102"



---

archive/issue_comments_433126.json:
```json
{
    "body": "<a id='comment:39'></a>I'll work on it right now.",
    "created_at": "2017-06-16T13:29:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433126",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'></a>I'll work on it right now.



---

archive/issue_comments_433127.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-06-16T13:31:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433127",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_433128.json:
```json
{
    "body": "Changing commit from \"acfd0aaea4de51b64c21fdd1a7a8d6e9174448de\" to \"86e9fcf87e6d8fea38a73edc3ea6830f6fc17657\"",
    "created_at": "2017-06-16T13:31:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433128",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "acfd0aaea4de51b64c21fdd1a7a8d6e9174448de" to "86e9fcf87e6d8fea38a73edc3ea6830f6fc17657"



---

archive/issue_comments_433129.json:
```json
{
    "body": "<a id='comment:41'></a>Travis: you put back the wrong branch. This is the original branch, rebased to 8.0.beta11.",
    "created_at": "2017-06-16T13:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433129",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>Travis: you put back the wrong branch. This is the original branch, rebased to 8.0.beta11.



---

archive/issue_comments_433130.json:
```json
{
    "body": "<a id='comment:42'></a>Ah, sorry; I had thought `u/jdemeyer/acfd0aaea4de51b64c21fdd1a7a8d6e9174448de` was just a trac formatting error.",
    "created_at": "2017-06-16T13:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433130",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:42'></a>Ah, sorry; I had thought `u/jdemeyer/acfd0aaea4de51b64c21fdd1a7a8d6e9174448de` was just a trac formatting error.



---

archive/issue_comments_433131.json:
```json
{
    "body": "<a id='comment:43'></a>Replying to [comment:28 embray]:\n> {{{\n> if type(slotwrapper) != PyWrapperDescr_Type:\n> }}}\n\n\nGood point. It didn't occur to me to use the C/API for this. Python doesn't expose this type anywhere AFAIK, but the C/API does.",
    "created_at": "2017-06-16T14:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433131",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:43'></a>Replying to [comment:28 embray]:
> {{{
> if type(slotwrapper) != PyWrapperDescr_Type:
> }}}


Good point. It didn't occur to me to use the C/API for this. Python doesn't expose this type anywhere AFAIK, but the C/API does.



---

archive/issue_comments_433132.json:
```json
{
    "body": "<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-16T15:03:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433132",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_433133.json:
```json
{
    "body": "Changing commit from \"86e9fcf87e6d8fea38a73edc3ea6830f6fc17657\" to \"4d1021b1e2ccd1e811549aeb1e451b9a08cc6251\"",
    "created_at": "2017-06-16T15:03:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433133",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "86e9fcf87e6d8fea38a73edc3ea6830f6fc17657" to "4d1021b1e2ccd1e811549aeb1e451b9a08cc6251"



---

archive/issue_comments_433134.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2017-06-16T15:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433134",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_433135.json:
```json
{
    "body": "<a id='comment:45'></a>I think this addresses all Erik's concerns.",
    "created_at": "2017-06-16T15:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433135",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>I think this addresses all Erik's concerns.



---

archive/issue_comments_433136.json:
```json
{
    "body": "Changing reviewer from \"Travis Scrimshaw\" to \"Travis Scrimshaw, Erik Bray\"",
    "created_at": "2017-06-16T15:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433136",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Travis Scrimshaw" to "Travis Scrimshaw, Erik Bray"



---

archive/issue_comments_433137.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:43 jdemeyer]:\n> Replying to [comment:28 embray]:\n> > {{{\n> > if type(slotwrapper) != PyWrapperDescr_Type:\n> > }}}\n\n> \n> Good point. It didn't occur to me to use the C/API for this. Python doesn't expose this type anywhere AFAIK, but the C/API does.\n\n\nYou can get at it in Python, for example, with `type(bytes.__lt__)`, but in Cython you might as well just use the type directly since it's exposed by the C API.",
    "created_at": "2017-06-16T15:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433137",
    "user": "https://github.com/embray"
}
```

<a id='comment:46'></a>Replying to [comment:43 jdemeyer]:
> Replying to [comment:28 embray]:
> > {{{
> > if type(slotwrapper) != PyWrapperDescr_Type:
> > }}}

> 
> Good point. It didn't occur to me to use the C/API for this. Python doesn't expose this type anywhere AFAIK, but the C/API does.


You can get at it in Python, for example, with `type(bytes.__lt__)`, but in Cython you might as well just use the type directly since it's exposed by the C API.



---

archive/issue_comments_433138.json:
```json
{
    "body": "<a id='comment:47'></a>is this ready to go ?",
    "created_at": "2017-06-19T17:14:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433138",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:47'></a>is this ready to go ?



---

archive/issue_comments_433139.json:
```json
{
    "body": "<a id='comment:48'></a>Erik?",
    "created_at": "2017-06-20T08:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433139",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:48'></a>Erik?



---

archive/issue_comments_433140.json:
```json
{
    "body": "<a id='comment:49'></a>Yep, perfect--thanks.",
    "created_at": "2017-06-20T08:21:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433140",
    "user": "https://github.com/embray"
}
```

<a id='comment:49'></a>Yep, perfect--thanks.



---

archive/issue_comments_433141.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-20T08:21:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433141",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_433142.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/23102\" to \"4d1021b1e2ccd1e811549aeb1e451b9a08cc6251\"",
    "created_at": "2017-06-22T07:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433142",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/ticket/23102" to "4d1021b1e2ccd1e811549aeb1e451b9a08cc6251"



---

archive/issue_events_059764.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-22T07:24:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23102#event-59764"
}
```



---

archive/issue_comments_433143.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-22T07:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23102",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23102#issuecomment-433143",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
