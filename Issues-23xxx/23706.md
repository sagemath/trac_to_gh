# Issue 23706: allow several implementations of matrices in MatrixSpace

archive/issues_023469.json:
```json
{
    "body": "CC:  @jplab simonking\n\nKeywords: days88\n\nThe aim of this ticket is to revamp the `MatrixSpace` constructor in order to be able to choose the implementation.\n\nFor example, with the attached branch one can have access to 2 implementations of integer matrices\n\n```\nsage: MatrixSpace(ZZ, 3, implementation='flint')\nFull MatrixSpace of 3 by 3 dense matrices over Integer Ring\nsage: MatrixSpace(ZZ, 3, implementation='generic')\nFull MatrixSpace of 3 by 3 dense matrices over Integer Ring (using Matrix_generic_dense)\n```\n\nOne important change is the move of the method `_get_matrix_class` of `MatrixSpace` as an independent function.\n\nA problem arose with `CartanMatrix` (in `sage/combinat/root_system/cartan_matrix.py`). The class `CartanMatrix` inherits from `Matrix_integer_sparse` but does not properly redefines the parent. As a consequence of the changes here, many matrix operations are not valid anymore for inherited types (mostly submatrices operations such as `__getitem__` with slices or `stack`). A fix is provided by defining `CartanMatrix.matrix_space`.\n\nfollow up: #23714 (implementation of gap matrices)\n\nIssue created by migration from https://trac.sagemath.org/ticket/23706\n\n",
    "closed_at": "2017-12-18T19:39:30Z",
    "created_at": "2017-08-25T00:05:44Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "allow several implementations of matrices in MatrixSpace",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23706",
    "user": "https://github.com/videlec"
}
```
CC:  @jplab simonking

Keywords: days88

The aim of this ticket is to revamp the `MatrixSpace` constructor in order to be able to choose the implementation.

For example, with the attached branch one can have access to 2 implementations of integer matrices

```
sage: MatrixSpace(ZZ, 3, implementation='flint')
Full MatrixSpace of 3 by 3 dense matrices over Integer Ring
sage: MatrixSpace(ZZ, 3, implementation='generic')
Full MatrixSpace of 3 by 3 dense matrices over Integer Ring (using Matrix_generic_dense)
```

One important change is the move of the method `_get_matrix_class` of `MatrixSpace` as an independent function.

A problem arose with `CartanMatrix` (in `sage/combinat/root_system/cartan_matrix.py`). The class `CartanMatrix` inherits from `Matrix_integer_sparse` but does not properly redefines the parent. As a consequence of the changes here, many matrix operations are not valid anymore for inherited types (mostly submatrices operations such as `__getitem__` with slices or `stack`). A fix is provided by defining `CartanMatrix.matrix_space`.

follow up: #23714 (implementation of gap matrices)

Issue created by migration from https://trac.sagemath.org/ticket/23706





---

archive/issue_comments_328397.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd88\".",
    "created_at": "2017-08-25T00:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328397",
    "user": "https://github.com/videlec"
}
```

Changing keywords from "" to "sd88".



---

archive/issue_comments_328398.json:
```json
{
    "body": "Changing keywords from \"sd88\" to \"days88\".",
    "created_at": "2017-08-25T02:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328398",
    "user": "https://github.com/jplab"
}
```

Changing keywords from "sd88" to "days88".



---

archive/issue_comments_328399.json:
```json
{
    "body": "experimental branch ready!\n\n---\nNew commits:",
    "created_at": "2017-08-25T02:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328399",
    "user": "https://github.com/videlec"
}
```

experimental branch ready!

---
New commits:



---

archive/issue_comments_328400.json:
```json
{
    "body": "The title of the ticket could be a bit more specific.",
    "created_at": "2017-08-25T02:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328400",
    "user": "https://github.com/jplab"
}
```

The title of the ticket could be a bit more specific.



---

archive/issue_comments_328401.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-08-25T02:49:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328401",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328402.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-25T03:49:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328402",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328403.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-25T03:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328403",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328404.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-25T04:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328404",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328405.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-25T04:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328406.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-08-25T21:13:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328406",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328407.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-25T21:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328407",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_328408.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-25T21:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328408",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328409.json:
```json
{
    "body": "hum... got a lot of failures\n\n```\ncombinat/root_system/root_lattice_realizations.py  # 1 doctest failed\ncombinat/root_system/root_system.py  # 1 doctest failed\ncombinat/root_system/weight_space.py  # 3 doctests failed\ncombinat/root_system/type_affine.py  # 3 doctests failed\ncombinat/root_system/ambient_space.py  # 1 doctest failed\ncombinat/root_system/root_space.py  # 1 doctest failed\ncombinat/root_system/cartan_type.py  # 2 doctests failed\ncategories/crystals.py  # 2 doctests failed\ncombinat/root_system/weight_lattice_realizations.py  # 12 doctests failed\ncombinat/root_system/cartan_matrix.py  # 5 doctests failed\ncombinat/root_system/type_relabel.py  # 1 doctest failed\ncombinat/root_system/dynkin_diagram.py  # 4 doctests failed\ncombinat/root_system/type_marked.py  # 1 doctest failed\ncombinat/root_system/type_reducible.py  # 2 doctests failed\n```",
    "created_at": "2017-08-25T21:56:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328409",
    "user": "https://github.com/videlec"
}
```

hum... got a lot of failures

```
combinat/root_system/root_lattice_realizations.py  # 1 doctest failed
combinat/root_system/root_system.py  # 1 doctest failed
combinat/root_system/weight_space.py  # 3 doctests failed
combinat/root_system/type_affine.py  # 3 doctests failed
combinat/root_system/ambient_space.py  # 1 doctest failed
combinat/root_system/root_space.py  # 1 doctest failed
combinat/root_system/cartan_type.py  # 2 doctests failed
categories/crystals.py  # 2 doctests failed
combinat/root_system/weight_lattice_realizations.py  # 12 doctests failed
combinat/root_system/cartan_matrix.py  # 5 doctests failed
combinat/root_system/type_relabel.py  # 1 doctest failed
combinat/root_system/dynkin_diagram.py  # 4 doctests failed
combinat/root_system/type_marked.py  # 1 doctest failed
combinat/root_system/type_reducible.py  # 2 doctests failed
```



---

archive/issue_comments_328410.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-08-25T22:35:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328410",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328411.json:
```json
{
    "body": "Needs to fix #23721 first.",
    "created_at": "2017-08-25T22:35:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328411",
    "user": "https://github.com/videlec"
}
```

Needs to fix #23721 first.



---

archive/issue_comments_328412.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-09-03T17:44:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328412",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328413.json:
```json
{
    "body": "I postponed the introduction of `Matrix_gap` in ticket #23714",
    "created_at": "2017-09-03T17:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328413",
    "user": "https://github.com/videlec"
}
```

I postponed the introduction of `Matrix_gap` in ticket #23714



---

archive/issue_comments_328414.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-03T17:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328414",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328415.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-03T17:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328415",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328416.json:
```json
{
    "body": "... wrong commits",
    "created_at": "2017-09-03T17:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328416",
    "user": "https://github.com/videlec"
}
```

... wrong commits



---

archive/issue_comments_328417.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-09-03T20:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328417",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328418.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-03T20:57:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328418",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328419.json:
```json
{
    "body": "JP, do you feel up for the review?",
    "created_at": "2017-09-03T21:04:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328419",
    "user": "https://github.com/videlec"
}
```

JP, do you feel up for the review?



---

archive/issue_comments_328420.json:
```json
{
    "body": "Fucking root systems\n\n```\nsage -t --long src/sage/combinat/root_system/cartan_type.py  # 2 doctests failed\nsage -t --long src/sage/combinat/root_system/weight_lattice_realizations.py  # 12 doctests failed\nsage -t --long src/sage/combinat/root_system/ambient_space.py  # 1 doctest failed\nsage -t --long src/sage/combinat/root_system/root_lattice_realizations.py  # 1 doctest failed\nsage -t --long src/sage/combinat/root_system/type_marked.py  # 1 doctest failed\nsage -t --long src/sage/combinat/root_system/type_reducible.py  # 2 doctests failed\nsage -t --long src/sage/combinat/root_system/root_space.py  # 1 doctest failed\nsage -t --long src/sage/combinat/root_system/cartan_matrix.py  # 5 doctests failed\nsage -t --long src/sage/combinat/root_system/dynkin_diagram.py  # 4 doctests failed\nsage -t --long src/sage/combinat/root_system/weight_space.py  # 3 doctests failed\nsage -t --long src/sage/combinat/root_system/type_relabel.py  # 1 doctest failed\nsage -t --long src/sage/combinat/root_system/type_affine.py  # 3 doctests failed\nsage -t --long src/sage/combinat/root_system/root_system.py  # 1 doctest failed\nsage -t --long src/sage/categories/crystals.py  # 2 doctests failed\n```",
    "created_at": "2017-09-04T04:40:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328420",
    "user": "https://github.com/videlec"
}
```

Fucking root systems

```
sage -t --long src/sage/combinat/root_system/cartan_type.py  # 2 doctests failed
sage -t --long src/sage/combinat/root_system/weight_lattice_realizations.py  # 12 doctests failed
sage -t --long src/sage/combinat/root_system/ambient_space.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/root_lattice_realizations.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/type_marked.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/type_reducible.py  # 2 doctests failed
sage -t --long src/sage/combinat/root_system/root_space.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/cartan_matrix.py  # 5 doctests failed
sage -t --long src/sage/combinat/root_system/dynkin_diagram.py  # 4 doctests failed
sage -t --long src/sage/combinat/root_system/weight_space.py  # 3 doctests failed
sage -t --long src/sage/combinat/root_system/type_relabel.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/type_affine.py  # 3 doctests failed
sage -t --long src/sage/combinat/root_system/root_system.py  # 1 doctest failed
sage -t --long src/sage/categories/crystals.py  # 2 doctests failed
```



---

archive/issue_comments_328421.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-04T05:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328421",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328422.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-09-04T05:38:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328422",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328423.json:
```json
{
    "body": "Cartan matrices are fixed... waiting for patchbot verdict again.",
    "created_at": "2017-09-04T05:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328423",
    "user": "https://github.com/videlec"
}
```

Cartan matrices are fixed... waiting for patchbot verdict again.



---

archive/issue_comments_328424.json:
```json
{
    "body": "Ok, I'm \"back on trac\"!\n\nI'll give a look at this today.\n\nWhere should I throw in the benchmarking script? I guess it is not a good idea to hard code the best implementation, but at least, in the tests, we could add some relevant benchmarks to keep track of the evolution?",
    "created_at": "2017-09-04T09:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328424",
    "user": "https://github.com/jplab"
}
```

Ok, I'm "back on trac"!

I'll give a look at this today.

Where should I throw in the benchmarking script? I guess it is not a good idea to hard code the best implementation, but at least, in the tests, we could add some relevant benchmarks to keep track of the evolution?



---

archive/issue_comments_328425.json:
```json
{
    "body": "In the description of the test:\n\n```\n+        Check that multiplication for matrices with different backends are not allowed::\n```\n\nI would also mention that sparsity is checked ( the reason why there is no X appearing in row 2, column 3...)\n\nThe changes in the CartanMatrix look good.\n\nIn one of the bot's report, I get an error here:\n\n```\n**********************************************************************\nFile \"src/sage/matrix/matrix_gfpn_dense.pyx\", line 1484, in sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense._echelon_in_place_classical\nFailed example:\n    type(X)\nExpected:\n    <type 'sage.matrix.matrix_generic_dense.Matrix_generic_dense'>\nGot:\n    <type 'sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense'>\n**********************************************************************\n```\n\nOther errors look to be unrelated. I'm still looking into the changes.",
    "created_at": "2017-09-04T13:20:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328425",
    "user": "https://github.com/jplab"
}
```

In the description of the test:

```
+        Check that multiplication for matrices with different backends are not allowed::
```

I would also mention that sparsity is checked ( the reason why there is no X appearing in row 2, column 3...)

The changes in the CartanMatrix look good.

In one of the bot's report, I get an error here:

```
**********************************************************************
File "src/sage/matrix/matrix_gfpn_dense.pyx", line 1484, in sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense._echelon_in_place_classical
Failed example:
    type(X)
Expected:
    <type 'sage.matrix.matrix_generic_dense.Matrix_generic_dense'>
Got:
    <type 'sage.matrix.matrix_gfpn_dense.Matrix_gfpn_dense'>
**********************************************************************
```

Other errors look to be unrelated. I'm still looking into the changes.



---

archive/issue_comments_328426.json:
```json
{
    "body": "I ran the test on the file `src/sage/matrix/matrix_gfpn_dense.pyx` and all tests passed...",
    "created_at": "2017-09-04T13:40:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328426",
    "user": "https://github.com/jplab"
}
```

I ran the test on the file `src/sage/matrix/matrix_gfpn_dense.pyx` and all tests passed...



---

archive/issue_comments_328427.json:
```json
{
    "body": "Just did some pep8 corrections... Otherwise, it looks good. Perhaps we should wait to get a proper bot to go over the changes as they touch many files...\n\n---\nNew commits:",
    "created_at": "2017-09-04T14:36:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328427",
    "user": "https://github.com/jplab"
}
```

Just did some pep8 corrections... Otherwise, it looks good. Perhaps we should wait to get a proper bot to go over the changes as they touch many files...

---
New commits:



---

archive/issue_comments_328428.json:
```json
{
    "body": "Replying to [comment:34 jipilab]:\n> I ran the test on the file `src/sage/matrix/matrix_gfpn_dense.pyx` and all tests passed...\n\n\nThis need to be fixed. It depends whether `meataxe` is installed or not.",
    "created_at": "2017-09-04T16:16:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328428",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:34 jipilab]:
> I ran the test on the file `src/sage/matrix/matrix_gfpn_dense.pyx` and all tests passed...


This need to be fixed. It depends whether `meataxe` is installed or not.



---

archive/issue_comments_328429.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-09-04T16:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328429",
    "user": "https://github.com/videlec"
}
```

New commits:



---

archive/issue_comments_328430.json:
```json
{
    "body": "Much cleaner now!!",
    "created_at": "2017-09-04T16:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328430",
    "user": "https://github.com/videlec"
}
```

Much cleaner now!!



---

archive/issue_comments_328431.json:
```json
{
    "body": "Replying to [comment:32 jipilab]:\n> Ok, I'm \"back on trac\"!\n> \n> I'll give a look at this today.\n> \n> Where should I throw in the benchmarking script? I guess it is not a good idea to hard code the best implementation, but at least, in the tests, we could add some relevant benchmarks to keep track of the evolution?\n\n\nNot here. You should open a new ticket (and you can add it to the follow-up list of this ticket). Moreover the concept of \"best implementation\" depends on what you intend to do (e.g. matrix multiplication, Gauss elimination, determinant, etc).",
    "created_at": "2017-09-10T16:13:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328431",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:32 jipilab]:
> Ok, I'm "back on trac"!
> 
> I'll give a look at this today.
> 
> Where should I throw in the benchmarking script? I guess it is not a good idea to hard code the best implementation, but at least, in the tests, we could add some relevant benchmarks to keep track of the evolution?


Not here. You should open a new ticket (and you can add it to the follow-up list of this ticket). Moreover the concept of "best implementation" depends on what you intend to do (e.g. matrix multiplication, Gauss elimination, determinant, etc).



---

archive/issue_comments_328432.json:
```json
{
    "body": "The ticket does not apply on beta5. I'm compiling b5 right now and I'll check if I can diagnose further. I have to install `meataxe` and checkout testing. Give my machine some time and I get back here!",
    "created_at": "2017-09-13T07:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328432",
    "user": "https://github.com/jplab"
}
```

The ticket does not apply on beta5. I'm compiling b5 right now and I'll check if I can diagnose further. I have to install `meataxe` and checkout testing. Give my machine some time and I get back here!



---

archive/issue_comments_328433.json:
```json
{
    "body": "Is there a dependency to #23721?",
    "created_at": "2017-09-13T07:59:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328433",
    "user": "https://github.com/jplab"
}
```

Is there a dependency to #23721?



---

archive/issue_comments_328434.json:
```json
{
    "body": "Replying to [comment:42 jipilab]:\n> Is there a dependency to #23721?\n\n\nNot that I know of...",
    "created_at": "2017-09-13T08:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328434",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:42 jipilab]:
> Is there a dependency to #23721?


Not that I know of...



---

archive/issue_comments_328435.json:
```json
{
    "body": "Replying to [comment:41 jipilab]:\n> The ticket does not apply on beta5. I'm compiling b5 right now and I'll check if I can diagnose further. I have to install `meataxe` and checkout testing. Give my machine some time and I get back here!\n\n\nThe problem comes from something that has changed in `matrix_space.py`. The merge is simple but I have to leave in 5 minutes... will fix that first thing this afternoon.",
    "created_at": "2017-09-13T08:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328435",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:41 jipilab]:
> The ticket does not apply on beta5. I'm compiling b5 right now and I'll check if I can diagnose further. I have to install `meataxe` and checkout testing. Give my machine some time and I get back here!


The problem comes from something that has changed in `matrix_space.py`. The merge is simple but I have to leave in 5 minutes... will fix that first thing this afternoon.



---

archive/issue_comments_328436.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-13T12:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328436",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328437.json:
```json
{
    "body": "Replying to [comment:44 vdelecroix]:\n> Replying to [comment:41 jipilab]:\n> > The ticket does not apply on beta5. I'm compiling b5 right now and I'll check if I can diagnose further. I have to install `meataxe` and checkout testing. Give my machine some time and I get back here!\n\n> \n> The problem comes from something that has changed in `matrix_space.py`. The merge is simple but I have to leave in 5 minutes... will fix that first thing this afternoon.\n\n\nDamn, I just read this comment... Hope I did not create any trouble.",
    "created_at": "2017-09-13T12:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328437",
    "user": "https://github.com/jplab"
}
```

Replying to [comment:44 vdelecroix]:
> Replying to [comment:41 jipilab]:
> > The ticket does not apply on beta5. I'm compiling b5 right now and I'll check if I can diagnose further. I have to install `meataxe` and checkout testing. Give my machine some time and I get back here!

> 
> The problem comes from something that has changed in `matrix_space.py`. The merge is simple but I have to leave in 5 minutes... will fix that first thing this afternoon.


Damn, I just read this comment... Hope I did not create any trouble.



---

archive/issue_comments_328438.json:
```json
{
    "body": "It's ok.",
    "created_at": "2017-09-13T12:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328438",
    "user": "https://github.com/videlec"
}
```

It's ok.



---

archive/issue_comments_328439.json:
```json
{
    "body": "There are some spurious doc errors, otherwise, it looks good.",
    "created_at": "2017-09-14T06:30:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328439",
    "user": "https://github.com/jplab"
}
```

There are some spurious doc errors, otherwise, it looks good.



---

archive/issue_comments_328440.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-14T07:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328440",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328441.json:
```json
{
    "body": "j'ai pouss\u00e9... reste plus qu'\u00e0 attendre les verdicts de madame patchbot.",
    "created_at": "2017-09-14T07:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328441",
    "user": "https://github.com/videlec"
}
```

j'ai poussé... reste plus qu'à attendre les verdicts de madame patchbot.



---

archive/issue_comments_328442.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-10-24T15:54:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328442",
    "user": "https://github.com/videlec"
}
```

New commits:



---

archive/issue_comments_328443.json:
```json
{
    "body": "Conflicts with #24096",
    "created_at": "2017-10-25T09:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328443",
    "user": "https://github.com/jdemeyer"
}
```

Conflicts with #24096



---

archive/issue_comments_328444.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-11-11T19:09:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328444",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328445.json:
```json
{
    "body": "rebased on 8.1.rc0",
    "created_at": "2017-11-11T19:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328445",
    "user": "https://github.com/videlec"
}
```

rebased on 8.1.rc0



---

archive/issue_comments_328446.json:
```json
{
    "body": "patchbot is happy! jipilab?",
    "created_at": "2017-11-12T20:18:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328446",
    "user": "https://github.com/videlec"
}
```

patchbot is happy! jipilab?



---

archive/issue_comments_328447.json:
```json
{
    "body": "I have a few comments:\n\n```diff\n-    def matrix_space(self, nrows=None, ncols=None, sparse=None):\n+    def matrix_space(self, nrows=None, ncols=None, sparse=True):\n         r\"\"\"\n         Return a matrix space over the integers.\n \n         INPUT:\n \n-        - ``nrows`` - number of rows\n+        - ``nrows`` -- number of rows\n \n-        - ``ncols`` - number of columns\n+        - ``ncols`` -- number of columns\n \n-        - ``sparse`` - (boolean) sparseness\n+        - ``sparse`` -- (boolean) sparseness\n \n         EXAMPLES::\n \n             sage: cm = CartanMatrix(['A', 3])\n             sage: cm.matrix_space()\n             Full MatrixSpace of 3 by 3 sparse matrices over Integer Ring\n             sage: cm.matrix_space(2, 2)\n             Full MatrixSpace of 2 by 2 sparse matrices over Integer Ring\n             sage: cm[:2,1:]   # indirect doctest\n             [-1  0]\n             [ 2 -1]\n         \"\"\"\n         if nrows is None:\n             nrows = self.nrows()\n         if ncols is None:\n             ncols = self.ncols()\n-        if sparse is None:\n-            sparse = True\n \n         if nrows == self.nrows() and ncols == self.ncols() and sparse:\n             return self.parent()\n         else:\n             from sage.matrix.matrix_space import MatrixSpace\n             return MatrixSpace(ZZ, nrows, ncols, sparse is None or bool(sparse))\n```\n\nI would make this into a more 2/3 compatible test:\n\n```\n            sage: for i in range(3):\n            ....:     for j in range(3):\n            ....:         try:\n            ....:             s = M[i].an_element() * M[j].an_element()\n            ....:             print('X', end='')\n            ....:         except TypeError:\n            ....:             print(' ', end='')\n            ....:     print()\n```\nI would instead create a 0/1-matrix and output that. Another option would be creating an appropriate string with `'\\n'.join(...)`. Similar for another test.\n\nThese tests should not be marked as meataxe if it really is using the generic implementation:\n\n```\n            sage: MS = MatrixSpace(M.base_ring(), M.nrows(), M.ncols(), implementation='generic')\n            sage: X = MS(M)                         # optional: meataxe\n            sage: type(X)                           # optional: meataxe\n            sage: X.echelon_form() # optional: meataxe\n```\nOtherwise that would be a bug.\n\nDo we want m4ri to have precedence over trying meataxe when no implementation is given? (I'm cc-ing Simon to note that there might be a change in behavior.)\n\nI'm also split on documenting about when we use a non-generic implementation by default. It feels too much like an implementation detail that it should be hidden from the more casual users, but I think it is good for the more advanced users to have it in the public doc. Thoughts?\n\nI'm also not 100% convinced about having to explicitly convert matrices of different implementations, but since things are likely to be incompatible and it seems unlikely that this would be a problem (I think a user who is choosing implementations will probably be careful and might even appreciate this error). I do not have a good reason to make this an objection, but I am just noting that this might come up from a user.",
    "created_at": "2017-11-13T00:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328447",
    "user": "https://github.com/tscrim"
}
```

I have a few comments:

```diff
-    def matrix_space(self, nrows=None, ncols=None, sparse=None):
+    def matrix_space(self, nrows=None, ncols=None, sparse=True):
         r"""
         Return a matrix space over the integers.
 
         INPUT:
 
-        - ``nrows`` - number of rows
+        - ``nrows`` -- number of rows
 
-        - ``ncols`` - number of columns
+        - ``ncols`` -- number of columns
 
-        - ``sparse`` - (boolean) sparseness
+        - ``sparse`` -- (boolean) sparseness
 
         EXAMPLES::
 
             sage: cm = CartanMatrix(['A', 3])
             sage: cm.matrix_space()
             Full MatrixSpace of 3 by 3 sparse matrices over Integer Ring
             sage: cm.matrix_space(2, 2)
             Full MatrixSpace of 2 by 2 sparse matrices over Integer Ring
             sage: cm[:2,1:]   # indirect doctest
             [-1  0]
             [ 2 -1]
         """
         if nrows is None:
             nrows = self.nrows()
         if ncols is None:
             ncols = self.ncols()
-        if sparse is None:
-            sparse = True
 
         if nrows == self.nrows() and ncols == self.ncols() and sparse:
             return self.parent()
         else:
             from sage.matrix.matrix_space import MatrixSpace
             return MatrixSpace(ZZ, nrows, ncols, sparse is None or bool(sparse))
```

I would make this into a more 2/3 compatible test:

```
            sage: for i in range(3):
            ....:     for j in range(3):
            ....:         try:
            ....:             s = M[i].an_element() * M[j].an_element()
            ....:             print('X', end='')
            ....:         except TypeError:
            ....:             print(' ', end='')
            ....:     print()
```
I would instead create a 0/1-matrix and output that. Another option would be creating an appropriate string with `'\n'.join(...)`. Similar for another test.

These tests should not be marked as meataxe if it really is using the generic implementation:

```
            sage: MS = MatrixSpace(M.base_ring(), M.nrows(), M.ncols(), implementation='generic')
            sage: X = MS(M)                         # optional: meataxe
            sage: type(X)                           # optional: meataxe
            sage: X.echelon_form() # optional: meataxe
```
Otherwise that would be a bug.

Do we want m4ri to have precedence over trying meataxe when no implementation is given? (I'm cc-ing Simon to note that there might be a change in behavior.)

I'm also split on documenting about when we use a non-generic implementation by default. It feels too much like an implementation detail that it should be hidden from the more casual users, but I think it is good for the more advanced users to have it in the public doc. Thoughts?

I'm also not 100% convinced about having to explicitly convert matrices of different implementations, but since things are likely to be incompatible and it seems unlikely that this would be a problem (I think a user who is choosing implementations will probably be careful and might even appreciate this error). I do not have a good reason to make this an objection, but I am just noting that this might come up from a user.



---

archive/issue_comments_328448.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-11-13T00:51:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328448",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328449.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-11-13T07:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328449",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328450.json:
```json
{
    "body": "Thanks Travis for having a look.\n\nReplying to [comment:56 tscrim]:\n> [SNIP]\n\n\nagreed and changed in eeeba32\n\n> Do we want m4ri to have precedence over trying meataxe when no implementation is given? (I'm cc-ing Simon to note that there might be a change in behavior.)\n\n\nThere should not be any change. It concerns only the case `characteristic = 2`.\n\n```\nif implementation is None:\n    if R.characteristic() == 2 and R.order() <= 65536:\n        implementation = 'm4ri'\n    elif R.order() <= 255:\n        try:\n            from . import matrix_gfpn_dense\n        except ImportError:\n            implementation = 'generic'\n        else:\n            implementation = 'meataxe'\n    else:\n        implementation = 'generic'\n```\nwhere it used to be\n\n```\nif R.characteristic() == 2:\n    if R.order() <= 65536:\n        return matrix_gf2e_dense.Matrix_gf2e_dense\nelif R.order() <= 255:\n    try:\n        from . import matrix_gfpn_dense\n        return matrix_gfpn_dense.Matrix_gfpn_dense\n    except ImportError:\n        pass\n```\n\n> I'm also split on documenting about when we use a non-generic implementation by default. It feels too much like an implementation detail that it should be hidden from the more casual users, but I think it is good for the more advanced users to have it in the public doc. Thoughts?\n\n\nWhat would you expect exactly? It would be a nightmare to keep the documentation up to date.\n\n> I'm also not 100% convinced about having to explicitly convert matrices of different implementations, but since things are likely to be incompatible and it seems unlikely that this would be a problem (I think a user who is choosing implementations will probably be careful and might even appreciate this error). I do not have a good reason to make this an objection, but I am just noting that this might come up from a user.\n\n\nIt should be possible to implement coercion to the default implementation (with conversion). Anyway, I would like to keep such changes for later.",
    "created_at": "2017-11-13T07:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328450",
    "user": "https://github.com/videlec"
}
```

Thanks Travis for having a look.

Replying to [comment:56 tscrim]:
> [SNIP]


agreed and changed in eeeba32

> Do we want m4ri to have precedence over trying meataxe when no implementation is given? (I'm cc-ing Simon to note that there might be a change in behavior.)


There should not be any change. It concerns only the case `characteristic = 2`.

```
if implementation is None:
    if R.characteristic() == 2 and R.order() <= 65536:
        implementation = 'm4ri'
    elif R.order() <= 255:
        try:
            from . import matrix_gfpn_dense
        except ImportError:
            implementation = 'generic'
        else:
            implementation = 'meataxe'
    else:
        implementation = 'generic'
```
where it used to be

```
if R.characteristic() == 2:
    if R.order() <= 65536:
        return matrix_gf2e_dense.Matrix_gf2e_dense
elif R.order() <= 255:
    try:
        from . import matrix_gfpn_dense
        return matrix_gfpn_dense.Matrix_gfpn_dense
    except ImportError:
        pass
```

> I'm also split on documenting about when we use a non-generic implementation by default. It feels too much like an implementation detail that it should be hidden from the more casual users, but I think it is good for the more advanced users to have it in the public doc. Thoughts?


What would you expect exactly? It would be a nightmare to keep the documentation up to date.

> I'm also not 100% convinced about having to explicitly convert matrices of different implementations, but since things are likely to be incompatible and it seems unlikely that this would be a problem (I think a user who is choosing implementations will probably be careful and might even appreciate this error). I do not have a good reason to make this an objection, but I am just noting that this might come up from a user.


It should be possible to implement coercion to the default implementation (with conversion). Anyway, I would like to keep such changes for later.



---

archive/issue_comments_328451.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-11-13T07:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328451",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328452.json:
```json
{
    "body": "Replying to [comment:58 vdelecroix]:\n> Thanks Travis for having a look.\n> > Do we want m4ri to have precedence over trying meataxe when no implementation is given? (I'm cc-ing Simon to note that there might be a change in behavior.)\n\n> \n> There should not be any change. It concerns only the case `characteristic = 2`.\n> [snip]\n\n\nRight, actually I might have misread what meataxe is for and it's a non-issue because it is not meant for characteristic 2. Sorry for the noise.\n\n> > I'm also split on documenting about when we use a non-generic implementation by default. It feels too much like an implementation detail that it should be hidden from the more casual users, but I think it is good for the more advanced users to have it in the public doc. Thoughts?\n\n> \n> What would you expect exactly? It would be a nightmare to keep the documentation up to date.\n\n\nKeeping it up to date would not be such a problem; at least I don't expect it to change that much. However, I tried a few different ways to present the info and nothing really worked too well. There's just a few too many little cases for the finite fields. I guess if someone cares enough they are good enough to just look at the code.\n\nThanks. Positive review.",
    "created_at": "2017-11-13T07:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328452",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:58 vdelecroix]:
> Thanks Travis for having a look.
> > Do we want m4ri to have precedence over trying meataxe when no implementation is given? (I'm cc-ing Simon to note that there might be a change in behavior.)

> 
> There should not be any change. It concerns only the case `characteristic = 2`.
> [snip]


Right, actually I might have misread what meataxe is for and it's a non-issue because it is not meant for characteristic 2. Sorry for the noise.

> > I'm also split on documenting about when we use a non-generic implementation by default. It feels too much like an implementation detail that it should be hidden from the more casual users, but I think it is good for the more advanced users to have it in the public doc. Thoughts?

> 
> What would you expect exactly? It would be a nightmare to keep the documentation up to date.


Keeping it up to date would not be such a problem; at least I don't expect it to change that much. However, I tried a few different ways to present the info and nothing really worked too well. There's just a few too many little cases for the finite fields. I guess if someone cares enough they are good enough to just look at the code.

Thanks. Positive review.



---

archive/issue_comments_328453.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-11-13T07:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328453",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_328454.json:
```json
{
    "body": "Documentation doesn't build",
    "created_at": "2017-12-09T12:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328454",
    "user": "https://github.com/vbraun"
}
```

Documentation doesn't build



---

archive/issue_comments_328455.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-12-09T12:59:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328455",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_328456.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-12-14T11:28:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328456",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_328457.json:
```json
{
    "body": "With the rebasing I do not have any problem with the documentation.",
    "created_at": "2017-12-14T11:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328457",
    "user": "https://github.com/videlec"
}
```

With the rebasing I do not have any problem with the documentation.



---

archive/issue_comments_328458.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-12-14T11:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328458",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_060570.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-12-14T11:30:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23706#event-60570"
}
```



---

archive/issue_comments_328459.json:
```json
{
    "body": "found out\n\n```\n[dochtml] [matrices ] docstring of sage.matrix.action.MatrixMatrixAction:24: WARNING: Unexpected indentation.\n[dochtml] [matrices ] docstring of sage.matrix.action.MatrixMatrixAction:25: WARNING: Block quote ends without a blank line; unexpected unindent.\n[dochtml] [matrices ] /opt/sage/local/lib/python2.7/site-packages/sage/matrix/special.py:docstring of sage.matrix.special:48: WARNING: undefined label: sage.combinat.matrices.hadamard_matrix (if the link has no caption the label must precede a section header)\n[dochtml] [matrices ] /opt/sage/local/lib/python2.7/site-packages/sage/matrix/special.py:docstring of sage.matrix.special:49: WARNING: undefined label: sage.combinat.matrices.latin (if the link has no caption the label must precede a section header)\n[dochtml] Error building the documentation.\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/opt/sage/local/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n[dochtml]     \"__main__\", fname, loader, pkg_name)\n[dochtml]   File \"/opt/sage/local/lib/python2.7/runpy.py\", line 72, in _run_code\n[dochtml]     exec code in run_globals\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml]     main()\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 1675, in main\n[dochtml]     builder()\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 310, in _wrapper\n[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 505, in _wrapper\n[dochtml]     build_many(build_ref_doc, L)\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 260, in build_many\n[dochtml]     results.append(target(arg))\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 71, in build_ref_doc\n[dochtml]     getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 720, in _wrapper\n[dochtml]     getattr(DocBuilder, build_type)(self, *args, **kwds)\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 105, in f\n[dochtml]     runsphinx()\n[dochtml]   File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/sphinxbuild.py\", line 218, in runsphinx\n[dochtml]     raise exception\n[dochtml] OSError: [matrices ] docstring of sage.matrix.action.MatrixMatrixAction:24: WARNING: Unexpected indentation.\n[dochtml] \n[dochtml] [matrices ] WARNING: Error building the documentation.\n[dochtml] [matrices ] Traceback (most recent call last):\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/runpy.py\", line 174, in _run_module_as_main\n[dochtml] [matrices ] \"__main__\", fname, loader, pkg_name)\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/runpy.py\", line 72, in _run_code\n[dochtml] [matrices ] exec code in run_globals\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml] [matrices ] main()\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 1675, in main\n[dochtml] [matrices ] builder()\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 310, in _wrapper\n[dochtml] [matrices ] getattr(get_builder(document), 'inventory')(*args, **kwds)\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 505, in _wrapper\n[dochtml] [matrices ] build_many(build_ref_doc, L)\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 260, in build_many\n[dochtml] [matrices ] results.append(target(arg))\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 71, in build_ref_doc\n[dochtml] [matrices ] getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 720, in _wrapper\n[dochtml] [matrices ] getattr(DocBuilder, build_type)(self, *args, **kwds)\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py\", line 105, in f\n[dochtml] [matrices ] runsphinx()\n[dochtml] [matrices ] File \"/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/sphinxbuild.py\", line 218, in runsphinx\n[dochtml] [matrices ] raise exception\n[dochtml] [matrices ] OSError: [matrices ] docstring of sage.matrix.action.MatrixMatrixAction:24: WARNING: Unexpected indentation.\n```",
    "created_at": "2017-12-14T23:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328459",
    "user": "https://github.com/videlec"
}
```

found out

```
[dochtml] [matrices ] docstring of sage.matrix.action.MatrixMatrixAction:24: WARNING: Unexpected indentation.
[dochtml] [matrices ] docstring of sage.matrix.action.MatrixMatrixAction:25: WARNING: Block quote ends without a blank line; unexpected unindent.
[dochtml] [matrices ] /opt/sage/local/lib/python2.7/site-packages/sage/matrix/special.py:docstring of sage.matrix.special:48: WARNING: undefined label: sage.combinat.matrices.hadamard_matrix (if the link has no caption the label must precede a section header)
[dochtml] [matrices ] /opt/sage/local/lib/python2.7/site-packages/sage/matrix/special.py:docstring of sage.matrix.special:49: WARNING: undefined label: sage.combinat.matrices.latin (if the link has no caption the label must precede a section header)
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/opt/sage/local/lib/python2.7/runpy.py", line 174, in _run_module_as_main
[dochtml]     "__main__", fname, loader, pkg_name)
[dochtml]   File "/opt/sage/local/lib/python2.7/runpy.py", line 72, in _run_code
[dochtml]     exec code in run_globals
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 1675, in main
[dochtml]     builder()
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 310, in _wrapper
[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 505, in _wrapper
[dochtml]     build_many(build_ref_doc, L)
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 260, in build_many
[dochtml]     results.append(target(arg))
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 71, in build_ref_doc
[dochtml]     getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 720, in _wrapper
[dochtml]     getattr(DocBuilder, build_type)(self, *args, **kwds)
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 105, in f
[dochtml]     runsphinx()
[dochtml]   File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/sphinxbuild.py", line 218, in runsphinx
[dochtml]     raise exception
[dochtml] OSError: [matrices ] docstring of sage.matrix.action.MatrixMatrixAction:24: WARNING: Unexpected indentation.
[dochtml] 
[dochtml] [matrices ] WARNING: Error building the documentation.
[dochtml] [matrices ] Traceback (most recent call last):
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/runpy.py", line 174, in _run_module_as_main
[dochtml] [matrices ] "__main__", fname, loader, pkg_name)
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/runpy.py", line 72, in _run_code
[dochtml] [matrices ] exec code in run_globals
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml] [matrices ] main()
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 1675, in main
[dochtml] [matrices ] builder()
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 310, in _wrapper
[dochtml] [matrices ] getattr(get_builder(document), 'inventory')(*args, **kwds)
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 505, in _wrapper
[dochtml] [matrices ] build_many(build_ref_doc, L)
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 260, in build_many
[dochtml] [matrices ] results.append(target(arg))
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 71, in build_ref_doc
[dochtml] [matrices ] getattr(ReferenceSubBuilder(doc, lang), format)(*args, **kwds)
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 720, in _wrapper
[dochtml] [matrices ] getattr(DocBuilder, build_type)(self, *args, **kwds)
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/__init__.py", line 105, in f
[dochtml] [matrices ] runsphinx()
[dochtml] [matrices ] File "/opt/sage/local/lib/python2.7/site-packages/sage_setup/docbuild/sphinxbuild.py", line 218, in runsphinx
[dochtml] [matrices ] raise exception
[dochtml] [matrices ] OSError: [matrices ] docstring of sage.matrix.action.MatrixMatrixAction:24: WARNING: Unexpected indentation.
```



---

archive/issue_comments_328460.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-12-14T23:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328460",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_328461.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-12-14T23:47:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328461",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328462.json:
```json
{
    "body": "I don't understand why, but sphinx was in trouble with `NOTE` and `TESTS` being in the same documentation string.",
    "created_at": "2017-12-14T23:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328462",
    "user": "https://github.com/videlec"
}
```

I don't understand why, but sphinx was in trouble with `NOTE` and `TESTS` being in the same documentation string.



---

archive/issue_comments_328463.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-12-14T23:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328463",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_328464.json:
```json
{
    "body": "It may not be Sphinx but our custom handling of the `TESTS` block (at least, IIRC we do something special there in order to hide the block).",
    "created_at": "2017-12-15T04:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328464",
    "user": "https://github.com/tscrim"
}
```

It may not be Sphinx but our custom handling of the `TESTS` block (at least, IIRC we do something special there in order to hide the block).



---

archive/issue_comments_328465.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-12-15T04:59:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328465",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_328466.json:
```json
{
    "body": "Anyways, the workaround is fine with me and there is a green patchbot. Back to positive review.",
    "created_at": "2017-12-15T04:59:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328466",
    "user": "https://github.com/tscrim"
}
```

Anyways, the workaround is fine with me and there is a green patchbot. Back to positive review.



---

archive/issue_comments_328467.json:
```json
{
    "body": "thanks Travis.",
    "created_at": "2017-12-15T14:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328467",
    "user": "https://github.com/videlec"
}
```

thanks Travis.



---

archive/issue_events_060571.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-12-18T19:39:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23706#event-60571"
}
```



---

archive/issue_comments_328468.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-12-18T19:39:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23706#issuecomment-328468",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
