# Issue 23411: Fix pickling of matrix_gfpn_dense

archive/issues_023174.json:
```json
{
    "body": "There currently are two problems related with pickling of `Matrix_gfpn_dense`: \n- When a string is provided as argument to `__init__`, it is interpreted as the name of a file from which data are read by some MeatAxe command. If the file doesn't exist, it was intended to have an uninitialised matrix (to be properly initialised later). But currently it crashes, which needs to be fixed.\n- The number of bytes used holding the data of a matrix row is machine independent. However, the number of bytes actually used to store the row always is a multiple of `sizeof(long)`, which is machine dependent (at least in theory). Pickling should of course only involve the machine independent memory chunks, but currently it involves the machine dependent chunks.\n\nReviewer: Jeroen Demeyer\n\nAuthor: Simon King\n\nBranch: ba72abac8a53b3d292df570d31709ab5c2f57157\n\nCommit: ba72abac8a53b3d292df570d31709ab5c2f57157\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23411\n\n",
    "closed_at": "2017-07-29T15:30:47Z",
    "created_at": "2017-07-12T14:19:25Z",
    "labels": [
        "component: packages: optional",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Fix pickling of matrix_gfpn_dense",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23411",
    "user": "https://github.com/simon-king-jena"
}
```
There currently are two problems related with pickling of `Matrix_gfpn_dense`: 
- When a string is provided as argument to `__init__`, it is interpreted as the name of a file from which data are read by some MeatAxe command. If the file doesn't exist, it was intended to have an uninitialised matrix (to be properly initialised later). But currently it crashes, which needs to be fixed.
- The number of bytes used holding the data of a matrix row is machine independent. However, the number of bytes actually used to store the row always is a multiple of `sizeof(long)`, which is machine dependent (at least in theory). Pickling should of course only involve the machine independent memory chunks, but currently it involves the machine dependent chunks.

Reviewer: Jeroen Demeyer

Author: Simon King

Branch: ba72abac8a53b3d292df570d31709ab5c2f57157

Commit: ba72abac8a53b3d292df570d31709ab5c2f57157

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23411





---

archive/issue_comments_323772.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-12T15:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323772",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_323773.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2017-07-12T15:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323773",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_323774.json:
```json
{
    "body": "<a id='comment:3'></a>Sorry, one commit is missing",
    "created_at": "2017-07-12T15:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323774",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:3'></a>Sorry, one commit is missing



---

archive/issue_comments_323775.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-12T15:12:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323775",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323776.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-12T15:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323776",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323777.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-12T15:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323777",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323778.json:
```json
{
    "body": "<a id='comment:5'></a>Now it builds and tests are passing...",
    "created_at": "2017-07-12T15:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323778",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:5'></a>Now it builds and tests are passing...



---

archive/issue_comments_323779.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-13T09:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323779",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323780.json:
```json
{
    "body": "<a id='comment:6'></a>1. As I mentioned on some other ticket, use `bytes` instead of `str` for pickling.\n\n2. If you claim that this makes pickling machine-independent, it would be good to actually test that. You can hardcode a pickle in a doctest (essentially, the output of `dumps()`) and then test that.",
    "created_at": "2017-07-13T09:50:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323780",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>1. As I mentioned on some other ticket, use `bytes` instead of `str` for pickling.

2. If you claim that this makes pickling machine-independent, it would be good to actually test that. You can hardcode a pickle in a doctest (essentially, the output of `dumps()`) and then test that.



---

archive/issue_comments_323781.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 jdemeyer]:\n> 1. As I mentioned on some other ticket, use `bytes` instead of `str` for pickling.\n\n\nYou also said I should split my original patchbomb into smaller parts. That's why I wanted to leave the transition from `str` to `bytes` for a ticket dedicated to cleaning code.\n\n> 2. If you claim that this makes pickling machine-independent, it would be good to actually test that. You can hardcode a pickle in a doctest (essentially, the output of `dumps()`) and then test that.\n\n\nOK. Just to be on the safe side: You do not say that I should imitate a pickle string that results from a machine where, say, `sizeof(long)==3`? Cause otherwise we would never see the deprecation warning.",
    "created_at": "2017-07-13T10:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323781",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:7'></a>Replying to [comment:6 jdemeyer]:
> 1. As I mentioned on some other ticket, use `bytes` instead of `str` for pickling.


You also said I should split my original patchbomb into smaller parts. That's why I wanted to leave the transition from `str` to `bytes` for a ticket dedicated to cleaning code.

> 2. If you claim that this makes pickling machine-independent, it would be good to actually test that. You can hardcode a pickle in a doctest (essentially, the output of `dumps()`) and then test that.


OK. Just to be on the safe side: You do not say that I should imitate a pickle string that results from a machine where, say, `sizeof(long)==3`? Cause otherwise we would never see the deprecation warning.



---

archive/issue_comments_323782.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 SimonKing]:\n> You also said I should split my original patchbomb into smaller parts. That's why I wanted to leave the transition from `str` to `bytes` for a ticket dedicated to cleaning code.\n\n\nPS: Adding such patch would also imply to modify the lines where I import the `PyString...` functions, which means that there will be further conflicts with #21437.",
    "created_at": "2017-07-13T10:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323782",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:8'></a>Replying to [comment:7 SimonKing]:
> You also said I should split my original patchbomb into smaller parts. That's why I wanted to leave the transition from `str` to `bytes` for a ticket dedicated to cleaning code.


PS: Adding such patch would also imply to modify the lines where I import the `PyString...` functions, which means that there will be further conflicts with #21437.



---

archive/issue_comments_323783.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-13T11:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323783",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323784.json:
```json
{
    "body": "<a id='comment:10'></a>In the latest commit, I add a test that should demonstrate machine independence of pickling (provided that the patchbots provide a whole lot of different architectures, including little and big endian and different sizes of `long`). I also add a test that triggers the deprecation warning.\n\nI am not really happy about doing part of the code cleanup here. Would you accept to do all cleanup on a separate ticket. If you do, then please consider this ticket as \"needs review\".",
    "created_at": "2017-07-13T11:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323784",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:10'></a>In the latest commit, I add a test that should demonstrate machine independence of pickling (provided that the patchbots provide a whole lot of different architectures, including little and big endian and different sizes of `long`). I also add a test that triggers the deprecation warning.

I am not really happy about doing part of the code cleanup here. Would you accept to do all cleanup on a separate ticket. If you do, then please consider this ticket as "needs review".



---

archive/issue_comments_323785.json:
```json
{
    "body": "<a id='comment:11'></a>Setting it to \"needs review\" in order to allow the patchbots to test the ticket.",
    "created_at": "2017-07-13T11:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323785",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:11'></a>Setting it to "needs review" in order to allow the patchbots to test the ticket.



---

archive/issue_comments_323786.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-13T11:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323786",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323787.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-13T12:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323787",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323788.json:
```json
{
    "body": "<a id='comment:13'></a>Question: Will the buildbot automatically test with and without meataxe being installed? If not: How can I advice the buildbot to do so?",
    "created_at": "2017-07-13T12:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323788",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:13'></a>Question: Will the buildbot automatically test with and without meataxe being installed? If not: How can I advice the buildbot to do so?



---

archive/issue_comments_323789.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:7 SimonKing]:\n> Replying to [comment:6 jdemeyer]:\n> > 1. As I mentioned on some other ticket, use `bytes` instead of `str` for pickling.\n  \n> \n> You also said I should split my original patchbomb into smaller parts. That's why I wanted to leave the transition from `str` to `bytes` for a ticket dedicated to cleaning code.\n\n\nIt's just a bit strange that you write \"unclean\" code in one ticket and then at the same time have another ticket to clean it up.\n\nBut that's not a big deal since the old code also uses strings.",
    "created_at": "2017-07-13T13:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323789",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replying to [comment:7 SimonKing]:
> Replying to [comment:6 jdemeyer]:
> > 1. As I mentioned on some other ticket, use `bytes` instead of `str` for pickling.
  
> 
> You also said I should split my original patchbomb into smaller parts. That's why I wanted to leave the transition from `str` to `bytes` for a ticket dedicated to cleaning code.


It's just a bit strange that you write "unclean" code in one ticket and then at the same time have another ticket to clean it up.

But that's not a big deal since the old code also uses strings.



---

archive/issue_comments_323790.json:
```json
{
    "body": "<a id='comment:15'></a>Also in some other ticket, I made the comment that you should use floor division (`//`) if that's what you want.",
    "created_at": "2017-07-13T13:36:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323790",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>Also in some other ticket, I made the comment that you should use floor division (`//`) if that's what you want.



---

archive/issue_comments_323791.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-13T13:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323791",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323792.json:
```json
{
    "body": "<a id='comment:16'></a>Please do not use the `for ... from ...` syntax. Cython understands `range()`.",
    "created_at": "2017-07-13T13:39:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323792",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>Please do not use the `for ... from ...` syntax. Cython understands `range()`.



---

archive/issue_comments_323793.json:
```json
{
    "body": "<a id='comment:17'></a>When unpickling, it seems that there is no protecting against reading out of bounds. The case where `x` is too short should be handled gracefully. The code should be more like:\n\n```\nif len(Data) == expected_size:\n    # Handle new-style pickle\nelif len(Data) == expected_size_for_old_pickle:\n    # Handle deprecated pickle\nelse:\n    raise ValueError(f\"expected a pickle with {expected_size} bytes, got {len(Data)} instead\")\n```\nEDIT: note the swapped conditions. It is possible that `expected_size == expected_size_for_old_pickle`.\n\nAnd a small detail: you write twice `x = PyString_AsString(Data)` while once (outside the branch) should be sufficient.",
    "created_at": "2017-07-13T13:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323793",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>When unpickling, it seems that there is no protecting against reading out of bounds. The case where `x` is too short should be handled gracefully. The code should be more like:

```
if len(Data) == expected_size:
    # Handle new-style pickle
elif len(Data) == expected_size_for_old_pickle:
    # Handle deprecated pickle
else:
    raise ValueError(f"expected a pickle with {expected_size} bytes, got {len(Data)} instead")
```
EDIT: note the swapped conditions. It is possible that `expected_size == expected_size_for_old_pickle`.

And a small detail: you write twice `x = PyString_AsString(Data)` while once (outside the branch) should be sufficient.



---

archive/issue_comments_323794.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:14 jdemeyer]:\n> It's just a bit strange that you write \"unclean\" code in one ticket and then at the same time have another ticket to clean it up.\n> \n> But that's not a big deal since the old code also uses strings.\n\n\nRight. And you spotted further problems with the code added by this ticket.\n\nSo, I guess it is better to clean the new code, although it will imply manual merging in other tickets.",
    "created_at": "2017-07-13T14:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323794",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:18'></a>Replying to [comment:14 jdemeyer]:
> It's just a bit strange that you write "unclean" code in one ticket and then at the same time have another ticket to clean it up.
> 
> But that's not a big deal since the old code also uses strings.


Right. And you spotted further problems with the code added by this ticket.

So, I guess it is better to clean the new code, although it will imply manual merging in other tickets.



---

archive/issue_comments_323795.json:
```json
{
    "body": "<a id='comment:19'></a>If I were you, I would first focus on getting these first tickets accepted, otherwise you will be forever merging and rebasing :-)",
    "created_at": "2017-07-13T14:30:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323795",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>If I were you, I would first focus on getting these first tickets accepted, otherwise you will be forever merging and rebasing :-)



---

archive/issue_comments_323796.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-13T14:38:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323796",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323797.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-13T14:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323797",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323798.json:
```json
{
    "body": "<a id='comment:22'></a>Replying to [comment:19 jdemeyer]:\n> If I were you, I would first focus on getting these first tickets accepted, otherwise you will be forever merging and rebasing :-)\n\n\nHooray, it merges cleanly into #21437...\n\nI guess I'll wait a while till I move on to #23400.",
    "created_at": "2017-07-13T14:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323798",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:22'></a>Replying to [comment:19 jdemeyer]:
> If I were you, I would first focus on getting these first tickets accepted, otherwise you will be forever merging and rebasing :-)


Hooray, it merges cleanly into #21437...

I guess I'll wait a while till I move on to #23400.



---

archive/issue_comments_323799.json:
```json
{
    "body": "<a id='comment:23'></a>PS: Perhaps it would have been better to *first* clean the existing code, and then do the bug fixes and additions. But I suppose I shouldn't change the order of tickets again, or should I?",
    "created_at": "2017-07-13T14:45:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323799",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:23'></a>PS: Perhaps it would have been better to *first* clean the existing code, and then do the bug fixes and additions. But I suppose I shouldn't change the order of tickets again, or should I?



---

archive/issue_comments_323800.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-13T14:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323800",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323801.json:
```json
{
    "body": "<a id='comment:24'></a>This is a potential division by zero:\n\n```\ncdef size_t pickled_rowsize = lenData//nr\n```\nIt would be good to add a doctest for the case `nr == 0`.\n\nI think the best solution is to replace the condition `if Data` by `if nr`.",
    "created_at": "2017-07-13T14:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323801",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:24'></a>This is a potential division by zero:

```
cdef size_t pickled_rowsize = lenData//nr
```
It would be good to add a doctest for the case `nr == 0`.

I think the best solution is to replace the condition `if Data` by `if nr`.



---

archive/issue_comments_323802.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-15T11:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323802",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323803.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-15T11:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323803",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323804.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-15T11:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323804",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323805.json:
```json
{
    "body": "<a id='comment:28'></a>Assertions are meant to guard against bugs, not against invalid input. Your `assert` should be a `raise ValueError`.",
    "created_at": "2017-07-17T08:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323805",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>Assertions are meant to guard against bugs, not against invalid input. Your `assert` should be a `raise ValueError`.



---

archive/issue_comments_323806.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-17T08:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323806",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323807.json:
```json
{
    "body": "<a id='comment:29'></a>It would be good to add doctests for *correct* unpickling of matrices with zero rows or columns.",
    "created_at": "2017-07-17T08:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323807",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>It would be good to add doctests for *correct* unpickling of matrices with zero rows or columns.



---

archive/issue_comments_323808.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:28 jdemeyer]:\n> Assertions are meant to guard against bugs, not against invalid input. Your `assert` should be a `raise ValueError`.\n\n\nOK. And I guess since I am touching some sub-optimal code here (using `PyString...`), it'd be better to clean this here, not in #23400",
    "created_at": "2017-07-17T08:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323808",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:30'></a>Replying to [comment:28 jdemeyer]:
> Assertions are meant to guard against bugs, not against invalid input. Your `assert` should be a `raise ValueError`.


OK. And I guess since I am touching some sub-optimal code here (using `PyString...`), it'd be better to clean this here, not in #23400



---

archive/issue_comments_323809.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:29 jdemeyer]:\n> It would be good to add doctests for *correct* unpickling of matrices with zero rows or columns.\n\n\nDo you mean a test with hard-coded pickle string? Or a test in the form `loads(dumps(M))==M`?",
    "created_at": "2017-07-17T08:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323809",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:31'></a>Replying to [comment:29 jdemeyer]:
> It would be good to add doctests for *correct* unpickling of matrices with zero rows or columns.


Do you mean a test with hard-coded pickle string? Or a test in the form `loads(dumps(M))==M`?



---

archive/issue_comments_323810.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:31 SimonKing]:\n> Replying to [comment:29 jdemeyer]:\n> > It would be good to add doctests for *correct* unpickling of matrices with zero rows or columns.\n\n> \n> Do you mean a test with hard-coded pickle string? Or a test in the form `loads(dumps(M))==M`?\n\n\nI meant the latter.  Although an explicit call to `mtx_unpickle` with empty `Data` would be good also.",
    "created_at": "2017-07-17T08:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323810",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>Replying to [comment:31 SimonKing]:
> Replying to [comment:29 jdemeyer]:
> > It would be good to add doctests for *correct* unpickling of matrices with zero rows or columns.

> 
> Do you mean a test with hard-coded pickle string? Or a test in the form `loads(dumps(M))==M`?


I meant the latter.  Although an explicit call to `mtx_unpickle` with empty `Data` would be good also.



---

archive/issue_comments_323811.json:
```json
{
    "body": "Replying to [ticket:23411 SimonKing]:\n> - When a string is provided as argument to `__init__`, it is interpreted as the name of a file from which data are read by some MeatAxe command. If the file doesn't exist, it was intended to have an uninitialised matrix (to be properly initialised later). But currently it crashes, which needs to be fixed.\n\n\nI don't like your fix for this for several reasons:\n\n1. I can't actually reproduce the issue. Without this patch, the doctest that you added passes. I think this is because the memory for Python objects is automatically initialized with all zeros.\n\n2. If the result of `__cinit__` is really invalid in some way, then it means that there is something wrong with `__cinit__`. Most importantly, `__cinit__` should already return an object which doesn't cause segfaults.\n\n3. A non-existing file should be an error, not something to be silently ignored.\n\n4. Do you really need to open the file in Python and then close it and then let MeatAxe open it again? At a minimum, you should document in a comment why you are doing it this way.\n\nFrom reading the code, I think the best solution would be to remove `__cinit__` completely and handle all initialization in `__init__`.",
    "created_at": "2017-07-17T09:10:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323811",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:23411 SimonKing]:
> - When a string is provided as argument to `__init__`, it is interpreted as the name of a file from which data are read by some MeatAxe command. If the file doesn't exist, it was intended to have an uninitialised matrix (to be properly initialised later). But currently it crashes, which needs to be fixed.


I don't like your fix for this for several reasons:

1. I can't actually reproduce the issue. Without this patch, the doctest that you added passes. I think this is because the memory for Python objects is automatically initialized with all zeros.

2. If the result of `__cinit__` is really invalid in some way, then it means that there is something wrong with `__cinit__`. Most importantly, `__cinit__` should already return an object which doesn't cause segfaults.

3. A non-existing file should be an error, not something to be silently ignored.

4. Do you really need to open the file in Python and then close it and then let MeatAxe open it again? At a minimum, you should document in a comment why you are doing it this way.

From reading the code, I think the best solution would be to remove `__cinit__` completely and handle all initialization in `__init__`.



---

archive/issue_comments_323812.json:
```json
{
    "body": "<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-17T09:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323812",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:34'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323813.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:33 jdemeyer]:\n> Replying to [ticket:23411 SimonKing]:\n> > - When a string is provided as argument to `__init__`, it is interpreted as the name of a file from which data are read by some MeatAxe command. If the file doesn't exist, it was intended to have an uninitialised matrix (to be properly initialised later). But currently it crashes, which needs to be fixed.\n \n> \n> I don't like your fix for this for several reasons:\n> \n> 1. I can't actually reproduce the issue.\n\n\nStrange. has there been a recent change in Cython? If I recall correctly, reading from a non-existing file left the matrix in an undefined state. In particular, it was possible that the `self.Data` pointer was *not* NULL.\n\n> 3. A non-existing file should be an error, not something to be silently ignored.\n\n\nOK.\n \n> 4. Do you really need to open the file in Python and then close it and then let MeatAxe open it again? At a minimum, you should document in a comment why you are doing it this way.\n> \n> From reading the code, I think the best solution would be to remove `__cinit__` completely and handle all initialization in `__init__`.\n\n\nIf it is really the case that I can rely on `self.Data` being initialised to NULL, then I guess removing `__cinit__` is fine.",
    "created_at": "2017-07-17T09:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323813",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:35'></a>Replying to [comment:33 jdemeyer]:
> Replying to [ticket:23411 SimonKing]:
> > - When a string is provided as argument to `__init__`, it is interpreted as the name of a file from which data are read by some MeatAxe command. If the file doesn't exist, it was intended to have an uninitialised matrix (to be properly initialised later). But currently it crashes, which needs to be fixed.
 
> 
> I don't like your fix for this for several reasons:
> 
> 1. I can't actually reproduce the issue.


Strange. has there been a recent change in Cython? If I recall correctly, reading from a non-existing file left the matrix in an undefined state. In particular, it was possible that the `self.Data` pointer was *not* NULL.

> 3. A non-existing file should be an error, not something to be silently ignored.


OK.
 
> 4. Do you really need to open the file in Python and then close it and then let MeatAxe open it again? At a minimum, you should document in a comment why you are doing it this way.
> 
> From reading the code, I think the best solution would be to remove `__cinit__` completely and handle all initialization in `__init__`.


If it is really the case that I can rely on `self.Data` being initialised to NULL, then I guess removing `__cinit__` is fine.



---

archive/issue_comments_323814.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-17T09:55:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323814",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323815.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:33 jdemeyer]:\n> Replying to [ticket:23411 SimonKing]:\n> 2. If the result of `__cinit__` is really invalid in some way, then it means that there is something wrong with `__cinit__`. Most importantly, `__cinit__` should already return an object which doesn't cause segfaults.\n\n\nThat is the case, provided that `self.Data` is correctly initialised to NULL by cython.\n \n> 3. A non-existing file should be an error, not something to be silently ignored.\n\n\nDone. Now, an error raised by MeatAxe is propagated.\n\n> 4. Do you really need to open the file in Python and then close it and then let MeatAxe open it again? \n\n\nNo, one can simply catch the resulting error, if one likes...\n\n> From reading the code, I think the best solution would be to remove `__cinit__` completely and handle all initialization in `__init__`.\n\n\nDone. And the tests pass :)",
    "created_at": "2017-07-17T09:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323815",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:37'></a>Replying to [comment:33 jdemeyer]:
> Replying to [ticket:23411 SimonKing]:
> 2. If the result of `__cinit__` is really invalid in some way, then it means that there is something wrong with `__cinit__`. Most importantly, `__cinit__` should already return an object which doesn't cause segfaults.


That is the case, provided that `self.Data` is correctly initialised to NULL by cython.
 
> 3. A non-existing file should be an error, not something to be silently ignored.


Done. Now, an error raised by MeatAxe is propagated.

> 4. Do you really need to open the file in Python and then close it and then let MeatAxe open it again? 


No, one can simply catch the resulting error, if one likes...

> From reading the code, I think the best solution would be to remove `__cinit__` completely and handle all initialization in `__init__`.


Done. And the tests pass :)



---

archive/issue_comments_323816.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-17T09:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323816",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323817.json:
```json
{
    "body": "<a id='comment:39'></a>There is something wrong with the indentation here:\n\n```\n        5. Creating a matrix from a file in MeatAxe format. If the file doesn't exist,\n            an error raised by the MeatAxe library is propagated::\n\n            sage: Matrix_gfpn_dense('foobarNONEXISTING_FILE')       # optional: meataxe\n            Traceback (most recent call last):\n            ...\n            SystemError: .../foobarNONEXISTING_FILE: No such file or directory in file os.c (line 254)\n```\nCorrect indentation would be\n\n```\n        5.  Creating a matrix from a file in MeatAxe format. If the file doesn't exist,\n            an error raised by the MeatAxe library is propagated::\n\n                sage: Matrix_gfpn_dense('foobarNONEXISTING_FILE')       # optional: meataxe\n                Traceback (most recent call last):\n                ...\n                SystemError: .../foobarNONEXISTING_FILE: No such file or directory in file os.c (line 254)\n```\n(note the double space after `5.` to make allow 4 spaces of indentation on the next line)",
    "created_at": "2017-07-17T11:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323817",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:39'></a>There is something wrong with the indentation here:

```
        5. Creating a matrix from a file in MeatAxe format. If the file doesn't exist,
            an error raised by the MeatAxe library is propagated::

            sage: Matrix_gfpn_dense('foobarNONEXISTING_FILE')       # optional: meataxe
            Traceback (most recent call last):
            ...
            SystemError: .../foobarNONEXISTING_FILE: No such file or directory in file os.c (line 254)
```
Correct indentation would be

```
        5.  Creating a matrix from a file in MeatAxe format. If the file doesn't exist,
            an error raised by the MeatAxe library is propagated::

                sage: Matrix_gfpn_dense('foobarNONEXISTING_FILE')       # optional: meataxe
                Traceback (most recent call last):
                ...
                SystemError: .../foobarNONEXISTING_FILE: No such file or directory in file os.c (line 254)
```
(note the double space after `5.` to make allow 4 spaces of indentation on the next line)



---

archive/issue_comments_323818.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-17T11:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323818",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323819.json:
```json
{
    "body": "<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-17T11:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323819",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:40'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323820.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-17T11:54:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323820",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323821.json:
```json
{
    "body": "<a id='comment:42'></a>What is the purpose of\n\n```\n            if not parent:\n                self._cache == {}\n```\n\nIt seems that you want to allow `Matrix_gfpn_dense(\"\")` to return an uninitialized matrix but I wonder why. If you *really* want that for some reason, it would be better to replace `if parent is None` above by `if not parent`.",
    "created_at": "2017-07-17T11:56:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323821",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>What is the purpose of

```
            if not parent:
                self._cache == {}
```

It seems that you want to allow `Matrix_gfpn_dense("")` to return an uninitialized matrix but I wonder why. If you *really* want that for some reason, it would be better to replace `if parent is None` above by `if not parent`.



---

archive/issue_comments_323822.json:
```json
{
    "body": "<a id='comment:43'></a>Except for my last comment, this ticket is fine for me.",
    "created_at": "2017-07-17T11:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323822",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:43'></a>Except for my last comment, this ticket is fine for me.



---

archive/issue_comments_323823.json:
```json
{
    "body": "<a id='comment:44'></a>Replying to [comment:42 jdemeyer]:\n> What is the purpose of\n> \n> ```\n>             if not parent:\n>                 self._cache == {}\n> ```\n> \n> It seems that you want to allow `Matrix_gfpn_dense(\"\")` to return an uninitialized matrix but I wonder why. If you *really* want that for some reason, it would be better to replace `if parent is None` above by `if not parent`.\n\n\nI do use uninitialised meataxe matrices in some application (of course in my group cohomology package), namely when I want to create a `Matrix_gfpn_dense` from an existing `Matrix_t*`. But your suggestion makes perfect sense.",
    "created_at": "2017-07-17T12:01:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323823",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:44'></a>Replying to [comment:42 jdemeyer]:
> What is the purpose of
> 
> ```
>             if not parent:
>                 self._cache == {}
> ```
> 
> It seems that you want to allow `Matrix_gfpn_dense("")` to return an uninitialized matrix but I wonder why. If you *really* want that for some reason, it would be better to replace `if parent is None` above by `if not parent`.


I do use uninitialised meataxe matrices in some application (of course in my group cohomology package), namely when I want to create a `Matrix_gfpn_dense` from an existing `Matrix_t*`. But your suggestion makes perfect sense.



---

archive/issue_comments_323824.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-17T12:04:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323824",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323825.json:
```json
{
    "body": "<a id='comment:46'></a>Done!",
    "created_at": "2017-07-17T12:04:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323825",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:46'></a>Done!



---

archive/issue_comments_323826.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:44 SimonKing]:\n> I do use uninitialised meataxe matrices in some application\n\n\nI would argue that the *proper* way to get an \"uninitialised meataxe matrix\" is precisely to do `Matrix_gfpn_dense.__new__(Matrix_gfpn_dense)`.\n\nThis idiom of using `__new__` and then manually filling in a data structure is used a lot in Sage. For example, in the `numerator` method for rational numbers:\n\n```\n    def numerator(self):\n        cdef Integer n = Integer.__new__(Integer)\n        n.set_from_mpz(mpq_numref(self.value))\n        return n\n```",
    "created_at": "2017-07-17T12:18:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323826",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'></a>Replying to [comment:44 SimonKing]:
> I do use uninitialised meataxe matrices in some application


I would argue that the *proper* way to get an "uninitialised meataxe matrix" is precisely to do `Matrix_gfpn_dense.__new__(Matrix_gfpn_dense)`.

This idiom of using `__new__` and then manually filling in a data structure is used a lot in Sage. For example, in the `numerator` method for rational numbers:

```
    def numerator(self):
        cdef Integer n = Integer.__new__(Integer)
        n.set_from_mpz(mpq_numref(self.value))
        return n
```



---

archive/issue_comments_323827.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-17T12:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323827",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323828.json:
```json
{
    "body": "<a id='comment:48'></a>Replying to [comment:47 jdemeyer]:\n> I would argue that the *proper* way to get an \"uninitialised meataxe matrix\" is precisely to do `Matrix_gfpn_dense.__new__(Matrix_gfpn_dense)`.\n\n\nActually I just checked: I am using the `.__new__` thing in some part of my cohomology code, and in some other parts I'd really better do it as well. I suppose it should be removed.",
    "created_at": "2017-07-17T12:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323828",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:48'></a>Replying to [comment:47 jdemeyer]:
> I would argue that the *proper* way to get an "uninitialised meataxe matrix" is precisely to do `Matrix_gfpn_dense.__new__(Matrix_gfpn_dense)`.


Actually I just checked: I am using the `.__new__` thing in some part of my cohomology code, and in some other parts I'd really better do it as well. I suppose it should be removed.



---

archive/issue_comments_323829.json:
```json
{
    "body": "<a id='comment:49'></a>PS: Also note the statement in the docstring of `__init__`, where I say that the case `parent = None` is used for unpickling --- which is not true, as I am using `__new__` there as well!",
    "created_at": "2017-07-17T12:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323829",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:49'></a>PS: Also note the statement in the docstring of `__init__`, where I say that the case `parent = None` is used for unpickling --- which is not true, as I am using `__new__` there as well!



---

archive/issue_comments_323830.json:
```json
{
    "body": "<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-17T12:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323830",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:50'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323831.json:
```json
{
    "body": "<a id='comment:51'></a>Avoid `six` in Cython files if possible! Please revert to `basestring`.",
    "created_at": "2017-07-17T12:39:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323831",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'></a>Avoid `six` in Cython files if possible! Please revert to `basestring`.



---

archive/issue_comments_323832.json:
```json
{
    "body": "<a id='comment:52'></a>Replying to [comment:51 jdemeyer]:\n> Avoid `six` in Cython files if possible! Please revert to `basestring`.\n\n\nReally? I thought this was needed to make things Python3 compliant. OK, I'll revert it.\n\nSomething else: If the MeatAxe function `MatLoad` gets an empty file name, it apparently just returns the NULL pointer, but doesn't raise an error. What shall I do? Shall I change\n`Matrix_t *MatLoad(char *fn) except NULL` into `Matrix_t *MatLoad(char *fn) except? NULL` (or what's the syntax if NULL can also be returned without an error)?",
    "created_at": "2017-07-17T12:42:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323832",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:52'></a>Replying to [comment:51 jdemeyer]:
> Avoid `six` in Cython files if possible! Please revert to `basestring`.


Really? I thought this was needed to make things Python3 compliant. OK, I'll revert it.

Something else: If the MeatAxe function `MatLoad` gets an empty file name, it apparently just returns the NULL pointer, but doesn't raise an error. What shall I do? Shall I change
`Matrix_t *MatLoad(char *fn) except NULL` into `Matrix_t *MatLoad(char *fn) except? NULL` (or what's the syntax if NULL can also be returned without an error)?



---

archive/issue_comments_323833.json:
```json
{
    "body": "<a id='comment:53'></a>Replying to [comment:52 SimonKing]:\n> I thought this was needed to make things Python3 compliant.\n\n\nYes, `six` is needed to make things Python 3 compliant.\n\nHowever, Cython is a language by itself. Cython is not Python 2 and it's not Python 3. Cython tries to be compatible with Python 2 and Python 3. This makes porting Cython code to Python 3 much easier than porting Python code.\n\nOf course, some Cython code is really just Python code and that code can depend on the Python version. And there are some incompatibilities that Cython cannot fix: support for `__cmp__` is gone in Python 3, there is nothing that Cython can do about that.",
    "created_at": "2017-07-17T12:47:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323833",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:53'></a>Replying to [comment:52 SimonKing]:
> I thought this was needed to make things Python3 compliant.


Yes, `six` is needed to make things Python 3 compliant.

However, Cython is a language by itself. Cython is not Python 2 and it's not Python 3. Cython tries to be compatible with Python 2 and Python 3. This makes porting Cython code to Python 3 much easier than porting Python code.

Of course, some Cython code is really just Python code and that code can depend on the Python version. And there are some incompatibilities that Cython cannot fix: support for `__cmp__` is gone in Python 3, there is nothing that Cython can do about that.



---

archive/issue_comments_323834.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:52 SimonKing]:\n> Replying to [comment:51 jdemeyer]:\n> > Avoid `six` in Cython files if possible! Please revert to `basestring`.\n\n> \n> Really? I thought this was needed to make things Python3 compliant. OK, I'll revert it.\n> \n> Something else: If the MeatAxe function `MatLoad` gets an empty file name, it apparently just returns the NULL pointer, but doesn't raise an error. What shall I do? Shall I change\n> `Matrix_t *MatLoad(char *fn) except NULL` into `Matrix_t *MatLoad(char *fn) except? NULL` (or what's the syntax if NULL can also be returned without an error)?\n\n\nYes, `except? NULL` is fine. I would still raise a Python exception in this case though.",
    "created_at": "2017-07-17T12:48:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323834",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:54'></a>Replying to [comment:52 SimonKing]:
> Replying to [comment:51 jdemeyer]:
> > Avoid `six` in Cython files if possible! Please revert to `basestring`.

> 
> Really? I thought this was needed to make things Python3 compliant. OK, I'll revert it.
> 
> Something else: If the MeatAxe function `MatLoad` gets an empty file name, it apparently just returns the NULL pointer, but doesn't raise an error. What shall I do? Shall I change
> `Matrix_t *MatLoad(char *fn) except NULL` into `Matrix_t *MatLoad(char *fn) except? NULL` (or what's the syntax if NULL can also be returned without an error)?


Yes, `except? NULL` is fine. I would still raise a Python exception in this case though.



---

archive/issue_comments_323835.json:
```json
{
    "body": "<a id='comment:55'></a>Replying to [comment:54 jdemeyer]:\n> Yes, `except? NULL` is fine. I would still raise a Python exception in this case though.\n\n\nIf you want an error being raised on `Matrix_gfpn_dense('')`, then I need to re-introduce the test `if not parent` (but then raise an error). Is that OK for you?\n\nIn any case, changing the function header of `MatLoad` should be done.",
    "created_at": "2017-07-17T12:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323835",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:55'></a>Replying to [comment:54 jdemeyer]:
> Yes, `except? NULL` is fine. I would still raise a Python exception in this case though.


If you want an error being raised on `Matrix_gfpn_dense('')`, then I need to re-introduce the test `if not parent` (but then raise an error). Is that OK for you?

In any case, changing the function header of `MatLoad` should be done.



---

archive/issue_comments_323836.json:
```json
{
    "body": "<a id='comment:56'></a>Replying to [comment:55 SimonKing]:\n> Replying to [comment:54 jdemeyer]:\n> > Yes, `except? NULL` is fine. I would still raise a Python exception in this case though.\n\n> \n> If you want an error being raised on `Matrix_gfpn_dense('')`, then I need to re-introduce the test `if not parent` (but then raise an error). Is that OK for you?\n\n\nBut you say that MeatAxe returns `NULL` without exception in this case. So it suffices to check the result of `MatLoad()`.",
    "created_at": "2017-07-17T13:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323836",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:56'></a>Replying to [comment:55 SimonKing]:
> Replying to [comment:54 jdemeyer]:
> > Yes, `except? NULL` is fine. I would still raise a Python exception in this case though.

> 
> If you want an error being raised on `Matrix_gfpn_dense('')`, then I need to re-introduce the test `if not parent` (but then raise an error). Is that OK for you?


But you say that MeatAxe returns `NULL` without exception in this case. So it suffices to check the result of `MatLoad()`.



---

archive/issue_comments_323837.json:
```json
{
    "body": "<a id='comment:57'></a>Replying to [comment:56 jdemeyer]:\n> But you say that MeatAxe returns `NULL` without exception in this case. So it suffices to check the result of `MatLoad()`.\n\n\nFrom my perspective, one could simply return an empty 0x0-matrix over an unspecified field in that special case. But if you prefer an error being raised (`ValueError(\"Received NULL pointer from initialisation of MeatAxe matrix\")`, perhaps?), I can do that.",
    "created_at": "2017-07-17T13:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323837",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:57'></a>Replying to [comment:56 jdemeyer]:
> But you say that MeatAxe returns `NULL` without exception in this case. So it suffices to check the result of `MatLoad()`.


From my perspective, one could simply return an empty 0x0-matrix over an unspecified field in that special case. But if you prefer an error being raised (`ValueError("Received NULL pointer from initialisation of MeatAxe matrix")`, perhaps?), I can do that.



---

archive/issue_comments_323838.json:
```json
{
    "body": "<a id='comment:58'></a>I consider it a bug that `MatLoad(\"\")` returns `NULL` without an error. So we are just working around a MeatAxe bug here...",
    "created_at": "2017-07-17T14:00:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323838",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:58'></a>I consider it a bug that `MatLoad("")` returns `NULL` without an error. So we are just working around a MeatAxe bug here...



---

archive/issue_comments_323839.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-17T14:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323839",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323840.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-17T14:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323840",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323841.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-25T09:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323841",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323842.json:
```json
{
    "body": "<a id='comment:61'></a>As expected, this \"machine dependent\" doctest may fail depending on the machine:\n\n```\n        sage: t = 'Uq\\x82\\x00\\x00\\x00\\x00\\x00\\xa7\\x8bh\\x00\\x00\\x00\\x00\\x00'\n        sage: len(t)\n        16\n        sage: N == mtx_unpickle(MS, 2, 5, t, True)           # optional: meataxe\n```",
    "created_at": "2017-07-25T09:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323842",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:61'></a>As expected, this "machine dependent" doctest may fail depending on the machine:

```
        sage: t = 'Uq\x82\x00\x00\x00\x00\x00\xa7\x8bh\x00\x00\x00\x00\x00'
        sage: len(t)
        16
        sage: N == mtx_unpickle(MS, 2, 5, t, True)           # optional: meataxe
```



---

archive/issue_comments_323843.json:
```json
{
    "body": "<a id='comment:62'></a>On a 32-bit system, this gives:\n\n```\nsage -t --long --warn-long 87.3 src/sage/matrix/matrix_gfpn_dense.pyx\n**********************************************************************\nFile \"src/sage/matrix/matrix_gfpn_dense.pyx\", line 1635, in sage.matrix.matrix_gfpn_dense.mtx_unpickle\nFailed example:\n    N == mtx_unpickle(MS, 2, 5, t, True)           # optional: meataxe\nException raised:\n    Traceback (most recent call last):\n      File \"/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.matrix.matrix_gfpn_dense.mtx_unpickle[18]>\", line 1, in <module>\n        N == mtx_unpickle(MS, Integer(2), Integer(5), t, True)           # optional: meataxe\n      File \"sage/matrix/matrix_gfpn_dense.pyx\", line 1712, in sage.matrix.matrix_gfpn_dense.mtx_unpickle (/home/jdemeyer/sage-git/src/build/cythonized/sage/matrix/matrix_gfpn_dense.c:14936)\n        raise ValueError(f\"Expected a pickle with {FfCurrentRowSizeIo}*{nr} bytes per row, got {lenData} instead\")\n    ValueError: Expected a pickle with 3*2 bytes per row, got 16 instead\n**********************************************************************\n```",
    "created_at": "2017-07-25T09:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323843",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:62'></a>On a 32-bit system, this gives:

```
sage -t --long --warn-long 87.3 src/sage/matrix/matrix_gfpn_dense.pyx
**********************************************************************
File "src/sage/matrix/matrix_gfpn_dense.pyx", line 1635, in sage.matrix.matrix_gfpn_dense.mtx_unpickle
Failed example:
    N == mtx_unpickle(MS, 2, 5, t, True)           # optional: meataxe
Exception raised:
    Traceback (most recent call last):
      File "/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/jdemeyer/sage-git/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.matrix.matrix_gfpn_dense.mtx_unpickle[18]>", line 1, in <module>
        N == mtx_unpickle(MS, Integer(2), Integer(5), t, True)           # optional: meataxe
      File "sage/matrix/matrix_gfpn_dense.pyx", line 1712, in sage.matrix.matrix_gfpn_dense.mtx_unpickle (/home/jdemeyer/sage-git/src/build/cythonized/sage/matrix/matrix_gfpn_dense.c:14936)
        raise ValueError(f"Expected a pickle with {FfCurrentRowSizeIo}*{nr} bytes per row, got {lenData} instead")
    ValueError: Expected a pickle with 3*2 bytes per row, got 16 instead
**********************************************************************
```



---

archive/issue_comments_323844.json:
```json
{
    "body": "<a id='comment:63'></a>Replying to [comment:62 jdemeyer]:\n> On a 32-bit system, this gives:\n> \n> ```\n> sage -t --long --warn-long 87.3 src/sage/matrix/matrix_gfpn_dense.pyx\n> ...\n>     ValueError: Expected a pickle with 3*2 bytes per row, got 16 instead\n> **********************************************************************\n> ```\n\n\nThank you for testing on different architectures!\n\nSo, what shall we do with that test?\n- On the one hand, that test is about a pickling format that is known to be machine dependent and is therefore deprecated. That's an argument for removing it (which I would like to avoid).\n- On the other hand, I could try to do better and make unpickling work in that case as well.\n\nI think I prefer the second way.",
    "created_at": "2017-07-25T12:19:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323844",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:63'></a>Replying to [comment:62 jdemeyer]:
> On a 32-bit system, this gives:
> 
> ```
> sage -t --long --warn-long 87.3 src/sage/matrix/matrix_gfpn_dense.pyx
> ...
>     ValueError: Expected a pickle with 3*2 bytes per row, got 16 instead
> **********************************************************************
> ```


Thank you for testing on different architectures!

So, what shall we do with that test?
- On the one hand, that test is about a pickling format that is known to be machine dependent and is therefore deprecated. That's an argument for removing it (which I would like to avoid).
- On the other hand, I could try to do better and make unpickling work in that case as well.

I think I prefer the second way.



---

archive/issue_comments_323845.json:
```json
{
    "body": "<a id='comment:64'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-25T12:50:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323845",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:64'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323846.json:
```json
{
    "body": "<a id='comment:65'></a>Done! And I demonstrate that a deprecated pickle can be opened even if it was created on a silly machine with `sizeof(long)==9`.",
    "created_at": "2017-07-25T12:52:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323846",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:65'></a>Done! And I demonstrate that a deprecated pickle can be opened even if it was created on a silly machine with `sizeof(long)==9`.



---

archive/issue_comments_323847.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-25T12:52:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323847",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323848.json:
```json
{
    "body": "<a id='comment:66'></a>Cool test! Now, we are still missing a doctest for the `else` case, when `elif pickled_rowsize < FfCurrentRowSizeIo`",
    "created_at": "2017-07-25T14:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323848",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:66'></a>Cool test! Now, we are still missing a doctest for the `else` case, when `elif pickled_rowsize < FfCurrentRowSizeIo`



---

archive/issue_comments_323849.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-25T14:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323849",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_323850.json:
```json
{
    "body": "<a id='comment:67'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-26T11:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323850",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:67'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_323851.json:
```json
{
    "body": "<a id='comment:68'></a>Done!\n\nThere is now one test where the number of bytes is not divisible by the number of rows and one test where the number is divisible but too small to contain a matrix of the given dimensions. Together with the existing tests, I think it covers all code paths.\n\n---\nNew commits:",
    "created_at": "2017-07-26T11:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323851",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:68'></a>Done!

There is now one test where the number of bytes is not divisible by the number of rows and one test where the number is divisible but too small to contain a matrix of the given dimensions. Together with the existing tests, I think it covers all code paths.

---
New commits:



---

archive/issue_comments_323852.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-26T11:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323852",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_323853.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-27T09:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323853",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_323854.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-07-29T15:30:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23411#issuecomment-323854",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_060170.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-07-29T15:30:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23411",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23411#event-60170"
}
```
