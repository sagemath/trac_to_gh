# Issue 23159: Deprecation from #5930 should not use inspect

archive/issues_022922.json:
```json
{
    "body": "In `src/sage/symbolic/ring.pyx`, there is this very unusual code:\n\n```python\n            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):\n                # only warn if _the_element is not dynamic\n                from sage.misc.superseded import deprecation\n                deprecation(5930, \"Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)\")\n```\nThe condition involving `inspect.ismethod` makes no sense to me... it was introduced in #2516.\n\nThe problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods. The easiest fix is to revert this change from #2516 and unconditionally give the deprecation warning.\n\nCC:  @rwst @nbruin @kcrisman @vbraun\n\nBranch/Commit: 44e5284f3a4e8ed10bf0c8d908b9d96401ac9af9\n\nReviewer: Karl-Dieter Crisman, Ralf Stephan\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23159\n\n",
    "closed_at": "2017-06-25T15:45:17Z",
    "created_at": "2017-06-07T13:16:23Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Deprecation from #5930 should not use inspect",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23159",
    "user": "https://github.com/jdemeyer"
}
```
In `src/sage/symbolic/ring.pyx`, there is this very unusual code:

```python
            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):
                # only warn if _the_element is not dynamic
                from sage.misc.superseded import deprecation
                deprecation(5930, "Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)")
```
The condition involving `inspect.ismethod` makes no sense to me... it was introduced in #2516.

The problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods. The easiest fix is to revert this change from #2516 and unconditionally give the deprecation warning.

CC:  @rwst @nbruin @kcrisman @vbraun

Branch/Commit: 44e5284f3a4e8ed10bf0c8d908b9d96401ac9af9

Reviewer: Karl-Dieter Crisman, Ralf Stephan

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23159





---

archive/issue_comments_341418.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,7 +6,7 @@\n                 from sage.misc.superseded import deprecation\n                 deprecation(5930, \"Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)\")\n ```\n-It's not clear to me what the intent of the condition involving `inspect.ismethod` is...\n+It's not clear to me what the intent of the condition involving `inspect.ismethod` is... it was introduced in #2516.\n \n The problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods.\n \n``````\n",
    "created_at": "2017-06-07T13:17:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341418",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,7 +6,7 @@
                 from sage.misc.superseded import deprecation
                 deprecation(5930, "Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)")
 ```
-It's not clear to me what the intent of the condition involving `inspect.ismethod` is...
+It's not clear to me what the intent of the condition involving `inspect.ismethod` is... it was introduced in #2516.
 
 The problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods.
 
``````




---

archive/issue_comments_341419.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+In `src/sage/symbolic/ring.pyx`, there is this very unusual code:\n \n+```python\n+            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):\n+                # only warn if _the_element is not dynamic\n+                from sage.misc.superseded import deprecation\n+                deprecation(5930, \"Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)\")\n+```\n+It's not clear to me what the intent of the condition involving `inspect.ismethod` is... it was introduced in #2516.\n+\n+The problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods. The easiest fix is to revert this change from #2516 and unconditionally give the deprecation warning.\n \n Comment: 1\n \n``````\n",
    "created_at": "2017-06-07T13:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341419",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
+In `src/sage/symbolic/ring.pyx`, there is this very unusual code:
 
+```python
+            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):
+                # only warn if _the_element is not dynamic
+                from sage.misc.superseded import deprecation
+                deprecation(5930, "Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)")
+```
+It's not clear to me what the intent of the condition involving `inspect.ismethod` is... it was introduced in #2516.
+
+The problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods. The easiest fix is to revert this change from #2516 and unconditionally give the deprecation warning.
 
 Comment: 1
 
``````




---

archive/issue_comments_341420.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-07T13:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341420",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_341421.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2017-06-07T13:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341421",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_comments_341422.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+In `src/sage/symbolic/ring.pyx`, there is this very unusual code:\n \n+```python\n+            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):\n+                # only warn if _the_element is not dynamic\n+                from sage.misc.superseded import deprecation\n+                deprecation(5930, \"Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)\")\n+```\n+The condition involving `inspect.ismethod` makes no sense to me... it was introduced in #2516.\n+\n+The problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods. The easiest fix is to revert this change from #2516 and unconditionally give the deprecation warning.\n \n Comment: 1\n \n``````\n",
    "created_at": "2017-06-21T12:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341422",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,14 @@
+In `src/sage/symbolic/ring.pyx`, there is this very unusual code:
 
+```python
+            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):
+                # only warn if _the_element is not dynamic
+                from sage.misc.superseded import deprecation
+                deprecation(5930, "Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)")
+```
+The condition involving `inspect.ismethod` makes no sense to me... it was introduced in #2516.
+
+The problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods. The easiest fix is to revert this change from #2516 and unconditionally give the deprecation warning.
 
 Comment: 1
 
``````




---

archive/issue_comments_341423.json:
```json
{
    "body": "<a id='comment:6'></a>I don't have a problem with this solution and the doctests seem to be correct.  But see [comment:32:ticket:2516 here] for the exact place rws resolved this (with discussion in the 5-10 comments preceding that one).  [comment:43:ticket:2516 This comment] and [comment:44:ticket:2516 this one] have further discussion about exact implementation and/or reasons - `fast_callable` is something I never properly understood, unfortunately.\n\nOn a separate note, the cleanups for the hypergeometric plots are nice ... but why use `SR.var()` instead of just `var()`?  I presume this is to avoid injecting something but I don't want to have to teach people to use `SR.var('y')` when the current variant is annoying enough.",
    "created_at": "2017-06-21T12:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341423",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>I don't have a problem with this solution and the doctests seem to be correct.  But see [comment:32:ticket:2516 here] for the exact place rws resolved this (with discussion in the 5-10 comments preceding that one).  [comment:43:ticket:2516 This comment] and [comment:44:ticket:2516 this one] have further discussion about exact implementation and/or reasons - `fast_callable` is something I never properly understood, unfortunately.

On a separate note, the cleanups for the hypergeometric plots are nice ... but why use `SR.var()` instead of just `var()`?  I presume this is to avoid injecting something but I don't want to have to teach people to use `SR.var('y')` when the current variant is annoying enough.



---

archive/issue_comments_341424.json:
```json
{
    "body": "<a id='comment:7'></a>I'm ok with the deletion. Using inspect was ad-hoc anyway.",
    "created_at": "2017-06-21T14:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341424",
    "user": "https://github.com/rwst"
}
```

<a id='comment:7'></a>I'm ok with the deletion. Using inspect was ad-hoc anyway.



---

archive/issue_comments_341425.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:6 kcrisman]:\n> why use `SR.var()` instead of just `var()`?\n\n\nWell, `z = var('z')` is a bit confusing since it first injects `z` in the global namespace and then assigns it again to the variable `z`. So either we change it to\n\n```\nsage: var('z')\nz\n```\nor\n\n```\nsage: z = SR.var('z')\n```\n\nAnyway, this is minor aspect of the patch which I will gladly revert.",
    "created_at": "2017-06-21T14:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341425",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Replying to [comment:6 kcrisman]:
> why use `SR.var()` instead of just `var()`?


Well, `z = var('z')` is a bit confusing since it first injects `z` in the global namespace and then assigns it again to the variable `z`. So either we change it to

```
sage: var('z')
z
```
or

```
sage: z = SR.var('z')
```

Anyway, this is minor aspect of the patch which I will gladly revert.



---

archive/issue_comments_341426.json:
```json
{
    "body": "<a id='comment:9'></a>> Well, `z = var('z')` is a bit confusing since it first injects `z` in the global namespace and then assigns it again to the variable `z`. So either we change it to\n> \n> ```\n> sage: var('z')\n> z\n> ```\n\n\nThis is one of the ways we have had it in the documentation, I think, but I guess somewhere along the line people wanted to not have an output line.  But I guess I prefer this to the `SR.var` since it is more likely to look like something a reader has seen before.  Definitely do like the making the hg function and plot in two separate lines, makes them much easier to read!",
    "created_at": "2017-06-21T15:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341426",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>> Well, `z = var('z')` is a bit confusing since it first injects `z` in the global namespace and then assigns it again to the variable `z`. So either we change it to
> 
> ```
> sage: var('z')
> z
> ```


This is one of the ways we have had it in the documentation, I think, but I guess somewhere along the line people wanted to not have an output line.  But I guess I prefer this to the `SR.var` since it is more likely to look like something a reader has seen before.  Definitely do like the making the hg function and plot in two separate lines, makes them much easier to read!



---

archive/issue_comments_341427.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 kcrisman]:\n> This is one of the ways we have had it in the documentation, I think, but I guess somewhere along the line people wanted to not have an output line.\n\n\nThere is also sporadically `_ = var(...)` in the documentation.",
    "created_at": "2017-06-22T05:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341427",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>Replying to [comment:9 kcrisman]:
> This is one of the ways we have had it in the documentation, I think, but I guess somewhere along the line people wanted to not have an output line.


There is also sporadically `_ = var(...)` in the documentation.



---

archive/issue_comments_341428.json:
```json
{
    "body": "<a id='comment:11'></a>So what should I do?\n\n`@`krisman: do you agree with setting this ticket to positive_review after I change the doctests of the form\n\n```\nsage: z = SR.var('z')\n```\nto\n\n```\nsage: var('z')\nz\n```",
    "created_at": "2017-06-22T08:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341428",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>So what should I do?

`@`krisman: do you agree with setting this ticket to positive_review after I change the doctests of the form

```
sage: z = SR.var('z')
```
to

```
sage: var('z')
z
```



---

archive/issue_comments_341429.json:
```json
{
    "body": "<a id='comment:12'></a>I do not have time to actually run doctests on this but the patchbot says all clear, and it sounds like none of us have a problem with this change, and your doctest change will be helpful in that spirit.  So I guess so?",
    "created_at": "2017-06-22T13:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341429",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>I do not have time to actually run doctests on this but the patchbot says all clear, and it sounds like none of us have a problem with this change, and your doctest change will be helpful in that spirit.  So I guess so?



---

archive/issue_comments_341430.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-22T14:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341430",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_341431.json:
```json
{
    "body": "<a id='comment:14'></a>That seems fine.",
    "created_at": "2017-06-22T16:15:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341431",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:14'></a>That seems fine.



---

archive/issue_comments_341432.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-22T18:03:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341432",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_059841.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-25T15:45:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23159#event-59841"
}
```



---

archive/issue_comments_341433.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-25T15:45:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23159#issuecomment-341433",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
