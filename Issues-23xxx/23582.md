# Issue 23582: Robustify doctest in hyperbolic_geodesic.py

archive/issues_023345.json:
```json
{
    "body": "A doctest of the `midpoint` code in `geometry/hyperbolic_space/hyperbolic_geodesic.py` relies on exact reproduction of complicated symbolic expressions involving square roots. With recent changes in Pynac the representation of the result no longer matches, although it is mathematically identical.\n\nThe ticket changes the doctest to match results numerically.\n\n\n**Branch:** [u/rws/robustify_doctest_in_hyperbolic_geodesic_py](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/robustify_doctest_in_hyperbolic_geodesic_py)\n\n**Commit:** [a90ce6a6d5eaf6f984dc863afb70c72de47e0a64](https://github.com/sagemath/sagetrac-mirror/commit/a90ce6a6d5eaf6f984dc863afb70c72de47e0a64)\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Ralf Stephan\n\nIssue created by migration from https://trac.sagemath.org/ticket/23582\n\n",
    "closed_at": "2017-12-12T08:23:33Z",
    "created_at": "2017-08-05T07:07:48Z",
    "labels": [
        "component: geometry",
        "enhancement",
        "wontfix"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Robustify doctest in hyperbolic_geodesic.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23582",
    "user": "https://github.com/rwst"
}
```
A doctest of the `midpoint` code in `geometry/hyperbolic_space/hyperbolic_geodesic.py` relies on exact reproduction of complicated symbolic expressions involving square roots. With recent changes in Pynac the representation of the result no longer matches, although it is mathematically identical.

The ticket changes the doctest to match results numerically.


**Branch:** [u/rws/robustify_doctest_in_hyperbolic_geodesic_py](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/robustify_doctest_in_hyperbolic_geodesic_py)

**Commit:** [a90ce6a6d5eaf6f984dc863afb70c72de47e0a64](https://github.com/sagemath/sagetrac-mirror/commit/a90ce6a6d5eaf6f984dc863afb70c72de47e0a64)

**Reviewer:** Frédéric Chapoton

**Author:** Ralf Stephan

Issue created by migration from https://trac.sagemath.org/ticket/23582





---

archive/issue_comments_424460.json:
```json
{
    "body": "**Branch:** [u/rws/robustify_doctest_in_hyperbolic_geodesic_py](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/robustify_doctest_in_hyperbolic_geodesic_py)",
    "created_at": "2017-08-05T07:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424460",
    "user": "https://github.com/rwst"
}
```

**Branch:** [u/rws/robustify_doctest_in_hyperbolic_geodesic_py](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/robustify_doctest_in_hyperbolic_geodesic_py)



---

archive/issue_comments_424461.json:
```json
{
    "body": "**Author:** Ralf Stephan",
    "created_at": "2017-08-05T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424461",
    "user": "https://github.com/rwst"
}
```

**Author:** Ralf Stephan



---

archive/issue_comments_424462.json:
```json
{
    "body": "**Commit:** [a90ce6a6d5eaf6f984dc863afb70c72de47e0a64](https://github.com/sagemath/sagetrac-mirror/commit/a90ce6a6d5eaf6f984dc863afb70c72de47e0a64)",
    "created_at": "2017-08-05T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424462",
    "user": "https://github.com/rwst"
}
```

**Commit:** [a90ce6a6d5eaf6f984dc863afb70c72de47e0a64](https://github.com/sagemath/sagetrac-mirror/commit/a90ce6a6d5eaf6f984dc863afb70c72de47e0a64)



---

archive/issue_comments_424463.json:
```json
{
    "body": "<a id='comment:2'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a90ce6a6d5eaf6f984dc863afb70c72de47e0a64\">a90ce6a</a></td><td><code>23582: Robustify doctest in hyperbolic_geodesic.py</code></td></tr></table>\n",
    "created_at": "2017-08-05T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424463",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a90ce6a6d5eaf6f984dc863afb70c72de47e0a64">a90ce6a</a></td><td><code>23582: Robustify doctest in hyperbolic_geodesic.py</code></td></tr></table>




---

archive/issue_comments_424464.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2017-08-05T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424464",
    "user": "https://github.com/rwst"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_424465.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2017-08-05T17:02:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424465",
    "user": "https://github.com/fchapoton"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_424466.json:
```json
{
    "body": "<a id='comment:3'></a>\nok, looks good",
    "created_at": "2017-08-05T17:02:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424466",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
ok, looks good



---

archive/issue_comments_424467.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2017-08-05T17:02:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424467",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_424468.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'm not completely sure about this. If it is mathematically identical, why not simply change the doctest with the new version of pynac? Should then all (sufficiently complicated) symbolic expressions output not be used for doctests? IMO, this makes the doctest less likely to catch errors and feels like a tiny step backwards in that regard.",
    "created_at": "2017-08-09T14:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424468",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
I'm not completely sure about this. If it is mathematically identical, why not simply change the doctest with the new version of pynac? Should then all (sufficiently complicated) symbolic expressions output not be used for doctests? IMO, this makes the doctest less likely to catch errors and feels like a tiny step backwards in that regard.



---

archive/issue_comments_424469.json:
```json
{
    "body": "**Changing status** from positive_review to needs_info.",
    "created_at": "2017-08-09T14:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424469",
    "user": "https://github.com/tscrim"
}
```

**Changing status** from positive_review to needs_info.



---

archive/issue_events_068995.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-08-10T06:51:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23582#event-68995"
}
```



---

archive/issue_comments_424470.json:
```json
{
    "body": "**Changing status** from needs_info to positive_review.",
    "created_at": "2017-08-10T06:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424470",
    "user": "https://github.com/rwst"
}
```

**Changing status** from needs_info to positive_review.



---

archive/issue_comments_424471.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe change is no longer necessary because the mentioned change in Pynac didn't happen. I agree to make the ticket invalid.\n\nHowever, let me point out that it is highly unlikely that a symbolic error would pass such a numeric test. Note that such numeric tests additionally test the FP evaluation code so it's more likely to catch bugs.",
    "created_at": "2017-08-10T06:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-424471",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>
The change is no longer necessary because the mentioned change in Pynac didn't happen. I agree to make the ticket invalid.

However, let me point out that it is highly unlikely that a symbolic error would pass such a numeric test. Note that such numeric tests additionally test the FP evaluation code so it's more likely to catch bugs.



---

archive/issue_events_068996.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23582#event-68996"
}
```
