# Issue 23582: Robustify doctest in hyperbolic_geodesic.py

archive/issues_023345.json:
```json
{
    "body": "A doctest of the `midpoint` code in `geometry/hyperbolic_space/hyperbolic_geodesic.py` relies on exact reproduction of complicated symbolic expressions involving square roots. With recent changes in Pynac the representation of the result no longer matches, although it is mathematically identical.\n\nThe ticket changes the doctest to match results numerically.\n\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Ralf Stephan\n\nBranch: u/rws/robustify_doctest_in_hyperbolic_geodesic_py\n\nCommit: a90ce6a6d5eaf6f984dc863afb70c72de47e0a64\n\nResolution: wontfix\n\nIssue created by migration from https://trac.sagemath.org/ticket/23582\n\n",
    "closed_at": "2017-12-12T08:23:33Z",
    "created_at": "2017-08-05T07:07:48Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Robustify doctest in hyperbolic_geodesic.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23582",
    "user": "https://github.com/rwst"
}
```
A doctest of the `midpoint` code in `geometry/hyperbolic_space/hyperbolic_geodesic.py` relies on exact reproduction of complicated symbolic expressions involving square roots. With recent changes in Pynac the representation of the result no longer matches, although it is mathematically identical.

The ticket changes the doctest to match results numerically.


Reviewer: Frédéric Chapoton

Author: Ralf Stephan

Branch: u/rws/robustify_doctest_in_hyperbolic_geodesic_py

Commit: a90ce6a6d5eaf6f984dc863afb70c72de47e0a64

Resolution: wontfix

Issue created by migration from https://trac.sagemath.org/ticket/23582





---

archive/issue_comments_438354.json:
```json
{
    "body": "Changing branch from \"\" to \"u/rws/robustify_doctest_in_hyperbolic_geodesic_py\"",
    "created_at": "2017-08-05T07:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438354",
    "user": "https://github.com/rwst"
}
```

Changing branch from "" to "u/rws/robustify_doctest_in_hyperbolic_geodesic_py"



---

archive/issue_comments_438355.json:
```json
{
    "body": "Changing author from \"\" to \"Ralf Stephan\"",
    "created_at": "2017-08-05T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438355",
    "user": "https://github.com/rwst"
}
```

Changing author from "" to "Ralf Stephan"



---

archive/issue_comments_438356.json:
```json
{
    "body": "Changing commit from \"\" to \"a90ce6a6d5eaf6f984dc863afb70c72de47e0a64\"",
    "created_at": "2017-08-05T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438356",
    "user": "https://github.com/rwst"
}
```

Changing commit from "" to "a90ce6a6d5eaf6f984dc863afb70c72de47e0a64"



---

archive/issue_comments_438357.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[a90ce6a](https://github.com/sagemath/sagetrac-mirror/commit/a90ce6a6d5eaf6f984dc863afb70c72de47e0a64)|`23582: Robustify doctest in hyperbolic_geodesic.py`|",
    "created_at": "2017-08-05T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438357",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[a90ce6a](https://github.com/sagemath/sagetrac-mirror/commit/a90ce6a6d5eaf6f984dc863afb70c72de47e0a64)|`23582: Robustify doctest in hyperbolic_geodesic.py`|



---

archive/issue_comments_438358.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-05T07:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438358",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_438359.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2017-08-05T17:02:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438359",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Frédéric Chapoton"



---

archive/issue_comments_438360.json:
```json
{
    "body": "<a id='comment:3'></a>\nok, looks good",
    "created_at": "2017-08-05T17:02:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438360",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
ok, looks good



---

archive/issue_comments_438361.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-05T17:02:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438361",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_438362.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'm not completely sure about this. If it is mathematically identical, why not simply change the doctest with the new version of pynac? Should then all (sufficiently complicated) symbolic expressions output not be used for doctests? IMO, this makes the doctest less likely to catch errors and feels like a tiny step backwards in that regard.",
    "created_at": "2017-08-09T14:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438362",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>
I'm not completely sure about this. If it is mathematically identical, why not simply change the doctest with the new version of pynac? Should then all (sufficiently complicated) symbolic expressions output not be used for doctests? IMO, this makes the doctest less likely to catch errors and feels like a tiny step backwards in that regard.



---

archive/issue_comments_438363.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2017-08-09T14:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438363",
    "user": "https://github.com/tscrim"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_events_076531.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-08-10T06:51:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23582#event-76531"
}
```



---

archive/issue_comments_438364.json:
```json
{
    "body": "Changing status from needs_info to positive_review.",
    "created_at": "2017-08-10T06:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438364",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_info to positive_review.



---

archive/issue_comments_438365.json:
```json
{
    "body": "<a id='comment:5'></a>\nThe change is no longer necessary because the mentioned change in Pynac didn't happen. I agree to make the ticket invalid.\n\nHowever, let me point out that it is highly unlikely that a symbolic error would pass such a numeric test. Note that such numeric tests additionally test the FP evaluation code so it's more likely to catch bugs.",
    "created_at": "2017-08-10T06:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438365",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>
The change is no longer necessary because the mentioned change in Pynac didn't happen. I agree to make the ticket invalid.

However, let me point out that it is highly unlikely that a symbolic error would pass such a numeric test. Note that such numeric tests additionally test the FP evaluation code so it's more likely to catch bugs.



---

archive/issue_comments_438366.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2017-12-12T08:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23582#issuecomment-438366",
    "user": "https://github.com/embray"
}
```

Resolution: wontfix



---

archive/issue_events_076532.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2017-12-12T08:23:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23582",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23582#event-76532"
}
```
