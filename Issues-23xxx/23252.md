# Issue 23252: Implement coercions in the category framework

archive/issues_023015.json:
```json
{
    "body": "Currently there is no way to implement coercions using categories because of the default implementation of `Parent._coerce_map_from_`. We currently have two proposals for how to do these.\n\n1) Use the normal hook `_coerce_map_from_` with a requirement to the effect of all classes must make a supercall up if not handled. Naturally calling successive `super._coerce_map_from_` is feasible and fits to an extent within the current coercion framework, but there are technical limitations with doing this in Python 2 within the category classes.\n\n2) Implement a coercion hook in the relevant `ConstructionFunctor` (subclasses) with an additional check of this hook in the coercion discovery. This would better reflect the mathematics as the new morphisms usually come from applying the functor to a morphism.\n\nSee the discussion on #18700.\n\nCC:  jpflori\n\nBranch: public/categories/coerce_map_from-23252\n\nStatus: new\n\nCommit: f06ce84b62a1e24f0d970dec2fba3147bcb89574\n\nIssue created by migration from https://trac.sagemath.org/ticket/23252\n\n",
    "created_at": "2017-06-16T02:40:58Z",
    "labels": [
        "component: coercion"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Implement coercions in the category framework",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23252",
    "user": "https://github.com/tscrim"
}
```
Currently there is no way to implement coercions using categories because of the default implementation of `Parent._coerce_map_from_`. We currently have two proposals for how to do these.

1) Use the normal hook `_coerce_map_from_` with a requirement to the effect of all classes must make a supercall up if not handled. Naturally calling successive `super._coerce_map_from_` is feasible and fits to an extent within the current coercion framework, but there are technical limitations with doing this in Python 2 within the category classes.

2) Implement a coercion hook in the relevant `ConstructionFunctor` (subclasses) with an additional check of this hook in the coercion discovery. This would better reflect the mathematics as the new morphisms usually come from applying the functor to a morphism.

See the discussion on #18700.

CC:  jpflori

Branch: public/categories/coerce_map_from-23252

Status: new

Commit: f06ce84b62a1e24f0d970dec2fba3147bcb89574

Issue created by migration from https://trac.sagemath.org/ticket/23252





---

archive/issue_comments_342779.json:
```json
{
    "body": "<a id='comment:1'></a>Branch with previous work from Nicolas on #18700. It will probably have a merge conflict with #18700, but I did that so my revert commit will not get applied.\n\n---\nLast 10 new commits:",
    "created_at": "2017-06-16T02:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23252#issuecomment-342779",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>Branch with previous work from Nicolas on #18700. It will probably have a merge conflict with #18700, but I did that so my revert commit will not get applied.

---
Last 10 new commits:



---

archive/issue_comments_342780.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n-Currently there is no way to implement coercions using categories because of the default implementation of `Parent._coerce_map_from_`. However, naturally calling successive `super._coerce_map_from_` is feasible, but there are technical limitations with doing this in Python 2. Another approach would be to implement a coercion hook in the relevant `ConstructionFunctor`, which would better reflect the mathematics.\n+Currently there is no way to implement coercions using categories because of the default implementation of `Parent._coerce_map_from_`. We currently have two proposals for how to do these.\n+\n+1) Use the normal hook `_coerce_map_from_` with a requirement to the effect of all classes must make a supercall up if not handled. Naturally calling successive `super._coerce_map_from_` is feasible and fits to an extent within the current coercion framework, but there are technical limitations with doing this in Python 2 within the category classes.\n+\n+2) Implement a coercion hook in the relevant `ConstructionFunctor` (subclasses) with an additional check of this hook in the coercion discovery. This would better reflect the mathematics as the new morphisms usually come from applying the functor to a morphism.\n+\n+See the discussion on #18700.\n \n Comment: 1\n \n```\n",
    "created_at": "2017-06-16T13:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23252#issuecomment-342780",
    "user": "https://github.com/tscrim"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,10 @@
-Currently there is no way to implement coercions using categories because of the default implementation of `Parent._coerce_map_from_`. However, naturally calling successive `super._coerce_map_from_` is feasible, but there are technical limitations with doing this in Python 2. Another approach would be to implement a coercion hook in the relevant `ConstructionFunctor`, which would better reflect the mathematics.
+Currently there is no way to implement coercions using categories because of the default implementation of `Parent._coerce_map_from_`. We currently have two proposals for how to do these.
+
+1) Use the normal hook `_coerce_map_from_` with a requirement to the effect of all classes must make a supercall up if not handled. Naturally calling successive `super._coerce_map_from_` is feasible and fits to an extent within the current coercion framework, but there are technical limitations with doing this in Python 2 within the category classes.
+
+2) Implement a coercion hook in the relevant `ConstructionFunctor` (subclasses) with an additional check of this hook in the coercion discovery. This would better reflect the mathematics as the new morphisms usually come from applying the functor to a morphism.
+
+See the discussion on #18700.
 
 Comment: 1
 
```




---

archive/issue_comments_342781.json:
```json
{
    "body": "<a id='comment:4'></a>What is this ticket about? It's hard to understand from the ticket description...",
    "created_at": "2017-06-18T21:49:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23252",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23252#issuecomment-342781",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>What is this ticket about? It's hard to understand from the ticket description...
