# Issue 23508: Improvements for p-adic polynomials

archive/issues_023271.json:
```json
{
    "body": "Add various methods to polynomial_padic.py for invariant computations and Monge reduction and update factor() to use OMTree from #12561 for factoring polynomials over p-adic extensions.\n\nIn all, this makes large changes to factor() and adds methods:\n- is_eisenstein\n- normalized (For use in factoring)\n- omtree\n- ramification_polynomial\n- ramification_polygon\n- ramification_polygon_with_colinear_points (used for residual polynomials)\n- hasse_herbrand (Evaluate n times Hasse-Herbrand at integers)\n- residual_polynomials (of the ramification polygon)\n- residual_polynomial_of_component (Monge's S_m)\n- has_residual_polynomial_class (Test whether another polynomial is in the same invariant class)\n- monge_reduce\n\nCC:  @pjbruin\n\nKeywords: sd87\n\nBranch: [u/roed/ticket/23508](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ticket/23508)\n\nCommit: [ed869783d20fd85dd5b1fc53c954ea177265475a](https://github.com/sagemath/sagetrac-mirror/commit/ed869783d20fd85dd5b1fc53c954ea177265475a)\n\nAuthor: Sebastian Pauli, Brian Sinclair\n\nStatus: new\n\nDependencies: #12561, #23471, #23510\n\nIssue created by migration from https://trac.sagemath.org/ticket/23508\n\n",
    "created_at": "2017-07-21T17:34:59Z",
    "labels": [
        "component: padics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Improvements for p-adic polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23508",
    "user": "https://trac.sagemath.org/admin/accounts/users/bsinclai"
}
```
Add various methods to polynomial_padic.py for invariant computations and Monge reduction and update factor() to use OMTree from #12561 for factoring polynomials over p-adic extensions.

In all, this makes large changes to factor() and adds methods:
- is_eisenstein
- normalized (For use in factoring)
- omtree
- ramification_polynomial
- ramification_polygon
- ramification_polygon_with_colinear_points (used for residual polynomials)
- hasse_herbrand (Evaluate n times Hasse-Herbrand at integers)
- residual_polynomials (of the ramification polygon)
- residual_polynomial_of_component (Monge's S_m)
- has_residual_polynomial_class (Test whether another polynomial is in the same invariant class)
- monge_reduce

CC:  @pjbruin

Keywords: sd87

Branch: [u/roed/ticket/23508](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ticket/23508)

Commit: [ed869783d20fd85dd5b1fc53c954ea177265475a](https://github.com/sagemath/sagetrac-mirror/commit/ed869783d20fd85dd5b1fc53c954ea177265475a)

Author: Sebastian Pauli, Brian Sinclair

Status: new

Dependencies: #12561, #23471, #23510

Issue created by migration from https://trac.sagemath.org/ticket/23508





---

archive/issue_comments_444847.json:
```json
{
    "body": "Changing dependencies from \"#12561, #23471\" to \"#12561, #23471, #23510\"",
    "created_at": "2017-07-21T18:41:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444847",
    "user": "https://trac.sagemath.org/admin/accounts/users/bsinclai"
}
```

Changing dependencies from "#12561, #23471" to "#12561, #23471, #23510"



---

archive/issue_comments_444848.json:
```json
{
    "body": "<a id='comment:2'></a>\nFactoring over unramified extension does not work currently (See #23510).  The following doctest shows this.\n\nWe run into `R.fraction_field() is self` occurring in `_coerce_map_from_(self, R)` in padic_extension_generic.pyc when we attempt to `change_ring()` our polynomial in `_factor_non_monic()` to increase precision cap. \n\n```\nR.<c> = Zq(125, prec = 500)\nRz.<z>=R[]\ng = 25*z^15 + 5\nFg = g.factor()\n```",
    "created_at": "2017-07-21T19:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444848",
    "user": "https://trac.sagemath.org/admin/accounts/users/bsinclai"
}
```

<a id='comment:2'></a>
Factoring over unramified extension does not work currently (See #23510).  The following doctest shows this.

We run into `R.fraction_field() is self` occurring in `_coerce_map_from_(self, R)` in padic_extension_generic.pyc when we attempt to `change_ring()` our polynomial in `_factor_non_monic()` to increase precision cap. 

```
R.<c> = Zq(125, prec = 500)
Rz.<z>=R[]
g = 25*z^15 + 5
Fg = g.factor()
```



---

archive/issue_comments_444849.json:
```json
{
    "body": "Changing commit from \"\" to \"d4bfddbc1c1976dfc292ec15ecf05623c89f327e\"",
    "created_at": "2017-07-21T19:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444849",
    "user": "https://trac.sagemath.org/admin/accounts/users/bsinclai"
}
```

Changing commit from "" to "d4bfddbc1c1976dfc292ec15ecf05623c89f327e"



---

archive/issue_comments_444850.json:
```json
{
    "body": "Changing branch from \"\" to \"u/bsinclai/ticket/23508\"",
    "created_at": "2017-07-21T19:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444850",
    "user": "https://trac.sagemath.org/admin/accounts/users/bsinclai"
}
```

Changing branch from "" to "u/bsinclai/ticket/23508"



---

archive/issue_comments_444851.json:
```json
{
    "body": "Changing commit from \"d4bfddbc1c1976dfc292ec15ecf05623c89f327e\" to \"9cfb8281e8bfb2145c95c0d24d95d25af8c1ee33\"",
    "created_at": "2017-07-22T04:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444851",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d4bfddbc1c1976dfc292ec15ecf05623c89f327e" to "9cfb8281e8bfb2145c95c0d24d95d25af8c1ee33"



---

archive/issue_comments_444852.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|\n|[7926b41](https://github.com/sagemath/sagetrac-mirror/commit/7926b41de6ec7eb654ae7dfcb4599b62f131f85f)|`Moving code for fraction_field and integer_ring, and enabling fraction fields for fixed-mod`|\n|[7d74ce5](https://github.com/sagemath/sagetrac-mirror/commit/7d74ce57b6c1885263302aa05f9821aca089a1e4)|`Merge branch 'u/roed/fixed_mod_frac_field' of git://trac.sagemath.org/sage into develop`|\n|[9cfb828](https://github.com/sagemath/sagetrac-mirror/commit/9cfb8281e8bfb2145c95c0d24d95d25af8c1ee33)|`Fixed monge_reduce()`|",
    "created_at": "2017-07-22T04:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444852",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|
|[7926b41](https://github.com/sagemath/sagetrac-mirror/commit/7926b41de6ec7eb654ae7dfcb4599b62f131f85f)|`Moving code for fraction_field and integer_ring, and enabling fraction fields for fixed-mod`|
|[7d74ce5](https://github.com/sagemath/sagetrac-mirror/commit/7d74ce57b6c1885263302aa05f9821aca089a1e4)|`Merge branch 'u/roed/fixed_mod_frac_field' of git://trac.sagemath.org/sage into develop`|
|[9cfb828](https://github.com/sagemath/sagetrac-mirror/commit/9cfb8281e8bfb2145c95c0d24d95d25af8c1ee33)|`Fixed monge_reduce()`|



---

archive/issue_comments_444853.json:
```json
{
    "body": "Changing branch from \"u/bsinclai/ticket/23508\" to \"u/roed/ticket/23508\"",
    "created_at": "2017-08-21T05:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444853",
    "user": "https://github.com/roed314"
}
```

Changing branch from "u/bsinclai/ticket/23508" to "u/roed/ticket/23508"



---

archive/issue_comments_444854.json:
```json
{
    "body": "Changing commit from \"9cfb8281e8bfb2145c95c0d24d95d25af8c1ee33\" to \"ed869783d20fd85dd5b1fc53c954ea177265475a\"",
    "created_at": "2018-11-09T14:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444854",
    "user": "https://github.com/pjbruin"
}
```

Changing commit from "9cfb8281e8bfb2145c95c0d24d95d25af8c1ee33" to "ed869783d20fd85dd5b1fc53c954ea177265475a"



---

archive/issue_comments_444855.json:
```json
{
    "body": "<a id='comment:5'></a>\nNew commits:\n|                                                                                                                                          |                                                                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|\n|[c8a3261](https://github.com/sagemath/sagetrac-mirror/commit/c8a3261bb44bb0722761e04a0840cf2ec4b03316)|`Merge branch 'u/bsinclai/ticket/12561' of git://trac.sagemath.org/sage into t/12561/om_tree`|\n|[ed86978](https://github.com/sagemath/sagetrac-mirror/commit/ed869783d20fd85dd5b1fc53c954ea177265475a)|`Merge branch 'u/bsinclai/ticket/23508' of git://trac.sagemath.org/sage into t/23508/padic_polynomial_improvements`|",
    "created_at": "2018-11-09T14:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-444855",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:5'></a>
New commits:
|                                                                                                                                          |                                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|
|[c8a3261](https://github.com/sagemath/sagetrac-mirror/commit/c8a3261bb44bb0722761e04a0840cf2ec4b03316)|`Merge branch 'u/bsinclai/ticket/12561' of git://trac.sagemath.org/sage into t/12561/om_tree`|
|[ed86978](https://github.com/sagemath/sagetrac-mirror/commit/ed869783d20fd85dd5b1fc53c954ea177265475a)|`Merge branch 'u/bsinclai/ticket/23508' of git://trac.sagemath.org/sage into t/23508/padic_polynomial_improvements`|
