# Issue 23508: Improvements for p-adic polynomials

archive/issues_023271.json:
```json
{
    "body": "Add various methods to polynomial_padic.py for invariant computations and Monge reduction and update factor() to use OMTree from #12561 for factoring polynomials over p-adic extensions.\n\nIn all, this makes large changes to factor() and adds methods:\n- is_eisenstein\n- normalized (For use in factoring)\n- omtree\n- ramification_polynomial\n- ramification_polygon\n- ramification_polygon_with_colinear_points (used for residual polynomials)\n- hasse_herbrand (Evaluate n times Hasse-Herbrand at integers)\n- residual_polynomials (of the ramification polygon)\n- residual_polynomial_of_component (Monge's S_m)\n- has_residual_polynomial_class (Test whether another polynomial is in the same invariant class)\n- monge_reduce\n\nCC:  @pjbruin\n\nKeywords: sd87\n\nAuthor: Sebastian Pauli, Brian Sinclair\n\nBranch: u/roed/ticket/23508\n\nStatus: new\n\nDependencies: #12561, #23471, #23510\n\nCommit: ed869783d20fd85dd5b1fc53c954ea177265475a\n\nIssue created by migration from https://trac.sagemath.org/ticket/23508\n\n",
    "created_at": "2017-07-21T17:34:59Z",
    "labels": [
        "component: padics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Improvements for p-adic polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23508",
    "user": "https://trac.sagemath.org/admin/accounts/users/bsinclai"
}
```
Add various methods to polynomial_padic.py for invariant computations and Monge reduction and update factor() to use OMTree from #12561 for factoring polynomials over p-adic extensions.

In all, this makes large changes to factor() and adds methods:
- is_eisenstein
- normalized (For use in factoring)
- omtree
- ramification_polynomial
- ramification_polygon
- ramification_polygon_with_colinear_points (used for residual polynomials)
- hasse_herbrand (Evaluate n times Hasse-Herbrand at integers)
- residual_polynomials (of the ramification polygon)
- residual_polynomial_of_component (Monge's S_m)
- has_residual_polynomial_class (Test whether another polynomial is in the same invariant class)
- monge_reduce

CC:  @pjbruin

Keywords: sd87

Author: Sebastian Pauli, Brian Sinclair

Branch: u/roed/ticket/23508

Status: new

Dependencies: #12561, #23471, #23510

Commit: ed869783d20fd85dd5b1fc53c954ea177265475a

Issue created by migration from https://trac.sagemath.org/ticket/23508





---

archive/issue_comments_346671.json:
```json
{
    "body": "<a id='comment:2'></a>Factoring over unramified extension does not work currently (See #23510).  The following doctest shows this.\n\nWe run into `R.fraction_field() is self` occurring in `_coerce_map_from_(self, R)` in padic_extension_generic.pyc when we attempt to `change_ring()` our polynomial in `_factor_non_monic()` to increase precision cap. \n\n```\nR.<c> = Zq(125, prec = 500)\nRz.<z>=R[]\ng = 25*z^15 + 5\nFg = g.factor()\n```",
    "created_at": "2017-07-21T19:11:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-346671",
    "user": "https://trac.sagemath.org/admin/accounts/users/bsinclai"
}
```

<a id='comment:2'></a>Factoring over unramified extension does not work currently (See #23510).  The following doctest shows this.

We run into `R.fraction_field() is self` occurring in `_coerce_map_from_(self, R)` in padic_extension_generic.pyc when we attempt to `change_ring()` our polynomial in `_factor_non_monic()` to increase precision cap. 

```
R.<c> = Zq(125, prec = 500)
Rz.<z>=R[]
g = 25*z^15 + 5
Fg = g.factor()
```



---

archive/issue_comments_346672.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-22T04:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-346672",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_346673.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2018-11-09T14:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23508",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23508#issuecomment-346673",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:5'></a>New commits:
