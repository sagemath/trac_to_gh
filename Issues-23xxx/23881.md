# Issue 23881: Remove Python access from Parent._element_constructor

archive/issues_023644.json:
```json
{
    "body": "In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. The same for `_element_init_pass_parent`. This way, those attributes can no longer be accessed from Python.\n\nCC:  simonking @koffie\n\nReviewer: Travis Scrimshaw\n\nAuthor: Jeroen Demeyer, Simon King\n\nBranch: 41614a7ea0c82da579a039eecd51ee628a3e41e0\n\nDependencies: #23882, #23884, #23894, #23899, #23905, #23907, #23914, #24033\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23881\n\n",
    "closed_at": "2017-10-22T17:23:24Z",
    "created_at": "2017-09-18T12:11:36Z",
    "labels": [
        "component: coercion",
        "trivial",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Remove Python access from Parent._element_constructor",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23881",
    "user": "https://github.com/jdemeyer"
}
```
In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. The same for `_element_init_pass_parent`. This way, those attributes can no longer be accessed from Python.

CC:  simonking @koffie

Reviewer: Travis Scrimshaw

Author: Jeroen Demeyer, Simon King

Branch: 41614a7ea0c82da579a039eecd51ee628a3e41e0

Dependencies: #23882, #23884, #23894, #23899, #23905, #23907, #23914, #24033

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23881





---

archive/issue_comments_352494.json:
```json
{
    "body": "Replying to [ticket:23881 jdemeyer]:\n> In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we rename the latter.\n\n\nI am not sure whether `_element_constructor` is needed at all. Since `_element_constructor_` has underscores, it is private to a certain extent, but still public enough to be a hook for customisation. That's why I believe a default implementation (which is allowed to override) of `_element_constructor_` should be a replacement of the current `_element_constructor`.",
    "created_at": "2017-09-18T12:27:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352494",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [ticket:23881 jdemeyer]:
> In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we rename the latter.


I am not sure whether `_element_constructor` is needed at all. Since `_element_constructor_` has underscores, it is private to a certain extent, but still public enough to be a hook for customisation. That's why I believe a default implementation (which is allowed to override) of `_element_constructor_` should be a replacement of the current `_element_constructor`.



---

archive/issue_comments_352495.json:
```json
{
    "body": "<a id='comment:2'></a>Replying to [comment:1 SimonKing]:\n> I am not sure whether `_element_constructor` is needed at all.\n\n\nI never claimed that it is. Please see my last comments on #23880.",
    "created_at": "2017-09-18T12:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352495",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>Replying to [comment:1 SimonKing]:
> I am not sure whether `_element_constructor` is needed at all.


I never claimed that it is. Please see my last comments on #23880.



---

archive/issue_comments_352496.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 jdemeyer]:\n> Replying to [comment:1 SimonKing]:\n> > I am not sure whether `_element_constructor` is needed at all.\n\n> \n> I never claimed that it is. Please see my last comments on #23880.\n\n\nSo, your suggestion is to rename `_element_constructor` into `__construct_element` in order to learn how things work? This could indeed have some benefits: Making it a very private argument, we would see errors if something tries to call it outside of `sage.structure.parents` (due to name mangling). This would indicate how much work it would be to avoid the indirection and directly replace the internal element constructor by the hook.",
    "created_at": "2017-09-18T12:34:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352496",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:3'></a>Replying to [comment:2 jdemeyer]:
> Replying to [comment:1 SimonKing]:
> > I am not sure whether `_element_constructor` is needed at all.

> 
> I never claimed that it is. Please see my last comments on #23880.


So, your suggestion is to rename `_element_constructor` into `__construct_element` in order to learn how things work? This could indeed have some benefits: Making it a very private argument, we would see errors if something tries to call it outside of `sage.structure.parents` (due to name mangling). This would indicate how much work it would be to avoid the indirection and directly replace the internal element constructor by the hook.



---

archive/issue_comments_352497.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 SimonKing]:\n> Making it a very private argument, we would see errors if something tries to call it outside of `sage.structure.parents` (due to name mangling).\n\n\nNote that a Cython `cdef classes` doesn't do mangling, only Python classes do. So the split would be on the Cython/Python border.",
    "created_at": "2017-09-18T12:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352497",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'></a>Replying to [comment:3 SimonKing]:
> Making it a very private argument, we would see errors if something tries to call it outside of `sage.structure.parents` (due to name mangling).


Note that a Cython `cdef classes` doesn't do mangling, only Python classes do. So the split would be on the Cython/Python border.



---

archive/issue_comments_352498.json:
```json
{
    "body": "<a id='comment:5'></a>I guess the following is what we have to change:\n\n```\n$ grep \"_element_constructor \" -r src/sage\nsrc/sage/combinat/subword.py:        if self._element_constructor is tuple:\nsrc/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\nsrc/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\nsrc/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\nsrc/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\nsrc/sage/combinat/sf/k_dual.py:    _element_constructor = _element_constructor_\nsrc/sage/categories/homset.py:        if self._element_constructor is None:\nsrc/sage/categories/sets_cat.py:        # Todo: simplify the _element_constructor definition logic\nsrc/sage/structure/coerce_maps.pyx:        if (<Parent>codomain)._element_constructor is None:\nsrc/sage/structure/parent_base.pyx:    if p._element_constructor is not None:\nsrc/sage/structure/parent.pyx:            self._element_constructor = element_constructor\nsrc/sage/structure/parent.pyx:            sage: k = GF(5); k._element_constructor # indirect doctest\nsrc/sage/structure/parent.pyx:        self._element_constructor = _element_constructor_\nsrc/sage/structure/parent.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent.pyx:                self._element_constructor = self._element_constructor_\nsrc/sage/structure/parent.pyx:        self._element_constructor = element_constructor\nsrc/sage/structure/parent_gens.pyx:    if p._element_constructor is not None:\nsrc/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_old.pyx:    if p._element_constructor is not None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent_old.pyx:                self._element_constructor = self._element_constructor_\n```\nand\n\n```\n$ grep \"_element_constructor(\" -r src/sage\nsrc/sage/sets/cartesian_product.py:            ``self._element_constructor(elements)``.\nsrc/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/FP_template.pxi:        self._zero = <FPElement?>R._element_constructor(R, 0)\nsrc/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/CR_template.pxi:        self._zero = <CRElement?>R._element_constructor(R, 0)\nsrc/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/finite_rings/hom_prime_finite_field.pyx:            return self._codomain._element_constructor(x)\nsrc/sage/rings/finite_rings/hom_prime_finite_field.pyx:        return self._codomain._element_constructor(x)\nsrc/sage/rings/polynomial/polynomial_element.pyx:            return self.__class__(P,[a], check=False) #P._element_constructor(a, check=False)\nsrc/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))\nsrc/sage/categories/morphism.pyx:            return C._element_constructor(C, x, *args, **kwds)\nsrc/sage/categories/morphism.pyx:            return C._element_constructor(x, *args, **kwds)\nsrc/sage/modular/dirichlet.py:        self._set_element_constructor()\nsrc/sage/structure/coerce_maps.pyx:            return C._element_constructor(C, x)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, **kwds)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, *args)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, *args, **kwds)\nsrc/sage/structure/coerce_maps.pyx:            return C._element_constructor(x)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, **kwds)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, *args)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, *args, **kwds)\nsrc/sage/structure/coerce_maps.pyx:        return C._element_constructor(self._call_(x), *args, **kwds)\nsrc/sage/structure/parent.pyx:            self._set_element_constructor()\nsrc/sage/structure/parent.pyx:    def _set_element_constructor(self):\nsrc/sage/structure/parent_old.pyx:        self._set_element_constructor()\n```",
    "created_at": "2017-09-18T12:38:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352498",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:5'></a>I guess the following is what we have to change:

```
$ grep "_element_constructor " -r src/sage
src/sage/combinat/subword.py:        if self._element_constructor is tuple:
src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
src/sage/combinat/sf/k_dual.py:    _element_constructor = _element_constructor_
src/sage/categories/homset.py:        if self._element_constructor is None:
src/sage/categories/sets_cat.py:        # Todo: simplify the _element_constructor definition logic
src/sage/structure/coerce_maps.pyx:        if (<Parent>codomain)._element_constructor is None:
src/sage/structure/parent_base.pyx:    if p._element_constructor is not None:
src/sage/structure/parent.pyx:            self._element_constructor = element_constructor
src/sage/structure/parent.pyx:            sage: k = GF(5); k._element_constructor # indirect doctest
src/sage/structure/parent.pyx:        self._element_constructor = _element_constructor_
src/sage/structure/parent.pyx:        if self._element_constructor is None:
src/sage/structure/parent.pyx:                self._element_constructor = self._element_constructor_
src/sage/structure/parent.pyx:        self._element_constructor = element_constructor
src/sage/structure/parent_gens.pyx:    if p._element_constructor is not None:
src/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_old.pyx:    if p._element_constructor is not None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is None:
src/sage/structure/parent_old.pyx:                self._element_constructor = self._element_constructor_
```
and

```
$ grep "_element_constructor(" -r src/sage
src/sage/sets/cartesian_product.py:            ``self._element_constructor(elements)``.
src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/FP_template.pxi:        self._zero = <FPElement?>R._element_constructor(R, 0)
src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/CR_template.pxi:        self._zero = <CRElement?>R._element_constructor(R, 0)
src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/finite_rings/hom_prime_finite_field.pyx:            return self._codomain._element_constructor(x)
src/sage/rings/finite_rings/hom_prime_finite_field.pyx:        return self._codomain._element_constructor(x)
src/sage/rings/polynomial/polynomial_element.pyx:            return self.__class__(P,[a], check=False) #P._element_constructor(a, check=False)
src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])
src/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))
src/sage/categories/morphism.pyx:            return C._element_constructor(C, x, *args, **kwds)
src/sage/categories/morphism.pyx:            return C._element_constructor(x, *args, **kwds)
src/sage/modular/dirichlet.py:        self._set_element_constructor()
src/sage/structure/coerce_maps.pyx:            return C._element_constructor(C, x)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, **kwds)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, *args)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, *args, **kwds)
src/sage/structure/coerce_maps.pyx:            return C._element_constructor(x)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, **kwds)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, *args)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, *args, **kwds)
src/sage/structure/coerce_maps.pyx:        return C._element_constructor(self._call_(x), *args, **kwds)
src/sage/structure/parent.pyx:            self._set_element_constructor()
src/sage/structure/parent.pyx:    def _set_element_constructor(self):
src/sage/structure/parent_old.pyx:        self._set_element_constructor()
```



---

archive/issue_comments_352499.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 SimonKing]:\n> {{{\n> $ grep \"_element_constructor \" -r src/sage\n> ...\n> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\n> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\n> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\n> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\n> src/sage/combinat/sf/k_dual.py:    _element_constructor = _element_constructor_\n> }}}\n\n\nThe above is strange. Shouldn't `Parent._set_element_constructor` assign `_element_constructor_` to `_element_constructor` anyway? So, why do it on class level?\n\n> {{{\n> $ grep \"_element_constructor(\" -r src/sage\n> ...\n> src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/FP_template.pxi:        self._zero = <FPElement?>R._element_constructor(R, 0)\n> src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/CR_template.pxi:        self._zero = <CRElement?>R._element_constructor(R, 0)\n> src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)\n> }}}\n\n\nHere we could probably use the default implementation of `zero()`.\n\n> {{{\n> src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)\n> src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))\n> }}}\n\n\nAn internal attribute such as `_element_constructor` shouldn't be mentioned in the docs.",
    "created_at": "2017-09-18T12:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352499",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:6'></a>Replying to [comment:5 SimonKing]:
> {{{
> $ grep "_element_constructor " -r src/sage
> ...
> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
> src/sage/combinat/sf/k_dual.py:    _element_constructor = _element_constructor_
> }}}


The above is strange. Shouldn't `Parent._set_element_constructor` assign `_element_constructor_` to `_element_constructor` anyway? So, why do it on class level?

> {{{
> $ grep "_element_constructor(" -r src/sage
> ...
> src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/FP_template.pxi:        self._zero = <FPElement?>R._element_constructor(R, 0)
> src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/CR_template.pxi:        self._zero = <CRElement?>R._element_constructor(R, 0)
> src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)
> }}}


Here we could probably use the default implementation of `zero()`.

> {{{
> src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)
> src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))
> }}}


An internal attribute such as `_element_constructor` shouldn't be mentioned in the docs.



---

archive/issue_comments_352500.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:5 SimonKing]:\n> {{{\n> src/sage/combinat/subword.py:        if self._element_constructor is tuple:\n> }}}\n\n\nWhy should it be a tuple?? Very strange.",
    "created_at": "2017-09-18T12:46:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352500",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:7'></a>Replying to [comment:5 SimonKing]:
> {{{
> src/sage/combinat/subword.py:        if self._element_constructor is tuple:
> }}}


Why should it be a tuple?? Very strange.



---

archive/issue_comments_352501.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 SimonKing]:\n> Replying to [comment:5 SimonKing]:\n> > {{{\n> > src/sage/combinat/subword.py:        if self._element_constructor is tuple:\n> > }}}\n\n> \n> Why should it be a tuple?? Very strange.\n\n\nI see: It is not *a* tuple, but it is *the class* <tuple>.\n\nThat's probably a tricky case: The elements are tuples, so, the elements are not instances of `sage.structure.element.Element`, and in particular it is one of the cases where we do not want to pass the parent. It should be possible to customize `_element_constructor_` in that case, but there would be a slow-down, compared with calling the tuple constructor directly (without the additional step of a method that calls the tuple constructor).",
    "created_at": "2017-09-18T12:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352501",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:8'></a>Replying to [comment:7 SimonKing]:
> Replying to [comment:5 SimonKing]:
> > {{{
> > src/sage/combinat/subword.py:        if self._element_constructor is tuple:
> > }}}

> 
> Why should it be a tuple?? Very strange.


I see: It is not *a* tuple, but it is *the class* <tuple>.

That's probably a tricky case: The elements are tuples, so, the elements are not instances of `sage.structure.element.Element`, and in particular it is one of the cases where we do not want to pass the parent. It should be possible to customize `_element_constructor_` in that case, but there would be a slow-down, compared with calling the tuple constructor directly (without the additional step of a method that calls the tuple constructor).



---

archive/issue_comments_352502.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:7 SimonKing]:\n> Replying to [comment:5 SimonKing]:\n> > {{{\n> > src/sage/combinat/subword.py:        if self._element_constructor is tuple:\n> > }}}\n\n> \n> Why should it be a tuple?? Very strange.\n\n\nlooking at the last few lines of https://git.sagemath.org/sage.git/commit/?id=a2915642f7f5357e0d374aaf007680c263cd164c\nmaybe that should have been `self._build`",
    "created_at": "2017-09-18T12:58:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352502",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'></a>Replying to [comment:7 SimonKing]:
> Replying to [comment:5 SimonKing]:
> > {{{
> > src/sage/combinat/subword.py:        if self._element_constructor is tuple:
> > }}}

> 
> Why should it be a tuple?? Very strange.


looking at the last few lines of https://git.sagemath.org/sage.git/commit/?id=a2915642f7f5357e0d374aaf007680c263cd164c
maybe that should have been `self._build`



---

archive/issue_comments_352503.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 mantepse]:\n> looking at the last few lines of https://git.sagemath.org/sage.git/commit/?id=a2915642f7f5357e0d374aaf007680c263cd164c\n> maybe that should have been `self._build`\n\n\nProbably you are right. And the fact that it doesn't fail indicates that it isn't sufficiently tested.",
    "created_at": "2017-09-18T13:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352503",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:10'></a>Replying to [comment:9 mantepse]:
> looking at the last few lines of https://git.sagemath.org/sage.git/commit/?id=a2915642f7f5357e0d374aaf007680c263cd164c
> maybe that should have been `self._build`


Probably you are right. And the fact that it doesn't fail indicates that it isn't sufficiently tested.



---

archive/issue_comments_352504.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 SimonKing]:\n\n> Probably you are right. And the fact that it doesn't fail indicates that it isn't sufficiently tested.\n\n\nI just checked, it's just a speedup of a factor 4 - I guess there is no performance testing in sage:\n\n```\nsage: S = Subwords([randint(1,10) for i in range(100)], 3, element_constructor=tuple)\nsage: %timeit len([x for x in S.__iter__()])\n1 loop, best of 3: 322 ms per loop\nsage: %timeit len([x for x in S.__iter_new__()])\n10 loops, best of 3: 85.7 ms per loop\n\nsage: A = [x for x in S.__iter_new__()]\nsage: B = [x for x in S.__iter__()]\nsage: A == B\nTrue\n```",
    "created_at": "2017-09-18T13:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352504",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:11'></a>Replying to [comment:10 SimonKing]:

> Probably you are right. And the fact that it doesn't fail indicates that it isn't sufficiently tested.


I just checked, it's just a speedup of a factor 4 - I guess there is no performance testing in sage:

```
sage: S = Subwords([randint(1,10) for i in range(100)], 3, element_constructor=tuple)
sage: %timeit len([x for x in S.__iter__()])
1 loop, best of 3: 322 ms per loop
sage: %timeit len([x for x in S.__iter_new__()])
10 loops, best of 3: 85.7 ms per loop

sage: A = [x for x in S.__iter_new__()]
sage: B = [x for x in S.__iter__()]
sage: A == B
True
```



---

archive/issue_comments_352505.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:11 mantepse]:\n> sage: A = [x for x in S.__iter_new__()]\n\n\nWhat is `__iter_new__`?",
    "created_at": "2017-09-18T13:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352505",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:12'></a>Replying to [comment:11 mantepse]:
> sage: A = [x for x in S.__iter_new__()]


What is `__iter_new__`?



---

archive/issue_comments_352506.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 SimonKing]:\n> Replying to [comment:11 mantepse]:\n> > sage: A = [x for x in S.__iter_new__()]\n\n> \n> What is `__iter_new__`?\n\n\nThat's the new (correct) implementation - I always put in old and new in parallel for the comparison.  That's #23882 now.",
    "created_at": "2017-09-18T13:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352506",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:13'></a>Replying to [comment:12 SimonKing]:
> Replying to [comment:11 mantepse]:
> > sage: A = [x for x in S.__iter_new__()]

> 
> What is `__iter_new__`?


That's the new (correct) implementation - I always put in old and new in parallel for the comparison.  That's #23882 now.



---

archive/issue_comments_352507.json:
```json
{
    "body": "<a id='comment:15'></a>On top of #23882, I propose to first remove `_element_constructor` from the docs, before we rename it in the code.",
    "created_at": "2017-09-18T14:24:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352507",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:15'></a>On top of #23882, I propose to first remove `_element_constructor` from the docs, before we rename it in the code.



---

archive/issue_comments_352508.json:
```json
{
    "body": "<a id='comment:16'></a>I think the following grep is also needed:\n\n```\ngrep -r --color -nH \"_element_constructor$\"  *\ncategories/sets_cat.py:964:                sage: A._element_constructor\ncategories/sets_cat.py:970:                sage: B._element_constructor\ncombinat/integer_lists/lists.py:173:        a = self._element_constructor\ncombinat/integer_lists/lists.py:174:        b = other._element_constructor\ncombinat/integer_lists/lists.py:281:            sage: L._element_constructor\nstructure/parent.pxd:13:    cdef public _element_constructor\nstructure/parent.pyx:776:        d['_element_constructor'] = self._element_constructor\nstructure/parent.pyx:1869:                element_constructor = (<Parent>S)._element_constructor\n```",
    "created_at": "2017-09-18T14:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352508",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:16'></a>I think the following grep is also needed:

```
grep -r --color -nH "_element_constructor$"  *
categories/sets_cat.py:964:                sage: A._element_constructor
categories/sets_cat.py:970:                sage: B._element_constructor
combinat/integer_lists/lists.py:173:        a = self._element_constructor
combinat/integer_lists/lists.py:174:        b = other._element_constructor
combinat/integer_lists/lists.py:281:            sage: L._element_constructor
structure/parent.pxd:13:    cdef public _element_constructor
structure/parent.pyx:776:        d['_element_constructor'] = self._element_constructor
structure/parent.pyx:1869:                element_constructor = (<Parent>S)._element_constructor
```



---

archive/issue_comments_352509.json:
```json
{
    "body": "<a id='comment:17'></a>and another one:\n\n```\ngrep -r --color -nH \"_element_constructor =\"  *\ncombinat/sf/k_dual.py:923:    _element_constructor = _element_constructor_\ncombinat/sf/new_kschur.py:1021:    _element_constructor = _element_constructor_\ncombinat/sf/new_kschur.py:1279:    _element_constructor = _element_constructor_\ncombinat/sf/new_kschur.py:1395:    _element_constructor = _element_constructor_\ncombinat/sf/new_kschur.py:1472:    _element_constructor = _element_constructor_\nstructure/parent_old.pyx:397:                self._element_constructor = self._element_constructor_\nstructure/parent.pyx:316:            self._element_constructor = element_constructor\nstructure/parent.pyx:607:        self._element_constructor = _element_constructor_\nstructure/parent.pyx:914:                self._element_constructor = self._element_constructor_\nstructure/parent.pyx:1452:        self._element_constructor = element_constructor\n```",
    "created_at": "2017-09-18T14:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352509",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:17'></a>and another one:

```
grep -r --color -nH "_element_constructor ="  *
combinat/sf/k_dual.py:923:    _element_constructor = _element_constructor_
combinat/sf/new_kschur.py:1021:    _element_constructor = _element_constructor_
combinat/sf/new_kschur.py:1279:    _element_constructor = _element_constructor_
combinat/sf/new_kschur.py:1395:    _element_constructor = _element_constructor_
combinat/sf/new_kschur.py:1472:    _element_constructor = _element_constructor_
structure/parent_old.pyx:397:                self._element_constructor = self._element_constructor_
structure/parent.pyx:316:            self._element_constructor = element_constructor
structure/parent.pyx:607:        self._element_constructor = _element_constructor_
structure/parent.pyx:914:                self._element_constructor = self._element_constructor_
structure/parent.pyx:1452:        self._element_constructor = element_constructor
```



---

archive/issue_comments_352510.json:
```json
{
    "body": "<a id='comment:18'></a>The documentation already is a lot worse than I thought:\n\n```\n$ grep \"_element_constructor\" -r src/sage | grep \"sage\\:\"\nsrc/sage/schemes/toric/variety.py:            sage: H._element_constructor_(1)\nsrc/sage/schemes/toric/divisor.py:            sage: TDiv._element_constructor_([ (1,P2.gen(2)) ])\nsrc/sage/schemes/toric/divisor.py:            sage: Cl._element_constructor_(D)\nsrc/sage/schemes/toric/homset.py:            sage: hom_set(fm)     # calls hom_set._element_constructor_()\nsrc/sage/schemes/product_projective/homset.py:            sage: P(QQ)._element_constructor_([4, 2, 2, 0])\nsrc/sage/schemes/generic/homset.py:            sage: H._element_constructor_(f)\nsrc/sage/schemes/generic/homset.py:            sage: F_points._element_constructor_([4,2*a])\nsrc/sage/schemes/projective/projective_homset.py:            sage: X._element_constructor_([0,1,0])\nsrc/sage/schemes/affine/affine_homset.py:            sage: H._element_constructor_(ring_hom)\nsrc/sage/numerical/linear_tensor.py:            sage: LT._element_constructor_(123)\nsrc/sage/numerical/linear_functions.pyx:            sage: LF._element_constructor_(123)\nsrc/sage/numerical/linear_functions.pyx:            sage: LC._element_constructor_(1, 2)\nsrc/sage/numerical/linear_tensor_constraints.py:            sage: LTC._element_constructor_(1, 2, True)\nsrc/sage/sets/disjoint_union_enumerated_sets.py:            sage: U._element_constructor_\nsrc/sage/sets/disjoint_union_enumerated_sets.py:            sage: U._element_constructor_\nsrc/sage/sets/disjoint_union_enumerated_sets.py:            sage: p = X._element_constructor_((0, []))  # indirect doctest\nsrc/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(42)\nsrc/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(-5)\nsrc/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(x)\nsrc/sage/groups/affine_gps/euclidean_group.py:            sage: E3._element_constructor_check(A, b)\nsrc/sage/groups/affine_gps/euclidean_group.py:            sage: E3._element_constructor_check(A, b)\nsrc/sage/groups/affine_gps/affine_group.py:            sage: Aff3._element_constructor_check(A, b)\nsrc/sage/groups/affine_gps/affine_group.py:            sage: Aff3._element_constructor_check(A, b)\nsrc/sage/rings/fraction_field.py:            sage: F._element_constructor_(1)\nsrc/sage/rings/fraction_field.py:            sage: F._element_constructor_(F.gen(0)/F.gen(1))\nsrc/sage/rings/fraction_field.py:            sage: F._element_constructor_('1 + x/y')\nsrc/sage/rings/fraction_field.py:            sage: F._element_constructor_(x/y)\nsrc/sage/rings/fraction_field.py:            sage: K._element_constructor_(2, 'x+y')\nsrc/sage/rings/fraction_field.py:            sage: K._element_constructor_(1, 'z')\nsrc/sage/rings/finite_rings/residue_field.pyx:            sage: ResidueField_generic._element_constructor_(F, i)\nsrc/sage/rings/finite_rings/residue_field.pyx:            sage: ResidueField_generic._element_constructor_(F, GF(13)(8))\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(1/2)\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(x*y)\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(y*x)\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(1)\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(0)\nsrc/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(m)\nsrc/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(p)\nsrc/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(p).parent()\nsrc/sage/rings/function_field/function_field.py:            sage: L._element_constructor_(L.polynomial_ring().gen())\nsrc/sage/rings/function_field/function_field.py:            sage: a = K._element_constructor_(K.maximal_order().gen()); a\nsrc/sage/rings/function_field/function_field_order.py:            sage: K.maximal_order()._element_constructor_(x)\nsrc/sage/rings/function_field/function_field_order.py:            sage: O._element_constructor_(y)\nsrc/sage/rings/function_field/function_field_order.py:            sage: O._element_constructor_(1/y)\nsrc/sage/combinat/rooted_tree.py:            sage: B._element_constructor_([])\nsrc/sage/combinat/root_system/weyl_characters.py:            sage: A2._element_constructor_([2,1,0])\nsrc/sage/combinat/root_system/weyl_characters.py:            sage: A2._element_constructor_([2,1,0])\nsrc/sage/combinat/root_system/associahedron.py:            sage: parent._element_constructor_(['A',2])\nsrc/sage/combinat/finite_class.py:            sage: F._element_constructor_(1)\nsrc/sage/combinat/partition_tuple.py:            sage: PartitionTuples._element_constructor_(PartitionTuples(), [[2,1],[3,2],[1,1,1]])\nsrc/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor_nocheck([1,2,3])\nsrc/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor\nsrc/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])\nsrc/sage/combinat/binary_tree.py:            sage: B._element_constructor_([])\nsrc/sage/combinat/binary_tree.py:            sage: FB._element_constructor_([])\nsrc/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_([2,1,3])\nsrc/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_(Permutation([2,1,3]))\nsrc/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_([1,2,1])\nsrc/sage/combinat/sf/classical.py:            sage: s._element_constructor_(McdJ(s[2,1]))\nsrc/sage/combinat/posets/linear_extensions.py:            sage: x = L._element_constructor_([1,2,4,3]); x\nsrc/sage/combinat/posets/linear_extensions.py:            sage: L._element_constructor_([4,3,2,1])\nsrc/sage/combinat/posets/linear_extensions.py:            sage: L._element_constructor_([4,3,2,1],check=False)\nsrc/sage/geometry/triangulation/point_configuration.py:            sage: p._element_constructor_([ (0,1,2), (2,3,0) ])\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)\nsrc/sage/geometry/polyhedron/parent.py:            sage: P._element_constructor_([[(0, 0, 0), (1, 0, 0), (0, 1, 0), (0,0,1)], [], []], None)\nsrc/sage/geometry/hyperplane_arrangement/hyperplane.py:        sage: ambient._element_constructor_(x+y-1)   \nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_(x, y)\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([x, y])\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([0, 1, 0], [0, 0, 1])\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([[0, 1, 0], [0, 0, 1]])\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))\nsrc/sage/homology/chain_complex.py:            sage: D._element_constructor_(0)\nsrc/sage/tensor/modules/free_module_homset.py:            sage: phi = H._element_constructor_([[2,-1,3], [1,0,-4]], bases=(e,f),\nsrc/sage/tensor/modules/free_module_homset.py:            sage: phi = EM._element_constructor_([[1,2,3],[4,5,6],[7,8,9]],\nsrc/sage/tensor/modules/free_module_homset.py:            sage: phi_a = EM._element_constructor_(a) ; phi_a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([], name='a') ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([2,0,-1], name='a') ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([], name='a') ; a\nsrc/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_(comp=[1,0,-2], basis=e, name='v') ; v\nsrc/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_(0) ; v\nsrc/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_() ; v\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(comp=[[1,2],[1,3]], basis=e,\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: GL._element_constructor_(1)\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: GL._element_constructor_(1).matrix(e)\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(phi) ; a\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(t) ; a\nsrc/sage/tensor/modules/tensor_free_module.py:            sage: T._element_constructor_(0) is T.zero()\nsrc/sage/tensor/modules/tensor_free_module.py:            sage: t = T._element_constructor_(comp=[[2,0],[1/2,-3]], basis=e,\nsrc/sage/categories/sets_cat.py:                sage: S._element_constructor_(17)\nsrc/sage/categories/sets_cat.py:                sage: A._element_constructor\nsrc/sage/categories/sets_cat.py:                sage: B._element_constructor\nsrc/sage/categories/sets_cat.py:                sage: s = S._element_constructor_from_element_class(17); s\nsrc/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('a')\nsrc/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('bad')\nsrc/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('z')\nsrc/sage/categories/examples/semigroups.py:            sage: bad = F._element_constructor_('bad'); bad\nsrc/sage/categories/examples/semigroups.py:            sage: type(S._element_constructor_(17))\nsrc/sage/categories/examples/semigroups.py:            sage: S._element_constructor_(17)\nsrc/sage/categories/examples/semigroups.py:            sage: type(S._element_constructor_(17))\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(13) == 13\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(13).parent()\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)\nsrc/sage/structure/parent.pyx:            sage: k = GF(5); k._element_constructor # indirect doctest\nsrc/sage/structure/set_factories.py:            sage: pol.self_element_constructor_attributes(XYPair)\nsrc/sage/structure/set_factories.py:            sage: pol.facade_element_constructor_attributes(XYPairs())\nsrc/sage/manifolds/differentiable/real_line.py:            sage: I((2,))  # standard used of TopologicalManifoldSubset._element_constructor_\nsrc/sage/algebras/steenrod/steenrod_algebra.py:            sage: A1._element_constructor_(Sq(2))\nsrc/sage/algebras/steenrod/steenrod_algebra.py:            sage: A1._element_constructor_(Sq(4)) # Sq(4) not in A1\nsrc/sage/algebras/free_algebra_quotient.py:            sage: H._element_constructor_(i) is i\nsrc/sage/algebras/free_algebra_quotient.py:            sage: a = H._element_constructor_(1); a\nsrc/sage/algebras/free_algebra_quotient.py:            sage: a = H._element_constructor_([1,2,3,4]); a\n```\n\nOf course, the documentation should explain how to implement `_element_constructor_`. However, the documentation must not suggest that the method (with or without trailing underscore) should ever be called directly.",
    "created_at": "2017-09-18T14:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352510",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:18'></a>The documentation already is a lot worse than I thought:

```
$ grep "_element_constructor" -r src/sage | grep "sage\:"
src/sage/schemes/toric/variety.py:            sage: H._element_constructor_(1)
src/sage/schemes/toric/divisor.py:            sage: TDiv._element_constructor_([ (1,P2.gen(2)) ])
src/sage/schemes/toric/divisor.py:            sage: Cl._element_constructor_(D)
src/sage/schemes/toric/homset.py:            sage: hom_set(fm)     # calls hom_set._element_constructor_()
src/sage/schemes/product_projective/homset.py:            sage: P(QQ)._element_constructor_([4, 2, 2, 0])
src/sage/schemes/generic/homset.py:            sage: H._element_constructor_(f)
src/sage/schemes/generic/homset.py:            sage: F_points._element_constructor_([4,2*a])
src/sage/schemes/projective/projective_homset.py:            sage: X._element_constructor_([0,1,0])
src/sage/schemes/affine/affine_homset.py:            sage: H._element_constructor_(ring_hom)
src/sage/numerical/linear_tensor.py:            sage: LT._element_constructor_(123)
src/sage/numerical/linear_functions.pyx:            sage: LF._element_constructor_(123)
src/sage/numerical/linear_functions.pyx:            sage: LC._element_constructor_(1, 2)
src/sage/numerical/linear_tensor_constraints.py:            sage: LTC._element_constructor_(1, 2, True)
src/sage/sets/disjoint_union_enumerated_sets.py:            sage: U._element_constructor_
src/sage/sets/disjoint_union_enumerated_sets.py:            sage: U._element_constructor_
src/sage/sets/disjoint_union_enumerated_sets.py:            sage: p = X._element_constructor_((0, []))  # indirect doctest
src/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(42)
src/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(-5)
src/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(x)
src/sage/groups/affine_gps/euclidean_group.py:            sage: E3._element_constructor_check(A, b)
src/sage/groups/affine_gps/euclidean_group.py:            sage: E3._element_constructor_check(A, b)
src/sage/groups/affine_gps/affine_group.py:            sage: Aff3._element_constructor_check(A, b)
src/sage/groups/affine_gps/affine_group.py:            sage: Aff3._element_constructor_check(A, b)
src/sage/rings/fraction_field.py:            sage: F._element_constructor_(1)
src/sage/rings/fraction_field.py:            sage: F._element_constructor_(F.gen(0)/F.gen(1))
src/sage/rings/fraction_field.py:            sage: F._element_constructor_('1 + x/y')
src/sage/rings/fraction_field.py:            sage: F._element_constructor_(x/y)
src/sage/rings/fraction_field.py:            sage: K._element_constructor_(2, 'x+y')
src/sage/rings/fraction_field.py:            sage: K._element_constructor_(1, 'z')
src/sage/rings/finite_rings/residue_field.pyx:            sage: ResidueField_generic._element_constructor_(F, i)
src/sage/rings/finite_rings/residue_field.pyx:            sage: ResidueField_generic._element_constructor_(F, GF(13)(8))
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(1/2)
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(x*y)
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(y*x)
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(1)
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(0)
src/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(m)
src/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(p)
src/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(p).parent()
src/sage/rings/function_field/function_field.py:            sage: L._element_constructor_(L.polynomial_ring().gen())
src/sage/rings/function_field/function_field.py:            sage: a = K._element_constructor_(K.maximal_order().gen()); a
src/sage/rings/function_field/function_field_order.py:            sage: K.maximal_order()._element_constructor_(x)
src/sage/rings/function_field/function_field_order.py:            sage: O._element_constructor_(y)
src/sage/rings/function_field/function_field_order.py:            sage: O._element_constructor_(1/y)
src/sage/combinat/rooted_tree.py:            sage: B._element_constructor_([])
src/sage/combinat/root_system/weyl_characters.py:            sage: A2._element_constructor_([2,1,0])
src/sage/combinat/root_system/weyl_characters.py:            sage: A2._element_constructor_([2,1,0])
src/sage/combinat/root_system/associahedron.py:            sage: parent._element_constructor_(['A',2])
src/sage/combinat/finite_class.py:            sage: F._element_constructor_(1)
src/sage/combinat/partition_tuple.py:            sage: PartitionTuples._element_constructor_(PartitionTuples(), [[2,1],[3,2],[1,1,1]])
src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor_nocheck([1,2,3])
src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor
src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])
src/sage/combinat/binary_tree.py:            sage: B._element_constructor_([])
src/sage/combinat/binary_tree.py:            sage: FB._element_constructor_([])
src/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_([2,1,3])
src/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_(Permutation([2,1,3]))
src/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_([1,2,1])
src/sage/combinat/sf/classical.py:            sage: s._element_constructor_(McdJ(s[2,1]))
src/sage/combinat/posets/linear_extensions.py:            sage: x = L._element_constructor_([1,2,4,3]); x
src/sage/combinat/posets/linear_extensions.py:            sage: L._element_constructor_([4,3,2,1])
src/sage/combinat/posets/linear_extensions.py:            sage: L._element_constructor_([4,3,2,1],check=False)
src/sage/geometry/triangulation/point_configuration.py:            sage: p._element_constructor_([ (0,1,2), (2,3,0) ])
src/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)
src/sage/geometry/polyhedron/parent.py:            sage: P._element_constructor_([[(0, 0, 0), (1, 0, 0), (0, 1, 0), (0,0,1)], [], []], None)
src/sage/geometry/hyperplane_arrangement/hyperplane.py:        sage: ambient._element_constructor_(x+y-1)   
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_(x, y)
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([x, y])
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([0, 1, 0], [0, 0, 1])
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([[0, 1, 0], [0, 0, 1]])
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))
src/sage/homology/chain_complex.py:            sage: D._element_constructor_(0)
src/sage/tensor/modules/free_module_homset.py:            sage: phi = H._element_constructor_([[2,-1,3], [1,0,-4]], bases=(e,f),
src/sage/tensor/modules/free_module_homset.py:            sage: phi = EM._element_constructor_([[1,2,3],[4,5,6],[7,8,9]],
src/sage/tensor/modules/free_module_homset.py:            sage: phi_a = EM._element_constructor_(a) ; phi_a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([], name='a') ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([2,0,-1], name='a') ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([], name='a') ; a
src/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_(comp=[1,0,-2], basis=e, name='v') ; v
src/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_(0) ; v
src/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_() ; v
src/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(comp=[[1,2],[1,3]], basis=e,
src/sage/tensor/modules/free_module_linear_group.py:            sage: GL._element_constructor_(1)
src/sage/tensor/modules/free_module_linear_group.py:            sage: GL._element_constructor_(1).matrix(e)
src/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(phi) ; a
src/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(t) ; a
src/sage/tensor/modules/tensor_free_module.py:            sage: T._element_constructor_(0) is T.zero()
src/sage/tensor/modules/tensor_free_module.py:            sage: t = T._element_constructor_(comp=[[2,0],[1/2,-3]], basis=e,
src/sage/categories/sets_cat.py:                sage: S._element_constructor_(17)
src/sage/categories/sets_cat.py:                sage: A._element_constructor
src/sage/categories/sets_cat.py:                sage: B._element_constructor
src/sage/categories/sets_cat.py:                sage: s = S._element_constructor_from_element_class(17); s
src/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('a')
src/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('bad')
src/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('z')
src/sage/categories/examples/semigroups.py:            sage: bad = F._element_constructor_('bad'); bad
src/sage/categories/examples/semigroups.py:            sage: type(S._element_constructor_(17))
src/sage/categories/examples/semigroups.py:            sage: S._element_constructor_(17)
src/sage/categories/examples/semigroups.py:            sage: type(S._element_constructor_(17))
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(13) == 13
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(13).parent()
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)
src/sage/structure/parent.pyx:            sage: k = GF(5); k._element_constructor # indirect doctest
src/sage/structure/set_factories.py:            sage: pol.self_element_constructor_attributes(XYPair)
src/sage/structure/set_factories.py:            sage: pol.facade_element_constructor_attributes(XYPairs())
src/sage/manifolds/differentiable/real_line.py:            sage: I((2,))  # standard used of TopologicalManifoldSubset._element_constructor_
src/sage/algebras/steenrod/steenrod_algebra.py:            sage: A1._element_constructor_(Sq(2))
src/sage/algebras/steenrod/steenrod_algebra.py:            sage: A1._element_constructor_(Sq(4)) # Sq(4) not in A1
src/sage/algebras/free_algebra_quotient.py:            sage: H._element_constructor_(i) is i
src/sage/algebras/free_algebra_quotient.py:            sage: a = H._element_constructor_(1); a
src/sage/algebras/free_algebra_quotient.py:            sage: a = H._element_constructor_([1,2,3,4]); a
```

Of course, the documentation should explain how to implement `_element_constructor_`. However, the documentation must not suggest that the method (with or without trailing underscore) should ever be called directly.



---

archive/issue_comments_352511.json:
```json
{
    "body": "<a id='comment:20'></a>New commits:",
    "created_at": "2017-09-18T14:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352511",
    "user": "https://github.com/koffie"
}
```

<a id='comment:20'></a>New commits:



---

archive/issue_comments_352512.json:
```json
{
    "body": "<a id='comment:22'></a>Briefly looking at your commit: I find it a good idea that you are using a `cdef __construct_element` instead of a `cdef public _element_constructor`, because in that way it is certain that no Python class will illegally use the internal element constructor. I also see that you make pickling backward compatible.\n\nMy commit fixes one part of the documentation (in sage.schemes).\n\n---\nNew commits:",
    "created_at": "2017-09-18T15:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352512",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:22'></a>Briefly looking at your commit: I find it a good idea that you are using a `cdef __construct_element` instead of a `cdef public _element_constructor`, because in that way it is certain that no Python class will illegally use the internal element constructor. I also see that you make pickling backward compatible.

My commit fixes one part of the documentation (in sage.schemes).

---
New commits:



---

archive/issue_comments_352513.json:
```json
{
    "body": "<a id='comment:25'></a>So far, the git commits come from Maarten and me, so, I guess the Authors field should be changed accordingly.\n\nOn a different ticket, Jeroen said that he likes small tickets. I guess that means I should open a new ticket for cleanup of the documentation.\n\nI suggest, in order to not change things in git that have already been done, to let commit:c95b724 (Remove ._element_constructor_ from sage.schemes documentation) stay here and open a new ticket for other documentation issues.\n\nFirst of all, the failures resulting from Maarten's commit should be addressed.",
    "created_at": "2017-09-18T16:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352513",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:25'></a>So far, the git commits come from Maarten and me, so, I guess the Authors field should be changed accordingly.

On a different ticket, Jeroen said that he likes small tickets. I guess that means I should open a new ticket for cleanup of the documentation.

I suggest, in order to not change things in git that have already been done, to let commit:c95b724 (Remove ._element_constructor_ from sage.schemes documentation) stay here and open a new ticket for other documentation issues.

First of all, the failures resulting from Maarten's commit should be addressed.



---

archive/issue_comments_352514.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:25 SimonKing]:\n> First of all, the failures resulting from Maarten's commit should be addressed.\n\n\nNope. Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.",
    "created_at": "2017-09-18T16:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352514",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:26'></a>Replying to [comment:25 SimonKing]:
> First of all, the failures resulting from Maarten's commit should be addressed.


Nope. Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.



---

archive/issue_comments_352515.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 SimonKing]:\n> Replying to [comment:25 SimonKing]:\n> > First of all, the failures resulting from Maarten's commit should be addressed.\n\n> \n> Nope. Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.\n\n\nAnyway, if we are lucky, merging Jeroen's branch from #23884 will fix the issue. I am trying that now.",
    "created_at": "2017-09-18T16:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352515",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:27'></a>Replying to [comment:26 SimonKing]:
> Replying to [comment:25 SimonKing]:
> > First of all, the failures resulting from Maarten's commit should be addressed.

> 
> Nope. Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.


Anyway, if we are lucky, merging Jeroen's branch from #23884 will fix the issue. I am trying that now.



---

archive/issue_comments_352516.json:
```json
{
    "body": "<a id='comment:28'></a>For the doc of binary trees, it is #23885",
    "created_at": "2017-09-18T18:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352516",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:28'></a>For the doc of binary trees, it is #23885



---

archive/issue_comments_352517.json:
```json
{
    "body": "<a id='comment:29'></a>For the remainder of combinat, it is #23889.  However, I'm not so sure about this anymore: `_element_constructor_` is a private method, so it won't show up in the documentation anyway?  So, isn't it correct to doctest it directly?",
    "created_at": "2017-09-19T06:42:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352517",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:29'></a>For the remainder of combinat, it is #23889.  However, I'm not so sure about this anymore: `_element_constructor_` is a private method, so it won't show up in the documentation anyway?  So, isn't it correct to doctest it directly?



---

archive/issue_comments_352518.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:26 SimonKing]:\n> Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.\n\n\nI don't really get this. The padic failures need to be fixed anyway, either here or on #23884. Why don't you like to do it on a different ticket?",
    "created_at": "2017-09-19T13:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352518",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>Replying to [comment:26 SimonKing]:
> Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.


I don't really get this. The padic failures need to be fixed anyway, either here or on #23884. Why don't you like to do it on a different ticket?



---

archive/issue_comments_352519.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:26 SimonKing]:\n> That's why I don't like creating many small tickets.\n\n\nInterestingly, you are the first person I am hearing this from.\n\nAdvantages of small tickets:\n\n1. Small tickets are easier to review because the reviewer only needs to look at a small set of changes.\n\n2. Different tickets can have different sets of authors/reviewers, each with their own interests/specialities.\n\n3. Small tickets are less likely to get stuck because of one isolated difficulty. For example: a ticket like \"stop using `_element_constructor`\" cannot succeed as long as there is one isolated place where `_element_constructor` is used non-trivially. A ticket like \"stop using `_element_constructor` in sub-package foo\" does not have this problem.\n\nUsually, when working on a big ticket like #23880 (big in the sense that it has a lot of connections to other parts of Sage, it is very non-local), I start coding and then split off separate tickets as I go along.",
    "created_at": "2017-09-19T13:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352519",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>Replying to [comment:26 SimonKing]:
> That's why I don't like creating many small tickets.


Interestingly, you are the first person I am hearing this from.

Advantages of small tickets:

1. Small tickets are easier to review because the reviewer only needs to look at a small set of changes.

2. Different tickets can have different sets of authors/reviewers, each with their own interests/specialities.

3. Small tickets are less likely to get stuck because of one isolated difficulty. For example: a ticket like "stop using `_element_constructor`" cannot succeed as long as there is one isolated place where `_element_constructor` is used non-trivially. A ticket like "stop using `_element_constructor` in sub-package foo" does not have this problem.

Usually, when working on a big ticket like #23880 (big in the sense that it has a lot of connections to other parts of Sage, it is very non-local), I start coding and then split off separate tickets as I go along.



---

archive/issue_comments_352520.json:
```json
{
    "body": "<a id='comment:32'></a>I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?",
    "created_at": "2017-09-19T13:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352520",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:32'></a>I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?



---

archive/issue_comments_352521.json:
```json
{
    "body": "<a id='comment:33'></a>Replying to [comment:32 mantepse]:\n> I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?\n\n\nIn the end, both should be tested: direct and indirect tests. In most cases, the indirect usage is already tested (many doctests indirectly use `_element_constructor_`). So, yes, I think that `_element_constructor_` should be tested directly.",
    "created_at": "2017-09-19T13:42:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352521",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>Replying to [comment:32 mantepse]:
> I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?


In the end, both should be tested: direct and indirect tests. In most cases, the indirect usage is already tested (many doctests indirectly use `_element_constructor_`). So, yes, I think that `_element_constructor_` should be tested directly.



---

archive/issue_comments_352522.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:33 jdemeyer]:\n> Replying to [comment:32 mantepse]:\n> > I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?\n\n> \n> In the end, both should be tested: direct and indirect tests. In most cases, the indirect usage is already tested (many doctests indirectly use `_element_constructor_`). So, yes, I think that `_element_constructor_` should be tested directly.\n\n\nSeriously??? When I was younger, I occasionally did direct tests (say, for `__iter__`) and was told to not do that.\n\nI also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the \"EXAMPLES:\" section) has to show how stuff is actually being used. It may be possible to be a bit more explicit in the \"TESTS:\" section, but still I'd recommend against it.\n\nIt is clear from the tutorials that `_repr_`, `_add_`, `_mul_` and `_element_constructor_` (all *single* underscore!) in Sage implement string representation of parents/elements, addition resp. multiplication of elements, and the call method of parents. Thus, all these methods should be tested indirectly:\n\n```\nsage: P    # indirect doctest\nString representation\nsage: x+y  # indirect doctest\nresult of addition\nsage: P(x) # indirect doctest\nresult of conversion\n```",
    "created_at": "2017-09-19T13:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352522",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:34'></a>Replying to [comment:33 jdemeyer]:
> Replying to [comment:32 mantepse]:
> > I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?

> 
> In the end, both should be tested: direct and indirect tests. In most cases, the indirect usage is already tested (many doctests indirectly use `_element_constructor_`). So, yes, I think that `_element_constructor_` should be tested directly.


Seriously??? When I was younger, I occasionally did direct tests (say, for `__iter__`) and was told to not do that.

I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the "EXAMPLES:" section) has to show how stuff is actually being used. It may be possible to be a bit more explicit in the "TESTS:" section, but still I'd recommend against it.

It is clear from the tutorials that `_repr_`, `_add_`, `_mul_` and `_element_constructor_` (all *single* underscore!) in Sage implement string representation of parents/elements, addition resp. multiplication of elements, and the call method of parents. Thus, all these methods should be tested indirectly:

```
sage: P    # indirect doctest
String representation
sage: x+y  # indirect doctest
result of addition
sage: P(x) # indirect doctest
result of conversion
```



---

archive/issue_comments_352523.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:34 SimonKing]:\n> I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the \"EXAMPLES:\" section) has to show how stuff is actually being used. It may be possible to be a bit more explicit in the \"TESTS:\" section, but still I'd recommend against it.\n\n\nI tried to find the discussion, but didn't succeed. So, if you prefer, do ask on Sage-devel.",
    "created_at": "2017-09-19T13:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352523",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:35'></a>Replying to [comment:34 SimonKing]:
> I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the "EXAMPLES:" section) has to show how stuff is actually being used. It may be possible to be a bit more explicit in the "TESTS:" section, but still I'd recommend against it.


I tried to find the discussion, but didn't succeed. So, if you prefer, do ask on Sage-devel.



---

archive/issue_comments_352524.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [comment:34 SimonKing]:\n> Seriously??? When I was younger, I occasionally did direct tests (say, for `__iter__`) and was told to not do that.\n\n\nI think Python *special methods* like `__iter__` and *private methods* like `_element_constructor_` are a different category. This is especially so for a `cdef class`, where `__iter__` is not a method at all! So whatever you think about `__iter__` may not apply to `_element_constructor_`.\n\n> I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the \"EXAMPLES:\" section) has to show how stuff is actually being used.\n\n\nWell, `_element_constructor_` is not actually used by the end user. So again, this is not a relevant point.\n\nIn the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?",
    "created_at": "2017-09-19T14:08:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352524",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>Replying to [comment:34 SimonKing]:
> Seriously??? When I was younger, I occasionally did direct tests (say, for `__iter__`) and was told to not do that.


I think Python *special methods* like `__iter__` and *private methods* like `_element_constructor_` are a different category. This is especially so for a `cdef class`, where `__iter__` is not a method at all! So whatever you think about `__iter__` may not apply to `_element_constructor_`.

> I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the "EXAMPLES:" section) has to show how stuff is actually being used.


Well, `_element_constructor_` is not actually used by the end user. So again, this is not a relevant point.

In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?



---

archive/issue_comments_352525.json:
```json
{
    "body": "<a id='comment:37'></a>> In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?\n\n\nWell, currently we are **removing** these tests.  So if we decide here that it's not *bad practice* to test `_element_constructor_` directly, several of the tickets can be closed immediately.\n\nPersonally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, comment:34 is convincing, too.  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.\n\nAnyway, let's not waste time on this.",
    "created_at": "2017-09-19T14:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352525",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:37'></a>> In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?


Well, currently we are **removing** these tests.  So if we decide here that it's not *bad practice* to test `_element_constructor_` directly, several of the tickets can be closed immediately.

Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, comment:34 is convincing, too.  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.

Anyway, let's not waste time on this.



---

archive/issue_comments_352526.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:37 mantepse]:\n> > In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?\n\n> \n> Well, currently we are **removing** these tests.  So if we decide here that it's not *bad practice* to test `_element_constructor_` directly, several of the tickets can be closed immediately.\n\n\nI am a strong -1 on removing these tests. There can be good reasons for calling it directly, such as having non-trivial parsing of inputs before sending it to the element class but wanting to avoid the coercion framework. I also cannot see any problems with a direct call. Since this is being tested directly in the corresponding method, it is not public, and so it won't cause any problems for users.\n\n> Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, comment:34 is convincing, too.\n\n\nDo you mean comment:33 or comment:36?\n\nI usually am just lazy and do indirect for `_element_constructor_` tests. However, I probably should do direct calls in tests... However, for some of the methods, it is just easier (and can be more readable, such as for algebraic operations) to do the indirect test.\n\n>  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.\n\n\nIt is the other way around; the `_element_constructor_` is called from `Parent.__call__`. It usually is the last thing called from the parent and actually constructs the element when doing `Foo(bar)`.",
    "created_at": "2017-09-19T17:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352526",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:39'></a>Replying to [comment:37 mantepse]:
> > In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?

> 
> Well, currently we are **removing** these tests.  So if we decide here that it's not *bad practice* to test `_element_constructor_` directly, several of the tickets can be closed immediately.


I am a strong -1 on removing these tests. There can be good reasons for calling it directly, such as having non-trivial parsing of inputs before sending it to the element class but wanting to avoid the coercion framework. I also cannot see any problems with a direct call. Since this is being tested directly in the corresponding method, it is not public, and so it won't cause any problems for users.

> Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, comment:34 is convincing, too.


Do you mean comment:33 or comment:36?

I usually am just lazy and do indirect for `_element_constructor_` tests. However, I probably should do direct calls in tests... However, for some of the methods, it is just easier (and can be more readable, such as for algebraic operations) to do the indirect test.

>  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.


It is the other way around; the `_element_constructor_` is called from `Parent.__call__`. It usually is the last thing called from the parent and actually constructs the element when doing `Foo(bar)`.



---

archive/issue_comments_352527.json:
```json
{
    "body": "<a id='comment:40'></a>> I am a strong -1 on removing these tests.\n\n\nOK - so please let's ignore these tickets for the moment and concentrate on this one and #23880 instead...\n\n> > Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, comment:34 is convincing, too.\n\n> \n> Do you mean comment:33 or comment:36?\n\n\nNo, I meant comment:34.  Specifically:\n\n>>> It is clear from the tutorials that `_repr_`, `_add_`, `_mul_` and `_element_constructor_` (all *single* underscore!) in Sage implement string representation of parents/elements, addition resp. multiplication of elements, and the call method of parents. Thus, all these methods should be tested indirectly:\n>>> \n>>> ```\n>>> sage: P    # indirect doctest\n>>> String representation\n>>> sage: x+y  # indirect doctest\n>>> result of addition\n>>> sage: P(x) # indirect doctest\n>>> result of conversion\n>>> ```\n\n\n> >  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.\n\n> \n> It is the other way around; the `_element_constructor_` is called from `Parent.__call__`. It usually is the last thing called from the parent and actually constructs the element when doing `Foo(bar)`.\n\n\nThanks for the clarification!",
    "created_at": "2017-09-19T18:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352527",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:40'></a>> I am a strong -1 on removing these tests.


OK - so please let's ignore these tickets for the moment and concentrate on this one and #23880 instead...

> > Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, comment:34 is convincing, too.

> 
> Do you mean comment:33 or comment:36?


No, I meant comment:34.  Specifically:

>>> It is clear from the tutorials that `_repr_`, `_add_`, `_mul_` and `_element_constructor_` (all *single* underscore!) in Sage implement string representation of parents/elements, addition resp. multiplication of elements, and the call method of parents. Thus, all these methods should be tested indirectly:
>>> 
>>> ```
>>> sage: P    # indirect doctest
>>> String representation
>>> sage: x+y  # indirect doctest
>>> result of addition
>>> sage: P(x) # indirect doctest
>>> result of conversion
>>> ```


> >  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.

> 
> It is the other way around; the `_element_constructor_` is called from `Parent.__call__`. It usually is the last thing called from the parent and actually constructs the element when doing `Foo(bar)`.


Thanks for the clarification!



---

archive/issue_comments_352528.json:
```json
{
    "body": "<a id='comment:45'></a>With all the dependencies on this ticket and #23880, I am no longer convinced that we need this ticket. We could also simply do the change `cdef public _element_constructor` -> `cdef _element_constructor` here and nothing else.",
    "created_at": "2017-09-22T09:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352528",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>With all the dependencies on this ticket and #23880, I am no longer convinced that we need this ticket. We could also simply do the change `cdef public _element_constructor` -> `cdef _element_constructor` here and nothing else.



---

archive/issue_comments_352529.json:
```json
{
    "body": "<a id='comment:46'></a>I think removing `_element_constructor` from the public Python API is a good thing to do to prevent anyone else from adding something (although I would say that is highly unlikely).",
    "created_at": "2017-09-29T19:46:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352529",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:46'></a>I think removing `_element_constructor` from the public Python API is a good thing to do to prevent anyone else from adding something (although I would say that is highly unlikely).



---

archive/issue_comments_352530.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we rename the latter.\n+In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. This way, it can no longer be accessed from Python.\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2017-09-30T13:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352530",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we rename the latter.
+In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. This way, it can no longer be accessed from Python.
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_352531.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. The same for `_element_init_pass_parent`. This way, those attributes can no longer be accessed from Python.\n \n Author: Jeroen Demeyer\n \n``````\n",
    "created_at": "2017-09-30T14:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352531",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. The same for `_element_init_pass_parent`. This way, those attributes can no longer be accessed from Python.
 
 Author: Jeroen Demeyer
 
``````




---

archive/issue_comments_352532.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-09-30T14:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352532",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_352533.json:
```json
{
    "body": "<a id='comment:50'></a>New commits:",
    "created_at": "2017-09-30T14:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352533",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'></a>New commits:



---

archive/issue_comments_352534.json:
```json
{
    "body": "<a id='comment:51'></a>Green patchbot => positive review.",
    "created_at": "2017-09-30T15:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352534",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:51'></a>Green patchbot => positive review.



---

archive/issue_comments_352535.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-09-30T22:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352535",
    "user": "https://github.com/koffie"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_352536.json:
```json
{
    "body": "<a id='comment:52'></a>Both arando and rk02-math seem to fail the same test:\n\n```\n sage -t --long src/sage/schemes/elliptic_curves/sha_tate.py # 1 doctest failed \n```\nWhich they do not seem to fail on with other tickets.",
    "created_at": "2017-09-30T22:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352536",
    "user": "https://github.com/koffie"
}
```

<a id='comment:52'></a>Both arando and rk02-math seem to fail the same test:

```
 sage -t --long src/sage/schemes/elliptic_curves/sha_tate.py # 1 doctest failed 
```
Which they do not seem to fail on with other tickets.



---

archive/issue_comments_352537.json:
```json
{
    "body": "<a id='comment:53'></a>I don't see how those failures could be related to the changes in this ticket unless they appear also in one of the dependencies. Even still, I don't see how they could be connected, much less be machine dependent.",
    "created_at": "2017-09-30T23:20:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352537",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:53'></a>I don't see how those failures could be related to the changes in this ticket unless they appear also in one of the dependencies. Even still, I don't see how they could be connected, much less be machine dependent.



---

archive/issue_comments_352538.json:
```json
{
    "body": "<a id='comment:54'></a>I don't see see why either so I agree it is highly unlikely, but since `parent` is modified it is not impossible. It does not need to be machine dependent, it can also be a bug that happens 50% of the time that is exposed after this.\n\nThere are two machines failing on this ticket and I have not seen it on either arando or rk02-math in at least 10 other failing logs that I checked. So from this point of view it is also very unlikely that it is not from this ticket. Of course this ticket could have been very unlucky to expose a rare random bug twice for the first time but this is also highly unlikely.\n\nI just would like to see arguments for why we are in one unlikely scenario and not the other.\n\nNote that this ticket also has a lot of dependencies merged so it could also be exposed by one of the dependencies, which might explain why I didn't see it on any of the arando and rk02-math logsI checked.\n\nIf only we could search through the patchbot log easily, then we could get conclusive answers much faster.",
    "created_at": "2017-10-01T08:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352538",
    "user": "https://github.com/koffie"
}
```

<a id='comment:54'></a>I don't see see why either so I agree it is highly unlikely, but since `parent` is modified it is not impossible. It does not need to be machine dependent, it can also be a bug that happens 50% of the time that is exposed after this.

There are two machines failing on this ticket and I have not seen it on either arando or rk02-math in at least 10 other failing logs that I checked. So from this point of view it is also very unlikely that it is not from this ticket. Of course this ticket could have been very unlucky to expose a rare random bug twice for the first time but this is also highly unlikely.

I just would like to see arguments for why we are in one unlikely scenario and not the other.

Note that this ticket also has a lot of dependencies merged so it could also be exposed by one of the dependencies, which might explain why I didn't see it on any of the arando and rk02-math logsI checked.

If only we could search through the patchbot log easily, then we could get conclusive answers much faster.



---

archive/issue_comments_352539.json:
```json
{
    "body": "<a id='comment:55'></a>I don't think that the failures have anything to do with this ticket, so I'm setting it to positive_review. If the failures are real, then it will fail on Volker's buildbot anyway.",
    "created_at": "2017-10-01T09:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352539",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:55'></a>I don't think that the failures have anything to do with this ticket, so I'm setting it to positive_review. If the failures are real, then it will fail on Volker's buildbot anyway.



---

archive/issue_comments_352540.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-10-01T09:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352540",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_352541.json:
```json
{
    "body": "<a id='comment:56'></a>I also tested it on arando manually (without the patchbot) and that test passed.",
    "created_at": "2017-10-01T09:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352541",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:56'></a>I also tested it on arando manually (without the patchbot) and that test passed.



---

archive/issue_comments_352542.json:
```json
{
    "body": "<a id='comment:57'></a>Before you reported that arando passes all test I kicked the patchbot to get more info. And arando did [fail again on the run resulting from that kick](https://patchbot.sagemath.org/log/23881/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-10-01%2011:59:20?short), while the bug did not occur in [two](https://patchbot.sagemath.org/log/22391/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-09-30%2020:08:17?short) [tests](https://patchbot.sagemath.org/log/15485/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-10-01%2002:45:51?short) ran on arando in between.\n\nI am a bit mystified by the situation since it can't be the optional packages since rk02-math has none, so it must be a randomly occuring bug.",
    "created_at": "2017-10-01T16:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352542",
    "user": "https://github.com/koffie"
}
```

<a id='comment:57'></a>Before you reported that arando passes all test I kicked the patchbot to get more info. And arando did [fail again on the run resulting from that kick](https://patchbot.sagemath.org/log/23881/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-10-01%2011:59:20?short), while the bug did not occur in [two](https://patchbot.sagemath.org/log/22391/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-09-30%2020:08:17?short) [tests](https://patchbot.sagemath.org/log/15485/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-10-01%2002:45:51?short) ran on arando in between.

I am a bit mystified by the situation since it can't be the optional packages since rk02-math has none, so it must be a randomly occuring bug.



---

archive/issue_comments_352543.json:
```json
{
    "body": "<a id='comment:58'></a>I tested this with\n\n```\n./sage -t --long --global-iterations=100 src/sage/schemes/elliptic_curves/sha_tate.py\n```\non arando and they all pass so it is not easily reproducible.",
    "created_at": "2017-10-01T20:04:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352543",
    "user": "https://github.com/koffie"
}
```

<a id='comment:58'></a>I tested this with

```
./sage -t --long --global-iterations=100 src/sage/schemes/elliptic_curves/sha_tate.py
```
on arando and they all pass so it is not easily reproducible.



---

archive/issue_comments_352544.json:
```json
{
    "body": "<a id='comment:59'></a>The sha_tate doctest fails on sage8.1.beta7 without any patches on arando so I created #23962, since arando failed on the 3 tests it ran on this ticket, but none of the other beta6 tests, I still suspect it to be something introduced by one of the dependencies of this ticket that got merged in sage8.1.beta7. Anyway it can't be this ticket so lets move the discussion to #23962.",
    "created_at": "2017-10-03T22:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352544",
    "user": "https://github.com/koffie"
}
```

<a id='comment:59'></a>The sha_tate doctest fails on sage8.1.beta7 without any patches on arando so I created #23962, since arando failed on the 3 tests it ran on this ticket, but none of the other beta6 tests, I still suspect it to be something introduced by one of the dependencies of this ticket that got merged in sage8.1.beta7. Anyway it can't be this ticket so lets move the discussion to #23962.



---

archive/issue_comments_352545.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-10-13T13:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352545",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_352546.json:
```json
{
    "body": "<a id='comment:60'></a>Replying to [comment:46 tscrim]:\n> to prevent anyone else from adding something (although I would say that is highly unlikely).\n\n\nIt seems that precisely this has happened in #23660...",
    "created_at": "2017-10-13T13:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352546",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:60'></a>Replying to [comment:46 tscrim]:
> to prevent anyone else from adding something (although I would say that is highly unlikely).


It seems that precisely this has happened in #23660...



---

archive/issue_comments_352547.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-10-13T13:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352547",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_060829.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-22T17:23:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23881#event-60829"
}
```



---

archive/issue_comments_352548.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-22T17:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352548",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_352549.json:
```json
{
    "body": "<a id='comment:63'></a>Good that this is merged now...",
    "created_at": "2017-10-22T20:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23881#issuecomment-352549",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:63'></a>Good that this is merged now...
