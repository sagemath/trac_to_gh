# Issue 23881: Remove Python access from Parent._element_constructor

archive/issues_023644.json:
```json
{
    "assignees": [],
    "body": "In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. The same for `_element_init_pass_parent`. This way, those attributes can no longer be accessed from Python.\n\nDepends on #23882\nDepends on #23884\nDepends on #23894\nDepends on #23899\nDepends on #23905\nDepends on #23907\nDepends on #23914\nDepends on #24033\n\nCC:  @simon-king-jena @koffie\n\nBranch: **[`41614a7`](https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0)**\n\nReviewer: **Travis Scrimshaw**\n\nAuthor: **Jeroen Demeyer, Simon King**\n\nComponent: **coercion**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23881_\n\n",
    "closed_at": "2017-10-22T17:23:24Z",
    "created_at": "2017-09-18T12:11:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20coercion",
        "https://github.com/sagemath/sage/labels/p%3A%205%20%E2%80%93%20trivial",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Remove Python access from Parent._element_constructor",
    "type": "issue",
    "updated_at": "2017-10-22T20:17:24Z",
    "url": "https://github.com/sagemath/sage/issues/23881",
    "user": "https://github.com/jdemeyer"
}
```
In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. The same for `_element_init_pass_parent`. This way, those attributes can no longer be accessed from Python.

Depends on #23882
Depends on #23884
Depends on #23894
Depends on #23899
Depends on #23905
Depends on #23907
Depends on #23914
Depends on #24033

CC:  @simon-king-jena @koffie

Branch: **[`41614a7`](https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0)**

Reviewer: **Travis Scrimshaw**

Author: **Jeroen Demeyer, Simon King**

Component: **coercion**

_Issue created by migration from https://trac.sagemath.org/ticket/23881_





---

archive/issue_events_333233.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-09-18T12:11:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333233"
}
```



---

archive/issue_events_333234.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-09-18T12:11:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20coercion",
    "label_color": "eeeeee",
    "label_name": "c: coercion",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333234"
}
```



---

archive/issue_events_333235.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-09-18T12:11:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/p%3A%205%20%E2%80%93%20trivial",
    "label_color": "fff9e5",
    "label_name": "p: 5 \u2013 trivial",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333235"
}
```



---

archive/issue_events_333236.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-09-18T12:11:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333236"
}
```



---

archive/issue_comments_360313.json:
```json
{
    "body": "Replying to [ticket:23881 jdemeyer]:\n> In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we rename the latter.\n\nI am not sure whether `_element_constructor` is needed at all. Since `_element_constructor_` has underscores, it is private to a certain extent, but still public enough to be a hook for customisation. That's why I believe a default implementation (which is allowed to override) of `_element_constructor_` should be a replacement of the current `_element_constructor`.",
    "created_at": "2017-09-18T12:27:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360313",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [ticket:23881 jdemeyer]:
> In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we rename the latter.

I am not sure whether `_element_constructor` is needed at all. Since `_element_constructor_` has underscores, it is private to a certain extent, but still public enough to be a hook for customisation. That's why I believe a default implementation (which is allowed to override) of `_element_constructor_` should be a replacement of the current `_element_constructor`.



---

archive/issue_comments_360314.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nReplying to [@simon-king-jena](#comment:1):\n> I am not sure whether `_element_constructor` is needed at all.\n\nI never claimed that it is. Please see my last comments on #23880.",
    "created_at": "2017-09-18T12:30:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360314",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

Replying to [@simon-king-jena](#comment:1):
> I am not sure whether `_element_constructor` is needed at all.

I never claimed that it is. Please see my last comments on #23880.



---

archive/issue_comments_360315.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@jdemeyer](#comment:2):\n> Replying to [@simon-king-jena](#comment:1):\n> > I am not sure whether `_element_constructor` is needed at all.\n\n> \n> I never claimed that it is. Please see my last comments on #23880.\n\nSo, your suggestion is to rename `_element_constructor` into `__construct_element` in order to learn how things work? This could indeed have some benefits: Making it a very private argument, we would see errors if something tries to call it outside of `sage.structure.parents` (due to name mangling). This would indicate how much work it would be to avoid the indirection and directly replace the internal element constructor by the hook.",
    "created_at": "2017-09-18T12:34:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360315",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@jdemeyer](#comment:2):
> Replying to [@simon-king-jena](#comment:1):
> > I am not sure whether `_element_constructor` is needed at all.

> 
> I never claimed that it is. Please see my last comments on #23880.

So, your suggestion is to rename `_element_constructor` into `__construct_element` in order to learn how things work? This could indeed have some benefits: Making it a very private argument, we would see errors if something tries to call it outside of `sage.structure.parents` (due to name mangling). This would indicate how much work it would be to avoid the indirection and directly replace the internal element constructor by the hook.



---

archive/issue_comments_360316.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@simon-king-jena](#comment:3):\n> Making it a very private argument, we would see errors if something tries to call it outside of `sage.structure.parents` (due to name mangling).\n\nNote that a Cython `cdef classes` doesn't do mangling, only Python classes do. So the split would be on the Cython/Python border.",
    "created_at": "2017-09-18T12:36:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360316",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@simon-king-jena](#comment:3):
> Making it a very private argument, we would see errors if something tries to call it outside of `sage.structure.parents` (due to name mangling).

Note that a Cython `cdef classes` doesn't do mangling, only Python classes do. So the split would be on the Cython/Python border.



---

archive/issue_comments_360317.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI guess the following is what we have to change:\n\n```\n$ grep \"_element_constructor \" -r src/sage\nsrc/sage/combinat/subword.py:        if self._element_constructor is tuple:\nsrc/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\nsrc/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\nsrc/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\nsrc/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\nsrc/sage/combinat/sf/k_dual.py:    _element_constructor = _element_constructor_\nsrc/sage/categories/homset.py:        if self._element_constructor is None:\nsrc/sage/categories/sets_cat.py:        # Todo: simplify the _element_constructor definition logic\nsrc/sage/structure/coerce_maps.pyx:        if (<Parent>codomain)._element_constructor is None:\nsrc/sage/structure/parent_base.pyx:    if p._element_constructor is not None:\nsrc/sage/structure/parent.pyx:            self._element_constructor = element_constructor\nsrc/sage/structure/parent.pyx:            sage: k = GF(5); k._element_constructor # indirect doctest\nsrc/sage/structure/parent.pyx:        self._element_constructor = _element_constructor_\nsrc/sage/structure/parent.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent.pyx:                self._element_constructor = self._element_constructor_\nsrc/sage/structure/parent.pyx:        self._element_constructor = element_constructor\nsrc/sage/structure/parent_gens.pyx:    if p._element_constructor is not None:\nsrc/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_old.pyx:    if p._element_constructor is not None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is not None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent_old.pyx:        if self._element_constructor is None:\nsrc/sage/structure/parent_old.pyx:                self._element_constructor = self._element_constructor_\n```\nand\n\n```\n$ grep \"_element_constructor(\" -r src/sage\nsrc/sage/sets/cartesian_product.py:            ``self._element_constructor(elements)``.\nsrc/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/FP_template.pxi:        self._zero = <FPElement?>R._element_constructor(R, 0)\nsrc/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/CR_template.pxi:        self._zero = <CRElement?>R._element_constructor(R, 0)\nsrc/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)\nsrc/sage/rings/finite_rings/hom_prime_finite_field.pyx:            return self._codomain._element_constructor(x)\nsrc/sage/rings/finite_rings/hom_prime_finite_field.pyx:        return self._codomain._element_constructor(x)\nsrc/sage/rings/polynomial/polynomial_element.pyx:            return self.__class__(P,[a], check=False) #P._element_constructor(a, check=False)\nsrc/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))\nsrc/sage/categories/morphism.pyx:            return C._element_constructor(C, x, *args, **kwds)\nsrc/sage/categories/morphism.pyx:            return C._element_constructor(x, *args, **kwds)\nsrc/sage/modular/dirichlet.py:        self._set_element_constructor()\nsrc/sage/structure/coerce_maps.pyx:            return C._element_constructor(C, x)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, **kwds)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, *args)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, *args, **kwds)\nsrc/sage/structure/coerce_maps.pyx:            return C._element_constructor(x)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, **kwds)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, *args)\nsrc/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, *args, **kwds)\nsrc/sage/structure/coerce_maps.pyx:        return C._element_constructor(self._call_(x), *args, **kwds)\nsrc/sage/structure/parent.pyx:            self._set_element_constructor()\nsrc/sage/structure/parent.pyx:    def _set_element_constructor(self):\nsrc/sage/structure/parent_old.pyx:        self._set_element_constructor()\n```",
    "created_at": "2017-09-18T12:38:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360317",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:5" align="right">comment:5</div>

I guess the following is what we have to change:

```
$ grep "_element_constructor " -r src/sage
src/sage/combinat/subword.py:        if self._element_constructor is tuple:
src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
src/sage/combinat/sf/k_dual.py:    _element_constructor = _element_constructor_
src/sage/categories/homset.py:        if self._element_constructor is None:
src/sage/categories/sets_cat.py:        # Todo: simplify the _element_constructor definition logic
src/sage/structure/coerce_maps.pyx:        if (<Parent>codomain)._element_constructor is None:
src/sage/structure/parent_base.pyx:    if p._element_constructor is not None:
src/sage/structure/parent.pyx:            self._element_constructor = element_constructor
src/sage/structure/parent.pyx:            sage: k = GF(5); k._element_constructor # indirect doctest
src/sage/structure/parent.pyx:        self._element_constructor = _element_constructor_
src/sage/structure/parent.pyx:        if self._element_constructor is None:
src/sage/structure/parent.pyx:                self._element_constructor = self._element_constructor_
src/sage/structure/parent.pyx:        self._element_constructor = element_constructor
src/sage/structure/parent_gens.pyx:    if p._element_constructor is not None:
src/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_gens.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_old.pyx:    if p._element_constructor is not None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is not None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is None:
src/sage/structure/parent_old.pyx:        if self._element_constructor is None:
src/sage/structure/parent_old.pyx:                self._element_constructor = self._element_constructor_
```
and

```
$ grep "_element_constructor(" -r src/sage
src/sage/sets/cartesian_product.py:            ``self._element_constructor(elements)``.
src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/FP_template.pxi:        self._zero = <FPElement?>R._element_constructor(R, 0)
src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/CR_template.pxi:        self._zero = <CRElement?>R._element_constructor(R, 0)
src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)
src/sage/rings/finite_rings/hom_prime_finite_field.pyx:            return self._codomain._element_constructor(x)
src/sage/rings/finite_rings/hom_prime_finite_field.pyx:        return self._codomain._element_constructor(x)
src/sage/rings/polynomial/polynomial_element.pyx:            return self.__class__(P,[a], check=False) #P._element_constructor(a, check=False)
src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])
src/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))
src/sage/categories/morphism.pyx:            return C._element_constructor(C, x, *args, **kwds)
src/sage/categories/morphism.pyx:            return C._element_constructor(x, *args, **kwds)
src/sage/modular/dirichlet.py:        self._set_element_constructor()
src/sage/structure/coerce_maps.pyx:            return C._element_constructor(C, x)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, **kwds)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, *args)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(C, x, *args, **kwds)
src/sage/structure/coerce_maps.pyx:            return C._element_constructor(x)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, **kwds)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, *args)
src/sage/structure/coerce_maps.pyx:                    return C._element_constructor(x, *args, **kwds)
src/sage/structure/coerce_maps.pyx:        return C._element_constructor(self._call_(x), *args, **kwds)
src/sage/structure/parent.pyx:            self._set_element_constructor()
src/sage/structure/parent.pyx:    def _set_element_constructor(self):
src/sage/structure/parent_old.pyx:        self._set_element_constructor()
```



---

archive/issue_comments_360318.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@simon-king-jena](#comment:5):\n> \n> ```\n> $ grep \"_element_constructor \" -r src/sage\n> ...\n> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\n> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\n> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\n> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_\n> src/sage/combinat/sf/k_dual.py:    _element_constructor = _element_constructor_\n> ```\n\nThe above is strange. Shouldn't `Parent._set_element_constructor` assign `_element_constructor_` to `_element_constructor` anyway? So, why do it on class level?\n\n> ```\n> $ grep \"_element_constructor(\" -r src/sage\n> ...\n> src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/FP_template.pxi:        self._zero = <FPElement?>R._element_constructor(R, 0)\n> src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/CR_template.pxi:        self._zero = <CRElement?>R._element_constructor(R, 0)\n> src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)\n> src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)\n> ```\n\nHere we could probably use the default implementation of `zero()`.\n\n> ```\n> src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))\n> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)\n> src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))\n> ```\n\nAn internal attribute such as `_element_constructor` shouldn't be mentioned in the docs.",
    "created_at": "2017-09-18T12:43:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360318",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@simon-king-jena](#comment:5):
> 
> ```
> $ grep "_element_constructor " -r src/sage
> ...
> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
> src/sage/combinat/sf/new_kschur.py:    _element_constructor = _element_constructor_
> src/sage/combinat/sf/k_dual.py:    _element_constructor = _element_constructor_
> ```

The above is strange. Shouldn't `Parent._set_element_constructor` assign `_element_constructor_` to `_element_constructor` anyway? So, why do it on class level?

> ```
> $ grep "_element_constructor(" -r src/sage
> ...
> src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/CA_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/FM_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/FP_template.pxi:        self._zero = <FPElement?>R._element_constructor(R, 0)
> src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/FP_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/CR_template.pxi:        self._zero = <CRElement?>R._element_constructor(R, 0)
> src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)
> src/sage/rings/padics/CR_template.pxi:        self._zero = R._element_constructor(R, 0)
> ```

Here we could probably use the default implementation of `zero()`.

> ```
> src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))
> src/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)
> src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))
> ```

An internal attribute such as `_element_constructor` shouldn't be mentioned in the docs.



---

archive/issue_comments_360319.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@simon-king-jena](#comment:5):\n> \n> ```\n> src/sage/combinat/subword.py:        if self._element_constructor is tuple:\n> ```\n\nWhy should it be a tuple?? Very strange.",
    "created_at": "2017-09-18T12:46:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360319",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@simon-king-jena](#comment:5):
> 
> ```
> src/sage/combinat/subword.py:        if self._element_constructor is tuple:
> ```

Why should it be a tuple?? Very strange.



---

archive/issue_comments_360320.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@simon-king-jena](#comment:7):\n> Replying to [@simon-king-jena](#comment:5):\n> > \n> > ```\n> > src/sage/combinat/subword.py:        if self._element_constructor is tuple:\n> > ```\n\n> \n> Why should it be a tuple?? Very strange.\n\nI see: It is not *a* tuple, but it is *the class* <tuple>.\n\nThat's probably a tricky case: The elements are tuples, so, the elements are not instances of `sage.structure.element.Element`, and in particular it is one of the cases where we do not want to pass the parent. It should be possible to customize `_element_constructor_` in that case, but there would be a slow-down, compared with calling the tuple constructor directly (without the additional step of a method that calls the tuple constructor).",
    "created_at": "2017-09-18T12:56:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360320",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@simon-king-jena](#comment:7):
> Replying to [@simon-king-jena](#comment:5):
> > 
> > ```
> > src/sage/combinat/subword.py:        if self._element_constructor is tuple:
> > ```

> 
> Why should it be a tuple?? Very strange.

I see: It is not *a* tuple, but it is *the class* <tuple>.

That's probably a tricky case: The elements are tuples, so, the elements are not instances of `sage.structure.element.Element`, and in particular it is one of the cases where we do not want to pass the parent. It should be possible to customize `_element_constructor_` in that case, but there would be a slow-down, compared with calling the tuple constructor directly (without the additional step of a method that calls the tuple constructor).



---

archive/issue_comments_360321.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@simon-king-jena](#comment:7):\n> Replying to [@simon-king-jena](#comment:5):\n> > \n> > ```\n> > src/sage/combinat/subword.py:        if self._element_constructor is tuple:\n> > ```\n\n> \n> Why should it be a tuple?? Very strange.\n\nlooking at the last few lines of https://github.com/sagemath/sagetrac-mirror/commit/a2915642f7f5357e0d374aaf007680c263cd164c\nmaybe that should have been `self._build`",
    "created_at": "2017-09-18T12:58:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360321",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@simon-king-jena](#comment:7):
> Replying to [@simon-king-jena](#comment:5):
> > 
> > ```
> > src/sage/combinat/subword.py:        if self._element_constructor is tuple:
> > ```

> 
> Why should it be a tuple?? Very strange.

looking at the last few lines of https://github.com/sagemath/sagetrac-mirror/commit/a2915642f7f5357e0d374aaf007680c263cd164c
maybe that should have been `self._build`



---

archive/issue_comments_360322.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@mantepse](#comment:9):\n> looking at the last few lines of https://github.com/sagemath/sagetrac-mirror/commit/a2915642f7f5357e0d374aaf007680c263cd164c\n> maybe that should have been `self._build`\n\nProbably you are right. And the fact that it doesn't fail indicates that it isn't sufficiently tested.",
    "created_at": "2017-09-18T13:00:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360322",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@mantepse](#comment:9):
> looking at the last few lines of https://github.com/sagemath/sagetrac-mirror/commit/a2915642f7f5357e0d374aaf007680c263cd164c
> maybe that should have been `self._build`

Probably you are right. And the fact that it doesn't fail indicates that it isn't sufficiently tested.



---

archive/issue_comments_360323.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@simon-king-jena](#comment:10):\n\n> Probably you are right. And the fact that it doesn't fail indicates that it isn't sufficiently tested.\n\nI just checked, it's just a speedup of a factor 4 - I guess there is no performance testing in sage:\n\n```\nsage: S = Subwords([randint(1,10) for i in range(100)], 3, element_constructor=tuple)\nsage: %timeit len([x for x in S.__iter__()])\n1 loop, best of 3: 322 ms per loop\nsage: %timeit len([x for x in S.__iter_new__()])\n10 loops, best of 3: 85.7 ms per loop\n\nsage: A = [x for x in S.__iter_new__()]\nsage: B = [x for x in S.__iter__()]\nsage: A == B\nTrue\n```",
    "created_at": "2017-09-18T13:08:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360323",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@simon-king-jena](#comment:10):

> Probably you are right. And the fact that it doesn't fail indicates that it isn't sufficiently tested.

I just checked, it's just a speedup of a factor 4 - I guess there is no performance testing in sage:

```
sage: S = Subwords([randint(1,10) for i in range(100)], 3, element_constructor=tuple)
sage: %timeit len([x for x in S.__iter__()])
1 loop, best of 3: 322 ms per loop
sage: %timeit len([x for x in S.__iter_new__()])
10 loops, best of 3: 85.7 ms per loop

sage: A = [x for x in S.__iter_new__()]
sage: B = [x for x in S.__iter__()]
sage: A == B
True
```



---

archive/issue_comments_360324.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@mantepse](#comment:11):\n> sage: A = [x for x in S.__iter_new__()]\n\nWhat is `__iter_new__`?",
    "created_at": "2017-09-18T13:18:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360324",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@mantepse](#comment:11):
> sage: A = [x for x in S.__iter_new__()]

What is `__iter_new__`?



---

archive/issue_comments_360325.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@simon-king-jena](#comment:12):\n> Replying to [@mantepse](#comment:11):\n> > sage: A = [x for x in S.__iter_new__()]\n\n> \n> What is `__iter_new__`?\n\nThat's the new (correct) implementation - I always put in old and new in parallel for the comparison.  That's #23882 now.",
    "created_at": "2017-09-18T13:19:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360325",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@simon-king-jena](#comment:12):
> Replying to [@mantepse](#comment:11):
> > sage: A = [x for x in S.__iter_new__()]

> 
> What is `__iter_new__`?

That's the new (correct) implementation - I always put in old and new in parallel for the comparison.  That's #23882 now.



---

archive/issue_comments_360326.json:
```json
{
    "body": "Dependencies: **#23882**",
    "created_at": "2017-09-18T14:10:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360326",
    "user": "https://github.com/simon-king-jena"
}
```

Dependencies: **#23882**



---

archive/issue_comments_360327.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nOn top of #23882, I propose to first remove `_element_constructor` from the docs, before we rename it in the code.",
    "created_at": "2017-09-18T14:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360327",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:15" align="right">comment:15</div>

On top of #23882, I propose to first remove `_element_constructor` from the docs, before we rename it in the code.



---

archive/issue_comments_360328.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI think the following grep is also needed:\n\n```\ngrep -r --color -nH \"_element_constructor$\"  *\ncategories/sets_cat.py:964:                sage: A._element_constructor\ncategories/sets_cat.py:970:                sage: B._element_constructor\ncombinat/integer_lists/lists.py:173:        a = self._element_constructor\ncombinat/integer_lists/lists.py:174:        b = other._element_constructor\ncombinat/integer_lists/lists.py:281:            sage: L._element_constructor\nstructure/parent.pxd:13:    cdef public _element_constructor\nstructure/parent.pyx:776:        d['_element_constructor'] = self._element_constructor\nstructure/parent.pyx:1869:                element_constructor = (<Parent>S)._element_constructor\n```",
    "created_at": "2017-09-18T14:30:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360328",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:16" align="right">comment:16</div>

I think the following grep is also needed:

```
grep -r --color -nH "_element_constructor$"  *
categories/sets_cat.py:964:                sage: A._element_constructor
categories/sets_cat.py:970:                sage: B._element_constructor
combinat/integer_lists/lists.py:173:        a = self._element_constructor
combinat/integer_lists/lists.py:174:        b = other._element_constructor
combinat/integer_lists/lists.py:281:            sage: L._element_constructor
structure/parent.pxd:13:    cdef public _element_constructor
structure/parent.pyx:776:        d['_element_constructor'] = self._element_constructor
structure/parent.pyx:1869:                element_constructor = (<Parent>S)._element_constructor
```



---

archive/issue_comments_360329.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nand another one:\n\n```\ngrep -r --color -nH \"_element_constructor =\"  *\ncombinat/sf/k_dual.py:923:    _element_constructor = _element_constructor_\ncombinat/sf/new_kschur.py:1021:    _element_constructor = _element_constructor_\ncombinat/sf/new_kschur.py:1279:    _element_constructor = _element_constructor_\ncombinat/sf/new_kschur.py:1395:    _element_constructor = _element_constructor_\ncombinat/sf/new_kschur.py:1472:    _element_constructor = _element_constructor_\nstructure/parent_old.pyx:397:                self._element_constructor = self._element_constructor_\nstructure/parent.pyx:316:            self._element_constructor = element_constructor\nstructure/parent.pyx:607:        self._element_constructor = _element_constructor_\nstructure/parent.pyx:914:                self._element_constructor = self._element_constructor_\nstructure/parent.pyx:1452:        self._element_constructor = element_constructor\n```",
    "created_at": "2017-09-18T14:31:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360329",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:17" align="right">comment:17</div>

and another one:

```
grep -r --color -nH "_element_constructor ="  *
combinat/sf/k_dual.py:923:    _element_constructor = _element_constructor_
combinat/sf/new_kschur.py:1021:    _element_constructor = _element_constructor_
combinat/sf/new_kschur.py:1279:    _element_constructor = _element_constructor_
combinat/sf/new_kschur.py:1395:    _element_constructor = _element_constructor_
combinat/sf/new_kschur.py:1472:    _element_constructor = _element_constructor_
structure/parent_old.pyx:397:                self._element_constructor = self._element_constructor_
structure/parent.pyx:316:            self._element_constructor = element_constructor
structure/parent.pyx:607:        self._element_constructor = _element_constructor_
structure/parent.pyx:914:                self._element_constructor = self._element_constructor_
structure/parent.pyx:1452:        self._element_constructor = element_constructor
```



---

archive/issue_comments_360330.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe documentation already is a lot worse than I thought:\n\n```\n$ grep \"_element_constructor\" -r src/sage | grep \"sage\\:\"\nsrc/sage/schemes/toric/variety.py:            sage: H._element_constructor_(1)\nsrc/sage/schemes/toric/divisor.py:            sage: TDiv._element_constructor_([ (1,P2.gen(2)) ])\nsrc/sage/schemes/toric/divisor.py:            sage: Cl._element_constructor_(D)\nsrc/sage/schemes/toric/homset.py:            sage: hom_set(fm)     # calls hom_set._element_constructor_()\nsrc/sage/schemes/product_projective/homset.py:            sage: P(QQ)._element_constructor_([4, 2, 2, 0])\nsrc/sage/schemes/generic/homset.py:            sage: H._element_constructor_(f)\nsrc/sage/schemes/generic/homset.py:            sage: F_points._element_constructor_([4,2*a])\nsrc/sage/schemes/projective/projective_homset.py:            sage: X._element_constructor_([0,1,0])\nsrc/sage/schemes/affine/affine_homset.py:            sage: H._element_constructor_(ring_hom)\nsrc/sage/numerical/linear_tensor.py:            sage: LT._element_constructor_(123)\nsrc/sage/numerical/linear_functions.pyx:            sage: LF._element_constructor_(123)\nsrc/sage/numerical/linear_functions.pyx:            sage: LC._element_constructor_(1, 2)\nsrc/sage/numerical/linear_tensor_constraints.py:            sage: LTC._element_constructor_(1, 2, True)\nsrc/sage/sets/disjoint_union_enumerated_sets.py:            sage: U._element_constructor_\nsrc/sage/sets/disjoint_union_enumerated_sets.py:            sage: U._element_constructor_\nsrc/sage/sets/disjoint_union_enumerated_sets.py:            sage: p = X._element_constructor_((0, []))  # indirect doctest\nsrc/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(42)\nsrc/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(-5)\nsrc/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(x)\nsrc/sage/groups/affine_gps/euclidean_group.py:            sage: E3._element_constructor_check(A, b)\nsrc/sage/groups/affine_gps/euclidean_group.py:            sage: E3._element_constructor_check(A, b)\nsrc/sage/groups/affine_gps/affine_group.py:            sage: Aff3._element_constructor_check(A, b)\nsrc/sage/groups/affine_gps/affine_group.py:            sage: Aff3._element_constructor_check(A, b)\nsrc/sage/rings/fraction_field.py:            sage: F._element_constructor_(1)\nsrc/sage/rings/fraction_field.py:            sage: F._element_constructor_(F.gen(0)/F.gen(1))\nsrc/sage/rings/fraction_field.py:            sage: F._element_constructor_('1 + x/y')\nsrc/sage/rings/fraction_field.py:            sage: F._element_constructor_(x/y)\nsrc/sage/rings/fraction_field.py:            sage: K._element_constructor_(2, 'x+y')\nsrc/sage/rings/fraction_field.py:            sage: K._element_constructor_(1, 'z')\nsrc/sage/rings/finite_rings/residue_field.pyx:            sage: ResidueField_generic._element_constructor_(F, i)\nsrc/sage/rings/finite_rings/residue_field.pyx:            sage: ResidueField_generic._element_constructor_(F, GF(13)(8))\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(1/2)\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(x*y)\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(y*x)\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(1)\nsrc/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(0)\nsrc/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(m)\nsrc/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(p)\nsrc/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(p).parent()\nsrc/sage/rings/function_field/function_field.py:            sage: L._element_constructor_(L.polynomial_ring().gen())\nsrc/sage/rings/function_field/function_field.py:            sage: a = K._element_constructor_(K.maximal_order().gen()); a\nsrc/sage/rings/function_field/function_field_order.py:            sage: K.maximal_order()._element_constructor_(x)\nsrc/sage/rings/function_field/function_field_order.py:            sage: O._element_constructor_(y)\nsrc/sage/rings/function_field/function_field_order.py:            sage: O._element_constructor_(1/y)\nsrc/sage/combinat/rooted_tree.py:            sage: B._element_constructor_([])\nsrc/sage/combinat/root_system/weyl_characters.py:            sage: A2._element_constructor_([2,1,0])\nsrc/sage/combinat/root_system/weyl_characters.py:            sage: A2._element_constructor_([2,1,0])\nsrc/sage/combinat/root_system/associahedron.py:            sage: parent._element_constructor_(['A',2])\nsrc/sage/combinat/finite_class.py:            sage: F._element_constructor_(1)\nsrc/sage/combinat/partition_tuple.py:            sage: PartitionTuples._element_constructor_(PartitionTuples(), [[2,1],[3,2],[1,1,1]])\nsrc/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor_nocheck([1,2,3])\nsrc/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor\nsrc/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])\nsrc/sage/combinat/binary_tree.py:            sage: B._element_constructor_([])\nsrc/sage/combinat/binary_tree.py:            sage: FB._element_constructor_([])\nsrc/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_([2,1,3])\nsrc/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_(Permutation([2,1,3]))\nsrc/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_([1,2,1])\nsrc/sage/combinat/sf/classical.py:            sage: s._element_constructor_(McdJ(s[2,1]))\nsrc/sage/combinat/posets/linear_extensions.py:            sage: x = L._element_constructor_([1,2,4,3]); x\nsrc/sage/combinat/posets/linear_extensions.py:            sage: L._element_constructor_([4,3,2,1])\nsrc/sage/combinat/posets/linear_extensions.py:            sage: L._element_constructor_([4,3,2,1],check=False)\nsrc/sage/geometry/triangulation/point_configuration.py:            sage: p._element_constructor_([ (0,1,2), (2,3,0) ])\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))\nsrc/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)\nsrc/sage/geometry/polyhedron/parent.py:            sage: P._element_constructor_([[(0, 0, 0), (1, 0, 0), (0, 1, 0), (0,0,1)], [], []], None)\nsrc/sage/geometry/hyperplane_arrangement/hyperplane.py:        sage: ambient._element_constructor_(x+y-1)   \nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_(x, y)\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([x, y])\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([0, 1, 0], [0, 0, 1])\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([[0, 1, 0], [0, 0, 1]])\nsrc/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))\nsrc/sage/homology/chain_complex.py:            sage: D._element_constructor_(0)\nsrc/sage/tensor/modules/free_module_homset.py:            sage: phi = H._element_constructor_([[2,-1,3], [1,0,-4]], bases=(e,f),\nsrc/sage/tensor/modules/free_module_homset.py:            sage: phi = EM._element_constructor_([[1,2,3],[4,5,6],[7,8,9]],\nsrc/sage/tensor/modules/free_module_homset.py:            sage: phi_a = EM._element_constructor_(a) ; phi_a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([], name='a') ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([2,0,-1], name='a') ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a\nsrc/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([], name='a') ; a\nsrc/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_(comp=[1,0,-2], basis=e, name='v') ; v\nsrc/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_(0) ; v\nsrc/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_() ; v\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(comp=[[1,2],[1,3]], basis=e,\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: GL._element_constructor_(1)\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: GL._element_constructor_(1).matrix(e)\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(phi) ; a\nsrc/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(t) ; a\nsrc/sage/tensor/modules/tensor_free_module.py:            sage: T._element_constructor_(0) is T.zero()\nsrc/sage/tensor/modules/tensor_free_module.py:            sage: t = T._element_constructor_(comp=[[2,0],[1/2,-3]], basis=e,\nsrc/sage/categories/sets_cat.py:                sage: S._element_constructor_(17)\nsrc/sage/categories/sets_cat.py:                sage: A._element_constructor\nsrc/sage/categories/sets_cat.py:                sage: B._element_constructor\nsrc/sage/categories/sets_cat.py:                sage: s = S._element_constructor_from_element_class(17); s\nsrc/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('a')\nsrc/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('bad')\nsrc/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('z')\nsrc/sage/categories/examples/semigroups.py:            sage: bad = F._element_constructor_('bad'); bad\nsrc/sage/categories/examples/semigroups.py:            sage: type(S._element_constructor_(17))\nsrc/sage/categories/examples/semigroups.py:            sage: S._element_constructor_(17)\nsrc/sage/categories/examples/semigroups.py:            sage: type(S._element_constructor_(17))\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(13) == 13\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(13).parent()\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)\nsrc/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)\nsrc/sage/structure/parent.pyx:            sage: k = GF(5); k._element_constructor # indirect doctest\nsrc/sage/structure/set_factories.py:            sage: pol.self_element_constructor_attributes(XYPair)\nsrc/sage/structure/set_factories.py:            sage: pol.facade_element_constructor_attributes(XYPairs())\nsrc/sage/manifolds/differentiable/real_line.py:            sage: I((2,))  # standard used of TopologicalManifoldSubset._element_constructor_\nsrc/sage/algebras/steenrod/steenrod_algebra.py:            sage: A1._element_constructor_(Sq(2))\nsrc/sage/algebras/steenrod/steenrod_algebra.py:            sage: A1._element_constructor_(Sq(4)) # Sq(4) not in A1\nsrc/sage/algebras/free_algebra_quotient.py:            sage: H._element_constructor_(i) is i\nsrc/sage/algebras/free_algebra_quotient.py:            sage: a = H._element_constructor_(1); a\nsrc/sage/algebras/free_algebra_quotient.py:            sage: a = H._element_constructor_([1,2,3,4]); a\n```\n\nOf course, the documentation should explain how to implement `_element_constructor_`. However, the documentation must not suggest that the method (with or without trailing underscore) should ever be called directly.",
    "created_at": "2017-09-18T14:33:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360330",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:18" align="right">comment:18</div>

The documentation already is a lot worse than I thought:

```
$ grep "_element_constructor" -r src/sage | grep "sage\:"
src/sage/schemes/toric/variety.py:            sage: H._element_constructor_(1)
src/sage/schemes/toric/divisor.py:            sage: TDiv._element_constructor_([ (1,P2.gen(2)) ])
src/sage/schemes/toric/divisor.py:            sage: Cl._element_constructor_(D)
src/sage/schemes/toric/homset.py:            sage: hom_set(fm)     # calls hom_set._element_constructor_()
src/sage/schemes/product_projective/homset.py:            sage: P(QQ)._element_constructor_([4, 2, 2, 0])
src/sage/schemes/generic/homset.py:            sage: H._element_constructor_(f)
src/sage/schemes/generic/homset.py:            sage: F_points._element_constructor_([4,2*a])
src/sage/schemes/projective/projective_homset.py:            sage: X._element_constructor_([0,1,0])
src/sage/schemes/affine/affine_homset.py:            sage: H._element_constructor_(ring_hom)
src/sage/numerical/linear_tensor.py:            sage: LT._element_constructor_(123)
src/sage/numerical/linear_functions.pyx:            sage: LF._element_constructor_(123)
src/sage/numerical/linear_functions.pyx:            sage: LC._element_constructor_(1, 2)
src/sage/numerical/linear_tensor_constraints.py:            sage: LTC._element_constructor_(1, 2, True)
src/sage/sets/disjoint_union_enumerated_sets.py:            sage: U._element_constructor_
src/sage/sets/disjoint_union_enumerated_sets.py:            sage: U._element_constructor_
src/sage/sets/disjoint_union_enumerated_sets.py:            sage: p = X._element_constructor_((0, []))  # indirect doctest
src/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(42)
src/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(-5)
src/sage/sets/non_negative_integers.py:            sage: NN._element_constructor_(x)
src/sage/groups/affine_gps/euclidean_group.py:            sage: E3._element_constructor_check(A, b)
src/sage/groups/affine_gps/euclidean_group.py:            sage: E3._element_constructor_check(A, b)
src/sage/groups/affine_gps/affine_group.py:            sage: Aff3._element_constructor_check(A, b)
src/sage/groups/affine_gps/affine_group.py:            sage: Aff3._element_constructor_check(A, b)
src/sage/rings/fraction_field.py:            sage: F._element_constructor_(1)
src/sage/rings/fraction_field.py:            sage: F._element_constructor_(F.gen(0)/F.gen(1))
src/sage/rings/fraction_field.py:            sage: F._element_constructor_('1 + x/y')
src/sage/rings/fraction_field.py:            sage: F._element_constructor_(x/y)
src/sage/rings/fraction_field.py:            sage: K._element_constructor_(2, 'x+y')
src/sage/rings/fraction_field.py:            sage: K._element_constructor_(1, 'z')
src/sage/rings/finite_rings/residue_field.pyx:            sage: ResidueField_generic._element_constructor_(F, i)
src/sage/rings/finite_rings/residue_field.pyx:            sage: ResidueField_generic._element_constructor_(F, GF(13)(8))
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(1/2)
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(x*y)
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(y*x)
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(1)
src/sage/rings/polynomial/plural.pyx:            sage: P._element_constructor_(0)
src/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(m)
src/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(p)
src/sage/rings/multi_power_series_ring.py:            sage: M._element_constructor_(p).parent()
src/sage/rings/function_field/function_field.py:            sage: L._element_constructor_(L.polynomial_ring().gen())
src/sage/rings/function_field/function_field.py:            sage: a = K._element_constructor_(K.maximal_order().gen()); a
src/sage/rings/function_field/function_field_order.py:            sage: K.maximal_order()._element_constructor_(x)
src/sage/rings/function_field/function_field_order.py:            sage: O._element_constructor_(y)
src/sage/rings/function_field/function_field_order.py:            sage: O._element_constructor_(1/y)
src/sage/combinat/rooted_tree.py:            sage: B._element_constructor_([])
src/sage/combinat/root_system/weyl_characters.py:            sage: A2._element_constructor_([2,1,0])
src/sage/combinat/root_system/weyl_characters.py:            sage: A2._element_constructor_([2,1,0])
src/sage/combinat/root_system/associahedron.py:            sage: parent._element_constructor_(['A',2])
src/sage/combinat/finite_class.py:            sage: F._element_constructor_(1)
src/sage/combinat/partition_tuple.py:            sage: PartitionTuples._element_constructor_(PartitionTuples(), [[2,1],[3,2],[1,1,1]])
src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor_nocheck([1,2,3])
src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor
src/sage/combinat/integer_lists/lists.py:            sage: L._element_constructor([1,2,3])
src/sage/combinat/binary_tree.py:            sage: B._element_constructor_([])
src/sage/combinat/binary_tree.py:            sage: FB._element_constructor_([])
src/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_([2,1,3])
src/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_(Permutation([2,1,3]))
src/sage/combinat/schubert_polynomial.py:            sage: X._element_constructor_([1,2,1])
src/sage/combinat/sf/classical.py:            sage: s._element_constructor_(McdJ(s[2,1]))
src/sage/combinat/posets/linear_extensions.py:            sage: x = L._element_constructor_([1,2,4,3]); x
src/sage/combinat/posets/linear_extensions.py:            sage: L._element_constructor_([4,3,2,1])
src/sage/combinat/posets/linear_extensions.py:            sage: L._element_constructor_([4,3,2,1],check=False)
src/sage/geometry/triangulation/point_configuration.py:            sage: p._element_constructor_([ (0,1,2), (2,3,0) ])
src/sage/geometry/linear_expression.py:            sage: L._element_constructor([1, 2, 3], 4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector(ZZ, [1, 2, 3]), 4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(4)
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(vector([4, 1, 2, 3]))
src/sage/geometry/linear_expression.py:            sage: L._element_constructor(m)
src/sage/geometry/polyhedron/parent.py:            sage: P._element_constructor_([[(0, 0, 0), (1, 0, 0), (0, 1, 0), (0,0,1)], [], []], None)
src/sage/geometry/hyperplane_arrangement/hyperplane.py:        sage: ambient._element_constructor_(x+y-1)   
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_(x, y)
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([x, y])
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([0, 1, 0], [0, 0, 1])
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor_([[0, 1, 0], [0, 0, 1]])
src/sage/geometry/hyperplane_arrangement/arrangement.py:            sage: L._element_constructor(polytopes.hypercube(2))
src/sage/homology/chain_complex.py:            sage: D._element_constructor_(0)
src/sage/tensor/modules/free_module_homset.py:            sage: phi = H._element_constructor_([[2,-1,3], [1,0,-4]], bases=(e,f),
src/sage/tensor/modules/free_module_homset.py:            sage: phi = EM._element_constructor_([[1,2,3],[4,5,6],[7,8,9]],
src/sage/tensor/modules/free_module_homset.py:            sage: phi_a = EM._element_constructor_(a) ; phi_a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([], name='a') ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([2,0,-1], name='a') ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_(0) ; a
src/sage/tensor/modules/ext_pow_free_module.py:            sage: a = A._element_constructor_([], name='a') ; a
src/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_(comp=[1,0,-2], basis=e, name='v') ; v
src/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_(0) ; v
src/sage/tensor/modules/finite_rank_free_module.py:            sage: v = M._element_constructor_() ; v
src/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(comp=[[1,2],[1,3]], basis=e,
src/sage/tensor/modules/free_module_linear_group.py:            sage: GL._element_constructor_(1)
src/sage/tensor/modules/free_module_linear_group.py:            sage: GL._element_constructor_(1).matrix(e)
src/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(phi) ; a
src/sage/tensor/modules/free_module_linear_group.py:            sage: a = GL._element_constructor_(t) ; a
src/sage/tensor/modules/tensor_free_module.py:            sage: T._element_constructor_(0) is T.zero()
src/sage/tensor/modules/tensor_free_module.py:            sage: t = T._element_constructor_(comp=[[2,0],[1/2,-3]], basis=e,
src/sage/categories/sets_cat.py:                sage: S._element_constructor_(17)
src/sage/categories/sets_cat.py:                sage: A._element_constructor
src/sage/categories/sets_cat.py:                sage: B._element_constructor
src/sage/categories/sets_cat.py:                sage: s = S._element_constructor_from_element_class(17); s
src/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('a')
src/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('bad')
src/sage/categories/examples/semigroups.py:            sage: F._element_constructor_('z')
src/sage/categories/examples/semigroups.py:            sage: bad = F._element_constructor_('bad'); bad
src/sage/categories/examples/semigroups.py:            sage: type(S._element_constructor_(17))
src/sage/categories/examples/semigroups.py:            sage: S._element_constructor_(17)
src/sage/categories/examples/semigroups.py:            sage: type(S._element_constructor_(17))
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(13) == 13
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(13).parent()
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)
src/sage/categories/examples/sets_cat.py:            sage: P._element_constructor_(14)
src/sage/structure/parent.pyx:            sage: k = GF(5); k._element_constructor # indirect doctest
src/sage/structure/set_factories.py:            sage: pol.self_element_constructor_attributes(XYPair)
src/sage/structure/set_factories.py:            sage: pol.facade_element_constructor_attributes(XYPairs())
src/sage/manifolds/differentiable/real_line.py:            sage: I((2,))  # standard used of TopologicalManifoldSubset._element_constructor_
src/sage/algebras/steenrod/steenrod_algebra.py:            sage: A1._element_constructor_(Sq(2))
src/sage/algebras/steenrod/steenrod_algebra.py:            sage: A1._element_constructor_(Sq(4)) # Sq(4) not in A1
src/sage/algebras/free_algebra_quotient.py:            sage: H._element_constructor_(i) is i
src/sage/algebras/free_algebra_quotient.py:            sage: a = H._element_constructor_(1); a
src/sage/algebras/free_algebra_quotient.py:            sage: a = H._element_constructor_([1,2,3,4]); a
```

Of course, the documentation should explain how to implement `_element_constructor_`. However, the documentation must not suggest that the method (with or without trailing underscore) should ever be called directly.



---

archive/issue_comments_360331.json:
```json
{
    "body": "Branch: **[u/jdemeyer/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rename_parent__element_constructor____parent___construct_element)**",
    "created_at": "2017-09-18T14:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360331",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rename_parent__element_constructor____parent___construct_element)**



---

archive/issue_comments_360332.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9ce136ca7810be46edf7f90b5ff598f91214bf3\"><code>e9ce136</code></a></td><td><code>_element_constructor was an attribute of Subword before it was replaced with _build</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/93e25fb2489c5a98c8ec2a018d23754987ce6937\"><code>93e25fb</code></a></td><td><code>Rename Parent._element_constructor -> Parent.__construct_element</code></td></tr></table>\n",
    "created_at": "2017-09-18T14:55:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360332",
    "user": "https://github.com/koffie"
}
```

<div id="comment:20"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9ce136ca7810be46edf7f90b5ff598f91214bf3"><code>e9ce136</code></a></td><td><code>_element_constructor was an attribute of Subword before it was replaced with _build</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/93e25fb2489c5a98c8ec2a018d23754987ce6937"><code>93e25fb</code></a></td><td><code>Rename Parent._element_constructor -> Parent.__construct_element</code></td></tr></table>




---

archive/issue_comments_360333.json:
```json
{
    "body": "Commit: **[`93e25fb`](https://github.com/sagemath/sagetrac-mirror/commit/93e25fb2489c5a98c8ec2a018d23754987ce6937)**",
    "created_at": "2017-09-18T14:55:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360333",
    "user": "https://github.com/koffie"
}
```

Commit: **[`93e25fb`](https://github.com/sagemath/sagetrac-mirror/commit/93e25fb2489c5a98c8ec2a018d23754987ce6937)**



---

archive/issue_comments_360334.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rename_parent__element_constructor____parent___construct_element)** to **[u/SimonKing/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/rename_parent__element_constructor____parent___construct_element)**",
    "created_at": "2017-09-18T15:00:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360334",
    "user": "https://github.com/simon-king-jena"
}
```

Changed branch from **[u/jdemeyer/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rename_parent__element_constructor____parent___construct_element)** to **[u/SimonKing/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/rename_parent__element_constructor____parent___construct_element)**



---

archive/issue_comments_360335.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nBriefly looking at your commit: I find it a good idea that you are using a `cdef __construct_element` instead of a `cdef public _element_constructor`, because in that way it is certain that no Python class will illegally use the internal element constructor. I also see that you make pickling backward compatible.\n\nMy commit fixes one part of the documentation (in sage.schemes).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c95b72453d16b13feff90c0308cdec5b3e4c5ac0\"><code>c95b724</code></a></td><td><code>Remove ._element_constructor_ from sage.schemes documentation</code></td></tr></table>\n",
    "created_at": "2017-09-18T15:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360335",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:22" align="right">comment:22</div>

Briefly looking at your commit: I find it a good idea that you are using a `cdef __construct_element` instead of a `cdef public _element_constructor`, because in that way it is certain that no Python class will illegally use the internal element constructor. I also see that you make pickling backward compatible.

My commit fixes one part of the documentation (in sage.schemes).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c95b72453d16b13feff90c0308cdec5b3e4c5ac0"><code>c95b724</code></a></td><td><code>Remove ._element_constructor_ from sage.schemes documentation</code></td></tr></table>




---

archive/issue_comments_360336.json:
```json
{
    "body": "Changed commit from **[`93e25fb`](https://github.com/sagemath/sagetrac-mirror/commit/93e25fb2489c5a98c8ec2a018d23754987ce6937)** to **[`c95b724`](https://github.com/sagemath/sagetrac-mirror/commit/c95b72453d16b13feff90c0308cdec5b3e4c5ac0)**",
    "created_at": "2017-09-18T15:02:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360336",
    "user": "https://github.com/simon-king-jena"
}
```

Changed commit from **[`93e25fb`](https://github.com/sagemath/sagetrac-mirror/commit/93e25fb2489c5a98c8ec2a018d23754987ce6937)** to **[`c95b724`](https://github.com/sagemath/sagetrac-mirror/commit/c95b72453d16b13feff90c0308cdec5b3e4c5ac0)**



---

archive/issue_comments_360337.json:
```json
{
    "body": "Changed author from **Jeroen Demeyer** to **Jeroen Demeyer, Simon King**",
    "created_at": "2017-09-18T15:10:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360337",
    "user": "https://github.com/simon-king-jena"
}
```

Changed author from **Jeroen Demeyer** to **Jeroen Demeyer, Simon King**



---

archive/issue_comments_360338.json:
```json
{
    "body": "Changed dependencies from **#23882** to **#23882, #23884**",
    "created_at": "2017-09-18T15:36:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360338",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#23882** to **#23882, #23884**



---

archive/issue_comments_360339.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nSo far, the git commits come from Maarten and me, so, I guess the Authors field should be changed accordingly.\n\nOn a different ticket, Jeroen said that he likes small tickets. I guess that means I should open a new ticket for cleanup of the documentation.\n\nI suggest, in order to not change things in git that have already been done, to let commit:c95b724 (Remove ._element_constructor_ from sage.schemes documentation) stay here and open a new ticket for other documentation issues.\n\nFirst of all, the failures resulting from Maarten's commit should be addressed.",
    "created_at": "2017-09-18T16:02:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360339",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:25" align="right">comment:25</div>

So far, the git commits come from Maarten and me, so, I guess the Authors field should be changed accordingly.

On a different ticket, Jeroen said that he likes small tickets. I guess that means I should open a new ticket for cleanup of the documentation.

I suggest, in order to not change things in git that have already been done, to let commit:c95b724 (Remove ._element_constructor_ from sage.schemes documentation) stay here and open a new ticket for other documentation issues.

First of all, the failures resulting from Maarten's commit should be addressed.



---

archive/issue_comments_360340.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@simon-king-jena](#comment:25):\n> First of all, the failures resulting from Maarten's commit should be addressed.\n\nNope. Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.",
    "created_at": "2017-09-18T16:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360340",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@simon-king-jena](#comment:25):
> First of all, the failures resulting from Maarten's commit should be addressed.

Nope. Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.



---

archive/issue_comments_360341.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@simon-king-jena](#comment:26):\n> Replying to [@simon-king-jena](#comment:25):\n> > First of all, the failures resulting from Maarten's commit should be addressed.\n\n> \n> Nope. Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.\n\nAnyway, if we are lucky, merging Jeroen's branch from #23884 will fix the issue. I am trying that now.",
    "created_at": "2017-09-18T16:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360341",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@simon-king-jena](#comment:26):
> Replying to [@simon-king-jena](#comment:25):
> > First of all, the failures resulting from Maarten's commit should be addressed.

> 
> Nope. Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.

Anyway, if we are lucky, merging Jeroen's branch from #23884 will fix the issue. I am trying that now.



---

archive/issue_comments_360342.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nFor the doc of binary trees, it is #23885",
    "created_at": "2017-09-18T18:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360342",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:28" align="right">comment:28</div>

For the doc of binary trees, it is #23885



---

archive/issue_comments_360343.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nFor the remainder of combinat, it is #23889.  However, I'm not so sure about this anymore: `_element_constructor_` is a private method, so it won't show up in the documentation anyway?  So, isn't it correct to doctest it directly?",
    "created_at": "2017-09-19T06:42:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360343",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:29" align="right">comment:29</div>

For the remainder of combinat, it is #23889.  However, I'm not so sure about this anymore: `_element_constructor_` is a private method, so it won't show up in the documentation anyway?  So, isn't it correct to doctest it directly?



---

archive/issue_comments_360344.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@simon-king-jena](#comment:26):\n> Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.\n\nI don't really get this. The padic failures need to be fixed anyway, either here or on #23884. Why don't you like to do it on a different ticket?",
    "created_at": "2017-09-19T13:14:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360344",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@simon-king-jena](#comment:26):
> Some failures come from padics. So, first #23884 needs to be fixed. That's why I don't like creating many small tickets.

I don't really get this. The padic failures need to be fixed anyway, either here or on #23884. Why don't you like to do it on a different ticket?



---

archive/issue_comments_360345.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@simon-king-jena](#comment:26):\n> That's why I don't like creating many small tickets.\n\nInterestingly, you are the first person I am hearing this from.\n\nAdvantages of small tickets:\n\n1. Small tickets are easier to review because the reviewer only needs to look at a small set of changes.\n\n2. Different tickets can have different sets of authors/reviewers, each with their own interests/specialities.\n\n3. Small tickets are less likely to get stuck because of one isolated difficulty. For example: a ticket like \"stop using `_element_constructor`\" cannot succeed as long as there is one isolated place where `_element_constructor` is used non-trivially. A ticket like \"stop using `_element_constructor` in sub-package foo\" does not have this problem.\n\nUsually, when working on a big ticket like #23880 (big in the sense that it has a lot of connections to other parts of Sage, it is very non-local), I start coding and then split off separate tickets as I go along.",
    "created_at": "2017-09-19T13:24:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360345",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@simon-king-jena](#comment:26):
> That's why I don't like creating many small tickets.

Interestingly, you are the first person I am hearing this from.

Advantages of small tickets:

1. Small tickets are easier to review because the reviewer only needs to look at a small set of changes.

2. Different tickets can have different sets of authors/reviewers, each with their own interests/specialities.

3. Small tickets are less likely to get stuck because of one isolated difficulty. For example: a ticket like "stop using `_element_constructor`" cannot succeed as long as there is one isolated place where `_element_constructor` is used non-trivially. A ticket like "stop using `_element_constructor` in sub-package foo" does not have this problem.

Usually, when working on a big ticket like #23880 (big in the sense that it has a lot of connections to other parts of Sage, it is very non-local), I start coding and then split off separate tickets as I go along.



---

archive/issue_comments_360346.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?",
    "created_at": "2017-09-19T13:38:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360346",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:32" align="right">comment:32</div>

I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?



---

archive/issue_comments_360347.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@mantepse](#comment:32):\n> I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?\n\nIn the end, both should be tested: direct and indirect tests. In most cases, the indirect usage is already tested (many doctests indirectly use `_element_constructor_`). So, yes, I think that `_element_constructor_` should be tested directly.",
    "created_at": "2017-09-19T13:42:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360347",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@mantepse](#comment:32):
> I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?

In the end, both should be tested: direct and indirect tests. In most cases, the indirect usage is already tested (many doctests indirectly use `_element_constructor_`). So, yes, I think that `_element_constructor_` should be tested directly.



---

archive/issue_comments_360348.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@jdemeyer](#comment:33):\n> Replying to [@mantepse](#comment:32):\n> > I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?\n\n> \n> In the end, both should be tested: direct and indirect tests. In most cases, the indirect usage is already tested (many doctests indirectly use `_element_constructor_`). So, yes, I think that `_element_constructor_` should be tested directly.\n\nSeriously??? When I was younger, I occasionally did direct tests (say, for `__iter__`) and was told to not do that.\n\nI also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the \"EXAMPLES:\" section) has to show how stuff is actually being used. It may be possible to be a bit more explicit in the \"TESTS:\" section, but still I'd recommend against it.\n\nIt is clear from the tutorials that `_repr_`, `_add_`, `_mul_` and `_element_constructor_` (all *single* underscore!) in Sage implement string representation of parents/elements, addition resp. multiplication of elements, and the call method of parents. Thus, all these methods should be tested indirectly:\n\n```\nsage: P    # indirect doctest\nString representation\nsage: x+y  # indirect doctest\nresult of addition\nsage: P(x) # indirect doctest\nresult of conversion\n```",
    "created_at": "2017-09-19T13:47:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360348",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@jdemeyer](#comment:33):
> Replying to [@mantepse](#comment:32):
> > I'd be genuinly interested: shouldn't doctests of a private method like `_element_constructor_` better doctest this method directly?  Or should I ask this on sage-devel?

> 
> In the end, both should be tested: direct and indirect tests. In most cases, the indirect usage is already tested (many doctests indirectly use `_element_constructor_`). So, yes, I think that `_element_constructor_` should be tested directly.

Seriously??? When I was younger, I occasionally did direct tests (say, for `__iter__`) and was told to not do that.

I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the "EXAMPLES:" section) has to show how stuff is actually being used. It may be possible to be a bit more explicit in the "TESTS:" section, but still I'd recommend against it.

It is clear from the tutorials that `_repr_`, `_add_`, `_mul_` and `_element_constructor_` (all *single* underscore!) in Sage implement string representation of parents/elements, addition resp. multiplication of elements, and the call method of parents. Thus, all these methods should be tested indirectly:

```
sage: P    # indirect doctest
String representation
sage: x+y  # indirect doctest
result of addition
sage: P(x) # indirect doctest
result of conversion
```



---

archive/issue_comments_360349.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@simon-king-jena](#comment:34):\n> I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the \"EXAMPLES:\" section) has to show how stuff is actually being used. It may be possible to be a bit more explicit in the \"TESTS:\" section, but still I'd recommend against it.\n\nI tried to find the discussion, but didn't succeed. So, if you prefer, do ask on Sage-devel.",
    "created_at": "2017-09-19T13:55:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360349",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@simon-king-jena](#comment:34):
> I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the "EXAMPLES:" section) has to show how stuff is actually being used. It may be possible to be a bit more explicit in the "TESTS:" section, but still I'd recommend against it.

I tried to find the discussion, but didn't succeed. So, if you prefer, do ask on Sage-devel.



---

archive/issue_comments_360350.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@simon-king-jena](#comment:34):\n> Seriously??? When I was younger, I occasionally did direct tests (say, for `__iter__`) and was told to not do that.\n\nI think Python *special methods* like `__iter__` and *private methods* like `_element_constructor_` are a different category. This is especially so for a `cdef class`, where `__iter__` is not a method at all! So whatever you think about `__iter__` may not apply to `_element_constructor_`.\n\n> I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the \"EXAMPLES:\" section) has to show how stuff is actually being used.\n\nWell, `_element_constructor_` is not actually used by the end user. So again, this is not a relevant point.\n\nIn the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?",
    "created_at": "2017-09-19T14:08:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360350",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@simon-king-jena](#comment:34):
> Seriously??? When I was younger, I occasionally did direct tests (say, for `__iter__`) and was told to not do that.

I think Python *special methods* like `__iter__` and *private methods* like `_element_constructor_` are a different category. This is especially so for a `cdef class`, where `__iter__` is not a method at all! So whatever you think about `__iter__` may not apply to `_element_constructor_`.

> I also think it has been discussed on sage-devel a long time ago and the consensus was that the documentation (in particular the "EXAMPLES:" section) has to show how stuff is actually being used.

Well, `_element_constructor_` is not actually used by the end user. So again, this is not a relevant point.

In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?



---

archive/issue_comments_360351.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\n> In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?\n\nWell, currently we are **removing** these tests.  So if we decide here that it's not *bad practice* to test `_element_constructor_` directly, several of the tickets can be closed immediately.\n\nPersonally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, [comment:34](#comment:34) is convincing, too.  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.\n\nAnyway, let's not waste time on this.",
    "created_at": "2017-09-19T14:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360351",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:37" align="right">comment:37</div>

> In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?

Well, currently we are **removing** these tests.  So if we decide here that it's not *bad practice* to test `_element_constructor_` directly, several of the tickets can be closed immediately.

Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, [comment:34](#comment:34) is convincing, too.  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.

Anyway, let's not waste time on this.



---

archive/issue_comments_360352.json:
```json
{
    "body": "Changed dependencies from **#23882, #23884** to **#23882, #23884, #23894**",
    "created_at": "2017-09-19T15:02:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360352",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#23882, #23884** to **#23882, #23884, #23894**



---

archive/issue_comments_360353.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@mantepse](#comment:37):\n> > In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?\n\n> \n> Well, currently we are **removing** these tests.  So if we decide here that it's not *bad practice* to test `_element_constructor_` directly, several of the tickets can be closed immediately.\n\nI am a strong -1 on removing these tests. There can be good reasons for calling it directly, such as having non-trivial parsing of inputs before sending it to the element class but wanting to avoid the coercion framework. I also cannot see any problems with a direct call. Since this is being tested directly in the corresponding method, it is not public, and so it won't cause any problems for users.\n\n> Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, [comment:34](#comment:34) is convincing, too.\n\nDo you mean [comment:33](#comment:33) or [comment:36](#comment:36)?\n\nI usually am just lazy and do indirect for `_element_constructor_` tests. However, I probably should do direct calls in tests... However, for some of the methods, it is just easier (and can be more readable, such as for algebraic operations) to do the indirect test.\n\n>  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.\n\nIt is the other way around; the `_element_constructor_` is called from `Parent.__call__`. It usually is the last thing called from the parent and actually constructs the element when doing `Foo(bar)`.",
    "created_at": "2017-09-19T17:25:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360353",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@mantepse](#comment:37):
> > In the end I would say that it doesn't really matter. Maybe add both kinds of tests to be safe?

> 
> Well, currently we are **removing** these tests.  So if we decide here that it's not *bad practice* to test `_element_constructor_` directly, several of the tickets can be closed immediately.

I am a strong -1 on removing these tests. There can be good reasons for calling it directly, such as having non-trivial parsing of inputs before sending it to the element class but wanting to avoid the coercion framework. I also cannot see any problems with a direct call. Since this is being tested directly in the corresponding method, it is not public, and so it won't cause any problems for users.

> Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, [comment:34](#comment:34) is convincing, too.

Do you mean [comment:33](#comment:33) or [comment:36](#comment:36)?

I usually am just lazy and do indirect for `_element_constructor_` tests. However, I probably should do direct calls in tests... However, for some of the methods, it is just easier (and can be more readable, such as for algebraic operations) to do the indirect test.

>  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.

It is the other way around; the `_element_constructor_` is called from `Parent.__call__`. It usually is the last thing called from the parent and actually constructs the element when doing `Foo(bar)`.



---

archive/issue_comments_360354.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\n> I am a strong -1 on removing these tests.\n\nOK - so please let's ignore these tickets for the moment and concentrate on this one and #23880 instead...\n\n> > Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, [comment:34](#comment:34) is convincing, too.\n\n> \n> Do you mean [comment:33](#comment:33) or [comment:36](#comment:36)?\n\nNo, I meant [comment:34](#comment:34).  Specifically:\n\n>>> It is clear from the tutorials that `_repr_`, `_add_`, `_mul_` and `_element_constructor_` (all *single* underscore!) in Sage implement string representation of parents/elements, addition resp. multiplication of elements, and the call method of parents. Thus, all these methods should be tested indirectly:\n>>> \n>>> ```\n>>> sage: P    # indirect doctest\n>>> String representation\n>>> sage: x+y  # indirect doctest\n>>> result of addition\n>>> sage: P(x) # indirect doctest\n>>> result of conversion\n>>> ```\n\n> >  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.\n\n> \n> It is the other way around; the `_element_constructor_` is called from `Parent.__call__`. It usually is the last thing called from the parent and actually constructs the element when doing `Foo(bar)`.\n\nThanks for the clarification!",
    "created_at": "2017-09-19T18:19:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360354",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:40" align="right">comment:40</div>

> I am a strong -1 on removing these tests.

OK - so please let's ignore these tickets for the moment and concentrate on this one and #23880 instead...

> > Personally, I think that indirect doctests do not add much value and are hard to write.  So, I think we could close all these tickets again - I'd move out the extra stuff from #23885.  But I don't care much, [comment:34](#comment:34) is convincing, too.

> 
> Do you mean [comment:33](#comment:33) or [comment:36](#comment:36)?

No, I meant [comment:34](#comment:34).  Specifically:

>>> It is clear from the tutorials that `_repr_`, `_add_`, `_mul_` and `_element_constructor_` (all *single* underscore!) in Sage implement string representation of parents/elements, addition resp. multiplication of elements, and the call method of parents. Thus, all these methods should be tested indirectly:
>>> 
>>> ```
>>> sage: P    # indirect doctest
>>> String representation
>>> sage: x+y  # indirect doctest
>>> result of addition
>>> sage: P(x) # indirect doctest
>>> result of conversion
>>> ```

> >  Actually, I didn't know that `_element_constructor_` always invokes the call method of the parent.

> 
> It is the other way around; the `_element_constructor_` is called from `Parent.__call__`. It usually is the last thing called from the parent and actually constructs the element when doing `Foo(bar)`.

Thanks for the clarification!



---

archive/issue_comments_360355.json:
```json
{
    "body": "Changed dependencies from **#23882, #23884, #23894** to **#23882, #23884, #23894, #23899**",
    "created_at": "2017-09-20T07:37:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360355",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#23882, #23884, #23894** to **#23882, #23884, #23894, #23899**



---

archive/issue_comments_360356.json:
```json
{
    "body": "Changed dependencies from **#23882, #23884, #23894, #23899** to **#23882, #23884, #23894, #23899, #23905**",
    "created_at": "2017-09-20T10:04:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360356",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#23882, #23884, #23894, #23899** to **#23882, #23884, #23894, #23899, #23905**



---

archive/issue_comments_360357.json:
```json
{
    "body": "Changed dependencies from **#23882, #23884, #23894, #23899, #23905** to **#23882, #23884, #23894, #23899, #23905, #23907**",
    "created_at": "2017-09-20T12:26:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360357",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#23882, #23884, #23894, #23899, #23905** to **#23882, #23884, #23894, #23899, #23905, #23907**



---

archive/issue_comments_360358.json:
```json
{
    "body": "Changed dependencies from **#23882, #23884, #23894, #23899, #23905, #23907** to **#23882, #23884, #23894, #23899, #23905, #23907, #23914**",
    "created_at": "2017-09-22T07:29:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360358",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#23882, #23884, #23894, #23899, #23905, #23907** to **#23882, #23884, #23894, #23899, #23905, #23907, #23914**



---

archive/issue_comments_360359.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nWith all the dependencies on this ticket and #23880, I am no longer convinced that we need this ticket. We could also simply do the change `cdef public _element_constructor` -> `cdef _element_constructor` here and nothing else.",
    "created_at": "2017-09-22T09:14:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360359",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

With all the dependencies on this ticket and #23880, I am no longer convinced that we need this ticket. We could also simply do the change `cdef public _element_constructor` -> `cdef _element_constructor` here and nothing else.



---

archive/issue_comments_360360.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nI think removing `_element_constructor` from the public Python API is a good thing to do to prevent anyone else from adding something (although I would say that is highly unlikely).",
    "created_at": "2017-09-29T19:46:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360360",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:46" align="right">comment:46</div>

I think removing `_element_constructor` from the public Python API is a good thing to do to prevent anyone else from adding something (although I would say that is highly unlikely).



---

archive/issue_events_333237.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-09-30T13:36:56Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "title_is": "Remove Python access from Parent._element_constructor",
    "title_was": "Rename Parent._element_constructor -> Parent.__construct_element",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333237"
}
```



---

archive/issue_comments_360361.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we rename the latter.\n+In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. This way, it can no longer be accessed from Python.\n``````\n",
    "created_at": "2017-09-30T13:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360361",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we rename the latter.
+In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. This way, it can no longer be accessed from Python.
``````




---

archive/issue_comments_360362.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. This way, it can no longer be accessed from Python.\n+In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. The same for `_element_init_pass_parent`. This way, those attributes can no longer be accessed from Python.\n``````\n",
    "created_at": "2017-09-30T14:11:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360362",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. This way, it can no longer be accessed from Python.
+In order to avoid confusion between `_element_constructor_` (a public interface) and `_element_constructor` (a private attribute), we change the latter from `cdef public` to `cdef`. The same for `_element_init_pass_parent`. This way, those attributes can no longer be accessed from Python.
``````




---

archive/issue_comments_360363.json:
```json
{
    "body": "Changed branch from **[u/SimonKing/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/rename_parent__element_constructor____parent___construct_element)** to **[u/jdemeyer/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rename_parent__element_constructor____parent___construct_element)**",
    "created_at": "2017-09-30T14:56:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360363",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/SimonKing/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/SimonKing/rename_parent__element_constructor____parent___construct_element)** to **[u/jdemeyer/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rename_parent__element_constructor____parent___construct_element)**



---

archive/issue_events_333238.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-09-30T14:56:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333238"
}
```



---

archive/issue_comments_360364.json:
```json
{
    "body": "Changed commit from **[`c95b724`](https://github.com/sagemath/sagetrac-mirror/commit/c95b72453d16b13feff90c0308cdec5b3e4c5ac0)** to **[`41614a7`](https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0)**",
    "created_at": "2017-09-30T14:56:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360364",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`c95b724`](https://github.com/sagemath/sagetrac-mirror/commit/c95b72453d16b13feff90c0308cdec5b3e4c5ac0)** to **[`41614a7`](https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0)**



---

archive/issue_comments_360365.json:
```json
{
    "body": "<div id=\"comment:50\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6878e67e99f1f3707c8b4a060264f5484989c52b\"><code>6878e67</code></a></td><td><code>Avoid _element_constructor in padics</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44bc9fb660fe4508b0bd8340667b8b65b70226a1\"><code>44bc9fb</code></a></td><td><code>Do not assign _element_constructor in combinat/sf</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f684cb0e4834a0041da29ef7a1f8f0b01cf84994\"><code>f684cb0</code></a></td><td><code>Implement `_element_constructor_` for Homset</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b9765e781f8f9359cfc6021f6cd3d0e3b4b36d6\"><code>8b9765e</code></a></td><td><code>Avoid _element_constructor in geometry doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2630849a988376b44769460989a41919bbe89520\"><code>2630849</code></a></td><td><code>Various minor changes to _element_constructor</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28560512caf479b51dd0a44df47b8f227cf92e4a\"><code>2856051</code></a></td><td><code>Merge commit '6878e67e99f1f3707c8b4a060264f5484989c52b'; commit '44bc9fb660fe4508b0bd8340667b8b65b70226a1'; commit 'f684cb0e4834a0041da29ef7a1f8f0b01cf84994'; commit '8b9765e781f8f9359cfc6021f6cd3d0e3b4b36d6'; commit '2630849a988376b44769460989a41919bbe89520' into t/23881/rename_parent__element_constructor____parent___construct_element</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77ccb855a3195396e5e55a471cc4ab10b3c77613\"><code>77ccb85</code></a></td><td><code>Do not set _element_init_pass_parent</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0\"><code>41614a7</code></a></td><td><code>Remove Python access from Parent._element_constructor and Parent._element_init_pass_parent</code></td></tr></table>\n",
    "created_at": "2017-09-30T14:56:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360365",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:50"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6878e67e99f1f3707c8b4a060264f5484989c52b"><code>6878e67</code></a></td><td><code>Avoid _element_constructor in padics</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44bc9fb660fe4508b0bd8340667b8b65b70226a1"><code>44bc9fb</code></a></td><td><code>Do not assign _element_constructor in combinat/sf</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f684cb0e4834a0041da29ef7a1f8f0b01cf84994"><code>f684cb0</code></a></td><td><code>Implement `_element_constructor_` for Homset</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b9765e781f8f9359cfc6021f6cd3d0e3b4b36d6"><code>8b9765e</code></a></td><td><code>Avoid _element_constructor in geometry doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2630849a988376b44769460989a41919bbe89520"><code>2630849</code></a></td><td><code>Various minor changes to _element_constructor</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28560512caf479b51dd0a44df47b8f227cf92e4a"><code>2856051</code></a></td><td><code>Merge commit '6878e67e99f1f3707c8b4a060264f5484989c52b'; commit '44bc9fb660fe4508b0bd8340667b8b65b70226a1'; commit 'f684cb0e4834a0041da29ef7a1f8f0b01cf84994'; commit '8b9765e781f8f9359cfc6021f6cd3d0e3b4b36d6'; commit '2630849a988376b44769460989a41919bbe89520' into t/23881/rename_parent__element_constructor____parent___construct_element</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77ccb855a3195396e5e55a471cc4ab10b3c77613"><code>77ccb85</code></a></td><td><code>Do not set _element_init_pass_parent</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0"><code>41614a7</code></a></td><td><code>Remove Python access from Parent._element_constructor and Parent._element_init_pass_parent</code></td></tr></table>




---

archive/issue_comments_360366.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nGreen patchbot => positive review.",
    "created_at": "2017-09-30T15:16:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360366",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:51" align="right">comment:51</div>

Green patchbot => positive review.



---

archive/issue_comments_360367.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2017-09-30T15:16:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360367",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_events_333239.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-09-30T22:58:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333239"
}
```



---

archive/issue_events_333240.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-09-30T22:58:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333240"
}
```



---

archive/issue_comments_360368.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nBoth arando and rk02-math seem to fail the same test:\n\n```\n sage -t --long src/sage/schemes/elliptic_curves/sha_tate.py # 1 doctest failed \n```\nWhich they do not seem to fail on with other tickets.",
    "created_at": "2017-09-30T22:58:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360368",
    "user": "https://github.com/koffie"
}
```

<div id="comment:52" align="right">comment:52</div>

Both arando and rk02-math seem to fail the same test:

```
 sage -t --long src/sage/schemes/elliptic_curves/sha_tate.py # 1 doctest failed 
```
Which they do not seem to fail on with other tickets.



---

archive/issue_comments_360369.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nI don't see how those failures could be related to the changes in this ticket unless they appear also in one of the dependencies. Even still, I don't see how they could be connected, much less be machine dependent.",
    "created_at": "2017-09-30T23:20:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360369",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:53" align="right">comment:53</div>

I don't see how those failures could be related to the changes in this ticket unless they appear also in one of the dependencies. Even still, I don't see how they could be connected, much less be machine dependent.



---

archive/issue_comments_360370.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nI don't see see why either so I agree it is highly unlikely, but since `parent` is modified it is not impossible. It does not need to be machine dependent, it can also be a bug that happens 50% of the time that is exposed after this.\n\nThere are two machines failing on this ticket and I have not seen it on either arando or rk02-math in at least 10 other failing logs that I checked. So from this point of view it is also very unlikely that it is not from this ticket. Of course this ticket could have been very unlucky to expose a rare random bug twice for the first time but this is also highly unlikely.\n\nI just would like to see arguments for why we are in one unlikely scenario and not the other.\n\nNote that this ticket also has a lot of dependencies merged so it could also be exposed by one of the dependencies, which might explain why I didn't see it on any of the arando and rk02-math logsI checked.\n\nIf only we could search through the patchbot log easily, then we could get conclusive answers much faster.",
    "created_at": "2017-10-01T08:47:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360370",
    "user": "https://github.com/koffie"
}
```

<div id="comment:54" align="right">comment:54</div>

I don't see see why either so I agree it is highly unlikely, but since `parent` is modified it is not impossible. It does not need to be machine dependent, it can also be a bug that happens 50% of the time that is exposed after this.

There are two machines failing on this ticket and I have not seen it on either arando or rk02-math in at least 10 other failing logs that I checked. So from this point of view it is also very unlikely that it is not from this ticket. Of course this ticket could have been very unlucky to expose a rare random bug twice for the first time but this is also highly unlikely.

I just would like to see arguments for why we are in one unlikely scenario and not the other.

Note that this ticket also has a lot of dependencies merged so it could also be exposed by one of the dependencies, which might explain why I didn't see it on any of the arando and rk02-math logsI checked.

If only we could search through the patchbot log easily, then we could get conclusive answers much faster.



---

archive/issue_comments_360371.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nI don't think that the failures have anything to do with this ticket, so I'm setting it to positive_review. If the failures are real, then it will fail on Volker's buildbot anyway.",
    "created_at": "2017-10-01T09:17:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360371",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

I don't think that the failures have anything to do with this ticket, so I'm setting it to positive_review. If the failures are real, then it will fail on Volker's buildbot anyway.



---

archive/issue_events_333241.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-01T09:17:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333241"
}
```



---

archive/issue_events_333242.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-01T09:17:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333242"
}
```



---

archive/issue_comments_360372.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nI also tested it on arando manually (without the patchbot) and that test passed.",
    "created_at": "2017-10-01T09:48:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360372",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

I also tested it on arando manually (without the patchbot) and that test passed.



---

archive/issue_comments_360373.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nBefore you reported that arando passes all test I kicked the patchbot to get more info. And arando did [fail again on the run resulting from that kick](https://patchbot.sagemath.org/log/23881/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-10-01%2011:59:20?short), while the bug did not occur in [two](https://patchbot.sagemath.org/log/22391/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-09-30%2020:08:17?short) [tests](https://patchbot.sagemath.org/log/15485/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-10-01%2002:45:51?short) ran on arando in between.\n\nI am a bit mystified by the situation since it can't be the optional packages since rk02-math has none, so it must be a randomly occuring bug.",
    "created_at": "2017-10-01T16:10:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360373",
    "user": "https://github.com/koffie"
}
```

<div id="comment:57" align="right">comment:57</div>

Before you reported that arando passes all test I kicked the patchbot to get more info. And arando did [fail again on the run resulting from that kick](https://patchbot.sagemath.org/log/23881/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-10-01%2011:59:20?short), while the bug did not occur in [two](https://patchbot.sagemath.org/log/22391/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-09-30%2020:08:17?short) [tests](https://patchbot.sagemath.org/log/15485/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-10-01%2002:45:51?short) ran on arando in between.

I am a bit mystified by the situation since it can't be the optional packages since rk02-math has none, so it must be a randomly occuring bug.



---

archive/issue_comments_360374.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nI tested this with\n\n```\n./sage -t --long --global-iterations=100 src/sage/schemes/elliptic_curves/sha_tate.py\n```\non arando and they all pass so it is not easily reproducible.",
    "created_at": "2017-10-01T20:04:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360374",
    "user": "https://github.com/koffie"
}
```

<div id="comment:58" align="right">comment:58</div>

I tested this with

```
./sage -t --long --global-iterations=100 src/sage/schemes/elliptic_curves/sha_tate.py
```
on arando and they all pass so it is not easily reproducible.



---

archive/issue_comments_360375.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nThe sha_tate doctest fails on sage8.1.beta7 without any patches on arando so I created #23962, since arando failed on the 3 tests it ran on this ticket, but none of the other beta6 tests, I still suspect it to be something introduced by one of the dependencies of this ticket that got merged in sage8.1.beta7. Anyway it can't be this ticket so lets move the discussion to #23962.",
    "created_at": "2017-10-03T22:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360375",
    "user": "https://github.com/koffie"
}
```

<div id="comment:59" align="right">comment:59</div>

The sha_tate doctest fails on sage8.1.beta7 without any patches on arando so I created #23962, since arando failed on the 3 tests it ran on this ticket, but none of the other beta6 tests, I still suspect it to be something introduced by one of the dependencies of this ticket that got merged in sage8.1.beta7. Anyway it can't be this ticket so lets move the discussion to #23962.



---

archive/issue_events_333243.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-13T13:44:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333243"
}
```



---

archive/issue_events_333244.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-13T13:44:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333244"
}
```



---

archive/issue_comments_360376.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@tscrim](#comment:46):\n> to prevent anyone else from adding something (although I would say that is highly unlikely).\n\nIt seems that precisely this has happened in #23660...",
    "created_at": "2017-10-13T13:44:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360376",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@tscrim](#comment:46):
> to prevent anyone else from adding something (although I would say that is highly unlikely).

It seems that precisely this has happened in #23660...



---

archive/issue_events_333245.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-13T13:49:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333245"
}
```



---

archive/issue_events_333246.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-13T13:49:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333246"
}
```



---

archive/issue_comments_360377.json:
```json
{
    "body": "Changed dependencies from **#23882, #23884, #23894, #23899, #23905, #23907, #23914** to **#23882, #23884, #23894, #23899, #23905, #23907, #23914, #24033**",
    "created_at": "2017-10-13T13:49:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360377",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#23882, #23884, #23894, #23899, #23905, #23907, #23914** to **#23882, #23884, #23894, #23899, #23905, #23907, #23914, #24033**



---

archive/issue_events_333247.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-22T17:23:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333247"
}
```



---

archive/issue_events_333248.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9b321572d1b81e787aabf78de9af16f789efc1d4",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-10-22T17:23:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23881#event-333248"
}
```



---

archive/issue_comments_360378.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rename_parent__element_constructor____parent___construct_element)** to **[`41614a7`](https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0)**",
    "created_at": "2017-10-22T17:23:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360378",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/rename_parent__element_constructor____parent___construct_element](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rename_parent__element_constructor____parent___construct_element)** to **[`41614a7`](https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0)**



---

archive/issue_comments_360379.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nGood that this is merged now...",
    "created_at": "2017-10-22T20:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360379",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:63" align="right">comment:63</div>

Good that this is merged now...



---

archive/issue_comments_360380.json:
```json
{
    "body": "Changed commit from **[`41614a7`](https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0)** to none",
    "created_at": "2017-10-22T20:17:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23881",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23881#issuecomment-360380",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`41614a7`](https://github.com/sagemath/sagetrac-mirror/commit/41614a7ea0c82da579a039eecd51ee628a3e41e0)** to none
