# Issue 23490: Correct __contains__ for Alternating Sign Matrix

archive/issues_023253.json:
```json
{
    "body": "The method `__contains__` of alternating sign matrices is wrong\n\n```\nsage: A = AlternatingSignMatrices(3)\nsage: A.cardinality()\n7\nsage: M = MatrixSpace(ZZ, 3)\nsage: from itertools import product\nsage: sum(1 for p in product([-1,0,1], repeat=9) if p in A)\n9\n```\nIndeed the matrix\n\n```\n0  1 0\n0  1 0\n1 -1 1\n```\nis not an asm.\n\nWe also add more checking and make a much faster conversion from monotone triangles.\n\nCC:  @fchapoton @tscrim\n\nBranch/Commit: 417a508f70cda144e0664a0c750bee325d9b04ef\n\nReviewer: Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw\n\nAuthor: Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23490\n\n",
    "closed_at": "2017-07-31T20:19:21Z",
    "created_at": "2017-07-20T08:42:31Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Correct __contains__ for Alternating Sign Matrix",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23490",
    "user": "https://github.com/videlec"
}
```
The method `__contains__` of alternating sign matrices is wrong

```
sage: A = AlternatingSignMatrices(3)
sage: A.cardinality()
7
sage: M = MatrixSpace(ZZ, 3)
sage: from itertools import product
sage: sum(1 for p in product([-1,0,1], repeat=9) if p in A)
9
```
Indeed the matrix

```
0  1 0
0  1 0
1 -1 1
```
is not an asm.

We also add more checking and make a much faster conversion from monotone triangles.

CC:  @fchapoton @tscrim

Branch/Commit: 417a508f70cda144e0664a0c750bee325d9b04ef

Reviewer: Frédéric Chapoton, Travis Scrimshaw

Author: Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23490





---

archive/issue_comments_444345.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------|\n|[ec99074](https://github.com/sagemath/sagetrac-mirror/commit/ec99074fd7a24507109a6eeaeea5272ff2a44e83)|`23490: fix asm`|",
    "created_at": "2017-07-20T08:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444345",
    "user": "https://github.com/videlec"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------|
|[ec99074](https://github.com/sagemath/sagetrac-mirror/commit/ec99074fd7a24507109a6eeaeea5272ff2a44e83)|`23490: fix asm`|



---

archive/issue_comments_444346.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/23490\"",
    "created_at": "2017-07-20T08:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444346",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/23490"



---

archive/issue_comments_444347.json:
```json
{
    "body": "Changing commit from \"\" to \"ec99074fd7a24507109a6eeaeea5272ff2a44e83\"",
    "created_at": "2017-07-20T08:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444347",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "ec99074fd7a24507109a6eeaeea5272ff2a44e83"



---

archive/issue_comments_444348.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-20T08:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444348",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_444349.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe current definition is correct. Alternating in sign and sum=1 implies that the first and last must be 1.",
    "created_at": "2017-07-20T11:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444349",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
The current definition is correct. Alternating in sign and sum=1 implies that the first and last must be 1.



---

archive/issue_comments_444350.json:
```json
{
    "body": "<a id='comment:3'></a>\nBut as mentioned in the ticket description the `__contains__` is not working... I will revert the change in documentation.",
    "created_at": "2017-07-20T12:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444350",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>
But as mentioned in the ticket description the `__contains__` is not working... I will revert the change in documentation.



---

archive/issue_comments_444351.json:
```json
{
    "body": "Changing commit from \"ec99074fd7a24507109a6eeaeea5272ff2a44e83\" to \"7ec1bd65e6731cb21c19cf0518d9a7a335589130\"",
    "created_at": "2017-07-20T12:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444351",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ec99074fd7a24507109a6eeaeea5272ff2a44e83" to "7ec1bd65e6731cb21c19cf0518d9a7a335589130"



---

archive/issue_comments_444352.json:
```json
{
    "body": "<a id='comment:4'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                           |                                |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[7ec1bd6](https://github.com/sagemath/sagetrac-mirror/commit/7ec1bd65e6731cb21c19cf0518d9a7a335589130)|`23490: fix __contains__ on asm`|",
    "created_at": "2017-07-20T12:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                           |                                |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[7ec1bd6](https://github.com/sagemath/sagetrac-mirror/commit/7ec1bd65e6731cb21c19cf0518d9a7a335589130)|`23490: fix __contains__ on asm`|



---

archive/issue_comments_444353.json:
```json
{
    "body": "<a id='comment:5'></a>\nThanks for the comment Fr\u00e9d\u00e9ric. I updated the commit.",
    "created_at": "2017-07-20T12:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444353",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
Thanks for the comment Frédéric. I updated the commit.



---

archive/issue_comments_444354.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-The documentation and the method `__contains__` of alternating sign matrices is wrong\n+The method `__contains__` of alternating sign matrices is wrong\n \n ```\n sage: A = AlternatingSignMatrices(3)\n@@ -17,3 +17,5 @@\n 1 -1 1\n ```\n is not an asm.\n+\n+We also add more checking and make a much faster conversion from monotone triangles.\n``````\n",
    "created_at": "2017-07-20T12:29:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444354",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-The documentation and the method `__contains__` of alternating sign matrices is wrong
+The method `__contains__` of alternating sign matrices is wrong
 
 ```
 sage: A = AlternatingSignMatrices(3)
@@ -17,3 +17,5 @@
 1 -1 1
 ```
 is not an asm.
+
+We also add more checking and make a much faster conversion from monotone triangles.
``````




---

archive/issue_events_068534.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "rename": {
        "from": "Correct definition of Alternating Sign Matrix",
        "to": "Correct __contains__ for Alternating Sign Matrix"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23490#event-68534"
}
```



---

archive/issue_comments_444355.json:
```json
{
    "body": "<a id='comment:8'></a>\nThe `check` is ignored in the `_element_constructor_`.\n\nIt is better to have the more standard `assert m not in A`.\n\nOtherwise LGTM.",
    "created_at": "2017-07-20T12:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444355",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>
The `check` is ignored in the `_element_constructor_`.

It is better to have the more standard `assert m not in A`.

Otherwise LGTM.



---

archive/issue_comments_444356.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fr\u00e9d\u00e9ric Chapoton, Travis Scrimshaw\"",
    "created_at": "2017-07-20T12:38:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444356",
    "user": "https://github.com/tscrim"
}
```

Changing reviewer from "" to "Frédéric Chapoton, Travis Scrimshaw"



---

archive/issue_comments_444357.json:
```json
{
    "body": "Changing commit from \"7ec1bd65e6731cb21c19cf0518d9a7a335589130\" to \"b957441ceb329d72cb0ba5a251a0abf675218237\"",
    "created_at": "2017-07-20T12:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444357",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7ec1bd65e6731cb21c19cf0518d9a7a335589130" to "b957441ceb329d72cb0ba5a251a0abf675218237"



---

archive/issue_comments_444358.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                         |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|\n|[b957441](https://github.com/sagemath/sagetrac-mirror/commit/b957441ceb329d72cb0ba5a251a0abf675218237)|`23490: use check appropriately in _element_constructor_`|",
    "created_at": "2017-07-20T12:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444358",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------|
|[b957441](https://github.com/sagemath/sagetrac-mirror/commit/b957441ceb329d72cb0ba5a251a0abf675218237)|`23490: use check appropriately in _element_constructor_`|



---

archive/issue_comments_444359.json:
```json
{
    "body": "<a id='comment:10'></a>\nmissing sage: here\n\n```\n+            AlternatingSignMatrices(3).list()\n```",
    "created_at": "2017-07-20T16:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444359",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:10'></a>
missing sage: here

```
+            AlternatingSignMatrices(3).list()
```



---

archive/issue_comments_444360.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                   |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[32c6c35](https://github.com/sagemath/sagetrac-mirror/commit/32c6c3539954822facc1f25c629d3924bea1e645)|`23490: add \"sage: \" where missing`|",
    "created_at": "2017-07-20T16:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[32c6c35](https://github.com/sagemath/sagetrac-mirror/commit/32c6c3539954822facc1f25c629d3924bea1e645)|`23490: add "sage: " where missing`|



---

archive/issue_comments_444361.json:
```json
{
    "body": "Changing commit from \"b957441ceb329d72cb0ba5a251a0abf675218237\" to \"32c6c3539954822facc1f25c629d3924bea1e645\"",
    "created_at": "2017-07-20T16:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b957441ceb329d72cb0ba5a251a0abf675218237" to "32c6c3539954822facc1f25c629d3924bea1e645"



---

archive/issue_comments_444362.json:
```json
{
    "body": "Changing commit from \"32c6c3539954822facc1f25c629d3924bea1e645\" to \"ab5978e6525c4c357588b12f9f245dfaa892afed\"",
    "created_at": "2017-07-20T16:54:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "32c6c3539954822facc1f25c629d3924bea1e645" to "ab5978e6525c4c357588b12f9f245dfaa892afed"



---

archive/issue_comments_444363.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------|\n|[ab5978e](https://github.com/sagemath/sagetrac-mirror/commit/ab5978e6525c4c357588b12f9f245dfaa892afed)|`23490: fix doctests`|",
    "created_at": "2017-07-20T16:54:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
|[ab5978e](https://github.com/sagemath/sagetrac-mirror/commit/ab5978e6525c4c357588b12f9f245dfaa892afed)|`23490: fix doctests`|



---

archive/issue_comments_444364.json:
```json
{
    "body": "<a id='comment:13'></a>\ntypo here:\n\n```\n+            # check that the total sums of the i-th\n+            # rwo and i-th column is 1\n```\nOnce corrected, the rest looks good.",
    "created_at": "2017-07-20T18:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444364",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
typo here:

```
+            # check that the total sums of the i-th
+            # rwo and i-th column is 1
```
Once corrected, the rest looks good.



---

archive/issue_comments_444365.json:
```json
{
    "body": "<a id='comment:14'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|\n|[417a508](https://github.com/sagemath/sagetrac-mirror/commit/417a508f70cda144e0664a0c750bee325d9b04ef)|`23490: fix typo in comment`|",
    "created_at": "2017-07-20T18:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444365",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|
|[417a508](https://github.com/sagemath/sagetrac-mirror/commit/417a508f70cda144e0664a0c750bee325d9b04ef)|`23490: fix typo in comment`|



---

archive/issue_comments_444366.json:
```json
{
    "body": "Changing commit from \"ab5978e6525c4c357588b12f9f245dfaa892afed\" to \"417a508f70cda144e0664a0c750bee325d9b04ef\"",
    "created_at": "2017-07-20T18:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444366",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ab5978e6525c4c357588b12f9f245dfaa892afed" to "417a508f70cda144e0664a0c750bee325d9b04ef"



---

archive/issue_comments_444367.json:
```json
{
    "body": "<a id='comment:15'></a>\nIdneed ;-)",
    "created_at": "2017-07-20T18:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444367",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>
Idneed ;-)



---

archive/issue_comments_444368.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-20T18:41:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444368",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_444369.json:
```json
{
    "body": "<a id='comment:16'></a>\nthx",
    "created_at": "2017-07-20T18:41:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444369",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:16'></a>
thx



---

archive/issue_comments_444370.json:
```json
{
    "body": "<a id='comment:17'></a>\nThanks to you for the review! I have an amazlingly fast random generation to come (I can generate 50x50 uniform asm in 1.5sec and 100x100 in 45secs). Still using CFTP as it is now in Sage, but way smarter code.",
    "created_at": "2017-07-20T18:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444370",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>
Thanks to you for the review! I have an amazlingly fast random generation to come (I can generate 50x50 uniform asm in 1.5sec and 100x100 in 45secs). Still using CFTP as it is now in Sage, but way smarter code.



---

archive/issue_events_068535.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-07-31T20:19:21Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23490#event-68535"
}
```



---

archive/issue_comments_444371.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-07-31T20:19:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444371",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_444372.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/23490\" to \"417a508f70cda144e0664a0c750bee325d9b04ef\"",
    "created_at": "2017-07-31T20:19:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23490",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23490#issuecomment-444372",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/23490" to "417a508f70cda144e0664a0c750bee325d9b04ef"
