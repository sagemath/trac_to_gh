# Issue 23384: py3: rich comparison for root systems

archive/issues_023147.json:
```json
{
    "assignees": [],
    "body": "as another step to python3\n\nCC:  @tscrim @jdemeyer @jhpalmieri\n\nComponent: **python3**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nBranch/Commit: **[`77876fa`](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)**\n\nReviewer: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23384_\n\n",
    "closed_at": "2017-07-26T22:12:26Z",
    "created_at": "2017-07-07T11:50:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: rich comparison for root systems",
    "type": "issue",
    "updated_at": "2017-07-26T22:12:26Z",
    "url": "https://github.com/sagemath/sage/issues/23384",
    "user": "https://github.com/fchapoton"
}
```
as another step to python3

CC:  @tscrim @jdemeyer @jhpalmieri

Component: **python3**

Author: **Frédéric Chapoton**

Branch/Commit: **[`77876fa`](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)**

Reviewer: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/23384_





---

archive/issue_events_322687.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-07-07T11:50:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322687"
}
```



---

archive/issue_events_322688.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-07-07T11:50:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322688"
}
```



---

archive/issue_events_322689.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-07-07T11:50:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322689"
}
```



---

archive/issue_events_322690.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-07-07T11:50:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322690"
}
```



---

archive/issue_comments_351103.json:
```json
{
    "body": "Commit: **[`fbcea9d`](https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7)**",
    "created_at": "2017-07-07T11:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351103",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`fbcea9d`](https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7)**



---

archive/issue_comments_351104.json:
```json
{
    "body": "Branch: **[u/chapoton/23384](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23384)**",
    "created_at": "2017-07-07T11:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351104",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/23384](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23384)**



---

archive/issue_comments_351105.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7\"><code>fbcea9d</code></a></td><td><code>py3: rich comparison for root systems</code></td></tr></table>\n",
    "created_at": "2017-07-07T11:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351105",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7"><code>fbcea9d</code></a></td><td><code>py3: rich comparison for root systems</code></td></tr></table>




---

archive/issue_events_322691.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-07-07T12:05:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322691"
}
```



---

archive/issue_comments_351106.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nActually, your code introduces a bug because of a very subtle use of `foo.__class__` and the category framework.\n\n```\nsage: e1 = RootSystem(['A',3]).ambient_space(QQ)\nsage: e2 = RootSystem(['A',3]).ambient_space(RR)\nsage: from sage.combinat.root_system.ambient_space import AmbientSpace\nsage: isinstance(e1, AmbientSpace)\nTrue\nsage: isinstance(e2, AmbientSpace)\nTrue\nsage: e1.root_system == e2.root_system\nTrue\nsage: e1.__class__ == e2.__class__\nFalse\n```\nThe last non-equality comes from the fact that the category of `e1` is different from that of `e2`, so they create different instances of `parent_class` and, ultimately, the classes of the parents in the respective categories are distinct.\n\nHowever, the check is really based on the input parameters, so the default comparison from `CombinatorialFreeModule` (which, in turn, is the `UniqueRepresentation` behavior). So you can just remove the `__cmp__`.",
    "created_at": "2017-07-07T14:52:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351106",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

Actually, your code introduces a bug because of a very subtle use of `foo.__class__` and the category framework.

```
sage: e1 = RootSystem(['A',3]).ambient_space(QQ)
sage: e2 = RootSystem(['A',3]).ambient_space(RR)
sage: from sage.combinat.root_system.ambient_space import AmbientSpace
sage: isinstance(e1, AmbientSpace)
True
sage: isinstance(e2, AmbientSpace)
True
sage: e1.root_system == e2.root_system
True
sage: e1.__class__ == e2.__class__
False
```
The last non-equality comes from the fact that the category of `e1` is different from that of `e2`, so they create different instances of `parent_class` and, ultimately, the classes of the parents in the respective categories are distinct.

However, the check is really based on the input parameters, so the default comparison from `CombinatorialFreeModule` (which, in turn, is the `UniqueRepresentation` behavior). So you can just remove the `__cmp__`.



---

archive/issue_comments_351107.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6\"><code>b514766</code></a></td><td><code>trac 23384 removing cmp for ambient space</code></td></tr></table>\n",
    "created_at": "2017-07-07T15:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351107",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6"><code>b514766</code></a></td><td><code>trac 23384 removing cmp for ambient space</code></td></tr></table>




---

archive/issue_comments_351108.json:
```json
{
    "body": "Changed commit from **[`fbcea9d`](https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7)** to **[`b514766`](https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6)**",
    "created_at": "2017-07-07T15:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351108",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fbcea9d`](https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7)** to **[`b514766`](https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6)**



---

archive/issue_comments_351109.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHello. I was not sure of what file you were talking, so I did something for {{ambient_space}}} hoping that this was the right one.",
    "created_at": "2017-07-07T15:10:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351109",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

Hello. I was not sure of what file you were talking, so I did something for {{ambient_space}}} hoping that this was the right one.



---

archive/issue_comments_351110.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2017-07-07T15:19:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351110",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_351111.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYes, sorry, I meant `ambient_space.py`. Could you add a test:\n\n```\nsage: e1 = RootSystem(['A',3]).ambient_space(QQ)\nsage: e2 = RootSystem(['A',3]).ambient_space(RR)\nsage: e1 == e2\nFalse\n```\nThen you can set a positive review on my behalf.",
    "created_at": "2017-07-07T15:19:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351111",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">comment:6</div>

Yes, sorry, I meant `ambient_space.py`. Could you add a test:

```
sage: e1 = RootSystem(['A',3]).ambient_space(QQ)
sage: e2 = RootSystem(['A',3]).ambient_space(RR)
sage: e1 == e2
False
```
Then you can set a positive review on my behalf.



---

archive/issue_comments_351112.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774\"><code>77876fa</code></a></td><td><code>trac 23384 adding doctest</code></td></tr></table>\n",
    "created_at": "2017-07-07T17:53:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351112",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774"><code>77876fa</code></a></td><td><code>trac 23384 adding doctest</code></td></tr></table>




---

archive/issue_comments_351113.json:
```json
{
    "body": "Changed commit from **[`b514766`](https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6)** to **[`77876fa`](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)**",
    "created_at": "2017-07-07T17:53:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351113",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b514766`](https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6)** to **[`77876fa`](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)**



---

archive/issue_events_322692.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-07-07T17:54:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322692"
}
```



---

archive/issue_events_322693.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-07-07T17:54:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322693"
}
```



---

archive/issue_comments_351114.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\ndone, setting to positive, thanks",
    "created_at": "2017-07-07T17:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351114",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:8" align="right">comment:8</div>

done, setting to positive, thanks



---

archive/issue_comments_351115.json:
```json
{
    "body": "Changed branch from **[u/chapoton/23384](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23384)** to **[`77876fa`](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)**",
    "created_at": "2017-07-26T22:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23384#issuecomment-351115",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/23384](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23384)** to **[`77876fa`](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)**



---

archive/issue_events_322694.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-07-26T22:12:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322694"
}
```



---

archive/issue_events_322695.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9759ed25c3b88eb812349bb3cd3b3ea3e03ec911",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-07-26T22:12:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23384",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23384#event-322695"
}
```
