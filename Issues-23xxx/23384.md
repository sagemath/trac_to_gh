# Issue 23384: py3: rich comparison for root systems

archive/issues_023147.json:
```json
{
    "body": "as another step to python3\n\n**CC:**  @tscrim @jdemeyer @jhpalmieri\n\n**Branch/Commit:** [77876fa654b8199e0bc232bead73df281429d774](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)\n\n**Reviewer:** Travis Scrimshaw\n\n**Author:** Fr\u00e9d\u00e9ric Chapoton\n\nIssue created by migration from https://trac.sagemath.org/ticket/23384\n\n",
    "closed_at": "2017-07-26T22:12:26Z",
    "created_at": "2017-07-07T11:50:49Z",
    "labels": [
        "component: python3",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "py3: rich comparison for root systems",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23384",
    "user": "https://github.com/fchapoton"
}
```
as another step to python3

**CC:**  @tscrim @jdemeyer @jhpalmieri

**Branch/Commit:** [77876fa654b8199e0bc232bead73df281429d774](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)

**Reviewer:** Travis Scrimshaw

**Author:** Frédéric Chapoton

Issue created by migration from https://trac.sagemath.org/ticket/23384





---

archive/issue_comments_420765.json:
```json
{
    "body": "**Commit:** [fbcea9d44f7fcb9d026618894ce788987a6865a7](https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7)",
    "created_at": "2017-07-07T11:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420765",
    "user": "https://github.com/fchapoton"
}
```

**Commit:** [fbcea9d44f7fcb9d026618894ce788987a6865a7](https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7)



---

archive/issue_comments_420766.json:
```json
{
    "body": "**Branch:** [u/chapoton/23384](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23384)",
    "created_at": "2017-07-07T11:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420766",
    "user": "https://github.com/fchapoton"
}
```

**Branch:** [u/chapoton/23384](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23384)



---

archive/issue_comments_420767.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7\">fbcea9d</a></td><td><code>py3: rich comparison for root systems</code></td></tr></table>\n",
    "created_at": "2017-07-07T11:51:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420767",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7">fbcea9d</a></td><td><code>py3: rich comparison for root systems</code></td></tr></table>




---

archive/issue_comments_420768.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2017-07-07T12:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420768",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_420769.json:
```json
{
    "body": "<a id='comment:3'></a>\nActually, your code introduces a bug because of a very subtle use of `foo.__class__` and the category framework.\n\n```\nsage: e1 = RootSystem(['A',3]).ambient_space(QQ)\nsage: e2 = RootSystem(['A',3]).ambient_space(RR)\nsage: from sage.combinat.root_system.ambient_space import AmbientSpace\nsage: isinstance(e1, AmbientSpace)\nTrue\nsage: isinstance(e2, AmbientSpace)\nTrue\nsage: e1.root_system == e2.root_system\nTrue\nsage: e1.__class__ == e2.__class__\nFalse\n```\nThe last non-equality comes from the fact that the category of `e1` is different from that of `e2`, so they create different instances of `parent_class` and, ultimately, the classes of the parents in the respective categories are distinct.\n\nHowever, the check is really based on the input parameters, so the default comparison from `CombinatorialFreeModule` (which, in turn, is the `UniqueRepresentation` behavior). So you can just remove the `__cmp__`.",
    "created_at": "2017-07-07T14:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420769",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>
Actually, your code introduces a bug because of a very subtle use of `foo.__class__` and the category framework.

```
sage: e1 = RootSystem(['A',3]).ambient_space(QQ)
sage: e2 = RootSystem(['A',3]).ambient_space(RR)
sage: from sage.combinat.root_system.ambient_space import AmbientSpace
sage: isinstance(e1, AmbientSpace)
True
sage: isinstance(e2, AmbientSpace)
True
sage: e1.root_system == e2.root_system
True
sage: e1.__class__ == e2.__class__
False
```
The last non-equality comes from the fact that the category of `e1` is different from that of `e2`, so they create different instances of `parent_class` and, ultimately, the classes of the parents in the respective categories are distinct.

However, the check is really based on the input parameters, so the default comparison from `CombinatorialFreeModule` (which, in turn, is the `UniqueRepresentation` behavior). So you can just remove the `__cmp__`.



---

archive/issue_comments_420770.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6\">b514766</a></td><td><code>trac 23384 removing cmp for ambient space</code></td></tr></table>\n",
    "created_at": "2017-07-07T15:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420770",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6">b514766</a></td><td><code>trac 23384 removing cmp for ambient space</code></td></tr></table>




---

archive/issue_comments_420771.json:
```json
{
    "body": "**Changing commit** from \"[fbcea9d44f7fcb9d026618894ce788987a6865a7](https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7)\" to \"[b514766cad89ec5d8769516cbae62ac74153e2b6](https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6)\".",
    "created_at": "2017-07-07T15:09:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420771",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[fbcea9d44f7fcb9d026618894ce788987a6865a7](https://github.com/sagemath/sagetrac-mirror/commit/fbcea9d44f7fcb9d026618894ce788987a6865a7)" to "[b514766cad89ec5d8769516cbae62ac74153e2b6](https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6)".



---

archive/issue_comments_420772.json:
```json
{
    "body": "<a id='comment:5'></a>\nHello. I was not sure of what file you were talking, so I did something for {{ambient_space}}} hoping that this was the right one.",
    "created_at": "2017-07-07T15:10:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420772",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
Hello. I was not sure of what file you were talking, so I did something for {{ambient_space}}} hoping that this was the right one.



---

archive/issue_comments_420773.json:
```json
{
    "body": "**Reviewer:** Travis Scrimshaw",
    "created_at": "2017-07-07T15:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420773",
    "user": "https://github.com/tscrim"
}
```

**Reviewer:** Travis Scrimshaw



---

archive/issue_comments_420774.json:
```json
{
    "body": "<a id='comment:6'></a>\nYes, sorry, I meant `ambient_space.py`. Could you add a test:\n\n```\nsage: e1 = RootSystem(['A',3]).ambient_space(QQ)\nsage: e2 = RootSystem(['A',3]).ambient_space(RR)\nsage: e1 == e2\nFalse\n```\nThen you can set a positive review on my behalf.",
    "created_at": "2017-07-07T15:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420774",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
Yes, sorry, I meant `ambient_space.py`. Could you add a test:

```
sage: e1 = RootSystem(['A',3]).ambient_space(QQ)
sage: e2 = RootSystem(['A',3]).ambient_space(RR)
sage: e1 == e2
False
```
Then you can set a positive review on my behalf.



---

archive/issue_comments_420775.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774\">77876fa</a></td><td><code>trac 23384 adding doctest</code></td></tr></table>\n",
    "created_at": "2017-07-07T17:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420775",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774">77876fa</a></td><td><code>trac 23384 adding doctest</code></td></tr></table>




---

archive/issue_comments_420776.json:
```json
{
    "body": "**Changing commit** from \"[b514766cad89ec5d8769516cbae62ac74153e2b6](https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6)\" to \"[77876fa654b8199e0bc232bead73df281429d774](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)\".",
    "created_at": "2017-07-07T17:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420776",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b514766cad89ec5d8769516cbae62ac74153e2b6](https://github.com/sagemath/sagetrac-mirror/commit/b514766cad89ec5d8769516cbae62ac74153e2b6)" to "[77876fa654b8199e0bc232bead73df281429d774](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)".



---

archive/issue_comments_420777.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2017-07-07T17:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420777",
    "user": "https://github.com/fchapoton"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_420778.json:
```json
{
    "body": "<a id='comment:8'></a>\ndone, setting to positive, thanks",
    "created_at": "2017-07-07T17:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420778",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
done, setting to positive, thanks



---

archive/issue_comments_420779.json:
```json
{
    "body": "**Changing branch** from \"[u/chapoton/23384](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23384)\" to \"[77876fa654b8199e0bc232bead73df281429d774](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)\".",
    "created_at": "2017-07-26T22:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23384#issuecomment-420779",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/chapoton/23384](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23384)" to "[77876fa654b8199e0bc232bead73df281429d774](https://github.com/sagemath/sagetrac-mirror/commit/77876fa654b8199e0bc232bead73df281429d774)".



---

archive/issue_events_068024.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-07-26T22:12:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23384",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23384#event-68024"
}
```
