# Issue 23119: Change behavior if SAGE_PYTHON3=yes: build for both Python 2 and Python 3

archive/issues_022882.json:
```json
{
    "assignees": [],
    "body": "This is a proposal for changing Sage's build behavior: if `SAGE_PYTHON3=yes`, then build for both Python 2 and Python 3. This will increase the build time and the required disk space, but then at runtime, you can choose which version of Sage to run.\n\nI also propose that we introduce a new shell command \"sage3\" which runs Sage using Python 3.\n\nAfter Sage builds with Python 3, we can change the default to `SAGE_PYTHON3=yes`, so more people can test this. A while after that, we can stop supporting Python 2 altogether.\n\n\nDepends on #23039\nDepends on #23134\nDepends on #23129\n\nCC:  @embray @jdemeyer @nbruin\n\nBranch/Commit: **[u/jhpalmieri/py2and3](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/py2and3) @ [`a74f112`](https://github.com/sagemath/sagetrac-mirror/commit/a74f1123635c69e4f0bcbb3e0afa98391d9551bb)**\n\nAuthor: **John Palmieri**\n\nComponent: **python3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23119_\n\n",
    "closed_at": "2018-02-14T13:43:02Z",
    "created_at": "2017-05-31T19:35:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/wontfix"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Change behavior if SAGE_PYTHON3=yes: build for both Python 2 and Python 3",
    "type": "issue",
    "updated_at": "2018-02-14T13:43:02Z",
    "url": "https://github.com/sagemath/sage/issues/23119",
    "user": "https://github.com/jhpalmieri"
}
```
This is a proposal for changing Sage's build behavior: if `SAGE_PYTHON3=yes`, then build for both Python 2 and Python 3. This will increase the build time and the required disk space, but then at runtime, you can choose which version of Sage to run.

I also propose that we introduce a new shell command "sage3" which runs Sage using Python 3.

After Sage builds with Python 3, we can change the default to `SAGE_PYTHON3=yes`, so more people can test this. A while after that, we can stop supporting Python 2 altogether.


Depends on #23039
Depends on #23134
Depends on #23129

CC:  @embray @jdemeyer @nbruin

Branch/Commit: **[u/jhpalmieri/py2and3](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/py2and3) @ [`a74f112`](https://github.com/sagemath/sagetrac-mirror/commit/a74f1123635c69e4f0bcbb3e0afa98391d9551bb)**

Author: **John Palmieri**

Component: **python3**

_Issue created by migration from https://trac.sagemath.org/ticket/23119_





---

archive/issue_events_319501.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-05-31T19:35:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23119#event-319501"
}
```



---

archive/issue_events_319502.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-05-31T19:35:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23119#event-319502"
}
```



---

archive/issue_events_319503.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-05-31T19:35:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23119#event-319503"
}
```



---

archive/issue_events_319504.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2017-05-31T19:35:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23119#event-319504"
}
```



---

archive/issue_comments_346419.json:
```json
{
    "body": "Dependencies: **#23039**",
    "created_at": "2017-05-31T19:36:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346419",
    "user": "https://github.com/jhpalmieri"
}
```

Dependencies: **#23039**



---

archive/issue_comments_346420.json:
```json
{
    "body": "Branch: **[u/jhpalmieri/py2and3](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/py2and3)**",
    "created_at": "2017-05-31T19:43:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346420",
    "user": "https://github.com/jhpalmieri"
}
```

Branch: **[u/jhpalmieri/py2and3](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/py2and3)**



---

archive/issue_comments_346421.json:
```json
{
    "body": "Commit: **[`95202e7`](https://github.com/sagemath/sagetrac-mirror/commit/95202e7bcd78c516f60e733a8e2e6bb05d22483b)**",
    "created_at": "2017-05-31T19:47:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346421",
    "user": "https://github.com/jhpalmieri"
}
```

Commit: **[`95202e7`](https://github.com/sagemath/sagetrac-mirror/commit/95202e7bcd78c516f60e733a8e2e6bb05d22483b)**



---

archive/issue_comments_346422.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThis branch is not complete, but it is good enough for testing. In particular, it does not address all of the issues at #23106, only the ones absolutely necessary for running Sage (not that Sage builds with Python 3 yet, but it almost does). Also, there are a few spkg-check scripts that still use `sage-python23` (cvxopt, gmpy2, pycrypto, python_igraph, scipy). Should they still use `sage-python23`? Should they run tests twice if `SAGE_PYTHON3=yes`, once for each version of Python?\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95202e7bcd78c516f60e733a8e2e6bb05d22483b\"><code>95202e7</code></a></td><td><code>trac 23119: when SAGE_PYTHON3=yes, build for both Python 2 and Python 3.</code></td></tr></table>\n",
    "created_at": "2017-05-31T19:47:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346422",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

This branch is not complete, but it is good enough for testing. In particular, it does not address all of the issues at #23106, only the ones absolutely necessary for running Sage (not that Sage builds with Python 3 yet, but it almost does). Also, there are a few spkg-check scripts that still use `sage-python23` (cvxopt, gmpy2, pycrypto, python_igraph, scipy). Should they still use `sage-python23`? Should they run tests twice if `SAGE_PYTHON3=yes`, once for each version of Python?

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95202e7bcd78c516f60e733a8e2e6bb05d22483b"><code>95202e7</code></a></td><td><code>trac 23119: when SAGE_PYTHON3=yes, build for both Python 2 and Python 3.</code></td></tr></table>




---

archive/issue_comments_346423.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI recommend running \"autoreconf\" with this branch, because it changes `configure.ac`. What do I need to do to create a new configure tarball? (If you don't run autoreconf and if `SAGE_PYTHON3=yes`, just make sure that Python 2 is built before any packages depending on PYTHON in `build/make/Makefile`. For example, I think you could run `./configure; ./sage -i python2; make`.)",
    "created_at": "2017-05-31T20:06:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346423",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">comment:4</div>

I recommend running "autoreconf" with this branch, because it changes `configure.ac`. What do I need to do to create a new configure tarball? (If you don't run autoreconf and if `SAGE_PYTHON3=yes`, just make sure that Python 2 is built before any packages depending on PYTHON in `build/make/Makefile`. For example, I think you could run `./configure; ./sage -i python2; make`.)



---

archive/issue_comments_346424.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOne issue with this: if SAGE_PYTHON3=yes, the cythonizing scripts are not written correctly: the scripts `local/bin/cython`, `local/bin/cythonize`, and `local/bin/cygdb` start with `#!/usr/bin/env python3` (because the pip3 version is installed after the pip2 version). It would be better to have separate `cython`, `cython2`, and `cython3` scripts, the way IPython does.",
    "created_at": "2017-06-01T00:10:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346424",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

One issue with this: if SAGE_PYTHON3=yes, the cythonizing scripts are not written correctly: the scripts `local/bin/cython`, `local/bin/cythonize`, and `local/bin/cygdb` start with `#!/usr/bin/env python3` (because the pip3 version is installed after the pip2 version). It would be better to have separate `cython`, `cython2`, and `cython3` scripts, the way IPython does.



---

archive/issue_comments_346425.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79ef81e8bfc222800e5c40b193b1a6aeadc9ae8b\"><code>79ef81e</code></a></td><td><code>trac 23119: build Cython for Python 3 first, then Python 2.</code></td></tr></table>\n",
    "created_at": "2017-06-01T21:07:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346425",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79ef81e8bfc222800e5c40b193b1a6aeadc9ae8b"><code>79ef81e</code></a></td><td><code>trac 23119: build Cython for Python 3 first, then Python 2.</code></td></tr></table>




---

archive/issue_comments_346426.json:
```json
{
    "body": "Changed commit from **[`95202e7`](https://github.com/sagemath/sagetrac-mirror/commit/95202e7bcd78c516f60e733a8e2e6bb05d22483b)** to **[`79ef81e`](https://github.com/sagemath/sagetrac-mirror/commit/79ef81e8bfc222800e5c40b193b1a6aeadc9ae8b)**",
    "created_at": "2017-06-01T21:07:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346426",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`95202e7`](https://github.com/sagemath/sagetrac-mirror/commit/95202e7bcd78c516f60e733a8e2e6bb05d22483b)** to **[`79ef81e`](https://github.com/sagemath/sagetrac-mirror/commit/79ef81e8bfc222800e5c40b193b1a6aeadc9ae8b)**



---

archive/issue_comments_346427.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHere is a partial fix for the Cython problem. I wonder if we need to do the same for cysignals, and possibly for other packages. Is pynac also going to be a problem?",
    "created_at": "2017-06-01T21:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346427",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:7" align="right">comment:7</div>

Here is a partial fix for the Cython problem. I wonder if we need to do the same for cysignals, and possibly for other packages. Is pynac also going to be a problem?



---

archive/issue_comments_346428.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jhpalmieri](#comment:7):\n> ... Is pynac also going to be a problem?\n\nYes. Pynac uses the Python C API and several functions there that changed name between version 2 and 3.",
    "created_at": "2017-06-02T06:00:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346428",
    "user": "https://github.com/rwst"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jhpalmieri](#comment:7):
> ... Is pynac also going to be a problem?

Yes. Pynac uses the Python C API and several functions there that changed name between version 2 and 3.



---

archive/issue_comments_346429.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nFurther we need a new release of pynac or at least https://github.com/pynac/pynac/pull/248 just to build pynac.",
    "created_at": "2017-06-02T10:10:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346429",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

Further we need a new release of pynac or at least https://github.com/pynac/pynac/pull/248 just to build pynac.



---

archive/issue_comments_346430.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI will make a new release of brial early next week which will make it easier (and faster) to install for both python, although I don't know if it will work well with `pip` since I am not usually using it.",
    "created_at": "2017-06-02T10:23:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346430",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:10" align="right">comment:10</div>

I will make a new release of brial early next week which will make it easier (and faster) to install for both python, although I don't know if it will work well with `pip` since I am not usually using it.



---

archive/issue_comments_346431.json:
```json
{
    "body": "Changed dependencies from **#23039** to **#23039, #23134**",
    "created_at": "2017-06-03T08:46:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346431",
    "user": "https://github.com/rwst"
}
```

Changed dependencies from **#23039** to **#23039, #23134**



---

archive/issue_comments_346432.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSo what is the status of all that, now ? I would appreciate if something would happen, but I am not able to review these tickets.",
    "created_at": "2017-06-19T19:51:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346432",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:12" align="right">comment:12</div>

So what is the status of all that, now ? I would appreciate if something would happen, but I am not able to review these tickets.



---

archive/issue_comments_346433.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@fchapoton](#comment:12):\n> So what is the status of all that, now ? I would appreciate if something would happen, but I am not able to review these tickets.\n\nI am not sure what the hold up is in #23039 but the present ticket looks fine to me once this is resolved. I can do my `brial` stuff once this is merged.",
    "created_at": "2017-06-19T21:46:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346433",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@fchapoton](#comment:12):
> So what is the status of all that, now ? I would appreciate if something would happen, but I am not able to review these tickets.

I am not sure what the hold up is in #23039 but the present ticket looks fine to me once this is resolved. I can do my `brial` stuff once this is merged.



---

archive/issue_comments_346434.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@kiwifb](#comment:13):\n> I am not sure what the hold up is in #23039\n\nThere is a different approach to solve the same problem in #23129, and I think the plan is to merge that early in 8.1, to give it lots of time for testing.",
    "created_at": "2017-06-19T22:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346434",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@kiwifb](#comment:13):
> I am not sure what the hold up is in #23039

There is a different approach to solve the same problem in #23129, and I think the plan is to merge that early in 8.1, to give it lots of time for testing.



---

archive/issue_comments_346435.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@jhpalmieri](#comment:14):\n> Replying to [@kiwifb](#comment:13):\n> > I am not sure what the hold up is in #23039\n\n> \n> There is a different approach to solve the same problem in #23129, and I think the plan is to merge that early in 8.1, to give it lots of time for testing.\n\nSo, does this ticket depend on #23039 or not?",
    "created_at": "2017-06-19T22:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346435",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@jhpalmieri](#comment:14):
> Replying to [@kiwifb](#comment:13):
> > I am not sure what the hold up is in #23039

> 
> There is a different approach to solve the same problem in #23129, and I think the plan is to merge that early in 8.1, to give it lots of time for testing.

So, does this ticket depend on #23039 or not?



---

archive/issue_comments_346436.json:
```json
{
    "body": "Changed dependencies from **#23039, #23134** to **#23039, #23134, #23129**",
    "created_at": "2017-06-20T02:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346436",
    "user": "https://github.com/jhpalmieri"
}
```

Changed dependencies from **#23039, #23134** to **#23039, #23134, #23129**



---

archive/issue_comments_346437.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@kiwifb](#comment:15):\n> Replying to [@jhpalmieri](#comment:14):\n> > Replying to [@kiwifb](#comment:13):\n> > > I am not sure what the hold up is in #23039\n\n> > \n> > There is a different approach to solve the same problem in #23129, and I think the plan is to merge that early in 8.1, to give it lots of time for testing.\n\n> \n> So, does this ticket depend on #23039 or not?\n\nIt depends on #23039 or #23129. If #23129 gets merged, then we'll close #23039 as a duplicate, and vice versa, so I'll make both dependencies.",
    "created_at": "2017-06-20T02:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346437",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@kiwifb](#comment:15):
> Replying to [@jhpalmieri](#comment:14):
> > Replying to [@kiwifb](#comment:13):
> > > I am not sure what the hold up is in #23039

> > 
> > There is a different approach to solve the same problem in #23129, and I think the plan is to merge that early in 8.1, to give it lots of time for testing.

> 
> So, does this ticket depend on #23039 or not?

It depends on #23039 or #23129. If #23129 gets merged, then we'll close #23039 as a duplicate, and vice versa, so I'll make both dependencies.



---

archive/issue_comments_346438.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nSo what happens here now ? the branch does not apply.",
    "created_at": "2017-08-07T12:06:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346438",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

So what happens here now ? the branch does not apply.



---

archive/issue_comments_346439.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5bfcf9c7546595e0225f41a5b3b016b469ad033e\"><code>5bfcf9c</code></a></td><td><code>trac 23119: rebased to Sage 8.1.beta1</code></td></tr></table>\n",
    "created_at": "2017-08-07T18:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346439",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5bfcf9c7546595e0225f41a5b3b016b469ad033e"><code>5bfcf9c</code></a></td><td><code>trac 23119: rebased to Sage 8.1.beta1</code></td></tr></table>




---

archive/issue_comments_346440.json:
```json
{
    "body": "Changed commit from **[`79ef81e`](https://github.com/sagemath/sagetrac-mirror/commit/79ef81e8bfc222800e5c40b193b1a6aeadc9ae8b)** to **[`5bfcf9c`](https://github.com/sagemath/sagetrac-mirror/commit/5bfcf9c7546595e0225f41a5b3b016b469ad033e)**",
    "created_at": "2017-08-07T18:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346440",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`79ef81e`](https://github.com/sagemath/sagetrac-mirror/commit/79ef81e8bfc222800e5c40b193b1a6aeadc9ae8b)** to **[`5bfcf9c`](https://github.com/sagemath/sagetrac-mirror/commit/5bfcf9c7546595e0225f41a5b3b016b469ad033e)**



---

archive/issue_comments_346441.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b380b2176b7230da17a51ce7b4ec80222d7ee625\"><code>b380b21</code></a></td><td><code>trac 23119: more rebasing</code></td></tr></table>\n",
    "created_at": "2017-08-07T18:21:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346441",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b380b2176b7230da17a51ce7b4ec80222d7ee625"><code>b380b21</code></a></td><td><code>trac 23119: more rebasing</code></td></tr></table>




---

archive/issue_comments_346442.json:
```json
{
    "body": "Changed commit from **[`5bfcf9c`](https://github.com/sagemath/sagetrac-mirror/commit/5bfcf9c7546595e0225f41a5b3b016b469ad033e)** to **[`b380b21`](https://github.com/sagemath/sagetrac-mirror/commit/b380b2176b7230da17a51ce7b4ec80222d7ee625)**",
    "created_at": "2017-08-07T18:21:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346442",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5bfcf9c`](https://github.com/sagemath/sagetrac-mirror/commit/5bfcf9c7546595e0225f41a5b3b016b469ad033e)** to **[`b380b21`](https://github.com/sagemath/sagetrac-mirror/commit/b380b2176b7230da17a51ce7b4ec80222d7ee625)**



---

archive/issue_comments_346443.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThis should apply now.",
    "created_at": "2017-08-07T18:28:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346443",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">comment:20</div>

This should apply now.



---

archive/issue_comments_346444.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nI don't know if we also need to include #23325 as a dependency. In any case we need to somehow deal with Pynac. Does it need to be built twice, once for each version of Python? If so, how do we distinguish between the library files once they have been built? Do we need two different `local/lib` directories?",
    "created_at": "2017-08-07T20:08:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346444",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

I don't know if we also need to include #23325 as a dependency. In any case we need to somehow deal with Pynac. Does it need to be built twice, once for each version of Python? If so, how do we distinguish between the library files once they have been built? Do we need two different `local/lib` directories?



---

archive/issue_comments_346445.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@jhpalmieri](#comment:21):\n> I don't know if we also need to include #23325 as a dependency. In any case we need to somehow deal with Pynac. Does it need to be built twice, once for each version of Python? If so, how do we distinguish between the library files once they have been built? Do we need two different `local/lib` directories?\n\n`pynac` produce only one usable library with soname `libpynac.so.x.y`. It is not versioned for python, meaning that even if you build it twice, you get the same library again. It will just be linked to a different python after rebuild (and since some internals depend on the python version, you cannot just underlink to provide whichever python when you link against pynac).\n\nFurther, as far as I can tell, and I tried, there is no way to introduce the python implementation as a variable in the library name in libtool. It just doesn't work. In sage-on-gentoo I\n* make a copy of the source for each version of python\n* patch Makfeile.am in each copy to replace `libpynac.la` by `libpynac_pythonX_Y.la`\n* rerun autoconf in each copy\n* build and install each copy which now install `libpynac_pythonX_Y.so`\n* Finally patch sage to get the right pynac library depending on the python I build for.\nLuckily the header are independent of the python implementation, otherwise it would be even more tricky.\n\nGiven that sage doesn't ship autotools by default, if you want to reproduce that setup you need to re-create one tarball by version of python.",
    "created_at": "2017-08-07T21:37:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346445",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@jhpalmieri](#comment:21):
> I don't know if we also need to include #23325 as a dependency. In any case we need to somehow deal with Pynac. Does it need to be built twice, once for each version of Python? If so, how do we distinguish between the library files once they have been built? Do we need two different `local/lib` directories?

`pynac` produce only one usable library with soname `libpynac.so.x.y`. It is not versioned for python, meaning that even if you build it twice, you get the same library again. It will just be linked to a different python after rebuild (and since some internals depend on the python version, you cannot just underlink to provide whichever python when you link against pynac).

Further, as far as I can tell, and I tried, there is no way to introduce the python implementation as a variable in the library name in libtool. It just doesn't work. In sage-on-gentoo I
* make a copy of the source for each version of python
* patch Makfeile.am in each copy to replace `libpynac.la` by `libpynac_pythonX_Y.la`
* rerun autoconf in each copy
* build and install each copy which now install `libpynac_pythonX_Y.so`
* Finally patch sage to get the right pynac library depending on the python I build for.
Luckily the header are independent of the python implementation, otherwise it would be even more tricky.

Given that sage doesn't ship autotools by default, if you want to reproduce that setup you need to re-create one tarball by version of python.



---

archive/issue_comments_346446.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThis is far from my area of expertise, but could we instead put a version of `libpynac.so.x.y` in `local/lib/python2.7/` or `local/lib/python3.6/` (or elsewhere), depending on the Python version used when building it, and then give !Sage/Python the appropriate library path?",
    "created_at": "2017-08-07T22:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346446",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:23" align="right">comment:23</div>

This is far from my area of expertise, but could we instead put a version of `libpynac.so.x.y` in `local/lib/python2.7/` or `local/lib/python3.6/` (or elsewhere), depending on the Python version used when building it, and then give !Sage/Python the appropriate library path?



---

archive/issue_comments_346447.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jhpalmieri](#comment:23):\n> This is far from my area of expertise, but could we instead put a version of `libpynac.so.x.y` in `local/lib/python2.7/` or `local/lib/python3.6/` (or elsewhere), depending on the Python version used when building it, and then give !Sage/Python the appropriate library path?\n\nThis is not a standard path, so you will have to add specific rpath for it if you do it this way.",
    "created_at": "2017-08-07T22:38:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346447",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jhpalmieri](#comment:23):
> This is far from my area of expertise, but could we instead put a version of `libpynac.so.x.y` in `local/lib/python2.7/` or `local/lib/python3.6/` (or elsewhere), depending on the Python version used when building it, and then give !Sage/Python the appropriate library path?

This is not a standard path, so you will have to add specific rpath for it if you do it this way.



---

archive/issue_comments_346448.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nAnd installation would need to be manual (`make install` will not give you what you want). But Erik's stuff about staging before installing could help with that. Distro are quite adept with this kind of stuff.",
    "created_at": "2017-08-07T22:44:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346448",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

And installation would need to be manual (`make install` will not give you what you want). But Erik's stuff about staging before installing could help with that. Distro are quite adept with this kind of stuff.



---

archive/issue_comments_346449.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nLooking at the ticket in its present form. `brial` doesn't quite have the same trouble as `pynac` but it uses an autotool building system. So I would prefer if, like I suggested for `pynac`, `PYTHON` was set at the end of the configure line.\n\nOf course the point will be moot once we bump `brial` since I decoupled the python part from the autotool build system to allow it to be more easily built against multiple python.",
    "created_at": "2017-08-07T22:49:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346449",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:26" align="right">comment:26</div>

Looking at the ticket in its present form. `brial` doesn't quite have the same trouble as `pynac` but it uses an autotool building system. So I would prefer if, like I suggested for `pynac`, `PYTHON` was set at the end of the configure line.

Of course the point will be moot once we bump `brial` since I decoupled the python part from the autotool build system to allow it to be more easily built against multiple python.



---

archive/issue_comments_346450.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@kiwifb](#comment:25):\n> And installation would need to be manual (`make install` will not give you what you want). But Erik's stuff about staging before installing could help with that. Distro are quite adept with this kind of stuff.\n\nI am talking rubbish. Ignore this comment, configure will help you with this. \n\nHowever you will still need to put `-L$SAGE_LOCAL/lib/pythonX.Y -Wl,-rpath=$SAGE_LOCAL/lib/pythonX.Y` somewhere in `setup.py` or `module_list.py` and distros may hate for putting stuff in a non standard place, and they'll have to fix it to whatever they want to use.",
    "created_at": "2017-08-08T01:28:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346450",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@kiwifb](#comment:25):
> And installation would need to be manual (`make install` will not give you what you want). But Erik's stuff about staging before installing could help with that. Distro are quite adept with this kind of stuff.

I am talking rubbish. Ignore this comment, configure will help you with this. 

However you will still need to put `-L$SAGE_LOCAL/lib/pythonX.Y -Wl,-rpath=$SAGE_LOCAL/lib/pythonX.Y` somewhere in `setup.py` or `module_list.py` and distros may hate for putting stuff in a non standard place, and they'll have to fix it to whatever they want to use.



---

archive/issue_comments_346451.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI am thinking of this ticket as being useful for developers who want to use Python 3, so maybe we should keep the default setup. So for example, build copies of the `pynac` library and put them in `local/lib/python...`, and then maybe at the very end of building Sage, construct a symlink at `local/lib/pynac.so.x.y` pointing to one of them. Which one? It could depend on the value of `SAGE_PYTHON3`, but this comes back to the old question of whether `SAGE_PYTHON3` should have any effect at run time, or only build time. For developers only, we could have scripts `sage2` and `sage3` which first create the appropriate symlink and then run Sage using the appropriate version of Python. (For developers only because we should not in general assume write access to `SAGE_LOCAL/lib`.)\n\nAs I said, this is not my area of expertise, so I would hope other people could come up with better solutions.",
    "created_at": "2017-08-08T03:00:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346451",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:28" align="right">comment:28</div>

I am thinking of this ticket as being useful for developers who want to use Python 3, so maybe we should keep the default setup. So for example, build copies of the `pynac` library and put them in `local/lib/python...`, and then maybe at the very end of building Sage, construct a symlink at `local/lib/pynac.so.x.y` pointing to one of them. Which one? It could depend on the value of `SAGE_PYTHON3`, but this comes back to the old question of whether `SAGE_PYTHON3` should have any effect at run time, or only build time. For developers only, we could have scripts `sage2` and `sage3` which first create the appropriate symlink and then run Sage using the appropriate version of Python. (For developers only because we should not in general assume write access to `SAGE_LOCAL/lib`.)

As I said, this is not my area of expertise, so I would hope other people could come up with better solutions.



---

archive/issue_comments_346452.json:
```json
{
    "body": "Changed commit from **[`b380b21`](https://github.com/sagemath/sagetrac-mirror/commit/b380b2176b7230da17a51ce7b4ec80222d7ee625)** to **[`a74f112`](https://github.com/sagemath/sagetrac-mirror/commit/a74f1123635c69e4f0bcbb3e0afa98391d9551bb)**",
    "created_at": "2017-08-08T03:05:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346452",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b380b21`](https://github.com/sagemath/sagetrac-mirror/commit/b380b2176b7230da17a51ce7b4ec80222d7ee625)** to **[`a74f112`](https://github.com/sagemath/sagetrac-mirror/commit/a74f1123635c69e4f0bcbb3e0afa98391d9551bb)**



---

archive/issue_comments_346453.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a74f1123635c69e4f0bcbb3e0afa98391d9551bb\"><code>a74f112</code></a></td><td><code>trac 23119: for brial, set PYTHON at the end of the ./configure line</code></td></tr></table>\n",
    "created_at": "2017-08-08T03:05:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346453",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a74f1123635c69e4f0bcbb3e0afa98391d9551bb"><code>a74f112</code></a></td><td><code>trac 23119: for brial, set PYTHON at the end of the ./configure line</code></td></tr></table>




---

archive/issue_comments_346454.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@kiwifb](#comment:26):\n> Looking at the ticket in its present form. `brial` doesn't quite have the same trouble as `pynac` but it uses an autotool building system. So I would prefer if, like I suggested for `pynac`, `PYTHON` was set at the end of the configure line.\n\nI made this change for `brial`.",
    "created_at": "2017-08-08T03:05:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346454",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@kiwifb](#comment:26):
> Looking at the ticket in its present form. `brial` doesn't quite have the same trouble as `pynac` but it uses an autotool building system. So I would prefer if, like I suggested for `pynac`, `PYTHON` was set at the end of the configure line.

I made this change for `brial`.



---

archive/issue_comments_346455.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@jhpalmieri](#comment:28):\n> I am thinking of this ticket as being useful for developers who want to use Python 3, so maybe we should keep the default setup. So for example, build copies of the `pynac` library and put them in `local/lib/python...`, and then maybe at the very end of building Sage, construct a symlink at `local/lib/pynac.so.x.y` pointing to one of them. Which one? It could depend on the value of `SAGE_PYTHON3`, but this comes back to the old question of whether `SAGE_PYTHON3` should have any effect at run time, or only build time. For developers only, we could have scripts `sage2` and `sage3` which first create the appropriate symlink and then run Sage using the appropriate version of Python. (For developers only because we should not in general assume write access to `SAGE_LOCAL/lib`.)\n> \n> As I said, this is not my area of expertise, so I would hope other people could come up with better solutions.\n\nThe same discussion happened in https://groups.google.com/forum/?hl=en#!searchin/sage-devel/Pynac$20python%7Csort:date/sage-devel/IY8rc3i-sh4/-MfB1OvkBQAJ\n\nNils Bruin: \"But then we need to either build libraries libpynac2 and libpynac3 or put libpynac somewhere in local/lib/python*\".\n\nWhat's wrong with building Pynac twice?",
    "created_at": "2017-08-08T15:03:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346455",
    "user": "https://github.com/rwst"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@jhpalmieri](#comment:28):
> I am thinking of this ticket as being useful for developers who want to use Python 3, so maybe we should keep the default setup. So for example, build copies of the `pynac` library and put them in `local/lib/python...`, and then maybe at the very end of building Sage, construct a symlink at `local/lib/pynac.so.x.y` pointing to one of them. Which one? It could depend on the value of `SAGE_PYTHON3`, but this comes back to the old question of whether `SAGE_PYTHON3` should have any effect at run time, or only build time. For developers only, we could have scripts `sage2` and `sage3` which first create the appropriate symlink and then run Sage using the appropriate version of Python. (For developers only because we should not in general assume write access to `SAGE_LOCAL/lib`.)
> 
> As I said, this is not my area of expertise, so I would hope other people could come up with better solutions.

The same discussion happened in https://groups.google.com/forum/?hl=en#!searchin/sage-devel/Pynac$20python%7Csort:date/sage-devel/IY8rc3i-sh4/-MfB1OvkBQAJ

Nils Bruin: "But then we need to either build libraries libpynac2 and libpynac3 or put libpynac somewhere in local/lib/python*".

What's wrong with building Pynac twice?



---

archive/issue_comments_346456.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@rwst](#comment:31):\n> What's wrong with building Pynac twice?\n\nThere is nothing wrong with that. The only thing we need to make sure is that there is a difference between the libraries either in name or location. In sage-on-gentoo I choose name but it is the hard way.",
    "created_at": "2017-08-08T20:22:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346456",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@rwst](#comment:31):
> What's wrong with building Pynac twice?

There is nothing wrong with that. The only thing we need to make sure is that there is a difference between the libraries either in name or location. In sage-on-gentoo I choose name but it is the hard way.



---

archive/issue_comments_346457.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nSingular also has a Python module, but I guess it apparently isn't used by Sage in any way so it can just be built against one Python.\n\nAnyways I'm actually -1 on this approach of having two separate Sage installs for Python 2 and Python 3 in the same SAGE_LOCAL in general.  I think it overcomplicates things needlessly, when one could simply have two separate installs in separate SAGE_LOCALs each using different Pythons.",
    "created_at": "2017-08-09T09:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346457",
    "user": "https://github.com/embray"
}
```

<div id="comment:33" align="right">comment:33</div>

Singular also has a Python module, but I guess it apparently isn't used by Sage in any way so it can just be built against one Python.

Anyways I'm actually -1 on this approach of having two separate Sage installs for Python 2 and Python 3 in the same SAGE_LOCAL in general.  I think it overcomplicates things needlessly, when one could simply have two separate installs in separate SAGE_LOCALs each using different Pythons.



---

archive/issue_comments_346458.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@embray](#comment:33):\n> Singular also has a Python module, but I guess it apparently isn't used by Sage in any way so it can just be built against one Python.\n> \n\nIt is also only python2.7 as far as I remember.\n\n> Anyways I'm actually -1 on this approach of having two separate Sage installs for Python 2 and Python 3 in the same SAGE_LOCAL in general.  I think it overcomplicates things needlessly, when one could simply have two separate installs in separate SAGE_LOCALs each using different Pythons.\n\nAs far as standalone sage is concerned, I approve of that approach. The dual install is only nice for people like me that do sage-on-distro. You don't really get the freedom you are talking about in that case. But I'll admit to being marginal.",
    "created_at": "2017-08-09T09:12:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346458",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@embray](#comment:33):
> Singular also has a Python module, but I guess it apparently isn't used by Sage in any way so it can just be built against one Python.
> 

It is also only python2.7 as far as I remember.

> Anyways I'm actually -1 on this approach of having two separate Sage installs for Python 2 and Python 3 in the same SAGE_LOCAL in general.  I think it overcomplicates things needlessly, when one could simply have two separate installs in separate SAGE_LOCALs each using different Pythons.

As far as standalone sage is concerned, I approve of that approach. The dual install is only nice for people like me that do sage-on-distro. You don't really get the freedom you are talking about in that case. But I'll admit to being marginal.



---

archive/issue_comments_346459.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI'm not sure I follow.  Why install Sage via a distribution package that includes a Python 2 Sage and a Python 3 Sage.  Having both only seems relevant to me for development reasons, in which case one would't be installing via a packaging system anyways...\n\nI'm not against this if it's helpful to you somehow.  But I don't understand how it's helpful, and it throws a wrench slightly into support for virtual packages (of which Python would be one).",
    "created_at": "2017-08-09T09:15:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346459",
    "user": "https://github.com/embray"
}
```

<div id="comment:35" align="right">comment:35</div>

I'm not sure I follow.  Why install Sage via a distribution package that includes a Python 2 Sage and a Python 3 Sage.  Having both only seems relevant to me for development reasons, in which case one would't be installing via a packaging system anyways...

I'm not against this if it's helpful to you somehow.  But I don't understand how it's helpful, and it throws a wrench slightly into support for virtual packages (of which Python would be one).



---

archive/issue_comments_346460.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nDistros offer side by side installations of many package for different version of python - unless there is a major problem with doing so. Of course python 2.7 will be phased out eventually.\n\nDevelopment is also a reason. It looks like until a few days ago I may have been the only one with a complete real python3 build.\n\nAnyway, **I don't use any bits of sage packaging** - nor do other distros. What you do about it has usually marginal effect on us at best. I try not to be dragged into ticket about sage's packaging system for that reason. Not relevant, unless it impact some of my other interests like clang support - primarily for OS X.",
    "created_at": "2017-08-09T09:22:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346460",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:36" align="right">comment:36</div>

Distros offer side by side installations of many package for different version of python - unless there is a major problem with doing so. Of course python 2.7 will be phased out eventually.

Development is also a reason. It looks like until a few days ago I may have been the only one with a complete real python3 build.

Anyway, **I don't use any bits of sage packaging** - nor do other distros. What you do about it has usually marginal effect on us at best. I try not to be dragged into ticket about sage's packaging system for that reason. Not relevant, unless it impact some of my other interests like clang support - primarily for OS X.



---

archive/issue_comments_346461.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@embray](#comment:33):\n> Anyways I'm actually -1 on this approach of having two separate Sage installs for Python 2 and Python 3 in the same SAGE_LOCAL in general.  I think it overcomplicates things needlessly, when one could simply have two separate installs in separate SAGE_LOCALs each using different Pythons.\n\nCan you implement something like this so we can test it out?",
    "created_at": "2017-08-09T15:39:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346461",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@embray](#comment:33):
> Anyways I'm actually -1 on this approach of having two separate Sage installs for Python 2 and Python 3 in the same SAGE_LOCAL in general.  I think it overcomplicates things needlessly, when one could simply have two separate installs in separate SAGE_LOCALs each using different Pythons.

Can you implement something like this so we can test it out?



---

archive/issue_comments_346462.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI'm just talking about `export SAGE_LOCAL=<whatever>`.  Is this not possible?",
    "created_at": "2017-08-10T18:18:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346462",
    "user": "https://github.com/embray"
}
```

<div id="comment:38" align="right">comment:38</div>

I'm just talking about `export SAGE_LOCAL=<whatever>`.  Is this not possible?



---

archive/issue_comments_346463.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nFirst, my proposed goal is to build Sage so that you can switch, at run-time, between Python 2 and Python 3. With that goal, I don't want to build everything twice, just the things that depend on the version of Python. On OS X or other systems with a bad default version of `gcc`, building `gcc` twice will increase the build time considerably, for example. Singular or R can take a while to build, and I don't think they depend on the version of Python. So I would want something more clever than just setting `SAGE_LOCAL` twice during the build process.",
    "created_at": "2017-08-10T19:12:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346463",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:39" align="right">comment:39</div>

First, my proposed goal is to build Sage so that you can switch, at run-time, between Python 2 and Python 3. With that goal, I don't want to build everything twice, just the things that depend on the version of Python. On OS X or other systems with a bad default version of `gcc`, building `gcc` twice will increase the build time considerably, for example. Singular or R can take a while to build, and I don't think they depend on the version of Python. So I would want something more clever than just setting `SAGE_LOCAL` twice during the build process.



---

archive/issue_comments_346464.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@jhpalmieri](#comment:37):\n> Replying to [@embray](#comment:33):\n> > Anyways I'm actually -1 on this approach of having two separate Sage installs for Python 2 and Python 3 in the same SAGE_LOCAL in general.  I think it overcomplicates things needlessly, when one could simply have two separate installs in separate SAGE_LOCALs each using different Pythons.\n\n> \n> Can you implement something like this so we can test it out?\n\nI would also prefer to have separate installs, one for python2-sage and one for python3-sage. I am not interested in being able to switch inside one unique SAGE_LOCAL. But the point is: when is this going to be possible ? I have been asking for this for quite some time now. Using SAGE_PYTHON3=yes is not enough, for example because of the scripts in src/bin, but more generally because of other build issues that have not been cared about that much so far.",
    "created_at": "2017-08-26T08:10:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346464",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@jhpalmieri](#comment:37):
> Replying to [@embray](#comment:33):
> > Anyways I'm actually -1 on this approach of having two separate Sage installs for Python 2 and Python 3 in the same SAGE_LOCAL in general.  I think it overcomplicates things needlessly, when one could simply have two separate installs in separate SAGE_LOCALs each using different Pythons.

> 
> Can you implement something like this so we can test it out?

I would also prefer to have separate installs, one for python2-sage and one for python3-sage. I am not interested in being able to switch inside one unique SAGE_LOCAL. But the point is: when is this going to be possible ? I have been asking for this for quite some time now. Using SAGE_PYTHON3=yes is not enough, for example because of the scripts in src/bin, but more generally because of other build issues that have not been cared about that much so far.



---

archive/issue_comments_346465.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nPeople who are interested in separate SAGE_LOCALs from one source tree might be interested in helping to update/complete ticket #21469 (VPATH builds).",
    "created_at": "2017-08-27T02:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346465",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:41" align="right">comment:41</div>

People who are interested in separate SAGE_LOCALs from one source tree might be interested in helping to update/complete ticket #21469 (VPATH builds).



---

archive/issue_comments_346466.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nClose as wontfix?",
    "created_at": "2018-02-14T13:22:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346466",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:42" align="right">comment:42</div>

Close as wontfix?



---

archive/issue_comments_346467.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nYes, I think so.",
    "created_at": "2018-02-14T13:22:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23119#issuecomment-346467",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:43" align="right">comment:43</div>

Yes, I think so.



---

archive/issue_events_319505.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-14T13:43:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23119#event-319505"
}
```



---

archive/issue_events_319506.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-14T13:43:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23119#event-319506"
}
```



---

archive/issue_events_319507.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-14T13:43:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23119#event-319507"
}
```



---

archive/issue_events_319508.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-02-14T13:43:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23119",
    "label": "https://github.com/sagemath/sage/labels/wontfix",
    "label_color": "c6c6c6",
    "label_name": "wontfix",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23119#event-319508"
}
```
