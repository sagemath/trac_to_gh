# Issue 23203: A polynomial ring contains its basering

archive/issues_022966.json:
```json
{
    "body": "Currently, this fails\n\n```\nsage: R.<x> = ZZ[]\nsage: S.<y> = R[]\nsage: R.is_subring(S)\nNotImplementedError\n```\n\nCC:  jpflori\n\nKeywords: sd86.5, sd87\n\nReviewer: Claire Tomesch\n\nAuthor: Julian R\u00fcth\n\nBranch: 5f99cf980c01783faecf31b1009ee39adea36c69\n\nDependencies: #23204\n\nCommit: 5f99cf980c01783faecf31b1009ee39adea36c69\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23203\n\n",
    "closed_at": "2017-08-03T22:11:29Z",
    "created_at": "2017-06-09T22:37:54Z",
    "labels": [
        "component: commutative algebra",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "A polynomial ring contains its basering",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23203",
    "user": "https://github.com/saraedum"
}
```
Currently, this fails

```
sage: R.<x> = ZZ[]
sage: S.<y> = R[]
sage: R.is_subring(S)
NotImplementedError
```

CC:  jpflori

Keywords: sd86.5, sd87

Reviewer: Claire Tomesch

Author: Julian RÃ¼th

Branch: 5f99cf980c01783faecf31b1009ee39adea36c69

Dependencies: #23204

Commit: 5f99cf980c01783faecf31b1009ee39adea36c69

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23203





---

archive/issue_comments_320924.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-09T23:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320924",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_320925.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2017-06-09T23:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320925",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_comments_320926.json:
```json
{
    "body": "<a id='comment:5'></a>(needs review: the `is_subring` does not work without #23204.)",
    "created_at": "2017-06-09T23:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320926",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:5'></a>(needs review: the `is_subring` does not work without #23204.)



---

archive/issue_comments_320927.json:
```json
{
    "body": "<a id='comment:8'></a>While it is a degenerate case, a polynomial ring could be isomorphic to its base ring:\n\n```\nsage: PolynomialRing(ZZ, [])\nMultivariate Polynomial Ring in no variables over Integer Ring\n```",
    "created_at": "2017-06-23T00:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320927",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:8'></a>While it is a degenerate case, a polynomial ring could be isomorphic to its base ring:

```
sage: PolynomialRing(ZZ, [])
Multivariate Polynomial Ring in no variables over Integer Ring
```



---

archive/issue_comments_320928.json:
```json
{
    "body": "Changing keywords from \"sd86.5\" to \"sd86.5, sd87\".",
    "created_at": "2017-07-17T17:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320928",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "sd86.5" to "sd86.5, sd87".



---

archive/issue_comments_320929.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2017-07-17T21:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320929",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_320930.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-20T18:12:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320930",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320931.json:
```json
{
    "body": "<a id='comment:13'></a>Full names in reviewer field please :)",
    "created_at": "2017-07-20T20:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320931",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:13'></a>Full names in reviewer field please :)



---

archive/issue_comments_320932.json:
```json
{
    "body": "<a id='comment:16'></a>After fetching and merging #23204 into my local branch for this ticket, I built sage. I then ran `./sage -coverage <files>` for all the files listed in the diff for this ticket, and compared that to the results of running the same command for the latest build of develop (8.0 rc2). The same number of missing doctests occurred in each build for each file, and although the total number of doctests for `src/sage/rings/morphism.pyx` and `src/sage/rings/polynomial/polynomial_element.pyx` changed between the develop build and this build, this was to be expected given the number of methods deleted (`__nonzero__` and `is_zero`) and the number of trivial methods added (`is_injective` and (`is_surjective`), respectively. So, it appears that functionally the doctest coverage remained the same.\n\nI am still within the (lengthly) process of running `./sage -tp 8 --long src/` now. It has produced some errors, which I will attempt to replicate before posting about them. Running all of the doctests may have been a mistake... I will also retry a more limited set of doctests shortly as well.",
    "created_at": "2017-07-21T18:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320932",
    "user": "https://trac.sagemath.org/admin/accounts/users/cmt"
}
```

<a id='comment:16'></a>After fetching and merging #23204 into my local branch for this ticket, I built sage. I then ran `./sage -coverage <files>` for all the files listed in the diff for this ticket, and compared that to the results of running the same command for the latest build of develop (8.0 rc2). The same number of missing doctests occurred in each build for each file, and although the total number of doctests for `src/sage/rings/morphism.pyx` and `src/sage/rings/polynomial/polynomial_element.pyx` changed between the develop build and this build, this was to be expected given the number of methods deleted (`__nonzero__` and `is_zero`) and the number of trivial methods added (`is_injective` and (`is_surjective`), respectively. So, it appears that functionally the doctest coverage remained the same.

I am still within the (lengthly) process of running `./sage -tp 8 --long src/` now. It has produced some errors, which I will attempt to replicate before posting about them. Running all of the doctests may have been a mistake... I will also retry a more limited set of doctests shortly as well.



---

archive/issue_comments_320933.json:
```json
{
    "body": "<a id='comment:17'></a>I just updated #23204 to fix typos in two of the doctest.  If you are getting a two failures, you might try checking out the updated ticket.\n\nReplying to [comment:16 cmt]:\n> After fetching and merging #23204 into my local branch for this ticket, I built sage. I then ran `./sage -coverage <files>` for all the files listed in the diff for this ticket, and compared that to the results of running the same command for the latest build of develop (8.0 rc2). The same number of missing doctests occurred in each build for each file, and although the total number of doctests for `src/sage/rings/morphism.pyx` and `src/sage/rings/polynomial/polynomial_element.pyx` changed between the develop build and this build, this was to be expected given the number of methods deleted (`__nonzero__` and `is_zero`) and the number of trivial methods added (`is_injective` and (`is_surjective`), respectively. So, it appears that functionally the doctest coverage remained the same.\n> \n> I am still within the (lengthly) process of running `./sage -tp 8 --long src/` now. It has produced some errors, which I will attempt to replicate before posting about them. Running all of the doctests may have been a mistake... I will also retry a more limited set of doctests shortly as well.",
    "created_at": "2017-07-21T18:58:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320933",
    "user": "https://github.com/adeines"
}
```

<a id='comment:17'></a>I just updated #23204 to fix typos in two of the doctest.  If you are getting a two failures, you might try checking out the updated ticket.

Replying to [comment:16 cmt]:
> After fetching and merging #23204 into my local branch for this ticket, I built sage. I then ran `./sage -coverage <files>` for all the files listed in the diff for this ticket, and compared that to the results of running the same command for the latest build of develop (8.0 rc2). The same number of missing doctests occurred in each build for each file, and although the total number of doctests for `src/sage/rings/morphism.pyx` and `src/sage/rings/polynomial/polynomial_element.pyx` changed between the develop build and this build, this was to be expected given the number of methods deleted (`__nonzero__` and `is_zero`) and the number of trivial methods added (`is_injective` and (`is_surjective`), respectively. So, it appears that functionally the doctest coverage remained the same.
> 
> I am still within the (lengthly) process of running `./sage -tp 8 --long src/` now. It has produced some errors, which I will attempt to replicate before posting about them. Running all of the doctests may have been a mistake... I will also retry a more limited set of doctests shortly as well.



---

archive/issue_comments_320934.json:
```json
{
    "body": "<a id='comment:18'></a>Okay, something in my configuration had gotten messed up, so I started over entirely. I just pulled the latest version of this branch (`5f99cf980c`), which has the content of #23204 already merged in, merged in the latest develop branch (`74b03027bc`), and rebuilt. I then ran the following limited set of doctests and got these results:\n\n```bash\nbash-3.2$ ./sage -tp 8 --long src/sage/structure/ src/sage/categories/ src/sage/rings/ src/sage/modular/ src/sage/schemes/\n\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2017-07-21-16-33-34-b8fb451a.\nGit branch: t/23203/a_polynomial_ring_contains_its_basering\nUsing --optional=ccache,mpir,python2,sage\nSorting sources by runtime so that slower doctests are run first....\nDoctesting 883 files using 8 threads.\n\n...\n\nsage -t --long src/sage/schemes/curves/projective_curve.py\n**********************************************************************\nFile \"src/sage/schemes/curves/projective_curve.py\", line 1304, in sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model\nFailed example:\n    D = C.ordinary_model(); D # long time (2 seconds)\nException raised:\n    Traceback (most recent call last):\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model[8]>\", line 1, in <module>\n        D = C.ordinary_model(); D # long time (2 seconds)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/curves/projective_curve.py\", line 1393, in ordinary_model\n        emb = extension(C.singular_subscheme())\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/curves/projective_curve.py\", line 1373, in extension\n        pts = self.change_ring(F.embeddings(QQbar)[0]).rational_points()\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py\", line 1846, in change_ring\n        I = [f.change_ring(R) for f in self.defining_polynomials()]\n      File \"sage/rings/polynomial/multi_polynomial.pyx\", line 873, in sage.rings.polynomial.multi_polynomial.MPolynomial.change_ring (build/cythonized/sage/rings/polynomial/multi_polynomial.c:13133)\n        return self.parent().change_ring(R)(self)\n      File \"sage/rings/polynomial/multi_polynomial_ring_generic.pyx\", line 985, in sage.rings.polynomial.multi_polynomial_ring_generic.MPolynomialRing_generic.change_ring (build/cythonized/sage/rings/polynomial/multi_polynomial_ring_generic.c:15237)\n        return PolynomialRing(base_ring, self.ngens(), names, order=order)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py\", line 438, in PolynomialRing\n        raise TypeError('base_ring must be a ring')\n    TypeError: base_ring must be a ring\n**********************************************************************\nFile \"src/sage/schemes/curves/projective_curve.py\", line 1321, in sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model\nFailed example:\n    all([D.codomain().is_ordinary_singularity(Q) for Q in D.codomain().singular_points()]) # long time\nException raised:\n    Traceback (most recent call last):\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model[9]>\", line 1, in <module>\n        all([D.codomain().is_ordinary_singularity(Q) for Q in D.codomain().singular_points()]) # long time\n    NameError: name 'D' is not defined\n**********************************************************************\nFile \"src/sage/schemes/curves/projective_curve.py\", line 1329, in sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model\nFailed example:\n    C.ordinary_model() # long time (5 seconds)\nException raised:\n    Traceback (most recent call last):\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model[13]>\", line 1, in <module>\n        C.ordinary_model() # long time (5 seconds)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/curves/projective_curve.py\", line 1393, in ordinary_model\n        emb = extension(C.singular_subscheme())\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/curves/projective_curve.py\", line 1373, in extension\n        pts = self.change_ring(F.embeddings(QQbar)[0]).rational_points()\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py\", line 1846, in change_ring\n        I = [f.change_ring(R) for f in self.defining_polynomials()]\n      File \"sage/rings/polynomial/multi_polynomial.pyx\", line 873, in sage.rings.polynomial.multi_polynomial.MPolynomial.change_ring (build/cythonized/sage/rings/polynomial/multi_polynomial.c:13133)\n        return self.parent().change_ring(R)(self)\n      File \"sage/rings/polynomial/multi_polynomial_ring_generic.pyx\", line 985, in sage.rings.polynomial.multi_polynomial_ring_generic.MPolynomialRing_generic.change_ring (build/cythonized/sage/rings/polynomial/multi_polynomial_ring_generic.c:15237)\n        return PolynomialRing(base_ring, self.ngens(), names, order=order)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py\", line 438, in PolynomialRing\n        raise TypeError('base_ring must be a ring')\n    TypeError: base_ring must be a ring\n**********************************************************************\n1 item had failures:\n   3 of  15 in sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model\n    [328 tests, 3 failures, 65.69 s]\n\n...\n\n----------------------------------------------------------------------\nsage -t --long src/sage/schemes/curves/projective_curve.py  # 3 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 1958.8 seconds\n    cpu time: 6272.7 seconds\n    cumulative wall time: 15257.4 seconds\n```\n\nI also ran the same tests on the latest develop build (`74b03027bc`) and they passed, so it seems like there is still something to fix here. \n\nSince I think someone with fresh eyes should take a look at this ticket the next time it comes up for review, I am taking my name out of the reviewer field.",
    "created_at": "2017-07-21T21:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320934",
    "user": "https://trac.sagemath.org/admin/accounts/users/cmt"
}
```

<a id='comment:18'></a>Okay, something in my configuration had gotten messed up, so I started over entirely. I just pulled the latest version of this branch (`5f99cf980c`), which has the content of #23204 already merged in, merged in the latest develop branch (`74b03027bc`), and rebuilt. I then ran the following limited set of doctests and got these results:

```bash
bash-3.2$ ./sage -tp 8 --long src/sage/structure/ src/sage/categories/ src/sage/rings/ src/sage/modular/ src/sage/schemes/

too few successful tests, not using stored timings
Running doctests with ID 2017-07-21-16-33-34-b8fb451a.
Git branch: t/23203/a_polynomial_ring_contains_its_basering
Using --optional=ccache,mpir,python2,sage
Sorting sources by runtime so that slower doctests are run first....
Doctesting 883 files using 8 threads.

...

sage -t --long src/sage/schemes/curves/projective_curve.py
**********************************************************************
File "src/sage/schemes/curves/projective_curve.py", line 1304, in sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model
Failed example:
    D = C.ordinary_model(); D # long time (2 seconds)
Exception raised:
    Traceback (most recent call last):
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model[8]>", line 1, in <module>
        D = C.ordinary_model(); D # long time (2 seconds)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/curves/projective_curve.py", line 1393, in ordinary_model
        emb = extension(C.singular_subscheme())
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/curves/projective_curve.py", line 1373, in extension
        pts = self.change_ring(F.embeddings(QQbar)[0]).rational_points()
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py", line 1846, in change_ring
        I = [f.change_ring(R) for f in self.defining_polynomials()]
      File "sage/rings/polynomial/multi_polynomial.pyx", line 873, in sage.rings.polynomial.multi_polynomial.MPolynomial.change_ring (build/cythonized/sage/rings/polynomial/multi_polynomial.c:13133)
        return self.parent().change_ring(R)(self)
      File "sage/rings/polynomial/multi_polynomial_ring_generic.pyx", line 985, in sage.rings.polynomial.multi_polynomial_ring_generic.MPolynomialRing_generic.change_ring (build/cythonized/sage/rings/polynomial/multi_polynomial_ring_generic.c:15237)
        return PolynomialRing(base_ring, self.ngens(), names, order=order)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 438, in PolynomialRing
        raise TypeError('base_ring must be a ring')
    TypeError: base_ring must be a ring
**********************************************************************
File "src/sage/schemes/curves/projective_curve.py", line 1321, in sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model
Failed example:
    all([D.codomain().is_ordinary_singularity(Q) for Q in D.codomain().singular_points()]) # long time
Exception raised:
    Traceback (most recent call last):
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model[9]>", line 1, in <module>
        all([D.codomain().is_ordinary_singularity(Q) for Q in D.codomain().singular_points()]) # long time
    NameError: name 'D' is not defined
**********************************************************************
File "src/sage/schemes/curves/projective_curve.py", line 1329, in sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model
Failed example:
    C.ordinary_model() # long time (5 seconds)
Exception raised:
    Traceback (most recent call last):
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model[13]>", line 1, in <module>
        C.ordinary_model() # long time (5 seconds)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/curves/projective_curve.py", line 1393, in ordinary_model
        emb = extension(C.singular_subscheme())
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/curves/projective_curve.py", line 1373, in extension
        pts = self.change_ring(F.embeddings(QQbar)[0]).rational_points()
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/schemes/generic/algebraic_scheme.py", line 1846, in change_ring
        I = [f.change_ring(R) for f in self.defining_polynomials()]
      File "sage/rings/polynomial/multi_polynomial.pyx", line 873, in sage.rings.polynomial.multi_polynomial.MPolynomial.change_ring (build/cythonized/sage/rings/polynomial/multi_polynomial.c:13133)
        return self.parent().change_ring(R)(self)
      File "sage/rings/polynomial/multi_polynomial_ring_generic.pyx", line 985, in sage.rings.polynomial.multi_polynomial_ring_generic.MPolynomialRing_generic.change_ring (build/cythonized/sage/rings/polynomial/multi_polynomial_ring_generic.c:15237)
        return PolynomialRing(base_ring, self.ngens(), names, order=order)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/rings/polynomial/polynomial_ring_constructor.py", line 438, in PolynomialRing
        raise TypeError('base_ring must be a ring')
    TypeError: base_ring must be a ring
**********************************************************************
1 item had failures:
   3 of  15 in sage.schemes.curves.projective_curve.ProjectivePlaneCurve.ordinary_model
    [328 tests, 3 failures, 65.69 s]

...

----------------------------------------------------------------------
sage -t --long src/sage/schemes/curves/projective_curve.py  # 3 doctests failed
----------------------------------------------------------------------
Total time for all tests: 1958.8 seconds
    cpu time: 6272.7 seconds
    cumulative wall time: 15257.4 seconds
```

I also ran the same tests on the latest develop build (`74b03027bc`) and they passed, so it seems like there is still something to fix here. 

Since I think someone with fresh eyes should take a look at this ticket the next time it comes up for review, I am taking my name out of the reviewer field.



---

archive/issue_comments_320935.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-21T22:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320935",
    "user": "https://trac.sagemath.org/admin/accounts/users/cmt"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_320936.json:
```json
{
    "body": "<a id='comment:20'></a>cmt: Thanks for pointing this out. This is a problem in #23204. I'll fix it there.",
    "created_at": "2017-07-21T22:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320936",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:20'></a>cmt: Thanks for pointing this out. This is a problem in #23204. I'll fix it there.



---

archive/issue_comments_320937.json:
```json
{
    "body": "<a id='comment:21'></a>Fixed in #23204.",
    "created_at": "2017-07-21T22:42:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320937",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:21'></a>Fixed in #23204.



---

archive/issue_comments_320938.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-22T02:17:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320938",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_320939.json:
```json
{
    "body": "<a id='comment:23'></a>Claire: We usually do not remove people from the Reviewers field, i.e., it is just a list of everybody that had a look at the ticket.",
    "created_at": "2017-07-22T02:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320939",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:23'></a>Claire: We usually do not remove people from the Reviewers field, i.e., it is just a list of everybody that had a look at the ticket.



---

archive/issue_comments_320940.json:
```json
{
    "body": "<a id='comment:24'></a>Julian: Thanks, and my apologies! I didn't realize that was the convention.",
    "created_at": "2017-07-22T14:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320940",
    "user": "https://trac.sagemath.org/admin/accounts/users/cmt"
}
```

<a id='comment:24'></a>Julian: Thanks, and my apologies! I didn't realize that was the convention.



---

archive/issue_comments_320941.json:
```json
{
    "body": "<a id='comment:25'></a>I just merged the latest version of #23204 (`382e2d1807`) into the latest version of this ticket (`5f99cf980c`), rebuilt, and reran the same limited set of tests (`./sage -tp 8 --long src/sage/structure/ src/sage/categories/ src/sage/rings/ src/sage/modular/ src/sage/schemes/`) which all passed!\n\nI am now running all doctests.",
    "created_at": "2017-07-22T16:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320941",
    "user": "https://trac.sagemath.org/admin/accounts/users/cmt"
}
```

<a id='comment:25'></a>I just merged the latest version of #23204 (`382e2d1807`) into the latest version of this ticket (`5f99cf980c`), rebuilt, and reran the same limited set of tests (`./sage -tp 8 --long src/sage/structure/ src/sage/categories/ src/sage/rings/ src/sage/modular/ src/sage/schemes/`) which all passed!

I am now running all doctests.



---

archive/issue_comments_320942.json:
```json
{
    "body": "<a id='comment:26'></a>I just ran all tests in `src/sage` and produced only the following weird failed tests:\n\n```bash\n$ ./sage -tp 8 --long src/sage/\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2017-07-22-12-22-47-8f9951fd.\nGit branch: t/23203/a_polynomial_ring_contains_its_basering\nUsing --optional=ccache,mpir,python2,sage\nSorting sources by runtime so that slower doctests are run first....\nDoctesting 2969 files using 8 threads.\n\n...\n\nsage -t --long src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 814, in sage.tests.cmdline.test_executable\nFailed example:\n    test_executable([\"sage\", \"--rst2sws\", input, output])\nExpected:\n    ('', '', 0)\nGot:\n    ('',\n     'Traceback (most recent call last):\\n  File \"/Sage/sage/src/bin/sage-rst2sws\", line 131, in <module>\\n    from sagenb.notebook.notebook import Notebook\\n  File \"/Sage/sage/local/lib/python2.7/site-packages/sagenb/notebook/notebook.py\", line 46, in <module>\\n    from . import js           # javascript\\n  File \"/Sage/sage/local/lib/python2.7/site-packages/sagenb/notebook/js.py\", line 34, in <module>\\n    from .compress.JavaScriptCompressor import JavaScriptCompressor\\nImportError: No module named JavaScriptCompressor\\n',\n     1)\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 817, in sage.tests.cmdline.test_executable\nFailed example:\n    f = tarfile.open(output, 'r')\nException raised:\n    Traceback (most recent call last):\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.cmdline.test_executable[242]>\", line 1, in <module>\n        f = tarfile.open(output, 'r')\n      File \"/Sage/sage/local/lib/python2.7/tarfile.py\", line 1680, in open\n        raise ReadError(\"file could not be opened successfully\")\n    ReadError: file could not be opened successfully\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 818, in sage.tests.cmdline.test_executable\nFailed example:\n    print(f.extractfile('sage_worksheet/worksheet.html').read())\nException raised:\n    Traceback (most recent call last):\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.cmdline.test_executable[243]>\", line 1, in <module>\n        print(f.extractfile('sage_worksheet/worksheet.html').read())\n    AttributeError: 'file' object has no attribute 'extractfile'\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 832, in sage.tests.cmdline.test_executable\nFailed example:\n    print(f.extractfile('sage_worksheet/worksheet.txt').read())\nException raised:\n    Traceback (most recent call last):\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.tests.cmdline.test_executable[244]>\", line 1, in <module>\n        print(f.extractfile('sage_worksheet/worksheet.txt').read())\n    AttributeError: 'file' object has no attribute 'extractfile'\n**********************************************************************\n1 item had failures:\n   4 of 246 in sage.tests.cmdline.test_executable\n    [245 tests, 4 failures, 155.43 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/tests/cmdline.py  # 4 doctests failed\n----------------------------------------------------------------------\n```\n\nHowever! When I run these same doctests on my latest build of the develop branch (`74b03027bc`), the exact same tests also fail. \n\nTherefore, I'm going to positively review this ticket -- if others think this is a problem they are welcome to revert the status as they see fit.",
    "created_at": "2017-07-22T18:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320942",
    "user": "https://trac.sagemath.org/admin/accounts/users/cmt"
}
```

<a id='comment:26'></a>I just ran all tests in `src/sage` and produced only the following weird failed tests:

```bash
$ ./sage -tp 8 --long src/sage/
too few successful tests, not using stored timings
Running doctests with ID 2017-07-22-12-22-47-8f9951fd.
Git branch: t/23203/a_polynomial_ring_contains_its_basering
Using --optional=ccache,mpir,python2,sage
Sorting sources by runtime so that slower doctests are run first....
Doctesting 2969 files using 8 threads.

...

sage -t --long src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 814, in sage.tests.cmdline.test_executable
Failed example:
    test_executable(["sage", "--rst2sws", input, output])
Expected:
    ('', '', 0)
Got:
    ('',
     'Traceback (most recent call last):\n  File "/Sage/sage/src/bin/sage-rst2sws", line 131, in <module>\n    from sagenb.notebook.notebook import Notebook\n  File "/Sage/sage/local/lib/python2.7/site-packages/sagenb/notebook/notebook.py", line 46, in <module>\n    from . import js           # javascript\n  File "/Sage/sage/local/lib/python2.7/site-packages/sagenb/notebook/js.py", line 34, in <module>\n    from .compress.JavaScriptCompressor import JavaScriptCompressor\nImportError: No module named JavaScriptCompressor\n',
     1)
**********************************************************************
File "src/sage/tests/cmdline.py", line 817, in sage.tests.cmdline.test_executable
Failed example:
    f = tarfile.open(output, 'r')
Exception raised:
    Traceback (most recent call last):
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.cmdline.test_executable[242]>", line 1, in <module>
        f = tarfile.open(output, 'r')
      File "/Sage/sage/local/lib/python2.7/tarfile.py", line 1680, in open
        raise ReadError("file could not be opened successfully")
    ReadError: file could not be opened successfully
**********************************************************************
File "src/sage/tests/cmdline.py", line 818, in sage.tests.cmdline.test_executable
Failed example:
    print(f.extractfile('sage_worksheet/worksheet.html').read())
Exception raised:
    Traceback (most recent call last):
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.cmdline.test_executable[243]>", line 1, in <module>
        print(f.extractfile('sage_worksheet/worksheet.html').read())
    AttributeError: 'file' object has no attribute 'extractfile'
**********************************************************************
File "src/sage/tests/cmdline.py", line 832, in sage.tests.cmdline.test_executable
Failed example:
    print(f.extractfile('sage_worksheet/worksheet.txt').read())
Exception raised:
    Traceback (most recent call last):
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.cmdline.test_executable[244]>", line 1, in <module>
        print(f.extractfile('sage_worksheet/worksheet.txt').read())
    AttributeError: 'file' object has no attribute 'extractfile'
**********************************************************************
1 item had failures:
   4 of 246 in sage.tests.cmdline.test_executable
    [245 tests, 4 failures, 155.43 s]
----------------------------------------------------------------------
sage -t --long src/sage/tests/cmdline.py  # 4 doctests failed
----------------------------------------------------------------------
```

However! When I run these same doctests on my latest build of the develop branch (`74b03027bc`), the exact same tests also fail. 

Therefore, I'm going to positively review this ticket -- if others think this is a problem they are welcome to revert the status as they see fit.



---

archive/issue_comments_320943.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-22T18:17:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320943",
    "user": "https://trac.sagemath.org/admin/accounts/users/cmt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_059886.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-03T22:11:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23203#event-59886"
}
```



---

archive/issue_comments_320944.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-03T22:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23203",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23203#issuecomment-320944",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
