# Issue 23344: p-adic square root

archive/issues_023107.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nThis ticket implements square root over p-adic fields (i.e. finite extension of Qp)\n\nCC:  @roed314 @xcaruso\n\nComponent: **padics**\n\nAuthor: **Xavier Caruso**\n\nBranch/Commit: **[`3085538`](https://github.com/sagemath/sagetrac-mirror/commit/30855382d325dabb77a7fb1033fa44ba58fbc2f1)**\n\nReviewer: **David Lubicz**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23344_\n\n",
    "closed_at": "2018-05-08T17:27:19Z",
    "created_at": "2017-06-30T12:48:57Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20padics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "p-adic square root",
    "type": "issue",
    "updated_at": "2018-05-08T17:27:19Z",
    "url": "https://github.com/sagemath/sage/issues/23344",
    "user": "https://github.com/dlubicz"
}
```
<div id="comment:0"></div>

This ticket implements square root over p-adic fields (i.e. finite extension of Qp)

CC:  @roed314 @xcaruso

Component: **padics**

Author: **Xavier Caruso**

Branch/Commit: **[`3085538`](https://github.com/sagemath/sagetrac-mirror/commit/30855382d325dabb77a7fb1033fa44ba58fbc2f1)**

Reviewer: **David Lubicz**

_Issue created by migration from https://trac.sagemath.org/ticket/23344_





---

archive/issue_events_322199.json:
```json
{
    "actor": "https://github.com/dlubicz",
    "created_at": "2017-06-30T12:48:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322199"
}
```



---

archive/issue_events_322200.json:
```json
{
    "actor": "https://github.com/dlubicz",
    "created_at": "2017-06-30T12:48:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20padics",
    "label_color": "0000ff",
    "label_name": "c: padics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322200"
}
```



---

archive/issue_events_322201.json:
```json
{
    "actor": "https://github.com/dlubicz",
    "created_at": "2017-06-30T12:48:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322201"
}
```



---

archive/issue_events_322202.json:
```json
{
    "actor": "https://github.com/dlubicz",
    "created_at": "2017-06-30T12:48:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322202"
}
```



---

archive/issue_comments_350430.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nDoesn't this already work? This field `L` is an example from the docstring for `Qp.extension`.\n\n```\nsage: F = list(Qp(19)['x'](cyclotomic_polynomial(5)).factor())[0][0]\nsage: L = Qp(19).extension(F, names='a')\nsage: L\nUnramified Extension of 19-adic Field with capped relative precision 20 in a defined by (1 + O(19^20))*x^2 + (5 + 2*19 + 10*19^2 + 14*19^3 + 7*19^4 + 13*19^5 + 5*19^6 + 12*19^7 + 8*19^8 + 4*19^9 + 14*19^10 + 6*19^11 + 5*19^12 + 13*19^13 + 16*19^14 + 4*19^15 + 17*19^16 + 8*19^18 + 4*19^19 + O(19^20))*x + (1 + O(19^20))\nsage: u = L(4+19).sqrt(); u\n2 + 5*19 + 3*19^2 + 11*19^3 + 12*19^4 + 13*19^5 + 11*19^6 + 15*19^7 + 12*19^8 + 18*19^9 + 15*19^10 + 2*19^11 + 9*19^12 + 4*19^13 + 19^15 + 19^16 + 13*19^18 + 3*19^19 + O(19^20)\nsage: u^2\n4 + 19 + O(19^20)\n```\nThe syntax `sqrt(L(4+19))` also works.",
    "created_at": "2017-08-24T21:25:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350430",
    "user": "https://github.com/kedlaya"
}
```

<div id="comment:1" align="right">comment:1</div>

Doesn't this already work? This field `L` is an example from the docstring for `Qp.extension`.

```
sage: F = list(Qp(19)['x'](cyclotomic_polynomial(5)).factor())[0][0]
sage: L = Qp(19).extension(F, names='a')
sage: L
Unramified Extension of 19-adic Field with capped relative precision 20 in a defined by (1 + O(19^20))*x^2 + (5 + 2*19 + 10*19^2 + 14*19^3 + 7*19^4 + 13*19^5 + 5*19^6 + 12*19^7 + 8*19^8 + 4*19^9 + 14*19^10 + 6*19^11 + 5*19^12 + 13*19^13 + 16*19^14 + 4*19^15 + 17*19^16 + 8*19^18 + 4*19^19 + O(19^20))*x + (1 + O(19^20))
sage: u = L(4+19).sqrt(); u
2 + 5*19 + 3*19^2 + 11*19^3 + 12*19^4 + 13*19^5 + 11*19^6 + 15*19^7 + 12*19^8 + 18*19^9 + 15*19^10 + 2*19^11 + 9*19^12 + 4*19^13 + 19^15 + 19^16 + 13*19^18 + 3*19^19 + O(19^20)
sage: u^2
4 + 19 + O(19^20)
```
The syntax `sqrt(L(4+19))` also works.



---

archive/issue_comments_350431.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nIf I am not mistaken, with the version of sage I am working with (8.0.rc0), the square root is working fine for elements of Qp (even if Qp is embeded in an extension) but not for elements of an extension of Qp (not in Q_p). Continuing your example :\n\n```\nsage: a=L.gen()\nsage: sqrt(4+19*a)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-5-842761a28969> in <module>()\n----> 1 sqrt(Integer(4)+Integer(19)*a)\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in sqrt(x, *args, **kwds)\n   2002         except (AttributeError, TypeError):\n   2003             pass\n-> 2004         return _do_sqrt(x, *args, **kwds)\n   2005 \n   2006 # register sqrt in pynac symbol_table for conversion back from other systems\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in _do_sqrt(x, prec, extend, all)\n   1903             z = I\n   1904         else:\n-> 1905             z = SR(x) ** one_half\n   1906 \n   1907         if all:\n\n/home/lubicz/sagemath/sage/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/symbolic/expression.cpp:25800)()\n   3882                            relational_operator(base._gobj))\n   3883         else:\n-> 3884             x = g_pow(base._gobj, nexp._gobj)\n   3885         return new_Expression_from_GEx(base._parent, x)\n   3886 \n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/CR_template.pxi in sage.rings.padics.qadic_flint_CR.CRElement.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:20012)()\n    672         elif exact_exp:\n    673             # exact_pow_helper is defined in padic_template_element.pxi\n--> 674             right = exact_pow_helper(&ans.relprec, self.relprec, _right, self.prime_pow)\n    675             if ans.relprec > self.prime_pow.ram_prec_cap:\n    676                 ans.relprec = self.prime_pow.ram_prec_cap\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/padic_template_element.pxi in sage.rings.padics.qadic_flint_CR.exact_pow_helper (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:15216)()\n    545         exp_val = mpz_get_si((<Integer>right.valuation(p)).value)\n    546     elif isinstance(_right, Rational):\n--> 547         raise NotImplementedError\n    548     ansrelprec[0] = relprec + exp_val\n    549     if exp_val > 0 and mpz_cmp_ui(p.value, 2) == 0 and relprec == 1:\n\nNotImplementedError: \n```\n\nAnother example which motivates my tickets since I am implementing in sagemath an improved version of the AGM algorithm :\n\n```\nsage: R.<x>=Zq(2^10, 20)\nsage: sqrt(1+8*x)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-10-25d75e2ffffe> in <module>()\n----> 1 sqrt(Integer(1)+Integer(8)*x)\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in sqrt(x, *args, **kwds)\n   2002         except (AttributeError, TypeError):\n   2003             pass\n-> 2004         return _do_sqrt(x, *args, **kwds)\n   2005 \n   2006 # register sqrt in pynac symbol_table for conversion back from other systems\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in _do_sqrt(x, prec, extend, all)\n   1903             z = I\n   1904         else:\n-> 1905             z = SR(x) ** one_half\n   1906 \n   1907         if all:\n\n/home/lubicz/sagemath/sage/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/symbolic/expression.cpp:25800)()\n   3882                            relational_operator(base._gobj))\n   3883         else:\n-> 3884             x = g_pow(base._gobj, nexp._gobj)\n   3885         return new_Expression_from_GEx(base._parent, x)\n   3886 \n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/CR_template.pxi in sage.rings.padics.qadic_flint_CR.CRElement.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:20012)()\n    672         elif exact_exp:\n    673             # exact_pow_helper is defined in padic_template_element.pxi\n--> 674             right = exact_pow_helper(&ans.relprec, self.relprec, _right, self.prime_pow)\n    675             if ans.relprec > self.prime_pow.ram_prec_cap:\n    676                 ans.relprec = self.prime_pow.ram_prec_cap\n\n/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/padic_template_element.pxi in sage.rings.padics.qadic_flint_CR.exact_pow_helper (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:15216)()\n    545         exp_val = mpz_get_si((<Integer>right.valuation(p)).value)\n    546     elif isinstance(_right, Rational):\n--> 547         raise NotImplementedError\n    548     ansrelprec[0] = relprec + exp_val\n    549     if exp_val > 0 and mpz_cmp_ui(p.value, 2) == 0 and relprec == 1:\n\nNotImplementedError: \n```",
    "created_at": "2017-08-28T07:06:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350431",
    "user": "https://github.com/dlubicz"
}
```

<div id="comment:2" align="right">comment:2</div>

If I am not mistaken, with the version of sage I am working with (8.0.rc0), the square root is working fine for elements of Qp (even if Qp is embeded in an extension) but not for elements of an extension of Qp (not in Q_p). Continuing your example :

```
sage: a=L.gen()
sage: sqrt(4+19*a)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-5-842761a28969> in <module>()
----> 1 sqrt(Integer(4)+Integer(19)*a)

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in sqrt(x, *args, **kwds)
   2002         except (AttributeError, TypeError):
   2003             pass
-> 2004         return _do_sqrt(x, *args, **kwds)
   2005 
   2006 # register sqrt in pynac symbol_table for conversion back from other systems

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in _do_sqrt(x, prec, extend, all)
   1903             z = I
   1904         else:
-> 1905             z = SR(x) ** one_half
   1906 
   1907         if all:

/home/lubicz/sagemath/sage/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/symbolic/expression.cpp:25800)()
   3882                            relational_operator(base._gobj))
   3883         else:
-> 3884             x = g_pow(base._gobj, nexp._gobj)
   3885         return new_Expression_from_GEx(base._parent, x)
   3886 

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/CR_template.pxi in sage.rings.padics.qadic_flint_CR.CRElement.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:20012)()
    672         elif exact_exp:
    673             # exact_pow_helper is defined in padic_template_element.pxi
--> 674             right = exact_pow_helper(&ans.relprec, self.relprec, _right, self.prime_pow)
    675             if ans.relprec > self.prime_pow.ram_prec_cap:
    676                 ans.relprec = self.prime_pow.ram_prec_cap

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/padic_template_element.pxi in sage.rings.padics.qadic_flint_CR.exact_pow_helper (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:15216)()
    545         exp_val = mpz_get_si((<Integer>right.valuation(p)).value)
    546     elif isinstance(_right, Rational):
--> 547         raise NotImplementedError
    548     ansrelprec[0] = relprec + exp_val
    549     if exp_val > 0 and mpz_cmp_ui(p.value, 2) == 0 and relprec == 1:

NotImplementedError: 
```

Another example which motivates my tickets since I am implementing in sagemath an improved version of the AGM algorithm :

```
sage: R.<x>=Zq(2^10, 20)
sage: sqrt(1+8*x)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-10-25d75e2ffffe> in <module>()
----> 1 sqrt(Integer(1)+Integer(8)*x)

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in sqrt(x, *args, **kwds)
   2002         except (AttributeError, TypeError):
   2003             pass
-> 2004         return _do_sqrt(x, *args, **kwds)
   2005 
   2006 # register sqrt in pynac symbol_table for conversion back from other systems

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/functions/other.pyc in _do_sqrt(x, prec, extend, all)
   1903             z = I
   1904         else:
-> 1905             z = SR(x) ** one_half
   1906 
   1907         if all:

/home/lubicz/sagemath/sage/src/sage/symbolic/expression.pyx in sage.symbolic.expression.Expression.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/symbolic/expression.cpp:25800)()
   3882                            relational_operator(base._gobj))
   3883         else:
-> 3884             x = g_pow(base._gobj, nexp._gobj)
   3885         return new_Expression_from_GEx(base._parent, x)
   3886 

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/CR_template.pxi in sage.rings.padics.qadic_flint_CR.CRElement.__pow__ (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:20012)()
    672         elif exact_exp:
    673             # exact_pow_helper is defined in padic_template_element.pxi
--> 674             right = exact_pow_helper(&ans.relprec, self.relprec, _right, self.prime_pow)
    675             if ans.relprec > self.prime_pow.ram_prec_cap:
    676                 ans.relprec = self.prime_pow.ram_prec_cap

/home/lubicz/sagemath/sage/local/lib/python2.7/site-packages/sage/rings/padics/padic_template_element.pxi in sage.rings.padics.qadic_flint_CR.exact_pow_helper (/home/lubicz/sagemath/sage/src/build/cythonized/sage/rings/padics/qadic_flint_CR.c:15216)()
    545         exp_val = mpz_get_si((<Integer>right.valuation(p)).value)
    546     elif isinstance(_right, Rational):
--> 547         raise NotImplementedError
    548     ansrelprec[0] = relprec + exp_val
    549     if exp_val > 0 and mpz_cmp_ui(p.value, 2) == 0 and relprec == 1:

NotImplementedError: 
```



---

archive/issue_comments_350432.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@dlubicz](#comment%3A2):\n> If I am not mistaken, with the version of sage I am working with (8.0.rc0), the square root is working fine for elements of Qp (even if Qp is embeded in an extension) but not for elements of an extension of Qp (not in Q_p). \n\nI agree.  The current implementation just calls off to Pari (see line 2774 in `padic_generic_element.pyx`).  It would be good if we could have a native implementation that worked for general extensions (not just unramified ones).",
    "created_at": "2017-08-28T08:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350432",
    "user": "https://github.com/roed314"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@dlubicz](#comment%3A2):
> If I am not mistaken, with the version of sage I am working with (8.0.rc0), the square root is working fine for elements of Qp (even if Qp is embeded in an extension) but not for elements of an extension of Qp (not in Q_p). 

I agree.  The current implementation just calls off to Pari (see line 2774 in `padic_generic_element.pyx`).  It would be good if we could have a native implementation that worked for general extensions (not just unramified ones).



---

archive/issue_comments_350433.json:
```json
{
    "body": "Branch: **[u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields)**",
    "created_at": "2018-03-01T15:25:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350433",
    "user": "https://github.com/dlubicz"
}
```

Branch: **[u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields)**



---

archive/issue_comments_350434.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e64d891c19b4b5bb1b2b8d666f16f02ad405c67e\"><code>e64d891</code></a></td><td><code>added square for unramified 2-adic fields</code></td></tr></table>\n",
    "created_at": "2018-03-01T15:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350434",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e64d891c19b4b5bb1b2b8d666f16f02ad405c67e"><code>e64d891</code></a></td><td><code>added square for unramified 2-adic fields</code></td></tr></table>




---

archive/issue_comments_350435.json:
```json
{
    "body": "Commit: **[`e64d891`](https://github.com/sagemath/sagetrac-mirror/commit/e64d891c19b4b5bb1b2b8d666f16f02ad405c67e)**",
    "created_at": "2018-03-01T15:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350435",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`e64d891`](https://github.com/sagemath/sagetrac-mirror/commit/e64d891c19b4b5bb1b2b8d666f16f02ad405c67e)**



---

archive/issue_comments_350436.json:
```json
{
    "body": "Changed branch from **[u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields)** to **[u/roed/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ramified_extensions_of_general_p_adic_rings_and_fields)**",
    "created_at": "2018-03-01T15:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350436",
    "user": "https://github.com/roed314"
}
```

Changed branch from **[u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields)** to **[u/roed/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ramified_extensions_of_general_p_adic_rings_and_fields)**



---

archive/issue_comments_350437.json:
```json
{
    "body": "Changed commit from **[`e64d891`](https://github.com/sagemath/sagetrac-mirror/commit/e64d891c19b4b5bb1b2b8d666f16f02ad405c67e)** to **[`e3a1c86`](https://github.com/sagemath/sagetrac-mirror/commit/e3a1c866f8fa3bc534e3434ab2ca066d470b5d5d)**",
    "created_at": "2018-03-01T15:46:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350437",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e64d891`](https://github.com/sagemath/sagetrac-mirror/commit/e64d891c19b4b5bb1b2b8d666f16f02ad405c67e)** to **[`e3a1c86`](https://github.com/sagemath/sagetrac-mirror/commit/e3a1c866f8fa3bc534e3434ab2ca066d470b5d5d)**



---

archive/issue_comments_350438.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ce61f647325dd0cd2b9f56e73cd6c9c0f25855f2\"><code>ce61f64</code></a></td><td><code>Improve base ring injections for relative extensions of p-adic fields</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16477d36802ae669a86758ccbbbb7c24d97ec354\"><code>16477d3</code></a></td><td><code>Make conversion from residue field work for two-step extensions of p-adics</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c7cc7131c9b5d5843cb0fd74a47944658586efb\"><code>1c7cc71</code></a></td><td><code>Fix typo in section method for base ring injection in p-adic two-step extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8be1504ea508f635759701240dc4dc911546e29d\"><code>8be1504</code></a></td><td><code>Fix bugs in creduce and ccoefficients for two-step p-adic extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d53df12cab4bc24bb9ed12d31466ecddf2a3dab7\"><code>d53df12</code></a></td><td><code>Add coerce_list back in to the `_populate_coercion_lists_` call in pAdicExtensionGeneric.__init__</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e68beeecf94f4dac71ac50f6e05bee5bd85280ff\"><code>e68beee</code></a></td><td><code>Fix some p-adic doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/635021af851aac33b40cba44301e5339337023cd\"><code>635021a</code></a></td><td><code>Change _poly_rep to always return the polynomial representing the element, not the unit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/67c1f149e0ea8d9a758a7396d25ec6eff7b23200\"><code>67c1f14</code></a></td><td><code>Change the internal base ring for two-step extensions to not show precision when printing, fix bug in base ring coercion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8939981e4b02ac12b86f943d93a8baef25e9af51\"><code>8939981</code></a></td><td><code>Fix problems in expansion code</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e3a1c866f8fa3bc534e3434ab2ca066d470b5d5d\"><code>e3a1c86</code></a></td><td><code>Merge commit '8939981e4b02ac12b86f943d93a8baef25e9af51' of git://trac.sagemath.org/sage into t/23218/general_extensions</code></td></tr></table>\n",
    "created_at": "2018-03-01T15:46:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350438",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ce61f647325dd0cd2b9f56e73cd6c9c0f25855f2"><code>ce61f64</code></a></td><td><code>Improve base ring injections for relative extensions of p-adic fields</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16477d36802ae669a86758ccbbbb7c24d97ec354"><code>16477d3</code></a></td><td><code>Make conversion from residue field work for two-step extensions of p-adics</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c7cc7131c9b5d5843cb0fd74a47944658586efb"><code>1c7cc71</code></a></td><td><code>Fix typo in section method for base ring injection in p-adic two-step extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8be1504ea508f635759701240dc4dc911546e29d"><code>8be1504</code></a></td><td><code>Fix bugs in creduce and ccoefficients for two-step p-adic extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d53df12cab4bc24bb9ed12d31466ecddf2a3dab7"><code>d53df12</code></a></td><td><code>Add coerce_list back in to the `_populate_coercion_lists_` call in pAdicExtensionGeneric.__init__</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e68beeecf94f4dac71ac50f6e05bee5bd85280ff"><code>e68beee</code></a></td><td><code>Fix some p-adic doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/635021af851aac33b40cba44301e5339337023cd"><code>635021a</code></a></td><td><code>Change _poly_rep to always return the polynomial representing the element, not the unit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/67c1f149e0ea8d9a758a7396d25ec6eff7b23200"><code>67c1f14</code></a></td><td><code>Change the internal base ring for two-step extensions to not show precision when printing, fix bug in base ring coercion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8939981e4b02ac12b86f943d93a8baef25e9af51"><code>8939981</code></a></td><td><code>Fix problems in expansion code</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e3a1c866f8fa3bc534e3434ab2ca066d470b5d5d"><code>e3a1c86</code></a></td><td><code>Merge commit '8939981e4b02ac12b86f943d93a8baef25e9af51' of git://trac.sagemath.org/sage into t/23218/general_extensions</code></td></tr></table>




---

archive/issue_comments_350439.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e64d891c19b4b5bb1b2b8d666f16f02ad405c67e\"><code>e64d891</code></a></td><td><code>added square for unramified 2-adic fields</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65f28536ad731c289db6a150a200d179c4f80647\"><code>65f2853</code></a></td><td><code>Merge commit 'e64d891c19b4b5bb1b2b8d666f16f02ad405c67e' of git://trac.sagemath.org/sage into t/23344/sqrt_2</code></td></tr></table>\n",
    "created_at": "2018-03-01T15:52:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350439",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e64d891c19b4b5bb1b2b8d666f16f02ad405c67e"><code>e64d891</code></a></td><td><code>added square for unramified 2-adic fields</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65f28536ad731c289db6a150a200d179c4f80647"><code>65f2853</code></a></td><td><code>Merge commit 'e64d891c19b4b5bb1b2b8d666f16f02ad405c67e' of git://trac.sagemath.org/sage into t/23344/sqrt_2</code></td></tr></table>




---

archive/issue_comments_350440.json:
```json
{
    "body": "Changed commit from **[`e3a1c86`](https://github.com/sagemath/sagetrac-mirror/commit/e3a1c866f8fa3bc534e3434ab2ca066d470b5d5d)** to **[`65f2853`](https://github.com/sagemath/sagetrac-mirror/commit/65f28536ad731c289db6a150a200d179c4f80647)**",
    "created_at": "2018-03-01T15:52:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350440",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e3a1c86`](https://github.com/sagemath/sagetrac-mirror/commit/e3a1c866f8fa3bc534e3434ab2ca066d470b5d5d)** to **[`65f2853`](https://github.com/sagemath/sagetrac-mirror/commit/65f28536ad731c289db6a150a200d179c4f80647)**



---

archive/issue_comments_350441.json:
```json
{
    "body": "Changed branch from **[u/roed/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ramified_extensions_of_general_p_adic_rings_and_fields)** to **[u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields)**",
    "created_at": "2018-03-01T15:57:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350441",
    "user": "https://github.com/dlubicz"
}
```

Changed branch from **[u/roed/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ramified_extensions_of_general_p_adic_rings_and_fields)** to **[u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields)**



---

archive/issue_comments_350442.json:
```json
{
    "body": "Changed branch from **[u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields)** to **[u/roed/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ramified_extensions_of_general_p_adic_rings_and_fields)**",
    "created_at": "2018-03-01T15:58:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350442",
    "user": "https://github.com/roed314"
}
```

Changed branch from **[u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/ramified_extensions_of_general_p_adic_rings_and_fields)** to **[u/roed/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ramified_extensions_of_general_p_adic_rings_and_fields)**



---

archive/issue_comments_350443.json:
```json
{
    "body": "Changed branch from **[u/roed/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ramified_extensions_of_general_p_adic_rings_and_fields)** to **[u/roed/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/23344/2adic_sqrt)**",
    "created_at": "2018-03-01T16:01:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350443",
    "user": "https://github.com/roed314"
}
```

Changed branch from **[u/roed/ramified_extensions_of_general_p_adic_rings_and_fields](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/ramified_extensions_of_general_p_adic_rings_and_fields)** to **[u/roed/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/23344/2adic_sqrt)**



---

archive/issue_comments_350444.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSeveral comments:\n\n- you don't need your function `_artin_schreier` since Sage has already methods (e.g. `roots`) for solving algebraic equations in finite fields\n\n- in the `square_root` method, `prec` shouldn't be the precision cap of the parent but the actual precision of the element, no?\n\n- in the `square_root` method, use the `sqrt` method for computing the square root modulo p (by the way, I don't understand why this part is needed)\n\n- `ceil((prec+1)/2.0)` is also `1 + prec // 2`, isn't it?\n\n- I would say that our recursive implementation is slower that an iterative one, but I'm not sure\n\n- maybe, you could at the same time complete the documentation of the method `sqrt`",
    "created_at": "2018-03-02T13:23:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350444",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:12" align="right">comment:12</div>

Several comments:

- you don't need your function `_artin_schreier` since Sage has already methods (e.g. `roots`) for solving algebraic equations in finite fields

- in the `square_root` method, `prec` shouldn't be the precision cap of the parent but the actual precision of the element, no?

- in the `square_root` method, use the `sqrt` method for computing the square root modulo p (by the way, I don't understand why this part is needed)

- `ceil((prec+1)/2.0)` is also `1 + prec // 2`, isn't it?

- I would say that our recursive implementation is slower that an iterative one, but I'm not sure

- maybe, you could at the same time complete the documentation of the method `sqrt`



---

archive/issue_comments_350445.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nBy the way, this ticket only implements `sqrt` for unramified extensions of `Q2`, is that right? (It's not what is written in the description of the ticket.)\n\n```\n    sage: R.<a> = Zq(5^2)\n    sage: sqrt(1+5*a)\n    Traceback (most recent call last):\n    ...\n    NotImplementedError\n```",
    "created_at": "2018-03-08T20:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350445",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:13" align="right">comment:13</div>

By the way, this ticket only implements `sqrt` for unramified extensions of `Q2`, is that right? (It's not what is written in the description of the ticket.)

```
    sage: R.<a> = Zq(5^2)
    sage: sqrt(1+5*a)
    Traceback (most recent call last):
    ...
    NotImplementedError
```



---

archive/issue_comments_350446.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@xcaruso](#comment%3A13):\n> By the way, this ticket only implements `sqrt` for unramified extensions of `Q2`, is that right? (It's not what is written in the description of the ticket.)\n\nYeah, I think that's correct.  It would be nice to have it also include an implementation for other primes, but that's not currently in the code.",
    "created_at": "2018-03-08T20:22:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350446",
    "user": "https://github.com/roed314"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@xcaruso](#comment%3A13):
> By the way, this ticket only implements `sqrt` for unramified extensions of `Q2`, is that right? (It's not what is written in the description of the ticket.)

Yeah, I think that's correct.  It would be nice to have it also include an implementation for other primes, but that's not currently in the code.



---

archive/issue_comments_350447.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nMy answer to the first comments of Xavier: \n\n1) artin schreier is very efficient to solve equations of the form \nx2=ax+b by using a square and multiply type algorithm it shoud perform in ln(n)2 (where n is the degree of Q_q / Q_p) operations in Q_2. I don't know what is the algorithm implemented in roots but it should be less efficient, no ?\n\n\n2) yes I will make the change \n\n3) I have search through the square_root method and I could find only to lines with the keyword sqrt : \n* ans = self.parent()(self.__pari__().sqrt())\n*  z = self._inv_sqrt(prec)\nthe first one is for calling the pari implementation and the second one is a call to the inverse square root method.\n\n4) yes I will make the change\n\n5) ok\n\n6) Ok \n\n7) I will extend the implementation for odd primes p.\nThanks for your comments and you help !",
    "created_at": "2018-03-08T20:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350447",
    "user": "https://github.com/dlubicz"
}
```

<div id="comment:15" align="right">comment:15</div>

My answer to the first comments of Xavier: 

1) artin schreier is very efficient to solve equations of the form 
x2=ax+b by using a square and multiply type algorithm it shoud perform in ln(n)2 (where n is the degree of Q_q / Q_p) operations in Q_2. I don't know what is the algorithm implemented in roots but it should be less efficient, no ?


2) yes I will make the change 

3) I have search through the square_root method and I could find only to lines with the keyword sqrt : 
* ans = self.parent()(self.__pari__().sqrt())
*  z = self._inv_sqrt(prec)
the first one is for calling the pari implementation and the second one is a call to the inverse square root method.

4) yes I will make the change

5) ok

6) Ok 

7) I will extend the implementation for odd primes p.
Thanks for your comments and you help !



---

archive/issue_comments_350448.json:
```json
{
    "body": "Changed branch from **[u/roed/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/23344/2adic_sqrt)** to **[u/caruso/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/23344/2adic_sqrt)**",
    "created_at": "2018-03-08T22:57:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350448",
    "user": "https://github.com/xcaruso"
}
```

Changed branch from **[u/roed/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/23344/2adic_sqrt)** to **[u/caruso/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/23344/2adic_sqrt)**



---

archive/issue_comments_350449.json:
```json
{
    "body": "Changed commit from **[`65f2853`](https://github.com/sagemath/sagetrac-mirror/commit/65f28536ad731c289db6a150a200d179c4f80647)** to **[`61ba701`](https://github.com/sagemath/sagetrac-mirror/commit/61ba7013effe7fd0365f999562afc11e2386142e)**",
    "created_at": "2018-03-08T23:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350449",
    "user": "https://github.com/xcaruso"
}
```

Changed commit from **[`65f2853`](https://github.com/sagemath/sagetrac-mirror/commit/65f28536ad731c289db6a150a200d179c4f80647)** to **[`61ba701`](https://github.com/sagemath/sagetrac-mirror/commit/61ba7013effe7fd0365f999562afc11e2386142e)**



---

archive/issue_comments_350450.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI've pushed a new implementation which works over any extension of `Qp` for p > 2 and any unramified extension of `Q2` (the case of ramified extensions of `Q2` is much more subtle).\n\nPS: I've deleted your code; feel free to revert my changes if you think that it's appropriate.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/830dbba13baecfcc169d7295b4aa65c8134e6780\"><code>830dbba</code></a></td><td><code>Merge branch 'develop' into t/23344/23344/2adic_sqrt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61ba7013effe7fd0365f999562afc11e2386142e\"><code>61ba701</code></a></td><td><code>square root over almost all p-adic fields (except ramified extension of Q2)</code></td></tr></table>\n",
    "created_at": "2018-03-08T23:01:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350450",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:17" align="right">comment:17</div>

I've pushed a new implementation which works over any extension of `Qp` for p > 2 and any unramified extension of `Q2` (the case of ramified extensions of `Q2` is much more subtle).

PS: I've deleted your code; feel free to revert my changes if you think that it's appropriate.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/830dbba13baecfcc169d7295b4aa65c8134e6780"><code>830dbba</code></a></td><td><code>Merge branch 'develop' into t/23344/23344/2adic_sqrt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61ba7013effe7fd0365f999562afc11e2386142e"><code>61ba701</code></a></td><td><code>square root over almost all p-adic fields (except ramified extension of Q2)</code></td></tr></table>




---

archive/issue_comments_350451.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/88e08b2d5d2956d0c4e33b3f4066478774d691d8\"><code>88e08b2</code></a></td><td><code>square root for all p-adic fields</code></td></tr></table>\n",
    "created_at": "2018-03-11T19:18:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350451",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/88e08b2d5d2956d0c4e33b3f4066478774d691d8"><code>88e08b2</code></a></td><td><code>square root for all p-adic fields</code></td></tr></table>




---

archive/issue_comments_350452.json:
```json
{
    "body": "Changed commit from **[`61ba701`](https://github.com/sagemath/sagetrac-mirror/commit/61ba7013effe7fd0365f999562afc11e2386142e)** to **[`88e08b2`](https://github.com/sagemath/sagetrac-mirror/commit/88e08b2d5d2956d0c4e33b3f4066478774d691d8)**",
    "created_at": "2018-03-11T19:18:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350452",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`61ba701`](https://github.com/sagemath/sagetrac-mirror/commit/61ba7013effe7fd0365f999562afc11e2386142e)** to **[`88e08b2`](https://github.com/sagemath/sagetrac-mirror/commit/88e08b2d5d2956d0c4e33b3f4066478774d691d8)**



---

archive/issue_events_322203.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2018-03-11T19:20:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322203"
}
```



---

archive/issue_comments_350453.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI've extended my implementation to all p-adic fields (including ramified extensions of Q_2).\n\nNeeds review.",
    "created_at": "2018-03-11T19:20:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350453",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:19" align="right">comment:19</div>

I've extended my implementation to all p-adic fields (including ramified extensions of Q_2).

Needs review.



---

archive/issue_comments_350454.json:
```json
{
    "body": "Changed branch from **[u/caruso/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/23344/2adic_sqrt)** to **[u/lubicz/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/23344/2adic_sqrt)**",
    "created_at": "2018-03-30T08:12:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350454",
    "user": "https://github.com/dlubicz"
}
```

Changed branch from **[u/caruso/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/23344/2adic_sqrt)** to **[u/lubicz/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/23344/2adic_sqrt)**



---

archive/issue_comments_350455.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/332fe2c09953fd794804d7b4d9437e0c1ae5f059\"><code>332fe2c</code></a></td><td><code>positive review</code></td></tr></table>\n",
    "created_at": "2018-03-30T08:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350455",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/332fe2c09953fd794804d7b4d9437e0c1ae5f059"><code>332fe2c</code></a></td><td><code>positive review</code></td></tr></table>




---

archive/issue_comments_350456.json:
```json
{
    "body": "Changed commit from **[`88e08b2`](https://github.com/sagemath/sagetrac-mirror/commit/88e08b2d5d2956d0c4e33b3f4066478774d691d8)** to **[`332fe2c`](https://github.com/sagemath/sagetrac-mirror/commit/332fe2c09953fd794804d7b4d9437e0c1ae5f059)**",
    "created_at": "2018-03-30T08:13:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350456",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`88e08b2`](https://github.com/sagemath/sagetrac-mirror/commit/88e08b2d5d2956d0c4e33b3f4066478774d691d8)** to **[`332fe2c`](https://github.com/sagemath/sagetrac-mirror/commit/332fe2c09953fd794804d7b4d9437e0c1ae5f059)**



---

archive/issue_comments_350457.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nIn  \ndef _square_root(self):\n\n- replaced  parent = self.parent() by ring = self.parent()\n- corrected a bug in the computation of Artin-Schreier equation (carac 2).\nPushed the changes on trac.",
    "created_at": "2018-03-30T08:28:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350457",
    "user": "https://github.com/dlubicz"
}
```

<div id="comment:22" align="right">comment:22</div>

In  
def _square_root(self):

- replaced  parent = self.parent() by ring = self.parent()
- corrected a bug in the computation of Artin-Schreier equation (carac 2).
Pushed the changes on trac.



---

archive/issue_events_322204.json:
```json
{
    "actor": "https://github.com/dlubicz",
    "created_at": "2018-03-30T12:51:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322204"
}
```



---

archive/issue_events_322205.json:
```json
{
    "actor": "https://github.com/dlubicz",
    "created_at": "2018-03-30T12:51:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322205"
}
```



---

archive/issue_comments_350458.json:
```json
{
    "body": "Author: **Xavier Caruso**",
    "created_at": "2018-03-30T15:09:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350458",
    "user": "https://github.com/xcaruso"
}
```

Author: **Xavier Caruso**



---

archive/issue_comments_350459.json:
```json
{
    "body": "Reviewer: **David Lubicz**",
    "created_at": "2018-03-30T15:09:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350459",
    "user": "https://github.com/xcaruso"
}
```

Reviewer: **David Lubicz**



---

archive/issue_events_322206.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-03-31T06:27:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322206"
}
```



---

archive/issue_events_322207.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-03-31T06:27:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322207"
}
```



---

archive/issue_comments_350460.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\npatchbot reports failing doctests..",
    "created_at": "2018-03-31T06:27:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350460",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:25" align="right">comment:25</div>

patchbot reports failing doctests..



---

archive/issue_comments_350461.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nIt looks like many of the failures result from different choices of square root, but I agree that they need to be fixed.",
    "created_at": "2018-03-31T07:06:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350461",
    "user": "https://github.com/roed314"
}
```

<div id="comment:26" align="right">comment:26</div>

It looks like many of the failures result from different choices of square root, but I agree that they need to be fixed.



---

archive/issue_comments_350462.json:
```json
{
    "body": "Changed branch from **[u/lubicz/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/23344/2adic_sqrt)** to **[u/caruso/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/23344/2adic_sqrt)**",
    "created_at": "2018-03-31T10:36:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350462",
    "user": "https://github.com/xcaruso"
}
```

Changed branch from **[u/lubicz/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/lubicz/23344/2adic_sqrt)** to **[u/caruso/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/23344/2adic_sqrt)**



---

archive/issue_comments_350463.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44ae009b0a2c05e8434604df8a504acd7b60a58f\"><code>44ae009</code></a></td><td><code>Better ordering of square roots</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30855382d325dabb77a7fb1033fa44ba58fbc2f1\"><code>3085538</code></a></td><td><code>Redo David's changes (sorry: forgot to pull)</code></td></tr></table>\n",
    "created_at": "2018-03-31T10:41:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350463",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44ae009b0a2c05e8434604df8a504acd7b60a58f"><code>44ae009</code></a></td><td><code>Better ordering of square roots</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30855382d325dabb77a7fb1033fa44ba58fbc2f1"><code>3085538</code></a></td><td><code>Redo David's changes (sorry: forgot to pull)</code></td></tr></table>




---

archive/issue_comments_350464.json:
```json
{
    "body": "Changed commit from **[`332fe2c`](https://github.com/sagemath/sagetrac-mirror/commit/332fe2c09953fd794804d7b4d9437e0c1ae5f059)** to **[`3085538`](https://github.com/sagemath/sagetrac-mirror/commit/30855382d325dabb77a7fb1033fa44ba58fbc2f1)**",
    "created_at": "2018-03-31T10:41:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350464",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`332fe2c`](https://github.com/sagemath/sagetrac-mirror/commit/332fe2c09953fd794804d7b4d9437e0c1ae5f059)** to **[`3085538`](https://github.com/sagemath/sagetrac-mirror/commit/30855382d325dabb77a7fb1033fa44ba58fbc2f1)**



---

archive/issue_events_322208.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2018-03-31T10:42:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322208"
}
```



---

archive/issue_events_322209.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2018-03-31T10:42:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322209"
}
```



---

archive/issue_comments_350465.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nAs David pointed out, the issue was due to the choice/ordering of square roots (which was not consistent when precision varies). I fixed it. Let's see what the patchbot says now.",
    "created_at": "2018-03-31T10:42:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350465",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:29" align="right">comment:29</div>

As David pointed out, the issue was due to the choice/ordering of square roots (which was not consistent when precision varies). I fixed it. Let's see what the patchbot says now.



---

archive/issue_comments_350466.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-This ticket will implement the square root over unramified entensions of Z_p\n+This ticket implements square root over p-adic fields (i.e. finite extension of Qp)\n``````\n",
    "created_at": "2018-03-31T10:44:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350466",
    "user": "https://github.com/xcaruso"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-This ticket will implement the square root over unramified entensions of Z_p
+This ticket implements square root over p-adic fields (i.e. finite extension of Qp)
``````




---

archive/issue_events_322210.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-03-31T16:52:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322210"
}
```



---

archive/issue_events_322211.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-03-31T16:52:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "milestone_number": null,
    "milestone_title": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322211"
}
```



---

archive/issue_comments_350467.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nbot is green",
    "created_at": "2018-03-31T16:52:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350467",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:31" align="right">comment:31</div>

bot is green



---

archive/issue_events_322212.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2018-04-02T10:31:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322212"
}
```



---

archive/issue_events_322213.json:
```json
{
    "actor": "https://github.com/xcaruso",
    "created_at": "2018-04-02T10:31:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322213"
}
```



---

archive/issue_comments_350468.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nOK. So, I give a positive review to this ticket again.\nPlease change this if you disagree.",
    "created_at": "2018-04-02T10:31:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350468",
    "user": "https://github.com/xcaruso"
}
```

<div id="comment:32" align="right">comment:32</div>

OK. So, I give a positive review to this ticket again.
Please change this if you disagree.



---

archive/issue_events_322214.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-08T17:27:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322214"
}
```



---

archive/issue_events_322215.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d8c74278225f1b45c0383559649532aadfe59b96",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2018-05-08T17:27:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23344#event-322215"
}
```



---

archive/issue_comments_350469.json:
```json
{
    "body": "Changed branch from **[u/caruso/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/23344/2adic_sqrt)** to **[`3085538`](https://github.com/sagemath/sagetrac-mirror/commit/30855382d325dabb77a7fb1033fa44ba58fbc2f1)**",
    "created_at": "2018-05-08T17:27:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23344",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23344#issuecomment-350469",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/caruso/23344/2adic_sqrt](https://github.com/sagemath/sagetrac-mirror/tree/u/caruso/23344/2adic_sqrt)** to **[`3085538`](https://github.com/sagemath/sagetrac-mirror/commit/30855382d325dabb77a7fb1033fa44ba58fbc2f1)**
