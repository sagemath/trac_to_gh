# Issue 23724: Allow random sampling for unit testing

archive/issues_023487.json:
```json
{
    "body": "#16244 removed random sampling, but there are times when it would be nice to have.  This ticket adds it back in, but optionally.\n\nCC:  @nthiery\n\nBranch/Commit: 5d4f93b23acff12ae8dd94fe2cfd334d534684c4\n\nReviewer: Julian R\u00fcth\n\nAuthor: David Roe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23724\n\n",
    "closed_at": "2017-09-11T13:47:18Z",
    "created_at": "2017-08-26T04:10:20Z",
    "labels": [
        "component: doctest framework"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Allow random sampling for unit testing",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23724",
    "user": "https://github.com/roed314"
}
```
#16244 removed random sampling, but there are times when it would be nice to have.  This ticket adds it back in, but optionally.

CC:  @nthiery

Branch/Commit: 5d4f93b23acff12ae8dd94fe2cfd334d534684c4

Reviewer: Julian RÃ¼th

Author: David Roe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23724





---

archive/issue_comments_328782.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2017-08-26T04:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328782",
    "user": "https://github.com/roed314"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_328783.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-08-26T04:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328783",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_328784.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-28T20:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328784",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328785.json:
```json
{
    "body": "<a id='comment:4'></a>What about also changing `some_tuples` for consistency?",
    "created_at": "2017-08-29T03:24:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328785",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>What about also changing `some_tuples` for consistency?



---

archive/issue_comments_328786.json:
```json
{
    "body": "<a id='comment:5'></a>Changing how?  Adding an optional keyword argument to use sampling instead?  Something like\n\n```\ndef some_tuples(elements, repeat, bound, sampling=False):\n    from itertools import islice, product\n    from random import sample\n    P = product(elements, repeat=repeat)\n    if sampling:\n        try:\n            return random.sample(P, bound)\n        except ValueError:\n            return P\n    else:\n        return islice(product(elements, repeat=repeat), bound)\n```",
    "created_at": "2017-08-29T04:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328786",
    "user": "https://github.com/roed314"
}
```

<a id='comment:5'></a>Changing how?  Adding an optional keyword argument to use sampling instead?  Something like

```
def some_tuples(elements, repeat, bound, sampling=False):
    from itertools import islice, product
    from random import sample
    P = product(elements, repeat=repeat)
    if sampling:
        try:
            return random.sample(P, bound)
        except ValueError:
            return P
    else:
        return islice(product(elements, repeat=repeat), bound)
```



---

archive/issue_comments_328787.json:
```json
{
    "body": "<a id='comment:6'></a>I was thinking it would have the same idiom as the `TestSuite` with a `max_samples=None` argument, but basically, yes.",
    "created_at": "2017-08-29T05:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328787",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>I was thinking it would have the same idiom as the `TestSuite` with a `max_samples=None` argument, but basically, yes.



---

archive/issue_comments_328788.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-05T05:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_328789.json:
```json
{
    "body": "<a id='comment:9'></a>New commits:",
    "created_at": "2017-09-06T17:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328789",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:9'></a>New commits:



---

archive/issue_comments_328790.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-06T17:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328790",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_328791.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-09-06T17:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328791",
    "user": "https://github.com/saraedum"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_328792.json:
```json
{
    "body": "<a id='comment:10'></a>I am confused about the patchbots errors. I first thought that was noise but it seems to be consistent for several patchbots.",
    "created_at": "2017-09-06T17:25:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328792",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:10'></a>I am confused about the patchbots errors. I first thought that was noise but it seems to be consistent for several patchbots.



---

archive/issue_comments_328793.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-06T17:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328793",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_060598.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-11T13:47:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23724#event-60598"
}
```



---

archive/issue_comments_328794.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-11T13:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23724",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23724#issuecomment-328794",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
