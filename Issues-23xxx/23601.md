# Issue 23601: Gammoids

archive/issues_023364.json:
```json
{
    "assignees": [],
    "body": "Implement gammoids using digraphs for data. These will use transversal matroids for taking minors or duals.\n\nCC:  zgershkoff Stefan @tscrim\n\nBranch/Commit: **[u/zgershkoff/gammoids](https://github.com/sagemath/sagetrac-mirror/tree/u/zgershkoff/gammoids) @ [0d916eb](https://github.com/sagemath/sagetrac-mirror/commit/0d916eb7e5f14c19ebba052d2450a46cb3d1700c)**\n\nAuthor: **Zachary Gershkoff**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23601_\n\n",
    "created_at": "2017-08-08T22:27:28Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20matroid%20theory",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Gammoids",
    "type": "issue",
    "updated_at": "2022-12-29T01:40:01Z",
    "url": "https://github.com/sagemath/sage/issues/23601",
    "user": "https://github.com/sagetrac-zgershkoff"
}
```
Implement gammoids using digraphs for data. These will use transversal matroids for taking minors or duals.

CC:  zgershkoff Stefan @tscrim

Branch/Commit: **[u/zgershkoff/gammoids](https://github.com/sagemath/sagetrac-mirror/tree/u/zgershkoff/gammoids) @ [0d916eb](https://github.com/sagemath/sagetrac-mirror/commit/0d916eb7e5f14c19ebba052d2450a46cb3d1700c)**

Author: **Zachary Gershkoff**

_Issue created by migration from https://trac.sagemath.org/ticket/23601_





---

archive/issue_events_310304.json:
```json
{
    "actor": "https://github.com/sagetrac-zgershkoff",
    "created_at": "2017-08-08T22:27:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23601#event-310304"
}
```



---

archive/issue_events_310305.json:
```json
{
    "actor": "https://github.com/sagetrac-zgershkoff",
    "created_at": "2017-08-08T22:27:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23601#event-310305"
}
```



---

archive/issue_comments_357917.json:
```json
{
    "body": "Branch: **[u/zgershkoff/gammoids](https://github.com/sagemath/sagetrac-mirror/tree/u/zgershkoff/gammoids)**",
    "created_at": "2017-08-08T23:01:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357917",
    "user": "https://github.com/sagetrac-zgershkoff"
}
```

Branch: **[u/zgershkoff/gammoids](https://github.com/sagemath/sagetrac-mirror/tree/u/zgershkoff/gammoids)**



---

archive/issue_comments_357918.json:
```json
{
    "body": "Commit: **[a861249](https://github.com/sagemath/sagetrac-mirror/commit/a861249caed8200d2c7771ceddfff816720758b5)**",
    "created_at": "2017-08-08T23:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357918",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[a861249](https://github.com/sagemath/sagetrac-mirror/commit/a861249caed8200d2c7771ceddfff816720758b5)**



---

archive/issue_comments_357919.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a861249caed8200d2c7771ceddfff816720758b5\">a861249</a></td><td><code>fix to rank function</code></td></tr></table>\n",
    "created_at": "2017-08-08T23:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357919",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>Comment 2:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a861249caed8200d2c7771ceddfff816720758b5">a861249</a></td><td><code>fix to rank function</code></td></tr></table>




---

archive/issue_comments_357920.json:
```json
{
    "body": "Author: **Zachary Gershkoff**",
    "created_at": "2017-08-08T23:12:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357920",
    "user": "https://github.com/sagetrac-zgershkoff"
}
```

Author: **Zachary Gershkoff**



---

archive/issue_events_310306.json:
```json
{
    "actor": "https://github.com/sagetrac-zgershkoff",
    "created_at": "2017-08-08T23:12:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20matroid%20theory",
    "label_color": "0000ff",
    "label_name": "component: matroid theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23601#event-310306"
}
```



---

archive/issue_comments_357921.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Implement gammoids using digraphs for data. These will use transversal matroids for taking minors or duals.\n``````\n",
    "created_at": "2017-08-08T23:12:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357921",
    "user": "https://github.com/sagetrac-zgershkoff"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Implement gammoids using digraphs for data. These will use transversal matroids for taking minors or duals.
``````




---

archive/issue_comments_357922.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nIt has a working rank function. I think the hard part will be minors from contraction.",
    "created_at": "2017-08-08T23:12:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357922",
    "user": "https://github.com/sagetrac-zgershkoff"
}
```

<a id='comment:3'>Comment 3:</a>
It has a working rank function. I think the hard part will be minors from contraction.



---

archive/issue_events_310307.json:
```json
{
    "actor": "https://github.com/sagetrac-zgershkoff",
    "created_at": "2017-08-08T23:12:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23601#event-310307"
}
```



---

archive/issue_comments_357923.json:
```json
{
    "body": "Changed commit from **[a861249](https://github.com/sagemath/sagetrac-mirror/commit/a861249caed8200d2c7771ceddfff816720758b5)** to **[66ffb54](https://github.com/sagemath/sagetrac-mirror/commit/66ffb54fd76032983d0f6c4c4215ae0798e70a64)**",
    "created_at": "2017-08-17T23:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357923",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a861249](https://github.com/sagemath/sagetrac-mirror/commit/a861249caed8200d2c7771ceddfff816720758b5)** to **[66ffb54](https://github.com/sagemath/sagetrac-mirror/commit/66ffb54fd76032983d0f6c4c4215ae0798e70a64)**



---

archive/issue_comments_357924.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/95c120126e8a4b080aa3928b893171036c728bf9\">95c1201</a></td><td><code>more methods and documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66ffb54fd76032983d0f6c4c4215ae0798e70a64\">66ffb54</a></td><td><code>Uploading changes, even though there's a bug in _prune_vertices()</code></td></tr></table>\n",
    "created_at": "2017-08-17T23:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357924",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:4'>Comment 4:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/95c120126e8a4b080aa3928b893171036c728bf9">95c1201</a></td><td><code>more methods and documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66ffb54fd76032983d0f6c4c4215ae0798e70a64">66ffb54</a></td><td><code>Uploading changes, even though there's a bug in _prune_vertices()</code></td></tr></table>




---

archive/issue_comments_357925.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5cd5845d5dc978c4c2e364a2272ab14282e664b\">c5cd584</a></td><td><code>found the bug</code></td></tr></table>\n",
    "created_at": "2017-08-17T23:54:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357925",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5cd5845d5dc978c4c2e364a2272ab14282e664b">c5cd584</a></td><td><code>found the bug</code></td></tr></table>




---

archive/issue_comments_357926.json:
```json
{
    "body": "Changed commit from **[66ffb54](https://github.com/sagemath/sagetrac-mirror/commit/66ffb54fd76032983d0f6c4c4215ae0798e70a64)** to **[c5cd584](https://github.com/sagemath/sagetrac-mirror/commit/c5cd5845d5dc978c4c2e364a2272ab14282e664b)**",
    "created_at": "2017-08-17T23:54:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357926",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[66ffb54](https://github.com/sagemath/sagetrac-mirror/commit/66ffb54fd76032983d0f6c4c4215ae0798e70a64)** to **[c5cd584](https://github.com/sagemath/sagetrac-mirror/commit/c5cd5845d5dc978c4c2e364a2272ab14282e664b)**



---

archive/issue_comments_357927.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/57f10a435d77fa6e87fd592bb51fe24a253a43d9\">57f10a4</a></td><td><code>gammoid_extension + tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6521d33c9b44f139bec38c4d357970000dee274\">b6521d3</a></td><td><code>fixing style of input and output blocks</code></td></tr></table>\n",
    "created_at": "2017-08-20T19:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357927",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/57f10a435d77fa6e87fd592bb51fe24a253a43d9">57f10a4</a></td><td><code>gammoid_extension + tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6521d33c9b44f139bec38c4d357970000dee274">b6521d3</a></td><td><code>fixing style of input and output blocks</code></td></tr></table>




---

archive/issue_comments_357928.json:
```json
{
    "body": "Changed commit from **[c5cd584](https://github.com/sagemath/sagetrac-mirror/commit/c5cd5845d5dc978c4c2e364a2272ab14282e664b)** to **[b6521d3](https://github.com/sagemath/sagetrac-mirror/commit/b6521d33c9b44f139bec38c4d357970000dee274)**",
    "created_at": "2017-08-20T19:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357928",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c5cd584](https://github.com/sagemath/sagetrac-mirror/commit/c5cd5845d5dc978c4c2e364a2272ab14282e664b)** to **[b6521d3](https://github.com/sagemath/sagetrac-mirror/commit/b6521d33c9b44f139bec38c4d357970000dee274)**



---

archive/issue_comments_357929.json:
```json
{
    "body": "Changed commit from **[b6521d3](https://github.com/sagemath/sagetrac-mirror/commit/b6521d33c9b44f139bec38c4d357970000dee274)** to **[686f016](https://github.com/sagemath/sagetrac-mirror/commit/686f016a56eb188defe7c52bf61fda95e72793ed)**",
    "created_at": "2017-08-25T18:17:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357929",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b6521d3](https://github.com/sagemath/sagetrac-mirror/commit/b6521d33c9b44f139bec38c4d357970000dee274)** to **[686f016](https://github.com/sagemath/sagetrac-mirror/commit/686f016a56eb188defe7c52bf61fda95e72793ed)**



---

archive/issue_comments_357930.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/158c5dcbc8b6c96757210232ca758de1ce2c0f04\">158c5dc</a></td><td><code>adding test suite</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e866e3554db1e2066cbd1bfd8fe0fff2cb08db5a\">e866e35</a></td><td><code>gammoid_extensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61052cf731fcb66b54a8a0daa5f997be63f59187\">61052cf</a></td><td><code>module documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/686f016a56eb188defe7c52bf61fda95e72793ed\">686f016</a></td><td><code>added under \"Concrete implementations\" in doc index</code></td></tr></table>\n",
    "created_at": "2017-08-25T18:17:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357930",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:7'>Comment 7:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/158c5dcbc8b6c96757210232ca758de1ce2c0f04">158c5dc</a></td><td><code>adding test suite</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e866e3554db1e2066cbd1bfd8fe0fff2cb08db5a">e866e35</a></td><td><code>gammoid_extensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61052cf731fcb66b54a8a0daa5f997be63f59187">61052cf</a></td><td><code>module documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/686f016a56eb188defe7c52bf61fda95e72793ed">686f016</a></td><td><code>added under "Concrete implementations" in doc index</code></td></tr></table>




---

archive/issue_comments_357931.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nThat should be everything it needs right now.",
    "created_at": "2017-08-25T18:22:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357931",
    "user": "https://github.com/sagetrac-zgershkoff"
}
```

<a id='comment:8'>Comment 8:</a>
That should be everything it needs right now.



---

archive/issue_events_310308.json:
```json
{
    "actor": "https://github.com/sagetrac-zgershkoff",
    "created_at": "2017-08-25T18:22:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23601#event-310308"
}
```



---

archive/issue_comments_357932.json:
```json
{
    "body": "Changed commit from **[686f016](https://github.com/sagemath/sagetrac-mirror/commit/686f016a56eb188defe7c52bf61fda95e72793ed)** to **[0d916eb](https://github.com/sagemath/sagetrac-mirror/commit/0d916eb7e5f14c19ebba052d2450a46cb3d1700c)**",
    "created_at": "2017-08-27T02:27:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357932",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[686f016](https://github.com/sagemath/sagetrac-mirror/commit/686f016a56eb188defe7c52bf61fda95e72793ed)** to **[0d916eb](https://github.com/sagemath/sagetrac-mirror/commit/0d916eb7e5f14c19ebba052d2450a46cb3d1700c)**



---

archive/issue_comments_357933.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d916eb7e5f14c19ebba052d2450a46cb3d1700c\">0d916eb</a></td><td><code>Reinstalled sage; documentation builds correctly now</code></td></tr></table>\n",
    "created_at": "2017-08-27T02:27:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357933",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>Comment 9:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d916eb7e5f14c19ebba052d2450a46cb3d1700c">0d916eb</a></td><td><code>Reinstalled sage; documentation builds correctly now</code></td></tr></table>




---

archive/issue_comments_357934.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nThis looks fairly good, but I noticed a few issues:\n\n- this is not merging cleanly with the latest development version, so you'll have to merge and resolve the conflict.\n\n- The class documentation might explain \"linked into\", or point to a reference.\n\n- the import of `newlabel` does not appear to be needed.\n\n- the imports `from copy import copy, deepcopy` are not needed either.\n\n- The constructor should perhaps check that input `D` is in fact a digraph, or can be coerced to one.  For example, I might be surprised by\n\n```\nsage: G = graphs.CompleteGraph(3)\nsage: g = Gammoid(G, roots=[1]); g\nGammoid of rank 1 on 3 elements\nsage: g.digraph().edges()\n[(0, 1, None), (0, 2, None), (1, 2, None)]\nsage: list(g.bases())\n[frozenset({0}), frozenset({1})]\n```\nI might have expected the Gammoid derived from graph G to have bases {2} as well.  The edge list seems to have arbitrarily directed the edges of G.  For another example `Gammoid(ZZ, roots=[])` raises a messy attribute error.\n- Why doesn't `_prune_vertices_` remove *all* irrelevant vertices?  And why is it not faster on bad examples?  Consider these timings with the existing code:\n\n```\nsage: d = digraphs.Circulant(201, [1, 59, 100])\nsage: %timeit Gammoid(d+digraphs.Path(1000), roots=[1,50,100,153], groundset=d.vertices())\n1 loop, best of 3: 580 ms per loop\nsage: %timeit Gammoid(d+digraphs.Path(2000), roots=[1,50,100,153], groundset=d.vertices())\n1 loop, best of 3: 1.96 s per loop\nsage: %timeit Gammoid(d+digraphs.Path(3000), roots=[1,50,100,153], groundset=d.vertices())\n1 loop, best of 3: 4.17 s per loop\n```\nHere's one way to be more thorough, and faster in these cases\n\n```\n        V = set(self._D.vertices()).difference(self._groundset)\n        if len(V) == 0:\n            return\n        v = self._D.add_vertex()\n        self._D.add_edges( (v,u) for u in self._groundset)\n        self._D.add_edges( (u,v) for u in self._roots)\n        c = self._D.strongly_connected_component_containing_vertex(v)\n        self._D.delete_vertices(V.difference(c))\n        self._D.delete_vertex(v)\n```\nNew timings:\n\n```\nsage: %timeit Gammoid(d+digraphs.Path(1000), roots=[1,50,100,153], groundset=d.vertices())\n10 loops, best of 3: 19.3 ms per loop\nsage: \nsage: %timeit Gammoid(d+digraphs.Path(2000), roots=[1,50,100,153], groundset=d.vertices())\n10 loops, best of 3: 39.7 ms per loop\nsage: %timeit Gammoid(d+digraphs.Path(3000), roots=[1,50,100,153], groundset=d.vertices())\n10 loops, best of 3: 72.4 ms per loop\n```\nAnd here's a case that, while slightly slower, the new code is more accurate in pruning.  First, with the original code:\n\n```\n%timeit Gammoid(d+digraphs.Circuit(3000), roots=[1,50,100,153], groundset=d.vertices())\n10 loops, best of 3: 49.1 ms per loop\n\nsage: g = Gammoid(d+digraphs.Circuit(3000), roots=[1,50,100,153], groundset=d.vertices())\nsage: g.digraph()\nDigraph on 3201 vertices\n```\nand with the new code\n\n```\n%timeit Gammoid(d+digraphs.Circuit(3000), roots=[1,50,100,153], groundset=d.vertices())\n10 loops, best of 3: 70 ms per loop\n\nsage: g = Gammoid(d+digraphs.Circuit(3000), roots=[1,50,100,153], groundset=d.vertices())\nsage: g.digraph()\nDigraph on 201 vertices\n```\nThe new code could be better, for example, also deleting roots if they are unreachable from the groundset, and there are of course other ways to code up the pruning.\n\n- the \"red\" colour #D55E00 looks more orange than red, to me.\n\n- every minor of a gammoid is a gammoid.  Why not have `_minor_` recognize that?\n\n- `_minor_` should have a few more test cases; there are 4 paths through the code and they could all be tested.\n\n- In the documentation for `gammoid_extension` you refer to the \"starting set\" and a \"source vertex\".  These are new terms not appearing the documentation of the class or constructor.  The documentation for the parameters does better.\n\n- The documentation for `gammoid extension` could be clearer on what it accomplishes.  Is every matroid extension of a gammoid that results in another gammoid obtained in this way?",
    "created_at": "2017-09-18T16:12:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23601#issuecomment-357934",
    "user": "https://github.com/sagetrac-msaaltink"
}
```

<a id='comment:10'>Comment 10:</a>
This looks fairly good, but I noticed a few issues:

- this is not merging cleanly with the latest development version, so you'll have to merge and resolve the conflict.

- The class documentation might explain "linked into", or point to a reference.

- the import of `newlabel` does not appear to be needed.

- the imports `from copy import copy, deepcopy` are not needed either.

- The constructor should perhaps check that input `D` is in fact a digraph, or can be coerced to one.  For example, I might be surprised by

```
sage: G = graphs.CompleteGraph(3)
sage: g = Gammoid(G, roots=[1]); g
Gammoid of rank 1 on 3 elements
sage: g.digraph().edges()
[(0, 1, None), (0, 2, None), (1, 2, None)]
sage: list(g.bases())
[frozenset({0}), frozenset({1})]
```
I might have expected the Gammoid derived from graph G to have bases {2} as well.  The edge list seems to have arbitrarily directed the edges of G.  For another example `Gammoid(ZZ, roots=[])` raises a messy attribute error.
- Why doesn't `_prune_vertices_` remove *all* irrelevant vertices?  And why is it not faster on bad examples?  Consider these timings with the existing code:

```
sage: d = digraphs.Circulant(201, [1, 59, 100])
sage: %timeit Gammoid(d+digraphs.Path(1000), roots=[1,50,100,153], groundset=d.vertices())
1 loop, best of 3: 580 ms per loop
sage: %timeit Gammoid(d+digraphs.Path(2000), roots=[1,50,100,153], groundset=d.vertices())
1 loop, best of 3: 1.96 s per loop
sage: %timeit Gammoid(d+digraphs.Path(3000), roots=[1,50,100,153], groundset=d.vertices())
1 loop, best of 3: 4.17 s per loop
```
Here's one way to be more thorough, and faster in these cases

```
        V = set(self._D.vertices()).difference(self._groundset)
        if len(V) == 0:
            return
        v = self._D.add_vertex()
        self._D.add_edges( (v,u) for u in self._groundset)
        self._D.add_edges( (u,v) for u in self._roots)
        c = self._D.strongly_connected_component_containing_vertex(v)
        self._D.delete_vertices(V.difference(c))
        self._D.delete_vertex(v)
```
New timings:

```
sage: %timeit Gammoid(d+digraphs.Path(1000), roots=[1,50,100,153], groundset=d.vertices())
10 loops, best of 3: 19.3 ms per loop
sage: 
sage: %timeit Gammoid(d+digraphs.Path(2000), roots=[1,50,100,153], groundset=d.vertices())
10 loops, best of 3: 39.7 ms per loop
sage: %timeit Gammoid(d+digraphs.Path(3000), roots=[1,50,100,153], groundset=d.vertices())
10 loops, best of 3: 72.4 ms per loop
```
And here's a case that, while slightly slower, the new code is more accurate in pruning.  First, with the original code:

```
%timeit Gammoid(d+digraphs.Circuit(3000), roots=[1,50,100,153], groundset=d.vertices())
10 loops, best of 3: 49.1 ms per loop

sage: g = Gammoid(d+digraphs.Circuit(3000), roots=[1,50,100,153], groundset=d.vertices())
sage: g.digraph()
Digraph on 3201 vertices
```
and with the new code

```
%timeit Gammoid(d+digraphs.Circuit(3000), roots=[1,50,100,153], groundset=d.vertices())
10 loops, best of 3: 70 ms per loop

sage: g = Gammoid(d+digraphs.Circuit(3000), roots=[1,50,100,153], groundset=d.vertices())
sage: g.digraph()
Digraph on 201 vertices
```
The new code could be better, for example, also deleting roots if they are unreachable from the groundset, and there are of course other ways to code up the pruning.

- the "red" colour #D55E00 looks more orange than red, to me.

- every minor of a gammoid is a gammoid.  Why not have `_minor_` recognize that?

- `_minor_` should have a few more test cases; there are 4 paths through the code and they could all be tested.

- In the documentation for `gammoid_extension` you refer to the "starting set" and a "source vertex".  These are new terms not appearing the documentation of the class or constructor.  The documentation for the parameters does better.

- The documentation for `gammoid extension` could be clearer on what it accomplishes.  Is every matroid extension of a gammoid that results in another gammoid obtained in this way?



---

archive/issue_events_310309.json:
```json
{
    "actor": "https://github.com/sagetrac-msaaltink",
    "created_at": "2017-09-18T16:12:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23601#event-310309"
}
```



---

archive/issue_events_310310.json:
```json
{
    "actor": "https://github.com/sagetrac-msaaltink",
    "created_at": "2017-09-18T16:12:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23601#event-310310"
}
```



---

archive/issue_events_310311.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:40:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23601",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23601#event-310311"
}
```
