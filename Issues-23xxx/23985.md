# Issue 23985: rst2ipynb causes doctest failures if pandoc is not installed

archive/issues_023748.json:
```json
{
    "assignees": [],
    "body": "The following is not very surprising as pandoc is listed as a requirement on https://pypi.python.org/pypi/rst2ipynb/0.2.0 .\n\n```\nbt-nac-b021:sagedev mderickx$ ./sage -t --long src/sage/tests/cmdline.py \nForcing sage-location, probably because a new package was installed.\nCleaning up, do not interrupt this.\nDone cleaning.\nRunning doctests with ID 2017-10-07-20-05-33-76cbb199.\nGit branch: 23971\nUsing --optional=ccache,gmpy2,mpir,normaliz,openssl,pandoc_attributes,pandocfilters,pynormaliz,python2,rst2ipynb,sage\nDoctesting 1 file.\nsage -t --long --warn-long 44.4 src/sage/tests/cmdline.py\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 655, in sage.tests.cmdline.test_executable\nFailed example:\n    print(out)                           # optional - rst2ipynb\nExpected:\n    {\n     \"nbformat_minor\": ...,\n     \"nbformat\": ...,\n     \"cells\": [\n      {\n       \"source\": [\n        \"$$\\n\",\n        \"\\\\def\\\\CC{\\\\bf C}\\n\",\n        \"\\\\def\\\\QQ{\\\\bf Q}\\n\",\n        \"\\\\def\\\\RR{\\\\bf R}\\n\",\n        \"\\\\def\\\\ZZ{\\\\bf Z}\\n\",\n        \"\\\\def\\\\NN{\\\\bf N}\\n\",\n        \"$$\"\n       ],\n       \"cell_type\": \"markdown\",\n       \"metadata\": {}\n      },\n      {\n       \"execution_count\": null,\n       \"cell_type\": \"code\",\n       \"source\": [\n        \"2^10\"\n       ],\n       \"outputs\": [\n        {\n         \"execution_count\": 1,\n         \"output_type\": \"execute_result\",\n         \"data\": {\n          \"text/plain\": [\n           \"1024\"\n          ]\n         },\n         \"metadata\": {}\n        }\n       ],\n       \"metadata\": {}\n      },\n      {\n       \"execution_count\": null,\n       \"cell_type\": \"code\",\n       \"source\": [\n        \"2 + 2\"\n       ],\n       \"outputs\": [\n        {\n         \"execution_count\": 1,\n         \"output_type\": \"execute_result\",\n         \"data\": {\n          \"text/plain\": [\n           \"4\"\n          ]\n         },\n         \"metadata\": {}\n        }\n       ],\n       \"metadata\": {}\n      }\n     ],\n     \"metadata\": {\n      \"kernelspec\": {\n       \"display_name\": \"sagemath\",\n       \"name\": \"sagemath\"\n      }\n     }\n    }\nGot:\n    <BLANKLINE>\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 721, in sage.tests.cmdline.test_executable\nFailed example:\n    err                   # optional - rst2ipynb\nExpected:\n    ''\nGot:\n    'ERROR: rst2ipnb requires pandoc; please install it on your system.\\n'\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 723, in sage.tests.cmdline.test_executable\nFailed example:\n    ret                   # optional - rst2ipynb\nExpected:\n    0\nGot:\n    1\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 734, in sage.tests.cmdline.test_executable\nFailed example:\n    test_executable(L)              # optional - rst2ipynb\nExpected:\n    ('', '', 0)\nGot:\n    ('', 'ERROR: rst2ipnb requires pandoc; please install it on your system.\\n', 1)\n**********************************************************************\nFile \"src/sage/tests/cmdline.py\", line 736, in sage.tests.cmdline.test_executable\nFailed example:\n    print(open(output, 'r').read()) # optional - rst2ipynb\nExpected:\n    {\n     \"nbformat_minor\": ...,\n     \"nbformat\": ...,\n     \"cells\": [\n      {\n       \"source\": [\n        \"$$\\n\",\n        \"\\\\def\\\\CC{\\\\bf C}\\n\",\n        \"\\\\def\\\\QQ{\\\\bf Q}\\n\",\n    ...\n     \"metadata\": {\n      \"kernelspec\": {\n       \"display_name\": \"sagemath\",\n       \"name\": \"sagemath\"\n      }\n     }\n    }\nGot:\n    <BLANKLINE>\n**********************************************************************\n1 item had failures:\n   5 of 251 in sage.tests.cmdline.test_executable\n    [250 tests, 5 failures, 64.90 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 44.4 src/sage/tests/cmdline.py  # 5 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 65.0 seconds\n    cpu time: 1.4 seconds\n    cumulative wall time: 64.9 seconds\n```\n\nTo fix this, we upgrade the rst2ipynb package and apply a patch:\n\n**Upstream patch**: https://github.com/nthiery/rst-to-ipynb/pull/4\n\n**Tarball**: https://pypi.python.org/packages/59/21/e8bc2432fb6b901d40728a8520401b04f3a8601c8f203790eea65b999793/rst2ipynb-0.2.2.tar.gz\n\nCC:  @nthiery\n\nBranch: **[4a31dbf](https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **Maarten Derickx**\n\nAuthor: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23985_\n\n",
    "closed_at": "2017-10-16T22:44:59Z",
    "created_at": "2017-10-07T18:11:22Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "rst2ipynb causes doctest failures if pandoc is not installed",
    "type": "issue",
    "updated_at": "2017-10-18T15:44:21Z",
    "url": "https://github.com/sagemath/sage/issues/23985",
    "user": "https://github.com/koffie"
}
```
The following is not very surprising as pandoc is listed as a requirement on https://pypi.python.org/pypi/rst2ipynb/0.2.0 .

```
bt-nac-b021:sagedev mderickx$ ./sage -t --long src/sage/tests/cmdline.py 
Forcing sage-location, probably because a new package was installed.
Cleaning up, do not interrupt this.
Done cleaning.
Running doctests with ID 2017-10-07-20-05-33-76cbb199.
Git branch: 23971
Using --optional=ccache,gmpy2,mpir,normaliz,openssl,pandoc_attributes,pandocfilters,pynormaliz,python2,rst2ipynb,sage
Doctesting 1 file.
sage -t --long --warn-long 44.4 src/sage/tests/cmdline.py
**********************************************************************
File "src/sage/tests/cmdline.py", line 655, in sage.tests.cmdline.test_executable
Failed example:
    print(out)                           # optional - rst2ipynb
Expected:
    {
     "nbformat_minor": ...,
     "nbformat": ...,
     "cells": [
      {
       "source": [
        "$$\n",
        "\\def\\CC{\\bf C}\n",
        "\\def\\QQ{\\bf Q}\n",
        "\\def\\RR{\\bf R}\n",
        "\\def\\ZZ{\\bf Z}\n",
        "\\def\\NN{\\bf N}\n",
        "$$"
       ],
       "cell_type": "markdown",
       "metadata": {}
      },
      {
       "execution_count": null,
       "cell_type": "code",
       "source": [
        "2^10"
       ],
       "outputs": [
        {
         "execution_count": 1,
         "output_type": "execute_result",
         "data": {
          "text/plain": [
           "1024"
          ]
         },
         "metadata": {}
        }
       ],
       "metadata": {}
      },
      {
       "execution_count": null,
       "cell_type": "code",
       "source": [
        "2 + 2"
       ],
       "outputs": [
        {
         "execution_count": 1,
         "output_type": "execute_result",
         "data": {
          "text/plain": [
           "4"
          ]
         },
         "metadata": {}
        }
       ],
       "metadata": {}
      }
     ],
     "metadata": {
      "kernelspec": {
       "display_name": "sagemath",
       "name": "sagemath"
      }
     }
    }
Got:
    <BLANKLINE>
**********************************************************************
File "src/sage/tests/cmdline.py", line 721, in sage.tests.cmdline.test_executable
Failed example:
    err                   # optional - rst2ipynb
Expected:
    ''
Got:
    'ERROR: rst2ipnb requires pandoc; please install it on your system.\n'
**********************************************************************
File "src/sage/tests/cmdline.py", line 723, in sage.tests.cmdline.test_executable
Failed example:
    ret                   # optional - rst2ipynb
Expected:
    0
Got:
    1
**********************************************************************
File "src/sage/tests/cmdline.py", line 734, in sage.tests.cmdline.test_executable
Failed example:
    test_executable(L)              # optional - rst2ipynb
Expected:
    ('', '', 0)
Got:
    ('', 'ERROR: rst2ipnb requires pandoc; please install it on your system.\n', 1)
**********************************************************************
File "src/sage/tests/cmdline.py", line 736, in sage.tests.cmdline.test_executable
Failed example:
    print(open(output, 'r').read()) # optional - rst2ipynb
Expected:
    {
     "nbformat_minor": ...,
     "nbformat": ...,
     "cells": [
      {
       "source": [
        "$$\n",
        "\\def\\CC{\\bf C}\n",
        "\\def\\QQ{\\bf Q}\n",
    ...
     "metadata": {
      "kernelspec": {
       "display_name": "sagemath",
       "name": "sagemath"
      }
     }
    }
Got:
    <BLANKLINE>
**********************************************************************
1 item had failures:
   5 of 251 in sage.tests.cmdline.test_executable
    [250 tests, 5 failures, 64.90 s]
----------------------------------------------------------------------
sage -t --long --warn-long 44.4 src/sage/tests/cmdline.py  # 5 doctests failed
----------------------------------------------------------------------
Total time for all tests: 65.0 seconds
    cpu time: 1.4 seconds
    cumulative wall time: 64.9 seconds
```

To fix this, we upgrade the rst2ipynb package and apply a patch:

**Upstream patch**: https://github.com/nthiery/rst-to-ipynb/pull/4

**Tarball**: https://pypi.python.org/packages/59/21/e8bc2432fb6b901d40728a8520401b04f3a8601c8f203790eea65b999793/rst2ipynb-0.2.2.tar.gz

CC:  @nthiery

Branch: **[4a31dbf](https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **Maarten Derickx**

Author: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/23985_





---

archive/issue_events_315065.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-10-07T18:11:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315065"
}
```



---

archive/issue_events_315066.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-10-07T18:11:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "component: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315066"
}
```



---

archive/issue_events_315067.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-10-07T18:11:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315067"
}
```



---

archive/issue_events_315068.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-10-07T18:11:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315068"
}
```



---

archive/issue_comments_365025.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nHi Jeroen,\n\nWould you think testing for pandoc during the installation of rst2ipynb and printing a clear error message redirecting the end user to https://pandoc.org/installing.html would be a good way to solve this? From the website it seems that this is a mature project that is easy to install on every platform we support and more. And building it ourselves from source would require a haskell compiler, and I rather not add this to sage if not needed, even not as optional package.",
    "created_at": "2017-10-07T18:21:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365025",
    "user": "https://github.com/koffie"
}
```

<a id='comment:1'>Comment 1:</a>
Hi Jeroen,

Would you think testing for pandoc during the installation of rst2ipynb and printing a clear error message redirecting the end user to https://pandoc.org/installing.html would be a good way to solve this? From the website it seems that this is a mature project that is easy to install on every platform we support and more. And building it ourselves from source would require a haskell compiler, and I rather not add this to sage if not needed, even not as optional package.



---

archive/issue_comments_365026.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nThere are also Python packages related to pandoc. Maybe the error would better be raised there. I'll check...",
    "created_at": "2017-10-09T08:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365026",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'>Comment 2:</a>
There are also Python packages related to pandoc. Maybe the error would better be raised there. I'll check...



---

archive/issue_comments_365027.json:
```json
{
    "body": "Upstream: **Reported upstream. No feedback yet.**",
    "created_at": "2017-10-09T10:41:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365027",
    "user": "https://github.com/jdemeyer"
}
```

Upstream: **Reported upstream. No feedback yet.**



---

archive/issue_comments_365028.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -140,5 +140,6 @@\n Total time for all tests: 65.0 seconds\n     cpu time: 1.4 seconds\n     cumulative wall time: 64.9 seconds\n+```\n \n-```\n+**Upstream patch**: https://github.com/nthiery/rst-to-ipynb/pull/4\n``````\n",
    "created_at": "2017-10-09T10:41:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365028",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -140,5 +140,6 @@
 Total time for all tests: 65.0 seconds
     cpu time: 1.4 seconds
     cumulative wall time: 64.9 seconds
+```
 
-```
+**Upstream patch**: https://github.com/nthiery/rst-to-ipynb/pull/4
``````




---

archive/issue_comments_365029.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -142,4 +142,8 @@\n     cumulative wall time: 64.9 seconds\n ```\n \n+To fix this, we upgrade the rst2ipynb package and apply a patch:\n+\n **Upstream patch**: https://github.com/nthiery/rst-to-ipynb/pull/4\n+\n+**Tarball**: https://pypi.python.org/packages/59/21/e8bc2432fb6b901d40728a8520401b04f3a8601c8f203790eea65b999793/rst2ipynb-0.2.2.tar.gz\n``````\n",
    "created_at": "2017-10-09T11:56:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365029",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -142,4 +142,8 @@
     cumulative wall time: 64.9 seconds
 ```
 
+To fix this, we upgrade the rst2ipynb package and apply a patch:
+
 **Upstream patch**: https://github.com/nthiery/rst-to-ipynb/pull/4
+
+**Tarball**: https://pypi.python.org/packages/59/21/e8bc2432fb6b901d40728a8520401b04f3a8601c8f203790eea65b999793/rst2ipynb-0.2.2.tar.gz
``````




---

archive/issue_comments_365030.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2017-10-09T11:56:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365030",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_365031.json:
```json
{
    "body": "Branch: **[u/jdemeyer/rst2ipynb_causes_doctest_failures_if_pandoc_is_not_installed](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rst2ipynb_causes_doctest_failures_if_pandoc_is_not_installed)**",
    "created_at": "2017-10-09T12:08:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365031",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/rst2ipynb_causes_doctest_failures_if_pandoc_is_not_installed](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rst2ipynb_causes_doctest_failures_if_pandoc_is_not_installed)**



---

archive/issue_comments_365032.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d\">4a31dbf</a></td><td><code>Upgrade rst2ipynb to version 0.2.2 and check pandoc dependency</code></td></tr></table>\n",
    "created_at": "2017-10-09T12:41:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365032",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'>Comment 6:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d">4a31dbf</a></td><td><code>Upgrade rst2ipynb to version 0.2.2 and check pandoc dependency</code></td></tr></table>




---

archive/issue_comments_365033.json:
```json
{
    "body": "Commit: **[4a31dbf](https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d)**",
    "created_at": "2017-10-09T12:41:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365033",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[4a31dbf](https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d)**



---

archive/issue_events_315069.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-10-09T12:41:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315069"
}
```



---

archive/issue_events_315070.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-10-09T15:39:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315070"
}
```



---

archive/issue_events_315071.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-10-09T15:39:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315071"
}
```



---

archive/issue_comments_365034.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nI like the fix you made, and the install now fails as it should. However because of the standard pip + sage failed install bloat, this means that the actual error is somewhere hidden in a bunch of noise so long that on my machine I actually have to scroll up to see the useful part of the error message. I would not have seen it if I was not reviewing this ticket and knew what to look for. So giving positive review since this fixes the blocker part of this ticket, but I am creating a follow up ticket to make the error messages more user friendly.\n\n```\n[rst2ipynb-0.2.2.p0] Installing collected packages: rst2ipynb\n[rst2ipynb-0.2.2.p0]   Running setup.py install for rst2ipynb: started\n[rst2ipynb-0.2.2.p0]     Running command /Applications/sagedev/local/bin/python2 -u -c \"import setuptools, tokenize;__file__='/private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" --no-user-cfg install --record /var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-zR3Z5F-record/install-record.txt --single-version-externally-managed --compile\n[rst2ipynb-0.2.2.p0]     running install\n[rst2ipynb-0.2.2.p0]     error: rst2ipynb requires the Haskell program 'pandoc'. You need to install it on your system.\n[rst2ipynb-0.2.2.p0]     Running setup.py install for rst2ipynb: finished with status 'error'\n[rst2ipynb-0.2.2.p0] Cleaning up...\n[rst2ipynb-0.2.2.p0]   Removing source in /private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build\n[rst2ipynb-0.2.2.p0] Command \"/Applications/sagedev/local/bin/python2 -u -c \"import setuptools, tokenize;__file__='/private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" --no-user-cfg install --record /var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-zR3Z5F-record/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/\n[rst2ipynb-0.2.2.p0] Exception information:\n[rst2ipynb-0.2.2.p0] Traceback (most recent call last):\n[rst2ipynb-0.2.2.p0]   File \"/Applications/sagedev/local/lib/python2.7/site-packages/pip/basecommand.py\", line 215, in main\n[rst2ipynb-0.2.2.p0]     status = self.run(options, args)\n[rst2ipynb-0.2.2.p0]   File \"/Applications/sagedev/local/lib/python2.7/site-packages/pip/commands/install.py\", line 342, in run\n[rst2ipynb-0.2.2.p0]     prefix=options.prefix_path,\n[rst2ipynb-0.2.2.p0]   File \"/Applications/sagedev/local/lib/python2.7/site-packages/pip/req/req_set.py\", line 784, in install\n[rst2ipynb-0.2.2.p0]     **kwargs\n[rst2ipynb-0.2.2.p0]   File \"/Applications/sagedev/local/lib/python2.7/site-packages/pip/req/req_install.py\", line 878, in install\n[rst2ipynb-0.2.2.p0]     spinner=spinner,\n[rst2ipynb-0.2.2.p0]   File \"/Applications/sagedev/local/lib/python2.7/site-packages/pip/utils/__init__.py\", line 707, in call_subprocess\n[rst2ipynb-0.2.2.p0]     % (command_desc, proc.returncode, cwd))\n[rst2ipynb-0.2.2.p0] InstallationError: Command \"/Applications/sagedev/local/bin/python2 -u -c \"import setuptools, tokenize;__file__='/private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\\r\\n', '\\n');f.close();exec(compile(code, __file__, 'exec'))\" --no-user-cfg install --record /var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-zR3Z5F-record/install-record.txt --single-version-externally-managed --compile\" failed with error code 1 in /private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/\n[rst2ipynb-0.2.2.p0] Error: installing with pip2 failed\n[rst2ipynb-0.2.2.p0] \n[rst2ipynb-0.2.2.p0] real\t0m3.995s\n[rst2ipynb-0.2.2.p0] user\t0m3.273s\n[rst2ipynb-0.2.2.p0] sys\t0m0.619s\n[rst2ipynb-0.2.2.p0] ************************************************************************\n[rst2ipynb-0.2.2.p0] Error installing package rst2ipynb-0.2.2.p0\n[rst2ipynb-0.2.2.p0] ************************************************************************\n[rst2ipynb-0.2.2.p0] Please email sage-devel (http://groups.google.com/group/sage-devel)\n[rst2ipynb-0.2.2.p0] explaining the problem and including the log file\n[rst2ipynb-0.2.2.p0]   /Applications/sagedev/logs/pkgs/rst2ipynb-0.2.2.p0.log\n[rst2ipynb-0.2.2.p0] Describe your computer, operating system, etc.\n[rst2ipynb-0.2.2.p0] If you want to try to fix the problem yourself, *don't* just cd to\n[rst2ipynb-0.2.2.p0] /Applications/sagedev/local/var/tmp/sage/build/rst2ipynb-0.2.2.p0 and type 'make' or whatever is appropriate.\n[rst2ipynb-0.2.2.p0] Instead, the following commands setup all environment variables\n[rst2ipynb-0.2.2.p0] correctly and load a subshell for you to debug the error:\n[rst2ipynb-0.2.2.p0]   (cd '/Applications/sagedev/local/var/tmp/sage/build/rst2ipynb-0.2.2.p0' && '/Applications/sagedev/sage' --sh)\n[rst2ipynb-0.2.2.p0] When you are done debugging, you can type \"exit\" to leave the subshell.\n[rst2ipynb-0.2.2.p0] ************************************************************************\nmake[1]: *** [/Applications/sagedev/local/var/lib/sage/installed/rst2ipynb-0.2.2.p0] Error 1\n\nreal\t0m4.407s\nuser\t0m3.504s\nsys\t0m0.751s\n***************************************************************\nError building Sage.\n\nThe following package(s) may have failed to build (not necessarily\nduring this run of 'make rst2ipynb'):\n\n* package: rst2ipynb-0.2.2.p0\n  log file: /Applications/sagedev/logs/pkgs/rst2ipynb-0.2.2.p0.log\n  build directory: /Applications/sagedev/local/var/tmp/sage/build/rst2ipynb-0.2.2.p0\n\nThe build directory may contain configuration files and other potentially\nhelpful information. WARNING: if you now run 'make' again, the build\ndirectory will, by default, be deleted. Set the environment variable\nSAGE_KEEP_BUILT_SPKGS to 'yes' to prevent this.\n\nmake: *** [rst2ipynb] Error 1\n```",
    "created_at": "2017-10-09T15:39:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365034",
    "user": "https://github.com/koffie"
}
```

<a id='comment:7'>Comment 7:</a>
I like the fix you made, and the install now fails as it should. However because of the standard pip + sage failed install bloat, this means that the actual error is somewhere hidden in a bunch of noise so long that on my machine I actually have to scroll up to see the useful part of the error message. I would not have seen it if I was not reviewing this ticket and knew what to look for. So giving positive review since this fixes the blocker part of this ticket, but I am creating a follow up ticket to make the error messages more user friendly.

```
[rst2ipynb-0.2.2.p0] Installing collected packages: rst2ipynb
[rst2ipynb-0.2.2.p0]   Running setup.py install for rst2ipynb: started
[rst2ipynb-0.2.2.p0]     Running command /Applications/sagedev/local/bin/python2 -u -c "import setuptools, tokenize;__file__='/private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\r\n', '\n');f.close();exec(compile(code, __file__, 'exec'))" --no-user-cfg install --record /var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-zR3Z5F-record/install-record.txt --single-version-externally-managed --compile
[rst2ipynb-0.2.2.p0]     running install
[rst2ipynb-0.2.2.p0]     error: rst2ipynb requires the Haskell program 'pandoc'. You need to install it on your system.
[rst2ipynb-0.2.2.p0]     Running setup.py install for rst2ipynb: finished with status 'error'
[rst2ipynb-0.2.2.p0] Cleaning up...
[rst2ipynb-0.2.2.p0]   Removing source in /private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build
[rst2ipynb-0.2.2.p0] Command "/Applications/sagedev/local/bin/python2 -u -c "import setuptools, tokenize;__file__='/private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\r\n', '\n');f.close();exec(compile(code, __file__, 'exec'))" --no-user-cfg install --record /var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-zR3Z5F-record/install-record.txt --single-version-externally-managed --compile" failed with error code 1 in /private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/
[rst2ipynb-0.2.2.p0] Exception information:
[rst2ipynb-0.2.2.p0] Traceback (most recent call last):
[rst2ipynb-0.2.2.p0]   File "/Applications/sagedev/local/lib/python2.7/site-packages/pip/basecommand.py", line 215, in main
[rst2ipynb-0.2.2.p0]     status = self.run(options, args)
[rst2ipynb-0.2.2.p0]   File "/Applications/sagedev/local/lib/python2.7/site-packages/pip/commands/install.py", line 342, in run
[rst2ipynb-0.2.2.p0]     prefix=options.prefix_path,
[rst2ipynb-0.2.2.p0]   File "/Applications/sagedev/local/lib/python2.7/site-packages/pip/req/req_set.py", line 784, in install
[rst2ipynb-0.2.2.p0]     **kwargs
[rst2ipynb-0.2.2.p0]   File "/Applications/sagedev/local/lib/python2.7/site-packages/pip/req/req_install.py", line 878, in install
[rst2ipynb-0.2.2.p0]     spinner=spinner,
[rst2ipynb-0.2.2.p0]   File "/Applications/sagedev/local/lib/python2.7/site-packages/pip/utils/__init__.py", line 707, in call_subprocess
[rst2ipynb-0.2.2.p0]     % (command_desc, proc.returncode, cwd))
[rst2ipynb-0.2.2.p0] InstallationError: Command "/Applications/sagedev/local/bin/python2 -u -c "import setuptools, tokenize;__file__='/private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/setup.py';f=getattr(tokenize, 'open', open)(__file__);code=f.read().replace('\r\n', '\n');f.close();exec(compile(code, __file__, 'exec'))" --no-user-cfg install --record /var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-zR3Z5F-record/install-record.txt --single-version-externally-managed --compile" failed with error code 1 in /private/var/folders/36/zx43_ll10r1dt47nqpbgmrs80000gn/T/pip-DMBGQ3-build/
[rst2ipynb-0.2.2.p0] Error: installing with pip2 failed
[rst2ipynb-0.2.2.p0] 
[rst2ipynb-0.2.2.p0] real	0m3.995s
[rst2ipynb-0.2.2.p0] user	0m3.273s
[rst2ipynb-0.2.2.p0] sys	0m0.619s
[rst2ipynb-0.2.2.p0] ************************************************************************
[rst2ipynb-0.2.2.p0] Error installing package rst2ipynb-0.2.2.p0
[rst2ipynb-0.2.2.p0] ************************************************************************
[rst2ipynb-0.2.2.p0] Please email sage-devel (http://groups.google.com/group/sage-devel)
[rst2ipynb-0.2.2.p0] explaining the problem and including the log file
[rst2ipynb-0.2.2.p0]   /Applications/sagedev/logs/pkgs/rst2ipynb-0.2.2.p0.log
[rst2ipynb-0.2.2.p0] Describe your computer, operating system, etc.
[rst2ipynb-0.2.2.p0] If you want to try to fix the problem yourself, *don't* just cd to
[rst2ipynb-0.2.2.p0] /Applications/sagedev/local/var/tmp/sage/build/rst2ipynb-0.2.2.p0 and type 'make' or whatever is appropriate.
[rst2ipynb-0.2.2.p0] Instead, the following commands setup all environment variables
[rst2ipynb-0.2.2.p0] correctly and load a subshell for you to debug the error:
[rst2ipynb-0.2.2.p0]   (cd '/Applications/sagedev/local/var/tmp/sage/build/rst2ipynb-0.2.2.p0' && '/Applications/sagedev/sage' --sh)
[rst2ipynb-0.2.2.p0] When you are done debugging, you can type "exit" to leave the subshell.
[rst2ipynb-0.2.2.p0] ************************************************************************
make[1]: *** [/Applications/sagedev/local/var/lib/sage/installed/rst2ipynb-0.2.2.p0] Error 1

real	0m4.407s
user	0m3.504s
sys	0m0.751s
***************************************************************
Error building Sage.

The following package(s) may have failed to build (not necessarily
during this run of 'make rst2ipynb'):

* package: rst2ipynb-0.2.2.p0
  log file: /Applications/sagedev/logs/pkgs/rst2ipynb-0.2.2.p0.log
  build directory: /Applications/sagedev/local/var/tmp/sage/build/rst2ipynb-0.2.2.p0

The build directory may contain configuration files and other potentially
helpful information. WARNING: if you now run 'make' again, the build
directory will, by default, be deleted. Set the environment variable
SAGE_KEEP_BUILT_SPKGS to 'yes' to prevent this.

make: *** [rst2ipynb] Error 1
```



---

archive/issue_comments_365035.json:
```json
{
    "body": "Reviewer: **Maarten Derickx**",
    "created_at": "2017-10-09T16:03:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365035",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Maarten Derickx**



---

archive/issue_comments_365036.json:
```json
{
    "body": "Changed reviewer from **Maarten Derickx** to none",
    "created_at": "2017-10-09T16:10:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365036",
    "user": "https://github.com/koffie"
}
```

Changed reviewer from **Maarten Derickx** to none



---

archive/issue_comments_365037.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nCreated #23999",
    "created_at": "2017-10-09T16:10:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365037",
    "user": "https://github.com/koffie"
}
```

<a id='comment:9'>Comment 9:</a>
Created #23999



---

archive/issue_comments_365038.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nReviewer name",
    "created_at": "2017-10-09T20:02:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365038",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'>Comment 10:</a>
Reviewer name



---

archive/issue_events_315072.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-09T20:02:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315072"
}
```



---

archive/issue_events_315073.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-09T20:02:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315073"
}
```



---

archive/issue_events_315074.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-10-09T21:12:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315074"
}
```



---

archive/issue_events_315075.json:
```json
{
    "actor": "https://github.com/koffie",
    "created_at": "2017-10-09T21:12:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315075"
}
```



---

archive/issue_comments_365039.json:
```json
{
    "body": "Reviewer: **Maarten Derickx**",
    "created_at": "2017-10-09T21:12:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365039",
    "user": "https://github.com/koffie"
}
```

Reviewer: **Maarten Derickx**



---

archive/issue_comments_365040.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2017-10-11T08:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365040",
    "user": "https://github.com/jdemeyer"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_events_315076.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-16T22:44:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315076"
}
```



---

archive/issue_events_315077.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "1472db0a6b967fcd8196bc841f63b47565c6a759",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-10-16T22:44:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23985#event-315077"
}
```



---

archive/issue_comments_365041.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/rst2ipynb_causes_doctest_failures_if_pandoc_is_not_installed](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rst2ipynb_causes_doctest_failures_if_pandoc_is_not_installed)** to **[4a31dbf](https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d)**",
    "created_at": "2017-10-16T22:44:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365041",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/rst2ipynb_causes_doctest_failures_if_pandoc_is_not_installed](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/rst2ipynb_causes_doctest_failures_if_pandoc_is_not_installed)** to **[4a31dbf](https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d)**



---

archive/issue_comments_365042.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nDoes it help at this stage if I do a new release of rst2ipynb?",
    "created_at": "2017-10-17T21:31:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365042",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:14'>Comment 14:</a>
Does it help at this stage if I do a new release of rst2ipynb?



---

archive/issue_comments_365043.json:
```json
{
    "body": "Changed commit from **[4a31dbf](https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d)** to none",
    "created_at": "2017-10-17T21:31:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365043",
    "user": "https://github.com/nthiery"
}
```

Changed commit from **[4a31dbf](https://github.com/sagemath/sagetrac-mirror/commit/4a31dbf28cc3b64beea87d09106f6824d5ea092d)** to none



---

archive/issue_comments_365044.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nFor Sage, a new version does not help since we already include the patch.\n\nI'll let you decide how important the patch is for non-Sage users who are doing `pip install rst2ipynb` without having `pandoc` installed. I would say: when in doubt, do make a release. It shouldn't take more than 10 minutes to actually do that.",
    "created_at": "2017-10-18T08:44:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365044",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'>Comment 15:</a>
For Sage, a new version does not help since we already include the patch.

I'll let you decide how important the patch is for non-Sage users who are doing `pip install rst2ipynb` without having `pandoc` installed. I would say: when in doubt, do make a release. It shouldn't take more than 10 minutes to actually do that.



---

archive/issue_comments_365045.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nrst2ipynb 0.3.3 is out, including another pull request improving parsing of python continuation prompts. So worth a release.",
    "created_at": "2017-10-18T15:43:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365045",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:16'>Comment 16:</a>
rst2ipynb 0.3.3 is out, including another pull request improving parsing of python continuation prompts. So worth a release.



---

archive/issue_comments_365046.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2017-10-18T15:43:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23985#issuecomment-365046",
    "user": "https://github.com/nthiery"
}
```

Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**
