# Issue 23729: py3: some care for division in graphs + various improvements

archive/issues_023492.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nas another step to py3\n\nCC:  @tscrim @jdemeyer @jhpalmieri\n\nComponent: **python3**\n\nKeywords: **division**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nBranch: **[`4fddb01`](https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402)**\n\nReviewer: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23729_\n\n",
    "closed_at": "2017-09-10T11:57:23Z",
    "created_at": "2017-08-26T18:31:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: some care for division in graphs + various improvements",
    "type": "issue",
    "updated_at": "2018-02-23T13:35:30Z",
    "url": "https://github.com/sagemath/sage/issues/23729",
    "user": "https://github.com/fchapoton"
}
```
<div id="comment:0"></div>

as another step to py3

CC:  @tscrim @jdemeyer @jhpalmieri

Component: **python3**

Keywords: **division**

Author: **Frédéric Chapoton**

Branch: **[`4fddb01`](https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402)**

Reviewer: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/23729_





---

archive/issue_events_327035.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-26T18:31:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327035"
}
```



---

archive/issue_events_327036.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-26T18:31:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "0000b0",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327036"
}
```



---

archive/issue_events_327037.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-26T18:31:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327037"
}
```



---

archive/issue_events_327038.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-26T18:31:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327038"
}
```



---

archive/issue_events_327039.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-26T18:32:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327039"
}
```



---

archive/issue_comments_357864.json:
```json
{
    "body": "Commit: **[`14c4058`](https://github.com/sagemath/sagetrac-mirror/commit/14c4058b02508f00f141cef1d6379a26ef512912)**",
    "created_at": "2017-08-26T18:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357864",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`14c4058`](https://github.com/sagemath/sagetrac-mirror/commit/14c4058b02508f00f141cef1d6379a26ef512912)**



---

archive/issue_comments_357865.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14c4058b02508f00f141cef1d6379a26ef512912\"><code>14c4058</code></a></td><td><code>some future divisions in graphs</code></td></tr></table>\n",
    "created_at": "2017-08-26T18:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357865",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14c4058b02508f00f141cef1d6379a26ef512912"><code>14c4058</code></a></td><td><code>some future divisions in graphs</code></td></tr></table>




---

archive/issue_comments_357866.json:
```json
{
    "body": "Branch: **[u/chapoton/23729](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23729)**",
    "created_at": "2017-08-26T18:32:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357866",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/23729](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23729)**



---

archive/issue_comments_357867.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nWhy this change?\n\n```diff\n-class CoercionException(TypeError):\n+class CoercionException(TypeError, BaseException):\n```\n`TypeError` is a subclass of `BaseException`, so I don't understand why it is needed/wanted.",
    "created_at": "2017-08-27T05:25:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357867",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:2" align="right">comment:2</div>

Why this change?

```diff
-class CoercionException(TypeError):
+class CoercionException(TypeError, BaseException):
```
`TypeError` is a subclass of `BaseException`, so I don't understand why it is needed/wanted.



---

archive/issue_comments_357868.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nbecause this line triggers the warning\n\n```\ncatching classes that don't inherit from BaseException is not allowed in  3.x\n```\nwhen the tests are run with \"python -3 sage-runtests\"\n\nare you sure of what you say ?\n\n```\nsage: isinstance(TypeError,Exception)\nFalse\nsage: isinstance(TypeError,BaseException)\nFalse\n```",
    "created_at": "2017-08-27T06:10:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357868",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

because this line triggers the warning

```
catching classes that don't inherit from BaseException is not allowed in  3.x
```
when the tests are run with "python -3 sage-runtests"

are you sure of what you say ?

```
sage: isinstance(TypeError,Exception)
False
sage: isinstance(TypeError,BaseException)
False
```



---

archive/issue_comments_357869.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nYour tests are incorrect because `TypeError` is a class, not an instance of a class:\n\n```\nsage: type(TypeError)\n<type 'type'>\n```\nCompare with\n\n```\nsage: TypeError.__mro__\n(<type 'exceptions.TypeError'>,\n <type 'exceptions.StandardError'>,\n <type 'exceptions.Exception'>,\n <type 'exceptions.BaseException'>,\n <type 'object'>)\nsage: e = TypeError(\"foo\")\nsage: isinstance(e, BaseException)\nTrue\nsage: isinstance(e, Exception)\nTrue\n```",
    "created_at": "2017-08-27T06:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357869",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:4" align="right">comment:4</div>

Your tests are incorrect because `TypeError` is a class, not an instance of a class:

```
sage: type(TypeError)
<type 'type'>
```
Compare with

```
sage: TypeError.__mro__
(<type 'exceptions.TypeError'>,
 <type 'exceptions.StandardError'>,
 <type 'exceptions.Exception'>,
 <type 'exceptions.BaseException'>,
 <type 'object'>)
sage: e = TypeError("foo")
sage: isinstance(e, BaseException)
True
sage: isinstance(e, Exception)
True
```



---

archive/issue_comments_357870.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOk, I stand corrected. But there is a warning:\n\n```\n      File \"/home/chapoton/sage/local/lib/python2.7/site-packages/sage/categories/pushout.py\", line 3992, in pushout\n        except CoercionException:\n    :\n    DeprecationWarning: catching classes that don't inherit from BaseException is not allowed in 3.x\n```\nSo, why ?",
    "created_at": "2017-08-27T06:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357870",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

Ok, I stand corrected. But there is a warning:

```
      File "/home/chapoton/sage/local/lib/python2.7/site-packages/sage/categories/pushout.py", line 3992, in pushout
        except CoercionException:
    :
    DeprecationWarning: catching classes that don't inherit from BaseException is not allowed in 3.x
```
So, why ?



---

archive/issue_comments_357871.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nindeed\n\n```\nsage: CoercionException.__mro__\n\n(<class 'sage.structure.coerce_exceptions.CoercionException'>,\n <type 'exceptions.TypeError'>,\n <type 'exceptions.StandardError'>,\n <type 'exceptions.Exception'>,\n <type 'exceptions.BaseException'>,\n <type 'object'>)\n```\nThe only difference is that it is a class and not a type.",
    "created_at": "2017-08-27T06:23:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357871",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

indeed

```
sage: CoercionException.__mro__

(<class 'sage.structure.coerce_exceptions.CoercionException'>,
 <type 'exceptions.TypeError'>,
 <type 'exceptions.StandardError'>,
 <type 'exceptions.Exception'>,
 <type 'exceptions.BaseException'>,
 <type 'object'>)
```
The only difference is that it is a class and not a type.



---

archive/issue_comments_357872.json:
```json
{
    "body": "Changed commit from **[`14c4058`](https://github.com/sagemath/sagetrac-mirror/commit/14c4058b02508f00f141cef1d6379a26ef512912)** to **[`4fddb01`](https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402)**",
    "created_at": "2017-08-27T06:25:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357872",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`14c4058`](https://github.com/sagemath/sagetrac-mirror/commit/14c4058b02508f00f141cef1d6379a26ef512912)** to **[`4fddb01`](https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402)**



---

archive/issue_comments_357873.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402\"><code>4fddb01</code></a></td><td><code>some future divisions in graphs</code></td></tr></table>\n",
    "created_at": "2017-08-27T06:25:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357873",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402"><code>4fddb01</code></a></td><td><code>some future divisions in graphs</code></td></tr></table>




---

archive/issue_comments_357874.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAh, that is a good observation and is likely the difference. I think they just were not quite smart enough with how they raise the warnings. IIRC, your Python3 branch is not far enough to check that this works in Python3, correct?",
    "created_at": "2017-08-27T06:26:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357874",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:8" align="right">comment:8</div>

Ah, that is a good observation and is likely the difference. I think they just were not quite smart enough with how they raise the warnings. IIRC, your Python3 branch is not far enough to check that this works in Python3, correct?



---

archive/issue_comments_357875.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nyes, yes. Anyway, I have undone this modification now.",
    "created_at": "2017-08-27T06:26:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357875",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:9" align="right">comment:9</div>

yes, yes. Anyway, I have undone this modification now.



---

archive/issue_events_327040.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-08-27T06:28:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327040"
}
```



---

archive/issue_events_327041.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-08-27T06:28:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327041"
}
```



---

archive/issue_comments_357876.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2017-08-27T06:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357876",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_357877.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThanks. LGTM.",
    "created_at": "2017-08-27T06:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357877",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

Thanks. LGTM.



---

archive/issue_comments_357878.json:
```json
{
    "body": "Changed branch from **[u/chapoton/23729](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23729)** to **[`4fddb01`](https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402)**",
    "created_at": "2017-09-10T11:57:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357878",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/23729](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/23729)** to **[`4fddb01`](https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402)**



---

archive/issue_events_327042.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-10T11:57:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327042"
}
```



---

archive/issue_events_327043.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "fd1e9b4baa14072a64604494325bbd177125e527",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-09-10T11:57:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23729#event-327043"
}
```



---

archive/issue_comments_357879.json:
```json
{
    "body": "Changed keywords from none to **division**",
    "created_at": "2018-02-23T13:35:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357879",
    "user": "https://github.com/embray"
}
```

Changed keywords from none to **division**



---

archive/issue_comments_357880.json:
```json
{
    "body": "Changed commit from **[`4fddb01`](https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402)** to none",
    "created_at": "2018-02-23T13:35:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23729",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23729#issuecomment-357880",
    "user": "https://github.com/embray"
}
```

Changed commit from **[`4fddb01`](https://github.com/sagemath/sagetrac-mirror/commit/4fddb017fa9e8c5693cd8b24f7ff1de8820e4402)** to none
