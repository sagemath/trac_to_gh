# Issue 23946: Exhaust over Weil polynomials

archive/issues_023709.json:
```json
{
    "body": "I have reasonably stable code (mostly in C, depending on FLINT) for exhausting over Weil polynomials:\n\nhttps://github.com/kedlaya/root-unitary\n\nThe goal of this ticket is to incorporate this code into Sage in some fashion.\n\nDepends on #24016\n\n**CC:**  @roed314\n\n**Keywords:** Weil polynomials, sd91\n\n**Branch/Commit:** [e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f](https://github.com/sagemath/sagetrac-mirror/commit/e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f)\n\n**Reviewer:** David Roe\n\n**Author:** Kiran Kedlaya\n\nIssue created by migration from https://trac.sagemath.org/ticket/23946\n\n",
    "closed_at": "2020-01-05T15:47:17Z",
    "created_at": "2017-09-30T20:23:32Z",
    "labels": [
        "component: number theory",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.1",
    "title": "Exhaust over Weil polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/23946",
    "user": "https://github.com/kedlaya"
}
```
I have reasonably stable code (mostly in C, depending on FLINT) for exhausting over Weil polynomials:

https://github.com/kedlaya/root-unitary

The goal of this ticket is to incorporate this code into Sage in some fashion.

Depends on #24016

**CC:**  @roed314

**Keywords:** Weil polynomials, sd91

**Branch/Commit:** [e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f](https://github.com/sagemath/sagetrac-mirror/commit/e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f)

**Reviewer:** David Roe

**Author:** Kiran Kedlaya

Issue created by migration from https://trac.sagemath.org/ticket/23946





---

archive/issue_comments_364006.json:
```json
{
    "body": "<a id='comment:1'></a>\nStatus update: I've pushed many recent changes to the branch `repackage_for_sage` of the Github repo. In particular, I have been working to make the call syntax much more transparent; for instance, to compute the Weil polynomials corresponding to abelian varieties of dimension `g` over the finite field of order `q`, one can now use standard Python iterator syntax:\n\n```\nsage: wp = WeilPolynomials(2*g, q)\nsage: for i in wp:\n...\n```\nSome to-do items: check that all my old test scripts still work; write more tests; add more documentation; add more input sanitization.\n\nIn the meantime, I'd appreciate some feedback about where this might belong in Sage.",
    "created_at": "2017-10-12T05:47:29Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364006",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:1'></a>
Status update: I've pushed many recent changes to the branch `repackage_for_sage` of the Github repo. In particular, I have been working to make the call syntax much more transparent; for instance, to compute the Weil polynomials corresponding to abelian varieties of dimension `g` over the finite field of order `q`, one can now use standard Python iterator syntax:

```
sage: wp = WeilPolynomials(2*g, q)
sage: for i in wp:
...
```
Some to-do items: check that all my old test scripts still work; write more tests; add more documentation; add more input sanitization.

In the meantime, I'd appreciate some feedback about where this might belong in Sage.



---

archive/issue_comments_364007.json:
```json
{
    "body": "**Dependencies:** #24016",
    "created_at": "2017-10-12T05:47:29Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364007",
    "user": "https://github.com/kedlaya"
}
```

**Dependencies:** #24016



---

archive/issue_comments_364008.json:
```json
{
    "body": "<a id='comment:2'></a>\nReplying to [@kedlaya](#comment%3A1):\n> In the meantime, I'd appreciate some feedback about where this might belong in Sage.\n\nFirst of all, your github repo contains both C code and `.sage` files. Are the `.sage` files considered to be part of your package or are they really only use cases/examples/tests/documentation?\n\n\nThere are two possibilities, each with its advantages and disadvantages:\n\n(A) Make it an external (presumably optional) package and interface it from Sage.\n\n(B) Make it actually a part of Sage itself.\n\nAdvantages of (A) are that you keep control of the package: you can easily change the package at will (with (B) every change would need to go through the Sage Trac) and you don't need to care about Sage coding standards. Also important: with (A) your package could be used without Sage. With (B), there might be more initial work needed to get it into Sage but then it might be less work to maintain.",
    "created_at": "2017-10-12T12:31:23Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364008",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
Replying to [@kedlaya](#comment%3A1):
> In the meantime, I'd appreciate some feedback about where this might belong in Sage.

First of all, your github repo contains both C code and `.sage` files. Are the `.sage` files considered to be part of your package or are they really only use cases/examples/tests/documentation?


There are two possibilities, each with its advantages and disadvantages:

(A) Make it an external (presumably optional) package and interface it from Sage.

(B) Make it actually a part of Sage itself.

Advantages of (A) are that you keep control of the package: you can easily change the package at will (with (B) every change would need to go through the Sage Trac) and you don't need to care about Sage coding standards. Also important: with (A) your package could be used without Sage. With (B), there might be more initial work needed to get it into Sage but then it might be less work to maintain.



---

archive/issue_comments_364009.json:
```json
{
    "body": "<a id='comment:3'></a>\nI just merged a pull request in from another branch, which has the effect of significantly reconfiguring the file structure. In particular, there are no longer any `.sage` files in the main directory; the ones that exist are all in subdirectories and are indeed examples/tests.\n\nThe main code base now consists of two `.c` files (and their `.h` headers) and one `.pyx` file. I still don't have any sort of independent build structure set up; moreover, the `.pyx` file is more than just a simple wrapper, it is where the parallelism is currently implemented. So at the moment there is really no way to use the code without Sage, and I don't particularly intend to work on making that possible. (Exception: if someone wants to use the code from some other platform like Julia, I'd be willing to cooperate with that.)",
    "created_at": "2017-10-18T04:13:22Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364009",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:3'></a>
I just merged a pull request in from another branch, which has the effect of significantly reconfiguring the file structure. In particular, there are no longer any `.sage` files in the main directory; the ones that exist are all in subdirectories and are indeed examples/tests.

The main code base now consists of two `.c` files (and their `.h` headers) and one `.pyx` file. I still don't have any sort of independent build structure set up; moreover, the `.pyx` file is more than just a simple wrapper, it is where the parallelism is currently implemented. So at the moment there is really no way to use the code without Sage, and I don't particularly intend to work on making that possible. (Exception: if someone wants to use the code from some other platform like Julia, I'd be willing to cooperate with that.)



---

archive/issue_comments_364010.json:
```json
{
    "body": "<a id='comment:4'></a>\nI think that the code is stable enough that we should just add it to Sage.  Maybe create a folder `sage/rings/polynomial/weil/` and put them in there?",
    "created_at": "2017-10-18T21:44:06Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364010",
    "user": "https://github.com/roed314"
}
```

<a id='comment:4'></a>
I think that the code is stable enough that we should just add it to Sage.  Maybe create a folder `sage/rings/polynomial/weil/` and put them in there?



---

archive/issue_comments_364011.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [@roed314](#comment%3A4):\n> I think that the code is stable enough that we should just add it to Sage.  Maybe create a folder `sage/rings/polynomial/weil/` and put them in there?\n\nDo you mean put everything in there? Or put the Cython in `sage/rings/polynomials/weil_polynomials.pyx` and the C files in `sage/rings/polynomial/weil`?\n\nAlso, if someone can point me to some guidance about a module to the Sage library (e.g., how to format `__init__.py` and `all.py` and the like to make the new code discoverable), that would be helpful.",
    "created_at": "2017-10-23T17:55:37Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364011",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:5'></a>
Replying to [@roed314](#comment%3A4):
> I think that the code is stable enough that we should just add it to Sage.  Maybe create a folder `sage/rings/polynomial/weil/` and put them in there?

Do you mean put everything in there? Or put the Cython in `sage/rings/polynomials/weil_polynomials.pyx` and the C files in `sage/rings/polynomial/weil`?

Also, if someone can point me to some guidance about a module to the Sage library (e.g., how to format `__init__.py` and `all.py` and the like to make the new code discoverable), that would be helpful.



---

archive/issue_comments_364012.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [@kedlaya](#comment%3A5):\n> Replying to [@roed314](#comment%3A4):\n> > I think that the code is stable enough that we should just add it to Sage.  Maybe create a folder `sage/rings/polynomial/weil/` and put them in there?\n\n> \n> Do you mean put everything in there? Or put the Cython in `sage/rings/polynomials/weil_polynomials.pyx` and the C files in `sage/rings/polynomial/weil`?\n\nI meant putting everything in there.  We should also talk about the best way for a user to access these methods; perhaps a method `weil_polynomials` on `ZZ[x]` and `QQ[x]` that returns your iterator?\n\n> Also, if someone can point me to some guidance about a module to the Sage library (e.g., how to format `__init__.py` and `all.py` and the like to make the new code discoverable), that would be helpful.\n\nSee http://doc.sagemath.org/html/en/developer/coding_basics.html#files-and-directory-structure for some details.  You'll also need to add lines to `src/module_list.py` for each extension module.",
    "created_at": "2017-10-25T16:09:18Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364012",
    "user": "https://github.com/roed314"
}
```

<a id='comment:6'></a>
Replying to [@kedlaya](#comment%3A5):
> Replying to [@roed314](#comment%3A4):
> > I think that the code is stable enough that we should just add it to Sage.  Maybe create a folder `sage/rings/polynomial/weil/` and put them in there?

> 
> Do you mean put everything in there? Or put the Cython in `sage/rings/polynomials/weil_polynomials.pyx` and the C files in `sage/rings/polynomial/weil`?

I meant putting everything in there.  We should also talk about the best way for a user to access these methods; perhaps a method `weil_polynomials` on `ZZ[x]` and `QQ[x]` that returns your iterator?

> Also, if someone can point me to some guidance about a module to the Sage library (e.g., how to format `__init__.py` and `all.py` and the like to make the new code discoverable), that would be helpful.

See http://doc.sagemath.org/html/en/developer/coding_basics.html#files-and-directory-structure for some details.  You'll also need to add lines to `src/module_list.py` for each extension module.



---

archive/issue_comments_364013.json:
```json
{
    "body": "**Branch:** [u/kedlaya/exhaust_over_weil_polynomials](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/exhaust_over_weil_polynomials)",
    "created_at": "2017-11-07T05:18:26Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364013",
    "user": "https://github.com/kedlaya"
}
```

**Branch:** [u/kedlaya/exhaust_over_weil_polynomials](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/exhaust_over_weil_polynomials)



---

archive/issue_comments_364014.json:
```json
{
    "body": "<a id='comment:8'></a>\nPushed some partial progress, but this doesn't compile yet.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da3d4834070e9cd38206dd0f467c98aa5c483376\">da3d483</a></td><td><code>Add directory src/sage/rings/polynomial/weil/</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d12b0ea0aa53cbf558e6ac873414778dd12796a4\">d12b0ea</a></td><td><code>Update module list, all.py</code></td></tr></table>\n",
    "created_at": "2017-11-07T05:19:45Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364014",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:8'></a>
Pushed some partial progress, but this doesn't compile yet.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da3d4834070e9cd38206dd0f467c98aa5c483376">da3d483</a></td><td><code>Add directory src/sage/rings/polynomial/weil/</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d12b0ea0aa53cbf558e6ac873414778dd12796a4">d12b0ea</a></td><td><code>Update module list, all.py</code></td></tr></table>




---

archive/issue_comments_364015.json:
```json
{
    "body": "**Commit:** [d12b0ea0aa53cbf558e6ac873414778dd12796a4](https://github.com/sagemath/sagetrac-mirror/commit/d12b0ea0aa53cbf558e6ac873414778dd12796a4)",
    "created_at": "2017-11-07T05:19:45Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364015",
    "user": "https://github.com/kedlaya"
}
```

**Commit:** [d12b0ea0aa53cbf558e6ac873414778dd12796a4](https://github.com/sagemath/sagetrac-mirror/commit/d12b0ea0aa53cbf558e6ac873414778dd12796a4)



---

archive/issue_comments_364016.json:
```json
{
    "body": "<a id='comment:9'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da3d4834070e9cd38206dd0f467c98aa5c483376\">da3d483</a></td><td><code>Add directory src/sage/rings/polynomial/weil/</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d12b0ea0aa53cbf558e6ac873414778dd12796a4\">d12b0ea</a></td><td><code>Update module list, all.py</code></td></tr></table>\n",
    "created_at": "2019-12-14T05:07:22Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364016",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:9'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da3d4834070e9cd38206dd0f467c98aa5c483376">da3d483</a></td><td><code>Add directory src/sage/rings/polynomial/weil/</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d12b0ea0aa53cbf558e6ac873414778dd12796a4">d12b0ea</a></td><td><code>Update module list, all.py</code></td></tr></table>




---

archive/issue_comments_364017.json:
```json
{
    "body": "**Changing branch** from \"[u/kedlaya/exhaust_over_weil_polynomials](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/exhaust_over_weil_polynomials)\" to \"\".",
    "created_at": "2019-12-14T05:08:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364017",
    "user": "https://github.com/kedlaya"
}
```

**Changing branch** from "[u/kedlaya/exhaust_over_weil_polynomials](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/exhaust_over_weil_polynomials)" to "".



---

archive/issue_comments_364018.json:
```json
{
    "body": "**Changing commit** from \"[d12b0ea0aa53cbf558e6ac873414778dd12796a4](https://github.com/sagemath/sagetrac-mirror/commit/d12b0ea0aa53cbf558e6ac873414778dd12796a4)\" to \"\".",
    "created_at": "2019-12-14T05:08:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364018",
    "user": "https://github.com/kedlaya"
}
```

**Changing commit** from "[d12b0ea0aa53cbf558e6ac873414778dd12796a4](https://github.com/sagemath/sagetrac-mirror/commit/d12b0ea0aa53cbf558e6ac873414778dd12796a4)" to "".



---

archive/issue_comments_364019.json:
```json
{
    "body": "**Branch:** [u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)",
    "created_at": "2019-12-14T05:08:57Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364019",
    "user": "https://github.com/kedlaya"
}
```

**Branch:** [u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)



---

archive/issue_comments_364020.json:
```json
{
    "body": "<a id='comment:12'></a>\nOK, here is a new branch which seems to compile. Still a lot of polishing to be done, but it should be possible to at least play with the code now.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2bfaf04113158c27f171fc302fc74852a2d41560\">2bfaf04</a></td><td><code>Initial commit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7e1e2aba0711734b95318254822eee0a6ba5b09\">d7e1e2a</a></td><td><code>Succesful compilation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a62e66aa58ccd7e82740078ce2c71d62a10ea52\">2a62e66</a></td><td><code>Bug fix from upstream (incorrect handling of leading coeffs)</code></td></tr></table>\n",
    "created_at": "2019-12-14T05:09:36Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364020",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:12'></a>
OK, here is a new branch which seems to compile. Still a lot of polishing to be done, but it should be possible to at least play with the code now.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2bfaf04113158c27f171fc302fc74852a2d41560">2bfaf04</a></td><td><code>Initial commit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7e1e2aba0711734b95318254822eee0a6ba5b09">d7e1e2a</a></td><td><code>Succesful compilation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a62e66aa58ccd7e82740078ce2c71d62a10ea52">2a62e66</a></td><td><code>Bug fix from upstream (incorrect handling of leading coeffs)</code></td></tr></table>




---

archive/issue_comments_364021.json:
```json
{
    "body": "**Commit:** [2a62e66aa58ccd7e82740078ce2c71d62a10ea52](https://github.com/sagemath/sagetrac-mirror/commit/2a62e66aa58ccd7e82740078ce2c71d62a10ea52)",
    "created_at": "2019-12-14T05:09:36Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364021",
    "user": "https://github.com/kedlaya"
}
```

**Commit:** [2a62e66aa58ccd7e82740078ce2c71d62a10ea52](https://github.com/sagemath/sagetrac-mirror/commit/2a62e66aa58ccd7e82740078ce2c71d62a10ea52)



---

archive/issue_comments_364022.json:
```json
{
    "body": "<a id='comment:13'></a>\ndoes not work for me:\n\n```\nsage: from sage.rings.polynomial.weil.weil_polynomials import *\n---------------------------------------------------------------------------\nImportError                               Traceback (most recent call last)\n<ipython-input-1-5b4f8184ba57> in <module>()\n----> 1 from sage.rings.polynomial.weil.weil_polynomials import *\n\nImportError: /home/chapoton/sage3/local/lib/python3.7/site-packages/sage/rings/polynomial/weil/weil_polynomials.cpython-37m-x86_64-linux-gnu.so: undefined symbol: GOMP_loop_nonmonotonic_dynamic_start\n```\n\nand there are missing empty lines in the doc after lines ending with `::`",
    "created_at": "2019-12-14T20:30:45Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364022",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
does not work for me:

```
sage: from sage.rings.polynomial.weil.weil_polynomials import *
---------------------------------------------------------------------------
ImportError                               Traceback (most recent call last)
<ipython-input-1-5b4f8184ba57> in <module>()
----> 1 from sage.rings.polynomial.weil.weil_polynomials import *

ImportError: /home/chapoton/sage3/local/lib/python3.7/site-packages/sage/rings/polynomial/weil/weil_polynomials.cpython-37m-x86_64-linux-gnu.so: undefined symbol: GOMP_loop_nonmonotonic_dynamic_start
```

and there are missing empty lines in the doc after lines ending with `::`



---

archive/issue_comments_364023.json:
```json
{
    "body": "<a id='comment:14'></a>\nThat is the code looking for OpenMP (which is optional, since we don't ship it with Sage). Does it help if you take out the compiler directive in line 2 of `sage/rings/polynomial/weil/weil_polynomials.pyx`?\n\nThe docstrings need a fair bit of work to get to 100% doctest coverage, let alone proper formatting. I can of course work on that independently.",
    "created_at": "2019-12-14T21:02:00Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364023",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:14'></a>
That is the code looking for OpenMP (which is optional, since we don't ship it with Sage). Does it help if you take out the compiler directive in line 2 of `sage/rings/polynomial/weil/weil_polynomials.pyx`?

The docstrings need a fair bit of work to get to 100% doctest coverage, let alone proper formatting. I can of course work on that independently.



---

archive/issue_events_212748.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2019-12-14T21:02:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212748"
}
```



---

archive/issue_events_212749.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2019-12-14T21:02:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212749"
}
```



---

archive/issue_comments_364024.json:
```json
{
    "body": "<a id='comment:15'></a>\nyes, removing the distutils directive make it work",
    "created_at": "2019-12-14T21:08:13Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364024",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:15'></a>
yes, removing the distutils directive make it work



---

archive/issue_comments_364025.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd2f537559a8c43af7f5b622f5275c3253caab80\">cd2f537</a></td><td><code>Eliminate compiler warnings about return from a void function</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1438c238cc5ab5aca7b0f558ff0261f7112ca9ec\">1438c23</a></td><td><code>Suppress OpenMP, add doctests</code></td></tr></table>\n",
    "created_at": "2019-12-14T22:51:05Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364025",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd2f537559a8c43af7f5b622f5275c3253caab80">cd2f537</a></td><td><code>Eliminate compiler warnings about return from a void function</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1438c238cc5ab5aca7b0f558ff0261f7112ca9ec">1438c23</a></td><td><code>Suppress OpenMP, add doctests</code></td></tr></table>




---

archive/issue_comments_364026.json:
```json
{
    "body": "**Changing commit** from \"[2a62e66aa58ccd7e82740078ce2c71d62a10ea52](https://github.com/sagemath/sagetrac-mirror/commit/2a62e66aa58ccd7e82740078ce2c71d62a10ea52)\" to \"[1438c238cc5ab5aca7b0f558ff0261f7112ca9ec](https://github.com/sagemath/sagetrac-mirror/commit/1438c238cc5ab5aca7b0f558ff0261f7112ca9ec)\".",
    "created_at": "2019-12-14T22:51:05Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364026",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2a62e66aa58ccd7e82740078ce2c71d62a10ea52](https://github.com/sagemath/sagetrac-mirror/commit/2a62e66aa58ccd7e82740078ce2c71d62a10ea52)" to "[1438c238cc5ab5aca7b0f558ff0261f7112ca9ec](https://github.com/sagemath/sagetrac-mirror/commit/1438c238cc5ab5aca7b0f558ff0261f7112ca9ec)".



---

archive/issue_comments_364027.json:
```json
{
    "body": "<a id='comment:17'></a>\nIn addition to suppressing OpenMP, I also added doctests to get to 100% coverage.\n\nCc'ing roed, who is somewhat familiar to the code.",
    "created_at": "2019-12-14T22:52:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364027",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:17'></a>
In addition to suppressing OpenMP, I also added doctests to get to 100% coverage.

Cc'ing roed, who is somewhat familiar to the code.



---

archive/issue_comments_364028.json:
```json
{
    "body": "<a id='comment:18'></a>\nplease remove the \"next\" method.\n\nand in the test of `__next__`, use next(it) to call the iterator.",
    "created_at": "2019-12-15T12:44:10Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364028",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>
please remove the "next" method.

and in the test of `__next__`, use next(it) to call the iterator.



---

archive/issue_comments_364029.json:
```json
{
    "body": "**Changing commit** from \"[1438c238cc5ab5aca7b0f558ff0261f7112ca9ec](https://github.com/sagemath/sagetrac-mirror/commit/1438c238cc5ab5aca7b0f558ff0261f7112ca9ec)\" to \"[7516836408314c97f176d62d677b7d2d924e861b](https://github.com/sagemath/sagetrac-mirror/commit/7516836408314c97f176d62d677b7d2d924e861b)\".",
    "created_at": "2019-12-15T17:39:35Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364029",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[1438c238cc5ab5aca7b0f558ff0261f7112ca9ec](https://github.com/sagemath/sagetrac-mirror/commit/1438c238cc5ab5aca7b0f558ff0261f7112ca9ec)" to "[7516836408314c97f176d62d677b7d2d924e861b](https://github.com/sagemath/sagetrac-mirror/commit/7516836408314c97f176d62d677b7d2d924e861b)".



---

archive/issue_comments_364030.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7516836408314c97f176d62d677b7d2d924e861b\">7516836</a></td><td><code>Removed \"next\" method</code></td></tr></table>\n",
    "created_at": "2019-12-15T17:39:35Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364030",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7516836408314c97f176d62d677b7d2d924e861b">7516836</a></td><td><code>Removed "next" method</code></td></tr></table>




---

archive/issue_comments_364031.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a6feb9edc7b3621738f1dac42ea0dbeea7282c3\">1a6feb9</a></td><td><code>Merge edits from Edgar Costa</code></td></tr></table>\n",
    "created_at": "2019-12-15T22:51:27Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364031",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a6feb9edc7b3621738f1dac42ea0dbeea7282c3">1a6feb9</a></td><td><code>Merge edits from Edgar Costa</code></td></tr></table>




---

archive/issue_comments_364032.json:
```json
{
    "body": "**Changing commit** from \"[7516836408314c97f176d62d677b7d2d924e861b](https://github.com/sagemath/sagetrac-mirror/commit/7516836408314c97f176d62d677b7d2d924e861b)\" to \"[1a6feb9edc7b3621738f1dac42ea0dbeea7282c3](https://github.com/sagemath/sagetrac-mirror/commit/1a6feb9edc7b3621738f1dac42ea0dbeea7282c3)\".",
    "created_at": "2019-12-15T22:51:27Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364032",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7516836408314c97f176d62d677b7d2d924e861b](https://github.com/sagemath/sagetrac-mirror/commit/7516836408314c97f176d62d677b7d2d924e861b)" to "[1a6feb9edc7b3621738f1dac42ea0dbeea7282c3](https://github.com/sagemath/sagetrac-mirror/commit/1a6feb9edc7b3621738f1dac42ea0dbeea7282c3)".



---

archive/issue_comments_364033.json:
```json
{
    "body": "<a id='comment:21'></a>\nneeds review ?",
    "created_at": "2019-12-17T19:57:22Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364033",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>
needs review ?



---

archive/issue_comments_364034.json:
```json
{
    "body": "<a id='comment:22'></a>\nStanding by for some feedback from roed first.",
    "created_at": "2019-12-17T20:40:30Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364034",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:22'></a>
Standing by for some feedback from roed first.



---

archive/issue_comments_364035.json:
```json
{
    "body": "**Changing branch** from \"[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)\" to \"[u/roed/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/weilpoly_search)\".",
    "created_at": "2019-12-18T19:01:58Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364035",
    "user": "https://github.com/roed314"
}
```

**Changing branch** from "[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)" to "[u/roed/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/weilpoly_search)".



---

archive/issue_comments_364036.json:
```json
{
    "body": "**Changing commit** from \"[1a6feb9edc7b3621738f1dac42ea0dbeea7282c3](https://github.com/sagemath/sagetrac-mirror/commit/1a6feb9edc7b3621738f1dac42ea0dbeea7282c3)\" to \"[c1be1fbff4f97dcd107be3e92c6e3b676afdbf00](https://github.com/sagemath/sagetrac-mirror/commit/c1be1fbff4f97dcd107be3e92c6e3b676afdbf00)\".",
    "created_at": "2019-12-18T19:03:02Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364036",
    "user": "https://github.com/roed314"
}
```

**Changing commit** from "[1a6feb9edc7b3621738f1dac42ea0dbeea7282c3](https://github.com/sagemath/sagetrac-mirror/commit/1a6feb9edc7b3621738f1dac42ea0dbeea7282c3)" to "[c1be1fbff4f97dcd107be3e92c6e3b676afdbf00](https://github.com/sagemath/sagetrac-mirror/commit/c1be1fbff4f97dcd107be3e92c6e3b676afdbf00)".



---

archive/issue_comments_364037.json:
```json
{
    "body": "<a id='comment:24'></a>\nAbout to board a flight, and I want to make a few more changes, but can you take a look at the documentation I added and make sure it looks right?  It would also be nice to see some examples illustrating the different inputs available to the iterator.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1be1fbff4f97dcd107be3e92c6e3b676afdbf00\">c1be1fb</a></td><td><code>Some Weil polynomial changes</code></td></tr></table>\n",
    "created_at": "2019-12-18T19:03:02Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364037",
    "user": "https://github.com/roed314"
}
```

<a id='comment:24'></a>
About to board a flight, and I want to make a few more changes, but can you take a look at the documentation I added and make sure it looks right?  It would also be nice to see some examples illustrating the different inputs available to the iterator.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1be1fbff4f97dcd107be3e92c6e3b676afdbf00">c1be1fb</a></td><td><code>Some Weil polynomial changes</code></td></tr></table>




---

archive/issue_comments_364038.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d88c654e80d164044cfb3b946f2475ef6dd1ece2\">d88c654</a></td><td><code>Fix some raise/return problems, add weil_polynomials method for polynomial rings, add some documentation</code></td></tr></table>\n",
    "created_at": "2019-12-19T00:54:23Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364038",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d88c654e80d164044cfb3b946f2475ef6dd1ece2">d88c654</a></td><td><code>Fix some raise/return problems, add weil_polynomials method for polynomial rings, add some documentation</code></td></tr></table>




---

archive/issue_comments_364039.json:
```json
{
    "body": "**Changing commit** from \"[c1be1fbff4f97dcd107be3e92c6e3b676afdbf00](https://github.com/sagemath/sagetrac-mirror/commit/c1be1fbff4f97dcd107be3e92c6e3b676afdbf00)\" to \"[d88c654e80d164044cfb3b946f2475ef6dd1ece2](https://github.com/sagemath/sagetrac-mirror/commit/d88c654e80d164044cfb3b946f2475ef6dd1ece2)\".",
    "created_at": "2019-12-19T00:54:23Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364039",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[c1be1fbff4f97dcd107be3e92c6e3b676afdbf00](https://github.com/sagemath/sagetrac-mirror/commit/c1be1fbff4f97dcd107be3e92c6e3b676afdbf00)" to "[d88c654e80d164044cfb3b946f2475ef6dd1ece2](https://github.com/sagemath/sagetrac-mirror/commit/d88c654e80d164044cfb3b946f2475ef6dd1ece2)".



---

archive/issue_comments_364040.json:
```json
{
    "body": "<a id='comment:26'></a>\nAlright, I made the other changes I wanted to make (most notably adding a method to polynomial rings).  Here are some documentation questions that I'd like to see addressed, but I think this ticket is basically ready to go.\n\n* I don't understand how specifying congruence constraints on leading coefficients works.  I tried the following:\n\n```\nsage: R.<T> = ZZ[]\nsage: R.weil_polynomials(4,2,lead=((1,0),(0,2)))\n[T^4 + 4, T^4 - T^2 + 4, T^4 - 2*T^2 + 4, T^4 - 3*T^2 + 4, T^4 - 4*T^2 + 4]\n```\nI would expect this to give polynomials where the coefficient of `T^3` was even, but I'm not sure what I'm getting.  Is it ignoring the 2 and giving me those where the coefficient of `T^3` is exactly 0?  Kiran, can you give me an idea of how this functionality is supposed to work?\n* I don't quite understand what `node_limit` does.  Raises a `RuntimeError` if the number of terminal nodes ever exceeds the given value?\n* Similarly, I guessed that `squarefree` omits polynomials that are not squarefree.\n\nOverall, can you check/correct the changes I made?  Also, if there's anything else useful to be said about how to recompile with OpenMP support, feel free to augment the documentation that I added.",
    "created_at": "2019-12-19T01:02:55Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364040",
    "user": "https://github.com/roed314"
}
```

<a id='comment:26'></a>
Alright, I made the other changes I wanted to make (most notably adding a method to polynomial rings).  Here are some documentation questions that I'd like to see addressed, but I think this ticket is basically ready to go.

* I don't understand how specifying congruence constraints on leading coefficients works.  I tried the following:

```
sage: R.<T> = ZZ[]
sage: R.weil_polynomials(4,2,lead=((1,0),(0,2)))
[T^4 + 4, T^4 - T^2 + 4, T^4 - 2*T^2 + 4, T^4 - 3*T^2 + 4, T^4 - 4*T^2 + 4]
```
I would expect this to give polynomials where the coefficient of `T^3` was even, but I'm not sure what I'm getting.  Is it ignoring the 2 and giving me those where the coefficient of `T^3` is exactly 0?  Kiran, can you give me an idea of how this functionality is supposed to work?
* I don't quite understand what `node_limit` does.  Raises a `RuntimeError` if the number of terminal nodes ever exceeds the given value?
* Similarly, I guessed that `squarefree` omits polynomials that are not squarefree.

Overall, can you check/correct the changes I made?  Also, if there's anything else useful to be said about how to recompile with OpenMP support, feel free to augment the documentation that I added.



---

archive/issue_comments_364041.json:
```json
{
    "body": "**Changing branch** from \"[u/roed/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/weilpoly_search)\" to \"[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)\".",
    "created_at": "2019-12-19T02:03:51Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364041",
    "user": "https://github.com/kedlaya"
}
```

**Changing branch** from "[u/roed/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/weilpoly_search)" to "[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)".



---

archive/issue_comments_364042.json:
```json
{
    "body": "**Changing commit** from \"[d88c654e80d164044cfb3b946f2475ef6dd1ece2](https://github.com/sagemath/sagetrac-mirror/commit/d88c654e80d164044cfb3b946f2475ef6dd1ece2)\" to \"[0aaec041320d09285a7d95171147d32f4304e850](https://github.com/sagemath/sagetrac-mirror/commit/0aaec041320d09285a7d95171147d32f4304e850)\".",
    "created_at": "2019-12-19T02:13:53Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364042",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d88c654e80d164044cfb3b946f2475ef6dd1ece2](https://github.com/sagemath/sagetrac-mirror/commit/d88c654e80d164044cfb3b946f2475ef6dd1ece2)" to "[0aaec041320d09285a7d95171147d32f4304e850](https://github.com/sagemath/sagetrac-mirror/commit/0aaec041320d09285a7d95171147d32f4304e850)".



---

archive/issue_comments_364043.json:
```json
{
    "body": "<a id='comment:28'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0aaec041320d09285a7d95171147d32f4304e850\">0aaec04</a></td><td><code>Updated some docstrings</code></td></tr></table>\n",
    "created_at": "2019-12-19T02:13:53Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364043",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0aaec041320d09285a7d95171147d32f4304e850">0aaec04</a></td><td><code>Updated some docstrings</code></td></tr></table>




---

archive/issue_comments_364044.json:
```json
{
    "body": "<a id='comment:29'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f48bf4e43e3afd232f719a760fb877c97951853\">6f48bf4</a></td><td><code>Fix squarefree search, add doctest</code></td></tr></table>\n",
    "created_at": "2019-12-19T03:18:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364044",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f48bf4e43e3afd232f719a760fb877c97951853">6f48bf4</a></td><td><code>Fix squarefree search, add doctest</code></td></tr></table>




---

archive/issue_comments_364045.json:
```json
{
    "body": "**Changing commit** from \"[0aaec041320d09285a7d95171147d32f4304e850](https://github.com/sagemath/sagetrac-mirror/commit/0aaec041320d09285a7d95171147d32f4304e850)\" to \"[6f48bf4e43e3afd232f719a760fb877c97951853](https://github.com/sagemath/sagetrac-mirror/commit/6f48bf4e43e3afd232f719a760fb877c97951853)\".",
    "created_at": "2019-12-19T03:18:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364045",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0aaec041320d09285a7d95171147d32f4304e850](https://github.com/sagemath/sagetrac-mirror/commit/0aaec041320d09285a7d95171147d32f4304e850)" to "[6f48bf4e43e3afd232f719a760fb877c97951853](https://github.com/sagemath/sagetrac-mirror/commit/6f48bf4e43e3afd232f719a760fb877c97951853)".



---

archive/issue_comments_364046.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [@roed314](#comment%3A26):\n> Alright, I made the other changes I wanted to make (most notably adding a method to polynomial rings).  Here are some documentation questions that I'd like to see addressed, but I think this ticket is basically ready to go.\n> \n\nI made a few tweaks in the latest commits. I really like having a method for polynomial rings; I'm guessing most users will only use the code this way. The iterator is really only needed for power use cases.\n\nSince there is already an `is_weil_polynomial` method for polynomial elements, I edited the docstring for that method to point to `weil_polynomials` and vice versa.\n\n> * I don't understand how specifying congruence constraints on leading coefficients works.  I tried the following:\n> \n> ```\n> sage: R.<T> = ZZ[]\n> sage: R.weil_polynomials(4,2,lead=((1,0),(0,2)))\n> [T^4 + 4, T^4 - T^2 + 4, T^4 - 2*T^2 + 4, T^4 - 3*T^2 + 4, T^4 - 4*T^2 + 4]\n> ```\n> I would expect this to give polynomials where the coefficient of `T^3` was even, but I'm not sure what I'm getting.  Is it ignoring the 2 and giving me those where the coefficient of `T^3` is exactly 0?  Kiran, can you give me an idea of how this functionality is supposed to work?\n\nYou just caught a bug in the C code which I have now fixed (here and upstream). I added a doctest documenting how this is supposed to work.\n\n> * I don't quite understand what `node_limit` does.  Raises a `RuntimeError` if the number of terminal nodes ever exceeds the given value?\n\nCorrect. It is there as a failsafe in case you don't want your code to run forever.\n\n> * Similarly, I guessed that `squarefree` omits polynomials that are not squarefree.\n> \n\nCorrect, except that there was a (long-known) bug in that too. I fixed that and added a doctest.\n\n> Overall, can you check/correct the changes I made?  Also, if there's anything else useful to be said about how to recompile with OpenMP support, feel free to augment the documentation that I added.\n\nOne issue is that on my system, I have to put the distutils lines at the top of the code when uncommenting them, which I think runs contrary to Sage conventions. I added a comment about this.\n\nSince it seems we are basically into the review phase anyway, let me go ahead and set state accordingly. I would be particularly open to suggestions for additional doctests; there are probably many use cases I haven't thought to test yet, and I'd like to make sure not to break those in future versions of the code.",
    "created_at": "2019-12-19T03:27:22Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364046",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:30'></a>
Replying to [@roed314](#comment%3A26):
> Alright, I made the other changes I wanted to make (most notably adding a method to polynomial rings).  Here are some documentation questions that I'd like to see addressed, but I think this ticket is basically ready to go.
> 

I made a few tweaks in the latest commits. I really like having a method for polynomial rings; I'm guessing most users will only use the code this way. The iterator is really only needed for power use cases.

Since there is already an `is_weil_polynomial` method for polynomial elements, I edited the docstring for that method to point to `weil_polynomials` and vice versa.

> * I don't understand how specifying congruence constraints on leading coefficients works.  I tried the following:
> 
> ```
> sage: R.<T> = ZZ[]
> sage: R.weil_polynomials(4,2,lead=((1,0),(0,2)))
> [T^4 + 4, T^4 - T^2 + 4, T^4 - 2*T^2 + 4, T^4 - 3*T^2 + 4, T^4 - 4*T^2 + 4]
> ```
> I would expect this to give polynomials where the coefficient of `T^3` was even, but I'm not sure what I'm getting.  Is it ignoring the 2 and giving me those where the coefficient of `T^3` is exactly 0?  Kiran, can you give me an idea of how this functionality is supposed to work?

You just caught a bug in the C code which I have now fixed (here and upstream). I added a doctest documenting how this is supposed to work.

> * I don't quite understand what `node_limit` does.  Raises a `RuntimeError` if the number of terminal nodes ever exceeds the given value?

Correct. It is there as a failsafe in case you don't want your code to run forever.

> * Similarly, I guessed that `squarefree` omits polynomials that are not squarefree.
> 

Correct, except that there was a (long-known) bug in that too. I fixed that and added a doctest.

> Overall, can you check/correct the changes I made?  Also, if there's anything else useful to be said about how to recompile with OpenMP support, feel free to augment the documentation that I added.

One issue is that on my system, I have to put the distutils lines at the top of the code when uncommenting them, which I think runs contrary to Sage conventions. I added a comment about this.

Since it seems we are basically into the review phase anyway, let me go ahead and set state accordingly. I would be particularly open to suggestions for additional doctests; there are probably many use cases I haven't thought to test yet, and I'd like to make sure not to break those in future versions of the code.



---

archive/issue_events_212750.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2019-12-19T03:27:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212750"
}
```



---

archive/issue_comments_364047.json:
```json
{
    "body": "**Author:** Kiran Kedlaya",
    "created_at": "2019-12-19T03:27:22Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364047",
    "user": "https://github.com/kedlaya"
}
```

**Author:** Kiran Kedlaya



---

archive/issue_comments_364048.json:
```json
{
    "body": "**Changing branch** from \"[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)\" to \"[u/roed/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/weilpoly_search)\".",
    "created_at": "2019-12-19T08:51:33Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364048",
    "user": "https://github.com/roed314"
}
```

**Changing branch** from "[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)" to "[u/roed/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/weilpoly_search)".



---

archive/issue_comments_364049.json:
```json
{
    "body": "**Changing commit** from \"[6f48bf4e43e3afd232f719a760fb877c97951853](https://github.com/sagemath/sagetrac-mirror/commit/6f48bf4e43e3afd232f719a760fb877c97951853)\" to \"[d8a813f7df1d503ef41e16c28beb2f77907fe444](https://github.com/sagemath/sagetrac-mirror/commit/d8a813f7df1d503ef41e16c28beb2f77907fe444)\".",
    "created_at": "2019-12-19T09:44:45Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364049",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6f48bf4e43e3afd232f719a760fb877c97951853](https://github.com/sagemath/sagetrac-mirror/commit/6f48bf4e43e3afd232f719a760fb877c97951853)" to "[d8a813f7df1d503ef41e16c28beb2f77907fe444](https://github.com/sagemath/sagetrac-mirror/commit/d8a813f7df1d503ef41e16c28beb2f77907fe444)".



---

archive/issue_comments_364050.json:
```json
{
    "body": "<a id='comment:32'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8a813f7df1d503ef41e16c28beb2f77907fe444\">d8a813f</a></td><td><code>Add some weil polynomial tests</code></td></tr></table>\n",
    "created_at": "2019-12-19T09:44:45Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364050",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8a813f7df1d503ef41e16c28beb2f77907fe444">d8a813f</a></td><td><code>Add some weil polynomial tests</code></td></tr></table>




---

archive/issue_comments_364051.json:
```json
{
    "body": "**Reviewer:** David Roe",
    "created_at": "2019-12-19T09:45:34Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364051",
    "user": "https://github.com/roed314"
}
```

**Reviewer:** David Roe



---

archive/issue_comments_364052.json:
```json
{
    "body": "<a id='comment:33'></a>\nI've added some more tests.  I think I'm happy to give this positive review if all tests are passing.   I'm also happy to try to keep brainstorming some more doctests if you'd like.",
    "created_at": "2019-12-19T09:45:34Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364052",
    "user": "https://github.com/roed314"
}
```

<a id='comment:33'></a>
I've added some more tests.  I think I'm happy to give this positive review if all tests are passing.   I'm also happy to try to keep brainstorming some more doctests if you'd like.



---

archive/issue_comments_364053.json:
```json
{
    "body": "**Changing branch** from \"[u/roed/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/weilpoly_search)\" to \"[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)\".",
    "created_at": "2019-12-19T15:57:23Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364053",
    "user": "https://github.com/kedlaya"
}
```

**Changing branch** from "[u/roed/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/roed/weilpoly_search)" to "[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)".



---

archive/issue_comments_364054.json:
```json
{
    "body": "**Changing commit** from \"[d8a813f7df1d503ef41e16c28beb2f77907fe444](https://github.com/sagemath/sagetrac-mirror/commit/d8a813f7df1d503ef41e16c28beb2f77907fe444)\" to \"[dbb60955f2e17b0b73dbd0353f4f8bfed223916b](https://github.com/sagemath/sagetrac-mirror/commit/dbb60955f2e17b0b73dbd0353f4f8bfed223916b)\".",
    "created_at": "2019-12-19T16:45:27Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364054",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[d8a813f7df1d503ef41e16c28beb2f77907fe444](https://github.com/sagemath/sagetrac-mirror/commit/d8a813f7df1d503ef41e16c28beb2f77907fe444)" to "[dbb60955f2e17b0b73dbd0353f4f8bfed223916b](https://github.com/sagemath/sagetrac-mirror/commit/dbb60955f2e17b0b73dbd0353f4f8bfed223916b)".



---

archive/issue_comments_364055.json:
```json
{
    "body": "<a id='comment:35'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbb60955f2e17b0b73dbd0353f4f8bfed223916b\">dbb6095</a></td><td><code>Fix compiler warnings</code></td></tr></table>\n",
    "created_at": "2019-12-19T16:45:27Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364055",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbb60955f2e17b0b73dbd0353f4f8bfed223916b">dbb6095</a></td><td><code>Fix compiler warnings</code></td></tr></table>




---

archive/issue_comments_364056.json:
```json
{
    "body": "**Changing commit** from \"[dbb60955f2e17b0b73dbd0353f4f8bfed223916b](https://github.com/sagemath/sagetrac-mirror/commit/dbb60955f2e17b0b73dbd0353f4f8bfed223916b)\" to \"[e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9](https://github.com/sagemath/sagetrac-mirror/commit/e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9)\".",
    "created_at": "2019-12-19T16:50:23Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364056",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[dbb60955f2e17b0b73dbd0353f4f8bfed223916b](https://github.com/sagemath/sagetrac-mirror/commit/dbb60955f2e17b0b73dbd0353f4f8bfed223916b)" to "[e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9](https://github.com/sagemath/sagetrac-mirror/commit/e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9)".



---

archive/issue_comments_364057.json:
```json
{
    "body": "<a id='comment:36'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9\">e0b9ff9</a></td><td><code>Add ref to github repo for Weil polynomials</code></td></tr></table>\n",
    "created_at": "2019-12-19T16:50:23Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364057",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9">e0b9ff9</a></td><td><code>Add ref to github repo for Weil polynomials</code></td></tr></table>




---

archive/issue_comments_364058.json:
```json
{
    "body": "<a id='comment:37'></a>\nA few last-minute changes:\n\n- There was a trivial bug in `polynomial_ring.py` about checking the base ring (which patchbot also noticed); I fixed that and added some doctests to confirm.\n- I fixed some compiler warnings on the backend.\n- I added a link to the github repo in the main package docstring.\n\nThat's probably enough doctests for the moment; I'll inevitably have to add more in response to later bugfixes. Let's see what patchbot has to say next.",
    "created_at": "2019-12-19T17:06:27Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364058",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:37'></a>
A few last-minute changes:

- There was a trivial bug in `polynomial_ring.py` about checking the base ring (which patchbot also noticed); I fixed that and added some doctests to confirm.
- I fixed some compiler warnings on the backend.
- I added a link to the github repo in the main package docstring.

That's probably enough doctests for the moment; I'll inevitably have to add more in response to later bugfixes. Let's see what patchbot has to say next.



---

archive/issue_events_212751.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-12-19T18:14:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212751"
}
```



---

archive/issue_events_212752.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-12-19T18:14:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212752"
}
```



---

archive/issue_comments_364059.json:
```json
{
    "body": "<a id='comment:38'></a>\nPatchbot is green; I think we're good to go!  I'll optimistically set the milestone to 9.0. :-)",
    "created_at": "2019-12-19T18:14:07Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364059",
    "user": "https://github.com/roed314"
}
```

<a id='comment:38'></a>
Patchbot is green; I think we're good to go!  I'll optimistically set the milestone to 9.0. :-)



---

archive/issue_events_212753.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-12-19T18:14:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212753"
}
```



---

archive/issue_events_212754.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-12-19T18:14:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212754"
}
```



---

archive/issue_comments_364060.json:
```json
{
    "body": "<a id='comment:39'></a>\nOn Python 2 there are various errors of the form \n\n```\n**********************************************************************\nFile \"src/sage/rings/polynomial/weil/weil_polynomials.pyx\", line 168, in sage.rings.polynomial.weil.weil_polynomials.dfs_manager.node_count\nFailed example:\n    _ = next(it)\nException raised:\n    Traceback (most recent call last):\n      File \"/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.polynomial.weil.weil_polynomials.dfs_manager.node_count[3]>\", line 1, in <module>\n        _ = next(it)\n    TypeError: instance has no next() method\n**********************************************************************\n```",
    "created_at": "2019-12-25T09:57:40Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364060",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:39'></a>
On Python 2 there are various errors of the form 

```
**********************************************************************
File "src/sage/rings/polynomial/weil/weil_polynomials.pyx", line 168, in sage.rings.polynomial.weil.weil_polynomials.dfs_manager.node_count
Failed example:
    _ = next(it)
Exception raised:
    Traceback (most recent call last):
      File "/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.polynomial.weil.weil_polynomials.dfs_manager.node_count[3]>", line 1, in <module>
        _ = next(it)
    TypeError: instance has no next() method
**********************************************************************
```



---

archive/issue_events_212755.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-12-25T09:57:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212755"
}
```



---

archive/issue_events_212756.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-12-25T09:57:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212756"
}
```



---

archive/issue_comments_364061.json:
```json
{
    "body": "**Changing commit** from \"[e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9](https://github.com/sagemath/sagetrac-mirror/commit/e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9)\" to \"[7f44a49a42de8291e091ca2f4c516111282888b0](https://github.com/sagemath/sagetrac-mirror/commit/7f44a49a42de8291e091ca2f4c516111282888b0)\".",
    "created_at": "2019-12-25T16:36:32Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364061",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9](https://github.com/sagemath/sagetrac-mirror/commit/e0b9ff9bcd8d3b5ef3f1c6b40fd6e6f6a1c175a9)" to "[7f44a49a42de8291e091ca2f4c516111282888b0](https://github.com/sagemath/sagetrac-mirror/commit/7f44a49a42de8291e091ca2f4c516111282888b0)".



---

archive/issue_comments_364062.json:
```json
{
    "body": "<a id='comment:41'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f44a49a42de8291e091ca2f4c516111282888b0\">7f44a49</a></td><td><code>Reinstate next() method for Py2 compatibility</code></td></tr></table>\n",
    "created_at": "2019-12-25T16:36:32Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364062",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f44a49a42de8291e091ca2f4c516111282888b0">7f44a49</a></td><td><code>Reinstate next() method for Py2 compatibility</code></td></tr></table>




---

archive/issue_comments_364063.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [@vbraun](#comment%3A39):\n> On Python 2 there are various errors of the form \n> \n> ```\n> **********************************************************************\n> File \"src/sage/rings/polynomial/weil/weil_polynomials.pyx\", line 168, in sage.rings.polynomial.weil.weil_polynomials.dfs_manager.node_count\n> Failed example:\n>     _ = next(it)\n> Exception raised:\n>     Traceback (most recent call last):\n>       File \"/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n>         self.compile_and_execute(example, compiler, test.globs)\n>       File \"/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n>         exec(compiled, globs)\n>       File \"<doctest sage.rings.polynomial.weil.weil_polynomials.dfs_manager.node_count[3]>\", line 1, in <module>\n>         _ = next(it)\n>     TypeError: instance has no next() method\n> **********************************************************************\n> ```\n\nI was asked to remove that method (see [comment:18](#comment%3A18)), but anyway here it is again.",
    "created_at": "2019-12-25T16:37:56Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364063",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:42'></a>
Replying to [@vbraun](#comment%3A39):
> On Python 2 there are various errors of the form 
> 
> ```
> **********************************************************************
> File "src/sage/rings/polynomial/weil/weil_polynomials.pyx", line 168, in sage.rings.polynomial.weil.weil_polynomials.dfs_manager.node_count
> Failed example:
>     _ = next(it)
> Exception raised:
>     Traceback (most recent call last):
>       File "/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 681, in _run
>         self.compile_and_execute(example, compiler, test.globs)
>       File "/var/lib/buildbot/slave/sage2_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
>         exec(compiled, globs)
>       File "<doctest sage.rings.polynomial.weil.weil_polynomials.dfs_manager.node_count[3]>", line 1, in <module>
>         _ = next(it)
>     TypeError: instance has no next() method
> **********************************************************************
> ```

I was asked to remove that method (see [comment:18](#comment%3A18)), but anyway here it is again.



---

archive/issue_events_212757.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2019-12-25T16:37:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212757"
}
```



---

archive/issue_events_212758.json:
```json
{
    "actor": "https://github.com/kedlaya",
    "created_at": "2019-12-25T16:37:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212758"
}
```



---

archive/issue_comments_364064.json:
```json
{
    "body": "<a id='comment:43'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6a3e93d0c200fa3d381c7d6b6433134439e04b33\">6a3e93d</a></td><td><code>Fix typos in doctest</code></td></tr></table>\n",
    "created_at": "2019-12-25T19:12:29Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364064",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6a3e93d0c200fa3d381c7d6b6433134439e04b33">6a3e93d</a></td><td><code>Fix typos in doctest</code></td></tr></table>




---

archive/issue_comments_364065.json:
```json
{
    "body": "**Changing commit** from \"[7f44a49a42de8291e091ca2f4c516111282888b0](https://github.com/sagemath/sagetrac-mirror/commit/7f44a49a42de8291e091ca2f4c516111282888b0)\" to \"[6a3e93d0c200fa3d381c7d6b6433134439e04b33](https://github.com/sagemath/sagetrac-mirror/commit/6a3e93d0c200fa3d381c7d6b6433134439e04b33)\".",
    "created_at": "2019-12-25T19:12:29Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364065",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7f44a49a42de8291e091ca2f4c516111282888b0](https://github.com/sagemath/sagetrac-mirror/commit/7f44a49a42de8291e091ca2f4c516111282888b0)" to "[6a3e93d0c200fa3d381c7d6b6433134439e04b33](https://github.com/sagemath/sagetrac-mirror/commit/6a3e93d0c200fa3d381c7d6b6433134439e04b33)".



---

archive/issue_comments_364066.json:
```json
{
    "body": "<a id='comment:44'></a>\nLooking at the patchbot logs, it seems that at least one of the bots failed to build because of nested function declarations in the C code. I thought we were always compiling the Sage library with gcc, which supports nested functions even though they are not in the ANSI standard...?",
    "created_at": "2019-12-25T19:39:43Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364066",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:44'></a>
Looking at the patchbot logs, it seems that at least one of the bots failed to build because of nested function declarations in the C code. I thought we were always compiling the Sage library with gcc, which supports nested functions even though they are not in the ANSI standard...?



---

archive/issue_comments_364067.json:
```json
{
    "body": "<a id='comment:45'></a>\non osx we now use clang by default",
    "created_at": "2019-12-25T21:56:42Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364067",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:45'></a>
on osx we now use clang by default



---

archive/issue_comments_364068.json:
```json
{
    "body": "<a id='comment:46'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f\">e02ae3c</a></td><td><code>Un-nest functions in C code for non-GNU compilers</code></td></tr></table>\n",
    "created_at": "2019-12-25T23:56:30Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364068",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f">e02ae3c</a></td><td><code>Un-nest functions in C code for non-GNU compilers</code></td></tr></table>




---

archive/issue_comments_364069.json:
```json
{
    "body": "**Changing commit** from \"[6a3e93d0c200fa3d381c7d6b6433134439e04b33](https://github.com/sagemath/sagetrac-mirror/commit/6a3e93d0c200fa3d381c7d6b6433134439e04b33)\" to \"[e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f](https://github.com/sagemath/sagetrac-mirror/commit/e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f)\".",
    "created_at": "2019-12-25T23:56:30Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364069",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6a3e93d0c200fa3d381c7d6b6433134439e04b33](https://github.com/sagemath/sagetrac-mirror/commit/6a3e93d0c200fa3d381c7d6b6433134439e04b33)" to "[e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f](https://github.com/sagemath/sagetrac-mirror/commit/e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f)".



---

archive/issue_comments_364070.json:
```json
{
    "body": "<a id='comment:47'></a>\nAh, it seems clang does not (yet) support nested functions as in GNU C. So I redid that bit of the C code; let's see what the patchbots have to say now.",
    "created_at": "2019-12-25T23:58:02Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364070",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:47'></a>
Ah, it seems clang does not (yet) support nested functions as in GNU C. So I redid that bit of the C code; let's see what the patchbots have to say now.



---

archive/issue_comments_364071.json:
```json
{
    "body": "<a id='comment:48'></a>\nSome of the patchbots are set up strangely, but I'm not seeing any systemic issues with this branch.",
    "created_at": "2019-12-30T07:29:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364071",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:48'></a>
Some of the patchbots are set up strangely, but I'm not seeing any systemic issues with this branch.



---

archive/issue_events_212759.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-12-30T23:28:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212759"
}
```



---

archive/issue_events_212760.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-12-30T23:28:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212760"
}
```



---

archive/issue_events_212761.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-12-30T23:28:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212761"
}
```



---

archive/issue_events_212762.json:
```json
{
    "actor": "https://github.com/roed314",
    "created_at": "2019-12-30T23:28:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212762"
}
```



---

archive/issue_comments_364072.json:
```json
{
    "body": "<a id='comment:49'></a>\nI agree.  We have successful tests run on Darwin, so I'm setting this back to positive review.",
    "created_at": "2019-12-30T23:28:09Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364072",
    "user": "https://github.com/roed314"
}
```

<a id='comment:49'></a>
I agree.  We have successful tests run on Darwin, so I'm setting this back to positive review.



---

archive/issue_comments_364073.json:
```json
{
    "body": "**Changing branch** from \"[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)\" to \"[e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f](https://github.com/sagemath/sagetrac-mirror/commit/e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f)\".",
    "created_at": "2020-01-05T15:47:17Z",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23946#issuecomment-364073",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/kedlaya/weilpoly_search](https://github.com/sagemath/sagetrac-mirror/tree/u/kedlaya/weilpoly_search)" to "[e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f](https://github.com/sagemath/sagetrac-mirror/commit/e02ae3cfc9bd4da34ee8f3b3b9a9b94e7666fa6f)".



---

archive/issue_events_212763.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-01-05T15:47:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212763"
}
```



---

archive/issue_events_212764.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "c80928120c4227bc0a4624ad351e795f1eeec6a5",
    "created_at": "2020-01-05T15:47:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23946",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23946#event-212764"
}
```
