# Issue 23341: port lcalc to C++11

archive/issues_023104.json:
```json
{
    "body": "lcalc doesn't use standard C++:\n\n- `using namespace std;` needs an include with stuff from `std::` before it\n    \n- `typeof` is a gcc extension - C++11 has `decltype` instead\n    \n- plain C must not be compiled with C++ compiler - thus a makefile change\n\n\n**CC:**  @kiwifb\n\n**Keywords:** lcalc\n\n**Branch/Commit:** [7cf967fa5f50daf67e9a910786970bf184c37ecb](https://github.com/sagemath/sagetrac-mirror/commit/7cf967fa5f50daf67e9a910786970bf184c37ecb)\n\n**Reviewer:** Dima Pasechnik, Fran\u00e7ois Bissey, Jeroen Demeyer, Ralf Stephan\n\n**Author:** Dima Pasechnik, Fran\u00e7ois Bissey\n\nIssue created by migration from https://trac.sagemath.org/ticket/23341\n\n",
    "closed_at": "2018-11-23T21:42:05Z",
    "created_at": "2017-06-29T23:04:58Z",
    "labels": [
        "component: number theory",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.5",
    "title": "port lcalc to C++11",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/23341",
    "user": "https://github.com/dimpase"
}
```
lcalc doesn't use standard C++:

- `using namespace std;` needs an include with stuff from `std::` before it
    
- `typeof` is a gcc extension - C++11 has `decltype` instead
    
- plain C must not be compiled with C++ compiler - thus a makefile change


**CC:**  @kiwifb

**Keywords:** lcalc

**Branch/Commit:** [7cf967fa5f50daf67e9a910786970bf184c37ecb](https://github.com/sagemath/sagetrac-mirror/commit/7cf967fa5f50daf67e9a910786970bf184c37ecb)

**Reviewer:** Dima Pasechnik, François Bissey, Jeroen Demeyer, Ralf Stephan

**Author:** Dima Pasechnik, François Bissey

Issue created by migration from https://trac.sagemath.org/ticket/23341





---

archive/issue_comments_352902.json:
```json
{
    "body": "<a id='comment:1'></a>\nCan you rebase on 8.0.rc0? Your branch shows up in red.",
    "created_at": "2017-06-29T23:06:16Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352902",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>
Can you rebase on 8.0.rc0? Your branch shows up in red.



---

archive/issue_comments_352903.json:
```json
{
    "body": "<a id='comment:2'></a>\nthis is needed for building lcalc with `-std=c++11`.\n(tested so far with clang 4.0.1 on Linux, with `stdlib=libc++`)\n\nOnly the top commit is of interest. Perhaps it can be based on rc0 indeed. But I need sleep now :-)",
    "created_at": "2017-06-29T23:08:02Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352903",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
this is needed for building lcalc with `-std=c++11`.
(tested so far with clang 4.0.1 on Linux, with `stdlib=libc++`)

Only the top commit is of interest. Perhaps it can be based on rc0 indeed. But I need sleep now :-)



---

archive/issue_comments_352904.json:
```json
{
    "body": "<a id='comment:3'></a>\nOK :)\n\nThe next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.",
    "created_at": "2017-06-29T23:30:43Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352904",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>
OK :)

The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.



---

archive/issue_comments_352905.json:
```json
{
    "body": "<a id='comment:4'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5434c70edc3be3dfa2c353adff92bf7909708c1b\">5434c70</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5657399ab53fcfe274dee50d0cf5d04bb83ae94\">f565739</a></td><td><code>bump config tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53f9c4de61b5af863af0bbec88a843a3289b3cba\">53f9c4d</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7\">7a9ab6b</a></td><td><code>checksum for this branch's configure tarball</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee\">14e08ae</a></td><td><code>Merge branch 'u/fbissey/clang-progress' of trac.sagemath.org:sage into clang</code></td></tr></table>\n",
    "created_at": "2017-06-30T06:46:07Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352905",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5434c70edc3be3dfa2c353adff92bf7909708c1b">5434c70</a></td><td><code>Merge branch 'develop' into compiler</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5657399ab53fcfe274dee50d0cf5d04bb83ae94">f565739</a></td><td><code>bump config tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53f9c4de61b5af863af0bbec88a843a3289b3cba">53f9c4d</a></td><td><code>Merge branch 'compiler' into clang-progress</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a9ab6b0cbc9625e1b5df0a29536803e8d7bfab7">7a9ab6b</a></td><td><code>checksum for this branch's configure tarball</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee">14e08ae</a></td><td><code>Merge branch 'u/fbissey/clang-progress' of trac.sagemath.org:sage into clang</code></td></tr></table>




---

archive/issue_comments_352906.json:
```json
{
    "body": "**Changing commit** from \"[015955efe9577dc9c3d443a4328297cd097454ee](https://github.com/sagemath/sagetrac-mirror/commit/015955efe9577dc9c3d443a4328297cd097454ee)\" to \"[14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee](https://github.com/sagemath/sagetrac-mirror/commit/14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee)\".",
    "created_at": "2017-06-30T06:46:07Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352906",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[015955efe9577dc9c3d443a4328297cd097454ee](https://github.com/sagemath/sagetrac-mirror/commit/015955efe9577dc9c3d443a4328297cd097454ee)" to "[14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee](https://github.com/sagemath/sagetrac-mirror/commit/14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee)".



---

archive/issue_comments_352907.json:
```json
{
    "body": "<a id='comment:5'></a>\nthe other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.\nAny idea how this can be fixed?\n\n```\n[sagelib-8.0.rc0] [  4/323] clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/cypari2 -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/cysignals -I/mnt/opt/Sage/sage-clang/local/include -I/mnt/opt/Sage/sage-clang/local/include/python2.7 -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/numpy/core/include -I/mnt/opt/Sage/sage-clang/src -I/mnt/opt/Sage/sage-clang/src/sage/ext -I/mnt/opt/Sage/sage-clang/src/build/cythonized -I/mnt/opt/Sage/sage-clang/src/build/cythonized/sage/ext -I/mnt/opt/Sage/sage-clang/local/include/python2.7 -c /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp -o build/temp.linux-x86_64-2.7/mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.o -fno-strict-aliasing -O3 -ffast-math\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:505:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/sage/libs/lcalc/lcalc_sage.h:1:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/L.h:34:\n[sagelib-8.0.rc0] In file included from /usr/lib/gcc/x86_64-pc-linux-gnu/6.3.0/include/g++-v6/backward/strstream:50:\n[sagelib-8.0.rc0] /usr/lib/gcc/x86_64-pc-linux-gnu/6.3.0/include/g++-v6/backward/backward_warning.h:32:2: warning: This file includes at least one deprecated or antiquated header which   may be removed without further notice at a future date. Please use a   non-deprecated interface with equivalent functionality instead. For a   listing of replacement headers and interfaces, consult the file   backward_warning.h. To disable this warning use -Wno-deprecated. [-W#warnings]\n[sagelib-8.0.rc0] #warning \\\n[sagelib-8.0.rc0]  ^\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:505:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/sage/libs/lcalc/lcalc_sage.h:1:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/L.h:40:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/Lglobals.h:48:\n[sagelib-8.0.rc0] /mnt/opt/Sage/sage-clang/local/include/libLfunction/Lcommon.h:71:8: error: expected ';' in 'for' statement specifier\n[sagelib-8.0.rc0]                 loop(i,this->N,N) coeffs[i]=zero;\n[sagelib-8.0.rc0                       ^\n...\n```",
    "created_at": "2017-06-30T07:30:09Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352907",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>
the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.
Any idea how this can be fixed?

```
[sagelib-8.0.rc0] [  4/323] clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/cypari2 -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/cysignals -I/mnt/opt/Sage/sage-clang/local/include -I/mnt/opt/Sage/sage-clang/local/include/python2.7 -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/numpy/core/include -I/mnt/opt/Sage/sage-clang/src -I/mnt/opt/Sage/sage-clang/src/sage/ext -I/mnt/opt/Sage/sage-clang/src/build/cythonized -I/mnt/opt/Sage/sage-clang/src/build/cythonized/sage/ext -I/mnt/opt/Sage/sage-clang/local/include/python2.7 -c /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp -o build/temp.linux-x86_64-2.7/mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.o -fno-strict-aliasing -O3 -ffast-math
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:505:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/sage/libs/lcalc/lcalc_sage.h:1:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/L.h:34:
[sagelib-8.0.rc0] In file included from /usr/lib/gcc/x86_64-pc-linux-gnu/6.3.0/include/g++-v6/backward/strstream:50:
[sagelib-8.0.rc0] /usr/lib/gcc/x86_64-pc-linux-gnu/6.3.0/include/g++-v6/backward/backward_warning.h:32:2: warning: This file includes at least one deprecated or antiquated header which   may be removed without further notice at a future date. Please use a   non-deprecated interface with equivalent functionality instead. For a   listing of replacement headers and interfaces, consult the file   backward_warning.h. To disable this warning use -Wno-deprecated. [-W#warnings]
[sagelib-8.0.rc0] #warning \
[sagelib-8.0.rc0]  ^
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:505:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/sage/libs/lcalc/lcalc_sage.h:1:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/L.h:40:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/Lglobals.h:48:
[sagelib-8.0.rc0] /mnt/opt/Sage/sage-clang/local/include/libLfunction/Lcommon.h:71:8: error: expected ';' in 'for' statement specifier
[sagelib-8.0.rc0]                 loop(i,this->N,N) coeffs[i]=zero;
[sagelib-8.0.rc0                       ^
...
```



---

archive/issue_comments_352908.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [@kiwifb](#comment%3A3):\n> OK :)\n> \n> The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.\n\nWe may assume that all the C++ compilers we care about support `-std=c++11`, right?\nSo this may be an independent of clang tickets thing?",
    "created_at": "2017-06-30T07:31:43Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352908",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
Replying to [@kiwifb](#comment%3A3):
> OK :)
> 
> The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.

We may assume that all the C++ compilers we care about support `-std=c++11`, right?
So this may be an independent of clang tickets thing?



---

archive/issue_comments_352909.json:
```json
{
    "body": "<a id='comment:7'></a>\nJeroen, do you know to force the use of C++ compiler here (with proper use of CXXFLAGS, too) ?",
    "created_at": "2017-06-30T07:35:00Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352909",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>
Jeroen, do you know to force the use of C++ compiler here (with proper use of CXXFLAGS, too) ?



---

archive/issue_events_207746.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-06-30T07:35:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "bug",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207746"
}
```



---

archive/issue_events_207747.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-06-30T07:35:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "component: packages: standard",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207747"
}
```



---

archive/issue_events_207748.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-06-30T07:35:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "bug",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207748"
}
```



---

archive/issue_comments_352910.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [@dimpase](#comment%3A5):\n> the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.\n> Any idea how this can be fixed?\n\nYes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.",
    "created_at": "2017-06-30T07:35:21Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352910",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>
Replying to [@dimpase](#comment%3A5):
> the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.
> Any idea how this can be fixed?

Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.



---

archive/issue_events_207749.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-06-30T07:35:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "component: packages: standard",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207749"
}
```



---

archive/issue_comments_352911.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [@dimpase](#comment%3A6):\n> We may assume that all the C++ compilers we care about support `-std=c++11`, right?\n> So this may be an independent of clang tickets thing?\n\nDefinitely. This shouldn't depend on #12426.",
    "created_at": "2017-06-30T07:36:34Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352911",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
Replying to [@dimpase](#comment%3A6):
> We may assume that all the C++ compilers we care about support `-std=c++11`, right?
> So this may be an independent of clang tickets thing?

Definitely. This shouldn't depend on #12426.



---

archive/issue_comments_352912.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [@kiwifb](#comment%3A8):\n> Replying to [@dimpase](#comment%3A5):\n> > the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.\n> > Any idea how this can be fixed?\n\n> \n> Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.\n\nIs there a Sage ticket for this already?",
    "created_at": "2017-06-30T07:38:14Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352912",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>
Replying to [@kiwifb](#comment%3A8):
> Replying to [@dimpase](#comment%3A5):
> > the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.
> > Any idea how this can be fixed?

> 
> Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.

Is there a Sage ticket for this already?



---

archive/issue_comments_352913.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [@dimpase](#comment%3A10):\n> Replying to [@kiwifb](#comment%3A8):\n> > Replying to [@dimpase](#comment%3A5):\n> > > the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.\n> > > Any idea how this can be fixed?\n\n> > \n> > Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.\n\n> \n> Is there a Sage ticket for this already?\n\nI don't think so. But it comes up regularly.",
    "created_at": "2017-06-30T07:40:10Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352913",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>
Replying to [@dimpase](#comment%3A10):
> Replying to [@kiwifb](#comment%3A8):
> > Replying to [@dimpase](#comment%3A5):
> > > the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.
> > > Any idea how this can be fixed?

> > 
> > Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.

> 
> Is there a Sage ticket for this already?

I don't think so. But it comes up regularly.



---

archive/issue_comments_352914.json:
```json
{
    "body": "<a id='comment:12'></a>\nHow urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).",
    "created_at": "2017-06-30T08:34:36Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352914",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>
How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).



---

archive/issue_comments_352915.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [@jdemeyer](#comment%3A12):\n> How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).\n\nI think Dima started this with the view of compiling sage with `-std=c++11`. If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.",
    "created_at": "2017-06-30T08:39:02Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352915",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>
Replying to [@jdemeyer](#comment%3A12):
> How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).

I think Dima started this with the view of compiling sage with `-std=c++11`. If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.



---

archive/issue_comments_352916.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [@kiwifb](#comment%3A13):\n> Replying to [@jdemeyer](#comment%3A12):\n> > How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).\n\n> \n> I think Dima started this with the view of compiling sage with `-std=c++11`.\n\nindeed, and as a part of the clang porting effort too - it's just too much trouble to have different packages with different `c++xy` IMHO, especially if one depends on the another, they better be on the same `xy`...\n \n\n\n> If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.\n\nI'll see how it flies with these patches, and open a ticket.",
    "created_at": "2017-06-30T09:11:27Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352916",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>
Replying to [@kiwifb](#comment%3A13):
> Replying to [@jdemeyer](#comment%3A12):
> > How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).

> 
> I think Dima started this with the view of compiling sage with `-std=c++11`.

indeed, and as a part of the clang porting effort too - it's just too much trouble to have different packages with different `c++xy` IMHO, especially if one depends on the another, they better be on the same `xy`...
 


> If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.

I'll see how it flies with these patches, and open a ticket.



---

archive/issue_comments_352917.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [@dimpase](#comment%3A14):\n> I'll see how it flies with these patches, and open a ticket.\n> \n\nFor info Gentoo's python includes those. sage-on-gentoo has been compiled using these patches to distutils for almost as long as it existed.",
    "created_at": "2017-06-30T09:13:45Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352917",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'></a>
Replying to [@dimpase](#comment%3A14):
> I'll see how it flies with these patches, and open a ticket.
> 

For info Gentoo's python includes those. sage-on-gentoo has been compiled using these patches to distutils for almost as long as it existed.



---

archive/issue_comments_352918.json:
```json
{
    "body": "<a id='comment:16'></a>\nFor the life of me, I don't understand why the patch [21_all_distutils_c++.patch](http://users.ox.ac.uk/~coml0531/sage/21_all_distutils_c++.patch)\nfrom https://dev.gentoo.org/~floppym/python/python-gentoo-patches-2.7.13-0.tar.xz\ndoes not apply if I place it in `build/pkgs/python2/patches/`: all the files etc are as they should be, yet I get\n\n```\n[python2-2.7.13.p1] Applying patches from ../patches...\n[python2-2.7.13.p1] Applying ../patches/2.6.5-FD_SETSIZE.patch\n[python2-2.7.13.p1] patching file Modules/selectmodule.c\n[python2-2.7.13.p1] Applying ../patches/21_all_distutils_c++.patch\n[python2-2.7.13.p1] can't find file to patch at input line 5\n[python2-2.7.13.p1] Perhaps you used the wrong -p or --strip option?\n[python2-2.7.13.p1] The text leading up to this was:\n[python2-2.7.13.p1] --------------------------\n[python2-2.7.13.p1] |https://bugs.python.org/issue1222585\n[python2-2.7.13.p1] |\n[python2-2.7.13.p1] |--- Lib/_osx_support.py\n[python2-2.7.13.p1] |+++ Lib/_osx_support.py\n[python2-2.7.13.p1] --------------------------\n[python2-2.7.13.p1] File to patch: \n...\n```\n\nSeems to be the right format, the right paths to files, yet this...",
    "created_at": "2017-06-30T10:45:30Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352918",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>
For the life of me, I don't understand why the patch [21_all_distutils_c++.patch](http://users.ox.ac.uk/~coml0531/sage/21_all_distutils_c++.patch)
from https://dev.gentoo.org/~floppym/python/python-gentoo-patches-2.7.13-0.tar.xz
does not apply if I place it in `build/pkgs/python2/patches/`: all the files etc are as they should be, yet I get

```
[python2-2.7.13.p1] Applying patches from ../patches...
[python2-2.7.13.p1] Applying ../patches/2.6.5-FD_SETSIZE.patch
[python2-2.7.13.p1] patching file Modules/selectmodule.c
[python2-2.7.13.p1] Applying ../patches/21_all_distutils_c++.patch
[python2-2.7.13.p1] can't find file to patch at input line 5
[python2-2.7.13.p1] Perhaps you used the wrong -p or --strip option?
[python2-2.7.13.p1] The text leading up to this was:
[python2-2.7.13.p1] --------------------------
[python2-2.7.13.p1] |https://bugs.python.org/issue1222585
[python2-2.7.13.p1] |
[python2-2.7.13.p1] |--- Lib/_osx_support.py
[python2-2.7.13.p1] |+++ Lib/_osx_support.py
[python2-2.7.13.p1] --------------------------
[python2-2.7.13.p1] File to patch: 
...
```

Seems to be the right format, the right paths to files, yet this...



---

archive/issue_comments_352919.json:
```json
{
    "body": "<a id='comment:17'></a>\nCheck the patch directory levels with another patch there may be one directory to many in the Gentoo patch compared to what sage's automatic patching needs.",
    "created_at": "2017-06-30T10:53:06Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352919",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>
Check the patch directory levels with another patch there may be one directory to many in the Gentoo patch compared to what sage's automatic patching needs.



---

archive/issue_comments_352920.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [@kiwifb](#comment%3A17):\n> Check the patch directory levels with another patch there may be one directory to many in the Gentoo patch compared to what sage's automatic patching needs.\n\nno, it's not the case as far as I can see (and I've been stuck with it for an hour already, just not yet ready to apply it by hand...)",
    "created_at": "2017-06-30T10:59:35Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352920",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>
Replying to [@kiwifb](#comment%3A17):
> Check the patch directory levels with another patch there may be one directory to many in the Gentoo patch compared to what sage's automatic patching needs.

no, it's not the case as far as I can see (and I've been stuck with it for an hour already, just not yet ready to apply it by hand...)



---

archive/issue_comments_352921.json:
```json
{
    "body": "<a id='comment:19'></a>\nJust checked you need to `_add_` one directory level to the gentoo patch. That is\n\n```\n--- Lib/_osx_support.py\n+++ Lib/_osx_support.py\n```\nneeds to become \n\n```\n--- a/Lib/_osx_support.py\n+++ b/Lib/_osx_support.py\n```\nand so on...",
    "created_at": "2017-06-30T11:18:49Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352921",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
Just checked you need to `_add_` one directory level to the gentoo patch. That is

```
--- Lib/_osx_support.py
+++ Lib/_osx_support.py
```
needs to become 

```
--- a/Lib/_osx_support.py
+++ b/Lib/_osx_support.py
```
and so on...



---

archive/issue_comments_352922.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [@kiwifb](#comment%3A19):\n> Just checked you need to `_add_` one directory level to the gentoo patch. That is\n> \n> ```\n> --- Lib/_osx_support.py\n> +++ Lib/_osx_support.py\n> ```\n> needs to become \n> \n> ```\n> --- a/Lib/_osx_support.py\n> +++ b/Lib/_osx_support.py\n> ```\n> and so on...\n\nOh, thanks, I've been blind...",
    "created_at": "2017-06-30T11:30:31Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352922",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>
Replying to [@kiwifb](#comment%3A19):
> Just checked you need to `_add_` one directory level to the gentoo patch. That is
> 
> ```
> --- Lib/_osx_support.py
> +++ Lib/_osx_support.py
> ```
> needs to become 
> 
> ```
> --- a/Lib/_osx_support.py
> +++ b/Lib/_osx_support.py
> ```
> and so on...

Oh, thanks, I've been blind...



---

archive/issue_comments_352923.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [@kiwifb](#comment%3A3):\n> OK :)\n> \n> The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.\n\nSomehow I cannot manage to achieve this; \nit all works if I do\n\n```\nCXXFLAGS=\"-std=c++11\" ./sage -f lcalc\n```\nbut somehow does not work if I put into spkg-install\n\n```\n$MAKE CXXFLAGS=\"-std=c++11\"\n```\n\nsome evil Makefile magic that escapes me here. :-(",
    "created_at": "2017-07-01T23:49:03Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352923",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:21'></a>
Replying to [@kiwifb](#comment%3A3):
> OK :)
> 
> The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.

Somehow I cannot manage to achieve this; 
it all works if I do

```
CXXFLAGS="-std=c++11" ./sage -f lcalc
```
but somehow does not work if I put into spkg-install

```
$MAKE CXXFLAGS="-std=c++11"
```

some evil Makefile magic that escapes me here. :-(



---

archive/issue_comments_352924.json:
```json
{
    "body": "<a id='comment:22'></a>\nMost other `spkg-install` do something like\n\n```\nCXXFLAGS=\"-std=c++11 ${CXXFLAGS}\"\nexport CXXFLAGS\n$MAKE\n```",
    "created_at": "2017-07-01T23:52:33Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352924",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:22'></a>
Most other `spkg-install` do something like

```
CXXFLAGS="-std=c++11 ${CXXFLAGS}"
export CXXFLAGS
$MAKE
```



---

archive/issue_comments_352925.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [@kiwifb](#comment%3A22):\n> Most other `spkg-install` do something like\n> \n> ```\n> CXXFLAGS=\"-std=c++11 ${CXXFLAGS}\"\n> export CXXFLAGS\n> $MAKE\n> ```\n\nno difference, it still does not work. It might be due to the Makefile modifying\nCXXFLAGS: it does\n\n```\nCXXFLAGS := -O3 $(OPENMP_FLAG) $(PREPROCESSOR_DEFINE) $(MACHINE_SPECIFIC_FLAGS) $(EXTRA) $(CXXFLAGS)\n```",
    "created_at": "2017-07-01T23:58:26Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352925",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>
Replying to [@kiwifb](#comment%3A22):
> Most other `spkg-install` do something like
> 
> ```
> CXXFLAGS="-std=c++11 ${CXXFLAGS}"
> export CXXFLAGS
> $MAKE
> ```

no difference, it still does not work. It might be due to the Makefile modifying
CXXFLAGS: it does

```
CXXFLAGS := -O3 $(OPENMP_FLAG) $(PREPROCESSOR_DEFINE) $(MACHINE_SPECIFIC_FLAGS) $(EXTRA) $(CXXFLAGS)
```



---

archive/issue_comments_352926.json:
```json
{
    "body": "<a id='comment:24'></a>\nI don't know:\n\n* bash bug? (version 4.4.12(1))\n* make bug? (4.2.1)\n\nwill try on something older...",
    "created_at": "2017-07-02T00:17:13Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352926",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>
I don't know:

* bash bug? (version 4.4.12(1))
* make bug? (4.2.1)

will try on something older...



---

archive/issue_comments_352927.json:
```json
{
    "body": "<a id='comment:25'></a>\nlogs please.",
    "created_at": "2017-07-02T01:36:50Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352927",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:25'></a>
logs please.



---

archive/issue_events_207750.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-07-02T07:34:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "component: number theory",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207750"
}
```



---

archive/issue_comments_352928.json:
```json
{
    "body": "<a id='comment:26'></a>\nI'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?",
    "created_at": "2017-07-02T07:34:17Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352928",
    "user": "https://github.com/rwst"
}
```

<a id='comment:26'></a>
I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?



---

archive/issue_events_207751.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-07-02T07:34:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207751"
}
```



---

archive/issue_events_207752.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-07-02T07:34:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207752"
}
```



---

archive/issue_events_207753.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-07-02T07:34:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207753"
}
```



---

archive/issue_comments_352929.json:
```json
{
    "body": "**Changing dependencies** from \"#12426\" to \"\".",
    "created_at": "2017-07-02T07:34:17Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352929",
    "user": "https://github.com/rwst"
}
```

**Changing dependencies** from "#12426" to "".



---

archive/issue_comments_352930.json:
```json
{
    "body": "<a id='comment:27'></a>\nthis is the branch, as here are the results of running \n\n```\n./sage -f lcalc\n```\nhttp://users.ox.ac.uk/~coml0531/sage/lcalc-1.23.p16.log\n\nvs the result of running\n\n```\nCXXFLAGS=\"-std=c++11\" ./sage -f lcalc\n```\nhttp://users.ox.ac.uk/~coml0531/sage/externalCXXFLAGS_lcalc-1.23.p16.log\n\nAs you see in the 1st log CXXFLAGS are ignored.\nTested on Fedora25 as well as on Gentoo.\nWhat am I missing?!!\n\nPS. F25 bash is 4.3.43(1)-release, and make is 4.1.",
    "created_at": "2017-07-02T07:38:39Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352930",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>
this is the branch, as here are the results of running 

```
./sage -f lcalc
```
http://users.ox.ac.uk/~coml0531/sage/lcalc-1.23.p16.log

vs the result of running

```
CXXFLAGS="-std=c++11" ./sage -f lcalc
```
http://users.ox.ac.uk/~coml0531/sage/externalCXXFLAGS_lcalc-1.23.p16.log

As you see in the 1st log CXXFLAGS are ignored.
Tested on Fedora25 as well as on Gentoo.
What am I missing?!!

PS. F25 bash is 4.3.43(1)-release, and make is 4.1.



---

archive/issue_comments_352931.json:
```json
{
    "body": "**Changing commit** from \"[14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee](https://github.com/sagemath/sagetrac-mirror/commit/14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee)\" to \"[666d6a3d3de0d80ff8730dd3320f182b6f21368b](https://github.com/sagemath/sagetrac-mirror/commit/666d6a3d3de0d80ff8730dd3320f182b6f21368b)\".",
    "created_at": "2017-07-02T07:38:39Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352931",
    "user": "https://github.com/dimpase"
}
```

**Changing commit** from "[14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee](https://github.com/sagemath/sagetrac-mirror/commit/14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee)" to "[666d6a3d3de0d80ff8730dd3320f182b6f21368b](https://github.com/sagemath/sagetrac-mirror/commit/666d6a3d3de0d80ff8730dd3320f182b6f21368b)".



---

archive/issue_comments_352932.json:
```json
{
    "body": "**Changing branch** from \"[u/dimpase/lcalc_c11](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/lcalc_c11)\" to \"[u/dimpase/lcalc_cxx11](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/lcalc_cxx11)\".",
    "created_at": "2017-07-02T07:38:39Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352932",
    "user": "https://github.com/dimpase"
}
```

**Changing branch** from "[u/dimpase/lcalc_c11](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/lcalc_c11)" to "[u/dimpase/lcalc_cxx11](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/lcalc_cxx11)".



---

archive/issue_comments_352933.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [@rwst](#comment%3A26):\n> I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?\n\nIt's done here, the problem which remains is to fight the makefile madness\n\nThere will be more similar C++ \"fun\" for gfan (I have a patch, but it produces lots of test errors), giac... I'll cc you on these tickets as they appear.",
    "created_at": "2017-07-02T07:41:17Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352933",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'></a>
Replying to [@rwst](#comment%3A26):
> I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?

It's done here, the problem which remains is to fight the makefile madness

There will be more similar C++ "fun" for gfan (I have a patch, but it produces lots of test errors), giac... I'll cc you on these tickets as they appear.



---

archive/issue_comments_352934.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [@rwst](#comment%3A26):\n> I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?\n\nNo.",
    "created_at": "2017-07-02T07:44:40Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352934",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:29'></a>
Replying to [@rwst](#comment%3A26):
> I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?

No.



---

archive/issue_comments_352935.json:
```json
{
    "body": "<a id='comment:30'></a>\nlet us make one on github.",
    "created_at": "2017-07-02T07:52:32Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352935",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:30'></a>
let us make one on github.



---

archive/issue_comments_352936.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [@dimpase](#comment%3A28):\n> There will be more similar C++ \"fun\" for gfan (I have a patch, but it produces lots of test errors), giac... I'll cc you on these tickets as they appear.\n\nNote BTW there is gfan-0.6 now.",
    "created_at": "2017-07-02T07:55:13Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352936",
    "user": "https://github.com/rwst"
}
```

<a id='comment:31'></a>
Replying to [@dimpase](#comment%3A28):
> There will be more similar C++ "fun" for gfan (I have a patch, but it produces lots of test errors), giac... I'll cc you on these tickets as they appear.

Note BTW there is gfan-0.6 now.



---

archive/issue_comments_352937.json:
```json
{
    "body": "<a id='comment:32'></a>\nin fact, a lcalc repo is here : https://code.google.com/archive/p/l-calc/\n\nlast commit is from 2014, but it's newer than what we use, \nsee http://oto.math.uwaterloo.ca/~mrubinst/L_function_public/CODE/",
    "created_at": "2017-07-02T07:59:47Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352937",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:32'></a>
in fact, a lcalc repo is here : https://code.google.com/archive/p/l-calc/

last commit is from 2014, but it's newer than what we use, 
see http://oto.math.uwaterloo.ca/~mrubinst/L_function_public/CODE/



---

archive/issue_comments_352938.json:
```json
{
    "body": "<a id='comment:33'></a>\nI just did one for gfan: https://github.com/rwst/gfan06",
    "created_at": "2017-07-02T08:08:08Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352938",
    "user": "https://github.com/rwst"
}
```

<a id='comment:33'></a>
I just did one for gfan: https://github.com/rwst/gfan06



---

archive/issue_comments_352939.json:
```json
{
    "body": "<a id='comment:34'></a>\nThis is quite peculiar. Looking more closely, even the section for OS X in spkg-install, doesn't work properly\n\n```\nif [ \"$UNAME\" = \"Darwin\" ]; then\n    export LDFLAGS=\"$LDFLAGS -Wl,-headerpad_max_install_names\"\nfi\n```\nwe still get the right thing because there is darwin section in the makefile but the `export` above doesn't work.",
    "created_at": "2017-07-02T08:31:30Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352939",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:34'></a>
This is quite peculiar. Looking more closely, even the section for OS X in spkg-install, doesn't work properly

```
if [ "$UNAME" = "Darwin" ]; then
    export LDFLAGS="$LDFLAGS -Wl,-headerpad_max_install_names"
fi
```
we still get the right thing because there is darwin section in the makefile but the `export` above doesn't work.



---

archive/issue_comments_352940.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [@dimpase](#comment%3A32):\n> in fact, a lcalc repo is here : https://code.google.com/archive/p/l-calc/\n> \n> last commit is from 2014, but it's newer than what we use, \n> see http://oto.math.uwaterloo.ca/~mrubinst/L_function_public/CODE/\n\nI've imported the code.google (hg) repo into git, here:\nhttps://github.com/dimpase/lcalc\n\nI'll try merging Sage's changes there.",
    "created_at": "2017-07-03T09:43:41Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352940",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'></a>
Replying to [@dimpase](#comment%3A32):
> in fact, a lcalc repo is here : https://code.google.com/archive/p/l-calc/
> 
> last commit is from 2014, but it's newer than what we use, 
> see http://oto.math.uwaterloo.ca/~mrubinst/L_function_public/CODE/

I've imported the code.google (hg) repo into git, here:
https://github.com/dimpase/lcalc

I'll try merging Sage's changes there.



---

archive/issue_comments_352941.json:
```json
{
    "body": "<a id='comment:36'></a>\nThat repo code is different enough and `clang-check` gives lots of errors. If we do this together, how to coordinate?",
    "created_at": "2017-07-03T13:09:46Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352941",
    "user": "https://github.com/rwst"
}
```

<a id='comment:36'></a>
That repo code is different enough and `clang-check` gives lots of errors. If we do this together, how to coordinate?



---

archive/issue_comments_352942.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [@rwst](#comment%3A36):\n> That repo code is different enough and `clang-check` gives lots of errors. If we do this together, how to coordinate?\n\nIf you like to take the lead on this, please go ahead---I have my hands full with other things.",
    "created_at": "2017-07-03T13:17:51Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352942",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>
Replying to [@rwst](#comment%3A36):
> That repo code is different enough and `clang-check` gives lots of errors. If we do this together, how to coordinate?

If you like to take the lead on this, please go ahead---I have my hands full with other things.



---

archive/issue_comments_352943.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [@dimpase](#comment%3A37):\n> If you like to take the lead on this, please go ahead---I have my hands full with other things.\n\nNP. Actual code changes will go in a PR.",
    "created_at": "2017-07-03T13:20:07Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352943",
    "user": "https://github.com/rwst"
}
```

<a id='comment:38'></a>
Replying to [@dimpase](#comment%3A37):
> If you like to take the lead on this, please go ahead---I have my hands full with other things.

NP. Actual code changes will go in a PR.



---

archive/issue_comments_352944.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [@rwst](#comment%3A38):\n> NP. Actual code changes will go in a PR.\n\nhttps://github.com/dimpase/lcalc/pull/1\n\nPlease review. I haven't worked on upgrading the Sage package, nor have I tested functionality.",
    "created_at": "2017-07-03T15:04:09Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352944",
    "user": "https://github.com/rwst"
}
```

<a id='comment:39'></a>
Replying to [@rwst](#comment%3A38):
> NP. Actual code changes will go in a PR.

https://github.com/dimpase/lcalc/pull/1

Please review. I haven't worked on upgrading the Sage package, nor have I tested functionality.



---

archive/issue_comments_352945.json:
```json
{
    "body": "<a id='comment:40'></a>\nTwo questions about this ticket:\n\n1. Is it about lcalc itself, Sage modules using lcalc, or both?\n\n2. Instead of porting lcalc to C++11, is it an option to force `-std=c++98` instead?",
    "created_at": "2017-09-22T12:05:59Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352945",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>
Two questions about this ticket:

1. Is it about lcalc itself, Sage modules using lcalc, or both?

2. Instead of porting lcalc to C++11, is it an option to force `-std=c++98` instead?



---

archive/issue_comments_352946.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n-    porting lcalc to C++11\n+lcalc doesn't use standard C++:\n+\n+- `using namespace std;` needs an include with stuff from `std::` before it\n     \n-* \"using namespace std;\" need an include with stuff from std:: before it\n+- `typeof` is a gcc extension - C++11 has `decltype` instead\n     \n-* \"typeof\" is a gcc extension - C++11 has \"decltype\" instead\n-    \n-* plain C must not be compiled with C++ compiler - thus a makefile change\n+- plain C must not be compiled with C++ compiler - thus a makefile change\n \n``````\n",
    "created_at": "2017-09-22T12:14:31Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352946",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
-    porting lcalc to C++11
+lcalc doesn't use standard C++:
+
+- `using namespace std;` needs an include with stuff from `std::` before it
     
-* "using namespace std;" need an include with stuff from std:: before it
+- `typeof` is a gcc extension - C++11 has `decltype` instead
     
-* "typeof" is a gcc extension - C++11 has "decltype" instead
-    
-* plain C must not be compiled with C++ compiler - thus a makefile change
+- plain C must not be compiled with C++ compiler - thus a makefile change
 
``````




---

archive/issue_comments_352947.json:
```json
{
    "body": "<a id='comment:41'></a>\nHmm, maybe it's not a matter of porting to C++**11**, but just porting to proper C++ instead. At least `src/sage/libs/lcalc/lcalc_Lfunction.pyx` doesn't compile with `-std=c++98` either: it requires either `-std=gnu++98` or `-std=gnu++11`.",
    "created_at": "2017-09-22T12:14:31Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352947",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>
Hmm, maybe it's not a matter of porting to C++**11**, but just porting to proper C++ instead. At least `src/sage/libs/lcalc/lcalc_Lfunction.pyx` doesn't compile with `-std=c++98` either: it requires either `-std=gnu++98` or `-std=gnu++11`.



---

archive/issue_comments_352948.json:
```json
{
    "body": "<a id='comment:42'></a>\nReplying to [@kiwifb](#comment%3A13):\n> I think Dima started this with the view of compiling sage with `-std=c++11`. If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.\n\nI created #7028 for that.",
    "created_at": "2017-09-22T13:34:41Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352948",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>
Replying to [@kiwifb](#comment%3A13):
> I think Dima started this with the view of compiling sage with `-std=c++11`. If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.

I created #7028 for that.



---

archive/issue_comments_352949.json:
```json
{
    "body": "<a id='comment:43'></a>\nThere is one more thing to add here; there is a macro `double(x)` defined in `include/Lcommon.h`, which does not seem to be used anywhere, and which causes havoc sometimes, e.g. if I try building with gcc on FreeBSD (due to cephes present)\n\nAnyway, hey, redefining a language keyword, yuck...",
    "created_at": "2017-09-24T20:02:42Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352949",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:43'></a>
There is one more thing to add here; there is a macro `double(x)` defined in `include/Lcommon.h`, which does not seem to be used anywhere, and which causes havoc sometimes, e.g. if I try building with gcc on FreeBSD (due to cephes present)

Anyway, hey, redefining a language keyword, yuck...



---

archive/issue_comments_352950.json:
```json
{
    "body": "<a id='comment:44'></a>\nBecause of what I logged in my comments in #23898 it looks like current lcalc does not compile on OpenSuSE systems with system gcc-5.3.1. A patch is at [#23898 comment:39](https://github.com/sagemath/sage/issues/23898#comment:39).",
    "created_at": "2017-10-07T16:06:10Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352950",
    "user": "https://github.com/rwst"
}
```

<a id='comment:44'></a>
Because of what I logged in my comments in #23898 it looks like current lcalc does not compile on OpenSuSE systems with system gcc-5.3.1. A patch is at [#23898 comment:39](https://github.com/sagemath/sage/issues/23898#comment:39).



---

archive/issue_comments_352951.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [@dimpase](#comment%3A43):\n> There is one more thing to add here; there is a macro `double(x)` defined in `include/Lcommon.h`, which does not seem to be used anywhere, and which causes havoc sometimes, e.g. if I try building with gcc on FreeBSD (due to cephes present)\n\nThis is outcommented in the github lcalc version which also, with the above PR, passes clang-check. It looks like an improvement. OTOH this ticket seems no longer pressing, as the Sage version compiles with clang too.\n\nThe attempt to replace Sage's lcalc with Pari (#24532) was dropped, so maybe it's an idea to at least upgrade it to the github version?",
    "created_at": "2018-02-19T16:06:22Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352951",
    "user": "https://github.com/rwst"
}
```

<a id='comment:45'></a>
Replying to [@dimpase](#comment%3A43):
> There is one more thing to add here; there is a macro `double(x)` defined in `include/Lcommon.h`, which does not seem to be used anywhere, and which causes havoc sometimes, e.g. if I try building with gcc on FreeBSD (due to cephes present)

This is outcommented in the github lcalc version which also, with the above PR, passes clang-check. It looks like an improvement. OTOH this ticket seems no longer pressing, as the Sage version compiles with clang too.

The attempt to replace Sage's lcalc with Pari (#24532) was dropped, so maybe it's an idea to at least upgrade it to the github version?



---

archive/issue_comments_352952.json:
```json
{
    "body": "<a id='comment:46'></a>\nI am all for it, but I'm a bit lost here. What stage are we at?",
    "created_at": "2018-02-21T14:43:05Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352952",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:46'></a>
I am all for it, but I'm a bit lost here. What stage are we at?



---

archive/issue_comments_352953.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [@dimpase](#comment%3A46):\n> What stage are we at? \n\nThis is the first ticket that mentions the 2014 version at all I think.",
    "created_at": "2018-02-21T15:03:40Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352953",
    "user": "https://github.com/rwst"
}
```

<a id='comment:47'></a>
Replying to [@dimpase](#comment%3A46):
> What stage are we at? 

This is the first ticket that mentions the 2014 version at all I think.



---

archive/issue_comments_352954.json:
```json
{
    "body": "<a id='comment:48'></a>\nThere is mention in [#11321 comment:8](https://github.com/sagemath/sage/issues/11321#comment:8) but this is only because patches were sent upstream.",
    "created_at": "2018-02-21T15:18:03Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352954",
    "user": "https://github.com/rwst"
}
```

<a id='comment:48'></a>
There is mention in [#11321 comment:8](https://github.com/sagemath/sage/issues/11321#comment:8) but this is only because patches were sent upstream.



---

archive/issue_comments_352955.json:
```json
{
    "body": "<a id='comment:49'></a>\nThe github version defines itself in `CHANGE.LOG` and `include/cmdline.h` as v. 1.3, so we might stick to that and add something. I mean with that the name of the tarball later distributed, not our Sage patchlevel. I personally prefer ISO dates like 20180223 whenever possible.",
    "created_at": "2018-02-21T15:32:15Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352955",
    "user": "https://github.com/rwst"
}
```

<a id='comment:49'></a>
The github version defines itself in `CHANGE.LOG` and `include/cmdline.h` as v. 1.3, so we might stick to that and add something. I mean with that the name of the tarball later distributed, not our Sage patchlevel. I personally prefer ISO dates like 20180223 whenever possible.



---

archive/issue_comments_352956.json:
```json
{
    "body": "<a id='comment:50'></a>\nReplying to [@rwst](#comment%3A49):\n> I personally prefer ISO dates like 20180223 whenever possible.\n\nWhat does the date refer to? If you are packaging something which does not have a naturally defined date, I wouldn't use a date. For packages created from a git repo, better use a git commit hash.",
    "created_at": "2018-02-21T15:38:33Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352956",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'></a>
Replying to [@rwst](#comment%3A49):
> I personally prefer ISO dates like 20180223 whenever possible.

What does the date refer to? If you are packaging something which does not have a naturally defined date, I wouldn't use a date. For packages created from a git repo, better use a git commit hash.



---

archive/issue_comments_352957.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [@jdemeyer](#comment%3A50):\n> For packages created from a git repo, better use a git commit hash.\n\nThat's fine too.",
    "created_at": "2018-02-21T15:40:30Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352957",
    "user": "https://github.com/rwst"
}
```

<a id='comment:51'></a>
Replying to [@jdemeyer](#comment%3A50):
> For packages created from a git repo, better use a git commit hash.

That's fine too.



---

archive/issue_comments_352958.json:
```json
{
    "body": "<a id='comment:52'></a>\nThe changes to install the package without patches are now added to\nhttps://github.com/dimpase/lcalc/pull/1\nwhich eventually needs a review. ATM Sage does NOT build with it as compilation of the Cython module fails.\n\nOne problem worked around was that the use of FP type (double,mpfr,etc..) can be given to make but is not fixed in a header like with conf.h in other packages. I have hardcoded the type used until now (double) but this is an issue.",
    "created_at": "2018-02-22T10:04:27Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352958",
    "user": "https://github.com/rwst"
}
```

<a id='comment:52'></a>
The changes to install the package without patches are now added to
https://github.com/dimpase/lcalc/pull/1
which eventually needs a review. ATM Sage does NOT build with it as compilation of the Cython module fails.

One problem worked around was that the use of FP type (double,mpfr,etc..) can be given to make but is not fixed in a header like with conf.h in other packages. I have hardcoded the type used until now (double) but this is an issue.



---

archive/issue_comments_352959.json:
```json
{
    "body": "<a id='comment:53'></a>\nI've just looked at the pull request again - do you see my comments there?",
    "created_at": "2018-02-22T11:12:59Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352959",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:53'></a>
I've just looked at the pull request again - do you see my comments there?



---

archive/issue_comments_352960.json:
```json
{
    "body": "<a id='comment:54'></a>\nReplying to [@dimpase](#comment%3A53):\n> I've just looked at the pull request again - do you see my comments there?\n\nYes, I have answered there.",
    "created_at": "2018-02-22T13:58:05Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352960",
    "user": "https://github.com/rwst"
}
```

<a id='comment:54'></a>
Replying to [@dimpase](#comment%3A53):
> I've just looked at the pull request again - do you see my comments there?

Yes, I have answered there.



---

archive/issue_comments_352961.json:
```json
{
    "body": "<a id='comment:55'></a>\nI opened #24280 with the changes on the Sage side. Testing yields mostly tolerance exceeded but also some different values that need a look.",
    "created_at": "2018-02-22T14:44:04Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352961",
    "user": "https://github.com/rwst"
}
```

<a id='comment:55'></a>
I opened #24280 with the changes on the Sage side. Testing yields mostly tolerance exceeded but also some different values that need a look.



---

archive/issue_comments_352962.json:
```json
{
    "body": "<a id='comment:56'></a>\nReplying to [@rwst](#comment%3A55):\n> I opened #24280 with the changes on the Sage side. Testing yields mostly tolerance exceeded but also some different values that need a look.\n\nseems to be wrong reference, what is the correct ticket?",
    "created_at": "2018-02-22T20:20:08Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352962",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:56'></a>
Replying to [@rwst](#comment%3A55):
> I opened #24280 with the changes on the Sage side. Testing yields mostly tolerance exceeded but also some different values that need a look.

seems to be wrong reference, what is the correct ticket?



---

archive/issue_comments_352963.json:
```json
{
    "body": "<a id='comment:57'></a>\nPlease see #24820.",
    "created_at": "2018-02-23T06:30:43Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352963",
    "user": "https://github.com/rwst"
}
```

<a id='comment:57'></a>
Please see #24820.



---

archive/issue_comments_352964.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"lcalc\".",
    "created_at": "2018-02-24T12:46:35Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352964",
    "user": "https://github.com/fchapoton"
}
```

**Changing keywords** from "" to "lcalc".



---

archive/issue_comments_352965.json:
```json
{
    "body": "<a id='comment:59'></a>\nThe ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?",
    "created_at": "2018-07-10T12:12:18Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352965",
    "user": "https://github.com/timokau"
}
```

<a id='comment:59'></a>
The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?



---

archive/issue_comments_352966.json:
```json
{
    "body": "<a id='comment:60'></a>\nReplying to [@timokau](#comment%3A59):\n> The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?\n\nI think #24820 is the newer attempt. It would be necessary to agree that either the Hardy-Z function is not defined for complex argument or lcalc is unable to compute the case. As I said in #24820, I have no idea about the usefulness of complex argument results. Do you?",
    "created_at": "2018-07-10T12:45:10Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352966",
    "user": "https://github.com/rwst"
}
```

<a id='comment:60'></a>
Replying to [@timokau](#comment%3A59):
> The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?

I think #24820 is the newer attempt. It would be necessary to agree that either the Hardy-Z function is not defined for complex argument or lcalc is unable to compute the case. As I said in #24820, I have no idea about the usefulness of complex argument results. Do you?



---

archive/issue_comments_352967.json:
```json
{
    "body": "<a id='comment:61'></a>\nReplying to [@timokau](#comment%3A59):\n> The ntl upgrade (#25532) depends on this.\n\nAs I said on that ticket, the dependency itself could be considered a bug. It is probably easier to remove the dependency than fixing lcalc.",
    "created_at": "2018-07-10T12:50:19Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352967",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:61'></a>
Replying to [@timokau](#comment%3A59):
> The ntl upgrade (#25532) depends on this.

As I said on that ticket, the dependency itself could be considered a bug. It is probably easier to remove the dependency than fixing lcalc.



---

archive/issue_comments_352968.json:
```json
{
    "body": "<a id='comment:62'></a>\nReplying to [@rwst](#comment%3A60):\n> Replying to [@timokau](#comment%3A59):\n> > The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?\n\n> \n> I think #24820 is the newer attempt. It would be necessary to agree that either the Hardy-Z function is not defined for complex argument or lcalc is unable to compute the case. As I said in #24820, I have no idea about the usefulness of complex argument results. Do you?\n\nUnfortunately I don't :/\n\nReplying to [@jdemeyer](#comment%3A61):\n> Replying to [@timokau](#comment%3A59):\n> > The ntl upgrade (#25532) depends on this.\n\n> \n> As I said on that ticket, the dependency itself could be considered a bug. It is probably easier to remove the dependency than fixing lcalc.\n\nAt least that would fix #25532. Isn't the dependency there for a reason?",
    "created_at": "2018-07-10T14:42:25Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352968",
    "user": "https://github.com/timokau"
}
```

<a id='comment:62'></a>
Replying to [@rwst](#comment%3A60):
> Replying to [@timokau](#comment%3A59):
> > The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?

> 
> I think #24820 is the newer attempt. It would be necessary to agree that either the Hardy-Z function is not defined for complex argument or lcalc is unable to compute the case. As I said in #24820, I have no idea about the usefulness of complex argument results. Do you?

Unfortunately I don't :/

Replying to [@jdemeyer](#comment%3A61):
> Replying to [@timokau](#comment%3A59):
> > The ntl upgrade (#25532) depends on this.

> 
> As I said on that ticket, the dependency itself could be considered a bug. It is probably easier to remove the dependency than fixing lcalc.

At least that would fix #25532. Isn't the dependency there for a reason?



---

archive/issue_comments_352969.json:
```json
{
    "body": "<a id='comment:63'></a>\nI think it is time we move forward with this again. I think this ticket should also include the matching patch from arch in sagelib https://git.archlinux.org/svntogit/community.git/plain/trunk/sagemath-lcalc-c++11.patch?h=packages/sagemath&id=0e31ae526ab7c6b5c0bfacb3f8b1c4fd490035aa so that we really are just using C++11 and allow us to make progress on #25532.\n\nAny objections to moving forward with what we have now?",
    "created_at": "2018-10-31T00:56:22Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352969",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:63'></a>
I think it is time we move forward with this again. I think this ticket should also include the matching patch from arch in sagelib https://git.archlinux.org/svntogit/community.git/plain/trunk/sagemath-lcalc-c++11.patch?h=packages/sagemath&id=0e31ae526ab7c6b5c0bfacb3f8b1c4fd490035aa so that we really are just using C++11 and allow us to make progress on #25532.

Any objections to moving forward with what we have now?



---

archive/issue_comments_352970.json:
```json
{
    "body": "<a id='comment:64'></a>\nYes this need the extra patch from arch I quoted. Otherwise sage's compilation fails because lcalc is no using construct that don't exist in gnu++98.",
    "created_at": "2018-10-31T20:32:49Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352970",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:64'></a>
Yes this need the extra patch from arch I quoted. Otherwise sage's compilation fails because lcalc is no using construct that don't exist in gnu++98.



---

archive/issue_events_207754.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-10-31T22:37:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207754"
}
```



---

archive/issue_events_207755.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-10-31T22:37:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207755"
}
```



---

archive/issue_comments_352971.json:
```json
{
    "body": "<a id='comment:65'></a>\nLast call for patches. Please someone review. It would be good to have this in the next beta and be able to move on to #25532 and get it all done for 8.5.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/108d5817f524a214e133198a75bf22c9cc7080b8\">108d581</a></td><td><code>Merge branch 'develop' into lcalc_cxx11</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/834e7a6eb3c607a9ddd6fd384e0ca4b3bfd701a1\">834e7a6</a></td><td><code>lcalc version bump for rebuild</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/837732e21257e3d2ad14bff15424ea9cae197e1b\">837732e</a></td><td><code>remove enforcement of gnu++98 in lcalc bindings</code></td></tr></table>\n",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352971",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:65'></a>
Last call for patches. Please someone review. It would be good to have this in the next beta and be able to move on to #25532 and get it all done for 8.5.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/108d5817f524a214e133198a75bf22c9cc7080b8">108d581</a></td><td><code>Merge branch 'develop' into lcalc_cxx11</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/834e7a6eb3c607a9ddd6fd384e0ca4b3bfd701a1">834e7a6</a></td><td><code>lcalc version bump for rebuild</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/837732e21257e3d2ad14bff15424ea9cae197e1b">837732e</a></td><td><code>remove enforcement of gnu++98 in lcalc bindings</code></td></tr></table>




---

archive/issue_comments_352972.json:
```json
{
    "body": "**Changing commit** from \"[666d6a3d3de0d80ff8730dd3320f182b6f21368b](https://github.com/sagemath/sagetrac-mirror/commit/666d6a3d3de0d80ff8730dd3320f182b6f21368b)\" to \"[837732e21257e3d2ad14bff15424ea9cae197e1b](https://github.com/sagemath/sagetrac-mirror/commit/837732e21257e3d2ad14bff15424ea9cae197e1b)\".",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352972",
    "user": "https://github.com/kiwifb"
}
```

**Changing commit** from "[666d6a3d3de0d80ff8730dd3320f182b6f21368b](https://github.com/sagemath/sagetrac-mirror/commit/666d6a3d3de0d80ff8730dd3320f182b6f21368b)" to "[837732e21257e3d2ad14bff15424ea9cae197e1b](https://github.com/sagemath/sagetrac-mirror/commit/837732e21257e3d2ad14bff15424ea9cae197e1b)".



---

archive/issue_comments_352973.json:
```json
{
    "body": "**Author:** Dima Pasechnik, Fran\u00e7ois Bissey",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352973",
    "user": "https://github.com/kiwifb"
}
```

**Author:** Dima Pasechnik, François Bissey



---

archive/issue_events_207756.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-10-31T22:37:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207756"
}
```



---

archive/issue_comments_352974.json:
```json
{
    "body": "**Changing branch** from \"[u/dimpase/lcalc_cxx11](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/lcalc_cxx11)\" to \"[u/fbissey/lcalc_cxx11](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/lcalc_cxx11)\".",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352974",
    "user": "https://github.com/kiwifb"
}
```

**Changing branch** from "[u/dimpase/lcalc_cxx11](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/lcalc_cxx11)" to "[u/fbissey/lcalc_cxx11](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/lcalc_cxx11)".



---

archive/issue_comments_352975.json:
```json
{
    "body": "<a id='comment:66'></a>\nAnyone interested in reviewing this?",
    "created_at": "2018-11-13T07:13:57Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352975",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:66'></a>
Anyone interested in reviewing this?



---

archive/issue_comments_352976.json:
```json
{
    "body": "<a id='comment:67'></a>\n1. Can you add some rationale for the changes to `Makefile`?\n\n2. I wouldn't make style changes such as\n\n```diff\n-\t\tloop(i,this->N,N)\n-\t\t\tcoeffs[i]=zero;\n+\t\tloop(i,this->N,N) coeffs[i]=zero;\n```",
    "created_at": "2018-11-13T09:41:42Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352976",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:67'></a>
1. Can you add some rationale for the changes to `Makefile`?

2. I wouldn't make style changes such as

```diff
-		loop(i,this->N,N)
-			coeffs[i]=zero;
+		loop(i,this->N,N) coeffs[i]=zero;
```



---

archive/issue_comments_352977.json:
```json
{
    "body": "<a id='comment:68'></a>\nReplying to [@kiwifb](#comment%3A65):\n> It would be good to have this in the next beta and be able to move on to #25532\n\nAs I mentioned multiple times, I don't really think that #25532 must depend on this.",
    "created_at": "2018-11-13T09:42:11Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352977",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:68'></a>
Replying to [@kiwifb](#comment%3A65):
> It would be good to have this in the next beta and be able to move on to #25532

As I mentioned multiple times, I don't really think that #25532 must depend on this.



---

archive/issue_events_207757.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-11-13T09:42:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207757"
}
```



---

archive/issue_events_207758.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2018-11-13T09:42:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207758"
}
```



---

archive/issue_comments_352978.json:
```json
{
    "body": "<a id='comment:70'></a>\nReplying to [@jdemeyer](#comment%3A68):\n> Replying to [@kiwifb](#comment%3A65):\n> > It would be good to have this in the next beta and be able to move on to #25532\n\n> \n> As I mentioned multiple times, I don't really think that #25532 must depend on this.\n\nWell, I tried to see if I could up ntl separately in sage-on-gentoo and sage wouldn't compile. It could be that I can tweak ntl's configuration to be compatible (at possible cost in ntl internal) but I'd rather get rid of the last bit of sage that is c++11 resistant (I think) and go with the natural flow again.",
    "created_at": "2018-11-13T09:50:11Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352978",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:70'></a>
Replying to [@jdemeyer](#comment%3A68):
> Replying to [@kiwifb](#comment%3A65):
> > It would be good to have this in the next beta and be able to move on to #25532

> 
> As I mentioned multiple times, I don't really think that #25532 must depend on this.

Well, I tried to see if I could up ntl separately in sage-on-gentoo and sage wouldn't compile. It could be that I can tweak ntl's configuration to be compatible (at possible cost in ntl internal) but I'd rather get rid of the last bit of sage that is c++11 resistant (I think) and go with the natural flow again.



---

archive/issue_comments_352979.json:
```json
{
    "body": "<a id='comment:71'></a>\nMinor nitpick: wouldn't it be cleaner to replace `decltype(m) i=(m)` by `auto i = (m)`?",
    "created_at": "2018-11-13T09:57:07Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352979",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:71'></a>
Minor nitpick: wouldn't it be cleaner to replace `decltype(m) i=(m)` by `auto i = (m)`?



---

archive/issue_comments_352980.json:
```json
{
    "body": "<a id='comment:72'></a>\nReplying to [@jdemeyer](#comment%3A71):\n> Minor nitpick: wouldn't it be cleaner to replace `decltype(m) i=(m)` by `auto i = (m)`?\n\nIt has indeed a better feel. A bit too late in the day for me to do any changes (safely), I'll go through your reviews in the morning.",
    "created_at": "2018-11-13T10:00:31Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352980",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:72'></a>
Replying to [@jdemeyer](#comment%3A71):
> Minor nitpick: wouldn't it be cleaner to replace `decltype(m) i=(m)` by `auto i = (m)`?

It has indeed a better feel. A bit too late in the day for me to do any changes (safely), I'll go through your reviews in the morning.



---

archive/issue_comments_352981.json:
```json
{
    "body": "<a id='comment:73'></a>\nReplying to [@kiwifb](#comment%3A72):\n> A bit too late in the day for me\n\nYou chose to live on the wrong side of the world :-)",
    "created_at": "2018-11-13T10:02:25Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352981",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:73'></a>
Replying to [@kiwifb](#comment%3A72):
> A bit too late in the day for me

You chose to live on the wrong side of the world :-)



---

archive/issue_comments_352982.json:
```json
{
    "body": "<a id='comment:74'></a>\nReplying to [@jdemeyer](#comment%3A73):\n> Replying to [@kiwifb](#comment%3A72):\n> > A bit too late in the day for me\n\n> \n> You chose to live on the wrong side of the world :-)\n\nWell it feels like it will be a nice summer. And not too hot, like our australian neighbors :-) but I really need to get some sleep now.",
    "created_at": "2018-11-13T10:06:17Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352982",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:74'></a>
Replying to [@jdemeyer](#comment%3A73):
> Replying to [@kiwifb](#comment%3A72):
> > A bit too late in the day for me

> 
> You chose to live on the wrong side of the world :-)

Well it feels like it will be a nice summer. And not too hot, like our australian neighbors :-) but I really need to get some sleep now.



---

archive/issue_comments_352983.json:
```json
{
    "body": "<a id='comment:75'></a>\nIn your `Makefile` patch, the rule `$(CC) $(CFLAGS) $(INCLUDEFILES) -c cmdline.c` is just the standard build rule for `.c` files (modulo the typo `$(CFLAGS)`->`$(CCFLAGS)`). So it might be better to just restore the comment.",
    "created_at": "2018-11-13T10:19:31Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352983",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:75'></a>
In your `Makefile` patch, the rule `$(CC) $(CFLAGS) $(INCLUDEFILES) -c cmdline.c` is just the standard build rule for `.c` files (modulo the typo `$(CFLAGS)`->`$(CCFLAGS)`). So it might be better to just restore the comment.



---

archive/issue_comments_352984.json:
```json
{
    "body": "<a id='comment:76'></a>\nOK some comments on the review from Jeroen which made me dig a bit deeper on the Makefile. I must say I adopted a slightly different approach in sage-on-gentoo so I don't have the same patch, but some of lesson learnt will definitely apply.\n\n* the original makefile defines CC as as g++ so that has to go.\n* Non standard flags like CCFLAGS are used, so Dima tried to use appropriate flags for both C and C++ compilers. And it also differentiate C and C++ flags which wasn't done before because even regular C code was passed to the C++ compiler.\n* The downside of using CFLAGS and CXXFLAGS inside the makefile is that regular options passed from the sage build system may need care if we want to inject them. That's a sage-on-gentoo difference I use `MYCXXFLAGS` so I can include whatever other flags we pass without worry.\n* Jeroen points out the standard rule for `.c` file should be used for `cmdline.c` except that the current patch erroneously define the rule as using CXXFLAGS instead of CFLAGS. Oopsie.\n\nPoint of difference with sage-on-gentoo: because pari headers are included in two files with `#include \"pari.h\"` the makefile has to define the location of pari headers and so do any code that include these headers. Decided that it was not worth it and patched to have `#include \"pari/pari.h\"` which is more sane and means that we don't have to worry about adding non standard includes. That means that I cut an extra bit of the makefile too. If people think that's a good idea I'll include that change in sage too.",
    "created_at": "2018-11-13T22:26:59Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352984",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:76'></a>
OK some comments on the review from Jeroen which made me dig a bit deeper on the Makefile. I must say I adopted a slightly different approach in sage-on-gentoo so I don't have the same patch, but some of lesson learnt will definitely apply.

* the original makefile defines CC as as g++ so that has to go.
* Non standard flags like CCFLAGS are used, so Dima tried to use appropriate flags for both C and C++ compilers. And it also differentiate C and C++ flags which wasn't done before because even regular C code was passed to the C++ compiler.
* The downside of using CFLAGS and CXXFLAGS inside the makefile is that regular options passed from the sage build system may need care if we want to inject them. That's a sage-on-gentoo difference I use `MYCXXFLAGS` so I can include whatever other flags we pass without worry.
* Jeroen points out the standard rule for `.c` file should be used for `cmdline.c` except that the current patch erroneously define the rule as using CXXFLAGS instead of CFLAGS. Oopsie.

Point of difference with sage-on-gentoo: because pari headers are included in two files with `#include "pari.h"` the makefile has to define the location of pari headers and so do any code that include these headers. Decided that it was not worth it and patched to have `#include "pari/pari.h"` which is more sane and means that we don't have to worry about adding non standard includes. That means that I cut an extra bit of the makefile too. If people think that's a good idea I'll include that change in sage too.



---

archive/issue_comments_352985.json:
```json
{
    "body": "<a id='comment:77'></a>\nReplying to [@kiwifb](#comment%3A76):\n> because pari headers are included in two files with `#include \"pari.h\"` the makefile has to define the location of pari headers and so do any code that include these headers. Decided that it was not worth it and patched to have `#include \"pari/pari.h\"` which is more sane and means that we don't have to worry about adding non standard includes. That means that I cut an extra bit of the makefile too. If people think that's a good idea I'll include that change in sage too.\n\nThat makes sense to me.",
    "created_at": "2018-11-14T06:35:18Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352985",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:77'></a>
Replying to [@kiwifb](#comment%3A76):
> because pari headers are included in two files with `#include "pari.h"` the makefile has to define the location of pari headers and so do any code that include these headers. Decided that it was not worth it and patched to have `#include "pari/pari.h"` which is more sane and means that we don't have to worry about adding non standard includes. That means that I cut an extra bit of the makefile too. If people think that's a good idea I'll include that change in sage too.

That makes sense to me.



---

archive/issue_comments_352986.json:
```json
{
    "body": "<a id='comment:78'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8190cef7b754eeec86a7ee12395f5aa69fb74733\">8190cef</a></td><td><code>Correct inclusion of pari header so no extra -I flags are required.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/71f8bf21c3db0dafb8276bf664f26fcb506f8614\">71f8bf2</a></td><td><code>update makefile patch and document it</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eb072d1119cd2305bb02cd8f8e00168e67f5cad6\">eb072d1</a></td><td><code>update the patch according to Jeroen's review. Add a correction of a \"std:\" which should have been \"std::\"</code></td></tr></table>\n",
    "created_at": "2018-11-14T21:58:40Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352986",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:78'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8190cef7b754eeec86a7ee12395f5aa69fb74733">8190cef</a></td><td><code>Correct inclusion of pari header so no extra -I flags are required.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/71f8bf21c3db0dafb8276bf664f26fcb506f8614">71f8bf2</a></td><td><code>update makefile patch and document it</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eb072d1119cd2305bb02cd8f8e00168e67f5cad6">eb072d1</a></td><td><code>update the patch according to Jeroen's review. Add a correction of a "std:" which should have been "std::"</code></td></tr></table>




---

archive/issue_comments_352987.json:
```json
{
    "body": "**Changing commit** from \"[837732e21257e3d2ad14bff15424ea9cae197e1b](https://github.com/sagemath/sagetrac-mirror/commit/837732e21257e3d2ad14bff15424ea9cae197e1b)\" to \"[eb072d1119cd2305bb02cd8f8e00168e67f5cad6](https://github.com/sagemath/sagetrac-mirror/commit/eb072d1119cd2305bb02cd8f8e00168e67f5cad6)\".",
    "created_at": "2018-11-14T21:58:40Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[837732e21257e3d2ad14bff15424ea9cae197e1b](https://github.com/sagemath/sagetrac-mirror/commit/837732e21257e3d2ad14bff15424ea9cae197e1b)" to "[eb072d1119cd2305bb02cd8f8e00168e67f5cad6](https://github.com/sagemath/sagetrac-mirror/commit/eb072d1119cd2305bb02cd8f8e00168e67f5cad6)".



---

archive/issue_comments_352988.json:
```json
{
    "body": "<a id='comment:79'></a>\nAll right back to review.",
    "created_at": "2018-11-14T22:00:28Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352988",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:79'></a>
All right back to review.



---

archive/issue_events_207759.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-11-14T22:00:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207759"
}
```



---

archive/issue_events_207760.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-11-14T22:00:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207760"
}
```



---

archive/issue_comments_352989.json:
```json
{
    "body": "<a id='comment:80'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a\">3fb7f80</a></td><td><code>std: was introduced in the clang patch. Correcting in that patch.</code></td></tr></table>\n",
    "created_at": "2018-11-14T22:31:44Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352989",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:80'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a">3fb7f80</a></td><td><code>std: was introduced in the clang patch. Correcting in that patch.</code></td></tr></table>




---

archive/issue_comments_352990.json:
```json
{
    "body": "**Changing commit** from \"[eb072d1119cd2305bb02cd8f8e00168e67f5cad6](https://github.com/sagemath/sagetrac-mirror/commit/eb072d1119cd2305bb02cd8f8e00168e67f5cad6)\" to \"[3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a](https://github.com/sagemath/sagetrac-mirror/commit/3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a)\".",
    "created_at": "2018-11-14T22:31:44Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352990",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[eb072d1119cd2305bb02cd8f8e00168e67f5cad6](https://github.com/sagemath/sagetrac-mirror/commit/eb072d1119cd2305bb02cd8f8e00168e67f5cad6)" to "[3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a](https://github.com/sagemath/sagetrac-mirror/commit/3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a)".



---

archive/issue_comments_352991.json:
```json
{
    "body": "<a id='comment:81'></a>\nSo many patches! It is hard to figure if the thing you patch was introduced by another patch :P",
    "created_at": "2018-11-14T22:33:38Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352991",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:81'></a>
So many patches! It is hard to figure if the thing you patch was introduced by another patch :P



---

archive/issue_comments_352992.json:
```json
{
    "body": "<a id='comment:82'></a>\nThis appears to work with clang 6.0.1, a good sign.",
    "created_at": "2018-11-17T13:18:08Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352992",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:82'></a>
This appears to work with clang 6.0.1, a good sign.



---

archive/issue_comments_352993.json:
```json
{
    "body": "<a id='comment:83'></a>\nReplying to [@dimpase](#comment%3A82):\n> This appears to work with clang 6.0.1, a good sign.\n\nI have checked clang-6 and gcc-8.2. Now if someone would put a kind review.\n\nAlthough Dima, I kept the patch name \"using_namespace_std.patch` but there is hardly any of that in there. Just removing GNU-ism. Did you have more stuff to do in mind?",
    "created_at": "2018-11-21T00:55:08Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352993",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:83'></a>
Replying to [@dimpase](#comment%3A82):
> This appears to work with clang 6.0.1, a good sign.

I have checked clang-6 and gcc-8.2. Now if someone would put a kind review.

Although Dima, I kept the patch name "using_namespace_std.patch` but there is hardly any of that in there. Just removing GNU-ism. Did you have more stuff to do in mind?



---

archive/issue_events_207761.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-11-21T11:01:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207761"
}
```



---

archive/issue_events_207762.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-11-21T11:01:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207762"
}
```



---

archive/issue_comments_352994.json:
```json
{
    "body": "<a id='comment:84'></a>\nOK",
    "created_at": "2018-11-21T11:01:45Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352994",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:84'></a>
OK



---

archive/issue_comments_352995.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik, Fran\u00e7ois Bissey, Jeroen Demeyer, Ralf Stephan",
    "created_at": "2018-11-21T11:01:45Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352995",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik, François Bissey, Jeroen Demeyer, Ralf Stephan



---

archive/issue_comments_352996.json:
```json
{
    "body": "<a id='comment:85'></a>\nThank you @kiwifb for pushing this forward, happy to have one less patch to apply :)",
    "created_at": "2018-11-21T11:09:21Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352996",
    "user": "https://github.com/timokau"
}
```

<a id='comment:85'></a>
Thank you @kiwifb for pushing this forward, happy to have one less patch to apply :)



---

archive/issue_events_207763.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-22T13:13:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207763"
}
```



---

archive/issue_events_207764.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-22T13:13:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207764"
}
```



---

archive/issue_comments_352997.json:
```json
{
    "body": "<a id='comment:86'></a>\nOn some machines this fails with:\n\n```\nmake libLfunction.so\nmake[5]: Entering directory '/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/lcalc-1.23.p17/src/src'\ng++ -O3   -ffast-math -fPIC   -I../include -c Lglobals.cc\nIn file included from ../include/Lglobals.h:48:0,\n                 from Lglobals.cc:23:\n../include/Lcommon.h: In member function 'void smallPoly<T>::resize(int)':\n../include/Lcommon.h:71:8: error: 'i' does not name a type\n   loop(i,this->N,N)\n        ^\n../include/Lcommon.h:51:30: note: in definition of macro 'loop'\n #define loop(i,m,n) for(auto i=(m); i!=(n); i++)\n                              ^\n```\nI guess the -std=c11 is missing in the gcc invocation...",
    "created_at": "2018-11-22T13:13:07Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352997",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:86'></a>
On some machines this fails with:

```
make libLfunction.so
make[5]: Entering directory '/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/lcalc-1.23.p17/src/src'
g++ -O3   -ffast-math -fPIC   -I../include -c Lglobals.cc
In file included from ../include/Lglobals.h:48:0,
                 from Lglobals.cc:23:
../include/Lcommon.h: In member function 'void smallPoly<T>::resize(int)':
../include/Lcommon.h:71:8: error: 'i' does not name a type
   loop(i,this->N,N)
        ^
../include/Lcommon.h:51:30: note: in definition of macro 'loop'
 #define loop(i,m,n) for(auto i=(m); i!=(n); i++)
                              ^
```
I guess the -std=c11 is missing in the gcc invocation...



---

archive/issue_comments_352998.json:
```json
{
    "body": "<a id='comment:87'></a>\nOf course I tested with compilers that default to C++11 or C++14 so that would make sense. Will fix ASAP.",
    "created_at": "2018-11-22T17:58:46Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352998",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:87'></a>
Of course I tested with compilers that default to C++11 or C++14 so that would make sense. Will fix ASAP.



---

archive/issue_comments_352999.json:
```json
{
    "body": "<a id='comment:88'></a>\n`lcalc` has both `spkg-build` and `spkg-install`, the `-std=c++11` was only added to `spkg-install` which explains the result. I am going to further inspect those for improvement.",
    "created_at": "2018-11-22T20:52:55Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-352999",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:88'></a>
`lcalc` has both `spkg-build` and `spkg-install`, the `-std=c++11` was only added to `spkg-install` which explains the result. I am going to further inspect those for improvement.



---

archive/issue_comments_353000.json:
```json
{
    "body": "<a id='comment:89'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7cf967fa5f50daf67e9a910786970bf184c37ecb\">7cf967f</a></td><td><code>make sure -std=c++11 is passed during build. Various improvement to spkg-build and spkg-install.</code></td></tr></table>\n",
    "created_at": "2018-11-22T21:04:35Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-353000",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:89'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7cf967fa5f50daf67e9a910786970bf184c37ecb">7cf967f</a></td><td><code>make sure -std=c++11 is passed during build. Various improvement to spkg-build and spkg-install.</code></td></tr></table>




---

archive/issue_comments_353001.json:
```json
{
    "body": "**Changing commit** from \"[3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a](https://github.com/sagemath/sagetrac-mirror/commit/3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a)\" to \"[7cf967fa5f50daf67e9a910786970bf184c37ecb](https://github.com/sagemath/sagetrac-mirror/commit/7cf967fa5f50daf67e9a910786970bf184c37ecb)\".",
    "created_at": "2018-11-22T21:04:35Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-353001",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a](https://github.com/sagemath/sagetrac-mirror/commit/3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a)" to "[7cf967fa5f50daf67e9a910786970bf184c37ecb](https://github.com/sagemath/sagetrac-mirror/commit/7cf967fa5f50daf67e9a910786970bf184c37ecb)".



---

archive/issue_events_207765.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-11-22T21:05:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207765"
}
```



---

archive/issue_events_207766.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-11-22T21:05:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207766"
}
```



---

archive/issue_comments_353002.json:
```json
{
    "body": "<a id='comment:90'></a>\nBack to need review.",
    "created_at": "2018-11-22T21:05:25Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-353002",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:90'></a>
Back to need review.



---

archive/issue_events_207767.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-11-22T21:22:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207767"
}
```



---

archive/issue_events_207768.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2018-11-22T21:22:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207768"
}
```



---

archive/issue_comments_353003.json:
```json
{
    "body": "<a id='comment:91'></a>\nover to the bots!",
    "created_at": "2018-11-22T21:22:13Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-353003",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:91'></a>
over to the bots!



---

archive/issue_comments_353004.json:
```json
{
    "body": "<a id='comment:92'></a>\nReplying to [@dimpase](#comment%3A91):\n> over to the bots!\n\nThank you Dima. Once we have closure here, I would appreciate if you could push the review button on #25532 for the ntl upgrade.",
    "created_at": "2018-11-23T01:06:57Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-353004",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:92'></a>
Replying to [@dimpase](#comment%3A91):
> over to the bots!

Thank you Dima. Once we have closure here, I would appreciate if you could push the review button on #25532 for the ntl upgrade.



---

archive/issue_comments_353005.json:
```json
{
    "body": "**Changing branch** from \"[u/fbissey/lcalc_cxx11](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/lcalc_cxx11)\" to \"[7cf967fa5f50daf67e9a910786970bf184c37ecb](https://github.com/sagemath/sagetrac-mirror/commit/7cf967fa5f50daf67e9a910786970bf184c37ecb)\".",
    "created_at": "2018-11-23T21:42:05Z",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23341#issuecomment-353005",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/fbissey/lcalc_cxx11](https://github.com/sagemath/sagetrac-mirror/tree/u/fbissey/lcalc_cxx11)" to "[7cf967fa5f50daf67e9a910786970bf184c37ecb](https://github.com/sagemath/sagetrac-mirror/commit/7cf967fa5f50daf67e9a910786970bf184c37ecb)".



---

archive/issue_events_207769.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-23T21:42:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207769"
}
```



---

archive/issue_events_207770.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "269bd3da7684ac03313641b09c75424dd98e6c9b",
    "created_at": "2018-11-23T21:42:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23341",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23341#event-207770"
}
```
