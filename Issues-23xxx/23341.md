# Issue 23341: port lcalc to C++11

archive/issues_023104.json:
```json
{
    "body": "lcalc doesn't use standard C++:\n\n- `using namespace std;` needs an include with stuff from `std::` before it\n    \n- `typeof` is a gcc extension - C++11 has `decltype` instead\n    \n- plain C must not be compiled with C++ compiler - thus a makefile change\n\n\nCC:  @kiwifb\n\nKeywords: lcalc\n\nBranch/Commit: 7cf967fa5f50daf67e9a910786970bf184c37ecb\n\nReviewer: Dima Pasechnik, Fran\u00e7ois Bissey, Jeroen Demeyer, Ralf Stephan\n\nAuthor: Dima Pasechnik, Fran\u00e7ois Bissey\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23341\n\n",
    "closed_at": "2018-11-23T21:42:05Z",
    "created_at": "2017-06-29T23:04:58Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "port lcalc to C++11",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23341",
    "user": "https://github.com/dimpase"
}
```
lcalc doesn't use standard C++:

- `using namespace std;` needs an include with stuff from `std::` before it
    
- `typeof` is a gcc extension - C++11 has `decltype` instead
    
- plain C must not be compiled with C++ compiler - thus a makefile change


CC:  @kiwifb

Keywords: lcalc

Branch/Commit: 7cf967fa5f50daf67e9a910786970bf184c37ecb

Reviewer: Dima Pasechnik, François Bissey, Jeroen Demeyer, Ralf Stephan

Author: Dima Pasechnik, François Bissey

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23341





---

archive/issue_comments_438450.json:
```json
{
    "body": "<a id='comment:1'></a>Can you rebase on 8.0.rc0? Your branch shows up in red.",
    "created_at": "2017-06-29T23:06:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438450",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:1'></a>Can you rebase on 8.0.rc0? Your branch shows up in red.



---

archive/issue_comments_438451.json:
```json
{
    "body": "<a id='comment:2'></a>this is needed for building lcalc with `-std=c++11`.\n(tested so far with clang 4.0.1 on Linux, with `stdlib=libc++`)\n\nOnly the top commit is of interest. Perhaps it can be based on rc0 indeed. But I need sleep now :-)",
    "created_at": "2017-06-29T23:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438451",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>this is needed for building lcalc with `-std=c++11`.
(tested so far with clang 4.0.1 on Linux, with `stdlib=libc++`)

Only the top commit is of interest. Perhaps it can be based on rc0 indeed. But I need sleep now :-)



---

archive/issue_comments_438452.json:
```json
{
    "body": "<a id='comment:3'></a>OK :)\n\nThe next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.",
    "created_at": "2017-06-29T23:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438452",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:3'></a>OK :)

The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.



---

archive/issue_comments_438453.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-30T06:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438453",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_438454.json:
```json
{
    "body": "Changing commit from \"015955efe9577dc9c3d443a4328297cd097454ee\" to \"14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee\"",
    "created_at": "2017-06-30T06:46:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438454",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "015955efe9577dc9c3d443a4328297cd097454ee" to "14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee"



---

archive/issue_comments_438455.json:
```json
{
    "body": "<a id='comment:5'></a>the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.\nAny idea how this can be fixed?\n\n```\n[sagelib-8.0.rc0] [  4/323] clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/cypari2 -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/cysignals -I/mnt/opt/Sage/sage-clang/local/include -I/mnt/opt/Sage/sage-clang/local/include/python2.7 -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/numpy/core/include -I/mnt/opt/Sage/sage-clang/src -I/mnt/opt/Sage/sage-clang/src/sage/ext -I/mnt/opt/Sage/sage-clang/src/build/cythonized -I/mnt/opt/Sage/sage-clang/src/build/cythonized/sage/ext -I/mnt/opt/Sage/sage-clang/local/include/python2.7 -c /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp -o build/temp.linux-x86_64-2.7/mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.o -fno-strict-aliasing -O3 -ffast-math\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:505:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/sage/libs/lcalc/lcalc_sage.h:1:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/L.h:34:\n[sagelib-8.0.rc0] In file included from /usr/lib/gcc/x86_64-pc-linux-gnu/6.3.0/include/g++-v6/backward/strstream:50:\n[sagelib-8.0.rc0] /usr/lib/gcc/x86_64-pc-linux-gnu/6.3.0/include/g++-v6/backward/backward_warning.h:32:2: warning: This file includes at least one deprecated or antiquated header which   may be removed without further notice at a future date. Please use a   non-deprecated interface with equivalent functionality instead. For a   listing of replacement headers and interfaces, consult the file   backward_warning.h. To disable this warning use -Wno-deprecated. [-W#warnings]\n[sagelib-8.0.rc0] #warning \\\n[sagelib-8.0.rc0]  ^\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:505:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/sage/libs/lcalc/lcalc_sage.h:1:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/L.h:40:\n[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/Lglobals.h:48:\n[sagelib-8.0.rc0] /mnt/opt/Sage/sage-clang/local/include/libLfunction/Lcommon.h:71:8: error: expected ';' in 'for' statement specifier\n[sagelib-8.0.rc0]                 loop(i,this->N,N) coeffs[i]=zero;\n[sagelib-8.0.rc0                       ^\n...\n```",
    "created_at": "2017-06-30T07:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438455",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'></a>the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.
Any idea how this can be fixed?

```
[sagelib-8.0.rc0] [  4/323] clang -fno-strict-aliasing -OPT:Olimit=0 -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -fPIC -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/cypari2 -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/cysignals -I/mnt/opt/Sage/sage-clang/local/include -I/mnt/opt/Sage/sage-clang/local/include/python2.7 -I/mnt/opt/Sage/sage-clang/local/lib/python2.7/site-packages/numpy/core/include -I/mnt/opt/Sage/sage-clang/src -I/mnt/opt/Sage/sage-clang/src/sage/ext -I/mnt/opt/Sage/sage-clang/src/build/cythonized -I/mnt/opt/Sage/sage-clang/src/build/cythonized/sage/ext -I/mnt/opt/Sage/sage-clang/local/include/python2.7 -c /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp -o build/temp.linux-x86_64-2.7/mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.o -fno-strict-aliasing -O3 -ffast-math
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:505:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/sage/libs/lcalc/lcalc_sage.h:1:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/L.h:34:
[sagelib-8.0.rc0] In file included from /usr/lib/gcc/x86_64-pc-linux-gnu/6.3.0/include/g++-v6/backward/strstream:50:
[sagelib-8.0.rc0] /usr/lib/gcc/x86_64-pc-linux-gnu/6.3.0/include/g++-v6/backward/backward_warning.h:32:2: warning: This file includes at least one deprecated or antiquated header which   may be removed without further notice at a future date. Please use a   non-deprecated interface with equivalent functionality instead. For a   listing of replacement headers and interfaces, consult the file   backward_warning.h. To disable this warning use -Wno-deprecated. [-W#warnings]
[sagelib-8.0.rc0] #warning \
[sagelib-8.0.rc0]  ^
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/build/cythonized/sage/libs/lcalc/lcalc_Lfunction.cpp:505:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/src/sage/libs/lcalc/lcalc_sage.h:1:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/L.h:40:
[sagelib-8.0.rc0] In file included from /mnt/opt/Sage/sage-clang/local/include/libLfunction/Lglobals.h:48:
[sagelib-8.0.rc0] /mnt/opt/Sage/sage-clang/local/include/libLfunction/Lcommon.h:71:8: error: expected ';' in 'for' statement specifier
[sagelib-8.0.rc0]                 loop(i,this->N,N) coeffs[i]=zero;
[sagelib-8.0.rc0                       ^
...
```



---

archive/issue_comments_438456.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:3 fbissey]:\n> OK :)\n> \n> The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.\n\n\nWe may assume that all the C++ compilers we care about support `-std=c++11`, right?\nSo this may be an independent of clang tickets thing?",
    "created_at": "2017-06-30T07:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438456",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>Replying to [comment:3 fbissey]:
> OK :)
> 
> The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.


We may assume that all the C++ compilers we care about support `-std=c++11`, right?
So this may be an independent of clang tickets thing?



---

archive/issue_comments_438457.json:
```json
{
    "body": "<a id='comment:7'></a>Jeroen, do you know to force the use of C++ compiler here (with proper use of CXXFLAGS, too) ?",
    "created_at": "2017-06-30T07:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438457",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:7'></a>Jeroen, do you know to force the use of C++ compiler here (with proper use of CXXFLAGS, too) ?



---

archive/issue_comments_438458.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2017-06-30T07:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438458",
    "user": "https://github.com/dimpase"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_438459.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2017-06-30T07:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438459",
    "user": "https://github.com/dimpase"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_438460.json:
```json
{
    "body": "Changing type from defect to PLEASE CHANGE.",
    "created_at": "2017-06-30T07:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438460",
    "user": "https://github.com/kiwifb"
}
```

Changing type from defect to PLEASE CHANGE.



---

archive/issue_comments_438461.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:5 dimpase]:\n> the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.\n> Any idea how this can be fixed?\n\n\nYes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.",
    "created_at": "2017-06-30T07:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438461",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:8'></a>Replying to [comment:5 dimpase]:
> the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.
> Any idea how this can be fixed?


Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.



---

archive/issue_comments_438462.json:
```json
{
    "body": "Changing component from packages: standard to PLEASE CHANGE.",
    "created_at": "2017-06-30T07:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438462",
    "user": "https://github.com/kiwifb"
}
```

Changing component from packages: standard to PLEASE CHANGE.



---

archive/issue_comments_438463.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:6 dimpase]:\n> We may assume that all the C++ compilers we care about support `-std=c++11`, right?\n> So this may be an independent of clang tickets thing?\n\n\nDefinitely. This shouldn't depend on #12426.",
    "created_at": "2017-06-30T07:36:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438463",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>Replying to [comment:6 dimpase]:
> We may assume that all the C++ compilers we care about support `-std=c++11`, right?
> So this may be an independent of clang tickets thing?


Definitely. This shouldn't depend on #12426.



---

archive/issue_comments_438464.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:8 fbissey]:\n> Replying to [comment:5 dimpase]:\n> > the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.\n> > Any idea how this can be fixed?\n\n> \n> Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.\n\n\nIs there a Sage ticket for this already?",
    "created_at": "2017-06-30T07:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438464",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:10'></a>Replying to [comment:8 fbissey]:
> Replying to [comment:5 dimpase]:
> > the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.
> > Any idea how this can be fixed?

> 
> Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.


Is there a Sage ticket for this already?



---

archive/issue_comments_438465.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 dimpase]:\n> Replying to [comment:8 fbissey]:\n> > Replying to [comment:5 dimpase]:\n> > > the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.\n> > > Any idea how this can be fixed?\n\n> > \n> > Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.\n  \n> \n> Is there a Sage ticket for this already?\n\n\nI don't think so. But it comes up regularly.",
    "created_at": "2017-06-30T07:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438465",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>Replying to [comment:10 dimpase]:
> Replying to [comment:8 fbissey]:
> > Replying to [comment:5 dimpase]:
> > > the other problem here is an incorrect building of lcalc extension. Here C++ is compiled with a C compiler, which is patently wrong.
> > > Any idea how this can be fixed?

> > 
> > Yes. This is https://bugs.python.org/issue1222585 the patch needed for that is included in the gentoo patch tarball for python.
  
> 
> Is there a Sage ticket for this already?


I don't think so. But it comes up regularly.



---

archive/issue_comments_438466.json:
```json
{
    "body": "<a id='comment:12'></a>How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).",
    "created_at": "2017-06-30T08:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438466",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).



---

archive/issue_comments_438467.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 jdemeyer]:\n> How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).\n\n\nI think Dima started this with the view of compiling sage with `-std=c++11`. If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.",
    "created_at": "2017-06-30T08:39:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438467",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>Replying to [comment:12 jdemeyer]:
> How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).


I think Dima started this with the view of compiling sage with `-std=c++11`. If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.



---

archive/issue_comments_438468.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 fbissey]:\n> Replying to [comment:12 jdemeyer]:\n> > How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).\n\n> \n> I think Dima started this with the view of compiling sage with `-std=c++11`.\n\n\nindeed, and as a part of the clang porting effort too - it's just too much trouble to have different packages with different `c++xy` IMHO, especially if one depends on the another, they better be on the same `xy`...\n \n\n\n> If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.\n\n\nI'll see how it flies with these patches, and open a ticket.",
    "created_at": "2017-06-30T09:11:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438468",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:14'></a>Replying to [comment:13 fbissey]:
> Replying to [comment:12 jdemeyer]:
> > How urgent is this? It might be possible to drop the `lcalc` package completely in favour of PARI/GP. However, the timeframe for this might be in the order on months (mainly because I don't know enough mathematically about L-functions).

> 
> I think Dima started this with the view of compiling sage with `-std=c++11`.


indeed, and as a part of the clang porting effort too - it's just too much trouble to have different packages with different `c++xy` IMHO, especially if one depends on the another, they better be on the same `xy`...
 


> If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.


I'll see how it flies with these patches, and open a ticket.



---

archive/issue_comments_438469.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 dimpase]:\n> I'll see how it flies with these patches, and open a ticket.\n> \n\n\nFor info Gentoo's python includes those. sage-on-gentoo has been compiled using these patches to distutils for almost as long as it existed.",
    "created_at": "2017-06-30T09:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438469",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'></a>Replying to [comment:14 dimpase]:
> I'll see how it flies with these patches, and open a ticket.
> 


For info Gentoo's python includes those. sage-on-gentoo has been compiled using these patches to distutils for almost as long as it existed.



---

archive/issue_comments_438470.json:
```json
{
    "body": "<a id='comment:16'></a>For the life of me, I don't understand why the patch [21_all_distutils_c++.patch](http://users.ox.ac.uk/~coml0531/sage/21_all_distutils_c++.patch)\nfrom https://dev.gentoo.org/~floppym/python/python-gentoo-patches-2.7.13-0.tar.xz\ndoes not apply if I place it in `build/pkgs/python2/patches/`: all the files etc are as they should be, yet I get\n\n```\n[python2-2.7.13.p1] Applying patches from ../patches...\n[python2-2.7.13.p1] Applying ../patches/2.6.5-FD_SETSIZE.patch\n[python2-2.7.13.p1] patching file Modules/selectmodule.c\n[python2-2.7.13.p1] Applying ../patches/21_all_distutils_c++.patch\n[python2-2.7.13.p1] can't find file to patch at input line 5\n[python2-2.7.13.p1] Perhaps you used the wrong -p or --strip option?\n[python2-2.7.13.p1] The text leading up to this was:\n[python2-2.7.13.p1] --------------------------\n[python2-2.7.13.p1] |https://bugs.python.org/issue1222585\n[python2-2.7.13.p1] |\n[python2-2.7.13.p1] |--- Lib/_osx_support.py\n[python2-2.7.13.p1] |+++ Lib/_osx_support.py\n[python2-2.7.13.p1] --------------------------\n[python2-2.7.13.p1] File to patch: \n...\n```\n\nSeems to be the right format, the right paths to files, yet this...",
    "created_at": "2017-06-30T10:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438470",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'></a>For the life of me, I don't understand why the patch [21_all_distutils_c++.patch](http://users.ox.ac.uk/~coml0531/sage/21_all_distutils_c++.patch)
from https://dev.gentoo.org/~floppym/python/python-gentoo-patches-2.7.13-0.tar.xz
does not apply if I place it in `build/pkgs/python2/patches/`: all the files etc are as they should be, yet I get

```
[python2-2.7.13.p1] Applying patches from ../patches...
[python2-2.7.13.p1] Applying ../patches/2.6.5-FD_SETSIZE.patch
[python2-2.7.13.p1] patching file Modules/selectmodule.c
[python2-2.7.13.p1] Applying ../patches/21_all_distutils_c++.patch
[python2-2.7.13.p1] can't find file to patch at input line 5
[python2-2.7.13.p1] Perhaps you used the wrong -p or --strip option?
[python2-2.7.13.p1] The text leading up to this was:
[python2-2.7.13.p1] --------------------------
[python2-2.7.13.p1] |https://bugs.python.org/issue1222585
[python2-2.7.13.p1] |
[python2-2.7.13.p1] |--- Lib/_osx_support.py
[python2-2.7.13.p1] |+++ Lib/_osx_support.py
[python2-2.7.13.p1] --------------------------
[python2-2.7.13.p1] File to patch: 
...
```

Seems to be the right format, the right paths to files, yet this...



---

archive/issue_comments_438471.json:
```json
{
    "body": "<a id='comment:17'></a>Check the patch directory levels with another patch there may be one directory to many in the Gentoo patch compared to what sage's automatic patching needs.",
    "created_at": "2017-06-30T10:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438471",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:17'></a>Check the patch directory levels with another patch there may be one directory to many in the Gentoo patch compared to what sage's automatic patching needs.



---

archive/issue_comments_438472.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 fbissey]:\n> Check the patch directory levels with another patch there may be one directory to many in the Gentoo patch compared to what sage's automatic patching needs.\n\n\nno, it's not the case as far as I can see (and I've been stuck with it for an hour already, just not yet ready to apply it by hand...)",
    "created_at": "2017-06-30T10:59:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438472",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:18'></a>Replying to [comment:17 fbissey]:
> Check the patch directory levels with another patch there may be one directory to many in the Gentoo patch compared to what sage's automatic patching needs.


no, it's not the case as far as I can see (and I've been stuck with it for an hour already, just not yet ready to apply it by hand...)



---

archive/issue_comments_438473.json:
```json
{
    "body": "<a id='comment:19'></a>Just checked you need to _add_ one directory level to the gentoo patch. That is\n\n```\n--- Lib/_osx_support.py\n+++ Lib/_osx_support.py\n```\nneeds to become \n\n```\n--- a/Lib/_osx_support.py\n+++ b/Lib/_osx_support.py\n```\nand so on...",
    "created_at": "2017-06-30T11:18:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438473",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>Just checked you need to _add_ one directory level to the gentoo patch. That is

```
--- Lib/_osx_support.py
+++ Lib/_osx_support.py
```
needs to become 

```
--- a/Lib/_osx_support.py
+++ b/Lib/_osx_support.py
```
and so on...



---

archive/issue_comments_438474.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:19 fbissey]:\n> Just checked you need to _add_ one directory level to the gentoo patch. That is\n> \n> ```\n> --- Lib/_osx_support.py\n> +++ Lib/_osx_support.py\n> ```\n> needs to become \n> \n> ```\n> --- a/Lib/_osx_support.py\n> +++ b/Lib/_osx_support.py\n> ```\n> and so on...\n\n\nOh, thanks, I've been blind...",
    "created_at": "2017-06-30T11:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438474",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>Replying to [comment:19 fbissey]:
> Just checked you need to _add_ one directory level to the gentoo patch. That is
> 
> ```
> --- Lib/_osx_support.py
> +++ Lib/_osx_support.py
> ```
> needs to become 
> 
> ```
> --- a/Lib/_osx_support.py
> +++ b/Lib/_osx_support.py
> ```
> and so on...


Oh, thanks, I've been blind...



---

archive/issue_comments_438475.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:3 fbissey]:\n> OK :)\n> \n> The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.\n\n\nSomehow I cannot manage to achieve this; \nit all works if I do\n\n```\nCXXFLAGS=\"-std=c++11\" ./sage -f lcalc\n```\nbut somehow does not work if I put into spkg-install\n\n```\n$MAKE CXXFLAGS=\"-std=c++11\"\n```\n\nsome evil Makefile magic that escapes me here. :-(",
    "created_at": "2017-07-01T23:49:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438475",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:21'></a>Replying to [comment:3 fbissey]:
> OK :)
> 
> The next question is how to ensure that the compiler then uses c++11. lcalc doesn't have a configure script so we cannot do it there.  At the very least `spkg-install` will need to insert `-std=c++11` in `CXXFLAGS` to make sure you are always using c++11.


Somehow I cannot manage to achieve this; 
it all works if I do

```
CXXFLAGS="-std=c++11" ./sage -f lcalc
```
but somehow does not work if I put into spkg-install

```
$MAKE CXXFLAGS="-std=c++11"
```

some evil Makefile magic that escapes me here. :-(



---

archive/issue_comments_438476.json:
```json
{
    "body": "<a id='comment:22'></a>Most other `spkg-install` do something like\n\n```\nCXXFLAGS=\"-std=c++11 ${CXXFLAGS}\"\nexport CXXFLAGS\n$MAKE\n```",
    "created_at": "2017-07-01T23:52:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438476",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:22'></a>Most other `spkg-install` do something like

```
CXXFLAGS="-std=c++11 ${CXXFLAGS}"
export CXXFLAGS
$MAKE
```



---

archive/issue_comments_438477.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 fbissey]:\n> Most other `spkg-install` do something like\n> \n> ```\n> CXXFLAGS=\"-std=c++11 ${CXXFLAGS}\"\n> export CXXFLAGS\n> $MAKE\n> ```\n\n\nno difference, it still does not work. It might be due to the Makefile modifying\nCXXFLAGS: it does\n\n```\nCXXFLAGS := -O3 $(OPENMP_FLAG) $(PREPROCESSOR_DEFINE) $(MACHINE_SPECIFIC_FLAGS) $(EXTRA) $(CXXFLAGS)\n```",
    "created_at": "2017-07-01T23:58:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438477",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>Replying to [comment:22 fbissey]:
> Most other `spkg-install` do something like
> 
> ```
> CXXFLAGS="-std=c++11 ${CXXFLAGS}"
> export CXXFLAGS
> $MAKE
> ```


no difference, it still does not work. It might be due to the Makefile modifying
CXXFLAGS: it does

```
CXXFLAGS := -O3 $(OPENMP_FLAG) $(PREPROCESSOR_DEFINE) $(MACHINE_SPECIFIC_FLAGS) $(EXTRA) $(CXXFLAGS)
```



---

archive/issue_comments_438478.json:
```json
{
    "body": "<a id='comment:24'></a>I don't know:\n\n* bash bug? (version 4.4.12(1))\n* make bug? (4.2.1)\n\nwill try on something older...",
    "created_at": "2017-07-02T00:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438478",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'></a>I don't know:

* bash bug? (version 4.4.12(1))
* make bug? (4.2.1)

will try on something older...



---

archive/issue_comments_438479.json:
```json
{
    "body": "<a id='comment:25'></a>logs please.",
    "created_at": "2017-07-02T01:36:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438479",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:25'></a>logs please.



---

archive/issue_comments_438480.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to number theory.",
    "created_at": "2017-07-02T07:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438480",
    "user": "https://github.com/rwst"
}
```

Changing component from PLEASE CHANGE to number theory.



---

archive/issue_comments_438481.json:
```json
{
    "body": "<a id='comment:26'></a>I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?",
    "created_at": "2017-07-02T07:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438481",
    "user": "https://github.com/rwst"
}
```

<a id='comment:26'></a>I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?



---

archive/issue_comments_438482.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2017-07-02T07:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438482",
    "user": "https://github.com/rwst"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_events_060084.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-07-02T07:34:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23341#event-60084"
}
```



---

archive/issue_comments_438483.json:
```json
{
    "body": "Changing dependencies from \"#12426\" to \"\"",
    "created_at": "2017-07-02T07:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438483",
    "user": "https://github.com/rwst"
}
```

Changing dependencies from "#12426" to ""



---

archive/issue_comments_438484.json:
```json
{
    "body": "<a id='comment:27'></a>this is the branch, as here are the results of running \n\n```\n./sage -f lcalc\n```\nhttp://users.ox.ac.uk/~coml0531/sage/lcalc-1.23.p16.log\n\nvs the result of running\n\n```\nCXXFLAGS=\"-std=c++11\" ./sage -f lcalc\n```\nhttp://users.ox.ac.uk/~coml0531/sage/externalCXXFLAGS_lcalc-1.23.p16.log\n\nAs you see in the 1st log CXXFLAGS are ignored.\nTested on Fedora25 as well as on Gentoo.\nWhat am I missing?!!\n\nPS. F25 bash is 4.3.43(1)-release, and make is 4.1.",
    "created_at": "2017-07-02T07:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438484",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>this is the branch, as here are the results of running 

```
./sage -f lcalc
```
http://users.ox.ac.uk/~coml0531/sage/lcalc-1.23.p16.log

vs the result of running

```
CXXFLAGS="-std=c++11" ./sage -f lcalc
```
http://users.ox.ac.uk/~coml0531/sage/externalCXXFLAGS_lcalc-1.23.p16.log

As you see in the 1st log CXXFLAGS are ignored.
Tested on Fedora25 as well as on Gentoo.
What am I missing?!!

PS. F25 bash is 4.3.43(1)-release, and make is 4.1.



---

archive/issue_comments_438485.json:
```json
{
    "body": "Changing commit from \"14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee\" to \"666d6a3d3de0d80ff8730dd3320f182b6f21368b\"",
    "created_at": "2017-07-02T07:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438485",
    "user": "https://github.com/dimpase"
}
```

Changing commit from "14e08ae6eb3f2d5c85f8b1e307ac5c1160d224ee" to "666d6a3d3de0d80ff8730dd3320f182b6f21368b"



---

archive/issue_comments_438486.json:
```json
{
    "body": "Changing branch from \"u/dimpase/lcalc_c11\" to \"u/dimpase/lcalc_cxx11\"",
    "created_at": "2017-07-02T07:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438486",
    "user": "https://github.com/dimpase"
}
```

Changing branch from "u/dimpase/lcalc_c11" to "u/dimpase/lcalc_cxx11"



---

archive/issue_comments_438487.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:26 rws]:\n> I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?\n\n\nIt's done here, the problem which remains is to fight the makefile madness\n\nThere will be more similar C++ \"fun\" for gfan (I have a patch, but it produces lots of test errors), giac... I'll cc you on these tickets as they appear.",
    "created_at": "2017-07-02T07:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438487",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:28'></a>Replying to [comment:26 rws]:
> I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?


It's done here, the problem which remains is to fight the makefile madness

There will be more similar C++ "fun" for gfan (I have a patch, but it produces lots of test errors), giac... I'll cc you on these tickets as they appear.



---

archive/issue_comments_438488.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:26 rws]:\n> I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?\n\n\nNo.",
    "created_at": "2017-07-02T07:44:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438488",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:29'></a>Replying to [comment:26 rws]:
> I'm willing to do some bulk C++11 work, as I did with Pynac. Is there a public lcalc repo?


No.



---

archive/issue_comments_438489.json:
```json
{
    "body": "<a id='comment:30'></a>let us make one on github.",
    "created_at": "2017-07-02T07:52:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438489",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:30'></a>let us make one on github.



---

archive/issue_comments_438490.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:28 dimpase]:\n> There will be more similar C++ \"fun\" for gfan (I have a patch, but it produces lots of test errors), giac... I'll cc you on these tickets as they appear.\n\n\nNote BTW there is gfan-0.6 now.",
    "created_at": "2017-07-02T07:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438490",
    "user": "https://github.com/rwst"
}
```

<a id='comment:31'></a>Replying to [comment:28 dimpase]:
> There will be more similar C++ "fun" for gfan (I have a patch, but it produces lots of test errors), giac... I'll cc you on these tickets as they appear.


Note BTW there is gfan-0.6 now.



---

archive/issue_comments_438491.json:
```json
{
    "body": "<a id='comment:32'></a>in fact, a lcalc repo is here : https://code.google.com/archive/p/l-calc/\n\nlast commit is from 2014, but it's newer than what we use, \nsee http://oto.math.uwaterloo.ca/~mrubinst/L_function_public/CODE/",
    "created_at": "2017-07-02T07:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438491",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:32'></a>in fact, a lcalc repo is here : https://code.google.com/archive/p/l-calc/

last commit is from 2014, but it's newer than what we use, 
see http://oto.math.uwaterloo.ca/~mrubinst/L_function_public/CODE/



---

archive/issue_comments_438492.json:
```json
{
    "body": "<a id='comment:33'></a>I just did one for gfan: https://github.com/rwst/gfan06",
    "created_at": "2017-07-02T08:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438492",
    "user": "https://github.com/rwst"
}
```

<a id='comment:33'></a>I just did one for gfan: https://github.com/rwst/gfan06



---

archive/issue_comments_438493.json:
```json
{
    "body": "<a id='comment:34'></a>This is quite peculiar. Looking more closely, even the section for OS X in spkg-install, doesn't work properly\n\n```\nif [ \"$UNAME\" = \"Darwin\" ]; then\n    export LDFLAGS=\"$LDFLAGS -Wl,-headerpad_max_install_names\"\nfi\n```\nwe still get the right thing because there is darwin section in the makefile but the `export` above doesn't work.",
    "created_at": "2017-07-02T08:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438493",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:34'></a>This is quite peculiar. Looking more closely, even the section for OS X in spkg-install, doesn't work properly

```
if [ "$UNAME" = "Darwin" ]; then
    export LDFLAGS="$LDFLAGS -Wl,-headerpad_max_install_names"
fi
```
we still get the right thing because there is darwin section in the makefile but the `export` above doesn't work.



---

archive/issue_comments_438494.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:32 dimpase]:\n> in fact, a lcalc repo is here : https://code.google.com/archive/p/l-calc/\n> \n> last commit is from 2014, but it's newer than what we use, \n> see http://oto.math.uwaterloo.ca/~mrubinst/L_function_public/CODE/\n\n\nI've imported the code.google (hg) repo into git, here:\nhttps://github.com/dimpase/lcalc\n\nI'll try merging Sage's changes there.",
    "created_at": "2017-07-03T09:43:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438494",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:35'></a>Replying to [comment:32 dimpase]:
> in fact, a lcalc repo is here : https://code.google.com/archive/p/l-calc/
> 
> last commit is from 2014, but it's newer than what we use, 
> see http://oto.math.uwaterloo.ca/~mrubinst/L_function_public/CODE/


I've imported the code.google (hg) repo into git, here:
https://github.com/dimpase/lcalc

I'll try merging Sage's changes there.



---

archive/issue_comments_438495.json:
```json
{
    "body": "<a id='comment:36'></a>That repo code is different enough and `clang-check` gives lots of errors. If we do this together, how to coordinate?",
    "created_at": "2017-07-03T13:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438495",
    "user": "https://github.com/rwst"
}
```

<a id='comment:36'></a>That repo code is different enough and `clang-check` gives lots of errors. If we do this together, how to coordinate?



---

archive/issue_comments_438496.json:
```json
{
    "body": "<a id='comment:37'></a>Replying to [comment:36 rws]:\n> That repo code is different enough and `clang-check` gives lots of errors. If we do this together, how to coordinate?\n\n\nIf you like to take the lead on this, please go ahead---I have my hands full with other things.",
    "created_at": "2017-07-03T13:17:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438496",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:37'></a>Replying to [comment:36 rws]:
> That repo code is different enough and `clang-check` gives lots of errors. If we do this together, how to coordinate?


If you like to take the lead on this, please go ahead---I have my hands full with other things.



---

archive/issue_comments_438497.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:37 dimpase]:\n> If you like to take the lead on this, please go ahead---I have my hands full with other things.\n\n\nNP. Actual code changes will go in a PR.",
    "created_at": "2017-07-03T13:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438497",
    "user": "https://github.com/rwst"
}
```

<a id='comment:38'></a>Replying to [comment:37 dimpase]:
> If you like to take the lead on this, please go ahead---I have my hands full with other things.


NP. Actual code changes will go in a PR.



---

archive/issue_comments_438498.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:38 rws]:\n> NP. Actual code changes will go in a PR.\n\n\nhttps://github.com/dimpase/lcalc/pull/1\n\nPlease review. I haven't worked on upgrading the Sage package, nor have I tested functionality.",
    "created_at": "2017-07-03T15:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438498",
    "user": "https://github.com/rwst"
}
```

<a id='comment:39'></a>Replying to [comment:38 rws]:
> NP. Actual code changes will go in a PR.


https://github.com/dimpase/lcalc/pull/1

Please review. I haven't worked on upgrading the Sage package, nor have I tested functionality.



---

archive/issue_comments_438499.json:
```json
{
    "body": "<a id='comment:40'></a>Two questions about this ticket:\n\n1. Is it about lcalc itself, Sage modules using lcalc, or both?\n\n2. Instead of porting lcalc to C++11, is it an option to force `-std=c++98` instead?",
    "created_at": "2017-09-22T12:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438499",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>Two questions about this ticket:

1. Is it about lcalc itself, Sage modules using lcalc, or both?

2. Instead of porting lcalc to C++11, is it an option to force `-std=c++98` instead?



---

archive/issue_comments_438500.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,8 @@\n-    porting lcalc to C++11\n+lcalc doesn't use standard C++:\n+\n+- `using namespace std;` needs an include with stuff from `std::` before it\n     \n-* \"using namespace std;\" need an include with stuff from std:: before it\n+- `typeof` is a gcc extension - C++11 has `decltype` instead\n     \n-* \"typeof\" is a gcc extension - C++11 has \"decltype\" instead\n-    \n-* plain C must not be compiled with C++ compiler - thus a makefile change\n+- plain C must not be compiled with C++ compiler - thus a makefile change\n \n``````\n",
    "created_at": "2017-09-22T12:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438500",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,8 @@
-    porting lcalc to C++11
+lcalc doesn't use standard C++:
+
+- `using namespace std;` needs an include with stuff from `std::` before it
     
-* "using namespace std;" need an include with stuff from std:: before it
+- `typeof` is a gcc extension - C++11 has `decltype` instead
     
-* "typeof" is a gcc extension - C++11 has "decltype" instead
-    
-* plain C must not be compiled with C++ compiler - thus a makefile change
+- plain C must not be compiled with C++ compiler - thus a makefile change
 
``````




---

archive/issue_comments_438501.json:
```json
{
    "body": "<a id='comment:41'></a>Hmm, maybe it's not a matter of porting to C++**11**, but just porting to proper C++ instead. At least `src/sage/libs/lcalc/lcalc_Lfunction.pyx` doesn't compile with `-std=c++98` either: it requires either `-std=gnu++98` or `-std=gnu++11`.",
    "created_at": "2017-09-22T12:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438501",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>Hmm, maybe it's not a matter of porting to C++**11**, but just porting to proper C++ instead. At least `src/sage/libs/lcalc/lcalc_Lfunction.pyx` doesn't compile with `-std=c++98` either: it requires either `-std=gnu++98` or `-std=gnu++11`.



---

archive/issue_comments_438502.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:13 fbissey]:\n> I think Dima started this with the view of compiling sage with `-std=c++11`. If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.\n\n\nI created #7028 for that.",
    "created_at": "2017-09-22T13:34:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438502",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>Replying to [comment:13 fbissey]:
> I think Dima started this with the view of compiling sage with `-std=c++11`. If that's what he is doing, getting https://bugs.python.org/issue1222585 in would be more pressing in my opinion.


I created #7028 for that.



---

archive/issue_comments_438503.json:
```json
{
    "body": "<a id='comment:43'></a>There is one more thing to add here; there is a macro `double(x)` defined in `include/Lcommon.h`, which does not seem to be used anywhere, and which causes havoc sometimes, e.g. if I try building with gcc on FreeBSD (due to cephes present)\n\nAnyway, hey, redefining a language keyword, yuck...",
    "created_at": "2017-09-24T20:02:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438503",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:43'></a>There is one more thing to add here; there is a macro `double(x)` defined in `include/Lcommon.h`, which does not seem to be used anywhere, and which causes havoc sometimes, e.g. if I try building with gcc on FreeBSD (due to cephes present)

Anyway, hey, redefining a language keyword, yuck...



---

archive/issue_comments_438504.json:
```json
{
    "body": "<a id='comment:44'></a>Because of what I logged in my comments in #23898 it looks like current lcalc does not compile on OpenSuSE systems with system gcc-5.3.1. A patch is at #23898#comment:39.",
    "created_at": "2017-10-07T16:06:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438504",
    "user": "https://github.com/rwst"
}
```

<a id='comment:44'></a>Because of what I logged in my comments in #23898 it looks like current lcalc does not compile on OpenSuSE systems with system gcc-5.3.1. A patch is at #23898#comment:39.



---

archive/issue_comments_438505.json:
```json
{
    "body": "<a id='comment:45'></a>Replying to [comment:43 dimpase]:\n> There is one more thing to add here; there is a macro `double(x)` defined in `include/Lcommon.h`, which does not seem to be used anywhere, and which causes havoc sometimes, e.g. if I try building with gcc on FreeBSD (due to cephes present)\n\n\nThis is outcommented in the github lcalc version which also, with the above PR, passes clang-check. It looks like an improvement. OTOH this ticket seems no longer pressing, as the Sage version compiles with clang too.\n\nThe attempt to replace Sage's lcalc with Pari (#24532) was dropped, so maybe it's an idea to at least upgrade it to the github version?",
    "created_at": "2018-02-19T16:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438505",
    "user": "https://github.com/rwst"
}
```

<a id='comment:45'></a>Replying to [comment:43 dimpase]:
> There is one more thing to add here; there is a macro `double(x)` defined in `include/Lcommon.h`, which does not seem to be used anywhere, and which causes havoc sometimes, e.g. if I try building with gcc on FreeBSD (due to cephes present)


This is outcommented in the github lcalc version which also, with the above PR, passes clang-check. It looks like an improvement. OTOH this ticket seems no longer pressing, as the Sage version compiles with clang too.

The attempt to replace Sage's lcalc with Pari (#24532) was dropped, so maybe it's an idea to at least upgrade it to the github version?



---

archive/issue_comments_438506.json:
```json
{
    "body": "<a id='comment:46'></a>I am all for it, but I'm a bit lost here. What stage are we at?",
    "created_at": "2018-02-21T14:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438506",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:46'></a>I am all for it, but I'm a bit lost here. What stage are we at?



---

archive/issue_comments_438507.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:46 dimpase]:\n> What stage are we at? \n\n\nThis is the first ticket that mentions the 2014 version at all I think.",
    "created_at": "2018-02-21T15:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438507",
    "user": "https://github.com/rwst"
}
```

<a id='comment:47'></a>Replying to [comment:46 dimpase]:
> What stage are we at? 


This is the first ticket that mentions the 2014 version at all I think.



---

archive/issue_comments_438508.json:
```json
{
    "body": "<a id='comment:48'></a>There is mention in #11321#comment:8 but this is only because patches were sent upstream.",
    "created_at": "2018-02-21T15:18:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438508",
    "user": "https://github.com/rwst"
}
```

<a id='comment:48'></a>There is mention in #11321#comment:8 but this is only because patches were sent upstream.



---

archive/issue_comments_438509.json:
```json
{
    "body": "<a id='comment:49'></a>The github version defines itself in `CHANGE.LOG` and `include/cmdline.h` as v. 1.3, so we might stick to that and add something. I mean with that the name of the tarball later distributed, not our Sage patchlevel. I personally prefer ISO dates like 20180223 whenever possible.",
    "created_at": "2018-02-21T15:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438509",
    "user": "https://github.com/rwst"
}
```

<a id='comment:49'></a>The github version defines itself in `CHANGE.LOG` and `include/cmdline.h` as v. 1.3, so we might stick to that and add something. I mean with that the name of the tarball later distributed, not our Sage patchlevel. I personally prefer ISO dates like 20180223 whenever possible.



---

archive/issue_comments_438510.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:49 rws]:\n> I personally prefer ISO dates like 20180223 whenever possible.\n\n\nWhat does the date refer to? If you are packaging something which does not have a naturally defined date, I wouldn't use a date. For packages created from a git repo, better use a git commit hash.",
    "created_at": "2018-02-21T15:38:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438510",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:50'></a>Replying to [comment:49 rws]:
> I personally prefer ISO dates like 20180223 whenever possible.


What does the date refer to? If you are packaging something which does not have a naturally defined date, I wouldn't use a date. For packages created from a git repo, better use a git commit hash.



---

archive/issue_comments_438511.json:
```json
{
    "body": "<a id='comment:51'></a>Replying to [comment:50 jdemeyer]:\n> For packages created from a git repo, better use a git commit hash.\n\n\nThat's fine too.",
    "created_at": "2018-02-21T15:40:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438511",
    "user": "https://github.com/rwst"
}
```

<a id='comment:51'></a>Replying to [comment:50 jdemeyer]:
> For packages created from a git repo, better use a git commit hash.


That's fine too.



---

archive/issue_comments_438512.json:
```json
{
    "body": "<a id='comment:52'></a>The changes to install the package without patches are now added to\nhttps://github.com/dimpase/lcalc/pull/1\nwhich eventually needs a review. ATM Sage does NOT build with it as compilation of the Cython module fails.\n\nOne problem worked around was that the use of FP type (double,mpfr,etc..) can be given to make but is not fixed in a header like with conf.h in other packages. I have hardcoded the type used until now (double) but this is an issue.",
    "created_at": "2018-02-22T10:04:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438512",
    "user": "https://github.com/rwst"
}
```

<a id='comment:52'></a>The changes to install the package without patches are now added to
https://github.com/dimpase/lcalc/pull/1
which eventually needs a review. ATM Sage does NOT build with it as compilation of the Cython module fails.

One problem worked around was that the use of FP type (double,mpfr,etc..) can be given to make but is not fixed in a header like with conf.h in other packages. I have hardcoded the type used until now (double) but this is an issue.



---

archive/issue_comments_438513.json:
```json
{
    "body": "<a id='comment:53'></a>I've just looked at the pull request again - do you see my comments there?",
    "created_at": "2018-02-22T11:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438513",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:53'></a>I've just looked at the pull request again - do you see my comments there?



---

archive/issue_comments_438514.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:53 dimpase]:\n> I've just looked at the pull request again - do you see my comments there?\n\n\nYes, I have answered there.",
    "created_at": "2018-02-22T13:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438514",
    "user": "https://github.com/rwst"
}
```

<a id='comment:54'></a>Replying to [comment:53 dimpase]:
> I've just looked at the pull request again - do you see my comments there?


Yes, I have answered there.



---

archive/issue_comments_438515.json:
```json
{
    "body": "<a id='comment:55'></a>I opened #24280 with the changes on the Sage side. Testing yields mostly tolerance exceeded but also some different values that need a look.",
    "created_at": "2018-02-22T14:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438515",
    "user": "https://github.com/rwst"
}
```

<a id='comment:55'></a>I opened #24280 with the changes on the Sage side. Testing yields mostly tolerance exceeded but also some different values that need a look.



---

archive/issue_comments_438516.json:
```json
{
    "body": "<a id='comment:56'></a>Replying to [comment:55 rws]:\n> I opened #24280 with the changes on the Sage side. Testing yields mostly tolerance exceeded but also some different values that need a look.\n\n\nseems to be wrong reference, what is the correct ticket?",
    "created_at": "2018-02-22T20:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438516",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:56'></a>Replying to [comment:55 rws]:
> I opened #24280 with the changes on the Sage side. Testing yields mostly tolerance exceeded but also some different values that need a look.


seems to be wrong reference, what is the correct ticket?



---

archive/issue_comments_438517.json:
```json
{
    "body": "<a id='comment:57'></a>Please see #24820.",
    "created_at": "2018-02-23T06:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438517",
    "user": "https://github.com/rwst"
}
```

<a id='comment:57'></a>Please see #24820.



---

archive/issue_comments_438518.json:
```json
{
    "body": "Changing keywords from \"\" to \"lcalc\".",
    "created_at": "2018-02-24T12:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438518",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "" to "lcalc".



---

archive/issue_comments_438519.json:
```json
{
    "body": "<a id='comment:59'></a>The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?",
    "created_at": "2018-07-10T12:12:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438519",
    "user": "https://github.com/timokau"
}
```

<a id='comment:59'></a>The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?



---

archive/issue_comments_438520.json:
```json
{
    "body": "<a id='comment:60'></a>Replying to [comment:59 gh-timokau]:\n> The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?\n\n\nI think #24820 is the newer attempt. It would be necessary to agree that either the Hardy-Z function is not defined for complex argument or lcalc is unable to compute the case. As I said in #24820, I have no idea about the usefulness of complex argument results. Do you?",
    "created_at": "2018-07-10T12:45:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438520",
    "user": "https://github.com/rwst"
}
```

<a id='comment:60'></a>Replying to [comment:59 gh-timokau]:
> The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?


I think #24820 is the newer attempt. It would be necessary to agree that either the Hardy-Z function is not defined for complex argument or lcalc is unable to compute the case. As I said in #24820, I have no idea about the usefulness of complex argument results. Do you?



---

archive/issue_comments_438521.json:
```json
{
    "body": "<a id='comment:61'></a>Replying to [comment:59 gh-timokau]:\n> The ntl upgrade (#25532) depends on this.\n\n\nAs I said on that ticket, the dependency itself could be considered a bug. It is probably easier to remove the dependency than fixing lcalc.",
    "created_at": "2018-07-10T12:50:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438521",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:61'></a>Replying to [comment:59 gh-timokau]:
> The ntl upgrade (#25532) depends on this.


As I said on that ticket, the dependency itself could be considered a bug. It is probably easier to remove the dependency than fixing lcalc.



---

archive/issue_comments_438522.json:
```json
{
    "body": "<a id='comment:62'></a>Replying to [comment:60 rws]:\n> Replying to [comment:59 gh-timokau]:\n> > The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?\n\n> \n> I think #24820 is the newer attempt. It would be necessary to agree that either the Hardy-Z function is not defined for complex argument or lcalc is unable to compute the case. As I said in #24820, I have no idea about the usefulness of complex argument results. Do you?\n\n\nUnfortunately I don't :/\n\nReplying to [comment:61 jdemeyer]:\n> Replying to [comment:59 gh-timokau]:\n> > The ntl upgrade (#25532) depends on this.\n\n> \n> As I said on that ticket, the dependency itself could be considered a bug. It is probably easier to remove the dependency than fixing lcalc.\n\n\nAt least that would fix #25532. Isn't the dependency there for a reason?",
    "created_at": "2018-07-10T14:42:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438522",
    "user": "https://github.com/timokau"
}
```

<a id='comment:62'></a>Replying to [comment:60 rws]:
> Replying to [comment:59 gh-timokau]:
> > The ntl upgrade (#25532) depends on this. Is there a reason this (or #24820) isn't needs_review?

> 
> I think #24820 is the newer attempt. It would be necessary to agree that either the Hardy-Z function is not defined for complex argument or lcalc is unable to compute the case. As I said in #24820, I have no idea about the usefulness of complex argument results. Do you?


Unfortunately I don't :/

Replying to [comment:61 jdemeyer]:
> Replying to [comment:59 gh-timokau]:
> > The ntl upgrade (#25532) depends on this.

> 
> As I said on that ticket, the dependency itself could be considered a bug. It is probably easier to remove the dependency than fixing lcalc.


At least that would fix #25532. Isn't the dependency there for a reason?



---

archive/issue_comments_438523.json:
```json
{
    "body": "<a id='comment:63'></a>I think it is time we move forward with this again. I think this ticket should also include the matching patch from arch in sagelib https://git.archlinux.org/svntogit/community.git/plain/trunk/sagemath-lcalc-c++11.patch?h=packages/sagemath&id=0e31ae526ab7c6b5c0bfacb3f8b1c4fd490035aa so that we really are just using C++11 and allow us to make progress on #25532.\n\nAny objections to moving forward with what we have now?",
    "created_at": "2018-10-31T00:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438523",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:63'></a>I think it is time we move forward with this again. I think this ticket should also include the matching patch from arch in sagelib https://git.archlinux.org/svntogit/community.git/plain/trunk/sagemath-lcalc-c++11.patch?h=packages/sagemath&id=0e31ae526ab7c6b5c0bfacb3f8b1c4fd490035aa so that we really are just using C++11 and allow us to make progress on #25532.

Any objections to moving forward with what we have now?



---

archive/issue_comments_438524.json:
```json
{
    "body": "<a id='comment:64'></a>Yes this need the extra patch from arch I quoted. Otherwise sage's compilation fails because lcalc is no using construct that don't exist in gnu++98.",
    "created_at": "2018-10-31T20:32:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438524",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:64'></a>Yes this need the extra patch from arch I quoted. Otherwise sage's compilation fails because lcalc is no using construct that don't exist in gnu++98.



---

archive/issue_events_060085.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-10-31T22:37:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23341#event-60085"
}
```



---

archive/issue_events_060086.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2018-10-31T22:37:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23341#event-60086"
}
```



---

archive/issue_comments_438525.json:
```json
{
    "body": "<a id='comment:65'></a>Last call for patches. Please someone review. It would be good to have this in the next beta and be able to move on to #25532 and get it all done for 8.5.\n\n---\nNew commits:",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438525",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:65'></a>Last call for patches. Please someone review. It would be good to have this in the next beta and be able to move on to #25532 and get it all done for 8.5.

---
New commits:



---

archive/issue_comments_438526.json:
```json
{
    "body": "Changing commit from \"666d6a3d3de0d80ff8730dd3320f182b6f21368b\" to \"837732e21257e3d2ad14bff15424ea9cae197e1b\"",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438526",
    "user": "https://github.com/kiwifb"
}
```

Changing commit from "666d6a3d3de0d80ff8730dd3320f182b6f21368b" to "837732e21257e3d2ad14bff15424ea9cae197e1b"



---

archive/issue_comments_438527.json:
```json
{
    "body": "Changing author from \"\" to \"Dima Pasechnik, Fran\u00e7ois Bissey\"",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438527",
    "user": "https://github.com/kiwifb"
}
```

Changing author from "" to "Dima Pasechnik, François Bissey"



---

archive/issue_comments_438528.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438528",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_438529.json:
```json
{
    "body": "Changing branch from \"u/dimpase/lcalc_cxx11\" to \"u/fbissey/lcalc_cxx11\"",
    "created_at": "2018-10-31T22:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438529",
    "user": "https://github.com/kiwifb"
}
```

Changing branch from "u/dimpase/lcalc_cxx11" to "u/fbissey/lcalc_cxx11"



---

archive/issue_comments_438530.json:
```json
{
    "body": "<a id='comment:66'></a>Anyone interested in reviewing this?",
    "created_at": "2018-11-13T07:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438530",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:66'></a>Anyone interested in reviewing this?



---

archive/issue_comments_438531.json:
```json
{
    "body": "<a id='comment:67'></a>1. Can you add some rationale for the changes to `Makefile`?\n\n2. I wouldn't make style changes such as\n\n```diff\n-\t\tloop(i,this->N,N)\n-\t\t\tcoeffs[i]=zero;\n+\t\tloop(i,this->N,N) coeffs[i]=zero;\n```",
    "created_at": "2018-11-13T09:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438531",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:67'></a>1. Can you add some rationale for the changes to `Makefile`?

2. I wouldn't make style changes such as

```diff
-		loop(i,this->N,N)
-			coeffs[i]=zero;
+		loop(i,this->N,N) coeffs[i]=zero;
```



---

archive/issue_comments_438532.json:
```json
{
    "body": "<a id='comment:68'></a>Replying to [comment:65 fbissey]:\n> It would be good to have this in the next beta and be able to move on to #25532\n\n\nAs I mentioned multiple times, I don't really think that #25532 must depend on this.",
    "created_at": "2018-11-13T09:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438532",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:68'></a>Replying to [comment:65 fbissey]:
> It would be good to have this in the next beta and be able to move on to #25532


As I mentioned multiple times, I don't really think that #25532 must depend on this.



---

archive/issue_comments_438533.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-11-13T09:42:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438533",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_438534.json:
```json
{
    "body": "<a id='comment:70'></a>Replying to [comment:68 jdemeyer]:\n> Replying to [comment:65 fbissey]:\n> > It would be good to have this in the next beta and be able to move on to #25532\n\n> \n> As I mentioned multiple times, I don't really think that #25532 must depend on this.\n\n\nWell, I tried to see if I could up ntl separately in sage-on-gentoo and sage wouldn't compile. It could be that I can tweak ntl's configuration to be compatible (at possible cost in ntl internal) but I'd rather get rid of the last bit of sage that is c++11 resistant (I think) and go with the natural flow again.",
    "created_at": "2018-11-13T09:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438534",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:70'></a>Replying to [comment:68 jdemeyer]:
> Replying to [comment:65 fbissey]:
> > It would be good to have this in the next beta and be able to move on to #25532

> 
> As I mentioned multiple times, I don't really think that #25532 must depend on this.


Well, I tried to see if I could up ntl separately in sage-on-gentoo and sage wouldn't compile. It could be that I can tweak ntl's configuration to be compatible (at possible cost in ntl internal) but I'd rather get rid of the last bit of sage that is c++11 resistant (I think) and go with the natural flow again.



---

archive/issue_comments_438535.json:
```json
{
    "body": "<a id='comment:71'></a>Minor nitpick: wouldn't it be cleaner to replace `decltype(m) i=(m)` by `auto i = (m)`?",
    "created_at": "2018-11-13T09:57:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438535",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:71'></a>Minor nitpick: wouldn't it be cleaner to replace `decltype(m) i=(m)` by `auto i = (m)`?



---

archive/issue_comments_438536.json:
```json
{
    "body": "<a id='comment:72'></a>Replying to [comment:71 jdemeyer]:\n> Minor nitpick: wouldn't it be cleaner to replace `decltype(m) i=(m)` by `auto i = (m)`?\n\n\nIt has indeed a better feel. A bit too late in the day for me to do any changes (safely), I'll go through your reviews in the morning.",
    "created_at": "2018-11-13T10:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438536",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:72'></a>Replying to [comment:71 jdemeyer]:
> Minor nitpick: wouldn't it be cleaner to replace `decltype(m) i=(m)` by `auto i = (m)`?


It has indeed a better feel. A bit too late in the day for me to do any changes (safely), I'll go through your reviews in the morning.



---

archive/issue_comments_438537.json:
```json
{
    "body": "<a id='comment:73'></a>Replying to [comment:72 fbissey]:\n> A bit too late in the day for me\n\n\nYou chose to live on the wrong side of the world :-)",
    "created_at": "2018-11-13T10:02:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438537",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:73'></a>Replying to [comment:72 fbissey]:
> A bit too late in the day for me


You chose to live on the wrong side of the world :-)



---

archive/issue_comments_438538.json:
```json
{
    "body": "<a id='comment:74'></a>Replying to [comment:73 jdemeyer]:\n> Replying to [comment:72 fbissey]:\n> > A bit too late in the day for me\n\n> \n> You chose to live on the wrong side of the world :-)\n\n\nWell it feels like it will be a nice summer. And not too hot, like our australian neighbors :-) but I really need to get some sleep now.",
    "created_at": "2018-11-13T10:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438538",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:74'></a>Replying to [comment:73 jdemeyer]:
> Replying to [comment:72 fbissey]:
> > A bit too late in the day for me

> 
> You chose to live on the wrong side of the world :-)


Well it feels like it will be a nice summer. And not too hot, like our australian neighbors :-) but I really need to get some sleep now.



---

archive/issue_comments_438539.json:
```json
{
    "body": "<a id='comment:75'></a>In your `Makefile` patch, the rule `$(CC) $(CFLAGS) $(INCLUDEFILES) -c cmdline.c` is just the standard build rule for `.c` files (modulo the typo `$(CFLAGS)`->`$(CCFLAGS)`). So it might be better to just restore the comment.",
    "created_at": "2018-11-13T10:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438539",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:75'></a>In your `Makefile` patch, the rule `$(CC) $(CFLAGS) $(INCLUDEFILES) -c cmdline.c` is just the standard build rule for `.c` files (modulo the typo `$(CFLAGS)`->`$(CCFLAGS)`). So it might be better to just restore the comment.



---

archive/issue_comments_438540.json:
```json
{
    "body": "<a id='comment:76'></a>OK some comments on the review from Jeroen which made me dig a bit deeper on the Makefile. I must say I adopted a slightly different approach in sage-on-gentoo so I don't have the same patch, but some of lesson learnt will definitely apply.\n\n* the original makefile defines CC as as g++ so that has to go.\n* Non standard flags like CCFLAGS are used, so Dima tried to use appropriate flags for both C and C++ compilers. And it also differentiate C and C++ flags which wasn't done before because even regular C code was passed to the C++ compiler.\n* The downside of using CFLAGS and CXXFLAGS inside the makefile is that regular options passed from the sage build system may need care if we want to inject them. That's a sage-on-gentoo difference I use `MYCXXFLAGS` so I can include whatever other flags we pass without worry.\n* Jeroen points out the standard rule for `.c` file should be used for `cmdline.c` except that the current patch erroneously define the rule as using CXXFLAGS instead of CFLAGS. Oopsie.\n\nPoint of difference with sage-on-gentoo: because pari headers are included in two files with `#include \"pari.h\"` the makefile has to define the location of pari headers and so do any code that include these headers. Decided that it was not worth it and patched to have `#include \"pari/pari.h\"` which is more sane and means that we don't have to worry about adding non standard includes. That means that I cut an extra bit of the makefile too. If people think that's a good idea I'll include that change in sage too.",
    "created_at": "2018-11-13T22:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438540",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:76'></a>OK some comments on the review from Jeroen which made me dig a bit deeper on the Makefile. I must say I adopted a slightly different approach in sage-on-gentoo so I don't have the same patch, but some of lesson learnt will definitely apply.

* the original makefile defines CC as as g++ so that has to go.
* Non standard flags like CCFLAGS are used, so Dima tried to use appropriate flags for both C and C++ compilers. And it also differentiate C and C++ flags which wasn't done before because even regular C code was passed to the C++ compiler.
* The downside of using CFLAGS and CXXFLAGS inside the makefile is that regular options passed from the sage build system may need care if we want to inject them. That's a sage-on-gentoo difference I use `MYCXXFLAGS` so I can include whatever other flags we pass without worry.
* Jeroen points out the standard rule for `.c` file should be used for `cmdline.c` except that the current patch erroneously define the rule as using CXXFLAGS instead of CFLAGS. Oopsie.

Point of difference with sage-on-gentoo: because pari headers are included in two files with `#include "pari.h"` the makefile has to define the location of pari headers and so do any code that include these headers. Decided that it was not worth it and patched to have `#include "pari/pari.h"` which is more sane and means that we don't have to worry about adding non standard includes. That means that I cut an extra bit of the makefile too. If people think that's a good idea I'll include that change in sage too.



---

archive/issue_comments_438541.json:
```json
{
    "body": "<a id='comment:77'></a>Replying to [comment:76 fbissey]:\n> because pari headers are included in two files with `#include \"pari.h\"` the makefile has to define the location of pari headers and so do any code that include these headers. Decided that it was not worth it and patched to have `#include \"pari/pari.h\"` which is more sane and means that we don't have to worry about adding non standard includes. That means that I cut an extra bit of the makefile too. If people think that's a good idea I'll include that change in sage too.\n\n\nThat makes sense to me.",
    "created_at": "2018-11-14T06:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438541",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:77'></a>Replying to [comment:76 fbissey]:
> because pari headers are included in two files with `#include "pari.h"` the makefile has to define the location of pari headers and so do any code that include these headers. Decided that it was not worth it and patched to have `#include "pari/pari.h"` which is more sane and means that we don't have to worry about adding non standard includes. That means that I cut an extra bit of the makefile too. If people think that's a good idea I'll include that change in sage too.


That makes sense to me.



---

archive/issue_comments_438542.json:
```json
{
    "body": "<a id='comment:78'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-14T21:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438542",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:78'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_438543.json:
```json
{
    "body": "Changing commit from \"837732e21257e3d2ad14bff15424ea9cae197e1b\" to \"eb072d1119cd2305bb02cd8f8e00168e67f5cad6\"",
    "created_at": "2018-11-14T21:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438543",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "837732e21257e3d2ad14bff15424ea9cae197e1b" to "eb072d1119cd2305bb02cd8f8e00168e67f5cad6"



---

archive/issue_comments_438544.json:
```json
{
    "body": "<a id='comment:79'></a>All right back to review.",
    "created_at": "2018-11-14T22:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438544",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:79'></a>All right back to review.



---

archive/issue_comments_438545.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-11-14T22:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438545",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_438546.json:
```json
{
    "body": "<a id='comment:80'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-14T22:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438546",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:80'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_438547.json:
```json
{
    "body": "Changing commit from \"eb072d1119cd2305bb02cd8f8e00168e67f5cad6\" to \"3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a\"",
    "created_at": "2018-11-14T22:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438547",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "eb072d1119cd2305bb02cd8f8e00168e67f5cad6" to "3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a"



---

archive/issue_comments_438548.json:
```json
{
    "body": "<a id='comment:81'></a>So many patches! It is hard to figure if the thing you patch was introduced by another patch :P",
    "created_at": "2018-11-14T22:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438548",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:81'></a>So many patches! It is hard to figure if the thing you patch was introduced by another patch :P



---

archive/issue_comments_438549.json:
```json
{
    "body": "<a id='comment:82'></a>This appears to work with clang 6.0.1, a good sign.",
    "created_at": "2018-11-17T13:18:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438549",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:82'></a>This appears to work with clang 6.0.1, a good sign.



---

archive/issue_comments_438550.json:
```json
{
    "body": "<a id='comment:83'></a>Replying to [comment:82 dimpase]:\n> This appears to work with clang 6.0.1, a good sign.\n\n\nI have checked clang-6 and gcc-8.2. Now if someone would put a kind review.\n\nAlthough Dima, I kept the patch name \"using_namespace_std.patch` but there is hardly any of that in there. Just removing GNU-ism. Did you have more stuff to do in mind?",
    "created_at": "2018-11-21T00:55:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438550",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:83'></a>Replying to [comment:82 dimpase]:
> This appears to work with clang 6.0.1, a good sign.


I have checked clang-6 and gcc-8.2. Now if someone would put a kind review.

Although Dima, I kept the patch name "using_namespace_std.patch` but there is hardly any of that in there. Just removing GNU-ism. Did you have more stuff to do in mind?



---

archive/issue_comments_438551.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-21T11:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438551",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_438552.json:
```json
{
    "body": "<a id='comment:84'></a>OK",
    "created_at": "2018-11-21T11:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438552",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:84'></a>OK



---

archive/issue_comments_438553.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik, Fran\u00e7ois Bissey, Jeroen Demeyer, Ralf Stephan\"",
    "created_at": "2018-11-21T11:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438553",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik, François Bissey, Jeroen Demeyer, Ralf Stephan"



---

archive/issue_comments_438554.json:
```json
{
    "body": "<a id='comment:85'></a>Thank you `@`fbissey for pushing this forward, happy to have one less patch to apply :)",
    "created_at": "2018-11-21T11:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438554",
    "user": "https://github.com/timokau"
}
```

<a id='comment:85'></a>Thank you `@`fbissey for pushing this forward, happy to have one less patch to apply :)



---

archive/issue_comments_438555.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-11-22T13:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438555",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_438556.json:
```json
{
    "body": "<a id='comment:86'></a>On some machines this fails with:\n\n```\nmake libLfunction.so\nmake[5]: Entering directory '/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/lcalc-1.23.p17/src/src'\ng++ -O3   -ffast-math -fPIC   -I../include -c Lglobals.cc\nIn file included from ../include/Lglobals.h:48:0,\n                 from Lglobals.cc:23:\n../include/Lcommon.h: In member function 'void smallPoly<T>::resize(int)':\n../include/Lcommon.h:71:8: error: 'i' does not name a type\n   loop(i,this->N,N)\n        ^\n../include/Lcommon.h:51:30: note: in definition of macro 'loop'\n #define loop(i,m,n) for(auto i=(m); i!=(n); i++)\n                              ^\n```\nI guess the -std=c11 is missing in the gcc invocation...",
    "created_at": "2018-11-22T13:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438556",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:86'></a>On some machines this fails with:

```
make libLfunction.so
make[5]: Entering directory '/home/buildbot/slave/sage_git/build/local/var/tmp/sage/build/lcalc-1.23.p17/src/src'
g++ -O3   -ffast-math -fPIC   -I../include -c Lglobals.cc
In file included from ../include/Lglobals.h:48:0,
                 from Lglobals.cc:23:
../include/Lcommon.h: In member function 'void smallPoly<T>::resize(int)':
../include/Lcommon.h:71:8: error: 'i' does not name a type
   loop(i,this->N,N)
        ^
../include/Lcommon.h:51:30: note: in definition of macro 'loop'
 #define loop(i,m,n) for(auto i=(m); i!=(n); i++)
                              ^
```
I guess the -std=c11 is missing in the gcc invocation...



---

archive/issue_comments_438557.json:
```json
{
    "body": "<a id='comment:87'></a>Of course I tested with compilers that default to C++11 or C++14 so that would make sense. Will fix ASAP.",
    "created_at": "2018-11-22T17:58:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438557",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:87'></a>Of course I tested with compilers that default to C++11 or C++14 so that would make sense. Will fix ASAP.



---

archive/issue_comments_438558.json:
```json
{
    "body": "<a id='comment:88'></a>`lcalc` has both `spkg-build` and `spkg-install`, the `-std=c++11` was only added to `spkg-install` which explains the result. I am going to further inspect those for improvement.",
    "created_at": "2018-11-22T20:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438558",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:88'></a>`lcalc` has both `spkg-build` and `spkg-install`, the `-std=c++11` was only added to `spkg-install` which explains the result. I am going to further inspect those for improvement.



---

archive/issue_comments_438559.json:
```json
{
    "body": "<a id='comment:89'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-11-22T21:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438559",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:89'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_438560.json:
```json
{
    "body": "Changing commit from \"3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a\" to \"7cf967fa5f50daf67e9a910786970bf184c37ecb\"",
    "created_at": "2018-11-22T21:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438560",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3fb7f80a02461137b5e1e80cfd5fae6ba9784b6a" to "7cf967fa5f50daf67e9a910786970bf184c37ecb"



---

archive/issue_comments_438561.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-11-22T21:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438561",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_438562.json:
```json
{
    "body": "<a id='comment:90'></a>Back to need review.",
    "created_at": "2018-11-22T21:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438562",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:90'></a>Back to need review.



---

archive/issue_comments_438563.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-11-22T21:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438563",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_438564.json:
```json
{
    "body": "<a id='comment:91'></a>over to the bots!",
    "created_at": "2018-11-22T21:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438564",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:91'></a>over to the bots!



---

archive/issue_comments_438565.json:
```json
{
    "body": "<a id='comment:92'></a>Replying to [comment:91 dimpase]:\n> over to the bots!\n\n\nThank you Dima. Once we have closure here, I would appreciate if you could push the review button on #25532 for the ntl upgrade.",
    "created_at": "2018-11-23T01:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438565",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:92'></a>Replying to [comment:91 dimpase]:
> over to the bots!


Thank you Dima. Once we have closure here, I would appreciate if you could push the review button on #25532 for the ntl upgrade.



---

archive/issue_comments_438566.json:
```json
{
    "body": "Changing branch from \"u/fbissey/lcalc_cxx11\" to \"7cf967fa5f50daf67e9a910786970bf184c37ecb\"",
    "created_at": "2018-11-23T21:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438566",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/fbissey/lcalc_cxx11" to "7cf967fa5f50daf67e9a910786970bf184c37ecb"



---

archive/issue_events_060087.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-11-23T21:42:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23341#event-60087"
}
```



---

archive/issue_comments_438567.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-11-23T21:42:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23341#issuecomment-438567",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
