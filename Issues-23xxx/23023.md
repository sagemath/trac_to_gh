# Issue 23023: Upgrade to Sphinx 1.6.x

archive/issues_022786.json:
```json
{
    "body": "**Tarballs**:\n\n1. https://pypi.python.org/packages/10/91/ceb2e0d763e0c626f7afd7e3272a5bb76dd06eed1f0b908270ea31984062/Sphinx-1.6.3.tar.gz\n\n2. https://pypi.python.org/packages/17/75/3698d7992a828ad6d7be99c0a888b75ed173a9280e53dbae67326029b60e/typing-3.6.1.tar.gz\n\nCC:  @kiwifb @embray\n\nReviewer: Fran\u00e7ois Bissey, Jeroen Demeyer, John Palmieri\n\nAuthor: Jeroen Demeyer, Fran\u00e7ois Bissey, John Palmieri\n\nBranch: c48896722c5546fbdca8a58e6516828912d87f85\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23023\n\n",
    "closed_at": "2017-08-26T09:58:15Z",
    "created_at": "2017-05-18T11:12:23Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Upgrade to Sphinx 1.6.x",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23023",
    "user": "https://github.com/jdemeyer"
}
```
**Tarballs**:

1. https://pypi.python.org/packages/10/91/ceb2e0d763e0c626f7afd7e3272a5bb76dd06eed1f0b908270ea31984062/Sphinx-1.6.3.tar.gz

2. https://pypi.python.org/packages/17/75/3698d7992a828ad6d7be99c0a888b75ed173a9280e53dbae67326029b60e/typing-3.6.1.tar.gz

CC:  @kiwifb @embray

Reviewer: François Bissey, Jeroen Demeyer, John Palmieri

Author: Jeroen Demeyer, François Bissey, John Palmieri

Branch: c48896722c5546fbdca8a58e6516828912d87f85

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23023





---

archive/issue_comments_431272.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/upgrade_to_sphinx_1_6_x\"",
    "created_at": "2017-05-19T07:00:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431272",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/upgrade_to_sphinx_1_6_x"



---

archive/issue_comments_431273.json:
```json
{
    "body": "Changing commit from \"\" to \"6a2b7866eaec483120b0abd99271bd589adb95b5\"",
    "created_at": "2017-05-19T18:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431273",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "6a2b7866eaec483120b0abd99271bd589adb95b5"



---

archive/issue_comments_431274.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-05-19T18:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431274",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_431275.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n **Tarball**: https://pypi.python.org/packages/0a/32/594257b9fccc8ce4d120e86d481cabe55ee9de7c1686af2ee58eb4ec741e/Sphinx-1.6.1.tar.gz\n+\n+There is an upstream i18n problem: https://groups.google.com/forum/#!topic/sphinx-users/B6PHvgm6fMM\n``````\n",
    "created_at": "2017-05-22T11:18:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431275",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 **Tarball**: https://pypi.python.org/packages/0a/32/594257b9fccc8ce4d120e86d481cabe55ee9de7c1686af2ee58eb4ec741e/Sphinx-1.6.1.tar.gz
+
+There is an upstream i18n problem: https://groups.google.com/forum/#!topic/sphinx-users/B6PHvgm6fMM
``````




---

archive/issue_comments_431276.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. No feedback yet.\"",
    "created_at": "2017-05-22T11:18:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431276",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "N/A" to "Reported upstream. No feedback yet."



---

archive/issue_comments_431277.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n **Tarball**: https://pypi.python.org/packages/0a/32/594257b9fccc8ce4d120e86d481cabe55ee9de7c1686af2ee58eb4ec741e/Sphinx-1.6.1.tar.gz\n \n-There is an upstream i18n problem: https://groups.google.com/forum/#!topic/sphinx-users/B6PHvgm6fMM\n+There is an upstream i18n bug (log messages are translated to the language of the compiled document): https://groups.google.com/forum/#!topic/sphinx-users/B6PHvgm6fMM\n``````\n",
    "created_at": "2017-05-22T11:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431277",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 **Tarball**: https://pypi.python.org/packages/0a/32/594257b9fccc8ce4d120e86d481cabe55ee9de7c1686af2ee58eb4ec741e/Sphinx-1.6.1.tar.gz
 
-There is an upstream i18n problem: https://groups.google.com/forum/#!topic/sphinx-users/B6PHvgm6fMM
+There is an upstream i18n bug (log messages are translated to the language of the compiled document): https://groups.google.com/forum/#!topic/sphinx-users/B6PHvgm6fMM
``````




---

archive/issue_comments_431278.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n-**Tarball**: https://pypi.python.org/packages/0a/32/594257b9fccc8ce4d120e86d481cabe55ee9de7c1686af2ee58eb4ec741e/Sphinx-1.6.1.tar.gz\n-\n-There is an upstream i18n bug (log messages are translated to the language of the compiled document): https://groups.google.com/forum/#!topic/sphinx-users/B6PHvgm6fMM\n+**Tarball**: https://pypi.python.org/packages/10/91/ceb2e0d763e0c626f7afd7e3272a5bb76dd06eed1f0b908270ea31984062/Sphinx-1.6.3.tar.gz\n``````\n",
    "created_at": "2017-07-03T08:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431278",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1 @@
-**Tarball**: https://pypi.python.org/packages/0a/32/594257b9fccc8ce4d120e86d481cabe55ee9de7c1686af2ee58eb4ec741e/Sphinx-1.6.1.tar.gz
-
-There is an upstream i18n bug (log messages are translated to the language of the compiled document): https://groups.google.com/forum/#!topic/sphinx-users/B6PHvgm6fMM
+**Tarball**: https://pypi.python.org/packages/10/91/ceb2e0d763e0c626f7afd7e3272a5bb76dd06eed1f0b908270ea31984062/Sphinx-1.6.3.tar.gz
``````




---

archive/issue_comments_431279.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. No feedback yet.\" to \"N/A\"",
    "created_at": "2017-07-03T08:13:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431279",
    "user": "https://github.com/jdemeyer"
}
```

Changing upstream from "Reported upstream. No feedback yet." to "N/A"



---

archive/issue_comments_431280.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,5 @@\n-**Tarball**: https://pypi.python.org/packages/10/91/ceb2e0d763e0c626f7afd7e3272a5bb76dd06eed1f0b908270ea31984062/Sphinx-1.6.3.tar.gz\n+**Tarballs**:\n+\n+1. https://pypi.python.org/packages/10/91/ceb2e0d763e0c626f7afd7e3272a5bb76dd06eed1f0b908270ea31984062/Sphinx-1.6.3.tar.gz\n+\n+2. https://pypi.python.org/packages/17/75/3698d7992a828ad6d7be99c0a888b75ed173a9280e53dbae67326029b60e/typing-3.6.1.tar.gz\n``````\n",
    "created_at": "2017-07-03T09:25:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431280",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,5 @@
-**Tarball**: https://pypi.python.org/packages/10/91/ceb2e0d763e0c626f7afd7e3272a5bb76dd06eed1f0b908270ea31984062/Sphinx-1.6.3.tar.gz
+**Tarballs**:
+
+1. https://pypi.python.org/packages/10/91/ceb2e0d763e0c626f7afd7e3272a5bb76dd06eed1f0b908270ea31984062/Sphinx-1.6.3.tar.gz
+
+2. https://pypi.python.org/packages/17/75/3698d7992a828ad6d7be99c0a888b75ed173a9280e53dbae67326029b60e/typing-3.6.1.tar.gz
``````




---

archive/issue_comments_431281.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-07-03T09:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431281",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_431282.json:
```json
{
    "body": "Changing commit from \"6a2b7866eaec483120b0abd99271bd589adb95b5\" to \"2ea32c168574623501bcd031253e8e322afa9a8c\"",
    "created_at": "2017-07-03T09:40:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431282",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6a2b7866eaec483120b0abd99271bd589adb95b5" to "2ea32c168574623501bcd031253e8e322afa9a8c"



---

archive/issue_comments_431283.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-04T08:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431283",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_431284.json:
```json
{
    "body": "<a id='comment:10'></a>Are we using sphinx.websupport for anything? This is now split:\n\n```\n# -*- coding: utf-8 -*-\n\"\"\"\n    sphinx.websupport\n    ~~~~~~~~~~~~~~~~~\n\n    Base Module for web support functions.\n\n    :copyright: Copyright 2007-2017 by the Sphinx team, see AUTHORS.\n    :license: BSD, see LICENSE for details.\n\"\"\"\n\nimport warnings\n\nfrom sphinx.deprecation import RemovedInSphinx20Warning\n\ntry:\n    from sphinxcontrib.websupport import WebSupport  # NOQA\n    from sphinxcontrib.websupport import errors  # NOQA\n    from sphinxcontrib.websupport.search import BaseSearch, SEARCH_ADAPTERS  # NOQA\n    from sphinxcontrib.websupport.storage import StorageBackend  # NOQA\n\n    warnings.warn('sphinx.websupport module is now provided as sphinxcontrib-websupport. '\n                  'sphinx.websupport will be removed at Sphinx-2.0. '\n                  'Please use the package instead.',\n                  RemovedInSphinx20Warning)\nexcept ImportError:\n    warnings.warn('Since Sphinx-1.6, sphinx.websupport module is now separated to '\n                  'sphinxcontrib-websupport package. Please add it into your dependency list.')\n```",
    "created_at": "2017-07-04T22:07:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431284",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:10'></a>Are we using sphinx.websupport for anything? This is now split:

```
# -*- coding: utf-8 -*-
"""
    sphinx.websupport
    ~~~~~~~~~~~~~~~~~

    Base Module for web support functions.

    :copyright: Copyright 2007-2017 by the Sphinx team, see AUTHORS.
    :license: BSD, see LICENSE for details.
"""

import warnings

from sphinx.deprecation import RemovedInSphinx20Warning

try:
    from sphinxcontrib.websupport import WebSupport  # NOQA
    from sphinxcontrib.websupport import errors  # NOQA
    from sphinxcontrib.websupport.search import BaseSearch, SEARCH_ADAPTERS  # NOQA
    from sphinxcontrib.websupport.storage import StorageBackend  # NOQA

    warnings.warn('sphinx.websupport module is now provided as sphinxcontrib-websupport. '
                  'sphinx.websupport will be removed at Sphinx-2.0. '
                  'Please use the package instead.',
                  RemovedInSphinx20Warning)
except ImportError:
    warnings.warn('Since Sphinx-1.6, sphinx.websupport module is now separated to '
                  'sphinxcontrib-websupport package. Please add it into your dependency list.')
```



---

archive/issue_comments_431285.json:
```json
{
    "body": "<a id='comment:11'></a>This thing needs imagemagick's `convert` program. Not sure if we would use it and this is a relatively low requirement on a normal desktop but still surprised me. From `sphinx/ext/imgconverter.py`\n\n```\ndef setup(app):\n    # type: (Sphinx) -> Dict[unicode, Any]\n    app.add_post_transform(ImagemagickConverter)\n    app.add_config_value('image_converter', 'convert', 'env')\n    app.add_config_value('image_converter_args', [], 'env')\n\n    return {\n        'version': 'builtin',\n        'parallel_read_safe': True,\n        'parallel_write_safe': True,\n    }\n```\nI have been trying to run the self tests for myself and that came up. Because it is a relatively new machine install `convert` was not installed.",
    "created_at": "2017-07-05T02:41:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431285",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:11'></a>This thing needs imagemagick's `convert` program. Not sure if we would use it and this is a relatively low requirement on a normal desktop but still surprised me. From `sphinx/ext/imgconverter.py`

```
def setup(app):
    # type: (Sphinx) -> Dict[unicode, Any]
    app.add_post_transform(ImagemagickConverter)
    app.add_config_value('image_converter', 'convert', 'env')
    app.add_config_value('image_converter_args', [], 'env')

    return {
        'version': 'builtin',
        'parallel_read_safe': True,
        'parallel_write_safe': True,
    }
```
I have been trying to run the self tests for myself and that came up. Because it is a relatively new machine install `convert` was not installed.



---

archive/issue_comments_431286.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [fbissey](#comment%3A11):\n> I have been trying to run the self tests for myself and that came up.\n\n\nExactly what came up? What happened? And is it a regression from Sphinx 1.5.3 to Sphinx 1.6.3?",
    "created_at": "2017-07-05T10:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431286",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Replying to [fbissey](#comment%3A11):
> I have been trying to run the self tests for myself and that came up.


Exactly what came up? What happened? And is it a regression from Sphinx 1.5.3 to Sphinx 1.6.3?



---

archive/issue_comments_431287.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [jdemeyer](#comment%3A12):\n> Replying to [fbissey](#comment%3A11):\n> > I have been trying to run the self tests for myself and that came up.\n\n> \n> Exactly what came up? What happened? And is it a regression from Sphinx 1.5.3 to Sphinx 1.6.3?\n\n\nsphinx own testsuite. I didn't have `convert` installed on the system and it broke. That stuff appears to be new, that extension didn't exist in 1.5.3, I haven't tested it within sage yet. The spkg doesn't have a spkg-check anyway, too many requirements not in sage to run it. But I'll probably do a test run soon without `convert` installed to see if it needs to be added to the list of sage's requirement",
    "created_at": "2017-07-05T10:11:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431287",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>Replying to [jdemeyer](#comment%3A12):
> Replying to [fbissey](#comment%3A11):
> > I have been trying to run the self tests for myself and that came up.

> 
> Exactly what came up? What happened? And is it a regression from Sphinx 1.5.3 to Sphinx 1.6.3?


sphinx own testsuite. I didn't have `convert` installed on the system and it broke. That stuff appears to be new, that extension didn't exist in 1.5.3, I haven't tested it within sage yet. The spkg doesn't have a spkg-check anyway, too many requirements not in sage to run it. But I'll probably do a test run soon without `convert` installed to see if it needs to be added to the list of sage's requirement



---

archive/issue_comments_431288.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [fbissey](#comment%3A13):\n> But I'll probably do a test run soon without `convert` installed to see if it needs to be added to the list of sage's requirement\n\n\nSounds good. If it's only needed for the Sphinx testsuite but not for Sage, I wouldn't worry about it.",
    "created_at": "2017-07-05T10:35:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431288",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replying to [fbissey](#comment%3A13):
> But I'll probably do a test run soon without `convert` installed to see if it needs to be added to the list of sage's requirement


Sounds good. If it's only needed for the Sphinx testsuite but not for Sage, I wouldn't worry about it.



---

archive/issue_comments_431289.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-06T01:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431289",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_431290.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2017-07-06T01:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431290",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "" to "François Bissey"



---

archive/issue_comments_431291.json:
```json
{
    "body": "<a id='comment:15'></a>Looks fine to me.",
    "created_at": "2017-07-06T01:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431291",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'></a>Looks fine to me.



---

archive/issue_comments_431292.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-07-12T12:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431292",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_431293.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#23179\"",
    "created_at": "2017-07-12T12:49:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431293",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#23179"



---

archive/issue_comments_431294.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-07-29T20:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431294",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_431295.json:
```json
{
    "body": "Changing dependencies from \"#23179\" to \"\"",
    "created_at": "2017-07-29T20:41:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431295",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#23179" to ""



---

archive/issue_comments_431296.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-07-30T14:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431296",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_431297.json:
```json
{
    "body": "<a id='comment:18'></a>The japanese docs don't build any more (make all-pdf works):\n\n```\n[docpdf] make[2]: Entering directory '/mnt/disk/home/release/Sage/local/share/doc/sage/latex/ja/a_tour_of_sage'\n[docpdf] make[2]: *** No rule to make target 'all-pdf-ja'.  Stop.\n[docpdf] make[2]: Leaving directory '/mnt/disk/home/release/Sage/local/share/doc/sage/latex/ja/a_tour_of_sage'\n[docpdf] Error building the documentation.\n```\n\nFor the record, we now also depend on latexmk (in TeXlive):\n\n```\n[docpdf] [repl     ] WARNING: LaTeX file written to /mnt/disk/home/release/Sage/local/share/doc/sage/latex/en/reference/repl\n[docpdf] make[2]: Entering directory '/mnt/disk/home/release/Sage/local/share/doc/sage/latex/en/reference/repl'\n[docpdf] latexmk -pdf -dvi- -ps-  'repl.tex'\n[docpdf] make[2]: latexmk: Command not found\n[docpdf] Makefile:33: recipe for target 'repl.pdf' failed\n```\nThis is easily fixed by installing latexmk.",
    "created_at": "2017-07-30T14:00:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431297",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>The japanese docs don't build any more (make all-pdf works):

```
[docpdf] make[2]: Entering directory '/mnt/disk/home/release/Sage/local/share/doc/sage/latex/ja/a_tour_of_sage'
[docpdf] make[2]: *** No rule to make target 'all-pdf-ja'.  Stop.
[docpdf] make[2]: Leaving directory '/mnt/disk/home/release/Sage/local/share/doc/sage/latex/ja/a_tour_of_sage'
[docpdf] Error building the documentation.
```

For the record, we now also depend on latexmk (in TeXlive):

```
[docpdf] [repl     ] WARNING: LaTeX file written to /mnt/disk/home/release/Sage/local/share/doc/sage/latex/en/reference/repl
[docpdf] make[2]: Entering directory '/mnt/disk/home/release/Sage/local/share/doc/sage/latex/en/reference/repl'
[docpdf] latexmk -pdf -dvi- -ps-  'repl.tex'
[docpdf] make[2]: latexmk: Command not found
[docpdf] Makefile:33: recipe for target 'repl.pdf' failed
```
This is easily fixed by installing latexmk.



---

archive/issue_comments_431298.json:
```json
{
    "body": "<a id='comment:19'></a>I can see it. `make all-pdf` completing is probably thanks to parallel building. In docbuild/__init__.py\n\n```\n    def pdf(self):\n        \"\"\"\n        Builds the PDF files for this document.  This is done by first\n        (re)-building the LaTeX output, going into that LaTeX\n        directory, and running 'make all-pdf' (or for the special case of\n        the ja docs, 'all-pdf-ja(ex,to run platex)' there.\n\n        EXAMPLES::\n\n            sage: from sage_setup.docbuild import DocBuilder\n            sage: b = DocBuilder('tutorial')\n            sage: b.pdf() #not tested\n        \"\"\"\n        self.latex()\n        tex_dir = self._output_dir('latex')\n        pdf_dir = self._output_dir('pdf')\n        make_target = \"cd '%s' && $MAKE %s && mv -f *.pdf '%s'\"\n        error_message = \"failed to run $MAKE %s in %s\"\n        MB_LANG = {'ja': 'all-pdf-ja'} # language name : the modified target\n\n        # Replace the command for languages that require special processing\n        if self.lang in MB_LANG:\n            command = MB_LANG[self.lang]\n        else:\n            command = 'all-pdf'\n\n        if subprocess.call(make_target%(tex_dir, command, pdf_dir), shell=True):\n            raise RuntimeError(error_message%(command, tex_dir))\n        logger.warning(\"Build finished.  The built documents can be found in %s\", pdf_dir)\n```\nso `ja` used to be treated specially. But it appears that with sphinx 1.6.3 the Japanese specific target is not produced, just the regular `all-pdf`. \n\nSetting `MB_LANG={}` seems to work but the bigger question is whether to keep expecting some exceptions. sphinx may be moving away from particularism, in that case we should ditch it too.",
    "created_at": "2017-07-31T00:02:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431298",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>I can see it. `make all-pdf` completing is probably thanks to parallel building. In docbuild/__init__.py

```
    def pdf(self):
        """
        Builds the PDF files for this document.  This is done by first
        (re)-building the LaTeX output, going into that LaTeX
        directory, and running 'make all-pdf' (or for the special case of
        the ja docs, 'all-pdf-ja(ex,to run platex)' there.

        EXAMPLES::

            sage: from sage_setup.docbuild import DocBuilder
            sage: b = DocBuilder('tutorial')
            sage: b.pdf() #not tested
        """
        self.latex()
        tex_dir = self._output_dir('latex')
        pdf_dir = self._output_dir('pdf')
        make_target = "cd '%s' && $MAKE %s && mv -f *.pdf '%s'"
        error_message = "failed to run $MAKE %s in %s"
        MB_LANG = {'ja': 'all-pdf-ja'} # language name : the modified target

        # Replace the command for languages that require special processing
        if self.lang in MB_LANG:
            command = MB_LANG[self.lang]
        else:
            command = 'all-pdf'

        if subprocess.call(make_target%(tex_dir, command, pdf_dir), shell=True):
            raise RuntimeError(error_message%(command, tex_dir))
        logger.warning("Build finished.  The built documents can be found in %s", pdf_dir)
```
so `ja` used to be treated specially. But it appears that with sphinx 1.6.3 the Japanese specific target is not produced, just the regular `all-pdf`. 

Setting `MB_LANG={}` seems to work but the bigger question is whether to keep expecting some exceptions. sphinx may be moving away from particularism, in that case we should ditch it too.



---

archive/issue_comments_431299.json:
```json
{
    "body": "Changing commit from \"2ea32c168574623501bcd031253e8e322afa9a8c\" to \"6930d06663d7bbac51c840f163ba0874fbd2e9e7\"",
    "created_at": "2017-08-08T02:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431299",
    "user": "https://github.com/kiwifb"
}
```

Changing commit from "2ea32c168574623501bcd031253e8e322afa9a8c" to "6930d06663d7bbac51c840f163ba0874fbd2e9e7"



---

archive/issue_comments_431300.json:
```json
{
    "body": "<a id='comment:20'></a>Let's start moving this forwards again. I conformed to the boiler plate in #23179 and remove the Japanese specific stuff. If I were upstream I would have removed any kind of particularism at that level, so I am acting as if they just did until proven otherwise.\n\n---\nNew commits:",
    "created_at": "2017-08-08T02:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431300",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:20'></a>Let's start moving this forwards again. I conformed to the boiler plate in #23179 and remove the Japanese specific stuff. If I were upstream I would have removed any kind of particularism at that level, so I am acting as if they just did until proven otherwise.

---
New commits:



---

archive/issue_comments_431301.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-08T02:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431301",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_431302.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/upgrade_to_sphinx_1_6_x\" to \"u/fbissey/sphinx1.6.3\"",
    "created_at": "2017-08-08T02:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431302",
    "user": "https://github.com/kiwifb"
}
```

Changing branch from "u/jdemeyer/upgrade_to_sphinx_1_6_x" to "u/fbissey/sphinx1.6.3"



---

archive/issue_comments_431303.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Fran\u00e7ois Bissey\"",
    "created_at": "2017-08-08T07:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431303",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "Jeroen Demeyer" to "Jeroen Demeyer, François Bissey"



---

archive/issue_comments_431304.json:
```json
{
    "body": "<a id='comment:21'></a>Thanks for moving forward with this! I'll test it right away.",
    "created_at": "2017-08-08T07:36:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431304",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Thanks for moving forward with this! I'll test it right away.



---

archive/issue_comments_431305.json:
```json
{
    "body": "Changing reviewer from \"Fran\u00e7ois Bissey\" to \"Fran\u00e7ois Bissey, Jeroen Demeyer\"",
    "created_at": "2017-08-08T18:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431305",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "François Bissey" to "François Bissey, Jeroen Demeyer"



---

archive/issue_comments_431306.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-08T18:41:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431306",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_431307.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-08-10T21:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431307",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_431308.json:
```json
{
    "body": "<a id='comment:23'></a>\n```\nsage -t --long --warn-long 75.4 src/doc/en/thematic_tutorials/sandpile.rst  # 2 doctests failed\nsage -t --long --warn-long 75.4 src/sage/sandpiles/sandpile.py  # 2 doctests failed\nsage -t --long --warn-long 75.4 src/sage/repl/ipython_tests.py  # 1 doctest failed\n```",
    "created_at": "2017-08-10T21:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431308",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>
```
sage -t --long --warn-long 75.4 src/doc/en/thematic_tutorials/sandpile.rst  # 2 doctests failed
sage -t --long --warn-long 75.4 src/sage/sandpiles/sandpile.py  # 2 doctests failed
sage -t --long --warn-long 75.4 src/sage/repl/ipython_tests.py  # 1 doctest failed
```



---

archive/issue_comments_431309.json:
```json
{
    "body": "<a id='comment:24'></a>Problem with \"smart\" quotes? See http://www.sphinx-doc.org/en/stable/config.html#confval-html_use_smartypants. Should we create a `docutils.conf` file? I tried creating one containing\n\n```\n[parsers]\nsmart_quotes = no\n```\nbut I couldn't figure out the right place to put it, or at least no location that I tried had any effect on the failing doctests.",
    "created_at": "2017-08-10T23:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431309",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>Problem with "smart" quotes? See http://www.sphinx-doc.org/en/stable/config.html#confval-html_use_smartypants. Should we create a `docutils.conf` file? I tried creating one containing

```
[parsers]
smart_quotes = no
```
but I couldn't figure out the right place to put it, or at least no location that I tried had any effect on the failing doctests.



---

archive/issue_comments_431310.json:
```json
{
    "body": "<a id='comment:25'></a>Could be. Jeroen and I both doctested the stuff before - without issues. My personal suspicion is interference with another merged ticket. In any case I am re-starting at Volker's current snapshot to see if I can reproduce it.",
    "created_at": "2017-08-10T23:36:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431310",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:25'></a>Could be. Jeroen and I both doctested the stuff before - without issues. My personal suspicion is interference with another merged ticket. In any case I am re-starting at Volker's current snapshot to see if I can reproduce it.



---

archive/issue_comments_431311.json:
```json
{
    "body": "<a id='comment:26'></a>I see the doctest failures on OS X when I apply this on top of 8.1.beta1. Could it be platform-specific?\n\nNote that changing line 680 in `local/lib/python2.7/site-packages/sphinx/environment/__init__.py`\n\n```\n       self.settings['smart_quotes'] = True\n```\nfrom `True` to `False` fixes the doctests.",
    "created_at": "2017-08-10T23:39:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431311",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'></a>I see the doctest failures on OS X when I apply this on top of 8.1.beta1. Could it be platform-specific?

Note that changing line 680 in `local/lib/python2.7/site-packages/sphinx/environment/__init__.py`

```
       self.settings['smart_quotes'] = True
```
from `True` to `False` fixes the doctests.



---

archive/issue_comments_431312.json:
```json
{
    "body": "<a id='comment:27'></a>I think I figured out the right place for `docutils.conf`:\n\n```diff\ndiff --git a/src/sage/misc/sphinxify.py b/src/sage/misc/sphinxify.py\nindex f084a19bf6..f114b9fcd7 100644\n--- a/src/sage/misc/sphinxify.py\n+++ b/src/sage/misc/sphinxify.py\n@@ -80,6 +80,10 @@ def sphinxify(docstring, format='html'):\n     # buildername, confoverrides, status, warning, freshenv).\n     confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')\n \n+    open(os.path.join(srcdir, 'docutils.conf'), 'w').write(r\"\"\"\n+[parser]\n+smart_quotes = no\n+\"\"\")\n     doctreedir = os.path.join(srcdir, 'doctrees')\n     confoverrides = {'html_context': {}, 'master_doc': 'docstring'}\n  \n```\nBut even though Sphinx seems to find this file, it doesn't change Sphinx's setting for `self.settings['smart_quotes']`.",
    "created_at": "2017-08-11T00:00:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431312",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:27'></a>I think I figured out the right place for `docutils.conf`:

```diff
diff --git a/src/sage/misc/sphinxify.py b/src/sage/misc/sphinxify.py
index f084a19bf6..f114b9fcd7 100644
--- a/src/sage/misc/sphinxify.py
+++ b/src/sage/misc/sphinxify.py
@@ -80,6 +80,10 @@ def sphinxify(docstring, format='html'):
     # buildername, confoverrides, status, warning, freshenv).
     confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')
 
+    open(os.path.join(srcdir, 'docutils.conf'), 'w').write(r"""
+[parser]
+smart_quotes = no
+""")
     doctreedir = os.path.join(srcdir, 'doctrees')
     confoverrides = {'html_context': {}, 'master_doc': 'docstring'}
  
```
But even though Sphinx seems to find this file, it doesn't change Sphinx's setting for `self.settings['smart_quotes']`.



---

archive/issue_comments_431313.json:
```json
{
    "body": "<a id='comment:28'></a>Not platform specific, but it may have been triggered by something else. What you show about the sphinx environment is quite suggestive. I will investigate that stuff.",
    "created_at": "2017-08-11T01:05:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431313",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:28'></a>Not platform specific, but it may have been triggered by something else. What you show about the sphinx environment is quite suggestive. I will investigate that stuff.



---

archive/issue_comments_431314.json:
```json
{
    "body": "<a id='comment:29'></a>I cannot seem to be able to force the smart_quotes to `False` at runtime either. More curious, I am looking at the file `sandpile.py` and there are other instances of help messages with double quotes that don't trigger doctests failures. So I am wondering if utf8 is also part of the mix.",
    "created_at": "2017-08-11T02:22:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431314",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:29'></a>I cannot seem to be able to force the smart_quotes to `False` at runtime either. More curious, I am looking at the file `sandpile.py` and there are other instances of help messages with double quotes that don't trigger doctests failures. So I am wondering if utf8 is also part of the mix.



---

archive/issue_comments_431315.json:
```json
{
    "body": "<a id='comment:30'></a>It's strange. In the two sandpile files with failures, single quotes are getting replaced, but not `--` by an en-dash. In `ipython_tests.py`, `--` is replaced by en-dashes, but that's all, the quotes are not changed.",
    "created_at": "2017-08-11T02:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431315",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>It's strange. In the two sandpile files with failures, single quotes are getting replaced, but not `--` by an en-dash. In `ipython_tests.py`, `--` is replaced by en-dashes, but that's all, the quotes are not changed.



---

archive/issue_comments_431316.json:
```json
{
    "body": "<a id='comment:31'></a>Two more things: first, I am seeing some messages unnecessarily labeled as \"warnings\":\n\n```\n[dochtml] Build finished.  The built documents can be found in /Users/palmieri/Desktop/Sage_stuff/git/sage/local/share/doc/sage/inventory/en/reference/parallel\n[dochtml] [parallel ] WARNING: Build finished.  The built documents can be found in /Users/palmieri/Desktop/Sage_stuff/git/sage/local/share/doc/sage/inventory/en/reference/parallel\n```\nSecond, there are deprecation warnings:\n\n```\n/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sphinx/util/compat.py:40: RemovedInSphinx17Warning: sphinx.util.compat.Directive is deprecated and will be removed in Sphinx 1.7, please use docutils' instead.\n```\nIt looks like these can be removed with this change:\n\n```diff\ndiff --git a/src/sage_setup/docbuild/ext/sage_autodoc.py b/src/sage_setup/docbuild/ext/sage_autodoc.py\nindex 32b045c6bf..7590e22918 100644\n--- a/src/sage_setup/docbuild/ext/sage_autodoc.py\n+++ b/src/sage_setup/docbuild/ext/sage_autodoc.py\n@@ -39,7 +39,7 @@ from sphinx.locale import _\n from sphinx.pycode import ModuleAnalyzer, PycodeError\n from sphinx.application import ExtensionError\n from sphinx.util.nodes import nested_parse_with_titles\n-from sphinx.util.compat import Directive\n+from docutils.parsers.rst import Directive\n from sphinx.util.inspect import getargspec, isdescriptor, safe_getmembers, \\\n     safe_getattr, object_description, is_builtin_class_method\n from sphinx.util.docstrings import prepare_docstring\n```\nEdit: this is while building the reference manual.",
    "created_at": "2017-08-11T03:05:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431316",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'></a>Two more things: first, I am seeing some messages unnecessarily labeled as "warnings":

```
[dochtml] Build finished.  The built documents can be found in /Users/palmieri/Desktop/Sage_stuff/git/sage/local/share/doc/sage/inventory/en/reference/parallel
[dochtml] [parallel ] WARNING: Build finished.  The built documents can be found in /Users/palmieri/Desktop/Sage_stuff/git/sage/local/share/doc/sage/inventory/en/reference/parallel
```
Second, there are deprecation warnings:

```
/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sphinx/util/compat.py:40: RemovedInSphinx17Warning: sphinx.util.compat.Directive is deprecated and will be removed in Sphinx 1.7, please use docutils' instead.
```
It looks like these can be removed with this change:

```diff
diff --git a/src/sage_setup/docbuild/ext/sage_autodoc.py b/src/sage_setup/docbuild/ext/sage_autodoc.py
index 32b045c6bf..7590e22918 100644
--- a/src/sage_setup/docbuild/ext/sage_autodoc.py
+++ b/src/sage_setup/docbuild/ext/sage_autodoc.py
@@ -39,7 +39,7 @@ from sphinx.locale import _
 from sphinx.pycode import ModuleAnalyzer, PycodeError
 from sphinx.application import ExtensionError
 from sphinx.util.nodes import nested_parse_with_titles
-from sphinx.util.compat import Directive
+from docutils.parsers.rst import Directive
 from sphinx.util.inspect import getargspec, isdescriptor, safe_getmembers, \
     safe_getattr, object_description, is_builtin_class_method
 from sphinx.util.docstrings import prepare_docstring
```
Edit: this is while building the reference manual.



---

archive/issue_comments_431317.json:
```json
{
    "body": "<a id='comment:32'></a>Yes, we can definitely do something about the deprecation. The `WARNING` is more curious.",
    "created_at": "2017-08-11T03:09:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431317",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:32'></a>Yes, we can definitely do something about the deprecation. The `WARNING` is more curious.



---

archive/issue_comments_431318.json:
```json
{
    "body": "<a id='comment:33'></a>Looks like the WARNING is self inflicted\n\n```\n        # replacements: pairs of regular expressions and their replacements,\n        # to be applied to Sphinx output.\n        self.replacements = [(re.compile('build succeeded, [0-9]+ warning[s]?.'),\n                              'build succeeded.')]\n```\nfrom `sage_setup/docbuild/sphinxbuild.py`",
    "created_at": "2017-08-11T03:16:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431318",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:33'></a>Looks like the WARNING is self inflicted

```
        # replacements: pairs of regular expressions and their replacements,
        # to be applied to Sphinx output.
        self.replacements = [(re.compile('build succeeded, [0-9]+ warning[s]?.'),
                              'build succeeded.')]
```
from `sage_setup/docbuild/sphinxbuild.py`



---

archive/issue_comments_431319.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [jhpalmieri](#comment%3A27):\n> I think I figured out the right place for `docutils.conf`:\n> \n> ```\n> #!diff\n> diff --git a/src/sage/misc/sphinxify.py b/src/sage/misc/sphinxify.py\n> index f084a19bf6..f114b9fcd7 100644\n> --- a/src/sage/misc/sphinxify.py\n> +++ b/src/sage/misc/sphinxify.py\n> @@ -80,6 +80,10 @@ def sphinxify(docstring, format='html'):\n>      # buildername, confoverrides, status, warning, freshenv).\n>      confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')\n>  \n> +    open(os.path.join(srcdir, 'docutils.conf'), 'w').write(r\"\"\"\n> +[parser]\n> +smart_quotes = no\n> +\"\"\")\n>      doctreedir = os.path.join(srcdir, 'doctrees')\n>      confoverrides = {'html_context': {}, 'master_doc': 'docstring'}\n>   \n> ```\n> But even though Sphinx seems to find this file, it doesn't change Sphinx's setting for `self.settings['smart_quotes']`.\n\n\nparser -> parsers I got something to work that way specifying `DOCUTILSCONFIG`",
    "created_at": "2017-08-11T03:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431319",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:34'></a>Replying to [jhpalmieri](#comment%3A27):
> I think I figured out the right place for `docutils.conf`:
> 
> ```
> #!diff
> diff --git a/src/sage/misc/sphinxify.py b/src/sage/misc/sphinxify.py
> index f084a19bf6..f114b9fcd7 100644
> --- a/src/sage/misc/sphinxify.py
> +++ b/src/sage/misc/sphinxify.py
> @@ -80,6 +80,10 @@ def sphinxify(docstring, format='html'):
>      # buildername, confoverrides, status, warning, freshenv).
>      confdir = os.path.join(SAGE_DOC_SRC, 'en', 'introspect')
>  
> +    open(os.path.join(srcdir, 'docutils.conf'), 'w').write(r"""
> +[parser]
> +smart_quotes = no
> +""")
>      doctreedir = os.path.join(srcdir, 'doctrees')
>      confoverrides = {'html_context': {}, 'master_doc': 'docstring'}
>   
> ```
> But even though Sphinx seems to find this file, it doesn't change Sphinx's setting for `self.settings['smart_quotes']`.


parser -> parsers I got something to work that way specifying `DOCUTILSCONFIG`



---

archive/issue_comments_431320.json:
```json
{
    "body": "<a id='comment:35'></a>Yes, your change but with `parsers` instead of `parser` works for sandpile.py.",
    "created_at": "2017-08-11T03:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431320",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:35'></a>Yes, your change but with `parsers` instead of `parser` works for sandpile.py.



---

archive/issue_comments_431321.json:
```json
{
    "body": "<a id='comment:36'></a>Good, thanks for catching that. I thought I had tried \"parsers\", and in fact I had, but with the wrong location for `docutils.conf`.",
    "created_at": "2017-08-11T04:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431321",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:36'></a>Good, thanks for catching that. I thought I had tried "parsers", and in fact I had, but with the wrong location for `docutils.conf`.



---

archive/issue_comments_431322.json:
```json
{
    "body": "<a id='comment:37'></a>We can silence the warnings by adding the appropriate regular expression to `self.useless_chatter`:\n\n```diff\ndiff --git a/src/sage_setup/docbuild/sphinxbuild.py b/src/sage_setup/docbuild/sphinxbuild.py\nindex 1deac3d312..ade37bd80f 100644\n--- a/src/sage_setup/docbuild/sphinxbuild.py\n+++ b/src/sage_setup/docbuild/sphinxbuild.py\n@@ -56,6 +56,7 @@ class SageSphinxLogger(object):\n             re.compile('WARNING: while setting up extension'),\n             re.compile('WARNING: Any IDs not assiend for figure node'),\n             re.compile('WARNING: .* is not referenced'),\n+            re.compile('WARNING: Build finished.*'),\n             re.compile('language \"hu\" not supported'),\n             )\n \n```",
    "created_at": "2017-08-11T04:42:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431322",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:37'></a>We can silence the warnings by adding the appropriate regular expression to `self.useless_chatter`:

```diff
diff --git a/src/sage_setup/docbuild/sphinxbuild.py b/src/sage_setup/docbuild/sphinxbuild.py
index 1deac3d312..ade37bd80f 100644
--- a/src/sage_setup/docbuild/sphinxbuild.py
+++ b/src/sage_setup/docbuild/sphinxbuild.py
@@ -56,6 +56,7 @@ class SageSphinxLogger(object):
             re.compile('WARNING: while setting up extension'),
             re.compile('WARNING: Any IDs not assiend for figure node'),
             re.compile('WARNING: .* is not referenced'),
+            re.compile('WARNING: Build finished.*'),
             re.compile('language "hu" not supported'),
             )
 
```



---

archive/issue_comments_431323.json:
```json
{
    "body": "Changing branch from \"u/fbissey/sphinx1.6.3\" to \"u/jhpalmieri/sphinx1.6.3\"",
    "created_at": "2017-08-11T04:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431323",
    "user": "https://github.com/jhpalmieri"
}
```

Changing branch from "u/fbissey/sphinx1.6.3" to "u/jhpalmieri/sphinx1.6.3"



---

archive/issue_comments_431324.json:
```json
{
    "body": "<a id='comment:39'></a>Here is a branch with my proposed changes.\n\n---\nNew commits:",
    "created_at": "2017-08-11T04:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431324",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:39'></a>Here is a branch with my proposed changes.

---
New commits:



---

archive/issue_comments_431325.json:
```json
{
    "body": "Changing commit from \"6930d06663d7bbac51c840f163ba0874fbd2e9e7\" to \"56bffcc8508c9a0ed9c052d0fc4db5ae9e71e53c\"",
    "created_at": "2017-08-11T04:47:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431325",
    "user": "https://github.com/jhpalmieri"
}
```

Changing commit from "6930d06663d7bbac51c840f163ba0874fbd2e9e7" to "56bffcc8508c9a0ed9c052d0fc4db5ae9e71e53c"



---

archive/issue_comments_431326.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [jhpalmieri](#comment%3A37):\n> We can silence the warnings by adding the appropriate regular expression to `self.useless_chatter`:\n> \n> ```\n> #!diff\n> diff --git a/src/sage_setup/docbuild/sphinxbuild.py b/src/sage_setup/docbuild/sphinxbuild.py\n> index 1deac3d312..ade37bd80f 100644\n> --- a/src/sage_setup/docbuild/sphinxbuild.py\n> +++ b/src/sage_setup/docbuild/sphinxbuild.py\n> @@ -56,6 +56,7 @@ class SageSphinxLogger(object):\n>              re.compile('WARNING: while setting up extension'),\n>              re.compile('WARNING: Any IDs not assiend for figure node'),\n>              re.compile('WARNING: .* is not referenced'),\n> +            re.compile('WARNING: Build finished.*'),\n>              re.compile('language \"hu\" not supported'),\n>              )\n>  \n> ```\n\nYes we could, but I believe we are generating them ourselves a few lines down #23023?replyto=37#comment:33. I think we shouldn't generate them in the first place.",
    "created_at": "2017-08-11T05:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431326",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:40'></a>Replying to [jhpalmieri](#comment%3A37):
> We can silence the warnings by adding the appropriate regular expression to `self.useless_chatter`:
> 
> ```
> #!diff
> diff --git a/src/sage_setup/docbuild/sphinxbuild.py b/src/sage_setup/docbuild/sphinxbuild.py
> index 1deac3d312..ade37bd80f 100644
> --- a/src/sage_setup/docbuild/sphinxbuild.py
> +++ b/src/sage_setup/docbuild/sphinxbuild.py
> @@ -56,6 +56,7 @@ class SageSphinxLogger(object):
>              re.compile('WARNING: while setting up extension'),
>              re.compile('WARNING: Any IDs not assiend for figure node'),
>              re.compile('WARNING: .* is not referenced'),
> +            re.compile('WARNING: Build finished.*'),
>              re.compile('language "hu" not supported'),
>              )
>  
> ```

Yes we could, but I believe we are generating them ourselves a few lines down #23023?replyto=37#comment:33. I think we shouldn't generate them in the first place.



---

archive/issue_comments_431327.json:
```json
{
    "body": "<a id='comment:41'></a>These warning messages say \"Build finished...\". The other line (from[comment:33](#comment%3A33)) refers to strings saying \"build succeeded...\", so I don't think they're the same thing.",
    "created_at": "2017-08-11T15:02:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431327",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:41'></a>These warning messages say "Build finished...". The other line (from[comment:33](#comment%3A33)) refers to strings saying "build succeeded...", so I don't think they're the same thing.



---

archive/issue_comments_431328.json:
```json
{
    "body": "Changing reviewer from \"Fran\u00e7ois Bissey, Jeroen Demeyer\" to \"Fran\u00e7ois Bissey, Jeroen Demeyer, John Palmieri\"",
    "created_at": "2017-08-12T03:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431328",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "François Bissey, Jeroen Demeyer" to "François Bissey, Jeroen Demeyer, John Palmieri"



---

archive/issue_comments_431329.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-12T03:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431329",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_431330.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [jhpalmieri](#comment%3A41):\n> These warning messages say \"Build finished...\". The other line (from[comment:33](#comment%3A33)) refers to strings saying \"build succeeded...\", so I don't think they're the same thing.\n\n\nRight you are. So, at the very least back to need review. I find it surprising that there doesn't seem to be an easier way to set smart_quotes but that's the only documented way.",
    "created_at": "2017-08-12T03:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431330",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:42'></a>Replying to [jhpalmieri](#comment%3A41):
> These warning messages say "Build finished...". The other line (from[comment:33](#comment%3A33)) refers to strings saying "build succeeded...", so I don't think they're the same thing.


Right you are. So, at the very least back to need review. I find it surprising that there doesn't seem to be an easier way to set smart_quotes but that's the only documented way.



---

archive/issue_comments_431331.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer, Fran\u00e7ois Bissey\" to \"Jeroen Demeyer, Fran\u00e7ois Bissey, John Palmieri\"",
    "created_at": "2017-08-12T03:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431331",
    "user": "https://github.com/kiwifb"
}
```

Changing author from "Jeroen Demeyer, François Bissey" to "Jeroen Demeyer, François Bissey, John Palmieri"



---

archive/issue_comments_431332.json:
```json
{
    "body": "<a id='comment:43'></a>Everything else was positively reviewed, so I can't review my own branch. Can you reproduce the doctest failures and verify that the change to sphinxify.py fixes them?\n\nFrom the docutils documentation, it sounds like there is a command-line switch to turn off smart quotes, but I don't think we can use that since we are not calling docutils from the command line.",
    "created_at": "2017-08-12T05:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431332",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:43'></a>Everything else was positively reviewed, so I can't review my own branch. Can you reproduce the doctest failures and verify that the change to sphinxify.py fixes them?

From the docutils documentation, it sounds like there is a command-line switch to turn off smart quotes, but I don't think we can use that since we are not calling docutils from the command line.



---

archive/issue_comments_431333.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-12T06:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431333",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_431334.json:
```json
{
    "body": "<a id='comment:44'></a>Replying to [jhpalmieri](#comment%3A43):\n> Everything else was positively reviewed, so I can't review my own branch. Can you reproduce the doctest failures and verify that the change to sphinxify.py fixes them?\n> \n\n\nI can and I already checked.\n\n> From the docutils documentation, it sounds like there is a command-line switch to turn off smart quotes, but I don't think we can use that since we are not calling docutils from the command line.\n\n\nYes. I am fairly sure there is a direct way to get sphinx to call docutils with different options but I don't know how to do it.",
    "created_at": "2017-08-12T06:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431334",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:44'></a>Replying to [jhpalmieri](#comment%3A43):
> Everything else was positively reviewed, so I can't review my own branch. Can you reproduce the doctest failures and verify that the change to sphinxify.py fixes them?
> 


I can and I already checked.

> From the docutils documentation, it sounds like there is a command-line switch to turn off smart quotes, but I don't think we can use that since we are not calling docutils from the command line.


Yes. I am fairly sure there is a direct way to get sphinx to call docutils with different options but I don't know how to do it.



---

archive/issue_comments_431335.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-08-12T17:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431335",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_431336.json:
```json
{
    "body": "<a id='comment:45'></a>Parallel \"make doc-pdf\" doesn't work, hangs with N = number of processes python zombies.",
    "created_at": "2017-08-12T17:45:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431336",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:45'></a>Parallel "make doc-pdf" doesn't work, hangs with N = number of processes python zombies.



---

archive/issue_comments_431337.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [vbraun](#comment%3A45):\n> Parallel \"make doc-pdf\" doesn't work, hangs with N = number of processes python zombies.\n\n\nI can't reproduce this on OS X. More silly warning messages, but it completes:\n\n```\n[docpdf] Elapsed time: 895.7 seconds.\n[docpdf] [website  ] WARNING: Elapsed time: 895.7 seconds.\n[docpdf] Done building the documentation!\n[docpdf] [website  ] WARNING: Done building the documentation!\n\nreal\t15m5.280s\nuser\t59m42.040s\nsys\t3m0.851s\nSage build/upgrade complete!\n```",
    "created_at": "2017-08-12T21:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431337",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:46'></a>Replying to [vbraun](#comment%3A45):
> Parallel "make doc-pdf" doesn't work, hangs with N = number of processes python zombies.


I can't reproduce this on OS X. More silly warning messages, but it completes:

```
[docpdf] Elapsed time: 895.7 seconds.
[docpdf] [website  ] WARNING: Elapsed time: 895.7 seconds.
[docpdf] Done building the documentation!
[docpdf] [website  ] WARNING: Done building the documentation!

real	15m5.280s
user	59m42.040s
sys	3m0.851s
Sage build/upgrade complete!
```



---

archive/issue_comments_431338.json:
```json
{
    "body": "<a id='comment:47'></a>Couldn't reproduce it here either on Gentoo at \"-j8\".",
    "created_at": "2017-08-13T01:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431338",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:47'></a>Couldn't reproduce it here either on Gentoo at "-j8".



---

archive/issue_comments_431339.json:
```json
{
    "body": "<a id='comment:48'></a>And in case it matters, I'm using \"-j6\".",
    "created_at": "2017-08-13T03:27:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431339",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:48'></a>And in case it matters, I'm using "-j6".



---

archive/issue_comments_431340.json:
```json
{
    "body": "<a id='comment:49'></a>Just got a hicup while doing another test. `typing` wasn't installed in time for building doc-pdf, so dependencies will have to be tweaked.",
    "created_at": "2017-08-13T22:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431340",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:49'></a>Just got a hicup while doing another test. `typing` wasn't installed in time for building doc-pdf, so dependencies will have to be tweaked.



---

archive/issue_comments_431341.json:
```json
{
    "body": "Changing branch from \"u/jhpalmieri/sphinx1.6.3\" to \"u/fbissey/sphinx1.6.3\"",
    "created_at": "2017-08-13T23:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431341",
    "user": "https://github.com/kiwifb"
}
```

Changing branch from "u/jhpalmieri/sphinx1.6.3" to "u/fbissey/sphinx1.6.3"



---

archive/issue_comments_431342.json:
```json
{
    "body": "Changing commit from \"56bffcc8508c9a0ed9c052d0fc4db5ae9e71e53c\" to \"c48896722c5546fbdca8a58e6516828912d87f85\"",
    "created_at": "2017-08-13T23:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431342",
    "user": "https://github.com/kiwifb"
}
```

Changing commit from "56bffcc8508c9a0ed9c052d0fc4db5ae9e71e53c" to "c48896722c5546fbdca8a58e6516828912d87f85"



---

archive/issue_comments_431343.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-13T23:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431343",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_431344.json:
```json
{
    "body": "<a id='comment:50'></a>That should take care of that last problem, but it doesn't explain Volker's issue that we cannot seem to able to reproduce. I am waiting for more opinions before putting it back to positive.\n\n---\nNew commits:",
    "created_at": "2017-08-13T23:40:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431344",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:50'></a>That should take care of that last problem, but it doesn't explain Volker's issue that we cannot seem to able to reproduce. I am waiting for more opinions before putting it back to positive.

---
New commits:



---

archive/issue_comments_431345.json:
```json
{
    "body": "<a id='comment:51'></a>Should `typing` be a dependency for `sphinx`, or just for doc-building?",
    "created_at": "2017-08-14T00:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431345",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:51'></a>Should `typing` be a dependency for `sphinx`, or just for doc-building?



---

archive/issue_comments_431346.json:
```json
{
    "body": "<a id='comment:52'></a>It is a runtime dependency. You could probably use some functionalities of sphinx without touching `typing`, that's why I put it there rather a dependency of `sphinx` but I gave it some thought.",
    "created_at": "2017-08-14T01:14:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431346",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:52'></a>It is a runtime dependency. You could probably use some functionalities of sphinx without touching `typing`, that's why I put it there rather a dependency of `sphinx` but I gave it some thought.



---

archive/issue_comments_431347.json:
```json
{
    "body": "<a id='comment:53'></a>Do we wait for more information, or do we mark this as \"positive review\" and hope that the dependencies fix the problem?",
    "created_at": "2017-08-14T05:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431347",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:53'></a>Do we wait for more information, or do we mark this as "positive review" and hope that the dependencies fix the problem?



---

archive/issue_comments_431348.json:
```json
{
    "body": "<a id='comment:54'></a>We may as well have another go.",
    "created_at": "2017-08-14T05:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431348",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:54'></a>We may as well have another go.



---

archive/issue_comments_431349.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-14T05:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431349",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_431350.json:
```json
{
    "body": "<a id='comment:55'></a>Replying to [fbissey](#comment%3A52):\n> It is a runtime dependency. You could probably use some functionalities of sphinx without touching `typing`, that's why I put it there rather a dependency of `sphinx` but I gave it some thought.\n\n\nI agree. You don't need typing just to install Sphinx.",
    "created_at": "2017-08-14T08:33:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431350",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:55'></a>Replying to [fbissey](#comment%3A52):
> It is a runtime dependency. You could probably use some functionalities of sphinx without touching `typing`, that's why I put it there rather a dependency of `sphinx` but I gave it some thought.


I agree. You don't need typing just to install Sphinx.



---

archive/issue_comments_431351.json:
```json
{
    "body": "<a id='comment:56'></a>Still get the error from `make -j10 doc-pdf`. The docpdf.log contains errors like\n\n```\n<sin_plot.png, id=51, 602.25pt x 501.875pt> <use sin_plot.png> [3 [85]]make[2]: *** write jobserver: Bad file descriptor.  Stop.\n```\nSeems like some script is mucking with the inherited make jobserver file descriptor.",
    "created_at": "2017-08-14T22:34:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431351",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:56'></a>Still get the error from `make -j10 doc-pdf`. The docpdf.log contains errors like

```
<sin_plot.png, id=51, 602.25pt x 501.875pt> <use sin_plot.png> [3 [85]]make[2]: *** write jobserver: Bad file descriptor.  Stop.
```
Seems like some script is mucking with the inherited make jobserver file descriptor.



---

archive/issue_comments_431352.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-08-14T22:34:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431352",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_431353.json:
```json
{
    "body": "<a id='comment:57'></a>That a little bit more to work on than your first report. I'll see if I can trigger this again.",
    "created_at": "2017-08-14T22:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431353",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:57'></a>That a little bit more to work on than your first report. I'll see if I can trigger this again.



---

archive/issue_comments_431354.json:
```json
{
    "body": "<a id='comment:58'></a>Btw which latexmk are you using? 4.52c here...",
    "created_at": "2017-08-15T06:46:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431354",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:58'></a>Btw which latexmk are you using? 4.52c here...



---

archive/issue_comments_431355.json:
```json
{
    "body": "<a id='comment:59'></a>`4.35` here, I can upgrade to see if it has an impact. I may be slow to respond in the next couple of days. The proverbial `s**t` hit the fan at work today.",
    "created_at": "2017-08-15T07:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431355",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:59'></a>`4.35` here, I can upgrade to see if it has an impact. I may be slow to respond in the next couple of days. The proverbial `s**t` hit the fan at work today.



---

archive/issue_comments_431356.json:
```json
{
    "body": "<a id='comment:60'></a>4.52c for me.",
    "created_at": "2017-08-15T14:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431356",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:60'></a>4.52c for me.



---

archive/issue_comments_431357.json:
```json
{
    "body": "<a id='comment:61'></a>No difference with `latekmk-4.52c` here.",
    "created_at": "2017-08-20T22:42:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431357",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:61'></a>No difference with `latekmk-4.52c` here.



---

archive/issue_comments_431358.json:
```json
{
    "body": "<a id='comment:62'></a>I upgraded to Fedora 26 and can't reproduce it any more...",
    "created_at": "2017-08-26T09:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431358",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:62'></a>I upgraded to Fedora 26 and can't reproduce it any more...



---

archive/issue_events_059629.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-26T09:58:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23023#event-59629"
}
```



---

archive/issue_comments_431359.json:
```json
{
    "body": "Changing branch from \"u/fbissey/sphinx1.6.3\" to \"c48896722c5546fbdca8a58e6516828912d87f85\"",
    "created_at": "2017-08-26T09:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431359",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/fbissey/sphinx1.6.3" to "c48896722c5546fbdca8a58e6516828912d87f85"



---

archive/issue_comments_431360.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-26T09:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431360",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_431361.json:
```json
{
    "body": "<a id='comment:64'></a>Replying to [vbraun](#comment%3A62):\n> I upgraded to Fedora 26 and can't reproduce it any more...\n\n\nWeird. But glad we are moving forward on that one.",
    "created_at": "2017-08-26T10:03:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431361",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:64'></a>Replying to [vbraun](#comment%3A62):
> I upgraded to Fedora 26 and can't reproduce it any more...


Weird. But glad we are moving forward on that one.



---

archive/issue_comments_431362.json:
```json
{
    "body": "Changing commit from \"c48896722c5546fbdca8a58e6516828912d87f85\" to \"\"",
    "created_at": "2017-08-26T10:03:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431362",
    "user": "https://github.com/kiwifb"
}
```

Changing commit from "c48896722c5546fbdca8a58e6516828912d87f85" to ""



---

archive/issue_comments_431363.json:
```json
{
    "body": "<a id='comment:65'></a>Thanks for finally getting this done.",
    "created_at": "2017-08-28T14:47:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431363",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:65'></a>Thanks for finally getting this done.



---

archive/issue_comments_431364.json:
```json
{
    "body": "<a id='comment:66'></a>What is the reason for `typing` package being `standard` rather than `pip` type?",
    "created_at": "2017-08-31T08:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431364",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:66'></a>What is the reason for `typing` package being `standard` rather than `pip` type?



---

archive/issue_comments_431365.json:
```json
{
    "body": "<a id='comment:67'></a>Not sure. I cannot say I really ever cared for that particular distinction - sorry.",
    "created_at": "2017-08-31T08:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431365",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:67'></a>Not sure. I cannot say I really ever cared for that particular distinction - sorry.



---

archive/issue_comments_431366.json:
```json
{
    "body": "<a id='comment:68'></a>Replying to [fbissey](#comment%3A67):\n> Not sure. I cannot say I really ever cared for that particular distinction - sorry.\n\nIn particular, it's about having an extra tarball to care about; (`pip` type, to the contrary, is just a placeholder, no tarball to worry about...)\n\nThe only thing I can imagine is that one needs to specify in some standard package that it depends on it (either via Sage deps mechanism, or via pip/setup.py, I suppose...)",
    "created_at": "2017-08-31T08:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431366",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:68'></a>Replying to [fbissey](#comment%3A67):
> Not sure. I cannot say I really ever cared for that particular distinction - sorry.

In particular, it's about having an extra tarball to care about; (`pip` type, to the contrary, is just a placeholder, no tarball to worry about...)

The only thing I can imagine is that one needs to specify in some standard package that it depends on it (either via Sage deps mechanism, or via pip/setup.py, I suppose...)



---

archive/issue_comments_431367.json:
```json
{
    "body": "<a id='comment:69'></a>Right, if you need to download it then it really makes it a special kind of optional package. `typing` is meant to be a standard package so part of the sage tarball.",
    "created_at": "2017-08-31T08:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431367",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:69'></a>Right, if you need to download it then it really makes it a special kind of optional package. `typing` is meant to be a standard package so part of the sage tarball.



---

archive/issue_comments_431368.json:
```json
{
    "body": "<a id='comment:70'></a>Replying to [dimpase](#comment%3A66):\n> What is the reason for `typing` package being `standard` rather than `pip` type?\n\n\n`standard` packages can depend only on `standard` packages: we do not assume Internet access when building Sage from source.",
    "created_at": "2017-08-31T08:37:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431368",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:70'></a>Replying to [dimpase](#comment%3A66):
> What is the reason for `typing` package being `standard` rather than `pip` type?


`standard` packages can depend only on `standard` packages: we do not assume Internet access when building Sage from source.



---

archive/issue_comments_431369.json:
```json
{
    "body": "<a id='comment:71'></a>I am stuck on #14645 with a pip package I don't know how to specify, due to \"`-`\" in its name, namely `sphinxcontrib-websupport`. It cannot be of type `pip`, as `-` is not allowed in the Sage package names, as far as I can tell...",
    "created_at": "2017-08-31T08:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431369",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:71'></a>I am stuck on #14645 with a pip package I don't know how to specify, due to "`-`" in its name, namely `sphinxcontrib-websupport`. It cannot be of type `pip`, as `-` is not allowed in the Sage package names, as far as I can tell...



---

archive/issue_comments_431370.json:
```json
{
    "body": "<a id='comment:72'></a>And can it be a standard package or is it the same problem? In any case that problem should be its own ticket.",
    "created_at": "2017-08-31T08:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431370",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:72'></a>And can it be a standard package or is it the same problem? In any case that problem should be its own ticket.



---

archive/issue_comments_431371.json:
```json
{
    "body": "<a id='comment:73'></a>Replying to [fbissey](#comment%3A72):\n> And can it be a standard package or is it the same problem? In any case that problem should be its own ticket.\n\n\nOf course with a standard package you can do anything in principle, but the standard machinery you used it `typing` won't work IMHO, as `sage-pip-install` (i.e. `$PIP_INSTALL` used in `spkg-install`) does not seem to allow\nthe name of pip package to be installed as an argument...",
    "created_at": "2017-08-31T09:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431371",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:73'></a>Replying to [fbissey](#comment%3A72):
> And can it be a standard package or is it the same problem? In any case that problem should be its own ticket.


Of course with a standard package you can do anything in principle, but the standard machinery you used it `typing` won't work IMHO, as `sage-pip-install` (i.e. `$PIP_INSTALL` used in `spkg-install`) does not seem to allow
the name of pip package to be installed as an argument...



---

archive/issue_comments_431372.json:
```json
{
    "body": "<a id='comment:74'></a>Replying to [dimpase](#comment%3A73):\n> Replying to [fbissey](#comment%3A72):\n> > And can it be a standard package or is it the same problem? In any case that problem should be its own ticket.\n\n> \n> Of course with a standard package you can do anything in principle, but the standard machinery you used it `typing` won't work IMHO, as `sage-pip-install` (i.e. `$PIP_INSTALL` used in `spkg-install`) does not seem to allow\n> the name of pip package to be installed as an argument...\n\n\nWe should really have this conversation at #14645 not here. I am not sure what your problem is with `$PIP_INSTALL`. It is a replacement for `python setup.py` in the package source tree. It behaves in a similar way but is better at package management operation (it knows how to remove a previous install properly).",
    "created_at": "2017-08-31T09:25:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431372",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:74'></a>Replying to [dimpase](#comment%3A73):
> Replying to [fbissey](#comment%3A72):
> > And can it be a standard package or is it the same problem? In any case that problem should be its own ticket.

> 
> Of course with a standard package you can do anything in principle, but the standard machinery you used it `typing` won't work IMHO, as `sage-pip-install` (i.e. `$PIP_INSTALL` used in `spkg-install`) does not seem to allow
> the name of pip package to be installed as an argument...


We should really have this conversation at #14645 not here. I am not sure what your problem is with `$PIP_INSTALL`. It is a replacement for `python setup.py` in the package source tree. It behaves in a similar way but is better at package management operation (it knows how to remove a previous install properly).



---

archive/issue_comments_431373.json:
```json
{
    "body": "<a id='comment:75'></a>I have opened #23764 to deal with this issue. Sorry for noise here.",
    "created_at": "2017-08-31T09:35:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431373",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:75'></a>I have opened #23764 to deal with this issue. Sorry for noise here.



---

archive/issue_comments_431374.json:
```json
{
    "body": "<a id='comment:76'></a>See #23834 for a followup.",
    "created_at": "2017-09-11T23:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23023#issuecomment-431374",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:76'></a>See #23834 for a followup.
