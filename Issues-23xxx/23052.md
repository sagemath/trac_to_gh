# Issue 23052: operations between sage and gmpy2 numbers

archive/issues_022815.json:
```json
{
    "assignees": [],
    "body": "Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.\n\nNote: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.\n\nUpstream issue: https://github.com/aleaxit/gmpy/issues/214\n\nAssignee: **@vinklein**\n\nCC:  @videlec @jdemeyer\n\nBranch/Commit: **[b7fbb9a](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Vincent Klein**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23052_\n\n",
    "closed_at": "2019-03-14T18:13:58Z",
    "created_at": "2017-05-22T10:18:18Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "operations between sage and gmpy2 numbers",
    "type": "issue",
    "updated_at": "2019-03-14T18:13:58Z",
    "url": "https://github.com/sagemath/sage/issues/23052",
    "user": "https://github.com/vinklein"
}
```
Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.

Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.

Upstream issue: https://github.com/aleaxit/gmpy/issues/214

Assignee: **@vinklein**

CC:  @videlec @jdemeyer

Branch/Commit: **[b7fbb9a](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **Vincent Delecroix**

Author: **Vincent Klein**

_Issue created by migration from https://trac.sagemath.org/ticket/23052_





---

archive/issue_events_303484.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:18:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303484"
}
```



---

archive/issue_events_303485.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:18:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "component: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303485"
}
```



---

archive/issue_events_303486.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:18:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303486"
}
```



---

archive/issue_events_303487.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:18:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303487"
}
```



---

archive/issue_comments_347896.json:
```json
{
    "body": "Assignee: **@vinklein**",
    "created_at": "2017-05-22T10:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347896",
    "user": "https://github.com/vinklein"
}
```

Assignee: **@vinklein**



---

archive/issue_comments_347897.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,3 @@\n Provide coercion for gmpy2 numbers for operations -, +, * and /\n+\n This ticket follow the discussion about coercion for gmpy2 numbers #22928.\n``````\n",
    "created_at": "2017-05-22T10:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347897",
    "user": "https://github.com/vinklein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,3 @@
 Provide coercion for gmpy2 numbers for operations -, +, * and /
+
 This ticket follow the discussion about coercion for gmpy2 numbers #22928.
``````




---

archive/issue_comments_347898.json:
```json
{
    "body": "Replying to [ticket:23052 vklein]:\n> Provide coercion for gmpy2 numbers for operations -, +, * and /\n\nThis makes no sense to me. What does it mean to provide coercion for **certain operations** only?",
    "created_at": "2017-05-22T10:26:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347898",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:23052 vklein]:
> Provide coercion for gmpy2 numbers for operations -, +, * and /

This makes no sense to me. What does it mean to provide coercion for **certain operations** only?



---

archive/issue_comments_347899.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Provide coercion for gmpy2 numbers for operations -, +, * and /\n+Provide coercion for gmpy2 numbers\n \n This ticket follow the discussion about coercion for gmpy2 numbers #22928.\n``````\n",
    "created_at": "2017-05-22T11:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347899",
    "user": "https://github.com/vinklein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Provide coercion for gmpy2 numbers for operations -, +, * and /
+Provide coercion for gmpy2 numbers
 
 This ticket follow the discussion about coercion for gmpy2 numbers #22928.
``````




---

archive/issue_comments_347900.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nYou're right, description updated",
    "created_at": "2017-05-22T11:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347900",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:3'>Comment 3:</a>
You're right, description updated



---

archive/issue_comments_347901.json:
```json
{
    "body": "Changed dependencies from **22928** to **#22928**",
    "created_at": "2017-05-22T11:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347901",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **22928** to **#22928**



---

archive/issue_comments_347902.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nThanks for the clarification.",
    "created_at": "2017-05-22T11:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347902",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:4'>Comment 4:</a>
Thanks for the clarification.



---

archive/issue_comments_347903.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Provide coercion for gmpy2 numbers\n-\n-This ticket follow the discussion about coercion for gmpy2 numbers #22928.\n+This ticket follows the discussion about coercion for gmpy2 numbers #22928. It is not clear:\n+- whether this coercion is desirable\n+- in which direction coercion should be done (Sage -> gmpy2 or gmpy2 -> Sage)\n``````\n",
    "created_at": "2017-05-22T16:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347903",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Provide coercion for gmpy2 numbers
-
-This ticket follow the discussion about coercion for gmpy2 numbers #22928.
+This ticket follows the discussion about coercion for gmpy2 numbers #22928. It is not clear:
+- whether this coercion is desirable
+- in which direction coercion should be done (Sage -> gmpy2 or gmpy2 -> Sage)
``````




---

archive/issue_events_303488.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-22T16:07:28Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "title_is": "coercion for gmpy2 numbers",
    "title_was": "Provide coercion for gmpy2 numbers",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303488"
}
```



---

archive/issue_comments_347904.json:
```json
{
    "body": "Changed dependencies from **#22928** to **#22928, #23024**",
    "created_at": "2018-02-07T08:45:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347904",
    "user": "https://github.com/videlec"
}
```

Changed dependencies from **#22928** to **#22928, #23024**



---

archive/issue_comments_347905.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n-This ticket follows the discussion about coercion for gmpy2 numbers #22928. It is not clear:\n-- whether this coercion is desirable\n-- in which direction coercion should be done (Sage -> gmpy2 or gmpy2 -> Sage)\n+This ticket follows the discussion about coercion for gmpy2 numbers #22928 (see also #23024 that proposes to make `gmpy2` a standard package). As it is the case with Python types, we implement coercion from gmpy2 types to the corresponding Sage types\n+- `gmpy2.mpz` -> `Integer`\n+- `gmpy2.mpq` -> `Rational`\n+- `gmpy2.mpfr` -> `RealNumber`\n+- `gmpy2.mpc` -> `MPComplexNumber`\n``````\n",
    "created_at": "2018-02-07T08:45:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347905",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
-This ticket follows the discussion about coercion for gmpy2 numbers #22928. It is not clear:
-- whether this coercion is desirable
-- in which direction coercion should be done (Sage -> gmpy2 or gmpy2 -> Sage)
+This ticket follows the discussion about coercion for gmpy2 numbers #22928 (see also #23024 that proposes to make `gmpy2` a standard package). As it is the case with Python types, we implement coercion from gmpy2 types to the corresponding Sage types
+- `gmpy2.mpz` -> `Integer`
+- `gmpy2.mpq` -> `Rational`
+- `gmpy2.mpfr` -> `RealNumber`
+- `gmpy2.mpc` -> `MPComplexNumber`
``````




---

archive/issue_comments_347906.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nI don't think that this feature is desirable. The behavior should be the same as with `cypari2`\n\n```\nsage: import cypari2\nsage: pari = cypari2.Pari()\nsage: type(pari(1) + 1)\n<type 'cypari2.gen.Gen'>\nsage: type(1 + pari(1))\n<type 'cypari2.gen.Gen'>\n```\nMixing `gmpy2` numbers with sage numbers currently raise errors\n\n```\nsage: import gmpy2\nsage: type(gmpy2.mpz(1) + 1)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-eeaeca1c122b> in <module>()\n----> 1 type(gmpy2.mpz(Integer(1)) + Integer(1))\n\n/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()\n   1683             return y\n   1684 \n-> 1685         return coercion_model.bin_op(left, right, operator.add)\n   1686 \n   1687     cpdef _add_(self, right):\n\n/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()\n   1208         # We should really include the underlying error.\n   1209         # This causes so much headache.\n-> 1210         raise bin_op_exception(op, x, y)\n   1211 \n   1212     cpdef canonical_coercion(self, x, y):\n\nTypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'\nsage: type(1 + gmpy2.mpz(1))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-ea356a02d58b> in <module>()\n----> 1 type(Integer(1) + gmpy2.mpz(Integer(1)))\n\n/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()\n   1683             return y\n   1684 \n-> 1685         return coercion_model.bin_op(left, right, operator.add)\n   1686 \n   1687     cpdef _add_(self, right):\n\n/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()\n   1208         # We should really include the underlying error.\n   1209         # This causes so much headache.\n-> 1210         raise bin_op_exception(op, x, y)\n   1211 \n   1212     cpdef canonical_coercion(self, x, y):\n\nTypeError: unsupported operand parent(s) for +: 'Integer Ring' and '<type 'mpz'>'\n```",
    "created_at": "2019-03-03T10:19:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347906",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'>Comment 7:</a>
I don't think that this feature is desirable. The behavior should be the same as with `cypari2`

```
sage: import cypari2
sage: pari = cypari2.Pari()
sage: type(pari(1) + 1)
<type 'cypari2.gen.Gen'>
sage: type(1 + pari(1))
<type 'cypari2.gen.Gen'>
```
Mixing `gmpy2` numbers with sage numbers currently raise errors

```
sage: import gmpy2
sage: type(gmpy2.mpz(1) + 1)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-eeaeca1c122b> in <module>()
----> 1 type(gmpy2.mpz(Integer(1)) + Integer(1))

/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()
   1683             return y
   1684 
-> 1685         return coercion_model.bin_op(left, right, operator.add)
   1686 
   1687     cpdef _add_(self, right):

/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()
   1208         # We should really include the underlying error.
   1209         # This causes so much headache.
-> 1210         raise bin_op_exception(op, x, y)
   1211 
   1212     cpdef canonical_coercion(self, x, y):

TypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'
sage: type(1 + gmpy2.mpz(1))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-ea356a02d58b> in <module>()
----> 1 type(Integer(1) + gmpy2.mpz(Integer(1)))

/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()
   1683             return y
   1684 
-> 1685         return coercion_model.bin_op(left, right, operator.add)
   1686 
   1687     cpdef _add_(self, right):

/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()
   1208         # We should really include the underlying error.
   1209         # This causes so much headache.
-> 1210         raise bin_op_exception(op, x, y)
   1211 
   1212     cpdef canonical_coercion(self, x, y):

TypeError: unsupported operand parent(s) for +: 'Integer Ring' and '<type 'mpz'>'
```



---

archive/issue_comments_347907.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nTo make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).",
    "created_at": "2019-03-03T10:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347907",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'>Comment 8:</a>
To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).



---

archive/issue_comments_347908.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nReplying to [@videlec](#comment%3A8):\n> To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).\n\nThis is obviously the right thing to do. Given that\n\n```\nsage: from gmpy2 import mpz\nsage: mpz(1) + int(1)\nmpz(2)\n```\nworks, it's actually strange that\n\n```\nsage: from gmpy2 import mpz\nsage: mpz(1) + Integer(1)\nTraceback (most recent call last):\n...\nTypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'\n```\ndoesn't work.",
    "created_at": "2019-03-03T10:53:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347908",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'>Comment 9:</a>
Replying to [@videlec](#comment%3A8):
> To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).

This is obviously the right thing to do. Given that

```
sage: from gmpy2 import mpz
sage: mpz(1) + int(1)
mpz(2)
```
works, it's actually strange that

```
sage: from gmpy2 import mpz
sage: mpz(1) + Integer(1)
Traceback (most recent call last):
...
TypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'
```
doesn't work.



---

archive/issue_comments_347909.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nLet me update the ticket description then.",
    "created_at": "2019-03-03T10:54:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347909",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'>Comment 10:</a>
Let me update the ticket description then.



---

archive/issue_comments_347910.json:
```json
{
    "body": "Upstream: **Not yet reported upstream; Will do shortly.**",
    "created_at": "2019-03-03T10:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347910",
    "user": "https://github.com/videlec"
}
```

Upstream: **Not yet reported upstream; Will do shortly.**



---

archive/issue_events_303489.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "title_is": "operations between sage and gmpy2 numbers",
    "title_was": "coercion for gmpy2 numbers",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303489"
}
```



---

archive/issue_comments_347911.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,3 @@\n-This ticket follows the discussion about coercion for gmpy2 numbers #22928 (see also #23024 that proposes to make `gmpy2` a standard package). As it is the case with Python types, we implement coercion from gmpy2 types to the corresponding Sage types\n-- `gmpy2.mpz` -> `Integer`\n-- `gmpy2.mpq` -> `Rational`\n-- `gmpy2.mpfr` -> `RealNumber`\n-- `gmpy2.mpc` -> `MPComplexNumber`\n+Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.\n+\n+Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.\n``````\n",
    "created_at": "2019-03-03T10:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347911",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,3 @@
-This ticket follows the discussion about coercion for gmpy2 numbers #22928 (see also #23024 that proposes to make `gmpy2` a standard package). As it is the case with Python types, we implement coercion from gmpy2 types to the corresponding Sage types
-- `gmpy2.mpz` -> `Integer`
-- `gmpy2.mpq` -> `Rational`
-- `gmpy2.mpfr` -> `RealNumber`
-- `gmpy2.mpc` -> `MPComplexNumber`
+Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.
+
+Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.
``````




---

archive/issue_events_303490.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "component: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303490"
}
```



---

archive/issue_events_303491.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303491"
}
```



---

archive/issue_events_303492.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303492"
}
```



---

archive/issue_events_303493.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303493"
}
```



---

archive/issue_comments_347912.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.\n \n Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.\n+\n+Upstream issue: https://github.com/aleaxit/gmpy/issues/214\n``````\n",
    "created_at": "2019-03-04T17:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347912",
    "user": "https://github.com/vinklein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.
 
 Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.
+
+Upstream issue: https://github.com/aleaxit/gmpy/issues/214
``````




---

archive/issue_comments_347913.json:
```json
{
    "body": "Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**",
    "created_at": "2019-03-04T17:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347913",
    "user": "https://github.com/vinklein"
}
```

Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**



---

archive/issue_comments_347914.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2019-03-07T07:30:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347914",
    "user": "https://github.com/vinklein"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_347915.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nThe gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\\\\\nShould we make a patch based on this or wait for the next gmpy2 release ?",
    "created_at": "2019-03-07T09:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347915",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:14'>Comment 14:</a>
The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\\
Should we make a patch based on this or wait for the next gmpy2 release ?



---

archive/issue_comments_347916.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@vinklein](#comment%3A14):\n> The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\n\nThis is a great news. Thanks for the work!\n\n> Should we make a patch based on this or wait for the next gmpy2 release ?\n\nDo we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.\n\nOtherwise, I am not a big fan of using patches that are integrated upstream but not released yet.",
    "created_at": "2019-03-07T12:50:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347916",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@vinklein](#comment%3A14):
> The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.

This is a great news. Thanks for the work!

> Should we make a patch based on this or wait for the next gmpy2 release ?

Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.

Otherwise, I am not a big fan of using patches that are integrated upstream but not released yet.



---

archive/issue_comments_347917.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nReplying to [@videlec](#comment%3A15):\n> Replying to [@vinklein](#comment%3A14):\n> > Should we make a patch based on this or wait for the next gmpy2 release ?\n\n> \n> Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.\n\nSomehow [#199](https://github.com/aleaxit/gmpy/issues/199) is a bit of an answer.",
    "created_at": "2019-03-07T12:52:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347917",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'>Comment 16:</a>
Replying to [@videlec](#comment%3A15):
> Replying to [@vinklein](#comment%3A14):
> > Should we make a patch based on this or wait for the next gmpy2 release ?

> 
> Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.

Somehow [#199](https://github.com/aleaxit/gmpy/issues/199) is a bit of an answer.



---

archive/issue_comments_347918.json:
```json
{
    "body": "Branch: **[u/vklein/23052](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/23052)**",
    "created_at": "2019-03-08T09:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347918",
    "user": "https://github.com/vinklein"
}
```

Branch: **[u/vklein/23052](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/23052)**



---

archive/issue_comments_347919.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nAfter some talk with vdelecroix we agree to make a gmpy2 patch with [#217](https://github.com/aleaxit/gmpy/pull/217).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5\">edfe875</a></td><td><code>Trac #23052: patch gmpy2 with PR #217 ...</code></td></tr></table>\n",
    "created_at": "2019-03-08T09:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347919",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:18'>Comment 18:</a>
After some talk with vdelecroix we agree to make a gmpy2 patch with [#217](https://github.com/aleaxit/gmpy/pull/217).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5">edfe875</a></td><td><code>Trac #23052: patch gmpy2 with PR #217 ...</code></td></tr></table>




---

archive/issue_comments_347920.json:
```json
{
    "body": "Commit: **[edfe875](https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5)**",
    "created_at": "2019-03-08T09:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347920",
    "user": "https://github.com/vinklein"
}
```

Commit: **[edfe875](https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5)**



---

archive/issue_events_303494.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-08T09:40:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303494"
}
```



---

archive/issue_comments_347921.json:
```json
{
    "body": "Changed dependencies from **#22928, #23024** to none",
    "created_at": "2019-03-08T09:41:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347921",
    "user": "https://github.com/vinklein"
}
```

Changed dependencies from **#22928, #23024** to none



---

archive/issue_events_303495.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-08T09:41:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303495"
}
```



---

archive/issue_events_303496.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-08T09:41:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303496"
}
```



---

archive/issue_comments_347922.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nYou create a lot of warnings with the macros. This should be fixed.\n\n```\ngmpy2-2.1.0a4.p1]     src/gmpy2_cache.c: In function 'GMPy_MPZ_NewInit':\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:44:60: warning: suggest parentheses around '&&' within '||' [-Wparentheses]\n[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPZ_CONVERSION(x) HAS_MPZ_CONVERSION(x) && \\\n[gmpy2-2.1.0a4.p1]                                                                 ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:52:25: note: in expansion of macro 'HAS_STRICT_MPZ_CONVERSION'\n[gmpy2-2.1.0a4.p1]                              HAS_STRICT_MPZ_CONVERSION(x))\n[gmpy2-2.1.0a4.p1]                              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:61:25: note: in expansion of macro 'IS_INTEGER'\n[gmpy2-2.1.0a4.p1]      #define IS_RATIONAL(x) (IS_INTEGER(x) || IS_RATIONAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:21: note: in expansion of macro 'IS_RATIONAL'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                          ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'\n[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {\n[gmpy2-2.1.0a4.p1]              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:46:62: warning: suggest parentheses around '&&' within '||' [-Wparentheses]\n[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPFR_CONVERSION(x) HAS_MPFR_CONVERSION(x) && \\\n[gmpy2-2.1.0a4.p1]                                                                   ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:63:63: note: in expansion of macro 'HAS_STRICT_MPFR_CONVERSION'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL_ONLY(x) (MPFR_Check(x) || PyFloat_Check(x) || HAS_STRICT_MPFR_CONVERSION(x))\n[gmpy2-2.1.0a4.p1]                                                                    ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:39: note: in expansion of macro 'IS_REAL_ONLY'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                                            ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'\n[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {\n[gmpy2-2.1.0a4.p1]              ^\n```",
    "created_at": "2019-03-08T18:46:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347922",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'>Comment 21:</a>
You create a lot of warnings with the macros. This should be fixed.

```
gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c: In function 'GMPy_MPZ_NewInit':
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:44:60: warning: suggest parentheses around '&&' within '||' [-Wparentheses]
[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPZ_CONVERSION(x) HAS_MPZ_CONVERSION(x) && \
[gmpy2-2.1.0a4.p1]                                                                 ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:52:25: note: in expansion of macro 'HAS_STRICT_MPZ_CONVERSION'
[gmpy2-2.1.0a4.p1]                              HAS_STRICT_MPZ_CONVERSION(x))
[gmpy2-2.1.0a4.p1]                              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:61:25: note: in expansion of macro 'IS_INTEGER'
[gmpy2-2.1.0a4.p1]      #define IS_RATIONAL(x) (IS_INTEGER(x) || IS_RATIONAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:21: note: in expansion of macro 'IS_RATIONAL'
[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                          ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'
[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {
[gmpy2-2.1.0a4.p1]              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:46:62: warning: suggest parentheses around '&&' within '||' [-Wparentheses]
[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPFR_CONVERSION(x) HAS_MPFR_CONVERSION(x) && \
[gmpy2-2.1.0a4.p1]                                                                   ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:63:63: note: in expansion of macro 'HAS_STRICT_MPFR_CONVERSION'
[gmpy2-2.1.0a4.p1]      #define IS_REAL_ONLY(x) (MPFR_Check(x) || PyFloat_Check(x) || HAS_STRICT_MPFR_CONVERSION(x))
[gmpy2-2.1.0a4.p1]                                                                    ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:39: note: in expansion of macro 'IS_REAL_ONLY'
[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                                            ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'
[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {
[gmpy2-2.1.0a4.p1]              ^
```



---

archive/issue_events_303497.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-08T18:46:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303497"
}
```



---

archive/issue_events_303498.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-08T18:46:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303498"
}
```



---

archive/issue_comments_347923.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643\">b60be6d</a></td><td><code>Trac #23052: Fix thousands lines of warnings.</code></td></tr></table>\n",
    "created_at": "2019-03-11T08:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347923",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:22'>Comment 22:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643">b60be6d</a></td><td><code>Trac #23052: Fix thousands lines of warnings.</code></td></tr></table>




---

archive/issue_comments_347924.json:
```json
{
    "body": "Changed commit from **[edfe875](https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5)** to **[b60be6d](https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643)**",
    "created_at": "2019-03-11T08:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347924",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[edfe875](https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5)** to **[b60be6d](https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643)**



---

archive/issue_comments_347925.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nWarnings fixed.",
    "created_at": "2019-03-11T08:35:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347925",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:23'>Comment 23:</a>
Warnings fixed.



---

archive/issue_events_303499.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-11T08:35:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303499"
}
```



---

archive/issue_events_303500.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-11T08:35:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303500"
}
```



---

archive/issue_comments_347926.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nsome failures...\n\n```\nDoctesting 3797 files using 14 threads.\nsage -t --long src/sage/arith/misc.py\n**********************************************************************\nFile \"src/sage/arith/misc.py\", line 3120, in sage.arith.misc.crt\nFailed example:\n    crt(mpz(2), mpz(3), mpz(7), mpz(11))\nExpected:\n    58\nGot:\n    mpz(58)\n**********************************************************************\nFile \"src/sage/arith/misc.py\", line 3122, in sage.arith.misc.crt\nFailed example:\n    crt(mpz(2), 3, mpz(7), numpy.int8(11))\nExpected:\n    58\nGot:\n    mpz(58)\n**********************************************************************\n1 item had failures:\n   2 of  37 in sage.arith.misc.crt\n    [1056 tests, 2 failures, 30.02 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/arith/misc.py  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-03-11T15:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347926",
    "user": "https://github.com/videlec"
}
```

<a id='comment:24'>Comment 24:</a>
some failures...

```
Doctesting 3797 files using 14 threads.
sage -t --long src/sage/arith/misc.py
**********************************************************************
File "src/sage/arith/misc.py", line 3120, in sage.arith.misc.crt
Failed example:
    crt(mpz(2), mpz(3), mpz(7), mpz(11))
Expected:
    58
Got:
    mpz(58)
**********************************************************************
File "src/sage/arith/misc.py", line 3122, in sage.arith.misc.crt
Failed example:
    crt(mpz(2), 3, mpz(7), numpy.int8(11))
Expected:
    58
Got:
    mpz(58)
**********************************************************************
1 item had failures:
   2 of  37 in sage.arith.misc.crt
    [1056 tests, 2 failures, 30.02 s]
----------------------------------------------------------------------
sage -t --long src/sage/arith/misc.py  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_events_303501.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-11T15:18:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303501"
}
```



---

archive/issue_events_303502.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-11T15:18:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303502"
}
```



---

archive/issue_comments_347927.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4\">5dff83b</a></td><td><code>Trac #23052: arith.misc.crt ensure this function</code></td></tr></table>\n",
    "created_at": "2019-03-11T17:30:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347927",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:25'>Comment 25:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4">5dff83b</a></td><td><code>Trac #23052: arith.misc.crt ensure this function</code></td></tr></table>




---

archive/issue_comments_347928.json:
```json
{
    "body": "Changed commit from **[b60be6d](https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643)** to **[5dff83b](https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4)**",
    "created_at": "2019-03-11T17:30:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347928",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b60be6d](https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643)** to **[5dff83b](https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4)**



---

archive/issue_comments_347929.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nfunction `sage.arith.misc.crt` fixed",
    "created_at": "2019-03-11T17:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347929",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:26'>Comment 26:</a>
function `sage.arith.misc.crt` fixed



---

archive/issue_events_303503.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-11T17:32:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303503"
}
```



---

archive/issue_events_303504.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-11T17:32:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303504"
}
```



---

archive/issue_comments_347930.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nThe patch that you called `PR217.patch` comes from two pull requests ([#217](https://github.com/aleaxit/gmpy/pull/217) and [#218](https://github.com/aleaxit/gmpy/pull/218)). You would better change the name of the patch and mention very explicitely in the header of the patch the urls of the actual pull requests.",
    "created_at": "2019-03-11T19:00:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347930",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'>Comment 27:</a>
The patch that you called `PR217.patch` comes from two pull requests ([#217](https://github.com/aleaxit/gmpy/pull/217) and [#218](https://github.com/aleaxit/gmpy/pull/218)). You would better change the name of the patch and mention very explicitely in the header of the patch the urls of the actual pull requests.



---

archive/issue_comments_347931.json:
```json
{
    "body": "Changed commit from **[5dff83b](https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4)** to **[b7fbb9a](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**",
    "created_at": "2019-03-12T07:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347931",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5dff83b](https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4)** to **[b7fbb9a](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**



---

archive/issue_comments_347932.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c\">b7fbb9a</a></td><td><code>Trac #23052: Rename patch and add links to the...</code></td></tr></table>\n",
    "created_at": "2019-03-12T07:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347932",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:28'>Comment 28:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c">b7fbb9a</a></td><td><code>Trac #23052: Rename patch and add links to the...</code></td></tr></table>




---

archive/issue_comments_347933.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nPatch renamed and links added.",
    "created_at": "2019-03-12T07:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347933",
    "user": "https://github.com/vinklein"
}
```

<a id='comment:29'>Comment 29:</a>
Patch renamed and links added.



---

archive/issue_comments_347934.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2019-03-12T08:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347934",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_303505.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-12T08:47:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303505"
}
```



---

archive/issue_events_303506.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-12T08:47:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303506"
}
```



---

archive/issue_events_303507.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-14T18:13:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303507"
}
```



---

archive/issue_events_303508.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ae38e0e0c81ce4f1491fb98ffd7643f067a4a918",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-03-14T18:13:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-303508"
}
```



---

archive/issue_comments_347935.json:
```json
{
    "body": "Changed branch from **[u/vklein/23052](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/23052)** to **[b7fbb9a](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**",
    "created_at": "2019-03-14T18:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-347935",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vklein/23052](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/23052)** to **[b7fbb9a](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**
