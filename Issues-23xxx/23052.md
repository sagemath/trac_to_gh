# Issue 23052: operations between sage and gmpy2 numbers

archive/issues_022815.json:
```json
{
    "assignees": [
        "https://github.com/vinklein"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nCurrently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.\n\nNote: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.\n\nUpstream issue: https://github.com/aleaxit/gmpy/issues/214\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nCC:  @videlec @jdemeyer\n\nComponent: **packages: standard**\n\nAuthor: **Vincent Klein**\n\nBranch/Commit: **[`b7fbb9a`](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**\n\nReviewer: **Vincent Delecroix**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23052_\n\n",
    "closed_at": "2019-03-14T18:13:58Z",
    "created_at": "2017-05-22T10:18:18Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "operations between sage and gmpy2 numbers",
    "type": "issue",
    "updated_at": "2019-03-14T18:13:58Z",
    "url": "https://github.com/sagemath/sage/issues/23052",
    "user": "https://github.com/vinklein"
}
```
<div id="comment:0"></div>

Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.

Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.

Upstream issue: https://github.com/aleaxit/gmpy/issues/214

Upstream: **Fixed upstream, in a later stable release.**

CC:  @videlec @jdemeyer

Component: **packages: standard**

Author: **Vincent Klein**

Branch/Commit: **[`b7fbb9a`](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**

Reviewer: **Vincent Delecroix**

_Issue created by migration from https://trac.sagemath.org/ticket/23052_





---

archive/issue_events_318661.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:18:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318661"
}
```



---

archive/issue_events_318662.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:18:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "0000b0",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318662"
}
```



---

archive/issue_events_318663.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:18:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318663"
}
```



---

archive/issue_events_318664.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:18:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318664"
}
```



---

archive/issue_events_318665.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2017-05-22T10:19:07Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "subject": "https://github.com/vinklein",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318665"
}
```



---

archive/issue_comments_345169.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,3 @@\n Provide coercion for gmpy2 numbers for operations -, +, * and /\n+\n This ticket follow the discussion about coercion for gmpy2 numbers #22928.\n``````\n",
    "created_at": "2017-05-22T10:19:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345169",
    "user": "https://github.com/vinklein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,3 @@
 Provide coercion for gmpy2 numbers for operations -, +, * and /
+
 This ticket follow the discussion about coercion for gmpy2 numbers #22928.
``````




---

archive/issue_comments_345170.json:
```json
{
    "body": "Replying to [@vinklein](https://github.com/sagemath/sage/issues/23052#comment:0):\n> Provide coercion for gmpy2 numbers for operations -, +, * and /\n\nThis makes no sense to me. What does it mean to provide coercion for **certain operations** only?",
    "created_at": "2017-05-22T10:26:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345170",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [@vinklein](https://github.com/sagemath/sage/issues/23052#comment:0):
> Provide coercion for gmpy2 numbers for operations -, +, * and /

This makes no sense to me. What does it mean to provide coercion for **certain operations** only?



---

archive/issue_comments_345171.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Provide coercion for gmpy2 numbers for operations -, +, * and /\n+Provide coercion for gmpy2 numbers\n \n This ticket follow the discussion about coercion for gmpy2 numbers #22928.\n``````\n",
    "created_at": "2017-05-22T11:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345171",
    "user": "https://github.com/vinklein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Provide coercion for gmpy2 numbers for operations -, +, * and /
+Provide coercion for gmpy2 numbers
 
 This ticket follow the discussion about coercion for gmpy2 numbers #22928.
``````




---

archive/issue_comments_345172.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nYou're right, description updated",
    "created_at": "2017-05-22T11:22:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345172",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:3" align="right">comment:3</div>

You're right, description updated



---

archive/issue_comments_345173.json:
```json
{
    "body": "Changed dependencies from **22928** to **#22928**",
    "created_at": "2017-05-22T11:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345173",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **22928** to **#22928**



---

archive/issue_comments_345174.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThanks for the clarification.",
    "created_at": "2017-05-22T11:44:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345174",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

Thanks for the clarification.



---

archive/issue_comments_345175.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-Provide coercion for gmpy2 numbers\n-\n-This ticket follow the discussion about coercion for gmpy2 numbers #22928.\n+This ticket follows the discussion about coercion for gmpy2 numbers #22928. It is not clear:\n+- whether this coercion is desirable\n+- in which direction coercion should be done (Sage -> gmpy2 or gmpy2 -> Sage)\n``````\n",
    "created_at": "2017-05-22T16:07:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345175",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-Provide coercion for gmpy2 numbers
-
-This ticket follow the discussion about coercion for gmpy2 numbers #22928.
+This ticket follows the discussion about coercion for gmpy2 numbers #22928. It is not clear:
+- whether this coercion is desirable
+- in which direction coercion should be done (Sage -> gmpy2 or gmpy2 -> Sage)
``````




---

archive/issue_events_318666.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-05-22T16:07:28Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "title_is": "coercion for gmpy2 numbers",
    "title_was": "Provide coercion for gmpy2 numbers",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318666"
}
```



---

archive/issue_comments_345176.json:
```json
{
    "body": "Changed dependencies from **#22928** to **#22928, #23024**",
    "created_at": "2018-02-07T08:45:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345176",
    "user": "https://github.com/videlec"
}
```

Changed dependencies from **#22928** to **#22928, #23024**



---

archive/issue_comments_345177.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n-This ticket follows the discussion about coercion for gmpy2 numbers #22928. It is not clear:\n-- whether this coercion is desirable\n-- in which direction coercion should be done (Sage -> gmpy2 or gmpy2 -> Sage)\n+This ticket follows the discussion about coercion for gmpy2 numbers #22928 (see also #23024 that proposes to make `gmpy2` a standard package). As it is the case with Python types, we implement coercion from gmpy2 types to the corresponding Sage types\n+- `gmpy2.mpz` -> `Integer`\n+- `gmpy2.mpq` -> `Rational`\n+- `gmpy2.mpfr` -> `RealNumber`\n+- `gmpy2.mpc` -> `MPComplexNumber`\n``````\n",
    "created_at": "2018-02-07T08:45:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345177",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
-This ticket follows the discussion about coercion for gmpy2 numbers #22928. It is not clear:
-- whether this coercion is desirable
-- in which direction coercion should be done (Sage -> gmpy2 or gmpy2 -> Sage)
+This ticket follows the discussion about coercion for gmpy2 numbers #22928 (see also #23024 that proposes to make `gmpy2` a standard package). As it is the case with Python types, we implement coercion from gmpy2 types to the corresponding Sage types
+- `gmpy2.mpz` -> `Integer`
+- `gmpy2.mpq` -> `Rational`
+- `gmpy2.mpfr` -> `RealNumber`
+- `gmpy2.mpc` -> `MPComplexNumber`
``````




---

archive/issue_comments_345178.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI don't think that this feature is desirable. The behavior should be the same as with `cypari2`\n\n```\nsage: import cypari2\nsage: pari = cypari2.Pari()\nsage: type(pari(1) + 1)\n<type 'cypari2.gen.Gen'>\nsage: type(1 + pari(1))\n<type 'cypari2.gen.Gen'>\n```\nMixing `gmpy2` numbers with sage numbers currently raise errors\n\n```\nsage: import gmpy2\nsage: type(gmpy2.mpz(1) + 1)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-2-eeaeca1c122b> in <module>()\n----> 1 type(gmpy2.mpz(Integer(1)) + Integer(1))\n\n/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()\n   1683             return y\n   1684 \n-> 1685         return coercion_model.bin_op(left, right, operator.add)\n   1686 \n   1687     cpdef _add_(self, right):\n\n/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()\n   1208         # We should really include the underlying error.\n   1209         # This causes so much headache.\n-> 1210         raise bin_op_exception(op, x, y)\n   1211 \n   1212     cpdef canonical_coercion(self, x, y):\n\nTypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'\nsage: type(1 + gmpy2.mpz(1))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-3-ea356a02d58b> in <module>()\n----> 1 type(Integer(1) + gmpy2.mpz(Integer(1)))\n\n/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()\n   1683             return y\n   1684 \n-> 1685         return coercion_model.bin_op(left, right, operator.add)\n   1686 \n   1687     cpdef _add_(self, right):\n\n/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()\n   1208         # We should really include the underlying error.\n   1209         # This causes so much headache.\n-> 1210         raise bin_op_exception(op, x, y)\n   1211 \n   1212     cpdef canonical_coercion(self, x, y):\n\nTypeError: unsupported operand parent(s) for +: 'Integer Ring' and '<type 'mpz'>'\n```",
    "created_at": "2019-03-03T10:19:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345178",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">comment:7</div>

I don't think that this feature is desirable. The behavior should be the same as with `cypari2`

```
sage: import cypari2
sage: pari = cypari2.Pari()
sage: type(pari(1) + 1)
<type 'cypari2.gen.Gen'>
sage: type(1 + pari(1))
<type 'cypari2.gen.Gen'>
```
Mixing `gmpy2` numbers with sage numbers currently raise errors

```
sage: import gmpy2
sage: type(gmpy2.mpz(1) + 1)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-2-eeaeca1c122b> in <module>()
----> 1 type(gmpy2.mpz(Integer(1)) + Integer(1))

/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()
   1683             return y
   1684 
-> 1685         return coercion_model.bin_op(left, right, operator.add)
   1686 
   1687     cpdef _add_(self, right):

/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()
   1208         # We should really include the underlying error.
   1209         # This causes so much headache.
-> 1210         raise bin_op_exception(op, x, y)
   1211 
   1212     cpdef canonical_coercion(self, x, y):

TypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'
sage: type(1 + gmpy2.mpz(1))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-3-ea356a02d58b> in <module>()
----> 1 type(Integer(1) + gmpy2.mpz(Integer(1)))

/opt/sage/local/lib/python2.7/site-packages/sage/rings/integer.pyx in sage.rings.integer.Integer.__add__ (build/cythonized/sage/rings/integer.c:11460)()
   1683             return y
   1684 
-> 1685         return coercion_model.bin_op(left, right, operator.add)
   1686 
   1687     cpdef _add_(self, right):

/opt/sage/local/lib/python2.7/site-packages/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel.bin_op (build/cythonized/sage/structure/coerce.c:11110)()
   1208         # We should really include the underlying error.
   1209         # This causes so much headache.
-> 1210         raise bin_op_exception(op, x, y)
   1211 
   1212     cpdef canonical_coercion(self, x, y):

TypeError: unsupported operand parent(s) for +: 'Integer Ring' and '<type 'mpz'>'
```



---

archive/issue_comments_345179.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nTo make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).",
    "created_at": "2019-03-03T10:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345179",
    "user": "https://github.com/videlec"
}
```

<div id="comment:8" align="right">comment:8</div>

To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).



---

archive/issue_comments_345180.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@videlec](#comment%3A8):\n> To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).\n\nThis is obviously the right thing to do. Given that\n\n```\nsage: from gmpy2 import mpz\nsage: mpz(1) + int(1)\nmpz(2)\n```\nworks, it's actually strange that\n\n```\nsage: from gmpy2 import mpz\nsage: mpz(1) + Integer(1)\nTraceback (most recent call last):\n...\nTypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'\n```\ndoesn't work.",
    "created_at": "2019-03-03T10:53:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345180",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@videlec](#comment%3A8):
> To make this work, one has to modify the various binary operators in `gmpy2` (e.g. `GMPy_Integer_Add`).

This is obviously the right thing to do. Given that

```
sage: from gmpy2 import mpz
sage: mpz(1) + int(1)
mpz(2)
```
works, it's actually strange that

```
sage: from gmpy2 import mpz
sage: mpz(1) + Integer(1)
Traceback (most recent call last):
...
TypeError: unsupported operand parent(s) for +: '<type 'mpz'>' and 'Integer Ring'
```
doesn't work.



---

archive/issue_comments_345181.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nLet me update the ticket description then.",
    "created_at": "2019-03-03T10:54:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345181",
    "user": "https://github.com/videlec"
}
```

<div id="comment:10" align="right">comment:10</div>

Let me update the ticket description then.



---

archive/issue_comments_345182.json:
```json
{
    "body": "Upstream: **Not yet reported upstream; Will do shortly.**",
    "created_at": "2019-03-03T10:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345182",
    "user": "https://github.com/videlec"
}
```

Upstream: **Not yet reported upstream; Will do shortly.**



---

archive/issue_events_318667.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "title_is": "operations between sage and gmpy2 numbers",
    "title_was": "coercion for gmpy2 numbers",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318667"
}
```



---

archive/issue_comments_345183.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,3 @@\n-This ticket follows the discussion about coercion for gmpy2 numbers #22928 (see also #23024 that proposes to make `gmpy2` a standard package). As it is the case with Python types, we implement coercion from gmpy2 types to the corresponding Sage types\n-- `gmpy2.mpz` -> `Integer`\n-- `gmpy2.mpq` -> `Rational`\n-- `gmpy2.mpfr` -> `RealNumber`\n-- `gmpy2.mpc` -> `MPComplexNumber`\n+Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.\n+\n+Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.\n``````\n",
    "created_at": "2019-03-03T10:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345183",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,3 @@
-This ticket follows the discussion about coercion for gmpy2 numbers #22928 (see also #23024 that proposes to make `gmpy2` a standard package). As it is the case with Python types, we implement coercion from gmpy2 types to the corresponding Sage types
-- `gmpy2.mpz` -> `Integer`
-- `gmpy2.mpq` -> `Rational`
-- `gmpy2.mpfr` -> `RealNumber`
-- `gmpy2.mpc` -> `MPComplexNumber`
+Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.
+
+Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.
``````




---

archive/issue_events_318668.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "0000b0",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318668"
}
```



---

archive/issue_events_318669.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318669"
}
```



---

archive/issue_events_318670.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318670"
}
```



---

archive/issue_events_318671.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-03T10:59:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318671"
}
```



---

archive/issue_comments_345184.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.\n \n Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.\n+\n+Upstream issue: https://github.com/aleaxit/gmpy/issues/214\n``````\n",
    "created_at": "2019-03-04T17:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345184",
    "user": "https://github.com/vinklein"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 Currently, operations involving Sage and gmpy2 numbers are broken (see [comment:7]). Though, it works fine with gmpy2 and Python numbers. The reason is that the various binary operations implemented in gmpy2 just check for Python integer types. It should be possible to modify these functions in order that an operation involving a gmpy2 number and a type implementing one of the `__mpz__`/`__mpq__`/`__mpfr__`/`__mpc__` method should work.
 
 Note: #22928 implemented the conversion Sage type -> gmpy2 type via the implementation of the `__mpz__`, `__mpq__`, `__mpfr__` and `__mpc__` methods.
+
+Upstream issue: https://github.com/aleaxit/gmpy/issues/214
``````




---

archive/issue_comments_345185.json:
```json
{
    "body": "Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**",
    "created_at": "2019-03-04T17:10:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345185",
    "user": "https://github.com/vinklein"
}
```

Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**



---

archive/issue_comments_345186.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2019-03-07T07:30:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345186",
    "user": "https://github.com/vinklein"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_345187.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\\\\\nShould we make a patch based on this or wait for the next gmpy2 release ?",
    "created_at": "2019-03-07T09:47:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345187",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:14" align="right">comment:14</div>

The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\\
Should we make a patch based on this or wait for the next gmpy2 release ?



---

archive/issue_comments_345188.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@vinklein](#comment%3A14):\n> The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.\n\nThis is a great news. Thanks for the work!\n\n> Should we make a patch based on this or wait for the next gmpy2 release ?\n\nDo we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.\n\nOtherwise, I am not a big fan of using patches that are integrated upstream but not released yet.",
    "created_at": "2019-03-07T12:50:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345188",
    "user": "https://github.com/videlec"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@vinklein](#comment%3A14):
> The gmpy2 pull request [#217](https://github.com/aleaxit/gmpy/pull/217) has been merged this morning.

This is a great news. Thanks for the work!

> Should we make a patch based on this or wait for the next gmpy2 release ?

Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.

Otherwise, I am not a big fan of using patches that are integrated upstream but not released yet.



---

archive/issue_comments_345189.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@videlec](#comment%3A15):\n> Replying to [@vinklein](#comment%3A14):\n> > Should we make a patch based on this or wait for the next gmpy2 release ?\n> \n> \n> Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.\n\nSomehow [#199](https://github.com/aleaxit/gmpy/issues/199) is a bit of an answer.",
    "created_at": "2019-03-07T12:52:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345189",
    "user": "https://github.com/videlec"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@videlec](#comment%3A15):
> Replying to [@vinklein](#comment%3A14):
> > Should we make a patch based on this or wait for the next gmpy2 release ?
> 
> 
> Do we have a schedule for the next gmpy2 release? Since gmpy2 becomes a standard package for the next Sage release it would be nice if it would happen before.

Somehow [#199](https://github.com/aleaxit/gmpy/issues/199) is a bit of an answer.



---

archive/issue_comments_345190.json:
```json
{
    "body": "Branch: **[u/vklein/23052](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/23052)**",
    "created_at": "2019-03-08T09:34:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345190",
    "user": "https://github.com/vinklein"
}
```

Branch: **[u/vklein/23052](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/23052)**



---

archive/issue_comments_345191.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nAfter some talk with vdelecroix we agree to make a gmpy2 patch with [#217](https://github.com/aleaxit/gmpy/pull/217).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5\"><code>edfe875</code></a></td><td><code>Trac #23052: patch gmpy2 with PR #217 ...</code></td></tr></table>\n",
    "created_at": "2019-03-08T09:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345191",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:18" align="right">comment:18</div>

After some talk with vdelecroix we agree to make a gmpy2 patch with [#217](https://github.com/aleaxit/gmpy/pull/217).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5"><code>edfe875</code></a></td><td><code>Trac #23052: patch gmpy2 with PR #217 ...</code></td></tr></table>




---

archive/issue_comments_345192.json:
```json
{
    "body": "Commit: **[`edfe875`](https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5)**",
    "created_at": "2019-03-08T09:40:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345192",
    "user": "https://github.com/vinklein"
}
```

Commit: **[`edfe875`](https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5)**



---

archive/issue_events_318672.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-08T09:40:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318672"
}
```



---

archive/issue_comments_345193.json:
```json
{
    "body": "Changed dependencies from **#22928, #23024** to none",
    "created_at": "2019-03-08T09:41:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345193",
    "user": "https://github.com/vinklein"
}
```

Changed dependencies from **#22928, #23024** to none



---

archive/issue_events_318673.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-08T09:41:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318673"
}
```



---

archive/issue_events_318674.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-08T09:41:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "milestone_number": null,
    "milestone_title": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318674"
}
```



---

archive/issue_comments_345194.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nYou create a lot of warnings with the macros. This should be fixed.\n\n```\ngmpy2-2.1.0a4.p1]     src/gmpy2_cache.c: In function 'GMPy_MPZ_NewInit':\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:44:60: warning: suggest parentheses around '&&' within '||' [-Wparentheses]\n[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPZ_CONVERSION(x) HAS_MPZ_CONVERSION(x) && \\\n[gmpy2-2.1.0a4.p1]                                                                 ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:52:25: note: in expansion of macro 'HAS_STRICT_MPZ_CONVERSION'\n[gmpy2-2.1.0a4.p1]                              HAS_STRICT_MPZ_CONVERSION(x))\n[gmpy2-2.1.0a4.p1]                              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:61:25: note: in expansion of macro 'IS_INTEGER'\n[gmpy2-2.1.0a4.p1]      #define IS_RATIONAL(x) (IS_INTEGER(x) || IS_RATIONAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:21: note: in expansion of macro 'IS_RATIONAL'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                          ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'\n[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {\n[gmpy2-2.1.0a4.p1]              ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:46:62: warning: suggest parentheses around '&&' within '||' [-Wparentheses]\n[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPFR_CONVERSION(x) HAS_MPFR_CONVERSION(x) && \\\n[gmpy2-2.1.0a4.p1]                                                                   ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:63:63: note: in expansion of macro 'HAS_STRICT_MPFR_CONVERSION'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL_ONLY(x) (MPFR_Check(x) || PyFloat_Check(x) || HAS_STRICT_MPFR_CONVERSION(x))\n[gmpy2-2.1.0a4.p1]                                                                    ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:39: note: in expansion of macro 'IS_REAL_ONLY'\n[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))\n[gmpy2-2.1.0a4.p1]                                            ^\n[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'\n[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {\n[gmpy2-2.1.0a4.p1]              ^\n```",
    "created_at": "2019-03-08T18:46:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345194",
    "user": "https://github.com/videlec"
}
```

<div id="comment:21" align="right">comment:21</div>

You create a lot of warnings with the macros. This should be fixed.

```
gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c: In function 'GMPy_MPZ_NewInit':
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:44:60: warning: suggest parentheses around '&&' within '||' [-Wparentheses]
[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPZ_CONVERSION(x) HAS_MPZ_CONVERSION(x) && \
[gmpy2-2.1.0a4.p1]                                                                 ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:52:25: note: in expansion of macro 'HAS_STRICT_MPZ_CONVERSION'
[gmpy2-2.1.0a4.p1]                              HAS_STRICT_MPZ_CONVERSION(x))
[gmpy2-2.1.0a4.p1]                              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:61:25: note: in expansion of macro 'IS_INTEGER'
[gmpy2-2.1.0a4.p1]      #define IS_RATIONAL(x) (IS_INTEGER(x) || IS_RATIONAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:21: note: in expansion of macro 'IS_RATIONAL'
[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                          ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'
[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {
[gmpy2-2.1.0a4.p1]              ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:46:62: warning: suggest parentheses around '&&' within '||' [-Wparentheses]
[gmpy2-2.1.0a4.p1]      #define HAS_STRICT_MPFR_CONVERSION(x) HAS_MPFR_CONVERSION(x) && \
[gmpy2-2.1.0a4.p1]                                                                   ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:63:63: note: in expansion of macro 'HAS_STRICT_MPFR_CONVERSION'
[gmpy2-2.1.0a4.p1]      #define IS_REAL_ONLY(x) (MPFR_Check(x) || PyFloat_Check(x) || HAS_STRICT_MPFR_CONVERSION(x))
[gmpy2-2.1.0a4.p1]                                                                    ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_convert.h:64:39: note: in expansion of macro 'IS_REAL_ONLY'
[gmpy2-2.1.0a4.p1]      #define IS_REAL(x) (IS_RATIONAL(x) || IS_REAL_ONLY(x))
[gmpy2-2.1.0a4.p1]                                            ^
[gmpy2-2.1.0a4.p1]     src/gmpy2_cache.c:191:9: note: in expansion of macro 'IS_REAL'
[gmpy2-2.1.0a4.p1]          if (IS_REAL(n)) {
[gmpy2-2.1.0a4.p1]              ^
```



---

archive/issue_events_318675.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-08T18:46:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318675"
}
```



---

archive/issue_events_318676.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-08T18:46:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318676"
}
```



---

archive/issue_comments_345195.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643\"><code>b60be6d</code></a></td><td><code>Trac #23052: Fix thousands lines of warnings.</code></td></tr></table>\n",
    "created_at": "2019-03-11T08:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345195",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643"><code>b60be6d</code></a></td><td><code>Trac #23052: Fix thousands lines of warnings.</code></td></tr></table>




---

archive/issue_comments_345196.json:
```json
{
    "body": "Changed commit from **[`edfe875`](https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5)** to **[`b60be6d`](https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643)**",
    "created_at": "2019-03-11T08:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345196",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`edfe875`](https://github.com/sagemath/sagetrac-mirror/commit/edfe875c099ab48145b976de2dcc2d70fff0f1b5)** to **[`b60be6d`](https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643)**



---

archive/issue_comments_345197.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nWarnings fixed.",
    "created_at": "2019-03-11T08:35:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345197",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:23" align="right">comment:23</div>

Warnings fixed.



---

archive/issue_events_318677.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-11T08:35:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318677"
}
```



---

archive/issue_events_318678.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-11T08:35:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318678"
}
```



---

archive/issue_comments_345198.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nsome failures...\n\n```\nDoctesting 3797 files using 14 threads.\nsage -t --long src/sage/arith/misc.py\n**********************************************************************\nFile \"src/sage/arith/misc.py\", line 3120, in sage.arith.misc.crt\nFailed example:\n    crt(mpz(2), mpz(3), mpz(7), mpz(11))\nExpected:\n    58\nGot:\n    mpz(58)\n**********************************************************************\nFile \"src/sage/arith/misc.py\", line 3122, in sage.arith.misc.crt\nFailed example:\n    crt(mpz(2), 3, mpz(7), numpy.int8(11))\nExpected:\n    58\nGot:\n    mpz(58)\n**********************************************************************\n1 item had failures:\n   2 of  37 in sage.arith.misc.crt\n    [1056 tests, 2 failures, 30.02 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/arith/misc.py  # 2 doctests failed\n----------------------------------------------------------------------\n```",
    "created_at": "2019-03-11T15:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345198",
    "user": "https://github.com/videlec"
}
```

<div id="comment:24" align="right">comment:24</div>

some failures...

```
Doctesting 3797 files using 14 threads.
sage -t --long src/sage/arith/misc.py
**********************************************************************
File "src/sage/arith/misc.py", line 3120, in sage.arith.misc.crt
Failed example:
    crt(mpz(2), mpz(3), mpz(7), mpz(11))
Expected:
    58
Got:
    mpz(58)
**********************************************************************
File "src/sage/arith/misc.py", line 3122, in sage.arith.misc.crt
Failed example:
    crt(mpz(2), 3, mpz(7), numpy.int8(11))
Expected:
    58
Got:
    mpz(58)
**********************************************************************
1 item had failures:
   2 of  37 in sage.arith.misc.crt
    [1056 tests, 2 failures, 30.02 s]
----------------------------------------------------------------------
sage -t --long src/sage/arith/misc.py  # 2 doctests failed
----------------------------------------------------------------------
```



---

archive/issue_events_318679.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-11T15:18:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318679"
}
```



---

archive/issue_events_318680.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-11T15:18:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318680"
}
```



---

archive/issue_comments_345199.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4\"><code>5dff83b</code></a></td><td><code>Trac #23052: arith.misc.crt ensure this function</code></td></tr></table>\n",
    "created_at": "2019-03-11T17:30:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345199",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4"><code>5dff83b</code></a></td><td><code>Trac #23052: arith.misc.crt ensure this function</code></td></tr></table>




---

archive/issue_comments_345200.json:
```json
{
    "body": "Changed commit from **[`b60be6d`](https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643)** to **[`5dff83b`](https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4)**",
    "created_at": "2019-03-11T17:30:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345200",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b60be6d`](https://github.com/sagemath/sagetrac-mirror/commit/b60be6d6e89e491cf5e9edc8bf30964b75921643)** to **[`5dff83b`](https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4)**



---

archive/issue_comments_345201.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nfunction `sage.arith.misc.crt` fixed",
    "created_at": "2019-03-11T17:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345201",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:26" align="right">comment:26</div>

function `sage.arith.misc.crt` fixed



---

archive/issue_events_318681.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-11T17:32:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318681"
}
```



---

archive/issue_events_318682.json:
```json
{
    "actor": "https://github.com/vinklein",
    "created_at": "2019-03-11T17:32:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318682"
}
```



---

archive/issue_comments_345202.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThe patch that you called `PR217.patch` comes from two pull requests ([#217](https://github.com/aleaxit/gmpy/pull/217) and [#218](https://github.com/aleaxit/gmpy/pull/218)). You would better change the name of the patch and mention very explicitely in the header of the patch the urls of the actual pull requests.",
    "created_at": "2019-03-11T19:00:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345202",
    "user": "https://github.com/videlec"
}
```

<div id="comment:27" align="right">comment:27</div>

The patch that you called `PR217.patch` comes from two pull requests ([#217](https://github.com/aleaxit/gmpy/pull/217) and [#218](https://github.com/aleaxit/gmpy/pull/218)). You would better change the name of the patch and mention very explicitely in the header of the patch the urls of the actual pull requests.



---

archive/issue_comments_345203.json:
```json
{
    "body": "Changed commit from **[`5dff83b`](https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4)** to **[`b7fbb9a`](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**",
    "created_at": "2019-03-12T07:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345203",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5dff83b`](https://github.com/sagemath/sagetrac-mirror/commit/5dff83b8730264b6d41edb177dfc5b47b5ea1be4)** to **[`b7fbb9a`](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**



---

archive/issue_comments_345204.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c\"><code>b7fbb9a</code></a></td><td><code>Trac #23052: Rename patch and add links to the...</code></td></tr></table>\n",
    "created_at": "2019-03-12T07:31:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345204",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c"><code>b7fbb9a</code></a></td><td><code>Trac #23052: Rename patch and add links to the...</code></td></tr></table>




---

archive/issue_comments_345205.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nPatch renamed and links added.",
    "created_at": "2019-03-12T07:32:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345205",
    "user": "https://github.com/vinklein"
}
```

<div id="comment:29" align="right">comment:29</div>

Patch renamed and links added.



---

archive/issue_comments_345206.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2019-03-12T08:47:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345206",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_318683.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-12T08:47:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318683"
}
```



---

archive/issue_events_318684.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-03-12T08:47:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318684"
}
```



---

archive/issue_events_318685.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-03-14T18:13:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318685"
}
```



---

archive/issue_events_318686.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ae38e0e0c81ce4f1491fb98ffd7643f067a4a918",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2019-03-14T18:13:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23052#event-318686"
}
```



---

archive/issue_comments_345207.json:
```json
{
    "body": "Changed branch from **[u/vklein/23052](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/23052)** to **[`b7fbb9a`](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**",
    "created_at": "2019-03-14T18:13:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23052",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23052#issuecomment-345207",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vklein/23052](https://github.com/sagemath/sagetrac-mirror/tree/u/vklein/23052)** to **[`b7fbb9a`](https://github.com/sagemath/sagetrac-mirror/commit/b7fbb9a4dac5d6882f6b83a57447dd79ecafb84c)**
