# Issue 23395: Use singular for quo_rem  of multivariate polynomial over the integers

archive/issues_023158.json:
```json
{
    "body": "Currently the quo_rem method of multipolynomial_libsingular only relies on Singular if the base ring is a field.\n\nFor the case of integers, it falls back to a very slow python implementation. However, Singular can handle that case too.\n\nCC:  @videlec @rwst\n\nBranch/Commit: [e1b5b52677d328a9bec0f664acb60216cf00f0b0](https://github.com/sagemath/sagetrac-mirror/commit/e1b5b52677d328a9bec0f664acb60216cf00f0b0)\n\nReviewer: Jean-Pierre Flori\n\nAuthor: Miguel Marco\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23395\n\n",
    "closed_at": "2017-08-29T19:51:01Z",
    "created_at": "2017-07-10T11:50:51Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Use singular for quo_rem  of multivariate polynomial over the integers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23395",
    "user": "https://github.com/miguelmarco"
}
```
Currently the quo_rem method of multipolynomial_libsingular only relies on Singular if the base ring is a field.

For the case of integers, it falls back to a very slow python implementation. However, Singular can handle that case too.

CC:  @videlec @rwst

Branch/Commit: [e1b5b52677d328a9bec0f664acb60216cf00f0b0](https://github.com/sagemath/sagetrac-mirror/commit/e1b5b52677d328a9bec0f664acb60216cf00f0b0)

Reviewer: Jean-Pierre Flori

Author: Miguel Marco

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23395





---

archive/issue_comments_442062.json:
```json
{
    "body": "Branch: [u/mmarco/use_singular_for_quo_rem__of_multivariate_polynomial_over_the_integers](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/use_singular_for_quo_rem__of_multivariate_polynomial_over_the_integers)",
    "created_at": "2017-07-10T12:01:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442062",
    "user": "https://github.com/miguelmarco"
}
```

Branch: [u/mmarco/use_singular_for_quo_rem__of_multivariate_polynomial_over_the_integers](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/use_singular_for_quo_rem__of_multivariate_polynomial_over_the_integers)



---

archive/issue_comments_442063.json:
```json
{
    "body": "Commit: [c522ced2719d9e701a85825f0662e73a1185145a](https://github.com/sagemath/sagetrac-mirror/commit/c522ced2719d9e701a85825f0662e73a1185145a)",
    "created_at": "2017-07-10T16:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442063",
    "user": "https://github.com/fchapoton"
}
```

Commit: [c522ced2719d9e701a85825f0662e73a1185145a](https://github.com/sagemath/sagetrac-mirror/commit/c522ced2719d9e701a85825f0662e73a1185145a)



---

archive/issue_comments_442064.json:
```json
{
    "body": "<a id='comment:2'></a>\nforgot to push ?",
    "created_at": "2017-07-10T16:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442064",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:2'></a>
forgot to push ?



---

archive/issue_comments_442065.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[e1b5b52](https://github.com/sagemath/sagetrac-mirror/commit/e1b5b52677d328a9bec0f664acb60216cf00f0b0)|`Don't fallback to slow implementation for polynomials over ZZ`|",
    "created_at": "2017-07-10T17:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442065",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[e1b5b52](https://github.com/sagemath/sagetrac-mirror/commit/e1b5b52677d328a9bec0f664acb60216cf00f0b0)|`Don't fallback to slow implementation for polynomials over ZZ`|



---

archive/issue_comments_442066.json:
```json
{
    "body": "Changing commit from \"[c522ced2719d9e701a85825f0662e73a1185145a](https://github.com/sagemath/sagetrac-mirror/commit/c522ced2719d9e701a85825f0662e73a1185145a)\" to \"[e1b5b52677d328a9bec0f664acb60216cf00f0b0](https://github.com/sagemath/sagetrac-mirror/commit/e1b5b52677d328a9bec0f664acb60216cf00f0b0)\"",
    "created_at": "2017-07-10T17:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442066",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[c522ced2719d9e701a85825f0662e73a1185145a](https://github.com/sagemath/sagetrac-mirror/commit/c522ced2719d9e701a85825f0662e73a1185145a)" to "[e1b5b52677d328a9bec0f664acb60216cf00f0b0](https://github.com/sagemath/sagetrac-mirror/commit/e1b5b52677d328a9bec0f664acb60216cf00f0b0)"



---

archive/issue_comments_442067.json:
```json
{
    "body": "<a id='comment:4'></a>\nActually i forgot to commit ;)",
    "created_at": "2017-07-10T17:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442067",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:4'></a>
Actually i forgot to commit ;)



---

archive/issue_comments_442068.json:
```json
{
    "body": "<a id='comment:5'></a>\nis this needs review ? patchbot is green.",
    "created_at": "2017-07-11T06:14:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442068",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
is this needs review ? patchbot is green.



---

archive/issue_comments_442069.json:
```json
{
    "body": "<a id='comment:6'></a>\nI guess so.",
    "created_at": "2017-07-11T08:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442069",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:6'></a>
I guess so.



---

archive/issue_comments_442070.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-11T08:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442070",
    "user": "https://github.com/miguelmarco"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_442071.json:
```json
{
    "body": "<a id='comment:7'></a>\nMaybe you can provide some timings (before / after) ?",
    "created_at": "2017-07-11T08:24:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442071",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:7'></a>
Maybe you can provide some timings (before / after) ?



---

archive/issue_comments_442072.json:
```json
{
    "body": "<a id='comment:8'></a>\nWith simple cases the differences are not significant. But when we go to slightly larger cases, we have a huge improvement.\n\nWith an example taken from [1].\n\nBefore:\n\n```\nsage: R.<x,y,z,t,u> = PolynomialRing(ZZ)\nsage: f = (1 + x + y + 2*z^2 + 3*t^3 + 5*u^5)^5\nsage: g = (1 + u + t + 2*z^2 + 3*y^3 + 5*x^5)^5\nsage: p = f*g\nsage: %time _ = p.quo_rem(f)\nCPU times: user 5.69 s, sys: 5 ms, total: 5.69 s\nWall time: 5.71 s\n```\n\nAfter:\n\n```\nsage: R.<x,y,z,t,u> = PolynomialRing(ZZ)\nsage: f = (1 + x + y + 2*z^2 + 3*t^3 + 5*u^5)^5\nsage: g = (1 + u + t + 2*z^2 + 3*y^3 + 5*x^5)^5\nsage: p = f*g\nsage: %time _ = p.quo_rem(f)\nCPU times: user 79 ms, sys: 0 ns, total: 79 ms\nWall time: 79.3 ms\n```\n\nIf we raise the exponent of f and g to 6, according to [1] the previous implementation goes to more than 100 seconds. The singular one gets about half a second.\n\n\n\n[https://wbhart.blogspot.com.es/2017/07/update-on-fast-multivariate-polynomial.html](https://wbhart.blogspot.com.es/2017/07/update-on-fast-multivariate-polynomial.html)",
    "created_at": "2017-07-11T08:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442072",
    "user": "https://github.com/miguelmarco"
}
```

<a id='comment:8'></a>
With simple cases the differences are not significant. But when we go to slightly larger cases, we have a huge improvement.

With an example taken from [1].

Before:

```
sage: R.<x,y,z,t,u> = PolynomialRing(ZZ)
sage: f = (1 + x + y + 2*z^2 + 3*t^3 + 5*u^5)^5
sage: g = (1 + u + t + 2*z^2 + 3*y^3 + 5*x^5)^5
sage: p = f*g
sage: %time _ = p.quo_rem(f)
CPU times: user 5.69 s, sys: 5 ms, total: 5.69 s
Wall time: 5.71 s
```

After:

```
sage: R.<x,y,z,t,u> = PolynomialRing(ZZ)
sage: f = (1 + x + y + 2*z^2 + 3*t^3 + 5*u^5)^5
sage: g = (1 + u + t + 2*z^2 + 3*y^3 + 5*x^5)^5
sage: p = f*g
sage: %time _ = p.quo_rem(f)
CPU times: user 79 ms, sys: 0 ns, total: 79 ms
Wall time: 79.3 ms
```

If we raise the exponent of f and g to 6, according to [1] the previous implementation goes to more than 100 seconds. The singular one gets about half a second.



[https://wbhart.blogspot.com.es/2017/07/update-on-fast-multivariate-polynomial.html](https://wbhart.blogspot.com.es/2017/07/update-on-fast-multivariate-polynomial.html)



---

archive/issue_comments_442073.json:
```json
{
    "body": "<a id='comment:10'></a>\nWouldn't make sense to have an `algorithm` option?",
    "created_at": "2017-07-14T13:57:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442073",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>
Wouldn't make sense to have an `algorithm` option?



---

archive/issue_comments_442074.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [vdelecroix](#comment%3A10):\n> Wouldn't make sense to have an `algorithm` option?\n\n\nYes, perhaps soon `algorithm=\"FLINT\"` might become an option!",
    "created_at": "2017-08-22T22:20:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442074",
    "user": "https://github.com/kedlaya"
}
```

<a id='comment:11'></a>
Replying to [vdelecroix](#comment%3A10):
> Wouldn't make sense to have an `algorithm` option?


Yes, perhaps soon `algorithm="FLINT"` might become an option!



---

archive/issue_comments_442075.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-23T23:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442075",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_442076.json:
```json
{
    "body": "Reviewer: Jean-Pierre Flori",
    "created_at": "2017-08-23T23:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442076",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Reviewer: Jean-Pierre Flori



---

archive/issue_comments_442077.json:
```json
{
    "body": "<a id='comment:12'></a>\nI guess we would like to have a completely new class for multivariate polynomials using flint, not just using the division from flint.\nSo let's get this in already.",
    "created_at": "2017-08-23T23:03:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442077",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

<a id='comment:12'></a>
I guess we would like to have a completely new class for multivariate polynomials using flint, not just using the division from flint.
So let's get this in already.



---

archive/issue_events_068405.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-29T19:51:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23395#event-68405"
}
```



---

archive/issue_comments_442078.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-29T19:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442078",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_442079.json:
```json
{
    "body": "Changing branch from \"[u/mmarco/use_singular_for_quo_rem__of_multivariate_polynomial_over_the_integers](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/use_singular_for_quo_rem__of_multivariate_polynomial_over_the_integers)\" to \"[e1b5b52677d328a9bec0f664acb60216cf00f0b0](https://github.com/sagemath/sagetrac-mirror/commit/e1b5b52677d328a9bec0f664acb60216cf00f0b0)\"",
    "created_at": "2017-08-29T19:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23395#issuecomment-442079",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/mmarco/use_singular_for_quo_rem__of_multivariate_polynomial_over_the_integers](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/use_singular_for_quo_rem__of_multivariate_polynomial_over_the_integers)" to "[e1b5b52677d328a9bec0f664acb60216cf00f0b0](https://github.com/sagemath/sagetrac-mirror/commit/e1b5b52677d328a9bec0f664acb60216cf00f0b0)"
