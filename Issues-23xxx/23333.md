# Issue 23333: Improve calculation of sigma invariants for projective morphisms

archive/issues_023096.json:
```json
{
    "assignees": [],
    "body": "The sigma invariants are the elementary symmetric functions evaluated at the multipliers. Currently they are computed over QQbar which can be very time consuming. They can be computed via resultants which is much faster and includes maps defined over polynomial rings.\n\nCC:  gjorgenson\n\nBranch/Commit: **[6709c77](https://github.com/sagemath/sagetrac-mirror/commit/6709c7746c3236518ca25b04178a9f2f55abd64e)**\n\nReviewer: **Grayson Jorgenson**\n\nAuthor: **Ben Hutz**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23333_\n\n",
    "closed_at": "2017-08-03T22:11:24Z",
    "created_at": "2017-06-28T15:06:38Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20dynamics",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improve calculation of sigma invariants for projective morphisms",
    "type": "issue",
    "updated_at": "2017-08-03T22:11:24Z",
    "url": "https://github.com/sagemath/sage/issues/23333",
    "user": "https://github.com/bhutz"
}
```
The sigma invariants are the elementary symmetric functions evaluated at the multipliers. Currently they are computed over QQbar which can be very time consuming. They can be computed via resultants which is much faster and includes maps defined over polynomial rings.

CC:  gjorgenson

Branch/Commit: **[6709c77](https://github.com/sagemath/sagetrac-mirror/commit/6709c7746c3236518ca25b04178a9f2f55abd64e)**

Reviewer: **Grayson Jorgenson**

Author: **Ben Hutz**

_Issue created by migration from https://trac.sagemath.org/ticket/23333_





---

archive/issue_events_306854.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T15:06:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306854"
}
```



---

archive/issue_events_306855.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T15:06:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "component: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306855"
}
```



---

archive/issue_events_306856.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T15:06:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306856"
}
```



---

archive/issue_events_306857.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T15:06:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306857"
}
```



---

archive/issue_comments_352864.json:
```json
{
    "body": "Commit: **[66160eb](https://github.com/sagemath/sagetrac-mirror/commit/66160ebb2a2bec65c0fc85f5dfd82f01cdf7401b)**",
    "created_at": "2017-06-28T15:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352864",
    "user": "https://github.com/bhutz"
}
```

Commit: **[66160eb](https://github.com/sagemath/sagetrac-mirror/commit/66160ebb2a2bec65c0fc85f5dfd82f01cdf7401b)**



---

archive/issue_comments_352865.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66160ebb2a2bec65c0fc85f5dfd82f01cdf7401b\">66160eb</a></td><td><code>23333: improve sigma invariant for projective morphism</code></td></tr></table>\n",
    "created_at": "2017-06-28T15:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352865",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:1'>Comment 1:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66160ebb2a2bec65c0fc85f5dfd82f01cdf7401b">66160eb</a></td><td><code>23333: improve sigma invariant for projective morphism</code></td></tr></table>




---

archive/issue_comments_352866.json:
```json
{
    "body": "Author: **Ben Hutz**",
    "created_at": "2017-06-28T15:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352866",
    "user": "https://github.com/bhutz"
}
```

Author: **Ben Hutz**



---

archive/issue_comments_352867.json:
```json
{
    "body": "Branch: **[u/bhutz/sigma_inv](https://github.com/sagemath/sagetrac-mirror/tree/u/bhutz/sigma_inv)**",
    "created_at": "2017-06-28T15:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352867",
    "user": "https://github.com/bhutz"
}
```

Branch: **[u/bhutz/sigma_inv](https://github.com/sagemath/sagetrac-mirror/tree/u/bhutz/sigma_inv)**



---

archive/issue_comments_352868.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nThis is ready for a review.",
    "created_at": "2017-06-28T19:34:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352868",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:2'>Comment 2:</a>
This is ready for a review.



---

archive/issue_events_306858.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T19:34:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306858"
}
```



---

archive/issue_events_306859.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T19:43:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306859"
}
```



---

archive/issue_events_306860.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T19:43:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306860"
}
```



---

archive/issue_comments_352869.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nerr. I think the definition here is not right. There should be one multiplier per periodic point (with multiplicity), not one per cycle?",
    "created_at": "2017-06-28T19:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352869",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:3'>Comment 3:</a>
err. I think the definition here is not right. There should be one multiplier per periodic point (with multiplicity), not one per cycle?



---

archive/issue_comments_352870.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nwell, it seems both definitions are used in the world.\n\n- define the sigma using every period n point (McMullen, Silverman). Really they define it from the fixed points of the nth iterate.\n\n- define the sigma via cycles (Milnor)\n\nIn both cases they define invariants of the moduli space, so it's not that one is right or wrong, they are just different.  I'm tempted to introduce a 'type' parameter that takes values 'cycles' or 'points' to both this function and multiplier_spectrum.\n\n\nWhat do you think?",
    "created_at": "2017-06-28T20:10:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352870",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:4'>Comment 4:</a>
well, it seems both definitions are used in the world.

- define the sigma using every period n point (McMullen, Silverman). Really they define it from the fixed points of the nth iterate.

- define the sigma via cycles (Milnor)

In both cases they define invariants of the moduli space, so it's not that one is right or wrong, they are just different.  I'm tempted to introduce a 'type' parameter that takes values 'cycles' or 'points' to both this function and multiplier_spectrum.


What do you think?



---

archive/issue_comments_352871.json:
```json
{
    "body": "Changed commit from **[66160eb](https://github.com/sagemath/sagetrac-mirror/commit/66160ebb2a2bec65c0fc85f5dfd82f01cdf7401b)** to **[225bfdd](https://github.com/sagemath/sagetrac-mirror/commit/225bfdd18033d3bd57b8ea1107d1f8696e5f6202)**",
    "created_at": "2017-06-28T21:29:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352871",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[66160eb](https://github.com/sagemath/sagetrac-mirror/commit/66160ebb2a2bec65c0fc85f5dfd82f01cdf7401b)** to **[225bfdd](https://github.com/sagemath/sagetrac-mirror/commit/225bfdd18033d3bd57b8ea1107d1f8696e5f6202)**



---

archive/issue_comments_352872.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/225bfdd18033d3bd57b8ea1107d1f8696e5f6202\">225bfdd</a></td><td><code>23333: add parameter for type</code></td></tr></table>\n",
    "created_at": "2017-06-28T21:29:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352872",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/225bfdd18033d3bd57b8ea1107d1f8696e5f6202">225bfdd</a></td><td><code>23333: add parameter for type</code></td></tr></table>




---

archive/issue_events_306861.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T21:30:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306861"
}
```



---

archive/issue_events_306862.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-06-28T21:30:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306862"
}
```



---

archive/issue_comments_352873.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nI implemented it with the 'type' switch since both version appear in the literature.",
    "created_at": "2017-06-28T21:30:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352873",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:6'>Comment 6:</a>
I implemented it with the 'type' switch since both version appear in the literature.



---

archive/issue_comments_352874.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nThat seems good to me also. I'll get started on reviewing the functionality.",
    "created_at": "2017-06-28T21:41:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352874",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:7'>Comment 7:</a>
That seems good to me also. I'll get started on reviewing the functionality.



---

archive/issue_comments_352875.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nOk I looked this over and did some testing. The new method of computing the sigma invariants appears to be correct (and much nicer than the previous implementation!), and everything seems to be working properly. I only found a few really minor issues:\n\nIn sigma_invariants:\n- line 3725, multiplicity is spelled incorrectly (also occurs line 3565 in multiplier_spectra)\n- line 3750, add another space around the hyphen (also occurs line 3579)\n- line 3780, there is an extra newline\n- need an input check in place to make sure the base ring is (or has its coefficients in) a number field\n- perhaps put the \"type\" input check on line 3897 that can raise a value error with the other input checks at the beginning (same comment for multiplier_spectra)\n- it also might be good to add an example with formal=True illustrating the different options type='cycle', 'point'",
    "created_at": "2017-07-03T06:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352875",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:8'>Comment 8:</a>
Ok I looked this over and did some testing. The new method of computing the sigma invariants appears to be correct (and much nicer than the previous implementation!), and everything seems to be working properly. I only found a few really minor issues:

In sigma_invariants:
- line 3725, multiplicity is spelled incorrectly (also occurs line 3565 in multiplier_spectra)
- line 3750, add another space around the hyphen (also occurs line 3579)
- line 3780, there is an extra newline
- need an input check in place to make sure the base ring is (or has its coefficients in) a number field
- perhaps put the "type" input check on line 3897 that can raise a value error with the other input checks at the beginning (same comment for multiplier_spectra)
- it also might be good to add an example with formal=True illustrating the different options type='cycle', 'point'



---

archive/issue_comments_352876.json:
```json
{
    "body": "Reviewer: **Grayson Jorgenson**",
    "created_at": "2017-07-03T06:55:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352876",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

Reviewer: **Grayson Jorgenson**



---

archive/issue_comments_352877.json:
```json
{
    "body": "Changed commit from **[225bfdd](https://github.com/sagemath/sagetrac-mirror/commit/225bfdd18033d3bd57b8ea1107d1f8696e5f6202)** to **[8467dc6](https://github.com/sagemath/sagetrac-mirror/commit/8467dc6b9a6ea4f7e0588369640d65fe70783144)**",
    "created_at": "2017-07-05T16:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352877",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[225bfdd](https://github.com/sagemath/sagetrac-mirror/commit/225bfdd18033d3bd57b8ea1107d1f8696e5f6202)** to **[8467dc6](https://github.com/sagemath/sagetrac-mirror/commit/8467dc6b9a6ea4f7e0588369640d65fe70783144)**



---

archive/issue_comments_352878.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8467dc6b9a6ea4f7e0588369640d65fe70783144\">8467dc6</a></td><td><code>23333: fixes from review</code></td></tr></table>\n",
    "created_at": "2017-07-05T16:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352878",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>Comment 9:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8467dc6b9a6ea4f7e0588369640d65fe70783144">8467dc6</a></td><td><code>23333: fixes from review</code></td></tr></table>




---

archive/issue_comments_352879.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI think I fixed all those, so you can take another look.",
    "created_at": "2017-07-05T16:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352879",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:10'>Comment 10:</a>
I think I fixed all those, so you can take another look.



---

archive/issue_comments_352880.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nThose changes look good. However I don't think the part of sigma_invariants that looks for a conjugation to avoid the point at infinity makes sense in positive characteristic:\n\n```\nsage: P.<x,y> = ProjectiveSpace(GF(3),1)\nsage: H = End(P)\nsage: f = H([x^2 - 2*y^2, y^2])\nsage: f.sigma_invariants(1)\nTraceback (click to the left of this block for traceback)\n...\nZeroDivisionError: Inverse does not exist.\n```\n\nWhen working over a finite field, if it is possible to construct a morphism P1-->P1 that has every point of P1 as a n-periodic point that seems like it could also be a problem.",
    "created_at": "2017-07-05T18:12:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352880",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:11'>Comment 11:</a>
Those changes look good. However I don't think the part of sigma_invariants that looks for a conjugation to avoid the point at infinity makes sense in positive characteristic:

```
sage: P.<x,y> = ProjectiveSpace(GF(3),1)
sage: H = End(P)
sage: f = H([x^2 - 2*y^2, y^2])
sage: f.sigma_invariants(1)
Traceback (click to the left of this block for traceback)
...
ZeroDivisionError: Inverse does not exist.
```

When working over a finite field, if it is possible to construct a morphism P1-->P1 that has every point of P1 as a n-periodic point that seems like it could also be a problem.



---

archive/issue_events_306863.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-05T18:19:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306863"
}
```



---

archive/issue_events_306864.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-05T18:19:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306864"
}
```



---

archive/issue_comments_352881.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nGood catch. I'll need to rethink how I deal with that case.",
    "created_at": "2017-07-05T18:19:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352881",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:12'>Comment 12:</a>
Good catch. I'll need to rethink how I deal with that case.



---

archive/issue_comments_352882.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f9f8aed9f07e99d230840304f55e612ee21cd883\">f9f8aed</a></td><td><code>23333: change how periodic infinity is dealt with</code></td></tr></table>\n",
    "created_at": "2017-07-06T00:21:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352882",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:13'>Comment 13:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f9f8aed9f07e99d230840304f55e612ee21cd883">f9f8aed</a></td><td><code>23333: change how periodic infinity is dealt with</code></td></tr></table>




---

archive/issue_comments_352883.json:
```json
{
    "body": "Changed commit from **[8467dc6](https://github.com/sagemath/sagetrac-mirror/commit/8467dc6b9a6ea4f7e0588369640d65fe70783144)** to **[f9f8aed](https://github.com/sagemath/sagetrac-mirror/commit/f9f8aed9f07e99d230840304f55e612ee21cd883)**",
    "created_at": "2017-07-06T00:21:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352883",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[8467dc6](https://github.com/sagemath/sagetrac-mirror/commit/8467dc6b9a6ea4f7e0588369640d65fe70783144)** to **[f9f8aed](https://github.com/sagemath/sagetrac-mirror/commit/f9f8aed9f07e99d230840304f55e612ee21cd883)**



---

archive/issue_events_306865.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-06T00:23:38Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306865"
}
```



---

archive/issue_events_306866.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-06T00:23:38Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306866"
}
```



---

archive/issue_comments_352884.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nok. Here's another try at this. I'm no longer trying to move infinity out of the fixed points and instead am dealing with the multiplier at infinity and its multiplicities as a special case.\n\nInterestingly, it looks like this exposed an issue with one of the earlier examples and also an issue when there are cycles of different periods with the same multiplier.",
    "created_at": "2017-07-06T00:23:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352884",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:14'>Comment 14:</a>
ok. Here's another try at this. I'm no longer trying to move infinity out of the fixed points and instead am dealing with the multiplier at infinity and its multiplicities as a special case.

Interestingly, it looks like this exposed an issue with one of the earlier examples and also an issue when there are cycles of different periods with the same multiplier.



---

archive/issue_events_306867.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-06T00:23:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306867"
}
```



---

archive/issue_events_306868.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-06T00:23:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306868"
}
```



---

archive/issue_comments_352885.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\non further thought, I think this still fails to do the right thing where there are cycles of different length with the same multipliers.",
    "created_at": "2017-07-06T13:02:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352885",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:15'>Comment 15:</a>
on further thought, I think this still fails to do the right thing where there are cycles of different length with the same multipliers.



---

archive/issue_events_306869.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-06T13:02:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306869"
}
```



---

archive/issue_events_306870.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-06T13:02:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306870"
}
```



---

archive/issue_comments_352886.json:
```json
{
    "body": "Changed commit from **[f9f8aed](https://github.com/sagemath/sagetrac-mirror/commit/f9f8aed9f07e99d230840304f55e612ee21cd883)** to **[35a1fec](https://github.com/sagemath/sagetrac-mirror/commit/35a1fec9aa138cabb6ddecd289e66254408fbe29)**",
    "created_at": "2017-07-06T18:12:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352886",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f9f8aed](https://github.com/sagemath/sagetrac-mirror/commit/f9f8aed9f07e99d230840304f55e612ee21cd883)** to **[35a1fec](https://github.com/sagemath/sagetrac-mirror/commit/35a1fec9aa138cabb6ddecd289e66254408fbe29)**



---

archive/issue_comments_352887.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35a1fec9aa138cabb6ddecd289e66254408fbe29\">35a1fec</a></td><td><code>23333: fix how cycle multipliers works</code></td></tr></table>\n",
    "created_at": "2017-07-06T18:12:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352887",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:16'>Comment 16:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35a1fec9aa138cabb6ddecd289e66254408fbe29">35a1fec</a></td><td><code>23333: fix how cycle multipliers works</code></td></tr></table>




---

archive/issue_events_306871.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-06T18:16:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306871"
}
```



---

archive/issue_events_306872.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-06T18:16:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306872"
}
```



---

archive/issue_comments_352888.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nI solved the cycle problem by building up the sigmas by divisor of n. Since the product of the dynatomic polys is the periodic point equation, this lets me assign a specific cycle length to each multiplier. Essentially it takes the formal period as the period. This has the advantage of being computable and always returns the same number of sigmas.",
    "created_at": "2017-07-06T18:16:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352888",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:17'>Comment 17:</a>
I solved the cycle problem by building up the sigmas by divisor of n. Since the product of the dynatomic polys is the periodic point equation, this lets me assign a specific cycle length to each multiplier. Essentially it takes the formal period as the period. This has the advantage of being computable and always returns the same number of sigmas.



---

archive/issue_events_306873.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2017-07-09T05:36:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306873"
}
```



---

archive/issue_events_306874.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2017-07-09T05:36:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306874"
}
```



---

archive/issue_comments_352889.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nThe new type='cycle' functionality looks good to me. While looking over the code I noticed just a few more superficial issues:\n\n- line 3754: add period after \"Default: False\"\n- line 3962: there's an extra newline\n- the expressions of the form\n\n```\ne_inf = 1\nwhile (y**e_inf).divides(fix_poly):\n    e_inf += 1\ne_inf -= 1\n```\n   could be shortened slightly to\n\n```\ne_inf = 0\nwhile (y**(e_inf + 1)).divides(fix_poly):\n    e_inf += 1\n```\n- change the code starting on line 3956 from\n\n```\nres = fix_poly.resultant(mult_poly, S.gen(0)).univariate_polynomial()\n#take infinty into consideration\nif inf_per.divides(n):\n   res = res*((S.gen(1) - self.multiplier(inf, n)[0,0])**e_inf)\n   res = res.univariate_polynomial()\n```\n   to\n\n```\nres = fix_poly.resultant(mult_poly, S.gen(0))\n#take infinty into consideration\nif inf_per.divides(n):\n   res = res*((S.gen(1) - self.multiplier(inf, n)[0,0])**e_inf)\nres = res.univariate_polynomial()\n```\n   otherwise there is a weird multiplication issue:\n\n```\nsage: P.<x,y> = ProjectiveSpace(QQ,1)\nsage: H = End(P)\nsage: f = H([x^2 + x*y + y^2, y^2 + x*y])\nsage: f.sigma_invariants(1)\n```\n   The same issue occurs in the formal=True block version of this code starting at 3925. It looks like this actually always occurs with multiplication with elements of the original polynomial ring after calling .univariate_polynomial() for a constant polynomial:\n\n```\nsage: R.<s,t> = PolynomialRing(QQ, 2)\nsage: f = R(1)\nsage: f.univariate_polynomial()*t\n```\n   fails, but\n\n```\nsage: R.<s,t> = PolynomialRing(QQ, 2)\nsage: f = s\nsage: f.univariate_polynomial()*t\n```\n   is fine.\n- the lines of the form `res = res*((S.gen(1) - self.multiplier(inf, n)[0,0])**e_inf)`\n   could be rewritten `res *= (S.gen(1) - self.multiplier(inf, n)[0,0])**e_inf`",
    "created_at": "2017-07-09T05:36:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352889",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:18'>Comment 18:</a>
The new type='cycle' functionality looks good to me. While looking over the code I noticed just a few more superficial issues:

- line 3754: add period after "Default: False"
- line 3962: there's an extra newline
- the expressions of the form

```
e_inf = 1
while (y**e_inf).divides(fix_poly):
    e_inf += 1
e_inf -= 1
```
   could be shortened slightly to

```
e_inf = 0
while (y**(e_inf + 1)).divides(fix_poly):
    e_inf += 1
```
- change the code starting on line 3956 from

```
res = fix_poly.resultant(mult_poly, S.gen(0)).univariate_polynomial()
#take infinty into consideration
if inf_per.divides(n):
   res = res*((S.gen(1) - self.multiplier(inf, n)[0,0])**e_inf)
   res = res.univariate_polynomial()
```
   to

```
res = fix_poly.resultant(mult_poly, S.gen(0))
#take infinty into consideration
if inf_per.divides(n):
   res = res*((S.gen(1) - self.multiplier(inf, n)[0,0])**e_inf)
res = res.univariate_polynomial()
```
   otherwise there is a weird multiplication issue:

```
sage: P.<x,y> = ProjectiveSpace(QQ,1)
sage: H = End(P)
sage: f = H([x^2 + x*y + y^2, y^2 + x*y])
sage: f.sigma_invariants(1)
```
   The same issue occurs in the formal=True block version of this code starting at 3925. It looks like this actually always occurs with multiplication with elements of the original polynomial ring after calling .univariate_polynomial() for a constant polynomial:

```
sage: R.<s,t> = PolynomialRing(QQ, 2)
sage: f = R(1)
sage: f.univariate_polynomial()*t
```
   fails, but

```
sage: R.<s,t> = PolynomialRing(QQ, 2)
sage: f = s
sage: f.univariate_polynomial()*t
```
   is fine.
- the lines of the form `res = res*((S.gen(1) - self.multiplier(inf, n)[0,0])**e_inf)`
   could be rewritten `res *= (S.gen(1) - self.multiplier(inf, n)[0,0])**e_inf`



---

archive/issue_comments_352890.json:
```json
{
    "body": "Changed commit from **[35a1fec](https://github.com/sagemath/sagetrac-mirror/commit/35a1fec9aa138cabb6ddecd289e66254408fbe29)** to **[6709c77](https://github.com/sagemath/sagetrac-mirror/commit/6709c7746c3236518ca25b04178a9f2f55abd64e)**",
    "created_at": "2017-07-09T15:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352890",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[35a1fec](https://github.com/sagemath/sagetrac-mirror/commit/35a1fec9aa138cabb6ddecd289e66254408fbe29)** to **[6709c77](https://github.com/sagemath/sagetrac-mirror/commit/6709c7746c3236518ca25b04178a9f2f55abd64e)**



---

archive/issue_comments_352891.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6709c7746c3236518ca25b04178a9f2f55abd64e\">6709c77</a></td><td><code>23333: minor code improvements</code></td></tr></table>\n",
    "created_at": "2017-07-09T15:35:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352891",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:19'>Comment 19:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6709c7746c3236518ca25b04178a9f2f55abd64e">6709c77</a></td><td><code>23333: minor code improvements</code></td></tr></table>




---

archive/issue_comments_352892.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nThanks. updated.\n\nThe issue with the univariate_polynomial of a constant is actually expected behavior. If you don't pass univeraite_polynomial a polynomial ring it creates it own. There is no reason it should be able to interact well with another polynomial ring. This is actually a little bit relevant to this ticket. In the new version I'm only calling univariate_polynomial once, so I don't rely anymore on Sage trying to 'do the right thing' in the background with multiplication of univariate and multivariate polynomial rings.",
    "created_at": "2017-07-09T15:41:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352892",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:20'>Comment 20:</a>
Thanks. updated.

The issue with the univariate_polynomial of a constant is actually expected behavior. If you don't pass univeraite_polynomial a polynomial ring it creates it own. There is no reason it should be able to interact well with another polynomial ring. This is actually a little bit relevant to this ticket. In the new version I'm only calling univariate_polynomial once, so I don't rely anymore on Sage trying to 'do the right thing' in the background with multiplication of univariate and multivariate polynomial rings.



---

archive/issue_events_306875.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-09T15:41:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306875"
}
```



---

archive/issue_events_306876.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-09T15:41:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306876"
}
```



---

archive/issue_events_306877.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2017-07-09T18:53:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306877"
}
```



---

archive/issue_events_306878.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2017-07-09T18:53:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306878"
}
```



---

archive/issue_comments_352893.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nOk that makes sense. With these new changes everything looks good to me.",
    "created_at": "2017-07-09T18:53:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352893",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:21'>Comment 21:</a>
Ok that makes sense. With these new changes everything looks good to me.



---

archive/issue_events_306879.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-21T19:37:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "component: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306879"
}
```



---

archive/issue_events_306880.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2017-07-21T19:37:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20dynamics",
    "label_color": "0000ff",
    "label_name": "component: dynamics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306880"
}
```



---

archive/issue_events_306881.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-08-03T22:11:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306881"
}
```



---

archive/issue_events_306882.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a7b1b35924e0825d2f0c015223757b354cb4880f",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-08-03T22:11:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23333#event-306882"
}
```



---

archive/issue_comments_352894.json:
```json
{
    "body": "Changed branch from **[u/bhutz/sigma_inv](https://github.com/sagemath/sagetrac-mirror/tree/u/bhutz/sigma_inv)** to **[6709c77](https://github.com/sagemath/sagetrac-mirror/commit/6709c7746c3236518ca25b04178a9f2f55abd64e)**",
    "created_at": "2017-08-03T22:11:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23333",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23333#issuecomment-352894",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/bhutz/sigma_inv](https://github.com/sagemath/sagetrac-mirror/tree/u/bhutz/sigma_inv)** to **[6709c77](https://github.com/sagemath/sagetrac-mirror/commit/6709c7746c3236518ca25b04178a9f2f55abd64e)**
