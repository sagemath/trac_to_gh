# Issue 23229: Cache fraction_field() of p-adic rings, deprecate print_mode options

archive/issues_022992.json:
```json
{
    "body": "Note that `creduce` calls this a lot since it computes `inverse_of_unit` in the fraction field.\n\nIn a two-step extension, introduced in #23218, this is probably most significant:\n\n```\nsage: w=W.gen()\nsage: %timeit u=-w\n1000 loops, best of 3: 774 \u00b5s per loop # without caching\n10000 loops, best of 3: 77.9 \u00b5s per loop # with caching\n```\n\nIn order to get better speed, this ticket also deprecates the `print_mode` dictionary that can passed into `fraction_field`, since this functionality is now available with `change`.\n\nCC:  @roed314\n\nBranch/Commit: [edf180196caab83f360921401e559bd2041698b6](https://github.com/sagemath/sagetrac-mirror/commit/edf180196caab83f360921401e559bd2041698b6)\n\nReviewer: David Roe\n\nAuthor: Julian R\u00fcth, David Roe\n\nDependencies: #23510\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23229\n\n",
    "closed_at": "2018-03-06T23:23:57Z",
    "created_at": "2017-06-13T09:25:17Z",
    "labels": [
        "component: padics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Cache fraction_field() of p-adic rings, deprecate print_mode options",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23229",
    "user": "https://github.com/saraedum"
}
```
Note that `creduce` calls this a lot since it computes `inverse_of_unit` in the fraction field.

In a two-step extension, introduced in #23218, this is probably most significant:

```
sage: w=W.gen()
sage: %timeit u=-w
1000 loops, best of 3: 774 µs per loop # without caching
10000 loops, best of 3: 77.9 µs per loop # with caching
```

In order to get better speed, this ticket also deprecates the `print_mode` dictionary that can passed into `fraction_field`, since this functionality is now available with `change`.

CC:  @roed314

Branch/Commit: [edf180196caab83f360921401e559bd2041698b6](https://github.com/sagemath/sagetrac-mirror/commit/edf180196caab83f360921401e559bd2041698b6)

Reviewer: David Roe

Author: Julian Rüth, David Roe

Dependencies: #23510

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23229





---

archive/issue_comments_438963.json:
```json
{
    "body": "Changing branch from \"\" to \"u/saraedum/cache_fraction_field___of_p_adic_extension_rings\"",
    "created_at": "2017-06-13T09:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438963",
    "user": "https://github.com/saraedum"
}
```

Changing branch from "" to "u/saraedum/cache_fraction_field___of_p_adic_extension_rings"



---

archive/issue_comments_438964.json:
```json
{
    "body": "Changing commit from \"\" to \"3b232613682491a3403e3a8f8eeabda8cd0374a5\"",
    "created_at": "2017-06-13T09:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438964",
    "user": "https://github.com/saraedum"
}
```

Changing commit from "" to "3b232613682491a3403e3a8f8eeabda8cd0374a5"



---

archive/issue_comments_438965.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------|\n|[3b23261](https://github.com/sagemath/sagetrac-mirror/commit/3b232613682491a3403e3a8f8eeabda8cd0374a5)|`Cache fraction_field()`|",
    "created_at": "2017-06-13T09:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438965",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                        |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------|
|[3b23261](https://github.com/sagemath/sagetrac-mirror/commit/3b232613682491a3403e3a8f8eeabda8cd0374a5)|`Cache fraction_field()`|



---

archive/issue_comments_438966.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-13T09:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438966",
    "user": "https://github.com/saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_438967.json:
```json
{
    "body": "<a id='comment:3'></a>\nLooks good.  The doctest failures are due to a missing x-server on Julian's patchbot.",
    "created_at": "2017-07-23T04:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438967",
    "user": "https://github.com/roed314"
}
```

<a id='comment:3'></a>
Looks good.  The doctest failures are due to a missing x-server on Julian's patchbot.



---

archive/issue_comments_438968.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-23T04:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438968",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_438969.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Roe\"",
    "created_at": "2017-07-23T04:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438969",
    "user": "https://github.com/roed314"
}
```

Changing reviewer from "" to "David Roe"



---

archive/issue_comments_438970.json:
```json
{
    "body": "<a id='comment:4'></a>\nNo, test failures are real...",
    "created_at": "2017-08-02T18:22:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438970",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>
No, test failures are real...



---

archive/issue_comments_438971.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-08-02T18:22:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438971",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_438972.json:
```json
{
    "body": "Changing branch from \"u/saraedum/cache_fraction_field___of_p_adic_extension_rings\" to \"u/roed/cache_fraction_field___of_p_adic_extension_rings\"",
    "created_at": "2017-08-04T03:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438972",
    "user": "https://github.com/roed314"
}
```

Changing branch from "u/saraedum/cache_fraction_field___of_p_adic_extension_rings" to "u/roed/cache_fraction_field___of_p_adic_extension_rings"



---

archive/issue_comments_438973.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                          |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[883e6b5](https://github.com/sagemath/sagetrac-mirror/commit/883e6b5fe81e5c2741ef8fb3521039ac6470fd0b)|`Fix doctest in local_generic_element.pyx`|\n|[99bdc60](https://github.com/sagemath/sagetrac-mirror/commit/99bdc604d9c200134d8e9014d12b9f82fa635389)|`Merge branch 't/23510/fixed_mod_frac_field' into t/23229/cache_fraction_field`|",
    "created_at": "2017-08-04T03:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438973",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                          |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[883e6b5](https://github.com/sagemath/sagetrac-mirror/commit/883e6b5fe81e5c2741ef8fb3521039ac6470fd0b)|`Fix doctest in local_generic_element.pyx`|
|[99bdc60](https://github.com/sagemath/sagetrac-mirror/commit/99bdc604d9c200134d8e9014d12b9f82fa635389)|`Merge branch 't/23510/fixed_mod_frac_field' into t/23229/cache_fraction_field`|



---

archive/issue_comments_438974.json:
```json
{
    "body": "Changing commit from \"3b232613682491a3403e3a8f8eeabda8cd0374a5\" to \"99bdc604d9c200134d8e9014d12b9f82fa635389\"",
    "created_at": "2017-08-04T03:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438974",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3b232613682491a3403e3a8f8eeabda8cd0374a5" to "99bdc604d9c200134d8e9014d12b9f82fa635389"



---

archive/issue_comments_438975.json:
```json
{
    "body": "Changing commit from \"99bdc604d9c200134d8e9014d12b9f82fa635389\" to \"8224475e0bd5e3cfd30504acf8e02f3ce8409491\"",
    "created_at": "2017-08-04T04:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438975",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "99bdc604d9c200134d8e9014d12b9f82fa635389" to "8224475e0bd5e3cfd30504acf8e02f3ce8409491"



---

archive/issue_comments_438976.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                           |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[8224475](https://github.com/sagemath/sagetrac-mirror/commit/8224475e0bd5e3cfd30504acf8e02f3ce8409491)|`Add deprecations for integer_ring as well`|",
    "created_at": "2017-08-04T04:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438976",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[8224475](https://github.com/sagemath/sagetrac-mirror/commit/8224475e0bd5e3cfd30504acf8e02f3ce8409491)|`Add deprecations for integer_ring as well`|



---

archive/issue_comments_438977.json:
```json
{
    "body": "Attachment [23229_over_23510.diff](tarball://root/attachments/some-uuid/ticket23229/23229_over_23510.diff) by @roed314 created at 2017-08-04 04:55:13\n\nDiff against #23510 for ease of review",
    "created_at": "2017-08-04T04:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438977",
    "user": "https://github.com/roed314"
}
```

Attachment [23229_over_23510.diff](tarball://root/attachments/some-uuid/ticket23229/23229_over_23510.diff) by @roed314 created at 2017-08-04 04:55:13

Diff against #23510 for ease of review



---

archive/issue_comments_438978.json:
```json
{
    "body": "Changing author from \"Julian R\u00fcth\" to \"Julian R\u00fcth, David Roe\"",
    "created_at": "2017-08-04T05:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438978",
    "user": "https://github.com/roed314"
}
```

Changing author from "Julian Rüth" to "Julian Rüth, David Roe"



---

archive/issue_comments_438979.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-08-04T05:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438979",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_438980.json:
```json
{
    "body": "<a id='comment:8'></a>\nI've fixed the doctest and added deprecations for using a `print_mode` argument for `fraction_field`.  This will speed up the `cached_method` once we remove it, and the functionality is available through `change`.",
    "created_at": "2017-08-04T05:08:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438980",
    "user": "https://github.com/roed314"
}
```

<a id='comment:8'></a>
I've fixed the doctest and added deprecations for using a `print_mode` argument for `fraction_field`.  This will speed up the `cached_method` once we remove it, and the functionality is available through `change`.



---

archive/issue_comments_438981.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,3 +8,5 @@\n 1000 loops, best of 3: 774 \u00b5s per loop # without caching\n 10000 loops, best of 3: 77.9 \u00b5s per loop # with caching\n ```\n+\n+In order to get better speed, this ticket also deprecates the `print_mode` dictionary that can passed into `fraction_field`, since this functionality is now available with `change`.\n``````\n",
    "created_at": "2017-08-04T07:34:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438981",
    "user": "https://github.com/roed314"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,3 +8,5 @@
 1000 loops, best of 3: 774 µs per loop # without caching
 10000 loops, best of 3: 77.9 µs per loop # with caching
 ```
+
+In order to get better speed, this ticket also deprecates the `print_mode` dictionary that can passed into `fraction_field`, since this functionality is now available with `change`.
``````




---

archive/issue_comments_438982.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#23510\"",
    "created_at": "2017-08-04T07:34:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438982",
    "user": "https://github.com/roed314"
}
```

Changing dependencies from "" to "#23510"



---

archive/issue_events_068145.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "rename": {
        "from": "Cache fraction_field() of p-adic extension rings",
        "to": "Cache fraction_field() of p-adic rings, deprecate print_mode options"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23229#event-68145"
}
```



---

archive/issue_comments_438983.json:
```json
{
    "body": "Changing commit from \"8224475e0bd5e3cfd30504acf8e02f3ce8409491\" to \"2d463cd6574fda86b8cae4e0a7fbe7a9ff6d23e4\"",
    "created_at": "2017-09-22T20:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438983",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8224475e0bd5e3cfd30504acf8e02f3ce8409491" to "2d463cd6574fda86b8cae4e0a7fbe7a9ff6d23e4"



---

archive/issue_comments_438984.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                           |                                                                                                                                                            |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|[e51c0f5](https://github.com/sagemath/sagetrac-mirror/commit/e51c0f50660a4fdb06071dba0551f5252984b171)|`Merge branch 'u/roed/polynomial_representation_of_a_padic_number' of git://trac.sagemath.org/sage into t/14825/polynomial_representation_of_a_padic_number`|\n|[b6457b1](https://github.com/sagemath/sagetrac-mirror/commit/b6457b1d48311d45bee32228bf989391b9754d88)|`Moving SEEALSO to the end of the docstring`|\n|[b81b722](https://github.com/sagemath/sagetrac-mirror/commit/b81b7223f120e4714163c79cab851f62eccf4e19)|`Remove use of depraceted list()`|\n|[04a1579](https://github.com/sagemath/sagetrac-mirror/commit/04a1579131d64cdc63ecf1babcba2350dec6497c)|`Fix NOTES blocks`|\n|[dbb869a](https://github.com/sagemath/sagetrac-mirror/commit/dbb869a81abced32d9be91e59b4850678b2cfd59)|`Merge branch 't/14825/polynomial_representation_of_a_padic_number' into t/23229/cache_frac_field`|\n|[fee575d](https://github.com/sagemath/sagetrac-mirror/commit/fee575d698e18c3a463f82c217f9bf21f9ac6985)|`Merge branch 't/14825/polynomial_representation_of_a_padic_number' into t/23510/fixed_mod_frac_field`|\n|[52cbd2a](https://github.com/sagemath/sagetrac-mirror/commit/52cbd2a0ed1c9154fa25ef340274ed985da84543)|`Merge branch 'u/roed/fixed_mod_frac_field' of git://trac.sagemath.org/sage into t/23510/fixed_mod_frac_field`|\n|[bc59ffa](https://github.com/sagemath/sagetrac-mirror/commit/bc59ffa25440c16729beeffcdc05bddb8081c5e2)|`Merge branch 't/14825/polynomial_representation_of_a_padic_number' into t/23510/fixed_mod_frac_field`|\n|[3292259](https://github.com/sagemath/sagetrac-mirror/commit/329225966f26609551ffcf07374409c9f3149ce2)|`Merge branch 'u/saraedum/fixed_mod_frac_field' of git://trac.sagemath.org/sage into t/23510/fixed_mod_frac_field`|\n|[2d463cd](https://github.com/sagemath/sagetrac-mirror/commit/2d463cd6574fda86b8cae4e0a7fbe7a9ff6d23e4)|`Merge branch 'u/saraedum/fixed_mod_frac_field' of git://trac.sagemath.org/sage into t/23229/cache_frac_field`|",
    "created_at": "2017-09-22T20:28:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438984",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                           |                                                                                                                                                            |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------|
|[e51c0f5](https://github.com/sagemath/sagetrac-mirror/commit/e51c0f50660a4fdb06071dba0551f5252984b171)|`Merge branch 'u/roed/polynomial_representation_of_a_padic_number' of git://trac.sagemath.org/sage into t/14825/polynomial_representation_of_a_padic_number`|
|[b6457b1](https://github.com/sagemath/sagetrac-mirror/commit/b6457b1d48311d45bee32228bf989391b9754d88)|`Moving SEEALSO to the end of the docstring`|
|[b81b722](https://github.com/sagemath/sagetrac-mirror/commit/b81b7223f120e4714163c79cab851f62eccf4e19)|`Remove use of depraceted list()`|
|[04a1579](https://github.com/sagemath/sagetrac-mirror/commit/04a1579131d64cdc63ecf1babcba2350dec6497c)|`Fix NOTES blocks`|
|[dbb869a](https://github.com/sagemath/sagetrac-mirror/commit/dbb869a81abced32d9be91e59b4850678b2cfd59)|`Merge branch 't/14825/polynomial_representation_of_a_padic_number' into t/23229/cache_frac_field`|
|[fee575d](https://github.com/sagemath/sagetrac-mirror/commit/fee575d698e18c3a463f82c217f9bf21f9ac6985)|`Merge branch 't/14825/polynomial_representation_of_a_padic_number' into t/23510/fixed_mod_frac_field`|
|[52cbd2a](https://github.com/sagemath/sagetrac-mirror/commit/52cbd2a0ed1c9154fa25ef340274ed985da84543)|`Merge branch 'u/roed/fixed_mod_frac_field' of git://trac.sagemath.org/sage into t/23510/fixed_mod_frac_field`|
|[bc59ffa](https://github.com/sagemath/sagetrac-mirror/commit/bc59ffa25440c16729beeffcdc05bddb8081c5e2)|`Merge branch 't/14825/polynomial_representation_of_a_padic_number' into t/23510/fixed_mod_frac_field`|
|[3292259](https://github.com/sagemath/sagetrac-mirror/commit/329225966f26609551ffcf07374409c9f3149ce2)|`Merge branch 'u/saraedum/fixed_mod_frac_field' of git://trac.sagemath.org/sage into t/23510/fixed_mod_frac_field`|
|[2d463cd](https://github.com/sagemath/sagetrac-mirror/commit/2d463cd6574fda86b8cae4e0a7fbe7a9ff6d23e4)|`Merge branch 'u/saraedum/fixed_mod_frac_field' of git://trac.sagemath.org/sage into t/23229/cache_frac_field`|



---

archive/issue_comments_438985.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                 |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|\n|[6764ea2](https://github.com/sagemath/sagetrac-mirror/commit/6764ea2edbec8d81ff52b2f9dbbc0f2226a68c32)|`Merge branch 'develop' into t/14825/polynomial_representation_of_a_padic_number`|\n|[dad02c7](https://github.com/sagemath/sagetrac-mirror/commit/dad02c7fcb3e8df67378259e19847e8c15424acf)|`Merge branch 'u/saraedum/fixed_mod_frac_field' of git://trac.sagemath.org/sage into t/23510/fixed_mod_frac_field`|\n|[189ac2b](https://github.com/sagemath/sagetrac-mirror/commit/189ac2b4a6b37dbe49ea70ab09e6e68b8b091d59)|`Add _test_fraction_field to the coercion tutorial`|\n|[edf1801](https://github.com/sagemath/sagetrac-mirror/commit/edf180196caab83f360921401e559bd2041698b6)|`Merge branch 't/23510/fixed_mod_frac_field' into t/23229/cache_frac_field`|",
    "created_at": "2017-09-23T18:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438985",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
|[6764ea2](https://github.com/sagemath/sagetrac-mirror/commit/6764ea2edbec8d81ff52b2f9dbbc0f2226a68c32)|`Merge branch 'develop' into t/14825/polynomial_representation_of_a_padic_number`|
|[dad02c7](https://github.com/sagemath/sagetrac-mirror/commit/dad02c7fcb3e8df67378259e19847e8c15424acf)|`Merge branch 'u/saraedum/fixed_mod_frac_field' of git://trac.sagemath.org/sage into t/23510/fixed_mod_frac_field`|
|[189ac2b](https://github.com/sagemath/sagetrac-mirror/commit/189ac2b4a6b37dbe49ea70ab09e6e68b8b091d59)|`Add _test_fraction_field to the coercion tutorial`|
|[edf1801](https://github.com/sagemath/sagetrac-mirror/commit/edf180196caab83f360921401e559bd2041698b6)|`Merge branch 't/23510/fixed_mod_frac_field' into t/23229/cache_frac_field`|



---

archive/issue_comments_438986.json:
```json
{
    "body": "Changing commit from \"2d463cd6574fda86b8cae4e0a7fbe7a9ff6d23e4\" to \"edf180196caab83f360921401e559bd2041698b6\"",
    "created_at": "2017-09-23T18:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438986",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2d463cd6574fda86b8cae4e0a7fbe7a9ff6d23e4" to "edf180196caab83f360921401e559bd2041698b6"



---

archive/issue_comments_438987.json:
```json
{
    "body": "<a id='comment:12'></a>\nLooks good. The patchbots complain about lots of things. If this is just noise from somewhere else you can set this to positive review.",
    "created_at": "2018-01-06T00:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438987",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:12'></a>
Looks good. The patchbots complain about lots of things. If this is just noise from somewhere else you can set this to positive review.



---

archive/issue_comments_438988.json:
```json
{
    "body": "<a id='comment:13'></a>\nDid you check for memory leaks? From\n`pAdicRing(7) is pAdicRing(7)`\nI suspect there is at least some kind of unique representation for padics. This tends to combine very poorly with caching, since it makes unexpected strong global reference chains: Because the ring lives in the (weak value) unique rep. cache, any object it references is strongly globally referenced. If any of those objects now references the ring (for instance by having it in its construction parameters if it's unique rep. itself), you have a globally anchored reference cycle and hence a memory leak.\n\n**EDIT:**\nOK, it looks like it's OK, because it seems that the construction parameters of field of fractions or integer ring do not refer to the ring/field, but are both constructed as completions:\n\n```\nsage: R=pAdicRing(7)\nsage: R.construction()\n(Completion[7], Integer Ring)\nsage: R.fraction_field().construction()\n(Completion[7], Rational Field)\nsage: K=pAdicField(7)\nsage: K.construction()\n(Completion[7], Rational Field)\nsage: K.integer_ring().construction()\n(Completion[7], Integer Ring)\n```\n\nIt means that \"completion\" on number fields cannot be caching.",
    "created_at": "2018-01-06T18:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438988",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:13'></a>
Did you check for memory leaks? From
`pAdicRing(7) is pAdicRing(7)`
I suspect there is at least some kind of unique representation for padics. This tends to combine very poorly with caching, since it makes unexpected strong global reference chains: Because the ring lives in the (weak value) unique rep. cache, any object it references is strongly globally referenced. If any of those objects now references the ring (for instance by having it in its construction parameters if it's unique rep. itself), you have a globally anchored reference cycle and hence a memory leak.

**EDIT:**
OK, it looks like it's OK, because it seems that the construction parameters of field of fractions or integer ring do not refer to the ring/field, but are both constructed as completions:

```
sage: R=pAdicRing(7)
sage: R.construction()
(Completion[7], Integer Ring)
sage: R.fraction_field().construction()
(Completion[7], Rational Field)
sage: K=pAdicField(7)
sage: K.construction()
(Completion[7], Rational Field)
sage: K.integer_ring().construction()
(Completion[7], Integer Ring)
```

It means that "completion" on number fields cannot be caching.



---

archive/issue_comments_438989.json:
```json
{
    "body": "<a id='comment:14'></a>\nI agree that the patchbot failures are just noise, and it sounds like Nils is okay with the caching going on here.",
    "created_at": "2018-02-26T12:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438989",
    "user": "https://github.com/roed314"
}
```

<a id='comment:14'></a>
I agree that the patchbot failures are just noise, and it sounds like Nils is okay with the caching going on here.



---

archive/issue_comments_438990.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-02-26T12:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438990",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_068146.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-03-06T23:23:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23229#event-68146"
}
```



---

archive/issue_comments_438991.json:
```json
{
    "body": "Changing branch from \"u/roed/cache_fraction_field___of_p_adic_extension_rings\" to \"edf180196caab83f360921401e559bd2041698b6\"",
    "created_at": "2018-03-06T23:23:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438991",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/roed/cache_fraction_field___of_p_adic_extension_rings" to "edf180196caab83f360921401e559bd2041698b6"



---

archive/issue_comments_438992.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-03-06T23:23:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23229",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23229#issuecomment-438992",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
