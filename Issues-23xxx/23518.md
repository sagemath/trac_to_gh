# Issue 23518: Upgrade cypari2 package

archive/issues_023281.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\n**Tarball**: https://pypi.python.org/packages/1c/ff/a9a0c9087c08d14807214930bed13ccfb6b2198f38c6992d89c63eb5870b/cypari2-1.1.1.tar.gz\n\nCC:  @jdemeyer @defeo @videlec @kiwifb\n\nComponent: **packages: standard**\n\nKeywords: **cypari2, sd87**\n\nAuthor: **Jeroen Demeyer**\n\nBranch: **[`749c534`](https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7)**\n\nReviewer: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23518_\n\n",
    "closed_at": "2017-09-02T09:34:04Z",
    "created_at": "2017-07-22T14:45:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Upgrade cypari2 package",
    "type": "issue",
    "updated_at": "2017-09-05T13:59:31Z",
    "url": "https://github.com/sagemath/sage/issues/23518",
    "user": "https://github.com/rharron"
}
```
<div id="comment:0"></div>

**Tarball**: https://pypi.python.org/packages/1c/ff/a9a0c9087c08d14807214930bed13ccfb6b2198f38c6992d89c63eb5870b/cypari2-1.1.1.tar.gz

CC:  @jdemeyer @defeo @videlec @kiwifb

Component: **packages: standard**

Keywords: **cypari2, sd87**

Author: **Jeroen Demeyer**

Branch: **[`749c534`](https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7)**

Reviewer: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/23518_





---

archive/issue_events_324415.json:
```json
{
    "actor": "https://github.com/rharron",
    "created_at": "2017-07-22T14:45:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324415"
}
```



---

archive/issue_events_324416.json:
```json
{
    "actor": "https://github.com/rharron",
    "created_at": "2017-07-22T14:45:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324416"
}
```



---

archive/issue_events_324417.json:
```json
{
    "actor": "https://github.com/rharron",
    "created_at": "2017-07-22T14:45:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324417"
}
```



---

archive/issue_events_324418.json:
```json
{
    "actor": "https://github.com/rharron",
    "created_at": "2017-07-22T14:45:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324418"
}
```



---

archive/issue_comments_353685.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nany release coming soon ?",
    "created_at": "2017-08-07T16:41:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353685",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1" align="right">comment:1</div>

any release coming soon ?



---

archive/issue_comments_353686.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n**ping** ? this is the current blocking point in my experimental python3 build.",
    "created_at": "2017-08-18T10:54:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353686",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

**ping** ? this is the current blocking point in my experimental python3 build.



---

archive/issue_events_324419.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-18T11:21:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324419"
}
```



---

archive/issue_comments_353687.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI don't really know about what kind of automated stuff happens on trac anymore, so let me ask this perhaps naive question: why is this a block for anything? I only created this ticket because of #15829 which itself is still under development (has never even been marked as \"needs review\").",
    "created_at": "2017-08-18T19:39:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353687",
    "user": "https://github.com/rharron"
}
```

<div id="comment:5" align="right">comment:5</div>

I don't really know about what kind of automated stuff happens on trac anymore, so let me ask this perhaps naive question: why is this a block for anything? I only created this ticket because of #15829 which itself is still under development (has never even been marked as "needs review").



---

archive/issue_comments_353688.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSorry, I have used your ticket for my own purposes. I need (for something having to do with making sage works with python3) to have a new release of cypari2. So I would just embark in this ticket, which is also asking for a release of cypari2.",
    "created_at": "2017-08-18T19:41:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353688",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:6" align="right">comment:6</div>

Sorry, I have used your ticket for my own purposes. I need (for something having to do with making sage works with python3) to have a new release of cypari2. So I would just embark in this ticket, which is also asking for a release of cypari2.



---

archive/issue_comments_353689.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAha! I understand now. It may be worth updating the ticket description: it might encourage people to work on this ticket!",
    "created_at": "2017-08-18T19:43:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353689",
    "user": "https://github.com/rharron"
}
```

<div id="comment:7" align="right">comment:7</div>

Aha! I understand now. It may be worth updating the ticket description: it might encourage people to work on this ticket!



---

archive/issue_events_324420.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2017-08-19T09:18:53Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "title_is": "Updgrade cypari2 package",
    "title_was": "Update cypari2 with version including idealmoddivisor",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324420"
}
```



---

archive/issue_comments_353690.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n-Update cypari2 to a version including at least the commit:\n+Update cypari2 to a version including at least\n \n-https://github.com/defeo/cypari2/commit/8f497cd27a04e292c52b31c44c569e50bab7a625\n+- [PR 13](https://github.com/defeo/cypari2/pull/13), [PR 23](https://github.com/defeo/cypari2/pull/23) and [PR 25](https://github.com/defeo/cypari2/pull/25) about Python 3 support\n \n-This exposes the function idealmoddivisor that is used in the ray class group and Hecke character code of ticket #15829.\n+- [PR16](https://github.com/defeo/cypari2/pull/16) about idealmoddivisor function (needed for #15829)\n``````\n",
    "created_at": "2017-08-19T09:18:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353690",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
-Update cypari2 to a version including at least the commit:
+Update cypari2 to a version including at least
 
-https://github.com/defeo/cypari2/commit/8f497cd27a04e292c52b31c44c569e50bab7a625
+- [PR 13](https://github.com/defeo/cypari2/pull/13), [PR 23](https://github.com/defeo/cypari2/pull/23) and [PR 25](https://github.com/defeo/cypari2/pull/25) about Python 3 support
 
-This exposes the function idealmoddivisor that is used in the ray class group and Hecke character code of ticket #15829.
+- [PR16](https://github.com/defeo/cypari2/pull/16) about idealmoddivisor function (needed for #15829)
``````




---

archive/issue_comments_353691.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n - [PR 13](https://github.com/defeo/cypari2/pull/13), [PR 23](https://github.com/defeo/cypari2/pull/23) and [PR 25](https://github.com/defeo/cypari2/pull/25) about Python 3 support\n \n - [PR16](https://github.com/defeo/cypari2/pull/16) about idealmoddivisor function (needed for #15829)\n+\n+Upstream = https://github.com/defeo/cypari2\n``````\n",
    "created_at": "2017-08-21T08:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353691",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 - [PR 13](https://github.com/defeo/cypari2/pull/13), [PR 23](https://github.com/defeo/cypari2/pull/23) and [PR 25](https://github.com/defeo/cypari2/pull/25) about Python 3 support
 
 - [PR16](https://github.com/defeo/cypari2/pull/16) about idealmoddivisor function (needed for #15829)
+
+Upstream = https://github.com/defeo/cypari2
``````




---

archive/issue_events_324421.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-22T14:58:37Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "title_is": "Upgrade cypari2 package",
    "title_was": "Updgrade cypari2 package",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324421"
}
```



---

archive/issue_comments_353692.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2017-08-22T14:58:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353692",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_353693.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1 @@\n-Update cypari2 to a version including at least\n-\n-- [PR 13](https://github.com/defeo/cypari2/pull/13), [PR 23](https://github.com/defeo/cypari2/pull/23) and [PR 25](https://github.com/defeo/cypari2/pull/25) about Python 3 support\n-\n-- [PR16](https://github.com/defeo/cypari2/pull/16) about idealmoddivisor function (needed for #15829)\n-\n-Upstream = https://github.com/defeo/cypari2\n+**Tarball**: https://pypi.python.org/packages/00/85/fa16eef48d19b2fce3bb563332762e16ad7f26ef4c80622a7985757a8cb5/cypari2-1.1.0.tar.gz\n``````\n",
    "created_at": "2017-08-23T10:22:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353693",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1 @@
-Update cypari2 to a version including at least
-
-- [PR 13](https://github.com/defeo/cypari2/pull/13), [PR 23](https://github.com/defeo/cypari2/pull/23) and [PR 25](https://github.com/defeo/cypari2/pull/25) about Python 3 support
-
-- [PR16](https://github.com/defeo/cypari2/pull/16) about idealmoddivisor function (needed for #15829)
-
-Upstream = https://github.com/defeo/cypari2
+**Tarball**: https://pypi.python.org/packages/00/85/fa16eef48d19b2fce3bb563332762e16ad7f26ef4c80622a7985757a8cb5/cypari2-1.1.0.tar.gz
``````




---

archive/issue_comments_353694.json:
```json
{
    "body": "Branch: **[u/jdemeyer/upgrade_cypari2_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/upgrade_cypari2_package)**",
    "created_at": "2017-08-23T10:22:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353694",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/upgrade_cypari2_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/upgrade_cypari2_package)**



---

archive/issue_comments_353695.json:
```json
{
    "body": "Commit: **[`75cd924`](https://github.com/sagemath/sagetrac-mirror/commit/75cd924e9b264c49598d7909b84a37c6bb050511)**",
    "created_at": "2017-08-23T10:33:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353695",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[`75cd924`](https://github.com/sagemath/sagetrac-mirror/commit/75cd924e9b264c49598d7909b84a37c6bb050511)**



---

archive/issue_comments_353696.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSomething very strange happens while testing the package:\n\n```\n[cypari-1.1.0] Testing cypari2.pari_instance\n[cypari-1.1.0] Traceback (most recent call last):\n[cypari-1.1.0]   File \"tests/rundoctest.py\", line 24, in <module>\n[cypari-1.1.0]     test = doctest.testmod(mod, optionflags=doctest.ELLIPSIS|doctest.REPORT_NDIFF|doctest.IGNORE_EXCEPTION_DETAIL)\n[cypari-1.1.0]   File \"/usr/local/src/sage-config/local/lib/python2.7/doctest.py\", line 1911, in testmod\n[cypari-1.1.0]     runner.run(test)\n[cypari-1.1.0]   File \"/usr/local/src/sage-config/local/lib/python2.7/doctest.py\", line 1454, in run\n[cypari-1.1.0]     return self.__run(test, compileflags, out)\n[cypari-1.1.0]   File \"/usr/local/src/sage-config/local/lib/python2.7/doctest.py\", line 1368, in __run\n[cypari-1.1.0]     exc_info)\n[cypari-1.1.0]   File \"/usr/local/src/sage-config/local/lib/python2.7/doctest.py\", line 1235, in report_unexpected_exception\n[cypari-1.1.0]     'Exception raised:\\n' + _indent(_exception_traceback(exc_info)))\n[cypari-1.1.0]   File \"/usr/local/src/sage-config/local/lib/python2.7/doctest.py\", line 1251, in _failure_header\n[cypari-1.1.0]     return '\\n'.join(out)\n[cypari-1.1.0] UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 16: ordinal not in range(128)\n```\n\nThis happens only when testing the Sage package. Any other way of running the testsuite works fine.\n\nI have absolutely no idea why and I hope that somebody else can fix it.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75cd924e9b264c49598d7909b84a37c6bb050511\"><code>75cd924</code></a></td><td><code>Upgrade cypari2 to version 1.1.0</code></td></tr></table>\n",
    "created_at": "2017-08-23T10:33:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353696",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Something very strange happens while testing the package:

```
[cypari-1.1.0] Testing cypari2.pari_instance
[cypari-1.1.0] Traceback (most recent call last):
[cypari-1.1.0]   File "tests/rundoctest.py", line 24, in <module>
[cypari-1.1.0]     test = doctest.testmod(mod, optionflags=doctest.ELLIPSIS|doctest.REPORT_NDIFF|doctest.IGNORE_EXCEPTION_DETAIL)
[cypari-1.1.0]   File "/usr/local/src/sage-config/local/lib/python2.7/doctest.py", line 1911, in testmod
[cypari-1.1.0]     runner.run(test)
[cypari-1.1.0]   File "/usr/local/src/sage-config/local/lib/python2.7/doctest.py", line 1454, in run
[cypari-1.1.0]     return self.__run(test, compileflags, out)
[cypari-1.1.0]   File "/usr/local/src/sage-config/local/lib/python2.7/doctest.py", line 1368, in __run
[cypari-1.1.0]     exc_info)
[cypari-1.1.0]   File "/usr/local/src/sage-config/local/lib/python2.7/doctest.py", line 1235, in report_unexpected_exception
[cypari-1.1.0]     'Exception raised:\n' + _indent(_exception_traceback(exc_info)))
[cypari-1.1.0]   File "/usr/local/src/sage-config/local/lib/python2.7/doctest.py", line 1251, in _failure_header
[cypari-1.1.0]     return '\n'.join(out)
[cypari-1.1.0] UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 16: ordinal not in range(128)
```

This happens only when testing the Sage package. Any other way of running the testsuite works fine.

I have absolutely no idea why and I hope that somebody else can fix it.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75cd924e9b264c49598d7909b84a37c6bb050511"><code>75cd924</code></a></td><td><code>Upgrade cypari2 to version 1.1.0</code></td></tr></table>




---

archive/issue_events_324422.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-23T10:33:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324422"
}
```



---

archive/issue_events_324423.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-23T10:33:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324423"
}
```



---

archive/issue_comments_353697.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nHow can I run this testsuite ?",
    "created_at": "2017-08-23T11:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353697",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:15" align="right">comment:15</div>

How can I run this testsuite ?



---

archive/issue_comments_353698.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThe failing testsuite is `./sage -i -c cypari`\n\nBut like I said, the strange thing is that manually running `spkg-check` works.",
    "created_at": "2017-08-23T11:45:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353698",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

The failing testsuite is `./sage -i -c cypari`

But like I said, the strange thing is that manually running `spkg-check` works.



---

archive/issue_comments_353699.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI can confirm the failure of `./sage -i -c cypari`, just the same as what you got.\n\nHow can I run manually \"spkg-check\" ?",
    "created_at": "2017-08-23T11:57:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353699",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:17" align="right">comment:17</div>

I can confirm the failure of `./sage -i -c cypari`, just the same as what you got.

How can I run manually "spkg-check" ?



---

archive/issue_comments_353700.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nwiht python3-sage, I get something else\n\n```\n[cypari-1.1.0] ****************************************************\n[cypari-1.1.0] Uninstalling cypari2-1.0.0:\n[cypari-1.1.0]   Successfully uninstalled cypari2-1.0.0\n[cypari-1.1.0] Installing package cypari2 using pip3\n[cypari-1.1.0] Ignoring indexes: https://pypi.python.org/simple\n[cypari-1.1.0] Processing /home/chapoton/sage3/local/var/tmp/sage/build/cypari-1.1.0/src\n[cypari-1.1.0]   Running setup.py (path:/tmp/pip-yihktdba-build/setup.py) egg_info for package from file:///home/chapoton/sage3/local/var/tmp/sage/build/cypari-1.1.0/src\n[cypari-1.1.0]     Running command python setup.py egg_info\n[cypari-1.1.0]     running egg_info\n[cypari-1.1.0]     creating pip-egg-info/cypari2.egg-info\n[cypari-1.1.0]     writing pip-egg-info/cypari2.egg-info/PKG-INFO\n[cypari-1.1.0]     writing dependency_links to pip-egg-info/cypari2.egg-info/dependency_links.txt\n[cypari-1.1.0]     writing top-level names to pip-egg-info/cypari2.egg-info/top_level.txt\n[cypari-1.1.0]     writing manifest file 'pip-egg-info/cypari2.egg-info/SOURCES.txt'\n[cypari-1.1.0]     Generating PARI functions: (!_) (#_) (%) (%#) (+_) (-_) Catalan Col Colrev (DEBUGLEVEL) Euler I List Map MatTraceback (most recent call last):\n[cypari-1.1.0]       File \"<string>\", line 1, in <module>\n[cypari-1.1.0]       File \"/tmp/pip-yihktdba-build/setup.py\", line 84, in <module>\n[cypari-1.1.0]         cmdclass=dict(build_ext=build_ext, bdist_egg=no_egg)\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/distutils/core.py\", line 148, in setup\n[cypari-1.1.0]         dist.run_commands()\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/distutils/dist.py\", line 955, in run_commands\n[cypari-1.1.0]         self.run_command(cmd)\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/distutils/dist.py\", line 974, in run_command\n[cypari-1.1.0]         cmd_obj.run()\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/egg_info.py\", line 279, in run\n[cypari-1.1.0]         self.find_sources()\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/egg_info.py\", line 294, in find_sources\n[cypari-1.1.0]         mm.run()\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/egg_info.py\", line 521, in run\n[cypari-1.1.0]         self.add_defaults()\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/egg_info.py\", line 557, in add_defaults\n[cypari-1.1.0]         sdist.add_defaults(self)\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/py36compat.py\", line 36, in add_defaults\n[cypari-1.1.0]         self._add_defaults_ext()\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/py36compat.py\", line 119, in _add_defaults_ext\n[cypari-1.1.0]         build_ext = self.get_finalized_command('build_ext')\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/distutils/cmd.py\", line 299, in get_finalized_command\n[cypari-1.1.0]         cmd_obj.ensure_finalized()\n[cypari-1.1.0]       File \"/home/chapoton/sage3/local/lib/python3.6/distutils/cmd.py\", line 107, in ensure_finalized\n[cypari-1.1.0]         self.finalize_options()\n[cypari-1.1.0]       File \"/tmp/pip-yihktdba-build/setup.py\", line 50, in finalize_options\n[cypari-1.1.0]         rebuild()\n[cypari-1.1.0]       File \"/tmp/pip-yihktdba-build/autogen/__init__.py\", line 26, in rebuild\n[cypari-1.1.0]         G()\n[cypari-1.1.0]       File \"/tmp/pip-yihktdba-build/autogen/generator.py\", line 336, in __call__\n[cypari-1.1.0]         self.handle_pari_function(**v)\n[cypari-1.1.0]       File \"/tmp/pip-yihktdba-build/autogen/generator.py\", line 239, in handle_pari_function\n[cypari-1.1.0]         self.gen_file, doc, obsolete)\n[cypari-1.1.0]       File \"/tmp/pip-yihktdba-build/autogen/generator.py\", line 313, in write_method\n[cypari-1.1.0]         print(s, file=file)\n[cypari-1.1.0]     UnicodeEncodeError: 'ascii' codec can't encode character '\\xa0' in position 314: ordinal not in range(128)\n[cypari-1.1.0] Cleaning up...\n[cypari-1.1.0] Command \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-yihktdba-build/\n[cypari-1.1.0] Exception information:\n[cypari-1.1.0] Traceback (most recent call last):\n[cypari-1.1.0]   File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/basecommand.py\", line 215, in main\n[cypari-1.1.0]     status = self.run(options, args)\n[cypari-1.1.0]   File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/commands/install.py\", line 324, in run\n[cypari-1.1.0]     requirement_set.prepare_files(finder)\n[cypari-1.1.0]   File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/req/req_set.py\", line 380, in prepare_files\n[cypari-1.1.0]     ignore_dependencies=self.ignore_dependencies))\n[cypari-1.1.0]   File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/req/req_set.py\", line 634, in _prepare_file\n[cypari-1.1.0]     abstract_dist.prep_for_dist()\n[cypari-1.1.0]   File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/req/req_set.py\", line 129, in prep_for_dist\n[cypari-1.1.0]     self.req_to_install.run_egg_info()\n[cypari-1.1.0]   File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/req/req_install.py\", line 439, in run_egg_info\n[cypari-1.1.0]     command_desc='python setup.py egg_info')\n[cypari-1.1.0]   File \"/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/utils/__init__.py\", line 707, in call_subprocess\n[cypari-1.1.0]     % (command_desc, proc.returncode, cwd))\n[cypari-1.1.0] pip.exceptions.InstallationError: Command \"python setup.py egg_info\" failed with error code 1 in /tmp/pip-yihktdba-build/\n[cypari-1.1.0] Error: installing with pip3 failed\n[cypari-1.1.0] \n[cypari-1.1.0] real\t0m4.142s\n[cypari-1.1.0] user\t0m2.116s\n[cypari-1.1.0] sys\t0m0.224s\n[cypari-1.1.0] ************************************************************************\n[cypari-1.1.0] Error installing package cypari-1.1.0\n[cypari-1.1.0] ************************************************************************\n```",
    "created_at": "2017-08-23T12:06:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353700",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:18" align="right">comment:18</div>

wiht python3-sage, I get something else

```
[cypari-1.1.0] ****************************************************
[cypari-1.1.0] Uninstalling cypari2-1.0.0:
[cypari-1.1.0]   Successfully uninstalled cypari2-1.0.0
[cypari-1.1.0] Installing package cypari2 using pip3
[cypari-1.1.0] Ignoring indexes: https://pypi.python.org/simple
[cypari-1.1.0] Processing /home/chapoton/sage3/local/var/tmp/sage/build/cypari-1.1.0/src
[cypari-1.1.0]   Running setup.py (path:/tmp/pip-yihktdba-build/setup.py) egg_info for package from file:///home/chapoton/sage3/local/var/tmp/sage/build/cypari-1.1.0/src
[cypari-1.1.0]     Running command python setup.py egg_info
[cypari-1.1.0]     running egg_info
[cypari-1.1.0]     creating pip-egg-info/cypari2.egg-info
[cypari-1.1.0]     writing pip-egg-info/cypari2.egg-info/PKG-INFO
[cypari-1.1.0]     writing dependency_links to pip-egg-info/cypari2.egg-info/dependency_links.txt
[cypari-1.1.0]     writing top-level names to pip-egg-info/cypari2.egg-info/top_level.txt
[cypari-1.1.0]     writing manifest file 'pip-egg-info/cypari2.egg-info/SOURCES.txt'
[cypari-1.1.0]     Generating PARI functions: (!_) (#_) (%) (%#) (+_) (-_) Catalan Col Colrev (DEBUGLEVEL) Euler I List Map MatTraceback (most recent call last):
[cypari-1.1.0]       File "<string>", line 1, in <module>
[cypari-1.1.0]       File "/tmp/pip-yihktdba-build/setup.py", line 84, in <module>
[cypari-1.1.0]         cmdclass=dict(build_ext=build_ext, bdist_egg=no_egg)
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/distutils/core.py", line 148, in setup
[cypari-1.1.0]         dist.run_commands()
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/distutils/dist.py", line 955, in run_commands
[cypari-1.1.0]         self.run_command(cmd)
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/distutils/dist.py", line 974, in run_command
[cypari-1.1.0]         cmd_obj.run()
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/egg_info.py", line 279, in run
[cypari-1.1.0]         self.find_sources()
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/egg_info.py", line 294, in find_sources
[cypari-1.1.0]         mm.run()
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/egg_info.py", line 521, in run
[cypari-1.1.0]         self.add_defaults()
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/egg_info.py", line 557, in add_defaults
[cypari-1.1.0]         sdist.add_defaults(self)
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/py36compat.py", line 36, in add_defaults
[cypari-1.1.0]         self._add_defaults_ext()
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/site-packages/setuptools/command/py36compat.py", line 119, in _add_defaults_ext
[cypari-1.1.0]         build_ext = self.get_finalized_command('build_ext')
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/distutils/cmd.py", line 299, in get_finalized_command
[cypari-1.1.0]         cmd_obj.ensure_finalized()
[cypari-1.1.0]       File "/home/chapoton/sage3/local/lib/python3.6/distutils/cmd.py", line 107, in ensure_finalized
[cypari-1.1.0]         self.finalize_options()
[cypari-1.1.0]       File "/tmp/pip-yihktdba-build/setup.py", line 50, in finalize_options
[cypari-1.1.0]         rebuild()
[cypari-1.1.0]       File "/tmp/pip-yihktdba-build/autogen/__init__.py", line 26, in rebuild
[cypari-1.1.0]         G()
[cypari-1.1.0]       File "/tmp/pip-yihktdba-build/autogen/generator.py", line 336, in __call__
[cypari-1.1.0]         self.handle_pari_function(**v)
[cypari-1.1.0]       File "/tmp/pip-yihktdba-build/autogen/generator.py", line 239, in handle_pari_function
[cypari-1.1.0]         self.gen_file, doc, obsolete)
[cypari-1.1.0]       File "/tmp/pip-yihktdba-build/autogen/generator.py", line 313, in write_method
[cypari-1.1.0]         print(s, file=file)
[cypari-1.1.0]     UnicodeEncodeError: 'ascii' codec can't encode character '\xa0' in position 314: ordinal not in range(128)
[cypari-1.1.0] Cleaning up...
[cypari-1.1.0] Command "python setup.py egg_info" failed with error code 1 in /tmp/pip-yihktdba-build/
[cypari-1.1.0] Exception information:
[cypari-1.1.0] Traceback (most recent call last):
[cypari-1.1.0]   File "/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/basecommand.py", line 215, in main
[cypari-1.1.0]     status = self.run(options, args)
[cypari-1.1.0]   File "/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/commands/install.py", line 324, in run
[cypari-1.1.0]     requirement_set.prepare_files(finder)
[cypari-1.1.0]   File "/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/req/req_set.py", line 380, in prepare_files
[cypari-1.1.0]     ignore_dependencies=self.ignore_dependencies))
[cypari-1.1.0]   File "/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/req/req_set.py", line 634, in _prepare_file
[cypari-1.1.0]     abstract_dist.prep_for_dist()
[cypari-1.1.0]   File "/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/req/req_set.py", line 129, in prep_for_dist
[cypari-1.1.0]     self.req_to_install.run_egg_info()
[cypari-1.1.0]   File "/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/req/req_install.py", line 439, in run_egg_info
[cypari-1.1.0]     command_desc='python setup.py egg_info')
[cypari-1.1.0]   File "/home/chapoton/sage3/local/lib/python3.6/site-packages/pip/utils/__init__.py", line 707, in call_subprocess
[cypari-1.1.0]     % (command_desc, proc.returncode, cwd))
[cypari-1.1.0] pip.exceptions.InstallationError: Command "python setup.py egg_info" failed with error code 1 in /tmp/pip-yihktdba-build/
[cypari-1.1.0] Error: installing with pip3 failed
[cypari-1.1.0] 
[cypari-1.1.0] real	0m4.142s
[cypari-1.1.0] user	0m2.116s
[cypari-1.1.0] sys	0m0.224s
[cypari-1.1.0] ************************************************************************
[cypari-1.1.0] Error installing package cypari-1.1.0
[cypari-1.1.0] ************************************************************************
```



---

archive/issue_comments_353701.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nCan I please have\n\n```\nfrom __past__ import bytes_literals\n```",
    "created_at": "2017-08-23T12:22:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353701",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

Can I please have

```
from __past__ import bytes_literals
```



---

archive/issue_comments_353702.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSorry, I do not understand..\n\n**EDIT**: oh, some kind of joke ?",
    "created_at": "2017-08-23T12:24:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353702",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:20" align="right">comment:20</div>

Sorry, I do not understand..

**EDIT**: oh, some kind of joke ?



---

archive/issue_comments_353703.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nYes, a joke of course.\n\nLet me just say that I'm not a fan of the way how Python deals with unicode encoding issues...",
    "created_at": "2017-08-23T12:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353703",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

Yes, a joke of course.

Let me just say that I'm not a fan of the way how Python deals with unicode encoding issues...



---

archive/issue_comments_353704.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nOK, the issues are due to `LC_ALL=C`. This is something that will need to be fixed upstream.",
    "created_at": "2017-08-24T08:04:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353704",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

OK, the issues are due to `LC_ALL=C`. This is something that will need to be fixed upstream.



---

archive/issue_comments_353705.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI just saw your e-mail about this.  Did you figure it out?  You mentioned something about `LC_ALL=C`.  And by \"fixed upstream\" do you mean in cypari?  Should I take a look at how cypari is handling encodings?",
    "created_at": "2017-08-24T10:07:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353705",
    "user": "https://github.com/embray"
}
```

<div id="comment:23" align="right">comment:23</div>

I just saw your e-mail about this.  Did you figure it out?  You mentioned something about `LC_ALL=C`.  And by "fixed upstream" do you mean in cypari?  Should I take a look at how cypari is handling encodings?



---

archive/issue_comments_353706.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@embray](#comment%3A23):\n> I just saw your e-mail about this.  Did you figure it out?\n\nYes. The issue is that Python's `open()` and `print()` functions depend on the locale:\n\n```\n$ LC_ALL=en_US.UTF-8 python3 -c 'print(open(\"/dev/null\"))'\n<_io.TextIOWrapper name='/dev/null' mode='r' encoding='UTF-8'>\n$ LC_ALL=C python3 -c 'print(open(\"/dev/null\"))'\n<_io.TextIOWrapper name='/dev/null' mode='r' encoding='ANSI_X3.4-1968'>\n```\n\nIt turns out that cypari2 was assuming that files were opened in UTF-8 mode. I now made this explicit with `open(...., encoding=\"utf-8\")` in Python 3.",
    "created_at": "2017-08-24T12:21:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353706",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@embray](#comment%3A23):
> I just saw your e-mail about this.  Did you figure it out?

Yes. The issue is that Python's `open()` and `print()` functions depend on the locale:

```
$ LC_ALL=en_US.UTF-8 python3 -c 'print(open("/dev/null"))'
<_io.TextIOWrapper name='/dev/null' mode='r' encoding='UTF-8'>
$ LC_ALL=C python3 -c 'print(open("/dev/null"))'
<_io.TextIOWrapper name='/dev/null' mode='r' encoding='ANSI_X3.4-1968'>
```

It turns out that cypari2 was assuming that files were opened in UTF-8 mode. I now made this explicit with `open(...., encoding="utf-8")` in Python 3.



---

archive/issue_comments_353707.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-**Tarball**: https://pypi.python.org/packages/00/85/fa16eef48d19b2fce3bb563332762e16ad7f26ef4c80622a7985757a8cb5/cypari2-1.1.0.tar.gz\n+**Tarball**: https://pypi.python.org/packages/1c/ff/a9a0c9087c08d14807214930bed13ccfb6b2198f38c6992d89c63eb5870b/cypari2-1.1.1.tar.gz\n``````\n",
    "created_at": "2017-08-24T12:21:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353707",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-**Tarball**: https://pypi.python.org/packages/00/85/fa16eef48d19b2fce3bb563332762e16ad7f26ef4c80622a7985757a8cb5/cypari2-1.1.0.tar.gz
+**Tarball**: https://pypi.python.org/packages/1c/ff/a9a0c9087c08d14807214930bed13ccfb6b2198f38c6992d89c63eb5870b/cypari2-1.1.1.tar.gz
``````




---

archive/issue_comments_353708.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nBy the way, this is a useful guide handling encodings when reading text files:\n\nhttp://python-notes.curiousefficiency.org/en/latest/python3/text_file_processing.html#text-file-processing\n\nI would suggest also adding `errors='surrogateescape'`.  This way if any file happens to contain non-ASCII characters that were written using any encoding other than UTF-8, it will at least handle the ASCII parts correctly and not blow up with a `UnicodeDecodeError`.",
    "created_at": "2017-08-24T12:32:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353708",
    "user": "https://github.com/embray"
}
```

<div id="comment:25" align="right">comment:25</div>

By the way, this is a useful guide handling encodings when reading text files:

http://python-notes.curiousefficiency.org/en/latest/python3/text_file_processing.html#text-file-processing

I would suggest also adding `errors='surrogateescape'`.  This way if any file happens to contain non-ASCII characters that were written using any encoding other than UTF-8, it will at least handle the ASCII parts correctly and not blow up with a `UnicodeDecodeError`.



---

archive/issue_comments_353709.json:
```json
{
    "body": "Changed commit from **[`75cd924`](https://github.com/sagemath/sagetrac-mirror/commit/75cd924e9b264c49598d7909b84a37c6bb050511)** to **[`749c534`](https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7)**",
    "created_at": "2017-08-24T12:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353709",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`75cd924`](https://github.com/sagemath/sagetrac-mirror/commit/75cd924e9b264c49598d7909b84a37c6bb050511)** to **[`749c534`](https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7)**



---

archive/issue_comments_353710.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7\"><code>749c534</code></a></td><td><code>Upgrade cypari2 to version 1.1.1</code></td></tr></table>\n",
    "created_at": "2017-08-24T12:59:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353710",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7"><code>749c534</code></a></td><td><code>Upgrade cypari2 to version 1.1.1</code></td></tr></table>




---

archive/issue_comments_353711.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@embray](#comment%3A25):\n> I would suggest also adding `errors='surrogateescape'`.  This way if any file happens to contain non-ASCII characters that were written using any encoding other than UTF-8, it will at least handle the ASCII parts correctly and not blow up with a `UnicodeDecodeError`.\n\nThis is not applicable here. In this case, we *know* that all the files we deal with are UTF-8. The input files come from the PARI documentation which is written in UTF-8. And the output files contain auto-generated Cython code which has a `# -*- coding: utf-8 -*-` header.",
    "created_at": "2017-08-24T13:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353711",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@embray](#comment%3A25):
> I would suggest also adding `errors='surrogateescape'`.  This way if any file happens to contain non-ASCII characters that were written using any encoding other than UTF-8, it will at least handle the ASCII parts correctly and not blow up with a `UnicodeDecodeError`.

This is not applicable here. In this case, we *know* that all the files we deal with are UTF-8. The input files come from the PARI documentation which is written in UTF-8. And the output files contain auto-generated Cython code which has a `# -*- coding: utf-8 -*-` header.



---

archive/issue_events_324424.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-24T13:07:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324424"
}
```



---

archive/issue_events_324425.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-08-24T13:07:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324425"
}
```



---

archive/issue_comments_353712.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThis version builds and passes its testsuite. I did not yet run Sage doctests.",
    "created_at": "2017-08-24T13:07:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353712",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

This version builds and passes its testsuite. I did not yet run Sage doctests.



---

archive/issue_comments_353713.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nThat's good, that makes it easy then.",
    "created_at": "2017-08-24T13:08:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353713",
    "user": "https://github.com/embray"
}
```

<div id="comment:29" align="right">comment:29</div>

That's good, that makes it easy then.



---

archive/issue_comments_353714.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nSide comment: the `# -*- coding: utf-8 -*-` header doesn't actually matter since Cython supports [PEP 3120](https://www.python.org/dev/peps/pep-3120/).",
    "created_at": "2017-08-24T13:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353714",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Side comment: the `# -*- coding: utf-8 -*-` header doesn't actually matter since Cython supports [PEP 3120](https://www.python.org/dev/peps/pep-3120/).



---

archive/issue_comments_353715.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nnot yet smooth for python3:\n\n```\n[cypari-1.1.1]     Running setup.py install for cypari2: finished with status 'done'\n[cypari-1.1.1]   Removing source in /tmp/pip-qsn9psry-build\n[cypari-1.1.1] Successfully installed cypari2-1.1.1\n[cypari-1.1.1] Cleaning up...\n[cypari-1.1.1] \n[cypari-1.1.1] real\t3m51.177s\n[cypari-1.1.1] user\t3m42.104s\n[cypari-1.1.1] sys\t0m5.896s\n[cypari-1.1.1] Successfully installed cypari-1.1.1\n[cypari-1.1.1] Running the test suite for cypari-1.1.1...\n[cypari-1.1.1] make[2]: Entering directory '/home/chapoton/sage3/local/var/tmp/sage/build/cypari-1.1.1/src'\n[cypari-1.1.1] python tests/rundoctest.py\n[cypari-1.1.1] Traceback (most recent call last):\n[cypari-1.1.1]   File \"tests/rundoctest.py\", line 15, in <module>\n[cypari-1.1.1]     cypari2.string_utils.encoding = \"utf-8\"\n[cypari-1.1.1] AttributeError: 'module' object has no attribute 'string_utils'\n[cypari-1.1.1] Makefile:16: recipe for target 'check' failed\n[cypari-1.1.1] make[2]: *** [check] Error 1\n[cypari-1.1.1] make[2]: Leaving directory '/home/chapoton/sage3/local/var/tmp/sage/build/cypari-1.1.1/src'\n[cypari-1.1.1] \n[cypari-1.1.1] real\t0m0.346s\n[cypari-1.1.1] user\t0m0.120s\n[cypari-1.1.1] sys\t0m0.012s\n[cypari-1.1.1] ************************************************************************\n```",
    "created_at": "2017-08-24T13:39:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353715",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:31" align="right">comment:31</div>

not yet smooth for python3:

```
[cypari-1.1.1]     Running setup.py install for cypari2: finished with status 'done'
[cypari-1.1.1]   Removing source in /tmp/pip-qsn9psry-build
[cypari-1.1.1] Successfully installed cypari2-1.1.1
[cypari-1.1.1] Cleaning up...
[cypari-1.1.1] 
[cypari-1.1.1] real	3m51.177s
[cypari-1.1.1] user	3m42.104s
[cypari-1.1.1] sys	0m5.896s
[cypari-1.1.1] Successfully installed cypari-1.1.1
[cypari-1.1.1] Running the test suite for cypari-1.1.1...
[cypari-1.1.1] make[2]: Entering directory '/home/chapoton/sage3/local/var/tmp/sage/build/cypari-1.1.1/src'
[cypari-1.1.1] python tests/rundoctest.py
[cypari-1.1.1] Traceback (most recent call last):
[cypari-1.1.1]   File "tests/rundoctest.py", line 15, in <module>
[cypari-1.1.1]     cypari2.string_utils.encoding = "utf-8"
[cypari-1.1.1] AttributeError: 'module' object has no attribute 'string_utils'
[cypari-1.1.1] Makefile:16: recipe for target 'check' failed
[cypari-1.1.1] make[2]: *** [check] Error 1
[cypari-1.1.1] make[2]: Leaving directory '/home/chapoton/sage3/local/var/tmp/sage/build/cypari-1.1.1/src'
[cypari-1.1.1] 
[cypari-1.1.1] real	0m0.346s
[cypari-1.1.1] user	0m0.120s
[cypari-1.1.1] sys	0m0.012s
[cypari-1.1.1] ************************************************************************
```



---

archive/issue_comments_353716.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nSigh... but Python 3 works fine outside of Sage in Travis CI, running the same commands (`pip install .` and `make check`).",
    "created_at": "2017-08-24T13:53:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353716",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">comment:32</div>

Sigh... but Python 3 works fine outside of Sage in Travis CI, running the same commands (`pip install .` and `make check`).



---

archive/issue_comments_353717.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nWell, I am using \"export SAGE_PYTHON3=yes\", pull the branch here and \"sage -c -f cypari\" (in a dedicated sage install for py3 experimental work)\n\nMaybe it is because the python3 general setup is not firmly in place..",
    "created_at": "2017-08-24T14:16:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353717",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:33" align="right">comment:33</div>

Well, I am using "export SAGE_PYTHON3=yes", pull the branch here and "sage -c -f cypari" (in a dedicated sage install for py3 experimental work)

Maybe it is because the python3 general setup is not firmly in place..



---

archive/issue_comments_353718.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nDoctests pass (on Python 2).\n\nI don't understand why this fails with `SAGE_PYTHON3=yes`, especially given that the error seems to be not specific to Python 3 and given that it works with Python 3 outside of Sage. Maybe there is simply a problem with the particular setup of chapoton.\n\nIn any case, I suggest that this should not be a blocker for merging this ticket. It doesn't make the Python 3 situation any worse than before and it helps people who need to update `cypari2` for other reasons.",
    "created_at": "2017-08-24T15:33:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353718",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Doctests pass (on Python 2).

I don't understand why this fails with `SAGE_PYTHON3=yes`, especially given that the error seems to be not specific to Python 3 and given that it works with Python 3 outside of Sage. Maybe there is simply a problem with the particular setup of chapoton.

In any case, I suggest that this should not be a blocker for merging this ticket. It doesn't make the Python 3 situation any worse than before and it helps people who need to update `cypari2` for other reasons.



---

archive/issue_comments_353719.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nok, ok. But still, if somebody could try to reproduce that error that I find..\n\nEDIT: I do not have a particular setup, I think.",
    "created_at": "2017-08-24T15:35:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353719",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:35" align="right">comment:35</div>

ok, ok. But still, if somebody could try to reproduce that error that I find..

EDIT: I do not have a particular setup, I think.



---

archive/issue_comments_353720.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nI'll have a look at the Python 3 issue. I agree with Jeroen it needn't hold up this issue but I can try to investigate ASAP (I need to do a `SAGE_PYTHON3=yes` build anyways to help with other issues on that).",
    "created_at": "2017-08-24T16:17:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353720",
    "user": "https://github.com/embray"
}
```

<div id="comment:36" align="right">comment:36</div>

I'll have a look at the Python 3 issue. I agree with Jeroen it needn't hold up this issue but I can try to investigate ASAP (I need to do a `SAGE_PYTHON3=yes` build anyways to help with other issues on that).



---

archive/issue_events_324426.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-29T12:09:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324426"
}
```



---

archive/issue_events_324427.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-29T12:09:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324427"
}
```



---

archive/issue_comments_353721.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nok, let this go in. We will see later what to do for tests to pass in python3.",
    "created_at": "2017-08-29T12:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353721",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:37" align="right">comment:37</div>

ok, let this go in. We will see later what to do for tests to pass in python3.



---

archive/issue_comments_353722.json:
```json
{
    "body": "Reviewer: **Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2017-08-29T12:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353722",
    "user": "https://github.com/fchapoton"
}
```

Reviewer: **Frédéric Chapoton**



---

archive/issue_comments_353723.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/upgrade_cypari2_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/upgrade_cypari2_package)** to **[`749c534`](https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7)**",
    "created_at": "2017-09-02T09:34:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353723",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/upgrade_cypari2_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/upgrade_cypari2_package)** to **[`749c534`](https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7)**



---

archive/issue_events_324428.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-02T09:34:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324428"
}
```



---

archive/issue_events_324429.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "dd8e80602920cd69d2c8aae2000008b21ab1b486",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-09-02T09:34:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23518#event-324429"
}
```



---

archive/issue_comments_353724.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nAny news from the `PYTHON3` front?",
    "created_at": "2017-09-05T13:54:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353724",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

Any news from the `PYTHON3` front?



---

archive/issue_comments_353725.json:
```json
{
    "body": "Changed commit from **[`749c534`](https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7)** to none",
    "created_at": "2017-09-05T13:54:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353725",
    "user": "https://github.com/jdemeyer"
}
```

Changed commit from **[`749c534`](https://github.com/sagemath/sagetrac-mirror/commit/749c534e8fd56f3ec32c29d2b8422292cefff5f7)** to none



---

archive/issue_comments_353726.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nNot an answer on the cypari2 relation to python3..\n\nWell, this ticket fixes the issue that I had. One of the first blocking point for PYTHON3 is now the division problem in #22875. If you feel like handling this one, it would be great, because I do not understand exactly what you ask for there.\n\nAnd #23785 would be helpful too.",
    "created_at": "2017-09-05T13:59:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23518",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23518#issuecomment-353726",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:40" align="right">comment:40</div>

Not an answer on the cypari2 relation to python3..

Well, this ticket fixes the issue that I had. One of the first blocking point for PYTHON3 is now the division problem in #22875. If you feel like handling this one, it would be great, because I do not understand exactly what you ask for there.

And #23785 would be helpful too.
