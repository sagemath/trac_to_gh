# Issue 23665: Implement Frobenius formula for Hecke algebra characters

archive/issues_023428.json:
```json
{
    "body": "This implements the basis qbar (as denoted by Ram-Remmel) for the ring of symmetric functions, which are q-deformations of the powersums. The character table for the Hecke algebra (with quadratic relation T<sup>2</sup> = (q-1)T + q) is obtained as the transition matrix from qbar to Schurs.\n\n**CC:**  sage-combinat @nthiery @darijgr @saliola @zabrocki @AndrewAtLarge\n\n**Keywords:** Hecke algebra, characters, days88\n\n**Branch/Commit:** [a08daf89ee19d842a06cd464f5fc272a3b1ed14c](https://github.com/sagemath/sagetrac-mirror/commit/a08daf89ee19d842a06cd464f5fc272a3b1ed14c)\n\n**Reviewer:** Mike Zabrocki\n\n**Author:** Travis Scrimshaw\n\nIssue created by migration from https://trac.sagemath.org/ticket/23665\n\n",
    "closed_at": "2018-05-08T17:26:23Z",
    "created_at": "2017-08-21T15:13:03Z",
    "labels": [
        "component: combinatorics",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.2",
    "title": "Implement Frobenius formula for Hecke algebra characters",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/23665",
    "user": "https://github.com/tscrim"
}
```
This implements the basis qbar (as denoted by Ram-Remmel) for the ring of symmetric functions, which are q-deformations of the powersums. The character table for the Hecke algebra (with quadratic relation T<sup>2</sup> = (q-1)T + q) is obtained as the transition matrix from qbar to Schurs.

**CC:**  sage-combinat @nthiery @darijgr @saliola @zabrocki @AndrewAtLarge

**Keywords:** Hecke algebra, characters, days88

**Branch/Commit:** [a08daf89ee19d842a06cd464f5fc272a3b1ed14c](https://github.com/sagemath/sagetrac-mirror/commit/a08daf89ee19d842a06cd464f5fc272a3b1ed14c)

**Reviewer:** Mike Zabrocki

**Author:** Travis Scrimshaw

Issue created by migration from https://trac.sagemath.org/ticket/23665





---

archive/issue_events_210494.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-08-21T15:15:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210494"
}
```



---

archive/issue_comments_358756.json:
```json
{
    "body": "<a id='comment:1'></a>\nI called the new basis \"Hecke algebra characters,\" but that is not quite right. However, I am not sure what a better name would be. Any thoughts?\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e84c702c2d8909f635953c1b47107c6083228b4\">8e84c70</a></td><td><code>Implementation of basis for Hecke algebra characters.</code></td></tr></table>\n",
    "created_at": "2017-08-21T15:15:55Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358756",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
I called the new basis "Hecke algebra characters," but that is not quite right. However, I am not sure what a better name would be. Any thoughts?

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e84c702c2d8909f635953c1b47107c6083228b4">8e84c70</a></td><td><code>Implementation of basis for Hecke algebra characters.</code></td></tr></table>




---

archive/issue_comments_358757.json:
```json
{
    "body": "**Branch:** [public/algebras/sym_hecke_basis-23665](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/sym_hecke_basis-23665)",
    "created_at": "2017-08-21T15:15:55Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358757",
    "user": "https://github.com/tscrim"
}
```

**Branch:** [public/algebras/sym_hecke_basis-23665](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/sym_hecke_basis-23665)



---

archive/issue_comments_358758.json:
```json
{
    "body": "**Commit:** [8e84c702c2d8909f635953c1b47107c6083228b4](https://github.com/sagemath/sagetrac-mirror/commit/8e84c702c2d8909f635953c1b47107c6083228b4)",
    "created_at": "2017-08-21T15:15:55Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358758",
    "user": "https://github.com/tscrim"
}
```

**Commit:** [8e84c702c2d8909f635953c1b47107c6083228b4](https://github.com/sagemath/sagetrac-mirror/commit/8e84c702c2d8909f635953c1b47107c6083228b4)



---

archive/issue_comments_358759.json:
```json
{
    "body": "<a id='comment:2'></a>\nIts kind of hard to pick a better name from the Ram-Remmel paper.  I think it is the character of a (H_n(q),Gl_n) bi-module so the `hecke_character` basis is not necessarily a bad name, but that means you should be as verbose as possible with the documentation because I don't think that you are going to capture what basis represents in a short name.  I do think that the documentation should include equation (37) from the Remmel-Ram paper.\n\nTry setting `q=-1` (or another root of unity not equal to 1).  It has a bit of a problem there.  There might be some speed-ups you can do over your current implementation because it is (up to constant) a plethysm of the complete basis, but its tough to implement that way if we have to be careful of the root of unity.  I'll try a few things and see if I can come up with something that avoids this problem, but it may not be a basis at a root of unity.",
    "created_at": "2017-08-21T23:39:26Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358759",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:2'></a>
Its kind of hard to pick a better name from the Ram-Remmel paper.  I think it is the character of a (H_n(q),Gl_n) bi-module so the `hecke_character` basis is not necessarily a bad name, but that means you should be as verbose as possible with the documentation because I don't think that you are going to capture what basis represents in a short name.  I do think that the documentation should include equation (37) from the Remmel-Ram paper.

Try setting `q=-1` (or another root of unity not equal to 1).  It has a bit of a problem there.  There might be some speed-ups you can do over your current implementation because it is (up to constant) a plethysm of the complete basis, but its tough to implement that way if we have to be careful of the root of unity.  I'll try a few things and see if I can come up with something that avoids this problem, but it may not be a basis at a root of unity.



---

archive/issue_comments_358760.json:
```json
{
    "body": "<a id='comment:3'></a>\nYour conjectured formula for the coproduct is correct and can be derived from plethystic manipulation and equation (37) of Ram-Remmel (i.e. you can remove the warning).\n\n```\nqbar_n(X+Y) = h_n((X+Y)(1-1/q))q^n/(q-1) \n= \\sum_{r=0}^n h_r(X(1-1/q)) h_{n-r}(Y(1-1/q)) q^n/(q-1) \n= \\sum_{r=1}^{n-1} q^r h_r(X(1-1/q)) q^{n-r}/(q-1) h_{n-r}(Y(1-1/q))\n   + h_n(X(1-1/q))q^n/(q-1) + h_n(Y(1-1/q))q^n/(q-1)\n= \\sum_{r=1}^{n-1} (q-1) qbar_r(X) qbar_{n-r}(Y) + qbar_n(X) + qbar_n(Y)\n```",
    "created_at": "2017-08-22T00:50:59Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358760",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:3'></a>
Your conjectured formula for the coproduct is correct and can be derived from plethystic manipulation and equation (37) of Ram-Remmel (i.e. you can remove the warning).

```
qbar_n(X+Y) = h_n((X+Y)(1-1/q))q^n/(q-1) 
= \sum_{r=0}^n h_r(X(1-1/q)) h_{n-r}(Y(1-1/q)) q^n/(q-1) 
= \sum_{r=1}^{n-1} q^r h_r(X(1-1/q)) q^{n-r}/(q-1) h_{n-r}(Y(1-1/q))
   + h_n(X(1-1/q))q^n/(q-1) + h_n(Y(1-1/q))q^n/(q-1)
= \sum_{r=1}^{n-1} (q-1) qbar_r(X) qbar_{n-r}(Y) + qbar_n(X) + qbar_n(Y)
```



---

archive/issue_comments_358761.json:
```json
{
    "body": "<a id='comment:4'></a>\nSounds like a nice addition.\n\nJust a suggestion: what about parametrizing the basis by the two roots  q1, q2 of the quadratic relation (with q2=-1 as default)? This would be consistent with what we did with the non symmetric macdonald polynomials and the `IwahoriHeckeAlgebra`.\n\nCheers,",
    "created_at": "2017-08-22T17:03:49Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358761",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:4'></a>
Sounds like a nice addition.

Just a suggestion: what about parametrizing the basis by the two roots  q1, q2 of the quadratic relation (with q2=-1 as default)? This would be consistent with what we did with the non symmetric macdonald polynomials and the `IwahoriHeckeAlgebra`.

Cheers,



---

archive/issue_comments_358762.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've looked more closely and this set of functions is not a basis for q a root of unity, but rather than preventing the user from entering a root of unity you might want to have them act like the Hall-Littlewood Q basis at a root of unity. In fact, at q=-1 they span the same space of QQ[p_1, p_3, p_5, ...] = the space of Schur's Q functions.\nI think that the most natural way of handling this will be to transform p_r -> qbar_\\mu by the following relation:\n\n```\n(q^r-1)p_r = r*qbar_r - \\sum_{i=1}^{r-1} (q-1)(q^i-1) p_i*qbar_{r-i}\n```\n\nTo implement Nicolas' suggestion we would have to work out the Frobenius formula from the quadratic relation.",
    "created_at": "2017-08-22T17:22:47Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358762",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:5'></a>
I've looked more closely and this set of functions is not a basis for q a root of unity, but rather than preventing the user from entering a root of unity you might want to have them act like the Hall-Littlewood Q basis at a root of unity. In fact, at q=-1 they span the same space of QQ[p_1, p_3, p_5, ...] = the space of Schur's Q functions.
I think that the most natural way of handling this will be to transform p_r -> qbar_\mu by the following relation:

```
(q^r-1)p_r = r*qbar_r - \sum_{i=1}^{r-1} (q-1)(q^i-1) p_i*qbar_{r-i}
```

To implement Nicolas' suggestion we would have to work out the Frobenius formula from the quadratic relation.



---

archive/issue_comments_358763.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [zabrocki](#comment%3A2):\n> Its kind of hard to pick a better name from the Ram-Remmel paper.  I think it is the character of a (H_n(q),Gl_n) bi-module so the `hecke_character` basis is not necessarily a bad name, but that means you should be as verbose as possible with the documentation because I don't think that you are going to capture what basis represents in a short name.  I do think that the documentation should include equation (37) from the Remmel-Ram paper.\n\n\nAnother name that is a little less descriptive but a little more accurate (IMO) would be \"deformed powersum.\" However, I am not convinced that this would be a better name as it is somewhat generic.\n\n> Try setting `q=-1` (or another root of unity not equal to 1).  It has a bit of a problem there.  There might be some speed-ups you can do over your current implementation because it is (up to constant) a plethysm of the complete basis, but its tough to implement that way if we have to be careful of the root of unity.  I'll try a few things and see if I can come up with something that avoids this problem, but it may not be a basis at a root of unity.\n\n\nWe might just want to let it fail with a warning in the documentation about certain values of q are bad (which is a theoretical issue because the Hecke algebra fails to be semisimple).\n\ncomment:3 Good to know. I will fix that on the next round of changes.",
    "created_at": "2017-08-22T19:15:53Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358763",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:6'></a>
Replying to [zabrocki](#comment%3A2):
> Its kind of hard to pick a better name from the Ram-Remmel paper.  I think it is the character of a (H_n(q),Gl_n) bi-module so the `hecke_character` basis is not necessarily a bad name, but that means you should be as verbose as possible with the documentation because I don't think that you are going to capture what basis represents in a short name.  I do think that the documentation should include equation (37) from the Remmel-Ram paper.


Another name that is a little less descriptive but a little more accurate (IMO) would be "deformed powersum." However, I am not convinced that this would be a better name as it is somewhat generic.

> Try setting `q=-1` (or another root of unity not equal to 1).  It has a bit of a problem there.  There might be some speed-ups you can do over your current implementation because it is (up to constant) a plethysm of the complete basis, but its tough to implement that way if we have to be careful of the root of unity.  I'll try a few things and see if I can come up with something that avoids this problem, but it may not be a basis at a root of unity.


We might just want to let it fail with a warning in the documentation about certain values of q are bad (which is a theoretical issue because the Hecke algebra fails to be semisimple).

comment:3 Good to know. I will fix that on the next round of changes.



---

archive/issue_comments_358764.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [zabrocki](#comment%3A5):\n> I've looked more closely and this set of functions is not a basis for q a root of unity, but rather than preventing the user from entering a root of unity you might want to have them act like the Hall-Littlewood Q basis at a root of unity. In fact, at q=-1 they span the same space of QQ[p_1, p_3, p_5, ...] = the space of Schur's Q functions.\n\n\nSo basically do the generic computation and then substitute in. I had thought about that, but I wasn't sure if we wanted it because I wasn't sure if it would still form a basis at these special cases.\n\n> I think that the most natural way of handling this will be to transform p_r -> qbar_\\mu by the following relation:\n> \n> ```\n> (q^r-1)p_r = r*qbar_r - \\sum_{i=1}^{r-1} (q-1)(q^i-1) p_i*qbar_{r-i}\n> ```\n\n\nDo you think I should add that as an explicit transition morphism as well?\n\n> To implement Nicolas' suggestion we would have to work out the Frobenius formula from the quadratic relation.\n\n\nThat was my thought as well. Andrew, do you by chance know or have a thought about this?",
    "created_at": "2017-08-22T19:23:13Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358764",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
Replying to [zabrocki](#comment%3A5):
> I've looked more closely and this set of functions is not a basis for q a root of unity, but rather than preventing the user from entering a root of unity you might want to have them act like the Hall-Littlewood Q basis at a root of unity. In fact, at q=-1 they span the same space of QQ[p_1, p_3, p_5, ...] = the space of Schur's Q functions.


So basically do the generic computation and then substitute in. I had thought about that, but I wasn't sure if we wanted it because I wasn't sure if it would still form a basis at these special cases.

> I think that the most natural way of handling this will be to transform p_r -> qbar_\mu by the following relation:
> 
> ```
> (q^r-1)p_r = r*qbar_r - \sum_{i=1}^{r-1} (q-1)(q^i-1) p_i*qbar_{r-i}
> ```


Do you think I should add that as an explicit transition morphism as well?

> To implement Nicolas' suggestion we would have to work out the Frobenius formula from the quadratic relation.


That was my thought as well. Andrew, do you by chance know or have a thought about this?



---

archive/issue_comments_358765.json:
```json
{
    "body": "<a id='comment:8'></a>\n> So basically do the generic computation and then substitute in. I had thought about that, but I wasn't sure if we wanted it because I wasn't sure if it would still form a basis at these special cases.\n\n\nWell, I think that the generic computation and then specialized is one way of doing it, but maybe not the best.\n\n> > I think that the most natural way of handling this will be to transform p_r -> qbar_\\mu by the following relation:\n> > \n> > ```\n> > (q^r-1)p_r = r*qbar_r - \\sum_{i=1}^{r-1} (q-1)(q^i-1) p_i*qbar_{r-i}\n> > ```\n\n> \n> Do you think I should add that as an explicit transition morphism as well?\n\nI think if this transition is implemented (instead of inverting the morphism through the Schur basis) the transition to and from classical bases won't choke unless you start with something that is not in the space.  This is because if `q` is an r'th root of unity then `p_r` is not in the algebra generated by the `qbar_d` but then the coefficient of `p_r` is equal to 0 in all expressions where it appears (so there should be no intermediate steps in going from `p` to `qbar` where you need to divide by 0).\n\nSage doesn't handle roots of unity very well, but the case when `q=-1` is a well studied space.  The Hall-Littlewood Q-basis specializes to Schur's Q functions.  This is is not well documented in Sage but if you want to work with Schur's Q-functions, you also might want to use this `hecke_character` basis for the same reason.",
    "created_at": "2017-08-22T19:46:40Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358765",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:8'></a>
> So basically do the generic computation and then substitute in. I had thought about that, but I wasn't sure if we wanted it because I wasn't sure if it would still form a basis at these special cases.


Well, I think that the generic computation and then specialized is one way of doing it, but maybe not the best.

> > I think that the most natural way of handling this will be to transform p_r -> qbar_\mu by the following relation:
> > 
> > ```
> > (q^r-1)p_r = r*qbar_r - \sum_{i=1}^{r-1} (q-1)(q^i-1) p_i*qbar_{r-i}
> > ```

> 
> Do you think I should add that as an explicit transition morphism as well?

I think if this transition is implemented (instead of inverting the morphism through the Schur basis) the transition to and from classical bases won't choke unless you start with something that is not in the space.  This is because if `q` is an r'th root of unity then `p_r` is not in the algebra generated by the `qbar_d` but then the coefficient of `p_r` is equal to 0 in all expressions where it appears (so there should be no intermediate steps in going from `p` to `qbar` where you need to divide by 0).

Sage doesn't handle roots of unity very well, but the case when `q=-1` is a well studied space.  The Hall-Littlewood Q-basis specializes to Schur's Q functions.  This is is not well documented in Sage but if you want to work with Schur's Q-functions, you also might want to use this `hecke_character` basis for the same reason.



---

archive/issue_comments_358766.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [zabrocki](#comment%3A8):\n> \n> > So basically do the generic computation and then substitute in. I had thought about that, but I wasn't sure if we wanted it because I wasn't sure if it would still form a basis at these special cases.\n\n> \n> Well, I think that the generic computation and then specialized is one way of doing it, but maybe not the best.\n> \n> > > I think that the most natural way of handling this will be to transform p_r -> qbar_\\mu by the following relation:\n> > > \n> > > ```\n> > > (q^r-1)p_r = r*qbar_r - \\sum_{i=1}^{r-1} (q-1)(q^i-1) p_i*qbar_{r-i}\n> > > ```\n\n> > \n> > Do you think I should add that as an explicit transition morphism as well?\n\n> I think if this transition is implemented (instead of inverting the morphism through the Schur basis) the transition to and from classical bases won't choke unless you start with something that is not in the space.  This is because if `q` is an r'th root of unity then `p_r` is not in the algebra generated by the `qbar_d` but then the coefficient of `p_r` is equal to 0 in all expressions where it appears (so there should be no intermediate steps in going from `p` to `qbar` where you need to divide by 0).\n\nSo maybe we do the generic and then specialize for the to/from Schur functions. Then to/from powersums, we use the formula recursively you give above. How does that sound?",
    "created_at": "2017-08-22T19:53:31Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358766",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:9'></a>
Replying to [zabrocki](#comment%3A8):
> 
> > So basically do the generic computation and then substitute in. I had thought about that, but I wasn't sure if we wanted it because I wasn't sure if it would still form a basis at these special cases.

> 
> Well, I think that the generic computation and then specialized is one way of doing it, but maybe not the best.
> 
> > > I think that the most natural way of handling this will be to transform p_r -> qbar_\mu by the following relation:
> > > 
> > > ```
> > > (q^r-1)p_r = r*qbar_r - \sum_{i=1}^{r-1} (q-1)(q^i-1) p_i*qbar_{r-i}
> > > ```

> > 
> > Do you think I should add that as an explicit transition morphism as well?

> I think if this transition is implemented (instead of inverting the morphism through the Schur basis) the transition to and from classical bases won't choke unless you start with something that is not in the space.  This is because if `q` is an r'th root of unity then `p_r` is not in the algebra generated by the `qbar_d` but then the coefficient of `p_r` is equal to 0 in all expressions where it appears (so there should be no intermediate steps in going from `p` to `qbar` where you need to divide by 0).

So maybe we do the generic and then specialize for the to/from Schur functions. Then to/from powersums, we use the formula recursively you give above. How does that sound?



---

archive/issue_comments_358767.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [tscrim](#comment%3A7):\n> > To implement Nicolas' suggestion we would have to work out the Frobenius formula from the quadratic relation.\n\n> \n> That was my thought as well. Andrew, do you by chance know or have a thought about this?\n\n\nIn my experience with NS macdo, the formulas for q1,q2 are usually\nfairly straightforward to reverse engineer when you have the formulas\nfor one of the specializations (typically by doing some rescaling of\nthe T operators). But your mileage may vary.",
    "created_at": "2017-08-22T20:00:12Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358767",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:10'></a>
Replying to [tscrim](#comment%3A7):
> > To implement Nicolas' suggestion we would have to work out the Frobenius formula from the quadratic relation.

> 
> That was my thought as well. Andrew, do you by chance know or have a thought about this?


In my experience with NS macdo, the formulas for q1,q2 are usually
fairly straightforward to reverse engineer when you have the formulas
for one of the specializations (typically by doing some rescaling of
the T operators). But your mileage may vary.



---

archive/issue_comments_358768.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [tscrim](#comment%3A9):\n> So maybe we do the generic and then specialize for the to/from Schur functions. Then to/from powersums, we use the formula recursively you give above. How does that sound?\n\n\nIt may take a bit of experimenting to see what is fastest, but it might be that `s->p->qbar` without the generic `q` implementation is faster because inverting a matrix can be slow (and this one isn't triangular) while the `p` and `qbar` are multiplicative bases.",
    "created_at": "2017-08-22T20:33:13Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358768",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:11'></a>
Replying to [tscrim](#comment%3A9):
> So maybe we do the generic and then specialize for the to/from Schur functions. Then to/from powersums, we use the formula recursively you give above. How does that sound?


It may take a bit of experimenting to see what is fastest, but it might be that `s->p->qbar` without the generic `q` implementation is faster because inverting a matrix can be slow (and this one isn't triangular) while the `p` and `qbar` are multiplicative bases.



---

archive/issue_comments_358769.json:
```json
{
    "body": "<a id='comment:12'></a>\nI implemented the change of basis to the power sums because they are both multiplicative.  This is a significant speedup when the degree is large because there is no need to cache the whole change of basis matrix.\n\nThis basis does not play nice at roots of unity, so we can't really prevent users from raising errors if q is a root of unity, but my calculations do try to avoid raising errors by doing a few checks before dividing by something that might be 0.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f6eb1ca0eea8da550ad882741fb07a9759959594\">f6eb1ca</a></td><td><code>Merge branch 'public/algebras/sym_hecke_basis-23665' of trac.sagemath.org:sage into public/heckecharacter</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/92e78148819e549487db0afb2c85b3654535948d\">92e7814</a></td><td><code>intermediate work to transition to the power basis from the hecke character</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6109d7310be7c034f32abc78230a662c73735a0\">e6109d7</a></td><td><code>delete Schur <-> qbar conversion and use only the power sum</code></td></tr></table>\n",
    "created_at": "2018-04-10T19:03:24Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358769",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:12'></a>
I implemented the change of basis to the power sums because they are both multiplicative.  This is a significant speedup when the degree is large because there is no need to cache the whole change of basis matrix.

This basis does not play nice at roots of unity, so we can't really prevent users from raising errors if q is a root of unity, but my calculations do try to avoid raising errors by doing a few checks before dividing by something that might be 0.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f6eb1ca0eea8da550ad882741fb07a9759959594">f6eb1ca</a></td><td><code>Merge branch 'public/algebras/sym_hecke_basis-23665' of trac.sagemath.org:sage into public/heckecharacter</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/92e78148819e549487db0afb2c85b3654535948d">92e7814</a></td><td><code>intermediate work to transition to the power basis from the hecke character</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6109d7310be7c034f32abc78230a662c73735a0">e6109d7</a></td><td><code>delete Schur <-> qbar conversion and use only the power sum</code></td></tr></table>




---

archive/issue_comments_358770.json:
```json
{
    "body": "**Changing branch** from \"[public/algebras/sym_hecke_basis-23665](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/sym_hecke_basis-23665)\" to \"[public/heckecharacter](https://github.com/sagemath/sagetrac-mirror/tree/public/heckecharacter)\".",
    "created_at": "2018-04-10T19:03:24Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358770",
    "user": "https://github.com/zabrocki"
}
```

**Changing branch** from "[public/algebras/sym_hecke_basis-23665](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/sym_hecke_basis-23665)" to "[public/heckecharacter](https://github.com/sagemath/sagetrac-mirror/tree/public/heckecharacter)".



---

archive/issue_comments_358771.json:
```json
{
    "body": "**Changing commit** from \"[8e84c702c2d8909f635953c1b47107c6083228b4](https://github.com/sagemath/sagetrac-mirror/commit/8e84c702c2d8909f635953c1b47107c6083228b4)\" to \"[e6109d7310be7c034f32abc78230a662c73735a0](https://github.com/sagemath/sagetrac-mirror/commit/e6109d7310be7c034f32abc78230a662c73735a0)\".",
    "created_at": "2018-04-10T19:03:24Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358771",
    "user": "https://github.com/zabrocki"
}
```

**Changing commit** from "[8e84c702c2d8909f635953c1b47107c6083228b4](https://github.com/sagemath/sagetrac-mirror/commit/8e84c702c2d8909f635953c1b47107c6083228b4)" to "[e6109d7310be7c034f32abc78230a662c73735a0](https://github.com/sagemath/sagetrac-mirror/commit/e6109d7310be7c034f32abc78230a662c73735a0)".



---

archive/issue_events_210495.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-04-10T21:42:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210495"
}
```



---

archive/issue_events_210496.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-04-10T21:42:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210496"
}
```



---

archive/issue_comments_358772.json:
```json
{
    "body": "**Changing branch** from \"[public/heckecharacter](https://github.com/sagemath/sagetrac-mirror/tree/public/heckecharacter)\" to \"[public/algebras/sym_hecke_basis-23665](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/sym_hecke_basis-23665)\".",
    "created_at": "2018-04-10T21:42:03Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358772",
    "user": "https://github.com/tscrim"
}
```

**Changing branch** from "[public/heckecharacter](https://github.com/sagemath/sagetrac-mirror/tree/public/heckecharacter)" to "[public/algebras/sym_hecke_basis-23665](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/sym_hecke_basis-23665)".



---

archive/issue_comments_358773.json:
```json
{
    "body": "**Changing commit** from \"[e6109d7310be7c034f32abc78230a662c73735a0](https://github.com/sagemath/sagetrac-mirror/commit/e6109d7310be7c034f32abc78230a662c73735a0)\" to \"[a4de0fef436177cd4444ba57736ccde41a9caeda](https://github.com/sagemath/sagetrac-mirror/commit/a4de0fef436177cd4444ba57736ccde41a9caeda)\".",
    "created_at": "2018-04-10T21:42:03Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358773",
    "user": "https://github.com/tscrim"
}
```

**Changing commit** from "[e6109d7310be7c034f32abc78230a662c73735a0](https://github.com/sagemath/sagetrac-mirror/commit/e6109d7310be7c034f32abc78230a662c73735a0)" to "[a4de0fef436177cd4444ba57736ccde41a9caeda](https://github.com/sagemath/sagetrac-mirror/commit/a4de0fef436177cd4444ba57736ccde41a9caeda)".



---

archive/issue_events_210497.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-04-10T21:42:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210497"
}
```



---

archive/issue_events_210498.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-04-10T21:42:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210498"
}
```



---

archive/issue_comments_358774.json:
```json
{
    "body": "<a id='comment:13'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4de0fef436177cd4444ba57736ccde41a9caeda\">a4de0fe</a></td><td><code>Moving some tests around and checking against definition from Ram.</code></td></tr></table>\n",
    "created_at": "2018-04-10T21:42:03Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358774",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4de0fef436177cd4444ba57736ccde41a9caeda">a4de0fe</a></td><td><code>Moving some tests around and checking against definition from Ram.</code></td></tr></table>




---

archive/issue_comments_358775.json:
```json
{
    "body": "**Changing commit** from \"[a4de0fef436177cd4444ba57736ccde41a9caeda](https://github.com/sagemath/sagetrac-mirror/commit/a4de0fef436177cd4444ba57736ccde41a9caeda)\" to \"[7535e6b3c9d8b214e1be85fc352f2aef38434d3d](https://github.com/sagemath/sagetrac-mirror/commit/7535e6b3c9d8b214e1be85fc352f2aef38434d3d)\".",
    "created_at": "2018-04-10T21:51:16Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358775",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a4de0fef436177cd4444ba57736ccde41a9caeda](https://github.com/sagemath/sagetrac-mirror/commit/a4de0fef436177cd4444ba57736ccde41a9caeda)" to "[7535e6b3c9d8b214e1be85fc352f2aef38434d3d](https://github.com/sagemath/sagetrac-mirror/commit/7535e6b3c9d8b214e1be85fc352f2aef38434d3d)".



---

archive/issue_comments_358776.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7535e6b3c9d8b214e1be85fc352f2aef38434d3d\">7535e6b</a></td><td><code>Moving some tests around and checking against definition from Ram.</code></td></tr></table>\n",
    "created_at": "2018-04-10T21:51:16Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358776",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7535e6b3c9d8b214e1be85fc352f2aef38434d3d">7535e6b</a></td><td><code>Moving some tests around and checking against definition from Ram.</code></td></tr></table>




---

archive/issue_comments_358777.json:
```json
{
    "body": "**Changing commit** from \"[7535e6b3c9d8b214e1be85fc352f2aef38434d3d](https://github.com/sagemath/sagetrac-mirror/commit/7535e6b3c9d8b214e1be85fc352f2aef38434d3d)\" to \"[a08daf89ee19d842a06cd464f5fc272a3b1ed14c](https://github.com/sagemath/sagetrac-mirror/commit/a08daf89ee19d842a06cd464f5fc272a3b1ed14c)\".",
    "created_at": "2018-04-10T23:07:49Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358777",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[7535e6b3c9d8b214e1be85fc352f2aef38434d3d](https://github.com/sagemath/sagetrac-mirror/commit/7535e6b3c9d8b214e1be85fc352f2aef38434d3d)" to "[a08daf89ee19d842a06cd464f5fc272a3b1ed14c](https://github.com/sagemath/sagetrac-mirror/commit/a08daf89ee19d842a06cd464f5fc272a3b1ed14c)".



---

archive/issue_comments_358778.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a08daf89ee19d842a06cd464f5fc272a3b1ed14c\">a08daf8</a></td><td><code>added MATH:: indicators for the equations</code></td></tr></table>\n",
    "created_at": "2018-04-10T23:07:49Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358778",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a08daf89ee19d842a06cd464f5fc272a3b1ed14c">a08daf8</a></td><td><code>added MATH:: indicators for the equations</code></td></tr></table>




---

archive/issue_events_210499.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2018-04-10T23:12:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210499"
}
```



---

archive/issue_events_210500.json:
```json
{
    "actor": "https://github.com/zabrocki",
    "created_at": "2018-04-10T23:12:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210500"
}
```



---

archive/issue_comments_358779.json:
```json
{
    "body": "**Reviewer:** Mike Zabrocki",
    "created_at": "2018-04-10T23:12:04Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358779",
    "user": "https://github.com/zabrocki"
}
```

**Reviewer:** Mike Zabrocki



---

archive/issue_comments_358780.json:
```json
{
    "body": "<a id='comment:17'></a>\nNote that we did not figure out how to implement a second parameter (as Nicolas suggested in comment 4).  That will have to be left for a future ticket if someone knows the relationship.",
    "created_at": "2018-04-10T23:15:38Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358780",
    "user": "https://github.com/zabrocki"
}
```

<a id='comment:17'></a>
Note that we did not figure out how to implement a second parameter (as Nicolas suggested in comment 4).  That will have to be left for a future ticket if someone knows the relationship.



---

archive/issue_comments_358781.json:
```json
{
    "body": "**Changing branch** from \"[public/algebras/sym_hecke_basis-23665](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/sym_hecke_basis-23665)\" to \"[a08daf89ee19d842a06cd464f5fc272a3b1ed14c](https://github.com/sagemath/sagetrac-mirror/commit/a08daf89ee19d842a06cd464f5fc272a3b1ed14c)\".",
    "created_at": "2018-05-08T17:26:23Z",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23665#issuecomment-358781",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/algebras/sym_hecke_basis-23665](https://github.com/sagemath/sagetrac-mirror/tree/public/algebras/sym_hecke_basis-23665)" to "[a08daf89ee19d842a06cd464f5fc272a3b1ed14c](https://github.com/sagemath/sagetrac-mirror/commit/a08daf89ee19d842a06cd464f5fc272a3b1ed14c)".



---

archive/issue_events_210501.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-05-08T17:26:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210501"
}
```



---

archive/issue_events_210502.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0c9519f6c535c6cf810832d95bb1a5c85cb1d597",
    "created_at": "2018-05-08T17:26:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23665",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23665#event-210502"
}
```
