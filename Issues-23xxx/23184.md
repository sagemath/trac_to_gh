# Issue 23184: Use the right category for DefaultConvertMaps, rather than SetsWithPartialMaps

archive/issues_022947.json:
```json
{
    "body": "Currently, the category for `DefaultConvertMap`s is `SetsWithPartialMaps()`.\n\n```\nsage: type(QQ[['x']].coerce_map_from(QQ))\n<type 'sage.structure.coerce_maps.DefaultConvertMap_unique'>\nsage: QQ[['x']].coerce_map_from(QQ).category_for()\nCategory of sets with partial maps\n```\nIn contrast,\n\n```\nsage: QQ.hom(QQ[['x']]).category_for()\nCategory of euclidean domains\n```\n\nKeywords: sd86.5\n\nReviewer: Julian R\u00fcth, David Roe\n\nAuthor: David Roe, Julian R\u00fcth\n\nBranch: 5eccb5217999af4dc094b8a21d8b00071457c04d\n\nDependencies: #23201\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/23184\n\n",
    "closed_at": "2017-06-12T18:01:40Z",
    "created_at": "2017-06-09T01:02:07Z",
    "labels": [
        "component: coercion"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Use the right category for DefaultConvertMaps, rather than SetsWithPartialMaps",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23184",
    "user": "https://github.com/roed314"
}
```
Currently, the category for `DefaultConvertMap`s is `SetsWithPartialMaps()`.

```
sage: type(QQ[['x']].coerce_map_from(QQ))
<type 'sage.structure.coerce_maps.DefaultConvertMap_unique'>
sage: QQ[['x']].coerce_map_from(QQ).category_for()
Category of sets with partial maps
```
In contrast,

```
sage: QQ.hom(QQ[['x']]).category_for()
Category of euclidean domains
```

Keywords: sd86.5

Reviewer: Julian Rüth, David Roe

Author: David Roe, Julian Rüth

Branch: 5eccb5217999af4dc094b8a21d8b00071457c04d

Dependencies: #23201

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/23184





---

archive/issue_comments_320689.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd86.5\".",
    "created_at": "2017-06-09T17:02:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320689",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "" to "sd86.5".



---

archive/issue_comments_320690.json:
```json
{
    "body": "<a id='comment:2'></a>Please make sure that you only refine the category when this makes mathematical sense.  In #15618, I  implemented taking `SetsWithPartialMaps` as the default category for a `DefaultConvertMap` because in general such a map is not defined everywhere, nor is it always a morphism in the category where the parents live.",
    "created_at": "2017-06-09T18:47:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320690",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:2'></a>Please make sure that you only refine the category when this makes mathematical sense.  In #15618, I  implemented taking `SetsWithPartialMaps` as the default category for a `DefaultConvertMap` because in general such a map is not defined everywhere, nor is it always a morphism in the category where the parents live.



---

archive/issue_comments_320691.json:
```json
{
    "body": "<a id='comment:3'></a>I guess this should be fixed in `PowerSeries_generic._coerce_map_from_()` by returning a specific map instead of `True`.",
    "created_at": "2017-06-09T19:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320691",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:3'></a>I guess this should be fixed in `PowerSeries_generic._coerce_map_from_()` by returning a specific map instead of `True`.



---

archive/issue_comments_320692.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:2 pbruin]:\n> Please make sure that you only refine the category when this makes mathematical sense.  In #15618, I  implemented taking `SetsWithPartialMaps` as the default category for a `DefaultConvertMap` because in general such a map is not defined everywhere, nor is it always a morphism in the category where the parents live.\n\n\nMy plan is to only change the category for coercions, not conversions.  I can't think of any examples where coercions aren't morphisms in the meet of the categories of the parents involved.  All of the examples I see in #15618 are conversions, which this ticket won't affect.",
    "created_at": "2017-06-09T20:14:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320692",
    "user": "https://github.com/roed314"
}
```

<a id='comment:4'></a>Replying to [comment:2 pbruin]:
> Please make sure that you only refine the category when this makes mathematical sense.  In #15618, I  implemented taking `SetsWithPartialMaps` as the default category for a `DefaultConvertMap` because in general such a map is not defined everywhere, nor is it always a morphism in the category where the parents live.


My plan is to only change the category for coercions, not conversions.  I can't think of any examples where coercions aren't morphisms in the meet of the categories of the parents involved.  All of the examples I see in #15618 are conversions, which this ticket won't affect.



---

archive/issue_comments_320693.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:3 pbruin]:\n> I guess this should be fixed in `PowerSeries_generic._coerce_map_from_()` by returning a specific map instead of `True`.\n\n\nYou could fix it in this way, but that's a lot of work that would need to be duplicated over and over again for different examples of `DefaultConvertMap`s.",
    "created_at": "2017-06-09T20:15:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320693",
    "user": "https://github.com/roed314"
}
```

<a id='comment:5'></a>Replying to [comment:3 pbruin]:
> I guess this should be fixed in `PowerSeries_generic._coerce_map_from_()` by returning a specific map instead of `True`.


You could fix it in this way, but that's a lot of work that would need to be duplicated over and over again for different examples of `DefaultConvertMap`s.



---

archive/issue_comments_320694.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-10T16:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320694",
    "user": "https://github.com/roed314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_320695.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2017-06-10T16:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320695",
    "user": "https://github.com/roed314"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_320696.json:
```json
{
    "body": "<a id='comment:8'></a>All tests pass.",
    "created_at": "2017-06-10T17:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320696",
    "user": "https://github.com/roed314"
}
```

<a id='comment:8'></a>All tests pass.



---

archive/issue_comments_320697.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-11T00:59:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320697",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_320698.json:
```json
{
    "body": "<a id='comment:10'></a>Looks good except for a few places where `S.category()` should be replaced with an appropriate meet. I'll fix that myself.",
    "created_at": "2017-06-11T03:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320698",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:10'></a>Looks good except for a few places where `S.category()` should be replaced with an appropriate meet. I'll fix that myself.



---

archive/issue_comments_320699.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-06-11T05:35:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320699",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_320700.json:
```json
{
    "body": "<a id='comment:14'></a>tests pass.",
    "created_at": "2017-06-11T05:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320700",
    "user": "https://github.com/saraedum"
}
```

<a id='comment:14'></a>tests pass.



---

archive/issue_comments_320701.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-11T05:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320701",
    "user": "https://github.com/roed314"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_320702.json:
```json
{
    "body": "<a id='comment:15'></a>Looks good.",
    "created_at": "2017-06-11T05:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320702",
    "user": "https://github.com/roed314"
}
```

<a id='comment:15'></a>Looks good.



---

archive/issue_comments_320703.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-12T18:01:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320703",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_059867.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-12T18:01:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/23184#event-59867"
}
```



---

archive/issue_comments_320704.json:
```json
{
    "body": "<a id='comment:17'></a>you used a bad syntax for the trac role here :\n\n```\n+        We check that `trac`:23184 has been resolved::\n```\nit should have been\n\n```\n+        We check that :trac:`23184` has been resolved::\n```\nSo please review #23526",
    "created_at": "2017-07-23T09:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23184",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23184#issuecomment-320704",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:17'></a>you used a bad syntax for the trac role here :

```
+        We check that `trac`:23184 has been resolved::
```
it should have been

```
+        We check that :trac:`23184` has been resolved::
```
So please review #23526
