# Issue 23107: py3: fix everything in src/sage/matrix/*

archive/issues_022870.json:
```json
{
    "assignees": [],
    "body": "Part of #16081\n\nThis set of changes takes care of all the problems reported by `sage -t --long src/sage/matrix/*`. With probability 1 there are other functions that would need to be changed as well but that are not tested enough to raise errors at the moment.\n\nIt is my first ticket concerning pythn3 so please be extra careful when reviewing it. \n\nThis marginally changed also `src/sage/graphs/generic_graph.py`.\n\n\nCC:  @fchapoton\n\nBranch/Commit: **[`aa3319f`](https://github.com/sagemath/sagetrac-mirror/commit/aa3319f7a7a92f3b5507f7d11f4a7c0d8ff0a49b)**\n\nReviewer: **Jeroen Demeyer, Travis Scrimshaw, Fr\u00e9d\u00e9ric Chapoton**\n\nAuthor: **Salvatore Stella**\n\nComponent: **python3**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23107_\n\n",
    "closed_at": "2017-06-29T06:46:44Z",
    "created_at": "2017-05-31T03:50:19Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20python3",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "py3: fix everything in src/sage/matrix/*",
    "type": "issue",
    "updated_at": "2017-06-29T06:46:44Z",
    "url": "https://github.com/sagemath/sage/issues/23107",
    "user": "https://github.com/etn40ff"
}
```
Part of #16081

This set of changes takes care of all the problems reported by `sage -t --long src/sage/matrix/*`. With probability 1 there are other functions that would need to be changed as well but that are not tested enough to raise errors at the moment.

It is my first ticket concerning pythn3 so please be extra careful when reviewing it. 

This marginally changed also `src/sage/graphs/generic_graph.py`.


CC:  @fchapoton

Branch/Commit: **[`aa3319f`](https://github.com/sagemath/sagetrac-mirror/commit/aa3319f7a7a92f3b5507f7d11f4a7c0d8ff0a49b)**

Reviewer: **Jeroen Demeyer, Travis Scrimshaw, Frédéric Chapoton**

Author: **Salvatore Stella**

Component: **python3**

_Issue created by migration from https://trac.sagemath.org/ticket/23107_





---

archive/issue_events_323657.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2017-05-31T03:50:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323657"
}
```



---

archive/issue_events_323658.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2017-05-31T03:50:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20python3",
    "label_color": "000080",
    "label_name": "c: python3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323658"
}
```



---

archive/issue_events_323659.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2017-05-31T03:50:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323659"
}
```



---

archive/issue_comments_345991.json:
```json
{
    "body": "Branch: **[public/ticket/23107](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/23107)**",
    "created_at": "2017-05-31T03:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345991",
    "user": "https://github.com/etn40ff"
}
```

Branch: **[public/ticket/23107](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/23107)**



---

archive/issue_comments_345992.json:
```json
{
    "body": "Commit: **[`91a7320`](https://github.com/sagemath/sagetrac-mirror/commit/91a7320801d289bd2a57e26ef14df0d56d696f84)**",
    "created_at": "2017-05-31T03:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345992",
    "user": "https://github.com/etn40ff"
}
```

Commit: **[`91a7320`](https://github.com/sagemath/sagetrac-mirror/commit/91a7320801d289bd2a57e26ef14df0d56d696f84)**



---

archive/issue_comments_345993.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0256751f2d534880ebafee6a377f40101e4634ec\"><code>0256751</code></a></td><td><code>src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dc88750525c61afaf76483b6641db0e53daa249d\"><code>dc88750</code></a></td><td><code>src/sage/matrix/matrix_double_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/23fbdff9462a576941a6a4fed80022ddc2e4b8f1\"><code>23fbdff</code></a></td><td><code>src/sage/matrix/matrix_integer_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fc2cc38691b74edecf1857d28716c4fe282c8426\"><code>fc2cc38</code></a></td><td><code>src/sage/matrix/matrix_modn_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1c85e2ffb05cb249bf46ad4d75f35045415295b\"><code>a1c85e2</code></a></td><td><code>src/sage/matrix/matrix_rational_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c6825b6fc80a786c2ce58c24fee7d040dddce20\"><code>9c6825b</code></a></td><td><code>src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/60f1e0b213c62fe44740bfbe04f35b8e66002213\"><code>60f1e0b</code></a></td><td><code>src/sage/matrix/matrix_modn_dense_template.pxi</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f2b607e4d15d3da714a168818edcf01137a21747\"><code>f2b607e</code></a></td><td><code>src/sage/graphs/generic_graph.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9075efd2e6ad90c56f76efe4181d98205d37be9\"><code>b9075ef</code></a></td><td><code>src/sage/matrix/matrix_mod2_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91a7320801d289bd2a57e26ef14df0d56d696f84\"><code>91a7320</code></a></td><td><code>src/sage/matrix/matrix_modn_dense_template.pxi</code></td></tr></table>\n",
    "created_at": "2017-05-31T03:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345993",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:1" align="right">comment:1</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0256751f2d534880ebafee6a377f40101e4634ec"><code>0256751</code></a></td><td><code>src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dc88750525c61afaf76483b6641db0e53daa249d"><code>dc88750</code></a></td><td><code>src/sage/matrix/matrix_double_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/23fbdff9462a576941a6a4fed80022ddc2e4b8f1"><code>23fbdff</code></a></td><td><code>src/sage/matrix/matrix_integer_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fc2cc38691b74edecf1857d28716c4fe282c8426"><code>fc2cc38</code></a></td><td><code>src/sage/matrix/matrix_modn_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1c85e2ffb05cb249bf46ad4d75f35045415295b"><code>a1c85e2</code></a></td><td><code>src/sage/matrix/matrix_rational_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c6825b6fc80a786c2ce58c24fee7d040dddce20"><code>9c6825b</code></a></td><td><code>src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/60f1e0b213c62fe44740bfbe04f35b8e66002213"><code>60f1e0b</code></a></td><td><code>src/sage/matrix/matrix_modn_dense_template.pxi</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f2b607e4d15d3da714a168818edcf01137a21747"><code>f2b607e</code></a></td><td><code>src/sage/graphs/generic_graph.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9075efd2e6ad90c56f76efe4181d98205d37be9"><code>b9075ef</code></a></td><td><code>src/sage/matrix/matrix_mod2_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91a7320801d289bd2a57e26ef14df0d56d696f84"><code>91a7320</code></a></td><td><code>src/sage/matrix/matrix_modn_dense_template.pxi</code></td></tr></table>




---

archive/issue_events_323660.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2017-05-31T03:52:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323660"
}
```



---

archive/issue_events_323661.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2017-05-31T03:53:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323661"
}
```



---

archive/issue_comments_345994.json:
```json
{
    "body": "Changed commit from **[`91a7320`](https://github.com/sagemath/sagetrac-mirror/commit/91a7320801d289bd2a57e26ef14df0d56d696f84)** to **[`2108e1b`](https://github.com/sagemath/sagetrac-mirror/commit/2108e1bac5d6a46a05b8165b39f96c1fbbc3ef4c)**",
    "created_at": "2017-05-31T04:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345994",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`91a7320`](https://github.com/sagemath/sagetrac-mirror/commit/91a7320801d289bd2a57e26ef14df0d56d696f84)** to **[`2108e1b`](https://github.com/sagemath/sagetrac-mirror/commit/2108e1bac5d6a46a05b8165b39f96c1fbbc3ef4c)**



---

archive/issue_comments_345995.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b28603670f8d988d66f65bffc6a0b352f4e61c90\"><code>b286036</code></a></td><td><code>src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3d427ffa23d55ca46819af38672e084e36fe5d0\"><code>b3d427f</code></a></td><td><code>src/sage/matrix/matrix_double_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c31595f33d8b45e78d4fc1b532f7955f8bddde2\"><code>8c31595</code></a></td><td><code>src/sage/matrix/matrix_integer_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f96bfc628ca19014607ebaf994c45ae1c2a0397e\"><code>f96bfc6</code></a></td><td><code>src/sage/matrix/matrix_modn_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4521f1d0e53db65e1b5840af037bad62451d777b\"><code>4521f1d</code></a></td><td><code>src/sage/matrix/matrix_rational_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/970bde8be6e63a317fdc81a17b6635bcab1a6c81\"><code>970bde8</code></a></td><td><code>src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a015c6f770c6a60b55290e2cd786c6c10955bb8d\"><code>a015c6f</code></a></td><td><code>src/sage/matrix/matrix_modn_dense_template.pxi</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4e8346feed2df03658055c424835142d09c6ef6e\"><code>4e8346f</code></a></td><td><code>src/sage/graphs/generic_graph.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f51aaf658bab0e02f92e79cd1ce6564679451343\"><code>f51aaf6</code></a></td><td><code>src/sage/matrix/matrix_mod2_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2108e1bac5d6a46a05b8165b39f96c1fbbc3ef4c\"><code>2108e1b</code></a></td><td><code>src/sage/matrix/matrix_modn_dense_template.pxi</code></td></tr></table>\n",
    "created_at": "2017-05-31T04:01:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345995",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b28603670f8d988d66f65bffc6a0b352f4e61c90"><code>b286036</code></a></td><td><code>src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3d427ffa23d55ca46819af38672e084e36fe5d0"><code>b3d427f</code></a></td><td><code>src/sage/matrix/matrix_double_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c31595f33d8b45e78d4fc1b532f7955f8bddde2"><code>8c31595</code></a></td><td><code>src/sage/matrix/matrix_integer_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f96bfc628ca19014607ebaf994c45ae1c2a0397e"><code>f96bfc6</code></a></td><td><code>src/sage/matrix/matrix_modn_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4521f1d0e53db65e1b5840af037bad62451d777b"><code>4521f1d</code></a></td><td><code>src/sage/matrix/matrix_rational_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/970bde8be6e63a317fdc81a17b6635bcab1a6c81"><code>970bde8</code></a></td><td><code>src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a015c6f770c6a60b55290e2cd786c6c10955bb8d"><code>a015c6f</code></a></td><td><code>src/sage/matrix/matrix_modn_dense_template.pxi</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4e8346feed2df03658055c424835142d09c6ef6e"><code>4e8346f</code></a></td><td><code>src/sage/graphs/generic_graph.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f51aaf658bab0e02f92e79cd1ce6564679451343"><code>f51aaf6</code></a></td><td><code>src/sage/matrix/matrix_mod2_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2108e1bac5d6a46a05b8165b39f96c1fbbc3ef4c"><code>2108e1b</code></a></td><td><code>src/sage/matrix/matrix_modn_dense_template.pxi</code></td></tr></table>




---

archive/issue_events_323662.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-05-31T09:50:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323662"
}
```



---

archive/issue_events_323663.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-05-31T09:50:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323663"
}
```



---

archive/issue_comments_345996.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n1. I would replace\n\n```\n            from collections import Iterator, Sequence\n            if isinstance(columns, (Iterator, Sequence)):\n                columns = list(columns)\n            else:\n                raise TypeError(\"columns (=%s) must be a list of integers\" % columns)\n```\nby\n\n```\n            columns = list(columns)\n```\n\n2. Don't break doctests! You should keep the test `A(range(4))`, just change it to\n\n```\nsage: from six.moves import range\nsage: A(range(4))\n```\nif you want to do the same thing in Python 2 and 3.",
    "created_at": "2017-05-31T09:50:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345996",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">comment:5</div>

1. I would replace

```
            from collections import Iterator, Sequence
            if isinstance(columns, (Iterator, Sequence)):
                columns = list(columns)
            else:
                raise TypeError("columns (=%s) must be a list of integers" % columns)
```
by

```
            columns = list(columns)
```

2. Don't break doctests! You should keep the test `A(range(4))`, just change it to

```
sage: from six.moves import range
sage: A(range(4))
```
if you want to do the same thing in Python 2 and 3.



---

archive/issue_comments_345997.json:
```json
{
    "body": "Changed commit from **[`2108e1b`](https://github.com/sagemath/sagetrac-mirror/commit/2108e1bac5d6a46a05b8165b39f96c1fbbc3ef4c)** to **[`869464d`](https://github.com/sagemath/sagetrac-mirror/commit/869464dc611b299e8c28794470277d6ed399e903)**",
    "created_at": "2017-05-31T12:25:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345997",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2108e1b`](https://github.com/sagemath/sagetrac-mirror/commit/2108e1bac5d6a46a05b8165b39f96c1fbbc3ef4c)** to **[`869464d`](https://github.com/sagemath/sagetrac-mirror/commit/869464dc611b299e8c28794470277d6ed399e903)**



---

archive/issue_comments_345998.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/869464dc611b299e8c28794470277d6ed399e903\"><code>869464d</code></a></td><td><code>Reintroduced test</code></td></tr></table>\n",
    "created_at": "2017-05-31T12:25:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345998",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/869464dc611b299e8c28794470277d6ed399e903"><code>869464d</code></a></td><td><code>Reintroduced test</code></td></tr></table>




---

archive/issue_comments_345999.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHi Jeroen, thanks for the fast reply.\n\n2. I bowed to your knowledge here and just reintroduced the test.\n\n1. The rationale behind the conditional clause you mention (and the many other similar occurrences I added in this partch) is that, most likely, `columns` is already going to be a list. I figured it was more efficient to add two checks rather than recreating a new list blindly. In this specific case you mention it will probably not matter because these lists will have short lengths anyway. The cases in which this is more relevant are probably in `src/sage/matrix/matrix_integer_sparse.pyx` where, in principle, one could be building a very big matrix. Should I remove these tests?\n\nOne other thing: before settling on this form I was just checking for `hasattr(columns, \"__iter__\")` but then I realized that also dictionaries will satisfy this.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/869464dc611b299e8c28794470277d6ed399e903\"><code>869464d</code></a></td><td><code>Reintroduced test</code></td></tr></table>\n",
    "created_at": "2017-05-31T12:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-345999",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:7" align="right">comment:7</div>

Hi Jeroen, thanks for the fast reply.

2. I bowed to your knowledge here and just reintroduced the test.

1. The rationale behind the conditional clause you mention (and the many other similar occurrences I added in this partch) is that, most likely, `columns` is already going to be a list. I figured it was more efficient to add two checks rather than recreating a new list blindly. In this specific case you mention it will probably not matter because these lists will have short lengths anyway. The cases in which this is more relevant are probably in `src/sage/matrix/matrix_integer_sparse.pyx` where, in principle, one could be building a very big matrix. Should I remove these tests?

One other thing: before settling on this form I was just checking for `hasattr(columns, "__iter__")` but then I realized that also dictionaries will satisfy this.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/869464dc611b299e8c28794470277d6ed399e903"><code>869464d</code></a></td><td><code>Reintroduced test</code></td></tr></table>




---

archive/issue_comments_346000.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@etn40ff](#comment:7):\n> 1. The rationale behind the conditional clause you mention (and the many other similar occurrences I added in this partch) is that, most likely, `columns` is already going to be a list.\n\nThis reply seems unrelated to the comment I made. It's not about calling `list()` when the input is not a list, it's about rejecting things which are not a `Sequence` or `Iterator`.\n\nI'm perfectly fine with code like\n\n```\nif not isinstance(foo, list):\n    foo = list(foo)\n```\nAs you say, this is more efficient if the input is already a `list`.",
    "created_at": "2017-05-31T14:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346000",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@etn40ff](#comment:7):
> 1. The rationale behind the conditional clause you mention (and the many other similar occurrences I added in this partch) is that, most likely, `columns` is already going to be a list.

This reply seems unrelated to the comment I made. It's not about calling `list()` when the input is not a list, it's about rejecting things which are not a `Sequence` or `Iterator`.

I'm perfectly fine with code like

```
if not isinstance(foo, list):
    foo = list(foo)
```
As you say, this is more efficient if the input is already a `list`.



---

archive/issue_comments_346001.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nAlso note that `isinstance(foo, list)` is extremely fast in Cython since there is a particular optimizating in CPython for checking lists.",
    "created_at": "2017-05-31T14:20:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346001",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Also note that `isinstance(foo, list)` is extremely fast in Cython since there is a particular optimizating in CPython for checking lists.



---

archive/issue_comments_346002.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI agree with Jeroen, you want to construct a list and let Python fail when `list(foo)` doesn't work. We shouldn't force it to be either an `Iterator` or `Sequence`, and fail otherwise. This would allow things like the Python3 `range` to be valid input. Plus it could get rid of the (relatively) expensive `from collections import Iterator, Sequence`.",
    "created_at": "2017-05-31T15:05:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346002",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">comment:10</div>

I agree with Jeroen, you want to construct a list and let Python fail when `list(foo)` doesn't work. We shouldn't force it to be either an `Iterator` or `Sequence`, and fail otherwise. This would allow things like the Python3 `range` to be valid input. Plus it could get rid of the (relatively) expensive `from collections import Iterator, Sequence`.



---

archive/issue_comments_346003.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI am confused. I assumed we do not want to allow this to work if `foo` is a dictionary, do we?",
    "created_at": "2017-05-31T15:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346003",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:11" align="right">comment:11</div>

I am confused. I assumed we do not want to allow this to work if `foo` is a dictionary, do we?



---

archive/issue_comments_346004.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nThen we can explicitly forbid that, but I think this would break Python's ducktyping principle. Since it is suppose to take any iterable, and a `dict` is an iterable, it should work. A user passing a `dict` is likely an error on the user's part, but there could be a use case for it.",
    "created_at": "2017-05-31T15:20:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346004",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:12" align="right">comment:12</div>

Then we can explicitly forbid that, but I think this would break Python's ducktyping principle. Since it is suppose to take any iterable, and a `dict` is an iterable, it should work. A user passing a `dict` is likely an error on the user's part, but there could be a use case for it.



---

archive/issue_comments_346005.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nOK, I consider myself voted down and I will remove these checks.\n\nI would only like to point out that we are changing the behaviour from the one before this patch.\n\nThe current patch:\n\n```\n-        if isinstance(columns, xrange):\n-            columns = list(columns)\n-        elif not isinstance(columns, (list, tuple)):\n-            raise TypeError(\"columns (=%s) must be a list of integers\" % columns)\n+        if not isinstance(columns, (list, tuple)):\n+            from collections import Iterator, Sequence\n+            if isinstance(columns, (Iterator, Sequence)):\n+                columns = list(columns)\n+            else:\n+                raise TypeError(\"columns (=%s) must be a list of integers\" % columns)\n```\n\nThe proposed version:\n\n```\n-        if isinstance(columns, xrange):\n-            columns = list(columns)\n-        elif not isinstance(columns, (list, tuple)):\n-            raise TypeError(\"columns (=%s) must be a list of integers\" % columns)\n+        if not isinstance(columns, (list, tuple)):\n+             columns = list(columns)\n```",
    "created_at": "2017-05-31T15:26:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346005",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:13" align="right">comment:13</div>

OK, I consider myself voted down and I will remove these checks.

I would only like to point out that we are changing the behaviour from the one before this patch.

The current patch:

```
-        if isinstance(columns, xrange):
-            columns = list(columns)
-        elif not isinstance(columns, (list, tuple)):
-            raise TypeError("columns (=%s) must be a list of integers" % columns)
+        if not isinstance(columns, (list, tuple)):
+            from collections import Iterator, Sequence
+            if isinstance(columns, (Iterator, Sequence)):
+                columns = list(columns)
+            else:
+                raise TypeError("columns (=%s) must be a list of integers" % columns)
```

The proposed version:

```
-        if isinstance(columns, xrange):
-            columns = list(columns)
-        elif not isinstance(columns, (list, tuple)):
-            raise TypeError("columns (=%s) must be a list of integers" % columns)
+        if not isinstance(columns, (list, tuple)):
+             columns = list(columns)
```



---

archive/issue_comments_346006.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@etn40ff](#comment:11):\n> I assumed we do not want to allow this to work if `foo` is a dictionary, do we?\n\nWhy should we explicitly *disallow* a `dict`?",
    "created_at": "2017-05-31T17:17:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346006",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@etn40ff](#comment:11):
> I assumed we do not want to allow this to work if `foo` is a dictionary, do we?

Why should we explicitly *disallow* a `dict`?



---

archive/issue_comments_346007.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nLet me rephrase:\n\n1. With the code in sage before this ticket was opened the function in the comment 13 fails if you pass a dictionary to it (or any other iterable that is not xrange list or tuple).\n\n2. With the change I made it preserves this behaviour.\n\n3. With the change you suggest it works also if `coulmns` is a dictionary (using the its keys as elements).\n\nI am not saying that 3 is bad (I actually prefer it), it is just different from 1.",
    "created_at": "2017-05-31T17:24:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346007",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:15" align="right">comment:15</div>

Let me rephrase:

1. With the code in sage before this ticket was opened the function in the comment 13 fails if you pass a dictionary to it (or any other iterable that is not xrange list or tuple).

2. With the change I made it preserves this behaviour.

3. With the change you suggest it works also if `coulmns` is a dictionary (using the its keys as elements).

I am not saying that 3 is bad (I actually prefer it), it is just different from 1.



---

archive/issue_comments_346008.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@etn40ff](#comment:15):\n> I am not saying that 3 is bad (I actually prefer it), it is just different from 1.\n\nWell, you are already changing the behaviour of the function in other ways too.\n\nIf allowing dicts was the *only* change that you did, I would agree with you: that would be dubious. But if you change behaviour anyway, then the argument \"it behaves different from the old code\" makes little sense.",
    "created_at": "2017-05-31T20:27:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346008",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@etn40ff](#comment:15):
> I am not saying that 3 is bad (I actually prefer it), it is just different from 1.

Well, you are already changing the behaviour of the function in other ways too.

If allowing dicts was the *only* change that you did, I would agree with you: that would be dubious. But if you change behaviour anyway, then the argument "it behaves different from the old code" makes little sense.



---

archive/issue_comments_346009.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nSomething that is a problem with your current version is that it no longer would support `xrange`:\n\n```\nsage: from six.moves import range\nsage: isinstance(range, Iterator)\nFalse\nsage: isinstance(range, Sequence)\nFalse\n```",
    "created_at": "2017-05-31T23:41:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346009",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">comment:17</div>

Something that is a problem with your current version is that it no longer would support `xrange`:

```
sage: from six.moves import range
sage: isinstance(range, Iterator)
False
sage: isinstance(range, Sequence)
False
```



---

archive/issue_comments_346010.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@tscrim](#comment:17):\n> Something that is a problem with your current version is that it no longer would support `xrange`:\n> \n> ```\n> sage: from six.moves import range\n> sage: isinstance(range, Iterator)\n> False\n> sage: isinstance(range, Sequence)\n> False\n> ```\n\nThat is not surprising: you forgot to call it.\n\n```\nsage: from six.moves import range\nsage: isinstance(range(10), Iterator)\nFalse\nsage: isinstance(range(10), Sequence)\nTrue\n```\n\nAnyway this is a moot point now since we decided that I should remove these conditional statements.",
    "created_at": "2017-06-01T01:44:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346010",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@tscrim](#comment:17):
> Something that is a problem with your current version is that it no longer would support `xrange`:
> 
> ```
> sage: from six.moves import range
> sage: isinstance(range, Iterator)
> False
> sage: isinstance(range, Sequence)
> False
> ```

That is not surprising: you forgot to call it.

```
sage: from six.moves import range
sage: isinstance(range(10), Iterator)
False
sage: isinstance(range(10), Sequence)
True
```

Anyway this is a moot point now since we decided that I should remove these conditional statements.



---

archive/issue_comments_346011.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\n*facepalm*",
    "created_at": "2017-06-01T02:05:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346011",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:19" align="right">comment:19</div>

*facepalm*



---

archive/issue_comments_346012.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nCan you revert some (all?) of the changes from `range` to explicit lists and be Python3 compatible? I think we should have coverage for (at least most) those as features. Once that is done, I think that takes care of all of the issues and we can set this to a positive review.\n\nAlso, author name.",
    "created_at": "2017-06-04T00:37:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346012",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

Can you revert some (all?) of the changes from `range` to explicit lists and be Python3 compatible? I think we should have coverage for (at least most) those as features. Once that is done, I think that takes care of all of the issues and we can set this to a positive review.

Also, author name.



---

archive/issue_comments_346013.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer, Travis Scrimshaw**",
    "created_at": "2017-06-04T00:37:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346013",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Jeroen Demeyer, Travis Scrimshaw**



---

archive/issue_comments_346014.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2749d7892cff4cde7644e071ce85f05ef70cd28\"><code>e2749d7</code></a></td><td><code>Merge branch 'public/ticket/23107' of git://trac.sagemath.org/sage into public/ticket/23107</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51011297d7dc1e460b39c2034cb32725f6a95fcc\"><code>5101129</code></a></td><td><code>Revert to lists in src/sage/matrix/docs.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c252f99296bd5428ade2b18a44633d4259906575\"><code>c252f99</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix0.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c474a9ed85bc15e085ecc94769d42e55878a58e\"><code>7c474a9</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/454671f69471b3110d8d66109f4a7ef902c60eb7\"><code>454671f</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx (bis)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6138023fe2b8eeb0f4dcaaf8feeb8a1e1a2c69aa\"><code>6138023</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_complex_ball_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c6c2ca421a2abfc40874812e25a42482bf4c35b\"><code>0c6c2ca</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_integer_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af55f074cc50fc99ded1b7b4911c7bc2e446cc53\"><code>af55f07</code></a></td><td><code>Removed iterator test from src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efa0b9d2239a7d2ca340a27e1b834b6a67e07c88\"><code>efa0b9d</code></a></td><td><code>typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7\"><code>8a5b849</code></a></td><td><code>Missing list</code></td></tr></table>\n",
    "created_at": "2017-06-07T03:23:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346014",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2749d7892cff4cde7644e071ce85f05ef70cd28"><code>e2749d7</code></a></td><td><code>Merge branch 'public/ticket/23107' of git://trac.sagemath.org/sage into public/ticket/23107</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51011297d7dc1e460b39c2034cb32725f6a95fcc"><code>5101129</code></a></td><td><code>Revert to lists in src/sage/matrix/docs.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c252f99296bd5428ade2b18a44633d4259906575"><code>c252f99</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix0.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c474a9ed85bc15e085ecc94769d42e55878a58e"><code>7c474a9</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/454671f69471b3110d8d66109f4a7ef902c60eb7"><code>454671f</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx (bis)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6138023fe2b8eeb0f4dcaaf8feeb8a1e1a2c69aa"><code>6138023</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_complex_ball_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c6c2ca421a2abfc40874812e25a42482bf4c35b"><code>0c6c2ca</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_integer_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af55f074cc50fc99ded1b7b4911c7bc2e446cc53"><code>af55f07</code></a></td><td><code>Removed iterator test from src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efa0b9d2239a7d2ca340a27e1b834b6a67e07c88"><code>efa0b9d</code></a></td><td><code>typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7"><code>8a5b849</code></a></td><td><code>Missing list</code></td></tr></table>




---

archive/issue_comments_346015.json:
```json
{
    "body": "Changed commit from **[`869464d`](https://github.com/sagemath/sagetrac-mirror/commit/869464dc611b299e8c28794470277d6ed399e903)** to **[`8a5b849`](https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7)**",
    "created_at": "2017-06-07T03:23:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346015",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`869464d`](https://github.com/sagemath/sagetrac-mirror/commit/869464dc611b299e8c28794470277d6ed399e903)** to **[`8a5b849`](https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7)**



---

archive/issue_comments_346016.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nDear All, sorry for the late reply.\n\nI made few changes to the code:\n\n1. All instances of `[0,1]` I introduced in the doctest are now `list(range(2))`. Same for `[0,1,2,3]`. I do not understand why you wanted this change (they produce the same output both in python2 and python3 and the fisrt syntax is shorter and more legible IMHO) but it is not worth spending time discussing this.\n\n2. I removed all the tests `isinstance(foo, (Iterator, Sequence))` that where easily removeable. There are few more around, I think only in the following files\n\n```\nsrc/sage/matrix/matrix_double_dense.pyx\nsrc/sage/matrix/matrix_integer_sparse.pyx\nsrc/sage/matrix/matrix_mod2_dense.pyx\nsrc/sage/matrix/matrix_modn_sparse.pyx\nsrc/sage/matrix/matrix_rational_sparse.pyx\nsrc/sage/matrix/matrix_space.py\n``` \n    The reason is that the function in there already accept a variety of inputs, some of which are not iterable, and to remove the tests these function would have to be significantly reworked. There are two solutions to this:\n \n    (cheap and messy) remove the test and fail if they are fed an iterator. This probably will require to fix doctests in other files. Plus I do not see why they should not work with iterators just because the implementation is not clean enough.\n\n    (more time consuming) rewrite the functions so that they default to evaluate `foo = list(foo)`\n\n    At the moment I do not have time to do so. If you are not satisfied feel free to take over this patch and fix it to your likings.\n\n@tscrim: I do not understand what you mean by \"and be Python3 compatible\". It looks to me that the changes this patch produces work in both version of python. This is the whole point, no?\n\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2749d7892cff4cde7644e071ce85f05ef70cd28\"><code>e2749d7</code></a></td><td><code>Merge branch 'public/ticket/23107' of git://trac.sagemath.org/sage into public/ticket/23107</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51011297d7dc1e460b39c2034cb32725f6a95fcc\"><code>5101129</code></a></td><td><code>Revert to lists in src/sage/matrix/docs.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c252f99296bd5428ade2b18a44633d4259906575\"><code>c252f99</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix0.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c474a9ed85bc15e085ecc94769d42e55878a58e\"><code>7c474a9</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/454671f69471b3110d8d66109f4a7ef902c60eb7\"><code>454671f</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx (bis)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6138023fe2b8eeb0f4dcaaf8feeb8a1e1a2c69aa\"><code>6138023</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_complex_ball_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c6c2ca421a2abfc40874812e25a42482bf4c35b\"><code>0c6c2ca</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_integer_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af55f074cc50fc99ded1b7b4911c7bc2e446cc53\"><code>af55f07</code></a></td><td><code>Removed iterator test from src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efa0b9d2239a7d2ca340a27e1b834b6a67e07c88\"><code>efa0b9d</code></a></td><td><code>typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7\"><code>8a5b849</code></a></td><td><code>Missing list</code></td></tr></table>\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2749d7892cff4cde7644e071ce85f05ef70cd28\"><code>e2749d7</code></a></td><td><code>Merge branch 'public/ticket/23107' of git://trac.sagemath.org/sage into public/ticket/23107</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51011297d7dc1e460b39c2034cb32725f6a95fcc\"><code>5101129</code></a></td><td><code>Revert to lists in src/sage/matrix/docs.py</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c252f99296bd5428ade2b18a44633d4259906575\"><code>c252f99</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix0.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c474a9ed85bc15e085ecc94769d42e55878a58e\"><code>7c474a9</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/454671f69471b3110d8d66109f4a7ef902c60eb7\"><code>454671f</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx (bis)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6138023fe2b8eeb0f4dcaaf8feeb8a1e1a2c69aa\"><code>6138023</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_complex_ball_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0c6c2ca421a2abfc40874812e25a42482bf4c35b\"><code>0c6c2ca</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_integer_dense.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af55f074cc50fc99ded1b7b4911c7bc2e446cc53\"><code>af55f07</code></a></td><td><code>Removed iterator test from src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efa0b9d2239a7d2ca340a27e1b834b6a67e07c88\"><code>efa0b9d</code></a></td><td><code>typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7\"><code>8a5b849</code></a></td><td><code>Missing list</code></td></tr></table>\n",
    "created_at": "2017-06-07T03:24:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346016",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:22" align="right">comment:22</div>

Dear All, sorry for the late reply.

I made few changes to the code:

1. All instances of `[0,1]` I introduced in the doctest are now `list(range(2))`. Same for `[0,1,2,3]`. I do not understand why you wanted this change (they produce the same output both in python2 and python3 and the fisrt syntax is shorter and more legible IMHO) but it is not worth spending time discussing this.

2. I removed all the tests `isinstance(foo, (Iterator, Sequence))` that where easily removeable. There are few more around, I think only in the following files

```
src/sage/matrix/matrix_double_dense.pyx
src/sage/matrix/matrix_integer_sparse.pyx
src/sage/matrix/matrix_mod2_dense.pyx
src/sage/matrix/matrix_modn_sparse.pyx
src/sage/matrix/matrix_rational_sparse.pyx
src/sage/matrix/matrix_space.py
``` 
    The reason is that the function in there already accept a variety of inputs, some of which are not iterable, and to remove the tests these function would have to be significantly reworked. There are two solutions to this:
 
    (cheap and messy) remove the test and fail if they are fed an iterator. This probably will require to fix doctests in other files. Plus I do not see why they should not work with iterators just because the implementation is not clean enough.

    (more time consuming) rewrite the functions so that they default to evaluate `foo = list(foo)`

    At the moment I do not have time to do so. If you are not satisfied feel free to take over this patch and fix it to your likings.

@tscrim: I do not understand what you mean by "and be Python3 compatible". It looks to me that the changes this patch produces work in both version of python. This is the whole point, no?


---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2749d7892cff4cde7644e071ce85f05ef70cd28"><code>e2749d7</code></a></td><td><code>Merge branch 'public/ticket/23107' of git://trac.sagemath.org/sage into public/ticket/23107</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51011297d7dc1e460b39c2034cb32725f6a95fcc"><code>5101129</code></a></td><td><code>Revert to lists in src/sage/matrix/docs.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c252f99296bd5428ade2b18a44633d4259906575"><code>c252f99</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix0.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c474a9ed85bc15e085ecc94769d42e55878a58e"><code>7c474a9</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/454671f69471b3110d8d66109f4a7ef902c60eb7"><code>454671f</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx (bis)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6138023fe2b8eeb0f4dcaaf8feeb8a1e1a2c69aa"><code>6138023</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_complex_ball_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c6c2ca421a2abfc40874812e25a42482bf4c35b"><code>0c6c2ca</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_integer_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af55f074cc50fc99ded1b7b4911c7bc2e446cc53"><code>af55f07</code></a></td><td><code>Removed iterator test from src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efa0b9d2239a7d2ca340a27e1b834b6a67e07c88"><code>efa0b9d</code></a></td><td><code>typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7"><code>8a5b849</code></a></td><td><code>Missing list</code></td></tr></table>

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2749d7892cff4cde7644e071ce85f05ef70cd28"><code>e2749d7</code></a></td><td><code>Merge branch 'public/ticket/23107' of git://trac.sagemath.org/sage into public/ticket/23107</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51011297d7dc1e460b39c2034cb32725f6a95fcc"><code>5101129</code></a></td><td><code>Revert to lists in src/sage/matrix/docs.py</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c252f99296bd5428ade2b18a44633d4259906575"><code>c252f99</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix0.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c474a9ed85bc15e085ecc94769d42e55878a58e"><code>7c474a9</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/454671f69471b3110d8d66109f4a7ef902c60eb7"><code>454671f</code></a></td><td><code>Removed iterator tests from src/sage/matrix/matrix1.pyx (bis)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6138023fe2b8eeb0f4dcaaf8feeb8a1e1a2c69aa"><code>6138023</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_complex_ball_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0c6c2ca421a2abfc40874812e25a42482bf4c35b"><code>0c6c2ca</code></a></td><td><code>Revert to lists in src/sage/matrix/matrix_integer_dense.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af55f074cc50fc99ded1b7b4911c7bc2e446cc53"><code>af55f07</code></a></td><td><code>Removed iterator test from src/sage/matrix/matrix_sparse.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efa0b9d2239a7d2ca340a27e1b834b6a67e07c88"><code>efa0b9d</code></a></td><td><code>typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7"><code>8a5b849</code></a></td><td><code>Missing list</code></td></tr></table>




---

archive/issue_comments_346017.json:
```json
{
    "body": "Author: **Salvatore Stella**",
    "created_at": "2017-06-07T03:24:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346017",
    "user": "https://github.com/etn40ff"
}
```

Author: **Salvatore Stella**



---

archive/issue_events_323664.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2017-06-07T03:24:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323664"
}
```



---

archive/issue_events_323665.json:
```json
{
    "actor": "https://github.com/etn40ff",
    "created_at": "2017-06-07T03:24:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323665"
}
```



---

archive/issue_events_323666.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-07T05:34:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323666"
}
```



---

archive/issue_events_323667.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-07T05:34:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323667"
}
```



---

archive/issue_comments_346018.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThere is still a lot of `list(range(...))` in the doctests.",
    "created_at": "2017-06-07T05:34:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346018",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

There is still a lot of `list(range(...))` in the doctests.



---

archive/issue_comments_346019.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI am totally confused here. The code contained many instances of things like `M[range(2):]` and I changed that to `M[[0,1],:]`. Travis complained in comment 20 and I reverted them to `M[list(range(2)):]` which is the way things have been done in other tickets (c.f. #22972 https://github.com/sagemath/sagetrac-mirror/commit/5c740530b0224aab62eaa8e4e49d0dfd9a19ec08 ). Now you complain for the exact opposite reason. Can we please reach an agreement on what should be done?",
    "created_at": "2017-06-07T11:50:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346019",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:25" align="right">comment:25</div>

I am totally confused here. The code contained many instances of things like `M[range(2):]` and I changed that to `M[[0,1],:]`. Travis complained in comment 20 and I reverted them to `M[list(range(2)):]` which is the way things have been done in other tickets (c.f. #22972 https://github.com/sagemath/sagetrac-mirror/commit/5c740530b0224aab62eaa8e4e49d0dfd9a19ec08 ). Now you complain for the exact opposite reason. Can we please reach an agreement on what should be done?



---

archive/issue_comments_346020.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThe solution is easy: if the original was A, Travis complains about B and I complain about C, just keep A.",
    "created_at": "2017-06-07T12:28:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346020",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

The solution is easy: if the original was A, Travis complains about B and I complain about C, just keep A.



---

archive/issue_comments_346021.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@etn40ff](#comment:25):\n> #22972\n\nWow, that's bad indeed. I would never have agreed with that.",
    "created_at": "2017-06-07T12:30:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346021",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@etn40ff](#comment:25):
> #22972

Wow, that's bad indeed. I would never have agreed with that.



---

archive/issue_comments_346022.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nA is not an option: slicing does not work with iterators and I am not adderssing this issue in this ticket.",
    "created_at": "2017-06-07T12:30:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346022",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:28" align="right">comment:28</div>

A is not an option: slicing does not work with iterators and I am not adderssing this issue in this ticket.



---

archive/issue_comments_346023.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nWhat has happened is you have increased support with changes like this:\n\n```diff\ndiff --git a/src/sage/matrix/matrix1.pyx b/src/sage/matrix/matrix1.pyx\nindex b9c35be..dfe74a9 100644\n--- a/src/sage/matrix/matrix1.pyx\n+++ b/src/sage/matrix/matrix1.pyx\n@@ -1697,10 +1697,9 @@ cdef class Matrix(matrix0.Matrix):\n             [5 4]\n             [0 7]\n         \"\"\"\n-        if isinstance(columns, xrange):\n+        if not isinstance(columns, (list, tuple)):\n             columns = list(columns)\n-        elif not isinstance(columns, (list, tuple)):\n-            raise TypeError(\"columns (=%s) must be a list of integers\" % columns)\n+\n         cdef Matrix A\n         cdef Py_ssize_t ncols,k,r\n \n```\nand you do not need to explicitly specify it as a list. By allowing an `xrange` (which is Cython-speak for Python3 range) input, you are Python3 compatible. So I don't fundamentally see my and Jeroen's objections as being different (actually, mine was more meant as a question at the time).\n\nEdit: Misread the code, it is not a regression but an expansion of support.",
    "created_at": "2017-06-07T12:30:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346023",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:29" align="right">comment:29</div>

What has happened is you have increased support with changes like this:

```diff
diff --git a/src/sage/matrix/matrix1.pyx b/src/sage/matrix/matrix1.pyx
index b9c35be..dfe74a9 100644
--- a/src/sage/matrix/matrix1.pyx
+++ b/src/sage/matrix/matrix1.pyx
@@ -1697,10 +1697,9 @@ cdef class Matrix(matrix0.Matrix):
             [5 4]
             [0 7]
         """
-        if isinstance(columns, xrange):
+        if not isinstance(columns, (list, tuple)):
             columns = list(columns)
-        elif not isinstance(columns, (list, tuple)):
-            raise TypeError("columns (=%s) must be a list of integers" % columns)
+
         cdef Matrix A
         cdef Py_ssize_t ncols,k,r
 
```
and you do not need to explicitly specify it as a list. By allowing an `xrange` (which is Cython-speak for Python3 range) input, you are Python3 compatible. So I don't fundamentally see my and Jeroen's objections as being different (actually, mine was more meant as a question at the time).

Edit: Misread the code, it is not a regression but an expansion of support.



---

archive/issue_comments_346024.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@etn40ff](#comment:28):\n> A is not an option: slicing does not work with iterators and I am not adderssing this issue in this ticket.\n\nSorry, I don't understand what you mean. Why cannot you just keep the doctests as they are?",
    "created_at": "2017-06-07T12:37:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346024",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@etn40ff](#comment:28):
> A is not an option: slicing does not work with iterators and I am not adderssing this issue in this ticket.

Sorry, I don't understand what you mean. Why cannot you just keep the doctests as they are?



---

archive/issue_comments_346025.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nThere is more general idea here: **do not break doctests**. If you make changes to the code which break a doctest, that's bad: you should fix your code such that the doctest remains to work.\n\nThere are always exceptions to this rule, but you need good reasons.",
    "created_at": "2017-06-07T12:39:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346025",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

There is more general idea here: **do not break doctests**. If you make changes to the code which break a doctest, that's bad: you should fix your code such that the doctest remains to work.

There are always exceptions to this rule, but you need good reasons.



---

archive/issue_comments_346026.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@jdemeyer](#comment:30):\n> Replying to [@etn40ff](#comment:28):\n> > A is not an option: slicing does not work with iterators and I am not adderssing this issue in this ticket.\n\n> \n> Sorry, I don't understand what you mean. Why cannot you just keep the doctests as they are?\n\nBecause of this:\n\n```\nsage: M = Matrix(5); M[iter(range(3)):]\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-ca1bbd50e7c9> in <module>()\n----> 1 M = Matrix(Integer(5)); M[iter(range(Integer(3))):]\n\n/opt/sage/src/sage/matrix/matrix0.pyx in sage.matrix.matrix0.Matrix.__getitem__ (build/cythonized/sage/matrix/matrix0.c:7659)()\n    984             r = self.matrix_from_rows(row_list)\n    985         elif isinstance(row_index, slice):\n--> 986             row_list = list(xrange(*row_index.indices(nrows)))\n    987             r = self.matrix_from_rows(row_list)\n    988         else:\n\nTypeError: slice indices must be integers or None or have an __index__ method\n```",
    "created_at": "2017-06-07T12:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346026",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@jdemeyer](#comment:30):
> Replying to [@etn40ff](#comment:28):
> > A is not an option: slicing does not work with iterators and I am not adderssing this issue in this ticket.

> 
> Sorry, I don't understand what you mean. Why cannot you just keep the doctests as they are?

Because of this:

```
sage: M = Matrix(5); M[iter(range(3)):]
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-ca1bbd50e7c9> in <module>()
----> 1 M = Matrix(Integer(5)); M[iter(range(Integer(3))):]

/opt/sage/src/sage/matrix/matrix0.pyx in sage.matrix.matrix0.Matrix.__getitem__ (build/cythonized/sage/matrix/matrix0.c:7659)()
    984             r = self.matrix_from_rows(row_list)
    985         elif isinstance(row_index, slice):
--> 986             row_list = list(xrange(*row_index.indices(nrows)))
    987             r = self.matrix_from_rows(row_list)
    988         else:

TypeError: slice indices must be integers or None or have an __index__ method
```



---

archive/issue_comments_346027.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@jdemeyer](#comment:31):\n> There is more general idea here: **do not break doctests**. If you make changes to the code which break a doctest, that's bad: you should fix your code such that the doctest remains to work.\n> \n> There are always exceptions to this rule, but you need good reasons.\n\nI *did not* break a doctest. I have been applying the same procedure taht all the other python3 tickets did i.e. adapt the doctest to accept both python2 and python3. I agree that `list(range(` is fugly but that is what has been done all over the place.",
    "created_at": "2017-06-07T12:44:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346027",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@jdemeyer](#comment:31):
> There is more general idea here: **do not break doctests**. If you make changes to the code which break a doctest, that's bad: you should fix your code such that the doctest remains to work.
> 
> There are always exceptions to this rule, but you need good reasons.

I *did not* break a doctest. I have been applying the same procedure taht all the other python3 tickets did i.e. adapt the doctest to accept both python2 and python3. I agree that `list(range(` is fugly but that is what has been done all over the place.



---

archive/issue_comments_346028.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@etn40ff](#comment:33):\n> i.e. adapt the doctest to accept both python2 and python3\n\nAdapting doctests is not a solution. The change from Python 2 to Python 3 should be as transparent as possible to the user. You cannot require the user to change all `range(n)` into `list(range(n))`.\n\n(edit: as usual, there are exceptions. Some things cannot work in Python 3 for fundamental reasons. But I see no reason to make an exception for this ticket)",
    "created_at": "2017-06-07T12:48:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346028",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@etn40ff](#comment:33):
> i.e. adapt the doctest to accept both python2 and python3

Adapting doctests is not a solution. The change from Python 2 to Python 3 should be as transparent as possible to the user. You cannot require the user to change all `range(n)` into `list(range(n))`.

(edit: as usual, there are exceptions. Some things cannot work in Python 3 for fundamental reasons. But I see no reason to make an exception for this ticket)



---

archive/issue_comments_346029.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThere is a difference between code that is designed to work with both types of `range` and those that currently need `list(range(`. Although perhaps on earlier Python3 tickets, Fr\u00e9d\u00e9ric and I didn't quite know what the best way forward would be (such as Cython's support for `xrange`).",
    "created_at": "2017-06-07T13:03:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346029",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:35" align="right">comment:35</div>

There is a difference between code that is designed to work with both types of `range` and those that currently need `list(range(`. Although perhaps on earlier Python3 tickets, Frédéric and I didn't quite know what the best way forward would be (such as Cython's support for `xrange`).



---

archive/issue_comments_346030.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@tscrim](#comment:35):\n> There is a difference between code that is designed to work with both types of `range` and those that currently need `list(range(`.\n\nAs I explained in [comment:34], the solution is to change the code to accept `range(n)` in Python 3. Changing doctests is not a solution.",
    "created_at": "2017-06-07T13:10:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346030",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@tscrim](#comment:35):
> There is a difference between code that is designed to work with both types of `range` and those that currently need `list(range(`.

As I explained in [comment:34], the solution is to change the code to accept `range(n)` in Python 3. Changing doctests is not a solution.



---

archive/issue_comments_346031.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@jdemeyer](#comment:36):\n> Replying to [@tscrim](#comment:35):\n> > There is a difference between code that is designed to work with both types of `range` and those that currently need `list(range(`.\n\n> \n> As I explained in [comment:34], the solution is to change the code to accept `range(n)` in Python 3. Changing doctests is not a solution.\n\nThis patch does not address the issue of slicing; are you saying that it should leave alone the doctests failing because of this? \n\nIn any case, it looks to me that there is no consensus on what to do. Moreover we are not being consistent with other py3 tickets so far. Do we have to revisit all the work that has already been done? Fr\u00e9d\u00e9ric should probably be part of the conversation as well so I just cced him.\n\nI guess that me trying to simultaneously satisfy contrasting guidelines is pointless so I will step back and let you figure out a list of desiderata first. I do not think I will have much time to work on this in the foreseeable future (I am moving to another country for my next job) so please feel free to claim ownership of this ticket and continue without me.",
    "created_at": "2017-06-07T18:54:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346031",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@jdemeyer](#comment:36):
> Replying to [@tscrim](#comment:35):
> > There is a difference between code that is designed to work with both types of `range` and those that currently need `list(range(`.

> 
> As I explained in [comment:34], the solution is to change the code to accept `range(n)` in Python 3. Changing doctests is not a solution.

This patch does not address the issue of slicing; are you saying that it should leave alone the doctests failing because of this? 

In any case, it looks to me that there is no consensus on what to do. Moreover we are not being consistent with other py3 tickets so far. Do we have to revisit all the work that has already been done? Frédéric should probably be part of the conversation as well so I just cced him.

I guess that me trying to simultaneously satisfy contrasting guidelines is pointless so I will step back and let you figure out a list of desiderata first. I do not think I will have much time to work on this in the foreseeable future (I am moving to another country for my next job) so please feel free to claim ownership of this ticket and continue without me.



---

archive/issue_comments_346032.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@etn40ff](#comment:37):\n> are you saying that it should leave alone the doctests failing because of this? \n\nExactly (to be clear, I assume that by \"failing\" you mean \"failing on Python 3 but succeeding on Python 2\").\n\n> Moreover we are not being consistent with other py3 tickets so far.\n\nThat's a pity indeed. Note that *most* of the Python 3 tickets do not change doctests that way. #22972 is the only one that I am aware of (and to repeat, I disagree with what was done there).\n\n> Do we have to revisit all the work that has already been done?\n\nWell, in any case that's not really urgent. But at least let's not make things worse.",
    "created_at": "2017-06-07T19:10:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346032",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@etn40ff](#comment:37):
> are you saying that it should leave alone the doctests failing because of this? 

Exactly (to be clear, I assume that by "failing" you mean "failing on Python 3 but succeeding on Python 2").

> Moreover we are not being consistent with other py3 tickets so far.

That's a pity indeed. Note that *most* of the Python 3 tickets do not change doctests that way. #22972 is the only one that I am aware of (and to repeat, I disagree with what was done there).

> Do we have to revisit all the work that has already been done?

Well, in any case that's not really urgent. But at least let's not make things worse.



---

archive/issue_comments_346033.json:
```json
{
    "body": "Changed branch from **[public/ticket/23107](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/23107)** to **[public/23107-v2](https://github.com/sagemath/sagetrac-mirror/tree/public/23107-v2)**",
    "created_at": "2017-06-19T19:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346033",
    "user": "https://github.com/fchapoton"
}
```

Changed branch from **[public/ticket/23107](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/23107)** to **[public/23107-v2](https://github.com/sagemath/sagetrac-mirror/tree/public/23107-v2)**



---

archive/issue_comments_346034.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nhere is a modified branch..\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54645bb8c4320a2a0b685771c3e4e69582cde286\"><code>54645bb</code></a></td><td><code>some work on range in matrix folder</code></td></tr></table>\n",
    "created_at": "2017-06-19T19:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346034",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:39" align="right">comment:39</div>

here is a modified branch..

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54645bb8c4320a2a0b685771c3e4e69582cde286"><code>54645bb</code></a></td><td><code>some work on range in matrix folder</code></td></tr></table>




---

archive/issue_comments_346035.json:
```json
{
    "body": "Changed commit from **[`8a5b849`](https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7)** to **[`54645bb`](https://github.com/sagemath/sagetrac-mirror/commit/54645bb8c4320a2a0b685771c3e4e69582cde286)**",
    "created_at": "2017-06-19T19:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346035",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`8a5b849`](https://github.com/sagemath/sagetrac-mirror/commit/8a5b84949339869d42091328874bd8ac83ab45d7)** to **[`54645bb`](https://github.com/sagemath/sagetrac-mirror/commit/54645bb8c4320a2a0b685771c3e4e69582cde286)**



---

archive/issue_comments_346036.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nJust to remind that this is still needs_work.",
    "created_at": "2017-06-20T15:06:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346036",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">comment:40</div>

Just to remind that this is still needs_work.



---

archive/issue_events_323668.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-06-20T15:21:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323668"
}
```



---

archive/issue_events_323669.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-06-20T15:21:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323669"
}
```



---

archive/issue_comments_346037.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThanks. I think Salvatore has dropped the case. I would have liked to see this resolved without me doing anything, but alas..\n\nI am not totally convinced by the use of Iterator, Sequence.",
    "created_at": "2017-06-20T15:21:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346037",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:41" align="right">comment:41</div>

Thanks. I think Salvatore has dropped the case. I would have liked to see this resolved without me doing anything, but alas..

I am not totally convinced by the use of Iterator, Sequence.



---

archive/issue_comments_346038.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nDear all,\nI just wanted to say that I did not drop the cause yet. I recently moved to my new job and I am still on a crazy rollercoaster trying to sort things out. If you are not in a hurry I can be back on this in a month time at the latest. On the other hand, if you are in a hurry feel free to push through without my input. There are going to be plenty of other py3 tickets I can contribute to once I am back.\n\nSorry for not being more helpful right now.",
    "created_at": "2017-06-20T15:36:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346038",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:42" align="right">comment:42</div>

Dear all,
I just wanted to say that I did not drop the cause yet. I recently moved to my new job and I am still on a crazy rollercoaster trying to sort things out. If you are not in a hurry I can be back on this in a month time at the latest. On the other hand, if you are in a hurry feel free to push through without my input. There are going to be plenty of other py3 tickets I can contribute to once I am back.

Sorry for not being more helpful right now.



---

archive/issue_comments_346039.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nPS: how is it possible that I am listed as the one making the latest commit on the current branch when I did not?",
    "created_at": "2017-06-20T15:40:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346039",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:43" align="right">comment:43</div>

PS: how is it possible that I am listed as the one making the latest commit on the current branch when I did not?



---

archive/issue_comments_346040.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nHello Salvatore,\n\nin fact, there is no hurry (py3 is still a long way ahead, sadly), but I was afraid that you were (besides being very busy with installation at your new job, which is very understandable) somewhat horrified by the complexity of the matter, and the various contradictory requirements.\n\nConcerning your name on the commit, I did a rebase, keeping only your first commit and squashing the others into this one, then changing its commit message. Then I worked a little bit and rebased again. So I guess this is considered to some kind of \"transformation\" of your initial commit.",
    "created_at": "2017-06-20T16:36:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346040",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:44" align="right">comment:44</div>

Hello Salvatore,

in fact, there is no hurry (py3 is still a long way ahead, sadly), but I was afraid that you were (besides being very busy with installation at your new job, which is very understandable) somewhat horrified by the complexity of the matter, and the various contradictory requirements.

Concerning your name on the commit, I did a rebase, keeping only your first commit and squashing the others into this one, then changing its commit message. Then I worked a little bit and rebased again. So I guess this is considered to some kind of "transformation" of your initial commit.



---

archive/issue_events_323670.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-23T14:18:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323670"
}
```



---

archive/issue_events_323671.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-23T14:18:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323671"
}
```



---

archive/issue_comments_346041.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\n1. Why was this doctest removed:\n\n```\nsage: A.delete_columns('junk')\n```\n\n2. This might be partially a style issue, but I hate code of the form\n\n```\ntry:\n    something()\nexcept TypeError:\n    raise TypeError(...)\n```\nbecause usually, the exception that is caught and thrown away contains more useful information that the newly raised exception. So I would replace this by\n\n```\nsomething()\n```",
    "created_at": "2017-06-23T14:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346041",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

1. Why was this doctest removed:

```
sage: A.delete_columns('junk')
```

2. This might be partially a style issue, but I hate code of the form

```
try:
    something()
except TypeError:
    raise TypeError(...)
```
because usually, the exception that is caught and thrown away contains more useful information that the newly raised exception. So I would replace this by

```
something()
```



---

archive/issue_comments_346042.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\n3. For efficiency, it is better to reverse these conditions (replace `A and B` by `B and A`):\n\n```\n        if (isinstance(x, (Iterator, Sequence)) and\n            not isinstance(x, (list, tuple))):\n```\nFirst of all, it's much cheaper to check if something is a `list` or `tuple` rather than some ABC type. Second, in many cases, the input will be a `list` or `tuple`, so then you don't even need the `(Iterator, Sequence)` check.\n\n4. Again for efficiency, move all imports of `Iterator, Sequence` to the top level, not inside the function. Since these are standard Python types, there should be no harm.",
    "created_at": "2017-06-23T14:29:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346042",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:46" align="right">comment:46</div>

3. For efficiency, it is better to reverse these conditions (replace `A and B` by `B and A`):

```
        if (isinstance(x, (Iterator, Sequence)) and
            not isinstance(x, (list, tuple))):
```
First of all, it's much cheaper to check if something is a `list` or `tuple` rather than some ABC type. Second, in many cases, the input will be a `list` or `tuple`, so then you don't even need the `(Iterator, Sequence)` check.

4. Again for efficiency, move all imports of `Iterator, Sequence` to the top level, not inside the function. Since these are standard Python types, there should be no harm.



---

archive/issue_comments_346043.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\n5. There is still a `list(range(3))` in `src/sage/matrix/matrix_modn_dense_template.pxi`",
    "created_at": "2017-06-23T14:42:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346043",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

5. There is still a `list(range(3))` in `src/sage/matrix/matrix_modn_dense_template.pxi`



---

archive/issue_comments_346044.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\n6. In `src/sage/matrix/matrix_modn_sparse.pyx`, there is no reason to raise an error for input which is not `Iterator, Sequence`. Just convert to `list` as you do in some other places.",
    "created_at": "2017-06-23T14:43:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346044",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:48" align="right">comment:48</div>

6. In `src/sage/matrix/matrix_modn_sparse.pyx`, there is no reason to raise an error for input which is not `Iterator, Sequence`. Just convert to `list` as you do in some other places.



---

archive/issue_comments_346045.json:
```json
{
    "body": "Changed commit from **[`54645bb`](https://github.com/sagemath/sagetrac-mirror/commit/54645bb8c4320a2a0b685771c3e4e69582cde286)** to **[`a4bce3b`](https://github.com/sagemath/sagetrac-mirror/commit/a4bce3b1dae3d961a5ed301fa37e287f0195a745)**",
    "created_at": "2017-06-24T08:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346045",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`54645bb`](https://github.com/sagemath/sagetrac-mirror/commit/54645bb8c4320a2a0b685771c3e4e69582cde286)** to **[`a4bce3b`](https://github.com/sagemath/sagetrac-mirror/commit/a4bce3b1dae3d961a5ed301fa37e287f0195a745)**



---

archive/issue_comments_346046.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39b799a9a7448e6491d0726495c6bad8b6f7fbfb\"><code>39b799a</code></a></td><td><code>Merge branch 'public/23107-v2' in 8.0.b12</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4bce3b1dae3d961a5ed301fa37e287f0195a745\"><code>a4bce3b</code></a></td><td><code>trac 2310\u00e8 some work on reviewer's comments</code></td></tr></table>\n",
    "created_at": "2017-06-24T08:03:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346046",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39b799a9a7448e6491d0726495c6bad8b6f7fbfb"><code>39b799a</code></a></td><td><code>Merge branch 'public/23107-v2' in 8.0.b12</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4bce3b1dae3d961a5ed301fa37e287f0195a745"><code>a4bce3b</code></a></td><td><code>trac 2310è some work on reviewer's comments</code></td></tr></table>




---

archive/issue_comments_346047.json:
```json
{
    "body": "<div id=\"comment:50\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e2c758798bf8a5d873f9b3b6020706ed55f81e0d\"><code>e2c7587</code></a></td><td><code>trac 23107 fixing things</code></td></tr></table>\n",
    "created_at": "2017-06-24T12:50:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346047",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:50"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e2c758798bf8a5d873f9b3b6020706ed55f81e0d"><code>e2c7587</code></a></td><td><code>trac 23107 fixing things</code></td></tr></table>




---

archive/issue_comments_346048.json:
```json
{
    "body": "Changed commit from **[`a4bce3b`](https://github.com/sagemath/sagetrac-mirror/commit/a4bce3b1dae3d961a5ed301fa37e287f0195a745)** to **[`e2c7587`](https://github.com/sagemath/sagetrac-mirror/commit/e2c758798bf8a5d873f9b3b6020706ed55f81e0d)**",
    "created_at": "2017-06-24T12:50:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346048",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a4bce3b`](https://github.com/sagemath/sagetrac-mirror/commit/a4bce3b1dae3d961a5ed301fa37e287f0195a745)** to **[`e2c7587`](https://github.com/sagemath/sagetrac-mirror/commit/e2c758798bf8a5d873f9b3b6020706ed55f81e0d)**



---

archive/issue_comments_346049.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nI think I have taken all of your comments into account. Back to needs review.",
    "created_at": "2017-06-24T12:53:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346049",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:51" align="right">comment:51</div>

I think I have taken all of your comments into account. Back to needs review.



---

archive/issue_events_323672.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-06-24T12:53:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323672"
}
```



---

archive/issue_events_323673.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-06-24T12:53:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323673"
}
```



---

archive/issue_comments_346050.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nIn `parent_old.pyx`, better give up on trying to list all possible exceptions. If you replace that by `except Exception`, you can set this to positive review.",
    "created_at": "2017-06-26T08:22:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346050",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">comment:52</div>

In `parent_old.pyx`, better give up on trying to list all possible exceptions. If you replace that by `except Exception`, you can set this to positive review.



---

archive/issue_events_323674.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-26T08:22:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323674"
}
```



---

archive/issue_events_323675.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2017-06-26T08:22:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323675"
}
```



---

archive/issue_comments_346051.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aa3319f7a7a92f3b5507f7d11f4a7c0d8ff0a49b\"><code>aa3319f</code></a></td><td><code>Replace list with generic Exception catch in old parents.</code></td></tr></table>\n",
    "created_at": "2017-06-26T11:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346051",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aa3319f7a7a92f3b5507f7d11f4a7c0d8ff0a49b"><code>aa3319f</code></a></td><td><code>Replace list with generic Exception catch in old parents.</code></td></tr></table>




---

archive/issue_comments_346052.json:
```json
{
    "body": "Changed commit from **[`e2c7587`](https://github.com/sagemath/sagetrac-mirror/commit/e2c758798bf8a5d873f9b3b6020706ed55f81e0d)** to **[`aa3319f`](https://github.com/sagemath/sagetrac-mirror/commit/aa3319f7a7a92f3b5507f7d11f4a7c0d8ff0a49b)**",
    "created_at": "2017-06-26T11:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346052",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e2c7587`](https://github.com/sagemath/sagetrac-mirror/commit/e2c758798bf8a5d873f9b3b6020706ed55f81e0d)** to **[`aa3319f`](https://github.com/sagemath/sagetrac-mirror/commit/aa3319f7a7a92f3b5507f7d11f4a7c0d8ff0a49b)**



---

archive/issue_events_323676.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-06-26T12:01:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323676"
}
```



---

archive/issue_events_323677.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-06-26T12:01:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323677"
}
```



---

archive/issue_comments_346053.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nI took care of it.",
    "created_at": "2017-06-26T12:01:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346053",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:54" align="right">comment:54</div>

I took care of it.



---

archive/issue_comments_346054.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer, Travis Scrimshaw** to **Jeroen Demeyer, Travis Scrimshaw, Fr\u00e9d\u00e9ric Chapoton**",
    "created_at": "2017-06-26T12:01:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346054",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Jeroen Demeyer, Travis Scrimshaw** to **Jeroen Demeyer, Travis Scrimshaw, Frédéric Chapoton**



---

archive/issue_events_323678.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-06-29T06:46:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323678"
}
```



---

archive/issue_events_323679.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "439836f9f16ff41438054c8e447946ca2b46720d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-06-29T06:46:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23107#event-323679"
}
```



---

archive/issue_comments_346055.json:
```json
{
    "body": "Changed branch from **[public/23107-v2](https://github.com/sagemath/sagetrac-mirror/tree/public/23107-v2)** to **[`aa3319f`](https://github.com/sagemath/sagetrac-mirror/commit/aa3319f7a7a92f3b5507f7d11f4a7c0d8ff0a49b)**",
    "created_at": "2017-06-29T06:46:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23107#issuecomment-346055",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/23107-v2](https://github.com/sagemath/sagetrac-mirror/tree/public/23107-v2)** to **[`aa3319f`](https://github.com/sagemath/sagetrac-mirror/commit/aa3319f7a7a92f3b5507f7d11f4a7c0d8ff0a49b)**
