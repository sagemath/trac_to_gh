# Issue 23403: Crash with applying divided_difference in SchubertPolynomialRing

archive/issues_023166.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: X = SchubertPolynomialRing(ZZ)\nsage: a = X([3,2,4,1])\nsage: a.divided_difference(2)\npython: : Unknown error -315708632\n```\nThe error number is random every time. The result should be 0.\n\nCC:  @sagetrac-sage-combinat @nthiery @VivianePons @fchapoton @darijgr\n\nKeywords: **Schubert, symmetrica**\n\nBranch: **[c3bfaaf](https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34)**\n\nReviewer: **Darij Grinberg**\n\nAuthor: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/23403_\n\n",
    "closed_at": "2017-09-04T06:11:13Z",
    "created_at": "2017-07-12T01:23:20Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-8.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Crash with applying divided_difference in SchubertPolynomialRing",
    "type": "issue",
    "updated_at": "2023-01-08T10:10:18Z",
    "url": "https://github.com/sagemath/sage/issues/23403",
    "user": "https://github.com/tscrim"
}
```

```
sage: X = SchubertPolynomialRing(ZZ)
sage: a = X([3,2,4,1])
sage: a.divided_difference(2)
python: : Unknown error -315708632
```
The error number is random every time. The result should be 0.

CC:  @sagetrac-sage-combinat @nthiery @VivianePons @fchapoton @darijgr

Keywords: **Schubert, symmetrica**

Branch: **[c3bfaaf](https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34)**

Reviewer: **Darij Grinberg**

Author: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/23403_





---

archive/issue_events_307754.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-12T01:23:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307754"
}
```



---

archive/issue_events_307755.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-12T01:23:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "component: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307755"
}
```



---

archive/issue_events_307756.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-12T01:23:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307756"
}
```



---

archive/issue_events_307757.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-12T01:23:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307757"
}
```



---

archive/issue_comments_354124.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nOkay, I've traced the problem down to the fact that there might be no monomials in the Schubert polynomial. Yet it is still a pointer to a non-`NULL` Schubert polynomial, so the code does not translate it to `0`.",
    "created_at": "2017-07-12T02:22:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354124",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:1" align="right">Comment 1</div>

Okay, I've traced the problem down to the fact that there might be no monomials in the Schubert polynomial. Yet it is still a pointer to a non-`NULL` Schubert polynomial, so the code does not translate it to `0`.



---

archive/issue_comments_354125.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,6 +3,6 @@\n sage: X = SchubertPolynomialRing(ZZ)\n sage: a = X([3,2,4,1])\n sage: a.divided_difference(2)\n-python: \ufffd: Unknown error -315708632\n+python: : Unknown error -315708632\n ```\n The error number is random every time.\n``````\n",
    "created_at": "2017-07-12T02:22:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354125",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,6 +3,6 @@
 sage: X = SchubertPolynomialRing(ZZ)
 sage: a = X([3,2,4,1])
 sage: a.divided_difference(2)
-python: ï¿½: Unknown error -315708632
+python: : Unknown error -315708632
 ```
 The error number is random every time.
``````




---

archive/issue_events_307758.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-12T04:21:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307758"
}
```



---

archive/issue_comments_354126.json:
```json
{
    "body": "Branch: **[public/combinat/symmetrica_crash-23403](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/symmetrica_crash-23403)**",
    "created_at": "2017-07-12T04:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354126",
    "user": "https://github.com/tscrim"
}
```

Branch: **[public/combinat/symmetrica_crash-23403](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/symmetrica_crash-23403)**



---

archive/issue_events_307759.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-07-12T04:21:10Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "title_is": "Crash with applying divided_difference in SchubertPolynomialRing",
    "title_was": "Crash with SchubertPolynomialRing",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307759"
}
```



---

archive/issue_comments_354127.json:
```json
{
    "body": "Changed keywords from none to **Schubert, symmetrica**",
    "created_at": "2017-07-12T04:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354127",
    "user": "https://github.com/tscrim"
}
```

Changed keywords from none to **Schubert, symmetrica**



---

archive/issue_comments_354128.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nSo the 0 Schubert polynomial is initialized to an empty list, which behaves differently from, e.g., Schur functions. Because of this, the code tries to get the next pointer starting from a null pointer, resulting in a crash within Symmetrica in a way that is not done within a `sig_on`/`sig_off` block. I also fix up some other corner cases.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2afcd0bdee08e5ebc2eddfddfc990e4a40d1e601\">2afcd0b</a></td><td><code>Fixing handling of objects for Schuberts.</code></td></tr></table>\n",
    "created_at": "2017-07-12T04:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354128",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:2" align="right">Comment 2</div>

So the 0 Schubert polynomial is initialized to an empty list, which behaves differently from, e.g., Schur functions. Because of this, the code tries to get the next pointer starting from a null pointer, resulting in a crash within Symmetrica in a way that is not done within a `sig_on`/`sig_off` block. I also fix up some other corner cases.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2afcd0bdee08e5ebc2eddfddfc990e4a40d1e601">2afcd0b</a></td><td><code>Fixing handling of objects for Schuberts.</code></td></tr></table>




---

archive/issue_comments_354129.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,4 +5,4 @@\n sage: a.divided_difference(2)\n python: : Unknown error -315708632\n ```\n-The error number is random every time.\n+The error number is random every time. The result should be 0.\n``````\n",
    "created_at": "2017-07-12T04:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354129",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,4 +5,4 @@
 sage: a.divided_difference(2)
 python: : Unknown error -315708632
 ```
-The error number is random every time.
+The error number is random every time. The result should be 0.
``````




---

archive/issue_comments_354130.json:
```json
{
    "body": "Commit: **[2afcd0b](https://github.com/sagemath/sagetrac-mirror/commit/2afcd0bdee08e5ebc2eddfddfc990e4a40d1e601)**",
    "created_at": "2017-07-12T04:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354130",
    "user": "https://github.com/tscrim"
}
```

Commit: **[2afcd0b](https://github.com/sagemath/sagetrac-mirror/commit/2afcd0bdee08e5ebc2eddfddfc990e4a40d1e601)**



---

archive/issue_comments_354131.json:
```json
{
    "body": "Author: **Travis Scrimshaw**",
    "created_at": "2017-07-12T04:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354131",
    "user": "https://github.com/tscrim"
}
```

Author: **Travis Scrimshaw**



---

archive/issue_comments_354132.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\ntypos:\n\n```\nFor convienence\n```\n\n```\nThis is compatibile\n```",
    "created_at": "2017-07-12T06:21:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354132",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">Comment 3</div>

typos:

```
For convienence
```

```
This is compatibile
```



---

archive/issue_comments_354133.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd5629b42eba476c4235f5787d9fbbe7ed18a1c3\">bd5629b</a></td><td><code>Fixing typos.</code></td></tr></table>\n",
    "created_at": "2017-07-12T06:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354133",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4" align="right">Comment 4</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd5629b42eba476c4235f5787d9fbbe7ed18a1c3">bd5629b</a></td><td><code>Fixing typos.</code></td></tr></table>




---

archive/issue_comments_354134.json:
```json
{
    "body": "Changed commit from **[2afcd0b](https://github.com/sagemath/sagetrac-mirror/commit/2afcd0bdee08e5ebc2eddfddfc990e4a40d1e601)** to **[bd5629b](https://github.com/sagemath/sagetrac-mirror/commit/bd5629b42eba476c4235f5787d9fbbe7ed18a1c3)**",
    "created_at": "2017-07-12T06:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354134",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[2afcd0b](https://github.com/sagemath/sagetrac-mirror/commit/2afcd0bdee08e5ebc2eddfddfc990e4a40d1e601)** to **[bd5629b](https://github.com/sagemath/sagetrac-mirror/commit/bd5629b42eba476c4235f5787d9fbbe7ed18a1c3)**



---

archive/issue_comments_354135.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nI still don't understand which divided difference operator is meant, and what i is. Is it the delta^i in DIFF.2.4 of http://www.math.ku.dk/~thorup/notes/sympol.pdf ?",
    "created_at": "2017-07-12T10:01:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354135",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:5" align="right">Comment 5</div>

I still don't understand which divided difference operator is meant, and what i is. Is it the delta^i in DIFF.2.4 of http://www.math.ku.dk/~thorup/notes/sympol.pdf ?



---

archive/issue_comments_354136.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nHere is what the code gives:\n\n```\nsage: a = X([3,2,1])\nsage: a.expand()\nx0^2*x1\nsage: for w in Permutations(3):\n....:     if not w.reduced_word():\n....:         continue\n....:     print w.reduced_word(),\n....:     print a.divided_difference(w).expand()\n[2] x0^2\n[1] x0*x1\n[1, 2] x0\n[2, 1] x0 + x1\n[2, 1, 2] 1\n```\nYou can tell that `i` acts on the `i`-th variable (although there is a 1-based to 0-based shift needed), and there does not seem to be any signs involved.",
    "created_at": "2017-07-12T14:39:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354136",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:6" align="right">Comment 6</div>

Here is what the code gives:

```
sage: a = X([3,2,1])
sage: a.expand()
x0^2*x1
sage: for w in Permutations(3):
....:     if not w.reduced_word():
....:         continue
....:     print w.reduced_word(),
....:     print a.divided_difference(w).expand()
[2] x0^2
[1] x0*x1
[1, 2] x0
[2, 1] x0 + x1
[2, 1, 2] 1
```
You can tell that `i` acts on the `i`-th variable (although there is a 1-based to 0-based shift needed), and there does not seem to be any signs involved.



---

archive/issue_comments_354137.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nFor the definition of the difference operator, see section 2 of http://www.math.cornell.edu/~allenk/schubnotes.pdf",
    "created_at": "2017-07-13T07:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354137",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:7" align="right">Comment 7</div>

For the definition of the difference operator, see section 2 of http://www.math.cornell.edu/~allenk/schubnotes.pdf



---

archive/issue_comments_354138.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nThanks Fr\u00e9d\u00e9ric. I'm pushing an improved doc.\n\nHowever, I think the new behavior, raising errors when there are not enough variables, is wrong. The Schubert polynomial ring is in infinitely many variables by definition; a polynomial isn't \"missing\" a variable; it just happens to be degree-0 with respect to it.\n\n```\nsage: a = X([1,2,3,4,5])\nsage: a.divided_difference(4)\n```\nThis should yield 0, not an exception!",
    "created_at": "2017-07-13T10:30:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354138",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:8" align="right">Comment 8</div>

Thanks FrÃ©dÃ©ric. I'm pushing an improved doc.

However, I think the new behavior, raising errors when there are not enough variables, is wrong. The Schubert polynomial ring is in infinitely many variables by definition; a polynomial isn't "missing" a variable; it just happens to be degree-0 with respect to it.

```
sage: a = X([1,2,3,4,5])
sage: a.divided_difference(4)
```
This should yield 0, not an exception!



---

archive/issue_comments_354139.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/799527dcae2fd231d3d7fc3330c8b6d9e88c6c14\">799527d</a></td><td><code>Merge branch 'public/combinat/symmetrica_crash-23403' of git://trac.sagemath.org/sage into schub</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f0ee907dd3f6d7324ae683384a1664da217d0ef\">7f0ee90</a></td><td><code>document divided difference operators</code></td></tr></table>\n",
    "created_at": "2017-07-13T10:32:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354139",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9" align="right">Comment 9</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/799527dcae2fd231d3d7fc3330c8b6d9e88c6c14">799527d</a></td><td><code>Merge branch 'public/combinat/symmetrica_crash-23403' of git://trac.sagemath.org/sage into schub</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f0ee907dd3f6d7324ae683384a1664da217d0ef">7f0ee90</a></td><td><code>document divided difference operators</code></td></tr></table>




---

archive/issue_comments_354140.json:
```json
{
    "body": "Changed commit from **[bd5629b](https://github.com/sagemath/sagetrac-mirror/commit/bd5629b42eba476c4235f5787d9fbbe7ed18a1c3)** to **[7f0ee90](https://github.com/sagemath/sagetrac-mirror/commit/7f0ee907dd3f6d7324ae683384a1664da217d0ef)**",
    "created_at": "2017-07-13T10:32:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354140",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[bd5629b](https://github.com/sagemath/sagetrac-mirror/commit/bd5629b42eba476c4235f5787d9fbbe7ed18a1c3)** to **[7f0ee90](https://github.com/sagemath/sagetrac-mirror/commit/7f0ee907dd3f6d7324ae683384a1664da217d0ef)**



---

archive/issue_comments_354141.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@darijgr](#comment%3A8):\n> However, I think the new behavior, raising errors when there are not enough variables, is wrong. The Schubert polynomial ring is in infinitely many variables by definition; a polynomial isn't \"missing\" a variable; it just happens to be degree-0 with respect to it.\n> \n> ```\n> sage: a = X([1,2,3,4,5])\n> sage: a.divided_difference(4)\n> ```\n> This should yield 0, not an exception!\n\nThat's not new behavior. The only change in behavior is for 0, which is a special case IMO. There is some reason to consider this an error by considering this as the restriction to a finite number of variables. So there is some room for debate, and as such, it should go on another ticket (there's enough \"ticket creep\" already).\n\nI do not disagree with you that it is more natural for it to be 0, but you also need the same behavior to happen for permutation input. If you're not careful with that input and let symmetrica try to handle it, it can result in crashes or other strange behavior (I can find the ticket that talks about it if you want). So I don't see this as being a simple change either and is another reason to put it on a separate ticket.",
    "created_at": "2017-07-13T13:40:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354141",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@darijgr](#comment%3A8):
> However, I think the new behavior, raising errors when there are not enough variables, is wrong. The Schubert polynomial ring is in infinitely many variables by definition; a polynomial isn't "missing" a variable; it just happens to be degree-0 with respect to it.
> 
> ```
> sage: a = X([1,2,3,4,5])
> sage: a.divided_difference(4)
> ```
> This should yield 0, not an exception!

That's not new behavior. The only change in behavior is for 0, which is a special case IMO. There is some reason to consider this an error by considering this as the restriction to a finite number of variables. So there is some room for debate, and as such, it should go on another ticket (there's enough "ticket creep" already).

I do not disagree with you that it is more natural for it to be 0, but you also need the same behavior to happen for permutation input. If you're not careful with that input and let symmetrica try to handle it, it can result in crashes or other strange behavior (I can find the ticket that talks about it if you want). So I don't see this as being a simple change either and is another reason to put it on a separate ticket.



---

archive/issue_comments_354142.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nOh, I just realized that you didn't add the \"if i > max_a\" check. I'll open a new ticket for this.",
    "created_at": "2017-07-13T13:43:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354142",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:11" align="right">Comment 11</div>

Oh, I just realized that you didn't add the "if i > max_a" check. I'll open a new ticket for this.



---

archive/issue_comments_354143.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nWhy are you using `X.element_class(X, z_elt)` instead of using something like `sum_of_terms`? Isn't `X` a CombinatorialFreeModule?",
    "created_at": "2017-07-13T13:48:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354143",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:12" align="right">Comment 12</div>

Why are you using `X.element_class(X, z_elt)` instead of using something like `sum_of_terms`? Isn't `X` a CombinatorialFreeModule?



---

archive/issue_comments_354144.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nCreated #23423 for the ValueError issue.",
    "created_at": "2017-07-13T13:51:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354144",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:13" align="right">Comment 13</div>

Created #23423 for the ValueError issue.



---

archive/issue_comments_354145.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@darijgr](#comment%3A12):\n> Why are you using `X.element_class(X, z_elt)` instead of using something like `sum_of_terms`? Isn't `X` a CombinatorialFreeModule?\n\nYes, and I am taking advantage of that because `z_elt` is a dict with coefficients in the proper ring. The other way would be `X._from_dict(z_elt, coerce=False, remove_zeros=False)`, but that just does exactly as above.",
    "created_at": "2017-07-13T13:54:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354145",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@darijgr](#comment%3A12):
> Why are you using `X.element_class(X, z_elt)` instead of using something like `sum_of_terms`? Isn't `X` a CombinatorialFreeModule?

Yes, and I am taking advantage of that because `z_elt` is a dict with coefficients in the proper ring. The other way would be `X._from_dict(z_elt, coerce=False, remove_zeros=False)`, but that just does exactly as above.



---

archive/issue_comments_354146.json:
```json
{
    "body": "Changed commit from **[7f0ee90](https://github.com/sagemath/sagetrac-mirror/commit/7f0ee907dd3f6d7324ae683384a1664da217d0ef)** to **[1aaca0f](https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131)**",
    "created_at": "2017-07-13T13:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354146",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7f0ee90](https://github.com/sagemath/sagetrac-mirror/commit/7f0ee907dd3f6d7324ae683384a1664da217d0ef)** to **[1aaca0f](https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131)**



---

archive/issue_comments_354147.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131\">1aaca0f</a></td><td><code>document a confusing notation</code></td></tr></table>\n",
    "created_at": "2017-07-13T13:57:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354147",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15" align="right">Comment 15</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131">1aaca0f</a></td><td><code>document a confusing notation</code></td></tr></table>




---

archive/issue_comments_354148.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nAh.\n\nActually, are you sure that `remove_zeros=False` is correct here? I don't understand the code, but I don't see where it properly coerces to the base ring and throws away resulting zeroes.",
    "created_at": "2017-07-13T14:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354148",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:16" align="right">Comment 16</div>

Ah.

Actually, are you sure that `remove_zeros=False` is correct here? I don't understand the code, but I don't see where it properly coerces to the base ring and throws away resulting zeroes.



---

archive/issue_comments_354149.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nIt definitely makes things no worse than before. There is not really any coercion but instead is just trying to make a corresponding element in Sage; it is referencing an external library (symmetrica) that does not implement a notion of parents. So I think the result could be a little loose with the parent it returns. Again, another ticket.",
    "created_at": "2017-07-13T14:10:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354149",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:17" align="right">Comment 17</div>

It definitely makes things no worse than before. There is not really any coercion but instead is just trying to make a corresponding element in Sage; it is referencing an external library (symmetrica) that does not implement a notion of parents. So I think the result could be a little loose with the parent it returns. Again, another ticket.



---

archive/issue_comments_354150.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nOh, but zeros should be removed by symmetrica IIRC.",
    "created_at": "2017-07-13T14:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354150",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">Comment 18</div>

Oh, but zeros should be removed by symmetrica IIRC.



---

archive/issue_comments_354151.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nOK, I'm just seeing that the method plainly doesn't work over non-ZZ/QQ base rings. At least it's being honest about it:\n\n```\nValueError: a must be a Schubert polynomial over ZZ or QQ\n```\nThis is probably a BS restriction, and we should be using Symmetrica on monomials rather than on the whole polynomial.\n\nI'm getting more and more confused the longer I stare at the Schubert code. What exactly does the following method (in libs/symmetrica/sb.pxi) do?\n\n```\ndef divdiff_perm_schubert_symmetrica(perm, a):\n    r\"\"\"\n    Returns the result of applying the divided difference operator\n    $\\delta_i$ to $a$ where $a$ is either a permutation or a\n    Schubert polynomial over QQ.\n```\nI'm pretty sure there is at least one typo in the docstring.",
    "created_at": "2017-07-13T20:07:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354151",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:19" align="right">Comment 19</div>

OK, I'm just seeing that the method plainly doesn't work over non-ZZ/QQ base rings. At least it's being honest about it:

```
ValueError: a must be a Schubert polynomial over ZZ or QQ
```
This is probably a BS restriction, and we should be using Symmetrica on monomials rather than on the whole polynomial.

I'm getting more and more confused the longer I stare at the Schubert code. What exactly does the following method (in libs/symmetrica/sb.pxi) do?

```
def divdiff_perm_schubert_symmetrica(perm, a):
    r"""
    Returns the result of applying the divided difference operator
    $\delta_i$ to $a$ where $a$ is either a permutation or a
    Schubert polynomial over QQ.
```
I'm pretty sure there is at least one typo in the docstring.



---

archive/issue_comments_354152.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\n`i` to `perm`, but if `a` is a permutation, then it considered it to be the corresponding monomial in the `X` basis.\n\nI do not know if lrcalc can do these computations or not (I simply haven't looked), but there is a goal of replacing symmetrica by lrcalc IIRC. However, that is again for later. At least for now, can not have Sage crash when trying to do a computation rather than trying to completely clean this code? I am willing to split this ticket just to focus on the big problem at hand: the crash.",
    "created_at": "2017-07-13T23:54:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354152",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">Comment 20</div>

`i` to `perm`, but if `a` is a permutation, then it considered it to be the corresponding monomial in the `X` basis.

I do not know if lrcalc can do these computations or not (I simply haven't looked), but there is a goal of replacing symmetrica by lrcalc IIRC. However, that is again for later. At least for now, can not have Sage crash when trying to do a computation rather than trying to completely clean this code? I am willing to split this ticket just to focus on the big problem at hand: the crash.



---

archive/issue_comments_354153.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cadcdd62e3ab68c24a147c42cd417a515abcaba\">9cadcdd</a></td><td><code>refactoring divided_difference</code></td></tr></table>\n",
    "created_at": "2017-07-16T12:54:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354153",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21" align="right">Comment 21</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cadcdd62e3ab68c24a147c42cd417a515abcaba">9cadcdd</a></td><td><code>refactoring divided_difference</code></td></tr></table>




---

archive/issue_comments_354154.json:
```json
{
    "body": "Changed commit from **[1aaca0f](https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131)** to **[9cadcdd](https://github.com/sagemath/sagetrac-mirror/commit/9cadcdd62e3ab68c24a147c42cd417a515abcaba)**",
    "created_at": "2017-07-16T12:54:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354154",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1aaca0f](https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131)** to **[9cadcdd](https://github.com/sagemath/sagetrac-mirror/commit/9cadcdd62e3ab68c24a147c42cd417a515abcaba)**



---

archive/issue_comments_354155.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nI have rewritten `divided_difference` natively in Sage. The resulting function is significantly faster (around factor 2 on the examples I have tried, which involve Schubert polynomials X(pi) with pi \\in S_3, S_4, S_5) and free of the #23423 issue. There is more potential for optimization: the whole thing could be rewritten in Cython (not by me), and the `remove_extra_fixed_points` helper method on the `Permutation` class could be made into a standalone function that deals with lists (rather than permutations).\n\nIn the current commit, for the sake of reviewing, both the new and the old method can be used (the default is the new one; get the old one by setting the optional `newm` variable to `False`). I guess we'll want to get rid of the old one before merging.",
    "created_at": "2017-07-16T12:55:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354155",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:22" align="right">Comment 22</div>

I have rewritten `divided_difference` natively in Sage. The resulting function is significantly faster (around factor 2 on the examples I have tried, which involve Schubert polynomials X(pi) with pi \in S_3, S_4, S_5) and free of the #23423 issue. There is more potential for optimization: the whole thing could be rewritten in Cython (not by me), and the `remove_extra_fixed_points` helper method on the `Permutation` class could be made into a standalone function that deals with lists (rather than permutations).

In the current commit, for the sake of reviewing, both the new and the old method can be used (the default is the new one; get the old one by setting the optional `newm` variable to `False`). I guess we'll want to get rid of the old one before merging.



---

archive/issue_comments_354156.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-07-16T13:28:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354156",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23" align="right">Comment 23</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_354157.json:
```json
{
    "body": "Changed commit from **[9cadcdd](https://github.com/sagemath/sagetrac-mirror/commit/9cadcdd62e3ab68c24a147c42cd417a515abcaba)** to **[1aaca0f](https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131)**",
    "created_at": "2017-07-16T13:28:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354157",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9cadcdd](https://github.com/sagemath/sagetrac-mirror/commit/9cadcdd62e3ab68c24a147c42cd417a515abcaba)** to **[1aaca0f](https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131)**



---

archive/issue_comments_354158.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nThis is a great improvement and is faster on all of the examples I tested (including some relatively large permutations). However, it must go on another ticket as this ticket is about fixing the crash in symmetrica, which is independent of the divided difference functionality. I guess it is somewhat my fault for starting this. Yet, I will revert all of the other little changes if that is what it takes for us to focus on the problem of this ticket. I will review the followup tickets in exchange.\n\nI reverted this branch to `1aaca0f` as that is still in the general realm of the ticket, but I am considering a full rewrite. I put your current rewrite on the branch\n\n```\npublic/combinat/improve_schubert_divided_difference\n```",
    "created_at": "2017-07-16T13:33:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354158",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:24" align="right">Comment 24</div>

This is a great improvement and is faster on all of the examples I tested (including some relatively large permutations). However, it must go on another ticket as this ticket is about fixing the crash in symmetrica, which is independent of the divided difference functionality. I guess it is somewhat my fault for starting this. Yet, I will revert all of the other little changes if that is what it takes for us to focus on the problem of this ticket. I will review the followup tickets in exchange.

I reverted this branch to `1aaca0f` as that is still in the general realm of the ticket, but I am considering a full rewrite. I put your current rewrite on the branch

```
public/combinat/improve_schubert_divided_difference
```



---

archive/issue_comments_354159.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nIs the crash actually independent from the divided difference functionality? I thought only the `divided_difference` method would crash. If not, this definitely should be a standalone ticket (but one I cannot reasonably review, sadly).",
    "created_at": "2017-07-16T13:50:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354159",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:25" align="right">Comment 25</div>

Is the crash actually independent from the divided difference functionality? I thought only the `divided_difference` method would crash. If not, this definitely should be a standalone ticket (but one I cannot reasonably review, sadly).



---

archive/issue_comments_354160.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nYes, the crash occurs because symmetrica returns an empty-list object to represent `0` from the data type but the interpreter is expecting a null pointer for `0` (as is the case for, e.g., Schur functions). The main change is in `symmetrica.pxi`. I also made the extra change in `sb.pxi` to further protect against bad-input that leads to either grossly wrong results or a crash. All other changes are tangential.",
    "created_at": "2017-07-16T13:54:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354160",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:26" align="right">Comment 26</div>

Yes, the crash occurs because symmetrica returns an empty-list object to represent `0` from the data type but the interpreter is expecting a null pointer for `0` (as is the case for, e.g., Schur functions). The main change is in `symmetrica.pxi`. I also made the extra change in `sb.pxi` to further protect against bad-input that leads to either grossly wrong results or a crash. All other changes are tangential.



---

archive/issue_comments_354161.json:
```json
{
    "body": "Replying to [ticket:23403 tscrim]:\n> \n> ```\n> sage: X = SchubertPolynomialRing(ZZ)\n> sage: a = X([3,2,4,1])\n> sage: a.divided_difference(2)\n> python: : Unknown error -315708632\n> ```\n\nIs that the exact (verbatim) output that you get? On which system is that?\n\nI get\n\n```\nsage: SchubertPolynomialRing(ZZ)([3,2,4,1]).divided_difference(2)\npython: ------------------------------------------------------------------------\n/usr/local/src/sage-git/local/lib/python2.7/site-packages/cysignals/signals.so(+0x5f38)[0x7fcb98405f38]\n/usr/local/src/sage-git/local/lib/python2.7/site-packages/cysignals/signals.so(+0x5fa5)[0x7fcb98405fa5]\n/usr/local/src/sage-git/local/lib/python2.7/site-packages/cysignals/signals.so(+0x8db7)[0x7fcb98408db7]\n/lib64/libpthread.so.0(+0x10860)[0x7fcba0a9e860]\n/lib64/libc.so.6(strchrnul+0x23)[0x7fcba0085de3]\n[...truncated a lot...]\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n------------------------------------------------------------------------\nSegmentation fault\n```",
    "created_at": "2017-08-09T12:23:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354161",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [ticket:23403 tscrim]:
> 
> ```
> sage: X = SchubertPolynomialRing(ZZ)
> sage: a = X([3,2,4,1])
> sage: a.divided_difference(2)
> python: : Unknown error -315708632
> ```

Is that the exact (verbatim) output that you get? On which system is that?

I get

```
sage: SchubertPolynomialRing(ZZ)([3,2,4,1]).divided_difference(2)
python: ------------------------------------------------------------------------
/usr/local/src/sage-git/local/lib/python2.7/site-packages/cysignals/signals.so(+0x5f38)[0x7fcb98405f38]
/usr/local/src/sage-git/local/lib/python2.7/site-packages/cysignals/signals.so(+0x5fa5)[0x7fcb98405fa5]
/usr/local/src/sage-git/local/lib/python2.7/site-packages/cysignals/signals.so(+0x8db7)[0x7fcb98408db7]
/lib64/libpthread.so.0(+0x10860)[0x7fcba0a9e860]
/lib64/libc.so.6(strchrnul+0x23)[0x7fcba0085de3]
[...truncated a lot...]
------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
------------------------------------------------------------------------
Segmentation fault
```



---

archive/issue_comments_354162.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nSymmetrica code:\n\n```C\nOP s_mo_k(a) OP a;\n/* AK 100789 V1.0 */ /* AK 191289 V1.1 */ /* AK 200891 V1.3 */\n{\n    OBJECTSELF c;\n    if (a == NULL)\n        return error(\"s_mo_k:a == NULL\"),(OP)NULL;\n    if (S_O_K(a) != MONOM)\n        return error(\"s_mo_k:a  != MONOM\"),(OP)NULL;\n    c = s_o_s(a);\n    return(c.ob_monom->mo_koeff);\n}\n```\n\nYup, totally clear what it does :-)",
    "created_at": "2017-08-09T12:36:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354162",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">Comment 28</div>

Symmetrica code:

```C
OP s_mo_k(a) OP a;
/* AK 100789 V1.0 */ /* AK 191289 V1.1 */ /* AK 200891 V1.3 */
{
    OBJECTSELF c;
    if (a == NULL)
        return error("s_mo_k:a == NULL"),(OP)NULL;
    if (S_O_K(a) != MONOM)
        return error("s_mo_k:a  != MONOM"),(OP)NULL;
    c = s_o_s(a);
    return(c.ob_monom->mo_koeff);
}
```

Yup, totally clear what it does :-)



---

archive/issue_comments_354163.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nLet me guess, 100789 means 10th July 1989?\n\nThat said, the English-German hodgepodge has probably not been up to standards even by the 80s standards...",
    "created_at": "2017-08-09T12:53:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354163",
    "user": "https://github.com/darijgr"
}
```

<div id="comment:29" align="right">Comment 29</div>

Let me guess, 100789 means 10th July 1989?

That said, the English-German hodgepodge has probably not been up to standards even by the 80s standards...



---

archive/issue_comments_354164.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nReplying to [@jdemeyer](#comment%3A27):\n> Replying to [ticket:23403 tscrim]:\n> > \n> > ```\n> > sage: X = SchubertPolynomialRing(ZZ)\n> > sage: a = X([3,2,4,1])\n> > sage: a.divided_difference(2)\n> > python: : Unknown error -315708632\n> > ```\n\n> \n> Is that the exact (verbatim) output that you get?\n\nYes (other than the number that changes every time).\n\n> On which system is that?\n\nUbuntu 16.04 LTS (with 8.1.beta0)\n\nThe segfault is definitely the \"correct\" failure, but for some reason it seems Python is attempting to handle the error. *shrugs*",
    "created_at": "2017-08-09T14:02:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354164",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:30" align="right">Comment 30</div>

Replying to [@jdemeyer](#comment%3A27):
> Replying to [ticket:23403 tscrim]:
> > 
> > ```
> > sage: X = SchubertPolynomialRing(ZZ)
> > sage: a = X([3,2,4,1])
> > sage: a.divided_difference(2)
> > python: : Unknown error -315708632
> > ```

> 
> Is that the exact (verbatim) output that you get?

Yes (other than the number that changes every time).

> On which system is that?

Ubuntu 16.04 LTS (with 8.1.beta0)

The segfault is definitely the "correct" failure, but for some reason it seems Python is attempting to handle the error. *shrugs*



---

archive/issue_comments_354165.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a725130e5049a22caa4d84912dd0be05b287aa8f\">a725130</a></td><td><code>Merge branch 'public/combinat/symmetrica_crash-23403' of trac.sagemath.org:sage into public/combinat/symmetrica_crash-23403</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34\">c3bfaaf</a></td><td><code>Removing unneeded declaration.</code></td></tr></table>\n",
    "created_at": "2017-09-01T19:32:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354165",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31" align="right">Comment 31</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a725130e5049a22caa4d84912dd0be05b287aa8f">a725130</a></td><td><code>Merge branch 'public/combinat/symmetrica_crash-23403' of trac.sagemath.org:sage into public/combinat/symmetrica_crash-23403</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34">c3bfaaf</a></td><td><code>Removing unneeded declaration.</code></td></tr></table>




---

archive/issue_comments_354166.json:
```json
{
    "body": "Changed commit from **[1aaca0f](https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131)** to **[c3bfaaf](https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34)**",
    "created_at": "2017-09-01T19:32:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354166",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1aaca0f](https://github.com/sagemath/sagetrac-mirror/commit/1aaca0fd453b5dd37f236c48f9486e88e65cd131)** to **[c3bfaaf](https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34)**



---

archive/issue_comments_354167.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nDarij looked at this patch with me and gave a positive review.",
    "created_at": "2017-09-01T19:36:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354167",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:32" align="right">Comment 32</div>

Darij looked at this patch with me and gave a positive review.



---

archive/issue_events_307760.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-09-01T19:36:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307760"
}
```



---

archive/issue_events_307761.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-09-01T19:36:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307761"
}
```



---

archive/issue_events_307762.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-09-01T19:36:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "milestone_number": null,
    "milestone_title": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307762"
}
```



---

archive/issue_events_307763.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-09-01T19:36:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "milestone_number": null,
    "milestone_title": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307763"
}
```



---

archive/issue_comments_354168.json:
```json
{
    "body": "Reviewer: **Darij Grinberg**",
    "created_at": "2017-09-01T19:36:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354168",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Darij Grinberg**



---

archive/issue_comments_354169.json:
```json
{
    "body": "Changed branch from **[public/combinat/symmetrica_crash-23403](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/symmetrica_crash-23403)** to **[c3bfaaf](https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34)**",
    "created_at": "2017-09-04T06:11:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354169",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/combinat/symmetrica_crash-23403](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/symmetrica_crash-23403)** to **[c3bfaaf](https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34)**



---

archive/issue_events_307764.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-04T06:11:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307764"
}
```



---

archive/issue_events_307765.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "75742243d2ed8dcc2a414e6458e992ab7c7dec1a",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-09-04T06:11:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/23403#event-307765"
}
```



---

archive/issue_comments_354170.json:
```json
{
    "body": "Changed commit from **[c3bfaaf](https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34)** to none",
    "created_at": "2023-01-08T10:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/23403",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/23403#issuecomment-354170",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[c3bfaaf](https://github.com/sagemath/sagetrac-mirror/commit/c3bfaafa4b61ec8e08870558da0ad106f00f5c34)** to none
