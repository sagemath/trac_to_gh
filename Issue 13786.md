# Issue 13786: Bug fix and small improvement of spanning_trees_count

Issue created by migration from Trac.

Original creator: azi

Original creation time: 2013-01-22 22:52:18

Assignee: jason, ncohen, rlm

CC:  azi ncohen

The current implementation of spanning_trees_count returns 1 as the number of spanning trees for the empty graph


```
sage: G = Graph()
sage: G.spanning_trees_count()
1
```


which is of course incorrect. 

The attached patch fixes this and also removes the unnecessary call to abs().




---

Attachment


---

Comment by ncohen created at 2013-01-23 10:50:43

Helloooooooo !!

Well... Thinking about it, why isn't the empty set a good spanning tree for the empty graph ? And by the way, why do you think that you can remove this "abs" ? Can't this thing be negative sometimes ? I only saw that result with "abs" around `:-)`

Nathann


---

Comment by azi created at 2013-02-01 10:38:51

Changing status from new to needs_review.


---

Comment by azi created at 2013-02-01 10:47:30

Damn. I haven't seen your comment..



A tree is a connected graph with n vertices and n-1 edges. There is no subgraph of the empty graph having $-1$ edges and $0$ vertices hence there is no spanning tree of the empty graph. I have also tested the function in Mathematica which returns 0 as expected.

As for abs(). The matrix tree theorem states the following. Let L_{i,j} be the Laplacian matrix of a graph G from which we remove the i'th column and j'th row. Then the number of spanning trees is (-1)^{i+j}det(L_{i,j}) hence for i=j the expression simplifies to simply computing det(L_{i,j})


---

Comment by ncohen created at 2013-02-01 12:36:32

A tree is a set of edges such that the graph induced by the set of edges is connected. Hence there is one spanning tree of the empty graph.

I'm not playing with words, just saying that one can either expect 1 or 0 there...

For instance, people there expect 1 : http://oeis.org/A000272
And I guess that you will always need one when you define a recursion formula to compute it.

Agreed for you modification to "abs". Looks like everybody out there agrees that this is not needed `:-)`

Nathann


---

Comment by azi created at 2013-02-01 13:09:05

Yeah!

Though if you take this definition in mind the complete graph is itself a tree! 

I agree with your remark that this is probably just a matter of how you define it but then I think it Sage is not consistent with respect to the "is_tree" routine.


```
sage: G = graphs.EmptyGraph()
sage: G.is_tree()            
False
```



---

Comment by ncohen created at 2013-02-01 13:12:03

Ahaahh. Yep, now that's a problem `:-)`

Do we fix this instead, then ?

Nathann


---

Comment by azi created at 2013-02-01 15:49:54

I'll ask around (mathoverflow) a bit if there if there are any reasons for defining this quantity in either way and then we see! 

OKOKOK?


---

Comment by ncohen created at 2013-02-01 18:16:58

> OKOKOK?

+1 !

Nathann


---

Comment by azi created at 2013-02-01 20:32:36

http://mathoverflow.net/questions/120536/is-the-empty-graph-a-tree


---

Comment by azi created at 2013-02-02 11:43:46

The guys there seems to agree that


* The empty graph is not a tree. (OK in Sage)
* The empty graph is a forest. (OK in Sage)
* The empty graph is not connected. (FAIL in Sage)
* The number of spanning trees in the empty graph is 0. (FAIL in Sage)

Now I would suggest that I change the patch so that all things work as expected by the points above. What you think mr Cohen?


---

Comment by ncohen created at 2013-02-02 13:29:57

Hellooooooo !!

> The guys there seems to agree that
> 
> * The empty graph is not a tree. (OK in Sage)
> * The empty graph is a forest. (OK in Sage)
> * The empty graph is not connected. (FAIL in Sage)
> * The number of spanning trees in the empty graph is 0. (FAIL in Sage)
> 
> Now I would suggest that I change the patch so that all things work as expected by the points above. What you think mr Cohen?

Ahahahaah. Well I would have prefered that the empty graph be a tree and a forest, AND connected. And I still wonder how they deal with the fact that "there exists a path between any pair of vertices" in the empty graph... But WELL `:-D`

I'll review that patch if you write it ! And besides the connectedness of the empty graph, I totally love people that can go to such length over such trivial things `:-D`

Have fuuuuuuuuuuuuuuuun !!! `:-D`

Nathann


---

Comment by azi created at 2013-02-02 14:15:57

Yeah! If you look at the answers on the page you'll see that only Bourbaki defines the empty graph as being connected so it appears there is a French thing in defining things differently :-)))))

Anyhow I completely agree that this is non-important and trivial, but since I already raised this issue I'd like to have the best "fix for the crowd" possible.


---

Comment by ncohen created at 2013-02-03 20:59:47

Well, then ...

Nathann


---

Comment by ncohen created at 2013-02-03 20:59:47

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-02-04 09:58:58

Please fill in the Author / Reviewer fields with your real names.


---

Comment by jdemeyer created at 2013-02-09 12:14:45

Resolution: fixed
