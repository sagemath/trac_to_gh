# Issue 25463: Upgrade pexpect to 4.6.0

Issue created by migration from Trac.

Original creator: vklein

Original creation time: 2018-06-29 12:23:57

CC:  jdemeyer fbissey slelievre

As pexpect [PR#304](https://github.com/pexpect/pexpect/pull/304) is not merged we should port the patch `read_more_bytes.patch`.


---

Comment by jdemeyer created at 2018-06-29 13:02:13

I'll have a look at this right now, just in case it turns out to be trivial.


---

Comment by jdemeyer created at 2018-06-29 13:08:34

Changing keywords from "" to "days94".


---

Comment by jdemeyer created at 2018-06-29 13:39:51

Changing keywords from "days94" to "".


---

Comment by jdemeyer created at 2018-06-29 14:05:54

Changing keywords from "" to "days94".


---

Comment by vklein created at 2018-06-29 15:27:52

New commits:


---

Comment by vklein created at 2018-06-29 15:27:52

Set assignee to vklein.


---

Comment by git created at 2018-06-29 15:28:14

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vklein created at 2018-06-29 15:28:27

Remove assignee vklein.


---

Comment by vklein created at 2018-06-29 15:28:27

New commits:
----
New commits:


---

Comment by git created at 2018-06-29 16:47:39

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2018-06-29 16:48:39

After rebasing the upstream patch https://github.com/pexpect/pexpect/pull/304 this is trivial.


---

Comment by jdemeyer created at 2018-06-29 16:48:39

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2018-06-29 16:51:04

In case somebody wonders why the patch is needed:

*With* the Sage patch:

```
sage: %time _ = str(gp("2^2^22"))
CPU times: user 21 ms, sys: 21 ms, total: 42 ms
Wall time: 243 ms
```


*Without* the Sage patch:

```
sage: %time _ = str(gp("2^2^22"))
CPU times: user 213 ms, sys: 20 ms, total: 233 ms
Wall time: 432 ms
```



---

Comment by slelievre created at 2018-06-29 22:09:33

Changing keywords from "days94" to "days94, upgrade, pexpect".


---

Comment by vklein created at 2018-07-02 05:43:35

Changing status from needs_review to positive_review.


---

Comment by vklein created at 2018-07-02 05:43:35

All tests passed. Looks good to me.


---

Comment by saraedum created at 2018-07-09 08:58:58

Conda uses pexpect 4.6.0 already and strangely R hangs on the first invocation there. My first thought was that the 4.6.0 upgrade was to blame somehow but since Sage uses an almost unpatched pexpect in this ticket, this seems not to be the case.

It would be great if someone more familiar with pexpect could have a look at https://github.com/conda-forge/sagelib-feedstock/issues/19#issuecomment-402557595 and help out with some ideas there.

Sorry for the noise on this ticket (as this is somewhat unrelated.)


---

Comment by vbraun created at 2018-08-05 08:17:54

Resolution: fixed
