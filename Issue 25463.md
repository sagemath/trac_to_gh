# Issue 25463: Upgrade pexpect to 4.6.0

archive/issues_025463.json:
```json
{
    "body": "CC:  @jdemeyer @kiwifb @slel\n\nAs pexpect [PR#304](https://github.com/pexpect/pexpect/pull/304) is not merged we should port the patch `read_more_bytes.patch`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25700\n\n",
    "created_at": "2018-06-29T12:23:57Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.3",
    "title": "Upgrade pexpect to 4.6.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25463",
    "user": "@vinklein"
}
```
CC:  @jdemeyer @kiwifb @slel

As pexpect [PR#304](https://github.com/pexpect/pexpect/pull/304) is not merged we should port the patch `read_more_bytes.patch`.

Issue created by migration from https://trac.sagemath.org/ticket/25700





---

archive/issue_comments_359275.json:
```json
{
    "body": "I'll have a look at this right now, just in case it turns out to be trivial.",
    "created_at": "2018-06-29T13:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359275",
    "user": "@jdemeyer"
}
```

I'll have a look at this right now, just in case it turns out to be trivial.



---

archive/issue_comments_359276.json:
```json
{
    "body": "Changing keywords from \"\" to \"days94\".",
    "created_at": "2018-06-29T13:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359276",
    "user": "@jdemeyer"
}
```

Changing keywords from "" to "days94".



---

archive/issue_comments_359277.json:
```json
{
    "body": "Changing keywords from \"days94\" to \"\".",
    "created_at": "2018-06-29T13:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359277",
    "user": "@jdemeyer"
}
```

Changing keywords from "days94" to "".



---

archive/issue_comments_359278.json:
```json
{
    "body": "Changing keywords from \"\" to \"days94\".",
    "created_at": "2018-06-29T14:05:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359278",
    "user": "@jdemeyer"
}
```

Changing keywords from "" to "days94".



---

archive/issue_comments_359279.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-06-29T15:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359279",
    "user": "@vinklein"
}
```

New commits:



---

archive/issue_comments_359280.json:
```json
{
    "body": "Set assignee to @vinklein.",
    "created_at": "2018-06-29T15:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359280",
    "user": "@vinklein"
}
```

Set assignee to @vinklein.



---

archive/issue_comments_359281.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-06-29T15:28:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359281",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_359282.json:
```json
{
    "body": "Remove assignee @vinklein.",
    "created_at": "2018-06-29T15:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359282",
    "user": "@vinklein"
}
```

Remove assignee @vinklein.



---

archive/issue_comments_359283.json:
```json
{
    "body": "New commits:\n----\nNew commits:",
    "created_at": "2018-06-29T15:28:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359283",
    "user": "@vinklein"
}
```

New commits:
----
New commits:



---

archive/issue_comments_359284.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-06-29T16:47:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359284",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_359285.json:
```json
{
    "body": "After rebasing the upstream patch https://github.com/pexpect/pexpect/pull/304 this is trivial.",
    "created_at": "2018-06-29T16:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359285",
    "user": "@jdemeyer"
}
```

After rebasing the upstream patch https://github.com/pexpect/pexpect/pull/304 this is trivial.



---

archive/issue_comments_359286.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-06-29T16:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359286",
    "user": "@jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_359287.json:
```json
{
    "body": "In case somebody wonders why the patch is needed:\n\n**With** the Sage patch:\n\n```\nsage: %time _ = str(gp(\"2^2^22\"))\nCPU times: user 21 ms, sys: 21 ms, total: 42 ms\nWall time: 243 ms\n```\n\n\n**Without** the Sage patch:\n\n```\nsage: %time _ = str(gp(\"2^2^22\"))\nCPU times: user 213 ms, sys: 20 ms, total: 233 ms\nWall time: 432 ms\n```\n",
    "created_at": "2018-06-29T16:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359287",
    "user": "@jdemeyer"
}
```

In case somebody wonders why the patch is needed:

**With** the Sage patch:

```
sage: %time _ = str(gp("2^2^22"))
CPU times: user 21 ms, sys: 21 ms, total: 42 ms
Wall time: 243 ms
```


**Without** the Sage patch:

```
sage: %time _ = str(gp("2^2^22"))
CPU times: user 213 ms, sys: 20 ms, total: 233 ms
Wall time: 432 ms
```




---

archive/issue_comments_359288.json:
```json
{
    "body": "Changing keywords from \"days94\" to \"days94, upgrade, pexpect\".",
    "created_at": "2018-06-29T22:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359288",
    "user": "@slel"
}
```

Changing keywords from "days94" to "days94, upgrade, pexpect".



---

archive/issue_comments_359289.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-02T05:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359289",
    "user": "@vinklein"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_359290.json:
```json
{
    "body": "All tests passed. Looks good to me.",
    "created_at": "2018-07-02T05:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359290",
    "user": "@vinklein"
}
```

All tests passed. Looks good to me.



---

archive/issue_comments_359291.json:
```json
{
    "body": "Conda uses pexpect 4.6.0 already and strangely R hangs on the first invocation there. My first thought was that the 4.6.0 upgrade was to blame somehow but since Sage uses an almost unpatched pexpect in this ticket, this seems not to be the case.\n\nIt would be great if someone more familiar with pexpect could have a look at https://github.com/conda-forge/sagelib-feedstock/issues/19#issuecomment-402557595 and help out with some ideas there.\n\nSorry for the noise on this ticket (as this is somewhat unrelated.)",
    "created_at": "2018-07-09T08:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359291",
    "user": "@saraedum"
}
```

Conda uses pexpect 4.6.0 already and strangely R hangs on the first invocation there. My first thought was that the 4.6.0 upgrade was to blame somehow but since Sage uses an almost unpatched pexpect in this ticket, this seems not to be the case.

It would be great if someone more familiar with pexpect could have a look at https://github.com/conda-forge/sagelib-feedstock/issues/19#issuecomment-402557595 and help out with some ideas there.

Sorry for the noise on this ticket (as this is somewhat unrelated.)



---

archive/issue_comments_359292.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25463",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25463#issuecomment-359292",
    "user": "@vbraun"
}
```

Resolution: fixed
