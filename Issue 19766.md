# Issue 19766: Incorrect output of squarefree_decomposition for polynomials over finite fields

Issue created by migration from Trac.

Original creator: lackermans

Original creation time: 2016-02-02 16:04:34

CC:  wbhart mstreng

When using squarefree_decomposition on linear polynomials over a finite field, an incorrect unit part is returned.


```
sage: K.<x> = GF(7)[]
sage: (6*x+3).squarefree_decomposition()
(6) * (6*x + 3)
sage: (6*x+3).squarefree_decomposition().expand()
x + 4
sage: K.<x> = GF(5)[]
sage: (2*x).squarefree_decomposition()
(2) * 2*x
```



---

Comment by mstreng created at 2016-02-03 14:01:12

Is this a bug in Flint or does Sage wrap Flint incorrectly in `factor_helper`?


---

Comment by lackermans created at 2016-02-04 16:12:42

It seems Flint doesn't return a monic factor in case of a linear input. I attached a patch to "fix" it.
