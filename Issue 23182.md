# Issue 23182: New function can_assign_class() to partially replace is_extension_type()

Issue created by migration from https://trac.sagemath.org/ticket/23419

Original creator: jdemeyer

Original creation time: 2017-07-13 08:50:45

CC:  nthiery dkrenn

The semantics of both Python types and Cython types have changed a lot since `is_extension_type()` was first written. In order to make it more clear why `is_extension_type()` is used, I suggest to replace it by more specific function.

In this ticket, I implement a new function `can_assign_class(obj)` to determine whether `obj.__class__` can be assigned to.


---

Comment by jdemeyer created at 2017-07-13 09:44:01

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-07-13 09:44:01

New commits:


---

Comment by tscrim created at 2017-08-28 16:34:17

I think we should hide `_underlying_class` from the public interface (well, specifically tab-completion).

Also, why the change in the test order?

```diff
-            if not issubclass(self.__class__, Sets_parent_class) and not is_extension_type(self.__class__):
+            if can_assign_class(self) and not issubclass(self.__class__, Sets_parent_class):
```

(I don't object, but I am curious if there is a reason.)


---

Comment by jdemeyer created at 2017-08-28 20:50:09

Replying to [comment:6 tscrim]:
> Also, why the change in the test order?

Efficiency. Checking `can_assign_class` is very fast, so it's good to do that first.


---

Comment by git created at 2017-08-28 21:15:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-08-29 03:30:42

Thanks.


---

Comment by tscrim created at 2017-08-29 03:30:42

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-09-02 09:34:07

Resolution: fixed
