# Issue 22922: Deprecation from #5930 should not use inspect

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2017-06-07 13:16:23

CC:  rws nbruin kcrisman vbraun

In `src/sage/symbolic/ring.pyx`, there is this very unusual code:

```python
            if not hasattr(_the_element,'_fast_callable_') or not inspect.ismethod(_the_element._fast_callable_):
                # only warn if _the_element is not dynamic
                from sage.misc.superseded import deprecation
                deprecation(5930, "Substitution using function-call syntax and unnamed arguments is deprecated and will be removed from a future release of Sage; you can use named arguments instead, like EXPR(x=..., y=...)")
```

It's not clear to me what the intent of the condition involving `inspect.ismethod` is...

The problem is that this breaks doctests in #22747, which changes some attributes from non-methods to methods.


---

Comment by jdemeyer created at 2017-06-07 13:57:52

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-06-07 13:57:52

New commits:


---

Comment by kcrisman created at 2017-06-21 12:58:17

I don't have a problem with this solution and the doctests seem to be correct.  But see [comment:32:ticket:2516 here] for the exact place rws resolved this (with discussion in the 5-10 comments preceding that one).  [comment:43:ticket:2516 This comment] and [comment:44:ticket:2516 this one] have further discussion about exact implementation and/or reasons - `fast_callable` is something I never properly understood, unfortunately.

On a separate note, the cleanups for the hypergeometric plots are nice ... but why use `SR.var()` instead of just `var()`?  I presume this is to avoid injecting something but I don't want to have to teach people to use `SR.var('y')` when the current variant is annoying enough.


---

Comment by rws created at 2017-06-21 14:05:02

I'm ok with the deletion. Using inspect was ad-hoc anyway.


---

Comment by jdemeyer created at 2017-06-21 14:08:31

Replying to [comment:6 kcrisman]:
> why use `SR.var()` instead of just `var()`?

Well, `z = var('z')` is a bit confusing since it first injects `z` in the global namespace and then assigns it again to the variable `z`. So either we change it to

```
sage: var('z')
z
```

or

```
sage: z = SR.var('z')
```


Anyway, this is minor aspect of the patch which I will gladly revert.


---

Comment by kcrisman created at 2017-06-21 15:22:17

> Well, `z = var('z')` is a bit confusing since it first injects `z` in the global namespace and then assigns it again to the variable `z`. So either we change it to
> {{{
> sage: var('z')
> z
> }}}

This is one of the ways we have had it in the documentation, I think, but I guess somewhere along the line people wanted to not have an output line.  But I guess I prefer this to the `SR.var` since it is more likely to look like something a reader has seen before.  Definitely do like the making the hg function and plot in two separate lines, makes them much easier to read!


---

Comment by rws created at 2017-06-22 05:55:53

Replying to [comment:9 kcrisman]:
> This is one of the ways we have had it in the documentation, I think, but I guess somewhere along the line people wanted to not have an output line.

There is also sporadically `_ = var(...)` in the documentation.


---

Comment by jdemeyer created at 2017-06-22 08:19:47

So what should I do?

`@`krisman: do you agree with setting this ticket to positive_review after I change the doctests of the form

```
sage: z = SR.var('z')
```

to

```
sage: var('z')
z
```



---

Comment by kcrisman created at 2017-06-22 13:38:53

I do not have time to actually run doctests on this but the patchbot says all clear, and it sounds like none of us have a problem with this change, and your doctest change will be helpful in that spirit.  So I guess so?


---

Comment by git created at 2017-06-22 14:18:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kcrisman created at 2017-06-22 16:15:04

That seems fine.


---

Comment by jdemeyer created at 2017-06-22 18:03:49

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-06-25 15:45:17

Resolution: fixed
