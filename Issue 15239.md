# Issue 15239: Involutions on NSym and QSym part I

Issue created by migration from Trac.

Original creator: darij

Original creation time: 2013-12-01 06:55:48

CC:  tscrim sage-combinat zabrocki vbraun

Keywords: ncsf, nsym, qsym, sage-combinat, symmetric functions, compositions

This got much longer than I expected it to be because there are three "classical" involution on each of NSym and QSym and each can be computed on various bases. I ended up implementing only two of the involutions (star=rho and psi), leaving out omega (which is just a rescaled antipode) for part II.

The patch also fixes some doc, moves a reference, and changes various invocations of `Composition(spam)` to `Compositions()(spam)` for speed reasons (when `spam` really is just a list). Could a `_Compositions` (akin to `_Partitions`) be of use?


---

Attachment


---

Comment by darij created at 2013-12-01 06:57:03

Changing status from new to needs_review.


---

Comment by tscrim created at 2013-12-16 17:33:35

Hey Darij,

Here's the patch converted to a branch, along with some additional changes of mine which should net some (perhaps small) speedups (I didn't run any benchmarks, but attribute lookup is suppose to be faster than function calls). Specifically I changed `Compositions()(spam)` to `self._basis_keys(spam)` where appropriate. If you're happy with my changes, then you can set this to positive review.

Best,

Travis
----
New commits:


---

Comment by darij created at 2013-12-16 17:53:30

Hi Travis,

thanks a lot! I don't have git-sage running on this machine and I haven't had time to check all of your changes so far, but I can confirm that `_basis_keys` is the right way to go here. BUT please don't use `Composition([])`:

```
sage: %timeit S._basis_keys([])
100000 loops, best of 3: 6.38 us per loop
sage: %timeit Compositions()([])
100000 loops, best of 3: 9 us per loop
sage: %timeit Composition([])
100000 loops, best of 3: 11 us per loop
```

Generally, `Composition(something)` does some slow and dirty ducktyping and should be avoided whenever possible in code.


---

Comment by tscrim created at 2013-12-16 18:47:53

It's only used once and then the result is cached, and it's more readable. I don't have a strong opinion and will be happy to change it back.


---

Comment by git created at 2013-12-17 02:46:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2013-12-17 02:49:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2013-12-17 02:51:00

If you are fine with my added changes, feel free to set this to positive.

Thanks again for reviewing this undeservedly long patch...


---

Comment by tscrim created at 2013-12-17 06:09:44

Looks good to me.


---

Comment by tscrim created at 2013-12-17 06:09:44

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-02-02 22:07:07

Resolution: fixed
