# Issue 27823: Partial map from GF(q^m) to GF(q) is in Sage but not readily available

Issue created by migration from https://trac.sagemath.org/ticket/28060

Original creator: jsrn

Original creation time: 2019-06-26 08:06:22

CC:  caruso tscrim

Keywords: finitefield, rings

The following gives me a map from GF(5^2) to GF(5^6), but there's neither "inverse" or "section":


```
    sage: k.<a> = GF(5^2)
    sage: K, f = k.extension(3, map=True)
    sage: f(a) in K
    True
    sage: f.inverse(f(a))
    AttributeError:
    ...
    NotImplementedError: 
    sage: f.section()
    ---------------------------------------------------------------------------
    TypeError                                 Traceback (most recent call last)
    ...
    /opt/sage/sage_devel/local/lib/python2.7/site-packages/sage/rings/finite_rings/hom_finite_field.pyx in sage.rings.finite_rings.hom_finite_field.FiniteFieldHomomorphism_generic.section 
(build/cythonized/sage/rings/finite_rings/hom_finite_field.c:4900)()
    340               Defn: t |--> T^20 + 2*T^18 + T^16 + 2*T^13 + T^9 + 2*T^8 + T^7 + T^6 + T^5 + T^3 + 2*T^2 + T
    341         """
--> 342         return self._section_class(self)
    343 
    344     def __hash__(self):

    TypeError: 'NoneType' object is not callable
```


The latter calls, apparently incorrectly, the code that *does* produce a map and its partial inverse:


```
    sage: k.<t> = GF(3^7)
    sage: K.<T> = GF(3^21)
    sage: from sage.rings.finite_rings.hom_finite_field import FiniteFieldHomomorphism_generic
    sage: f = FiniteFieldHomomorphism_generic(Hom(k, K))
    sage: g = f.section()
    sage: g(f(a))
    a
```


On a related note, a redundant implementation of seemingly exactly this map is also available in `sage/coding/relative_finite_field_extension.py`. That implementation should probably be removed and its few uses in `sage/coding` be changed to use the one in `sage/rings/finite_rings/hom_finite_field.pyx`.


---

Comment by jsrn created at 2019-06-26 12:29:43

Oops, I should have updated my ancient Sage before posting this ticket: the `f.section()` method now works fine and gives a partial map from K to k which inverts `f`. Sorry for the noise!

For usability, I find it very strange that `f.inverse_image(f(a))` does not return `a`, but rather throws a `NotImplementedException`. I'm posting a patch that makes `inverse_image` behave like this.
----
New commits:


---

Comment by jsrn created at 2019-06-26 12:30:03

Changing status from new to needs_review.


---

Comment by bruno created at 2019-08-22 09:19:42

Hi Johan, I have two very minor comments: 

1. There is a typo `methid` instead of `method` in the documentation.
2. ``self.section()`` and ``b`` should have double backticks.

Otherwise, LGTM.


---

Comment by git created at 2019-08-22 10:10:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jsrn created at 2019-08-22 10:11:35

Cool, thanks Bruno!


---

Comment by jsrn created at 2019-08-22 10:11:35

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-08-26 22:14:56

Resolution: fixed
