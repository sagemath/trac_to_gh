# Issue 17278: email command line output

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2014-12-16 13:49:55

Using the email command is nice.

```
sage: email('root`@`localhost', 'hi', 'test')
Child process 9360 is sending email to root`@`localhost...
sage: Successfully sent an email to root`@`localhost.
```

Except that it isn't clear that the `sage:` prompt is actually usable.  Is there any way to make the prompt print after the message, or this is essentially some kind of race condition?


---

Comment by jdemeyer created at 2014-12-16 15:49:26

Replying to [ticket:17515 kcrisman]:
> Is there any way to make the prompt print after the message
Use the `block=True` argument :-)

This behaviour in intentional. From the source code:

```
    if not block:
        # Do a non-block sendmail, which is typically what a user wants, since it can take
        # a while to send an email.
```



---

Comment by jdemeyer created at 2014-12-16 15:50:27

We could make this a ticket about using `block=True` by default or close it as "wontfix".


---

Comment by kcrisman created at 2014-12-16 15:54:52

> We could make this a ticket about using `block=True` by default or close it as "wontfix".
Well, if it's intentional I suppose this is okay, but it still is confusing.  Do you have any other ideas for how to deal with this?  When I saw

```
sage: Successfully sent an email to root`@`localhost.
```

I was worried that typing anything at all would cause problems, much less `return` for a new prompt.


---

Comment by jdemeyer created at 2014-12-16 16:00:45

Well, the function is really meant for the notebook (it's defined in `sagenb/notebook/sage_email.py`) and then I guess the output just comes at the end of the cell where it's executed.

Perhaps one could make the default `block=True` except in the notebook? That would be easy to implement.


---

Comment by kcrisman created at 2014-12-16 16:14:26

It does come there, but I'm currently debugging the email, see https://github.com/sagemath/sagenb/pull/120 where there is something weird about doing it in the notebook - though I never tried using it before.  I don't know that `block=True` is that great if it keeps people from doing stuff while waiting for the email in the command line, though.  Maybe it should just be removed from the command line, since it needs to use the server somehow anyway...


---

Comment by jdemeyer created at 2014-12-16 16:24:07

Replying to [comment:5 kcrisman]:
> Maybe it should just be removed from the command line, since it needs to use the server somehow anyway...
The fact that it depends on an external package (`twisted` in this case) shouldn't be a reason to remove it. It works fine in the command line, so why not keep it?


---

Comment by kcrisman created at 2014-12-16 16:27:35

Okay.  But at least it would be nice to have an addition to the message if one is not embedded, to say you can keep using the command line.  If you have ideas about the sagenb thing of course that would be great too.


---

Comment by jdemeyer created at 2014-12-16 17:47:03

Replying to [comment:7 kcrisman]:
> But at least it would be nice to have an addition to the message if one is not embedded, to say you can keep using the command line.
Like I said, the easiest solution there would be to use `block=True` by default.

> If you have ideas about the sagenb thing of course that would be great too.
Which "sagenb thing"???


---

Comment by kcrisman created at 2014-12-16 17:50:33

> Like I said, the easiest solution there would be to use `block=True` by default.
Okay, if you think people will be cool with that.  You made it sound like this was bad because it might take a long time to send the email and they would have no prompt for that time (based on the code).
> > If you have ideas about the sagenb thing of course that would be great too.
> Which "sagenb thing"???
[Issue 120](https://github.com/sagemath/sagenb/pull/120).


---

Comment by jdemeyer created at 2014-12-16 18:09:22

Replying to [comment:9 kcrisman]:
> > Which "sagenb thing"???
> [Issue 120](https://github.com/sagemath/sagenb/pull/120).
Yes, I understood that, but I thought you wanted me to look at something specific on that ticket. If it's about removing the fork: I don't see why it should be removed (just saying "it doesn't work otherwise" is not a good explanation).


---

Comment by kcrisman created at 2014-12-16 18:47:33

> > [Issue 120](https://github.com/sagemath/sagenb/pull/120).
> Yes, I understood that, but I thought you wanted me to look at something specific on that ticket. If it's about removing the fork: I don't see why it should be removed (just saying "it doesn't work otherwise" is not a good explanation).
I was wondering about the green line not going away even after the email was sent.  I haven't tried without the rmartinjak branch... hmm, I see it _does_ work normally there.  Very interesting, thanks!  (Even if you don't know what you did, you did something.)

Edit: Anyway, let's wait to see what happens upstream before doing anything here.


---

Comment by jdemeyer created at 2014-12-16 20:30:08

Also note that what the way that `email()` works is quite unusual: it actually acts like a local email _server_. In my university network (and probably other places), this is blocked by a firewall for security reasons (normally users don't run email servers).


---

Comment by kcrisman created at 2014-12-16 21:43:49

Oh yes, and gmail and microsoft don't accept emails from this either :)


---

Comment by jdemeyer created at 2015-06-23 13:51:29

Changing component from interfaces to interfaces: optional.
