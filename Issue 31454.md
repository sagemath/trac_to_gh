# Issue 31454: Make mixed forms to de Rham complex

Issue created by migration from https://trac.sagemath.org/ticket/31691

Original creator: @mjungmath

Original creation time: 2021-04-19 10:20:39

CC:  egourgoulhon tscrim mkoeppe jhpalmieri

Keywords: chain_complex

We turn the algebra of mixed differential forms into a de Rham complex and add it to the category of `ChainComplexes`.


---

Comment by git created at 2021-04-20 17:10:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2021-04-20 17:14:29

Here is a first draft. Unfortunately I get an error with the current test:



```
sage: M = Manifold(2, 'M')
sage: X.<x,y> = M.chart()
sage: C = M.de_rham_complex()
sage: d0 = C.differential(0); d0
Exception raised:
...
ValueError: Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M is not in Category of modules over Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M
```


This is somewhat peculiar. Each algebra should automatically be a module over itself... Should I simply add the category to the scalar field algebra or does that need a broader fix?


---

Comment by git created at 2021-04-20 17:17:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2021-04-22 11:53:31

Replying to [comment:5 gh-mjungmath]:
> Here is a first draft. Unfortunately I get an error with the current test:
> 
> 
> {{{
> sage: M = Manifold(2, 'M')
> sage: X.<x,y> = M.chart()
> sage: C = M.de_rham_complex()
> sage: d0 = C.differential(0); d0
> Exception raised:
> ...
> ValueError: Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M is not in Category of modules over Algebra of differentiable scalar fields on the 2-dimensional differentiable manifold M
> }}}
> 
> This is somewhat peculiar. Each algebra should automatically be a module over itself... Should I simply add the category to the scalar field algebra or does that need a broader fix?

See #31713.


---

Comment by git created at 2021-04-22 21:21:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2021-04-22 21:23:05

This draft should already reflect what I have in mind. Comments are welcome.


---

Comment by @mjungmath created at 2021-04-23 09:34:21

I must apologize. I was extremely sloppy here: differentials are _no_ morphisms in the category of modules over scalar fields, they are morphisms in the category of modules over `K`!

I'll fix this.


---

Comment by @mjungmath created at 2021-04-23 18:32:59

That was expected. Same problem, but now with differential form modules not considered as vector spaces.

There should be _some_ way to define these morphisms, no?


---

Comment by git created at 2021-04-26 10:36:04

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by @mjungmath created at 2021-04-26 10:37:13

Changing status from new to needs_review.


---

Comment by @mjungmath created at 2021-04-26 10:37:13

Ready for review.


---

Comment by @mjungmath created at 2021-04-26 10:44:53

This is just a first step.

My idea (not for this ticket): Optimally, we want to cover our manifold by contractible chart domains. Therefore it would be helpful if we could determine whether an open subset is contractible or not. Perhaps this needs some input from the user. But then, we can probably check for exactness (I still have to think about it) and, other than that, construct Cech cohomology.


---

Comment by @mjungmath created at 2021-04-26 12:30:22

P.S. I said "simply connected" in the first place, but of course I meant _contractible_.


---

Comment by git created at 2021-04-28 07:22:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2021-04-28 11:33:43

Patchbot green.


---

Comment by tscrim created at 2021-04-30 06:21:41

I think it would be best to split off the cohomology ring into a separate file.

Do you want to give a special (latex) name to `zero` and `one`?

For the class-level docstring of `DeRahmComologyRing`:

```diff
-Define the de Rham cohomology ring of a de Rham complex.
The de Rham cohomology ring of a de Rham complex.
```


I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).

In your `cohomology()` method, you have both `\left.` and `\right.`. I don't understand the point of this.

The input block to `differential()` is over-indented. Also, remove the full-stop/period.


---

Comment by @mjungmath created at 2021-04-30 08:04:50

Replying to [comment:24 tscrim]:
> I think it would be best to split off the cohomology ring into a separate file.

Sounds reasonable.

> 
> Do you want to give a special (latex) name to `zero` and `one`?
> 

I don't think so. That would make more sense if we can distinguish cohomology classes properly.

> For the class-level docstring of `DeRahmComologyRing`:
> {{{#!diff
> -Define the de Rham cohomology ring of a de Rham complex.
> The de Rham cohomology ring of a de Rham complex.
> }}}

Thanks, done.

> I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).

What do you mean?

> In your `cohomology()` method, you have both `\left.` and `\right.`. I don't understand the point of this.

The point is that `\middle/` has the appropriate size.

> The input block to `differential()` is over-indented. Also, remove the full-stop/period.

Thanks, done.


---

Comment by tscrim created at 2021-04-30 08:08:39

Replying to [comment:25 gh-mjungmath]:
> Replying to [comment:24 tscrim]:
> > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).
> 
> What do you mean?

If you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.


---

Comment by @mjungmath created at 2021-04-30 08:12:53

Replying to [comment:26 tscrim]:
> Replying to [comment:25 gh-mjungmath]:
> > Replying to [comment:24 tscrim]:
> > > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).
> > 
> > What do you mean?
> 
> If you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.

Currently, there is not even a natural coercion implemented. The only coercion that would be admissible is the one from closed differential forms (and everything that is contained in it) into cohomology, but we don't have that subspace implemented. Therefore, it wouldn't even work with `_mul_`.


---

Comment by tscrim created at 2021-04-30 11:34:31

Replying to [comment:27 gh-mjungmath]:
> Replying to [comment:26 tscrim]:
> > Replying to [comment:25 gh-mjungmath]:
> > > Replying to [comment:24 tscrim]:
> > > > I don't think you should assume that the parents are the same for `cup` (unlike what you can do for `_mul_`).
> > > 
> > > What do you mean?
> > 
> > If you take the `cup` with something the coerces in (perhaps `2`?) but is not actually an element of the same parent, then it will either fail or could end up with an element that is not actually in the ring. However, for `_mul_`, this can never happen because the coercion framework would make sure both arguments belong to the same parent.
> 
> Currently, there is not even a natural coercion implemented. The only coercion that would be admissible is the one from closed differential forms (and everything that is contained in it) into cohomology, but we don't have that subspace implemented. Therefore, it wouldn't even work with `_mul_`.

However, it will fail with a much more reasonable message and it will be all setup for when there is a coercion implemented. Most importantly, it will handle the natural coercion from the scalar field into the ring, but `cup` will not. You should have `cup` simply redirect to `*`. This will also make it easier if this ever gets subclassed too.


---

Comment by @mjungmath created at 2021-04-30 16:24:51

Replying to [comment:28 tscrim]:
> However, it will fail with a much more reasonable message and it will be all setup for when there is a coercion implemented. Most importantly, it will handle the natural coercion from the scalar field into the ring, but `cup` will not. You should have `cup` simply redirect to `*`. This will also make it easier if this ever gets subclassed too.

It will get subclassed. My idea is that a characteristic class becomes a subclass of `DeRhamCohomologyClass` with a dedicated `representative` method.


---

Comment by @mjungmath created at 2021-04-30 16:25:16

So your idea is good. I will redirect `cup` to the product.


---

Comment by git created at 2021-04-30 21:39:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2021-04-30 21:41:31

Commit pushed. Wait for patchbot.


---

Comment by tscrim created at 2021-04-30 22:11:22

Green bot => positive review


---

Comment by @mjungmath created at 2021-05-01 10:08:53

Morally green?


---

Comment by tscrim created at 2021-05-02 01:44:01

Changing status from needs_review to positive_review.


---

Comment by @mjungmath created at 2021-05-08 13:25:33

Thanks for the review!


---

Comment by vbraun created at 2021-06-06 13:17:50

Resolution: fixed
