# Issue 13264: Elliptic Curve Enumeration by height

Issue created by migration from https://trac.sagemath.org/ticket/13436

Original creator: spice

Original creation time: 2012-09-06 17:42:52

Assignee: spice

Keywords: Elliptic curves, enumeration

Add functionality to Sage that allows one to enumerate elliptic curves over Q by height for a range of Weierstrass families of curve.

This code has grown from work with Wei Ho, who desired a way to enumerate curves over Q by height (where the height of a curve is a function of the coefficients in its Weierstrass model) so that the average value of some datum (e.g.rank, 2-Selmer size) could be computed for curves up to a given height. This code introduces a class, CurveEnumerator(), that computes lists of curves ordered by height for this purpose.


---

Attachment


---

Comment by spice created at 2012-09-17 22:01:28

Changing status from new to needs_review.


---

Comment by spice created at 2012-09-17 22:01:28

Version 1.0 patch posted. All new code (except for an added import statement in sage.schemes.elliptic_curves.all) is in a new file, curve_enumerator.py, in the sage.schemes.elliptic_curves directory. It's thoroughly documented and doctested, so hopefully its logic will straightforward enough to follow.


---

Comment by was created at 2012-09-25 18:48:52

For the three_selmer function, you need a doctest.

```
sage: magma('2+2')  # optional - magma
```


Then

```
sage -t --only_optional=magma curve_enumerator.py 
```

to test.


---

Comment by was created at 2012-09-25 18:50:32

Fix some docstring formatitng, e.g., the funny indent:

```
    def heights(self, lowerbound, upperbound):  
        """
        Return a list of permissable curve heights in the specified range
         (bounds inclusive), and for each height the equation coefficients
         that produce curves of that height.
```


This should output "100%":

```
...elliptic_curves$ sage -coverage curve_enumerator.py 
----------------------------------------------------------------------
curve_enumerator.py
ERROR: Please add a `TestSuite(s).run()` doctest.
SCORE curve_enumerator.py: 87% (35 of 40)

Missing documentation:
	 * __init__(self):
	 * __repr__(self):
	 * _coeffs_to_a_invariants(self, c):


Missing doctests:
	 * __init__(self):
	 * three_selmer(self, curves, rank=True, reduced=False, output_filename=None, problems_filename=None, \ proof=True, return_data=True, print_timing=True):
```



---

Comment by was created at 2012-09-25 18:52:04

* Here: `over Q up` I would put ``\\QQ`` or at `QQ`. 

* Either: Or: -- maybe instead a sublist of two things?

* weird formatting:

```
sage: C = EllipticCurveEnumerator(family="short_weierstrass")
sage: C.n_torsion?

       * "rank"              -- (Default True): Compute the rank versus
         size of the curve's torsion/n-torsion subgroup. If True, the
         n-torsion rank is computed (i.e. 0, 1 or 2). If set to False, the
         size of the n-torsion subgroup is computed instead (i.e. n^rank)
    
         * "output_filename" -- (Default None): If not None, the string
    
         name of the file to which the output will be saved.
```


 *  Restructure code so that this is natural:

```
v = EllipticCurveEnumerator(family="short_weierstrass", height=1000).ranks()
}}} 

Will need caching:
{{{
sage: from sage.misc.cachefunc import cached_method
sage: cached_method?
}}}


---

Comment by ohanar created at 2012-09-25 19:12:53

There are three `AssertionErrors` that should be `ValueErrors`.

also `two_selmer` and `three_selmer` have an extra space for the OUTPUT portion of the docstring.


---

Comment by ohanar created at 2012-09-25 19:15:40

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2013-05-17 21:06:29

I have uploaded a patch that cleans up the documentation.

Still needs works, I think


---

Comment by chapoton created at 2013-05-18 12:57:26

could please someone with magma add the missing doctest for "three_selmer" ?


---

Comment by cremona created at 2013-07-05 20:54:41

I applied the patches to 5.10 and ran the doctest and report the result here.

```
sage: C = EllipticCurveEnumerator(family="short_weierstrass") 
sage: L = C.coefficients_over_height_range(4, 4)                                                               
sage: R, P = C.three_selmer(L, rank=True,return_data=True,print_timing=False)                                  
sage: R                                                                                                        
[(4, [0, 0, 0, -1, -2], 1),
 (4, [0, 0, 0, -1, 2], 0),
 (4, [0, 0, 0, 0, -2], 1),
 (4, [0, 0, 0, 0, 2], 1),
 (4, [0, 0, 0, 1, -2], 0),
 (4, [0, 0, 0, 1, 2], 0)]
sage: P                                                                                                        
[]
```



---

Attachment

thanks for the help !


---

Comment by chapoton created at 2014-01-05 09:48:00

New commits:


---

Comment by cremona created at 2014-01-11 15:33:41

Thanks for converting this to git and fixing the docstring formatting (which I will trust has been done properly)!

Authors:  can you remove the place(s) where there are comments "this should be checked" or "todo"?  And in several similar places you can delete the comment that some integers must be Sage integers or ... some rather frivolous consequence will occur?

I see that you have carefully allowed for the unavoidable fact that there will be "problem curves" and have an option output filename for these.  But I don't think that any of the doctests illustrate this -- please add one or more doctests which do.  Meanwhile I am trying the functions out.


---

Comment by git created at 2014-09-07 13:09:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-06-03 07:25:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-06-03 19:00:23

There is still one failing doctest, that I do not understand.


---

Comment by git created at 2016-02-05 20:46:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-04-13 19:16:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-07-29 18:57:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-03-01 16:32:15

Branch pushed to git repo; I updated commit sha1. New commits:
