# Issue 24415: UnicodeArt is unable to convert to a unicode object

Issue created by migration from https://trac.sagemath.org/ticket/24652

Original creator: tscrim

Original creation time: 2018-02-03 21:28:31

CC:  chapoton embray jdemeyer

Keywords: unicode art

This currently fails:

```
sage: i = var('i')
sage: ua = unicode_art(sum(pi^i/factorial(i)*x^i, i, 0, oo))
sage: unicode(ua)
---------------------------------------------------------------------------
UnicodeDecodeError                        Traceback (most recent call last)
<ipython-input-4-13a6120e2b40> in <module>()
----> 1 unicode(ua)

UnicodeDecodeError: 'ascii' codec can't decode byte 0xcf in position 1: ordinal not in range(128)
```

which means we cannot add `UnicodeArt` objects to `format` like we can with `AsciiArt` objects:

```
sage: u"{}".format(ua)
---------------------------------------------------------------------------
UnicodeDecodeError                        Traceback (most recent call last)
<ipython-input-3-96cad1bd589e> in <module>()
----> 1 u"{}".format(ua)

UnicodeDecodeError: 'ascii' codec can't decode byte 0xcf in position 1: ordinal not in range(128)
```



---

Comment by tscrim created at 2018-02-03 21:29:49

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-02-03 21:29:49

Probably will not be an issue on Python3, but it lingers around while we have Python2. This was the best way I know of to fix this, but let me know if there is a better way.
----
New commits:


---

Comment by embray created at 2018-02-05 13:04:52

I already have all this stuff fixed in my Python 3 branch.  Let me see if I can gather that up into a sensible ticket instead.


---

Comment by embray created at 2018-02-05 13:04:52

Changing status from needs_review to needs_work.


---

Comment by embray created at 2018-02-05 13:08:59

I'll try to incorporate your test for Python 2 though--that's useful and I didn't have that before.


---

Comment by embray created at 2018-02-05 13:09:13

Set assignee to embray.


---

Comment by embray created at 2018-02-05 13:37:18

Okay, on closer look I think this is actually pretty orthogonal to my other updates to that package.  I'm a bit iffy on the `.decode('utf-8')`, but since this code will only run on Python 2 anyways I don't mind.

Please just add a `# py2` comment to the `sage: unicode(ua)` test (since it won't work on Python 3), and maybe add a Python 3 equivalent of the test:


```
sage: str(ua)  # py3
' \u03c0\u22c5x\n\u212f   '
```


Even though `__unicode__` won't be used on Python 3, it's still nice to demonstrate that there's no regression in this use case on Python 3.


---

Comment by embray created at 2018-02-05 13:37:18

Changing assignee from embray to tscrim.


---

Comment by git created at 2018-02-06 02:51:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-02-06 02:53:10

Done.


---

Comment by tscrim created at 2018-02-06 02:53:10

Changing status from needs_work to needs_review.


---

Comment by embray created at 2018-02-06 14:53:31

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-02-09 23:47:18

Resolution: fixed
