# Issue 22596: fix a calculus doctest

archive/issues_022596.json:
```json
{
    "body": "CC:  @rwst @frederichan-IMJPRG\n\nthat currently prevents many patchbots to run smoothly\n\nIssue created by migration from https://trac.sagemath.org/ticket/22833\n\n",
    "created_at": "2017-04-19T16:46:15Z",
    "labels": [
        "component: calculus",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "fix a calculus doctest",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22596",
    "user": "https://github.com/fchapoton"
}
```
CC:  @rwst @frederichan-IMJPRG

that currently prevents many patchbots to run smoothly

Issue created by migration from https://trac.sagemath.org/ticket/22833





---

archive/issue_comments_314865.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-04-19T16:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314865",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_314866.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-19T16:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314866",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_314867.json:
```json
{
    "body": "I thought someone had already fixed this, but I guess not.",
    "created_at": "2017-04-19T18:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314867",
    "user": "https://github.com/tscrim"
}
```

I thought someone had already fixed this, but I guess not.



---

archive/issue_comments_314868.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-19T18:31:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314868",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314869.json:
```json
{
    "body": "the error was because of the double `::` in TETS or the `Unable to parse Giac output`? or both? and how did you know that `integration` is ok? (i still get the `NotImplementedError` in sage8.0beta2) because the \"dummy integrate\" keyword of maxima is `integrate`.",
    "created_at": "2017-04-20T05:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314869",
    "user": "https://github.com/mforets"
}
```

the error was because of the double `::` in TETS or the `Unable to parse Giac output`? or both? and how did you know that `integration` is ok? (i still get the `NotImplementedError` in sage8.0beta2) because the "dummy integrate" keyword of maxima is `integrate`.



---

archive/issue_comments_314870.json:
```json
{
    "body": "The change to TESTS:: was just something I could not keep like that once I had seen it.\n\nI am not sure that the change to integration doctest is ok. If it fails on your machine, then you can set this ticket back to needs work.",
    "created_at": "2017-04-20T07:40:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314870",
    "user": "https://github.com/fchapoton"
}
```

The change to TESTS:: was just something I could not keep like that once I had seen it.

I am not sure that the change to integration doctest is ok. If it fails on your machine, then you can set this ticket back to needs work.



---

archive/issue_comments_314871.json:
```json
{
    "body": "failing in my machine with:\n\n\n```\nDoctesting 1 file.\nsage -t src/sage/calculus/calculus.py\n**********************************************************************\nFile \"src/sage/calculus/calculus.py\", line 1365, in sage.calculus.calculus.laplace\nFailed example:\n    (p1+p2).save(os.path.join(SAGE_TMP, \"de_plot.png\"))\nExpected nothing\nGot:\n    doctest:warning\n      File \"/Users/forets/sage-src/sage/src/bin/sage-runtests\", line 89, in <module>\n        err = DC.run()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 1134, in run\n        self.run_doctests()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 858, in run_doctests\n        self.dispatcher.dispatch()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1705, in dispatch\n        self.parallel_dispatch()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1595, in parallel_dispatch\n        w.start()  # This might take some time\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1871, in start\n        super(DocTestWorker, self).start()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/multiprocessing/process.py\", line 130, in start\n        self._popen = Popen(self)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/multiprocessing/forking.py\", line 126, in __init__\n        code = process_obj._bootstrap()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/multiprocessing/process.py\", line 258, in _bootstrap\n        self.run()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1844, in run\n        task(self.options, self.outtmpfile, msgpipe, self.result_queue)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 2137, in __call__\n        runner.run(test)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 641, in run\n        return self._run(test, compileflags, out)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 503, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 866, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.calculus.calculus.laplace[23]>\", line 1, in <module>\n        (p1+p2).save(os.path.join(SAGE_TMP, \"de_plot.png\"))\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 471, in wrapper\n        return func(*args, **kwds)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/plot/graphics.py\", line 3170, in save\n        figure = self.matplotlib(**options)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/plot/graphics.py\", line 2566, in matplotlib\n        from matplotlib.figure import Figure\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/figure.py\", line 38, in <module>\n        import matplotlib.colorbar as cbar\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/colorbar.py\", line 34, in <module>\n        import matplotlib.collections as collections\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/collections.py\", line 27, in <module>\n        import matplotlib.backend_bases as backend_bases\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/backend_bases.py\", line 62, in <module>\n        import matplotlib.textpath as textpath\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/textpath.py\", line 15, in <module>\n        import matplotlib.font_manager as font_manager\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py\", line 1413, in <module>\n        fontManager = pickle_load(_fmcache)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py\", line 965, in pickle_load\n        data = pickle.load(fh)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py\", line 1044, in __init__\n        self.ttffiles = findSystemFonts(paths) + findSystemFonts()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py\", line 324, in findSystemFonts\n        for f in get_fontconfig_fonts(fontext):\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py\", line 273, in get_fontconfig_fonts\n        warnings.warn('Matplotlib is building the font cache using fc-list. This may take a moment.')\n    :\n    UserWarning: Matplotlib is building the font cache using fc-list. This may take a moment.\n**********************************************************************\nFile \"src/sage/calculus/calculus.py\", line 1407, in sage.calculus.calculus.laplace\nFailed example:\n    laplace(t^n, t, s, algorithm='giac')\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 503, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 866, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.calculus.calculus.laplace[34]>\", line 1, in <module>\n        laplace(t**n, t, s, algorithm='giac')\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/calculus/calculus.py\", line 1456, in laplace\n        return result.sage()\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 1053, in sage\n        return self._sage_(*args, **kwds)\n      File \"/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/interfaces/giac.py\", line 1095, in _sage_\n        raise NotImplementedError(\"Unable to parse Giac output: %s\" % result)\n    NotImplementedError: Unable to parse Giac output: integrate(t^n*exp(-s*t),t,0,+infinity)\n**********************************************************************\n1 item had failures:\n   2 of  39 in sage.calculus.calculus.laplace\n    [419 tests, 2 failures, 11.53 s]\n----------------------------------------------------------------------\nsage -t src/sage/calculus/calculus.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 11.6 seconds\n    cpu time: 10.8 seconds\n    cumulative wall time: 11.5 seconds\n```\n",
    "created_at": "2017-04-20T11:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314871",
    "user": "https://github.com/mforets"
}
```

failing in my machine with:


```
Doctesting 1 file.
sage -t src/sage/calculus/calculus.py
**********************************************************************
File "src/sage/calculus/calculus.py", line 1365, in sage.calculus.calculus.laplace
Failed example:
    (p1+p2).save(os.path.join(SAGE_TMP, "de_plot.png"))
Expected nothing
Got:
    doctest:warning
      File "/Users/forets/sage-src/sage/src/bin/sage-runtests", line 89, in <module>
        err = DC.run()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 1134, in run
        self.run_doctests()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 858, in run_doctests
        self.dispatcher.dispatch()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1705, in dispatch
        self.parallel_dispatch()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1595, in parallel_dispatch
        w.start()  # This might take some time
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1871, in start
        super(DocTestWorker, self).start()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/multiprocessing/process.py", line 130, in start
        self._popen = Popen(self)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/multiprocessing/forking.py", line 126, in __init__
        code = process_obj._bootstrap()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
        self.run()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1844, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 2137, in __call__
        runner.run(test)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 641, in run
        return self._run(test, compileflags, out)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 503, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 866, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.calculus.calculus.laplace[23]>", line 1, in <module>
        (p1+p2).save(os.path.join(SAGE_TMP, "de_plot.png"))
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 471, in wrapper
        return func(*args, **kwds)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/plot/graphics.py", line 3170, in save
        figure = self.matplotlib(**options)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/plot/graphics.py", line 2566, in matplotlib
        from matplotlib.figure import Figure
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/figure.py", line 38, in <module>
        import matplotlib.colorbar as cbar
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/colorbar.py", line 34, in <module>
        import matplotlib.collections as collections
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/collections.py", line 27, in <module>
        import matplotlib.backend_bases as backend_bases
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/backend_bases.py", line 62, in <module>
        import matplotlib.textpath as textpath
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/textpath.py", line 15, in <module>
        import matplotlib.font_manager as font_manager
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py", line 1413, in <module>
        fontManager = pickle_load(_fmcache)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py", line 965, in pickle_load
        data = pickle.load(fh)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py", line 1044, in __init__
        self.ttffiles = findSystemFonts(paths) + findSystemFonts()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py", line 324, in findSystemFonts
        for f in get_fontconfig_fonts(fontext):
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/matplotlib/font_manager.py", line 273, in get_fontconfig_fonts
        warnings.warn('Matplotlib is building the font cache using fc-list. This may take a moment.')
    :
    UserWarning: Matplotlib is building the font cache using fc-list. This may take a moment.
**********************************************************************
File "src/sage/calculus/calculus.py", line 1407, in sage.calculus.calculus.laplace
Failed example:
    laplace(t^n, t, s, algorithm='giac')
Exception raised:
    Traceback (most recent call last):
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 503, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 866, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.calculus.calculus.laplace[34]>", line 1, in <module>
        laplace(t**n, t, s, algorithm='giac')
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/calculus/calculus.py", line 1456, in laplace
        return result.sage()
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 1053, in sage
        return self._sage_(*args, **kwds)
      File "/Users/forets/sage-src/sage/local/lib/python2.7/site-packages/sage/interfaces/giac.py", line 1095, in _sage_
        raise NotImplementedError("Unable to parse Giac output: %s" % result)
    NotImplementedError: Unable to parse Giac output: integrate(t^n*exp(-s*t),t,0,+infinity)
**********************************************************************
1 item had failures:
   2 of  39 in sage.calculus.calculus.laplace
    [419 tests, 2 failures, 11.53 s]
----------------------------------------------------------------------
sage -t src/sage/calculus/calculus.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 11.6 seconds
    cpu time: 10.8 seconds
    cumulative wall time: 11.5 seconds
```




---

archive/issue_comments_314872.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-04-20T11:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314872",
    "user": "https://github.com/mforets"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_314873.json:
```json
{
    "body": "The first failure is not a true failure and is independent. We need to figure out what makes this test pass on some systems and not on others.",
    "created_at": "2017-04-20T13:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314873",
    "user": "https://github.com/tscrim"
}
```

The first failure is not a true failure and is independent. We need to figure out what makes this test pass on some systems and not on others.



---

archive/issue_comments_314874.json:
```json
{
    "body": "I see this failure with giac 1.2.3.\n\nThe branch works for me. \n\nThis problem is rather annoying, it prevents my patchbot from giving any green light..",
    "created_at": "2017-05-04T12:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314874",
    "user": "https://github.com/fchapoton"
}
```

I see this failure with giac 1.2.3.

The branch works for me. 

This problem is rather annoying, it prevents my patchbot from giving any green light..



---

archive/issue_comments_314875.json:
```json
{
    "body": "`@`mforets, could you try the following, please:\n\n```\nsage: var('t,n,s')\nsage: ex=t^n\nsage: from sage.interfaces.giac import giac\nsage: giac.laplace(ex, t, s)\nintegration(t^n*exp(-s*t),t,0,+infinity)\n```\n",
    "created_at": "2017-05-04T12:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314875",
    "user": "https://github.com/fchapoton"
}
```

`@`mforets, could you try the following, please:

```
sage: var('t,n,s')
sage: ex=t^n
sage: from sage.interfaces.giac import giac
sage: giac.laplace(ex, t, s)
integration(t^n*exp(-s*t),t,0,+infinity)
```




---

archive/issue_comments_314876.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-04T13:18:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314876",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_314877.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-04T13:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314877",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_314878.json:
```json
{
    "body": "And also tell me what you get when doing\n\n```\nsage: %giac\n\ngiac: Int(exp(x),x,0,1)\nintegration(exp(x),x,0,1)\n```\n",
    "created_at": "2017-05-04T13:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314878",
    "user": "https://github.com/fchapoton"
}
```

And also tell me what you get when doing

```
sage: %giac

giac: Int(exp(x),x,0,1)
integration(exp(x),x,0,1)
```




---

archive/issue_comments_314879.json:
```json
{
    "body": "Replying to [comment:13 chapoton]:\n> And also tell me what you get when doing\n> {{{\n> sage: %giac\n> \n> giac: Int(exp(x),x,0,1)\n> integration(exp(x),x,0,1)\n> }}}\n\nEDIT: no no, ignore my last message, I hadn't notice that you pushed changes < 1hr ago.  \n\ni've recompiled this branch and i'm getting: \n\n\n```\nsage: %giac\n\n\n  --> Switching to Giac <--\n\ngiac: Int(exp(x),x,0,1)\nintegrate(exp(x),x,0,1)\n```\n",
    "created_at": "2017-05-04T13:49:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314879",
    "user": "https://github.com/mforets"
}
```

Replying to [comment:13 chapoton]:
> And also tell me what you get when doing
> {{{
> sage: %giac
> 
> giac: Int(exp(x),x,0,1)
> integration(exp(x),x,0,1)
> }}}

EDIT: no no, ignore my last message, I hadn't notice that you pushed changes < 1hr ago.  

i've recompiled this branch and i'm getting: 


```
sage: %giac


  --> Switching to Giac <--

giac: Int(exp(x),x,0,1)
integrate(exp(x),x,0,1)
```




---

archive/issue_comments_314880.json:
```json
{
    "body": "in my machine, and for the commit 79442f3, i have \n\n\n```\nsage:\u00a0var('t,n,s')\n(t,\u00a0n,\u00a0s)\nsage:\u00a0ex=t^n\nsage:\u00a0from\u00a0sage.interfaces.giac\u00a0import\u00a0giac\nsage:\u00a0giac.laplace(ex,\u00a0t,\u00a0s)\nintegrate(t^n*exp(-s*t),t,0,+infinity)\nsage:\u00a0%giac\n\u00a0\n\u00a0\u00a0-->\u00a0Switching\u00a0to\u00a0Giac\u00a0<--\n\u00a0\ngiac:\u00a0Int(exp(x),x,0,1)\n\nintegrate(exp(x),x,0,1)\n```\n\n\nand i still get:\n\n\n```\nsage: laplace(t^n*exp(-s*t),t,s,algorithm='giac')\n...\nNotImplementedError: Unable to parse Giac output: integrate(t^n*exp(-2*s*t),t,0,+infinity)\n```\n\n\nthis exception is raised when we transform back to sage. maybe it's better to mimick the unevaluated laplace as with the SymPy case, that is:\n\n\n```\n...\nif 'integrate' in format(result):\n   return dummy_laplace(ex, t, s)\nelse:\n   return result.sage()\n```\n\n\ni git pulled and re-compiled everything, so i ignore why you get \"integration\" instead.\n\nthat said, if you have pressing need then you may as well consider removing this \"no-go\" test altogether..",
    "created_at": "2017-05-04T15:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314880",
    "user": "https://github.com/mforets"
}
```

in my machine, and for the commit 79442f3, i have 


```
sage: var('t,n,s')
(t, n, s)
sage: ex=t^n
sage: from sage.interfaces.giac import giac
sage: giac.laplace(ex, t, s)
integrate(t^n*exp(-s*t),t,0,+infinity)
sage: %giac
 
  --> Switching to Giac <--
 
giac: Int(exp(x),x,0,1)

integrate(exp(x),x,0,1)
```


and i still get:


```
sage: laplace(t^n*exp(-s*t),t,s,algorithm='giac')
...
NotImplementedError: Unable to parse Giac output: integrate(t^n*exp(-2*s*t),t,0,+infinity)
```


this exception is raised when we transform back to sage. maybe it's better to mimick the unevaluated laplace as with the SymPy case, that is:


```
...
if 'integrate' in format(result):
   return dummy_laplace(ex, t, s)
else:
   return result.sage()
```


i git pulled and re-compiled everything, so i ignore why you get "integration" instead.

that said, if you have pressing need then you may as well consider removing this "no-go" test altogether..



---

archive/issue_comments_314881.json:
```json
{
    "body": "Replying to [comment:15 mforets]:\n> {{{\n> ...\n> if 'integrate' in format(result):\n>    return dummy_laplace(ex, t, s)\n> else:\n>    return result.sage()\n> }}}\n> \n\nwith that modif, the expected output for the test at hand becomes: `laplace(t^n, t, s)` \n\nin my machine the updated code passes. let me know if you want me to push that or try something else.",
    "created_at": "2017-05-04T16:52:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314881",
    "user": "https://github.com/mforets"
}
```

Replying to [comment:15 mforets]:
> {{{
> ...
> if 'integrate' in format(result):
>    return dummy_laplace(ex, t, s)
> else:
>    return result.sage()
> }}}
> 

with that modif, the expected output for the test at hand becomes: `laplace(t^n, t, s)` 

in my machine the updated code passes. let me know if you want me to push that or try something else.



---

archive/issue_comments_314882.json:
```json
{
    "body": "Replying to [comment:15 mforets]:\n> and i still get:\n> \n> {{{\n> sage: laplace(t^n*exp(-s*t),t,s,algorithm='giac')\n> ...\n> NotImplementedError: Unable to parse Giac output: integrate(t^n*exp(-2*s*t),t,0,+infinity)\n> }}}\n\nSame here.",
    "created_at": "2017-05-05T14:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314882",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:15 mforets]:
> and i still get:
> 
> {{{
> sage: laplace(t^n*exp(-s*t),t,s,algorithm='giac')
> ...
> NotImplementedError: Unable to parse Giac output: integrate(t^n*exp(-2*s*t),t,0,+infinity)
> }}}

Same here.



---

archive/issue_comments_314883.json:
```json
{
    "body": "Would there be need for symbolic laplace? Maxima might return such unevaluated results as anonymous functions too, and they are difficult to handle.",
    "created_at": "2017-05-05T14:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314883",
    "user": "https://github.com/rwst"
}
```

Would there be need for symbolic laplace? Maxima might return such unevaluated results as anonymous functions too, and they are difficult to handle.



---

archive/issue_comments_314884.json:
```json
{
    "body": "in this case it is raising a `NotImplementedError`, which i find a bit misleading if this kind of exception belongs to the level of Sage the library. perhaps an intermediate point is to return just `integrate(t^n*exp(-2*s*t),t,0,+infinity)`, what do you think?\n\non the other hand, Laplace placeholder could be needed here (in opposition to a naked integral):\n\n- to attach properties of the transform which are not 'obvious', eg. properties as a function of a complex variable s, convergence radius, final and initial value theorems\n- if you have many of them, it looks nicer  with respect to printing the equations!",
    "created_at": "2017-05-05T16:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314884",
    "user": "https://github.com/mforets"
}
```

in this case it is raising a `NotImplementedError`, which i find a bit misleading if this kind of exception belongs to the level of Sage the library. perhaps an intermediate point is to return just `integrate(t^n*exp(-2*s*t),t,0,+infinity)`, what do you think?

on the other hand, Laplace placeholder could be needed here (in opposition to a naked integral):

- to attach properties of the transform which are not 'obvious', eg. properties as a function of a complex variable s, convergence radius, final and initial value theorems
- if you have many of them, it looks nicer  with respect to printing the equations!



---

archive/issue_comments_314885.json:
```json
{
    "body": "Got an answer from Parisse:\n\n```\nsi vous etes en francais (export LANG=fr_FR.UTF-8 par exemple), \nles mots-clefs de giac qui ont une traduction s'affichent en francais.\n Le fichier qui contient les traductions sous linux est \n/usr/share/giac/doc/fr/keywords.\nSi vous passez en export LANG=en_US.UTF-8 ca restera en anglais.\n\nDans l'interface de Xcas les fichiers de session sont sauvegardes \navec les mots-clefs en anglais.\n```\n",
    "created_at": "2017-05-11T14:20:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314885",
    "user": "https://github.com/fchapoton"
}
```

Got an answer from Parisse:

```
si vous etes en francais (export LANG=fr_FR.UTF-8 par exemple), 
les mots-clefs de giac qui ont une traduction s'affichent en francais.
 Le fichier qui contient les traductions sous linux est 
/usr/share/giac/doc/fr/keywords.
Si vous passez en export LANG=en_US.UTF-8 ca restera en anglais.

Dans l'interface de Xcas les fichiers de session sont sauvegardes 
avec les mots-clefs en anglais.
```




---

archive/issue_comments_314886.json:
```json
{
    "body": "So what he is saying is that it has to with the localization settings?",
    "created_at": "2017-05-11T14:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314886",
    "user": "https://github.com/tscrim"
}
```

So what he is saying is that it has to with the localization settings?



---

archive/issue_comments_314887.json:
```json
{
    "body": "I think so. The English \"integrate\" got translated to \"integration\" in the output for people whose locale is French.\n\nhttps://fossies.org/linux/giac/doc/fr/keywords",
    "created_at": "2017-05-11T14:41:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314887",
    "user": "https://github.com/fchapoton"
}
```

I think so. The English "integrate" got translated to "integration" in the output for people whose locale is French.

https://fossies.org/linux/giac/doc/fr/keywords



---

archive/issue_comments_314888.json:
```json
{
    "body": "I think there is a deeper issue. I suspect that is failing out at some other place because it can't find the symbol `integration` in the symbol table. At least this is coming from trying to unravel things and get a better traceback:\n\n```sage\nsage: t,n,s = var('t,n,s')\nsage: from sage.libs.pynac.pynac import symbol_table\nsage: from sage.calculus.calculus import symbolic_expression_from_string\nsage: ex = t^n*exp(-s*t)\nsage: result = ex._giac_().integrate(t._giac_(), 0._giac_(), oo._giac_())\nsage: symbolic_expression_from_string(repr(result), symbol_table['giac'], True)\n...\n/home/travis/sage-build/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.pyc in sr_integral(self, *args)\n    808                 raise ValueError(\"Integral is divergent.\")\n    809             elif \"Is\" in s: # Maxima asked for a condition\n--> 810                 self._missing_assumption(s)\n    811             else:\n    812                 raise\n\n/home/travis/sage-build/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.pyc in _missing_assumption(self, errstr)\n   1018              + errstr[jj+1:k] +\">0)', see `assume?` for more details)\\n\" + errstr\n   1019         outstr = outstr.replace('_SAGE_VAR_','')\n-> 1020         raise ValueError(outstr)\n   1021 \n   1022 def is_MaximaLibElement(x):\n\nValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(s>0)', see `assume?` for more details)\nIs s positive, negative or zero?\n```\n\nDo you get a similar error?",
    "created_at": "2017-05-11T15:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314888",
    "user": "https://github.com/tscrim"
}
```

I think there is a deeper issue. I suspect that is failing out at some other place because it can't find the symbol `integration` in the symbol table. At least this is coming from trying to unravel things and get a better traceback:

```sage
sage: t,n,s = var('t,n,s')
sage: from sage.libs.pynac.pynac import symbol_table
sage: from sage.calculus.calculus import symbolic_expression_from_string
sage: ex = t^n*exp(-s*t)
sage: result = ex._giac_().integrate(t._giac_(), 0._giac_(), oo._giac_())
sage: symbolic_expression_from_string(repr(result), symbol_table['giac'], True)
...
/home/travis/sage-build/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.pyc in sr_integral(self, *args)
    808                 raise ValueError("Integral is divergent.")
    809             elif "Is" in s: # Maxima asked for a condition
--> 810                 self._missing_assumption(s)
    811             else:
    812                 raise

/home/travis/sage-build/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.pyc in _missing_assumption(self, errstr)
   1018              + errstr[jj+1:k] +">0)', see `assume?` for more details)\n" + errstr
   1019         outstr = outstr.replace('_SAGE_VAR_','')
-> 1020         raise ValueError(outstr)
   1021 
   1022 def is_MaximaLibElement(x):

ValueError: Computation failed since Maxima requested additional constraints; using the 'assume' command before evaluation *may* help (example of legal syntax is 'assume(s>0)', see `assume?` for more details)
Is s positive, negative or zero?
```

Do you get a similar error?



---

archive/issue_comments_314889.json:
```json
{
    "body": "no, I just get\n\n```\nintegration(t^n*e^(-s*t), t, 0, +Infinity)\n```\n",
    "created_at": "2017-05-11T15:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314889",
    "user": "https://github.com/fchapoton"
}
```

no, I just get

```
integration(t^n*e^(-s*t), t, 0, +Infinity)
```




---

archive/issue_comments_314890.json:
```json
{
    "body": "I think the problem is actually with Maxima. What happens when you try to explicitly evaluate the integral?\n\n```\nsage: integrate(t^n*exp(-s*t),t,0,oo)\n```\n\nI get the same error as above when I do this. If I impose `s > 0` and `n` in **Z**<sub>>0</sub>, then I get\n\n```\ns^(-n - 1)*gamma(n + 1)\n```\n",
    "created_at": "2017-05-11T15:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314890",
    "user": "https://github.com/tscrim"
}
```

I think the problem is actually with Maxima. What happens when you try to explicitly evaluate the integral?

```
sage: integrate(t^n*exp(-s*t),t,0,oo)
```

I get the same error as above when I do this. If I impose `s > 0` and `n` in **Z**<sub>>0</sub>, then I get

```
s^(-n - 1)*gamma(n + 1)
```




---

archive/issue_comments_314891.json:
```json
{
    "body": "\n```\nsage: integrate(t^n*exp(-s*t),t,0,oo)\n```\n\ngives me the same \"assume\" failure as you got ;\n\nand then works as for you with the assumes done",
    "created_at": "2017-05-11T15:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314891",
    "user": "https://github.com/fchapoton"
}
```


```
sage: integrate(t^n*exp(-s*t),t,0,oo)
```

gives me the same "assume" failure as you got ;

and then works as for you with the assumes done



---

archive/issue_comments_314892.json:
```json
{
    "body": "Hmm...that is strange. So something is happening between the attempt to parse the giac output and actually evaluate the maxima integral.",
    "created_at": "2017-05-11T15:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314892",
    "user": "https://github.com/tscrim"
}
```

Hmm...that is strange. So something is happening between the attempt to parse the giac output and actually evaluate the maxima integral.



---

archive/issue_comments_314893.json:
```json
{
    "body": "Is `'integration'` a key in your `symbol_table['functions']`?",
    "created_at": "2017-05-11T15:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314893",
    "user": "https://github.com/tscrim"
}
```

Is `'integration'` a key in your `symbol_table['functions']`?



---

archive/issue_comments_314894.json:
```json
{
    "body": "Also, do you have\n\n```\nsage: symbol_table['giac']\n{'(1+sqrt(5))/2': golden_ratio,\n 'Dirac': dirac_delta,\n 'Heaviside': heaviside,\n 'pi': pi}\n```\n",
    "created_at": "2017-05-11T15:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314894",
    "user": "https://github.com/tscrim"
}
```

Also, do you have

```
sage: symbol_table['giac']
{'(1+sqrt(5))/2': golden_ratio,
 'Dirac': dirac_delta,
 'Heaviside': heaviside,
 'pi': pi}
```




---

archive/issue_comments_314895.json:
```json
{
    "body": "\n```\n'integrate': integrate,\n 'integration': integration,\n```\n\nin symbol_table['functions']\n\nand\n\n```\nsage: symbol_table['giac']\n\n{'(1+sqrt(5))/2': golden_ratio,\n 'Dirac': dirac_delta,\n 'Heaviside': heaviside,\n 'pi': pi}\n\n```\n",
    "created_at": "2017-05-11T15:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314895",
    "user": "https://github.com/fchapoton"
}
```


```
'integrate': integrate,
 'integration': integration,
```

in symbol_table['functions']

and

```
sage: symbol_table['giac']

{'(1+sqrt(5))/2': golden_ratio,
 'Dirac': dirac_delta,
 'Heaviside': heaviside,
 'pi': pi}

```




---

archive/issue_comments_314896.json:
```json
{
    "body": "That's the difference: I don't have the `'integration'` in the functions symbol table. What is the `integration` function, specifically, what does `import_statements` give?",
    "created_at": "2017-05-11T15:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314896",
    "user": "https://github.com/tscrim"
}
```

That's the difference: I don't have the `'integration'` in the functions symbol table. What is the `integration` function, specifically, what does `import_statements` give?



---

archive/issue_comments_314897.json:
```json
{
    "body": "\n```\nsage: import_statements('integration')\n# **Warning**: distinct objects with name 'integration' in:\n#   - sage.calculus\n#   - sage.symbolic\nimport sage.symbolic.integration\n\n```\n",
    "created_at": "2017-05-11T15:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314897",
    "user": "https://github.com/fchapoton"
}
```


```
sage: import_statements('integration')
# **Warning**: distinct objects with name 'integration' in:
#   - sage.calculus
#   - sage.symbolic
import sage.symbolic.integration

```




---

archive/issue_comments_314898.json:
```json
{
    "body": "Sorry, I was vague, I meant:\n\n```\nsage: import_statements(symbol_table['functions]['integration'])\n```\n",
    "created_at": "2017-05-11T15:33:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314898",
    "user": "https://github.com/tscrim"
}
```

Sorry, I was vague, I meant:

```
sage: import_statements(symbol_table['functions]['integration'])
```




---

archive/issue_comments_314899.json:
```json
{
    "body": "\n```\nsage: symbol_table['functions']['integration']\nintegration\nsage: import_statements(_)\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n\nValueError: no import statement found for 'integration'.\n```\n",
    "created_at": "2017-05-11T15:34:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314899",
    "user": "https://github.com/fchapoton"
}
```


```
sage: symbol_table['functions']['integration']
integration
sage: import_statements(_)
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)

ValueError: no import statement found for 'integration'.
```




---

archive/issue_comments_314900.json:
```json
{
    "body": "\n```\nsage: symbol_table['functions']['integration']\nintegration\nsage: type(_)\n<class 'sage.symbolic.function_factory.NewSymbolicFunction'>\n```\n",
    "created_at": "2017-05-11T15:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314900",
    "user": "https://github.com/fchapoton"
}
```


```
sage: symbol_table['functions']['integration']
integration
sage: type(_)
<class 'sage.symbolic.function_factory.NewSymbolicFunction'>
```




---

archive/issue_comments_314901.json:
```json
{
    "body": "Now I'm not so sure about what to look for or ask, but I'm investigating. Ralf, do you have any ideas?",
    "created_at": "2017-05-11T15:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314901",
    "user": "https://github.com/tscrim"
}
```

Now I'm not so sure about what to look for or ask, but I'm investigating. Ralf, do you have any ideas?



---

archive/issue_comments_314902.json:
```json
{
    "body": "So I think what is happening is that `integration` is being considered by Maxima as a formal function. Hence, it is not simplified as an integral, and I don't think you could manipulate it as a function.",
    "created_at": "2017-05-11T15:50:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314902",
    "user": "https://github.com/tscrim"
}
```

So I think what is happening is that `integration` is being considered by Maxima as a formal function. Hence, it is not simplified as an integral, and I don't think you could manipulate it as a function.



---

archive/issue_comments_314903.json:
```json
{
    "body": "does this pass?\n\n\n```\n...\nif 'integrate' in format(result) or 'integration' in format(result):\n   return dummy_laplace(ex, t, s)\nelse:\n   return result.sage()\n```\n",
    "created_at": "2017-05-11T19:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314903",
    "user": "https://github.com/mforets"
}
```

does this pass?


```
...
if 'integrate' in format(result) or 'integration' in format(result):
   return dummy_laplace(ex, t, s)
else:
   return result.sage()
```




---

archive/issue_comments_314904.json:
```json
{
    "body": "Let me try to summarize. We cannot fix the doctest because of conflicting results due to giac's clever use of locale which breaks its interface to the world. The immediate way to adapt to this IMO is to look for both `integrate` and `integration` in the result when using laplace of giac. The more far-sighted way would be to fix the giac-Sage interface so that in the laplace code we can just say `return result.sage()` unconditionally.",
    "created_at": "2017-05-12T07:07:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314904",
    "user": "https://github.com/rwst"
}
```

Let me try to summarize. We cannot fix the doctest because of conflicting results due to giac's clever use of locale which breaks its interface to the world. The immediate way to adapt to this IMO is to look for both `integrate` and `integration` in the result when using laplace of giac. The more far-sighted way would be to fix the giac-Sage interface so that in the laplace code we can just say `return result.sage()` unconditionally.



---

archive/issue_comments_314905.json:
```json
{
    "body": "could somebody please take action here, and propose a better branch ?",
    "created_at": "2017-05-12T20:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314905",
    "user": "https://github.com/fchapoton"
}
```

could somebody please take action here, and propose a better branch ?



---

archive/issue_comments_314906.json:
```json
{
    "body": "What is the desired output of\n\n```\nsage: laplace(t^n, t, s, algorithm='giac')\n```\n\nIf it is `integration(t<sup>n*e</sup>(-s*t), t, 0, +Infinity)` then one could add \n\n```\nintegrate integration\n```\n\nto `local/share/giac/doc/en/keywords` and any other provided `$LANG/keywords` file. Doing this I get\n\n```\nsage: var('t,n,s')\n(t, n, s)\nsage: ex=t^n\nsage: from sage.interfaces.giac import giac\nsage: giac.laplace(ex, t, s)\nintegration(t^n*exp(-s*t),t,0,+infinity)\nsage: %giac\n\n  --> Switching to Giac <--\n\ngiac: Int(exp(x),x,0,1)\nintegration(exp(x),x,0,1)\n```\n\n\nWithout the change the doctest would pass but with the change I get\n\n```\nsage -t --long src/sage/calculus/calculus.py\n**********************************************************************\nFile \"src/sage/calculus/calculus.py\", line 1406, in sage.calculus.calculus.laplace\nFailed example:\n    laplace(t^n, t, s, algorithm='giac')\nExpected:\n    Traceback (most recent call last):\n    ...\n    NotImplementedError: Unable to parse Giac output: integrate(t^n*exp(-s*t),t,0,+infinity)\nGot:\n    integration(t^n*e^(-s*t), t, 0, +Infinity)\n```\n",
    "created_at": "2017-05-13T01:19:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314906",
    "user": "https://github.com/strogdon"
}
```

What is the desired output of

```
sage: laplace(t^n, t, s, algorithm='giac')
```

If it is `integration(t<sup>n*e</sup>(-s*t), t, 0, +Infinity)` then one could add 

```
integrate integration
```

to `local/share/giac/doc/en/keywords` and any other provided `$LANG/keywords` file. Doing this I get

```
sage: var('t,n,s')
(t, n, s)
sage: ex=t^n
sage: from sage.interfaces.giac import giac
sage: giac.laplace(ex, t, s)
integration(t^n*exp(-s*t),t,0,+infinity)
sage: %giac

  --> Switching to Giac <--

giac: Int(exp(x),x,0,1)
integration(exp(x),x,0,1)
```


Without the change the doctest would pass but with the change I get

```
sage -t --long src/sage/calculus/calculus.py
**********************************************************************
File "src/sage/calculus/calculus.py", line 1406, in sage.calculus.calculus.laplace
Failed example:
    laplace(t^n, t, s, algorithm='giac')
Expected:
    Traceback (most recent call last):
    ...
    NotImplementedError: Unable to parse Giac output: integrate(t^n*exp(-s*t),t,0,+infinity)
Got:
    integration(t^n*e^(-s*t), t, 0, +Infinity)
```




---

archive/issue_comments_314907.json:
```json
{
    "body": "again, for consistency the desired output of `laplace(t^n, t, s, algorithm='giac')` should be the same as the other two interfaces when they don't know the answer, don't you think?\n\nfrom your answers, i can reproduce the issue playing with `$ export LANG=fr_FR.UTF-8` and `$ export LANG=en_US.UTF-8` in the shell :)\n\nhence, let me upload a branch doing rws's comment:39 and my comment:38, if i understood correctly.",
    "created_at": "2017-05-13T06:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314907",
    "user": "https://github.com/mforets"
}
```

again, for consistency the desired output of `laplace(t^n, t, s, algorithm='giac')` should be the same as the other two interfaces when they don't know the answer, don't you think?

from your answers, i can reproduce the issue playing with `$ export LANG=fr_FR.UTF-8` and `$ export LANG=en_US.UTF-8` in the shell :)

hence, let me upload a branch doing rws's comment:39 and my comment:38, if i understood correctly.



---

archive/issue_comments_314908.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-05-13T06:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314908",
    "user": "https://github.com/mforets"
}
```

New commits:



---

archive/issue_comments_314909.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-13T06:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314909",
    "user": "https://github.com/mforets"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_314910.json:
```json
{
    "body": "Just to confirm that merging this branch in Sage 8.0.beta6 fixes the doctest error on my system.",
    "created_at": "2017-05-13T14:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314910",
    "user": "https://github.com/egourgoulhon"
}
```

Just to confirm that merging this branch in Sage 8.0.beta6 fixes the doctest error on my system.



---

archive/issue_comments_314911.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-13T16:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314911",
    "user": "https://github.com/strogdon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_314912.json:
```json
{
    "body": "I think this is good.",
    "created_at": "2017-05-13T16:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314912",
    "user": "https://github.com/strogdon"
}
```

I think this is good.



---

archive/issue_comments_314913.json:
```json
{
    "body": "Thanks for the review. \n\nHere are two somehow related issues: #22997 and #22995.",
    "created_at": "2017-05-14T09:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314913",
    "user": "https://github.com/mforets"
}
```

Thanks for the review. 

Here are two somehow related issues: #22997 and #22995.



---

archive/issue_comments_314914.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-05-15T22:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22596#issuecomment-314914",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_059349.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-05-15T22:53:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22596",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22596#event-59349"
}
```
