# Issue 31756: ConvexSet_base: Add affine_hull, affine_hull_projection, an_affine_basis

Issue created by migration from https://trac.sagemath.org/ticket/31993

Original creator: mkoeppe

Original creation time: 2021-06-16 18:20:06

CC:  @kliem

`affine_hull`, `affine_hull_projection` and `AffineHullProjectionData` (from #27366) should be generalized to `ConvexSet_base` via `an_affine_basis`.

(A prototype for `an_affine_basis` is on the branch of #31955.)


---

Comment by git created at 2021-07-09 15:52:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-07-09 17:53:09

`ConvexRationalPolyhedralCone.solid_restriction` is similar to `affine_hull_projection`


---

Comment by git created at 2021-07-10 22:45:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-07-10 23:34:09

Replying to [comment:4 mkoeppe]:
> `ConvexRationalPolyhedralCone.solid_restriction` is similar to `affine_hull_projection`

... best taken care of in #30172, which adds a cone ABC


---

Comment by git created at 2021-07-10 23:51:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-07-10 23:52:23

Changing status from new to needs_review.


---

Comment by git created at 2021-07-11 07:09:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2021-07-12 14:47:04

Coverage needs work yet.


```
-geometry/relative_interior.py: 100.0% (14 of 14)
+geometry/relative_interior.py: 83.3% (15 of 18)
```


Probably three stupid tests, testing abstract methods raise a `NotImplementedError`.


---

Comment by git created at 2021-07-12 16:50:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-07-12 23:42:34

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-07-13 00:01:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-07-13 00:13:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-07-13 00:17:06

Changing status from needs_work to needs_review.


---

Comment by git created at 2021-07-17 21:13:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-07-18 20:02:48

green patchbot, ready for review


---

Comment by @kliem created at 2021-07-20 09:54:38

Merge conflict.


---

Comment by @kliem created at 2021-07-20 09:54:45

Changing status from needs_review to needs_work.


---

Comment by git created at 2021-07-20 15:31:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-07-20 15:35:29

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-07-20 15:35:29

Actually would be good to get it into 9.4 so that we don't have to bother with deprecation for the changes to `AffineHullProjectionData`


---

Comment by @kliem created at 2021-07-22 08:04:35

I think things are fine.

Waiting for a patchbot, seems hopeless: https://patchbot.sagemath.org/ticket/0/

Coverage is good. I'm going to run `sage -t --all` on this ticket. Ping me, if I don't report in the next 24 hours.


---

Comment by @kliem created at 2021-07-22 10:53:07

I'm getting those failures


```
sage -t --random-seed=0 src/sage/misc/sagedoc.py  # 1 doctest failed
sage -t --random-seed=0 src/sage/tests/cmdline.py  # 5 doctests failed
sage -t --random-seed=0 src/sage/modular/local_comp/local_comp.py  # 1 doctest failed
sage -t --random-seed=0 src/sage/rings/number_field/number_field_ideal.py  # 1 doctest failed   
```


and nothing is related to this ticket, but I also get failures on develop.


---

Comment by @kliem created at 2021-07-22 10:53:26

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2021-07-22 10:53:26

LGTM.


---

Comment by mkoeppe created at 2021-07-22 14:45:40

Thanks!


---

Comment by vbraun created at 2021-07-23 22:12:46

Merge conflict


---

Comment by vbraun created at 2021-07-23 22:12:46

Changing status from positive_review to needs_work.


---

Comment by git created at 2021-07-23 22:35:28

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by mkoeppe created at 2021-07-23 22:35:53

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2021-07-25 13:26:54

Resolution: fixed
