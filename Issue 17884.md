# Issue 17884: Patch Cython with PyTypeObject members

archive/issues_017884.json:
```json
{
    "body": "Various places in Sage need access to `PyTypeObject` members. There is currently no consistent way how this is done. I propose to just add the declarations to the Cython includes.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18121\n\n",
    "created_at": "2015-04-03T12:19:49Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "Patch Cython with PyTypeObject members",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17884",
    "user": "@jdemeyer"
}
```
Various places in Sage need access to `PyTypeObject` members. There is currently no consistent way how this is done. I propose to just add the declarations to the Cython includes.

Issue created by migration from https://trac.sagemath.org/ticket/18121





---

archive/issue_comments_239958.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-03T21:23:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239958",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_239959.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-03T21:26:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239959",
    "user": "@jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_239960.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-05T07:14:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239960",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_239961.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-06T21:31:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239961",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_239962.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-06T21:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239962",
    "user": "@jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_239963.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-07T08:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239963",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_239964.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd66\".",
    "created_at": "2015-04-07T08:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239964",
    "user": "@jdemeyer"
}
```

Changing keywords from "" to "sd66".



---

archive/issue_comments_239965.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-16T09:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239965",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_239966.json:
```json
{
    "body": "As far as I can see, the patch you are using does not exactly match the changes to Cython given by [ec8ba63](https://github.com/cython/cython/commit/ec8ba63bc54839d00a07af9bcdc5129a25182a6c) (concerning the pull request 378).\n\nYou are using\n\n```\nfrom cpython.object cimport PyObject\n```\n\ninstead of\n\n```\nfrom .object cimport PyObject\n```\n\nwhy is that? It is not supported in our Cython 0.22?",
    "created_at": "2015-04-19T20:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239966",
    "user": "@videlec"
}
```

As far as I can see, the patch you are using does not exactly match the changes to Cython given by [ec8ba63](https://github.com/cython/cython/commit/ec8ba63bc54839d00a07af9bcdc5129a25182a6c) (concerning the pull request 378).

You are using

```
from cpython.object cimport PyObject
```

instead of

```
from .object cimport PyObject
```

why is that? It is not supported in our Cython 0.22?



---

archive/issue_comments_239967.json:
```json
{
    "body": "Replying to [comment:17 vdelecroix]:\n> It is not supported in our Cython 0.22?\nNot completely. It needs a bug-fix which isn't in Cython 0.22.",
    "created_at": "2015-04-20T17:00:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239967",
    "user": "@jdemeyer"
}
```

Replying to [comment:17 vdelecroix]:
> It is not supported in our Cython 0.22?
Not completely. It needs a bug-fix which isn't in Cython 0.22.



---

archive/issue_comments_239968.json:
```json
{
    "body": "Why `void Py_VISIT(PyObject *o)` is not compatible with Cython? I do not quite understand what is this `__pyx_v_visit`. Is it because of Cython renaming arguments? If it is so, I do not find it very safe. Though, your version of `MonoDict_traverse` looks nicer.\n\nCould you explain to me the reason of declaring\n\n```\n    int PyList_SetItem(object list, Py_ssize_t index, PyObject * item) except -1\n```\n\nand not use the `PyList_SetItem` from `cpython.lists` declared as `(object,Py_ssize_t,object)`? It would also be cool to add a comment if it is important to keep as such.\n\nIn `sage/structure/coerce_dict.pyx`, couldn't you get rid of\n\n```\ncdef extern from \"Python.h\":\n    PyObject* PyWeakref_GetObject(object r)\n```\n\nIt is in `cpython.weakref`.\n\nDo you know why `Py_None` is not available from Cython?\n\nCould we also remove or comment the `cpdef inline Py_ssize_t signed_id(x)`?",
    "created_at": "2015-04-20T17:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239968",
    "user": "@videlec"
}
```

Why `void Py_VISIT(PyObject *o)` is not compatible with Cython? I do not quite understand what is this `__pyx_v_visit`. Is it because of Cython renaming arguments? If it is so, I do not find it very safe. Though, your version of `MonoDict_traverse` looks nicer.

Could you explain to me the reason of declaring

```
    int PyList_SetItem(object list, Py_ssize_t index, PyObject * item) except -1
```

and not use the `PyList_SetItem` from `cpython.lists` declared as `(object,Py_ssize_t,object)`? It would also be cool to add a comment if it is important to keep as such.

In `sage/structure/coerce_dict.pyx`, couldn't you get rid of

```
cdef extern from "Python.h":
    PyObject* PyWeakref_GetObject(object r)
```

It is in `cpython.weakref`.

Do you know why `Py_None` is not available from Cython?

Could we also remove or comment the `cpdef inline Py_ssize_t signed_id(x)`?



---

archive/issue_comments_239969.json:
```json
{
    "body": "Replying to [comment:19 vdelecroix]:\n> Why `void Py_VISIT(PyObject *o)` is not compatible with Cython? I do not quite understand what is this `__pyx_v_visit`. Is it because of Cython renaming arguments? If it is so, I do not find it very safe.\n\nCorrect, and I agree. Depending on the user giving parameters a particular name *and* cython mangling the names in a particular way is more fragile than what the CPython macro does. We only use this stuff twice, so it's not too onerous and much less obscure to be explicit in the code. If we find ourselves writing more \"traverse\" functions, we should push for a more structural solution in cython (currently we're already hacking by modifying a pytype structure after PyTypeReady has run on it).\n\n> Could you explain to me the reason of declaring\n> {{{\n>     int PyList_SetItem(object list, Py_ssize_t index, PyObject * item) except -1\n> }}}\n> and not use the `PyList_SetItem` from `cpython.lists` declared as `(object,Py_ssize_t,object)`? It would also be cool to add a comment if it is important to keep as such.\n\nSee its use in `extract_*` functions. It's handling `PyObject*` there and a cast to `object` would generate an INCREF (which is really not what you want to do in code that's just deleting things). This ticket doesn't affect that code.\n> In `sage/structure/coerce_dict.pyx`, couldn't you get rid of\n> {{{\n> cdef extern from \"Python.h\":\n>     PyObject* PyWeakref_GetObject(object r)\n> }}}\n> It is in `cpython.weakref`.\n\nSo it is now! I don't think it was before.\n\n> Do you know why `Py_None` is not available from Cython?\n\nIt is as \"None\", but then it's an `object`, and we need to compare it as a `PyObject *`. Cython's support for `PyObject *` (i.e., borrowed references) is poor -- basically intentionally so at the moment because a good interface (other than just the C interface) hasn't been formulated yet.\n\n> Could we also remove or comment the `cpdef inline Py_ssize_t signed_id(x)`?\n\nNo objections to that.",
    "created_at": "2015-04-20T18:32:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239969",
    "user": "@nbruin"
}
```

Replying to [comment:19 vdelecroix]:
> Why `void Py_VISIT(PyObject *o)` is not compatible with Cython? I do not quite understand what is this `__pyx_v_visit`. Is it because of Cython renaming arguments? If it is so, I do not find it very safe.

Correct, and I agree. Depending on the user giving parameters a particular name *and* cython mangling the names in a particular way is more fragile than what the CPython macro does. We only use this stuff twice, so it's not too onerous and much less obscure to be explicit in the code. If we find ourselves writing more "traverse" functions, we should push for a more structural solution in cython (currently we're already hacking by modifying a pytype structure after PyTypeReady has run on it).

> Could you explain to me the reason of declaring
> {{{
>     int PyList_SetItem(object list, Py_ssize_t index, PyObject * item) except -1
> }}}
> and not use the `PyList_SetItem` from `cpython.lists` declared as `(object,Py_ssize_t,object)`? It would also be cool to add a comment if it is important to keep as such.

See its use in `extract_*` functions. It's handling `PyObject*` there and a cast to `object` would generate an INCREF (which is really not what you want to do in code that's just deleting things). This ticket doesn't affect that code.
> In `sage/structure/coerce_dict.pyx`, couldn't you get rid of
> {{{
> cdef extern from "Python.h":
>     PyObject* PyWeakref_GetObject(object r)
> }}}
> It is in `cpython.weakref`.

So it is now! I don't think it was before.

> Do you know why `Py_None` is not available from Cython?

It is as "None", but then it's an `object`, and we need to compare it as a `PyObject *`. Cython's support for `PyObject *` (i.e., borrowed references) is poor -- basically intentionally so at the moment because a good interface (other than just the C interface) hasn't been formulated yet.

> Could we also remove or comment the `cpdef inline Py_ssize_t signed_id(x)`?

No objections to that.



---

archive/issue_comments_239970.json:
```json
{
    "body": "Replying to [comment:20 nbruin]:\n> Replying to [comment:19 vdelecroix]:\n> > Why `void Py_VISIT(PyObject *o)` is not compatible with Cython? I do not quite understand what is this `__pyx_v_visit`. Is it because of Cython renaming arguments? If it is so, I do not find it very safe.\n> \n> Correct, and I agree. Depending on the user giving parameters a particular name *and* cython mangling the names in a particular way is more fragile than what the CPython macro does.\nHow about generalizing the macro to accept `visit` and `arg` arguments?\n\n> We only use this stuff twice\n8 times if I count correctly.",
    "created_at": "2015-04-20T19:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239970",
    "user": "@jdemeyer"
}
```

Replying to [comment:20 nbruin]:
> Replying to [comment:19 vdelecroix]:
> > Why `void Py_VISIT(PyObject *o)` is not compatible with Cython? I do not quite understand what is this `__pyx_v_visit`. Is it because of Cython renaming arguments? If it is so, I do not find it very safe.
> 
> Correct, and I agree. Depending on the user giving parameters a particular name *and* cython mangling the names in a particular way is more fragile than what the CPython macro does.
How about generalizing the macro to accept `visit` and `arg` arguments?

> We only use this stuff twice
8 times if I count correctly.



---

archive/issue_comments_239971.json:
```json
{
    "body": "Replying to [comment:21 jdemeyer]:\n> How about generalizing the macro to accept `visit` and `arg` arguments?\n\nFine with me. It's brainless boilerplate, but at least we have a clean macro that way that doesn't depend on naming conventions and (undocumented) cython behaviour.\n\n> > We only use this stuff twice\n> 8 times if I count correctly.\nOK, \"twice\"= in two simple, trivial, boilerplate routines :-).",
    "created_at": "2015-04-20T20:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239971",
    "user": "@nbruin"
}
```

Replying to [comment:21 jdemeyer]:
> How about generalizing the macro to accept `visit` and `arg` arguments?

Fine with me. It's brainless boilerplate, but at least we have a clean macro that way that doesn't depend on naming conventions and (undocumented) cython behaviour.

> > We only use this stuff twice
> 8 times if I count correctly.
OK, "twice"= in two simple, trivial, boilerplate routines :-).



---

archive/issue_comments_239972.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-21T09:03:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239972",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_239973.json:
```json
{
    "body": "Replying to [comment:20 nbruin]:\n> Replying to [comment:19 vdelecroix]:\n> > Could you explain to me the reason of declaring\n> > {{{\n> >     int PyList_SetItem(object list, Py_ssize_t index, PyObject * item) except -1\n> > }}}\n> > and not use the `PyList_SetItem` from `cpython.lists` declared as `(object,Py_ssize_t,object)`? It would also be cool to add a comment if it is important to keep as such.\n> \n> See its use in `extract_*` functions. It's handling `PyObject*` there and a cast to `object` would generate an INCREF (which is really not what you want to do in code that's just deleting things). This ticket doesn't affect that code.\n\n`@`Nils: then do you think Cython is wrong here?\n\n> > In `sage/structure/coerce_dict.pyx`, couldn't you get rid of\n> > {{{\n> > cdef extern from \"Python.h\":\n> >     PyObject* PyWeakref_GetObject(object r)\n> > }}}\n> > It is in `cpython.weakref`.\n> \n> So it is now! I don't think it was before.\n\n`@`Jeroen: could this be done here?",
    "created_at": "2015-04-21T12:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239973",
    "user": "@videlec"
}
```

Replying to [comment:20 nbruin]:
> Replying to [comment:19 vdelecroix]:
> > Could you explain to me the reason of declaring
> > {{{
> >     int PyList_SetItem(object list, Py_ssize_t index, PyObject * item) except -1
> > }}}
> > and not use the `PyList_SetItem` from `cpython.lists` declared as `(object,Py_ssize_t,object)`? It would also be cool to add a comment if it is important to keep as such.
> 
> See its use in `extract_*` functions. It's handling `PyObject*` there and a cast to `object` would generate an INCREF (which is really not what you want to do in code that's just deleting things). This ticket doesn't affect that code.

`@`Nils: then do you think Cython is wrong here?

> > In `sage/structure/coerce_dict.pyx`, couldn't you get rid of
> > {{{
> > cdef extern from "Python.h":
> >     PyObject* PyWeakref_GetObject(object r)
> > }}}
> > It is in `cpython.weakref`.
> 
> So it is now! I don't think it was before.

`@`Jeroen: could this be done here?



---

archive/issue_comments_239974.json:
```json
{
    "body": "Replying to [comment:25 vdelecroix]:\n> Replying to [comment:20 nbruin]:\n> > Replying to [comment:19 vdelecroix]:\n> > > Could you explain to me the reason of declaring\n> > > {{{\n> > >     int PyList_SetItem(object list, Py_ssize_t index, PyObject * item) except -1\n> > > }}}\n> > > and not use the `PyList_SetItem` from `cpython.lists` declared as `(object,Py_ssize_t,object)`? It would also be cool to add a comment if it is important to keep as such.\n> > \n> > See its use in `extract_*` functions. It's handling `PyObject*` there and a cast to `object` would generate an INCREF (which is really not what you want to do in code that's just deleting things). This ticket doesn't affect that code.\n> \n> `@`Nils: then do you think Cython is wrong here?\n> \n> > > In `sage/structure/coerce_dict.pyx`, couldn't you get rid of\n> > > {{{\n> > > cdef extern from \"Python.h\":\n> > >     PyObject* PyWeakref_GetObject(object r)\n> > > }}}\n> > > It is in `cpython.weakref`.\n> > \n> > So it is now! I don't think it was before.\n> \n> `@`Jeroen: could this be done here?\n\nBoth questions have the same answer: using `PyObject*` instead of `object` is the right thing in this specific use case. Cython isn't wrong, it's just that we are doing very low-level stuff for which the standard Cython declarations don't work.",
    "created_at": "2015-04-21T18:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239974",
    "user": "@jdemeyer"
}
```

Replying to [comment:25 vdelecroix]:
> Replying to [comment:20 nbruin]:
> > Replying to [comment:19 vdelecroix]:
> > > Could you explain to me the reason of declaring
> > > {{{
> > >     int PyList_SetItem(object list, Py_ssize_t index, PyObject * item) except -1
> > > }}}
> > > and not use the `PyList_SetItem` from `cpython.lists` declared as `(object,Py_ssize_t,object)`? It would also be cool to add a comment if it is important to keep as such.
> > 
> > See its use in `extract_*` functions. It's handling `PyObject*` there and a cast to `object` would generate an INCREF (which is really not what you want to do in code that's just deleting things). This ticket doesn't affect that code.
> 
> `@`Nils: then do you think Cython is wrong here?
> 
> > > In `sage/structure/coerce_dict.pyx`, couldn't you get rid of
> > > {{{
> > > cdef extern from "Python.h":
> > >     PyObject* PyWeakref_GetObject(object r)
> > > }}}
> > > It is in `cpython.weakref`.
> > 
> > So it is now! I don't think it was before.
> 
> `@`Jeroen: could this be done here?

Both questions have the same answer: using `PyObject*` instead of `object` is the right thing in this specific use case. Cython isn't wrong, it's just that we are doing very low-level stuff for which the standard Cython declarations don't work.



---

archive/issue_comments_239975.json:
```json
{
    "body": "`PyWeakref_GetObject` is defined in ` cpython.weakref` as\n\n```\n    PyObject* PyWeakref_GetObject(object ref)\n    # Return the referenced object from a weak reference, ref.  If the\n    # referent is no longer live, returns None.\n```\n",
    "created_at": "2015-04-21T19:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239975",
    "user": "@videlec"
}
```

`PyWeakref_GetObject` is defined in ` cpython.weakref` as

```
    PyObject* PyWeakref_GetObject(object ref)
    # Return the referenced object from a weak reference, ref.  If the
    # referent is no longer live, returns None.
```




---

archive/issue_comments_239976.json:
```json
{
    "body": "Replying to [comment:27 vdelecroix]:\n> `PyWeakref_GetObject` is defined in ` cpython.weakref` as\n> {{{\n>     PyObject* PyWeakref_GetObject(object ref)\n>     # Return the referenced object from a weak reference, ref.  If the\n>     # referent is no longer live, returns None.\n> }}}\nYes, and that is the same signature as with which it is defined in `coerce_dict.pyx`. Apparently we're only dereferencing weakrefs we are actually owning (i.e., `object`s). Its return type is also correctly typed, since it returns a *borrowed* reference, so the normal use of storing the returned value into an `<object>` leads exactly to the INCREF required to ensure the object doesn't get deallocated.\n\nI am pretty sure that if this is now available in cpython.weakref, we can cimport it from there rather than explicitly \"cdef extern\" it from \"Python.h\". Of course, there will be absolutely no difference to the eventual code generated either.",
    "created_at": "2015-04-21T19:13:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239976",
    "user": "@nbruin"
}
```

Replying to [comment:27 vdelecroix]:
> `PyWeakref_GetObject` is defined in ` cpython.weakref` as
> {{{
>     PyObject* PyWeakref_GetObject(object ref)
>     # Return the referenced object from a weak reference, ref.  If the
>     # referent is no longer live, returns None.
> }}}
Yes, and that is the same signature as with which it is defined in `coerce_dict.pyx`. Apparently we're only dereferencing weakrefs we are actually owning (i.e., `object`s). Its return type is also correctly typed, since it returns a *borrowed* reference, so the normal use of storing the returned value into an `<object>` leads exactly to the INCREF required to ensure the object doesn't get deallocated.

I am pretty sure that if this is now available in cpython.weakref, we can cimport it from there rather than explicitly "cdef extern" it from "Python.h". Of course, there will be absolutely no difference to the eventual code generated either.



---

archive/issue_comments_239977.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-21T19:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239977",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_239978.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-21T20:02:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239978",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_239979.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-21T20:02:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239979",
    "user": "@jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_239980.json:
```json
{
    "body": "I have no further remark.\n\nVincent",
    "created_at": "2015-04-21T20:26:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239980",
    "user": "@videlec"
}
```

I have no further remark.

Vincent



---

archive/issue_comments_239981.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-22T05:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239981",
    "user": "@nbruin"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_239982.json:
```json
{
    "body": "seems good to me!",
    "created_at": "2015-04-22T05:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239982",
    "user": "@nbruin"
}
```

seems good to me!



---

archive/issue_comments_239983.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-23T03:21:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239983",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_239984.json:
```json
{
    "body": "Please, guys, fix the milestones...  (It's odd enough \"Merged in\" gets no longer filled.)",
    "created_at": "2015-04-25T02:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239984",
    "user": "@nexttime"
}
```

Please, guys, fix the milestones...  (It's odd enough "Merged in" gets no longer filled.)



---

archive/issue_comments_239985.json:
```json
{
    "body": "this ticket was opened before 6.7",
    "created_at": "2015-04-25T02:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239985",
    "user": "@vbraun"
}
```

this ticket was opened before 6.7



---

archive/issue_comments_239986.json:
```json
{
    "body": "Replying to [comment:36 vbraun]:\n> this ticket was opened before 6.7\n\nSo what?  Besides that `vbraun_spam` appears to be on holidays since a while, certainly 6.6 got released before this ticket got closed.  (And it's based on 6.7.beta2.)\n\nIf someone sees a closed milestone on a (closed) ticket, the first guess is that it'd been merged into that release.\n\nI'm certainly not the only one not wanting having to read the ticket history and/or to look up the parent(s) of the commit to find out whether that's true or not.\n\nEspecially \"ordinary\" Sage users simply won't do that, e.g. if they want to find out whether a bug has already been fixed, and if so, in which [stable] release.",
    "created_at": "2015-04-25T02:42:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239986",
    "user": "@nexttime"
}
```

Replying to [comment:36 vbraun]:
> this ticket was opened before 6.7

So what?  Besides that `vbraun_spam` appears to be on holidays since a while, certainly 6.6 got released before this ticket got closed.  (And it's based on 6.7.beta2.)

If someone sees a closed milestone on a (closed) ticket, the first guess is that it'd been merged into that release.

I'm certainly not the only one not wanting having to read the ticket history and/or to look up the parent(s) of the commit to find out whether that's true or not.

Especially "ordinary" Sage users simply won't do that, e.g. if they want to find out whether a bug has already been fixed, and if so, in which [stable] release.



---

archive/issue_comments_239987.json:
```json
{
    "body": "We agreed to not update the milestone at each new release. Karl-Dieter wanted to write a script to set the milestone (edit: I mean merged-in) after each release, I'm sure he would appreciate help...",
    "created_at": "2015-04-25T02:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239987",
    "user": "@vbraun"
}
```

We agreed to not update the milestone at each new release. Karl-Dieter wanted to write a script to set the milestone (edit: I mean merged-in) after each release, I'm sure he would appreciate help...



---

archive/issue_comments_239988.json:
```json
{
    "body": "Replying to [comment:38 vbraun]:\n> We agreed to not update the milestone at each new release.\n\nWhy?  (Pointer?)\n\nIf so, then at least the milestone should get corrected by the authors/reviewers or the RM before it gets closed.\n\nBut it's annoying to have open (new/needs review/whatever) tickets for already closed milestones; usual queries will no longer work (as expected).\n\n\n\n\n\n> Karl-Dieter wanted to write a script to set the milestone (edit: I mean merged-in) after each release, I'm sure he would appreciate help...\n\nThe only thing one needs is a \"spam\" trac account... ;-)",
    "created_at": "2015-04-25T03:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239988",
    "user": "@nexttime"
}
```

Replying to [comment:38 vbraun]:
> We agreed to not update the milestone at each new release.

Why?  (Pointer?)

If so, then at least the milestone should get corrected by the authors/reviewers or the RM before it gets closed.

But it's annoying to have open (new/needs review/whatever) tickets for already closed milestones; usual queries will no longer work (as expected).





> Karl-Dieter wanted to write a script to set the milestone (edit: I mean merged-in) after each release, I'm sure he would appreciate help...

The only thing one needs is a "spam" trac account... ;-)



---

archive/issue_comments_239989.json:
```json
{
    "body": "Replying to [comment:39 leif]:\n> Why?  (Pointer?)\n\nGoogle? ... sigh... http://thread.gmane.org/gmane.comp.mathematics.sage.devel/74794/focus=74860",
    "created_at": "2015-04-25T03:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239989",
    "user": "@vbraun"
}
```

Replying to [comment:39 leif]:
> Why?  (Pointer?)

Google? ... sigh... http://thread.gmane.org/gmane.comp.mathematics.sage.devel/74794/focus=74860



---

archive/issue_comments_239990.json:
```json
{
    "body": "Replying to [comment:40 vbraun]:\n> Replying to [comment:39 leif]:\n> > Why?  (Pointer?)\n> \n> Google? \n\nGmane!\n\n> ... sigh... http://thread.gmane.org/gmane.comp.mathematics.sage.devel/74794/focus=74860\n\n\nQuoting Ivan: *\"Why can\u2019t we just set them all to future, **and then when they get merged, we can change the milestone to the actual version**?\"*",
    "created_at": "2015-04-25T04:38:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17884",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17884#issuecomment-239990",
    "user": "@nexttime"
}
```

Replying to [comment:40 vbraun]:
> Replying to [comment:39 leif]:
> > Why?  (Pointer?)
> 
> Google? 

Gmane!

> ... sigh... http://thread.gmane.org/gmane.comp.mathematics.sage.devel/74794/focus=74860


Quoting Ivan: *"Why canâ€™t we just set them all to future, **and then when they get merged, we can change the milestone to the actual version**?"*
