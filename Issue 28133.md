# Issue 28133: Polyhedron pynormaliz backend does not handle large coefficients correctly

archive/issues_028133.json:
```json
{
    "body": "CC:  @mkoeppe @jplab\n\n\n```\nsage: x = polygen(ZZ)\nsage: K.<sqrt2> = NumberField(x^2 - 2, embedding=AA(2).sqrt())\nsage: P = Polyhedron(vertices=[(2**100, sqrt2), (sqrt2,1)], backend='normaliz')\nError in rational_handler: Python int too large to convert to C long\nError in nfelem_handler: unsupported operand type(s) for +=: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'\nError in rational_handler: Python int too large to convert to C unsigned long\nError in rational_handler: Python int too large to convert to C unsigned long\nError in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'\nError in rational_handler: Python int too large to convert to C long\nError in rational_handler: Python int too large to convert to C long\nError in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'\nError in rational_handler: Python int too large to convert to C long\nError in rational_handler: Python int too large to convert to C long\nError in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'\nsage: P.vertices()\n(A vertex at (sqrt2, 1), A vertex at (0, sqrt2))\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/28370\n\n",
    "created_at": "2019-08-20T08:26:20Z",
    "labels": [
        "component: geometry",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Polyhedron pynormaliz backend does not handle large coefficients correctly",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28133",
    "user": "https://github.com/videlec"
}
```
CC:  @mkoeppe @jplab


```
sage: x = polygen(ZZ)
sage: K.<sqrt2> = NumberField(x^2 - 2, embedding=AA(2).sqrt())
sage: P = Polyhedron(vertices=[(2**100, sqrt2), (sqrt2,1)], backend='normaliz')
Error in rational_handler: Python int too large to convert to C long
Error in nfelem_handler: unsupported operand type(s) for +=: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'
Error in rational_handler: Python int too large to convert to C unsigned long
Error in rational_handler: Python int too large to convert to C unsigned long
Error in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'
Error in rational_handler: Python int too large to convert to C long
Error in rational_handler: Python int too large to convert to C long
Error in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'
Error in rational_handler: Python int too large to convert to C long
Error in rational_handler: Python int too large to convert to C long
Error in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'
sage: P.vertices()
(A vertex at (sqrt2, 1), A vertex at (0, sqrt2))
```


Issue created by migration from https://trac.sagemath.org/ticket/28370





---

archive/issue_comments_396913.json:
```json
{
    "body": "I just think that #28321 is to blame (Python 3 issue)",
    "created_at": "2019-08-20T08:38:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396913",
    "user": "https://github.com/videlec"
}
```

I just think that #28321 is to blame (Python 3 issue)



---

archive/issue_comments_396914.json:
```json
{
    "body": "You mean that it would be a duplicate? i.e. that the backend is fine?",
    "created_at": "2019-08-20T08:53:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396914",
    "user": "https://github.com/jplab"
}
```

You mean that it would be a duplicate? i.e. that the backend is fine?



---

archive/issue_comments_396915.json:
```json
{
    "body": "It is probably not a problem with the backend.",
    "created_at": "2019-08-20T08:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396915",
    "user": "https://github.com/videlec"
}
```

It is probably not a problem with the backend.



---

archive/issue_comments_396916.json:
```json
{
    "body": "I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.",
    "created_at": "2019-08-20T11:37:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396916",
    "user": "https://github.com/videlec"
}
```

I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.



---

archive/issue_comments_396917.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-20T11:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396917",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_events_070876.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-08-20T11:37:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28133#event-70876"
}
```



---

archive/issue_comments_396918.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-08-20T12:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396918",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_396919.json:
```json
{
    "body": "Replying to [comment:5 vdelecroix]:\n> I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.\n\nI agree. Where to raise this error? This should become another ticket?",
    "created_at": "2019-08-20T12:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396919",
    "user": "https://github.com/jplab"
}
```

Replying to [comment:5 vdelecroix]:
> I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.

I agree. Where to raise this error? This should become another ticket?



---

archive/issue_comments_396920.json:
```json
{
    "body": "Replying to [comment:7 jipilab]:\n> Replying to [comment:5 vdelecroix]:\n> > I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.\n> \n> I agree. Where to raise this error? This should become another ticket?\n\n- Another ticket: yes\n- What to do: just remove the `try/except`",
    "created_at": "2019-08-20T12:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396920",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:7 jipilab]:
> Replying to [comment:5 vdelecroix]:
> > I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.
> 
> I agree. Where to raise this error? This should become another ticket?

- Another ticket: yes
- What to do: just remove the `try/except`



---

archive/issue_comments_396921.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2019-08-26T18:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28133#issuecomment-396921",
    "user": "https://github.com/fchapoton"
}
```

Resolution: duplicate



---

archive/issue_events_070877.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-08-26T18:29:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/28133",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/28133#event-70877"
}
```
