# Issue 28133: Polyhedron pynormaliz backend does not handle large coefficients correctly

Issue created by migration from https://trac.sagemath.org/ticket/28370

Original creator: vdelecroix

Original creation time: 2019-08-20 08:26:20

CC:  mkoeppe jipilab


```
sage: x = polygen(ZZ)
sage: K.<sqrt2> = NumberField(x^2 - 2, embedding=AA(2).sqrt())
sage: P = Polyhedron(vertices=[(2**100, sqrt2), (sqrt2,1)], backend='normaliz')
Error in rational_handler: Python int too large to convert to C long
Error in nfelem_handler: unsupported operand type(s) for +=: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'
Error in rational_handler: Python int too large to convert to C unsigned long
Error in rational_handler: Python int too large to convert to C unsigned long
Error in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'
Error in rational_handler: Python int too large to convert to C long
Error in rational_handler: Python int too large to convert to C long
Error in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'
Error in rational_handler: Python int too large to convert to C long
Error in rational_handler: Python int too large to convert to C long
Error in nfelem_handler: unsupported operand type(s) for *: 'NoneType' and 'sage.rings.number_field.number_field_element_quadratic.NumberFieldElement_quadratic'
sage: P.vertices()
(A vertex at (sqrt2, 1), A vertex at (0, sqrt2))
```



---

Comment by vdelecroix created at 2019-08-20 08:38:27

I just think that #28321 is to blame (Python 3 issue)


---

Comment by jipilab created at 2019-08-20 08:53:11

You mean that it would be a duplicate? i.e. that the backend is fine?


---

Comment by vdelecroix created at 2019-08-20 08:57:37

It is probably not a problem with the backend.


---

Comment by vdelecroix created at 2019-08-20 11:37:27

I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.


---

Comment by vdelecroix created at 2019-08-20 11:37:57

Changing status from new to needs_review.


---

Comment by jipilab created at 2019-08-20 12:07:27

Changing status from needs_review to positive_review.


---

Comment by jipilab created at 2019-08-20 12:07:27

Replying to [comment:5 vdelecroix]:
> I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.

I agree. Where to raise this error? This should become another ticket?


---

Comment by vdelecroix created at 2019-08-20 12:20:43

Replying to [comment:7 jipilab]:
> Replying to [comment:5 vdelecroix]:
> > I confirm that it is solved with #28321... however, the fact that errors are not raised in the constructor is a bug in itself. In the example I wrote in the ticket description, I obtain a polytope `P` which is simply wrong. It is to my mind much better to get an error rather than false results.
> 
> I agree. Where to raise this error? This should become another ticket?

- Another ticket: yes
- What to do: just remove the `try/except`


---

Comment by chapoton created at 2019-08-26 18:29:17

Resolution: duplicate
