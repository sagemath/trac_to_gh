# Issue 20177: Add copy/__copy__ methods to CVXOPT, PPL, InteractiveLP backends

archive/issues_020177.json:
```json
{
    "body": "CC:  vdelecroix vbraun dimpase\n\nKeywords: lp\n\nThe COIN, CPLEX, GLPK, and Gurobi backends supply a `copy` method. \nBut it's not documented as a backend interface method in `GenericBackend`, and the CVXOPT, PPL, InteractiveLP backends do not implement it. \nIt is used by `MixedIntegerLinearProgram.__copy__`.\n\nThe backend method should actually probably be called `__copy__` as well -- see https://docs.python.org/2/library/copy.html\n\nSee also #15159 (which may indicate that we may need a `__deepcopy__` method as well) and #20323 (in which copying a backend could be the basis for more diverse tests)\n\nIssue created by migration from https://trac.sagemath.org/ticket/20414\n\n",
    "created_at": "2016-04-11T01:37:33Z",
    "labels": [
        "numerical",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "Add copy/__copy__ methods to CVXOPT, PPL, InteractiveLP backends",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20177",
    "user": "mkoeppe"
}
```
CC:  vdelecroix vbraun dimpase

Keywords: lp

The COIN, CPLEX, GLPK, and Gurobi backends supply a `copy` method. 
But it's not documented as a backend interface method in `GenericBackend`, and the CVXOPT, PPL, InteractiveLP backends do not implement it. 
It is used by `MixedIntegerLinearProgram.__copy__`.

The backend method should actually probably be called `__copy__` as well -- see https://docs.python.org/2/library/copy.html

See also #15159 (which may indicate that we may need a `__deepcopy__` method as well) and #20323 (in which copying a backend could be the basis for more diverse tests)

Issue created by migration from https://trac.sagemath.org/ticket/20414





---

archive/issue_comments_278199.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2016-04-15T02:28:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278199",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_278200.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-15T02:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278200",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278201.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-15T07:24:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278201",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278202.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-04-15T07:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278202",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_278203.json:
```json
{
    "body": "The branch is on top of #20323 (Common `TestSuite` for MIP backends).\nThe `_test_copy_some_mips` method exposed a bug in `CoinBackend`, which I have fixed on the way.",
    "created_at": "2016-04-15T07:31:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278203",
    "user": "mkoeppe"
}
```

The branch is on top of #20323 (Common `TestSuite` for MIP backends).
The `_test_copy_some_mips` method exposed a bug in `CoinBackend`, which I have fixed on the way.



---

archive/issue_comments_278204.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-17T00:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278204",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278205.json:
```json
{
    "body": "Now also contains a fix for #15159 (see description). \nNeeds review.",
    "created_at": "2016-04-17T00:38:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278205",
    "user": "mkoeppe"
}
```

Now also contains a fix for #15159 (see description). 
Needs review.



---

archive/issue_comments_278206.json:
```json
{
    "body": "How reliable is `__deepcopy__` here? Is it just working now?",
    "created_at": "2016-04-18T11:37:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278206",
    "user": "dimpase"
}
```

How reliable is `__deepcopy__` here? Is it just working now?



---

archive/issue_comments_278207.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-04-18T18:49:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278207",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_278208.json:
```json
{
    "body": "Replying to [comment:10 dimpase]:\n> How reliable is `__deepcopy__` here? Is it just working now?\n\nIt's working. I've added another test to illustrate deepcopy semantics.",
    "created_at": "2016-04-18T18:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278208",
    "user": "mkoeppe"
}
```

Replying to [comment:10 dimpase]:
> How reliable is `__deepcopy__` here? Is it just working now?

It's working. I've added another test to illustrate deepcopy semantics.



---

archive/issue_comments_278209.json:
```json
{
    "body": "Replying to [comment:12 mkoeppe]:\n> Replying to [comment:10 dimpase]:\n> > How reliable is `__deepcopy__` here? Is it just working now?\n> \n> It's working. I've added another test to illustrate deepcopy semantics.\n\nwas there something about variables that are (not) copied?",
    "created_at": "2016-04-18T19:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278209",
    "user": "dimpase"
}
```

Replying to [comment:12 mkoeppe]:
> Replying to [comment:10 dimpase]:
> > How reliable is `__deepcopy__` here? Is it just working now?
> 
> It's working. I've added another test to illustrate deepcopy semantics.

was there something about variables that are (not) copied?



---

archive/issue_comments_278210.json:
```json
{
    "body": "Replying to [comment:13 dimpase]:\n> was there something about variables that are (not) copied?\n\nBefore this patch, deepcopy didn't even copy the backend of a MIP. \nNow it does, simply by doing the same as copy.\n\nBoth copy and deepcopy have weird semantics in relation to the MIPVariables in a problems -- because a MIP does not have an API to gain access to its variables; and trying to use the old MIPVariables with the copy is questionable and definitely broken if one creates new components of this variable, see #15159, #19523. Fixing this would require a redesign; a possible stopgap would be to stop all MIPVariables from creating new components when they have been subjected to copy().",
    "created_at": "2016-04-18T19:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278210",
    "user": "mkoeppe"
}
```

Replying to [comment:13 dimpase]:
> was there something about variables that are (not) copied?

Before this patch, deepcopy didn't even copy the backend of a MIP. 
Now it does, simply by doing the same as copy.

Both copy and deepcopy have weird semantics in relation to the MIPVariables in a problems -- because a MIP does not have an API to gain access to its variables; and trying to use the old MIPVariables with the copy is questionable and definitely broken if one creates new components of this variable, see #15159, #19523. Fixing this would require a redesign; a possible stopgap would be to stop all MIPVariables from creating new components when they have been subjected to copy().



---

archive/issue_comments_278211.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-18T21:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278211",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_278212.json:
```json
{
    "body": "ok, fine.",
    "created_at": "2016-04-18T21:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278212",
    "user": "dimpase"
}
```

ok, fine.



---

archive/issue_comments_278213.json:
```json
{
    "body": "Replying to [comment:15 dimpase]:\n> ok, fine.\n\nThanks for reviewing.\n\nI've created a new ticket, #20461, for solving the issue with the variables of a copied MIP. Please take a look when you have a chance.",
    "created_at": "2016-04-19T04:12:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278213",
    "user": "mkoeppe"
}
```

Replying to [comment:15 dimpase]:
> ok, fine.

Thanks for reviewing.

I've created a new ticket, #20461, for solving the issue with the variables of a copied MIP. Please take a look when you have a chance.



---

archive/issue_comments_278214.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-20T22:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20177",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20177#issuecomment-278214",
    "user": "vbraun"
}
```

Resolution: fixed
