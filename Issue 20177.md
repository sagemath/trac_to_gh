# Issue 20177: Add copy/__copy__ methods to CVXOPT, PPL, InteractiveLP backends

Issue created by migration from Trac.

Original creator: mkoeppe

Original creation time: 2016-04-11 01:37:33

CC:  vdelecroix vbraun dimpase

Keywords: lp

The COIN, CPLEX, GLPK, and Gurobi backends supply a `copy` method. 
But it's not documented as a backend interface method in `GenericBackend`, and the CVXOPT, PPL, InteractiveLP backends do not implement it. 
It is used by `MixedIntegerLinearProgram.__copy__`.

The backend method should actually probably be called `__copy__` as well -- see https://docs.python.org/2/library/copy.html

See also #15159 (which may indicate that we may need a `__deepcopy__` method as well) and #20323 (in which copying a backend could be the basis for more diverse tests)


---

Comment by git created at 2016-04-15 02:28:28

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2016-04-15 02:43:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-04-15 07:24:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-04-15 07:31:21

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2016-04-15 07:31:21

The branch is on top of #20323 (Common `TestSuite` for MIP backends).
The `_test_copy_some_mips` method exposed a bug in `CoinBackend`, which I have fixed on the way.


---

Comment by git created at 2016-04-17 00:34:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-04-17 00:38:36

Now also contains a fix for #15159 (see description). 
Needs review.


---

Comment by dimpase created at 2016-04-18 11:37:28

How reliable is `__deepcopy__` here? Is it just working now?


---

Comment by git created at 2016-04-18 18:49:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2016-04-18 18:50:05

Replying to [comment:10 dimpase]:
> How reliable is `__deepcopy__` here? Is it just working now?

It's working. I've added another test to illustrate deepcopy semantics.


---

Comment by dimpase created at 2016-04-18 19:08:23

Replying to [comment:12 mkoeppe]:
> Replying to [comment:10 dimpase]:
> > How reliable is `__deepcopy__` here? Is it just working now?
> 
> It's working. I've added another test to illustrate deepcopy semantics.

was there something about variables that are (not) copied?


---

Comment by mkoeppe created at 2016-04-18 19:25:37

Replying to [comment:13 dimpase]:
> was there something about variables that are (not) copied?

Before this patch, deepcopy didn't even copy the backend of a MIP. 
Now it does, simply by doing the same as copy.

Both copy and deepcopy have weird semantics in relation to the MIPVariables in a problems -- because a MIP does not have an API to gain access to its variables; and trying to use the old MIPVariables with the copy is questionable and definitely broken if one creates new components of this variable, see #15159, #19523. Fixing this would require a redesign; a possible stopgap would be to stop all MIPVariables from creating new components when they have been subjected to copy().


---

Comment by dimpase created at 2016-04-18 21:27:53

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2016-04-18 21:27:53

ok, fine.


---

Comment by mkoeppe created at 2016-04-19 04:12:26

Replying to [comment:15 dimpase]:
> ok, fine.

Thanks for reviewing.

I've created a new ticket, #20461, for solving the issue with the variables of a copied MIP. Please take a look when you have a chance.


---

Comment by vbraun created at 2016-04-20 22:26:38

Resolution: fixed
