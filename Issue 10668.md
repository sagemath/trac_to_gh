# Issue 10668: IndexError in toric sheaf cohomology

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2011-02-02 18:30:14

Assignee: AlexGhitza

CC:  novoselt

This computation dies unnecessarily:

```
sage: cell24 = Polyhedron(vertices=[   
...    (1,0,0,0),(0,1,0,0),(0,0,1,0),(0,0,0,1),(1,-1,-1,1),(0,0,-1,1),          
...    (0,-1,0,1),(-1,0,0,1),(1,0,0,-1),(0,1,0,-1),(0,0,1,-1),(-1,1,1,-1),
...    (1,-1,-1,0),(0,0,-1,0),(0,-1,0,0),(-1,0,0,0),(1,-1,0,0),(1,0,-1,0),
...    (0,1,1,-1),(-1,1,1,0),(-1,1,0,0),(-1,0,1,0),(0,-1,-1,1),(0,0,0,-1)])
sage: X = ToricVariety(FaceFan(cell24.lattice_polytope()))
sage: D = -X.divisor(0)
sage: D.cohomology()
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)

/home/vbraun/Sage/24cell/<ipython console> in <module>()

/home/vbraun/Sage/sage/local/lib/python2.6/site-packages/sage/schemes/generic/toric_divisor.pyc in _sheaf_cohomology(self, cplx)
   1544                 assert(h[1].dimension()==0)
   1545                 continue
-> 1546             HH_list[ h[0]+1 ] = h[1].dimension()
   1547 
   1548         return vector(ZZ, HH_list)

IndexError: list assignment index out of range
```

Inside, the homology of an auxiliary simplicial complex is computed. For sufficiently complicated cases, vector spaces of dimension 0 are sometimes returned even if all higher-dimensional homology groups vanish. My sheaf cohomology code wrongly assumed that this would not be the case.




---

Comment by vbraun created at 2011-02-02 18:40:42

Changing status from new to needs_review.


---

Comment by novoselt created at 2011-02-02 19:39:57

Changing status from needs_review to needs_work.


---

Comment by novoselt created at 2011-02-02 19:39:57

Looks good, but misses the reference to this ticket.

Is it possible to get these 0-dimensional spaces even in negative degree? In general, is it how homology of this associated complex should behave? I.e. was it really a defect of toric code or there should be a follow-up ticket open for homology computation?


---

Comment by vbraun created at 2011-02-02 19:53:43

Updated patch


---

Attachment

I've added a reference to this trac ticket.

I don't think that the homology every returns negative degrees, but even if that were the case it would be mathematically correct as long as the homology group is zero-dimensional. As is, the auxiliary simplicial complex is higher-dimensional (but of course has no homology in degrees larger) than the dimension of the variety. So we can't blame the homology code...


---

Comment by vbraun created at 2011-02-02 19:57:57

Changing status from needs_work to needs_review.


---

Comment by novoselt created at 2011-02-02 20:00:13

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-02-07 08:16:46

Resolution: fixed
