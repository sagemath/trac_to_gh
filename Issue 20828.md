# Issue 20828: Improve pickling error handling

Issue created by migration from https://trac.sagemath.org/ticket/21065

Original creator: novoselt

Original creation time: 2016-07-21 00:18:07

To fix unpickling of old objects it is necessary to know both module and callable. At the moment module may be invisible:

```
sage:  load('http://rlmiller.org/de_codes/get_code.php?id=16_08')
...
/home/novoselt/sage/src/sage/structure/sage_object.pyx in sage.structure.sage_object.unpickle_global (build/cythonized/sage/structure/sage_object.c:12911)()
   1323     mod = sys_modules.get(module)
   1324     if mod is not None:
-> 1325         return getattr(mod, name)
   1326     try:
   1327         __import__(module)

AttributeError: 'module' object has no attribute 'unpickle_FiniteField_prm'
```

After the fix:

```
sage:  load('http://rlmiller.org/de_codes/get_code.php?id=16_08')
...
ImportError: cannot import unpickle_FiniteField_prm from sage.rings.ring, call register_unpickle_override('sage.rings.ring', 'unpickle_FiniteField_prm', ...) to fix this
```



---

Comment by novoselt created at 2016-07-21 00:20:50

Changing status from new to needs_review.


---

Comment by novoselt created at 2016-07-21 00:20:50

New commits:


---

Comment by jdemeyer created at 2016-07-22 08:23:43

Could you add a doctest?


---

Comment by jdemeyer created at 2016-07-22 08:23:43

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-07-23 00:02:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by novoselt created at 2016-07-23 00:05:58

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2016-11-17 05:53:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-11-19 16:34:59

Resolution: fixed
