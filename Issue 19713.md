# Issue 19713: docbuild of single file, allow to include underscore method

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2016-01-23 18:45:30

The hidden doc can be build using

```
sage -docbuild -u
```

but this does not work for a single file. Let us allow that.

later aim: use that in a patchbot plugin.


---

Comment by chapoton created at 2016-01-23 18:46:17

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-01-23 18:46:17

New commits:


---

Comment by git created at 2016-01-27 19:50:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-01-28 12:16:01

Simple enought for even me to review.


---

Comment by jmantysalo created at 2016-01-28 14:22:35

Stupid question, but... 


```
$ make doc-clean
 . . .
Sage build/upgrade complete!
$ ./sage -docbuild -u file=src/sage/graphs/digraph.py  html
[html     ] loading pickled environment... not yet created
 . . .
Build finished. The built documents can be found in /home/jm58660/.sage/docbuild/digraph/output/html
$ find . -name '*digraph*html'
$
```


Where is the result?


---

Comment by chapoton created at 2016-01-28 18:11:12

The result is in the `.sage` directory. Just copy-paste `/home/jm58660/.sage/docbuild/digraph/output/html` in your browser.


---

Comment by jmantysalo created at 2016-01-28 18:54:08

Replying to [comment:5 chapoton]:
> The result is in the `.sage` directory. Just copy-paste `/home/jm58660/.sage/docbuild/digraph/output/html` in your browser.

Duh, why not in `sage`-directory? And sorry for dumb question, should have used `strace`. Or read the output...

When I ran this for `posets.py` I got doc for `posets.is_poset(dig)`, not for `sage.combinat.posets.posets.is_poset(dig)`. Is this a planned feature?

This does not put functions to index generated by `{INDEX_OF_METHODS}`. I think that it is not needed, but I mention this in any case.

Seems to work. I will read the code lines little later.


---

Comment by jhpalmieri created at 2016-01-28 19:07:51

Replying to [comment:6 jmantysalo]:
> Replying to [comment:5 chapoton]:
> > The result is in the `.sage` directory. Just copy-paste `/home/jm58660/.sage/docbuild/digraph/output/html` in your browser.
> 
> Duh, why not in `sage`-directory? 

There is no reason to assume that the user has write access to the Sage directory.

> When I ran this for `posets.py` I got doc for `posets.is_poset(dig)`, not for `sage.combinat.posets.posets.is_poset(dig)`. Is this a planned feature?

The original point of the single file docbuilding functionality was to build documentation for a file not in the Sage library. If you're working on a file within Sage, say in `src/combinat`, then you should probably be doing something like `sage --docbuild reference/combinat html`


---

Comment by chapoton created at 2016-01-28 19:15:52

Replying to [comment:7 jhpalmieri]:

> The original point of the single file docbuilding functionality was to build documentation for a file not in the Sage library. If you're working on a file within Sage, say in `src/combinat`, then you should probably be doing something like `sage --docbuild reference/combinat html`

Hum, I would like to use that in the patchbot, to test the hidden doc only in the modified files. Do you think this is not a good idea ? or that it cannot work ?


---

Comment by jhpalmieri created at 2016-01-28 20:35:44

Replying to [comment:8 chapoton]:
> Replying to [comment:7 jhpalmieri]:
> 
> > The original point of the single file docbuilding functionality was to build documentation for a file not in the Sage library. If you're working on a file within Sage, say in `src/combinat`, then you should probably be doing something like `sage --docbuild reference/combinat html`
> 
> Hum, I would like to use that in the patchbot, to test the hidden doc only in the modified files. Do you think this is not a good idea ? or that it cannot work ?

It might work, at least if you're just relying on it to flag errors. The output may not look right if it's a Sage library file (saying `posets.is_poset` rather than `sage.combinat.posets.posets.is_poset`, for example, and I don't know if there are other problems), but the patchbot won't care about that. Have you tested it on many Sage library files?


---

Comment by chapoton created at 2016-01-28 20:49:12

No, I have only tested that on a few Sage library files so far. Before trying
to insert that in the patchbot, this must of course be more thoroughly tested.


---

Comment by jmantysalo created at 2016-01-29 05:32:58

Also pdf documentation builds.


---

Comment by jmantysalo created at 2016-01-29 05:32:58

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-01-30 00:11:01

Resolution: fixed
