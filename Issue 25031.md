# Issue 25031: Bug in GammaH modular symbols

Issue created by migration from https://trac.sagemath.org/ticket/25268

Original creator: davidloeffler

Original creation time: 2018-04-30 19:12:50

Keywords: modular symbols


```
sage: G = GammaH(20, [13])
sage: A = ModularSymbols(G, 3)
sage: S = A.cuspidal_submodule()
sage: S.dimension() # should be 8
7
sage: S.hecke_matrix(2)
---------------------------------------------------------------------------
ArithmeticError                           Traceback (most recent call last)
<ipython-input-60-2f6aec71996b> in <module>()
----> 1 S.hecke_matrix(Integer(2))

/home/masiao/sage/local/lib/python2.7/site-packages/sage/modular/hecke/module.pyc in hecke_matrix(self, n)
   1400             raise IndexError("n must be positive.")
   1401         if n not in self._hecke_matrices:
-> 1402             T = self._compute_hecke_matrix(n)
   1403             T.set_immutable()
   1404             self._hecke_matrices[n] = T

/home/masiao/sage/local/lib/python2.7/site-packages/sage/modular/hecke/submodule.pyc in _compute_hecke_matrix(self, n)
    239         A = self.ambient_hecke_module().hecke_matrix(n)
    240         check = arith.gcd(self.level(), n) != 1
--> 241         return A.restrict(self.free_module(), check=check)
    242 
    243     def _compute_diamond_matrix(self, d):

/home/masiao/sage/local/lib/python2.7/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.restrict (build/cythonized/sage/matrix/matrix2.c:41151)()
   5052                 C = [V.coordinate_vector(b*self) for b in V.basis()]
   5053             except ArithmeticError:
-> 5054                 raise ArithmeticError("subspace is not invariant under matrix")
   5055             return self.new_matrix(n, n, C, sparse=False)
   5056 

ArithmeticError: subspace is not invariant under matrix
```


The whole space is getting computed wrongly, it seems, because it should have twice the cuspidal dimension (i.e. 8), but its dimension is being computed as 7. This may well have something to do with #6072 and/or #7837.


---

Comment by davidloeffler created at 2018-05-12 21:39:49

Fixed (and doctested) in the git branch I just uploaded at #6072. This ticket can be closed as duplicate when that gets merged.


---

Comment by davidloeffler created at 2018-05-12 21:39:49

Changing status from new to needs_review.


---

Comment by tscrim created at 2018-05-12 22:01:43

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2018-05-18 17:16:26

closing positively reviewed duplicates


---

Comment by vdelecroix created at 2018-05-18 17:16:26

Resolution: wontfix
