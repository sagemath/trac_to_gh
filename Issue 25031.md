# Issue 25031: Bug in GammaH modular symbols

archive/issues_025031.json:
```json
{
    "body": "Keywords: modular symbols\n\n\n```\nsage: G = GammaH(20, [13])\nsage: A = ModularSymbols(G, 3)\nsage: S = A.cuspidal_submodule()\nsage: S.dimension() # should be 8\n7\nsage: S.hecke_matrix(2)\n---------------------------------------------------------------------------\nArithmeticError                           Traceback (most recent call last)\n<ipython-input-60-2f6aec71996b> in <module>()\n----> 1 S.hecke_matrix(Integer(2))\n\n/home/masiao/sage/local/lib/python2.7/site-packages/sage/modular/hecke/module.pyc in hecke_matrix(self, n)\n   1400             raise IndexError(\"n must be positive.\")\n   1401         if n not in self._hecke_matrices:\n-> 1402             T = self._compute_hecke_matrix(n)\n   1403             T.set_immutable()\n   1404             self._hecke_matrices[n] = T\n\n/home/masiao/sage/local/lib/python2.7/site-packages/sage/modular/hecke/submodule.pyc in _compute_hecke_matrix(self, n)\n    239         A = self.ambient_hecke_module().hecke_matrix(n)\n    240         check = arith.gcd(self.level(), n) != 1\n--> 241         return A.restrict(self.free_module(), check=check)\n    242 \n    243     def _compute_diamond_matrix(self, d):\n\n/home/masiao/sage/local/lib/python2.7/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.restrict (build/cythonized/sage/matrix/matrix2.c:41151)()\n   5052                 C = [V.coordinate_vector(b*self) for b in V.basis()]\n   5053             except ArithmeticError:\n-> 5054                 raise ArithmeticError(\"subspace is not invariant under matrix\")\n   5055             return self.new_matrix(n, n, C, sparse=False)\n   5056 \n\nArithmeticError: subspace is not invariant under matrix\n```\n\n\nThe whole space is getting computed wrongly, it seems, because it should have twice the cuspidal dimension (i.e. 8), but its dimension is being computed as 7. This may well have something to do with #6072 and/or #7837.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25268\n\n",
    "created_at": "2018-04-30T19:12:50Z",
    "labels": [
        "modular forms",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "Bug in GammaH modular symbols",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25031",
    "user": "@loefflerd"
}
```
Keywords: modular symbols


```
sage: G = GammaH(20, [13])
sage: A = ModularSymbols(G, 3)
sage: S = A.cuspidal_submodule()
sage: S.dimension() # should be 8
7
sage: S.hecke_matrix(2)
---------------------------------------------------------------------------
ArithmeticError                           Traceback (most recent call last)
<ipython-input-60-2f6aec71996b> in <module>()
----> 1 S.hecke_matrix(Integer(2))

/home/masiao/sage/local/lib/python2.7/site-packages/sage/modular/hecke/module.pyc in hecke_matrix(self, n)
   1400             raise IndexError("n must be positive.")
   1401         if n not in self._hecke_matrices:
-> 1402             T = self._compute_hecke_matrix(n)
   1403             T.set_immutable()
   1404             self._hecke_matrices[n] = T

/home/masiao/sage/local/lib/python2.7/site-packages/sage/modular/hecke/submodule.pyc in _compute_hecke_matrix(self, n)
    239         A = self.ambient_hecke_module().hecke_matrix(n)
    240         check = arith.gcd(self.level(), n) != 1
--> 241         return A.restrict(self.free_module(), check=check)
    242 
    243     def _compute_diamond_matrix(self, d):

/home/masiao/sage/local/lib/python2.7/site-packages/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.restrict (build/cythonized/sage/matrix/matrix2.c:41151)()
   5052                 C = [V.coordinate_vector(b*self) for b in V.basis()]
   5053             except ArithmeticError:
-> 5054                 raise ArithmeticError("subspace is not invariant under matrix")
   5055             return self.new_matrix(n, n, C, sparse=False)
   5056 

ArithmeticError: subspace is not invariant under matrix
```


The whole space is getting computed wrongly, it seems, because it should have twice the cuspidal dimension (i.e. 8), but its dimension is being computed as 7. This may well have something to do with #6072 and/or #7837.

Issue created by migration from https://trac.sagemath.org/ticket/25268





---

archive/issue_comments_352238.json:
```json
{
    "body": "Fixed (and doctested) in the git branch I just uploaded at #6072. This ticket can be closed as duplicate when that gets merged.",
    "created_at": "2018-05-12T21:39:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25031#issuecomment-352238",
    "user": "@loefflerd"
}
```

Fixed (and doctested) in the git branch I just uploaded at #6072. This ticket can be closed as duplicate when that gets merged.



---

archive/issue_comments_352239.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-05-12T21:39:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25031#issuecomment-352239",
    "user": "@loefflerd"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_352240.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-05-12T22:01:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25031#issuecomment-352240",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_352241.json:
```json
{
    "body": "closing positively reviewed duplicates",
    "created_at": "2018-05-18T17:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25031#issuecomment-352241",
    "user": "@videlec"
}
```

closing positively reviewed duplicates



---

archive/issue_comments_352242.json:
```json
{
    "body": "Resolution: wontfix",
    "created_at": "2018-05-18T17:16:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25031",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25031#issuecomment-352242",
    "user": "@videlec"
}
```

Resolution: wontfix
