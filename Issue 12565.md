# Issue 12565: Add an `unsafe` argument to Expression.simplify_full()

archive/issues_012565.json:
```json
{
    "body": "Assignee: mjo\n\nCC:  jvkersch navigium\n\nFollowup to #12650. There are a number of tickets open due to the use of `simplify_radical()` in `simplify_full()`. By adding an `unsafe` argument, we make sure the user really knows what he's doing.\n\nFor example,\n\n\n```\nsage: f = sqrt( (x+1)^2 )         \nsage: f.full_simplify(unsafe=True)\nx + 1\n```\n\n\nThis will fix at least,\n\n* [Ask Sage 767](http://ask.sagemath.org/question/767/simplification-errors-in-simple-expressions)\n* #3520 - inconsistency in simplify_radical\n* #11668 - `abs(a+b)^2 == (a+b)^2`\n* #11934 - Symbolic simplification error\n* #12322 - invalid simplification of complex logarithm\n\nAnd maybe more.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12737\n\n",
    "created_at": "2012-03-23T16:13:31Z",
    "labels": [
        "symbolics",
        "major",
        "enhancement"
    ],
    "title": "Add an `unsafe` argument to Expression.simplify_full()",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12565",
    "user": "mjo"
}
```
Assignee: mjo

CC:  jvkersch navigium

Followup to #12650. There are a number of tickets open due to the use of `simplify_radical()` in `simplify_full()`. By adding an `unsafe` argument, we make sure the user really knows what he's doing.

For example,


```
sage: f = sqrt( (x+1)^2 )         
sage: f.full_simplify(unsafe=True)
x + 1
```


This will fix at least,

* [Ask Sage 767](http://ask.sagemath.org/question/767/simplification-errors-in-simple-expressions)
* #3520 - inconsistency in simplify_radical
* #11668 - `abs(a+b)^2 == (a+b)^2`
* #11934 - Symbolic simplification error
* #12322 - invalid simplification of complex logarithm

And maybe more.

Issue created by migration from https://trac.sagemath.org/ticket/12737





---

archive/issue_comments_149370.json:
```json
{
    "body": "Add the flag and update doctests.",
    "created_at": "2012-03-23T18:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149370",
    "user": "mjo"
}
```

Add the flag and update doctests.



---

archive/issue_comments_149371.json:
```json
{
    "body": "Attachment [sage-trac_12737.patch](tarball://root/attachments/some-uuid/ticket12737/sage-trac_12737.patch) by mjo created at 2012-03-23 18:48:39",
    "created_at": "2012-03-23T18:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149371",
    "user": "mjo"
}
```

Attachment [sage-trac_12737.patch](tarball://root/attachments/some-uuid/ticket12737/sage-trac_12737.patch) by mjo created at 2012-03-23 18:48:39



---

archive/issue_comments_149372.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-03-23T18:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149372",
    "user": "mjo"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_149373.json:
```json
{
    "body": "It's not entirely clear to me which simplifications are \"safe\" and which are not. Simplifying `x^2/x` to `x` is also not \"safe\" in the sense that equality does not hold for `x=0`. In many computer algebra systems, acceptable simplifications are not \"safe\" in this respect. By including a default `unsafe=False` I'm afraid you'll be raising expectations to a level that Sage does not attain (yet?).",
    "created_at": "2012-03-23T19:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149373",
    "user": "nbruin"
}
```

It's not entirely clear to me which simplifications are "safe" and which are not. Simplifying `x^2/x` to `x` is also not "safe" in the sense that equality does not hold for `x=0`. In many computer algebra systems, acceptable simplifications are not "safe" in this respect. By including a default `unsafe=False` I'm afraid you'll be raising expectations to a level that Sage does not attain (yet?).



---

archive/issue_comments_149374.json:
```json
{
    "body": "Replying to [comment:2 nbruin]:\n> It's not entirely clear to me which simplifications are \"safe\" and which are not. Simplifying `x^2/x` to `x` is also not \"safe\" in the sense that equality does not hold for `x=0`. In many computer algebra systems, acceptable simplifications are not \"safe\" in this respect. By including a default `unsafe=False` I'm afraid you'll be raising expectations to a level that Sage does not attain (yet?). \n\nIt's completely heuristic: the four I chose nobody seems to have a problem with. `simplify_radical`, on the other hand, wreaks havoc on trivial functions and has been the cause of numerous bug reports and mailing list discussions.\n\nIn `simplify`, after #12650, I say that a safe simplification is one \"for which we are reasonably sure that the input will be considered equivalent to the output.\" That's probably the best we can do for now, and I'm *reasonably sure* that most people would consider `x^2/x` equivalent to `x`.\n\nAs it stands, I think `full_simplify` *sounds* safe so people will assume that anyway. This fix, while not perfect, at least improves things.",
    "created_at": "2012-03-23T19:32:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149374",
    "user": "mjo"
}
```

Replying to [comment:2 nbruin]:
> It's not entirely clear to me which simplifications are "safe" and which are not. Simplifying `x^2/x` to `x` is also not "safe" in the sense that equality does not hold for `x=0`. In many computer algebra systems, acceptable simplifications are not "safe" in this respect. By including a default `unsafe=False` I'm afraid you'll be raising expectations to a level that Sage does not attain (yet?). 

It's completely heuristic: the four I chose nobody seems to have a problem with. `simplify_radical`, on the other hand, wreaks havoc on trivial functions and has been the cause of numerous bug reports and mailing list discussions.

In `simplify`, after #12650, I say that a safe simplification is one "for which we are reasonably sure that the input will be considered equivalent to the output." That's probably the best we can do for now, and I'm *reasonably sure* that most people would consider `x^2/x` equivalent to `x`.

As it stands, I think `full_simplify` *sounds* safe so people will assume that anyway. This fix, while not perfect, at least improves things.



---

archive/issue_comments_149375.json:
```json
{
    "body": "> > It's not entirely clear to me which simplifications are \"safe\" and which are not. Simplifying `x^2/x` to `x` is also not \"safe\" in the sense that equality does not hold for `x=0`. In many computer algebra systems, acceptable simplifications are not \"safe\" in this respect. By including a default `unsafe=False` I'm afraid you'll be raising expectations to a level that Sage does not attain (yet?). \n> \n> It's completely heuristic: the four I chose nobody seems to have a problem with. \nOnly in that we couldn't find Trac tickets about them.\n>`simplify_radical`, on the other hand, wreaks havoc on trivial functions and has been the cause of numerous bug reports and mailing list discussions.\n> \n> In `simplify`, after #12650, I say that a safe simplification is one \"for which we are reasonably sure that the input will be considered equivalent to the output.\" That's probably the best we can do for now, and I'm *reasonably sure* that most people would consider `x^2/x` equivalent to `x`.\n\nI'm reasonably sure that no mathematician would consider them equivalent unless you add \"almost everywhere\".  Simplification *simplifies*, hence makes it not actually the same (at least potentially).  This shouldn't be controversial.\n\n> As it stands, I think `full_simplify` *sounds* safe so people will assume that anyway. This fix, while not perfect, at least improves things.\n\nWell, everything *sounds* safe unless you put in the word \"unsafe\".\n\nI'm pretty confused as to the relation of this to #12650.  See [comment:6:ticket:12650 my comments there].\n\nI'm sympathetic to doing something about `radcan`, but simplification is simplification, not identity.\n\nDoesn't it make more sense to either document fully what can go wrong with `simplify_full`, or to add a flag `simplify_radicals` or something?  I think that changing behavior in this case is probably the best compromise, but probably `unsafe` is sending the wrong message.  There isn't anything unsafe about `radcan`, it's just a different point of view than ours - symbolic expressions versus functions.  Spend some time on the Maxima list :)",
    "created_at": "2012-03-24T02:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149375",
    "user": "kcrisman"
}
```

> > It's not entirely clear to me which simplifications are "safe" and which are not. Simplifying `x^2/x` to `x` is also not "safe" in the sense that equality does not hold for `x=0`. In many computer algebra systems, acceptable simplifications are not "safe" in this respect. By including a default `unsafe=False` I'm afraid you'll be raising expectations to a level that Sage does not attain (yet?). 
> 
> It's completely heuristic: the four I chose nobody seems to have a problem with. 
Only in that we couldn't find Trac tickets about them.
>`simplify_radical`, on the other hand, wreaks havoc on trivial functions and has been the cause of numerous bug reports and mailing list discussions.
> 
> In `simplify`, after #12650, I say that a safe simplification is one "for which we are reasonably sure that the input will be considered equivalent to the output." That's probably the best we can do for now, and I'm *reasonably sure* that most people would consider `x^2/x` equivalent to `x`.

I'm reasonably sure that no mathematician would consider them equivalent unless you add "almost everywhere".  Simplification *simplifies*, hence makes it not actually the same (at least potentially).  This shouldn't be controversial.

> As it stands, I think `full_simplify` *sounds* safe so people will assume that anyway. This fix, while not perfect, at least improves things.

Well, everything *sounds* safe unless you put in the word "unsafe".

I'm pretty confused as to the relation of this to #12650.  See [comment:6:ticket:12650 my comments there].

I'm sympathetic to doing something about `radcan`, but simplification is simplification, not identity.

Doesn't it make more sense to either document fully what can go wrong with `simplify_full`, or to add a flag `simplify_radicals` or something?  I think that changing behavior in this case is probably the best compromise, but probably `unsafe` is sending the wrong message.  There isn't anything unsafe about `radcan`, it's just a different point of view than ours - symbolic expressions versus functions.  Spend some time on the Maxima list :)



---

archive/issue_comments_149376.json:
```json
{
    "body": "Replying to [comment:4 kcrisman]:\n> > > It's not entirely clear to me which simplifications are \"safe\" and which are not. Simplifying `x^2/x` to `x` is also not \"safe\" in the sense that equality does not hold for `x=0`. In many computer algebra systems, acceptable simplifications are not \"safe\" in this respect. By including a default `unsafe=False` I'm afraid you'll be raising expectations to a level that Sage does not attain (yet?). \n> > \n> > It's completely heuristic: the four I chose nobody seems to have a problem with. \n> Only in that we couldn't find Trac tickets about them.\n> >`simplify_radical`, on the other hand, wreaks havoc on trivial functions and has been the cause of numerous bug reports and mailing list discussions.\n> > \n> > In `simplify`, after #12650, I say that a safe simplification is one \"for which we are reasonably sure that the input will be considered equivalent to the output.\" That's probably the best we can do for now, and I'm *reasonably sure* that most people would consider `x^2/x` equivalent to `x`.\n> \n> I'm reasonably sure that no mathematician would consider them equivalent unless you add \"almost everywhere\".  Simplification *simplifies*, hence makes it not actually the same (at least potentially).  This shouldn't be controversial.\n> \n\nBefore our discussion on another one of these tickets, I had assumed it was not controversial that simplification had to return an equivalent expression. So it is at least a little controversial.\n\n> > As it stands, I think `full_simplify` *sounds* safe so people will assume that anyway. This fix, while not perfect, at least improves things.\n> \n> Well, everything *sounds* safe unless you put in the word \"unsafe\".\n> \n> I'm pretty confused as to the relation of this to #12650.  See [comment:6:ticket:12650 my comments there].\n> \n> I'm sympathetic to doing something about `radcan`, but simplification is simplification, not identity.\n> \n> Doesn't it make more sense to either document fully what can go wrong with `simplify_full`, or to add a flag `simplify_radicals` or something?  I think that changing behavior in this case is probably the best compromise, but probably `unsafe` is sending the wrong message.  There isn't anything unsafe about `radcan`, it's just a different point of view than ours - symbolic expressions versus functions.  Spend some time on the Maxima list :)\n\nAll expressions in sage are callable like functions, so if you have both radicals and a variable in an expression, `simplify_radical()` is unsafe. I.e. you're probably gonna get the wrong answer. I think marking it as unsafe is more likely to catch someone's attention than asking him to read the documentation. I almost certainly used `full_simplify()` for years without doing so, since I thought I knew what it was doing and had used similar functions in e.g. Mathematica. I think the problem is that it's called \"simplification,\" not that it exists.\n\nEither way, `f.full_simplify(simplify_radicals=True)` is not much better than `f.full_simplify().simplify_radical()`... the keyword argument is the easy way out, but I feel like it should control more than one method call if we do it. And if we remove the unsafe simplifications from `full_simplify()`, that seems to make `simplify()` redundant, too. That's the dual situation to what we'd have after #12650, but at least we could add more stuff to `full_simplify()` in the future to change that.",
    "created_at": "2012-03-26T19:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149376",
    "user": "mjo"
}
```

Replying to [comment:4 kcrisman]:
> > > It's not entirely clear to me which simplifications are "safe" and which are not. Simplifying `x^2/x` to `x` is also not "safe" in the sense that equality does not hold for `x=0`. In many computer algebra systems, acceptable simplifications are not "safe" in this respect. By including a default `unsafe=False` I'm afraid you'll be raising expectations to a level that Sage does not attain (yet?). 
> > 
> > It's completely heuristic: the four I chose nobody seems to have a problem with. 
> Only in that we couldn't find Trac tickets about them.
> >`simplify_radical`, on the other hand, wreaks havoc on trivial functions and has been the cause of numerous bug reports and mailing list discussions.
> > 
> > In `simplify`, after #12650, I say that a safe simplification is one "for which we are reasonably sure that the input will be considered equivalent to the output." That's probably the best we can do for now, and I'm *reasonably sure* that most people would consider `x^2/x` equivalent to `x`.
> 
> I'm reasonably sure that no mathematician would consider them equivalent unless you add "almost everywhere".  Simplification *simplifies*, hence makes it not actually the same (at least potentially).  This shouldn't be controversial.
> 

Before our discussion on another one of these tickets, I had assumed it was not controversial that simplification had to return an equivalent expression. So it is at least a little controversial.

> > As it stands, I think `full_simplify` *sounds* safe so people will assume that anyway. This fix, while not perfect, at least improves things.
> 
> Well, everything *sounds* safe unless you put in the word "unsafe".
> 
> I'm pretty confused as to the relation of this to #12650.  See [comment:6:ticket:12650 my comments there].
> 
> I'm sympathetic to doing something about `radcan`, but simplification is simplification, not identity.
> 
> Doesn't it make more sense to either document fully what can go wrong with `simplify_full`, or to add a flag `simplify_radicals` or something?  I think that changing behavior in this case is probably the best compromise, but probably `unsafe` is sending the wrong message.  There isn't anything unsafe about `radcan`, it's just a different point of view than ours - symbolic expressions versus functions.  Spend some time on the Maxima list :)

All expressions in sage are callable like functions, so if you have both radicals and a variable in an expression, `simplify_radical()` is unsafe. I.e. you're probably gonna get the wrong answer. I think marking it as unsafe is more likely to catch someone's attention than asking him to read the documentation. I almost certainly used `full_simplify()` for years without doing so, since I thought I knew what it was doing and had used similar functions in e.g. Mathematica. I think the problem is that it's called "simplification," not that it exists.

Either way, `f.full_simplify(simplify_radicals=True)` is not much better than `f.full_simplify().simplify_radical()`... the keyword argument is the easy way out, but I feel like it should control more than one method call if we do it. And if we remove the unsafe simplifications from `full_simplify()`, that seems to make `simplify()` redundant, too. That's the dual situation to what we'd have after #12650, but at least we could add more stuff to `full_simplify()` in the future to change that.



---

archive/issue_comments_149377.json:
```json
{
    "body": "There is not consensus that this is even a good idea, so I'll leave it alone until we can discuss it further.",
    "created_at": "2012-03-27T17:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149377",
    "user": "mjo"
}
```

There is not consensus that this is even a good idea, so I'll leave it alone until we can discuss it further.



---

archive/issue_comments_149378.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2012-03-27T17:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149378",
    "user": "mjo"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_149379.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2012-04-14T23:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149379",
    "user": "mjo"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_149380.json:
```json
{
    "body": "This should be a more straight-forward proposal. I just removed `simplify_radical()` from `simplify_full()` and fixed a few doctests (details in the commit message).\n\nOne of the doctest fixes is duplicated in #12780; the doctest is wrong (missing assumptions) but we're masking that fact at the moment.",
    "created_at": "2012-04-14T23:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149380",
    "user": "mjo"
}
```

This should be a more straight-forward proposal. I just removed `simplify_radical()` from `simplify_full()` and fixed a few doctests (details in the commit message).

One of the doctest fixes is duplicated in #12780; the doctest is wrong (missing assumptions) but we're masking that fact at the moment.



---

archive/issue_comments_149381.json:
```json
{
    "body": "Same patch with the functional.py doctest factored out",
    "created_at": "2012-04-15T18:34:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149381",
    "user": "mjo"
}
```

Same patch with the functional.py doctest factored out



---

archive/issue_comments_149382.json:
```json
{
    "body": "Attachment [sage-trac_12737-remove_radcan.patch](tarball://root/attachments/some-uuid/ticket12737/sage-trac_12737-remove_radcan.patch) by mjo created at 2012-04-15 18:35:16\n\nI moved the common doctest to #12845 and removed it from this patch.",
    "created_at": "2012-04-15T18:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149382",
    "user": "mjo"
}
```

Attachment [sage-trac_12737-remove_radcan.patch](tarball://root/attachments/some-uuid/ticket12737/sage-trac_12737-remove_radcan.patch) by mjo created at 2012-04-15 18:35:16

I moved the common doctest to #12845 and removed it from this patch.



---

archive/issue_comments_149383.json:
```json
{
    "body": "Lest it seem weird that I'm adding to the list in the description, let it be known that I haven't necessarily changed my mind here, but fairness dictates that I point this additional example out!",
    "created_at": "2012-11-14T19:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149383",
    "user": "kcrisman"
}
```

Lest it seem weird that I'm adding to the list in the description, let it be known that I haven't necessarily changed my mind here, but fairness dictates that I point this additional example out!



---

archive/issue_comments_149384.json:
```json
{
    "body": "Burcin agrees here at SD that this should be done.  I concur with him that probably we should solve #11912 (perhaps even deprecating the simplify name?) at the same time.  What do you think?",
    "created_at": "2013-06-18T18:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149384",
    "user": "kcrisman"
}
```

Burcin agrees here at SD that this should be done.  I concur with him that probably we should solve #11912 (perhaps even deprecating the simplify name?) at the same time.  What do you think?



---

archive/issue_comments_149385.json:
```json
{
    "body": "Replying to [comment:13 kcrisman]:\n> Burcin agrees here at SD that this should be done.  I concur with him that probably we should solve #11912 (perhaps even deprecating the simplify name?) at the same time.  What do you think?\n\nOnce it's gone from simplify_full(), personally I would deprecate `simplify_radical()` and rename it to `radcan()`. It's probably impossible to clearly explain what radcan does, but we can try to fix the docs and add many more examples.",
    "created_at": "2013-06-18T18:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149385",
    "user": "mjo"
}
```

Replying to [comment:13 kcrisman]:
> Burcin agrees here at SD that this should be done.  I concur with him that probably we should solve #11912 (perhaps even deprecating the simplify name?) at the same time.  What do you think?

Once it's gone from simplify_full(), personally I would deprecate `simplify_radical()` and rename it to `radcan()`. It's probably impossible to clearly explain what radcan does, but we can try to fix the docs and add many more examples.



---

archive/issue_comments_149386.json:
```json
{
    "body": "> > Burcin agrees here at SD that this should be done.  I concur with him that probably we should solve #11912 (perhaps even deprecating the simplify name?) at the same time.  What do you think?\n> \n> Once it's gone from simplify_full(), personally I would deprecate `simplify_radical()` and rename it to `radcan()`. It's probably impossible to clearly explain what radcan does, but we can try to fix the docs and add many more examples.\nDo you mind putting that on #11912, as the architect of this set of changes?",
    "created_at": "2013-06-18T19:01:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149386",
    "user": "kcrisman"
}
```

> > Burcin agrees here at SD that this should be done.  I concur with him that probably we should solve #11912 (perhaps even deprecating the simplify name?) at the same time.  What do you think?
> 
> Once it's gone from simplify_full(), personally I would deprecate `simplify_radical()` and rename it to `radcan()`. It's probably impossible to clearly explain what radcan does, but we can try to fix the docs and add many more examples.
Do you mind putting that on #11912, as the architect of this set of changes?



---

archive/issue_comments_149387.json:
```json
{
    "body": "Here's another example of unexpected behavior introduced by using simplify_radical as a part of simplify_full: [https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/Pq9hyOTzrL8](https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/Pq9hyOTzrL8).",
    "created_at": "2013-07-01T10:37:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149387",
    "user": "jvkersch"
}
```

Here's another example of unexpected behavior introduced by using simplify_radical as a part of simplify_full: [https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/Pq9hyOTzrL8](https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/Pq9hyOTzrL8).



---

archive/issue_comments_149388.json:
```json
{
    "body": "I think there's consensus to remove it now, but this will need rebasing. There are also a ton of related tickets which will all need to be coordinated so that the patches apply cleanly.\n\nAs soon as I get time I'll start by updating this patch.",
    "created_at": "2013-07-01T13:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149388",
    "user": "mjo"
}
```

I think there's consensus to remove it now, but this will need rebasing. There are also a ton of related tickets which will all need to be coordinated so that the patches apply cleanly.

As soon as I get time I'll start by updating this patch.



---

archive/issue_comments_149389.json:
```json
{
    "body": "Attachment [sage-trac_12737-rebased.patch](tarball://root/attachments/some-uuid/ticket12737/sage-trac_12737-rebased.patch) by mjo created at 2013-07-02 21:59:19\n\nRebased patch against 5.11.beta3",
    "created_at": "2013-07-02T21:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149389",
    "user": "mjo"
}
```

Attachment [sage-trac_12737-rebased.patch](tarball://root/attachments/some-uuid/ticket12737/sage-trac_12737-rebased.patch) by mjo created at 2013-07-02 21:59:19

Rebased patch against 5.11.beta3



---

archive/issue_comments_149390.json:
```json
{
    "body": "I just put up a new patch that should apply cleanly. There are some failing tests in doc/de/thematische_anleitungen/sage_gymnasium.rst, but I don't know what the surrounding context is and so I'm not sure how best to fix them. Will need some attention from the Germans.",
    "created_at": "2013-07-02T22:01:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149390",
    "user": "mjo"
}
```

I just put up a new patch that should apply cleanly. There are some failing tests in doc/de/thematische_anleitungen/sage_gymnasium.rst, but I don't know what the surrounding context is and so I'm not sure how best to fix them. Will need some attention from the Germans.



---

archive/issue_comments_149391.json:
```json
{
    "body": "> Here's another example of unexpected behavior introduced by using simplify_radical as a part of simplify_full: [https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/Pq9hyOTzrL8](https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/Pq9hyOTzrL8).\n\nIn that same thread: Robert D. of Maxima reports\n\n```\n>   sage: u, v = var('u, v', domain='real') \n>   sage: sqrt(-1/(u^2+v^2-1)).simplify_radical()  # This will hang \n\nThis is a bug in Maxima: \n\n(%i2) radcan (sqrt (-1 / (u^2 + v^2 - 1))), domain=complex; \n\nIt waits apparently forever here -- but it is actually looping over \n*ALPHA (not sure why) which is a large prime number (8388593). \n\n(%i3) :lisp (setq *alpha 17) \n17 \n(%i3) radcan(sqrt(-1/(u^2+v^2-1))), domain=complex; \n(%o3) 1/sqrt(-v^2-u^2+1) \n\nI've reported this as bug # 2605. \n```\n\nE.g. [Maxima 2605](http://sourceforge.net/p/maxima/bugs/2605/).  We may want to open a ticket for this or something, maybe along with #11912.\n\n----\n\nI'll take a look at the failures in the new German tutorial at some point today, it's probably not a big deal.",
    "created_at": "2013-07-03T14:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149391",
    "user": "kcrisman"
}
```

> Here's another example of unexpected behavior introduced by using simplify_radical as a part of simplify_full: [https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/Pq9hyOTzrL8](https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/Pq9hyOTzrL8).

In that same thread: Robert D. of Maxima reports

```
>   sage: u, v = var('u, v', domain='real') 
>   sage: sqrt(-1/(u^2+v^2-1)).simplify_radical()  # This will hang 

This is a bug in Maxima: 

(%i2) radcan (sqrt (-1 / (u^2 + v^2 - 1))), domain=complex; 

It waits apparently forever here -- but it is actually looping over 
*ALPHA (not sure why) which is a large prime number (8388593). 

(%i3) :lisp (setq *alpha 17) 
17 
(%i3) radcan(sqrt(-1/(u^2+v^2-1))), domain=complex; 
(%o3) 1/sqrt(-v^2-u^2+1) 

I've reported this as bug # 2605. 
```

E.g. [Maxima 2605](http://sourceforge.net/p/maxima/bugs/2605/).  We may want to open a ticket for this or something, maybe along with #11912.

----

I'll take a look at the failures in the new German tutorial at some point today, it's probably not a big deal.



---

archive/issue_comments_149392.json:
```json
{
    "body": "> I'll take a look at the failures in the new German tutorial at some point today, it's probably not a big deal.\n\n```\nsage -t doc/de/thematische_anleitungen/sage_gymnasium.rst\n**********************************************************************\nFile \"doc/de/thematische_anleitungen/sage_gymnasium.rst\", line 397, in doc.de.thematische_anleitungen.sage_gymnasium\nFailed example:\n    (log(8)/log(2)).simplify_full()\nExpected:\n    3\nGot:\n    log(8)/log(2)\n**********************************************************************\nFile \"doc/de/thematische_anleitungen/sage_gymnasium.rst\", line 703, in doc.de.thematische_anleitungen.sage_gymnasium\nFailed example:\n    log(10^5).simplify_full()\nExpected:\n    5*log(5) + 5*log(2)\nGot:\n    log(100000)\n**********************************************************************\n```\n\nWell, unfortunately the context is that the authors of the tutorial really really like using just one simplification command. In particular, they advertise `simplify_full` as providing log addition rules \"for free\".  Which I don't really see as \"simplification in the latter example! (Which is some of what you've been saying earlier.)  However, it does mean it would be interesting to see whether it might be worth adding `canonicalize_exp` or `canonicalize_log` at #11912 as aliases...\n\nAnyway, I can fix this, but I don't have time right now, because I would have to think about how best to preserve the authors' intentions.   I assume it would be annoying to all of a sudden point out that there are multiple \"simplification\" options.  I've cc:ed the author of #14550 to see if he has any suggestions.  \n\n`@`navigium - man k\u00f6nnte behaupten, dass `log(10^5) = > 5*log(5) + 5*log(2)` nicht eine Vereinfachung, sondern eine ... \"Gezetzeseinsetzung\" ist.  Im jeden Fall sieht es nicht einfacher aus!  Dennoch wollen wir die Einleitung nicht einfach so ohne weiteres zerlegen.   Vorausgesetzt, dass `simplify_radical` von `simplify_full` verschwindet, wie w\u00e4re es am Besten (d. Hinsicht nach) `simplify_radical` im Gymnasialkontext zu erw\u00e4hnen?",
    "created_at": "2013-07-03T18:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149392",
    "user": "kcrisman"
}
```

> I'll take a look at the failures in the new German tutorial at some point today, it's probably not a big deal.

```
sage -t doc/de/thematische_anleitungen/sage_gymnasium.rst
**********************************************************************
File "doc/de/thematische_anleitungen/sage_gymnasium.rst", line 397, in doc.de.thematische_anleitungen.sage_gymnasium
Failed example:
    (log(8)/log(2)).simplify_full()
Expected:
    3
Got:
    log(8)/log(2)
**********************************************************************
File "doc/de/thematische_anleitungen/sage_gymnasium.rst", line 703, in doc.de.thematische_anleitungen.sage_gymnasium
Failed example:
    log(10^5).simplify_full()
Expected:
    5*log(5) + 5*log(2)
Got:
    log(100000)
**********************************************************************
```

Well, unfortunately the context is that the authors of the tutorial really really like using just one simplification command. In particular, they advertise `simplify_full` as providing log addition rules "for free".  Which I don't really see as "simplification in the latter example! (Which is some of what you've been saying earlier.)  However, it does mean it would be interesting to see whether it might be worth adding `canonicalize_exp` or `canonicalize_log` at #11912 as aliases...

Anyway, I can fix this, but I don't have time right now, because I would have to think about how best to preserve the authors' intentions.   I assume it would be annoying to all of a sudden point out that there are multiple "simplification" options.  I've cc:ed the author of #14550 to see if he has any suggestions.  

`@`navigium - man könnte behaupten, dass `log(10^5) = > 5*log(5) + 5*log(2)` nicht eine Vereinfachung, sondern eine ... "Gezetzeseinsetzung" ist.  Im jeden Fall sieht es nicht einfacher aus!  Dennoch wollen wir die Einleitung nicht einfach so ohne weiteres zerlegen.   Vorausgesetzt, dass `simplify_radical` von `simplify_full` verschwindet, wie wäre es am Besten (d. Hinsicht nach) `simplify_radical` im Gymnasialkontext zu erwähnen?



---

archive/issue_comments_149393.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-07-03T18:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149393",
    "user": "kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_149394.json:
```json
{
    "body": "I'm at the moment unsure how to fix this. I guess the first example that fails could just be removed since it can be numerically evaluated. But I think the second example should remain in the tutorial and should be fixed. At the moment I don't have the time to look into it. I won't be around till mid August. \n\n`@`kcrisman Ich habe es vor allem als Vereinfachung bezeichnet, da es die notwendige Umformung ist, welche man f\u00fcr das L\u00f6sen von Exponentialgleichungen ben\u00f6tigt. Aus diesem Grund halte ich es auch f\u00fcr wichtig, dass man erw\u00e4hnt, wie man eine solche Umformung machen kann. \n\nMan k\u00f6nnte es aber nat\u00fcrlich umbennen. Ich w\u00fcrde es als \"Zerlegung durch Benutzen der Logarithmengesetze\" oder \u00e4hnlich nennen. \n\nNat\u00fcrlich w\u00e4re es schon, wenn man simplify_radical nicht separat auff\u00fchren muss, um die Sache einfach zu halten. Wenn es aber aus simplify_full fliegt, m\u00fcsste man es wohl erw\u00e4hnen.",
    "created_at": "2013-07-04T08:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149394",
    "user": "navigium"
}
```

I'm at the moment unsure how to fix this. I guess the first example that fails could just be removed since it can be numerically evaluated. But I think the second example should remain in the tutorial and should be fixed. At the moment I don't have the time to look into it. I won't be around till mid August. 

`@`kcrisman Ich habe es vor allem als Vereinfachung bezeichnet, da es die notwendige Umformung ist, welche man für das Lösen von Exponentialgleichungen benötigt. Aus diesem Grund halte ich es auch für wichtig, dass man erwähnt, wie man eine solche Umformung machen kann. 

Man könnte es aber natürlich umbennen. Ich würde es als "Zerlegung durch Benutzen der Logarithmengesetze" oder ähnlich nennen. 

Natürlich wäre es schon, wenn man simplify_radical nicht separat aufführen muss, um die Sache einfach zu halten. Wenn es aber aus simplify_full fliegt, müsste man es wohl erwähnen.



---

archive/issue_comments_149395.json:
```json
{
    "body": "> `@`kcrisman Ich habe es vor allem als Vereinfachung bezeichnet, da es die notwendige Umformung ist, welche man f\u00fcr das L\u00f6sen von Exponentialgleichungen ben\u00f6tigt. Aus diesem Grund halte ich es auch f\u00fcr wichtig, dass man erw\u00e4hnt, wie man eine solche Umformung machen kann. \n> \n> Man k\u00f6nnte es aber nat\u00fcrlich umbennen. Ich w\u00fcrde es als \"Zerlegung durch Benutzen der Logarithmengesetze\" oder \u00e4hnlich nennen. \n> \nEigentlich gen\u00fcgt das!  \n\n> Nat\u00fcrlich w\u00e4re es schon, wenn man simplify_radical nicht separat auff\u00fchren muss, um die Sache einfach zu halten. Wenn es aber aus simplify_full fliegt, m\u00fcsste man es wohl erw\u00e4hnen.\n\nTja...\n\nMichael, I'll try to keep this on the front burner for finding a good fix - navigium has a good phrase we can use, and I don't really see any other way to fix this, since it does happen to be very convenient that we can use radcan in some cases to do log expansion.",
    "created_at": "2013-07-04T13:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149395",
    "user": "kcrisman"
}
```

> `@`kcrisman Ich habe es vor allem als Vereinfachung bezeichnet, da es die notwendige Umformung ist, welche man für das Lösen von Exponentialgleichungen benötigt. Aus diesem Grund halte ich es auch für wichtig, dass man erwähnt, wie man eine solche Umformung machen kann. 
> 
> Man könnte es aber natürlich umbennen. Ich würde es als "Zerlegung durch Benutzen der Logarithmengesetze" oder ähnlich nennen. 
> 
Eigentlich genügt das!  

> Natürlich wäre es schon, wenn man simplify_radical nicht separat aufführen muss, um die Sache einfach zu halten. Wenn es aber aus simplify_full fliegt, müsste man es wohl erwähnen.

Tja...

Michael, I'll try to keep this on the front burner for finding a good fix - navigium has a good phrase we can use, and I don't really see any other way to fix this, since it does happen to be very convenient that we can use radcan in some cases to do log expansion.



---

archive/issue_comments_149396.json:
```json
{
    "body": "It is regrettable that there's no other way to get log simplification of things like `log(8)/log(2)`, but `simplify_radical()` will do the same thing even when the argument to the log function is a complex function of, say, `z`.\n\nIt'd be nice to have something that worked for constants at least, but avoided e.g. #12322.",
    "created_at": "2013-07-06T16:31:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149396",
    "user": "mjo"
}
```

It is regrettable that there's no other way to get log simplification of things like `log(8)/log(2)`, but `simplify_radical()` will do the same thing even when the argument to the log function is a complex function of, say, `z`.

It'd be nice to have something that worked for constants at least, but avoided e.g. #12322.



---

archive/issue_comments_149397.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-07-09T20:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149397",
    "user": "kcrisman"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_149398.json:
```json
{
    "body": "I'd appreciate a quick review from navigium as to whether my German syntax is 100% correct, but this should take care of it, and conforms to what he suggested as a solution.\n\nPatchbot, apply sage-trac_12737-rebased.patch and trac_12737-de.patch",
    "created_at": "2013-07-09T20:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149398",
    "user": "kcrisman"
}
```

I'd appreciate a quick review from navigium as to whether my German syntax is 100% correct, but this should take care of it, and conforms to what he suggested as a solution.

Patchbot, apply sage-trac_12737-rebased.patch and trac_12737-de.patch



---

archive/issue_comments_149399.json:
```json
{
    "body": "Attachment [trac_12737-de.patch](tarball://root/attachments/some-uuid/ticket12737/trac_12737-de.patch) by kcrisman created at 2013-07-10 15:48:10",
    "created_at": "2013-07-10T15:48:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149399",
    "user": "kcrisman"
}
```

Attachment [trac_12737-de.patch](tarball://root/attachments/some-uuid/ticket12737/trac_12737-de.patch) by kcrisman created at 2013-07-10 15:48:10



---

archive/issue_comments_149400.json:
```json
{
    "body": "Patchbot, apply sage-trac_12737-rebased.patch and trac_12737-de.patch",
    "created_at": "2013-07-10T15:48:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149400",
    "user": "kcrisman"
}
```

Patchbot, apply sage-trac_12737-rebased.patch and trac_12737-de.patch



---

archive/issue_comments_149401.json:
```json
{
    "body": "I think that's a great way to solve my document. Now the readers even get something extra because they are taught how to apply log rules both ways. Thanks `@`kcrisman for solving it.",
    "created_at": "2013-07-10T18:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149401",
    "user": "navigium"
}
```

I think that's a great way to solve my document. Now the readers even get something extra because they are taught how to apply log rules both ways. Thanks `@`kcrisman for solving it.



---

archive/issue_comments_149402.json:
```json
{
    "body": "Great.  Now someone (other than me) just needs to check that it passes tests and they can set it to positive review.",
    "created_at": "2013-07-10T18:38:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149402",
    "user": "kcrisman"
}
```

Great.  Now someone (other than me) just needs to check that it passes tests and they can set it to positive review.



---

archive/issue_comments_149403.json:
```json
{
    "body": "`make ptestlong` does not report any errors so I'm setting this to positive review.",
    "created_at": "2013-07-15T16:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149403",
    "user": "jvkersch"
}
```

`make ptestlong` does not report any errors so I'm setting this to positive review.



---

archive/issue_comments_149404.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-07-15T16:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149404",
    "user": "jvkersch"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_149405.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-08-02T14:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149405",
    "user": "jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_149406.json:
```json
{
    "body": "Updates:\n\nRemoved\n* #3520 - inconsistency in simplify_radical\nfrom description, as that was not about `simplify_full` to start with.\n\nI posted updates on the ask.sagemath questions just now.\n\n#11934 needs review.\n\n#12322 needs to be reworded since we didn't use the \"unsafe\" parameter in `simplify_full`.",
    "created_at": "2013-11-06T15:59:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12565",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12565#issuecomment-149406",
    "user": "kcrisman"
}
```

Updates:

Removed
* #3520 - inconsistency in simplify_radical
from description, as that was not about `simplify_full` to start with.

I posted updates on the ask.sagemath questions just now.

#11934 needs review.

#12322 needs to be reworded since we didn't use the "unsafe" parameter in `simplify_full`.
