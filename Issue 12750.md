# Issue 12750: Implicit derivative

archive/issues_012750.json:
```json
{
    "body": "Assignee: burcin\n\nCC:  kcrisman sjg10 burcin\n\nKeywords: implicit derivative\n\nAdded implicit_derivative function. It allows to compute the n'th derivative of the implicit function defined by a symbolic expression.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12922\n\n",
    "created_at": "2012-05-08T11:35:00Z",
    "labels": [
        "calculus",
        "major",
        "enhancement"
    ],
    "title": "Implicit derivative",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12750",
    "user": "mmarco"
}
```
Assignee: burcin

CC:  kcrisman sjg10 burcin

Keywords: implicit derivative

Added implicit_derivative function. It allows to compute the n'th derivative of the implicit function defined by a symbolic expression.

Issue created by migration from https://trac.sagemath.org/ticket/12922





---

archive/issue_comments_152779.json:
```json
{
    "body": "Attachment [16191.patch](tarball://root/attachments/some-uuid/ticket12922/16191.patch) by mmarco created at 2012-05-08 11:40:17",
    "created_at": "2012-05-08T11:40:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152779",
    "user": "mmarco"
}
```

Attachment [16191.patch](tarball://root/attachments/some-uuid/ticket12922/16191.patch) by mmarco created at 2012-05-08 11:40:17



---

archive/issue_comments_152780.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-08T11:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152780",
    "user": "mmarco"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_152781.json:
```json
{
    "body": "Reviewed, seems good. Added a check for having no y term in the expression. Was previously an uncaught `DivideByZero`, while code now gives a more informative error.\nWas my first review, would appreciate to know whether I'm actually being any help!",
    "created_at": "2012-07-11T11:40:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152781",
    "user": "sjg10"
}
```

Reviewed, seems good. Added a check for having no y term in the expression. Was previously an uncaught `DivideByZero`, while code now gives a more informative error.
Was my first review, would appreciate to know whether I'm actually being any help!



---

archive/issue_comments_152782.json:
```json
{
    "body": "Yes, both helpful!  A few comments.\n* The reviewer patch should be a separate patch on top of the original patch, so that the original author is kept.\n* In any case, the patch should have a meaningful commit message.\n* I'm a little apprehensive about the many specific variables and functions defined here.  Won't that cause some kind of conflict with (say) an already-defined `yy`?  We shouldn't depend on people not needing those variables.  Or is everything only in local scope because of the use of `SR.symbol`?\n\nI'm also wondering - is it possible to have an implicit derivative method for symbolic expressions?  Just curious.",
    "created_at": "2012-07-11T13:25:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152782",
    "user": "kcrisman"
}
```

Yes, both helpful!  A few comments.
* The reviewer patch should be a separate patch on top of the original patch, so that the original author is kept.
* In any case, the patch should have a meaningful commit message.
* I'm a little apprehensive about the many specific variables and functions defined here.  Won't that cause some kind of conflict with (say) an already-defined `yy`?  We shouldn't depend on people not needing those variables.  Or is everything only in local scope because of the use of `SR.symbol`?

I'm also wondering - is it possible to have an implicit derivative method for symbolic expressions?  Just curious.



---

archive/issue_comments_152783.json:
```json
{
    "body": "adds error handler",
    "created_at": "2012-07-11T16:02:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152783",
    "user": "sjg10"
}
```

adds error handler



---

archive/issue_comments_152784.json:
```json
{
    "body": "Attachment [16191_review.patch](tarball://root/attachments/some-uuid/ticket12922/16191_review.patch) by mmarco created at 2012-07-12 09:37:21\n\nAll the variables defined in the function are local. They do not get mixed with the global variables with the same name. You can even call the function with xx and yy as parameters, and they will  not be mixed with the local xx and yy.\n\n\n```\nsage: var('x,y')\n(x, y)\nsage: implicit_derivative(y,x,y*x/cos(x+y))\n-(x*y*sin(x + y)/cos(x + y)^2 + y/cos(x + y))/(x*y*sin(x + y)/cos(x + y)^2 + x/cos(x + y))\nsage: var('xx,yy')\n(xx, yy)\nsage: implicit_derivative(yy,xx,yy*xx/cos(xx+yy))\n-(xx*yy*sin(xx + yy)/cos(xx + yy)^2 + yy/cos(xx + yy))/(xx*yy*sin(xx + yy)/cos(xx + yy)^2 + xx/cos(xx + yy))\n```\n\n\nAbout writing this as a method for symbolic expressions... that was my first idea; but i prefeared this aproach, due to the fact that you are actually not  diferentiating the symbolic expression, but a function defined implicitely by the symbolic expression. So it seemed more natural to me this kind of syntax.",
    "created_at": "2012-07-12T09:37:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152784",
    "user": "mmarco"
}
```

Attachment [16191_review.patch](tarball://root/attachments/some-uuid/ticket12922/16191_review.patch) by mmarco created at 2012-07-12 09:37:21

All the variables defined in the function are local. They do not get mixed with the global variables with the same name. You can even call the function with xx and yy as parameters, and they will  not be mixed with the local xx and yy.


```
sage: var('x,y')
(x, y)
sage: implicit_derivative(y,x,y*x/cos(x+y))
-(x*y*sin(x + y)/cos(x + y)^2 + y/cos(x + y))/(x*y*sin(x + y)/cos(x + y)^2 + x/cos(x + y))
sage: var('xx,yy')
(xx, yy)
sage: implicit_derivative(yy,xx,yy*xx/cos(xx+yy))
-(xx*yy*sin(xx + yy)/cos(xx + yy)^2 + yy/cos(xx + yy))/(xx*yy*sin(xx + yy)/cos(xx + yy)^2 + xx/cos(xx + yy))
```


About writing this as a method for symbolic expressions... that was my first idea; but i prefeared this aproach, due to the fact that you are actually not  diferentiating the symbolic expression, but a function defined implicitely by the symbolic expression. So it seemed more natural to me this kind of syntax.



---

archive/issue_comments_152785.json:
```json
{
    "body": "Calling `var` or `SR.symbol('somename')` even locally does add to the `pynac_symbol_registry`, yet calling `SR.symbol()` with no argument will create a temporary variable that will not be added to this registry. Possibly adding to the registry may cause problems if it is being referenced directly for some reason. Maybe worth just using `x = SR.symbol()` etc?\n\n\n\n```\nsage: from sage.symbolic.ring import pynac_symbol_registry\nsage: pynac_symbol_registry                               \n{'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}\nsage: def f(): temp = SR.symbol()                         \n....: \nsage: f()\nsage: pynac_symbol_registry\n{'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}\nsage: def f(): temp = SR.symbol('temp')\n....: \nsage: f()\nsage: pynac_symbol_registry\n{'temp': temp, 'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}\n```\n",
    "created_at": "2012-07-13T10:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152785",
    "user": "sjg10"
}
```

Calling `var` or `SR.symbol('somename')` even locally does add to the `pynac_symbol_registry`, yet calling `SR.symbol()` with no argument will create a temporary variable that will not be added to this registry. Possibly adding to the registry may cause problems if it is being referenced directly for some reason. Maybe worth just using `x = SR.symbol()` etc?



```
sage: from sage.symbolic.ring import pynac_symbol_registry
sage: pynac_symbol_registry                               
{'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}
sage: def f(): temp = SR.symbol()                         
....: 
sage: f()
sage: pynac_symbol_registry
{'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}
sage: def f(): temp = SR.symbol('temp')
....: 
sage: f()
sage: pynac_symbol_registry
{'temp': temp, 'some_variable': some_variable, 'A': A, 'C': C, 'B': B, 'E': E, 'D': D, 'G': G, 'F': F, 'H': H, 'K': K, 'J': J, 'M': M, 'L': L, 'N': N, 'Q': Q, 'P': P, 'S': S, 'R': R, 'U': U, 'T': T, 'W': W, 'V': V, 'Y': Y, 'X': X, 'Z': Z, 'a': a, 'c': c, 'b': b, 'd': d, 'g': g, 'f': f, 'h': h, 'k': k, 'j': j, 'm': m, 'l': l, 'o': o, 'n': n, 'q': q, 'p': p, 's': s, 'r': r, 'u': u, 't': t, 'w': w, 'v': v, 'y': y, 'x': x, 'z': z}
```




---

archive/issue_comments_152786.json:
```json
{
    "body": "I have tried to use SR.symbol() instead of SR.symbol('x'), but then the result is a mess.\n\nI can't think of a way to make this work without the said side effect.",
    "created_at": "2012-07-13T10:52:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152786",
    "user": "mmarco"
}
```

I have tried to use SR.symbol() instead of SR.symbol('x'), but then the result is a mess.

I can't think of a way to make this work without the said side effect.



---

archive/issue_comments_152787.json:
```json
{
    "body": "I solved the pynac symbol registry pollution by saving a copy of it at the beginning of the function, and restoring it at the end. I am not sure if this is the best choice, but it is the only solution i found, and seems to work fine.",
    "created_at": "2013-06-07T17:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152787",
    "user": "mmarco"
}
```

I solved the pynac symbol registry pollution by saving a copy of it at the beginning of the function, and restoring it at the end. I am not sure if this is the best choice, but it is the only solution i found, and seems to work fine.



---

archive/issue_comments_152788.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2013-06-07T20:53:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152788",
    "user": "burcin"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_152789.json:
```json
{
    "body": "Messing with the symbol registry this way is really not a good idea. That is just supposed to be internal data.\n\nWhat if there is an exception in that code and the registry is not restored?\n\nWhat exactly is the problem with using temporary variables? Looking briefly at the patch, it looks like we also need temporary functions.",
    "created_at": "2013-06-07T20:53:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152789",
    "user": "burcin"
}
```

Messing with the symbol registry this way is really not a good idea. That is just supposed to be internal data.

What if there is an exception in that code and the registry is not restored?

What exactly is the problem with using temporary variables? Looking briefly at the patch, it looks like we also need temporary functions.



---

archive/issue_comments_152790.json:
```json
{
    "body": "The problem with using temporary variables without giving them a name string is this:\n\n\n```\n\nsage: from sage.symbolic.function_factory import SymbolicFunction\nsage: var('x,y')                                                                                                                                    \n(x, y)\nsage: def implicit_derivative(Y,X,F,n=1):                                                                                                           \n....:         x=SR.symbol()                                                                                                                         \n....:         yy=SR.symbol()                                                                                                                        \n....:         y=SymbolicFunction('y',1)(x)                                                                                                          \n....:         f=SymbolicFunction('f',2)(x,yy)                                                                                                       \n....:         Fx=f.diff(x)                                                                                                                          \n....:         Fy=f.diff(yy)                                                                                                                         \n....:         G=-(Fx/Fy)                                                                                                                            \n....:         G=G.subs_expr({yy:y})                                                                                                                 \n....:         di={y.diff(x):-F.diff(X)/F.diff(Y)}                                                                                                   \n....:         R=G                                                                                                                                   \n....:         S=G.diff(x,n-1)                                                                                                                       \n....:         for i in range(n+1):                                                                                                                  \n....:                 di[y.diff(x,i+1)(x=x)]=R                                                                                                      \n....:                 S=S.subs_expr(di)                                                                                                             \n....:                 R=G.diff(x,i)                                                                                                                 \n....:                 for j in range(n+1-i):                                                                                                        \n....:                         di[f.diff(x,i,yy,j)(x=x,yy=y)]=F.diff(X,i,Y,j)                                                                        \n....:                         S=S.subs_expr(di)                                                                                                     \n....:                 return S                                                                                                                      \n....:                                                                                                                                               \nsage: implicit_derivative(y,x,x^2+y^2-1)                                                                                                            \n-D[0](f)(symbol160, y(symbol160))/D[1](f)(symbol160, y(symbol160))\n```\n\n\nI don't know why, this problem is not present if we put the strings in the definitions of the variables.",
    "created_at": "2013-06-07T21:05:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152790",
    "user": "mmarco"
}
```

The problem with using temporary variables without giving them a name string is this:


```

sage: from sage.symbolic.function_factory import SymbolicFunction
sage: var('x,y')                                                                                                                                    
(x, y)
sage: def implicit_derivative(Y,X,F,n=1):                                                                                                           
....:         x=SR.symbol()                                                                                                                         
....:         yy=SR.symbol()                                                                                                                        
....:         y=SymbolicFunction('y',1)(x)                                                                                                          
....:         f=SymbolicFunction('f',2)(x,yy)                                                                                                       
....:         Fx=f.diff(x)                                                                                                                          
....:         Fy=f.diff(yy)                                                                                                                         
....:         G=-(Fx/Fy)                                                                                                                            
....:         G=G.subs_expr({yy:y})                                                                                                                 
....:         di={y.diff(x):-F.diff(X)/F.diff(Y)}                                                                                                   
....:         R=G                                                                                                                                   
....:         S=G.diff(x,n-1)                                                                                                                       
....:         for i in range(n+1):                                                                                                                  
....:                 di[y.diff(x,i+1)(x=x)]=R                                                                                                      
....:                 S=S.subs_expr(di)                                                                                                             
....:                 R=G.diff(x,i)                                                                                                                 
....:                 for j in range(n+1-i):                                                                                                        
....:                         di[f.diff(x,i,yy,j)(x=x,yy=y)]=F.diff(X,i,Y,j)                                                                        
....:                         S=S.subs_expr(di)                                                                                                     
....:                 return S                                                                                                                      
....:                                                                                                                                               
sage: implicit_derivative(y,x,x^2+y^2-1)                                                                                                            
-D[0](f)(symbol160, y(symbol160))/D[1](f)(symbol160, y(symbol160))
```


I don't know why, this problem is not present if we put the strings in the definitions of the variables.



---

archive/issue_comments_152791.json:
```json
{
    "body": "Replying to [comment:10 mmarco]:\n> {{{             \n> sage: implicit_derivative(y,x,x<sup>2+y</sup>2-1)                                                                                  \n> -D[0](f)(symbol160, y(symbol160))/D[1](f)(symbol160, y(symbol160))\n> }}}\n\nIt looks like the substitution doesn't work at some point.\n\nLooking at the code...\n\nThe calls `y.diff(x,i+1)(x=x)` and `f.diff(x,i,yy,j)(x=x,yy=y)` rely on the name of the variable. You should use a dictionary argument to `.subs()`.\n\nBTW, the `subs_expr()` method will go away at some point. Why not just use `.subs()` everywhere?",
    "created_at": "2013-06-08T09:26:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152791",
    "user": "burcin"
}
```

Replying to [comment:10 mmarco]:
> {{{             
> sage: implicit_derivative(y,x,x<sup>2+y</sup>2-1)                                                                                  
> -D[0](f)(symbol160, y(symbol160))/D[1](f)(symbol160, y(symbol160))
> }}}

It looks like the substitution doesn't work at some point.

Looking at the code...

The calls `y.diff(x,i+1)(x=x)` and `f.diff(x,i,yy,j)(x=x,yy=y)` rely on the name of the variable. You should use a dictionary argument to `.subs()`.

BTW, the `subs_expr()` method will go away at some point. Why not just use `.subs()` everywhere?



---

archive/issue_comments_152792.json:
```json
{
    "body": "Before this gets switched to positive review, we should check how it behaves if there already is a symbolic function defined with a custom method for evaluation named `y` or `f`.\n\nWhy is this not a method of symbolic expressions? Isn't it inconsistent to have the functional notation supported but not a class method?",
    "created_at": "2013-06-08T09:33:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152792",
    "user": "burcin"
}
```

Before this gets switched to positive review, we should check how it behaves if there already is a symbolic function defined with a custom method for evaluation named `y` or `f`.

Why is this not a method of symbolic expressions? Isn't it inconsistent to have the functional notation supported but not a class method?



---

archive/issue_comments_152793.json:
```json
{
    "body": "Thanks for the comments. I will try to work on it.\n\nAs i said, the reason why it is not a method is that it is not clear to me what class should it be in. \n\nIs this a method of the expression F? Well, not exactly, since F is not the function that we are trying to differentiate, but the symbollic expression that deffines it implicitly.\n\nOf X? This is just the variable with which we differentiate on.\n\nOf Y? Riguorilously that should be the function that we are differentiating. But doesn't sound natural at all to add a method like this for symbollic variables.\n\nOr maybe we could define a new class ImplicitelyDefinedSymbolicFunction for this case, bat that sounds way overkill.",
    "created_at": "2013-06-08T10:00:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152793",
    "user": "mmarco"
}
```

Thanks for the comments. I will try to work on it.

As i said, the reason why it is not a method is that it is not clear to me what class should it be in. 

Is this a method of the expression F? Well, not exactly, since F is not the function that we are trying to differentiate, but the symbollic expression that deffines it implicitly.

Of X? This is just the variable with which we differentiate on.

Of Y? Riguorilously that should be the function that we are differentiating. But doesn't sound natural at all to add a method like this for symbollic variables.

Or maybe we could define a new class ImplicitelyDefinedSymbolicFunction for this case, bat that sounds way overkill.



---

archive/issue_comments_152794.json:
```json
{
    "body": "Attachment [12922.patch](tarball://root/attachments/some-uuid/ticket12922/12922.patch) by mmarco created at 2013-06-08 16:03:22\n\nNewer version, solves the pynac registry pollution without manipulating it",
    "created_at": "2013-06-08T16:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152794",
    "user": "mmarco"
}
```

Attachment [12922.patch](tarball://root/attachments/some-uuid/ticket12922/12922.patch) by mmarco created at 2013-06-08 16:03:22

Newer version, solves the pynac registry pollution without manipulating it



---

archive/issue_comments_152795.json:
```json
{
    "body": "Ok, your suggestions seemed to work fine. I have uploaded a newer version. Please check it.",
    "created_at": "2013-06-08T16:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152795",
    "user": "mmarco"
}
```

Ok, your suggestions seemed to work fine. I have uploaded a newer version. Please check it.



---

archive/issue_comments_152796.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2013-06-10T11:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152796",
    "user": "mmarco"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_152797.json:
```json
{
    "body": "bump",
    "created_at": "2014-08-22T14:48:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152797",
    "user": "mmarco"
}
```

bump



---

archive/issue_comments_152798.json:
```json
{
    "body": "Hi mmarco: \n\nThanks for writing up a patch regarding something very fundamental to calculus. Sage has since v6.0 moved to Git for its revision control. As a consequence, we work with \"branches\" instead of \"patches\" and so on. Could you kindly make the patch here into a branch? \n\nI think this might be a bit painful depending on several factors. So, please feel free to ask for any help!",
    "created_at": "2014-08-23T12:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152798",
    "user": "knsam"
}
```

Hi mmarco: 

Thanks for writing up a patch regarding something very fundamental to calculus. Sage has since v6.0 moved to Git for its revision control. As a consequence, we work with "branches" instead of "patches" and so on. Could you kindly make the patch here into a branch? 

I think this might be a bit painful depending on several factors. So, please feel free to ask for any help!



---

archive/issue_comments_152799.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-23T12:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152799",
    "user": "knsam"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_152800.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-24T15:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152800",
    "user": "knsam"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_152801.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-08-24T15:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152801",
    "user": "knsam"
}
```

New commits:



---

archive/issue_comments_152802.json:
```json
{
    "body": "For starters, I have the following comments: \n\n1. The one-line docstring for the function is \"incorrect\": it computes something, yes, but it also returns it. So, please change that to \"Return <whatever>\". \n2. The value error could return the expression `F` explicitly instead of saying the generic F. While you are it, please use the `.format` to format the string for the output instead.\n\nHonestly, I have not looked at the math. I will get back about the math and the programming part in a bit.",
    "created_at": "2014-08-24T16:05:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152802",
    "user": "knsam"
}
```

For starters, I have the following comments: 

1. The one-line docstring for the function is "incorrect": it computes something, yes, but it also returns it. So, please change that to "Return <whatever>". 
2. The value error could return the expression `F` explicitly instead of saying the generic F. While you are it, please use the `.format` to format the string for the output instead.

Honestly, I have not looked at the math. I will get back about the math and the programming part in a bit.



---

archive/issue_comments_152803.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-24T16:59:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152803",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_152804.json:
```json
{
    "body": "Replying to [comment:13 mmarco]:\n> As i said, the reason why it is not a method is that it is not clear to me what class should it be in. \n> \n> Is this a method of the expression F? Well, not exactly, since F is not the function that we are trying to differentiate, but the symbollic expression that deffines it implicitly.\nI think Burcin wants this method part of the symbolic expression or function class. If it's not tied to a specific expression then make it a ``@`classmethod` (equivalent to a static method in C), and then create the globally accessible name for it.",
    "created_at": "2014-09-01T09:17:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152804",
    "user": "rws"
}
```

Replying to [comment:13 mmarco]:
> As i said, the reason why it is not a method is that it is not clear to me what class should it be in. 
> 
> Is this a method of the expression F? Well, not exactly, since F is not the function that we are trying to differentiate, but the symbollic expression that deffines it implicitly.
I think Burcin wants this method part of the symbolic expression or function class. If it's not tied to a specific expression then make it a ``@`classmethod` (equivalent to a static method in C), and then create the globally accessible name for it.



---

archive/issue_comments_152805.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-02T17:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152805",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_152806.json:
```json
{
    "body": "Moved it to a method in the expression class.",
    "created_at": "2014-09-02T17:32:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152806",
    "user": "mmarco"
}
```

Moved it to a method in the expression class.



---

archive/issue_comments_152807.json:
```json
{
    "body": "Just some minor fixes. It looks good. I did no `make ptestlong` as it's just a new method.\n----\nNew commits:",
    "created_at": "2015-02-02T14:23:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152807",
    "user": "rws"
}
```

Just some minor fixes. It looks good. I did no `make ptestlong` as it's just a new method.
----
New commits:



---

archive/issue_comments_152808.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-02-02T14:23:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152808",
    "user": "rws"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_152809.json:
```json
{
    "body": "Thanks for the review.",
    "created_at": "2015-02-02T14:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152809",
    "user": "mmarco"
}
```

Thanks for the review.



---

archive/issue_comments_152810.json:
```json
{
    "body": "\n```\n**********************************************************************\nFile \"src/sage/misc/sageinspect.py\", line 1815, in sage.misc.sageinspect.sage_getsourcelines\nFailed example:\n    sage_getsourcelines(x)[0][-1]    # last line\nExpected:\n    '        return self / x\\n'\nGot:\n    '        return S\\n'\n**********************************************************************\n```\n",
    "created_at": "2015-02-07T15:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152810",
    "user": "mmezzarobba"
}
```


```
**********************************************************************
File "src/sage/misc/sageinspect.py", line 1815, in sage.misc.sageinspect.sage_getsourcelines
Failed example:
    sage_getsourcelines(x)[0][-1]    # last line
Expected:
    '        return self / x\n'
Got:
    '        return S\n'
**********************************************************************
```




---

archive/issue_comments_152811.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-02-07T15:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152811",
    "user": "mmezzarobba"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_152812.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-02-08T07:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152812",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_152813.json:
```json
{
    "body": "Interesting. That doctest depends on the last line in `class Expression` to remain unchanged.",
    "created_at": "2015-02-08T07:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152813",
    "user": "rws"
}
```

Interesting. That doctest depends on the last line in `class Expression` to remain unchanged.



---

archive/issue_comments_152814.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-02-08T07:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152814",
    "user": "rws"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_152815.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-17T19:28:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12750",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12750#issuecomment-152815",
    "user": "vbraun"
}
```

Resolution: fixed
