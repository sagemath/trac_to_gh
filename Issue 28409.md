# Issue 28409: Use CombinatorialPolyhedron to obtain faces of polyhedra

archive/issues_028409.json:
```json
{
    "body": "CC:  @jplab @laisrast\n\nKeywords: polytopes, combinatorial polyhedron\n\nWe use `CombinatorialPolyhedron` to obtain the faces of fixed dimensions of a polyhedron.\n\nWe add a method `face_generator`, which iterates over all faces (possibly of fixed dimension).\n\nWith this ticket we can obtain the faces much faster and without generating the entire face lattice. The iterator is a true iterator in the sense that it has almost constant memory usage and does and no point store a list of all faces.\n\nThis ticket changes the order of the output of `faces`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28646\n\n",
    "created_at": "2019-10-23T14:25:39Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.1",
    "title": "Use CombinatorialPolyhedron to obtain faces of polyhedra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28409",
    "user": "https://github.com/kliem"
}
```
CC:  @jplab @laisrast

Keywords: polytopes, combinatorial polyhedron

We use `CombinatorialPolyhedron` to obtain the faces of fixed dimensions of a polyhedron.

We add a method `face_generator`, which iterates over all faces (possibly of fixed dimension).

With this ticket we can obtain the faces much faster and without generating the entire face lattice. The iterator is a true iterator in the sense that it has almost constant memory usage and does and no point store a list of all faces.

This ticket changes the order of the output of `faces`.

Issue created by migration from https://trac.sagemath.org/ticket/28646





---

archive/issue_comments_400781.json:
```json
{
    "body": "I accidentally pulled #28625 instead of #28621. As #28625 is closed, I don't feel like fixing the branch.\n----\nNew commits:",
    "created_at": "2019-10-23T14:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400781",
    "user": "https://github.com/kliem"
}
```

I accidentally pulled #28625 instead of #28621. As #28625 is closed, I don't feel like fixing the branch.
----
New commits:



---

archive/issue_comments_400782.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-10-23T14:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400782",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_400783.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-23T17:45:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400783",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400784.json:
```json
{
    "body": "I would vote to change `face_dimension` to simply `dimension`.\n\nThe INPUT of `combinatorial_face_to_polyhedral_face` is too verbose to me.\n\nA `Polyhedron`, the polyhedron containing the face\nA `CombinatorialFace`\n\nOUTPUT:\n\nA `PolyhedronFace`\n\nis sufficient. If you insist to have the links on the documentation ok... But I would not be too verbose here.",
    "created_at": "2019-10-24T09:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400784",
    "user": "https://github.com/jplab"
}
```

I would vote to change `face_dimension` to simply `dimension`.

The INPUT of `combinatorial_face_to_polyhedral_face` is too verbose to me.

A `Polyhedron`, the polyhedron containing the face
A `CombinatorialFace`

OUTPUT:

A `PolyhedronFace`

is sufficient. If you insist to have the links on the documentation ok... But I would not be too verbose here.



---

archive/issue_comments_400785.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-10-24T09:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400785",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_400786.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-25T10:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400786",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400787.json:
```json
{
    "body": "Replying to [comment:3 jipilab]:\n> I would vote to change `face_dimension` to simply `dimension`.\n\nThis is to be consistent with the method `faces``.",
    "created_at": "2019-10-25T10:02:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400787",
    "user": "https://github.com/kliem"
}
```

Replying to [comment:3 jipilab]:
> I would vote to change `face_dimension` to simply `dimension`.

This is to be consistent with the method `faces``.



---

archive/issue_comments_400788.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-25T10:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400788",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_400789.json:
```json
{
    "body": "There will be a conflict with #17215.",
    "created_at": "2019-10-25T11:16:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400789",
    "user": "https://github.com/kliem"
}
```

There will be a conflict with #17215.



---

archive/issue_comments_400790.json:
```json
{
    "body": "Rebased\n----\nNew commits:",
    "created_at": "2019-10-28T08:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400790",
    "user": "https://github.com/kliem"
}
```

Rebased
----
New commits:



---

archive/issue_comments_400791.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-28T08:33:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400791",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_400792.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-10-28T11:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_400793.json:
```json
{
    "body": "The tests all pass on my end. face_generator runs for every type of polytope it should run on, and combinatorial_face_to_polyhedral_face runs as it should. The change in order experienced by the various face functions only affected the lists, not the correctness.",
    "created_at": "2019-11-18T22:59:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400793",
    "user": "https://github.com/bbryant33"
}
```

The tests all pass on my end. face_generator runs for every type of polytope it should run on, and combinatorial_face_to_polyhedral_face runs as it should. The change in order experienced by the various face functions only affected the lists, not the correctness.



---

archive/issue_comments_400794.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-11-18T22:59:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400794",
    "user": "https://github.com/bbryant33"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_400795.json:
```json
{
    "body": "Removing the dependency.\n\n#17215 will need small changes in the doctests, once it's done.",
    "created_at": "2019-11-19T05:36:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400795",
    "user": "https://github.com/kliem"
}
```

Removing the dependency.

#17215 will need small changes in the doctests, once it's done.



---

archive/issue_comments_400796.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-11-28T21:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400796",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_400797.json:
```json
{
    "body": "\n```\nsage -t --long --warn-long 34.6 src/sage/geometry/polyhedron/base.py  # 9 doctests failed\nsage -t --long --warn-long 34.6 src/sage/geometry/polyhedron/face.py  # 4 doctests failed\n```\n\ne.g.\n\n```\nFile \"src/sage/geometry/polyhedron/face.py\", line 10, in sage.geometry.polyhedron.face\nFailed example:\n    P.faces(3)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 681, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1123, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.geometry.polyhedron.face[1]>\", line 1, in <module>\n        P.faces(Integer(3))\n      File \"/home/release/Sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py\", line 5577, in faces\n        return tuple(self.face_generator(face_dimension))\n      File \"/home/release/Sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py\", line 5480, in face_generator\n        yield self._make_polyhedron_face(range(self.n_Vrepresentation()), [])\n      File \"/home/release/Sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base_ZZ.py\", line 53, in __getattribute__\n        return super(Polyhedron_ZZ, self).__getattribute__(name)\n      File \"sage/structure/element.pyx\", line 487, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4608)\n        return self.getattr_from_category(name)\n      File \"sage/structure/element.pyx\", line 500, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4717)\n        return getattr_from_other_class(self, cls, name)\n      File \"sage/cpython/getattr.pyx\", line 389, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:2547)\n        raise AttributeError(dummy_error_message)\n    AttributeError: 'Polyhedra_ZZ_ppl_with_category.element_class' object has no attribute '_make_polyhedron_face'\n```\n",
    "created_at": "2019-11-28T21:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400797",
    "user": "https://github.com/vbraun"
}
```


```
sage -t --long --warn-long 34.6 src/sage/geometry/polyhedron/base.py  # 9 doctests failed
sage -t --long --warn-long 34.6 src/sage/geometry/polyhedron/face.py  # 4 doctests failed
```

e.g.

```
File "src/sage/geometry/polyhedron/face.py", line 10, in sage.geometry.polyhedron.face
Failed example:
    P.faces(3)
Exception raised:
    Traceback (most recent call last):
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 681, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1123, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.geometry.polyhedron.face[1]>", line 1, in <module>
        P.faces(Integer(3))
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py", line 5577, in faces
        return tuple(self.face_generator(face_dimension))
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base.py", line 5480, in face_generator
        yield self._make_polyhedron_face(range(self.n_Vrepresentation()), [])
      File "/home/release/Sage/local/lib/python3.7/site-packages/sage/geometry/polyhedron/base_ZZ.py", line 53, in __getattribute__
        return super(Polyhedron_ZZ, self).__getattribute__(name)
      File "sage/structure/element.pyx", line 487, in sage.structure.element.Element.__getattr__ (build/cythonized/sage/structure/element.c:4608)
        return self.getattr_from_category(name)
      File "sage/structure/element.pyx", line 500, in sage.structure.element.Element.getattr_from_category (build/cythonized/sage/structure/element.c:4717)
        return getattr_from_other_class(self, cls, name)
      File "sage/cpython/getattr.pyx", line 389, in sage.cpython.getattr.getattr_from_other_class (build/cythonized/sage/cpython/getattr.c:2547)
        raise AttributeError(dummy_error_message)
    AttributeError: 'Polyhedra_ZZ_ppl_with_category.element_class' object has no attribute '_make_polyhedron_face'
```




---

archive/issue_comments_400798.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-11-28T22:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400798",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_400799.json:
```json
{
    "body": "Should work now.\n----\nNew commits:",
    "created_at": "2019-11-28T22:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400799",
    "user": "https://github.com/kliem"
}
```

Should work now.
----
New commits:



---

archive/issue_comments_400800.json:
```json
{
    "body": "ping",
    "created_at": "2019-12-17T14:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400800",
    "user": "https://github.com/kliem"
}
```

ping



---

archive/issue_comments_400801.json:
```json
{
    "body": "LGTM.",
    "created_at": "2019-12-27T17:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400801",
    "user": "https://github.com/tscrim"
}
```

LGTM.



---

archive/issue_comments_400802.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-12-27T17:00:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400802",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_400803.json:
```json
{
    "body": "9.0 is out",
    "created_at": "2020-01-01T21:01:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400803",
    "user": "https://github.com/fchapoton"
}
```

9.0 is out



---

archive/issue_comments_400804.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-01-05T15:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28409",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28409#issuecomment-400804",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
