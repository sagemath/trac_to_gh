# Issue 14666: Failure with Python int modulo a rational

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2013-07-09 10:21:07

Assignee: tscrim

CC:  vbraun roed

Some fun I came across:

```
sage: int(5) % QQ(2)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-8ec0f9994ded> in <module>()
----> 1 int(Integer(5)) % QQ(Integer(2))

TypeError: Argument 'self' has incorrect type (expected sage.rings.rational.Rational, got int)
```


Note that this works:

```
sage: 5 % QQ(2)
1
```



---

Comment by tscrim created at 2013-07-11 08:29:52

Fixed. Thanks Volker and David for your insight.


---

Comment by tscrim created at 2013-07-11 08:29:52

Changing status from new to needs_review.


---

Comment by vbraun created at 2013-07-11 16:39:29

You shouldn't check the type exactly, derived classes of rational should be treated like a rational.

Also, the whole `PY_*` macro usage that you see in the sources is mostly historical, nowadays Cython understands `isinstance(x, Rational)` just fine and this is the preferred form of a type check.


---

Comment by malmskog created at 2013-07-11 22:19:32

Changing status from needs_review to positive_review.


---

Comment by malmskog created at 2013-07-11 22:19:32

We tried using decimals like 3.0, coerced rationals like QQ(3), non-reduced fractions like 4/2, complex-like values like 3+0*I, and absolute values of integers as moduli (second argument in function)--all of these were correctly interpreted as integers.  We also found correct error messages for moduli that didn't make sense, for example mod(31/10, 10) produces a correct error message.  Looks good!


---

Attachment


---

Comment by tscrim created at 2013-07-12 04:52:22

New version as per Volker's comment.


---

Comment by tscrim created at 2013-07-12 04:52:49

`@`malmskog, you'll need to write your real name as the reviewer.


---

Comment by jdemeyer created at 2013-08-02 14:18:15

Resolution: fixed
