# Issue 21122: LiE does not start

Issue created by migration from Trac.

Original creator: mantepse

Original creation time: 2016-08-29 06:37:26


```
sage: lie.console()
/home/martin/sage-develop/local/bin/lie: Zeile 4: /home/martin/sage-develop/local/var/tmp/sage/build/lie-2.2.2/src/Lie.exe: Datei oder Verzeichnis nicht gefunden
```



The contents of `sage-develop/local/bin/lie` is
{{{#!/bin/sh

LD=/home/martin/sage-develop/local/var/tmp/sage/build/lie-2.2.2/src
exec $LD/Lie.exe initfile $LD
```

which looks like nonsense.  Indeed, changing it to

```
LD=/home/martin/sage-develop/local/lib/LiE
```

fixes the problem.  No idea (yet) where to put this though.


---

Comment by tscrim created at 2016-08-29 14:08:21

It works for me with LiE installed on 7.3. On 7.4.beta2 without LiE installed, it immediately crashes Sage without any message/traceback/core dump.


---

Comment by mantepse created at 2016-08-29 14:42:11

Replying to [comment:1 tscrim]:
> It works for me with LiE installed on 7.3. On 7.4.beta2 without LiE installed, it immediately crashes Sage without any message/traceback/core dump.

That's interesting.  On my computer, everything is fine (with the fix in the description)


```
martin`@`Martin-Laptop:~$ sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 7.4.beta2, Release Date: 2016-08-26               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: lie(1+1)
2
sage: lie.console()

LiE version 2.2.2 created on Aug 29 2016 at 08:20:52
Authors: Arjeh M. Cohen, Marc van Leeuwen, Bert Lisser.
Free source code distribution
type '?help' for help information
type '?' for a list of help entries.
> 
```



---

Comment by tscrim created at 2016-08-29 14:45:09

Granted, this should not crash Sage when LiE is not installed.

However, I just installed LiE on my 7.4.beta2 and that failed (without this fix). So something changed between 7.3 and 7.4.beta2.


---

Comment by jhpalmieri created at 2016-08-29 15:18:41

I wonder if the problem is the line

```
sed -e "s'$PWD/LiE'$SAGE_LOCAL/lib/LiE'" src/lie > src/lie~
```

in `spkg-install`. Try changing `$PWD/LiE` to `$PWD/src`: all spkgs now unpack into `src`, whereas the `spkg-install` script assumes that this unpacks into `LiE`.

```diff
diff --git a/build/pkgs/lie/spkg-install b/build/pkgs/lie/spkg-install
index 3668c4c..282a127 100755
--- a/build/pkgs/lie/spkg-install
+++ b/build/pkgs/lie/spkg-install
`@``@` -27,7 +27,7 `@``@` $MAKE CC="$CC" || die "Error building LiE. Did you install bison?"
 # "install" the LiE package by moving over the complete build
 # directory to $SAGE_LOCAL/lib/lie
 cd ..
-sed -e "s'$PWD/LiE'$SAGE_LOCAL/lib/LiE'" src/lie > src/lie~
+sed -e "s'$PWD/src'$SAGE_LOCAL/lib/LiE'" src/lie > src/lie~
 mv src/lie~ src/lie
 chmod +x src/lie
 rm -rf "$SAGE_LOCAL"/lib/lie # clean up old versions
```



---

Comment by jhpalmieri created at 2016-09-01 03:16:13

New commits:


---

Comment by jhpalmieri created at 2016-09-01 03:16:13

Changing status from new to needs_review.


---

Comment by tscrim created at 2016-09-01 04:59:15

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-09-01 04:59:15

This works for me and the fix looks good.

I don't feel we should force a reinstall by a version bump as the number of people who are likely to come across this bug is extremely small. So I'm setting this to positive review.


---

Comment by jdemeyer created at 2016-09-01 07:23:32

For the record: I don't know if `sed -e` is really portable (has it been tested on OS X)? I think just using `sed` without the `-e` option would be better.


---

Comment by jhpalmieri created at 2016-09-01 14:51:04

`sed -e` is available on OS X and [seems to be a POSIX standard option](http://pubs.opengroup.org/onlinepubs/009604599/utilities/sed.html). (I worked on this on an OS X machine.)


---

Comment by vbraun created at 2016-09-04 00:13:46

Resolution: fixed
