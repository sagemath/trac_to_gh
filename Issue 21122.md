# Issue 21122: LiE does not start

archive/issues_021122.json:
```json
{
    "body": "\n```\nsage: lie.console()\n/home/martin/sage-develop/local/bin/lie: Zeile 4: /home/martin/sage-develop/local/var/tmp/sage/build/lie-2.2.2/src/Lie.exe: Datei oder Verzeichnis nicht gefunden\n```\n\n\n\nThe contents of `sage-develop/local/bin/lie` is\n\n```/bin/sh\n\nLD=/home/martin/sage-develop/local/var/tmp/sage/build/lie-2.2.2/src\nexec $LD/Lie.exe initfile $LD\n```\n\nwhich looks like nonsense.  Indeed, changing it to\n\n```\nLD=/home/martin/sage-develop/local/lib/LiE\n```\n\nfixes the problem.  No idea (yet) where to put this though.\n\nIssue created by migration from https://trac.sagemath.org/ticket/21359\n\n",
    "created_at": "2016-08-29T06:37:26Z",
    "labels": [
        "component: packages: experimental",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "LiE does not start",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21122",
    "user": "https://github.com/mantepse"
}
```

```
sage: lie.console()
/home/martin/sage-develop/local/bin/lie: Zeile 4: /home/martin/sage-develop/local/var/tmp/sage/build/lie-2.2.2/src/Lie.exe: Datei oder Verzeichnis nicht gefunden
```



The contents of `sage-develop/local/bin/lie` is

```/bin/sh

LD=/home/martin/sage-develop/local/var/tmp/sage/build/lie-2.2.2/src
exec $LD/Lie.exe initfile $LD
```

which looks like nonsense.  Indeed, changing it to

```
LD=/home/martin/sage-develop/local/lib/LiE
```

fixes the problem.  No idea (yet) where to put this though.

Issue created by migration from https://trac.sagemath.org/ticket/21359





---

archive/issue_comments_292365.json:
```json
{
    "body": "It works for me with LiE installed on 7.3. On 7.4.beta2 without LiE installed, it immediately crashes Sage without any message/traceback/core dump.",
    "created_at": "2016-08-29T14:08:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292365",
    "user": "https://github.com/tscrim"
}
```

It works for me with LiE installed on 7.3. On 7.4.beta2 without LiE installed, it immediately crashes Sage without any message/traceback/core dump.



---

archive/issue_comments_292366.json:
```json
{
    "body": "Replying to [comment:1 tscrim]:\n> It works for me with LiE installed on 7.3. On 7.4.beta2 without LiE installed, it immediately crashes Sage without any message/traceback/core dump.\n\nThat's interesting.  On my computer, everything is fine (with the fix in the description)\n\n\n```\nmartin@Martin-Laptop:~$ sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 7.4.beta2, Release Date: 2016-08-26               \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: lie(1+1)\n2\nsage: lie.console()\n\nLiE version 2.2.2 created on Aug 29 2016 at 08:20:52\nAuthors: Arjeh M. Cohen, Marc van Leeuwen, Bert Lisser.\nFree source code distribution\ntype '?help' for help information\ntype '?' for a list of help entries.\n> \n```\n",
    "created_at": "2016-08-29T14:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292366",
    "user": "https://github.com/mantepse"
}
```

Replying to [comment:1 tscrim]:
> It works for me with LiE installed on 7.3. On 7.4.beta2 without LiE installed, it immediately crashes Sage without any message/traceback/core dump.

That's interesting.  On my computer, everything is fine (with the fix in the description)


```
martin@Martin-Laptop:~$ sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 7.4.beta2, Release Date: 2016-08-26               │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: lie(1+1)
2
sage: lie.console()

LiE version 2.2.2 created on Aug 29 2016 at 08:20:52
Authors: Arjeh M. Cohen, Marc van Leeuwen, Bert Lisser.
Free source code distribution
type '?help' for help information
type '?' for a list of help entries.
> 
```




---

archive/issue_comments_292367.json:
```json
{
    "body": "Granted, this should not crash Sage when LiE is not installed.\n\nHowever, I just installed LiE on my 7.4.beta2 and that failed (without this fix). So something changed between 7.3 and 7.4.beta2.",
    "created_at": "2016-08-29T14:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292367",
    "user": "https://github.com/tscrim"
}
```

Granted, this should not crash Sage when LiE is not installed.

However, I just installed LiE on my 7.4.beta2 and that failed (without this fix). So something changed between 7.3 and 7.4.beta2.



---

archive/issue_comments_292368.json:
```json
{
    "body": "I wonder if the problem is the line\n\n```\nsed -e \"s'$PWD/LiE'$SAGE_LOCAL/lib/LiE'\" src/lie > src/lie~\n```\n\nin `spkg-install`. Try changing `$PWD/LiE` to `$PWD/src`: all spkgs now unpack into `src`, whereas the `spkg-install` script assumes that this unpacks into `LiE`.\n\n```diff\ndiff --git a/build/pkgs/lie/spkg-install b/build/pkgs/lie/spkg-install\nindex 3668c4c..282a127 100755\n--- a/build/pkgs/lie/spkg-install\n+++ b/build/pkgs/lie/spkg-install\n@@ -27,7 +27,7 @@ $MAKE CC=\"$CC\" || die \"Error building LiE. Did you install bison?\"\n # \"install\" the LiE package by moving over the complete build\n # directory to $SAGE_LOCAL/lib/lie\n cd ..\n-sed -e \"s'$PWD/LiE'$SAGE_LOCAL/lib/LiE'\" src/lie > src/lie~\n+sed -e \"s'$PWD/src'$SAGE_LOCAL/lib/LiE'\" src/lie > src/lie~\n mv src/lie~ src/lie\n chmod +x src/lie\n rm -rf \"$SAGE_LOCAL\"/lib/lie # clean up old versions\n```\n",
    "created_at": "2016-08-29T15:18:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292368",
    "user": "https://github.com/jhpalmieri"
}
```

I wonder if the problem is the line

```
sed -e "s'$PWD/LiE'$SAGE_LOCAL/lib/LiE'" src/lie > src/lie~
```

in `spkg-install`. Try changing `$PWD/LiE` to `$PWD/src`: all spkgs now unpack into `src`, whereas the `spkg-install` script assumes that this unpacks into `LiE`.

```diff
diff --git a/build/pkgs/lie/spkg-install b/build/pkgs/lie/spkg-install
index 3668c4c..282a127 100755
--- a/build/pkgs/lie/spkg-install
+++ b/build/pkgs/lie/spkg-install
@@ -27,7 +27,7 @@ $MAKE CC="$CC" || die "Error building LiE. Did you install bison?"
 # "install" the LiE package by moving over the complete build
 # directory to $SAGE_LOCAL/lib/lie
 cd ..
-sed -e "s'$PWD/LiE'$SAGE_LOCAL/lib/LiE'" src/lie > src/lie~
+sed -e "s'$PWD/src'$SAGE_LOCAL/lib/LiE'" src/lie > src/lie~
 mv src/lie~ src/lie
 chmod +x src/lie
 rm -rf "$SAGE_LOCAL"/lib/lie # clean up old versions
```




---

archive/issue_comments_292369.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-09-01T03:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292369",
    "user": "https://github.com/jhpalmieri"
}
```

New commits:



---

archive/issue_comments_292370.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-01T03:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292370",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_292371.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-09-01T04:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292371",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_292372.json:
```json
{
    "body": "This works for me and the fix looks good.\n\nI don't feel we should force a reinstall by a version bump as the number of people who are likely to come across this bug is extremely small. So I'm setting this to positive review.",
    "created_at": "2016-09-01T04:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292372",
    "user": "https://github.com/tscrim"
}
```

This works for me and the fix looks good.

I don't feel we should force a reinstall by a version bump as the number of people who are likely to come across this bug is extremely small. So I'm setting this to positive review.



---

archive/issue_comments_292373.json:
```json
{
    "body": "For the record: I don't know if `sed -e` is really portable (has it been tested on OS X)? I think just using `sed` without the `-e` option would be better.",
    "created_at": "2016-09-01T07:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292373",
    "user": "https://github.com/jdemeyer"
}
```

For the record: I don't know if `sed -e` is really portable (has it been tested on OS X)? I think just using `sed` without the `-e` option would be better.



---

archive/issue_comments_292374.json:
```json
{
    "body": "`sed -e` is available on OS X and [seems to be a POSIX standard option](http://pubs.opengroup.org/onlinepubs/009604599/utilities/sed.html). (I worked on this on an OS X machine.)",
    "created_at": "2016-09-01T14:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292374",
    "user": "https://github.com/jhpalmieri"
}
```

`sed -e` is available on OS X and [seems to be a POSIX standard option](http://pubs.opengroup.org/onlinepubs/009604599/utilities/sed.html). (I worked on this on an OS X machine.)



---

archive/issue_events_020006.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-09-04T00:13:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21122#event-20006"
}
```



---

archive/issue_comments_292375.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-09-04T00:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21122",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21122#issuecomment-292375",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
