# Issue 28908: Indeterminacy locus and image of morphisms of schemes

Issue created by migration from https://trac.sagemath.org/ticket/29145

Original creator: klee

Original creation time: 2020-02-03 07:12:39

Implemented indeterminacy locus and image of morphisms of affine and projective schemes.

Along the way, cleaned up some files in schemes module.


---

Comment by git created at 2020-02-03 09:19:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2020-02-03 09:33:32

Changing status from new to needs_review.


---

Comment by git created at 2020-02-04 02:32:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-02-04 02:41:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2020-02-04 03:12:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-02-04 06:47:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-02-04 06:53:18

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2020-02-08 22:08:58

A few things:

It would be good to have a more clear indication for this list here

```diff
             sage: g.representatives()
             [Scheme morphism:
                From: Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:
                x^2 - y^2 - y
                To:   Affine Space of dimension 1 over Rational Field
                Defn: Defined on coordinates by sending (x, y) to
-                     (x/y), Scheme morphism:
+                     (x/y),
+             Scheme morphism:
                From: Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:
                x^2 - y^2 - y
                To:   Affine Space of dimension 1 over Rational Field
                Defn: Defined on coordinates by sending (x, y) to
                      ((y + 1)/x)]
```

and similar changes for the other tests in this method.

Do you need to move the `SchemeMorphism.__init__(self, parent)` in `SchemeMorphism_polynomial.__init__`? I feel it would be better to do it after the possible error messages for when those are raised so as to not do unnecessary work (granted, if it is needed to be initialized for the tests, then this comment is moot).

PEP8:

```diff
-p = source_ring(poly.numerator())/source_ring(poly.denominator())
+p = source_ring(poly.numerator()) / source_ring(poly.denominator())
```


I don't understand this bit of code:

```
        if not self.codomain().is_projective():
            pass
```

There is no `else` statement attached, so I feel it can be removed.

Is the `Chow_form` still usable by instances of `AlgebraicScheme_subscheme_projective`? Are they suppose to be?


---

Comment by klee created at 2020-02-10 02:18:28

Replying to [comment:11 tscrim]:
> A few things:
> 
> It would be good to have a more clear indication for this list here
> {{{#!diff
>              sage: g.representatives()
>              [Scheme morphism:
>                 From: Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:
>                 x^2 - y^2 - y
>                 To:   Affine Space of dimension 1 over Rational Field
>                 Defn: Defined on coordinates by sending (x, y) to
> -                     (x/y), Scheme morphism:
> +                     (x/y),
> +             Scheme morphism:
>                 From: Closed subscheme of Affine Space of dimension 2 over Rational Field defined by:
>                 x^2 - y^2 - y
>                 To:   Affine Space of dimension 1 over Rational Field
>                 Defn: Defined on coordinates by sending (x, y) to
>                       ((y + 1)/x)]
> }}}
> and similar changes for the other tests in this method.

OK. Done.

> Do you need to move the `SchemeMorphism.__init__(self, parent)` in `SchemeMorphism_polynomial.__init__`? I feel it would be better to do it after the possible error messages for when those are raised so as to not do unnecessary work (granted, if it is needed to be initialized for the tests, then this comment is moot).

No. You are right. I wrongly thought it is needed. Moved back.

> PEP8:
> {{{#!diff
> -p = source_ring(poly.numerator())/source_ring(poly.denominator())
> +p = source_ring(poly.numerator()) / source_ring(poly.denominator())
> }}}

Done.
 
> I don't understand this bit of code:
> {{{
>         if not self.codomain().is_projective():
>             pass
> }}}
> There is no `else` statement attached, so I feel it can be removed.

This part was "to do", and then I somehow  forgot.. Now I filled the missing part, which is for morphisms from projective subscheme to affine space. Thank you for spotting this!
> 
> Is the `Chow_form` still usable by instances of `AlgebraicScheme_subscheme_projective`? Are they suppose to be?

`Chow_form` method assumes the base ring is a field.  Methods of `AlgebraicScheme_subscheme_projective` should assume just rings. So it would be usable when the assumption is met.


---

Comment by git created at 2020-02-10 02:19:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-02-10 02:21:53

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2020-02-10 13:13:11

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-02-10 13:13:11

Thank you for the changes and explanations. LGTM.


---

Comment by vbraun created at 2020-02-11 21:05:51

Resolution: fixed
