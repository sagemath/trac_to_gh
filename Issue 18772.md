# Issue 18772: upgrade flint to 2.5.2

archive/issues_018772.json:
```json
{
    "body": "CC:  jpflori wbhart\n\nflint 2.5.2 is out. Upstream tarball is here \n\n    [http://flintlib.org/flint-2.5.2.tar.gz](http://flintlib.org/flint-2.5.2.tar.gz) \n\nAll interesting patches integrated upstream.\n\nIssue created by migration from https://trac.sagemath.org/ticket/19009\n\n",
    "closed_at": "2015-08-14T18:16:53Z",
    "created_at": "2015-08-10T11:36:12Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "upgrade flint to 2.5.2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18772",
    "user": "https://github.com/videlec"
}
```
CC:  jpflori wbhart

flint 2.5.2 is out. Upstream tarball is here 

    [http://flintlib.org/flint-2.5.2.tar.gz](http://flintlib.org/flint-2.5.2.tar.gz) 

All interesting patches integrated upstream.

Issue created by migration from https://trac.sagemath.org/ticket/19009





---

archive/issue_comments_256063.json:
```json
{
    "body": "The three patches that were written for flint-2.4.5 seem not needed anymore (two modifications are included and I was not sure how to handle the remaining one `flint-2.4.5-test.patch`). Removing them and launching `sage -f flint` I ended up with a failure related to NTL. I do not think that I can not help much more right now.",
    "created_at": "2015-08-10T12:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256063",
    "user": "https://github.com/videlec"
}
```

The three patches that were written for flint-2.4.5 seem not needed anymore (two modifications are included and I was not sure how to handle the remaining one `flint-2.4.5-test.patch`). Removing them and launching `sage -f flint` I ended up with a failure related to NTL. I do not think that I can not help much more right now.



---

archive/issue_comments_256064.json:
```json
{
    "body": "Can you post the failure log here?",
    "created_at": "2015-08-10T12:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256064",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Can you post the failure log here?



---

archive/issue_comments_256065.json:
```json
{
    "body": "Attachment [flint-2.5.log](tarball://root/attachments/some-uuid/ticket19009/flint-2.5.log) by @videlec created at 2015-08-10 15:39:58\n\nVincent build failed on the 10th of August",
    "created_at": "2015-08-10T15:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256065",
    "user": "https://github.com/videlec"
}
```

Attachment [flint-2.5.log](tarball://root/attachments/some-uuid/ticket19009/flint-2.5.log) by @videlec created at 2015-08-10 15:39:58

Vincent build failed on the 10th of August



---

archive/issue_comments_256066.json:
```json
{
    "body": "Replying to [comment:2 jpflori]:\n> Can you post the failure log here?\n\n\nDone. I also give the branch I started from in case.\n  \n---\nNew commits:",
    "created_at": "2015-08-10T15:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256066",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:2 jpflori]:
> Can you post the failure log here?


Done. I also give the branch I started from in case.
  
---
New commits:



---

archive/issue_comments_256067.json:
```json
{
    "body": "Strange\n\n```\n2631\tmake[2]: Leaving directory '/opt/sage/local/var/tmp/sage/build/flint-2.5/src'\n2632\t/bin/sh: 2: ldconfig: not found\n2633\tMakefile:141: recipe for target 'libflint.so.13.5.0' failed\n2634\tmake[1]: *** [libflint.so.13.5.0] Error 127\n```\nWhat can be this story with `ldconfig` not being found?",
    "created_at": "2015-08-10T16:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256067",
    "user": "https://github.com/videlec"
}
```

Strange

```
2631	make[2]: Leaving directory '/opt/sage/local/var/tmp/sage/build/flint-2.5/src'
2632	/bin/sh: 2: ldconfig: not found
2633	Makefile:141: recipe for target 'libflint.so.13.5.0' failed
2634	make[1]: *** [libflint.so.13.5.0] Error 127
```
What can be this story with `ldconfig` not being found?



---

archive/issue_comments_256068.json:
```json
{
    "body": "By replacing `ldconfig` with `/sbin/ldconfig` in `Makefile.in`, I was able to build flint... I am waiting for the rest.\n\nThere was a patch about changing a `.o` to a `.lo`. Should I keep it?",
    "created_at": "2015-08-10T16:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256068",
    "user": "https://github.com/videlec"
}
```

By replacing `ldconfig` with `/sbin/ldconfig` in `Makefile.in`, I was able to build flint... I am waiting for the rest.

There was a patch about changing a `.o` to a `.lo`. Should I keep it?



---

archive/issue_comments_256069.json:
```json
{
    "body": "Attachment [singular-3.1.7p1.p0.log](tarball://root/attachments/some-uuid/ticket19009/singular-3.1.7p1.p0.log) by @videlec created at 2015-08-10 16:52:16\n\nSingular failed build on 10th of August",
    "created_at": "2015-08-10T16:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256069",
    "user": "https://github.com/videlec"
}
```

Attachment [singular-3.1.7p1.p0.log](tarball://root/attachments/some-uuid/ticket19009/singular-3.1.7p1.p0.log) by @videlec created at 2015-08-10 16:52:16

Singular failed build on 10th of August



---

archive/issue_comments_256070.json:
```json
{
    "body": "Attachment [eclib-20150510.log](tarball://root/attachments/some-uuid/ticket19009/eclib-20150510.log) by @videlec created at 2015-08-10 16:52:56\n\nFailed eclib build on 10th of August",
    "created_at": "2015-08-10T16:52:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256070",
    "user": "https://github.com/videlec"
}
```

Attachment [eclib-20150510.log](tarball://root/attachments/some-uuid/ticket19009/eclib-20150510.log) by @videlec created at 2015-08-10 16:52:56

Failed eclib build on 10th of August



---

archive/issue_comments_256071.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-10T17:40:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256071",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_256072.json:
```json
{
    "body": "There seems to be a bug around `nmod_mat_cols` vs `nmod_mat_ncols` that prevents to build both `singular` and `eclib`. A simple substitution does the trick (see commit `5af4274`). I posted a message on [flint-devel](https://groups.google.com/forum/#!forum/flint-devel) but as I just registered my message is moderated.\n\nWith the current branch I was able to build the whole Sage from scratch.",
    "created_at": "2015-08-10T17:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256072",
    "user": "https://github.com/videlec"
}
```

There seems to be a bug around `nmod_mat_cols` vs `nmod_mat_ncols` that prevents to build both `singular` and `eclib`. A simple substitution does the trick (see commit `5af4274`). I posted a message on [flint-devel](https://groups.google.com/forum/#!forum/flint-devel) but as I just registered my message is moderated.

With the current branch I was able to build the whole Sage from scratch.



---

archive/issue_comments_256073.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-10T21:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256073",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_256074.json:
```json
{
    "body": "Ready to be tested!",
    "created_at": "2015-08-10T21:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256074",
    "user": "https://github.com/videlec"
}
```

Ready to be tested!



---

archive/issue_comments_256075.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-08-10T21:41:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256075",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_256076.json:
```json
{
    "body": "Have you run the test suite Vincent? I got rather interesting stuff while working on the Gentoo ebuild\n* the old test patch shouldn't be needed anymore (I originally wrote that patch) because the `.o` is explicitly requested to be build for the test (quick clever actually, wish I had thought of that).\n\nSomething that I will have to take upstream but from which the spkg should be safe. If a previous libflint is already installed the test suite will fail to link because the old one may miss some symbols that are tested and it will be the one found and linked again first. It shouldn't affect sagemath because `spkg-install` explicitly remove the old flint library before install.",
    "created_at": "2015-08-11T00:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256076",
    "user": "https://github.com/kiwifb"
}
```

Have you run the test suite Vincent? I got rather interesting stuff while working on the Gentoo ebuild
* the old test patch shouldn't be needed anymore (I originally wrote that patch) because the `.o` is explicitly requested to be build for the test (quick clever actually, wish I had thought of that).

Something that I will have to take upstream but from which the spkg should be safe. If a previous libflint is already installed the test suite will fail to link because the old one may miss some symbols that are tested and it will be the one found and linked again first. It shouldn't affect sagemath because `spkg-install` explicitly remove the old flint library before install.



---

archive/issue_comments_256077.json:
```json
{
    "body": "The problem is quite linux specific. The `FLINT_LIB` target creates `libflint.so.x.y.z` and link it to `libflint.so.x` but doesn't create `libflint.so`. That last one is only created on installation. So if you configure flint to only build shared libraries on linux and run `make check` you don't have a usable `libflint.so` in your build directory. If you have one in a `-Lpath` or global location it will be used. If not you'll go for a straight failure.",
    "created_at": "2015-08-11T01:47:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256077",
    "user": "https://github.com/kiwifb"
}
```

The problem is quite linux specific. The `FLINT_LIB` target creates `libflint.so.x.y.z` and link it to `libflint.so.x` but doesn't create `libflint.so`. That last one is only created on installation. So if you configure flint to only build shared libraries on linux and run `make check` you don't have a usable `libflint.so` in your build directory. If you have one in a `-Lpath` or global location it will be used. If not you'll go for a straight failure.



---

archive/issue_comments_256078.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-11T08:42:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256078",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_256079.json:
```json
{
    "body": "All flint test passed without the first patch (I ran `sage -f -c flint`). Thanks!\n\nI also added some description of the two remaining patches in SPKG.txt. According to Bill Hart, they will be in flint-2.5.1.",
    "created_at": "2015-08-11T08:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256079",
    "user": "https://github.com/videlec"
}
```

All flint test passed without the first patch (I ran `sage -f -c flint`). Thanks!

I also added some description of the two remaining patches in SPKG.txt. According to Bill Hart, they will be in flint-2.5.1.



---

archive/issue_comments_256080.json:
```json
{
    "body": "I think you did a very good job spotting those issues, although I am not sure `ldconfig` should be used but that is a matter of taste. I think this is in good shape to go. Send it to the bots!",
    "created_at": "2015-08-11T08:58:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256080",
    "user": "https://github.com/kiwifb"
}
```

I think you did a very good job spotting those issues, although I am not sure `ldconfig` should be used but that is a matter of taste. I think this is in good shape to go. Send it to the bots!



---

archive/issue_comments_256081.json:
```json
{
    "body": "Sadly, the bots will not run it because it is about a package... (e.g. they would have to guess where to download the package)",
    "created_at": "2015-08-11T09:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256081",
    "user": "https://github.com/videlec"
}
```

Sadly, the bots will not run it because it is about a package... (e.g. they would have to guess where to download the package)



---

archive/issue_comments_256082.json:
```json
{
    "body": "Well I guess you could at least make the location of the tarball more obvious in the description. It took me a few seconds to work it out.",
    "created_at": "2015-08-11T09:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256082",
    "user": "https://github.com/kiwifb"
}
```

Well I guess you could at least make the location of the tarball more obvious in the description. It took me a few seconds to work it out.



---

archive/issue_comments_256083.json:
```json
{
    "body": "Sorry for that.",
    "created_at": "2015-08-11T09:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256083",
    "user": "https://github.com/videlec"
}
```

Sorry for that.



---

archive/issue_comments_256084.json:
```json
{
    "body": "Do not work on OS X. Your `ldconfig` fix is not appropriate for OS X and other platform lacking `ldconfig`. I will be in touch with upstream about it.",
    "created_at": "2015-08-11T21:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256084",
    "user": "https://github.com/kiwifb"
}
```

Do not work on OS X. Your `ldconfig` fix is not appropriate for OS X and other platform lacking `ldconfig`. I will be in touch with upstream about it.



---

archive/issue_comments_256085.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-11T21:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256085",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_256086.json:
```json
{
    "body": "Replying to [comment:20 fbissey]:\n> Do not work on OS X. Your `ldconfig` fix is not appropriate for OS X and other platform lacking `ldconfig`. I will be in touch with upstream about it.\n\n\nBill did something for !Cygwin/Mingw (setting `LDCONFIG=/dev/null`). But not OS X. The last state of `configure` in the `trunk` branch shows\n\n```\n# sometimes LDCONFIG is not to be found in the path. Look at some common places.\ncase \"$OS\" in\n   MINGW*|CYGWIN*)\n      LDCONFIG=\"/dev/null\";;\n   *)\n      if [ -z \"$LDCONFIG\" ]; then\n         if command -v ldconfig > /dev/null; then\n            LDCONFIG=\"ldconfig\"\n         elif [ -x /sbin/ldconfig ]; then\n            LDCONFIG=\"/sbin/ldconfig\"\n         else\n            echo \"Warning: ldconfig was not found. You can specify a path on the command line with LDCONFIG=<name>\";\n            exit 1\n         fi\n      fi;;\nesac\n```",
    "created_at": "2015-08-11T21:58:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256086",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:20 fbissey]:
> Do not work on OS X. Your `ldconfig` fix is not appropriate for OS X and other platform lacking `ldconfig`. I will be in touch with upstream about it.


Bill did something for !Cygwin/Mingw (setting `LDCONFIG=/dev/null`). But not OS X. The last state of `configure` in the `trunk` branch shows

```
# sometimes LDCONFIG is not to be found in the path. Look at some common places.
case "$OS" in
   MINGW*|CYGWIN*)
      LDCONFIG="/dev/null";;
   *)
      if [ -z "$LDCONFIG" ]; then
         if command -v ldconfig > /dev/null; then
            LDCONFIG="ldconfig"
         elif [ -x /sbin/ldconfig ]; then
            LDCONFIG="/sbin/ldconfig"
         else
            echo "Warning: ldconfig was not found. You can specify a path on the command line with LDCONFIG=<name>";
            exit 1
         fi
      fi;;
esac
```



---

archive/issue_comments_256087.json:
```json
{
    "body": "I hadn't noticed that. That's the obvious spot to add something for OS X. Thanks for pointing it out.",
    "created_at": "2015-08-11T22:01:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256087",
    "user": "https://github.com/kiwifb"
}
```

I hadn't noticed that. That's the obvious spot to add something for OS X. Thanks for pointing it out.



---

archive/issue_comments_256088.json:
```json
{
    "body": "See the discussion here [https://github.com/wbhart/flint2/pull/177](https://github.com/wbhart/flint2/pull/177)",
    "created_at": "2015-08-11T22:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256088",
    "user": "https://github.com/videlec"
}
```

See the discussion here [https://github.com/wbhart/flint2/pull/177](https://github.com/wbhart/flint2/pull/177)



---

archive/issue_comments_256089.json:
```json
{
    "body": "I see, I have added stuff to the ongoing conversation I have with Bill in https://github.com/wbhart/flint2/issues/180 I guess if it doesn't pick it up now I should make a further pull request for him to find.",
    "created_at": "2015-08-11T22:13:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256089",
    "user": "https://github.com/kiwifb"
}
```

I see, I have added stuff to the ongoing conversation I have with Bill in https://github.com/wbhart/flint2/issues/180 I guess if it doesn't pick it up now I should make a further pull request for him to find.



---

archive/issue_comments_256090.json:
```json
{
    "body": "Bill has merged my OS X stuff and I compiled/tested trunk inside of sage 6.8 (but not installed in place or rebuild stuff, including sage, against it). It looks like we will have a 2.5.1 release shortly with all those fixes inside. I suggest we move to that.",
    "created_at": "2015-08-12T01:32:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256090",
    "user": "https://github.com/kiwifb"
}
```

Bill has merged my OS X stuff and I compiled/tested trunk inside of sage 6.8 (but not installed in place or rebuild stuff, including sage, against it). It looks like we will have a 2.5.1 release shortly with all those fixes inside. I suggest we move to that.



---

archive/issue_comments_256091.json:
```json
{
    "body": "Back to needs review with flint-2.5.1!\n\n---\nNew commits:",
    "created_at": "2015-08-12T16:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256091",
    "user": "https://github.com/videlec"
}
```

Back to needs review with flint-2.5.1!

---
New commits:



---

archive/issue_comments_256092.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-12T16:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256092",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_256093.json:
```json
{
    "body": "I'm afraid there is going to be a 2.5.2. This soname versioning is causing problems everywhere, even with the fixes.\n\nThere's also a bug in gmpcompat.h (fixed in trunk).\n\nI hope it won't take long.\n\nUnfortunately libtool is broken on msys2, so we can't even use that.\n\nAnd some systems don't make /dev/null executable. What a mess this soname business is!",
    "created_at": "2015-08-12T18:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256093",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

I'm afraid there is going to be a 2.5.2. This soname versioning is causing problems everywhere, even with the fixes.

There's also a bug in gmpcompat.h (fixed in trunk).

I hope it won't take long.

Unfortunately libtool is broken on msys2, so we can't even use that.

And some systems don't make /dev/null executable. What a mess this soname business is!



---

archive/issue_comments_256094.json:
```json
{
    "body": "Replying to [comment:28 wbhart]:\n> I'm afraid there is going to be a 2.5.2. This soname versioning is causing problems everywhere, even with the fixes.\n\n\nWe will wait for that... there is no hurry on the Sage side.",
    "created_at": "2015-08-12T18:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256094",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:28 wbhart]:
> I'm afraid there is going to be a 2.5.2. This soname versioning is causing problems everywhere, even with the fixes.


We will wait for that... there is no hurry on the Sage side.



---

archive/issue_comments_256095.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-12T18:50:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256095",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_256096.json:
```json
{
    "body": "Can someone verify that \"true\" is available on OSX as an alternative to /dev/null and that it ignores arguments, i.e.\n\ntrue blah 1 2 3 \"hello\"\n\ndoes nothing. I want to use this instead of /dev/null in lieu of LDCONFIG, since more and more systems are making /dev/null not executable.",
    "created_at": "2015-08-13T09:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256096",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

Can someone verify that "true" is available on OSX as an alternative to /dev/null and that it ignores arguments, i.e.

true blah 1 2 3 "hello"

does nothing. I want to use this instead of /dev/null in lieu of LDCONFIG, since more and more systems are making /dev/null not executable.



---

archive/issue_comments_256097.json:
```json
{
    "body": "```\nMirage:~ fbissey$ uname -a\nDarwin Mirage.local 14.4.0 Darwin Kernel Version 14.4.0: Thu May 28 11:35:04 PDT 2015; root:xnu-2782.30.5~1/RELEASE_X86_64 x86_64\nMirage:~ fbissey$ which true\n/usr/bin/true\nMirage:~ fbissey$ true blah 1 2 3 \"hello\"\nMirage:~ fbissey$ \n```\nMore seriously I am not sure where your problem is. On OS X when I found out that `LDCONFIG` needed a value I put `a`.\nNothing will try to execute or run the content of `LDCONFIG` in configure if it is passed as an argument and putting `/dev/null` where you did is just as good. Once `LDCONFIG` is defined the only place it can be executed is in the `Makefile` and then it only happens on system with `FLINT_SOLIB` which should only be true on linux. So not executed on any other platform. Actually if you want to clean that up, only care about `LDCONFIG` if `FLINT_SOLIB` is defined in configure.",
    "created_at": "2015-08-13T09:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256097",
    "user": "https://github.com/kiwifb"
}
```

```
Mirage:~ fbissey$ uname -a
Darwin Mirage.local 14.4.0 Darwin Kernel Version 14.4.0: Thu May 28 11:35:04 PDT 2015; root:xnu-2782.30.5~1/RELEASE_X86_64 x86_64
Mirage:~ fbissey$ which true
/usr/bin/true
Mirage:~ fbissey$ true blah 1 2 3 "hello"
Mirage:~ fbissey$ 
```
More seriously I am not sure where your problem is. On OS X when I found out that `LDCONFIG` needed a value I put `a`.
Nothing will try to execute or run the content of `LDCONFIG` in configure if it is passed as an argument and putting `/dev/null` where you did is just as good. Once `LDCONFIG` is defined the only place it can be executed is in the `Makefile` and then it only happens on system with `FLINT_SOLIB` which should only be true on linux. So not executed on any other platform. Actually if you want to clean that up, only care about `LDCONFIG` if `FLINT_SOLIB` is defined in configure.



---

archive/issue_comments_256098.json:
```json
{
    "body": "Sorry, I'm not sure I understand what you mean. LDCONFIG is intended to be executed by the Makefile. I don't see where I said it was to be executed by configure. Of course I meant to use true in lieu of ldconfig, not LDCONFIG.\n\n/dev/null doesn't work on some systems (the build fails) because permission to execute /dev/null is denied. Unfortunately, such systems don't set a meaningful uname and so we can't even detect them. true seems to be more portable than /dev/null, at least until someone decides it is a security threat and stops people executing it, as happened with /dev/null.\n\nI will try to clean up when LDCONFIG is set to something other than true. I think having it bomb out with an error is not the right strategy. Even on systems that set FLINT_SOLIB, if they don't have ldconfig it is most likely because they don't need it, in which case configure shouldn't just exit.",
    "created_at": "2015-08-13T11:29:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256098",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

Sorry, I'm not sure I understand what you mean. LDCONFIG is intended to be executed by the Makefile. I don't see where I said it was to be executed by configure. Of course I meant to use true in lieu of ldconfig, not LDCONFIG.

/dev/null doesn't work on some systems (the build fails) because permission to execute /dev/null is denied. Unfortunately, such systems don't set a meaningful uname and so we can't even detect them. true seems to be more portable than /dev/null, at least until someone decides it is a security threat and stops people executing it, as happened with /dev/null.

I will try to clean up when LDCONFIG is set to something other than true. I think having it bomb out with an error is not the right strategy. Even on systems that set FLINT_SOLIB, if they don't have ldconfig it is most likely because they don't need it, in which case configure shouldn't just exit.



---

archive/issue_comments_256099.json:
```json
{
    "body": "Have you thought about using `-` in front of `$LDCONFIG` https://www.gnu.org/software/make/manual/html_node/Errors.html#Errors ? That would help it not to bomb out I think.",
    "created_at": "2015-08-13T12:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256099",
    "user": "https://github.com/kiwifb"
}
```

Have you thought about using `-` in front of `$LDCONFIG` https://www.gnu.org/software/make/manual/html_node/Errors.html#Errors ? That would help it not to bomb out I think.



---

archive/issue_comments_256100.json:
```json
{
    "body": "I don't know why, but putting a - in from of $LDCONFIG didn't actually work. It just said, \n\n/bin/sh: 2: -ldconfig: not found\n\nSo much for removing the minus before passing it to the shell!\n\nEdit: ok it works if I put it earlier. It obviously considers the whole block a \"line\".",
    "created_at": "2015-08-13T13:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256100",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

I don't know why, but putting a - in from of $LDCONFIG didn't actually work. It just said, 

/bin/sh: 2: -ldconfig: not found

So much for removing the minus before passing it to the shell!

Edit: ok it works if I put it earlier. It obviously considers the whole block a "line".



---

archive/issue_comments_256101.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-13T16:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256101",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_256102.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-13T16:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256102",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_256103.json:
```json
{
    "body": "I have now put up flint-2.5.2. I've tested it on Ubuntu and Msys2 and Cygwin to ensure we didn't break anything there. I'd appreciate testing on OSX to verify that all is fine there.",
    "created_at": "2015-08-13T16:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256103",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

I have now put up flint-2.5.2. I've tested it on Ubuntu and Msys2 and Cygwin to ensure we didn't break anything there. I'd appreciate testing on OSX to verify that all is fine there.



---

archive/issue_comments_256104.json:
```json
{
    "body": "By the way, in case it is relevant, the BSD's use different soname policies than Linux, Cygwin, Msys2 or OSX. So flint is almost certainly broken on BSD. But I recently lost access to the last BSD machine I could use. So there's not much I can do for BSD. No doubt Solaris/SunOS is different again.",
    "created_at": "2015-08-13T16:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256104",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

By the way, in case it is relevant, the BSD's use different soname policies than Linux, Cygwin, Msys2 or OSX. So flint is almost certainly broken on BSD. But I recently lost access to the last BSD machine I could use. So there's not much I can do for BSD. No doubt Solaris/SunOS is different again.



---

archive/issue_comments_256105.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-13T16:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256105",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_256106.json:
```json
{
    "body": "I just installed FreeBSD in a virtual machine. Though I was not able to run the `Makefile`. I got plenty of errors\n\n```\nmake: \"/usr/home/vincent/flint2/Makefile\" line 35: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 37: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 39: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 63: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 122: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 126: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 128: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 192: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 198: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 200: Need an operator\nmake: \"/usr/home/vincent/flint2/Makefile\" line 201: duplicate script for target \"define\" ignored\n...\n```\nLooks like the BSD make is not exactly behaving like the linux one.",
    "created_at": "2015-08-13T18:37:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256106",
    "user": "https://github.com/videlec"
}
```

I just installed FreeBSD in a virtual machine. Though I was not able to run the `Makefile`. I got plenty of errors

```
make: "/usr/home/vincent/flint2/Makefile" line 35: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 37: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 39: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 63: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 122: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 126: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 128: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 192: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 198: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 200: Need an operator
make: "/usr/home/vincent/flint2/Makefile" line 201: duplicate script for target "define" ignored
...
```
Looks like the BSD make is not exactly behaving like the linux one.



---

archive/issue_comments_256107.json:
```json
{
    "body": "Yes. You should use GNU make rather than BSD make. A common problem not just on BSD. Usually it is found as `gmake` on those platforms.",
    "created_at": "2015-08-13T18:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256107",
    "user": "https://github.com/kiwifb"
}
```

Yes. You should use GNU make rather than BSD make. A common problem not just on BSD. Usually it is found as `gmake` on those platforms.



---

archive/issue_comments_256108.json:
```json
{
    "body": "If you can tell me what uname and uname -m return on that particular VM I can at least hack in my best guess (in the next release -- I'm not fixing to issue another patch to 2.5).\n\nAnd yeah, you'll need a bunch of gnu tools to get anywhere on BSD. gmake and probably others.",
    "created_at": "2015-08-13T19:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256108",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

If you can tell me what uname and uname -m return on that particular VM I can at least hack in my best guess (in the next release -- I'm not fixing to issue another patch to 2.5).

And yeah, you'll need a bunch of gnu tools to get anywhere on BSD. gmake and probably others.



---

archive/issue_comments_256109.json:
```json
{
    "body": "On OS X, it passes its test suite and all of Sage's tests pass. (The checksums didn't match, though. I had to fix those first.)",
    "created_at": "2015-08-13T19:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256109",
    "user": "https://github.com/jhpalmieri"
}
```

On OS X, it passes its test suite and all of Sage's tests pass. (The checksums didn't match, though. I had to fix those first.)



---

archive/issue_comments_256110.json:
```json
{
    "body": "Replying to [comment:45 jhpalmieri]:\n> On OS X, it passes its test suite and all of Sage's tests pass. (The checksums didn't match, though. I had to fix those first.)\n\n\nWhere you at commit `70b5107`? The sha1sum of the flint-2.5.2.tar.gz that I downloaded started with `04534a2b`.",
    "created_at": "2015-08-13T19:36:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256110",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:45 jhpalmieri]:
> On OS X, it passes its test suite and all of Sage's tests pass. (The checksums didn't match, though. I had to fix those first.)


Where you at commit `70b5107`? The sha1sum of the flint-2.5.2.tar.gz that I downloaded started with `04534a2b`.



---

archive/issue_comments_256111.json:
```json
{
    "body": "I sneaked an extra commit into the flint-2.5.2 tarball just a couple of minutes after I announced 2.5.2. It's just an extra line in the NEWS file.\n\nI would rewrite history, but my time machine is currently stuck in subspace and I have a plasma leak on deck 7.",
    "created_at": "2015-08-13T19:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256111",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

I sneaked an extra commit into the flint-2.5.2 tarball just a couple of minutes after I announced 2.5.2. It's just an extra line in the NEWS file.

I would rewrite history, but my time machine is currently stuck in subspace and I have a plasma leak on deck 7.



---

archive/issue_comments_256112.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-13T20:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256112",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_256113.json:
```json
{
    "body": "With the good checksum.",
    "created_at": "2015-08-13T20:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256113",
    "user": "https://github.com/videlec"
}
```

With the good checksum.



---

archive/issue_comments_256114.json:
```json
{
    "body": "Replying to [comment:35 wbhart]:\n> I don't know why, but putting a - in from of $LDCONFIG didn't actually work. It just said, \n> \n> /bin/sh: 2: -ldconfig: not found\n> \n> So much for removing the minus before passing it to the shell!\n> \n> Edit: ok it works if I put it earlier. It obviously considers the whole block a \"line\".\n\n\nLooking back at it, yes of course not just the `ldconfig` call. I am not even sure I want to call it a block when you use a continuation line.\n\nI am putting this back to positive review.",
    "created_at": "2015-08-13T22:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256114",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:35 wbhart]:
> I don't know why, but putting a - in from of $LDCONFIG didn't actually work. It just said, 
> 
> /bin/sh: 2: -ldconfig: not found
> 
> So much for removing the minus before passing it to the shell!
> 
> Edit: ok it works if I put it earlier. It obviously considers the whole block a "line".


Looking back at it, yes of course not just the `ldconfig` call. I am not even sure I want to call it a block when you use a continuation line.

I am putting this back to positive review.



---

archive/issue_comments_256115.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-08-13T22:04:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256115",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_052922.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-08-14T18:16:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18772#event-52922"
}
```



---

archive/issue_comments_256116.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-08-14T18:16:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18772",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18772#issuecomment-256116",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
