# Issue 20741: polygon3d view broken

archive/issues_020741.json:
```json
{
    "body": "CC:  paulmasson novoselt mkoeppe\n\n\n```\npolygon3d([[0,0,0], [1,2,3], [3,0,0]]) \n```\n\ndoes not show anything.  See [this ask.sagemath question](http://ask.sagemath.org/question/34054/polygon3d-doesnt-work/).\n\nIssue created by migration from https://trac.sagemath.org/ticket/20978\n\n",
    "created_at": "2016-07-07T22:18:50Z",
    "labels": [
        "graphics",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "polygon3d view broken",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20741",
    "user": "kcrisman"
}
```
CC:  paulmasson novoselt mkoeppe


```
polygon3d([[0,0,0], [1,2,3], [3,0,0]]) 
```

does not show anything.  See [this ask.sagemath question](http://ask.sagemath.org/question/34054/polygon3d-doesnt-work/).

Issue created by migration from https://trac.sagemath.org/ticket/20978





---

archive/issue_comments_286528.json:
```json
{
    "body": "When I add an `arrow3d` (for example), then it displays properly:\n\n```\nsage: polygon3d([[0,0,1],[0,1,0],[1,0,0]]) + arrow3d([0,0,0],[1,1,1])\nsage: p2.plot() + arrow3d([0,0,0],[1,1,1])\n```\n\nIt seems like it is just ignoring the polygon3d when it is the only object:\n\n```\nsage: p = polygon3d([[0,0,1],[0,1,0],[1,0,0]]) + arrow3d([0,0,0],[1,1,1])\nsage: rp = p.default_render_params()\nsage: rp.output_archive = None\nsage: p.jmol_repr(rp)\n['pmesh obj_1 \"/home/travis/.sage/temp/apricot/5573/tmp_pU6Ppq-obj_1.pmesh\"\\ncolor pmesh  [0,0,255]']\n<type 'sage.plot.plot3d.index_face_set.IndexFaceSet'>\n\nsage: p = polygon3d([[0,0,1],[0,1,0],[1,0,0]]) + arrow3d([0,0,0],[1,1,1])\nsage: p.jmol_repr(rp)\n[['pmesh obj_2 \"/home/travis/.sage/temp/apricot/5573/tmp_pU6Ppq-obj_2.pmesh\"\\ncolor pmesh  [0,0,255]'],\n [[['\\ndraw line_3 width 0.02 {0.0 0.0 0.0} {0.896076951546 0.896076951546 0.896076951546}\\ncolor $line_3  [102,102,255]\\n'],\n   [['pmesh obj_4 \"/home/travis/.sage/temp/apricot/5573/tmp_pU6Ppq-obj_4.pmesh\"\\ncolor pmesh  [102,102,255]']]]]]\nsage: type(p)\n<class 'sage.plot.plot3d.base.Graphics3dGroup'>\n\nsage: p = arrow3d([0,0,0],[1,1,1])\nsage: p.plot()    # This works fine\nLaunched jmol viewer for Graphics3d Object\nsage: p.jmol_repr(rp)\n[[['\\ndraw line_5 width 0.02 {0.0 0.0 0.0} {0.896076951546 0.896076951546 0.896076951546}\\ncolor $line_5  [102,102,255]\\n'],\n  [['pmesh obj_6 \"/home/travis/.sage/temp/apricot/5573/tmp_pU6Ppq-obj_6.pmesh\"\\ncolor pmesh  [102,102,255]']]]]\nsage: type(p)\n<class 'sage.plot.plot3d.base.TransformGroup'>\n```\n\n\nA somewhat strange thing is that the graphics group `jmol_repr` calls the `jmol_repr` of the polygon. Perhaps someone has an idea about this (and knows how to read the jmol input).",
    "created_at": "2016-07-08T04:18:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286528",
    "user": "tscrim"
}
```

When I add an `arrow3d` (for example), then it displays properly:

```
sage: polygon3d([[0,0,1],[0,1,0],[1,0,0]]) + arrow3d([0,0,0],[1,1,1])
sage: p2.plot() + arrow3d([0,0,0],[1,1,1])
```

It seems like it is just ignoring the polygon3d when it is the only object:

```
sage: p = polygon3d([[0,0,1],[0,1,0],[1,0,0]]) + arrow3d([0,0,0],[1,1,1])
sage: rp = p.default_render_params()
sage: rp.output_archive = None
sage: p.jmol_repr(rp)
['pmesh obj_1 "/home/travis/.sage/temp/apricot/5573/tmp_pU6Ppq-obj_1.pmesh"\ncolor pmesh  [0,0,255]']
<type 'sage.plot.plot3d.index_face_set.IndexFaceSet'>

sage: p = polygon3d([[0,0,1],[0,1,0],[1,0,0]]) + arrow3d([0,0,0],[1,1,1])
sage: p.jmol_repr(rp)
[['pmesh obj_2 "/home/travis/.sage/temp/apricot/5573/tmp_pU6Ppq-obj_2.pmesh"\ncolor pmesh  [0,0,255]'],
 [[['\ndraw line_3 width 0.02 {0.0 0.0 0.0} {0.896076951546 0.896076951546 0.896076951546}\ncolor $line_3  [102,102,255]\n'],
   [['pmesh obj_4 "/home/travis/.sage/temp/apricot/5573/tmp_pU6Ppq-obj_4.pmesh"\ncolor pmesh  [102,102,255]']]]]]
sage: type(p)
<class 'sage.plot.plot3d.base.Graphics3dGroup'>

sage: p = arrow3d([0,0,0],[1,1,1])
sage: p.plot()    # This works fine
Launched jmol viewer for Graphics3d Object
sage: p.jmol_repr(rp)
[[['\ndraw line_5 width 0.02 {0.0 0.0 0.0} {0.896076951546 0.896076951546 0.896076951546}\ncolor $line_5  [102,102,255]\n'],
  [['pmesh obj_6 "/home/travis/.sage/temp/apricot/5573/tmp_pU6Ppq-obj_6.pmesh"\ncolor pmesh  [102,102,255]']]]]
sage: type(p)
<class 'sage.plot.plot3d.base.TransformGroup'>
```


A somewhat strange thing is that the graphics group `jmol_repr` calls the `jmol_repr` of the polygon. Perhaps someone has an idea about this (and knows how to read the jmol input).



---

archive/issue_comments_286529.json:
```json
{
    "body": "Works for me with sage 7.3.beta6 on Ubuntu 15.10 for both sage notebook and jupyter notebook (a blue triangle is displayed in the jmol output). Does *not* work from the sage console (only the bounding box is displayed).",
    "created_at": "2016-07-08T11:35:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286529",
    "user": "egourgoulhon"
}
```

Works for me with sage 7.3.beta6 on Ubuntu 15.10 for both sage notebook and jupyter notebook (a blue triangle is displayed in the jmol output). Does *not* work from the sage console (only the bounding box is displayed).



---

archive/issue_comments_286530.json:
```json
{
    "body": "Replying to [comment:3 egourgoulhon]:\n> Works for me with sage 7.3.beta6 on Ubuntu 15.10 for both sage notebook and jupyter notebook (a blue triangle is displayed in the jmol output). Does *not* work from the sage console (only the bounding box is displayed). \n\nAddendum: in the sage notebook, the triangle is displayed only after one has clicked on the figure.",
    "created_at": "2016-07-08T11:48:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286530",
    "user": "egourgoulhon"
}
```

Replying to [comment:3 egourgoulhon]:
> Works for me with sage 7.3.beta6 on Ubuntu 15.10 for both sage notebook and jupyter notebook (a blue triangle is displayed in the jmol output). Does *not* work from the sage console (only the bounding box is displayed). 

Addendum: in the sage notebook, the triangle is displayed only after one has clicked on the figure.



---

archive/issue_comments_286531.json:
```json
{
    "body": "I don't think this is a Sage problem. If you look at the temporary files under the hidden `User/.sage` directory that are passed to the Jmol viewer, the `pmesh` files for the polygons are there and included every time in the `SCRIPT` file in `scene.spt.zip`. The data for the polygons is exactly the same whether or not the arrow is included.\n\nAs a test, run this at the command line:\n\n\n```\np=polygon([(0,0,0),(1,0,0),(1,1,0)])\nfor n in range(1,10):\n     p+=polygon([(n,0,0),(n+1,0,0),(n+1,n+1,0)])\n     p\n```\n\n\nWhen I run it the polygons don't being to appear until there are six of them, and don't appear reliably for higher numbers.\n\nI think this is a Jmol display problem.",
    "created_at": "2016-07-11T20:59:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286531",
    "user": "paulmasson"
}
```

I don't think this is a Sage problem. If you look at the temporary files under the hidden `User/.sage` directory that are passed to the Jmol viewer, the `pmesh` files for the polygons are there and included every time in the `SCRIPT` file in `scene.spt.zip`. The data for the polygons is exactly the same whether or not the arrow is included.

As a test, run this at the command line:


```
p=polygon([(0,0,0),(1,0,0),(1,1,0)])
for n in range(1,10):
     p+=polygon([(n,0,0),(n+1,0,0),(n+1,n+1,0)])
     p
```


When I run it the polygons don't being to appear until there are six of them, and don't appear reliably for higher numbers.

I think this is a Jmol display problem.



---

archive/issue_comments_286532.json:
```json
{
    "body": "Hmmm...perhaps it is time to revive the discussion of moving to a different 3d viewing platform? At least we should probably tell upstream.",
    "created_at": "2016-07-12T14:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286532",
    "user": "tscrim"
}
```

Hmmm...perhaps it is time to revive the discussion of moving to a different 3d viewing platform? At least we should probably tell upstream.



---

archive/issue_comments_286533.json:
```json
{
    "body": "On #12402 I've written some basic Three.js support for `Graphics3d` objects that can handle examples here that fail in Jmol. If there is interest in having an option other than Jmol, feedback on #12402 would be appreciated.",
    "created_at": "2016-09-30T00:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286533",
    "user": "paulmasson"
}
```

On #12402 I've written some basic Three.js support for `Graphics3d` objects that can handle examples here that fail in Jmol. If there is interest in having an option other than Jmol, feedback on #12402 would be appreciated.



---

archive/issue_comments_286534.json:
```json
{
    "body": "Is this usable with sage running in a terminal? Note that the failure documented in this ticket is about the Java version of Jmol, which is the one that is used in this situation.",
    "created_at": "2016-09-30T05:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286534",
    "user": "mkoeppe"
}
```

Is this usable with sage running in a terminal? Note that the failure documented in this ticket is about the Java version of Jmol, which is the one that is used in this situation.



---

archive/issue_comments_286535.json:
```json
{
    "body": "Replying to [comment:10 mkoeppe]:\n> Is this usable with sage running in a terminal?\nYup! That's the entire point: an HTML file is generated at the command line and saved in a temporary file like other plots. It can then be displayed immediately in a browser, or embedded in an iframe for future application in notebooks or the cell server.",
    "created_at": "2016-09-30T19:52:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286535",
    "user": "paulmasson"
}
```

Replying to [comment:10 mkoeppe]:
> Is this usable with sage running in a terminal?
Yup! That's the entire point: an HTML file is generated at the command line and saved in a temporary file like other plots. It can then be displayed immediately in a browser, or embedded in an iframe for future application in notebooks or the cell server.



---

archive/issue_comments_286536.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-10-08T20:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286536",
    "user": "paulmasson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_286537.json:
```json
{
    "body": "Since Three.js will be the default viewer in Sage 9.0 this ticket can be closed.",
    "created_at": "2019-10-08T20:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286537",
    "user": "paulmasson"
}
```

Since Three.js will be the default viewer in Sage 9.0 this ticket can be closed.



---

archive/issue_comments_286538.json:
```json
{
    "body": "Changing keywords from \"\" to \"jmol threejs\".",
    "created_at": "2019-10-08T20:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286538",
    "user": "paulmasson"
}
```

Changing keywords from "" to "jmol threejs".



---

archive/issue_comments_286539.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-08T21:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286539",
    "user": "egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_286540.json:
```json
{
    "body": "Replying to [comment:12 paulmasson]:\n> Since Three.js will be the default viewer in Sage 9.0 this ticket can be closed.\n\nYes indeed.",
    "created_at": "2019-10-08T21:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286540",
    "user": "egourgoulhon"
}
```

Replying to [comment:12 paulmasson]:
> Since Three.js will be the default viewer in Sage 9.0 this ticket can be closed.

Yes indeed.



---

archive/issue_comments_286541.json:
```json
{
    "body": "Changing priority from critical to minor.",
    "created_at": "2019-10-08T21:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286541",
    "user": "kcrisman"
}
```

Changing priority from critical to minor.



---

archive/issue_comments_286542.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2019-10-08T21:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286542",
    "user": "kcrisman"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_286543.json:
```json
{
    "body": "Just because the default changes doesn't mean this is fixed, and some people may still be using Jmol from command line or whatever.    But we can certainly modify the ticket.",
    "created_at": "2019-10-08T21:09:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286543",
    "user": "kcrisman"
}
```

Just because the default changes doesn't mean this is fixed, and some people may still be using Jmol from command line or whatever.    But we can certainly modify the ticket.



---

archive/issue_comments_286544.json:
```json
{
    "body": "Replying to [comment:14 kcrisman]:\n> Just because the default changes doesn't mean this is fixed, and some people may still be using Jmol from command line or whatever.    \n\nYes you are right of course, I've been too fast here.",
    "created_at": "2019-10-08T21:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286544",
    "user": "egourgoulhon"
}
```

Replying to [comment:14 kcrisman]:
> Just because the default changes doesn't mean this is fixed, and some people may still be using Jmol from command line or whatever.    

Yes you are right of course, I've been too fast here.



---

archive/issue_comments_286545.json:
```json
{
    "body": "For the record, the issue is still there in Sage 9.0.beta0, even after the update of Jmol in #25026.",
    "created_at": "2019-10-08T21:18:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286545",
    "user": "egourgoulhon"
}
```

For the record, the issue is still there in Sage 9.0.beta0, even after the update of Jmol in #25026.



---

archive/issue_comments_286546.json:
```json
{
    "body": "Replying to [comment:14 kcrisman]:\n> Just because the default changes doesn't mean this is fixed, and some people may still be using Jmol from command line or whatever.    But we can certainly modify the ticket.\nAs I pointed out three years ago, this is not a Sage problem and won\u2019t get fixed here. Are you keeping the ticket open monitor upstream activity? Otherwise it should be closed.",
    "created_at": "2019-10-08T22:29:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286546",
    "user": "paulmasson"
}
```

Replying to [comment:14 kcrisman]:
> Just because the default changes doesn't mean this is fixed, and some people may still be using Jmol from command line or whatever.    But we can certainly modify the ticket.
As I pointed out three years ago, this is not a Sage problem and wonâ€™t get fixed here. Are you keeping the ticket open monitor upstream activity? Otherwise it should be closed.



---

archive/issue_comments_286547.json:
```json
{
    "body": "We have tons of tickets here that monitor upstream activity, because they impact Sage usability in various contexts.   I notice that \"Report Upstream\" is currently N/A, though, so maybe that should be changed and possibly worked on.  I often do this with Maxima bugs but I don't know what the current Jmol upstream reporting process is.",
    "created_at": "2019-10-09T12:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286547",
    "user": "kcrisman"
}
```

We have tons of tickets here that monitor upstream activity, because they impact Sage usability in various contexts.   I notice that "Report Upstream" is currently N/A, though, so maybe that should be changed and possibly worked on.  I often do this with Maxima bugs but I don't know what the current Jmol upstream reporting process is.



---

archive/issue_comments_286548.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286548",
    "user": "embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_comments_286549.json:
```json
{
    "body": "Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.",
    "created_at": "2020-05-01T04:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286549",
    "user": "mkoeppe"
}
```

Moving tickets to milestone sage-9.2 based on a review of last modification date, branch status, and severity.



---

archive/issue_comments_286550.json:
```json
{
    "body": "Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage",
    "created_at": "2021-04-02T20:21:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286550",
    "user": "mkoeppe"
}
```

Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage



---

archive/issue_comments_286551.json:
```json
{
    "body": "Setting a new milestone for this ticket based on a cursory review.",
    "created_at": "2021-07-19T00:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286551",
    "user": "mkoeppe"
}
```

Setting a new milestone for this ticket based on a cursory review.



---

archive/issue_comments_286552.json:
```json
{
    "body": "Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20741#issuecomment-286552",
    "user": "mkoeppe"
}
```

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.
