# Issue 30800: Install tests in sage/tests/books

Issue created by migration from https://trac.sagemath.org/ticket/31037

Original creator: fbissey

Original creation time: 2020-12-11 00:06:00

CC:  arojas

Keywords: sd111

Following sd111 discussion at #31016 we noted that tests in `sage/tests/books` are not installed and therefore not doctested when doctests are run from a globally installed sage as is done by the like of sage-on-gentoo and Arch.


---

Comment by fbissey created at 2020-12-11 00:08:08

Changing status from new to needs_info.


---

Comment by fbissey created at 2020-12-11 00:08:08

New commits:


---

Comment by fbissey created at 2020-12-11 00:09:48

Before putting it for review we need to make a final decision on the README file attached to the "computational mathematics with sagemath" book.
https://github.com/sagemath/sage/blob/develop/src/sage/tests/books/computational-mathematics-with-sagemath/README


---

Comment by mkoeppe created at 2020-12-11 00:12:20

I think I would prefer a solution that installs all these files as package data rather than as Python packages.


---

Comment by fbissey created at 2020-12-11 00:21:36

I am not even sure that `sage/tests` is the right location for them in the first place. In `judson-abstract-algebra` we have solution of problems from the book, in a doctestable format. And in `computational-mathematics-with-sage` we have autogenerated example, that are meant to be doctestable. In fact there is a disconnect between the name of the files and their own description. See https://github.com/sagemath/sage/blob/develop/src/sage/tests/books/computational-mathematics-with-sagemath/calculus_doctest.py for example.

They have been put into sage so they can be updated on change of behavior, but a better location may be somewhere under `doc` and that could still be doctested.


---

Comment by fbissey created at 2020-12-11 01:55:32

Just to re-iterate: 

If it is .py files that you install under `PYTHON_PATH` (site-package or otherwise), it should be precompiled. This happens automatically if you install things as python package but not as package data. QA in Gentoo would tell me to manually compile them, effectively it would introduce something I have to do on my side.

If we install them as real data by changing them to .rst files for example, we could then install them as package data, but we would need some kind of runner for them like `sage/doctest/test.py` is for the content of `sage/doctest/tests/`.

Putting them under `doc` is interesting but may cause problem with the doc build system. We don't want to produce html or pdf.


---

Comment by mkoeppe created at 2020-12-11 02:46:40

OK, adding the `__init__` files seems like a good simple solution then.


---

Comment by mkoeppe created at 2020-12-11 19:02:13

Changing status from needs_info to needs_review.


---

Comment by mkoeppe created at 2020-12-11 19:02:52

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-12-14 23:52:58

Resolution: fixed
