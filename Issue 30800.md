# Issue 30800: Install tests in sage/tests/books

archive/issues_030800.json:
```json
{
    "body": "CC:  @antonio-rojas\n\nKeywords: sd111\n\nFollowing sd111 discussion at #31016 we noted that tests in `sage/tests/books` are not installed and therefore not doctested when doctests are run from a globally installed sage as is done by the like of sage-on-gentoo and Arch.\n\nIssue created by migration from https://trac.sagemath.org/ticket/31037\n\n",
    "created_at": "2020-12-11T00:06:00Z",
    "labels": [
        "component: distribution"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Install tests in sage/tests/books",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30800",
    "user": "https://github.com/kiwifb"
}
```
CC:  @antonio-rojas

Keywords: sd111

Following sd111 discussion at #31016 we noted that tests in `sage/tests/books` are not installed and therefore not doctested when doctests are run from a globally installed sage as is done by the like of sage-on-gentoo and Arch.

Issue created by migration from https://trac.sagemath.org/ticket/31037





---

archive/issue_comments_439814.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2020-12-11T00:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439814",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_439815.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-12-11T00:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439815",
    "user": "https://github.com/kiwifb"
}
```

New commits:



---

archive/issue_comments_439816.json:
```json
{
    "body": "Before putting it for review we need to make a final decision on the README file attached to the \"computational mathematics with sagemath\" book.\nhttps://github.com/sagemath/sage/blob/develop/src/sage/tests/books/computational-mathematics-with-sagemath/README",
    "created_at": "2020-12-11T00:09:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439816",
    "user": "https://github.com/kiwifb"
}
```

Before putting it for review we need to make a final decision on the README file attached to the "computational mathematics with sagemath" book.
https://github.com/sagemath/sage/blob/develop/src/sage/tests/books/computational-mathematics-with-sagemath/README



---

archive/issue_comments_439817.json:
```json
{
    "body": "I think I would prefer a solution that installs all these files as package data rather than as Python packages.",
    "created_at": "2020-12-11T00:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439817",
    "user": "https://github.com/mkoeppe"
}
```

I think I would prefer a solution that installs all these files as package data rather than as Python packages.



---

archive/issue_comments_439818.json:
```json
{
    "body": "I am not even sure that `sage/tests` is the right location for them in the first place. In `judson-abstract-algebra` we have solution of problems from the book, in a doctestable format. And in `computational-mathematics-with-sage` we have autogenerated example, that are meant to be doctestable. In fact there is a disconnect between the name of the files and their own description. See https://github.com/sagemath/sage/blob/develop/src/sage/tests/books/computational-mathematics-with-sagemath/calculus_doctest.py for example.\n\nThey have been put into sage so they can be updated on change of behavior, but a better location may be somewhere under `doc` and that could still be doctested.",
    "created_at": "2020-12-11T00:21:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439818",
    "user": "https://github.com/kiwifb"
}
```

I am not even sure that `sage/tests` is the right location for them in the first place. In `judson-abstract-algebra` we have solution of problems from the book, in a doctestable format. And in `computational-mathematics-with-sage` we have autogenerated example, that are meant to be doctestable. In fact there is a disconnect between the name of the files and their own description. See https://github.com/sagemath/sage/blob/develop/src/sage/tests/books/computational-mathematics-with-sagemath/calculus_doctest.py for example.

They have been put into sage so they can be updated on change of behavior, but a better location may be somewhere under `doc` and that could still be doctested.



---

archive/issue_comments_439819.json:
```json
{
    "body": "Just to re-iterate: \n\nIf it is .py files that you install under `PYTHON_PATH` (site-package or otherwise), it should be precompiled. This happens automatically if you install things as python package but not as package data. QA in Gentoo would tell me to manually compile them, effectively it would introduce something I have to do on my side.\n\nIf we install them as real data by changing them to .rst files for example, we could then install them as package data, but we would need some kind of runner for them like `sage/doctest/test.py` is for the content of `sage/doctest/tests/`.\n\nPutting them under `doc` is interesting but may cause problem with the doc build system. We don't want to produce html or pdf.",
    "created_at": "2020-12-11T01:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439819",
    "user": "https://github.com/kiwifb"
}
```

Just to re-iterate: 

If it is .py files that you install under `PYTHON_PATH` (site-package or otherwise), it should be precompiled. This happens automatically if you install things as python package but not as package data. QA in Gentoo would tell me to manually compile them, effectively it would introduce something I have to do on my side.

If we install them as real data by changing them to .rst files for example, we could then install them as package data, but we would need some kind of runner for them like `sage/doctest/test.py` is for the content of `sage/doctest/tests/`.

Putting them under `doc` is interesting but may cause problem with the doc build system. We don't want to produce html or pdf.



---

archive/issue_comments_439820.json:
```json
{
    "body": "OK, adding the `__init__` files seems like a good simple solution then.",
    "created_at": "2020-12-11T02:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439820",
    "user": "https://github.com/mkoeppe"
}
```

OK, adding the `__init__` files seems like a good simple solution then.



---

archive/issue_comments_439821.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2020-12-11T19:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439821",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_439822.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-11T19:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439822",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_439823.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-14T23:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30800",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30800#issuecomment-439823",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
