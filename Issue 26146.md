# Issue 26146: Include missing patch for openblas from #24669

Issue created by migration from Trac.

Original creator: embray

Original creation time: 2018-10-02 09:56:51

CC:  vbraun

My branch for #24669 originally included this patch (the patch is even mentioned in the ticket description).  But when I rebased the branch on 8.4.beta0 it looks like I somehow dropped the commit that included the patch.

I have good reason to believe this is what caused the Cygwin buildbot to hang, but I am in the process of rebuilding with the patch now in order to test.

I just discovered this issue or obviously I would have reported sooner.


---

Comment by embray created at 2018-10-02 10:07:25

Not sure if I should bump the patch level or not.  The main body of the patch itself only impacts Cygwin (everything it changes is protected by an `#ifdef`), but it also updates one test that will run on other platforms.

I just manually rebuilt openblas with `SAGE_CHECK=yes` and this patch on my Ubuntu machine and it passed, but maybe it should run on the other buildbots as well...?

The additional test is a less important part of the patch, and can be removed if it is a problem.


---

Comment by git created at 2018-10-02 12:59:14

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by embray created at 2018-10-02 13:00:29

Went ahead and bumped the package version.

I confirmed that this fixed cases of code which uses openblas hanging on Cygwin (which is a relief, since after the last time I fixed this I had a hard time imagining what else could be broken unless there was some deep bug in Cygwin).


---

Comment by embray created at 2018-10-02 13:00:29

Changing status from new to needs_review.


---

Comment by @timokau created at 2018-10-02 15:59:24

Can you please add documentation to the patch? What is the upstreaming status?


---

Comment by embray created at 2018-10-03 10:04:46

Replying to [comment:4 gh-timokau]:
> Can you please add documentation to the patch? What is the upstreaming status?

As I wrote on the original ticket, this fix is already accepted upstream and is in a later release.  Next time we update the openblas package for Sage we can probably drop it.


---

Comment by git created at 2018-10-03 10:06:53

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by embray created at 2018-10-03 10:07:36

Fine. I added a comment to the patch file.  Note, you can also always look at the git log for the file to see where it came from.  But I agree it's often more convenient to have it right in the file.


---

Comment by @timokau created at 2018-10-03 16:10:32

Thank you! Yes its usually possible to find the origin of a patch with git-log, but its far from pleasant. We should document at least all new patches. Its a bit less urgent when its already accepted upstream, but its still nice to be able to see that immediately.

LGTM now, positive review pending on local tests.


---

Comment by @timokau created at 2018-10-03 17:56:19

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-10-04 21:54:20

Resolution: fixed
