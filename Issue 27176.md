# Issue 27176: Implement picard group and unit group for non-maximal orders

Issue created by migration from https://trac.sagemath.org/ticket/27413

Original creator: klui

Original creation time: 2019-03-04 01:19:11

Keywords: class group, unit group, non-maximal order, picard group

The goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.

Non-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, 


```
sage: K.<a> = NumberField(x^2-5)
sage: O = K.order(a); O.is_maximal()
False
sage: O.ideal(2)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-10-8da0cc5ea6ab> in <module>()
----> 1 O.ideal(Integer(2))

/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)
    232         """
    233         if not self.is_maximal():
--> 234             raise NotImplementedError("ideals of non-maximal orders not yet supported.")
    235         I = self.number_field().ideal(*args, **kwds)
    236         if not I.is_integral():

NotImplementedError: ideals of non-maximal orders not yet supported. 
```

So this might be hard.


---

Comment by klui created at 2019-03-05 04:23:54

Changing component from modular forms to number fields.


---

Comment by git created at 2019-08-17 20:06:21

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by git created at 2019-08-17 23:54:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2019-08-19 02:11:55

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
