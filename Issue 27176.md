# Issue 27176: Implement picard group and unit group for non-maximal orders

archive/issues_027176.json:
```json
{
    "body": "Keywords: class group, unit group, non-maximal order, picard group\n\nThe goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.\n\nNon-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, \n\n\n```\nsage: K.<a> = NumberField(x^2-5)\nsage: O = K.order(a); O.is_maximal()\nFalse\nsage: O.ideal(2)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-10-8da0cc5ea6ab> in <module>()\n----> 1 O.ideal(Integer(2))\n\n/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)\n    232         \"\"\"\n    233         if not self.is_maximal():\n--> 234             raise NotImplementedError(\"ideals of non-maximal orders not yet supported.\")\n    235         I = self.number_field().ideal(*args, **kwds)\n    236         if not I.is_integral():\n\nNotImplementedError: ideals of non-maximal orders not yet supported. \n```\n\nSo this might be hard.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27413\n\n",
    "created_at": "2019-03-04T01:19:11Z",
    "labels": [
        "component: modular forms"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-wishlist",
    "title": "Implement picard group and unit group for non-maximal orders",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27176",
    "user": "https://github.com/kevinywlui"
}
```
Keywords: class group, unit group, non-maximal order, picard group

The goal of this ticket is to compute the unit group (as a subgroup of the unit group of the maximal order) and to compute the picard group (these are useful for isomorphism-testing and isogeny-enumerating of modabvars.) So the goal is to implement the algorithms here: https://math.uni-paderborn.de/fileadmin/mathematik/AG-Computeralgebra/Publications-klueners/picard.pdf . These have already been implemented in Magma (by the authors of the paper, I believe) so we should double-check with the results there.

Non-maximal orders are not well-supported in Sage (Sage uses PARI for maximal orders but PARI does not have non-maximal orders, except for quadratic number fields). For example, 


```
sage: K.<a> = NumberField(x^2-5)
sage: O = K.order(a); O.is_maximal()
False
sage: O.ideal(2)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-10-8da0cc5ea6ab> in <module>()
----> 1 O.ideal(Integer(2))

/home/klui/sage/local/lib/python2.7/site-packages/sage/rings/number_field/order.pyc in ideal(self, *args, **kwds)
    232         """
    233         if not self.is_maximal():
--> 234             raise NotImplementedError("ideals of non-maximal orders not yet supported.")
    235         I = self.number_field().ideal(*args, **kwds)
    236         if not I.is_integral():

NotImplementedError: ideals of non-maximal orders not yet supported. 
```

So this might be hard.

Issue created by migration from https://trac.sagemath.org/ticket/27413





---

archive/issue_comments_382439.json:
```json
{
    "body": "Changing component from modular forms to number fields.",
    "created_at": "2019-03-05T04:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27176#issuecomment-382439",
    "user": "https://github.com/kevinywlui"
}
```

Changing component from modular forms to number fields.



---

archive/issue_comments_382440.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-08-17T20:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27176#issuecomment-382440",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_382441.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-17T23:54:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27176#issuecomment-382441",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_382442.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2019-08-19T02:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27176",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27176#issuecomment-382442",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
