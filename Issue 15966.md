# Issue 15966: conversion from SR.series() to PowerSeries(SR) gives unexpected result

archive/issues_015966.json:
```json
{
    "body": "CC:  kcrisman\n\nKeywords: series conversion\n\n\n```\nsage: R.<x> = PowerSeriesRing(SR)\nsage: var('y')\ny\nsage: ex=1/(1-y)\nsage: ex.series(y,20)\n1 + 1*y + 1*y^2 + 1*y^3 + 1*y^4 + 1*y^5 + 1*y^6 + 1*y^7 + 1*y^8 + 1*y^9 + 1*y^10 + 1*y^11 + 1*y^12 + 1*y^13 + 1*y^14 + 1*y^15 + 1*y^16 + 1*y^17 + 1*y^18 + 1*y^19 + Order(y^20)\nsage: s=R(_); s\n1 + y + y^2 + y^3 + y^4 + y^5 + y^6 + y^7 + y^8 + y^9 + y^10 + y^11 + y^12 + y^13 + y^14 + y^15 + y^16 + y^17 + y^18 + y^19 + Order(y^20)\nsage: type(s)\n<type 'sage.rings.power_series_poly.PowerSeries_poly'>\nsage: s.list()\n[1 + 1*y + 1*y^2 + 1*y^3 + 1*y^4 + 1*y^5 + 1*y^6 + 1*y^7 + 1*y^8 + 1*y^9 + 1*y^10 + 1*y^11 + 1*y^12 + 1*y^13 + 1*y^14 + 1*y^15 + 1*y^16 + 1*y^17 + 1*y^18 + 1*y^19 + Order(y^20)]\n```\n\nThe correct result would be `1 + x + x^2...`. Obviously `Order(20)` is not recognized as a marker for the existence of a power series. The whole symbolic expression is taken as a constant.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16203\n\n",
    "created_at": "2014-04-22T07:43:31Z",
    "labels": [
        "algebra",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "conversion from SR.series() to PowerSeries(SR) gives unexpected result",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15966",
    "user": "rws"
}
```
CC:  kcrisman

Keywords: series conversion


```
sage: R.<x> = PowerSeriesRing(SR)
sage: var('y')
y
sage: ex=1/(1-y)
sage: ex.series(y,20)
1 + 1*y + 1*y^2 + 1*y^3 + 1*y^4 + 1*y^5 + 1*y^6 + 1*y^7 + 1*y^8 + 1*y^9 + 1*y^10 + 1*y^11 + 1*y^12 + 1*y^13 + 1*y^14 + 1*y^15 + 1*y^16 + 1*y^17 + 1*y^18 + 1*y^19 + Order(y^20)
sage: s=R(_); s
1 + y + y^2 + y^3 + y^4 + y^5 + y^6 + y^7 + y^8 + y^9 + y^10 + y^11 + y^12 + y^13 + y^14 + y^15 + y^16 + y^17 + y^18 + y^19 + Order(y^20)
sage: type(s)
<type 'sage.rings.power_series_poly.PowerSeries_poly'>
sage: s.list()
[1 + 1*y + 1*y^2 + 1*y^3 + 1*y^4 + 1*y^5 + 1*y^6 + 1*y^7 + 1*y^8 + 1*y^9 + 1*y^10 + 1*y^11 + 1*y^12 + 1*y^13 + 1*y^14 + 1*y^15 + 1*y^16 + 1*y^17 + 1*y^18 + 1*y^19 + Order(y^20)]
```

The correct result would be `1 + x + x^2...`. Obviously `Order(20)` is not recognized as a marker for the existence of a power series. The whole symbolic expression is taken as a constant.

Issue created by migration from https://trac.sagemath.org/ticket/16203





---

archive/issue_comments_207188.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-12-03T09:45:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207188",
    "user": "rws"
}
```

New commits:



---

archive/issue_comments_207189.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-12-04T15:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207189",
    "user": "rws"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207190.json:
```json
{
    "body": "This also resolves #16198\n----\nNew commits:",
    "created_at": "2014-12-04T15:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207190",
    "user": "rws"
}
```

This also resolves #16198
----
New commits:



---

archive/issue_comments_207191.json:
```json
{
    "body": "As currently stated in the description, this is the correct result as the variable for `PowerSeriesRing` is `x`, whereas we have some symbolic expression in `y` (so is naturally an element in the coefficient ring). Having mismatched variable names automatically converting over seems fraught with problems and could lead to subtle bugs.",
    "created_at": "2014-12-04T18:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207191",
    "user": "tscrim"
}
```

As currently stated in the description, this is the correct result as the variable for `PowerSeriesRing` is `x`, whereas we have some symbolic expression in `y` (so is naturally an element in the coefficient ring). Having mismatched variable names automatically converting over seems fraught with problems and could lead to subtle bugs.



---

archive/issue_comments_207192.json:
```json
{
    "body": "Replying to [comment:11 tscrim]:\n> As currently stated in the description, this is the correct result as the variable for `PowerSeriesRing` is `x`, whereas we have some symbolic expression in `y` (so is naturally an element in the coefficient ring). Having mismatched variable names automatically converting over seems fraught with problems and could lead to subtle bugs.\nI see. So, conversion to an existing power series ring should only be allowed if the series expansion variable has the same name as the ring var. Multiple vars aren't supported by SR.series anyway.",
    "created_at": "2014-12-05T08:26:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207192",
    "user": "rws"
}
```

Replying to [comment:11 tscrim]:
> As currently stated in the description, this is the correct result as the variable for `PowerSeriesRing` is `x`, whereas we have some symbolic expression in `y` (so is naturally an element in the coefficient ring). Having mismatched variable names automatically converting over seems fraught with problems and could lead to subtle bugs.
I see. So, conversion to an existing power series ring should only be allowed if the series expansion variable has the same name as the ring var. Multiple vars aren't supported by SR.series anyway.



---

archive/issue_comments_207193.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-05T09:38:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207193",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207194.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-01-23T08:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207194",
    "user": "rws"
}
```

New commits:



---

archive/issue_comments_207195.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-01-25T15:07:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207195",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207196.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-01-25T16:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207196",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207197.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-23T16:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207197",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207198.json:
```json
{
    "body": "Pending because #17659 is pending.",
    "created_at": "2015-04-20T15:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207198",
    "user": "rws"
}
```

Pending because #17659 is pending.



---

archive/issue_comments_207199.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-02-05T08:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207199",
    "user": "rws"
}
```

New commits:



---

archive/issue_comments_207200.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-03-21T15:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207200",
    "user": "maurimo"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_207201.json:
```json
{
    "body": "\"is\" should be \"==\".\nThe changes to ring.pyx are unrelated and should be removed.\nEverything else looks alright.",
    "created_at": "2016-03-21T15:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207201",
    "user": "maurimo"
}
```

"is" should be "==".
The changes to ring.pyx are unrelated and should be removed.
Everything else looks alright.



---

archive/issue_comments_207202.json:
```json
{
    "body": "Changing keywords from \"series conversion\" to \"series conversion days71\".",
    "created_at": "2016-03-21T15:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207202",
    "user": "maurimo"
}
```

Changing keywords from "series conversion" to "series conversion days71".



---

archive/issue_comments_207203.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-03-21T16:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207203",
    "user": "rws"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_207204.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-03-21T16:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207204",
    "user": "rws"
}
```

New commits:



---

archive/issue_comments_207205.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-03-21T16:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207205",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207206.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-03-27T09:28:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207206",
    "user": "mmezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207207.json:
```json
{
    "body": "Thanks!",
    "created_at": "2016-03-27T12:41:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207207",
    "user": "rws"
}
```

Thanks!



---

archive/issue_comments_207208.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-03-28T07:24:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15966",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15966#issuecomment-207208",
    "user": "vbraun"
}
```

Resolution: fixed
