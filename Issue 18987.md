# Issue 18987: swtich OA(k,n)+* strongly regular graphs

archive/issues_018987.json:
```json
{
    "body": "CC:  dimpase\n\nThis branch adds the \"switch OA(k,n)+*\" graphs used in Andries Brouwer's database.\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/19224\n\n",
    "created_at": "2015-09-16T13:25:29Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "title": "swtich OA(k,n)+* strongly regular graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18987",
    "user": "ncohen"
}
```
CC:  dimpase

This branch adds the "switch OA(k,n)+*" graphs used in Andries Brouwer's database.

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/19224





---

archive/issue_comments_260444.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-09-16T13:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260444",
    "user": "ncohen"
}
```

New commits:



---

archive/issue_comments_260445.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-09-16T13:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260445",
    "user": "ncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_260446.json:
```json
{
    "body": "Hello,\n\n1. You wrote\n\n```\nfrom math import sqrt\ncdef int n = int(sqrt(n_2_p_1-1))\n```\n\n  Sage integers do have a method `sqrtrem` that gives you the square root and the rest\n\n```\nsage: x = ZZ.random_element(0,10000)\nsage: s,r = x.sqrtrem()\nsage: x == s**2 + r\nTrue\n```\n\n  But as you are using int from Cython you would better use standard C functions\n\n```\nfrom libc.math cimport sqrt, floor\n```\n\n\n2. Why are you testing withtout the option `resolvable=True`\n\n```\nif (k % n          or\n   ...\n   not orthogonal_array(c+1,n,existence=True)):\n      return None\n```\n\n  while using in the function\n\n```\ndef switch_OA_srg(c,n):\n    ...\n    OA = map(tuple, orthogonal_array(c+1,n,resolvable=True))\n    ...\n```\n\n\n3. Use better spacings: `int v,int k,int l` -> `int v, int k, int l`.\n\n4. Do you mind moving out the function `switch_OA_srg` into a global function? With such local definition you are generating again and again different Python functions with the very same code\n\n```\nsage: f1 = is_switch_OA_srg(290, 136, 63, 64)[0]\nsage: f2 = is_switch_OA_srg(290, 136, 63, 64)[0]\nsage: f1 is f2\nFalse\n```\n\n\n5. Could you add an example of a SRG that was not available before?\n\nVincent",
    "created_at": "2015-09-19T03:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260446",
    "user": "vdelecroix"
}
```

Hello,

1. You wrote

```
from math import sqrt
cdef int n = int(sqrt(n_2_p_1-1))
```

  Sage integers do have a method `sqrtrem` that gives you the square root and the rest

```
sage: x = ZZ.random_element(0,10000)
sage: s,r = x.sqrtrem()
sage: x == s**2 + r
True
```

  But as you are using int from Cython you would better use standard C functions

```
from libc.math cimport sqrt, floor
```


2. Why are you testing withtout the option `resolvable=True`

```
if (k % n          or
   ...
   not orthogonal_array(c+1,n,existence=True)):
      return None
```

  while using in the function

```
def switch_OA_srg(c,n):
    ...
    OA = map(tuple, orthogonal_array(c+1,n,resolvable=True))
    ...
```


3. Use better spacings: `int v,int k,int l` -> `int v, int k, int l`.

4. Do you mind moving out the function `switch_OA_srg` into a global function? With such local definition you are generating again and again different Python functions with the very same code

```
sage: f1 = is_switch_OA_srg(290, 136, 63, 64)[0]
sage: f2 = is_switch_OA_srg(290, 136, 63, 64)[0]
sage: f1 is f2
False
```


5. Could you add an example of a SRG that was not available before?

Vincent



---

archive/issue_comments_260447.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-19T03:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260447",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_260448.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-19T06:55:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260448",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_260449.json:
```json
{
    "body": "Hello,\n\n> 1. You wrote\n> {{{\n> from math import sqrt\n> cdef int n = int(sqrt(n_2_p_1-1))\n> }}}\n\nI did that because sqrt(-4) raises an exception, while in C floor(-a) returns nan. I prefer this behaviour when I do not need the speed. As a reviewer, your job is to make sure that the code is correct an reliable, properly documented etc. These kind of comments are to me a matter of taste, and it would be cool if you proposed a commit rather than include as part of your review that the way it is done does not conform to your taste. As there isn't, I believe, any reason to prefer yours over mine in this context where the speed difference does not matter.\n\n> 2. Why are you testing withtout the option `resolvable=True`\n\nThat's a mistake indeed.\n\n> 3. Use better spacings: `int v,int k,int l` -> `int v, int k, int l`.\n\nAs previously, please propose a commit the next time you cannot tolerate a missing space.\n\n> 4. Do you mind moving out the function `switch_OA_srg` into a global function? With such local definition you are generating again and again different Python functions with the very same code\n\nIt is not that I would mind, but mostly that I would not know how to write its documentation to my taste. The subfunction takes `c` and `n`  as parameters, whose role has to be explained. Plus 'c' is actually used twice in the function in \"different ways\" (it has two different meanings in the construction), so that the independent function should probably differenciate the two uses of 'c' instead of tying them to be equal (and I have no use for that generalization). The result would be unclear, look hardcoded, and the name of the function is hard to pick too as this class does not seem very standard.\n\nMore technically, I could not care less about returning functions which are not equal to each other. My job here is to build new graphs.\n\n> 5. Could you add an example of a SRG that was not available before?\n\nWhat about the 4 that already appear in the doctest?\n\nNathann",
    "created_at": "2015-09-19T07:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260449",
    "user": "ncohen"
}
```

Hello,

> 1. You wrote
> {{{
> from math import sqrt
> cdef int n = int(sqrt(n_2_p_1-1))
> }}}

I did that because sqrt(-4) raises an exception, while in C floor(-a) returns nan. I prefer this behaviour when I do not need the speed. As a reviewer, your job is to make sure that the code is correct an reliable, properly documented etc. These kind of comments are to me a matter of taste, and it would be cool if you proposed a commit rather than include as part of your review that the way it is done does not conform to your taste. As there isn't, I believe, any reason to prefer yours over mine in this context where the speed difference does not matter.

> 2. Why are you testing withtout the option `resolvable=True`

That's a mistake indeed.

> 3. Use better spacings: `int v,int k,int l` -> `int v, int k, int l`.

As previously, please propose a commit the next time you cannot tolerate a missing space.

> 4. Do you mind moving out the function `switch_OA_srg` into a global function? With such local definition you are generating again and again different Python functions with the very same code

It is not that I would mind, but mostly that I would not know how to write its documentation to my taste. The subfunction takes `c` and `n`  as parameters, whose role has to be explained. Plus 'c' is actually used twice in the function in "different ways" (it has two different meanings in the construction), so that the independent function should probably differenciate the two uses of 'c' instead of tying them to be equal (and I have no use for that generalization). The result would be unclear, look hardcoded, and the name of the function is hard to pick too as this class does not seem very standard.

More technically, I could not care less about returning functions which are not equal to each other. My job here is to build new graphs.

> 5. Could you add an example of a SRG that was not available before?

What about the 4 that already appear in the doctest?

Nathann



---

archive/issue_comments_260450.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-20T20:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260450",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_260451.json:
```json
{
    "body": "Replying to [comment:4 ncohen]:\n> > 5. Could you add an example of a SRG that was not available before?\n> \n> What about the 4 that already appear in the doctest?\n\nI meant in the function `graphs.strongly_regular_graphs`.\n\nVincent",
    "created_at": "2015-09-20T20:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260451",
    "user": "vdelecroix"
}
```

Replying to [comment:4 ncohen]:
> > 5. Could you add an example of a SRG that was not available before?
> 
> What about the 4 that already appear in the doctest?

I meant in the function `graphs.strongly_regular_graphs`.

Vincent



---

archive/issue_comments_260452.json:
```json
{
    "body": "Do you mean that you want a doctest that checks that the new srg is available through the general constructor (like we did for designs)?\n\nNathann",
    "created_at": "2015-09-20T20:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260452",
    "user": "ncohen"
}
```

Do you mean that you want a doctest that checks that the new srg is available through the general constructor (like we did for designs)?

Nathann



---

archive/issue_comments_260453.json:
```json
{
    "body": "Replying to [comment:7 ncohen]:\n> Do you mean that you want a doctest that checks that the new srg is available through the general constructor (like we did for designs)?\n\nYes, would be good to check that the construction is actually useful...\n\n```\nsage: graphs.strongly_regular_graph(my_new_parameters)\n!Got one!\n```\n",
    "created_at": "2015-09-20T20:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260453",
    "user": "vdelecroix"
}
```

Replying to [comment:7 ncohen]:
> Do you mean that you want a doctest that checks that the new srg is available through the general constructor (like we did for designs)?

Yes, would be good to check that the construction is actually useful...

```
sage: graphs.strongly_regular_graph(my_new_parameters)
!Got one!
```




---

archive/issue_comments_260454.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-20T20:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260454",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_260455.json:
```json
{
    "body": "you do not test anywhere that graphs you construct in this functions are SRGs with parameters you claim they will have. IMHO such tests must be present.",
    "created_at": "2015-09-24T17:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260455",
    "user": "dimpase"
}
```

you do not test anywhere that graphs you construct in this functions are SRGs with parameters you claim they will have. IMHO such tests must be present.



---

archive/issue_comments_260456.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-24T17:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260456",
    "user": "dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_260457.json:
```json
{
    "body": "I do in the doctest that builds the SRG by calling `graphs.strongly_regular_graph` (remember that it checks its output). Before, I had the usual \"build the graph + test\" doctest, but Vincent wanted me to query the general constructor instead.\n\nSo well, this doctest actually builds the graph and tests it. Like the one that was there before it.\n\nNathann",
    "created_at": "2015-09-24T18:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260457",
    "user": "ncohen"
}
```

I do in the doctest that builds the SRG by calling `graphs.strongly_regular_graph` (remember that it checks its output). Before, I had the usual "build the graph + test" doctest, but Vincent wanted me to query the general constructor instead.

So well, this doctest actually builds the graph and tests it. Like the one that was there before it.

Nathann



---

archive/issue_comments_260458.json:
```json
{
    "body": "Replying to [comment:11 ncohen]:\n> I do in the doctest that builds the SRG by calling `graphs.strongly_regular_graph` (remember that it checks its output). Before, I had the usual \"build the graph + test\" doctest, but Vincent wanted me to query the general constructor instead.\n> \n> So well, this doctest actually builds the graph and tests it. Like the one that was there before it.\n\nit does not strike me as a reliable way to test; if the implementation of `graphs.strongly_regular_graph` changes, you'd be SOL. And testing only one tuple of parameters looks a bit too weak, too...",
    "created_at": "2015-09-24T18:19:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260458",
    "user": "dimpase"
}
```

Replying to [comment:11 ncohen]:
> I do in the doctest that builds the SRG by calling `graphs.strongly_regular_graph` (remember that it checks its output). Before, I had the usual "build the graph + test" doctest, but Vincent wanted me to query the general constructor instead.
> 
> So well, this doctest actually builds the graph and tests it. Like the one that was there before it.

it does not strike me as a reliable way to test; if the implementation of `graphs.strongly_regular_graph` changes, you'd be SOL. And testing only one tuple of parameters looks a bit too weak, too...



---

archive/issue_comments_260459.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-24T18:25:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260459",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_260460.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-24T18:25:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260460",
    "user": "ncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_260461.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-09-24T19:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260461",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_260462.json:
```json
{
    "body": "OK",
    "created_at": "2015-09-24T19:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260462",
    "user": "dimpase"
}
```

OK



---

archive/issue_comments_260463.json:
```json
{
    "body": "Reviewer name",
    "created_at": "2015-10-11T09:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260463",
    "user": "vbraun"
}
```

Reviewer name



---

archive/issue_comments_260464.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-11T09:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260464",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_260465.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-10-11T09:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260465",
    "user": "ncohen"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_260466.json:
```json
{
    "body": "Dima. Please.. `-_-`",
    "created_at": "2015-10-11T09:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260466",
    "user": "ncohen"
}
```

Dima. Please.. `-_-`



---

archive/issue_comments_260467.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-12T07:16:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18987",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18987#issuecomment-260467",
    "user": "vbraun"
}
```

Resolution: fixed
