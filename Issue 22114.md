# Issue 22114: PyString_AsString is gone in Python3

archive/issues_022114.json:
```json
{
    "body": "CC:  chapoton\n\nThe function `PyString_AsString` no longer exists in Python 3 and even Cython does not support it.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22351\n\n",
    "created_at": "2017-02-10T22:09:26Z",
    "labels": [
        "python3",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "PyString_AsString is gone in Python3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22114",
    "user": "jdemeyer"
}
```
CC:  chapoton

The function `PyString_AsString` no longer exists in Python 3 and even Cython does not support it.

Issue created by migration from https://trac.sagemath.org/ticket/22351





---

archive/issue_comments_307229.json:
```json
{
    "body": "Any idea of what to do here ?\n\nJust replacing `PyString_*` by `PyBytes_*` does not work.",
    "created_at": "2017-02-20T16:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307229",
    "user": "chapoton"
}
```

Any idea of what to do here ?

Just replacing `PyString_*` by `PyBytes_*` does not work.



---

archive/issue_comments_307230.json:
```json
{
    "body": "Here is a tentative.\n----\nNew commits:",
    "created_at": "2017-02-21T12:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307230",
    "user": "chapoton"
}
```

Here is a tentative.
----
New commits:



---

archive/issue_comments_307231.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-02-21T12:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307231",
    "user": "chapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_307232.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-02-21T12:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307232",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_307233.json:
```json
{
    "body": "I removed the changes to `pynac.pyx` to avoid a conflict with #21371.\n----\nNew commits:",
    "created_at": "2017-02-21T16:55:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307233",
    "user": "jdemeyer"
}
```

I removed the changes to `pynac.pyx` to avoid a conflict with #21371.
----
New commits:



---

archive/issue_comments_307234.json:
```json
{
    "body": "ok, agreed.\n\nBot is green, do you think this ticket is now ok ?",
    "created_at": "2017-02-22T08:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307234",
    "user": "chapoton"
}
```

ok, agreed.

Bot is green, do you think this ticket is now ok ?



---

archive/issue_comments_307235.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-02-22T09:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307235",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_307236.json:
```json
{
    "body": "No, let me clean some stuff up. I will do that right now.",
    "created_at": "2017-02-22T09:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307236",
    "user": "jdemeyer"
}
```

No, let me clean some stuff up. I will do that right now.



---

archive/issue_comments_307237.json:
```json
{
    "body": "`matrix_gfpn_dense.pyx` needs further changes and will conflict with #21437. I will instead add a comment on #21437.",
    "created_at": "2017-02-22T09:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307237",
    "user": "jdemeyer"
}
```

`matrix_gfpn_dense.pyx` needs further changes and will conflict with #21437. I will instead add a comment on #21437.



---

archive/issue_comments_307238.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-02-22T09:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307238",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_307239.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-02-22T09:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307239",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_307240.json:
```json
{
    "body": "I tried to get rid of some calls to `PyBytes_...` functions. Please review. I have not ran the testsuite, so let's wait for the patchbot.",
    "created_at": "2017-02-22T10:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307240",
    "user": "jdemeyer"
}
```

I tried to get rid of some calls to `PyBytes_...` functions. Please review. I have not ran the testsuite, so let's wait for the patchbot.



---

archive/issue_comments_307241.json:
```json
{
    "body": "Looks good to me, and the bot is green. Shall we set to positive ?\n\nBy the way, did you handle the pynac case in #21371 ?",
    "created_at": "2017-02-22T20:13:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307241",
    "user": "chapoton"
}
```

Looks good to me, and the bot is green. Shall we set to positive ?

By the way, did you handle the pynac case in #21371 ?



---

archive/issue_comments_307242.json:
```json
{
    "body": "Replying to [comment:15 chapoton]:\n> By the way, did you handle the pynac case in #21371 ?\n\nYes.",
    "created_at": "2017-02-23T06:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307242",
    "user": "jdemeyer"
}
```

Replying to [comment:15 chapoton]:
> By the way, did you handle the pynac case in #21371 ?

Yes.



---

archive/issue_comments_307243.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-02-23T06:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307243",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_307244.json:
```json
{
    "body": "Merge conflict...",
    "created_at": "2017-02-23T13:42:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307244",
    "user": "vbraun"
}
```

Merge conflict...



---

archive/issue_comments_307245.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-02-23T13:42:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307245",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_307246.json:
```json
{
    "body": "trivial rebase on 7.6.b5, setting back to positive\n----\nNew commits:",
    "created_at": "2017-02-26T20:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307246",
    "user": "chapoton"
}
```

trivial rebase on 7.6.b5, setting back to positive
----
New commits:



---

archive/issue_comments_307247.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-02-26T20:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307247",
    "user": "chapoton"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_307248.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-01T18:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22114",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22114#issuecomment-307248",
    "user": "vbraun"
}
```

Resolution: fixed
