# Issue 13796: Speedup in GenericGraph.relabel() and two new options

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2013-01-23 17:10:21

Assignee: jason, ncohen, rlm

CC:  stumpc5 chapoton

Because of some weird graphs built by ennemies of The Good Graph People, it seems that most of the work done by GenericGraph.relabel() is totally useless.
This patch adds two optional arguments to this method, which let the users enable/disable tests.

Nathann


---

Attachment


---

Comment by ncohen created at 2013-01-23 17:12:44

Changing status from new to needs_review.


---

Comment by aschilling created at 2013-02-22 21:18:04

Nathann, you need to put in some tests that show how the code works with the new inputs set to False. Also, please post a timing comparison before and after the patch.

Thanks,

Anne


---

Comment by ncohen created at 2013-02-22 21:55:54

`O_o`

Well... The code works the same way. It just does not check some things internally... The output does not change `O_o`

Nathann


---

Comment by aschilling created at 2013-02-22 22:06:19

I know, but it is still good to put in a test that checks that it works the same ;-)

Replying to [comment:3 ncohen]:
> `O_o`
> 
> Well... The code works the same way. It just does not check some things internally... The output does not change `O_o`
> 
> Nathann


---

Comment by ncohen created at 2013-02-22 22:07:03

Yep yep I'm doing it right now, but the point is that I am not totally sure that it does not produce a memory leak somewhere `O_o`

Nathann


---

Attachment


---

Comment by ncohen created at 2013-02-22 22:11:10

A timing, just for the show :

Before :

```
sage: g = graphs.KneserGraph(11,4)
sage: %time g.relabel()           
CPU times: user 0.37 s, sys: 0.00 s, total: 0.37 s
Wall time: 0.37 s
```


After :

```
sage: g = graphs.KneserGraph(11,4)
sage: %time g.relabel()           
CPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s
Wall time: 0.01 s
```


Ready for review again ! `;-)`

Nathann


---

Comment by aschilling created at 2013-02-23 15:22:29

Changing keywords from "" to "graphs, relabelling".


---

Comment by aschilling created at 2013-02-23 15:24:31

Replying to [comment:5 ncohen]:
> Yep yep I'm doing it right now, but the point is that I am not totally sure that it does not produce a memory leak somewhere `O_o`

What does this mean? Do you mean disabling the option is at the user's own risk?


---

Comment by ncohen created at 2013-02-23 15:27:51

> What does this mean? Do you mean disabling the option is at the user's own risk?

Precisely ! I wrote that in the doctest itself :

"Checking that all vertices have an image can require some time, and this feature can be disabled (at your own risk)"

If you "rename" the vertices of a graph in such a way that two vertices end up having the same name at the end of the procedure, I can totally imagine that some data will be lost on the way `:-P`

Nathann


---

Comment by aschilling created at 2013-02-23 15:28:57

Ok, then I am happy with your patch!

Anne


---

Comment by aschilling created at 2013-02-23 15:29:11

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2013-02-23 15:31:24

> Ok, then I am happy with your patch!

Cool. Thanks for reviewing it ! `:-D`

Nathann


---

Comment by jdemeyer created at 2013-02-28 10:34:29

Resolution: fixed
