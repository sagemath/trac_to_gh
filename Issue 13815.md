# Issue 13815: equality is broken for Posets

archive/issues_013815.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  @hivert @nthiery nborie vivianepons @fchapoton @anneschilling stumpc5 @jm58660\n\nPlain and simple :\n\n\n```\nsage: d = DiGraph({2:[1],3:[1]})                                                                                                                                                   \nsage: p1 = Poset(d, linear_extension = [1,2,3])                                                                                                                                    \nsage: p2 = p1.relabel({1:1,2:3,3:2})                                                                                                                                               \nsage: p1.hasse_diagram() == p1.hasse_diagram()                                                                                                                                     \nTrue                                                                                                                                                                               \nsage: p1 == p2                                                                                                                                                                     \nFalse                                                                                                                                                                               \n```\n\n\nThis can be fixed by saying that two posets are equal if their hasse diagrams are equal, as it should have been since the beginning.\n\nThis will probably make poset equality much slower. On the bright side it will work correctly.\n\nOf course this patch could have been almost trivial, but there is in the FinitePoset class a \"key\" argument, whose purpose is to make two posets different if they have different keys. So this patch checks that too.\n\nAnd the next time that somebody will need to store pairs \"(a poset, a key)\", the best will be to store pairs \"(a poset, a key)\". And not \"A poset with a key included inside, which is useful just for my own code\" as one could easily believe.\n\nOh. And the same with linear orderings, of course.\n\nNathann\n\nIssue created by migration from https://trac.sagemath.org/ticket/14019\n\n",
    "created_at": "2013-01-26T15:28:37Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "equality is broken for Posets",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13815",
    "user": "https://github.com/nathanncohen"
}
```
Assignee: sage-combinat

CC:  @hivert @nthiery nborie vivianepons @fchapoton @anneschilling stumpc5 @jm58660

Plain and simple :


```
sage: d = DiGraph({2:[1],3:[1]})                                                                                                                                                   
sage: p1 = Poset(d, linear_extension = [1,2,3])                                                                                                                                    
sage: p2 = p1.relabel({1:1,2:3,3:2})                                                                                                                                               
sage: p1.hasse_diagram() == p1.hasse_diagram()                                                                                                                                     
True                                                                                                                                                                               
sage: p1 == p2                                                                                                                                                                     
False                                                                                                                                                                               
```


This can be fixed by saying that two posets are equal if their hasse diagrams are equal, as it should have been since the beginning.

This will probably make poset equality much slower. On the bright side it will work correctly.

Of course this patch could have been almost trivial, but there is in the FinitePoset class a "key" argument, whose purpose is to make two posets different if they have different keys. So this patch checks that too.

And the next time that somebody will need to store pairs "(a poset, a key)", the best will be to store pairs "(a poset, a key)". And not "A poset with a key included inside, which is useful just for my own code" as one could easily believe.

Oh. And the same with linear orderings, of course.

Nathann

Issue created by migration from https://trac.sagemath.org/ticket/14019





---

archive/issue_comments_171403.json:
```json
{
    "body": "Oh, yeah. And this patch also fixes this :\n\n\n```\ndef hasse_diagram(self, wrapped = True):\n    return DiGraph(self._hasse_diagram).relabel(self._list, inplace = False)\n```\n\n\nCombinat-Style.\n\nNathann",
    "created_at": "2013-01-26T15:36:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171403",
    "user": "https://github.com/nathanncohen"
}
```

Oh, yeah. And this patch also fixes this :


```
def hasse_diagram(self, wrapped = True):
    return DiGraph(self._hasse_diagram).relabel(self._list, inplace = False)
```


Combinat-Style.

Nathann



---

archive/issue_comments_171404.json:
```json
{
    "body": "fixed by removing the useless keyword (it is useless, as it cannot be used and hence has never been). Casting the `HasseDiagram` to a digraph first is useless copy, as relabeling with `inplace = False` already makes a copy.\n\nAnd also because for some reason, up to now, a call to `.hasse_diagram()` returned a `DiGraph` and not a `HasseDiagram` object.\n\nNathann",
    "created_at": "2013-01-26T15:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171404",
    "user": "https://github.com/nathanncohen"
}
```

fixed by removing the useless keyword (it is useless, as it cannot be used and hence has never been). Casting the `HasseDiagram` to a digraph first is useless copy, as relabeling with `inplace = False` already makes a copy.

And also because for some reason, up to now, a call to `.hasse_diagram()` returned a `DiGraph` and not a `HasseDiagram` object.

Nathann



---

archive/issue_comments_171405.json:
```json
{
    "body": "Yeahhhhhhhhhhhhh.....\n\n\n```\ndef __eq__(self, other):\n     return self.hasse_diagram() == other.hasse_diagram()\n```\n\n\nResult :\n\n\n```\n      ...\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/combinat/posets/posets.py\", line 826, in __eq__\n        return ((self.hasse_diagram() == other.hasse_diagram()) and\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/generic_graph.py\", line 432, in __eq__\n        if self.vertices() != other.vertices():\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/combinat/posets/elements.py\", line 116, in __eq__\n        return have_same_parent(self, other) \\\n      File \"sage_object.pyx\", line 700, in sage.structure.sage_object.have_same_parent (sage/structure/sage_object.c:8386)\n      File \"/home/ncohen/.Sage/local/lib/python/site-packages/sage/combinat/posets/posets.py\", line 826, in __eq__\n        return ((self.hasse_diagram() == other.hasse_diagram()) and\n      ...\n      RuntimeError: maximum recursion depth exceeded\n```\n\n\nCategories strike again.\n\nNathann",
    "created_at": "2013-01-26T15:56:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171405",
    "user": "https://github.com/nathanncohen"
}
```

Yeahhhhhhhhhhhhh.....


```
def __eq__(self, other):
     return self.hasse_diagram() == other.hasse_diagram()
```


Result :


```
      ...
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/combinat/posets/posets.py", line 826, in __eq__
        return ((self.hasse_diagram() == other.hasse_diagram()) and
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/graphs/generic_graph.py", line 432, in __eq__
        if self.vertices() != other.vertices():
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/combinat/posets/elements.py", line 116, in __eq__
        return have_same_parent(self, other) \
      File "sage_object.pyx", line 700, in sage.structure.sage_object.have_same_parent (sage/structure/sage_object.c:8386)
      File "/home/ncohen/.Sage/local/lib/python/site-packages/sage/combinat/posets/posets.py", line 826, in __eq__
        return ((self.hasse_diagram() == other.hasse_diagram()) and
      ...
      RuntimeError: maximum recursion depth exceeded
```


Categories strike again.

Nathann



---

archive/issue_comments_171406.json:
```json
{
    "body": "\n```\nreturn ((DiGraph.__eq__(self.hasse_diagram(), other.hasse_diagram()))\n```\n\n\nSame result.",
    "created_at": "2013-01-26T16:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171406",
    "user": "https://github.com/nathanncohen"
}
```


```
return ((DiGraph.__eq__(self.hasse_diagram(), other.hasse_diagram()))
```


Same result.



---

archive/issue_comments_171407.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2013-01-26T16:21:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171407",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_171408.json:
```json
{
    "body": "Ok guys, you did it, I have no way to write a new `__eq__` method in `Poset` which is not \"self is other\" without getting an infinite loop. \n\nIf I want to actually compare the data of the posets (hasse diagram, vertices), then  comparing the data will raise a call to compare their parents, and I'm gone for another loop.\n\nNow what ?\n\nNathann",
    "created_at": "2013-01-26T16:21:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171408",
    "user": "https://github.com/nathanncohen"
}
```

Ok guys, you did it, I have no way to write a new `__eq__` method in `Poset` which is not "self is other" without getting an infinite loop. 

If I want to actually compare the data of the posets (hasse diagram, vertices), then  comparing the data will raise a call to compare their parents, and I'm gone for another loop.

Now what ?

Nathann



---

archive/issue_comments_171409.json:
```json
{
    "body": "Attachment [trac_14019.patch](tarball://root/attachments/some-uuid/ticket14019/trac_14019.patch) by @anneschilling created at 2013-01-26 16:26:09\n\nWe discussed this at the Sage Days last week (unfortunately you were not there). The best way might be to have an option in Posets which would allow to create posets with and without an attached linear extension. Your use case would be in the new default case of no linear extension attached.\n\nBest,\n\nAnne",
    "created_at": "2013-01-26T16:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171409",
    "user": "https://github.com/anneschilling"
}
```

Attachment [trac_14019.patch](tarball://root/attachments/some-uuid/ticket14019/trac_14019.patch) by @anneschilling created at 2013-01-26 16:26:09

We discussed this at the Sage Days last week (unfortunately you were not there). The best way might be to have an option in Posets which would allow to create posets with and without an attached linear extension. Your use case would be in the new default case of no linear extension attached.

Best,

Anne



---

archive/issue_comments_171410.json:
```json
{
    "body": "> We discussed this at the Sage Days last week (unfortunately you were not there).\n\nI'm pretty sure that I was, but I admittedly have a very poor memory.\n\n> The best way might be to have an option in Posets which would allow to create posets with and without an attached linear extension.\n\nAnd the one without fancy stuff would be the default Poset.\n\n> Your use case would be in the new default case of no linear extension attached.\n\nMy use case is the definition of what a Poset is. In any book. Also, do we overlook the fact that this is a conceptual problem of categories, and equalities, an parents, and all that stuff ?\n\nNathann",
    "created_at": "2013-01-26T16:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171410",
    "user": "https://github.com/nathanncohen"
}
```

> We discussed this at the Sage Days last week (unfortunately you were not there).

I'm pretty sure that I was, but I admittedly have a very poor memory.

> The best way might be to have an option in Posets which would allow to create posets with and without an attached linear extension.

And the one without fancy stuff would be the default Poset.

> Your use case would be in the new default case of no linear extension attached.

My use case is the definition of what a Poset is. In any book. Also, do we overlook the fact that this is a conceptual problem of categories, and equalities, an parents, and all that stuff ?

Nathann



---

archive/issue_comments_171411.json:
```json
{
    "body": "Quotes from posets.py\n\n\n```\n            # We need to relabel the digraph since range(self._n) must be a linear                                                                                                             \n            # extension. Too bad we need to compute this again. TODO: Fix this.  \n```\n\n\nNathann",
    "created_at": "2013-01-26T17:01:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171411",
    "user": "https://github.com/nathanncohen"
}
```

Quotes from posets.py


```
            # We need to relabel the digraph since range(self._n) must be a linear                                                                                                             
            # extension. Too bad we need to compute this again. TODO: Fix this.  
```


Nathann



---

archive/issue_comments_171412.json:
```json
{
    "body": "Hi Nathann,\n\nReplying to [comment:9 ncohen]:\n> > We discussed this at the Sage Days last week (unfortunately you were not there).\n> \n> I'm pretty sure that I was, but I admittedly have a very poor memory.\n\nThe discussion continued later.\n\n> > Your use case would be in the new default case of no linear extension attached.\n>\n> My use case is the definition of what a Poset is. In any book.\n\nObviously. We all agree that this is the rationale for the new default\nvalue.\n\n> Also, do we overlook the fact that this is a conceptual problem of\n> categories, and equalities, an parents, and all that stuff ?\n\nThis has nothing to do with categories. This is a consequence of the\nchoice of having unique representation for posets. The constructor\nshould do the right thing and then equality be simply tested by \"is\".\n\nNow if you would not mind stopping spreading FUD on unrelated things\nfor no reason except that you happen to not need them yourself, \u00ab\u00e7a\nnous ferait des vacances\u00bb.\n\nCheers,\n                             Nicolas",
    "created_at": "2013-01-26T18:06:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171412",
    "user": "https://github.com/nthiery"
}
```

Hi Nathann,

Replying to [comment:9 ncohen]:
> > We discussed this at the Sage Days last week (unfortunately you were not there).
> 
> I'm pretty sure that I was, but I admittedly have a very poor memory.

The discussion continued later.

> > Your use case would be in the new default case of no linear extension attached.
>
> My use case is the definition of what a Poset is. In any book.

Obviously. We all agree that this is the rationale for the new default
value.

> Also, do we overlook the fact that this is a conceptual problem of
> categories, and equalities, an parents, and all that stuff ?

This has nothing to do with categories. This is a consequence of the
choice of having unique representation for posets. The constructor
should do the right thing and then equality be simply tested by "is".

Now if you would not mind stopping spreading FUD on unrelated things
for no reason except that you happen to not need them yourself, «ça
nous ferait des vacances».

Cheers,
                             Nicolas



---

archive/issue_comments_171413.json:
```json
{
    "body": "> Obviously. We all agree that this is the rationale for the new default\n> value.\n\nJust to make sure everybody accepts that code will be broken.\n\n> This has nothing to do with categories. This is a consequence of the\n> choice of having unique representation for posets. The constructor\n> should do the right thing and then equality be simply tested by \"is\".\n\nNice. Now, if I have a class that I define myself which contains elements which belong to the category framework : does it mean that this class has to be `UniqueRepresentation` ? That seems to be the source of my problem above.\n\n> Now if you would not mind stopping spreading FUD on unrelated things\n> for no reason except that you happen to not need them yourself, \u00ab\u00e7a\n> nous ferait des vacances\u00bb.\n\nFix the bugs you introduce and we have a deal. How do I break out of this infinite loop ?\n\nNathann",
    "created_at": "2013-01-26T18:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171413",
    "user": "https://github.com/nathanncohen"
}
```

> Obviously. We all agree that this is the rationale for the new default
> value.

Just to make sure everybody accepts that code will be broken.

> This has nothing to do with categories. This is a consequence of the
> choice of having unique representation for posets. The constructor
> should do the right thing and then equality be simply tested by "is".

Nice. Now, if I have a class that I define myself which contains elements which belong to the category framework : does it mean that this class has to be `UniqueRepresentation` ? That seems to be the source of my problem above.

> Now if you would not mind stopping spreading FUD on unrelated things
> for no reason except that you happen to not need them yourself, «ça
> nous ferait des vacances».

Fix the bugs you introduce and we have a deal. How do I break out of this infinite loop ?

Nathann



---

archive/issue_comments_171414.json:
```json
{
    "body": "Replying to [comment:13 ncohen]:\n> > Obviously. We all agree that this is the rationale for the new default\n> > value.\n> \n> Just to make sure everybody accepts that code will be broken.\n\nPlease reread. The new default is what we both agree on and is correct.\n\n> Nice. Now, if I have a class that I define myself which contains elements which belong to the category framework : does it mean that this class has to be `UniqueRepresentation` ?\n\nNo. Some parents don't have unique representation.\n\n> Fix the bugs you introduce and we have a deal.\n\nI did not introduce this bug. And anyway it's Chet's fault.\n\n> How do I break out of this infinite loop ?\n\nI know it's frustrating when one can't have an influence to improve the world. But in the case at hand the only step you can take is to stop wasting our time repeating the same things over and over.",
    "created_at": "2013-01-26T18:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171414",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:13 ncohen]:
> > Obviously. We all agree that this is the rationale for the new default
> > value.
> 
> Just to make sure everybody accepts that code will be broken.

Please reread. The new default is what we both agree on and is correct.

> Nice. Now, if I have a class that I define myself which contains elements which belong to the category framework : does it mean that this class has to be `UniqueRepresentation` ?

No. Some parents don't have unique representation.

> Fix the bugs you introduce and we have a deal.

I did not introduce this bug. And anyway it's Chet's fault.

> How do I break out of this infinite loop ?

I know it's frustrating when one can't have an influence to improve the world. But in the case at hand the only step you can take is to stop wasting our time repeating the same things over and over.



---

archive/issue_comments_171415.json:
```json
{
    "body": "Helloooooooooooooo !!!\n\nOkayyyyyyyyyy, I just had a nice evening with Florent which had begun with a conversation about this patch, and he said that he'd have a patch for this one month from now.\n\nThis being said, I still have no answer for a problem with categories : you say that some parents do not have a unique representation, but here is the reason behind the infinite loop I got today :\n\n1) My Poset parent implements `__eq__` by first comparing the hasse diagrams, which leads to check that the elements of the digraph are equal.\n\n2) In order to know whether the elements are equal, the category mechanism makes them check that they have the same parents\n\n3) I check that the parents are equal again, and loop ...\n\nThat's why I asked whether Parents need to be UniqueRepresentation. Because if they aren't, they sure cannot compare their elements !\n\nNathann",
    "created_at": "2013-01-27T00:03:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171415",
    "user": "https://github.com/nathanncohen"
}
```

Helloooooooooooooo !!!

Okayyyyyyyyyy, I just had a nice evening with Florent which had begun with a conversation about this patch, and he said that he'd have a patch for this one month from now.

This being said, I still have no answer for a problem with categories : you say that some parents do not have a unique representation, but here is the reason behind the infinite loop I got today :

1) My Poset parent implements `__eq__` by first comparing the hasse diagrams, which leads to check that the elements of the digraph are equal.

2) In order to know whether the elements are equal, the category mechanism makes them check that they have the same parents

3) I check that the parents are equal again, and loop ...

That's why I asked whether Parents need to be UniqueRepresentation. Because if they aren't, they sure cannot compare their elements !

Nathann



---

archive/issue_comments_171416.json:
```json
{
    "body": "Generally, `==` should mean identical and not just isomorphic. Up to automorphism there is only one set of a given size. But surely we don't want all sets of fixed size to compare equal, right? \n\nAny two objects that satisfy `==` may be substituted for each other in cached method calls. \n\nIf you want \"isomorphic with possibly non-unique isomorphism\" then just implement a `is_isomorphic()` method.",
    "created_at": "2013-01-28T15:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171416",
    "user": "https://github.com/vbraun"
}
```

Generally, `==` should mean identical and not just isomorphic. Up to automorphism there is only one set of a given size. But surely we don't want all sets of fixed size to compare equal, right? 

Any two objects that satisfy `==` may be substituted for each other in cached method calls. 

If you want "isomorphic with possibly non-unique isomorphism" then just implement a `is_isomorphic()` method.



---

archive/issue_comments_171417.json:
```json
{
    "body": "There's nothing related to isomorphism in what I said. The same way that you expect that int(1) == Integer(1) is True, I would like that two posets that represent the very same partially ordered set be equal. This is totally linear, and consists in checking that i<j in one poset if and only if i<j in the other one. That's not an isomorphism, there is no relabeling involved.\n\nThis being said, I would like to have an answer to my question above. Not being able to define an `__eq__` function as you see fit because of the parent stuff looks to me like a problem.\n\nNathann",
    "created_at": "2013-01-28T15:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171417",
    "user": "https://github.com/nathanncohen"
}
```

There's nothing related to isomorphism in what I said. The same way that you expect that int(1) == Integer(1) is True, I would like that two posets that represent the very same partially ordered set be equal. This is totally linear, and consists in checking that i<j in one poset if and only if i<j in the other one. That's not an isomorphism, there is no relabeling involved.

This being said, I would like to have an answer to my question above. Not being able to define an `__eq__` function as you see fit because of the parent stuff looks to me like a problem.

Nathann



---

archive/issue_comments_171418.json:
```json
{
    "body": "> But surely we don't want all sets of fixed size to compare equal, right? \n\nAnd surely we don't want all Sage objects to be UniqueRepresentation.\n\nNathann",
    "created_at": "2013-01-28T16:05:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171418",
    "user": "https://github.com/nathanncohen"
}
```

> But surely we don't want all sets of fixed size to compare equal, right? 

And surely we don't want all Sage objects to be UniqueRepresentation.

Nathann



---

archive/issue_comments_171419.json:
```json
{
    "body": "(Answer from Nicolas Thiery, because trac is in a bad mood)\n\nReplying to [comment:15 ncohen]:\n> Okayyyyyyyyyy, I just had a nice evening with Florent which had begun with a conversation about this patch, and he said that he'd have a patch for this one month from now.\n\nExcellent :-)\n\n> This being said, I still have no answer for a problem with categories : you say that some parents do not have a unique representation, but here is the reason behind the infinite loop I got today :\n>\n> 1) My Poset parent implements `__eq__` by first comparing the hasse diagrams, which leads to check that the elements of the digraph are equal.\n> 2) In order to know whether the elements are equal, the category mechanism makes them check that they have the same parents\n> 3) I check that the parents are equal again, and loop ...\n>\n> That's why I asked whether Parents need to be UniqueRepresentation. Because if they aren't, they sure cannot compare their elements !\n\nOk, I get your point now.\n\nThat's a situation we never met before; parents not often compare\nthemselves by comparing (some of) their elements. When this is the\ncase, this probably means that those elements were part of the\ndefinition of the parent, and thus constructed from some data that\npreexisted the parent.\n\nTo break the loop, one could thus compare that data. In the case at\nhand, that would amount to compare the digraph that was use as input\nto the Poset constructor.\n\nEven if this occurred from time to time, I guess I would not see this\nas a recurrent problem of elements/parent, but of data structures with\nloops in general.\n\nCheers,\n                     Nicolas",
    "created_at": "2013-01-30T13:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171419",
    "user": "https://github.com/nathanncohen"
}
```

(Answer from Nicolas Thiery, because trac is in a bad mood)

Replying to [comment:15 ncohen]:
> Okayyyyyyyyyy, I just had a nice evening with Florent which had begun with a conversation about this patch, and he said that he'd have a patch for this one month from now.

Excellent :-)

> This being said, I still have no answer for a problem with categories : you say that some parents do not have a unique representation, but here is the reason behind the infinite loop I got today :
>
> 1) My Poset parent implements `__eq__` by first comparing the hasse diagrams, which leads to check that the elements of the digraph are equal.
> 2) In order to know whether the elements are equal, the category mechanism makes them check that they have the same parents
> 3) I check that the parents are equal again, and loop ...
>
> That's why I asked whether Parents need to be UniqueRepresentation. Because if they aren't, they sure cannot compare their elements !

Ok, I get your point now.

That's a situation we never met before; parents not often compare
themselves by comparing (some of) their elements. When this is the
case, this probably means that those elements were part of the
definition of the parent, and thus constructed from some data that
preexisted the parent.

To break the loop, one could thus compare that data. In the case at
hand, that would amount to compare the digraph that was use as input
to the Poset constructor.

Even if this occurred from time to time, I guess I would not see this
as a recurrent problem of elements/parent, but of data structures with
loops in general.

Cheers,
                     Nicolas



---

archive/issue_comments_171420.json:
```json
{
    "body": "What is the expected output of the following:\n\n```\nsage: d = DiGraph({2:[1],3:[1]})   \nsage: p1 = Poset(d)\nsage: p2 = p1.relabel({1:1,2:3,3:2})\nsage: p1[0] \n3\nsage: p2[0]\n2\nsage: @cached_function\n....: def first_element(poset): \n....:     return poset[0]\n....: \nsage: first_element(p1)\n3\nsage: first_element(p2)\n???\n```\n",
    "created_at": "2013-01-30T14:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171420",
    "user": "https://github.com/vbraun"
}
```

What is the expected output of the following:

```
sage: d = DiGraph({2:[1],3:[1]})   
sage: p1 = Poset(d)
sage: p2 = p1.relabel({1:1,2:3,3:2})
sage: p1[0] 
3
sage: p2[0]
2
sage: @cached_function
....: def first_element(poset): 
....:     return poset[0]
....: 
sage: first_element(p1)
3
sage: first_element(p2)
???
```




---

archive/issue_comments_171421.json:
```json
{
    "body": "Hi Nathann,\n\nI moved your patch over to git and I found a hack which stops the infinite loop: it turns out that posets have an attribute `_hasse_diagram` and checking this seems to be better for some (unknown) reason. A few of the doctests still fail:\n\n```\nsage -t posets.py\n**********************************************************************\nFile \"posets.py\", line 456, in sage.combinat.posets.posets.Poset\nFailed example:\n    P1 == P2\nExpected:\n    False\nGot:\n    True\n**********************************************************************\nFile \"posets.py\", line 838, in sage.combinat.posets.posets.FinitePoset.__eq__\nFailed example:\n    p3 == p1\nExpected:\n    False\nGot:\n    True\n**********************************************************************\nFile \"posets.py\", line 842, in sage.combinat.posets.posets.FinitePoset.__eq__\nFailed example:\n    p3 == p5\nExpected:\n    False\nGot:\n    True\n**********************************************************************\nFile \"posets.py\", line 1133, in sage.combinat.posets.posets.FinitePoset.hasse_diagram\nFailed example:\n    Q.hasse_diagram()\nExpected:\n    Hasse diagram of a poset containing 6 elements\nGot:\n    Digraph on 6 vertices\n**********************************************************************\n```\n\nI guess that the failing equality tests are bad, but I am happy that the infinite loop is gone.\n\nFlorent, Nicolas: it would be good if you could take some time to look at this too as this has been sitting around unloved for quite awhile.\n\nAndrew\n----\nNew commits:",
    "created_at": "2013-12-06T10:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171421",
    "user": "https://github.com/AndrewAtLarge"
}
```

Hi Nathann,

I moved your patch over to git and I found a hack which stops the infinite loop: it turns out that posets have an attribute `_hasse_diagram` and checking this seems to be better for some (unknown) reason. A few of the doctests still fail:

```
sage -t posets.py
**********************************************************************
File "posets.py", line 456, in sage.combinat.posets.posets.Poset
Failed example:
    P1 == P2
Expected:
    False
Got:
    True
**********************************************************************
File "posets.py", line 838, in sage.combinat.posets.posets.FinitePoset.__eq__
Failed example:
    p3 == p1
Expected:
    False
Got:
    True
**********************************************************************
File "posets.py", line 842, in sage.combinat.posets.posets.FinitePoset.__eq__
Failed example:
    p3 == p5
Expected:
    False
Got:
    True
**********************************************************************
File "posets.py", line 1133, in sage.combinat.posets.posets.FinitePoset.hasse_diagram
Failed example:
    Q.hasse_diagram()
Expected:
    Hasse diagram of a poset containing 6 elements
Got:
    Digraph on 6 vertices
**********************************************************************
```

I guess that the failing equality tests are bad, but I am happy that the infinite loop is gone.

Florent, Nicolas: it would be good if you could take some time to look at this too as this has been sitting around unloved for quite awhile.

Andrew
----
New commits:



---

archive/issue_comments_171422.json:
```json
{
    "body": "Hmm, not sure why the commit for #15479 is also on this ticket. Probably I screwed up and didn't branch off the master:(",
    "created_at": "2013-12-06T10:08:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171422",
    "user": "https://github.com/AndrewAtLarge"
}
```

Hmm, not sure why the commit for #15479 is also on this ticket. Probably I screwed up and didn't branch off the master:(



---

archive/issue_comments_171423.json:
```json
{
    "body": "Hmmmmmm... Must be because my original patch fixed several things, and two of these fixes are not compatible with each other : I also made `.hasse_diagram()` return a `HasseDiagram` object.\nIn the patch you imported with git, this modification is not made anymore. So you compare `DiGraph` objects, and not `HasseDiagram` objects. Perhaps it still works if you compare the results of `.hasse_diagram()` instead of `._hasse_diagram` directly.\n\nArggggggg ! No, I think I understood ! I think that it is incorrect to compare the `._hasse_diagram` digraphs, because they are always labelled with integers, so when you do that you do not compare the vertice' labels :\n\n\n```\nsage: list(posets.IntegerCompositions(3)) \n[[3], [1, 2], [2, 1], [1, 1, 1]]\nsage: list(posets.IntegerCompositions(3).hasse_diagram())\n[[3], [1, 2], [1, 1, 1], [2, 1]]\nsage: list(posets.IntegerCompositions(3)._hasse_diagram) \n[0, 1, 2, 3]\n```\n\n\nAnd of course as you compare digraphs defined on integers there is no problem, for they don't have parents. But it may say that two posets are equal even if they are defined on disjoint sets of elements.\n\nNathann",
    "created_at": "2013-12-06T11:47:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171423",
    "user": "https://github.com/nathanncohen"
}
```

Hmmmmmm... Must be because my original patch fixed several things, and two of these fixes are not compatible with each other : I also made `.hasse_diagram()` return a `HasseDiagram` object.
In the patch you imported with git, this modification is not made anymore. So you compare `DiGraph` objects, and not `HasseDiagram` objects. Perhaps it still works if you compare the results of `.hasse_diagram()` instead of `._hasse_diagram` directly.

Arggggggg ! No, I think I understood ! I think that it is incorrect to compare the `._hasse_diagram` digraphs, because they are always labelled with integers, so when you do that you do not compare the vertice' labels :


```
sage: list(posets.IntegerCompositions(3)) 
[[3], [1, 2], [2, 1], [1, 1, 1]]
sage: list(posets.IntegerCompositions(3).hasse_diagram())
[[3], [1, 2], [1, 1, 1], [2, 1]]
sage: list(posets.IntegerCompositions(3)._hasse_diagram) 
[0, 1, 2, 3]
```


And of course as you compare digraphs defined on integers there is no problem, for they don't have parents. But it may say that two posets are equal even if they are defined on disjoint sets of elements.

Nathann



---

archive/issue_comments_171424.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-12-06T14:11:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171424",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171425.json:
```json
{
    "body": "I have just undone my mistaken branching off #15479",
    "created_at": "2013-12-06T14:13:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171425",
    "user": "https://github.com/AndrewAtLarge"
}
```

I have just undone my mistaken branching off #15479



---

archive/issue_comments_171426.json:
```json
{
    "body": "Hello,\n\n20 months ago, I thought that this problem would be fixed in a month. Yesterday Jori created ticket #17051 which is a bug report, apparently linked with what this ticket was meant to address.\n\nToday is saturday. Unless somebody has a different way to solve the problem and is meaning to solve it during the week, I will create a ticket here that makes `.relabel()` return a Poset.\n\nYou cannot defend that Posets are both `UniqueRepresentation` and mutable. So `.relabel()` cannot change self. There will be no deprecation, for it is a bugfix.\n\nNathann",
    "created_at": "2014-09-27T10:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171426",
    "user": "https://github.com/nathanncohen"
}
```

Hello,

20 months ago, I thought that this problem would be fixed in a month. Yesterday Jori created ticket #17051 which is a bug report, apparently linked with what this ticket was meant to address.

Today is saturday. Unless somebody has a different way to solve the problem and is meaning to solve it during the week, I will create a ticket here that makes `.relabel()` return a Poset.

You cannot defend that Posets are both `UniqueRepresentation` and mutable. So `.relabel()` cannot change self. There will be no deprecation, for it is a bugfix.

Nathann



---

archive/issue_comments_171427.json:
```json
{
    "body": "`relabel()` does return a new poset. The issue is a little more subtle in regards to the ordering on the set of elements of the poset:\n\n```\nsage: list(p1)\n[3, 2, 1]\nsage: list(p2)\n[2, 3, 1]\n```\n\nbecause\n\n```\nsage: p1._elements\n(3, 2, 1)\nsage: p2._elements\n(2, 3, 1)\n```\n\nThat is why they don't compare as equal (as it is part of the construction data). The simplist change (FTR, I don't consider this to be a bug, but instead a lack of documentation) would be to make the Hasse diagram the only part of the construction info, however this would mean we'd have to relabel the Hasse diagram at construction time rather than when calling `hasse_diagram()`. This also has the drawback of not being able to use the same digraph for all relabelings of a poset, which is probably used by the linear extensions and creates a much larger memory usage (and data duplication).\n\nHopefully before you have gotten angry, I think better standardization could be used here too.\n\nI'm also not quite sure #17051 is because of this behavior, but I haven't really looked into it.",
    "created_at": "2014-09-27T13:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171427",
    "user": "https://github.com/tscrim"
}
```

`relabel()` does return a new poset. The issue is a little more subtle in regards to the ordering on the set of elements of the poset:

```
sage: list(p1)
[3, 2, 1]
sage: list(p2)
[2, 3, 1]
```

because

```
sage: p1._elements
(3, 2, 1)
sage: p2._elements
(2, 3, 1)
```

That is why they don't compare as equal (as it is part of the construction data). The simplist change (FTR, I don't consider this to be a bug, but instead a lack of documentation) would be to make the Hasse diagram the only part of the construction info, however this would mean we'd have to relabel the Hasse diagram at construction time rather than when calling `hasse_diagram()`. This also has the drawback of not being able to use the same digraph for all relabelings of a poset, which is probably used by the linear extensions and creates a much larger memory usage (and data duplication).

Hopefully before you have gotten angry, I think better standardization could be used here too.

I'm also not quite sure #17051 is because of this behavior, but I haven't really looked into it.



---

archive/issue_comments_171428.json:
```json
{
    "body": "Yo !\n\n> `relabel()` does return a new poset.\n\nOh, True, True, I had forgotten what exactly the problem was. Two years ago, after all `:-D`\n\nCool, then the interface will not even change.\n\n> The simplist change would be to make the Hasse diagram the only part of the construction info, however this would mean we'd have to relabel the Hasse diagram at construction time rather than when calling `hasse_diagram()`.\n\nIndeed.I will do just that.\n\n> This also has the drawback of not being able to use the same digraph for all relabelings of a poset, which is probably used by the linear extensions and creates a much larger memory usage (and data duplication).\n> \n> Hopefully before you have gotten angry, I think better standardization could be used here too.\n\nI was angry two years ago, because I was told that the problem would be fixed, and it was not. Jori had been doing a lot of work to fix/improve the poset class in the last two days, and I just don't want to tell him that this bug will stay because nobody is willing to make a move.\n\nI will write the branch that rewrites .relabel properly, and that will be all.\n\nNathann",
    "created_at": "2014-09-27T13:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171428",
    "user": "https://github.com/nathanncohen"
}
```

Yo !

> `relabel()` does return a new poset.

Oh, True, True, I had forgotten what exactly the problem was. Two years ago, after all `:-D`

Cool, then the interface will not even change.

> The simplist change would be to make the Hasse diagram the only part of the construction info, however this would mean we'd have to relabel the Hasse diagram at construction time rather than when calling `hasse_diagram()`.

Indeed.I will do just that.

> This also has the drawback of not being able to use the same digraph for all relabelings of a poset, which is probably used by the linear extensions and creates a much larger memory usage (and data duplication).
> 
> Hopefully before you have gotten angry, I think better standardization could be used here too.

I was angry two years ago, because I was told that the problem would be fixed, and it was not. Jori had been doing a lot of work to fix/improve the poset class in the last two days, and I just don't want to tell him that this bug will stay because nobody is willing to make a move.

I will write the branch that rewrites .relabel properly, and that will be all.

Nathann



---

archive/issue_comments_171429.json:
```json
{
    "body": "> Hopefully before you have gotten angry, I think better standardization could be used here too.\n\nCan you implement your idea this week ? If you can't I will implement the simple idea I understand (just give the relabelled Hasse Diagram) to fix the bug. If you can, tell me and so that I do not implement this for nothing.\n\nThanks,\n\nNathann",
    "created_at": "2014-09-27T13:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171429",
    "user": "https://github.com/nathanncohen"
}
```

> Hopefully before you have gotten angry, I think better standardization could be used here too.

Can you implement your idea this week ? If you can't I will implement the simple idea I understand (just give the relabelled Hasse Diagram) to fix the bug. If you can, tell me and so that I do not implement this for nothing.

Thanks,

Nathann



---

archive/issue_comments_171430.json:
```json
{
    "body": "Replying to [comment:34 ncohen]:\n\n> Jori had been doing a lot of work to fix/improve the poset class in the last two days, and I just don't want to tell him that this bug will stay because nobody is willing to make a move.\n\nThis is not a blocker issue for me. I was just making some test set, but I can do it by other ways.",
    "created_at": "2014-09-27T15:18:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171430",
    "user": "https://github.com/jm58660"
}
```

Replying to [comment:34 ncohen]:

> Jori had been doing a lot of work to fix/improve the poset class in the last two days, and I just don't want to tell him that this bug will stay because nobody is willing to make a move.

This is not a blocker issue for me. I was just making some test set, but I can do it by other ways.



---

archive/issue_comments_171431.json:
```json
{
    "body": "Okay, I am wasting my week-end on this bug that had been left to rot for 20 months again, and here is where I am:\n\nIn the `__init__` of FinitePoset you have a hasse diagram on `0,...,n-1` and a list of labels for the n points. Those are used as the key for the equality inherited from `UniqueRepresentation`.\n\nOf course, if you apply a graph isomorphism to the list of labels it still represents the very same poset. But the key is different, so equality answers 'no'.\n\nGuys this bug is hard to fix because there is a LOT of code that uses these functions, and there are two layers of pre-treatment (`Poset` and `FinitePoset.__classcall__`). I would appreciate it if somebody felt responsible of that and fixed it.\n\nNathann\n\nP.S.: I created #17059 that fixes some other stupid bug.",
    "created_at": "2014-09-28T13:28:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171431",
    "user": "https://github.com/nathanncohen"
}
```

Okay, I am wasting my week-end on this bug that had been left to rot for 20 months again, and here is where I am:

In the `__init__` of FinitePoset you have a hasse diagram on `0,...,n-1` and a list of labels for the n points. Those are used as the key for the equality inherited from `UniqueRepresentation`.

Of course, if you apply a graph isomorphism to the list of labels it still represents the very same poset. But the key is different, so equality answers 'no'.

Guys this bug is hard to fix because there is a LOT of code that uses these functions, and there are two layers of pre-treatment (`Poset` and `FinitePoset.__classcall__`). I would appreciate it if somebody felt responsible of that and fixed it.

Nathann

P.S.: I created #17059 that fixes some other stupid bug.



---

archive/issue_comments_171432.json:
```json
{
    "body": "See https://groups.google.com/d/topic/sage-devel/WXNmH3PL7kY/discussion",
    "created_at": "2014-09-29T11:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171432",
    "user": "https://github.com/nathanncohen"
}
```

See https://groups.google.com/d/topic/sage-devel/WXNmH3PL7kY/discussion



---

archive/issue_comments_171433.json:
```json
{
    "body": "Hi Nathann,\n\nTo be honest, I cannot even reproduce the bug that you reported\n\n```\nsage: d = DiGraph({2:[1],3:[1]})   \nsage: sage: p1 = Poset(d)\nsage: sage: p2 = p1.relabel({1:1,2:3,3:2})\n/Applications/sage/src/bin/sage-ipython:1:\n********************************************************************************\nRelabelling posets is known to break equality between posets (P == Q)\nThis issue is being tracked at http://trac.sagemath.org/sage_trac/ticket/14019.\n********************************************************************************\nsage: sage: p1.hasse_diagram() == p2.hasse_diagram()\nTrue\nsage: p1 == p2\nTrue \n```\n\nIs it possible that this was already fixed with #17059? I am running sage-6.4.beta4.\n\nAnne",
    "created_at": "2014-10-05T03:08:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171433",
    "user": "https://github.com/anneschilling"
}
```

Hi Nathann,

To be honest, I cannot even reproduce the bug that you reported

```
sage: d = DiGraph({2:[1],3:[1]})   
sage: sage: p1 = Poset(d)
sage: sage: p2 = p1.relabel({1:1,2:3,3:2})
/Applications/sage/src/bin/sage-ipython:1:
********************************************************************************
Relabelling posets is known to break equality between posets (P == Q)
This issue is being tracked at http://trac.sagemath.org/sage_trac/ticket/14019.
********************************************************************************
sage: sage: p1.hasse_diagram() == p2.hasse_diagram()
True
sage: p1 == p2
True 
```

Is it possible that this was already fixed with #17059? I am running sage-6.4.beta4.

Anne



---

archive/issue_comments_171434.json:
```json
{
    "body": "No Anne, I am not complaining about a bug that I fixed myself last week.\n\nI found #17059 while working on it, and #17059 is only about a bad 'category' argument. \n\nIn particular, I can still reproduce it on my computer.\n\nThis being said, the code has absolutely no reason to be machine-dependent in its current state. Can you check this again and give us the output of p1._list and p2._list ? The relabel function, which you wrote yourself in #12536, makes sure that the `._list` flag is modified, which breaks equality. This is not machine-dependent, so I do not understand why it may work on your computer.\n\nNathann",
    "created_at": "2014-10-05T07:50:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171434",
    "user": "https://github.com/nathanncohen"
}
```

No Anne, I am not complaining about a bug that I fixed myself last week.

I found #17059 while working on it, and #17059 is only about a bad 'category' argument. 

In particular, I can still reproduce it on my computer.

This being said, the code has absolutely no reason to be machine-dependent in its current state. Can you check this again and give us the output of p1._list and p2._list ? The relabel function, which you wrote yourself in #12536, makes sure that the `._list` flag is modified, which breaks equality. This is not machine-dependent, so I do not understand why it may work on your computer.

Nathann



---

archive/issue_comments_171435.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-10-10T19:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171435",
    "user": "https://github.com/anneschilling"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_171436.json:
```json
{
    "body": "Changing keywords from \"\" to \"posets\".",
    "created_at": "2014-10-10T19:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171436",
    "user": "https://github.com/anneschilling"
}
```

Changing keywords from "" to "posets".



---

archive/issue_comments_171437.json:
```json
{
    "body": "The current branch fixes the bug. The rationale is to allow posets to not have a specified linear extension. This is achieved by changing the input behavior of `FinitePoset`. If `elements` is specified, this is used for the underlying linear extension. If `elements` is None, then the default linear extension is now computed in the `__init__`, so that posets where linear extensions are not specified now compare equal.\n\nTravis and Anne\n----\nLast 10 new commits:",
    "created_at": "2014-10-10T19:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171437",
    "user": "https://github.com/anneschilling"
}
```

The current branch fixes the bug. The rationale is to allow posets to not have a specified linear extension. This is achieved by changing the input behavior of `FinitePoset`. If `elements` is specified, this is used for the underlying linear extension. If `elements` is None, then the default linear extension is now computed in the `__init__`, so that posets where linear extensions are not specified now compare equal.

Travis and Anne
----
Last 10 new commits:



---

archive/issue_comments_171438.json:
```json
{
    "body": "FTR, we also did some minor cleanup of the file.",
    "created_at": "2014-10-10T19:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171438",
    "user": "https://github.com/tscrim"
}
```

FTR, we also did some minor cleanup of the file.



---

archive/issue_comments_171439.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-10T19:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171439",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_171440.json:
```json
{
    "body": "Positive review ? On my computer this code breaks a *LOT* of doctests in the combinat folder.\n\nNathann",
    "created_at": "2014-10-10T19:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171440",
    "user": "https://github.com/nathanncohen"
}
```

Positive review ? On my computer this code breaks a *LOT* of doctests in the combinat folder.

Nathann



---

archive/issue_comments_171441.json:
```json
{
    "body": "Also, I do not understand what you do in the `.dual()` function. You seem to define a `elements` variable that you do not use. As a result the dual of a Poset with a linear extension becomes a poset without linear extension.\n\nWould it also be possible to change the `__repr__` function so that is says explicitly that the poset is a `poset with a linear extension` ? The two posets behave as if they were of different type (they can never be equal), and if such a poset is returned by a function it may surprise the user that the poset is never equal to a poset he built himself.\n\nNathann",
    "created_at": "2014-10-10T20:05:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171441",
    "user": "https://github.com/nathanncohen"
}
```

Also, I do not understand what you do in the `.dual()` function. You seem to define a `elements` variable that you do not use. As a result the dual of a Poset with a linear extension becomes a poset without linear extension.

Would it also be possible to change the `__repr__` function so that is says explicitly that the poset is a `poset with a linear extension` ? The two posets behave as if they were of different type (they can never be equal), and if such a poset is returned by a function it may surprise the user that the poset is never equal to a poset he built himself.

Nathann



---

archive/issue_comments_171442.json:
```json
{
    "body": "Merge conflict, too",
    "created_at": "2014-10-10T20:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171442",
    "user": "https://github.com/vbraun"
}
```

Merge conflict, too



---

archive/issue_comments_171443.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-10-10T20:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171443",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_171444.json:
```json
{
    "body": "Merge conflict ? Oh, yes probably with all the Poset tickets Jori wrote. Their code is based on the latest beta though.\n\nNathann",
    "created_at": "2014-10-10T20:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171444",
    "user": "https://github.com/nathanncohen"
}
```

Merge conflict ? Oh, yes probably with all the Poset tickets Jori wrote. Their code is based on the latest beta though.

Nathann



---

archive/issue_comments_171445.json:
```json
{
    "body": "I can't even get to the point of running doctests: if I run `make`, then docbuilding fails with\n\n```\n[modmisc  ] loading pickled environment... not yet created\n[modmisc  ] building [inventory]: targets for 16 source files that are out of date\n[modmisc  ] updating environment: 16 added, 0 changed, 0 removed\n[modmisc  ] reading sources... [  6%] index\n[modmisc  ] reading sources... [ 12%] sage/modular/buzzard\nError building the documentation.\n\nNote: incremental documentation builds sometimes cause spurious\nerror messages. To be certain that these are real errors, run\n\"make doc-clean\" first and try again.\nTraceback (most recent call last):\n  File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py\", line 1491, in <module>\n    getattr(get_builder(name), type)()\n  File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py\", line 292, in _wrapper\n    getattr(get_builder(document), 'inventory')(*args, **kwds)\n  File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py\", line 503, in _wrapper\n    x.get(99999)\n  File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python/multiprocessing/pool.py\", line 558, in get\n    raise self._value\nNotImplementedError: Non injective relabeling\nmake: *** [doc-html] Error 1\n```\n",
    "created_at": "2014-10-10T20:43:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171445",
    "user": "https://github.com/jhpalmieri"
}
```

I can't even get to the point of running doctests: if I run `make`, then docbuilding fails with

```
[modmisc  ] loading pickled environment... not yet created
[modmisc  ] building [inventory]: targets for 16 source files that are out of date
[modmisc  ] updating environment: 16 added, 0 changed, 0 removed
[modmisc  ] reading sources... [  6%] index
[modmisc  ] reading sources... [ 12%] sage/modular/buzzard
Error building the documentation.

Note: incremental documentation builds sometimes cause spurious
error messages. To be certain that these are real errors, run
"make doc-clean" first and try again.
Traceback (most recent call last):
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py", line 1491, in <module>
    getattr(get_builder(name), type)()
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py", line 292, in _wrapper
    getattr(get_builder(document), 'inventory')(*args, **kwds)
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py", line 503, in _wrapper
    x.get(99999)
  File "/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python/multiprocessing/pool.py", line 558, in get
    raise self._value
NotImplementedError: Non injective relabeling
make: *** [doc-html] Error 1
```




---

archive/issue_comments_171446.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-10T21:17:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171446",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171447.json:
```json
{
    "body": "Replying to [comment:43 ncohen]:\n> Positive review ? On my computer this code breaks a *LOT* of doctests in the combinat folder.\n\nThey were all trivial failures and are fixed now!\n\n>Also, I do not understand what you do in the .dual() function. You seem to define a >elements variable that you do not use. As a result the dual of a Poset with a linear >extension becomes a poset without linear extension.\n\nFixed.\n\n>Would it also be possible to change the __repr__ function so that is says explicitly \n>that the poset is a poset with a linear extension ? The two posets behave as if they \n>were of different type (they can never be equal), and if such a poset is returned by a \n>function it may surprise the user that the poset is never equal to a poset he built \n>himself.\n\nIf this is only for HIM, I am sure this is now in your ability range to fix it, if it is important to you!\n\nAnne",
    "created_at": "2014-10-10T21:19:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171447",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:43 ncohen]:
> Positive review ? On my computer this code breaks a *LOT* of doctests in the combinat folder.

They were all trivial failures and are fixed now!

>Also, I do not understand what you do in the .dual() function. You seem to define a >elements variable that you do not use. As a result the dual of a Poset with a linear >extension becomes a poset without linear extension.

Fixed.

>Would it also be possible to change the __repr__ function so that is says explicitly 
>that the poset is a poset with a linear extension ? The two posets behave as if they 
>were of different type (they can never be equal), and if such a poset is returned by a 
>function it may surprise the user that the poset is never equal to a poset he built 
>himself.

If this is only for HIM, I am sure this is now in your ability range to fix it, if it is important to you!

Anne



---

archive/issue_comments_171448.json:
```json
{
    "body": "Replying to [comment:45 vbraun]:\n> Merge conflict, too\n\nWhat tickets does it conflict with?",
    "created_at": "2014-10-10T23:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171448",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:45 vbraun]:
> Merge conflict, too

What tickets does it conflict with?



---

archive/issue_comments_171449.json:
```json
{
    "body": "I get lots of doctest failures with this. See http://sage.math.washington.edu/home/palmieri/misc/ptest-14019-OSX.log. (This is on an OS X machine, but I see the same failures on sage.math.)",
    "created_at": "2014-10-11T01:08:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171449",
    "user": "https://github.com/jhpalmieri"
}
```

I get lots of doctest failures with this. See http://sage.math.washington.edu/home/palmieri/misc/ptest-14019-OSX.log. (This is on an OS X machine, but I see the same failures on sage.math.)



---

archive/issue_comments_171450.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-11T02:22:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171450",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171451.json:
```json
{
    "body": "Replying to [comment:51 jhpalmieri]:\n> I get lots of doctest failures with this. See http://sage.math.washington.edu/home/palmieri/misc/ptest-14019-OSX.log. (This is on an OS X machine, but I see the same failures on sage.math.)\n\nOopsey daisey, thanks for reporting. We forgot a couple of places in the sage library, where FinitePoset was used directly. Should be fixed now!",
    "created_at": "2014-10-11T02:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171451",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:51 jhpalmieri]:
> I get lots of doctest failures with this. See http://sage.math.washington.edu/home/palmieri/misc/ptest-14019-OSX.log. (This is on an OS X machine, but I see the same failures on sage.math.)

Oopsey daisey, thanks for reporting. We forgot a couple of places in the sage library, where FinitePoset was used directly. Should be fixed now!



---

archive/issue_comments_171452.json:
```json
{
    "body": "Replying to [comment:47 jhpalmieri]:\n> I can't even get to the point of running doctests: if I run `make`, then docbuilding fails with\n> {{{\n> [modmisc  ] loading pickled environment... not yet created\n> [modmisc  ] building [inventory]: targets for 16 source files that are out of date\n> [modmisc  ] updating environment: 16 added, 0 changed, 0 removed\n> [modmisc  ] reading sources... [  6%] index\n> [modmisc  ] reading sources... [ 12%] sage/modular/buzzard\n> Error building the documentation.\n> \n> Note: incremental documentation builds sometimes cause spurious\n> error messages. To be certain that these are real errors, run\n> \"make doc-clean\" first and try again.\n> Traceback (most recent call last):\n>   File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py\", line 1491, in <module>\n>     getattr(get_builder(name), type)()\n>   File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py\", line 292, in _wrapper\n>     getattr(get_builder(document), 'inventory')(*args, **kwds)\n>   File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py\", line 503, in _wrapper\n>     x.get(99999)\n>   File \"/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python/multiprocessing/pool.py\", line 558, in get\n>     raise self._value\n> NotImplementedError: Non injective relabeling\n> make: *** [doc-html] Error 1\n> }}}\n\nI am not sure why/how this would be caused by this branch.\n\nAnne",
    "created_at": "2014-10-11T02:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171452",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:47 jhpalmieri]:
> I can't even get to the point of running doctests: if I run `make`, then docbuilding fails with
> {{{
> [modmisc  ] loading pickled environment... not yet created
> [modmisc  ] building [inventory]: targets for 16 source files that are out of date
> [modmisc  ] updating environment: 16 added, 0 changed, 0 removed
> [modmisc  ] reading sources... [  6%] index
> [modmisc  ] reading sources... [ 12%] sage/modular/buzzard
> Error building the documentation.
> 
> Note: incremental documentation builds sometimes cause spurious
> error messages. To be certain that these are real errors, run
> "make doc-clean" first and try again.
> Traceback (most recent call last):
>   File "/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py", line 1491, in <module>
>     getattr(get_builder(name), type)()
>   File "/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py", line 292, in _wrapper
>     getattr(get_builder(document), 'inventory')(*args, **kwds)
>   File "/Users/palmieri/Desktop/Sage_stuff/git/sage/src/doc/common/builder.py", line 503, in _wrapper
>     x.get(99999)
>   File "/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python/multiprocessing/pool.py", line 558, in get
>     raise self._value
> NotImplementedError: Non injective relabeling
> make: *** [doc-html] Error 1
> }}}

I am not sure why/how this would be caused by this branch.

Anne



---

archive/issue_comments_171453.json:
```json
{
    "body": "Replying to [comment:53 aschilling]:\n> Oopsey daisey, thanks for reporting. We forgot a couple of places in the sage library, where FinitePoset was used directly. Should be fixed now!\n\nUnfortunately not:\n\n```\n----------------------------------------------------------------------\nsage -t src/sage/combinat/root_system/root_lattice_realizations.py  # 2 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/abstract_ring.py  # 377 doctests failed\nsage -t src/sage/combinat/root_system/root_system.py  # 1 doctest failed\nsage -t src/sage/modular/modform_hecketriangle/graded_ring_element.py  # 386 doctests failed\nsage -t src/sage/homology/cell_complex.py  # 1 doctest failed\nsage -t src/sage/modular/modform_hecketriangle/abstract_space.py  # 306 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/space.py  # 184 doctests failed\nsage -t src/sage/categories/finite_posets.py  # 4 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/hecke_triangle_groups.py  # 107 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/series_constructor.py  # 144 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/functors.py  # 121 doctests failed\nsage -t src/doc/en/reference/coercion/index.rst  # 1 doctest failed\nsage -t src/sage/modular/modform_hecketriangle/analytic_type.py  # 113 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/graded_ring.py  # 65 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/readme.py  # 94 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/subspace.py  # 85 doctests failed\nsage -t src/sage/misc/c3_controlled.pyx  # 9 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/element.py  # 32 doctests failed\nsage -t src/sage/modular/modform_hecketriangle/constructor.py  # 30 doctests failed\n----------------------------------------------------------------------\n```\n\n\nRe docbuilding:\n> I am not sure why/how this would be caused by this branch.\nIt definitely was, but it was fixed by commit [\"e575472\"](http://git.sagemath.org/sage.git/commit/?id=e575742951572b4b383abeae1e21e934b9e1683f).",
    "created_at": "2014-10-11T05:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171453",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:53 aschilling]:
> Oopsey daisey, thanks for reporting. We forgot a couple of places in the sage library, where FinitePoset was used directly. Should be fixed now!

Unfortunately not:

```
----------------------------------------------------------------------
sage -t src/sage/combinat/root_system/root_lattice_realizations.py  # 2 doctests failed
sage -t src/sage/modular/modform_hecketriangle/abstract_ring.py  # 377 doctests failed
sage -t src/sage/combinat/root_system/root_system.py  # 1 doctest failed
sage -t src/sage/modular/modform_hecketriangle/graded_ring_element.py  # 386 doctests failed
sage -t src/sage/homology/cell_complex.py  # 1 doctest failed
sage -t src/sage/modular/modform_hecketriangle/abstract_space.py  # 306 doctests failed
sage -t src/sage/modular/modform_hecketriangle/space.py  # 184 doctests failed
sage -t src/sage/categories/finite_posets.py  # 4 doctests failed
sage -t src/sage/modular/modform_hecketriangle/hecke_triangle_groups.py  # 107 doctests failed
sage -t src/sage/modular/modform_hecketriangle/series_constructor.py  # 144 doctests failed
sage -t src/sage/modular/modform_hecketriangle/functors.py  # 121 doctests failed
sage -t src/doc/en/reference/coercion/index.rst  # 1 doctest failed
sage -t src/sage/modular/modform_hecketriangle/analytic_type.py  # 113 doctests failed
sage -t src/sage/modular/modform_hecketriangle/graded_ring.py  # 65 doctests failed
sage -t src/sage/modular/modform_hecketriangle/readme.py  # 94 doctests failed
sage -t src/sage/modular/modform_hecketriangle/subspace.py  # 85 doctests failed
sage -t src/sage/misc/c3_controlled.pyx  # 9 doctests failed
sage -t src/sage/modular/modform_hecketriangle/element.py  # 32 doctests failed
sage -t src/sage/modular/modform_hecketriangle/constructor.py  # 30 doctests failed
----------------------------------------------------------------------
```


Re docbuilding:
> I am not sure why/how this would be caused by this branch.
It definitely was, but it was fixed by commit ["e575472"](http://git.sagemath.org/sage.git/commit/?id=e575742951572b4b383abeae1e21e934b9e1683f).



---

archive/issue_comments_171454.json:
```json
{
    "body": "Replying to [comment:55 jhpalmieri]:\n> Replying to [comment:53 aschilling]:\n> > Oopsey daisey, thanks for reporting. We forgot a couple of places in the sage library, where FinitePoset was used directly. Should be fixed now!\n> \n> Unfortunately not:\n> {{{\n> ----------------------------------------------------------------------\n> sage -t src/sage/combinat/root_system/root_lattice_realizations.py  # 2 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/abstract_ring.py  # 377 doctests failed\n> sage -t src/sage/combinat/root_system/root_system.py  # 1 doctest failed\n> sage -t src/sage/modular/modform_hecketriangle/graded_ring_element.py  # 386 doctests failed\n> sage -t src/sage/homology/cell_complex.py  # 1 doctest failed\n> sage -t src/sage/modular/modform_hecketriangle/abstract_space.py  # 306 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/space.py  # 184 doctests failed\n> sage -t src/sage/categories/finite_posets.py  # 4 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/hecke_triangle_groups.py  # 107 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/series_constructor.py  # 144 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/functors.py  # 121 doctests failed\n> sage -t src/doc/en/reference/coercion/index.rst  # 1 doctest failed\n> sage -t src/sage/modular/modform_hecketriangle/analytic_type.py  # 113 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/graded_ring.py  # 65 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/readme.py  # 94 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/subspace.py  # 85 doctests failed\n> sage -t src/sage/misc/c3_controlled.pyx  # 9 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/element.py  # 32 doctests failed\n> sage -t src/sage/modular/modform_hecketriangle/constructor.py  # 30 doctests failed\n> ----------------------------------------------------------------------\n> }}}\n\nStrange, I do not get these errors:\n\n\n```\nroot_system anne$ sage -t *.py\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2014-10-10-22-40-44-9fc5ba66.\nDoctesting 44 files.\nsage -t __init__.py\n    [0 tests, 0.00 s]\nsage -t all.py\n    [0 tests, 0.00 s]\nsage -t ambient_space.py\n    [69 tests, 10.05 s]\nsage -t associahedron.py\n    [28 tests, 2.83 s]\nsage -t branching_rules.py\n    [252 tests, 10.29 s]\nsage -t cartan_matrix.py\n    [105 tests, 1.96 s]\nsage -t cartan_type.py\n    [408 tests, 3.53 s]\nsage -t coxeter_group.py\n    [28 tests, 4.64 s]\nsage -t coxeter_matrix.py\n    [10 tests, 0.15 s]\nsage -t dynkin_diagram.py\n    [104 tests, 0.84 s]\nsage -t hecke_algebra_representation.py\n    [286 tests, 5.06 s]\nsage -t non_symmetric_macdonald_polynomials.py\n    [533 tests, 13.02 s]\nsage -t pieri_factors.py\n    [225 tests, 13.11 s]\nsage -t plot.py\n    [256 tests, 28.88 s]\nsage -t root_lattice_realization_algebras.py\n    [309 tests, 4.04 s]\nsage -t root_lattice_realizations.py\n    [561 tests, 15.06 s]\nsage -t root_space.py\n    [77 tests, 4.89 s]\nsage -t root_system.py\n    [131 tests, 3.85 s]\nsage -t type_A.py\n    [48 tests, 0.27 s]\nsage -t type_A_affine.py\n    [31 tests, 0.04 s]\nsage -t type_B.py\n    [41 tests, 0.20 s]\nsage -t type_BC_affine.py\n    [44 tests, 0.05 s]\nsage -t type_B_affine.py\n    [27 tests, 0.04 s]\nsage -t type_C.py\n    [42 tests, 0.26 s]\nsage -t type_C_affine.py\n    [23 tests, 0.04 s]\nsage -t type_D.py\n    [41 tests, 0.20 s]\nsage -t type_D_affine.py\n    [25 tests, 0.04 s]\nsage -t type_E.py\n    [55 tests, 0.34 s]\nsage -t type_E_affine.py\n    [26 tests, 0.03 s]\nsage -t type_F.py\n    [39 tests, 0.31 s]\nsage -t type_F_affine.py\n    [19 tests, 0.03 s]\nsage -t type_G.py\n    [35 tests, 0.26 s]\nsage -t type_G_affine.py\n    [19 tests, 0.03 s]\nsage -t type_H.py\n    [20 tests, 0.15 s]\nsage -t type_I.py\n    [19 tests, 0.14 s]\nsage -t type_affine.py\n    [80 tests, 8.43 s]\nsage -t type_dual.py\n    [122 tests, 0.39 s]\nsage -t type_folded.py\n    [37 tests, 0.23 s]\nsage -t type_reducible.py\n    [72 tests, 0.30 s]\nsage -t type_relabel.py\n    [138 tests, 1.94 s]\nsage -t weight_lattice_realizations.py\n    [200 tests, 2.08 s]\nsage -t weight_space.py\n    [82 tests, 18.63 s]\nsage -t weyl_characters.py\n    [266 tests, 4.40 s]\nsage -t weyl_group.py\n    [180 tests, 8.64 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 176.0 seconds\n    cpu time: 140.0 seconds\n    cumulative wall time: 169.7 seconds\n```\n\n\n\n```\nmodform_hecketriangle anne$ sage -t *.py\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2014-10-10-22-44-49-0b9b275e.\nDoctesting 15 files.\nsage -t __init__.py\n    [0 tests, 0.00 s]\nsage -t abstract_ring.py\n    [377 tests, 3.89 s]\nsage -t abstract_space.py\n    [309 tests, 9.34 s]\nsage -t all.py\n    [0 tests, 0.00 s]\nsage -t analytic_type.py\n    [119 tests, 0.60 s]\nsage -t constructor.py\n    [31 tests, 0.97 s]\nsage -t element.py\n    [35 tests, 1.17 s]\nsage -t functors.py\n    [121 tests, 1.20 s]\nsage -t graded_ring.py\n    [65 tests, 0.48 s]\nsage -t graded_ring_element.py\n    [409 tests, 24.97 s]\nsage -t hecke_triangle_groups.py\n    [112 tests, 1.89 s]\nsage -t readme.py\n    [94 tests, 4.54 s]\nsage -t series_constructor.py\n    [144 tests, 0.51 s]\nsage -t space.py\n    [186 tests, 5.31 s]\nsage -t subspace.py\n    [86 tests, 3.62 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 60.2 seconds\n    cpu time: 57.1 seconds\n    cumulative wall time: 58.5 seconds\n```\n\n\nDid you pull the latest version?\n\nAnne",
    "created_at": "2014-10-11T05:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171454",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:55 jhpalmieri]:
> Replying to [comment:53 aschilling]:
> > Oopsey daisey, thanks for reporting. We forgot a couple of places in the sage library, where FinitePoset was used directly. Should be fixed now!
> 
> Unfortunately not:
> {{{
> ----------------------------------------------------------------------
> sage -t src/sage/combinat/root_system/root_lattice_realizations.py  # 2 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/abstract_ring.py  # 377 doctests failed
> sage -t src/sage/combinat/root_system/root_system.py  # 1 doctest failed
> sage -t src/sage/modular/modform_hecketriangle/graded_ring_element.py  # 386 doctests failed
> sage -t src/sage/homology/cell_complex.py  # 1 doctest failed
> sage -t src/sage/modular/modform_hecketriangle/abstract_space.py  # 306 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/space.py  # 184 doctests failed
> sage -t src/sage/categories/finite_posets.py  # 4 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/hecke_triangle_groups.py  # 107 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/series_constructor.py  # 144 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/functors.py  # 121 doctests failed
> sage -t src/doc/en/reference/coercion/index.rst  # 1 doctest failed
> sage -t src/sage/modular/modform_hecketriangle/analytic_type.py  # 113 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/graded_ring.py  # 65 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/readme.py  # 94 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/subspace.py  # 85 doctests failed
> sage -t src/sage/misc/c3_controlled.pyx  # 9 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/element.py  # 32 doctests failed
> sage -t src/sage/modular/modform_hecketriangle/constructor.py  # 30 doctests failed
> ----------------------------------------------------------------------
> }}}

Strange, I do not get these errors:


```
root_system anne$ sage -t *.py
too few successful tests, not using stored timings
Running doctests with ID 2014-10-10-22-40-44-9fc5ba66.
Doctesting 44 files.
sage -t __init__.py
    [0 tests, 0.00 s]
sage -t all.py
    [0 tests, 0.00 s]
sage -t ambient_space.py
    [69 tests, 10.05 s]
sage -t associahedron.py
    [28 tests, 2.83 s]
sage -t branching_rules.py
    [252 tests, 10.29 s]
sage -t cartan_matrix.py
    [105 tests, 1.96 s]
sage -t cartan_type.py
    [408 tests, 3.53 s]
sage -t coxeter_group.py
    [28 tests, 4.64 s]
sage -t coxeter_matrix.py
    [10 tests, 0.15 s]
sage -t dynkin_diagram.py
    [104 tests, 0.84 s]
sage -t hecke_algebra_representation.py
    [286 tests, 5.06 s]
sage -t non_symmetric_macdonald_polynomials.py
    [533 tests, 13.02 s]
sage -t pieri_factors.py
    [225 tests, 13.11 s]
sage -t plot.py
    [256 tests, 28.88 s]
sage -t root_lattice_realization_algebras.py
    [309 tests, 4.04 s]
sage -t root_lattice_realizations.py
    [561 tests, 15.06 s]
sage -t root_space.py
    [77 tests, 4.89 s]
sage -t root_system.py
    [131 tests, 3.85 s]
sage -t type_A.py
    [48 tests, 0.27 s]
sage -t type_A_affine.py
    [31 tests, 0.04 s]
sage -t type_B.py
    [41 tests, 0.20 s]
sage -t type_BC_affine.py
    [44 tests, 0.05 s]
sage -t type_B_affine.py
    [27 tests, 0.04 s]
sage -t type_C.py
    [42 tests, 0.26 s]
sage -t type_C_affine.py
    [23 tests, 0.04 s]
sage -t type_D.py
    [41 tests, 0.20 s]
sage -t type_D_affine.py
    [25 tests, 0.04 s]
sage -t type_E.py
    [55 tests, 0.34 s]
sage -t type_E_affine.py
    [26 tests, 0.03 s]
sage -t type_F.py
    [39 tests, 0.31 s]
sage -t type_F_affine.py
    [19 tests, 0.03 s]
sage -t type_G.py
    [35 tests, 0.26 s]
sage -t type_G_affine.py
    [19 tests, 0.03 s]
sage -t type_H.py
    [20 tests, 0.15 s]
sage -t type_I.py
    [19 tests, 0.14 s]
sage -t type_affine.py
    [80 tests, 8.43 s]
sage -t type_dual.py
    [122 tests, 0.39 s]
sage -t type_folded.py
    [37 tests, 0.23 s]
sage -t type_reducible.py
    [72 tests, 0.30 s]
sage -t type_relabel.py
    [138 tests, 1.94 s]
sage -t weight_lattice_realizations.py
    [200 tests, 2.08 s]
sage -t weight_space.py
    [82 tests, 18.63 s]
sage -t weyl_characters.py
    [266 tests, 4.40 s]
sage -t weyl_group.py
    [180 tests, 8.64 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 176.0 seconds
    cpu time: 140.0 seconds
    cumulative wall time: 169.7 seconds
```



```
modform_hecketriangle anne$ sage -t *.py
too few successful tests, not using stored timings
Running doctests with ID 2014-10-10-22-44-49-0b9b275e.
Doctesting 15 files.
sage -t __init__.py
    [0 tests, 0.00 s]
sage -t abstract_ring.py
    [377 tests, 3.89 s]
sage -t abstract_space.py
    [309 tests, 9.34 s]
sage -t all.py
    [0 tests, 0.00 s]
sage -t analytic_type.py
    [119 tests, 0.60 s]
sage -t constructor.py
    [31 tests, 0.97 s]
sage -t element.py
    [35 tests, 1.17 s]
sage -t functors.py
    [121 tests, 1.20 s]
sage -t graded_ring.py
    [65 tests, 0.48 s]
sage -t graded_ring_element.py
    [409 tests, 24.97 s]
sage -t hecke_triangle_groups.py
    [112 tests, 1.89 s]
sage -t readme.py
    [94 tests, 4.54 s]
sage -t series_constructor.py
    [144 tests, 0.51 s]
sage -t space.py
    [186 tests, 5.31 s]
sage -t subspace.py
    [86 tests, 3.62 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 60.2 seconds
    cpu time: 57.1 seconds
    cumulative wall time: 58.5 seconds
```


Did you pull the latest version?

Anne



---

archive/issue_comments_171455.json:
```json
{
    "body": "You are right (I was in the wrong branch when running the tests whilst trying to investigate the doc build failure). I get the same doc failures.\n\nPosets are used in `src/sage/modular/modform_hecketriangle/analytic_type.py`\n\nAnne",
    "created_at": "2014-10-11T06:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171455",
    "user": "https://github.com/anneschilling"
}
```

You are right (I was in the wrong branch when running the tests whilst trying to investigate the doc build failure). I get the same doc failures.

Posets are used in `src/sage/modular/modform_hecketriangle/analytic_type.py`

Anne



---

archive/issue_comments_171456.json:
```json
{
    "body": "Hello !\n\nI think that there is something wrong with the code for canonical label:\n\n\n```\nsage: Poset(digraphs.Path(10)).canonical_label().linear_extension()\n[0, 9, 7, 5, 3, 2, 4, 6, 8, 1]\n```\n\n\nIn particular, the code looks like you suppose that `range(n)` is a linear extension of a canonically labelled digraph, and this is wrong:\n\n\n```\nsage: digraphs.Path(10).canonical_label(certify=True)[1]\n{0: 0, 1: 9, 2: 7, 3: 5, 4: 3, 5: 2, 6: 4, 7: 6, 8: 8, 9: 1}\n```\n\n\nThis seems to work fine with the latest beta release\n\n\n```\nsage: Poset(digraphs.Path(10)).canonical_label().linear_extension()\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n```\n\n\nNathann",
    "created_at": "2014-10-11T13:08:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171456",
    "user": "https://github.com/nathanncohen"
}
```

Hello !

I think that there is something wrong with the code for canonical label:


```
sage: Poset(digraphs.Path(10)).canonical_label().linear_extension()
[0, 9, 7, 5, 3, 2, 4, 6, 8, 1]
```


In particular, the code looks like you suppose that `range(n)` is a linear extension of a canonically labelled digraph, and this is wrong:


```
sage: digraphs.Path(10).canonical_label(certify=True)[1]
{0: 0, 1: 9, 2: 7, 3: 5, 4: 3, 5: 2, 6: 4, 7: 6, 8: 8, 9: 1}
```


This seems to work fine with the latest beta release


```
sage: Poset(digraphs.Path(10)).canonical_label().linear_extension()
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
```


Nathann



---

archive/issue_comments_171457.json:
```json
{
    "body": "Hi Nathann,\n\nI am not quite sure why this is supposed to be wrong. As you wrote the output of `canonical_label` of `DiGraph` is \n\n```\nsage: D = digraphs.Path(10)\nsage: D.edges()\n[(0, 1, None),\n (1, 2, None),\n (2, 3, None),\n (3, 4, None),\n (4, 5, None),\n (5, 6, None),\n (6, 7, None),\n (7, 8, None),\n (8, 9, None)]\nsage: D.canonical_label().edges()\n[(0, 9, None),\n (2, 4, None),\n (3, 2, None),\n (4, 6, None),\n (5, 3, None),\n (6, 8, None),\n (7, 5, None),\n (8, 1, None),\n (9, 7, None)]\n```\n\nI do not understand why (the documentation says that this is supposed to be unique, but there seems nothing unique about this particular choice to me). But with this we obtain\n\n```\nsage: P = Poset(digraphs.Path(10))\nsage: Pp = P.canonical_label()\nsage: Pp.cover_relations()\n[[0, 9], [9, 7], [7, 5], [5, 3], [3, 2], [2, 4], [4, 6], [6, 8], [8, 1]]\nsage: Pp.linear_extension()\n[0, 9, 7, 5, 3, 2, 4, 6, 8, 1]\n```\n\nwhich is indeed the single linear extension for this poset. If this is not the desired output, perhaps someone should rewrite the documentation and specify precisely what this *unique* poset is supposed to be. Is it supposed to be naturally labelled perhaps? Is that what your problem is? It does not say so in the documentation.\n\nAnne",
    "created_at": "2014-10-11T21:18:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171457",
    "user": "https://github.com/anneschilling"
}
```

Hi Nathann,

I am not quite sure why this is supposed to be wrong. As you wrote the output of `canonical_label` of `DiGraph` is 

```
sage: D = digraphs.Path(10)
sage: D.edges()
[(0, 1, None),
 (1, 2, None),
 (2, 3, None),
 (3, 4, None),
 (4, 5, None),
 (5, 6, None),
 (6, 7, None),
 (7, 8, None),
 (8, 9, None)]
sage: D.canonical_label().edges()
[(0, 9, None),
 (2, 4, None),
 (3, 2, None),
 (4, 6, None),
 (5, 3, None),
 (6, 8, None),
 (7, 5, None),
 (8, 1, None),
 (9, 7, None)]
```

I do not understand why (the documentation says that this is supposed to be unique, but there seems nothing unique about this particular choice to me). But with this we obtain

```
sage: P = Poset(digraphs.Path(10))
sage: Pp = P.canonical_label()
sage: Pp.cover_relations()
[[0, 9], [9, 7], [7, 5], [5, 3], [3, 2], [2, 4], [4, 6], [6, 8], [8, 1]]
sage: Pp.linear_extension()
[0, 9, 7, 5, 3, 2, 4, 6, 8, 1]
```

which is indeed the single linear extension for this poset. If this is not the desired output, perhaps someone should rewrite the documentation and specify precisely what this *unique* poset is supposed to be. Is it supposed to be naturally labelled perhaps? Is that what your problem is? It does not say so in the documentation.

Anne



---

archive/issue_comments_171458.json:
```json
{
    "body": "Yo !\n\n> I am not quite sure why this is supposed to be wrong. As you wrote the output of `canonical_label` of `DiGraph` is \n\nMy mistake, I was convinced that I had displayed the poset with a `.show()` and looked at a path labelled with 0,1,2,3,... while the linear extension was 0,9,... There is nothing wrong with this example indeed.\n\nThis being said, i still do not understand the code. Is the following behaviour correct ?\n\n\n```\nsage: P = Poset(digraphs.Path(4),['a','b','c','d'],linear_extension=True)\nsage: list(P.canonical_label())\n[0, 1, 2, 3]\n```\n\n\nI do not understand what you do with the `elements` list in `canonical_label` given that the output is labelled with `0,1,2,3`. Especially when `linear_extension=False` `O_o`\n\nNathann",
    "created_at": "2014-10-11T21:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171458",
    "user": "https://github.com/nathanncohen"
}
```

Yo !

> I am not quite sure why this is supposed to be wrong. As you wrote the output of `canonical_label` of `DiGraph` is 

My mistake, I was convinced that I had displayed the poset with a `.show()` and looked at a path labelled with 0,1,2,3,... while the linear extension was 0,9,... There is nothing wrong with this example indeed.

This being said, i still do not understand the code. Is the following behaviour correct ?


```
sage: P = Poset(digraphs.Path(4),['a','b','c','d'],linear_extension=True)
sage: list(P.canonical_label())
[0, 1, 2, 3]
```


I do not understand what you do with the `elements` list in `canonical_label` given that the output is labelled with `0,1,2,3`. Especially when `linear_extension=False` `O_o`

Nathann



---

archive/issue_comments_171459.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-11T22:52:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171459",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171460.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-12T00:13:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171460",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171461.json:
```json
{
    "body": "Hi Nathann,\n\n> My mistake, I was convinced that I had displayed the poset with a `.show()` and looked at a path labelled with 0,1,2,3,... while the linear extension was 0,9,... There is nothing wrong with this example indeed.\n\nOk. Why does the documentation say *unique* though? It does not make sense to me.\n\n> This being said, i still do not understand the code. Is the following behaviour correct ?\n> \n> {{{\n> sage: P = Poset(digraphs.Path(4),['a','b','c','d'],linear_extension=True)\n> sage: list(P.canonical_label())\n> [0, 1, 2, 3]\n> }}}\n\nI think so. The documentation says that `canonical_label` is supposed to label the poset with elements `\\{0,1,\\ldots,n-1\\}`. I changed the code slightly, so that [0,1,2,...]\nis a linear extension of the canonical relabeled poset.\n\n> I do not understand what you do with the `elements` list in `canonical_label` given that the output is labelled with `0,1,2,3`. Especially when `linear_extension=False` `O_o`\n\nThe documentation says that canonical relabeled means indexed by `0,1,\\ldots,n-1`. I did not write this code, so am not sure what this is used for. \n\nInternally, now the poset code still stores `P._hasse_diagram` as a Hasse diagram on `0,1,\\ldots,n-1` to make it light-weight and only compare integers internally. The elements are taken from the Hasse diagram, when `elements` is not specified. So passing a Hasse diagram that is on `0,1,\\ldots,n-1` will automatically make the element set equal to this.\n\nAnne \n\nPS: I fixed the doc failures that John reported except the ones in `src/sage/modular/modform_hecketriangle`\n----\nNew commits:",
    "created_at": "2014-10-12T00:22:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171461",
    "user": "https://github.com/anneschilling"
}
```

Hi Nathann,

> My mistake, I was convinced that I had displayed the poset with a `.show()` and looked at a path labelled with 0,1,2,3,... while the linear extension was 0,9,... There is nothing wrong with this example indeed.

Ok. Why does the documentation say *unique* though? It does not make sense to me.

> This being said, i still do not understand the code. Is the following behaviour correct ?
> 
> {{{
> sage: P = Poset(digraphs.Path(4),['a','b','c','d'],linear_extension=True)
> sage: list(P.canonical_label())
> [0, 1, 2, 3]
> }}}

I think so. The documentation says that `canonical_label` is supposed to label the poset with elements `\{0,1,\ldots,n-1\}`. I changed the code slightly, so that [0,1,2,...]
is a linear extension of the canonical relabeled poset.

> I do not understand what you do with the `elements` list in `canonical_label` given that the output is labelled with `0,1,2,3`. Especially when `linear_extension=False` `O_o`

The documentation says that canonical relabeled means indexed by `0,1,\ldots,n-1`. I did not write this code, so am not sure what this is used for. 

Internally, now the poset code still stores `P._hasse_diagram` as a Hasse diagram on `0,1,\ldots,n-1` to make it light-weight and only compare integers internally. The elements are taken from the Hasse diagram, when `elements` is not specified. So passing a Hasse diagram that is on `0,1,\ldots,n-1` will automatically make the element set equal to this.

Anne 

PS: I fixed the doc failures that John reported except the ones in `src/sage/modular/modform_hecketriangle`
----
New commits:



---

archive/issue_comments_171462.json:
```json
{
    "body": "Hello !\n\n> Ok. Why does the documentation say *unique* though? It does not make sense to me.\n\nTake two digraphs `D1,D2` labelled on whatever you want, and such that `D1.is_isomorphic(D2)` is True. Then `D1.canonical_label()==D2.canonical_label()` is True. In such a way, the output of `canonical_label` is unique on its isomorphism class.\n\nTo me this is a sufficient reason to raise an exception in `canonical_label` when an linear extension is defined: `DiGraph.canonical_label` ignores the linear extension, and so the output is not unique for a pair \"Poset, linear extension\".\n\nI also believe that `is_isomorphic` should raise an exception in that case.\n\n> I think so. The documentation says that `canonical_label` is supposed to label the poset with elements `\\{0,1,\\ldots,n-1\\}`. I changed the code slightly, so that [0,1,2,...]\n> is a linear extension of the canonical relabeled poset.\n\nOkay, but now the code totally ignores the linear extension that may be stored within the poset. I have nothing against that, but it would be more honest to raise an exception in that case, to say to the \"PosetWithLinearExtension\" users that they should first explicitly convert their poset to a 'normal one' before computing that. We are unable to compute a canonical label for a pair \"Poset, linear extension\" right now.\n\nNathann",
    "created_at": "2014-10-12T09:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171462",
    "user": "https://github.com/nathanncohen"
}
```

Hello !

> Ok. Why does the documentation say *unique* though? It does not make sense to me.

Take two digraphs `D1,D2` labelled on whatever you want, and such that `D1.is_isomorphic(D2)` is True. Then `D1.canonical_label()==D2.canonical_label()` is True. In such a way, the output of `canonical_label` is unique on its isomorphism class.

To me this is a sufficient reason to raise an exception in `canonical_label` when an linear extension is defined: `DiGraph.canonical_label` ignores the linear extension, and so the output is not unique for a pair "Poset, linear extension".

I also believe that `is_isomorphic` should raise an exception in that case.

> I think so. The documentation says that `canonical_label` is supposed to label the poset with elements `\{0,1,\ldots,n-1\}`. I changed the code slightly, so that [0,1,2,...]
> is a linear extension of the canonical relabeled poset.

Okay, but now the code totally ignores the linear extension that may be stored within the poset. I have nothing against that, but it would be more honest to raise an exception in that case, to say to the "PosetWithLinearExtension" users that they should first explicitly convert their poset to a 'normal one' before computing that. We are unable to compute a canonical label for a pair "Poset, linear extension" right now.

Nathann



---

archive/issue_comments_171463.json:
```json
{
    "body": "> > Ok. Why does the documentation say *unique* though? It does not make sense to me.\n> \n> Take two digraphs `D1,D2` labelled on whatever you want, and such that `D1.is_isomorphic(D2)` is True. Then `D1.canonical_label()==D2.canonical_label()` is True. In such a way, the output of `canonical_label` is unique on its isomorphism class.\n\nThat condition is fine, but the labeling of the \"canonical\" labeling is still arbitrary and not unique (as you can see, it has changed).\n\n> To me this is a sufficient reason to raise an exception in `canonical_label` when an linear extension is defined: `DiGraph.canonical_label` ignores the linear extension, and so the output is not unique for a pair \"Poset, linear extension\".\n\nWhy? Your isomorphism property is still satisfied:\n\n```\nsage: p1 = Poset(d, linear_extension=True)\nsage: p2 = p1.relabel({1:1,2:3,3:2})\nsage: q1 = p1.canonical_label()\nsage: q2 = p2.canonical_label()\nsage: q1.is_isomorphic(q2)\nTrue\nsage: q1._linear_extension\nTrue\nsage: q2._linear_extension\nTrue\n```\n\n\n> I also believe that `is_isomorphic` should raise an exception in that case.\n\nNo, it checks that the posets are isomorphic (which has nothing to do with the linear extension chosen).\n\nAnne",
    "created_at": "2014-10-12T15:47:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171463",
    "user": "https://github.com/anneschilling"
}
```

> > Ok. Why does the documentation say *unique* though? It does not make sense to me.
> 
> Take two digraphs `D1,D2` labelled on whatever you want, and such that `D1.is_isomorphic(D2)` is True. Then `D1.canonical_label()==D2.canonical_label()` is True. In such a way, the output of `canonical_label` is unique on its isomorphism class.

That condition is fine, but the labeling of the "canonical" labeling is still arbitrary and not unique (as you can see, it has changed).

> To me this is a sufficient reason to raise an exception in `canonical_label` when an linear extension is defined: `DiGraph.canonical_label` ignores the linear extension, and so the output is not unique for a pair "Poset, linear extension".

Why? Your isomorphism property is still satisfied:

```
sage: p1 = Poset(d, linear_extension=True)
sage: p2 = p1.relabel({1:1,2:3,3:2})
sage: q1 = p1.canonical_label()
sage: q2 = p2.canonical_label()
sage: q1.is_isomorphic(q2)
True
sage: q1._linear_extension
True
sage: q2._linear_extension
True
```


> I also believe that `is_isomorphic` should raise an exception in that case.

No, it checks that the posets are isomorphic (which has nothing to do with the linear extension chosen).

Anne



---

archive/issue_comments_171464.json:
```json
{
    "body": "> That condition is fine, but the labeling of the \"canonical\" labeling is still arbitrary and not unique (as you can see, it has changed).\n\nNo, it is unique. And it is always integers from 0 to n-1.\n\nTry it in Sage: take a graph `D1` labelled on whatever you want, then compute its canonical representative `R`. Then relabel the vertices of `D1` into a graph `D2` in any way you like: the representatie of `D2` will be equal to `R`.\n\n> Why? Your isomorphism property is still satisfied:\n\nTwo pairs \"Poset, linear_extension\" are \"isomorphic\" if there is an isomorphism of the two posets that sends the first linear extension on the second linear extension. But we never check this second part (and similarly for the canonical representatives).\n\nFor instance, if `P` is a poset on three points 0,1,2 where the cover relations are only (1<2), then the pair \"Poset, linear extension\" equal to `P,[0,1,2]` is not isomorphic to `P,[1,0,2]`.\n\n> No, it checks that the posets are isomorphic (which has nothing to do with the linear extension chosen).\n\nIndeed, and to me that is incorrect. It is quite simple: you cannot say that two \"posets with linear extension\" `P1,P2` are isomorphic unless there is a relabel function `f` such that `P1.relabel(f)==P2`.\n\nAs it is implemented right now this does not hold.\n\nNathann",
    "created_at": "2014-10-12T17:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171464",
    "user": "https://github.com/nathanncohen"
}
```

> That condition is fine, but the labeling of the "canonical" labeling is still arbitrary and not unique (as you can see, it has changed).

No, it is unique. And it is always integers from 0 to n-1.

Try it in Sage: take a graph `D1` labelled on whatever you want, then compute its canonical representative `R`. Then relabel the vertices of `D1` into a graph `D2` in any way you like: the representatie of `D2` will be equal to `R`.

> Why? Your isomorphism property is still satisfied:

Two pairs "Poset, linear_extension" are "isomorphic" if there is an isomorphism of the two posets that sends the first linear extension on the second linear extension. But we never check this second part (and similarly for the canonical representatives).

For instance, if `P` is a poset on three points 0,1,2 where the cover relations are only (1<2), then the pair "Poset, linear extension" equal to `P,[0,1,2]` is not isomorphic to `P,[1,0,2]`.

> No, it checks that the posets are isomorphic (which has nothing to do with the linear extension chosen).

Indeed, and to me that is incorrect. It is quite simple: you cannot say that two "posets with linear extension" `P1,P2` are isomorphic unless there is a relabel function `f` such that `P1.relabel(f)==P2`.

As it is implemented right now this does not hold.

Nathann



---

archive/issue_comments_171465.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-12T19:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171465",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171466.json:
```json
{
    "body": "Replying to [comment:66 ncohen]:\n> > That condition is fine, but the labeling of the \"canonical\" labeling is still arbitrary and not unique (as you can see, it has changed).\n> \n> No, it is unique. And it is always integers from 0 to n-1.\n>\n> Try it in Sage: take a graph `D1` labelled on whatever you want, then compute its canonical representative `R`. Then relabel the vertices of `D1` into a graph `D2` in any way you like: the representatie of `D2` will be equal to `R`.\n\n\nHowever the labeling itself is not unique. Consider the path on 3 vertices with labelings `0 - 1 - 2` and `1 - 0 - 2`. The first one is no more canonical than the second.\n\n> Two pairs \"Poset, linear_extension\" are \"isomorphic\" if there is an isomorphism of the two posets that sends the first linear extension on the second linear extension. But we never check this second part (and similarly for the canonical representatives).\n\n> For instance, if `P` is a poset on three points 0,1,2 where the cover relations are only (1<2), then the pair \"Poset, linear extension\" equal to `P,[0,1,2]` is not isomorphic to `P,[1,0,2]`.\n> \n> > No, it checks that the posets are isomorphic (which has nothing to do with the linear extension chosen).\n> \n> Indeed, and to me that is incorrect. It is quite simple: you cannot say that two \"posets with linear extension\" `P1,P2` are isomorphic unless there is a relabel function `f` such that `P1.relabel(f)==P2`.\n> \n> As it is implemented right now this does not hold.\n\nIt depends on what we want to actually check. Yet as currently stated in the documentation of `is_isomorphic`, it does return the correct value as it checks \"if both posets are isomorphic\". My thought is that *if* we decide we want to also check with a specified linear extension, then we add another argument to `is_isomorphic`. At present, the method should not raise an error, and this should probably be done on another ticket.\n\nAnyways, doctests are now all fixed.",
    "created_at": "2014-10-12T19:41:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171466",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:66 ncohen]:
> > That condition is fine, but the labeling of the "canonical" labeling is still arbitrary and not unique (as you can see, it has changed).
> 
> No, it is unique. And it is always integers from 0 to n-1.
>
> Try it in Sage: take a graph `D1` labelled on whatever you want, then compute its canonical representative `R`. Then relabel the vertices of `D1` into a graph `D2` in any way you like: the representatie of `D2` will be equal to `R`.


However the labeling itself is not unique. Consider the path on 3 vertices with labelings `0 - 1 - 2` and `1 - 0 - 2`. The first one is no more canonical than the second.

> Two pairs "Poset, linear_extension" are "isomorphic" if there is an isomorphism of the two posets that sends the first linear extension on the second linear extension. But we never check this second part (and similarly for the canonical representatives).

> For instance, if `P` is a poset on three points 0,1,2 where the cover relations are only (1<2), then the pair "Poset, linear extension" equal to `P,[0,1,2]` is not isomorphic to `P,[1,0,2]`.
> 
> > No, it checks that the posets are isomorphic (which has nothing to do with the linear extension chosen).
> 
> Indeed, and to me that is incorrect. It is quite simple: you cannot say that two "posets with linear extension" `P1,P2` are isomorphic unless there is a relabel function `f` such that `P1.relabel(f)==P2`.
> 
> As it is implemented right now this does not hold.

It depends on what we want to actually check. Yet as currently stated in the documentation of `is_isomorphic`, it does return the correct value as it checks "if both posets are isomorphic". My thought is that *if* we decide we want to also check with a specified linear extension, then we add another argument to `is_isomorphic`. At present, the method should not raise an error, and this should probably be done on another ticket.

Anyways, doctests are now all fixed.



---

archive/issue_comments_171467.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-13T00:42:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171467",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171468.json:
```json
{
    "body": "There were two more doc test failures in `combinat/ordered_trees.py` due to the non-canonical way of labeling the vertices in `canonical_label`. I fixed those. Everything else looks ok to me.\n\n>However the labeling itself is not unique. Consider the path on 3 vertices with \n>labelings 0 - 1 - 2 and 1 - 0 - 2. The first one is no more canonical than the second.\n\nPrecisely!\n\nJohn: if you are happy now, can we set it back to positive review?\n\nNathann: if you are still unhappy, please change the behavior in a different ticket. In this ticket we wanted to keep the behavior of the posets with `_linear_extension = True` as previous.",
    "created_at": "2014-10-13T00:55:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171468",
    "user": "https://github.com/anneschilling"
}
```

There were two more doc test failures in `combinat/ordered_trees.py` due to the non-canonical way of labeling the vertices in `canonical_label`. I fixed those. Everything else looks ok to me.

>However the labeling itself is not unique. Consider the path on 3 vertices with 
>labelings 0 - 1 - 2 and 1 - 0 - 2. The first one is no more canonical than the second.

Precisely!

John: if you are happy now, can we set it back to positive review?

Nathann: if you are still unhappy, please change the behavior in a different ticket. In this ticket we wanted to keep the behavior of the posets with `_linear_extension = True` as previous.



---

archive/issue_comments_171469.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-13T01:13:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171469",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171470.json:
```json
{
    "body": "Oops, sorry, I accidentally pushed the ipython change (without which my sage does not even start any longer) ... but that is a problem with the most recent develop branch.",
    "created_at": "2014-10-13T01:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171470",
    "user": "https://github.com/anneschilling"
}
```

Oops, sorry, I accidentally pushed the ipython change (without which my sage does not even start any longer) ... but that is a problem with the most recent develop branch.



---

archive/issue_comments_171471.json:
```json
{
    "body": "Should I complain here that `relabel` is also broken with return type:\n\n\n```\nP=LatticePoset({1:[2]})\nP.relabel(lambda x: x+1)\n```\n\n\noutputs \"Finite **poset** containing 2 elements\".",
    "created_at": "2014-10-13T07:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171471",
    "user": "https://github.com/jm58660"
}
```

Should I complain here that `relabel` is also broken with return type:


```
P=LatticePoset({1:[2]})
P.relabel(lambda x: x+1)
```


outputs "Finite **poset** containing 2 elements".



---

archive/issue_comments_171472.json:
```json
{
    "body": "Hello,\n\n> It depends on what we want to actually check. Yet as currently stated in the documentation of `is_isomorphic`, it does return the correct value as it checks \"if both posets are isomorphic\". My thought is that *if* we decide we want to also check with a specified linear extension, then we add another argument to `is_isomorphic`. At present, the method should not raise an error, and this should probably be done on another ticket.\n\nWell. I am convinced that you understand what is happening right now, and that you know how and why it is that while two posets object `P1,P2` may be reported to be isomorphic by Sage, it does not necessarily mean that there is a relabelling of one that makes it equal to the other. I will not fight for the bugs of this 'poset with linear extension' feature.\n\nNathann",
    "created_at": "2014-10-13T08:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171472",
    "user": "https://github.com/nathanncohen"
}
```

Hello,

> It depends on what we want to actually check. Yet as currently stated in the documentation of `is_isomorphic`, it does return the correct value as it checks "if both posets are isomorphic". My thought is that *if* we decide we want to also check with a specified linear extension, then we add another argument to `is_isomorphic`. At present, the method should not raise an error, and this should probably be done on another ticket.

Well. I am convinced that you understand what is happening right now, and that you know how and why it is that while two posets object `P1,P2` may be reported to be isomorphic by Sage, it does not necessarily mean that there is a relabelling of one that makes it equal to the other. I will not fight for the bugs of this 'poset with linear extension' feature.

Nathann



---

archive/issue_comments_171473.json:
```json
{
    "body": "Hello !\n\n> Nathann: if you are still unhappy, please change the behavior in a different ticket. In this ticket we wanted to keep the behavior of the posets with `_linear_extension = True` as previous.\n\nWell I still have to look at the commits you added, but otherwise it does it job. Thanks for fixing that bug in the end.\n\nNathann",
    "created_at": "2014-10-13T08:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171473",
    "user": "https://github.com/nathanncohen"
}
```

Hello !

> Nathann: if you are still unhappy, please change the behavior in a different ticket. In this ticket we wanted to keep the behavior of the posets with `_linear_extension = True` as previous.

Well I still have to look at the commits you added, but otherwise it does it job. Thanks for fixing that bug in the end.

Nathann



---

archive/issue_comments_171474.json:
```json
{
    "body": "Hello,\n\nBesides Jori's report, I have one question. Why did you do this change ?\n\n\n```diff\n-        G = DiGraph(self._hasse_diagram).relabel(self._list, inplace=False)\n+        G = DiGraph(self._hasse_diagram).relabel(self._elements, inplace=False)\n```\n\n\nDid the meaning of `self._list` changed in some way ? If it did, this function probably isn't the only one that needs to be updated `O_o`\n\nMore importantly: aren't `self._list` and `self._elements` the same thing ? It would be nice in a later patch to change this name is something like `linear_extension`, for it really is a pain to work with this class when variables are not named according to what they represent. And perhaps one day it will become trustworthy `:-P`\n\nThanks,\n\nNathann",
    "created_at": "2014-10-13T08:46:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171474",
    "user": "https://github.com/nathanncohen"
}
```

Hello,

Besides Jori's report, I have one question. Why did you do this change ?


```diff
-        G = DiGraph(self._hasse_diagram).relabel(self._list, inplace=False)
+        G = DiGraph(self._hasse_diagram).relabel(self._elements, inplace=False)
```


Did the meaning of `self._list` changed in some way ? If it did, this function probably isn't the only one that needs to be updated `O_o`

More importantly: aren't `self._list` and `self._elements` the same thing ? It would be nice in a later patch to change this name is something like `linear_extension`, for it really is a pain to work with this class when variables are not named according to what they represent. And perhaps one day it will become trustworthy `:-P`

Thanks,

Nathann



---

archive/issue_comments_171475.json:
```json
{
    "body": "No, `self._list` are wrapped elements (if not a facade), whereas `self._elements` are always the unwrapped elements, and we always want to label the digraph by the unwrapped elements.\n\nThe return type of relabel should be another ticket IMO.",
    "created_at": "2014-10-13T14:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171475",
    "user": "https://github.com/tscrim"
}
```

No, `self._list` are wrapped elements (if not a facade), whereas `self._elements` are always the unwrapped elements, and we always want to label the digraph by the unwrapped elements.

The return type of relabel should be another ticket IMO.



---

archive/issue_comments_171476.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-13T14:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171476",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_171477.json:
```json
{
    "body": "Replying to [comment:70 aschilling]:\n> John: if you are happy now, can we set it back to positive review?\n\nAs long as doctests pass and the documentation builds, I'm happy. I'm also not seriously reviewing this ticket -- I haven't looked at any of the code and I don't plan to -- so everyone else needs to be happy, too.",
    "created_at": "2014-10-13T15:26:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171477",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:70 aschilling]:
> John: if you are happy now, can we set it back to positive review?

As long as doctests pass and the documentation builds, I'm happy. I'm also not seriously reviewing this ticket -- I haven't looked at any of the code and I don't plan to -- so everyone else needs to be happy, too.



---

archive/issue_comments_171478.json:
```json
{
    "body": "> No, `self._list` are wrapped elements (if not a facade), whereas `self._elements` are always the unwrapped elements, and we always want to label the digraph by the unwrapped elements.\n\nOkay. Do you have any objections if later the following variables are renamed\n\n- `_list` -> `_linear_extension_of_wrapped_elements`\n- `_elements` -> `_linear_extension_of_unwrapped_elements` \n\nBy the way, what would you think in this ticket of renaming the `linear_extension` parameter you added ? The name does not sound at all like it is a boolean variable, and you create a `Poset._linear_extension` variable which is boolean. If you renamed it to `Poset._carries_linear_extension` or something (whose name sounds like a boolean variable) we could rename `_list` to `_linear_extension` and `_elements` to `_linear_extension_unwrapped_elements` (which I think is better/shorter).\n\nThe thing is that if we have to rename `linear_extension` later we will have to deprecate it --> loss of time.\n\nNathann",
    "created_at": "2014-10-13T15:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171478",
    "user": "https://github.com/nathanncohen"
}
```

> No, `self._list` are wrapped elements (if not a facade), whereas `self._elements` are always the unwrapped elements, and we always want to label the digraph by the unwrapped elements.

Okay. Do you have any objections if later the following variables are renamed

- `_list` -> `_linear_extension_of_wrapped_elements`
- `_elements` -> `_linear_extension_of_unwrapped_elements` 

By the way, what would you think in this ticket of renaming the `linear_extension` parameter you added ? The name does not sound at all like it is a boolean variable, and you create a `Poset._linear_extension` variable which is boolean. If you renamed it to `Poset._carries_linear_extension` or something (whose name sounds like a boolean variable) we could rename `_list` to `_linear_extension` and `_elements` to `_linear_extension_unwrapped_elements` (which I think is better/shorter).

The thing is that if we have to rename `linear_extension` later we will have to deprecate it --> loss of time.

Nathann



---

archive/issue_comments_171479.json:
```json
{
    "body": "Replying to [comment:79 ncohen]:\n> > No, `self._list` are wrapped elements (if not a facade), whereas `self._elements` are always the unwrapped elements, and we always want to label the digraph by the unwrapped elements.\n> \n> Okay. Do you have any objections if later the following variables are renamed\n> \n> - `_list` -> `_linear_extension_of_wrapped_elements`\n> - `_elements` -> `_linear_extension_of_unwrapped_elements` \n> \n> By the way, what would you think in this ticket of renaming the `linear_extension` parameter you added ? The name does not sound at all like it is a boolean variable, and you create a `Poset._linear_extension` variable which is boolean. If you renamed it to `Poset._carries_linear_extension` or something (whose name sounds like a boolean variable) we could rename `_list` to `_linear_extension` and `_elements` to `_linear_extension_unwrapped_elements` (which I think is better/shorter).\n> \n> The thing is that if we have to rename `linear_extension` later we will have to deprecate it --> loss of time.\n> \n> Nathann\n\nGo ahead and write a review patch which makes these changes!\n\nAnne",
    "created_at": "2014-10-13T16:49:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171479",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:79 ncohen]:
> > No, `self._list` are wrapped elements (if not a facade), whereas `self._elements` are always the unwrapped elements, and we always want to label the digraph by the unwrapped elements.
> 
> Okay. Do you have any objections if later the following variables are renamed
> 
> - `_list` -> `_linear_extension_of_wrapped_elements`
> - `_elements` -> `_linear_extension_of_unwrapped_elements` 
> 
> By the way, what would you think in this ticket of renaming the `linear_extension` parameter you added ? The name does not sound at all like it is a boolean variable, and you create a `Poset._linear_extension` variable which is boolean. If you renamed it to `Poset._carries_linear_extension` or something (whose name sounds like a boolean variable) we could rename `_list` to `_linear_extension` and `_elements` to `_linear_extension_unwrapped_elements` (which I think is better/shorter).
> 
> The thing is that if we have to rename `linear_extension` later we will have to deprecate it --> loss of time.
> 
> Nathann

Go ahead and write a review patch which makes these changes!

Anne



---

archive/issue_comments_171480.json:
```json
{
    "body": "Replying to [comment:77 tscrim]:\n\n> The return type of relabel should be another ticket IMO.\n\nOK, let it be part of #17142.",
    "created_at": "2014-10-13T17:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171480",
    "user": "https://github.com/jm58660"
}
```

Replying to [comment:77 tscrim]:

> The return type of relabel should be another ticket IMO.

OK, let it be part of #17142.



---

archive/issue_comments_171481.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-10-13T21:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171481",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_171482.json:
```json
{
    "body": "> Go ahead and write a review patch which makes these changes!\n\nI will. The branch still does not pass tests though\n\n\n```\nsage -t --long src/sage/categories/finite_coxeter_groups.py\n```\n\n\nNathann",
    "created_at": "2014-10-13T21:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171482",
    "user": "https://github.com/nathanncohen"
}
```

> Go ahead and write a review patch which makes these changes!

I will. The branch still does not pass tests though


```
sage -t --long src/sage/categories/finite_coxeter_groups.py
```


Nathann



---

archive/issue_comments_171483.json:
```json
{
    "body": "Replying to [comment:82 ncohen]:\n> > Go ahead and write a review patch which makes these changes!\n> \n> I will. The branch still does not pass tests though\n> \n> {{{\n> sage -t --long src/sage/categories/finite_coxeter_groups.py\n> }}}\n\nOn both Travis' and my machine there is no problem\n\n```\nsage -t --long finite_coxeter_groups.py\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2014-10-13-14-15-29-a31aa4aa.\nDoctesting 1 file.\nsage -t --long finite_coxeter_groups.py\n    [91 tests, 7.57 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 8.0 seconds\n    cpu time: 6.1 seconds\n    cumulative wall time: 7.6 seconds\n```\n\nPlease post at least the error that you get!",
    "created_at": "2014-10-13T21:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171483",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:82 ncohen]:
> > Go ahead and write a review patch which makes these changes!
> 
> I will. The branch still does not pass tests though
> 
> {{{
> sage -t --long src/sage/categories/finite_coxeter_groups.py
> }}}

On both Travis' and my machine there is no problem

```
sage -t --long finite_coxeter_groups.py
too few successful tests, not using stored timings
Running doctests with ID 2014-10-13-14-15-29-a31aa4aa.
Doctesting 1 file.
sage -t --long finite_coxeter_groups.py
    [91 tests, 7.57 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 8.0 seconds
    cpu time: 6.1 seconds
    cumulative wall time: 7.6 seconds
```

Please post at least the error that you get!



---

archive/issue_comments_171484.json:
```json
{
    "body": "Yo !\n\n> On both Travis' and my machine there is no problem\n\n`O_o`\n\nWeird.\n\n> Please post at least the error that you get!\n\nI get three things like that\n\n\n```\nsage -t --long categories/finite_coxeter_groups.py\n**********************************************************************\nFile \"categories/finite_coxeter_groups.py\", line 143, in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.bruhat_poset\nFailed example:\n    P.show()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 851, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.bruhat_poset[3]>\", line 1, in <module>\n        P.show()\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py\", line 1523, in show\n        vertex_size=vertex_size, vertex_colors=vertex_colors, layout=layout).show(**kwds)\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py\", line 1497, in plot\n        **kwds)\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/misc/decorators.py\", line 550, in wrapper\n        return func(*args, **options)\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 15675, in plot\n        return self.graphplot(**options).plot()\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 15376, in graphplot\n        return GraphPlot(graph=self, options=options)\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py\", line 247, in __init__\n        self.set_vertices()\n      File \"/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py\", line 426, in set_vertices\n        self._pos[v], rgbcolor=(0,0,0), zorder=8))\n    KeyError: [0 0 1]\n    [0 1 0]\n    [1 0 0]\n\n```\n\n\nNathann",
    "created_at": "2014-10-13T21:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171484",
    "user": "https://github.com/nathanncohen"
}
```

Yo !

> On both Travis' and my machine there is no problem

`O_o`

Weird.

> Please post at least the error that you get!

I get three things like that


```
sage -t --long categories/finite_coxeter_groups.py
**********************************************************************
File "categories/finite_coxeter_groups.py", line 143, in sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.bruhat_poset
Failed example:
    P.show()
Exception raised:
    Traceback (most recent call last):
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 851, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.categories.finite_coxeter_groups.FiniteCoxeterGroups.ParentMethods.bruhat_poset[3]>", line 1, in <module>
        P.show()
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1523, in show
        vertex_size=vertex_size, vertex_colors=vertex_colors, layout=layout).show(**kwds)
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/combinat/posets/posets.py", line 1497, in plot
        **kwds)
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/misc/decorators.py", line 550, in wrapper
        return func(*args, **options)
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 15675, in plot
        return self.graphplot(**options).plot()
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 15376, in graphplot
        return GraphPlot(graph=self, options=options)
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py", line 247, in __init__
        self.set_vertices()
      File "/home/ncohen/.Sage/local/lib/python2.7/site-packages/sage/graphs/graph_plot.py", line 426, in set_vertices
        self._pos[v], rgbcolor=(0,0,0), zorder=8))
    KeyError: [0 0 1]
    [0 1 0]
    [1 0 0]

```


Nathann



---

archive/issue_comments_171485.json:
```json
{
    "body": "Do you get these errors without the branch applied?\n\nAnne",
    "created_at": "2014-10-13T21:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171485",
    "user": "https://github.com/anneschilling"
}
```

Do you get these errors without the branch applied?

Anne



---

archive/issue_comments_171486.json:
```json
{
    "body": "> Do you get these errors without the branch applied?\n\nI do not.",
    "created_at": "2014-10-13T21:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171486",
    "user": "https://github.com/nathanncohen"
}
```

> Do you get these errors without the branch applied?

I do not.



---

archive/issue_comments_171487.json:
```json
{
    "body": "Works for me in a sage session too; same for `view(P, tightpage=True)`.\n\nFTR, I have Coxeter3, dot2tex, database_gap, and gap_packages installed on my machine.",
    "created_at": "2014-10-13T21:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171487",
    "user": "https://github.com/tscrim"
}
```

Works for me in a sage session too; same for `view(P, tightpage=True)`.

FTR, I have Coxeter3, dot2tex, database_gap, and gap_packages installed on my machine.



---

archive/issue_comments_171488.json:
```json
{
    "body": "For what it's worth, I see the same errors as Nathann both on sage.math and on an OS X 10.9 machine.",
    "created_at": "2014-10-13T23:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171488",
    "user": "https://github.com/jhpalmieri"
}
```

For what it's worth, I see the same errors as Nathann both on sage.math and on an OS X 10.9 machine.



---

archive/issue_comments_171489.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-14T02:25:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171489",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171490.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-14T02:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171490",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_171491.json:
```json
{
    "body": "This should fix the problems. I reverted the change that made `hasse_diagram()`'s labels be the labels as opposed to (for non-facade parents) elements of the poset. I also made a related change in `dual()`. I uninstalled dot2tex from my machine and was able to reproduce the error and checked things in that state and after re-installing dot2tex.",
    "created_at": "2014-10-14T02:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171491",
    "user": "https://github.com/tscrim"
}
```

This should fix the problems. I reverted the change that made `hasse_diagram()`'s labels be the labels as opposed to (for non-facade parents) elements of the poset. I also made a related change in `dual()`. I uninstalled dot2tex from my machine and was able to reproduce the error and checked things in that state and after re-installing dot2tex.



---

archive/issue_comments_171492.json:
```json
{
    "body": "FTR, this conflicts with #16933 which also removes the `p(i)` for `p[i]` thing.",
    "created_at": "2014-10-14T06:41:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171492",
    "user": "https://github.com/tscrim"
}
```

FTR, this conflicts with #16933 which also removes the `p(i)` for `p[i]` thing.



---

archive/issue_comments_171493.json:
```json
{
    "body": "Okay, after having tried again I will not rename those attributes `._list` and `._elements`, for it breaks doctests everywhere as everybody calls the private parameters directly.\n\nNathann",
    "created_at": "2014-10-14T13:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171493",
    "user": "https://github.com/nathanncohen"
}
```

Okay, after having tried again I will not rename those attributes `._list` and `._elements`, for it breaks doctests everywhere as everybody calls the private parameters directly.

Nathann



---

archive/issue_comments_171494.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-14T13:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171494",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171495.json:
```json
{
    "body": "Replying to [comment:93 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[e677d31](http://git.sagemath.org/sage.git/commit/?id=e677d31fa4e40822bcd00c509dd1ca94ed6de52d)||`trac #14019: rename _linear_extension to _carries_linear_extension`||\n\nThanks so much everyone for your work on this! Big kuddos to Anne and Travis for taking the lead!\n\nI read the discussion, and the decisions taken make sense to me. I still need to have a look at the code, but what I had seen in an earlier version Anne had pointed me too was looking good, so feel free to proceed anyway.\n\nJust one thing: I would prefer `_with_linear_extension rather` than `_carries_linear_extensions` since we already use this convention in our \"WithBasis\" and friends. I can do this change if you wish.",
    "created_at": "2014-10-14T17:23:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171495",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:93 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[e677d31](http://git.sagemath.org/sage.git/commit/?id=e677d31fa4e40822bcd00c509dd1ca94ed6de52d)||`trac #14019: rename _linear_extension to _carries_linear_extension`||

Thanks so much everyone for your work on this! Big kuddos to Anne and Travis for taking the lead!

I read the discussion, and the decisions taken make sense to me. I still need to have a look at the code, but what I had seen in an earlier version Anne had pointed me too was looking good, so feel free to proceed anyway.

Just one thing: I would prefer `_with_linear_extension rather` than `_carries_linear_extensions` since we already use this convention in our "WithBasis" and friends. I can do this change if you wish.



---

archive/issue_comments_171496.json:
```json
{
    "body": "> Just one thing: I would prefer `_with_linear_extension rather` than `_carries_linear_extensions` since we already use this convention in our \"WithBasis\" and friends. I can do this change if you wish.\n\nThat is fine with me! Travis and I are done with the patch, so you can change whatever you two agree on!\n\nBest,\n\nAnne",
    "created_at": "2014-10-14T18:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171496",
    "user": "https://github.com/anneschilling"
}
```

> Just one thing: I would prefer `_with_linear_extension rather` than `_carries_linear_extensions` since we already use this convention in our "WithBasis" and friends. I can do this change if you wish.

That is fine with me! Travis and I are done with the patch, so you can change whatever you two agree on!

Best,

Anne



---

archive/issue_comments_171497.json:
```json
{
    "body": "> That is fine with me! Travis and I are done with the patch, so you can change whatever you two agree on!\n\nNo prob !\n\nNathann",
    "created_at": "2014-10-15T07:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171497",
    "user": "https://github.com/nathanncohen"
}
```

> That is fine with me! Travis and I are done with the patch, so you can change whatever you two agree on!

No prob !

Nathann



---

archive/issue_comments_171498.json:
```json
{
    "body": "Replying to [comment:96 ncohen]:\n> > That is fine with me! Travis and I are done with the patch, so you can change whatever you two agree on!\n> \n> No prob !\n\nAre we done now and can set positive review?\n\nAnne",
    "created_at": "2014-10-16T05:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171498",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:96 ncohen]:
> > That is fine with me! Travis and I are done with the patch, so you can change whatever you two agree on!
> 
> No prob !

Are we done now and can set positive review?

Anne



---

archive/issue_comments_171499.json:
```json
{
    "body": "> Are we done now and can set positive review?\n\nNicolas wants to rename something.\n\nNathann",
    "created_at": "2014-10-16T05:07:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171499",
    "user": "https://github.com/nathanncohen"
}
```

> Are we done now and can set positive review?

Nicolas wants to rename something.

Nathann



---

archive/issue_comments_171500.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-16T21:28:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171500",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171501.json:
```json
{
    "body": "I renamed `_carries_linear_extension` to `_with_linear_extension`. Please set a positive review now if you are happy!\n\nAnne",
    "created_at": "2014-10-16T21:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171501",
    "user": "https://github.com/anneschilling"
}
```

I renamed `_carries_linear_extension` to `_with_linear_extension`. Please set a positive review now if you are happy!

Anne



---

archive/issue_comments_171502.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-17T01:55:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171502",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171503.json:
```json
{
    "body": "I've handled the conflict from #16933, so we're back to positive review.",
    "created_at": "2014-10-17T01:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171503",
    "user": "https://github.com/tscrim"
}
```

I've handled the conflict from #16933, so we're back to positive review.



---

archive/issue_comments_171504.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-17T01:56:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171504",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_171505.json:
```json
{
    "body": "Breaks docbuild after #16933 is applied.",
    "created_at": "2014-10-17T14:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171505",
    "user": "https://github.com/vbraun"
}
```

Breaks docbuild after #16933 is applied.



---

archive/issue_comments_171506.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-10-17T14:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171506",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_171507.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-17T20:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171507",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_171508.json:
```json
{
    "body": "Fixed. What had happened is we removed a reference (because it was a duplicate), but without deleting the doc first, there was still a reference for sphinx, which is why we didn't catch it before when we checked that the doc builds.",
    "created_at": "2014-10-17T20:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171508",
    "user": "https://github.com/tscrim"
}
```

Fixed. What had happened is we removed a reference (because it was a duplicate), but without deleting the doc first, there was still a reference for sphinx, which is why we didn't catch it before when we checked that the doc builds.



---

archive/issue_comments_171509.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-10-17T20:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171509",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_013646.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-18T18:19:34Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13815#event-13646"
}
```



---

archive/issue_comments_171510.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-18T18:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171510",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_171511.json:
```json
{
    "body": "Thanks Anne for finalizing!",
    "created_at": "2014-10-19T17:05:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13815",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13815#issuecomment-171511",
    "user": "https://github.com/nthiery"
}
```

Thanks Anne for finalizing!
