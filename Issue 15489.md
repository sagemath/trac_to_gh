# Issue 15489: Implement tensor modules and algebras

Issue created by migration from Trac.

Original creator: tscrim

Original creation time: 2014-01-24 16:39:29

Assignee: sage-combinat

CC:  sage-combinat nthiery mshimo

Keywords: tensor module algebra




---

Comment by tscrim created at 2014-02-08 17:39:24

Last 10 new commits:


---

Comment by tscrim created at 2014-02-08 17:39:24

Changing status from new to needs_review.


---

Comment by nthiery created at 2014-02-10 10:56:27

Hi Travis!

Thanks for your work on free monoids and algebras; those features have been waiting around for too long! I glanced through the code, and here are some random thoughts that came to my mind:

- Rather than importing `IndexedFreeMonoid` in the global namespace,
  it would be preferable to have `FreeMonoid(...)` construct an
  `IndexedFreeMonoid` when given appropriate arguments (and same
  things for its friends). Let's avoid the bad route we took with
  `CombinatorialFreeModule` and have at once a single entry point for
  free monoids! As an immediate side effect, the current code for
  the `FreeAlgebra` might well make it almost immediately work for any
  index set.

- Mathematically speaking, the free algebra indexed by I is
  (isomorphic to) the algebra of the free monoid indexed by I is
  (isomorphic to) the tensor algebra of the free module indexed by I. So we now have three implementations of the free algebra!

  I'd rather only have a single implementation, typically in
  `FreeAlgebra(K, I)`, with `FreeMonoid(I).algebra(K)`
  pointing to it.

  `FreeAlgebra(K, I)` should by the way be in the category
  Monoids().Algebras(K) which could allow for reusing some generic
  code.

  `TensorAlgebra(V)` could then also point to `FreeAlgebra(K, I)`.
  Possibly with some customization (e.g. printing using tensor symbol).

  By the way, with the name `TensorAlgebra`, the user would probably
  expect to write the product using tensor rather than *. Actually I
  am not yet sure we actually want at this point to have
  `TensorAlgebra` with multiplicative notation.

  Altogether, since `TensorAlgebra` does not bring a feature set
  really different from `FreeAlgebra`, I'd rather leave it name alone
  for now until we have a better view on how we want to handle
  tensor/symmetric/exterior modules.

- It could be preferable to have `TensorModule` be a functorial
  construction, parallel to that for tensor products, and if
  possible sharing as much code as possible with it.

- On a similar footing, the code for _repr_, _latex_, ... in
  `TensorModule` is duplicated from
  `CombinatorialFreeModule_Tensor`.  Can we avoid that?

- `IndexedFreeAbelianGroup`: do we want to write them additively or
  multiplicatively? In the later case, code could be shared with
  `CombinatorialFreeModule`.

- `TensorModule.algebra`: this definition of .algebra is incompatible
  with the functorial construction with the same name
  (`I.algebra()` builds an algebra whose basis is indexed by
  I). Do we really need this method?

- `is_finite` methods for `Free...Monoid`: this would be
  best achieved by setting the category appropriately.

- `IndexedMonoidElement`: Describe the data structure

- The doctests of __init__ actually constructs an
  `IndexedFreeAbelianMonoid`. Is this on purpose?

- `_mul_(self, y)` -> `_mul_(self, other)`

- What is the semantic of comparisons (__lt__, ...)? Do we really
  need those comparisons?

- __pow__: Can't we use a generic implementation?

- IndexedMonoid.__contains__ seems generic enough to be lifted
  higher up in the class hierarchy

- _an_element_: rather do the product of the first three elements
  (if available), similar to what's done in
  CombinatorialFreeModule.an_element. This is less demanding on the
  index set (computing the cardinality may be expensive/not
  implemented)

- gens: using `PoorManMap` in `CombinatorialFreeModule.monomial`
  is relevant to make it easy to allow for the short idiom:
  `M.module_morphism(M.monomial*...)`. Do we need it here?

- gens: define instead monoid_generators. gens defers by default to
  monoid_generators in the monoids category (at least with #10963).

- ngens: kill the beast. `self.gens().cardinality()` is a better
  idiom. If we really want a shortcut, it should live in a more
  generic setting.


---

Comment by git created at 2014-03-04 18:18:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-03-13 05:35:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-04-02 01:38:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2014-04-05 16:07:26

Is there any connection and/or overlap between this ticket and #15916?


---

Comment by tscrim created at 2014-04-05 16:15:01

This is for a given basis of the underlying vector space, whereas #15916 is a coordinate free approach (at least, that's how I understand #15916).


---

Comment by git created at 2014-04-09 01:55:45

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by egourgoulhon created at 2014-04-12 14:24:15

Replying to [comment:10 tscrim]:
> This is for a given basis of the underlying vector space, whereas #15916 is a coordinate free approach (at least, that's how I understand #15916).

See also my reply in ticket:15916#comment:5. Am I correct about the tensor symmetries?


---

Comment by tscrim created at 2014-04-12 14:49:40

For this, tensor symmetries are irrelevent since we are constructing the tensor algebra from a single vector space. There is something for tensor products of arbitrary free modules in `combinat/free_module.py`, but because we want a specified/distinguished basis, we can't identify `A \otimes B` with `B \otimes A` (as objects in memory).


---

Comment by git created at 2014-04-15 02:24:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-25 06:53:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-07-25 07:14:22

I've removed `TensorModule` and just made it into `TensorAlgebra` since we always have a natural algebra structure. I've also made some fixes based upon the changes in #15289.

There is one feature that `TensorAlgebra` has different from `FreeAlgebra`, and that is handling coercions from finite tensor products of modules (which all coerce into the base module of `TensorAlgebra`). `TensorAlgebra` also has the Hopf algebra structure defined on it.

However they probably should be some subclassing of `FreeAlgebra` and/or `CombinatorialFreeModule_Tensor`. I haven't made it a functorial construction yet. Also `tensor` should not be the multiplication of two tensor algebra elements, but instead return the element in the tensor product of tensor algebras (this is not isomorphic to the tensor algebra since `(1 # b) * (c # 1) = (c # 1) * (1 # b)` where `b,c` are any elements the tensor algebra). So there is still room for improvement.


---

Comment by git created at 2014-11-23 03:10:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2014-11-23 03:22:28

I've rebased this and added the construction functor. From doing some reading (on wikipedia), the tensor algebra is a different construction than the free algebra, as this is a functor from modules to algebras, whereas the free algebra is a functor from sets to algebras (well...should be as the `construction()` and the corresponding functor currently isn't implemented).

FTR, I felt that it was better to not put `TensorAlgebraFunctor` as `TensorAlgebra` in the global namespace (instead injecting the class `TensorAlgebra`) because we would have syntax like `TensorAlgebra(M.base_ring())(M)`. Plus having it accessible via `construction()` seems to be what we currently do in Sage.


---

Comment by chapoton created at 2015-08-07 06:42:16

does not apply, needs rebase


---

Comment by chapoton created at 2015-08-07 06:42:16

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-08-07 16:32:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-08-07 16:33:46

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2015-08-07 17:49:34

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2015-08-07 17:49:34

two failing doctests


---

Comment by git created at 2015-08-07 23:20:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-08-07 23:20:35

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2015-08-07 23:20:35

Fixed. The location of the `ascii_art` moved.


---

Comment by chapoton created at 2015-10-14 16:58:46

some failing doctests


---

Comment by chapoton created at 2015-10-14 16:58:46

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-10-15 14:35:58

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2015-10-15 14:36:20

Changing status from needs_work to needs_review.


---

Comment by git created at 2016-02-28 08:13:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-05-31 19:03:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-09-01 22:17:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-09-01 22:18:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2016-09-01 22:18:58

I've just push a review commit. Couldn't check the doctests yet (Sage is still compiling), but if anything's wrong I suspect a syntax error in my doctests. If the tests pass and you're fine with the changes, this is a positive review!


---

Comment by git created at 2016-09-02 04:06:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2016-09-02 04:08:29

OK, that was quite a few failing doctests, mostly just me being careless. Fixed... with one big exception: almost none of the coercion doctests work! Most strikingly, this here:

```
            sage: C = CombinatorialFreeModule(ZZ, Set([1,2]))
            sage: TAC = TensorAlgebra(C)
            sage: c = C.monomial(2)
            sage: TAC(c)
```

blows up! I don't understand coercion well enough to fix this; this probably needs you, Travis.

That said, some of my coercion doctests might be expecting too much.


---

Comment by git created at 2016-09-02 23:15:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2016-09-02 23:17:52

I've fixed the issues. The first is that the indexed (free) monoid was not handling creating its elements properly when given a list (well, a finite enumerated set by the time it gets through the `__classcall__`). The second is #21405. I've elected to simply remove those tests for now since it is not a bug per se and the issues are independent.


---

Comment by git created at 2016-09-03 04:24:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by darij created at 2016-09-03 04:25:26

Thanks, this was a good edit.

But now that #21405 is as good as reviewed, I've put the doctests back (slightly corrected). They work!


---

Comment by git created at 2016-09-03 16:11:12

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2016-09-03 16:12:31

The issues brought up on #21405 is precisely why I kept them independent. I've reverted back the addition of #21405.


---

Comment by darij created at 2016-09-03 16:31:02

Thanks -- but is changing the commit back enough, or should we also make a new branch?


---

Comment by tscrim created at 2016-09-03 16:31:39

I set the branch to point back to the old commit, so it is enough.


---

Comment by darij created at 2016-09-03 16:33:42

Ah, I see. I was distracted by the change to `free_module.py`.


---

Comment by darij created at 2016-09-03 16:34:56

EDI:T ignore


---

Comment by darij created at 2016-09-03 16:36:02

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2016-09-03 16:38:55

Thanks for the review.


---

Comment by vbraun created at 2016-09-04 13:38:14

Resolution: fixed
