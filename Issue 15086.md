# Issue 15086: Upgrade GCC 4.8 series spkg to 4.8.2

Issue created by migration from https://trac.sagemath.org/ticket/15323

Original creator: jpflori

Original creation time: 2013-10-25 07:03:59

A straightforward replacement of the src dir (and cleaning up with spkg-src) seems enough.
Note that:
* #14460 (http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56982) is not fixed
* it fails on Cygwin because libbacktrace passes -Werror which errors out as -fPIC is also passed but results in a warning (and so an error with -Werror) on Cygwin We need to configure it with --disable-werror, see http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56057 .

It seems this is currently an experimental spkg, maybe it could be moved to optional?


---

Comment by vbraun created at 2013-10-25 13:48:40

Do you have a spkg url? ;-) Does it work on the git directory layout?


---

Comment by jpflori created at 2013-10-30 10:05:38

No url yet, just a dirty spkg.

What's the requirement for the git layout?
That everything not in the "upstream" tarball (which can be stripped, include additional files) is tracked?


---

Comment by vbraun created at 2013-10-30 10:37:51

yes, see also the existing examples.


---

Comment by jpflori created at 2013-10-30 16:35:42

It did not seem to me that the spkg needed special treatment for the git layout though I have no access to a git install these days so I might be wrong.

Use spkg at http://boxen.math.washington.edu/home/jpflori/spkg/gcc-4.8.2.spkg

Tested on Cygwin and Ubuntu.


---

Comment by jpflori created at 2013-10-30 16:36:04

Spkg diff, for review only.


---

Comment by jpflori created at 2013-10-30 16:37:51

Changing status from new to needs_review.


---

Attachment

Even though I've set the permission right on the spkg on boxen, the link gives me a 403 error.
Maybe some magic caching issue somewhere deep in the internet.


---

Comment by jdemeyer created at 2013-10-31 09:37:36

You forgot to change the version number in `SPKG.txt`.

The only reason it's experimental is because it hasn't been tested on many systems and because the requirement of having a C++ compiler is an extra step compared to GCC-4.7.x.


---

Comment by jdemeyer created at 2013-10-31 09:39:24

Also, I would pass `--disable-werror` everywhere (it can't hurt on other systems, right?)


---

Comment by jpflori created at 2013-10-31 10:03:16

Passing --disable-werrror shouldn't hurt, but a priori it is only needed on Cygwin.
So it could only let relevant (and unexpected) warnings pass unnoticed on other systems.
I don't have a strong opinion about that though.

spkg update with correct version number.


---

Comment by jdemeyer created at 2013-10-31 10:07:05

Replying to [comment:8 jpflori]:
> I don't have a strong opinion about that though.
I have had bad experiences with `-Werror` in the past, where a perfectly fine program refused to compile because of a harmless warning. I believe that `-Werror` should never be used by default. It is useful for maintainers of a package to check their compilation, but only for this.


---

Comment by jpflori created at 2013-10-31 10:12:41

Let's pass it everywhere then.

Please don't download the spkg right now.


---

Comment by jpflori created at 2013-10-31 10:20:31

Hum, looking backa t my virtual machine seems to indicate that --disable-werror is still broken anyway...
Note that http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56057 was assessing the contrary.
So I might need to include a more involved patch as I originally did for my personal use.


---

Comment by jpflori created at 2013-10-31 10:20:31

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2013-10-31 10:35:48

Too bad that #14460 still isn't fixed...


---

Comment by jpflori created at 2013-10-31 16:03:34

See http://gcc.gnu.org/bugzilla/show_bug.cgi?id=32193 as well as far as -Werror is concerned.


---

Comment by jpflori created at 2013-11-06 21:06:46

A fix as in #15366 should be included as well.


---

Comment by jpflori created at 2014-04-23 14:43:16

And GCC 4.9 is now released (though Sage does not build with it, #16208).


---

Comment by jpflori created at 2014-10-20 08:16:18

We should surely close this one as an upgrade to 4.9.x is planned at #17169.


---

Comment by jpflori created at 2014-10-27 16:21:22

Let's also close this one.


---

Comment by jpflori created at 2014-10-27 16:21:22

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2014-10-27 16:23:23

Resolution: duplicate
