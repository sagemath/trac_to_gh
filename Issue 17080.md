# Issue 17080: Add unit_group() method to IntegerModRing

archive/issues_017080.json:
```json
{
    "body": "CC:  @rbeezer fwclarke @kcrisman @categorie jpflori\n\nKeywords: unit group\n\nThis ticket implements a `unit_group()` method for **Z**/*n***Z**.  Example:\n\n```\nsage: A = Zmod(24)\nsage: G = A.unit_group(); G\nMultiplicative Abelian group isomorphic to C2 x C2 x C2\nsage: G.gens_orders()\n(2, 2, 2)\nsage: G.gens_values()\n(7, 13, 17)\n```\n\n\nAt the moment, there is no new class for such groups; it uses `AbelianGroupWithValues`.  However, this could easily be changed in the future if required.\n\nThe `unit_group()` method admits an optional `algorithm` argument (default: `'sage'`).  This can be set to `'pari'` to use PARI's `znstar()` function (see #17315).  This gives different generators in general.\n\nThe ticket also makes the set of generators for *n* = 1 be the empty set, and makes Dirichlet characters modulo 1 and 2 print as\n\n```\nsage: DirichletGroup(1)[0]\nDirichlet character modulo 1 of conductor 1\nsage: DirichletGroup(2)[0]\nDirichlet character modulo 2 of conductor 1\n```\n\ni.e. without the `mapping ...` appearing in\n\n```\nsage: DirichletGroup(3)[1]\nDirichlet character modulo 3 of conductor 1 mapping 2 |--> -1\n```\n\n\nSee also:\n\n- #7234\n- https://groups.google.com/forum/#!topic/sage-devel/T5A_gwrtZT0\n\nIssue created by migration from https://trac.sagemath.org/ticket/17317\n\n",
    "created_at": "2014-11-12T00:16:58Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Add unit_group() method to IntegerModRing",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17080",
    "user": "https://github.com/pjbruin"
}
```
CC:  @rbeezer fwclarke @kcrisman @categorie jpflori

Keywords: unit group

This ticket implements a `unit_group()` method for **Z**/*n***Z**.  Example:

```
sage: A = Zmod(24)
sage: G = A.unit_group(); G
Multiplicative Abelian group isomorphic to C2 x C2 x C2
sage: G.gens_orders()
(2, 2, 2)
sage: G.gens_values()
(7, 13, 17)
```


At the moment, there is no new class for such groups; it uses `AbelianGroupWithValues`.  However, this could easily be changed in the future if required.

The `unit_group()` method admits an optional `algorithm` argument (default: `'sage'`).  This can be set to `'pari'` to use PARI's `znstar()` function (see #17315).  This gives different generators in general.

The ticket also makes the set of generators for *n* = 1 be the empty set, and makes Dirichlet characters modulo 1 and 2 print as

```
sage: DirichletGroup(1)[0]
Dirichlet character modulo 1 of conductor 1
sage: DirichletGroup(2)[0]
Dirichlet character modulo 2 of conductor 1
```

i.e. without the `mapping ...` appearing in

```
sage: DirichletGroup(3)[1]
Dirichlet character modulo 3 of conductor 1 mapping 2 |--> -1
```


See also:

- #7234
- https://groups.google.com/forum/#!topic/sage-devel/T5A_gwrtZT0

Issue created by migration from https://trac.sagemath.org/ticket/17317





---

archive/issue_comments_226852.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-11-12T00:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226852",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_226853.json:
```json
{
    "body": "First impressions:\n\n1. I find the examples in the doctest all rather simple. It doesn't really show how different the `algorithm=\"sage\"` and `algorithm=\"pari\"` can be. I would add `Zmod(319)` as example. Also a larger example, say `Zmod(lcm([1..40]))` or so...\n\n2. I would add a `**kwds` argument to `unit_gens()`:\n\n```\ndef unit_gens(self, **kwds):\n    return self.unit_group(**kwds).gens_values()\n```\n\n\n3. And a nitpick: I prefer to see `repr(algorithm)` in the error message, something like:\n\n```\nraise ValueError('unknown algorithm %r for computing the unit group' % algorithm)\n```\n\nThis error should also be doctested in a `TESTS::` block.",
    "created_at": "2014-11-13T12:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226853",
    "user": "https://github.com/jdemeyer"
}
```

First impressions:

1. I find the examples in the doctest all rather simple. It doesn't really show how different the `algorithm="sage"` and `algorithm="pari"` can be. I would add `Zmod(319)` as example. Also a larger example, say `Zmod(lcm([1..40]))` or so...

2. I would add a `**kwds` argument to `unit_gens()`:

```
def unit_gens(self, **kwds):
    return self.unit_group(**kwds).gens_values()
```


3. And a nitpick: I prefer to see `repr(algorithm)` in the error message, something like:

```
raise ValueError('unknown algorithm %r for computing the unit group' % algorithm)
```

This error should also be doctested in a `TESTS::` block.



---

archive/issue_comments_226854.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-11-13T12:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226854",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_226855.json:
```json
{
    "body": "I would also add doctests for the special cases `Zmod(1)` and `Zmod(2)`",
    "created_at": "2014-11-13T12:49:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226855",
    "user": "https://github.com/jdemeyer"
}
```

I would also add doctests for the special cases `Zmod(1)` and `Zmod(2)`



---

archive/issue_comments_226856.json:
```json
{
    "body": "If possible, I would like to see the changes to the Dirichlet character stuff in a different ticket (to make reviewing easier).",
    "created_at": "2014-11-13T12:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226856",
    "user": "https://github.com/jdemeyer"
}
```

If possible, I would like to see the changes to the Dirichlet character stuff in a different ticket (to make reviewing easier).



---

archive/issue_comments_226857.json:
```json
{
    "body": "Why not\n\n```\nfrom sage.rings.arith import primitive_root\n\ndef _unit_gens_primecase(p):\n    return primitive_root(p, check=False)\n\ndef _unit_gens_primepowercase(p, r):\n    return primitive_root(p**r, check=False)\n```\n",
    "created_at": "2014-11-13T13:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226857",
    "user": "https://github.com/jdemeyer"
}
```

Why not

```
from sage.rings.arith import primitive_root

def _unit_gens_primecase(p):
    return primitive_root(p, check=False)

def _unit_gens_primepowercase(p, r):
    return primitive_root(p**r, check=False)
```




---

archive/issue_comments_226858.json:
```json
{
    "body": "For number fields, we have\n\n```\nsage: QuadraticField(5).unit_group(5)\nUnit group with structure C2 x Z of Number Field in a with defining polynomial x^2 - 5\nsage: QuadraticField(5).unit_group(5).number_field()\nNumber Field in a with defining polynomial x^2 - 5\n```\n\nBut in the current case:\n\n```\nsage: Zmod(1000).unit_group()\nMultiplicative Abelian group isomorphic to C2 x C2 x C100\n```\n\nThough we can see which ring we're working with via\n\n```\nsage: Zmod(1000).unit_group().values_group()\nRing of integers modulo 1000\n```\n\nthis terminology is very non-intuitive.  I think it would be worth having a class for these groups, with a `ring` method and a more complete `_repr_`.",
    "created_at": "2014-11-13T13:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226858",
    "user": "https://trac.sagemath.org/admin/accounts/users/fwclarke"
}
```

For number fields, we have

```
sage: QuadraticField(5).unit_group(5)
Unit group with structure C2 x Z of Number Field in a with defining polynomial x^2 - 5
sage: QuadraticField(5).unit_group(5).number_field()
Number Field in a with defining polynomial x^2 - 5
```

But in the current case:

```
sage: Zmod(1000).unit_group()
Multiplicative Abelian group isomorphic to C2 x C2 x C100
```

Though we can see which ring we're working with via

```
sage: Zmod(1000).unit_group().values_group()
Ring of integers modulo 1000
```

this terminology is very non-intuitive.  I think it would be worth having a class for these groups, with a `ring` method and a more complete `_repr_`.



---

archive/issue_comments_226859.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-11-13T17:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226859",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_226860.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-11-13T18:15:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226860",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_226861.json:
```json
{
    "body": "Replying to [comment:5 jdemeyer]:\n> If possible, I would like to see the changes to the Dirichlet character stuff in a different ticket (to make reviewing easier).\nSee #17337 and #17338.\n\nI think the new commits address your other comments, back to `needs_review`.",
    "created_at": "2014-11-13T18:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226861",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:5 jdemeyer]:
> If possible, I would like to see the changes to the Dirichlet character stuff in a different ticket (to make reviewing easier).
See #17337 and #17338.

I think the new commits address your other comments, back to `needs_review`.



---

archive/issue_comments_226862.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-11-13T18:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226862",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_226863.json:
```json
{
    "body": "Replying to [comment:7 fwclarke]:\n> For number fields, we have\n> {{{\n> sage: QuadraticField(5).unit_group(5)\n> Unit group with structure C2 x Z of Number Field in a with defining polynomial x^2 - 5\n> sage: QuadraticField(5).unit_group(5).number_field()\n> Number Field in a with defining polynomial x^2 - 5\n> }}}\n> But in the current case:\n> {{{\n> sage: Zmod(1000).unit_group()\n> Multiplicative Abelian group isomorphic to C2 x C2 x C100\n> }}}\n> Though we can see which ring we're working with via\n> {{{\n> sage: Zmod(1000).unit_group().values_group()\n> Ring of integers modulo 1000\n> }}}\n> this terminology is very non-intuitive.  I think it would be worth having a class for these groups, with a `ring` method and a more complete `_repr_`.\nI agree, but this should probably be done on a different ticket.  I think it won't cause problems if we change the precise type of group output by `unit_group()` in the future.  (Maybe we could just make it a subclass of `AbelianGroupWithValues`.)",
    "created_at": "2014-11-13T18:20:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226863",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:7 fwclarke]:
> For number fields, we have
> {{{
> sage: QuadraticField(5).unit_group(5)
> Unit group with structure C2 x Z of Number Field in a with defining polynomial x^2 - 5
> sage: QuadraticField(5).unit_group(5).number_field()
> Number Field in a with defining polynomial x^2 - 5
> }}}
> But in the current case:
> {{{
> sage: Zmod(1000).unit_group()
> Multiplicative Abelian group isomorphic to C2 x C2 x C100
> }}}
> Though we can see which ring we're working with via
> {{{
> sage: Zmod(1000).unit_group().values_group()
> Ring of integers modulo 1000
> }}}
> this terminology is very non-intuitive.  I think it would be worth having a class for these groups, with a `ring` method and a more complete `_repr_`.
I agree, but this should probably be done on a different ticket.  I think it won't cause problems if we change the precise type of group output by `unit_group()` in the future.  (Maybe we could just make it a subclass of `AbelianGroupWithValues`.)



---

archive/issue_comments_226864.json:
```json
{
    "body": "Replying to [comment:11 pbruin]:\n> I think the new commits address your other comments, back to `needs_review`.\nFrom a quick look through the diffs, this is indeed the case. I'll make a deeper review later.",
    "created_at": "2014-11-13T20:16:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226864",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:11 pbruin]:
> I think the new commits address your other comments, back to `needs_review`.
From a quick look through the diffs, this is indeed the case. I'll make a deeper review later.



---

archive/issue_comments_226865.json:
```json
{
    "body": "I added a trivial patch, looks good!\n----\nNew commits:",
    "created_at": "2014-11-23T08:10:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226865",
    "user": "https://github.com/jdemeyer"
}
```

I added a trivial patch, looks good!
----
New commits:



---

archive/issue_comments_226866.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-11-23T08:10:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226866",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_016509.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-24T16:01:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17080#event-16509"
}
```



---

archive/issue_comments_226867.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-11-24T16:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17080",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17080#issuecomment-226867",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
