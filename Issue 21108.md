# Issue 21108: very minor speedup in edge_labels

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2016-08-26 12:04:16

by creating the list directly


---

Comment by chapoton created at 2016-08-26 12:05:02

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-08-26 12:05:02

New commits:


---

Comment by dcoudert created at 2016-08-26 13:42:22

We can easily do better.

Previous code:

```
sage: G = graphs.PetersenGraph()
sage: %timeit G.edge_labels()
The slowest run took 5.12 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 11.9 µs per loop

sage: G = graphs.Grid2dGraph(50,50)
sage: %timeit G.edge_labels()
100 loops, best of 3: 6.98 ms per loop
```



Your code (almost the same):

```
sage: G = graphs.PetersenGraph()
sage: %timeit G.edge_labels()
The slowest run took 4.17 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 11.8 µs per loop

sage: G = graphs.Grid2dGraph(50,50)
sage: %timeit G.edge_labels()
100 loops, best of 3: 6.8 ms per loop
```



using instead `return list(l for _,_,l in self.edge_iterator())` seems more efficient.

```
sage: G = graphs.PetersenGraph()
sage: %timeit G.edge_labels()
100000 loops, best of 3: 10.1 µs per loop

sage: G = graphs.Grid2dGraph(50,50)
sage: %timeit G.edge_labels()
100 loops, best of 3: 2.81 ms per loop
```



---

Comment by dcoudert created at 2016-08-26 13:42:22

Changing status from needs_review to needs_work.


---

Comment by git created at 2016-08-26 14:36:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-08-26 14:37:22

done, thanks


---

Comment by chapoton created at 2016-08-26 14:37:22

Changing status from needs_work to needs_review.


---

Comment by dcoudert created at 2016-08-26 16:53:28

Hello. It is much better to use `edge_iterator`. We don't need to build the list of edges first and then iterate over that list.

```
sage: G = graphs.Grid2dGraph(50,50)
sage: %timeit [l for _, _, l in G.edges()]
100 loops, best of 3: 7.59 ms per loop
sage: %timeit [l for _, _, l in G.edge_iterator()]
100 loops, best of 3: 3.34 ms per loop
```



---

Comment by git created at 2016-08-26 17:06:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-08-26 17:08:45

done, thanks again !


---

Comment by dcoudert created at 2016-08-26 21:40:16

We can certainly do better accessing directly the backends, but we already have a significant speed up.
Good to go.


---

Comment by dcoudert created at 2016-08-26 21:40:16

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-08-29 16:56:27

Resolution: fixed
