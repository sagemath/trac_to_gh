# Issue 10452: Round values returned by CPLEX when the variable's type is integer/binary

Issue created by migration from https://trac.sagemath.org/ticket/10505

Original creator: ncohen

Original creation time: 2010-12-20 16:13:04

Assignee: ncohen

CPLEX is a funny guy who does not understand that 1.546846847 e-17 is not a proper value for a binary variable. As I often forgot to replace test ``== 1`` by ``> .5`` and as it is anyway what CPLEX should return, this patch rounds values given to the variables before returning them when it is sound. It amounts to copying two lines from ``is_variable_continuous`` in the ``get_variable_value`` method, and doctests pass better with CPLEX (which is not the case with the new patch for TSP #10497)

Nathann


---

Comment by ncohen created at 2010-12-20 16:14:10

Changing status from new to needs_review.


---

Comment by dcoudert created at 2011-10-14 09:08:23

Changing status from needs_review to needs_info.


---

Comment by dcoudert created at 2011-10-14 09:08:23

The returned value is not of integer type (2.0 instead of 2). Should we cast it to Integer, or int, or leave it like that ?


---

Comment by ncohen created at 2011-10-14 09:25:49

Changing status from needs_info to needs_review.


---

Comment by ncohen created at 2011-10-14 09:25:49

Oops... You are right !

The thing is that casting it to Integer would mean having to create a new object for each returned variable, even when using the code from the C level. And casting it to a Python int would mean that you can not divide is safely anymore (1/2 becomes 0).

What do you think of letting it stay like that ? The goal was really to be able to test (variable == 0) without fearing that variable (declared as binary in the LP) would have 0.0000001 as a value.

We can still *really* cast the values to integer in situations where the user expect it, like in #11367 which just got reviewed.

While I was at it, though, I noticed a mistake in the documentation generated from the mip.pyx file : the first line contained a math equation which was not properly written.. I just updated the patch to fix it ! `:-)`

Nathann


---

Comment by dcoudert created at 2011-10-14 09:43:17

OK, you can live it like this, but it should be clearly indicated in the documentation to avoid confusion. Users can cast afterwards depending of their needs.

Concerning the documentation, I don't see any improvement. In fact, most of the math equations are not properly displayed in the page. I see only the latex code (e.g., w_i \in \mathbb{Z}).


---

Comment by dcoudert created at 2011-10-14 09:43:17

Changing status from needs_review to needs_info.


---

Comment by ncohen created at 2011-10-14 10:17:58

> OK, you can live it like this, but it should be clearly indicated in the documentation to avoid confusion. Users can cast afterwards depending of their needs.

Patch updated. I added a note in the documentation of ``MixedIntegerLinearProgram.get_values``.

> Concerning the documentation, I don't see any improvement. In fact, most of the math equations are not properly displayed in the page. I see only the latex code (e.g., w_i \in \mathbb{Z}). 

Are you talking of the HTML documentation ? The LaTeX formula will of course never appear in the console ! In my version of it, I find nothing wrong with the others formulas contained in this page. `O_o`

Nathann


---

Comment by ncohen created at 2011-10-14 10:17:58

Changing status from needs_info to needs_review.


---

Attachment

I'm now satisfied with this patch.


---

Comment by dcoudert created at 2011-10-14 11:43:35

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-10-18 20:14:42

Resolution: fixed


---

Comment by jdemeyer created at 2011-11-03 16:14:43

Milestone sage-4.7.3 deleted
