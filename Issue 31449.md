# Issue 31449: Computing the factored multiplicative order of an extension field tries to solve an unnecessarily hard factoring problem

archive/issues_031449.json:
```json
{
    "body": "CC:  @slel\n\n(Initially asked at https://ask.sagemath.org/question/56710/computing-the-factored-multiplicative-order-of-an-extension-field-tries-to-solve-an-unnecessarily-hard-factoring-problem/ )\n\nThere seems to be a unnecessary performance problem with constructing large extension fields:\n\n    sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\n    sage: GF(p^2)\n\nThis hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)\n\nIt is not unreasonable that constructing the extension field requires knowing the factorization of the multiplicative order. (You can get around this by constructing it with a specific modulus, but then many operations, e.g. taking roots, require this factorization anyway.)\n\nHowever, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:\n\n    sage: factor(p-1)                                                                                                                                                  \n    2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\n    sage: factor(p+1)                                                                                                                                                  \n    2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299\n\n(this takes less than a second on my desktop).\n\nIn general, computing the multiplicative order of an extension field should take advantage of the factorization of p<sup>k</sup> - 1 as a polynomial. There might also be other cases where we know the factorization by construction, and should be able to provide it.\n\nIssue created by migration from https://trac.sagemath.org/ticket/31686\n\n",
    "created_at": "2021-04-18T18:22:21Z",
    "labels": [],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Computing the factored multiplicative order of an extension field tries to solve an unnecessarily hard factoring problem",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31449",
    "user": "https://github.com/daira"
}
```
CC:  @slel

(Initially asked at https://ask.sagemath.org/question/56710/computing-the-factored-multiplicative-order-of-an-extension-field-tries-to-solve-an-unnecessarily-hard-factoring-problem/ )

There seems to be a unnecessary performance problem with constructing large extension fields:

    sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
    sage: GF(p^2)

This hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)

It is not unreasonable that constructing the extension field requires knowing the factorization of the multiplicative order. (You can get around this by constructing it with a specific modulus, but then many operations, e.g. taking roots, require this factorization anyway.)

However, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:

    sage: factor(p-1)                                                                                                                                                  
    2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
    sage: factor(p+1)                                                                                                                                                  
    2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299

(this takes less than a second on my desktop).

In general, computing the multiplicative order of an extension field should take advantage of the factorization of p<sup>k</sup> - 1 as a polynomial. There might also be other cases where we know the factorization by construction, and should be able to provide it.

Issue created by migration from https://trac.sagemath.org/ticket/31686





---

archive/issue_comments_449221.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2021-04-18T18:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449221",
    "user": "https://github.com/daira"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_449222.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to number theory.",
    "created_at": "2021-04-18T18:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449222",
    "user": "https://github.com/daira"
}
```

Changing component from PLEASE CHANGE to number theory.



---

archive/issue_comments_449223.json:
```json
{
    "body": "Changing keywords from \"\" to \"extension-field\".",
    "created_at": "2021-04-18T18:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449223",
    "user": "https://github.com/daira"
}
```

Changing keywords from "" to "extension-field".



---

archive/issue_comments_449224.json:
```json
{
    "body": "This appears to work but obviously only addresses the simplest case:\n\n```\ndiff --git a/src/sage/rings/finite_rings/finite_field_base.pyx b/src/sage/rings/finite_rings/finite_field_base.pyx\nindex a4b396621f..6900035193 100644\n--- a/src/sage/rings/finite_rings/finite_field_base.pyx\n+++ b/src/sage/rings/finite_rings/finite_field_base.pyx\n@@ -23,6 +23,7 @@ AUTHORS:\n #       Copyright (C) 2012 Xavier Caruso <xavier.caruso@normalesup.org>\n #       Copyright (C) 2013 Peter Bruin <P.Bruin@warwick.ac.uk>\n #       Copyright (C) 2014 Julian Rueth <julian.rueth@fsfe.org>\n+#       Copyright (C) 2021 Daira Hopwood <daira@jacaranda.org>\n #\n #  Distributed under the terms of the GNU General Public License (GPL)\n #  as published by the Free Software Foundation; either version 2 of\n@@ -829,7 +830,11 @@ cdef class FiniteField(Field):\n             sage: GF(7^2,'a').factored_unit_order()\n             (2^4 * 3,)\n         \"\"\"\n-        F = (self.order() - 1).factor()\n+        if self.degree() == 2:\n+            p = self.characteristic()\n+            F = (p-1).factor() * (p+1).factor()\n+        else:\n+            F = (self.order() - 1).factor()\n         return (F,)\n \n     def cardinality(self):\n```",
    "created_at": "2021-04-18T18:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449224",
    "user": "https://github.com/daira"
}
```

This appears to work but obviously only addresses the simplest case:

```
diff --git a/src/sage/rings/finite_rings/finite_field_base.pyx b/src/sage/rings/finite_rings/finite_field_base.pyx
index a4b396621f..6900035193 100644
--- a/src/sage/rings/finite_rings/finite_field_base.pyx
+++ b/src/sage/rings/finite_rings/finite_field_base.pyx
@@ -23,6 +23,7 @@ AUTHORS:
 #       Copyright (C) 2012 Xavier Caruso <xavier.caruso@normalesup.org>
 #       Copyright (C) 2013 Peter Bruin <P.Bruin@warwick.ac.uk>
 #       Copyright (C) 2014 Julian Rueth <julian.rueth@fsfe.org>
+#       Copyright (C) 2021 Daira Hopwood <daira@jacaranda.org>
 #
 #  Distributed under the terms of the GNU General Public License (GPL)
 #  as published by the Free Software Foundation; either version 2 of
@@ -829,7 +830,11 @@ cdef class FiniteField(Field):
             sage: GF(7^2,'a').factored_unit_order()
             (2^4 * 3,)
         """
-        F = (self.order() - 1).factor()
+        if self.degree() == 2:
+            p = self.characteristic()
+            F = (p-1).factor() * (p+1).factor()
+        else:
+            F = (self.order() - 1).factor()
         return (F,)
 
     def cardinality(self):
```



---

archive/issue_comments_449225.json:
```json
{
    "body": "For the general case, you can try along the lines:\n\n```\nfrom sage.structure.factorization import Factorization\np = self.characteristic()\nd = self.degree()\nx = polygen(ZZ)\nF = Factorization([(P(p).factor(), m) for P,m in (x^d-1).factor()]).expand()\n```\n\nNote that for small degrees, it might slow down things, so it might be worth benchmarking first.",
    "created_at": "2021-04-18T20:18:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449225",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

For the general case, you can try along the lines:

```
from sage.structure.factorization import Factorization
p = self.characteristic()
d = self.degree()
x = polygen(ZZ)
F = Factorization([(P(p).factor(), m) for P,m in (x^d-1).factor()]).expand()
```

Note that for small degrees, it might slow down things, so it might be worth benchmarking first.



---

archive/issue_comments_449226.json:
```json
{
    "body": "Changing component from number theory to finite rings.",
    "created_at": "2021-04-18T22:20:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449226",
    "user": "https://github.com/slel"
}
```

Changing component from number theory to finite rings.



---

archive/issue_comments_449227.json:
```json
{
    "body": "Could `cyclotomic_value` help?\n\n```diff\n- F = Factorization([(P(p).factor(), m) for P, m in (x^d - 1).factor()]).expand()\n+ F = Factorization([(cyclotomic_value(n, p).factor(), 1)\n+                    for n in d.divisors()]).expand()\n```",
    "created_at": "2021-04-18T22:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449227",
    "user": "https://github.com/slel"
}
```

Could `cyclotomic_value` help?

```diff
- F = Factorization([(P(p).factor(), m) for P, m in (x^d - 1).factor()]).expand()
+ F = Factorization([(cyclotomic_value(n, p).factor(), 1)
+                    for n in d.divisors()]).expand()
```



---

archive/issue_comments_449228.json:
```json
{
    "body": "EDIT: I wrongly thought that the program hangs at factoring `p^2`... this comment is not much relevant to the ticket.\n\nTo my mind it is a mistake that `GF` takes as input `p^2` and not the pair `(p, 2)`. I would suggest to\n- rework the `FiniteFieldFactory` to also accept `Factorization`\n\n```\nsage: p = 17\nsage: q = Factorization([[p, 2]])\nsage: GF(q)\n```\n- tweak the sage preparser so that the `p^2` in `GF(p^2)` is converted to `GF(Factorization([This is the Trac macro *p,2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#p,2-macro)))`.",
    "created_at": "2021-04-19T20:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449228",
    "user": "https://github.com/videlec"
}
```

EDIT: I wrongly thought that the program hangs at factoring `p^2`... this comment is not much relevant to the ticket.

To my mind it is a mistake that `GF` takes as input `p^2` and not the pair `(p, 2)`. I would suggest to
- rework the `FiniteFieldFactory` to also accept `Factorization`

```
sage: p = 17
sage: q = Factorization([[p, 2]])
sage: GF(q)
```
- tweak the sage preparser so that the `p^2` in `GF(p^2)` is converted to `GF(Factorization([This is the Trac macro *p,2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#p,2-macro)))`.



---

archive/issue_comments_449229.json:
```json
{
    "body": "Another example where taking advantage of the cyclotomic factorization does succeed with the proposed fix\n\n```\nsage: p = 1100585370631\nsage: GF(p^24)\nFinite Field in z24 of size 1100585370631^24\n```\n\nThis is a very nice proposal! Coud you submit a branch?",
    "created_at": "2021-04-20T17:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449229",
    "user": "https://github.com/videlec"
}
```

Another example where taking advantage of the cyclotomic factorization does succeed with the proposed fix

```
sage: p = 1100585370631
sage: GF(p^24)
Finite Field in z24 of size 1100585370631^24
```

This is a very nice proposal! Coud you submit a branch?



---

archive/issue_comments_449230.json:
```json
{
    "body": "Please open a ticket to allow `GF((p, d))` instead of `GF(p^d)`.\n\nOf course figuring out the prime and degree \nwhen factoring the argument `q` of `GF(q)` as `p^d`\nis easier than factoring general composite numbers.\nStill it seems a waste that in `GF(p^d)` the prime power\nis computed only to then recover the prime and degree.",
    "created_at": "2021-04-20T23:36:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449230",
    "user": "https://github.com/slel"
}
```

Please open a ticket to allow `GF((p, d))` instead of `GF(p^d)`.

Of course figuring out the prime and degree 
when factoring the argument `q` of `GF(q)` as `p^d`
is easier than factoring general composite numbers.
Still it seems a waste that in `GF(p^d)` the prime power
is computed only to then recover the prime and degree.



---

archive/issue_comments_449231.json:
```json
{
    "body": "Replying to [comment:10 slelievre]:\n> Please open a ticket to allow `GF((p, d))` instead of `GF(p^d)`.\n> \n> Of course figuring out the prime and degree \n> when factoring the argument `q` of `GF(q)` as `p^d`\n> is easier than factoring general composite numbers.\n> Still it seems a waste that in `GF(p^d)` the prime power\n> is computed only to then recover the prime and degree.\n\n\nThis is #31709",
    "created_at": "2021-04-21T06:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449231",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:10 slelievre]:
> Please open a ticket to allow `GF((p, d))` instead of `GF(p^d)`.
> 
> Of course figuring out the prime and degree 
> when factoring the argument `q` of `GF(q)` as `p^d`
> is easier than factoring general composite numbers.
> Still it seems a waste that in `GF(p^d)` the prime power
> is computed only to then recover the prime and degree.


This is #31709



---

archive/issue_comments_449232.json:
```json
{
    "body": "Related:\n\n- #31434: Default to random modulus for finite field creation",
    "created_at": "2021-04-21T09:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449232",
    "user": "https://github.com/slel"
}
```

Related:

- #31434: Default to random modulus for finite field creation



---

archive/issue_comments_449233.json:
```json
{
    "body": "The attached branch achieves the proposed goal of the ticket,\nunderstood as speeding up (and often allowing at all)\nfactoring the unit order of non-prime finite fields.\n\n```python\nsage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\nsage: F = GF(p^2, 'a')\nsage: F.factored_unit_order()\n(2^33 * 3^4 * 17 * 67 * 293 * 313 * 349 * 751\n * 1997 * 2003 * 2671 * 19556633 * 738231097 * 44179799701097\n * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\n * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299,)\n```\n\n```python\nsage: p = 1100585370631\nsage: F = GF(p^24, 'a')\nsage: F.factored_unit_order()\n(2^6 * 3^2 * 5 * 7 * 11 * 13 * 17 * 53 * 97 * 229 * 337 * 421\n * 3929 * 215417 * 249737 * 262519 * 397897 * 59825761 * 692192057\n * 12506651939 * 37553789761 * 46950147799 * 172462808473 * 434045140817\n * 81866093016401 * 617237859576697 * 659156729361017707\n * 268083135725348991493995910983015600019336657\n * 90433843562394341719266736354746485652016132372842876085423636587989263202299569913,)\n```\n\nFinding a pseudo-Conway polynomial still takes longer\nthan using a random irreducible polynommial, see #31434.\n\n```python\nsage: p = 1100585370631\nsage: %time F = GF(p^24, 'a')\nCPU times: user 120 ms, sys: 12.3 ms, total: 132 ms\nWall time: 170 ms\nsage: %time F = GF(p^24)\nCPU times: user 1.76 s, sys: 303 ms, total: 2.07 s\nWall time: 2.46 s\n```\n\n```python\nsage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\nsage: %time F = GF(p^2, 'a')\nCPU times: user 1.94 s, sys: 9.62 ms, total: 1.95 s\nWall time: 2.05 s\nsage: %time F = GF(p^2)\nCPU times: user 14.7 s, sys: 49.9 ms, total: 14.8 s\nWall time: 17.7 s\n```\n\nPlease review.\n\n---\nNew commits:",
    "created_at": "2021-04-21T12:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449233",
    "user": "https://github.com/slel"
}
```

The attached branch achieves the proposed goal of the ticket,
understood as speeding up (and often allowing at all)
factoring the unit order of non-prime finite fields.

```python
sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
sage: F = GF(p^2, 'a')
sage: F.factored_unit_order()
(2^33 * 3^4 * 17 * 67 * 293 * 313 * 349 * 751
 * 1997 * 2003 * 2671 * 19556633 * 738231097 * 44179799701097
 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299,)
```

```python
sage: p = 1100585370631
sage: F = GF(p^24, 'a')
sage: F.factored_unit_order()
(2^6 * 3^2 * 5 * 7 * 11 * 13 * 17 * 53 * 97 * 229 * 337 * 421
 * 3929 * 215417 * 249737 * 262519 * 397897 * 59825761 * 692192057
 * 12506651939 * 37553789761 * 46950147799 * 172462808473 * 434045140817
 * 81866093016401 * 617237859576697 * 659156729361017707
 * 268083135725348991493995910983015600019336657
 * 90433843562394341719266736354746485652016132372842876085423636587989263202299569913,)
```

Finding a pseudo-Conway polynomial still takes longer
than using a random irreducible polynommial, see #31434.

```python
sage: p = 1100585370631
sage: %time F = GF(p^24, 'a')
CPU times: user 120 ms, sys: 12.3 ms, total: 132 ms
Wall time: 170 ms
sage: %time F = GF(p^24)
CPU times: user 1.76 s, sys: 303 ms, total: 2.07 s
Wall time: 2.46 s
```

```python
sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
sage: %time F = GF(p^2, 'a')
CPU times: user 1.94 s, sys: 9.62 ms, total: 1.95 s
Wall time: 2.05 s
sage: %time F = GF(p^2)
CPU times: user 14.7 s, sys: 49.9 ms, total: 14.8 s
Wall time: 17.7 s
```

Please review.

---
New commits:



---

archive/issue_comments_449234.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-04-21T12:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449234",
    "user": "https://github.com/slel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_449235.json:
```json
{
    "body": "Some questions and thoughts.\n\nI added a doctest in a `TESTS` block, should it be\nin `EXAMPLES` instead?\n\nI decided to only include a quick one, to keep\ndoctesting time under control.\n\nOptionally, the example from #31434 and the first\nexample from here could be added too.\n\nMaybe Flint, NTL, PARI, ... have code we could use\ninstead of rolling our own?\n\nShould `d == 1` and maybe `d == 2` be special-cased\nto avoid imports in those frequent cases?",
    "created_at": "2021-04-21T13:27:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449235",
    "user": "https://github.com/slel"
}
```

Some questions and thoughts.

I added a doctest in a `TESTS` block, should it be
in `EXAMPLES` instead?

I decided to only include a quick one, to keep
doctesting time under control.

Optionally, the example from #31434 and the first
example from here could be added too.

Maybe Flint, NTL, PARI, ... have code we could use
instead of rolling our own?

Should `d == 1` and maybe `d == 2` be special-cased
to avoid imports in those frequent cases?



---

archive/issue_comments_449236.json:
```json
{
    "body": "Replying to [comment:14 slelievre]:\n> Some questions and thoughts.\n> \n> I added a doctest in a `TESTS` block, should it be\n> in `EXAMPLES` instead?\n\n>\n> I decided to only include a quick one, to keep\n> doctesting time under control.\n\n\nI think this is a good habit.\n \n> Optionally, the example from #31434 and the first\n> example from here could be added too.\n\n\nIf it does not exceed a couple of seconds, why not.\n\n> Maybe Flint, NTL, PARI, ... have code we could use\n> instead of rolling our own?\n\n\nFor PARI/GP\n\nhttps://pari.math.u-bordeaux.fr/dochtml/html/Arithmetic_functions.html#se:ffprimroot\n\n> Should `d == 1` and maybe `d == 2` be special-cased\n> to avoid imports in those frequent cases?\n\n\nI would say yes if it makes a difference in timings.",
    "created_at": "2021-04-21T13:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449236",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:14 slelievre]:
> Some questions and thoughts.
> 
> I added a doctest in a `TESTS` block, should it be
> in `EXAMPLES` instead?

>
> I decided to only include a quick one, to keep
> doctesting time under control.


I think this is a good habit.
 
> Optionally, the example from #31434 and the first
> example from here could be added too.


If it does not exceed a couple of seconds, why not.

> Maybe Flint, NTL, PARI, ... have code we could use
> instead of rolling our own?


For PARI/GP

https://pari.math.u-bordeaux.fr/dochtml/html/Arithmetic_functions.html#se:ffprimroot

> Should `d == 1` and maybe `d == 2` be special-cased
> to avoid imports in those frequent cases?


I would say yes if it makes a difference in timings.



---

archive/issue_comments_449237.json:
```json
{
    "body": "The other suggestion that I'd add is to use `factor_cunningham` from `sage.rings.factorint` when `p < 12`.",
    "created_at": "2021-04-21T19:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449237",
    "user": "https://github.com/roed314"
}
```

The other suggestion that I'd add is to use `factor_cunningham` from `sage.rings.factorint` when `p < 12`.



---

archive/issue_comments_449238.json:
```json
{
    "body": "Replying to [comment:16 roed]:\n> The other suggestion that I'd add is to use `factor_cunningham` from `sage.rings.factorint` when `p < 12`.\n\n\nThat might provide a speed up. But in its current state, the package is not usable \"optionally\" as it lacks a `Feature`, see #31715.",
    "created_at": "2021-04-22T13:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449238",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:16 roed]:
> The other suggestion that I'd add is to use `factor_cunningham` from `sage.rings.factorint` when `p < 12`.


That might provide a speed up. But in its current state, the package is not usable "optionally" as it lacks a `Feature`, see #31715.



---

archive/issue_comments_449239.json:
```json
{
    "body": "I did not notice any significant speed up by short cutting `d=1` or `d=2`. This ticket provides a great improvement!",
    "created_at": "2021-04-22T13:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449239",
    "user": "https://github.com/videlec"
}
```

I did not notice any significant speed up by short cutting `d=1` or `d=2`. This ticket provides a great improvement!



---

archive/issue_comments_449240.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-22T13:13:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449240",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_449241.json:
```json
{
    "body": "Please `@`gh-daira add your full name in the author field.",
    "created_at": "2021-04-22T13:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449241",
    "user": "https://github.com/slel"
}
```

Please `@`gh-daira add your full name in the author field.



---

archive/issue_comments_449242.json:
```json
{
    "body": "(from https://github.com/daira)",
    "created_at": "2021-04-22T13:42:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449242",
    "user": "https://github.com/videlec"
}
```

(from https://github.com/daira)



---

archive/issue_comments_449243.json:
```json
{
    "body": "Yes that's my name. Thankyou all for being so responsive to this ticket! :-)",
    "created_at": "2021-04-26T23:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449243",
    "user": "https://github.com/daira"
}
```

Yes that's my name. Thankyou all for being so responsive to this ticket! :-)



---

archive/issue_events_083539.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-06T13:17:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31449#event-83539"
}
```



---

archive/issue_comments_449244.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-06-06T13:17:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31449",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31449#issuecomment-449244",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
