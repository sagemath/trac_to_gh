# Issue 20556: Coefficients of a modular form don't coerce into the Hecke eigenfield

Issue created by migration from Trac.

Original creator: pbruin

Original creation time: 2016-06-09 11:38:15

CC:  kedlaya

Reported by Kiran Kedlaya on [sage-nt](https://groups.google.com/forum/#!topic/sage-nt/lDu23r0bAYk):

```
sage: N = Newforms(83,2, names="a")
sage: f = N[1]
sage: K = f.hecke_eigenvalue_field()
sage: print K
Number Field in a1 with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8
sage: l = f.coefficients(20)
sage: print l[-1].parent()
Number Field in alpha with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8
sage: K(l[-1])
Traceback (most recent call last):
...
TypeError: No compatible natural embeddings found for Number Field in a1 with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8 and Number Field in alpha with defining polynomial x^6 - x^5 - 9*x^4 + 7*x^3 + 20*x^2 - 12*x - 8
```

This can be fixed by returning the coefficients as number field elements in the variable name of the Hecke eigenvalue field instead of `alpha`.


---

Comment by pbruin created at 2016-06-09 11:45:33

Changing status from new to needs_review.


---

Comment by saraedum created at 2016-06-09 15:11:46

My local sage does not build right now so I could not test this. Feel free to set it to positive review yourself once the patchbot tested it or if you have run all tests yourself.


---

Comment by pbruin created at 2016-06-09 16:27:18

Replying to [comment:2 saraedum]:
> My local sage does not build right now so I could not test this. Feel free to set it to positive review yourself once the patchbot tested it or if you have run all tests yourself.
Tests pass, thanks for your review.


---

Comment by pbruin created at 2016-06-09 16:27:18

Changing status from needs_review to positive_review.


---

Comment by kedlaya created at 2016-06-09 18:14:13

I will run `make ptestlong` on my local build just to confirm, but it looks fine to me too.


---

Comment by kedlaya created at 2016-06-09 20:34:56

... and indeed all tests pass for me.


---

Comment by vbraun created at 2016-06-11 22:28:25

Resolution: fixed
