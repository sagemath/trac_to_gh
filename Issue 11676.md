# Issue 11676: zero_at() method for RDF/CDF vectors

Issue created by migration from https://trac.sagemath.org/ticket/11848

Original creator: rbeezer

Original creation time: 2011-09-25 23:34:26

Assignee: jason, was

CC:  leif

This patch adds a method to replace small entries of a floating-point vector with zeros, according to a provided tolerance.  It mirrors the matrix method of the same name.


---

Attachment


---

Comment by rbeezer created at 2011-09-25 23:38:19

Changing status from new to needs_review.


---

Comment by leif created at 2011-09-25 23:51:44


```
if
    s/complex matrices/complex vectors/
    s/imaginaryparts/imaginary parts/
then
    ok
```

(Not yet tested, will do shortly...)


---

Attachment

Replying to [comment:2 leif]:

Thanks for the editorial work.  ;-)  v2 patch includes indicated changes.


---

Comment by leif created at 2011-09-26 00:29:51

Replying to [comment:3 rbeezer]:
> Replying to [comment:2 leif]:
> 
> Thanks for the editorial work.  ;-)  v2 patch includes indicated changes.

Yep, immediately seen it. :)


---

Comment by leif created at 2011-09-26 01:09:34

Changing status from needs_review to positive_review.


---

Comment by leif created at 2011-09-26 01:09:34

This function is (e.g.) required by a doctest fix for #7852:

```diff
diff --git a/sage/misc/preparser.py b/sage/misc/preparser.py
--- a/sage/misc/preparser.py
+++ b/sage/misc/preparser.py
@@ -1383,11 +1383,15 @@
 
             sage: A = matrix(RDF, 5, 5, 2)
             sage: b = vector(RDF, 5, range(5))
-            sage: A \ b
+            sage: # On at least one platform, we get a "negative zero":
+            sage: v = A \ b
+            sage: v.zero_at(1e-19)
             (0.0, 0.5, 1.0, 1.5, 2.0)
-            sage: A._backslash_(b)
+            sage: v = A._backslash_(b)
+            sage: v.zero_at(1e-19)
             (0.0, 0.5, 1.0, 1.5, 2.0)
-            sage: A * BackslashOperator() * b
+            sage: v = A * BackslashOperator() * b
+            sage: v.zero_at(1e-19)
             (0.0, 0.5, 1.0, 1.5, 2.0)
         """
         return self.left._backslash_(right)
```


With both patches applied, the tests now pass on the Skynet machine "cleo" (Linux IA64 / Itanium 2), where they previously failed, so *positive review*.


---

Comment by leif created at 2011-09-26 01:44:15

Resolution: fixed


---

Comment by leif created at 2011-09-26 02:34:32

Now also used in `sage/matrix/matrix_double_dense.pyx`, to fix another doctest error introduced by #7852 (noisy zero in a vector result).
