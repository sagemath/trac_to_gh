# Issue 10257: Block interrupts during malloc

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2010-11-13 14:12:53

Assignee: tba

Keywords: malloc sage_malloc c_lib

Allow to temporarily suspend interrupts and do this in sage_malloc() and friends (an interrupt during malloc() will mess up the heap, this happens sometimes with a "fixed" #9564!)


---

Comment by jdemeyer created at 2010-11-13 14:32:08

Changing assignee from tba to jdemeyer.


---

Comment by jdemeyer created at 2011-01-13 23:55:17

Changing status from new to needs_work.


---

Comment by jdemeyer created at 2011-01-13 23:55:17

Changing keywords from "malloc sage_malloc c_lib" to "malloc sage_malloc".


---

Comment by jdemeyer created at 2011-01-14 17:41:21

Changing status from needs_work to needs_review.


---

Comment by vbraun created at 2011-01-21 23:38:13

Nice!

There are some examples in the documentation that use malloc, for example `doc/en/numerical_sage/ctypes_examples.rst`. We should convert these to `sage_malloc` as well, probably in #10109.


---

Comment by vbraun created at 2011-01-21 23:38:13

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-01-22 14:54:00

Replying to [comment:5 vbraun]:
> Nice!
> 
> There are some examples in the documentation that use malloc, for example `doc/en/numerical_sage/ctypes_examples.rst`. We should convert these to `sage_malloc` as well, probably in #10109.

You are right that some documentation uses `malloc`.  But that seems to be pure C code.  So changing `malloc` to `sage_malloc` would imply linking against `-Lcsage` and possibly adding some `sig_on()`/`sig_off()` machinery and possibly more complications...


---

Attachment


---

Comment by jdemeyer created at 2011-02-04 14:51:24

Rebased patch


---

Comment by jdemeyer created at 2011-03-08 21:45:55

Resolution: fixed
