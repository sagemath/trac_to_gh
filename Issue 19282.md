# Issue 19282: flag long test with time indication

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2015-11-04 12:53:15

CC:  jdemeyer ncohen

In order to skip too long doctests we introduce time indications to `long time` flag like

```
sage: (2**2000 + 31).is_prime()  # long time: 1h
```

The allowed units are: `s` (seconds), `m` (minutes), `h` (hours), `d` (days).

We also modify the `--long` option of `sage -t` to allow skipping too long default (with a default at 10 sec).


---

Comment by vdelecroix created at 2015-11-04 14:37:46

New commits:


---

Comment by git created at 2015-11-04 15:18:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-11-04 15:24:12

Instead of `--maxtime`, can't you add an argument to `--long` (similar to `--warn-long`)?


---

Comment by vdelecroix created at 2015-11-04 15:35:24

Replying to [comment:4 jdemeyer]:
> Instead of `--maxtime`, can't you add an argument to `--long` (similar to `--warn-long`)?

That is what I wanted but I do not know how to make an option that at the same time is valid with or without a value. I don't think that is even possible since the following is a valid syntax

```
sage -t --maxtime 1s test.py
```

In the above example, you can not distinguish between the value of your option and an argument of the command line.

The only way would be to always wait for an argument to `--long`. What do you think?


---

Comment by jdemeyer created at 2015-11-04 15:37:30

I think `--warn-long` can be used with and without argument.


---

Comment by git created at 2015-11-05 03:43:10

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2015-11-05 03:43:53

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2015-11-05 03:46:32

I am lacking documentation in the developer manual, but I want a patchbot report...


---

Comment by git created at 2015-11-05 03:53:33

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2015-11-05 08:10:00

Hellooooooo !

What is the default behaviour of `--long` ? Run *all* long tests while ignoring their length? Or will `--long` become an alias for `--long 2s` or something?

THaaaaaaanks,

Nathann


---

Comment by jmantysalo created at 2015-11-05 09:40:54

Replying to [comment:12 ncohen]:

> What is the default behaviour of `--long` ?

The patch says "If set to `True` it will  be set to 10 seconds."

Btw, I think that http://sage.sis.uta.fi/documentation/developer/doctesting.html#testing-a-module should contain a link 
to http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-tests , or maybe the whole paragraph should be moved?


---

Comment by ncohen created at 2015-11-05 09:57:31

Don't know.. The second link you gave points toward a more 'to-the-point' information, while the first is more verbose. To me a link would be cool (let's not have the same information in different places), and we would not add tons of lines either to that other part of the doc?..


---

Comment by git created at 2015-11-05 12:22:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-11-05 13:24:31

Given that the docs say "No example should take more than about 30 seconds", I think 30 seconds would be the best default for `--long`.


---

Comment by ncohen created at 2015-11-05 13:25:48

It is quite likely that I wrote that there just to say "not too long, please".


---

Comment by jdemeyer created at 2015-11-05 13:26:33

I also think that the docs should keep recommending a maximum time of 30 seconds. Longer doctests should only be added for exceptional cases, when it's not possible to write a shorter doctest.


---

Comment by jdemeyer created at 2015-11-05 13:27:49

I think the "30 second" convention has existed for a long time and I see no reason to change that.


---

Comment by vdelecroix created at 2015-11-05 13:44:21

The patchbot got into troubles! It does not properly report the thing. Mine just finished (mangouste) with all test passed. But the report said "pending"...


---

Comment by jmantysalo created at 2016-02-18 08:42:51

This ticket seems to be stalled. Are we still making this?

Somehow "30 seconds" sound odd, when we have no reference machine. With years to pass this means that "long" tests will take less than a second but will not be tested.


---

Comment by chapoton created at 2016-07-28 08:14:00

does not apply


---

Comment by chapoton created at 2016-07-28 08:14:00

Changing status from needs_review to needs_work.
