# Issue 32348: sage.doctest: Eliminate dependency on RealIntervalField

Issue created by migration from https://trac.sagemath.org/ticket/32585

Original creator: mkoeppe

Original creation time: 2021-09-29 16:04:30

CC:  @kliem tmonteil

Follow up on #29922. 
The doctester uses `RealIntervalField` for doctests involving numerical tolerances. This is an obstacle to doctesting modularized subset distributions.

We should eliminate this by rewriting it in a more elementary way.


---

Comment by mkoeppe created at 2021-10-03 17:03:48

New commits:


---

Comment by mkoeppe created at 2021-10-03 17:03:48

Changing status from new to needs_review.


---

Comment by tscrim created at 2021-10-03 23:36:05

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2021-10-03 23:36:05

LGTM.


---

Comment by mkoeppe created at 2021-10-04 00:31:07

Thank you!


---

Comment by mkoeppe created at 2021-10-06 06:41:27

Something isn't quite right with this workaround yet. Getting a `TypeError in doctesting framework` when testing in #32432 `sage/geometry/polyhedron/library.py", line 677, in sage.geometry.polyhedron.library.Polytopes.simplex`

```
 File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/pkgs/sagemath-polyhedra/.tox/python/lib/python3.9/site-packages/sage/doctest/parsing.py", line 1121, in <listcomp>
    want_intervals = [self.add_tolerance(v, want) for v in want_values]
  File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/pkgs/sagemath-polyhedra/.tox/python/lib/python3.9/site-packages/sage/doctest/parsing.py", line 977, in add_tolerance
    return wantval + RIFtol(want.abs_tol) * RIFtol(-1,1)
TypeError: can't multiply sequence by non-int of type 'float'
```



---

Comment by mkoeppe created at 2021-10-06 06:42:02

Changing status from positive_review to needs_work.


---

Comment by git created at 2021-10-10 05:18:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-10-10 05:18:29

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2021-10-10 12:54:56

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-10-10 16:53:44

Thanks.


---

Comment by vbraun created at 2021-10-13 22:50:51

Resolution: fixed
