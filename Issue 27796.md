# Issue 27796: MR20: Add zlib as a gap dependency

Issue created by migration from https://trac.sagemath.org/ticket/28033

Original creator: galois

Original creation time: 2019-06-20 21:46:22

CC:  slelievre

Isuru Fernando ([`@`isuruf](https://gitlab.com/isuruf)) opened a merge request at https://gitlab.com/sagemath/sage/merge_requests/20:
----









---

Comment by isuruf created at 2019-06-20 21:47:07

Changing component from PLEASE CHANGE to build.


---

Comment by isuruf created at 2019-06-20 21:47:07

Changing type from PLEASE CHANGE to defect.


---

Comment by slelievre created at 2019-06-20 21:49:12

Changing keywords from "" to "days101, gap, zlib".


---

Comment by slelievre created at 2019-06-20 21:55:26

Changing status from needs_review to positive_review.


---

Comment by slelievre created at 2019-06-20 21:55:26

Checked that libgap indeed links to zlib.

On macOS:

```
$ sw_vers
ProductName:    Mac OS X
ProductVersion: 10.10.5
BuildVersion:   14F2511

$ ./sage --version
SageMath version 8.8.rc2, Release Date: 2019-06-19

$ otool -L local/lib/libgap.dylib
local/lib/libgap.dylib:
    /opt/s/sage/local/lib/libgap.0.dylib (compatibility version 1.0.0, current version 1.0.0)
    /opt/s/sage/local/lib/libgmp.23.dylib (compatibility version 24.0.0, current version 24.3.0)
    /opt/s/sage/local/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.11)
    /opt/s/sage/local/lib/libreadline.6.dylib (compatibility version 6.0.0, current version 6.3.0)
    /usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1213.0.0)
```


On Debian:

```
$ lsb_release -a
No LSB modules are available.
Distributor ID: Debian
Description:    Debian GNU/Linux 9.9 (stretch)
Release:    9.9
Codename:   stretch

$ ./sage --version
SageMath version 8.8.rc2, Release Date: 2019-06-19

$ readelf -d local/lib/libgap.so

Dynamic section at offset 0x1dd360 contains 32 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libgmp.so.23]
 0x0000000000000001 (NEEDED)             Shared library: [libz.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libreadline.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libdl.so.2]
 0x0000000000000001 (NEEDED)             Shared library: [libutil.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000e (SONAME)             Library soname: [libgap.so.0]
 0x000000000000001d (RUNPATH)            Library runpath: [/home/lelievre/s/sage/local/lib]
 0x000000000000000c (INIT)               0x536a0
 0x000000000000000d (FINI)               0x18253c
 0x0000000000000019 (INIT_ARRAY)         0x3db008
 0x000000000000001b (INIT_ARRAYSZ)       8 (bytes)
 0x000000000000001a (FINI_ARRAY)         0x3db010
 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes)
 0x000000006ffffef5 (GNU_HASH)           0x1f0
 0x0000000000000005 (STRTAB)             0x1b450
 0x0000000000000006 (SYMTAB)             0x66c0
 0x000000000000000a (STRSZ)              53655 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000003 (PLTGOT)             0x3e0000
 0x0000000000000002 (PLTRELSZ)           28608 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x4c6e0
 0x0000000000000007 (RELA)               0x2a258
 0x0000000000000008 (RELASZ)             140424 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x2a1b8
 0x000000006fffffff (VERNEEDNUM)         4
 0x000000006ffffff0 (VERSYM)             0x285e8
 0x000000006ffffff9 (RELACOUNT)          3443
 0x0000000000000000 (NULL)               0x0
```



---

Comment by dimpase created at 2019-06-21 00:00:36

OK, indeed, zlib usage is a recent change in GAP, a year ago it was merged in their master.
https://github.com/gap-system/gap/pull/2509

as everybody nowdays builds with zlib available from the system (and Sage builds zlib early on otherwise), we didn't notice the need.


---

Comment by chapoton created at 2019-06-21 11:27:33

reviewer name is missing


---

Comment by vbraun created at 2019-06-28 04:29:32

Resolution: fixed
