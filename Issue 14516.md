# Issue 14516: Padé approximants

archive/issues_014516.json:
```json
{
    "body": "Assignee: @aghitza\n\nCC:  sage-combinat\n\nKeywords: pad\u00e9 approximant, power series\n\nIt would be good to have Pad\u00e9 approximants for formal power series\n\n\n```\nsage: z = PowerSeriesRing(QQ, 'z').gen()\nsage: pade(exp(z),4,0)      \n1/24*z^4 + 1/6*z^3 + 1/2*z^2 + z + 1\nsage: pade(exp(z),3,1)\n(1/144*z^3 + 1/24*z^2 + 1/8*z + 1/6)/(-1/24*z + 1/6)\n```\n\n\npatch in preparation\n\nIssue created by migration from https://trac.sagemath.org/ticket/14720\n\n",
    "created_at": "2013-06-11T14:50:04Z",
    "labels": [
        "algebra",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Pad\u00e9 approximants",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14516",
    "user": "@fchapoton"
}
```
Assignee: @aghitza

CC:  sage-combinat

Keywords: padé approximant, power series

It would be good to have Padé approximants for formal power series


```
sage: z = PowerSeriesRing(QQ, 'z').gen()
sage: pade(exp(z),4,0)      
1/24*z^4 + 1/6*z^3 + 1/2*z^2 + z + 1
sage: pade(exp(z),3,1)
(1/144*z^3 + 1/24*z^2 + 1/8*z + 1/6)/(-1/24*z + 1/6)
```


patch in preparation

Issue created by migration from https://trac.sagemath.org/ticket/14720





---

archive/issue_comments_184232.json:
```json
{
    "body": "Attachment [trac_14720_pade_approximants-fc.patch](tarball://root/attachments/some-uuid/ticket14720/trac_14720_pade_approximants-fc.patch) by @fchapoton created at 2013-06-11 19:07:44",
    "created_at": "2013-06-11T19:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184232",
    "user": "@fchapoton"
}
```

Attachment [trac_14720_pade_approximants-fc.patch](tarball://root/attachments/some-uuid/ticket14720/trac_14720_pade_approximants-fc.patch) by @fchapoton created at 2013-06-11 19:07:44



---

archive/issue_comments_184233.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-06-11T19:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184233",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_184234.json:
```json
{
    "body": "Changing keywords from \"pad\u00e9 approximant, power series\" to \"pade approximant, power series\".",
    "created_at": "2013-07-30T06:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184234",
    "user": "@cnassau"
}
```

Changing keywords from "padé approximant, power series" to "pade approximant, power series".



---

archive/issue_comments_184235.json:
```json
{
    "body": "I've taken the liberty to remove the UTF-8 characters from title and summary - currently the patchbots choke on this (see #14707)",
    "created_at": "2013-07-30T06:54:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184235",
    "user": "@cnassau"
}
```

I've taken the liberty to remove the UTF-8 characters from title and summary - currently the patchbots choke on this (see #14707)



---

archive/issue_comments_184236.json:
```json
{
    "body": "Thanks for your interest. But the patchbot is wrong and the correct name is **Pad\u00e9** and should always be written as such when possible (namely everywhere except in the name of the function)",
    "created_at": "2013-07-30T07:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184236",
    "user": "@fchapoton"
}
```

Thanks for your interest. But the patchbot is wrong and the correct name is **Padé** and should always be written as such when possible (namely everywhere except in the name of the function)



---

archive/issue_comments_184237.json:
```json
{
    "body": "Yes, the patchbot is wrong. But if you write \"Pad\u00e9\" in the title of a Sage ticket then\n\n- your ticket will not be tested\n- the patchbot that tried to test your ticket will stop\n\nI suggest to revert to the proper \"Pad\u00e9\" after ticket #14707 has been fixed. Maybe you can help to get somebody interested in actually fixing it.",
    "created_at": "2013-07-30T08:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184237",
    "user": "@cnassau"
}
```

Yes, the patchbot is wrong. But if you write "Padé" in the title of a Sage ticket then

- your ticket will not be tested
- the patchbot that tried to test your ticket will stop

I suggest to revert to the proper "Padé" after ticket #14707 has been fixed. Maybe you can help to get somebody interested in actually fixing it.



---

archive/issue_comments_184238.json:
```json
{
    "body": "New commits:",
    "created_at": "2013-12-04T19:37:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184238",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_184239.json:
```json
{
    "body": "* You might want to call the variable `anneau` something else.\n* The existing `sage.matrix.berlekamp_massey.berlekamp_massey` more or less computes the same thing and may be faster. (The same goes for `sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint.rational_reconstruct` in the case of series over `Z/nZ`.)",
    "created_at": "2013-12-20T09:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184239",
    "user": "@mezzarobba"
}
```

* You might want to call the variable `anneau` something else.
* The existing `sage.matrix.berlekamp_massey.berlekamp_massey` more or less computes the same thing and may be faster. (The same goes for `sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint.rational_reconstruct` in the case of series over `Z/nZ`.)



---

archive/issue_comments_184240.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2013-12-20T10:06:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184240",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_184241.json:
```json
{
    "body": "Hi Fr\u00e9d\u00e9ric,\n\nI had a look at your new version and started changing a few things in `u/mmezzarobba/14720-pade`, but I stopped midstream. (I'm intentionally not setting the ticket's branch field to my branch, because it is half-broken.)\n\nHere are some remaining issues.\n\n* The code does not work over `RR`:\n  {{{\n  sage: R.<z> = RR[[]]\n  sage: f = exp(2*z)\n  sage: f.pade(3,3)\n  ...\n  ValueError: variable names must be alphanumeric, but one is '0.000000000000000 + 1.00000000000000*z' which is not.\n  }}}\n  I fixed the `ValueError` by changing the definition of `polyring` to `self.parent()._poly_ring()`, but this is not enough: the degrees of the resulting polynomials are wrong due to round-off errors.\n* The doc should mention how large the order of `self` needs to be (and/or the function should raise a meaningful error when it is too small).",
    "created_at": "2014-02-04T14:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184241",
    "user": "@mezzarobba"
}
```

Hi Frédéric,

I had a look at your new version and started changing a few things in `u/mmezzarobba/14720-pade`, but I stopped midstream. (I'm intentionally not setting the ticket's branch field to my branch, because it is half-broken.)

Here are some remaining issues.

* The code does not work over `RR`:
  {{{
  sage: R.<z> = RR[[]]
  sage: f = exp(2*z)
  sage: f.pade(3,3)
  ...
  ValueError: variable names must be alphanumeric, but one is '0.000000000000000 + 1.00000000000000*z' which is not.
  }}}
  I fixed the `ValueError` by changing the definition of `polyring` to `self.parent()._poly_ring()`, but this is not enough: the degrees of the resulting polynomials are wrong due to round-off errors.
* The doc should mention how large the order of `self` needs to be (and/or the function should raise a meaningful error when it is too small).



---

archive/issue_comments_184242.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-02-04T15:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184242",
    "user": "@mezzarobba"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_184243.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-02-04T21:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184243",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_184244.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-02-21T15:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184244",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_184245.json:
```json
{
    "body": "I have added a truncation to the polynomials computed as determinants, in order to ensure they have the right degree. This probably means that the algorithm is not very well suited to handle the case of real coefficients, but, well, in the absence of another algorithm..",
    "created_at": "2014-02-21T15:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184245",
    "user": "@fchapoton"
}
```

I have added a truncation to the polynomials computed as determinants, in order to ensure they have the right degree. This probably means that the algorithm is not very well suited to handle the case of real coefficients, but, well, in the absence of another algorithm..



---

archive/issue_comments_184246.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-02-21T15:35:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184246",
    "user": "@fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_184247.json:
```json
{
    "body": "Looks good to me. I pushed some minor changes; please set the ticket to positive review if you agree.\n\nThanks for your work!\n----\nNew commits:",
    "created_at": "2014-02-22T17:17:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184247",
    "user": "@mezzarobba"
}
```

Looks good to me. I pushed some minor changes; please set the ticket to positive review if you agree.

Thanks for your work!
----
New commits:



---

archive/issue_comments_184248.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-02-22T19:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184248",
    "user": "@fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_184249.json:
```json
{
    "body": "ok, looks good to me. Thanks for the review !",
    "created_at": "2014-02-22T19:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184249",
    "user": "@fchapoton"
}
```

ok, looks good to me. Thanks for the review !



---

archive/issue_comments_184250.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-02-23T07:46:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14516",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14516#issuecomment-184250",
    "user": "@vbraun"
}
```

Resolution: fixed
