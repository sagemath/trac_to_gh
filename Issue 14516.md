# Issue 14516: Padé approximants

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2013-06-11 14:50:04

Assignee: AlexGhitza

CC:  sage-combinat

Keywords: padé approximant, power series

It would be good to have Padé approximants for formal power series


```
sage: z = PowerSeriesRing(QQ, 'z').gen()
sage: pade(exp(z),4,0)      
1/24*z^4 + 1/6*z^3 + 1/2*z^2 + z + 1
sage: pade(exp(z),3,1)
(1/144*z^3 + 1/24*z^2 + 1/8*z + 1/6)/(-1/24*z + 1/6)
```


patch in preparation


---

Attachment


---

Comment by chapoton created at 2013-06-11 19:07:44

Changing status from new to needs_review.


---

Comment by cnassau created at 2013-07-30 06:54:18

Changing keywords from "padé approximant, power series" to "pade approximant, power series".


---

Comment by cnassau created at 2013-07-30 06:54:58

I've taken the liberty to remove the UTF-8 characters from title and summary - currently the patchbots choke on this (see #14707)


---

Comment by chapoton created at 2013-07-30 07:39:23

Thanks for your interest. But the patchbot is wrong and the correct name is *Padé* and should always be written as such when possible (namely everywhere except in the name of the function)


---

Comment by cnassau created at 2013-07-30 08:02:41

Yes, the patchbot is wrong. But if you write "Padé" in the title of a Sage ticket then

   - your ticket will not be tested
   - the patchbot that tried to test your ticket will stop

I suggest to revert to the proper "Padé" after ticket #14707 has been fixed. Maybe you can help to get somebody interested in actually fixing it.


---

Comment by chapoton created at 2013-12-04 19:37:12

New commits:


---

Comment by mmezzarobba created at 2013-12-20 09:51:13

* You might want to call the variable `anneau` something else.
* The existing `sage.matrix.berlekamp_massey.berlekamp_massey` more or less computes the same thing and may be faster. (The same goes for `sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint.rational_reconstruct` in the case of series over `Z/nZ`.)


---

Comment by git created at 2013-12-20 10:06:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmezzarobba created at 2014-02-04 14:32:08

Hi Frédéric,

I had a look at your new version and started changing a few things in `u/mmezzarobba/14720-pade`, but I stopped midstream. (I'm intentionally not setting the ticket's branch field to my branch, because it is half-broken.)

Here are some remaining issues.

* The code does not work over `RR`:
  {{{
  sage: R.<z> = RR[[]]
  sage: f = exp(2*z)
  sage: f.pade(3,3)
  ...
  ValueError: variable names must be alphanumeric, but one is '0.000000000000000 + 1.00000000000000*z' which is not.
  }}}
  I fixed the `ValueError` by changing the definition of `polyring` to `self.parent()._poly_ring()`, but this is not enough: the degrees of the resulting polynomials are wrong due to round-off errors.
* The doc should mention how large the order of `self` needs to be (and/or the function should raise a meaningful error when it is too small).


---

Comment by mmezzarobba created at 2014-02-04 15:02:37

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-02-04 21:29:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-02-21 15:34:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-02-21 15:35:58

I have added a truncation to the polynomials computed as determinants, in order to ensure they have the right degree. This probably means that the algorithm is not very well suited to handle the case of real coefficients, but, well, in the absence of another algorithm..


---

Comment by chapoton created at 2014-02-21 15:35:58

Changing status from needs_work to needs_review.


---

Comment by mmezzarobba created at 2014-02-22 17:17:37

Looks good to me. I pushed some minor changes; please set the ticket to positive review if you agree.

Thanks for your work!
----
New commits:


---

Comment by chapoton created at 2014-02-22 19:37:24

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2014-02-22 19:37:24

ok, looks good to me. Thanks for the review !


---

Comment by vbraun created at 2014-02-23 07:46:23

Resolution: fixed
