# Issue 22958: Stop using cysignals .pxi files in interpreters

Issue created by migration from https://trac.sagemath.org/ticket/23195

Original creator: jdemeyer

Original creation time: 2017-06-09 10:02:11

CC:  embray

Follow-up to #22806 and #22896: we should stop using the deprecated files `cysignals/memory.pxi` and `cysignals/signals.pxi`.

This deals with the auto-generated interpreters files. Besides changing the include to a cimport, we also clean up and optimize the memory allocation code a bit.


---

Comment by jdemeyer created at 2017-06-09 12:10:02

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2017-06-09 12:10:02

New commits:


---

Comment by embray created at 2017-06-09 12:19:26

I don't really know enough about the differences between the old and new APIs to really have an opinion about this, but it seems obvious and straightforward enough.


---

Comment by jdemeyer created at 2017-06-09 12:26:52

Replying to [comment:4 embray]:
> I don't really know enough about the differences between the old and new APIs

The main goal here is getting rid of the of Cython `include` statements, which are semi-deprecated(*) by Cython upstream.

The change from `sig_malloc` to `check_allocarray` is just a minor clean-up which removes the need for the `NULL` check.

(*) They would like to deprecate `include` statements. However, there are some corner cases where `include` statements make sense, so they don't formally deprecate them. Instead, they just keep them working in the current state, rejecting any new features.


---

Comment by tscrim created at 2017-06-09 12:50:19

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-06-09 12:50:19

LGTM.


---

Comment by jdemeyer created at 2017-06-12 10:35:07

This doesn't strictly depend on #23196.


---

Comment by jdemeyer created at 2017-06-12 10:37:46

Actually, it does depend since this branch contains the commit from #23196.


---

Comment by vbraun created at 2017-06-15 23:09:46

Resolution: fixed
