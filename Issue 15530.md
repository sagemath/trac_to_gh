# Issue 15530: Upgrade PARI to 2.7

Issue created by migration from https://trac.sagemath.org/ticket/15767

Original creator: jdemeyer

Original creation time: 2014-01-30 16:27:35

CC:  jpflori pbruin snark

PARI 2.7 is not yet released, but we can prepare for the release by packaging PARI-2.6.2


---

Comment by pbruin created at 2014-01-30 16:32:13

Good plan; there have been quite a few changes (also in the interface) from 2.5 to 2.6, but 2.7 (being a stable release) will be close to 2.6.2.


---

Comment by jdemeyer created at 2014-02-09 01:06:25

New commits:


---

Comment by git created at 2014-02-09 12:52:59

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-09 14:18:41

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-09 14:43:42

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-09 14:44:46

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-09 15:00:04

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2014-02-09 15:02:10

This version compiles fine, but there are about a million doctest failures :-(


---

Comment by git created at 2014-02-09 16:29:13

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2014-02-09 17:44:14

This is a serious regression:

```
sage: EllipticCurve('90c3').integral_points(both_signs=False)
[(-15 : 7 : 1), (1 : 39 : 1), (21 : 79 : 1)]
```



---

Comment by git created at 2014-02-09 17:55:19

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-09 20:10:33

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-09 20:59:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-09 21:22:19

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-10 09:58:40

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-11 09:47:47

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by pbruin created at 2014-02-11 11:19:07

I know this isn't ready yet; I was just browsing the branch to see how many changes need to be made.  Are you sure the following is correct?  I think the purpose of the `ellinit()` call is to allow the user to specify the curve in short Weierstrass form (`ellinit([a, b]) --> y^2 = x^3 + a*x + b`).

```diff
@@ -1903,7 +1903,7 @@ bnfellrank(bnf,ell,help=[],bigflag=1,flag3=1) =
local(urst,urst1,den,factden,eqtheta,rnfeq,bbnf,ext,rang);
if( DEBUGLEVEL_ell >= 3, print("entree dans bnfellrank"));
- if( #ell <= 5, ell = ellinit(ell,1));
+ ell = vector(5, i, ell[i]);
\\ removes the coefficients a1 and a3
urst = [1,0,0,0];
```



---

Comment by jdemeyer created at 2014-02-11 11:21:49

Replying to [comment:23 pbruin]:
> I know this isn't ready yet; I was just browsing the branch to see how many changes need to be made.  Are you sure the following is correct?  I think the purpose of the `ellinit()` call is to allow the user to specify the curve in short Weierstrass form (`ellinit([a, b]) --> y^2 = x^3 + a*x + b`).
> {{{
> #!diff
> `@``@` -1903,7 +1903,7 `@``@` bnfellrank(bnf,ell,help=[],bigflag=1,flag3=1) =
> local(urst,urst1,den,factden,eqtheta,rnfeq,bbnf,ext,rang);
> if( DEBUGLEVEL_ell >= 3, print("entree dans bnfellrank"));
> - if( #ell <= 5, ell = ellinit(ell,1));
> + ell = vector(5, i, ell[i]);
> \\ removes the coefficients a1 and a3
> urst = [1,0,0,0];
> }}}

OK, I see what you mean. We could change it to

```
ell = ellinit(ell);
ell = vector(5, i, ell[i]);
```



---

Comment by jdemeyer created at 2014-02-11 11:26:24

We could also try to merge #11005 first, maybe that helps.


---

Comment by pbruin created at 2014-02-11 11:35:01

Replying to [comment:25 jdemeyer]:
> We could also try to merge #11005 first, maybe that helps.
OK, I'll take a look at that one.


---

Comment by git created at 2014-02-11 17:00:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-12 10:52:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-12 15:26:54

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-12 16:22:39

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-13 09:43:39

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-13 10:48:29

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-13 11:17:12

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-15 09:22:00

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-16 11:36:44

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-21 21:28:39

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-02-21 21:33:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-02-21 22:18:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-02-24 12:40:57

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-03-04 09:00:11

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-03-04 18:48:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-03-04 18:54:57

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-03-05 06:17:37

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-03-05 13:37:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-03-06 10:06:03

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2014-03-06 10:06:57

New commits:


---

Comment by git created at 2014-03-06 10:26:23

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-03-06 10:43:00

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-03-06 12:25:41

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-03-18 08:51:06

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2014-03-18 08:52:42

New commits:


---

Comment by jpflori created at 2014-03-18 09:02:54

Hi Jeroen,

What's the status of this?
Are there still hundreds of failing stuff?
With the forced pushes its not that easy to see how the situtation evolves.
And I've not tested it yet.

Whatsoever, thanks for the hard work.


---

Comment by git created at 2014-03-18 09:43:41

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2014-03-18 09:47:24

Replying to [comment:60 jpflori]:
> Hi Jeroen,
> 
> What's the status of this?
> Are there still hundreds of failing stuff?
> With the forced pushes its not that easy to see how the situtation evolves.
> And I've not tested it yet.
It's almost ready. The announcement of the PARI-2.7 release candidate gave me a good reason to finish this ticket. Sage doctests found many (10 or so) bugs in PARI, all of which have been fixed upstream.

The forced pushes are the most convenient way to develop this, otherwise I would have 100 commits and several merges in between. I will now look into the remaining doctest failures.


---

Comment by jpflori created at 2014-03-18 09:49:19

Sure, I wasn't criticizing your way of doing things.
Just get a status report if possible at this point and know if it's worth having a look at it and potentially give you a hand.


---

Comment by git created at 2014-03-18 10:23:21

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2014-03-18 18:50:49

This passes 64-bit doctests for me. Now building a 32-bit version to check that...


---

Comment by git created at 2014-03-23 13:05:00

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by fbissey created at 2014-04-01 23:54:41

Hi,

I didn't see any changes in spkg-install in the last commit. Is there any? I am asking because in #16017 we noticed that pari doesn't have the right install_name for OS X. It turns out [http://trac.sagemath.org/ticket/16017#comment:43](http://trac.sagemath.org/ticket/16017#comment:43) that it is caused by cruft in spkg-install. I don't think it has any value and I am wondering if you could remove it as a part of this ticket.


---

Comment by jdemeyer created at 2014-04-02 06:34:00

Replying to [comment:68 fbissey]:
> Hi,
> 
> I didn't see any changes in spkg-install in the last commit. Is there any?
No, this ticket does not change `spkg-install`. So you should make the changes you propose either on #16017 or on a new ticket.


---

Comment by jdemeyer created at 2014-04-02 06:35:19

Let me also give a general status of this ticket: the single one remaining issue is the following doctest failure on 32-bit:

```
sage -t --long src/doc/en/reference/coercion/index.rst
**********************************************************************
File "src/doc/en/reference/coercion/index.rst", line 65, in doc.en.reference.coercion.index
Failed example:
    f = EllipticCurve('37a').lseries().taylor_series(10); f
Expected:
    0.997997869801216 + 0.00140712894524925*z - 0.000498127610960097*z^2 + 0.000118835596665956*z^3 - 0.0000215906522442707*z^4 + (3.20363155418419e-6)*z^5 + O(z^6)
Got:
    -0.0000405744363329341 + 2.21638825958869*z - 2.40591010134898*z^2 + 1.70010490236379*z^3 - 0.876833052881789*z^4 + 0.350599228549426*z^5 + O(z^6)
**********************************************************************
```


The problem is that the result is totally wrong.

I have been busy with other things lately, so I haven't looked into this issue.


---

Comment by git created at 2014-04-11 08:27:27

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-04-11 13:06:03

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-04-11 13:51:48

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-04-15 08:42:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2014-05-01 17:17:31

Any progress on the remaining doctest failure?  I don't have access to a 32-bit machine, otherwise I could try to look into it.


---

Comment by git created at 2014-05-03 08:17:42

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-05-03 21:13:38

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-05-05 08:28:48

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-05-07 11:45:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2014-05-07 11:45:52

New commits:


---

Comment by pbruin created at 2014-06-05 11:03:38

Are there any obstacles to finishing this ticket soon?


---

Comment by jdemeyer created at 2014-06-05 18:07:57

Only [comment:70]...


---

Comment by Snark created at 2014-06-09 17:47:14

Good news, I found one of my boxes is able to reproduce the problem of comment 70. Now I need to dig what happens... first step would be trying to see if I can reproduce it in gp, because at that point that could also be an upstream issue.


---

Comment by Snark created at 2014-06-09 19:11:51

Using ~/.sage/dokchitser.log, I was able to check the computation against debian's pari-gp package, and find there is the same discrepancy between amd64 and i386, so I reported a problem in debian.


---

Comment by pbruin created at 2014-06-09 20:17:55

I can reproduce this inside GP 2.7.1 (patched version of this ticket) on ARM using the following commands (also adapted from `dokchitser.log`):

```
read("local/share/sage/ext/pari/dokchitser/computel.gp");
default(realprecision, 19);
conductor = 37;
gammaV = [0, 1];
weight = 2;
sgn = -1;
Lpoles = [];
Lresidues = automatic;
e = ellinit([0, 0, 1, -1, 0]);
a(k) = ellak(e, k);
initLdata("a(k)", 1.0);
v = Vec(Lseries(10.0, , 5));
print(v)
```

One gets the correct answer after replacing 19 by 20 in the second line, presumably because this increases the precision by one word.


---

Comment by pbruin created at 2014-06-09 23:26:10

According to `git bisect`, the bug is triggered by the following upstream change (PARI Git commit 8cfb9c6b, incorrect rounding in mulur):

```diff
diff --git a/src/kernel/none/mp_indep.c b/src/kernel/none/mp_indep.c
index 522e8a6..63f3311 100644
--- a/src/kernel/none/mp_indep.c
+++ b/src/kernel/none/mp_indep.c
@@ -143,10 +143,11 @@ mulur_2(ulong x, GEN y, long s)
   y--; garde = mulll(x,y[lx]);
   for (i=lx-1; i>=3; i--) z[i]=addmul(x,y[i]);
   z[2]=hiremainder; /* != 0 since y normalized and |x| > 1 */
-
   sh = bfffo(hiremainder); m = BITS_IN_LONG-sh;
   if (sh) shift_left(z,z, 2,lx-1, garde,sh);
-  z[1] = evalsigne(s) | evalexpo(m+e); return z;
+  z[1] = evalsigne(s) | evalexpo(m+e);
+  if ((garde << sh) & HIGHBIT) roundr_up_ip(z, lx);
+  return z;
 }
 
 INLINE GEN
```



---

Comment by pbruin created at 2014-06-10 23:26:36

It seems to me that the function `SeriesToContFrac` in Dokchitser's `computel` program is affected by some numerical instability, so that the above rounding fix in PARI leads to wildly different output of this function for the same input.  It is probably possible to solve (or at least diminish) the problem by increasing the variable `asympdigits` in the script.


---

Comment by Snark created at 2014-06-11 05:01:10

Indeed that's what Bill Allombert answered to my bug report in debian: the pari code is correct, and the computeL code looks like it uses catastrophic cancellation... hence it should really shoot for more precision. Either by increasing asymdigits at Peter suggests, or (notice that the following only solves that one example) change the line in dokchitser.py which sets the realprecision to `prec//3+2` to `prec//3+3`.


---

Comment by pbruin created at 2014-06-15 00:34:45

This seems to be a minimal fix:

```diff
diff --git a/src/ext/pari/dokchitser/computel.gp b/src/ext/pari/dokchitser/computel.gp
index 9768874..3494fc9 100644
--- a/src/ext/pari/dokchitser/computel.gp
+++ b/src/ext/pari/dokchitser/computel.gp
@@ -297,7 +297,7 @@ SeriesToContFrac(vec,
   while (1,
     res=concat(res,[vec[1]]);
     ind=0;
-    until(ind==length(vec) || abs(vec[ind+1])>10^-asympdigits,ind++;vec[ind]=0);
+    until(ind==length(vec) || abs(vec[ind+1])>10^(-asympdigits-1),ind++;vec[ind]=0);
     if(ind>=length(vec),break);
     res=concat(res,[ind]);
     vec=Vec(x^ind/Ser(vec));
```

There are also two doctest failures in `elliptic_curves/ell_number_field.py` and `elliptic_curves/height.py` (at least on 32-bit ARM), which appear to be related to `simon_two_descent`.


---

Comment by git created at 2014-06-27 10:14:48

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-06-27 10:16:28

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2014-06-27 15:13:45

We have a new regression (in a doctest added by #8828):

```
sage: K.<a> = NumberField(x^3-2)
sage: E = EllipticCurve([0,0,0,0,a])
sage: E.gens()
[]
```


This used to return

```
sage: K.<a> = NumberField(x^3-2)
sage: E = EllipticCurve([0,0,0,0,a])
sage: E.gens()
[(1/3*a^2 + a + 5/3 : -2*a^2 - 4/3*a - 5/3 : 1)]
```



---

Comment by git created at 2014-06-27 15:14:42

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-06-27 15:58:28

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by pbruin created at 2014-07-15 12:28:55

Replying to [comment:98 jdemeyer]:
> We have a new regression (in a doctest added by #8828):
> {{{
> sage: K.<a> = NumberField(x^3-2)
> sage: E = EllipticCurve([0,0,0,0,a])
> sage: E.gens()
> []
> }}}
> 
> This used to return
> {{{
> sage: K.<a> = NumberField(x^3-2)
> sage: E = EllipticCurve([0,0,0,0,a])
> sage: E.gens()
> [(1/3*a^2 + a + 5/3 : -2*a^2 - 4/3*a - 5/3 : 1)]
> }}}
The parameter `lim1` for Simon's 2-descent program needs to be adjusted (default is 2, minimal value for which a point is found is now apparently 5):

```diff
diff --git a/src/sage/schemes/elliptic_curves/height.py b/src/sage/schemes/elliptic_curves/height.py
index 8d0ef41..6917594 100644
--- a/src/sage/schemes/elliptic_curves/height.py
+++ b/src/sage/schemes/elliptic_curves/height.py
@@ -1800,7 +1800,7 @@ class EllipticCurveCanonicalHeight:
         This curve does have a point of good reduction whose canonical
         point is approximately 1.68::
 
-            sage: P = E.gens()[0]
+            sage: P = E.gens(lim1=5)[0]
             sage: P.height()
             1.68038085233673
             sage: P.has_good_reduction()
```



---

Comment by pbruin created at 2014-07-15 14:22:01

Replying to [comment:101 pbruin]:
> The parameter `lim1` for Simon's 2-descent program needs to be adjusted (default is 2, minimal value for which a point is found is now apparently 5):
Actually the same can be done much more efficiently using `lim3` instead (with `lim1` it needlessly increases the search bound for quartics that are not everywhere locally soluble):

```diff
diff --git a/src/sage/schemes/elliptic_curves/height.py b/src/sage/schemes/elliptic_curves/height.py
index 8d0ef41..6917594 100644
--- a/src/sage/schemes/elliptic_curves/height.py
+++ b/src/sage/schemes/elliptic_curves/height.py
@@ -1800,7 +1800,7 @@ class EllipticCurveCanonicalHeight:
         This curve does have a point of good reduction whose canonical
         point is approximately 1.68::
 
-            sage: P = E.gens()[0]
+            sage: P = E.gens(lim3=5)[0]
             sage: P.height()
             1.68038085233673
             sage: P.has_good_reduction()
```



---

Comment by pbruin created at 2014-07-15 19:02:19

The other remaining failure on 32-bit (see comment:94) is in the following doctest (in `ell_number_field.py`, introduced in #15483):

```
sage: K.<s> = QuadraticField(229)
sage: c4 = 2173 - 235*(1 - s)/2
sage: c6 = -124369 + 15988*(1 - s)/2
sage: E = EllipticCurve([-c4/48, -c6/864])
sage: E.simon_two_descent()
(0, 0, [])
```

This returns `(1, 1, [])` on 32-bit because a certain quartic is incorrectly determined to be locally soluble at infinity.  It appears to be caused by `polsturm` being called on a polynomial whose precision is too low.  This bug is similar to but different than the one in #15483, and seems somewhat harder to fix.


---

Comment by pbruin created at 2014-07-16 12:02:56

It seems the above problem can be solved by computing the exact inequalities appearing in Sturm's method and checking them using the function `nfrealsign()` from the script.  I am uploading a patch that I also sent to Denis Simon.


---

Attachment

Trac 15767: more exact Archimedean computations in ell.gp


---

Comment by pbruin created at 2014-07-21 11:12:45

It seems that the link to the updated `genus2red` has broken.


---

Comment by jpflori created at 2014-07-22 08:47:58

Yes indeed, note that I downloaded it a few days ago without problem.


---

Comment by jdemeyer created at 2014-07-30 20:56:34

I have been away for 3 weeks without touching anything Sage-related, so I'm just coming back to this now.

Strange that the boxen link doesn't work anymore, even this gives a 404: [http://boxen.math.washington.edu/home/jdemeyer](http://boxen.math.washington.edu/home/jdemeyer) (luckily, the directory on boxen still exists). Does anybody have a clue what could have caused this? If no, I should ask on sagemath-admins.


---

Comment by pbruin created at 2014-07-31 08:18:37

Replying to [comment:107 jdemeyer]:
> Strange that the boxen link doesn't work anymore, even this gives a 404: [http://boxen.math.washington.edu/home/jdemeyer](http://boxen.math.washington.edu/home/jdemeyer) (luckily, the directory on boxen still exists). Does anybody have a clue what could have caused this?
This could be relevant: https://groups.google.com/forum/#!topic/sage-devel/dhON2NJoSoc


---

Comment by kcrisman created at 2014-08-15 11:06:18

The issue with the links is fixed, so perhaps it's time to review this (e.g. #16165 depends on this).


---

Comment by jdemeyer created at 2014-08-18 09:57:34

Sure, I'll start with rebasing to the latest beta. Hold on...


---

Comment by jdemeyer created at 2014-08-18 10:07:45

Replying to [comment:101 pbruin]:
> The parameter `lim1` for Simon's 2-descent program needs to be adjusted (default is 2, minimal value for which a point is found is now apparently 5):
Do you happen to know the deeper reason why this needs to be changed?

I'll make the change in the doctest.


---

Comment by jdemeyer created at 2014-08-18 10:08:48

Did you get any answers from Denis Simon yet?


---

Comment by git created at 2014-08-18 10:14:54

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by pbruin created at 2014-08-18 11:06:26

Replying to [comment:112 jdemeyer]:
> Replying to [comment:101 pbruin]:
> > The parameter `lim1` for Simon's 2-descent program needs to be adjusted (default is 2, minimal value for which a point is found is now apparently 5):
> Do you happen to know the deeper reason why this needs to be changed?
No, I only found this experimentally.  I would guess some PARI number field function returns a more complicated or "unlucky" result than before in this example.
> Did you get any answers from Denis Simon yet?
So far I didn't.


---

Comment by git created at 2014-08-18 13:34:43

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jdemeyer created at 2014-08-18 13:35:03

I rebased this ticket and added the fixes by Peter Bruin. It now again passes doctests on 64-bit.


---

Comment by pbruin created at 2014-08-18 16:15:49

I am now running `make ptestlong` on ARM 32-bit.


---

Comment by jdemeyer created at 2014-08-18 20:07:05

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2014-08-18 20:07:05

Tests pass on 32-bit Linux! Party!


---

Comment by pbruin created at 2014-08-18 22:34:37

And all the developers rejoiced!

If you agree with the (small) changes in the reviewer patch, this ticket is good to go as far as I'm concerned.


---

Comment by rws created at 2014-08-19 09:42:50

Changing status from needs_review to needs_work.


---

Comment by rws created at 2014-08-19 09:42:50

Fails on OpenSuSE 12.3:

```
sage -t --long src/sage/libs/pari/gen.pyx
**********************************************************************
File "src/sage/libs/pari/gen.pyx", line 2236, in sage.libs.pari.gen.gen.Ser
Failed example:
    pari(Mod(0, 7)).Ser()
Expected:
    O(x^16)
Got:
    Mod(0, 7) + O(x^16)
**********************************************************************
1 item had failures:
   1 of   9 in sage.libs.pari.gen.gen.Ser
    [1270 tests, 1 failure, 1.48 s]
```



---

Comment by jdemeyer created at 2014-08-19 09:47:00

Replying to [comment:121 rws]:
> Fails on OpenSuSE 12.3

Indeed, the last commit broke this.


---

Comment by pbruin created at 2014-08-19 09:52:50

Replying to [comment:121 rws]:
> Fails on OpenSuSE 12.3:
Ouch, that is my fault.  The change to `Ser()` was the last thing I added to my reviewer patch; I tested everything that I thought might call this code, but inexplicably forgot to test the file itself.  I'll fix the doctest.


---

Comment by git created at 2014-08-19 09:53:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2014-08-19 09:57:27

Peter, could you please add some documentation for the application of Sturm's Theorem in `ell.gp`? I checked the calculations by hand and it looks correct, but it would be nice to have the calculation as comment in the file.


---

Comment by git created at 2014-08-19 11:13:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by pbruin created at 2014-08-19 11:14:00

Changing status from needs_work to needs_review.


---

Comment by pbruin created at 2014-08-19 11:14:00

Replying to [comment:125 jdemeyer]:
> Peter, could you please add some documentation for the application of Sturm's Theorem in `ell.gp`? I checked the calculations by hand and it looks correct, but it would be nice to have the calculation as comment in the file.
Done in the above commit.


---

Comment by jdemeyer created at 2014-08-19 11:32:42

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2014-08-19 11:32:42

Replying to [comment:127 pbruin]:
> Done in the above commit.
Nice.


---

Comment by vbraun created at 2014-08-19 22:12:48

I'm getting merge failures, will release beta1 soon. Please merge with that release then.


---

Comment by vbraun created at 2014-08-19 22:12:48

Changing status from positive_review to needs_work.


---

Comment by jdemeyer created at 2014-08-20 09:09:01

Replying to [comment:129 vbraun]:
> I'm getting merge failures, will release beta1 soon. Please merge with that release then.
OK, I will do that. Unfortunately, this ticket tends to give a lot of conflicts because it touches so much code (in a way which cannot really be avoided). For beta2, I hope you will give this ticket priority and ask other branches to merge with this.


---

Comment by vbraun created at 2014-08-20 10:29:36

I've released beta1, if you can resolve the conflicts soon then I'll merge this as the first ticket.


---

Comment by jdemeyer created at 2014-08-20 11:52:48

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2014-08-20 11:52:48

Done. I'm running doctests now to check that nothing got broken.


---

Comment by pbruin created at 2014-08-20 12:24:58

This branch agrees (up to whitespace) with a merge I did.  If it passes doctests, you can set it back to positive review.


---

Comment by jdemeyer created at 2014-08-20 14:22:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-08-20 20:21:55

Resolution: fixed
