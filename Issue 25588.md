# Issue 25588: Move gap_packages and cremona db to features

archive/issues_025588.json:
```json
{
    "body": "CC:  tscrim fbissey mkoeppe\n\nThis continues the work in #20382. After this patch is applied, only one usage of `is_package_installed` remains: The one in `OptionalExtension`.\n\nTo test this I ran `./sage -t --optional=sage,gap_packages,database_cremona_ellcurve $( git diff --name-only HEAD~2 )`.\n\nAfter this I would propose to fix the usage in `OptionalExtension` (which seems to be a purely internal function just used for the build -- should be easy to fix) and then deprecate or remove `is_package_installed`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25825\n\n",
    "created_at": "2018-07-11T13:18:28Z",
    "labels": [
        "build",
        "major",
        "enhancement"
    ],
    "title": "Move gap_packages and cremona db to features",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25588",
    "user": "@timokau"
}
```
CC:  tscrim fbissey mkoeppe

This continues the work in #20382. After this patch is applied, only one usage of `is_package_installed` remains: The one in `OptionalExtension`.

To test this I ran `./sage -t --optional=sage,gap_packages,database_cremona_ellcurve $( git diff --name-only HEAD~2 )`.

After this I would propose to fix the usage in `OptionalExtension` (which seems to be a purely internal function just used for the build -- should be easy to fix) and then deprecate or remove `is_package_installed`.

Issue created by migration from https://trac.sagemath.org/ticket/25825





---

archive/issue_comments_360688.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-11T13:18:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360688",
    "user": "@timokau"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_360689.json:
```json
{
    "body": "I just discovered #24718. This seems to be related/a duplicate. But that ticket seems to do some more unrelated stuff and probably needs a rebase. No clue why that is still \"new\".",
    "created_at": "2018-07-11T17:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360689",
    "user": "@timokau"
}
```

I just discovered #24718. This seems to be related/a duplicate. But that ticket seems to do some more unrelated stuff and probably needs a rebase. No clue why that is still "new".



---

archive/issue_comments_360690.json:
```json
{
    "body": "In any case, I would rather have 1 ticket for each issue (1 for GAP, one for the Cremona database).",
    "created_at": "2018-07-11T18:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360690",
    "user": "jdemeyer"
}
```

In any case, I would rather have 1 ticket for each issue (1 for GAP, one for the Cremona database).



---

archive/issue_comments_360691.json:
```json
{
    "body": "Sure, I'll split it up.",
    "created_at": "2018-07-11T19:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360691",
    "user": "@timokau"
}
```

Sure, I'll split it up.



---

archive/issue_comments_360692.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-07-11T19:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360692",
    "user": "@timokau"
}
```

New commits:



---

archive/issue_comments_360693.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-07-11T19:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360693",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_360694.json:
```json
{
    "body": "Split to this and #25835.",
    "created_at": "2018-07-11T19:44:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360694",
    "user": "@timokau"
}
```

Split to this and #25835.



---

archive/issue_comments_360695.json:
```json
{
    "body": "As I mentioned on #24718: We should also use the database location discovered by the feature check instead of hardcoding it. In other words: there should be a single source for the database location.",
    "created_at": "2018-07-11T21:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360695",
    "user": "jdemeyer"
}
```

As I mentioned on #24718: We should also use the database location discovered by the feature check instead of hardcoding it. In other words: there should be a single source for the database location.



---

archive/issue_comments_360696.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-07-11T21:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360696",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_360697.json:
```json
{
    "body": "What do you mean by \"discover\"? It looks to me like the path to the database is just as hardcoded in the feature. Am I reading that wrong?\n\nThat should probably use the environment variable I introduced in #25309 though. So that'll have to be merged first.",
    "created_at": "2018-07-11T21:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360697",
    "user": "@timokau"
}
```

What do you mean by "discover"? It looks to me like the path to the database is just as hardcoded in the feature. Am I reading that wrong?

That should probably use the environment variable I introduced in #25309 though. So that'll have to be merged first.



---

archive/issue_comments_360698.json:
```json
{
    "body": "Replying to [comment:10 gh-timokau]:\n> It looks to me like the path to the database is just as hardcoded in the feature.\n\nYes, it's hardcoded in two different places which is bad design. There should be single source for it.",
    "created_at": "2018-07-11T22:09:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360698",
    "user": "jdemeyer"
}
```

Replying to [comment:10 gh-timokau]:
> It looks to me like the path to the database is just as hardcoded in the feature.

Yes, it's hardcoded in two different places which is bad design. There should be single source for it.



---

archive/issue_comments_360699.json:
```json
{
    "body": "I agree, I'll use the environment variable after #25309 is merged.",
    "created_at": "2018-07-11T22:21:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360699",
    "user": "@timokau"
}
```

I agree, I'll use the environment variable after #25309 is merged.



---

archive/issue_comments_360700.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-08-06T12:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360700",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_360701.json:
```json
{
    "body": "Alright I'm using the proper environment variables now.",
    "created_at": "2018-08-06T12:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360701",
    "user": "@timokau"
}
```

Alright I'm using the proper environment variables now.



---

archive/issue_comments_360702.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-06T12:20:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360702",
    "user": "@timokau"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_360703.json:
```json
{
    "body": "My point was that you shouldn't use `CREMONA_MINI_DATA_DIR, CREMONA_LARGE_DATA_DIR` at all in the implementation, as the `Feature` already knows the filename.",
    "created_at": "2018-08-06T12:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360703",
    "user": "jdemeyer"
}
```

My point was that you shouldn't use `CREMONA_MINI_DATA_DIR, CREMONA_LARGE_DATA_DIR` at all in the implementation, as the `Feature` already knows the filename.



---

archive/issue_comments_360704.json:
```json
{
    "body": "Yes the filename, but not the directory. How is it supposed to know that?",
    "created_at": "2018-08-06T13:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360704",
    "user": "@timokau"
}
```

Yes the filename, but not the directory. How is it supposed to know that?



---

archive/issue_comments_360705.json:
```json
{
    "body": "I guess you should ask the feature for the path and not import it independently, see `StaticFile.absolute_path()`.",
    "created_at": "2018-08-07T17:09:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360705",
    "user": "saraedum"
}
```

I guess you should ask the feature for the path and not import it independently, see `StaticFile.absolute_path()`.



---

archive/issue_comments_360706.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-07T17:10:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360706",
    "user": "saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_360707.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2018-08-07T18:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360707",
    "user": "@timokau"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_360708.json:
```json
{
    "body": "But how is the feature supposed to know the path?",
    "created_at": "2018-08-07T18:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360708",
    "user": "@timokau"
}
```

But how is the feature supposed to know the path?



---

archive/issue_comments_360709.json:
```json
{
    "body": "The features looks at `CREMONA_*_DATA_DIR`. The point is that this information is only in the feature and users of the feature should not look at these variables again, i.e., the feature's implementation can change and we do not have to update all the users.",
    "created_at": "2018-08-07T18:55:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360709",
    "user": "saraedum"
}
```

The features looks at `CREMONA_*_DATA_DIR`. The point is that this information is only in the feature and users of the feature should not look at these variables again, i.e., the feature's implementation can change and we do not have to update all the users.



---

archive/issue_comments_360710.json:
```json
{
    "body": "This is of course not so terribly important but it feels cleaner like that to me. (And closer to my idea of how features are supposed to work.)",
    "created_at": "2018-08-07T18:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360710",
    "user": "saraedum"
}
```

This is of course not so terribly important but it feels cleaner like that to me. (And closer to my idea of how features are supposed to work.)



---

archive/issue_comments_360711.json:
```json
{
    "body": "Ah, that makes sense to me. Also would make it easier to switch out the ad-hoc environment variables for a `./configure` based system in the future. I thought Jeroen meant that I shouldn't use the environment variable at all.",
    "created_at": "2018-08-07T20:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360711",
    "user": "@timokau"
}
```

Ah, that makes sense to me. Also would make it easier to switch out the ad-hoc environment variables for a `./configure` based system in the future. I thought Jeroen meant that I shouldn't use the environment variable at all.



---

archive/issue_comments_360712.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2018-08-07T20:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360712",
    "user": "@timokau"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_360713.json:
```json
{
    "body": "In that case we'd still need `CREMONA_MINI_DATA_DIR` though, creating an assymetry. Should I change over anyways? Or make the two cremona databases mutually exclusive, always going through the feature and unifying the two env variables?",
    "created_at": "2018-08-07T20:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360713",
    "user": "@timokau"
}
```

In that case we'd still need `CREMONA_MINI_DATA_DIR` though, creating an assymetry. Should I change over anyways? Or make the two cremona databases mutually exclusive, always going through the feature and unifying the two env variables?



---

archive/issue_comments_360714.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2018-08-07T20:17:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360714",
    "user": "@timokau"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_360715.json:
```json
{
    "body": "Shouldn't both databases be features? Isn't the only difference that the mini one is a standard SPKG and the full one is optional?",
    "created_at": "2018-08-07T20:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360715",
    "user": "saraedum"
}
```

Shouldn't both databases be features? Isn't the only difference that the mini one is a standard SPKG and the full one is optional?



---

archive/issue_comments_360716.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2018-08-07T20:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360716",
    "user": "saraedum"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_360717.json:
```json
{
    "body": "Yes, why would we use a feature to detect a standard package? Its always available by definition. Of course I would prefer to move more packages to `optional` and make sage more modular, but currently the mini db is standard.",
    "created_at": "2018-08-07T20:41:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360717",
    "user": "@timokau"
}
```

Yes, why would we use a feature to detect a standard package? Its always available by definition. Of course I would prefer to move more packages to `optional` and make sage more modular, but currently the mini db is standard.



---

archive/issue_comments_360718.json:
```json
{
    "body": "It's a standard package in Sage-the-distribution but it still makes sense to use the feature infrastructure as it might make things easier for (us) packagers. Even if we always ship it we can rely on the features detecting the correct paths for things.",
    "created_at": "2018-08-07T21:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360718",
    "user": "saraedum"
}
```

It's a standard package in Sage-the-distribution but it still makes sense to use the feature infrastructure as it might make things easier for (us) packagers. Even if we always ship it we can rely on the features detecting the correct paths for things.



---

archive/issue_comments_360719.json:
```json
{
    "body": "I'm not sure if features are the right choice / intended for that use case. In general I think detecting time at runtime usually causes problems. Would that feature then only provide a path?\n\nCC'ing fbissey because this is related to #25309, which apparently created problems for him.",
    "created_at": "2018-08-07T21:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360719",
    "user": "@timokau"
}
```

I'm not sure if features are the right choice / intended for that use case. In general I think detecting time at runtime usually causes problems. Would that feature then only provide a path?

CC'ing fbissey because this is related to #25309, which apparently created problems for him.



---

archive/issue_comments_360720.json:
```json
{
    "body": "Thanks for the concern but I am a proponent of using `features` more (been wanting to move to such thing for years), and the part of #25309 related to this ticket is fine by me.",
    "created_at": "2018-08-07T22:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360720",
    "user": "fbissey"
}
```

Thanks for the concern but I am a proponent of using `features` more (been wanting to move to such thing for years), and the part of #25309 related to this ticket is fine by me.



---

archive/issue_comments_360721.json:
```json
{
    "body": "I think it should be a feature in particular because we should not handle the large database differently from the mini database.\n\nThe feature would tell you whether the mini database is present (which must be true) and provide its path. I think for the cremona DBs that's all we need.",
    "created_at": "2018-08-07T22:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360721",
    "user": "saraedum"
}
```

I think it should be a feature in particular because we should not handle the large database differently from the mini database.

The feature would tell you whether the mini database is present (which must be true) and provide its path. I think for the cremona DBs that's all we need.



---

archive/issue_comments_360722.json:
```json
{
    "body": "Alright and what should we do if the database is not present?",
    "created_at": "2018-08-07T23:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360722",
    "user": "@timokau"
}
```

Alright and what should we do if the database is not present?



---

archive/issue_comments_360723.json:
```json
{
    "body": "For the mini database: I would just ask for its `absolute_path()` which throws if it cannot find it. If that happens, I'd just let it throw. It won't happen on a properly configured setup. (and maybe add something like that as a comment in the code\u2026)\n\nDoes that make sense?",
    "created_at": "2018-08-09T00:17:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360723",
    "user": "saraedum"
}
```

For the mini database: I would just ask for its `absolute_path()` which throws if it cannot find it. If that happens, I'd just let it throw. It won't happen on a properly configured setup. (and maybe add something like that as a comment in the code…)

Does that make sense?



---

archive/issue_comments_360724.json:
```json
{
    "body": "Yeah that makes sense, I'll look into it.",
    "created_at": "2018-08-09T08:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360724",
    "user": "@timokau"
}
```

Yeah that makes sense, I'll look into it.



---

archive/issue_comments_360725.json:
```json
{
    "body": "Should I then remove `CREMONA_{LARGE,MINI}_DATA_DIR` entirely from `env.py` and instead read the variable directly (with fallback) in the feature?\n\nThat would have the advantage that there would be only one way to get that information. Otherwise, it will be easy for future code to use the variable from `env.py` instead.\n\nBut there would be the disadvantage that it wouldn't be as easy anymore to figure out which variables can be set to configure locations.\n\n`@`fbissey as you were involved with `env.py`, do you have an opinion about that?",
    "created_at": "2018-08-09T08:46:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360725",
    "user": "@timokau"
}
```

Should I then remove `CREMONA_{LARGE,MINI}_DATA_DIR` entirely from `env.py` and instead read the variable directly (with fallback) in the feature?

That would have the advantage that there would be only one way to get that information. Otherwise, it will be easy for future code to use the variable from `env.py` instead.

But there would be the disadvantage that it wouldn't be as easy anymore to figure out which variables can be set to configure locations.

`@`fbissey as you were involved with `env.py`, do you have an opinion about that?



---

archive/issue_comments_360726.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-09T15:45:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360726",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_360727.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2018-08-09T15:50:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360727",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_360728.json:
```json
{
    "body": "I added a mechanism to `StaticFile` that takes an environment variable as an override for `search_path`. It will then also notify the user of the existence of that search path when the file is not found. I like that solution even better than the `env.py` one.\n\nFor the record: I think `resolution()` should be refactored to return a list of lines for easier extensibility. The variable `resolution` should be removed because users can just override `resolution()` if they want to change the message. But that is out of scope of this ticket.\n\nAlso in the future I hope `search_path_override` could be replaced by a key in a configuration file instead of an env var.\n----\nNew commits:",
    "created_at": "2018-08-09T15:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360728",
    "user": "@timokau"
}
```

I added a mechanism to `StaticFile` that takes an environment variable as an override for `search_path`. It will then also notify the user of the existence of that search path when the file is not found. I like that solution even better than the `env.py` one.

For the record: I think `resolution()` should be refactored to return a list of lines for easier extensibility. The variable `resolution` should be removed because users can just override `resolution()` if they want to change the message. But that is out of scope of this ticket.

Also in the future I hope `search_path_override` could be replaced by a key in a configuration file instead of an env var.
----
New commits:



---

archive/issue_comments_360729.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-09T15:51:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360729",
    "user": "@timokau"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_360730.json:
```json
{
    "body": "This appears to need some kind of rebasing.",
    "created_at": "2019-01-25T22:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360730",
    "user": "fbissey"
}
```

This appears to need some kind of rebasing.



---

archive/issue_comments_360731.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-02-15T10:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360731",
    "user": "jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_360732.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-03-09T16:57:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360732",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_360733.json:
```json
{
    "body": "Rebased.\n----\nNew commits:",
    "created_at": "2019-03-09T16:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360733",
    "user": "@timokau"
}
```

Rebased.
----
New commits:



---

archive/issue_comments_360734.json:
```json
{
    "body": "Are there any outstanding issues with this ticket or should we put it back to positive review?",
    "created_at": "2019-03-17T22:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360734",
    "user": "fbissey"
}
```

Are there any outstanding issues with this ticket or should we put it back to positive review?



---

archive/issue_comments_360735.json:
```json
{
    "body": "For consistency, I would prefer if the handling of environment variables would remain in `src/sage/env.py`. Right now, you're moving part of that to `src/sage/features/__init__.py`",
    "created_at": "2019-03-18T06:31:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360735",
    "user": "jdemeyer"
}
```

For consistency, I would prefer if the handling of environment variables would remain in `src/sage/env.py`. Right now, you're moving part of that to `src/sage/features/__init__.py`



---

archive/issue_comments_360736.json:
```json
{
    "body": "How would you suggest we do that? I'm not convinced hard-coding a search path override variable for every feature would be a better solution, but if you prefer that I'll implement it.",
    "created_at": "2019-03-18T08:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360736",
    "user": "@timokau"
}
```

How would you suggest we do that? I'm not convinced hard-coding a search path override variable for every feature would be a better solution, but if you prefer that I'll implement it.



---

archive/issue_comments_360737.json:
```json
{
    "body": "Maybe just use `search_path=[CREMONA_MINI_DATA_DIR]` in `src/sage/features/databases.py`? That wouldn't require any changes to the general feature framework.",
    "created_at": "2019-03-18T09:14:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360737",
    "user": "jdemeyer"
}
```

Maybe just use `search_path=[CREMONA_MINI_DATA_DIR]` in `src/sage/features/databases.py`? That wouldn't require any changes to the general feature framework.



---

archive/issue_comments_360738.json:
```json
{
    "body": "Let's try to finish this... I'm having a look at it now.",
    "created_at": "2019-04-30T08:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360738",
    "user": "jdemeyer"
}
```

Let's try to finish this... I'm having a look at it now.



---

archive/issue_comments_360739.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-04-30T10:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360739",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_360740.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-04-30T10:07:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360740",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_360741.json:
```json
{
    "body": "The last 2 commits are not strictly needed, they are just cleaning stuff up. If a reviewer prefers to move that to a separate ticket, I'll do that.",
    "created_at": "2019-04-30T10:08:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360741",
    "user": "jdemeyer"
}
```

The last 2 commits are not strictly needed, they are just cleaning stuff up. If a reviewer prefers to move that to a separate ticket, I'll do that.



---

archive/issue_comments_360742.json:
```json
{
    "body": "I am just verifying the last two cleanup commits are good.",
    "created_at": "2019-04-30T11:50:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360742",
    "user": "tscrim"
}
```

I am just verifying the last two cleanup commits are good.



---

archive/issue_comments_360743.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-07-15T20:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360743",
    "user": "arojas"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_360744.json:
```json
{
    "body": "Rebase needed",
    "created_at": "2019-07-15T20:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360744",
    "user": "arojas"
}
```

Rebase needed



---

archive/issue_comments_360745.json:
```json
{
    "body": "Let's please try to get this finally in\n----\nNew commits:",
    "created_at": "2020-10-08T16:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360745",
    "user": "arojas"
}
```

Let's please try to get this finally in
----
New commits:



---

archive/issue_comments_360746.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-10-08T16:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360746",
    "user": "arojas"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_360747.json:
```json
{
    "body": "Ticket description needs updating",
    "created_at": "2020-10-08T16:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360747",
    "user": "mkoeppe"
}
```

Ticket description needs updating



---

archive/issue_comments_360748.json:
```json
{
    "body": "Replying to [comment:56 mkoeppe]:\n> Ticket description needs updating\n\nIs the `OptionalExtension` bit still relevant? I'm not familiar with the recent changes in that area.",
    "created_at": "2020-10-08T16:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360748",
    "user": "arojas"
}
```

Replying to [comment:56 mkoeppe]:
> Ticket description needs updating

Is the `OptionalExtension` bit still relevant? I'm not familiar with the recent changes in that area.



---

archive/issue_comments_360749.json:
```json
{
    "body": "No, the use of `OptionalExtension` has been eliminated. See https://wiki.sagemath.org/ReleaseTours/sage-9.2#For_developers:_Changes_to_the_build_system_of_sagelib",
    "created_at": "2020-10-08T16:18:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360749",
    "user": "mkoeppe"
}
```

No, the use of `OptionalExtension` has been eliminated. See https://wiki.sagemath.org/ReleaseTours/sage-9.2#For_developers:_Changes_to_the_build_system_of_sagelib



---

archive/issue_comments_360750.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-10-08T16:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360750",
    "user": "mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_360751.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-10-31T18:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25588",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25588#issuecomment-360751",
    "user": "vbraun"
}
```

Resolution: fixed
