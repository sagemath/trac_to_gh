# Issue 28475: clarify acceptable input to prime_range

Issue created by migration from https://trac.sagemath.org/ticket/28712

Original creator: @DaveWitteMorris

Original creation time: 2019-11-09 07:19:46

The function `prime_range` has two algorithms, and they do not accept the same types of input. The  "pari_isprime" algorithm accepts any input that can be coerced to an integer, because the `primes` function executes `start = ZZ(start)` and `stop = ZZ(stop)`. In contrast, the "pari_primes" algorithm simply executes the cython code `c_start = start` and `c_stop = stop` (where `c_start` and `c_stop`  are `cdef long`), without any coercion. But "pari_primes" does accept non-integer real numbers as input, which the "pari_isprime" algorithm does not. (Actually, this description of "pari_primes" is not completely accurate after ticket:28467, but the behavior is still similar to this.)

This ticket proposes to harmonize the two algorithms, so that both accept anything that either can be coerced to an integer, or is a real number. (Note that the file ??? would cause a doctest error if the "pari_primes" algorithm were changed to reject non-integer real input.)

The proposed patch may also provide error messages that are more helpful when code runs into trouble by passing bad input to `prime_range`, because an exception will be thrown up front, during the attempt to coerce or round.

The issue in this ticket was split off from ticket:28467.


---

Comment by @DaveWitteMorris created at 2019-11-09 07:31:48

Changing status from new to needs_review.


---

Comment by @DaveWitteMorris created at 2019-11-09 07:31:48

Changing type from PLEASE CHANGE to enhancement.


---

Comment by @DaveWitteMorris created at 2019-12-29 04:59:22

Changing status from needs_review to needs_work.


---

Comment by @DaveWitteMorris created at 2019-12-29 04:59:22

Doctest failures with Python 3.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by git created at 2020-01-19 07:02:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @DaveWitteMorris created at 2020-01-19 07:05:33

Changing status from needs_work to needs_review.


---

Comment by @DaveWitteMorris created at 2020-01-19 07:05:33

I merged the latest version of ticket #28467, and then fixed the bug that was causing doctest failures with Python 3.


---

Comment by @DaveWitteMorris created at 2020-04-07 02:01:51

Rebased on #28467 and 9.1b9.
----
Last 10 new commits:


---

Comment by git created at 2020-04-12 22:32:58

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by @DaveWitteMorris created at 2020-04-12 22:45:28

This ticket had a conflict with the latest changes to #28467, so I merged them. I also moved a few doctests (and deleted duplicates).


---

Comment by git created at 2020-04-15 08:20:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kedlaya created at 2020-09-20 03:39:23

Patchbot is morally green, and this otherwise looks fine to me.


---

Comment by kedlaya created at 2020-09-20 03:39:23

Changing status from needs_review to positive_review.


---

Comment by @DaveWitteMorris created at 2020-09-20 04:36:08

Thanks for the review!


---

Comment by slelievre created at 2020-11-26 20:35:54

Changing priority from minor to major.


---

Comment by @DaveWitteMorris created at 2020-11-26 22:07:04

Resolved minor merge conflict ("algorithm == None" ==> "algorithm is None").

I cannot run full doctests, because my sage installation has some problems, but I don't expect any complaints from the patchbots.
----
New commits:


---

Comment by @DaveWitteMorris created at 2020-11-26 22:17:51

Changing status from positive_review to needs_review.


---

Comment by kedlaya created at 2020-11-27 01:09:49

Patchbot looks good!


---

Comment by kedlaya created at 2020-11-27 01:09:49

Changing status from needs_review to positive_review.


---

Comment by @DaveWitteMorris created at 2020-11-27 01:37:39

Thanks for reviewing it again!


---

Comment by vbraun created at 2020-12-06 22:47:16

the format for dependencies is comma-separate ticket numbers


---

Comment by @DaveWitteMorris created at 2020-12-07 00:03:59

Sorry for the mis-formatted dependency. Thanks for fixing it.

The doctest failures (on the steenrod patchbot) are not from this ticket.  They are ticket:30764 and ticket:29528.


---

Comment by slelievre created at 2020-12-07 03:43:46

Actually we need comma separated ticket numbers with `#`
in the "dependencies" field.


---

Comment by vbraun created at 2020-12-13 20:31:10

Resolution: fixed
