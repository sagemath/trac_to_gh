# Issue 27328: Fix segfault / memory corruption in OpenBLAS

archive/issues_027328.json:
```json
{
    "body": "Keywords: openblas\n\nThere is a bug in OpenBLAS [already fixed upstream](https://github.com/xianyi/OpenBLAS/pull/1957) which I am encountering on Cygwin, though it could also affect Linux (in fact the original bug report was for Linux).\n\nFor Sage, this bug is causing a segfault on Cygwin when running\n\n\n```\n./sage -t --long src/sage/manifolds/differentiable/vectorfield.py\n```\n\n\nbut it could happen arbitrarily anywhere that uses OpenBLAS and that happens to use threads (even without using OpenBLAS threads).\n\nI have already confirmed that the upstream fix resolves the issue for me.\n\nIssue created by migration from https://trac.sagemath.org/ticket/27565\n\n",
    "created_at": "2019-03-29T07:27:27Z",
    "labels": [
        "packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "Fix segfault / memory corruption in OpenBLAS",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27328",
    "user": "embray"
}
```
Keywords: openblas

There is a bug in OpenBLAS [already fixed upstream](https://github.com/xianyi/OpenBLAS/pull/1957) which I am encountering on Cygwin, though it could also affect Linux (in fact the original bug report was for Linux).

For Sage, this bug is causing a segfault on Cygwin when running


```
./sage -t --long src/sage/manifolds/differentiable/vectorfield.py
```


but it could happen arbitrarily anywhere that uses OpenBLAS and that happens to use threads (even without using OpenBLAS threads).

I have already confirmed that the upstream fix resolves the issue for me.

Issue created by migration from https://trac.sagemath.org/ticket/27565





---

archive/issue_comments_385252.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-29T07:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385252",
    "user": "embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_385253.json:
```json
{
    "body": "There is no changes to openblas on this branch. Did you forget to commit?",
    "created_at": "2019-03-29T21:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385253",
    "user": "fbissey"
}
```

There is no changes to openblas on this branch. Did you forget to commit?



---

archive/issue_comments_385254.json:
```json
{
    "body": "Strange.  It looks like I did.",
    "created_at": "2019-04-01T09:35:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385254",
    "user": "embray"
}
```

Strange.  It looks like I did.



---

archive/issue_comments_385255.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-04-01T09:37:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385255",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_385256.json:
```json
{
    "body": "There it is.  I was working on this on the train last week so who knows what could've interrupted me.",
    "created_at": "2019-04-01T09:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385256",
    "user": "embray"
}
```

There it is.  I was working on this on the train last week so who knows what could've interrupted me.



---

archive/issue_comments_385257.json:
```json
{
    "body": "Including a a patch merged upstream. I think it is safe.",
    "created_at": "2019-04-01T09:40:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385257",
    "user": "fbissey"
}
```

Including a a patch merged upstream. I think it is safe.



---

archive/issue_comments_385258.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-01T09:40:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385258",
    "user": "fbissey"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_385259.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:",
    "created_at": "2019-04-03T09:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385259",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:



---

archive/issue_comments_385260.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-04-03T09:32:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385260",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_385261.json:
```json
{
    "body": "Rebased on 8.8.beta0 (not strictly necessary, but I wanted to anyways so that I could test the rest of 8.8.beta0 on Cygwin).",
    "created_at": "2019-04-03T09:34:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385261",
    "user": "embray"
}
```

Rebased on 8.8.beta0 (not strictly necessary, but I wanted to anyways so that I could test the rest of 8.8.beta0 on Cygwin).



---

archive/issue_comments_385262.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-03T09:34:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385262",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_385263.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-03T18:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385263",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_385264.json:
```json
{
    "body": "The branch on this didn't get updated for some reason.",
    "created_at": "2019-04-18T09:50:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27328",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27328#issuecomment-385264",
    "user": "embray"
}
```

The branch on this didn't get updated for some reason.
