# Issue 14646: Arithmetic operators extracted from expressions do not support holding

Issue created by migration from Trac.

Original creator: eviatarbach

Original creation time: 2013-07-03 22:01:50

Assignee: burcin

The fact that calling `.operator()` on symbolic expressions with arithmetic operations returns a function that does not support holding means that a held expression cannot be properly reconstructed:

```
sage: a = x.add(x, hold=True)         
sage: a
x + x
sage: a.operator()(x, x)
2*x
sage: a.operator()(x, x, hold=True)
...
TypeError: add() takes no keyword arguments
```


This causes problems for #10034.


---

Comment by burcin created at 2013-07-03 22:40:18

Isn't this a duplicate of #10169?

We should create a module `sage.symbolic.operator`, and override functions defined in Pythons `operator` module with others, which take multiple arguments when appropriate and support a hold argument if you like. Hopefully this can be done by wrapping the existing functions defined in `operator` with minimum code duplication and speed penalty.


---

Comment by eviatarbach created at 2013-07-05 18:35:02

I suppose, although that one is a fairly broad ticket. Maybe this one should just be dedicated to fixing the arithmetic operators?

Another problem is that the operators in the `operator` module only accept two arguments, which is a major problem, since there is no way to reliably reconstruct expressions such as `x + 3 + y`.


---

Comment by burcin created at 2013-07-08 07:19:06

Changing status from new to needs_review.


---

Comment by burcin created at 2013-07-08 07:19:06

Replying to [comment:2 eviatarbach]:
> I suppose, although that one is a fairly broad ticket. Maybe this one should just be dedicated to fixing the arithmetic operators?
> 
> Another problem is that the operators in the `operator` module only accept two arguments, which is a major problem, since there is no way to reliably reconstruct expressions such as `x + 3 + y`.

This is exactly item 2 in what Simon requests in #10169. I described how I think it should be fixed in comment:1.

I don't think we should have an identity operator which is returned instead of `None` for `var('x').operator()`. So this leaves only item 2 in #10169, which is identical to this ticket. Other cases where `ex.operator()(*ex.operands())` do not hold should get their own ticket, like #10136.


---

Comment by rws created at 2014-03-24 17:39:22

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-03-31 15:06:01

Resolution: duplicate
