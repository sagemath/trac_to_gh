# Issue 19628: Added functionality to compute zeta functions of nondegenerate hypersurfaces over finite fields

Issue created by migration from Trac.

Original creator: malcolmkotok

Original creation time: 2016-01-11 19:23:31

CC:  malcolmkotok ursula kedlaya

Keywords: zeta, p-adic, L-function

As part of my Ph.D. thesis I am implementing a function to compute zeta functions of nondegenerate hypersurfaces over finite fields. I wish to incorporate this into Sage. For more information see: http://arxiv.org/abs/1112.4881


---

Comment by kedlaya created at 2016-03-27 20:16:09

There is also a project by Costa, Harvey, and myself to do a different computation of zeta functions of nondegenerate toric hypersurfaces, using Monsky-Washnitzer cohomology in place of Dwork's series method. It's not yet clear how these two methods will compare (the Sperber-Voight method is optimized towards sparse hypersurfaces somewhat more than our approach), so it would be valuable to have both!


---

Comment by kedlaya created at 2016-04-05 02:49:11

Note also ticket #15239 regarding testing for nondegeneracy, which might be worth dealing with first.


---

Comment by roed created at 2017-07-17 17:37:42

Changing keywords from "zeta, p-adic, L-function" to "zeta, p-adic, L-function, sd87".


---

Comment by kedlaya created at 2017-09-23 04:17:54

For (my own) convenience, the link to the code is http://hdl.handle.net/1802/30832.

Related projects: #20265, #23863.


---

Comment by kedlaya created at 2017-09-26 03:58:56

Changing keywords from "zeta, p-adic, L-function, sd87" to "zeta, p-adic, L-function, sd87, sd91".


---

Comment by jantuitman created at 2017-10-10 14:25:37

I tried this code about a year ago and it seemed to have some serious problems like it not finishing for a plane quartic curve over F_p (for any p). I wrote to Kotok about this, but never heard back from him. It could be some trivial issue, but it is hard to say.


---

Comment by kedlaya created at 2017-10-11 05:05:19

My understanding is that some successful experiments with the code were made at SD91. Maybe someone can push the result to trac so that the rest of us can help with stress-testing?


---

Comment by jantuitman created at 2017-10-11 09:49:25

Ok, here is what I'm talking about:



```
load("ffzeta.sage");
R.<x,y>=PolynomialRing(ZZ,2);

# does work:
Q=y^2-(x^3+x+1); p=13;
ffzeta(Q,p,verbose=True);

# does not work:
Q=y^4+(5*x-4)*y^3+(3*x^2+2*x-3)*y^2+(x^3+4*x^2-2*x+3)*y+(3*x^4-2*x^3-4*x^2+2*x+2); p=11;
ffzeta(Q,p,verbose=True);

```



---

Comment by kedlaya created at 2017-10-11 14:55:56

The Sperber-Voight algorithm being implemented here has as a complexity parameter the number of interior monomials, so it probably doesn't stand much of a chance for dense equations (although descending it from Sage to Cython might help near the borderline).

For smooth projective hypersurfaces, we also have tickets #20265 (deformation) and #23863 (controlled reduction). For nondegenerate toric hypersurfaces, Edgar Costa has functioning C code doing controlled reduction, but I believe it is not yet available for public consumption.


---

Comment by mwest created at 2017-10-20 14:34:21

We have some debugging to make this a method for polynomials.  There are definitely errors in the computation in the multivariate example at the beginning of the function.
----
New commits:


---

Comment by chapoton created at 2019-10-08 14:13:14

New commits:


---

Comment by git created at 2019-10-08 15:27:29

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2019-10-08 15:59:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-10-08 16:11:07

Maybe this could be saved ?


---

Comment by kedlaya created at 2019-12-16 00:34:00

Just tried this and there is still something wrong:

```
File "src/sage/rings/polynomial/multi_polynomial.pyx", line 2494, in sage.rings.polynomial.multi_polynomial.MPolynomial.zeta_function
Failed example:
    (x^3+x+1-y^2).zeta_function(7)
Expected:
    (7*T^7 - 17*T^6 + 14*T^5 - 12*T^4 + 18*T^3 - 14*T^2 + 5*T - 1)/(7*T - 1)
Got:
    (-3*T^4 + 2*T^3 + 4*T^2 - 2*T - 1)/(7*T - 1)
```

I was not one of the people working on this at sd91, so I wouldn't know what the issue is.


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by kedlaya created at 2020-08-14 21:47:25

Still not sure what is going on here. This passage in `zeta_function.py` is nonsensical:

```
            # Reduce remaining part
            meta = Gm.parent()(m * eta[i])
            x_i = Gm.parent()(x[i])
            Gmbar = -sum([x_i * meta.derivative(x_i) for i in range(n + 1)])
```

but fixing it doesn't have any effect on the doctests (the terms in the sum are all zero anyway).

Another data point: the ratio of the answers with `affine=True` and `affine=False` is not correct either.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.
