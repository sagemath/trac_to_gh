# Issue 19628: Added functionality to compute zeta functions of nondegenerate hypersurfaces over finite fields

archive/issues_019628.json:
```json
{
    "body": "CC:  malcolmkotok ursula @kedlaya\n\nKeywords: zeta, p-adic, L-function\n\nAs part of my Ph.D. thesis I am implementing a function to compute zeta functions of nondegenerate hypersurfaces over finite fields. I wish to incorporate this into Sage. For more information see: http://arxiv.org/abs/1112.4881\n\nIssue created by migration from https://trac.sagemath.org/ticket/19865\n\n",
    "created_at": "2016-01-11T19:23:31Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Added functionality to compute zeta functions of nondegenerate hypersurfaces over finite fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19628",
    "user": "https://trac.sagemath.org/admin/accounts/users/malcolmkotok"
}
```
CC:  malcolmkotok ursula @kedlaya

Keywords: zeta, p-adic, L-function

As part of my Ph.D. thesis I am implementing a function to compute zeta functions of nondegenerate hypersurfaces over finite fields. I wish to incorporate this into Sage. For more information see: http://arxiv.org/abs/1112.4881

Issue created by migration from https://trac.sagemath.org/ticket/19865





---

archive/issue_comments_269385.json:
```json
{
    "body": "There is also a project by Costa, Harvey, and myself to do a different computation of zeta functions of nondegenerate toric hypersurfaces, using Monsky-Washnitzer cohomology in place of Dwork's series method. It's not yet clear how these two methods will compare (the Sperber-Voight method is optimized towards sparse hypersurfaces somewhat more than our approach), so it would be valuable to have both!",
    "created_at": "2016-03-27T20:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269385",
    "user": "https://github.com/kedlaya"
}
```

There is also a project by Costa, Harvey, and myself to do a different computation of zeta functions of nondegenerate toric hypersurfaces, using Monsky-Washnitzer cohomology in place of Dwork's series method. It's not yet clear how these two methods will compare (the Sperber-Voight method is optimized towards sparse hypersurfaces somewhat more than our approach), so it would be valuable to have both!



---

archive/issue_comments_269386.json:
```json
{
    "body": "Note also ticket #15239 regarding testing for nondegeneracy, which might be worth dealing with first.",
    "created_at": "2016-04-05T02:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269386",
    "user": "https://github.com/kedlaya"
}
```

Note also ticket #15239 regarding testing for nondegeneracy, which might be worth dealing with first.



---

archive/issue_comments_269387.json:
```json
{
    "body": "Changing keywords from \"zeta, p-adic, L-function\" to \"zeta, p-adic, L-function, sd87\".",
    "created_at": "2017-07-17T17:37:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269387",
    "user": "https://github.com/roed314"
}
```

Changing keywords from "zeta, p-adic, L-function" to "zeta, p-adic, L-function, sd87".



---

archive/issue_comments_269388.json:
```json
{
    "body": "For (my own) convenience, the link to the code is http://hdl.handle.net/1802/30832.\n\nRelated projects: #20265, #23863.",
    "created_at": "2017-09-23T04:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269388",
    "user": "https://github.com/kedlaya"
}
```

For (my own) convenience, the link to the code is http://hdl.handle.net/1802/30832.

Related projects: #20265, #23863.



---

archive/issue_comments_269389.json:
```json
{
    "body": "Changing keywords from \"zeta, p-adic, L-function, sd87\" to \"zeta, p-adic, L-function, sd87, sd91\".",
    "created_at": "2017-09-26T03:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269389",
    "user": "https://github.com/kedlaya"
}
```

Changing keywords from "zeta, p-adic, L-function, sd87" to "zeta, p-adic, L-function, sd87, sd91".



---

archive/issue_comments_269390.json:
```json
{
    "body": "I tried this code about a year ago and it seemed to have some serious problems like it not finishing for a plane quartic curve over F_p (for any p). I wrote to Kotok about this, but never heard back from him. It could be some trivial issue, but it is hard to say.",
    "created_at": "2017-10-10T14:25:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269390",
    "user": "https://trac.sagemath.org/admin/accounts/users/jantuitman"
}
```

I tried this code about a year ago and it seemed to have some serious problems like it not finishing for a plane quartic curve over F_p (for any p). I wrote to Kotok about this, but never heard back from him. It could be some trivial issue, but it is hard to say.



---

archive/issue_comments_269391.json:
```json
{
    "body": "My understanding is that some successful experiments with the code were made at SD91. Maybe someone can push the result to trac so that the rest of us can help with stress-testing?",
    "created_at": "2017-10-11T05:05:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269391",
    "user": "https://github.com/kedlaya"
}
```

My understanding is that some successful experiments with the code were made at SD91. Maybe someone can push the result to trac so that the rest of us can help with stress-testing?



---

archive/issue_comments_269392.json:
```json
{
    "body": "Ok, here is what I'm talking about:\n\n\n```\nload(\"ffzeta.sage\");\nR.<x,y>=PolynomialRing(ZZ,2);\n\n# does work:\nQ=y^2-(x^3+x+1); p=13;\nffzeta(Q,p,verbose=True);\n\n# does not work:\nQ=y^4+(5*x-4)*y^3+(3*x^2+2*x-3)*y^2+(x^3+4*x^2-2*x+3)*y+(3*x^4-2*x^3-4*x^2+2*x+2); p=11;\nffzeta(Q,p,verbose=True);\n\n```",
    "created_at": "2017-10-11T09:49:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269392",
    "user": "https://trac.sagemath.org/admin/accounts/users/jantuitman"
}
```

Ok, here is what I'm talking about:


```
load("ffzeta.sage");
R.<x,y>=PolynomialRing(ZZ,2);

# does work:
Q=y^2-(x^3+x+1); p=13;
ffzeta(Q,p,verbose=True);

# does not work:
Q=y^4+(5*x-4)*y^3+(3*x^2+2*x-3)*y^2+(x^3+4*x^2-2*x+3)*y+(3*x^4-2*x^3-4*x^2+2*x+2); p=11;
ffzeta(Q,p,verbose=True);

```



---

archive/issue_comments_269393.json:
```json
{
    "body": "The Sperber-Voight algorithm being implemented here has as a complexity parameter the number of interior monomials, so it probably doesn't stand much of a chance for dense equations (although descending it from Sage to Cython might help near the borderline).\n\nFor smooth projective hypersurfaces, we also have tickets #20265 (deformation) and #23863 (controlled reduction). For nondegenerate toric hypersurfaces, Edgar Costa has functioning C code doing controlled reduction, but I believe it is not yet available for public consumption.",
    "created_at": "2017-10-11T14:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269393",
    "user": "https://github.com/kedlaya"
}
```

The Sperber-Voight algorithm being implemented here has as a complexity parameter the number of interior monomials, so it probably doesn't stand much of a chance for dense equations (although descending it from Sage to Cython might help near the borderline).

For smooth projective hypersurfaces, we also have tickets #20265 (deformation) and #23863 (controlled reduction). For nondegenerate toric hypersurfaces, Edgar Costa has functioning C code doing controlled reduction, but I believe it is not yet available for public consumption.



---

archive/issue_comments_269394.json:
```json
{
    "body": "We have some debugging to make this a method for polynomials.  There are definitely errors in the computation in the multivariate example at the beginning of the function.\n\n---\nNew commits:",
    "created_at": "2017-10-20T14:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269394",
    "user": "https://github.com/mckenziewest"
}
```

We have some debugging to make this a method for polynomials.  There are definitely errors in the computation in the multivariate example at the beginning of the function.

---
New commits:



---

archive/issue_events_054299.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-10-08T14:13:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54299"
}
```



---

archive/issue_comments_269395.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-10-08T14:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269395",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_269396.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-10-08T15:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269396",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_269397.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-08T15:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269397",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_269398.json:
```json
{
    "body": "Maybe this could be saved ?",
    "created_at": "2019-10-08T16:11:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269398",
    "user": "https://github.com/fchapoton"
}
```

Maybe this could be saved ?



---

archive/issue_comments_269399.json:
```json
{
    "body": "Just tried this and there is still something wrong:\n\n```\nFile \"src/sage/rings/polynomial/multi_polynomial.pyx\", line 2494, in sage.rings.polynomial.multi_polynomial.MPolynomial.zeta_function\nFailed example:\n    (x^3+x+1-y^2).zeta_function(7)\nExpected:\n    (7*T^7 - 17*T^6 + 14*T^5 - 12*T^4 + 18*T^3 - 14*T^2 + 5*T - 1)/(7*T - 1)\nGot:\n    (-3*T^4 + 2*T^3 + 4*T^2 - 2*T - 1)/(7*T - 1)\n```\nI was not one of the people working on this at sd91, so I wouldn't know what the issue is.",
    "created_at": "2019-12-16T00:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269399",
    "user": "https://github.com/kedlaya"
}
```

Just tried this and there is still something wrong:

```
File "src/sage/rings/polynomial/multi_polynomial.pyx", line 2494, in sage.rings.polynomial.multi_polynomial.MPolynomial.zeta_function
Failed example:
    (x^3+x+1-y^2).zeta_function(7)
Expected:
    (7*T^7 - 17*T^6 + 14*T^5 - 12*T^4 + 18*T^3 - 14*T^2 + 5*T - 1)/(7*T - 1)
Got:
    (-3*T^4 + 2*T^3 + 4*T^2 - 2*T - 1)/(7*T - 1)
```
I was not one of the people working on this at sd91, so I wouldn't know what the issue is.



---

archive/issue_comments_269400.json:
```json
{
    "body": "Ticket retargeted after milestone closed",
    "created_at": "2020-01-06T14:10:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269400",
    "user": "https://github.com/embray"
}
```

Ticket retargeted after milestone closed



---

archive/issue_events_054300.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54300"
}
```



---

archive/issue_events_054301.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2020-01-06T14:10:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54301"
}
```



---

archive/issue_comments_269401.json:
```json
{
    "body": "Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.",
    "created_at": "2020-04-14T19:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269401",
    "user": "https://github.com/mkoeppe"
}
```

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.



---

archive/issue_events_054302.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54302"
}
```



---

archive/issue_events_054303.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-04-14T19:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54303"
}
```



---

archive/issue_comments_269402.json:
```json
{
    "body": "Still not sure what is going on here. This passage in `zeta_function.py` is nonsensical:\n\n```\n            # Reduce remaining part\n            meta = Gm.parent()(m * eta[i])\n            x_i = Gm.parent()(x[i])\n            Gmbar = -sum([x_i * meta.derivative(x_i) for i in range(n + 1)])\n```\nbut fixing it doesn't have any effect on the doctests (the terms in the sum are all zero anyway).\n\nAnother data point: the ratio of the answers with `affine=True` and `affine=False` is not correct either.",
    "created_at": "2020-08-14T21:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269402",
    "user": "https://github.com/kedlaya"
}
```

Still not sure what is going on here. This passage in `zeta_function.py` is nonsensical:

```
            # Reduce remaining part
            meta = Gm.parent()(m * eta[i])
            x_i = Gm.parent()(x[i])
            Gmbar = -sum([x_i * meta.derivative(x_i) for i in range(n + 1)])
```
but fixing it doesn't have any effect on the doctests (the terms in the sum are all zero anyway).

Another data point: the ratio of the answers with `affine=True` and `affine=False` is not correct either.



---

archive/issue_events_054304.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54304"
}
```



---

archive/issue_events_054305.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-09-05T19:21:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54305"
}
```



---

archive/issue_events_054306.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54306"
}
```



---

archive/issue_events_054307.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54307"
}
```



---

archive/issue_comments_269403.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19628#issuecomment-269403",
    "user": "https://github.com/mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_054308.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54308"
}
```



---

archive/issue_events_054309.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54309"
}
```



---

archive/issue_events_054310.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54310"
}
```



---

archive/issue_events_054311.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54311"
}
```



---

archive/issue_events_054312.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54312"
}
```



---

archive/issue_events_054313.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-02T04:32:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54313"
}
```



---

archive/issue_events_054314.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T16:33:45Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54314"
}
```



---

archive/issue_events_054315.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T16:33:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/19628",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19628#event-54315"
}
```
