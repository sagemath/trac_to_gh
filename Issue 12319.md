# Issue 12319: Bring two more plot3d files to 100% coverage

Issue created by migration from https://trac.sagemath.org/ticket/12491

Original creator: kcrisman

Original creation time: 2012-02-10 13:50:07

Assignee: jason, was


```

plot3d/list_plot3d.py: 25% (1 of 4)
plot3d/parametric_plot3d.py: 20% (1 of 5)


$ ./sage -coverage devel/sage/sage/plot/plot3d/plot3d.py 
----------------------------------------------------------------------
devel/sage/sage/plot/plot3d/plot3d.py
ERROR: Please add a `TestSuite(s).run()` doctest.
SCORE devel/sage/sage/plot/plot3d/plot3d.py: 83% (15 of 18)

Missing documentation:
	 * triangle(self, a, b, c, color = None):
	 * smooth_triangle(self, a, b, c, da, db, dc, color = None):
	 * axes(scale=1, radius=None, **kwds):


$ ../../sage -coverage sage/plot/plot3d/parametric_plot3d.py 
----------------------------------------------------------------------
sage/plot/plot3d/parametric_plot3d.py
SCORE sage/plot/plot3d/parametric_plot3d.py: 20% (1 of 5)

Missing doctests:
	 * _parametric_plot3d_curve(f, urange, plot_points, **kwds):
	 * _parametric_plot3d_surface(f, urange, vrange, plot_points, boundary_style, **kwds):
	 * adapt_if_symbolic(f):
	 * adapt_to_callable(f, nargs=None):
```


Base ticket: #12024 bringing docs to 90%.


---

Comment by kcrisman created at 2012-02-11 01:54:04

Just some notes...
 * `axes` appears to be used nowhere else, but since it is in a doctest, I won't remove it on this ticket.  See also some of the other constructions in the various 3d plot directories which perform similar functions.
 * `adapt_to_callable` is deprecated, as is a piece in it where we use function-call syntax.  Given that this was deprecated in #7008 (and let me tell you, figuring that out was nontrivial!) and Sage-4.1.2, from October 2009, I am going to remove this.


---

Comment by kcrisman created at 2012-02-11 02:26:37

In addition, `adapt_if_symbolic`, while not deprecated, has been stated to be for internal use since [changeset 8271](http://trac.sagemath.org/sage_trac/changeset?new=8271%3A89ae58cb0bd1%40sage%2Fplot%2Fplot3d%2Fparametric_plot3d.py&old=8268%3Aea1f2da82d0f%40sage%2Fplot%2Fplot3d%2Fparametric_plot3d.py) and has not been used anywhere in Sage since [changeset 8272](http://trac.sagemath.org/sage_trac/changeset?new=8272%3A03f8ccee86a8%40sage%2Fplot%2Fplot3d%2Fparametric_plot3d.py&old=8271%3A89ae58cb0bd1%40sage%2Fplot%2Fplot3d%2Fparametric_plot3d.py) - January, 2008, Sage 2.10.1.

So I'm going to remove it.


---

Comment by kcrisman created at 2012-02-11 02:48:58

Based on 5.0.beta3


---

Attachment

It seems to pass all tests, and I looked at all the examples I added.  Coverage is good.  Needs review!


---

Comment by kcrisman created at 2012-02-11 02:49:46

Changing status from new to needs_review.


---

Comment by davidloeffler created at 2012-03-12 20:53:17

Apply trac_12491.patch, trac_12491-review.patch

(for the patchbot). This looks fine; I found no problems except a couple of minor typos and formatting fixes. Also I flagged some doctests with `#indirect doctest` where necessary. Karl: if you're happy with my changes you can give this a positive review.


---

Attachment

Apply over previous patch


---

Comment by davidloeffler created at 2012-03-12 23:08:45

Apply trac_12491.patch, trac_12491-review.patch

(for the patchbot, which spotted a trailing whitespace character in my previous patch)


---

Comment by kcrisman created at 2012-03-13 15:07:39

I guess I try to do the most minor stuff possible.  I don't have time to look at this right now, but I'll try to do so soon.

What's up with the indirect stuff?  I assume this is for `sage -coverage`?  I only check whether it _has_ a doctest, not that stuff.  Thanks.


---

Comment by jhpalmieri created at 2012-03-13 18:36:31

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2012-03-13 18:36:31

Replying to [comment:7 kcrisman]:
> What's up with the indirect stuff?  I assume this is for `sage -coverage`?

Yes, exactly. The review patch looks good to me.

By the way, is it an issue that the instances of the `_Coordinates` class don't seem to be picklable?

```
sage/plot/plot3d/plot3d.py
ERROR: Please add a `TestSuite(s).run()` doctest.
SCORE sage/plot/plot3d/plot3d.py: 100% (18 of 18)
```

But if I add a `TestSuite` doctest, it fails: if I make this change:

```diff
diff --git a/sage/plot/plot3d/plot3d.py b/sage/plot/plot3d/plot3d.py
--- a/sage/plot/plot3d/plot3d.py
+++ b/sage/plot/plot3d/plot3d.py
@@ -108,8 +108,9 @@ class _Coordinates(object):
 
             sage: from sage.plot.plot3d.plot3d import _ArbitraryCoordinates as 
             sage: x,y,z=var('x,y,z')
-            sage: arb((x+z,y*z,z), z, (x,y))
+            sage: c=arb((x+z,y*z,z), z, (x,y)); c
             Arbitrary Coordinates coordinate transform (z in terms of x, y)
+            sage: TestSuite(c).run()
         """
         import inspect
         all_vars=inspect.getargspec(self.transform).args[1:]
```

then I get this failure:

```
sage -t  "devel/sage-main/sage/plot/plot3d/plot3d.py"       
**********************************************************************
File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.0.beta7-gcc/devel/sage-main/sage/plot/plot3d/plot3d.py", line 113:
    sage: TestSuite(c).run()
Expected nothing
Got:
    Failure in _test_pickling:
    Traceback (most recent call last):
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.0.beta7-gcc/local/lib/python/site-packages/sage/misc/sage_unittest.py", line 275, in run
        test_method(tester = tester)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.0.beta7-gcc/local/lib/python/site-packages/sage/misc/sage_unittest.py", line 499, in _test_pickling
        tester.assertEqual(loads(dumps(self._instance)), self._instance)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.0.beta7-gcc/local/lib/python2.7/unittest/case.py", line 509, in assertEqual
        assertion_func(first, second, msg=msg)
      File "/Users/palmieri/Desktop/Sage_stuff/sage_builds/sage-5.0.beta7-gcc/local/lib/python2.7/unittest/case.py", line 502, in _baseAssertEqual
        raise self.failureException(msg)
    AssertionError: Arbitrary Coordinates coordinate transform (z in terms of x, y) != Arbitrary Coordinates coordinate transform (z in terms of x, y)
    ------------------------------------------------------------
    The following tests failed: _test_pickling
```

A doctest like `c == loads(dumps(c))` also fails. If this can be fixed, it probably should be, but on another ticket (unless it's trivial to do here).


---

Comment by kcrisman created at 2012-03-13 18:38:22

Thanks, John.  Definitely another ticket - this pickling stuff is always tricky.


---

Comment by jdemeyer created at 2012-03-21 22:08:31

Resolution: fixed
