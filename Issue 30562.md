# Issue 30562: Add Folder for Manifold Models

archive/issues_030562.json:
```json
{
    "body": "CC:  @egourgoulhon @tscrim\n\nI propose to add a new folder for manifold models:\n\n`src/sage/manifolds/differentiable/models`\n\nFurthermore, I suggest we move `EuclideanSpace` to that folder and make it, besides the global availability, accessible from the catalog, too. The idea is that any manifold model can be accessed via the catalog, and the corresponding files are stored in the `model` folder.\n\nFor manifolds with non-smooth structure (or non-diffeomorphic structures), we can add such a folder in `manifolds`, too. But I don't see the need yet.\n\nIssue created by migration from https://trac.sagemath.org/ticket/30799\n\n",
    "created_at": "2020-10-20T10:33:59Z",
    "labels": [
        "manifolds",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Add Folder for Manifold Models",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30562",
    "user": "@mjungmath"
}
```
CC:  @egourgoulhon @tscrim

I propose to add a new folder for manifold models:

`src/sage/manifolds/differentiable/models`

Furthermore, I suggest we move `EuclideanSpace` to that folder and make it, besides the global availability, accessible from the catalog, too. The idea is that any manifold model can be accessed via the catalog, and the corresponding files are stored in the `model` folder.

For manifolds with non-smooth structure (or non-diffeomorphic structures), we can add such a folder in `manifolds`, too. But I don't see the need yet.

Issue created by migration from https://trac.sagemath.org/ticket/30799





---

archive/issue_comments_436508.json:
```json
{
    "body": "There are now two way that I see (not related to this ticket directly):\n\n1) The methods in `catalog.py` operate as a factory method for each model.\n\n2) Each model manages its own factory in its corresponding file (as in `EuclideanSpace` right now).\n\nNamely, some dimensions have peculiarities that we may want to consider (e.g. S<sup>3</sup> is parallelizable).",
    "created_at": "2020-10-20T10:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436508",
    "user": "@mjungmath"
}
```

There are now two way that I see (not related to this ticket directly):

1) The methods in `catalog.py` operate as a factory method for each model.

2) Each model manages its own factory in its corresponding file (as in `EuclideanSpace` right now).

Namely, some dimensions have peculiarities that we may want to consider (e.g. S<sup>3</sup> is parallelizable).



---

archive/issue_comments_436509.json:
```json
{
    "body": "Here's my proposal in concrete form. Feedback is welcome.\n----\nNew commits:",
    "created_at": "2020-10-20T13:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436509",
    "user": "@mjungmath"
}
```

Here's my proposal in concrete form. Feedback is welcome.
----
New commits:



---

archive/issue_comments_436510.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-10-20T13:16:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436510",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_436511.json:
```json
{
    "body": "I struggle a bit with the word \"model\". Other ideas are welcome.",
    "created_at": "2020-10-20T13:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436511",
    "user": "@mjungmath"
}
```

I struggle a bit with the word "model". Other ideas are welcome.



---

archive/issue_comments_436512.json:
```json
{
    "body": "I don't care for the name \"model\" as it means something slightly different to me than what you intend. I would say \"examples\" is a better name.",
    "created_at": "2020-10-21T09:24:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436512",
    "user": "@tscrim"
}
```

I don't care for the name "model" as it means something slightly different to me than what you intend. I would say "examples" is a better name.



---

archive/issue_comments_436513.json:
```json
{
    "body": "What about calling the folder simply `catalog`? Or would that mess up the structure with the `catalog.py` in the manifold's main folder?",
    "created_at": "2020-10-21T11:23:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436513",
    "user": "@mjungmath"
}
```

What about calling the folder simply `catalog`? Or would that mess up the structure with the `catalog.py` in the manifold's main folder?



---

archive/issue_comments_436514.json:
```json
{
    "body": "Thanks for this ticket. A folder dedicated to standard manifolds sounds like a good idea. Regarding the name, I would lean to `catalog` as suggested in comment:9, with an import statement of the form\n\n```\nfrom sage.manifolds.catalog import Torus   \n```\n\ninstead of \n\n```\nfrom sage.manifolds.differentiable.catalog import Torus   \n```\n\nwhich looks unnecessarily longer and probably more difficult to find via introspection. \n\nApparently, there is no `catalog` folder in all `src/sage`, only `catalog.py` files. I don't know if there is any reason for this...",
    "created_at": "2020-10-21T16:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436514",
    "user": "@egourgoulhon"
}
```

Thanks for this ticket. A folder dedicated to standard manifolds sounds like a good idea. Regarding the name, I would lean to `catalog` as suggested in comment:9, with an import statement of the form

```
from sage.manifolds.catalog import Torus   
```

instead of 

```
from sage.manifolds.differentiable.catalog import Torus   
```

which looks unnecessarily longer and probably more difficult to find via introspection. 

Apparently, there is no `catalog` folder in all `src/sage`, only `catalog.py` files. I don't know if there is any reason for this...



---

archive/issue_comments_436515.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-21T18:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436515",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436516.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-10-21T18:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436516",
    "user": "@mjungmath"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_436517.json:
```json
{
    "body": "Doctest works out for `manifolds` folder. I hope I catched all docstrings refering to `EuclideanSpace` and `real_line`.",
    "created_at": "2020-10-21T18:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436517",
    "user": "@mjungmath"
}
```

Doctest works out for `manifolds` folder. I hope I catched all docstrings refering to `EuclideanSpace` and `real_line`.



---

archive/issue_comments_436518.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-21T19:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436518",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436519.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-21T22:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436519",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436520.json:
```json
{
    "body": "Usually there is just a `catalog.py` because things are not sufficiently complex to warrant a separate subfolder and there can be simple(-ish) functions that create objects that benefit from being together in one file.",
    "created_at": "2020-10-21T23:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436520",
    "user": "@tscrim"
}
```

Usually there is just a `catalog.py` because things are not sufficiently complex to warrant a separate subfolder and there can be simple(-ish) functions that create objects that benefit from being together in one file.



---

archive/issue_comments_436521.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-22T09:16:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436521",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436522.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-10-22T10:37:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436522",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_436523.json:
```json
{
    "body": "Patchbot is green now. :)",
    "created_at": "2020-10-22T14:12:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436523",
    "user": "@mjungmath"
}
```

Patchbot is green now. :)



---

archive/issue_comments_436524.json:
```json
{
    "body": "Replying to [comment:10 egourgoulhon]:\n> Thanks for this ticket. A folder dedicated to standard manifolds sounds like a good idea. Regarding the name, I would lean to `catalog` as suggested in comment:9, with an import statement of the form\n> {{{\n> from sage.manifolds.catalog import Torus   \n> }}}\n> instead of \n> {{{\n> from sage.manifolds.differentiable.catalog import Torus   \n> }}}\n> which looks unnecessarily longer and probably more difficult to find via introspection. \n> \n> Apparently, there is no `catalog` folder in all `src/sage`, only `catalog.py` files. I don't know if there is any reason for this...\n\nBtw, in addition to that, the examples can currently be invoked by\n\n```\nmanifolds.Torus()\n```\n\n\nThis comes from the fact that `all.py` imports\n\n\n```\nimport sage.manifolds.catalog as manifolds\n```\n\n\nI think this is very nice, too.",
    "created_at": "2020-10-22T19:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436524",
    "user": "@mjungmath"
}
```

Replying to [comment:10 egourgoulhon]:
> Thanks for this ticket. A folder dedicated to standard manifolds sounds like a good idea. Regarding the name, I would lean to `catalog` as suggested in comment:9, with an import statement of the form
> {{{
> from sage.manifolds.catalog import Torus   
> }}}
> instead of 
> {{{
> from sage.manifolds.differentiable.catalog import Torus   
> }}}
> which looks unnecessarily longer and probably more difficult to find via introspection. 
> 
> Apparently, there is no `catalog` folder in all `src/sage`, only `catalog.py` files. I don't know if there is any reason for this...

Btw, in addition to that, the examples can currently be invoked by

```
manifolds.Torus()
```


This comes from the fact that `all.py` imports


```
import sage.manifolds.catalog as manifolds
```


I think this is very nice, too.



---

archive/issue_comments_436525.json:
```json
{
    "body": "I would suggest to import the different models in the `catalog/__init__.py` file, so that from a user-perspective there is no real difference in having a big `catalog.py` file or a `catalog` module. This would simplify the import\n\n```\nfrom sage.manifolds.differentiable.catalog.real_line import RealLine\n```\n\nto\n\n```\nfrom sage.manifolds.differentiable.catalog import RealLine\n```\n",
    "created_at": "2020-10-23T07:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436525",
    "user": "@tobiasdiez"
}
```

I would suggest to import the different models in the `catalog/__init__.py` file, so that from a user-perspective there is no real difference in having a big `catalog.py` file or a `catalog` module. This would simplify the import

```
from sage.manifolds.differentiable.catalog.real_line import RealLine
```

to

```
from sage.manifolds.differentiable.catalog import RealLine
```




---

archive/issue_comments_436526.json:
```json
{
    "body": "Replying to [comment:22 gh-tobiasdiez]:\n> I would suggest to import the different models in the `catalog/__init__.py` file, so that from a user-perspective there is no real difference in having a big `catalog.py` file or a `catalog` module. This would simplify the import\n> {{{\n> from sage.manifolds.differentiable.catalog.real_line import RealLine\n> }}}\n> to\n> {{{\n> from sage.manifolds.differentiable.catalog import RealLine\n> }}}\n\nThe import pattern is currently\n\n\n```\nS2 = manifolds.Sphere(2)\n```\n\n\nand\n\n\n```\nfrom sage.manifolds.catalog import Sphere\n\nS2 = Sphere(2)\n```\n\n\nI think this is what we should promote. As Eric pointed out in comment:10,\n\n\n```\nfrom sage.manifolds.differentiable.catalog...\n```\n\n\nis something that should not be promoted, and I agree with him.\n\nHowever, even if the import pattern is the same, the suggested folder structure is nice because it indicates what examples are differentiable manifolds and what not.",
    "created_at": "2020-10-23T08:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436526",
    "user": "@mjungmath"
}
```

Replying to [comment:22 gh-tobiasdiez]:
> I would suggest to import the different models in the `catalog/__init__.py` file, so that from a user-perspective there is no real difference in having a big `catalog.py` file or a `catalog` module. This would simplify the import
> {{{
> from sage.manifolds.differentiable.catalog.real_line import RealLine
> }}}
> to
> {{{
> from sage.manifolds.differentiable.catalog import RealLine
> }}}

The import pattern is currently


```
S2 = manifolds.Sphere(2)
```


and


```
from sage.manifolds.catalog import Sphere

S2 = Sphere(2)
```


I think this is what we should promote. As Eric pointed out in comment:10,


```
from sage.manifolds.differentiable.catalog...
```


is something that should not be promoted, and I agree with him.

However, even if the import pattern is the same, the suggested folder structure is nice because it indicates what examples are differentiable manifolds and what not.



---

archive/issue_comments_436527.json:
```json
{
    "body": "Ok, I also like these conventions. Then I would also promote them in the \"normal\" Sage code, e.g. `from sage.manifolds.catalog import EuclideanSpace` instead of `from sage.manifolds.differentiable.catalog.euclidean import EuclideanSpace` (in the changes in `catalog.py`).",
    "created_at": "2020-10-23T11:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436527",
    "user": "@tobiasdiez"
}
```

Ok, I also like these conventions. Then I would also promote them in the "normal" Sage code, e.g. `from sage.manifolds.catalog import EuclideanSpace` instead of `from sage.manifolds.differentiable.catalog.euclidean import EuclideanSpace` (in the changes in `catalog.py`).



---

archive/issue_comments_436528.json:
```json
{
    "body": "Replying to [comment:24 gh-tobiasdiez]:\n> Ok, I also like these conventions. Then I would also promote them in the \"normal\" Sage code, e.g. `from sage.manifolds.catalog import EuclideanSpace` instead of `from sage.manifolds.differentiable.catalog.euclidean import EuclideanSpace` (in the changes in `catalog.py`).\n\nThen I see the problem that the imports rely on the catalog import pattern too much. If we decide to change it at some point, there is too much dependency involved. I personally don't care when the internal import statements are that long.\n\nI think it is always good to import the modules internally from where they are. Besides, I can imagine that the work around could cause a slight slowdown, because the `catalog` module contains further code which is not necessary for the `EuclideanSpace`.\n\nEric, Travis? What do you say?",
    "created_at": "2020-10-23T12:02:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436528",
    "user": "@mjungmath"
}
```

Replying to [comment:24 gh-tobiasdiez]:
> Ok, I also like these conventions. Then I would also promote them in the "normal" Sage code, e.g. `from sage.manifolds.catalog import EuclideanSpace` instead of `from sage.manifolds.differentiable.catalog.euclidean import EuclideanSpace` (in the changes in `catalog.py`).

Then I see the problem that the imports rely on the catalog import pattern too much. If we decide to change it at some point, there is too much dependency involved. I personally don't care when the internal import statements are that long.

I think it is always good to import the modules internally from where they are. Besides, I can imagine that the work around could cause a slight slowdown, because the `catalog` module contains further code which is not necessary for the `EuclideanSpace`.

Eric, Travis? What do you say?



---

archive/issue_comments_436529.json:
```json
{
    "body": "The more I think about it, the more I tend to an `examples` folder instead. This is at least consistent with other modules (see e.g. `homology`).",
    "created_at": "2020-10-23T12:35:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436529",
    "user": "@mjungmath"
}
```

The more I think about it, the more I tend to an `examples` folder instead. This is at least consistent with other modules (see e.g. `homology`).



---

archive/issue_comments_436530.json:
```json
{
    "body": "Replying to [comment:21 gh-mjungmath]:\n> \n> Btw, in addition to that, the examples can currently be invoked by\n> {{{\n> manifolds.Torus()\n> }}}\n> \n> This comes from the fact that `all.py` imports\n> \n> {{{\n> import sage.manifolds.catalog as manifolds\n> }}}\n> \n> I think this is very nice, too.\n> \n\nAh yes indeed, that's the standard way to use the catalog. Much better than the `import` statement I mentioned in comment:10. So let us forget about the latter.",
    "created_at": "2020-10-23T12:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436530",
    "user": "@egourgoulhon"
}
```

Replying to [comment:21 gh-mjungmath]:
> 
> Btw, in addition to that, the examples can currently be invoked by
> {{{
> manifolds.Torus()
> }}}
> 
> This comes from the fact that `all.py` imports
> 
> {{{
> import sage.manifolds.catalog as manifolds
> }}}
> 
> I think this is very nice, too.
> 

Ah yes indeed, that's the standard way to use the catalog. Much better than the `import` statement I mentioned in comment:10. So let us forget about the latter.



---

archive/issue_comments_436531.json:
```json
{
    "body": "Replying to [comment:25 gh-mjungmath]:\n> Replying to [comment:24 gh-tobiasdiez]:\n> > Ok, I also like these conventions. Then I would also promote them in the \"normal\" Sage code, e.g. `from sage.manifolds.catalog import EuclideanSpace` instead of `from sage.manifolds.differentiable.catalog.euclidean import EuclideanSpace` (in the changes in `catalog.py`).\n> \n> Then I see the problem that the imports rely on the catalog import pattern too much. If we decide to change it at some point, there is too much dependency involved. I personally don't care when the internal import statements are that long.\n\n+1\n> \n> I think it is always good to import the modules internally from where they are. \n\nIndeed.",
    "created_at": "2020-10-23T12:45:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436531",
    "user": "@egourgoulhon"
}
```

Replying to [comment:25 gh-mjungmath]:
> Replying to [comment:24 gh-tobiasdiez]:
> > Ok, I also like these conventions. Then I would also promote them in the "normal" Sage code, e.g. `from sage.manifolds.catalog import EuclideanSpace` instead of `from sage.manifolds.differentiable.catalog.euclidean import EuclideanSpace` (in the changes in `catalog.py`).
> 
> Then I see the problem that the imports rely on the catalog import pattern too much. If we decide to change it at some point, there is too much dependency involved. I personally don't care when the internal import statements are that long.

+1
> 
> I think it is always good to import the modules internally from where they are. 

Indeed.



---

archive/issue_comments_436532.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-10-23T14:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436532",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_436533.json:
```json
{
    "body": "Changed `catalog` to `examples` and some further details. Wait for patchbot.",
    "created_at": "2020-10-23T14:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436533",
    "user": "@mjungmath"
}
```

Changed `catalog` to `examples` and some further details. Wait for patchbot.



---

archive/issue_comments_436534.json:
```json
{
    "body": "I am not sure `examples` is a better name than `catalog` in the present case. Indeed, this folder shall contain most (all?) \"standard\" manifolds in low dimension: Euclidian spaces, spheres, tori, projective spaces, etc. It looks more than a mere collection of examples to me.",
    "created_at": "2020-10-23T20:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436534",
    "user": "@egourgoulhon"
}
```

I am not sure `examples` is a better name than `catalog` in the present case. Indeed, this folder shall contain most (all?) "standard" manifolds in low dimension: Euclidian spaces, spheres, tori, projective spaces, etc. It looks more than a mere collection of examples to me.



---

archive/issue_comments_436535.json:
```json
{
    "body": "Replying to [comment:31 egourgoulhon]:\n> I am not sure `examples` is a better name than `catalog` in the present case. Indeed, this folder shall contain most (all?) \"standard\" manifolds in low dimension: Euclidian spaces, spheres, tori, projective spaces, etc. It looks more than a mere collection of examples to me. \n\nThe `homology` module for instance calls their catalog members \"examples\", too. Moreover, I would prefer `examples` because it doesn't pollute the namespace too much with the preexisting `catalog.py`.",
    "created_at": "2020-10-23T23:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436535",
    "user": "@mjungmath"
}
```

Replying to [comment:31 egourgoulhon]:
> I am not sure `examples` is a better name than `catalog` in the present case. Indeed, this folder shall contain most (all?) "standard" manifolds in low dimension: Euclidian spaces, spheres, tori, projective spaces, etc. It looks more than a mere collection of examples to me. 

The `homology` module for instance calls their catalog members "examples", too. Moreover, I would prefer `examples` because it doesn't pollute the namespace too much with the preexisting `catalog.py`.



---

archive/issue_comments_436536.json:
```json
{
    "body": "I would also go for `examples` rather than `catalog` because we can add functions to the catalog file that are not sufficiently big/detailed to require their own file.\n\nAlso, I strongly support directly important from the files at hand. This makes it a little easier to see where cyclic imports are coming from and to help prevent that.",
    "created_at": "2020-10-24T05:23:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436536",
    "user": "@tscrim"
}
```

I would also go for `examples` rather than `catalog` because we can add functions to the catalog file that are not sufficiently big/detailed to require their own file.

Also, I strongly support directly important from the files at hand. This makes it a little easier to see where cyclic imports are coming from and to help prevent that.



---

archive/issue_comments_436537.json:
```json
{
    "body": "I vote for `catalog`. I thought the long-term goal was to replace the `catalog.py` file by the `catalog` module. You can then still easily add functions to `catalog/__init__py`.",
    "created_at": "2020-10-24T07:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436537",
    "user": "@tobiasdiez"
}
```

I vote for `catalog`. I thought the long-term goal was to replace the `catalog.py` file by the `catalog` module. You can then still easily add functions to `catalog/__init__py`.



---

archive/issue_comments_436538.json:
```json
{
    "body": "Stalemate! :D\n\nReplying to [comment:34 gh-tobiasdiez]:\n> I vote for `catalog`. I thought the long-term goal was to replace the `catalog.py` file by the `catalog` module.\n\nNot precisely. As Travis pointed out in comment:33, the `catalog.py` still contains entire code of \"small\" examples. Besides, I think it is best if the `catalog.py` also manages the factories to construct the examples at hand. Let me give two arguments for that:\n\n1. For example, inheriting from a `Manifold` class makes that class a `UniqueRepresentation`. But that is not the behavior we want for examples constructed from `catalog.py` (compare `EuclideanSpace` or the `Manifold` class and the `Manifold` factory method imported to the global namespace).\n\n2. The factory method can delegate special dimensions, exotic counterparts or different realizations to the corresponding implementation.\n\n> You can then still easily add functions to `catalog/__init__py`.\n\nI would advice against it. Nobody expects code in `__init__.py`.",
    "created_at": "2020-10-24T08:46:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436538",
    "user": "@mjungmath"
}
```

Stalemate! :D

Replying to [comment:34 gh-tobiasdiez]:
> I vote for `catalog`. I thought the long-term goal was to replace the `catalog.py` file by the `catalog` module.

Not precisely. As Travis pointed out in comment:33, the `catalog.py` still contains entire code of "small" examples. Besides, I think it is best if the `catalog.py` also manages the factories to construct the examples at hand. Let me give two arguments for that:

1. For example, inheriting from a `Manifold` class makes that class a `UniqueRepresentation`. But that is not the behavior we want for examples constructed from `catalog.py` (compare `EuclideanSpace` or the `Manifold` class and the `Manifold` factory method imported to the global namespace).

2. The factory method can delegate special dimensions, exotic counterparts or different realizations to the corresponding implementation.

> You can then still easily add functions to `catalog/__init__py`.

I would advice against it. Nobody expects code in `__init__.py`.



---

archive/issue_comments_436539.json:
```json
{
    "body": "Replying to [comment:34 gh-tobiasdiez]:\n> I vote for `catalog`. I thought the long-term goal was to replace the `catalog.py` file by the `catalog` module. You can then still easily add functions to `catalog/__init__py`.\n\nThat doesn't quite make sense, `catalog.py` is a module (in Python-speak). If you mean folder, then no, that is not the long-term goal.\n\nHowever, there is not any specific reason to not have code in `__init__.py`.",
    "created_at": "2020-10-24T08:47:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436539",
    "user": "@tscrim"
}
```

Replying to [comment:34 gh-tobiasdiez]:
> I vote for `catalog`. I thought the long-term goal was to replace the `catalog.py` file by the `catalog` module. You can then still easily add functions to `catalog/__init__py`.

That doesn't quite make sense, `catalog.py` is a module (in Python-speak). If you mean folder, then no, that is not the long-term goal.

However, there is not any specific reason to not have code in `__init__.py`.



---

archive/issue_comments_436540.json:
```json
{
    "body": "Ok, what is then the long-term goal?\n\n- The `catalog.py` contains a few examples. But all of them are differentiable and seem complex enough to be put in a separate classes. Should they be put in separate files in the folder `manifolds/differentiable/catalog`?\n- Where should one add a example that is not differentiable? The folder `manifolds/catalog` would be the natural choice. But having such a folder would lead to problems as packages have priority over modules, so the `catalog.py` module would not be visible. That's why I proposed to replace the `catalog` module (file) by the `catalog` package (directory).\n\n\n\n----\n\n> The factory method can delegate special dimensions, exotic counterparts or different realizations to the corresponding implementation.\n\nI would solve this using the fa\u00e7ade pattern. So, if dimension 2 would be special for the sphere, you have a class `Sphere` for every dimension that delegates its work to `Sphere2Dim` and `SphereHigherDim` where the actual implementation is taking place.",
    "created_at": "2020-10-24T09:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436540",
    "user": "@tobiasdiez"
}
```

Ok, what is then the long-term goal?

- The `catalog.py` contains a few examples. But all of them are differentiable and seem complex enough to be put in a separate classes. Should they be put in separate files in the folder `manifolds/differentiable/catalog`?
- Where should one add a example that is not differentiable? The folder `manifolds/catalog` would be the natural choice. But having such a folder would lead to problems as packages have priority over modules, so the `catalog.py` module would not be visible. That's why I proposed to replace the `catalog` module (file) by the `catalog` package (directory).



----

> The factory method can delegate special dimensions, exotic counterparts or different realizations to the corresponding implementation.

I would solve this using the façade pattern. So, if dimension 2 would be special for the sphere, you have a class `Sphere` for every dimension that delegates its work to `Sphere2Dim` and `SphereHigherDim` where the actual implementation is taking place.



---

archive/issue_comments_436541.json:
```json
{
    "body": "Replying to [comment:37 gh-tobiasdiez]:\n> The `catalog.py` contains a few examples. But all of them are differentiable and seem complex enough to be put in a separate classes. Should they be put in separate files in the folder `manifolds/differentiable/catalog`?\n\nYou got a point. The most simple examples, Euclidean space and open intervals, are already complex enough to occupy whole files. On the other hand, some examples might stay primitive and are too short to occupy an own file.\n\n> Where should one add a example that is not differentiable? The folder `manifolds/catalog` would be the natural choice. But having such a folder would lead to problems as packages have priority over modules, so the `catalog.py` module would not be visible. That's why I proposed to replace the `catalog` module (file) by the `catalog` package (directory).\n\nThis was exactly my worry and is the reason why I proposed `examples` as folder name. If we do as you propose, we additionally have to make sure that the documentation about the catalog remains at least somewhere; `__init__.py` is no option as far as I can see.\n\n> I would solve this using the fa\u00e7ade pattern. So, if dimension 2 would be special for the sphere, you have a class `Sphere` for every dimension that delegates its work to `Sphere2Dim` and `SphereHigherDim` where the actual implementation is taking place. \n\nThis sounds like a reasonable approach, too. It is also consistent with the current implementation of `EuclideanSpace`.\n\nOn the other hand, the only thing I'm unsure about is whether this approach is flexible enough for adding new examples/alternatives step-by-step, also by developers who might not be not familiar with our discussion here. As for the factory method this is easy and comprehensible: just add another if-clause and/or option.",
    "created_at": "2020-10-24T11:09:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436541",
    "user": "@mjungmath"
}
```

Replying to [comment:37 gh-tobiasdiez]:
> The `catalog.py` contains a few examples. But all of them are differentiable and seem complex enough to be put in a separate classes. Should they be put in separate files in the folder `manifolds/differentiable/catalog`?

You got a point. The most simple examples, Euclidean space and open intervals, are already complex enough to occupy whole files. On the other hand, some examples might stay primitive and are too short to occupy an own file.

> Where should one add a example that is not differentiable? The folder `manifolds/catalog` would be the natural choice. But having such a folder would lead to problems as packages have priority over modules, so the `catalog.py` module would not be visible. That's why I proposed to replace the `catalog` module (file) by the `catalog` package (directory).

This was exactly my worry and is the reason why I proposed `examples` as folder name. If we do as you propose, we additionally have to make sure that the documentation about the catalog remains at least somewhere; `__init__.py` is no option as far as I can see.

> I would solve this using the façade pattern. So, if dimension 2 would be special for the sphere, you have a class `Sphere` for every dimension that delegates its work to `Sphere2Dim` and `SphereHigherDim` where the actual implementation is taking place. 

This sounds like a reasonable approach, too. It is also consistent with the current implementation of `EuclideanSpace`.

On the other hand, the only thing I'm unsure about is whether this approach is flexible enough for adding new examples/alternatives step-by-step, also by developers who might not be not familiar with our discussion here. As for the factory method this is easy and comprehensible: just add another if-clause and/or option.



---

archive/issue_comments_436542.json:
```json
{
    "body": "Replying to [comment:38 gh-mjungmath]:\n> Replying to [comment:37 gh-tobiasdiez]:\n> > The `catalog.py` contains a few examples. But all of them are differentiable and seem complex enough to be put in a separate classes. Should they be put in separate files in the folder `manifolds/differentiable/catalog`?\n> \n> You got a point. The most simple examples, Euclidean space and open intervals, are already complex enough to occupy whole files. On the other hand, some examples might stay primitive and are too short to occupy an own file.\n\nIndeed.\n> \n> > Where should one add a example that is not differentiable? The folder `manifolds/catalog` would be the natural choice. But having such a folder would lead to problems as packages have priority over modules, so the `catalog.py` module would not be visible. That's why I proposed to replace the `catalog` module (file) by the `catalog` package (directory).\n> \n> This was exactly my worry and is the reason why I proposed `examples` as folder name. If we do as you propose, we additionally have to make sure that the documentation about the catalog remains at least somewhere; `__init__.py` is no option as far as I can see.\n> \n\nOK, to be consistent with the rest of Sage code, it's probably wise to keep the `catalog.py` file and rename the folder(s) by something else than `catalog`. I was somewhat reluctant about `examples`, but at the moment I don't have any better name to suggest (besides `models` as already suggested by Michael, `realizations` came to my mind but I am not sure it's pertinent...).\n> > I would solve this using the fa\u00e7ade pattern. So, if dimension 2 would be special for the sphere, you have a class `Sphere` for every dimension that delegates its work to `Sphere2Dim` and `SphereHigherDim` where the actual implementation is taking place. \n> \n> This sounds like a reasonable approach, too. It is also consistent with the current implementation of `EuclideanSpace`.\n> \n\nYes. Most probably, we need a `Sphere2D` class, at least for the standard naming of spherical coordinates as (theta, phi). We shall also need special subclasses for parallelizable spheres\n(S<sup>1</sup>, S<sup>3</sup> and S<sup>7</sup>).\n> On the other hand, the only thing I'm unsure about is whether this approach is flexible enough for adding new examples/alternatives step-by-step, also by developers who might not be not familiar with our discussion here. As for the factory method this is easy and comprehensible: just add another if-clause and/or option.\n\nYes factory approach might be better in this respect. It avoids to invoke  `__classcall_private__`, as currently done in `EuclideanSpace`.",
    "created_at": "2020-10-24T12:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436542",
    "user": "@egourgoulhon"
}
```

Replying to [comment:38 gh-mjungmath]:
> Replying to [comment:37 gh-tobiasdiez]:
> > The `catalog.py` contains a few examples. But all of them are differentiable and seem complex enough to be put in a separate classes. Should they be put in separate files in the folder `manifolds/differentiable/catalog`?
> 
> You got a point. The most simple examples, Euclidean space and open intervals, are already complex enough to occupy whole files. On the other hand, some examples might stay primitive and are too short to occupy an own file.

Indeed.
> 
> > Where should one add a example that is not differentiable? The folder `manifolds/catalog` would be the natural choice. But having such a folder would lead to problems as packages have priority over modules, so the `catalog.py` module would not be visible. That's why I proposed to replace the `catalog` module (file) by the `catalog` package (directory).
> 
> This was exactly my worry and is the reason why I proposed `examples` as folder name. If we do as you propose, we additionally have to make sure that the documentation about the catalog remains at least somewhere; `__init__.py` is no option as far as I can see.
> 

OK, to be consistent with the rest of Sage code, it's probably wise to keep the `catalog.py` file and rename the folder(s) by something else than `catalog`. I was somewhat reluctant about `examples`, but at the moment I don't have any better name to suggest (besides `models` as already suggested by Michael, `realizations` came to my mind but I am not sure it's pertinent...).
> > I would solve this using the façade pattern. So, if dimension 2 would be special for the sphere, you have a class `Sphere` for every dimension that delegates its work to `Sphere2Dim` and `SphereHigherDim` where the actual implementation is taking place. 
> 
> This sounds like a reasonable approach, too. It is also consistent with the current implementation of `EuclideanSpace`.
> 

Yes. Most probably, we need a `Sphere2D` class, at least for the standard naming of spherical coordinates as (theta, phi). We shall also need special subclasses for parallelizable spheres
(S<sup>1</sup>, S<sup>3</sup> and S<sup>7</sup>).
> On the other hand, the only thing I'm unsure about is whether this approach is flexible enough for adding new examples/alternatives step-by-step, also by developers who might not be not familiar with our discussion here. As for the factory method this is easy and comprehensible: just add another if-clause and/or option.

Yes factory approach might be better in this respect. It avoids to invoke  `__classcall_private__`, as currently done in `EuclideanSpace`.



---

archive/issue_comments_436543.json:
```json
{
    "body": "Allow me to summarize the accumulated discussion. Unfortunately, we can't start polls here (a feature I completely miss).\n\n- For consistency, to keep the documentation, and to obtain a more comprehensible factory pattern, it is better to keep the `catalog.py`.\n- In conclusion, we have to choose another name for the folders. Possible suggestions:\n  1. `models`\n  2. `examples`\n  3. `realizations`\n- Which pattern?\n  1. Special dimensions of the same implementation could be treated via facade pattern as it has been done for `EuclideanSpace`, whereas more deviating realizations could be treated via factory method pattern in `catalog.py`.\n  2. Everything is regulated via facade.\n  3. Everything is regulated via factory method in `catalog.py`.\n\n----\n\nWith respect to the last point, I suggest that *every* cataloged manifold should have it's own method in `catalog.py` for documentation and unification reasons. This also avoids duplicated or circular imports.\n\n----\n\nPlease let me know if I caught something wrong.",
    "created_at": "2020-10-24T13:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436543",
    "user": "@mjungmath"
}
```

Allow me to summarize the accumulated discussion. Unfortunately, we can't start polls here (a feature I completely miss).

- For consistency, to keep the documentation, and to obtain a more comprehensible factory pattern, it is better to keep the `catalog.py`.
- In conclusion, we have to choose another name for the folders. Possible suggestions:
  1. `models`
  2. `examples`
  3. `realizations`
- Which pattern?
  1. Special dimensions of the same implementation could be treated via facade pattern as it has been done for `EuclideanSpace`, whereas more deviating realizations could be treated via factory method pattern in `catalog.py`.
  2. Everything is regulated via facade.
  3. Everything is regulated via factory method in `catalog.py`.

----

With respect to the last point, I suggest that *every* cataloged manifold should have it's own method in `catalog.py` for documentation and unification reasons. This also avoids duplicated or circular imports.

----

Please let me know if I caught something wrong.



---

archive/issue_comments_436544.json:
```json
{
    "body": "Ok, I'm convinced: +1 for `examples`. I would also tend to put every example in its own file. It's more consistent and I don't see any disadvantages of having \"small\" classes. \n\nFor the pattern, it probably depends on the concrete example and how much the implementations differ. In general, the factory pattern is good when you have completely independent implementations of some interface (e.g. getting infos from a file vs from an web api) whereas the fa\u00e7ade pattern excels at hiding the implementation details. You can also combine them easily.\nFor example, for the sphere one could imagine the following:\n- A general class `Sphere` that acts as a fa\u00e7ade for `Sphere2Dim` and `SphereHigherDim` (e.g. because you might have more effective ways to calculate in 2d).\n- Classes for `d=1,3,7` deriving from `Sphere` and adding the parallelizable aspect.\n- Factory method in `catalog.py` that based on the dimension invokes the constructor of `Sphere` or one of its subclasses for `d=1,3,7`",
    "created_at": "2020-10-24T15:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436544",
    "user": "@tobiasdiez"
}
```

Ok, I'm convinced: +1 for `examples`. I would also tend to put every example in its own file. It's more consistent and I don't see any disadvantages of having "small" classes. 

For the pattern, it probably depends on the concrete example and how much the implementations differ. In general, the factory pattern is good when you have completely independent implementations of some interface (e.g. getting infos from a file vs from an web api) whereas the façade pattern excels at hiding the implementation details. You can also combine them easily.
For example, for the sphere one could imagine the following:
- A general class `Sphere` that acts as a façade for `Sphere2Dim` and `SphereHigherDim` (e.g. because you might have more effective ways to calculate in 2d).
- Classes for `d=1,3,7` deriving from `Sphere` and adding the parallelizable aspect.
- Factory method in `catalog.py` that based on the dimension invokes the constructor of `Sphere` or one of its subclasses for `d=1,3,7`



---

archive/issue_comments_436545.json:
```json
{
    "body": "Replying to [comment:41 gh-tobiasdiez]:\n> I would also tend to put every example in its own file. It's more consistent and I don't see any disadvantages of having \"small\" classes.\n\nI disagree here. Dedicated methods to each example are a good thing anyway imho, see comment:40. So why not leave the simple constructions there?\n\n> For the pattern, it probably depends on the concrete example and how much the implementations differ. In general, the factory pattern is good when you have completely independent implementations of some interface (e.g. getting infos from a file vs from an web api) whereas the fa\u00e7ade pattern excels at hiding the implementation details. You can also combine them easily.\n> For example, for the sphere one could imagine the following:\n> - A general class `Sphere` that acts as a fa\u00e7ade for `Sphere2Dim` and `SphereHigherDim` (e.g. because you might have more effective ways to calculate in 2d).\n> - Classes for `d=1,3,7` deriving from `Sphere` and adding the parallelizable aspect.\n> - Factory method in `catalog.py` that based on the dimension invokes the constructor of `Sphere` or one of its subclasses for `d=1,3,7`\n\nTotally! I think this is how we should do it. The parallelizable cases have the same charts, but in contrast to their brothers a global frame which can be constructed in the corresponding classes. So, I'd prefer the fa\u00e7ade pattern here as well. But this is something we should discuss in more detail in #30804.",
    "created_at": "2020-10-24T18:50:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436545",
    "user": "@mjungmath"
}
```

Replying to [comment:41 gh-tobiasdiez]:
> I would also tend to put every example in its own file. It's more consistent and I don't see any disadvantages of having "small" classes.

I disagree here. Dedicated methods to each example are a good thing anyway imho, see comment:40. So why not leave the simple constructions there?

> For the pattern, it probably depends on the concrete example and how much the implementations differ. In general, the factory pattern is good when you have completely independent implementations of some interface (e.g. getting infos from a file vs from an web api) whereas the façade pattern excels at hiding the implementation details. You can also combine them easily.
> For example, for the sphere one could imagine the following:
> - A general class `Sphere` that acts as a façade for `Sphere2Dim` and `SphereHigherDim` (e.g. because you might have more effective ways to calculate in 2d).
> - Classes for `d=1,3,7` deriving from `Sphere` and adding the parallelizable aspect.
> - Factory method in `catalog.py` that based on the dimension invokes the constructor of `Sphere` or one of its subclasses for `d=1,3,7`

Totally! I think this is how we should do it. The parallelizable cases have the same charts, but in contrast to their brothers a global frame which can be constructed in the corresponding classes. So, I'd prefer the façade pattern here as well. But this is something we should discuss in more detail in #30804.



---

archive/issue_comments_436546.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-10-25T15:49:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436546",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_436547.json:
```json
{
    "body": "What about this? I think, the `UniqueRepresentation` behavior should now be consistent with `Manifold()`.\n\nHowever, with this commit, there is a doctest error in line 215 of `real_line.py`...",
    "created_at": "2020-10-25T15:54:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436547",
    "user": "@mjungmath"
}
```

What about this? I think, the `UniqueRepresentation` behavior should now be consistent with `Manifold()`.

However, with this commit, there is a doctest error in line 215 of `real_line.py`...



---

archive/issue_comments_436548.json:
```json
{
    "body": "Replying to [comment:45 gh-mjungmath]:\n> However, with this commit, there is a doctest error in line 215 of `real_line.py`...\n\nSee #30830 for details.",
    "created_at": "2020-10-25T20:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436548",
    "user": "@mjungmath"
}
```

Replying to [comment:45 gh-mjungmath]:
> However, with this commit, there is a doctest error in line 215 of `real_line.py`...

See #30830 for details.



---

archive/issue_comments_436549.json:
```json
{
    "body": "Replying to [comment:45 gh-mjungmath]:\n> What about this? I think, the `UniqueRepresentation` behavior should now be consistent with `Manifold()`.\n> \n> However, with this commit, there is a doctest error in line 215 of `real_line.py`...\n\nTo elaborate: each manifold constructed from the global namespace, i.e. via the factory method, obtains a unique tag. That means, each invokation constructs a new object.\n\nFor consistency, this should hold for `OpenInterval` and `RealLine`, too. And for more consistency, it is good to manage this behavior via factory methods.\n\nPlease object if you disagree.",
    "created_at": "2020-10-26T10:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436549",
    "user": "@mjungmath"
}
```

Replying to [comment:45 gh-mjungmath]:
> What about this? I think, the `UniqueRepresentation` behavior should now be consistent with `Manifold()`.
> 
> However, with this commit, there is a doctest error in line 215 of `real_line.py`...

To elaborate: each manifold constructed from the global namespace, i.e. via the factory method, obtains a unique tag. That means, each invokation constructs a new object.

For consistency, this should hold for `OpenInterval` and `RealLine`, too. And for more consistency, it is good to manage this behavior via factory methods.

Please object if you disagree.



---

archive/issue_comments_436550.json:
```json
{
    "body": "Replying to [comment:47 gh-mjungmath]:\n> Replying to [comment:45 gh-mjungmath]:\n> > What about this? I think, the `UniqueRepresentation` behavior should now be consistent with `Manifold()`.\n> > \n> > However, with this commit, there is a doctest error in line 215 of `real_line.py`...\n> \n> To elaborate: each manifold constructed from the global namespace, i.e. via the factory method, obtains a unique tag. That means, each invokation constructs a new object.\n> \n> For consistency, this should hold for `OpenInterval` and `RealLine`, too.\n\nNo, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.\n\nAnyway, the unique tag issue is beyond the scope of this ticket, I believe. \nAt some point, we should get rid of `UniqueRepresentation` inheritance for generic manifolds. It is a workaround to have a correct pickling, which is necessary for parallelized computations.",
    "created_at": "2020-10-26T11:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436550",
    "user": "@egourgoulhon"
}
```

Replying to [comment:47 gh-mjungmath]:
> Replying to [comment:45 gh-mjungmath]:
> > What about this? I think, the `UniqueRepresentation` behavior should now be consistent with `Manifold()`.
> > 
> > However, with this commit, there is a doctest error in line 215 of `real_line.py`...
> 
> To elaborate: each manifold constructed from the global namespace, i.e. via the factory method, obtains a unique tag. That means, each invokation constructs a new object.
> 
> For consistency, this should hold for `OpenInterval` and `RealLine`, too.

No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.

Anyway, the unique tag issue is beyond the scope of this ticket, I believe. 
At some point, we should get rid of `UniqueRepresentation` inheritance for generic manifolds. It is a workaround to have a correct pickling, which is necessary for parallelized computations.



---

archive/issue_comments_436551.json:
```json
{
    "body": "Replying to [comment:48 egourgoulhon]:\n> No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.\n\nWhat is the intention behind it?\n\n> Anyway, the unique tag issue is beyond the scope of this ticket, I believe. \n> At some point, we should get rid of `UniqueRepresentation` inheritance for generic manifolds. It is a workaround to have a correct pickling, which is necessary for parallelized computations.\n\nYou're right. However, it is somehow entwined. It wouldn't make sense to create a factory method somewhere else than in `catalog.py`.",
    "created_at": "2020-10-26T11:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436551",
    "user": "@mjungmath"
}
```

Replying to [comment:48 egourgoulhon]:
> No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.

What is the intention behind it?

> Anyway, the unique tag issue is beyond the scope of this ticket, I believe. 
> At some point, we should get rid of `UniqueRepresentation` inheritance for generic manifolds. It is a workaround to have a correct pickling, which is necessary for parallelized computations.

You're right. However, it is somehow entwined. It wouldn't make sense to create a factory method somewhere else than in `catalog.py`.



---

archive/issue_comments_436552.json:
```json
{
    "body": "Replying to [comment:49 gh-mjungmath]:\n> Replying to [comment:48 egourgoulhon]:\n> > No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.\n> \n> What is the intention behind it?\n\n`RealLine()` or `OpenInterval(0,1)` fully defines the mathematical object, `Manifold(2, 'M')` does not.",
    "created_at": "2020-10-26T12:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436552",
    "user": "@egourgoulhon"
}
```

Replying to [comment:49 gh-mjungmath]:
> Replying to [comment:48 egourgoulhon]:
> > No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.
> 
> What is the intention behind it?

`RealLine()` or `OpenInterval(0,1)` fully defines the mathematical object, `Manifold(2, 'M')` does not.



---

archive/issue_comments_436553.json:
```json
{
    "body": "Replying to [comment:50 egourgoulhon]:\n> Replying to [comment:49 gh-mjungmath]:\n> > Replying to [comment:48 egourgoulhon]:\n> > > No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.\n> > \n> > What is the intention behind it?\n> \n> `RealLine()` or `OpenInterval(0,1)` fully defines the mathematical object, `Manifold(2, 'M')` does not.\n> \n\nMh, I see. And `EuclideanSpace(2)` could still yield two different but isomorphic mathematical entities.\n\nBut what about `OpenInterval(0,1)` and `OpenInterval(0,1, name='I')`. Or `OpenInterval(-oo,oo)` and `RealLine()`. Same mathematical object, but different instances.\n\nI think, this should be catched via `__classcall_private__` then. However, that's definitely beyond the scope of this ticket.\n\n----\n\nSo, what's your proposal with the import/method/catalog behavior then? Keep the version of comment:29?",
    "created_at": "2020-10-26T12:37:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436553",
    "user": "@mjungmath"
}
```

Replying to [comment:50 egourgoulhon]:
> Replying to [comment:49 gh-mjungmath]:
> > Replying to [comment:48 egourgoulhon]:
> > > No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.
> > 
> > What is the intention behind it?
> 
> `RealLine()` or `OpenInterval(0,1)` fully defines the mathematical object, `Manifold(2, 'M')` does not.
> 

Mh, I see. And `EuclideanSpace(2)` could still yield two different but isomorphic mathematical entities.

But what about `OpenInterval(0,1)` and `OpenInterval(0,1, name='I')`. Or `OpenInterval(-oo,oo)` and `RealLine()`. Same mathematical object, but different instances.

I think, this should be catched via `__classcall_private__` then. However, that's definitely beyond the scope of this ticket.

----

So, what's your proposal with the import/method/catalog behavior then? Keep the version of comment:29?



---

archive/issue_comments_436554.json:
```json
{
    "body": "Replying to [comment:48 egourgoulhon]:\n> Replying to [comment:47 gh-mjungmath]:\n> > Replying to [comment:45 gh-mjungmath]:\n> > > What about this? I think, the `UniqueRepresentation` behavior should now be consistent with `Manifold()`.\n> > > \n> > > However, with this commit, there is a doctest error in line 215 of `real_line.py`...\n> > \n> > To elaborate: each manifold constructed from the global namespace, i.e. via the factory method, obtains a unique tag. That means, each invokation constructs a new object.\n> > \n> > For consistency, this should hold for `OpenInterval` and `RealLine`, too.\n> \n> No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.\n> \n> Anyway, the unique tag issue is beyond the scope of this ticket, I believe. \n> At some point, we should get rid of `UniqueRepresentation` inheritance for generic manifolds. It is a workaround to have a correct pickling, which is necessary for parallelized computations.\n> \n\nI still haven't forgotten that I promised you I would do that. It is on my to-do list. Sorry for taking so long.",
    "created_at": "2020-10-27T23:07:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436554",
    "user": "@tscrim"
}
```

Replying to [comment:48 egourgoulhon]:
> Replying to [comment:47 gh-mjungmath]:
> > Replying to [comment:45 gh-mjungmath]:
> > > What about this? I think, the `UniqueRepresentation` behavior should now be consistent with `Manifold()`.
> > > 
> > > However, with this commit, there is a doctest error in line 215 of `real_line.py`...
> > 
> > To elaborate: each manifold constructed from the global namespace, i.e. via the factory method, obtains a unique tag. That means, each invokation constructs a new object.
> > 
> > For consistency, this should hold for `OpenInterval` and `RealLine`, too.
> 
> No, `OpenInterval` and `RealLine` are truely `UniqueRepresentation` objects. The unique tag trick shall not apply to them.
> 
> Anyway, the unique tag issue is beyond the scope of this ticket, I believe. 
> At some point, we should get rid of `UniqueRepresentation` inheritance for generic manifolds. It is a workaround to have a correct pickling, which is necessary for parallelized computations.
> 

I still haven't forgotten that I promised you I would do that. It is on my to-do list. Sorry for taking so long.



---

archive/issue_comments_436555.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-10-30T22:56:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436555",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_436556.json:
```json
{
    "body": "Like Eric pointed out correctly, some things discussed here go beyond the scope of this ticket. I reverted the branch to an older version, where I used lazy imports into `catalog.py`.\n\nLazy import should prevent circular and unneccessary imports.\n\nPatchbot is already green.",
    "created_at": "2020-10-30T23:00:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436556",
    "user": "@mjungmath"
}
```

Like Eric pointed out correctly, some things discussed here go beyond the scope of this ticket. I reverted the branch to an older version, where I used lazy imports into `catalog.py`.

Lazy import should prevent circular and unneccessary imports.

Patchbot is already green.



---

archive/issue_comments_436557.json:
```json
{
    "body": "We can do further changes in other tickets. I think it is good to take some smaller steps in each ticket.",
    "created_at": "2020-10-31T07:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436557",
    "user": "@tscrim"
}
```

We can do further changes in other tickets. I think it is good to take some smaller steps in each ticket.



---

archive/issue_comments_436558.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-10-31T07:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436558",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_436559.json:
```json
{
    "body": "I agree.\n\nThanks.",
    "created_at": "2020-10-31T12:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436559",
    "user": "@mjungmath"
}
```

I agree.

Thanks.



---

archive/issue_comments_436560.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-11-01T00:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30562",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30562#issuecomment-436560",
    "user": "@vbraun"
}
```

Resolution: fixed
