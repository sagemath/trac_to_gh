# Issue 31822: Check containment for combinatorial faces

archive/issues_031585.json:
```json
{
    "assignees": [],
    "body": "We add a method `is_subface` to combinatorial faces.\n\nDepends on #31819\n\nCC:  @jplab @mkoeppe @yuan-zhou\n\nKeywords: **combinatorial polyhedron, subface**\n\nBranch/Commit: **[`ac5c327`](https://github.com/sagemath/sagetrac-mirror/commit/ac5c32764b3b9283fc5b7635fac631fea7bb6840)**\n\nReviewer: **Yuan Zhou, Matthias Koeppe**\n\nAuthor: **Jonathan Kliem**\n\nComponent: **geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31822_\n\n",
    "closed_at": "2021-07-01T20:44:58Z",
    "created_at": "2021-05-12T14:05:37Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Check containment for combinatorial faces",
    "type": "issue",
    "updated_at": "2021-07-01T20:44:58Z",
    "url": "https://github.com/sagemath/sage/issues/31822",
    "user": "https://github.com/kliem"
}
```
We add a method `is_subface` to combinatorial faces.

Depends on #31819

CC:  @jplab @mkoeppe @yuan-zhou

Keywords: **combinatorial polyhedron, subface**

Branch/Commit: **[`ac5c327`](https://github.com/sagemath/sagetrac-mirror/commit/ac5c32764b3b9283fc5b7635fac631fea7bb6840)**

Reviewer: **Yuan Zhou, Matthias Koeppe**

Author: **Jonathan Kliem**

Component: **geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/31822_





---

archive/issue_events_438886.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T14:05:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438886"
}
```



---

archive/issue_events_438887.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T14:05:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438887"
}
```



---

archive/issue_events_438888.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T14:05:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438888"
}
```



---

archive/issue_events_438889.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T14:05:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438889"
}
```



---

archive/issue_events_438890.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T14:05:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438890"
}
```



---

archive/issue_comments_511790.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nIt works fine in the intended case.\n\nHowever, it should raise an error, when `self` and `other` or not from the same `CombinatorialPolyhedron` (`NotImplementedError`?) and it should consider the case that `self` is from a dual face iterator and `other isn't.",
    "created_at": "2021-05-13T05:32:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511790",
    "user": "https://github.com/kliem"
}
```

<div id="comment:3" align="right">comment:3</div>

It works fine in the intended case.

However, it should raise an error, when `self` and `other` or not from the same `CombinatorialPolyhedron` (`NotImplementedError`?) and it should consider the case that `self` is from a dual face iterator and `other isn't.



---

archive/issue_events_438891.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-13T05:32:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438891"
}
```



---

archive/issue_events_438892.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-13T05:32:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438892"
}
```



---

archive/issue_comments_511791.json:
```json
{
    "body": "<div id=\"comment:4\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4bfca6c607572ec057185b8e29137b99aba5ad4\">b4bfca6</a></td><td><code>only allow subface check for faces of identical combinatorial polyhedron</code></td></tr></table>\n",
    "created_at": "2021-05-13T07:20:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511791",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:4"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4bfca6c607572ec057185b8e29137b99aba5ad4">b4bfca6</a></td><td><code>only allow subface check for faces of identical combinatorial polyhedron</code></td></tr></table>




---

archive/issue_comments_511792.json:
```json
{
    "body": "Changed commit from **[`ce5ab6d`](https://github.com/sagemath/sagetrac-mirror/commit/ce5ab6d8a89206be2b1e816be48642e652ff73b7)** to **[`b4bfca6`](https://github.com/sagemath/sagetrac-mirror/commit/b4bfca6c607572ec057185b8e29137b99aba5ad4)**",
    "created_at": "2021-05-13T07:20:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511792",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ce5ab6d`](https://github.com/sagemath/sagetrac-mirror/commit/ce5ab6d8a89206be2b1e816be48642e652ff73b7)** to **[`b4bfca6`](https://github.com/sagemath/sagetrac-mirror/commit/b4bfca6c607572ec057185b8e29137b99aba5ad4)**



---

archive/issue_events_438893.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-13T07:20:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438893"
}
```



---

archive/issue_events_438894.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-13T07:20:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438894"
}
```



---

archive/issue_comments_511793.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThe pyflakes plugin complains that `facet` is not defined in this line:\n\n```\n            if isinstance(v, PolyhedronFace) and facet.dim() == 0:\n```\nDid you mean `v.dim()`?",
    "created_at": "2021-05-13T17:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511793",
    "user": "https://github.com/slel"
}
```

<div id="comment:6" align="right">comment:6</div>

The pyflakes plugin complains that `facet` is not defined in this line:

```
            if isinstance(v, PolyhedronFace) and facet.dim() == 0:
```
Did you mean `v.dim()`?



---

archive/issue_events_438895.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-05-13T17:27:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438895"
}
```



---

archive/issue_events_438896.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-05-13T17:27:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438896"
}
```



---

archive/issue_comments_511794.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/343b340da6be1de52b53d1473b387a8a37050f40\">343b340</a></td><td><code>fix a variable name and add a doctest</code></td></tr></table>\n",
    "created_at": "2021-05-13T18:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511794",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/343b340da6be1de52b53d1473b387a8a37050f40">343b340</a></td><td><code>fix a variable name and add a doctest</code></td></tr></table>




---

archive/issue_comments_511795.json:
```json
{
    "body": "Changed commit from **[`b4bfca6`](https://github.com/sagemath/sagetrac-mirror/commit/b4bfca6c607572ec057185b8e29137b99aba5ad4)** to **[`343b340`](https://github.com/sagemath/sagetrac-mirror/commit/343b340da6be1de52b53d1473b387a8a37050f40)**",
    "created_at": "2021-05-13T18:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511795",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b4bfca6`](https://github.com/sagemath/sagetrac-mirror/commit/b4bfca6c607572ec057185b8e29137b99aba5ad4)** to **[`343b340`](https://github.com/sagemath/sagetrac-mirror/commit/343b340da6be1de52b53d1473b387a8a37050f40)**



---

archive/issue_comments_511796.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a66e324a1e5dcd3b176e4a78e49599149bc4c93\">9a66e32</a></td><td><code>expose in Polyhedron_base</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/977c088966acadcb1b7fd6589e996a68793db697\">977c088</a></td><td><code>fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15e2c58d57980e142c8ac90e7081d4e6256a5e84\">15e2c58</a></td><td><code>improved documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/deca8e0aa9df9eb7d4f77d9e6e984962c07c1543\">deca8e0</a></td><td><code>fix a variable name and add a doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be121ad494ccdd78ae2e4e4ca7a15ae9a64c0d94\">be121ad</a></td><td><code>implement only subfaces/supfaces for face iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee42e9895eb8830089e328fae674616ca3e9245c\">ee42e98</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/05ec5b29b59e078d5601c4cfa5b1828aa940eab8\">05ec5b2</a></td><td><code>fix error message in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ddf2284a5ae25d4680e78615e881df6ef5bf0d9\">6ddf228</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0a0afa8353b11cc6594425a7376ca04a8582a37\">f0a0afa</a></td><td><code>implement is_subface for combinatorial face</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c632f5609f5e898cebcfb285fd015ad89b89203a\">c632f56</a></td><td><code>only allow subface check for faces of identical combinatorial polyhedron</code></td></tr></table>\n",
    "created_at": "2021-05-13T18:55:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511796",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a66e324a1e5dcd3b176e4a78e49599149bc4c93">9a66e32</a></td><td><code>expose in Polyhedron_base</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/977c088966acadcb1b7fd6589e996a68793db697">977c088</a></td><td><code>fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15e2c58d57980e142c8ac90e7081d4e6256a5e84">15e2c58</a></td><td><code>improved documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/deca8e0aa9df9eb7d4f77d9e6e984962c07c1543">deca8e0</a></td><td><code>fix a variable name and add a doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be121ad494ccdd78ae2e4e4ca7a15ae9a64c0d94">be121ad</a></td><td><code>implement only subfaces/supfaces for face iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee42e9895eb8830089e328fae674616ca3e9245c">ee42e98</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/05ec5b29b59e078d5601c4cfa5b1828aa940eab8">05ec5b2</a></td><td><code>fix error message in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ddf2284a5ae25d4680e78615e881df6ef5bf0d9">6ddf228</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0a0afa8353b11cc6594425a7376ca04a8582a37">f0a0afa</a></td><td><code>implement is_subface for combinatorial face</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c632f5609f5e898cebcfb285fd015ad89b89203a">c632f56</a></td><td><code>only allow subface check for faces of identical combinatorial polyhedron</code></td></tr></table>




---

archive/issue_comments_511797.json:
```json
{
    "body": "Changed commit from **[`343b340`](https://github.com/sagemath/sagetrac-mirror/commit/343b340da6be1de52b53d1473b387a8a37050f40)** to **[`c632f56`](https://github.com/sagemath/sagetrac-mirror/commit/c632f5609f5e898cebcfb285fd015ad89b89203a)**",
    "created_at": "2021-05-13T18:55:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511797",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`343b340`](https://github.com/sagemath/sagetrac-mirror/commit/343b340da6be1de52b53d1473b387a8a37050f40)** to **[`c632f56`](https://github.com/sagemath/sagetrac-mirror/commit/c632f5609f5e898cebcfb285fd015ad89b89203a)**



---

archive/issue_events_438897.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-13T18:55:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438897"
}
```



---

archive/issue_events_438898.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-13T18:55:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438898"
}
```



---

archive/issue_comments_511798.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@slel](#comment:6):\n> The pyflakes plugin complains that `facet` is not defined in this line:\n> \n> ```\n>             if isinstance(v, PolyhedronFace) and facet.dim() == 0:\n> ```\n> Did you mean `v.dim()`?\n\nFixed in #29683 and rebased.",
    "created_at": "2021-05-13T18:56:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511798",
    "user": "https://github.com/kliem"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@slel](#comment:6):
> The pyflakes plugin complains that `facet` is not defined in this line:
> 
> ```
>             if isinstance(v, PolyhedronFace) and facet.dim() == 0:
> ```
> Did you mean `v.dim()`?

Fixed in #29683 and rebased.



---

archive/issue_comments_511799.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThanks.",
    "created_at": "2021-05-13T18:56:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511799",
    "user": "https://github.com/kliem"
}
```

<div id="comment:11" align="right">comment:11</div>

Thanks.



---

archive/issue_comments_511800.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nNees rebase.",
    "created_at": "2021-05-20T07:23:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511800",
    "user": "https://github.com/kliem"
}
```

<div id="comment:12" align="right">comment:12</div>

Nees rebase.



---

archive/issue_events_438899.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-20T07:23:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438899"
}
```



---

archive/issue_events_438900.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-20T07:23:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438900"
}
```



---

archive/issue_comments_511801.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n`is_subface` looks correct. However I don't understand why you distinguished two cases on whether`self._dual == other_face._dual`. It seems to me that the `ambient_V_indices` containment check always works. Is it because using `face_issubset` in the first case is faster? Then, how about using `only_subfaces`?\n\n```\nsage: P = polytopes.cube()\nsage: C = P.combinatorial_polyhedron()\n```\nis repeated in the doctest.",
    "created_at": "2021-05-22T11:51:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511801",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:13" align="right">comment:13</div>

`is_subface` looks correct. However I don't understand why you distinguished two cases on whether`self._dual == other_face._dual`. It seems to me that the `ambient_V_indices` containment check always works. Is it because using `face_issubset` in the first case is faster? Then, how about using `only_subfaces`?

```
sage: P = polytopes.cube()
sage: C = P.combinatorial_polyhedron()
```
is repeated in the doctest.



---

archive/issue_comments_511802.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17720f3c5240919ec231fc2f7402aefb13b89694\">17720f3</a></td><td><code>delete duplication in doctest</code></td></tr></table>\n",
    "created_at": "2021-05-22T11:59:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511802",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17720f3c5240919ec231fc2f7402aefb13b89694">17720f3</a></td><td><code>delete duplication in doctest</code></td></tr></table>




---

archive/issue_comments_511803.json:
```json
{
    "body": "Changed commit from **[`c632f56`](https://github.com/sagemath/sagetrac-mirror/commit/c632f5609f5e898cebcfb285fd015ad89b89203a)** to **[`17720f3`](https://github.com/sagemath/sagetrac-mirror/commit/17720f3c5240919ec231fc2f7402aefb13b89694)**",
    "created_at": "2021-05-22T11:59:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511803",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c632f56`](https://github.com/sagemath/sagetrac-mirror/commit/c632f5609f5e898cebcfb285fd015ad89b89203a)** to **[`17720f3`](https://github.com/sagemath/sagetrac-mirror/commit/17720f3c5240919ec231fc2f7402aefb13b89694)**



---

archive/issue_comments_511804.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@yuan-zhou](#comment:13):\n> `is_subface` looks correct. However I don't understand why you distinguished two cases on whether`self._dual == other_face._dual`. It seems to me that the `ambient_V_indices` containment check always works. Is it because using `face_issubset` in the first case is faster? Then, how about using `only_subfaces`?\n\nUsing the face as a bitset is much much faster than creating a list. Well there would be a faster method for the second case by comparing directly the array instead of the list, but I don't think this case is very important anyway.\n\nHere is some speed comparison:\n\n```\nsage: P = polytopes.hypercube(14, backend='field')                                                                                                                                  \nsage: C = CombinatorialPolyhedron(P)                                                                                                                                                \nsage: it = C.face_iter(dual=False)                                                                                                                                                  \nsage: f = next(it)                                                                                                                                                                  \nsage: it.only_subfaces()                                                                                                                                                            \nsage: f2 = next(it)                                                                                                                                                                 \nsage: %timeit f2.is_subface(f)                                                                                                                                                      \n80.2 ns \u00b1 0.0408 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000000 loops each)\nsage: %timeit f.is_subface(f2)                                                                                                                                                      \n50.1 ns \u00b1 0.0767 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000000 loops each)\nsage: it2 = C.face_iter(dual=True)                                                                                                                                                  \nsage: f3 = next(it2)                                                                                                                                                                \nsage: %timeit f3.is_subface(f)                                                                                                                                                      \n781 \u00b5s \u00b1 444 ns per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\nsage: %timeit f.is_subface(f3)                                                                                                                                                      \n708 \u00b5s \u00b1 239 ns per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\nsage: while f3.dimension() < 12: \n....:     while not f3.is_subface(f): \n....:         f3 = next(it2) \n....:     it2.only_supfaces() \n....:     f3 = next(it2) \n....:                                                                                                                                                                               \nsage: f3.dimension()                                                                                                                                                                \n12\nsage: %timeit f3.is_subface(f)                                                                                                                                                      \n1.16 ms \u00b1 619 ns per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\nsage: %timeit f.is_subface(f3)                                                                                                                                                      \n1.06 ms \u00b1 256 ns per loop (mean \u00b1 std. dev. of 7 runs, 1000 loops each)\n```\n\nEven the very difficult first case (`f2` is indeed a subface of `f`) only takes a few nano seconds to check all `2^14` bits. In comparison the other case is really slow (but it is also not optimized at all).\n\n> \n> ```\n> sage: P = polytopes.cube()\n> sage: C = P.combinatorial_polyhedron()\n> ```\n> is repeated in the doctest.\n\nFixed.",
    "created_at": "2021-05-22T12:15:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511804",
    "user": "https://github.com/kliem"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@yuan-zhou](#comment:13):
> `is_subface` looks correct. However I don't understand why you distinguished two cases on whether`self._dual == other_face._dual`. It seems to me that the `ambient_V_indices` containment check always works. Is it because using `face_issubset` in the first case is faster? Then, how about using `only_subfaces`?

Using the face as a bitset is much much faster than creating a list. Well there would be a faster method for the second case by comparing directly the array instead of the list, but I don't think this case is very important anyway.

Here is some speed comparison:

```
sage: P = polytopes.hypercube(14, backend='field')                                                                                                                                  
sage: C = CombinatorialPolyhedron(P)                                                                                                                                                
sage: it = C.face_iter(dual=False)                                                                                                                                                  
sage: f = next(it)                                                                                                                                                                  
sage: it.only_subfaces()                                                                                                                                                            
sage: f2 = next(it)                                                                                                                                                                 
sage: %timeit f2.is_subface(f)                                                                                                                                                      
80.2 ns ± 0.0408 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
sage: %timeit f.is_subface(f2)                                                                                                                                                      
50.1 ns ± 0.0767 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
sage: it2 = C.face_iter(dual=True)                                                                                                                                                  
sage: f3 = next(it2)                                                                                                                                                                
sage: %timeit f3.is_subface(f)                                                                                                                                                      
781 µs ± 444 ns per loop (mean ± std. dev. of 7 runs, 1000 loops each)
sage: %timeit f.is_subface(f3)                                                                                                                                                      
708 µs ± 239 ns per loop (mean ± std. dev. of 7 runs, 1000 loops each)
sage: while f3.dimension() < 12: 
....:     while not f3.is_subface(f): 
....:         f3 = next(it2) 
....:     it2.only_supfaces() 
....:     f3 = next(it2) 
....:                                                                                                                                                                               
sage: f3.dimension()                                                                                                                                                                
12
sage: %timeit f3.is_subface(f)                                                                                                                                                      
1.16 ms ± 619 ns per loop (mean ± std. dev. of 7 runs, 1000 loops each)
sage: %timeit f.is_subface(f3)                                                                                                                                                      
1.06 ms ± 256 ns per loop (mean ± std. dev. of 7 runs, 1000 loops each)
```

Even the very difficult first case (`f2` is indeed a subface of `f`) only takes a few nano seconds to check all `2^14` bits. In comparison the other case is really slow (but it is also not optimized at all).

> 
> ```
> sage: P = polytopes.cube()
> sage: C = P.combinatorial_polyhedron()
> ```
> is repeated in the doctest.

Fixed.



---

archive/issue_comments_511805.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@kliem](#comment:15):\n> Replying to [@yuan-zhou](#comment:13):\n> In comparison the other case is really slow (but it is also not optimized at all).\n\nIf speed is a concern, then I'd recommend to check `self.dimension() <= other.dimension()` at least.\n\nDoes a face know about the original combinatorial polyhedron `C`? Is `f2.is_subface(f1)`   through something like `C.face_iter().find_face(f1).only_subfaces().find_face(f2)` faster than comparing `ambient_V_indices()`?",
    "created_at": "2021-05-22T13:04:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511805",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@kliem](#comment:15):
> Replying to [@yuan-zhou](#comment:13):
> In comparison the other case is really slow (but it is also not optimized at all).

If speed is a concern, then I'd recommend to check `self.dimension() <= other.dimension()` at least.

Does a face know about the original combinatorial polyhedron `C`? Is `f2.is_subface(f1)`   through something like `C.face_iter().find_face(f1).only_subfaces().find_face(f2)` faster than comparing `ambient_V_indices()`?



---

archive/issue_comments_511806.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nIf `f1` and `f2` are in the same mode, then the current check is fast enough I think.\n\nThe other case is not really intended and I just have something that will work. However, if you want, I can do something more efficient. `find_face` is definitely not the best way of doing it, because it does way to much work. After all, I just have to get the coatom representation of `f1` and compare it with the atom representation of `f2` (the atoms of `f1` are the coatoms of `f2`).",
    "created_at": "2021-05-22T13:33:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511806",
    "user": "https://github.com/kliem"
}
```

<div id="comment:17" align="right">comment:17</div>

If `f1` and `f2` are in the same mode, then the current check is fast enough I think.

The other case is not really intended and I just have something that will work. However, if you want, I can do something more efficient. `find_face` is definitely not the best way of doing it, because it does way to much work. After all, I just have to get the coatom representation of `f1` and compare it with the atom representation of `f2` (the atoms of `f1` are the coatoms of `f2`).



---

archive/issue_comments_511807.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@kliem](#comment:17):\n> After all, I just have to get the coatom representation of `f1` and compare it with the atom representation of `f2` (the atoms of `f1` are the coatoms of `f2`).\n\nIf it's not too complicated to implement, this sounds like a great solution! I don't have a direct use case of \"f1 and f2 not in the same mode\", so I feel good about the ticket even if you won't implement the additional speed-up. However, I'd like to include the `self.dimension() <= other.dimension()` check, as mentioned above.",
    "created_at": "2021-05-23T10:24:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511807",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@kliem](#comment:17):
> After all, I just have to get the coatom representation of `f1` and compare it with the atom representation of `f2` (the atoms of `f1` are the coatoms of `f2`).

If it's not too complicated to implement, this sounds like a great solution! I don't have a direct use case of "f1 and f2 not in the same mode", so I feel good about the ticket even if you won't implement the additional speed-up. However, I'd like to include the `self.dimension() <= other.dimension()` check, as mentioned above.



---

archive/issue_comments_511808.json:
```json
{
    "body": "Reviewer: **Yuan Zhou**",
    "created_at": "2021-05-23T10:24:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511808",
    "user": "https://github.com/yuan-zhou"
}
```

Reviewer: **Yuan Zhou**



---

archive/issue_comments_511809.json:
```json
{
    "body": "Changed commit from **[`17720f3`](https://github.com/sagemath/sagetrac-mirror/commit/17720f3c5240919ec231fc2f7402aefb13b89694)** to **[`c0c8295`](https://github.com/sagemath/sagetrac-mirror/commit/c0c8295950d26fd59fe3a0311a9f7df7a873e05a)**",
    "created_at": "2021-05-23T19:12:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511809",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`17720f3`](https://github.com/sagemath/sagetrac-mirror/commit/17720f3c5240919ec231fc2f7402aefb13b89694)** to **[`c0c8295`](https://github.com/sagemath/sagetrac-mirror/commit/c0c8295950d26fd59fe3a0311a9f7df7a873e05a)**



---

archive/issue_comments_511810.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ed706f7cbdb539ced4ec3a780d28da8f799273b\">8ed706f</a></td><td><code>assume type to safe some time</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c0c8295950d26fd59fe3a0311a9f7df7a873e05a\">c0c8295</a></td><td><code>optimized code</code></td></tr></table>\n",
    "created_at": "2021-05-23T19:12:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511810",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:19"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ed706f7cbdb539ced4ec3a780d28da8f799273b">8ed706f</a></td><td><code>assume type to safe some time</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c0c8295950d26fd59fe3a0311a9f7df7a873e05a">c0c8295</a></td><td><code>optimized code</code></td></tr></table>




---

archive/issue_comments_511811.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@yuan-zhou](#comment:18):\n> Replying to [@kliem](#comment:17):\n> > After all, I just have to get the coatom representation of `f1` and compare it with the atom representation of `f2` (the atoms of `f1` are the coatoms of `f2`).\n\n> If it's not too complicated to implement, this sounds like a great solution! I don't have a direct use case of \"f1 and f2 not in the same mode\", so I feel good about the ticket even if you won't implement the additional speed-up. However, I'd like to include the `self.dimension() <= other.dimension()` check, as mentioned above. \n\nThe check `self.dimension() <= other.dimension()` is no improvement either way, when `self` and `other` are in same mode.\n\nHere are the new timings:\n\n```\nsage: P = polytopes.hypercube(14, backend='field')                                                                                                                                  \nsage: C = CombinatorialPolyhedron(P)                                                                                                                                                \nsage: it = C.face_iter(dual=False)                                                                                                                                                  \nsage: f = next(it)                                                                                                                                                                  \nsage: it.only_subfaces()                                                                                                                                                            \nsage: f2 = next(it)                                                                                                                                                                 \nsage: %timeit f.is_subface(f2)                                                                                                                                                      \n42.2 ns \u00b1 0.0401 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000000 loops each)\nsage: %timeit f2.is_subface(f)                                                                                                                                                      \n72.4 ns \u00b1 0.0662 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000000 loops each)\nsage: it2 = C.face_iter(dual=True)                                                                                                                                                  \nsage: f3 = next(it2)                                                                                                                                                                \nsage: %timeit f.is_subface(f3)                                                                                                                                                      \n56.8 ns \u00b1 0.0814 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000000 loops each)\nsage: %timeit f3.is_subface(f)                                                                                                                                                      \n78.1 \u00b5s \u00b1 92.8 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\nsage: while True: \n....:     while not f3.is_subface(f): \n....:         f3 = next(it2) \n....:     it2.only_supfaces() \n....:     if f3.dimension() == 12: \n....:         break \n....:     f3 = next(it2) \n....:                                                                                                                                                                               \nsage: %timeit f.is_subface(f3)                                                                                                                                                      \n58.5 ns \u00b1 0.0699 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000000 loops each)\nsage: %timeit f3.is_subface(f)                                                                                                                                                      \n78.3 \u00b5s \u00b1 46.5 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000 loops each)\nsage: f3.dimension()                                                                                                                                                                \n12\nsage: f.is_subface(f3)                                                                                                                                                              \nFalse\nsage: f3.is_subface(f)                                                                                                                                                              \nTrue\n```",
    "created_at": "2021-05-23T19:17:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511811",
    "user": "https://github.com/kliem"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@yuan-zhou](#comment:18):
> Replying to [@kliem](#comment:17):
> > After all, I just have to get the coatom representation of `f1` and compare it with the atom representation of `f2` (the atoms of `f1` are the coatoms of `f2`).

> If it's not too complicated to implement, this sounds like a great solution! I don't have a direct use case of "f1 and f2 not in the same mode", so I feel good about the ticket even if you won't implement the additional speed-up. However, I'd like to include the `self.dimension() <= other.dimension()` check, as mentioned above. 

The check `self.dimension() <= other.dimension()` is no improvement either way, when `self` and `other` are in same mode.

Here are the new timings:

```
sage: P = polytopes.hypercube(14, backend='field')                                                                                                                                  
sage: C = CombinatorialPolyhedron(P)                                                                                                                                                
sage: it = C.face_iter(dual=False)                                                                                                                                                  
sage: f = next(it)                                                                                                                                                                  
sage: it.only_subfaces()                                                                                                                                                            
sage: f2 = next(it)                                                                                                                                                                 
sage: %timeit f.is_subface(f2)                                                                                                                                                      
42.2 ns ± 0.0401 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
sage: %timeit f2.is_subface(f)                                                                                                                                                      
72.4 ns ± 0.0662 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
sage: it2 = C.face_iter(dual=True)                                                                                                                                                  
sage: f3 = next(it2)                                                                                                                                                                
sage: %timeit f.is_subface(f3)                                                                                                                                                      
56.8 ns ± 0.0814 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
sage: %timeit f3.is_subface(f)                                                                                                                                                      
78.1 µs ± 92.8 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
sage: while True: 
....:     while not f3.is_subface(f): 
....:         f3 = next(it2) 
....:     it2.only_supfaces() 
....:     if f3.dimension() == 12: 
....:         break 
....:     f3 = next(it2) 
....:                                                                                                                                                                               
sage: %timeit f.is_subface(f3)                                                                                                                                                      
58.5 ns ± 0.0699 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
sage: %timeit f3.is_subface(f)                                                                                                                                                      
78.3 µs ± 46.5 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
sage: f3.dimension()                                                                                                                                                                
12
sage: f.is_subface(f3)                                                                                                                                                              
False
sage: f3.is_subface(f)                                                                                                                                                              
True
```



---

archive/issue_comments_511812.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nBtw, currently `face.coatom_rep` etc. is reinitialized. I expect things to be much faster on repeated calls, if I change the code to realize this.\n\nHowever, this might be the more honest timing, as it reflects more realistic the amount of time the first call needs.",
    "created_at": "2021-05-23T19:37:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511812",
    "user": "https://github.com/kliem"
}
```

<div id="comment:21" align="right">comment:21</div>

Btw, currently `face.coatom_rep` etc. is reinitialized. I expect things to be much faster on repeated calls, if I change the code to realize this.

However, this might be the more honest timing, as it reflects more realistic the amount of time the first call needs.



---

archive/issue_comments_511813.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nCaching `atom_rep` and `coatom_rep` (actually not cashing, but only remembering that it has already been computed), I get the following timings now:\n\n```\nsage: P = polytopes.hypercube(14, backend='field')                                                                                                                                  \nsage: C = CombinatorialPolyhedron(P)                                                                                                                                                \nsage: it = C.face_iter(dual=False)                                                                                                                                                  \nsage: f = next(it)                                                                                                                                                                   \nsage: it2 = C.face_iter(dual=True)                                                                                                                                                  \nsage: f3 = next(it2)                                                                                                                                                                \nsage: %timeit f.is_subface(f3)                                                                                                                                                      \n56.7 ns \u00b1 0.0563 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000000 loops each)\nsage: %timeit f3.is_subface(f)                                                                                                                                                      \n7.12 \u00b5s \u00b1 68.1 ns per loop (mean \u00b1 std. dev. of 7 runs, 100000 loops each)\nsage: while True: \n....:     while not f3.is_subface(f): \n....:         f3 = next(it2) \n....:     it2.only_supfaces() \n....:     if f3.dimension() == 12: \n....:         break \n....:     f3 = next(it2) \n....:                                                                                                                                                                               \nsage: %timeit f.is_subface(f3)                                                                                                                                                      \n58.1 ns \u00b1 0.0822 ns per loop (mean \u00b1 std. dev. of 7 runs, 10000000 loops each)\nsage: %timeit f3.is_subface(f)                                                                                                                                                      \n5.34 \u00b5s \u00b1 2.1 ns per loop (mean \u00b1 std. dev. of 7 runs, 100000 loops each)\n```",
    "created_at": "2021-05-25T07:02:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511813",
    "user": "https://github.com/kliem"
}
```

<div id="comment:22" align="right">comment:22</div>

Caching `atom_rep` and `coatom_rep` (actually not cashing, but only remembering that it has already been computed), I get the following timings now:

```
sage: P = polytopes.hypercube(14, backend='field')                                                                                                                                  
sage: C = CombinatorialPolyhedron(P)                                                                                                                                                
sage: it = C.face_iter(dual=False)                                                                                                                                                  
sage: f = next(it)                                                                                                                                                                   
sage: it2 = C.face_iter(dual=True)                                                                                                                                                  
sage: f3 = next(it2)                                                                                                                                                                
sage: %timeit f.is_subface(f3)                                                                                                                                                      
56.7 ns ± 0.0563 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
sage: %timeit f3.is_subface(f)                                                                                                                                                      
7.12 µs ± 68.1 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
sage: while True: 
....:     while not f3.is_subface(f): 
....:         f3 = next(it2) 
....:     it2.only_supfaces() 
....:     if f3.dimension() == 12: 
....:         break 
....:     f3 = next(it2) 
....:                                                                                                                                                                               
sage: %timeit f.is_subface(f3)                                                                                                                                                      
58.1 ns ± 0.0822 ns per loop (mean ± std. dev. of 7 runs, 10000000 loops each)
sage: %timeit f3.is_subface(f)                                                                                                                                                      
5.34 µs ± 2.1 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
```



---

archive/issue_comments_511814.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5de63bee53fdefbdb1a99ed978c72db2b611410d\">5de63be</a></td><td><code>cache atom_rep and coatom_rep of combinatorial face</code></td></tr></table>\n",
    "created_at": "2021-05-25T07:06:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511814",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5de63bee53fdefbdb1a99ed978c72db2b611410d">5de63be</a></td><td><code>cache atom_rep and coatom_rep of combinatorial face</code></td></tr></table>




---

archive/issue_comments_511815.json:
```json
{
    "body": "Changed commit from **[`c0c8295`](https://github.com/sagemath/sagetrac-mirror/commit/c0c8295950d26fd59fe3a0311a9f7df7a873e05a)** to **[`5de63be`](https://github.com/sagemath/sagetrac-mirror/commit/5de63bee53fdefbdb1a99ed978c72db2b611410d)**",
    "created_at": "2021-05-25T07:06:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511815",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c0c8295`](https://github.com/sagemath/sagetrac-mirror/commit/c0c8295950d26fd59fe3a0311a9f7df7a873e05a)** to **[`5de63be`](https://github.com/sagemath/sagetrac-mirror/commit/5de63bee53fdefbdb1a99ed978c72db2b611410d)**



---

archive/issue_comments_511816.json:
```json
{
    "body": "Changed branch from **[u/gh-kliem/is_subface_for_combinatorial_face](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/is_subface_for_combinatorial_face)** to **[u/mkoeppe/is_subface_for_combinatorial_face](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/is_subface_for_combinatorial_face)**",
    "created_at": "2021-06-23T01:04:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511816",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/gh-kliem/is_subface_for_combinatorial_face](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/is_subface_for_combinatorial_face)** to **[u/mkoeppe/is_subface_for_combinatorial_face](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/is_subface_for_combinatorial_face)**



---

archive/issue_events_438901.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T01:08:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438901"
}
```



---

archive/issue_events_438902.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T01:08:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438902"
}
```



---

archive/issue_comments_511817.json:
```json
{
    "body": "Changed commit from **[`5de63be`](https://github.com/sagemath/sagetrac-mirror/commit/5de63bee53fdefbdb1a99ed978c72db2b611410d)** to **[`ac5c327`](https://github.com/sagemath/sagetrac-mirror/commit/ac5c32764b3b9283fc5b7635fac631fea7bb6840)**",
    "created_at": "2021-06-23T01:08:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511817",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`5de63be`](https://github.com/sagemath/sagetrac-mirror/commit/5de63bee53fdefbdb1a99ed978c72db2b611410d)** to **[`ac5c327`](https://github.com/sagemath/sagetrac-mirror/commit/ac5c32764b3b9283fc5b7635fac631fea7bb6840)**



---

archive/issue_comments_511818.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI am guessing that this ticket \"needs review\"\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70a8791eb07df89a7d3e2a40c35516ae93e6e0bb\">70a8791</a></td><td><code>Merge branch 'u/gh-kliem/check_openmp_at_configuration' of git://trac.sagemath.org/sage into u/gh-kliem/first_parallel_version_of_face_iterator_reb2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdbe95f9cf2b4787a59a459231074a7c528397f3\">fdbe95f</a></td><td><code>use cython.parallel.threadid instead of omp_get_thread_num</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ae6966e49618739268625fbe5b9767ca6175200\">4ae6966</a></td><td><code>Merge tag '9.4.beta0' into t/31245/first_parallel_version_of_face_iterator_reb2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfb4efb24275dd80071451411f71094fe4084710\">bfb4efb</a></td><td><code>Merge branch 'u/mkoeppe/first_parallel_version_of_face_iterator_reb2' of git://trac.sagemath.org/sage into u/mkoeppe/first_parallel_version_of_face_iterator_reb3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c0a4ae74c28680e48080c39c5e3b171a79a9ad3\">4c0a4ae</a></td><td><code>initialize do_f_vector</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/542baee396e8db57d59020cc1fd905e1b045eaa7\">542baee</a></td><td><code>merge in #31245</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e0229f2d13cae98944d37ba5f6a1387334cf96f\">3e0229f</a></td><td><code>Merge tag '9.4.beta3' into t/31834/public/31834-reb2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81909176a611e8a0ec32eab9990c25467c417552\">8190917</a></td><td><code>Merge #31834</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338\">7f7e630</a></td><td><code>Merge #29683</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac5c32764b3b9283fc5b7635fac631fea7bb6840\">ac5c327</a></td><td><code>Merge #31819</code></td></tr></table>\n",
    "created_at": "2021-06-23T01:08:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511818",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:25" align="right">comment:25</div>

I am guessing that this ticket "needs review"

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70a8791eb07df89a7d3e2a40c35516ae93e6e0bb">70a8791</a></td><td><code>Merge branch 'u/gh-kliem/check_openmp_at_configuration' of git://trac.sagemath.org/sage into u/gh-kliem/first_parallel_version_of_face_iterator_reb2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdbe95f9cf2b4787a59a459231074a7c528397f3">fdbe95f</a></td><td><code>use cython.parallel.threadid instead of omp_get_thread_num</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ae6966e49618739268625fbe5b9767ca6175200">4ae6966</a></td><td><code>Merge tag '9.4.beta0' into t/31245/first_parallel_version_of_face_iterator_reb2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfb4efb24275dd80071451411f71094fe4084710">bfb4efb</a></td><td><code>Merge branch 'u/mkoeppe/first_parallel_version_of_face_iterator_reb2' of git://trac.sagemath.org/sage into u/mkoeppe/first_parallel_version_of_face_iterator_reb3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c0a4ae74c28680e48080c39c5e3b171a79a9ad3">4c0a4ae</a></td><td><code>initialize do_f_vector</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/542baee396e8db57d59020cc1fd905e1b045eaa7">542baee</a></td><td><code>merge in #31245</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e0229f2d13cae98944d37ba5f6a1387334cf96f">3e0229f</a></td><td><code>Merge tag '9.4.beta3' into t/31834/public/31834-reb2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81909176a611e8a0ec32eab9990c25467c417552">8190917</a></td><td><code>Merge #31834</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338">7f7e630</a></td><td><code>Merge #29683</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac5c32764b3b9283fc5b7635fac631fea7bb6840">ac5c327</a></td><td><code>Merge #31819</code></td></tr></table>




---

archive/issue_comments_511819.json:
```json
{
    "body": "Changed reviewer from **Yuan Zhou** to **Yuan Zhou, Matthias Koeppe**",
    "created_at": "2021-06-23T01:24:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511819",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Yuan Zhou** to **Yuan Zhou, Matthias Koeppe**



---

archive/issue_events_438903.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T01:24:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438903"
}
```



---

archive/issue_events_438904.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T01:24:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438904"
}
```



---

archive/issue_comments_511820.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI have not followed the discussion on timing, but the code looks fine to me, and passes tests.",
    "created_at": "2021-06-23T01:24:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511820",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

I have not followed the discussion on timing, but the code looks fine to me, and passes tests.



---

archive/issue_comments_511821.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThank you.",
    "created_at": "2021-06-23T11:36:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511821",
    "user": "https://github.com/kliem"
}
```

<div id="comment:27" align="right">comment:27</div>

Thank you.



---

archive/issue_comments_511822.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/is_subface_for_combinatorial_face](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/is_subface_for_combinatorial_face)** to **[`ac5c327`](https://github.com/sagemath/sagetrac-mirror/commit/ac5c32764b3b9283fc5b7635fac631fea7bb6840)**",
    "created_at": "2021-07-01T20:44:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31822#issuecomment-511822",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/is_subface_for_combinatorial_face](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/is_subface_for_combinatorial_face)** to **[`ac5c327`](https://github.com/sagemath/sagetrac-mirror/commit/ac5c32764b3b9283fc5b7635fac631fea7bb6840)**



---

archive/issue_events_438905.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-01T20:44:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438905"
}
```



---

archive/issue_events_438906.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "5f639d3c78a67b45a90a5ec44a7ed807b04849e3",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-07-01T20:44:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31822",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31822#event-438906"
}
```
