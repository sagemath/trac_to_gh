# Issue 31443: update eclib and improve interface for elliptic curve saturation

archive/issues_031206.json:
```json
{
    "assignees": [],
    "body": "I recently made a new version of eclib, which will only affect the saturation of points on elliptic curves over Q.  The interface for this (in the `saturation()` method for elliptic curves over Q) has some problems.  Mainly, it does not do a good job of choosing the real precision which mwrank should work at, and also (due to shortcomings in eclib which are now improved) (1) when saturation at one prime fails owing to precision being too low, Sage has no way to do something sensible such as raise an error, or put the call into a loop in which the precision is increased; (2) there is no way to saturate at a single prime, or a range of primes, only at all primes or all primes except 2 or all primes up to some bound.  The new eclib version allows for a first and last prime at which saturation should be done.  The rationale here is that if you have saturated points on one curve and map them to another using an isogeny, then the image points will automatically be saturated at all primes dividing the isogeny degree.\n\nI don't see a sensible way to deal with this in two parts, so I'll make a new eclib spkg (if that is what they are still called) and make the code changes to saturation at the same time.\n\nIncidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n\nNew eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210625/eclib-20210625.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210625/eclib-20210625.tar.bz2)\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nCC:  @slel @collares @orlitzky @isuruf @kiwifb @antonio-rojas\n\nComponent: **packages: standard**\n\nKeywords: **eclib elliptic curve saturation**\n\nAuthor: **John Cremona, Dima Pasechnik**\n\nBranch: **[`789550c`](https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038)**\n\nReviewer: **Dima Pasechnik, Matthias Koeppe**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31443_\n\n",
    "closed_at": "2021-06-29T23:08:47Z",
    "created_at": "2021-03-01T17:03:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "update eclib and improve interface for elliptic curve saturation",
    "type": "issue",
    "updated_at": "2021-07-08T20:25:42Z",
    "url": "https://github.com/sagemath/sage/issues/31443",
    "user": "https://github.com/JohnCremona"
}
```
I recently made a new version of eclib, which will only affect the saturation of points on elliptic curves over Q.  The interface for this (in the `saturation()` method for elliptic curves over Q) has some problems.  Mainly, it does not do a good job of choosing the real precision which mwrank should work at, and also (due to shortcomings in eclib which are now improved) (1) when saturation at one prime fails owing to precision being too low, Sage has no way to do something sensible such as raise an error, or put the call into a loop in which the precision is increased; (2) there is no way to saturate at a single prime, or a range of primes, only at all primes or all primes except 2 or all primes up to some bound.  The new eclib version allows for a first and last prime at which saturation should be done.  The rationale here is that if you have saturated points on one curve and map them to another using an isogeny, then the image points will automatically be saturated at all primes dividing the isogeny degree.

I don't see a sensible way to deal with this in two parts, so I'll make a new eclib spkg (if that is what they are still called) and make the code changes to saturation at the same time.

Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).

New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210625/eclib-20210625.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210625/eclib-20210625.tar.bz2)

Upstream: **Fixed upstream, in a later stable release.**

CC:  @slel @collares @orlitzky @isuruf @kiwifb @antonio-rojas

Component: **packages: standard**

Keywords: **eclib elliptic curve saturation**

Author: **John Cremona, Dima Pasechnik**

Branch: **[`789550c`](https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038)**

Reviewer: **Dima Pasechnik, Matthias Koeppe**

_Issue created by migration from https://trac.sagemath.org/ticket/31443_





---

archive/issue_events_430259.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-01T17:03:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430259"
}
```



---

archive/issue_events_430260.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-01T17:03:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430260"
}
```



---

archive/issue_events_430261.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-01T17:03:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430261"
}
```



---

archive/issue_events_430262.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-01T17:03:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430262"
}
```



---

archive/issue_comments_504720.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n-I recently made a new version of eclib, which will only affect the saturation of points on elliptic curves over Q.  The interface for this (in the saturation() method for elliptic curves over Q) has some problems.  Mainly, it does not do a good job of choosing the real precision which mwrank should work at, and also (due to shortcomings in eclib which are now improved) (1) when saturation at one prime fails owing to precision being to low, Sage has no way to do something sensible such as raise an error, or put the call into a loop in which the precision is increased; (2) there is no way to saturate at a single prime, or a range of primes, only at all primes or all primes except 2 or all primes up to some bound.  The new eclib version allows for a first and last prime at which saturation should be done.  The rationale here is that if you have saturated points on one curve and map them to another using an isogeny, then the image points will autimatically be saturated at all primes dividing the isogeny degree.\n+I recently made a new version of eclib, which will only affect the saturation of points on elliptic curves over Q.  The interface for this (in the `saturation()` method for elliptic curves over Q) has some problems.  Mainly, it does not do a good job of choosing the real precision which mwrank should work at, and also (due to shortcomings in eclib which are now improved) (1) when saturation at one prime fails owing to precision being too low, Sage has no way to do something sensible such as raise an error, or put the call into a loop in which the precision is increased; (2) there is no way to saturate at a single prime, or a range of primes, only at all primes or all primes except 2 or all primes up to some bound.  The new eclib version allows for a first and last prime at which saturation should be done.  The rationale here is that if you have saturated points on one curve and map them to another using an isogeny, then the image points will automatically be saturated at all primes dividing the isogeny degree.\n \n-I don't see a sensible wway to dedeal with this in two parts, so I'll make a new eclib spkg (if that is what they are still called) and make the code changes to saturation at the same time.\n+I don't see a sensible way to deal with this in two parts, so I'll make a new eclib spkg (if that is what they are still called) and make the code changes to saturation at the same time.\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n``````\n",
    "created_at": "2021-03-02T03:33:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504720",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
-I recently made a new version of eclib, which will only affect the saturation of points on elliptic curves over Q.  The interface for this (in the saturation() method for elliptic curves over Q) has some problems.  Mainly, it does not do a good job of choosing the real precision which mwrank should work at, and also (due to shortcomings in eclib which are now improved) (1) when saturation at one prime fails owing to precision being to low, Sage has no way to do something sensible such as raise an error, or put the call into a loop in which the precision is increased; (2) there is no way to saturate at a single prime, or a range of primes, only at all primes or all primes except 2 or all primes up to some bound.  The new eclib version allows for a first and last prime at which saturation should be done.  The rationale here is that if you have saturated points on one curve and map them to another using an isogeny, then the image points will autimatically be saturated at all primes dividing the isogeny degree.
+I recently made a new version of eclib, which will only affect the saturation of points on elliptic curves over Q.  The interface for this (in the `saturation()` method for elliptic curves over Q) has some problems.  Mainly, it does not do a good job of choosing the real precision which mwrank should work at, and also (due to shortcomings in eclib which are now improved) (1) when saturation at one prime fails owing to precision being too low, Sage has no way to do something sensible such as raise an error, or put the call into a loop in which the precision is increased; (2) there is no way to saturate at a single prime, or a range of primes, only at all primes or all primes except 2 or all primes up to some bound.  The new eclib version allows for a first and last prime at which saturation should be done.  The rationale here is that if you have saturated points on one curve and map them to another using an isogeny, then the image points will automatically be saturated at all primes dividing the isogeny degree.
 
-I don't see a sensible wway to dedeal with this in two parts, so I'll make a new eclib spkg (if that is what they are still called) and make the code changes to saturation at the same time.
+I don't see a sensible way to deal with this in two parts, so I'll make a new eclib spkg (if that is what they are still called) and make the code changes to saturation at the same time.
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
``````




---

archive/issue_comments_504721.json:
```json
{
    "body": "Commit: **[`69c3195`](https://github.com/sagemath/sagetrac-mirror/commit/69c3195d7adee86991ae3b9a47081f3222178d18)**",
    "created_at": "2021-03-11T16:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504721",
    "user": "https://github.com/JohnCremona"
}
```

Commit: **[`69c3195`](https://github.com/sagemath/sagetrac-mirror/commit/69c3195d7adee86991ae3b9a47081f3222178d18)**



---

archive/issue_comments_504722.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n I don't see a sensible way to deal with this in two parts, so I'll make a new eclib spkg (if that is what they are still called) and make the code changes to saturation at the same time.\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n+\n+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210310.tar.bz2](https://johncremona.github.io/ftp/eclib-20210310.tar.bz2)\n``````\n",
    "created_at": "2021-03-11T16:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504722",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 I don't see a sensible way to deal with this in two parts, so I'll make a new eclib spkg (if that is what they are still called) and make the code changes to saturation at the same time.
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
+
+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210310.tar.bz2](https://johncremona.github.io/ftp/eclib-20210310.tar.bz2)
``````




---

archive/issue_comments_504723.json:
```json
{
    "body": "Changed keywords from none to **eclib elliptic curve saturation**",
    "created_at": "2021-03-11T16:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504723",
    "user": "https://github.com/JohnCremona"
}
```

Changed keywords from none to **eclib elliptic curve saturation**



---

archive/issue_events_430263.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-11T16:24:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430263"
}
```



---

archive/issue_comments_504724.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nHere's the updated `eclib` version `v20210310` (see tarball link above) together with the necessary changes to the interface in `src/sage/libs/eclib`, and also a much simplified (and improved) `saturation()` method in `sage/schemes/elliptic_curves/ell_rational_field`.\n\nThis was a symbiotic procedure, in the sense that as I modified the interface code and tested, I found issues which had to be fixed on the `eclib` side.\n\nThe main changes for `eclib` are:  various efficiency improvements in the sieve used to p-saturation for an individual prime p;  much better division of a point by p (when it is p times a smaller point), by default using division polynomials instead of floating point methods, though I did also improve the f.p. approach to set the precision appropriately (instead of just relying on the user to do so) which fixed the immediate hard cases I had;  reducing the saturation index bound when the subgroup is enlarged.  I also made some improvements to the construction of a newform from an elliptic curve which will avoid the normalisation problems with modular symbols (which I had already fixed on the Sage side, but this is more robust).\n\nI will post here some elliptic curves whose saturation is now faster and/or better.  There are plenty of examples in the old doctests, but the really hard cases are not very suitable for doctests as they involve hundreds (or thousands) of digits, or take 15 minutes.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2215893710051b3a0891e3dd06527a076d3600b3\"><code>2215893</code></a></td><td><code>#31443: update eclib package metadata</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/25549670286c71f7a7fb74b9767c54130d7c1285\"><code>2554967</code></a></td><td><code>#31443: update eclib package metadata again</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1dfacfe172f9c82da90a7ff7e76cba990a05613\"><code>e1dfacf</code></a></td><td><code>#31443: adapt eclib library interface for version v20210310</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69c3195d7adee86991ae3b9a47081f3222178d18\"><code>69c3195</code></a></td><td><code>#31443: simplify/improve saturation method for elliptic curves over Q</code></td></tr></table>\n",
    "created_at": "2021-03-11T16:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504724",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:2" align="right">comment:2</div>

Here's the updated `eclib` version `v20210310` (see tarball link above) together with the necessary changes to the interface in `src/sage/libs/eclib`, and also a much simplified (and improved) `saturation()` method in `sage/schemes/elliptic_curves/ell_rational_field`.

This was a symbiotic procedure, in the sense that as I modified the interface code and tested, I found issues which had to be fixed on the `eclib` side.

The main changes for `eclib` are:  various efficiency improvements in the sieve used to p-saturation for an individual prime p;  much better division of a point by p (when it is p times a smaller point), by default using division polynomials instead of floating point methods, though I did also improve the f.p. approach to set the precision appropriately (instead of just relying on the user to do so) which fixed the immediate hard cases I had;  reducing the saturation index bound when the subgroup is enlarged.  I also made some improvements to the construction of a newform from an elliptic curve which will avoid the normalisation problems with modular symbols (which I had already fixed on the Sage side, but this is more robust).

I will post here some elliptic curves whose saturation is now faster and/or better.  There are plenty of examples in the old doctests, but the really hard cases are not very suitable for doctests as they involve hundreds (or thousands) of digits, or take 15 minutes.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2215893710051b3a0891e3dd06527a076d3600b3"><code>2215893</code></a></td><td><code>#31443: update eclib package metadata</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/25549670286c71f7a7fb74b9767c54130d7c1285"><code>2554967</code></a></td><td><code>#31443: update eclib package metadata again</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1dfacfe172f9c82da90a7ff7e76cba990a05613"><code>e1dfacf</code></a></td><td><code>#31443: adapt eclib library interface for version v20210310</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69c3195d7adee86991ae3b9a47081f3222178d18"><code>69c3195</code></a></td><td><code>#31443: simplify/improve saturation method for elliptic curves over Q</code></td></tr></table>




---

archive/issue_comments_504725.json:
```json
{
    "body": "Branch: **[u/cremona/31443-eclib-saturation](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/31443-eclib-saturation)**",
    "created_at": "2021-03-11T16:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504725",
    "user": "https://github.com/JohnCremona"
}
```

Branch: **[u/cremona/31443-eclib-saturation](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/31443-eclib-saturation)**



---

archive/issue_comments_504726.json:
```json
{
    "body": "Author: **John Cremona**",
    "created_at": "2021-03-11T16:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504726",
    "user": "https://github.com/JohnCremona"
}
```

Author: **John Cremona**



---

archive/issue_comments_504727.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAn example where the point P is 3*Q but E.saturation([P]) used to fail.\n\nIn Sage 9.2:\n\n```\nE = EllipticCurve([0, 1, 0, -3532341, 2671895459])\nQ = E([188751344014/116704809 , 43530702836852015/1260762051627])\nP = 3*Q\nE.saturation([P]) # fails\n```\neven after `mwrank_set_precision(2000)`, which is slow.  But with the new version (and no precision adjustment necessary, as the new method is exact):\n\n```\nsage: E.saturation([P])                                                                                                                               \n([(188751344014/116704809 : 43530702836852015/1260762051627 : 1)],\n 3,\n 22.2351273597058)\n```\nand this is instantaneous.\n\nAn example you will probably not want to run to completion:\n\n```\nsage: E = EllipticCurve([0,1,1,-9872,374262])                                                                                                         \nsage: pts = E.gens(sat_bound=0)                                                                                                                       \nsage: pts                                                                                                                                             \n[(-88 : 754 : 1), (-42 : 846 : 1), (-25 : 778 : 1), (57 : -1 : 1)]\nsage: %time E.saturation(pts, verbose=True)\n```\nUnder 9.2 it reports that the saturation index bound is 86682 but that it will not go past 10000 -- you can override this if you want, but even going up to 10000 takes a long time.  With the new code, it does not reduce the bound (since the default is supposed to be that it goes all the way up to the bound necessary to prove saturation) and takes about 15 minutes.",
    "created_at": "2021-03-11T16:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504727",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:3" align="right">comment:3</div>

An example where the point P is 3*Q but E.saturation([P]) used to fail.

In Sage 9.2:

```
E = EllipticCurve([0, 1, 0, -3532341, 2671895459])
Q = E([188751344014/116704809 , 43530702836852015/1260762051627])
P = 3*Q
E.saturation([P]) # fails
```
even after `mwrank_set_precision(2000)`, which is slow.  But with the new version (and no precision adjustment necessary, as the new method is exact):

```
sage: E.saturation([P])                                                                                                                               
([(188751344014/116704809 : 43530702836852015/1260762051627 : 1)],
 3,
 22.2351273597058)
```
and this is instantaneous.

An example you will probably not want to run to completion:

```
sage: E = EllipticCurve([0,1,1,-9872,374262])                                                                                                         
sage: pts = E.gens(sat_bound=0)                                                                                                                       
sage: pts                                                                                                                                             
[(-88 : 754 : 1), (-42 : 846 : 1), (-25 : 778 : 1), (57 : -1 : 1)]
sage: %time E.saturation(pts, verbose=True)
```
Under 9.2 it reports that the saturation index bound is 86682 but that it will not go past 10000 -- you can override this if you want, but even going up to 10000 takes a long time.  With the new code, it does not reduce the bound (since the default is supposed to be that it goes all the way up to the bound necessary to prove saturation) and takes about 15 minutes.



---

archive/issue_comments_504728.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIn fact the second example is even more stupid in 9.2 since after proving p-saturation at all p up to 10979, with no errors or problems at all, it adds 1000 to the bound and starts again proving p-saturation from 2 up to 11981.  As each of these runs takes several minutes, it will take a long time to get up to 86682 this way.  One issue (now addressed) is that eclib did not have a parameter specifying which p to start at, if you wanted to resume saturating at any point except 2 or 3 (there was only an option to skip p=2).  But more seriously, the saturation was being repeated not because of any problem which has arisen, just because of the artificial lowering of the bound.  The old version could do the job by setting `max_prime` to 86682 but that takes a lot longer than the new version.",
    "created_at": "2021-03-11T17:12:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504728",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:4" align="right">comment:4</div>

In fact the second example is even more stupid in 9.2 since after proving p-saturation at all p up to 10979, with no errors or problems at all, it adds 1000 to the bound and starts again proving p-saturation from 2 up to 11981.  As each of these runs takes several minutes, it will take a long time to get up to 86682 this way.  One issue (now addressed) is that eclib did not have a parameter specifying which p to start at, if you wanted to resume saturating at any point except 2 or 3 (there was only an option to skip p=2).  But more seriously, the saturation was being repeated not because of any problem which has arisen, just because of the artificial lowering of the bound.  The old version could do the job by setting `max_prime` to 86682 but that takes a lot longer than the new version.



---

archive/issue_comments_504729.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nNeeds rebasing",
    "created_at": "2021-03-15T19:01:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504729",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:6" align="right">comment:6</div>

Needs rebasing



---

archive/issue_events_430264.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2021-03-15T19:01:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430264"
}
```



---

archive/issue_events_430265.json:
```json
{
    "actor": "https://github.com/antonio-rojas",
    "created_at": "2021-03-15T19:01:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430265"
}
```



---

archive/issue_comments_504730.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f0b74f20bb3e444fc1fdfa3fb92b33c5b5cb06e\"><code>1f0b74f</code></a></td><td><code>#31443: update eclib package metadata</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5fce79f65d4a5071a5fccd210a99cd07bdc8b30d\"><code>5fce79f</code></a></td><td><code>#31443: update eclib package metadata again</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a46b6f9d9b3b2fb8a9ba0587dd6b71991cd0fec9\"><code>a46b6f9</code></a></td><td><code>#31443: adapt eclib library interface for version v20210310</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/453c793d1f17096695d7ee2cf53d6e0c9c462338\"><code>453c793</code></a></td><td><code>#31443: simplify/improve saturation method for elliptic curves over Q</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ba267ac16722b3eee43d2b4ed73840c366a8bec\"><code>4ba267a</code></a></td><td><code>#31443: fix two doctest output now that eclib no longer gives incorrect results</code></td></tr></table>\n",
    "created_at": "2021-03-16T14:29:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504730",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f0b74f20bb3e444fc1fdfa3fb92b33c5b5cb06e"><code>1f0b74f</code></a></td><td><code>#31443: update eclib package metadata</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5fce79f65d4a5071a5fccd210a99cd07bdc8b30d"><code>5fce79f</code></a></td><td><code>#31443: update eclib package metadata again</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a46b6f9d9b3b2fb8a9ba0587dd6b71991cd0fec9"><code>a46b6f9</code></a></td><td><code>#31443: adapt eclib library interface for version v20210310</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/453c793d1f17096695d7ee2cf53d6e0c9c462338"><code>453c793</code></a></td><td><code>#31443: simplify/improve saturation method for elliptic curves over Q</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ba267ac16722b3eee43d2b4ed73840c366a8bec"><code>4ba267a</code></a></td><td><code>#31443: fix two doctest output now that eclib no longer gives incorrect results</code></td></tr></table>




---

archive/issue_comments_504731.json:
```json
{
    "body": "Changed commit from **[`69c3195`](https://github.com/sagemath/sagetrac-mirror/commit/69c3195d7adee86991ae3b9a47081f3222178d18)** to **[`4ba267a`](https://github.com/sagemath/sagetrac-mirror/commit/4ba267ac16722b3eee43d2b4ed73840c366a8bec)**",
    "created_at": "2021-03-16T14:29:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504731",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`69c3195`](https://github.com/sagemath/sagetrac-mirror/commit/69c3195d7adee86991ae3b9a47081f3222178d18)** to **[`4ba267a`](https://github.com/sagemath/sagetrac-mirror/commit/4ba267ac16722b3eee43d2b4ed73840c366a8bec)**



---

archive/issue_events_430266.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-16T14:31:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430266"
}
```



---

archive/issue_events_430267.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-03-16T14:31:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430267"
}
```



---

archive/issue_comments_504732.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI rebased, fixed a merge conflict and two doctest outputs which were there to illustrate how it used to be true that you could get wrong results from eclib by choosing a parameter too small, but now eclib adjusts itself automatically so such an illustration is not possible.",
    "created_at": "2021-03-16T14:31:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504732",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:8" align="right">comment:8</div>

I rebased, fixed a merge conflict and two doctest outputs which were there to illustrate how it used to be true that you could get wrong results from eclib by choosing a parameter too small, but now eclib adjusts itself automatically so such an illustration is not possible.



---

archive/issue_comments_504733.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n`checksums.ini` needs a new field `upstream_url`, as explained in https://wiki.sagemath.org/ReleaseTours/sage-9.1#For_developers-1",
    "created_at": "2021-03-16T17:23:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504733",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

`checksums.ini` needs a new field `upstream_url`, as explained in https://wiki.sagemath.org/ReleaseTours/sage-9.1#For_developers-1



---

archive/issue_comments_504734.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@mkoeppe](#comment%3A9):\n> `checksums.ini` needs a new field `upstream_url`, as explained in https://wiki.sagemath.org/ReleaseTours/sage-9.1#For_developers-1\n\nThanks, I will look at that tomorrow.  I did re-read the packaging instructions to refresh my memory and found some new stuff, but the contents of checksums.ini is whatever was put there by whatever the instructions told me to do.  (I have been updating the eclib package since about 2008...)",
    "created_at": "2021-03-16T17:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504734",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@mkoeppe](#comment%3A9):
> `checksums.ini` needs a new field `upstream_url`, as explained in https://wiki.sagemath.org/ReleaseTours/sage-9.1#For_developers-1

Thanks, I will look at that tomorrow.  I did re-read the packaging instructions to refresh my memory and found some new stuff, but the contents of checksums.ini is whatever was put there by whatever the instructions told me to do.  (I have been updating the eclib package since about 2008...)



---

archive/issue_comments_504735.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\n(The packaging documentation has been updated in #30895 during the 9.3 cycle; it's not in the online copy of the Sage documentation yet.)",
    "created_at": "2021-03-16T18:02:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504735",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

(The packaging documentation has been updated in #30895 during the 9.3 cycle; it's not in the online copy of the Sage documentation yet.)



---

archive/issue_comments_504736.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI added the line (literally)\nupstream_url=https://github.com/JohnCremona/eclib/archive/VERSION.tar.gz\nto build/pkgs/eclib/checksums.ini and then did \n./sage --package fix-checksum eclib\nthough the response was\nChecksum of eclib (tarball eclib-20210310.tar.bz2) unchanged\n\nI'll update the branch in a minute, but I suspect that Sage will not like the fact that the upstream tarball (which is a tar.gz file created by github) is not the same as the tarball I put into upstream/ (and in the link on this ticket) which was created using make dist-bzip2.\n\nIf they need to be identical then I'll replace the actual tarball and then the checksum really will change.\n\nThe developers guide instructions are not at all clear.  For example, I had assumed that one was suppose to replace the string 'VERSION' with the actual version number.  Or is it supposed to be literally the string 'VERSION' which will be replaced by the content of the file package-version.txt?  If that is the case I'll need to make another adjustment.",
    "created_at": "2021-03-17T10:13:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504736",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:12" align="right">comment:12</div>

I added the line (literally)
upstream_url=https://github.com/JohnCremona/eclib/archive/VERSION.tar.gz
to build/pkgs/eclib/checksums.ini and then did 
./sage --package fix-checksum eclib
though the response was
Checksum of eclib (tarball eclib-20210310.tar.bz2) unchanged

I'll update the branch in a minute, but I suspect that Sage will not like the fact that the upstream tarball (which is a tar.gz file created by github) is not the same as the tarball I put into upstream/ (and in the link on this ticket) which was created using make dist-bzip2.

If they need to be identical then I'll replace the actual tarball and then the checksum really will change.

The developers guide instructions are not at all clear.  For example, I had assumed that one was suppose to replace the string 'VERSION' with the actual version number.  Or is it supposed to be literally the string 'VERSION' which will be replaced by the content of the file package-version.txt?  If that is the case I'll need to make another adjustment.



---

archive/issue_comments_504737.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4752618381fc589d3b992d67cd29e9a9c7086d5\"><code>f475261</code></a></td><td><code>added upstream_url to eclib's checksums.ini</code></td></tr></table>\n",
    "created_at": "2021-03-17T10:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504737",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4752618381fc589d3b992d67cd29e9a9c7086d5"><code>f475261</code></a></td><td><code>added upstream_url to eclib's checksums.ini</code></td></tr></table>




---

archive/issue_comments_504738.json:
```json
{
    "body": "Changed commit from **[`4ba267a`](https://github.com/sagemath/sagetrac-mirror/commit/4ba267ac16722b3eee43d2b4ed73840c366a8bec)** to **[`f475261`](https://github.com/sagemath/sagetrac-mirror/commit/f4752618381fc589d3b992d67cd29e9a9c7086d5)**",
    "created_at": "2021-03-17T10:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504738",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4ba267a`](https://github.com/sagemath/sagetrac-mirror/commit/4ba267ac16722b3eee43d2b4ed73840c366a8bec)** to **[`f475261`](https://github.com/sagemath/sagetrac-mirror/commit/f4752618381fc589d3b992d67cd29e9a9c7086d5)**



---

archive/issue_comments_504739.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nNow I also did what I thought I should have done, namely change package-version.txt to be v20210310' (before it did not have the v but github puts the v in as the relevant tag is v20210310), and change the first line of checksum.ini to tarball=eclib-VERSION.tar.gz.  I put an actual download from github of the tarball into upstream/;  since github calls the file just v20210310.tar.gz I added the prefix 'eclib-'.  Then \n\n```\n./sage --package fix-checksum eclib\n```\ndid change the checksums.  I then did \n\n```\n./sage -package update eclib v20210310\n```\nand then\n\n```\n./sage -f eclib\n```\nbut this failed quickly with\n\n```\n[eclib-v20210310] Package 'eclib' is currently not installed\n[eclib-v20210310] No legacy uninstaller found for 'eclib'; nothing to do\n[eclib-v20210310] Deleting old versions of eclib libraries, which\n[eclib-v20210310] would interfere with new builds...\n[eclib-v20210310] Deleting old include directory...\n[eclib-v20210310] --with-flint=/home/john/sage/local\n[eclib-v20210310] Configuring eclib-v20210310\n[eclib-v20210310] /home/john/sage/build/bin/sage-dist-helpers: line 163: ./configure: No such file or directory\n[eclib-v20210310] /home/john/sage/build/bin/sage-dist-helpers: line 165: ./configure: No such file or directory\n[eclib-v20210310] ******************************************************************************************************************************************************\n[eclib-v20210310] Error configuring eclib-v20210310\n```\n\nI know that the recent packaging changes are supposed to make the procedure easier, but it is only easy when you know how and the instructions are clearly not adequately telling *me* what to do.  Help!",
    "created_at": "2021-03-17T10:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504739",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:14" align="right">comment:14</div>

Now I also did what I thought I should have done, namely change package-version.txt to be v20210310' (before it did not have the v but github puts the v in as the relevant tag is v20210310), and change the first line of checksum.ini to tarball=eclib-VERSION.tar.gz.  I put an actual download from github of the tarball into upstream/;  since github calls the file just v20210310.tar.gz I added the prefix 'eclib-'.  Then 

```
./sage --package fix-checksum eclib
```
did change the checksums.  I then did 

```
./sage -package update eclib v20210310
```
and then

```
./sage -f eclib
```
but this failed quickly with

```
[eclib-v20210310] Package 'eclib' is currently not installed
[eclib-v20210310] No legacy uninstaller found for 'eclib'; nothing to do
[eclib-v20210310] Deleting old versions of eclib libraries, which
[eclib-v20210310] would interfere with new builds...
[eclib-v20210310] Deleting old include directory...
[eclib-v20210310] --with-flint=/home/john/sage/local
[eclib-v20210310] Configuring eclib-v20210310
[eclib-v20210310] /home/john/sage/build/bin/sage-dist-helpers: line 163: ./configure: No such file or directory
[eclib-v20210310] /home/john/sage/build/bin/sage-dist-helpers: line 165: ./configure: No such file or directory
[eclib-v20210310] ******************************************************************************************************************************************************
[eclib-v20210310] Error configuring eclib-v20210310
```

I know that the recent packaging changes are supposed to make the procedure easier, but it is only easy when you know how and the instructions are clearly not adequately telling *me* what to do.  Help!



---

archive/issue_comments_504740.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nYou should use a configured tarball (created by `make dist`, typically. It would have `./configure` script then ready), not the raw [GitHub](../wiki/GitHub) tarball, in `upstream_url=` field of `checksums.ini`.\n\nThen `./sage -f` should go through.",
    "created_at": "2021-03-17T11:07:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504740",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">comment:15</div>

You should use a configured tarball (created by `make dist`, typically. It would have `./configure` script then ready), not the raw [GitHub](../wiki/GitHub) tarball, in `upstream_url=` field of `checksums.ini`.

Then `./sage -f` should go through.



---

archive/issue_comments_504741.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nthis patch makes it work:\n\n```diff\n--- a/build/pkgs/eclib/checksums.ini\n+++ b/build/pkgs/eclib/checksums.ini\n@@ -1,5 +1,5 @@\n-tarball=eclib-20210310.tar.bz2\n+tarball=eclib-VERSION.tar.bz2\n sha1=73437ac8deae94f00e7713405b3251d9c81f95e4\n md5=4ac988bc46869866f076f7bea0fdaa6b\n cksum=2130748042\n-upstream_url=https://github.com/JohnCremona/eclib/archive/VERSION.tar.gz\n+upstream_url=https://johncremona.github.io/ftp/eclib-VERSION.tar.bz2\n```\n\n(needless to say, Sage's ./configure must be run with `--enable-download-from-upstream-url` for this tarball-downloading machinery to work)",
    "created_at": "2021-03-17T11:15:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504741",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

this patch makes it work:

```diff
--- a/build/pkgs/eclib/checksums.ini
+++ b/build/pkgs/eclib/checksums.ini
@@ -1,5 +1,5 @@
-tarball=eclib-20210310.tar.bz2
+tarball=eclib-VERSION.tar.bz2
 sha1=73437ac8deae94f00e7713405b3251d9c81f95e4
 md5=4ac988bc46869866f076f7bea0fdaa6b
 cksum=2130748042
-upstream_url=https://github.com/JohnCremona/eclib/archive/VERSION.tar.gz
+upstream_url=https://johncremona.github.io/ftp/eclib-VERSION.tar.bz2
```

(needless to say, Sage's ./configure must be run with `--enable-download-from-upstream-url` for this tarball-downloading machinery to work)



---

archive/issue_comments_504742.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nIs this a non-backward compatible change in Sage's interface to eclib (many distros have versions of eclibs available, and they are used by default).\nIf so, we also need to modify `build/pkgs/eclib/spkg-configure.m4` to take this into account. \n\nA quick fix would be to assume that pkg-config will now work with eclib, simpifying  build/pkgs/eclib/spkg-configure.m4 a lot.",
    "created_at": "2021-03-17T11:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504742",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:17" align="right">comment:17</div>

Is this a non-backward compatible change in Sage's interface to eclib (many distros have versions of eclibs available, and they are used by default).
If so, we also need to modify `build/pkgs/eclib/spkg-configure.m4` to take this into account. 

A quick fix would be to assume that pkg-config will now work with eclib, simpifying  build/pkgs/eclib/spkg-configure.m4 a lot.



---

archive/issue_comments_504743.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI typed a long reply to that which just got zapped before I submitted the changes...\n\nYes, all previous versions of eclib will NOT work after these changes.  So YES, we need to provide a method to check the version.  The current m4 script cannot do that (the function version() it runs dates from before eclib had versin numbers and just displays compilation date and time).  I can easily provide a function to return the version (which autotools defines as the macro VERSION).  Perhaps more helpful would be a function to return the triple of integers (year, month, day), and also a function to compare the current version with a given (y,m,d) triple and return true iff the current version is equal or later than it.   Then the little program constructed and run by the m4 could run (say) compare_eclib_version(2021, 3, 10) which would return true if and only if the actual version was equal or later than this.  How does that sound?\n\nIn any case I can see that today will see a new version released with these functions in it, probably called 'v20210317'.",
    "created_at": "2021-03-17T11:54:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504743",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:18" align="right">comment:18</div>

I typed a long reply to that which just got zapped before I submitted the changes...

Yes, all previous versions of eclib will NOT work after these changes.  So YES, we need to provide a method to check the version.  The current m4 script cannot do that (the function version() it runs dates from before eclib had versin numbers and just displays compilation date and time).  I can easily provide a function to return the version (which autotools defines as the macro VERSION).  Perhaps more helpful would be a function to return the triple of integers (year, month, day), and also a function to compare the current version with a given (y,m,d) triple and return true iff the current version is equal or later than it.   Then the little program constructed and run by the m4 could run (say) compare_eclib_version(2021, 3, 10) which would return true if and only if the actual version was equal or later than this.  How does that sound?

In any case I can see that today will see a new version released with these functions in it, probably called 'v20210317'.



---

archive/issue_comments_504744.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\n`pkg-config` is standard, distros that don't use it consistently have only themselves to blame.\nWith `pkg-config`, it's as simple as with `fplll`, say, see\nhttps://github.com/sagemath/sage/blob/develop/build/pkgs/fplll/spkg-configure.m4\n\nProbably the separate check for `mwrank` should be kept, though. Can you add `--version` and/or `-v` option to `mwrank`, so that `mwrank -v` prints its version (make it equal to \nthe `eclib` version) and exits?\n\nTheoretically, there could be a situation that versions of mwrank and eclib are not the same on the system, so `mwrank -v` will allow to check for this consistency.",
    "created_at": "2021-03-17T12:43:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504744",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">comment:19</div>

`pkg-config` is standard, distros that don't use it consistently have only themselves to blame.
With `pkg-config`, it's as simple as with `fplll`, say, see
https://github.com/sagemath/sage/blob/develop/build/pkgs/fplll/spkg-configure.m4

Probably the separate check for `mwrank` should be kept, though. Can you add `--version` and/or `-v` option to `mwrank`, so that `mwrank -v` prints its version (make it equal to 
the `eclib` version) and exits?

Theoretically, there could be a situation that versions of mwrank and eclib are not the same on the system, so `mwrank -v` will allow to check for this consistency.



---

archive/issue_comments_504745.json:
```json
{
    "body": "Upstream: **Reported upstream. No feedback yet.**",
    "created_at": "2021-03-17T13:46:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504745",
    "user": "https://github.com/dimpase"
}
```

Upstream: **Reported upstream. No feedback yet.**



---

archive/issue_comments_504746.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@dimpase](#comment%3A19):\n\n> \n> Theoretically, there could be a situation that versions of mwrank and eclib are not the same on the system, so `mwrank -v` will allow to check for this consistency.\n\ncopied this suggestion to https://github.com/JohnCremona/eclib/issues/67",
    "created_at": "2021-03-17T13:46:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504746",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@dimpase](#comment%3A19):

> 
> Theoretically, there could be a situation that versions of mwrank and eclib are not the same on the system, so `mwrank -v` will allow to check for this consistency.

copied this suggestion to https://github.com/JohnCremona/eclib/issues/67



---

archive/issue_comments_504747.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThat makes sense -- and I had mentioned this in the posting which disappeared.  But I thought I had done this last time you (Dima) suggested it.\n\nIt makes little sense to talk about mwrank versions as different from eclib versions.  mwrank is just the name of one of the executables built by eclib.  But it does seem reasonable to use `mwrank --version` as a way for a system to tell which eclib version is installed.  That is something different from your pkg-config suggestion though -- and eclib does have a file `eclib.pc`.\n\nNow I will also comment on your eclib issue.",
    "created_at": "2021-03-17T13:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504747",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:21" align="right">comment:21</div>

That makes sense -- and I had mentioned this in the posting which disappeared.  But I thought I had done this last time you (Dima) suggested it.

It makes little sense to talk about mwrank versions as different from eclib versions.  mwrank is just the name of one of the executables built by eclib.  But it does seem reasonable to use `mwrank --version` as a way for a system to tell which eclib version is installed.  That is something different from your pkg-config suggestion though -- and eclib does have a file `eclib.pc`.

Now I will also comment on your eclib issue.



---

archive/issue_comments_504748.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@JohnCremona](#comment%3A21):\n> That makes sense -- and I had mentioned this in the poting which disappeared.  But I thought I had done this last time you (Dima) suggested it.\n> \n> It makes little sense to talk about mwrank versions as different from eclib versions.\n\nSay, one installs `mwrank` using an old eclib in `/usr/local/bin`, and has it shadow the new one `mwrank` in `/usr/bin`. We see such fun not quite bugs creeping up once in a while. \n\nComparing versions of eclib and mwrank is an extra check that won't hurt. `pkg-config` is useful in Python, as there is a Python interface to it (already used in Sage quite a bit\nto simplify the dread of getting the right libraries etc).",
    "created_at": "2021-03-17T14:31:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504748",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@JohnCremona](#comment%3A21):
> That makes sense -- and I had mentioned this in the poting which disappeared.  But I thought I had done this last time you (Dima) suggested it.
> 
> It makes little sense to talk about mwrank versions as different from eclib versions.

Say, one installs `mwrank` using an old eclib in `/usr/local/bin`, and has it shadow the new one `mwrank` in `/usr/bin`. We see such fun not quite bugs creeping up once in a while. 

Comparing versions of eclib and mwrank is an extra check that won't hurt. `pkg-config` is useful in Python, as there is a Python interface to it (already used in Sage quite a bit
to simplify the dread of getting the right libraries etc).



---

archive/issue_comments_504749.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nOK, so my current branch allows `mwrank -V` and outputs (e.g.) v20210317 and exits.  None of my command-line options are multi-character and I am not going to change that now; as I said, '-v' is already taken.\n\nSo now we have pkg-config which reports the version, and also mwrank -V which does too.\n\nAll this still seems to be a lot of unnecessary both to me.  Sage provides an mwrank executable via 'sage -mwrank' purely as a convenience to anyone out there (if there is anyone) who wants to install mwrank, as for such people I can say \"install Sage and you'll get mwrank\".  That has been true for a decade or more, and now I can also say \"use your distro package manager to install eclib, and you'll get mwrank\".  For historical reasons, Sage allows access to the mwrank binary in some of the elliptic curve functions, and also allows %mwrank to get a not very friendly user interface to mwrank (with no prompts).  Both of these are really unnecessary and we could save some hassle by getting rid of them.\n\nThe point of what I am saying is that it matters not at all if anyone has a version of mwrank on their system which is not the same as the one provided by the eclib which Sage is using.  A lot of the sage-eclib interface (including everything relevant to this ticket) is not about mwrank as such.\n\nCan someone now explain to me how to change the m4 file to make use of the pkg-config thing?   I think it would be quite reasonable to insist that the version installed on the system is *exactly* the version specified, not just \"this or any later version\", since I have enough to worry about without having to think about backwards compatibility.  I'm also fairly sure that there is no-one in the world (except me) who installs eclib except as part of Sage anyway.",
    "created_at": "2021-03-17T14:43:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504749",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:23" align="right">comment:23</div>

OK, so my current branch allows `mwrank -V` and outputs (e.g.) v20210317 and exits.  None of my command-line options are multi-character and I am not going to change that now; as I said, '-v' is already taken.

So now we have pkg-config which reports the version, and also mwrank -V which does too.

All this still seems to be a lot of unnecessary both to me.  Sage provides an mwrank executable via 'sage -mwrank' purely as a convenience to anyone out there (if there is anyone) who wants to install mwrank, as for such people I can say "install Sage and you'll get mwrank".  That has been true for a decade or more, and now I can also say "use your distro package manager to install eclib, and you'll get mwrank".  For historical reasons, Sage allows access to the mwrank binary in some of the elliptic curve functions, and also allows %mwrank to get a not very friendly user interface to mwrank (with no prompts).  Both of these are really unnecessary and we could save some hassle by getting rid of them.

The point of what I am saying is that it matters not at all if anyone has a version of mwrank on their system which is not the same as the one provided by the eclib which Sage is using.  A lot of the sage-eclib interface (including everything relevant to this ticket) is not about mwrank as such.

Can someone now explain to me how to change the m4 file to make use of the pkg-config thing?   I think it would be quite reasonable to insist that the version installed on the system is *exactly* the version specified, not just "this or any later version", since I have enough to worry about without having to think about backwards compatibility.  I'm also fairly sure that there is no-one in the world (except me) who installs eclib except as part of Sage anyway.



---

archive/issue_comments_504750.json:
```json
{
    "body": "Changed commit from **[`f475261`](https://github.com/sagemath/sagetrac-mirror/commit/f4752618381fc589d3b992d67cd29e9a9c7086d5)** to **[`1bac713`](https://github.com/sagemath/sagetrac-mirror/commit/1bac7138020240bd3b6944e85bfc28676dcca6f1)**",
    "created_at": "2021-03-17T15:55:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504750",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f475261`](https://github.com/sagemath/sagetrac-mirror/commit/f4752618381fc589d3b992d67cd29e9a9c7086d5)** to **[`1bac713`](https://github.com/sagemath/sagetrac-mirror/commit/1bac7138020240bd3b6944e85bfc28676dcca6f1)**



---

archive/issue_comments_504751.json:
```json
{
    "body": "<div id=\"comment:24\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1bac7138020240bd3b6944e85bfc28676dcca6f1\"><code>1bac713</code></a></td><td><code>more changes to eclib build setup</code></td></tr></table>\n",
    "created_at": "2021-03-17T15:55:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504751",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:24"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1bac7138020240bd3b6944e85bfc28676dcca6f1"><code>1bac713</code></a></td><td><code>more changes to eclib build setup</code></td></tr></table>




---

archive/issue_comments_504752.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210310.tar.bz2](https://johncremona.github.io/ftp/eclib-20210310.tar.bz2)\n+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2](https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2)\n``````\n",
    "created_at": "2021-03-17T15:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504752",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210310.tar.bz2](https://johncremona.github.io/ftp/eclib-20210310.tar.bz2)
+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2](https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2)
``````




---

archive/issue_comments_504753.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nThe latest version + updated tarball for eclib-v20210317 is closer.  For me this works in that I could (re)install eclib using `./sage -f eclib` (I know there is a new way to do that but this worked), where I had put a copy of the updated tarball into upstream so it did no downloading.\n\nI made some changes to the `m4` file, but I have not tested to see if that works, and it does not try to compare the version number with what `mwrank -V` gives out.  I guess that I should at least install this eclib version on my system and then try to configure sage from scratch to see if it likes my system version.  I would be very happy if someone else would like to improve the `m4` file.",
    "created_at": "2021-03-17T15:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504753",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:25" align="right">comment:25</div>

The latest version + updated tarball for eclib-v20210317 is closer.  For me this works in that I could (re)install eclib using `./sage -f eclib` (I know there is a new way to do that but this worked), where I had put a copy of the updated tarball into upstream so it did no downloading.

I made some changes to the `m4` file, but I have not tested to see if that works, and it does not try to compare the version number with what `mwrank -V` gives out.  I guess that I should at least install this eclib version on my system and then try to configure sage from scratch to see if it likes my system version.  I would be very happy if someone else would like to improve the `m4` file.



---

archive/issue_comments_504754.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nI'll look at the m4 file tonight.",
    "created_at": "2021-03-17T18:06:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504754",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:26" align="right">comment:26</div>

I'll look at the m4 file tonight.



---

archive/issue_comments_504755.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThe Sage configure system is mysterious to me.  For example, I have flint-2.7.1 installed but the configure script outputs\n\n```\nflint-2.6.3:                                 no suitable system package; will be installed as an SPKG\n```\nI think it might be the case that as eclib lists ntl, flint and pari as prerequisites, it will build eclib if any of those three are also going to be built.  That is why  I was looking at the output for these.  I was not surprised to see that it wanted to build NTL since my installed NTL was old -- I am now building ntl-11.4.4.  (I am in the habit of installing eclib's dependencies by building from source.)  Similarly with pari.  Sage wants pari-2.11.4.p1 which I assume is 2.11.4 with some patching (why?).  I have a 2.11.3 and 2.12.0.alpha but the last stable release is 2.13.1 so shoule Sage not upgrade?",
    "created_at": "2021-03-18T09:16:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504755",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:27" align="right">comment:27</div>

The Sage configure system is mysterious to me.  For example, I have flint-2.7.1 installed but the configure script outputs

```
flint-2.6.3:                                 no suitable system package; will be installed as an SPKG
```
I think it might be the case that as eclib lists ntl, flint and pari as prerequisites, it will build eclib if any of those three are also going to be built.  That is why  I was looking at the output for these.  I was not surprised to see that it wanted to build NTL since my installed NTL was old -- I am now building ntl-11.4.4.  (I am in the habit of installing eclib's dependencies by building from source.)  Similarly with pari.  Sage wants pari-2.11.4.p1 which I assume is 2.11.4 with some patching (why?).  I have a 2.11.3 and 2.12.0.alpha but the last stable release is 2.13.1 so shoule Sage not upgrade?



---

archive/issue_comments_504756.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@JohnCremona](#comment%3A27):\n> The Sage configure system is mysterious to me.  For example, I have flint-2.7.1 installed but the configure script outputs\n> \n> ```\n> flint-2.6.3:                                 no suitable system package; will be installed as an SPKG\n> ```\n> I think it might be the case that as eclib lists ntl, flint and pari as prerequisites, it will build eclib if any of those three are also going to be built. \n\nthis is correct. Also, Sage is still on flint 2.6.3, see #31069\n\nmore details can be found in the top-level config.log\n\n> That is why  I was looking at the output for these.  I was not surprised to see that it wanted to build NTL since my installed NTL was old -- I am now building ntl-11.4.4.  (I am in the habit of installing eclib's dependencies by building from source.)\n\nYou might be willing to install them in /usr/local, then they will be picked up by \n./configure, and (hopefully) used.\n\n\n>  Similarly with pari.  Sage wants pari-2.11.4.p1 which I assume is 2.11.4 with some patching (why?).  I have a 2.11.3 and 2.12.0.alpha but the last stable release is 2.13.1 so shoule Sage not upgrade?\n\nPari upgrade to 2.13 is not yet done, see #30906 - needs review.\n\nAs to what exactly is amiss in your current Pari, it can be seen in the top-level config log. There were several bugs in Pari 2.11 - were they all fixed in 2.11.4?\nI don't recall right away, there was a problematic Pari 2.12 release, perhaps something from there needed to be backported...",
    "created_at": "2021-03-18T11:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504756",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@JohnCremona](#comment%3A27):
> The Sage configure system is mysterious to me.  For example, I have flint-2.7.1 installed but the configure script outputs
> 
> ```
> flint-2.6.3:                                 no suitable system package; will be installed as an SPKG
> ```
> I think it might be the case that as eclib lists ntl, flint and pari as prerequisites, it will build eclib if any of those three are also going to be built. 

this is correct. Also, Sage is still on flint 2.6.3, see #31069

more details can be found in the top-level config.log

> That is why  I was looking at the output for these.  I was not surprised to see that it wanted to build NTL since my installed NTL was old -- I am now building ntl-11.4.4.  (I am in the habit of installing eclib's dependencies by building from source.)

You might be willing to install them in /usr/local, then they will be picked up by 
./configure, and (hopefully) used.


>  Similarly with pari.  Sage wants pari-2.11.4.p1 which I assume is 2.11.4 with some patching (why?).  I have a 2.11.3 and 2.12.0.alpha but the last stable release is 2.13.1 so shoule Sage not upgrade?

Pari upgrade to 2.13 is not yet done, see #30906 - needs review.

As to what exactly is amiss in your current Pari, it can be seen in the top-level config log. There were several bugs in Pari 2.11 - were they all fixed in 2.11.4?
I don't recall right away, there was a problematic Pari 2.12 release, perhaps something from there needed to be backported...



---

archive/issue_comments_504757.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nThanks for the detailed comments.  I do install stuff in /usr/local, currently I have a problem with FLINT-2.7.2 whose \"make check\" now fails after I upgraded MPIR to 3.0.0 and MPFR to 4.0.0.\n\nI will look at those two tickets, especially the pari one.  Meanwhile I don't mind at all if Sage builds its own eclib, as in any case that will be essential now at least until there are any distros with my current version (which I have not yet tagged or released anyway).",
    "created_at": "2021-03-18T12:17:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504757",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:29" align="right">comment:29</div>

Thanks for the detailed comments.  I do install stuff in /usr/local, currently I have a problem with FLINT-2.7.2 whose "make check" now fails after I upgraded MPIR to 3.0.0 and MPFR to 4.0.0.

I will look at those two tickets, especially the pari one.  Meanwhile I don't mind at all if Sage builds its own eclib, as in any case that will be essential now at least until there are any distros with my current version (which I have not yet tagged or released anyway).



---

archive/issue_comments_504758.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nthe tarball URL is still wrong. (the one in checksums.ini)",
    "created_at": "2021-03-18T12:29:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504758",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:30" align="right">comment:30</div>

the tarball URL is still wrong. (the one in checksums.ini)



---

archive/issue_comments_504759.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nthere is also rubbish in the branch, a file named `t`.",
    "created_at": "2021-03-18T12:30:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504759",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

there is also rubbish in the branch, a file named `t`.



---

archive/issue_comments_504760.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2021-03-18T12:36:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504760",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_504761.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nSorry about that, but at least these are things I can easily fix...done, but trac is not allowing me to push the revised branch.  I also updated the tarball at \u200bhttps://johncremona.github.io/ftp/eclib-v20210317.tar.bz2 (in case you had already downloaded it).",
    "created_at": "2021-03-18T13:50:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504761",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:33" align="right">comment:33</div>

Sorry about that, but at least these are things I can easily fix...done, but trac is not allowing me to push the revised branch.  I also updated the tarball at ​https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2 (in case you had already downloaded it).



---

archive/issue_comments_504762.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nLooking at my config.log, working backwards, I see that it wants to install eclib since it is installing ntl, it wants to install ntl (despite a new version being in /usr/local) because it is installing gmp/mpir, and it is installing gmp because it found no suitable system package, while for mpir it did find my new install and will not try to install that.  But I *do* have gmp installed (libgmp-dev on ubuntu, package version 2:6.2.0+dsfg-4 on ubuntu 20.04).  Dare I suggest that the configure script is incorrectly determining that gmp is not available?",
    "created_at": "2021-03-18T14:22:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504762",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:34" align="right">comment:34</div>

Looking at my config.log, working backwards, I see that it wants to install eclib since it is installing ntl, it wants to install ntl (despite a new version being in /usr/local) because it is installing gmp/mpir, and it is installing gmp because it found no suitable system package, while for mpir it did find my new install and will not try to install that.  But I *do* have gmp installed (libgmp-dev on ubuntu, package version 2:6.2.0+dsfg-4 on ubuntu 20.04).  Dare I suggest that the configure script is incorrectly determining that gmp is not available?



---

archive/issue_comments_504763.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nby the way, why do you prepend `v` to to the version? This is an extra hassle. If it's just a number, or something like a.b.c, with a, b, c nonneg. integers, it's more stanard.",
    "created_at": "2021-03-18T14:23:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504763",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:35" align="right">comment:35</div>

by the way, why do you prepend `v` to to the version? This is an extra hassle. If it's just a number, or something like a.b.c, with a, b, c nonneg. integers, it's more stanard.



---

archive/issue_comments_504764.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@JohnCremona](#comment%3A34):\n> Looking at my config.log, working backwards, I see that it wants to install eclib since it is installing ntl, it wants to install ntl (despite a new version being in /usr/local) because it is installing gmp/mpir, and it is installing gmp because it found no suitable system package, while for mpir it did find my new install and will not try to install that.  But I *do* have gmp installed (libgmp-dev on ubuntu, package version 2:6.2.0+dsfg-4 on ubuntu 20.04).  Dare I suggest that the configure script is incorrectly determining that gmp is not available?\n\nHmm, if you already have mpir/gmp installed in your Sage install, then ./configure will assume you want to keep it (and thus everything that depends upon it will be built).\n\n```\nmake gmp-clean mpir-clean \n```\nshould clean these up, so that the system GMP is picked up by ./configure",
    "created_at": "2021-03-18T14:25:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504764",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@JohnCremona](#comment%3A34):
> Looking at my config.log, working backwards, I see that it wants to install eclib since it is installing ntl, it wants to install ntl (despite a new version being in /usr/local) because it is installing gmp/mpir, and it is installing gmp because it found no suitable system package, while for mpir it did find my new install and will not try to install that.  But I *do* have gmp installed (libgmp-dev on ubuntu, package version 2:6.2.0+dsfg-4 on ubuntu 20.04).  Dare I suggest that the configure script is incorrectly determining that gmp is not available?

Hmm, if you already have mpir/gmp installed in your Sage install, then ./configure will assume you want to keep it (and thus everything that depends upon it will be built).

```
make gmp-clean mpir-clean 
```
should clean these up, so that the system GMP is picked up by ./configure



---

archive/issue_comments_504765.json:
```json
{
    "body": "Changed branch from **[u/cremona/31443-eclib-saturation](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/31443-eclib-saturation)** to **[public/packages/eclib/31443](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/eclib/31443)**",
    "created_at": "2021-03-18T14:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504765",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/cremona/31443-eclib-saturation](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/31443-eclib-saturation)** to **[public/packages/eclib/31443](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/eclib/31443)**



---

archive/issue_comments_504766.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nhere are my updates, with fixed m4 etc.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/573bcf604b3ab69d19716b47627f3b378b0c081f\"><code>573bcf6</code></a></td><td><code>fix m4 and tar URL, remove junk</code></td></tr></table>\n",
    "created_at": "2021-03-18T14:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504766",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:37" align="right">comment:37</div>

here are my updates, with fixed m4 etc.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/573bcf604b3ab69d19716b47627f3b378b0c081f"><code>573bcf6</code></a></td><td><code>fix m4 and tar URL, remove junk</code></td></tr></table>




---

archive/issue_comments_504767.json:
```json
{
    "body": "Changed commit from **[`1bac713`](https://github.com/sagemath/sagetrac-mirror/commit/1bac7138020240bd3b6944e85bfc28676dcca6f1)** to **[`573bcf6`](https://github.com/sagemath/sagetrac-mirror/commit/573bcf604b3ab69d19716b47627f3b378b0c081f)**",
    "created_at": "2021-03-18T14:34:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504767",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`1bac713`](https://github.com/sagemath/sagetrac-mirror/commit/1bac7138020240bd3b6944e85bfc28676dcca6f1)** to **[`573bcf6`](https://github.com/sagemath/sagetrac-mirror/commit/573bcf604b3ab69d19716b47627f3b378b0c081f)**



---

archive/issue_comments_504768.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nI guess if the tarfile has changed then the checksums should be updated too.",
    "created_at": "2021-03-18T14:35:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504768",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:38" align="right">comment:38</div>

I guess if the tarfile has changed then the checksums should be updated too.



---

archive/issue_comments_504769.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nI have nbot yet managed to push my branch, but I'll try again only after merging your fix for the mp4.\n\nMy version numbers did not use to have the v in them, I added that yesterday for some reason.  I will revert that -- I think it was because my tag did have the v, so th tarball github creates has the v, an I thought I would be linking to that -- but we are not.  This will require a fresh tarball, but that will not take long.\n\nThe configure tests I have been running are on a fresh download from trac, not an existing build, so *nothing* has been built in it yet!  eclib itself detects gmp, and when I run ldd on my latest version of the shared libec library I see\n\n```\nlibgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007f23ee737000)\n```\nso I don't know why Sage's configure does not find it.  I do build mpir in its gmp-compat mode, so as well as the system library as above, in /usr/local/lib I have both libmpir and libgmp both installed when I do 'make install' on mpir.",
    "created_at": "2021-03-18T14:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504769",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:39" align="right">comment:39</div>

I have nbot yet managed to push my branch, but I'll try again only after merging your fix for the mp4.

My version numbers did not use to have the v in them, I added that yesterday for some reason.  I will revert that -- I think it was because my tag did have the v, so th tarball github creates has the v, an I thought I would be linking to that -- but we are not.  This will require a fresh tarball, but that will not take long.

The configure tests I have been running are on a fresh download from trac, not an existing build, so *nothing* has been built in it yet!  eclib itself detects gmp, and when I run ldd on my latest version of the shared libec library I see

```
libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007f23ee737000)
```
so I don't know why Sage's configure does not find it.  I do build mpir in its gmp-compat mode, so as well as the system library as above, in /usr/local/lib I have both libmpir and libgmp both installed when I do 'make install' on mpir.



---

archive/issue_comments_504770.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nMaybe `./configure --with-mp=gmp` can help?",
    "created_at": "2021-03-18T15:00:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504770",
    "user": "https://github.com/slel"
}
```

<div id="comment:40" align="right">comment:40</div>

Maybe `./configure --with-mp=gmp` can help?



---

archive/issue_comments_504771.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2](https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2)\n+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210318.tar.bz2](https://johncremona.github.io/ftp/eclib-20210318.tar.bz2)\n``````\n",
    "created_at": "2021-03-18T15:36:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504771",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2](https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2)
+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210318.tar.bz2](https://johncremona.github.io/ftp/eclib-20210318.tar.bz2)
``````




---

archive/issue_comments_504772.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210318.tar.bz2](https://johncremona.github.io/ftp/eclib-20210318.tar.bz2)\n+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2](https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2)\n``````\n",
    "created_at": "2021-03-18T15:39:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504772",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210318.tar.bz2](https://johncremona.github.io/ftp/eclib-20210318.tar.bz2)
+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2](https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2)
``````




---

archive/issue_comments_504773.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@JohnCremona](#comment%3A39):\n  eclib itself detects gmp, and when I run ldd on my latest version of the shared libec library I see\n> \n> ```\n> libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007f23ee737000)\n> ```\n> so I don't know why Sage's configure does not find it.  I do build mpir in its gmp-compat mode, so as well as the system library as above, in /usr/local/lib I have both libmpir and libgmp both installed when I do 'make install' on mpir.\n\nSage most probably finds mpir in /usr/local first, and then rejects it for some reason.\nPlease post top-level config.log\n(This is a configuration noone tried since few years, I guess. MPIR is semi-abandoned,\nI don't know why we have not downgraded it to experimental yet)",
    "created_at": "2021-03-18T15:39:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504773",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@JohnCremona](#comment%3A39):
  eclib itself detects gmp, and when I run ldd on my latest version of the shared libec library I see
> 
> ```
> libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007f23ee737000)
> ```
> so I don't know why Sage's configure does not find it.  I do build mpir in its gmp-compat mode, so as well as the system library as above, in /usr/local/lib I have both libmpir and libgmp both installed when I do 'make install' on mpir.

Sage most probably finds mpir in /usr/local first, and then rejects it for some reason.
Please post top-level config.log
(This is a configuration noone tried since few years, I guess. MPIR is semi-abandoned,
I don't know why we have not downgraded it to experimental yet)



---

archive/issue_comments_504774.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI wil try that configure suggestion, thanks.\n\nMeanwhile I have updated the branch with yet another version of the tarball, checksums etc, 20210318 (no v) but for some reason I cannot now push to trac, either to u/cremona/31443-eclib-saturation (by old branch) or public/packages/eclib/31443.  In both cases I see\n\n```\nfatal: remote error: access denied or repository not exported: /sage.git\n```\nI have changed nothing with my ssh setup (no new keys, etc).  Suggestions?",
    "created_at": "2021-03-18T15:39:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504774",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:43" align="right">comment:43</div>

I wil try that configure suggestion, thanks.

Meanwhile I have updated the branch with yet another version of the tarball, checksums etc, 20210318 (no v) but for some reason I cannot now push to trac, either to u/cremona/31443-eclib-saturation (by old branch) or public/packages/eclib/31443.  In both cases I see

```
fatal: remote error: access denied or repository not exported: /sage.git
```
I have changed nothing with my ssh setup (no new keys, etc).  Suggestions?



---

archive/issue_comments_504775.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2](https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2)\n+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210318.tar.bz2](https://johncremona.github.io/ftp/eclib-20210318.tar.bz2)\n``````\n",
    "created_at": "2021-03-18T15:39:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504775",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2](https://johncremona.github.io/ftp/eclib-v20210317.tar.bz2)
+New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210318.tar.bz2](https://johncremona.github.io/ftp/eclib-20210318.tar.bz2)
``````




---

archive/issue_comments_504776.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@dimpase](#comment%3A42):\n> Replying to [@JohnCremona](#comment%3A39):\n>   eclib itself detects gmp, and when I run ldd on my latest version of the shared libec library I see\n> > \n> > ```\n> > libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007f23ee737000)\n> > ```\n> > so I don't know why Sage's configure does not find it.  I do build mpir in its gmp-compat mode, so as well as the system library as above, in /usr/local/lib I have both libmpir and libgmp both installed when I do 'make install' on mpir.\n\n> \n> Sage most probably finds mpir in /usr/local first, and then rejects it for some reason.\n> Please post top-level config.log\n> (This is a configuration noone tried since few years, I guess. MPIR is semi-abandoned,\n> I don't know why we have not downgraded it to experimental yet)\n> \n\nI am not tied at all to MPIR, I started using it when Bill Hart was in Warwick.  But it will simplify m life a bit to just use ordinary gmp, so I will uninstall mpir and hope that this will fix things.",
    "created_at": "2021-03-18T15:41:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504776",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@dimpase](#comment%3A42):
> Replying to [@JohnCremona](#comment%3A39):
>   eclib itself detects gmp, and when I run ldd on my latest version of the shared libec library I see
> > 
> > ```
> > libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007f23ee737000)
> > ```
> > so I don't know why Sage's configure does not find it.  I do build mpir in its gmp-compat mode, so as well as the system library as above, in /usr/local/lib I have both libmpir and libgmp both installed when I do 'make install' on mpir.

> 
> Sage most probably finds mpir in /usr/local first, and then rejects it for some reason.
> Please post top-level config.log
> (This is a configuration noone tried since few years, I guess. MPIR is semi-abandoned,
> I don't know why we have not downgraded it to experimental yet)
> 

I am not tied at all to MPIR, I started using it when Bill Hart was in Warwick.  But it will simplify m life a bit to just use ordinary gmp, so I will uninstall mpir and hope that this will fix things.



---

archive/issue_comments_504777.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\ndo you by any chance use `git trac` extension?",
    "created_at": "2021-03-18T15:49:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504777",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:45" align="right">comment:45</div>

do you by any chance use `git trac` extension?



---

archive/issue_comments_504778.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@dimpase](#comment%3A45):\n> do you by any chance use `git trac` extension?\n\nNo",
    "created_at": "2021-03-18T15:52:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504778",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@dimpase](#comment%3A45):
> do you by any chance use `git trac` extension?

No



---

archive/issue_comments_504779.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nwhat do you get if you run `ssh git@trac.sagemath.org` ?\nYou'd see something like \n\n```\nhello <username>, this is git@trac running gitolite3 3.5.3.1-2 (Debian) on git 1.9.1\n\n R W\tsage\nConnection to trac.sagemath.org closed.\n```",
    "created_at": "2021-03-18T15:58:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504779",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:47" align="right">comment:47</div>

what do you get if you run `ssh git@trac.sagemath.org` ?
You'd see something like 

```
hello <username>, this is git@trac running gitolite3 3.5.3.1-2 (Debian) on git 1.9.1

 R W	sage
Connection to trac.sagemath.org closed.
```



---

archive/issue_comments_504780.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@dimpase](#comment%3A47):\n> what do you get if you run `ssh git@trac.sagemath.org` ?\n> You'd see something like \n> \n> ```\n> hello <username>, this is git@trac running gitolite3 3.5.3.1-2 (Debian) on git 1.9.1\n> \n>  R W\tsage\n> Connection to trac.sagemath.org closed.\n> ```\n\nI get this:\n\n```\n$ ssh git@trac.sagemath.org\nX11 forwarding request failed on channel 0\nPTY allocation request failed on channel 0\nhello cremona, this is git@trac running gitolite3 3.5.3.1-2 (Debian) on git 1.9.1\n\n R W\tsage\nConnection to trac.sagemath.org closed.\n```\nwhich looks OK to me.",
    "created_at": "2021-03-18T16:10:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504780",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@dimpase](#comment%3A47):
> what do you get if you run `ssh git@trac.sagemath.org` ?
> You'd see something like 
> 
> ```
> hello <username>, this is git@trac running gitolite3 3.5.3.1-2 (Debian) on git 1.9.1
> 
>  R W	sage
> Connection to trac.sagemath.org closed.
> ```

I get this:

```
$ ssh git@trac.sagemath.org
X11 forwarding request failed on channel 0
PTY allocation request failed on channel 0
hello cremona, this is git@trac running gitolite3 3.5.3.1-2 (Debian) on git 1.9.1

 R W	sage
Connection to trac.sagemath.org closed.
```
which looks OK to me.



---

archive/issue_comments_504781.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nWhen I uninstalled MPIR I managed to so seriously break my system that gcc did not work.  I even reinstalled ubuntu's gmp and gcc but they still did not work.  So I reinstalled MPIR, which puts libgmp files (as well as libmpir files) into /usr/local, and now gcc works.  Bizarre.",
    "created_at": "2021-03-18T16:20:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504781",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:49" align="right">comment:49</div>

When I uninstalled MPIR I managed to so seriously break my system that gcc did not work.  I even reinstalled ubuntu's gmp and gcc but they still did not work.  So I reinstalled MPIR, which puts libgmp files (as well as libmpir files) into /usr/local, and now gcc works.  Bizarre.



---

archive/issue_comments_504782.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nWhat does `git remote -v` say for this repo?",
    "created_at": "2021-03-18T16:29:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504782",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:50" align="right">comment:50</div>

What does `git remote -v` say for this repo?



---

archive/issue_comments_504783.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@JohnCremona](#comment%3A49):\n> When I uninstalled MPIR I managed to so seriously break my system that gcc did not work.  I even reinstalled ubuntu's gmp and gcc but they still did not work.  So I reinstalled MPIR, which puts libgmp files (as well as libmpir files) into /usr/local, and now gcc works.  Bizarre.\n\ngmp is a build dependency of gcc, so not too bizzare. \n\nHowever, system packages should not depend on anything in /usr/local, so perhaps something was not properly flushed...",
    "created_at": "2021-03-18T16:37:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504783",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@JohnCremona](#comment%3A49):
> When I uninstalled MPIR I managed to so seriously break my system that gcc did not work.  I even reinstalled ubuntu's gmp and gcc but they still did not work.  So I reinstalled MPIR, which puts libgmp files (as well as libmpir files) into /usr/local, and now gcc works.  Bizarre.

gmp is a build dependency of gcc, so not too bizzare. 

However, system packages should not depend on anything in /usr/local, so perhaps something was not properly flushed...



---

archive/issue_comments_504784.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nReplying to [@dimpase](#comment%3A50):\n> What does `git remote -v` say for this repo?\n\n\n```\n$ git remote -v\ntrac\tgit://trac.sagemath.org/sage.git (fetch)\ntrac\tgit://trac.sagemath.org/sage.git (push)\n```\nThis is a repo I downloaded yesterday, have made some changes to (in build/ and whatever else the branch on this ticket touches such as src/libs/eclib) but have never actually built, only run ./bootstrap and ./configure.\n\n./configure *does* now report that it can use the system gmp -- this is only true after rerunning ./bootstrap *and* adding --with-mp=pir on the configure command line.  That is progress.  But it still does not like my NTL.  Here's a bit of config.log:\n\n```\n## ----------------------------------------------------- ##\n## Checking whether SageMath should install SPKG mpir... ##\n## ----------------------------------------------------- ##\nconfigure:10351: no suitable system package found for SPKG mpir\nconfigure:10371: result: using mpir SPKG (via --with-mp=mpir)\n## ---------------------------------------------------- ##\n## Checking whether SageMath should install SPKG gmp... ##\n## ---------------------------------------------------- ##\nconfigure:10526: will use system package and not install SPKG gmp\n## ----------------------------------------------------- ##\n## Checking whether SageMath should install SPKG mpfr... ##\n## ----------------------------------------------------- ##\nconfigure:10624: checking installing gmp/mpir? \nconfigure:10627: result: yes; install mpfr as well\nconfigure:10715: no suitable system package found for SPKG mpfr\nconfigure:10733: result: using Sage's mpfr SPKG\n## ---------------------------------------------------- ##\n## Checking whether SageMath should install SPKG ntl... ##\n## ---------------------------------------------------- ##\nconfigure:10814: checking installing gmp/mpir? \nconfigure:10817: result: yes; install ntl as well\nconfigure:10929: no suitable system package found for SPKG ntl\n## ------------------------------------------------------ ##\n## Checking whether SageMath should install SPKG flint... ##\n## ------------------------------------------------------ ##\nconfigure:11136: checking installing mpfr or ntl? \nconfigure:11139: result: yes; install flint as well\nconfigure:11324: no suitable system package found for SPKG flint\nconfigure:11342: result: using Sage's flint SPKG\n## ---------------------------------------------------- ##\n## Checking whether SageMath should install SPKG arb... ##\n## ---------------------------------------------------- ##\nconfigure:11424: checking installing flint? \nconfigure:11427: result: yes; install arb as well\nconfigure:11544: no suitable system package found for SPKG arb\n```\n\nThis is so inconsistent!",
    "created_at": "2021-03-18T16:37:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504784",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:52" align="right">comment:52</div>

Replying to [@dimpase](#comment%3A50):
> What does `git remote -v` say for this repo?


```
$ git remote -v
trac	git://trac.sagemath.org/sage.git (fetch)
trac	git://trac.sagemath.org/sage.git (push)
```
This is a repo I downloaded yesterday, have made some changes to (in build/ and whatever else the branch on this ticket touches such as src/libs/eclib) but have never actually built, only run ./bootstrap and ./configure.

./configure *does* now report that it can use the system gmp -- this is only true after rerunning ./bootstrap *and* adding --with-mp=pir on the configure command line.  That is progress.  But it still does not like my NTL.  Here's a bit of config.log:

```
## ----------------------------------------------------- ##
## Checking whether SageMath should install SPKG mpir... ##
## ----------------------------------------------------- ##
configure:10351: no suitable system package found for SPKG mpir
configure:10371: result: using mpir SPKG (via --with-mp=mpir)
## ---------------------------------------------------- ##
## Checking whether SageMath should install SPKG gmp... ##
## ---------------------------------------------------- ##
configure:10526: will use system package and not install SPKG gmp
## ----------------------------------------------------- ##
## Checking whether SageMath should install SPKG mpfr... ##
## ----------------------------------------------------- ##
configure:10624: checking installing gmp/mpir? 
configure:10627: result: yes; install mpfr as well
configure:10715: no suitable system package found for SPKG mpfr
configure:10733: result: using Sage's mpfr SPKG
## ---------------------------------------------------- ##
## Checking whether SageMath should install SPKG ntl... ##
## ---------------------------------------------------- ##
configure:10814: checking installing gmp/mpir? 
configure:10817: result: yes; install ntl as well
configure:10929: no suitable system package found for SPKG ntl
## ------------------------------------------------------ ##
## Checking whether SageMath should install SPKG flint... ##
## ------------------------------------------------------ ##
configure:11136: checking installing mpfr or ntl? 
configure:11139: result: yes; install flint as well
configure:11324: no suitable system package found for SPKG flint
configure:11342: result: using Sage's flint SPKG
## ---------------------------------------------------- ##
## Checking whether SageMath should install SPKG arb... ##
## ---------------------------------------------------- ##
configure:11424: checking installing flint? 
configure:11427: result: yes; install arb as well
configure:11544: no suitable system package found for SPKG arb
```

This is so inconsistent!



---

archive/issue_comments_504785.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@dimpase](#comment%3A51):\n> Replying to [@JohnCremona](#comment%3A49):\n> > When I uninstalled MPIR I managed to so seriously break my system that gcc did not work.  I even reinstalled ubuntu's gmp and gcc but they still did not work.  So I reinstalled MPIR, which puts libgmp files (as well as libmpir files) into /usr/local, and now gcc works.  Bizarre.\n\n> \n> gmp is a build dependency of gcc, so not too bizzare. \n\nI think it *is* bizarre since I reinstalled the system gmp and gcc and after that gcc did not work, while after reinstalling my own mpir build gcc does work.\n\n> \n> However, system packages should not depend on anything in /usr/local, so perhaps something was not properly flushed...\n> \n\nI don't know exactly what that means or how to fix it.\n\nThe only reason I am in this  mess is that I was trying to improve Sage for Sage users by improving eclib (no-one else uses it).  I have now spent several days on all this package installation nonsense, which used to be very simple but is now in some in-between state where things only half work.  And now I cannot even push my branch to trac for some other stupid reason.  I did push it to my github fork https://github.com/JohnCremona/sage/tree/31443-eclib-saturation\n\nbut I have had enough of all this.  I may come back to it next week, but I have others things to do.",
    "created_at": "2021-03-18T16:47:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504785",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@dimpase](#comment%3A51):
> Replying to [@JohnCremona](#comment%3A49):
> > When I uninstalled MPIR I managed to so seriously break my system that gcc did not work.  I even reinstalled ubuntu's gmp and gcc but they still did not work.  So I reinstalled MPIR, which puts libgmp files (as well as libmpir files) into /usr/local, and now gcc works.  Bizarre.

> 
> gmp is a build dependency of gcc, so not too bizzare. 

I think it *is* bizarre since I reinstalled the system gmp and gcc and after that gcc did not work, while after reinstalling my own mpir build gcc does work.

> 
> However, system packages should not depend on anything in /usr/local, so perhaps something was not properly flushed...
> 

I don't know exactly what that means or how to fix it.

The only reason I am in this  mess is that I was trying to improve Sage for Sage users by improving eclib (no-one else uses it).  I have now spent several days on all this package installation nonsense, which used to be very simple but is now in some in-between state where things only half work.  And now I cannot even push my branch to trac for some other stupid reason.  I did push it to my github fork https://github.com/JohnCremona/sage/tree/31443-eclib-saturation

but I have had enough of all this.  I may come back to it next week, but I have others things to do.



---

archive/issue_comments_504786.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@JohnCremona](#comment%3A52):\n> Replying to [@dimpase](#comment%3A50):\n> > What does `git remote -v` say for this repo?\n\n> \n> ```\n> $ git remote -v\n> trac\tgit://trac.sagemath.org/sage.git (fetch)\n> trac\tgit://trac.sagemath.org/sage.git (push)\n> ```\n\nremove these `git://` things - you are not using `ssh` while pushing to a `git://` URL. `git://` is a \"native\" git protocol that does authentication via a password, I have no idea how you actually managed to push from this machine earlier. That is, run \n\n```\ngit remote rm trac\ngit remote add trac git@trac.sagemath.org:sage.git\n```\n\n\n>I think it *is* bizarre since I reinstalled the system gmp and gcc and after that gcc did not work, while after reinstalling my own mpir build gcc does work.\n\n>> However, system packages should not depend on anything in /usr/local, so perhaps  something was not properly flushed...\n\n> I don't know exactly what that means or how to fix it.\n\nI don't know either, I've never seen this before --- I only know that your gcc toolchain is messed up (and this doesn't have much to do with Sage). It might be as simple as looging out and back in, or perhaps a reboot, bit it really no Sage's fault.\n\n> And now I cannot even push my branch to trac for some other stupid reason.\n\nwhich this is not Sage's fault (other that Sage messes up with MPIR for far too long :-)).\n\n\nI think your packages is in a good shape, I will finish up the branch and put it up for review.",
    "created_at": "2021-03-18T18:55:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504786",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@JohnCremona](#comment%3A52):
> Replying to [@dimpase](#comment%3A50):
> > What does `git remote -v` say for this repo?

> 
> ```
> $ git remote -v
> trac	git://trac.sagemath.org/sage.git (fetch)
> trac	git://trac.sagemath.org/sage.git (push)
> ```

remove these `git://` things - you are not using `ssh` while pushing to a `git://` URL. `git://` is a "native" git protocol that does authentication via a password, I have no idea how you actually managed to push from this machine earlier. That is, run 

```
git remote rm trac
git remote add trac git@trac.sagemath.org:sage.git
```


>I think it *is* bizarre since I reinstalled the system gmp and gcc and after that gcc did not work, while after reinstalling my own mpir build gcc does work.

>> However, system packages should not depend on anything in /usr/local, so perhaps  something was not properly flushed...

> I don't know exactly what that means or how to fix it.

I don't know either, I've never seen this before --- I only know that your gcc toolchain is messed up (and this doesn't have much to do with Sage). It might be as simple as looging out and back in, or perhaps a reboot, bit it really no Sage's fault.

> And now I cannot even push my branch to trac for some other stupid reason.

which this is not Sage's fault (other that Sage messes up with MPIR for far too long :-)).


I think your packages is in a good shape, I will finish up the branch and put it up for review.



---

archive/issue_comments_504787.json:
```json
{
    "body": "Changed commit from **[`573bcf6`](https://github.com/sagemath/sagetrac-mirror/commit/573bcf604b3ab69d19716b47627f3b378b0c081f)** to **[`926670f`](https://github.com/sagemath/sagetrac-mirror/commit/926670fc33cc68d86bf002db4acb45c63f4df9ef)**",
    "created_at": "2021-03-18T22:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504787",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`573bcf6`](https://github.com/sagemath/sagetrac-mirror/commit/573bcf604b3ab69d19716b47627f3b378b0c081f)** to **[`926670f`](https://github.com/sagemath/sagetrac-mirror/commit/926670fc33cc68d86bf002db4acb45c63f4df9ef)**



---

archive/issue_comments_504788.json:
```json
{
    "body": "<div id=\"comment:55\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7db4910ebff9e37ccbdadebf0a4e365e064d0c3a\"><code>7db4910</code></a></td><td><code>remove dud empty file</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/28408fc22d9d9525460e74492f9193e54a20bb15\"><code>28408fc</code></a></td><td><code>correct upstream_url for eclib</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d32295ffeab20af1781b903fad1139c50527d94d\"><code>d32295f</code></a></td><td><code>fix spkg-configure for eclib</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5a90432220bf69426b4f5c82562891292b07a1b2\"><code>5a90432</code></a></td><td><code>updated eclib build files to 20210318</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/926670fc33cc68d86bf002db4acb45c63f4df9ef\"><code>926670f</code></a></td><td><code>Merge remote-tracking branch 'jc/31443-eclib-saturation' into public/packages/eclib/31443</code></td></tr></table>\n",
    "created_at": "2021-03-18T22:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504788",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:55"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7db4910ebff9e37ccbdadebf0a4e365e064d0c3a"><code>7db4910</code></a></td><td><code>remove dud empty file</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/28408fc22d9d9525460e74492f9193e54a20bb15"><code>28408fc</code></a></td><td><code>correct upstream_url for eclib</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d32295ffeab20af1781b903fad1139c50527d94d"><code>d32295f</code></a></td><td><code>fix spkg-configure for eclib</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5a90432220bf69426b4f5c82562891292b07a1b2"><code>5a90432</code></a></td><td><code>updated eclib build files to 20210318</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/926670fc33cc68d86bf002db4acb45c63f4df9ef"><code>926670f</code></a></td><td><code>Merge remote-tracking branch 'jc/31443-eclib-saturation' into public/packages/eclib/31443</code></td></tr></table>




---

archive/issue_comments_504789.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nThanks to everyone for their patience.  I have no idea how I got the trac remote set up so weirdly on this new clone.  On my main sage clone it looked like \n\n```\ntrac\tgit://trac.sagemath.org/sage.git (fetch)\ntrac\tgit@trac.sagemath.org:sage.git (push)\n```\nwhich had been working, apparantly, but I have now sorted that one out too.  So I could finally push my branch to u/cremona/31443-eclib-saturation though that was  made reduandant thanks to Dima's help.",
    "created_at": "2021-03-19T09:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504789",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:56" align="right">comment:56</div>

Thanks to everyone for their patience.  I have no idea how I got the trac remote set up so weirdly on this new clone.  On my main sage clone it looked like 

```
trac	git://trac.sagemath.org/sage.git (fetch)
trac	git@trac.sagemath.org:sage.git (push)
```
which had been working, apparantly, but I have now sorted that one out too.  So I could finally push my branch to u/cremona/31443-eclib-saturation though that was  made reduandant thanks to Dima's help.



---

archive/issue_comments_504790.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@JohnCremona](#comment%3A56):\n> Thanks to everyone for their patience.  I have no idea how I got the trac remote set up so weirdly on this new clone.  On my main sage clone it looked like \n> \n> ```\n> trac\tgit://trac.sagemath.org/sage.git (fetch)\n> trac\tgit@trac.sagemath.org:sage.git (push)\n> ```\n> which had been working, \n\nthis is fine - git:// works for fetch, this does not need authentication,\nand the push url is OK here, it is an ssh one.\n\ngit:// sometimes does not work through firewalls (if they are not too well set up)",
    "created_at": "2021-03-19T09:25:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504790",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@JohnCremona](#comment%3A56):
> Thanks to everyone for their patience.  I have no idea how I got the trac remote set up so weirdly on this new clone.  On my main sage clone it looked like 
> 
> ```
> trac	git://trac.sagemath.org/sage.git (fetch)
> trac	git@trac.sagemath.org:sage.git (push)
> ```
> which had been working, 

this is fine - git:// works for fetch, this does not need authentication,
and the push url is OK here, it is an ssh one.

git:// sometimes does not work through firewalls (if they are not too well set up)



---

archive/issue_comments_504791.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2021-03-19T10:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504791",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_504792.json:
```json
{
    "body": "Changed author from **John Cremona** to **John Cremona, Dima Pasechnik**",
    "created_at": "2021-03-19T10:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504792",
    "user": "https://github.com/dimpase"
}
```

Changed author from **John Cremona** to **John Cremona, Dima Pasechnik**



---

archive/issue_comments_504793.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nthis looks good,perhaps someone who knowns autoconf can review my changes to spkg-configure.m4",
    "created_at": "2021-03-19T10:15:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504793",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:58" align="right">comment:58</div>

this looks good,perhaps someone who knowns autoconf can review my changes to spkg-configure.m4



---

archive/issue_comments_504794.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@JohnCremona](#comment%3A23):\n> I think it would be quite reasonable to insist that the version installed on the system is *exactly* the version specified, not just \"this or any later version\", since I have enough to worry about without having to think about backwards compatibility.  I'm also fairly sure that there is no-one in the world (except me) who installs eclib except as part of Sage anyway.\n\nThere is also a possible middle ground - you could set an upper bound as well such as `<= 20231231`. \n\nDoes the new version of `eclib` work with old version of Sage?\n\nDownstream distributors of sage could perhaps comment whether fixing the eclib version creates additional burden for them.",
    "created_at": "2021-03-19T17:13:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504794",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@JohnCremona](#comment%3A23):
> I think it would be quite reasonable to insist that the version installed on the system is *exactly* the version specified, not just "this or any later version", since I have enough to worry about without having to think about backwards compatibility.  I'm also fairly sure that there is no-one in the world (except me) who installs eclib except as part of Sage anyway.

There is also a possible middle ground - you could set an upper bound as well such as `<= 20231231`. 

Does the new version of `eclib` work with old version of Sage?

Downstream distributors of sage could perhaps comment whether fixing the eclib version creates additional burden for them.



---

archive/issue_comments_504795.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@mkoeppe](#comment%3A59):\n\n> Downstream distributors of sage could perhaps comment whether fixing the eclib version creates additional burden for them.\n\nI don't use sage's build system, so personally I don't care which eclib version the m4 file expects. I always make sure that the versions of eclib and sagelib in our repos are compatible.",
    "created_at": "2021-03-19T17:32:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504795",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@mkoeppe](#comment%3A59):

> Downstream distributors of sage could perhaps comment whether fixing the eclib version creates additional burden for them.

I don't use sage's build system, so personally I don't care which eclib version the m4 file expects. I always make sure that the versions of eclib and sagelib in our repos are compatible.



---

archive/issue_comments_504796.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nNo, the new version of eclib will not work with older sages: the sage code changes here in the eclib interface are necesary.\n\nI just push a tag '20210318' to eclib on github and will make a release with the same name.\n\nFrom what I have been discovering about dependencies in Sage's own build system, since Sage has a patched version of pari it will always build any package with pari as a dependency.  But eclib works fine with the latest stable release of pari (2.11.2) so I don't think that distro package managers will be bothered: they can upgrade their eclib to 20210318 at the same time as upgrading sage to 9.3, assuming that this ticket is merged into 9.3.",
    "created_at": "2021-03-19T17:53:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504796",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:61" align="right">comment:61</div>

No, the new version of eclib will not work with older sages: the sage code changes here in the eclib interface are necesary.

I just push a tag '20210318' to eclib on github and will make a release with the same name.

From what I have been discovering about dependencies in Sage's own build system, since Sage has a patched version of pari it will always build any package with pari as a dependency.  But eclib works fine with the latest stable release of pari (2.11.2) so I don't think that distro package managers will be bothered: they can upgrade their eclib to 20210318 at the same time as upgrading sage to 9.3, assuming that this ticket is merged into 9.3.



---

archive/issue_comments_504797.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nI can pin a version for sage-9.2 and a different one for beta and future 9.3 in Gentoo.",
    "created_at": "2021-03-19T20:03:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504797",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:62" align="right">comment:62</div>

I can pin a version for sage-9.2 and a different one for beta and future 9.3 in Gentoo.



---

archive/issue_comments_504798.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@JohnCremona](#comment%3A61):\n> No, the new version of eclib will not work with older sages: the sage code changes here in the eclib interface are necesary.\n> \n> I just push a tag '20210318' to eclib on github and will make a release with the same name.\n> \n> From what I have been discovering about dependencies in Sage's own build system, since Sage has a patched version of pari it will always build any package with pari as a dependency.\n\nno, this is not correct. There are versions of Pari 2.11 around on some Linux distributions which are accepted by Sage and may be used. Sage's patches to Pari are needed for Cygwin.",
    "created_at": "2021-03-19T20:24:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504798",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@JohnCremona](#comment%3A61):
> No, the new version of eclib will not work with older sages: the sage code changes here in the eclib interface are necesary.
> 
> I just push a tag '20210318' to eclib on github and will make a release with the same name.
> 
> From what I have been discovering about dependencies in Sage's own build system, since Sage has a patched version of pari it will always build any package with pari as a dependency.

no, this is not correct. There are versions of Pari 2.11 around on some Linux distributions which are accepted by Sage and may be used. Sage's patches to Pari are needed for Cygwin.



---

archive/issue_comments_504799.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nBy the way, about eclib's 3 dependencies:  \n\n- NTL is vital, used in many ways throughout.  \n\n- FLINT is optional -- eclib can be configured and built without it, though I am not sure when I tested that.  The only difference would be in the speed of certain parts of linear algebra mod p which are used by Sage only in some modular symbols code.  That would still work without the FLINT use but larger examples (large enough to take hours anyway) would be slower.  It will be easy to write that using NTL instead, which I will do and if the performance is no worse than using FLINT then I will consider removing the FLINT version and hance that dependency.\n\n- pari could be made optional, though there seems little point in  that. Until version 20190909, the only difference would have been that without it integer factorization would only use trial division.  Since the 2021 releases eclib also uses libpari's ellap function for point-counting on elliptic curves mod p.  I could  make that optional too since eclib can do its own point counting (it is just slower).",
    "created_at": "2021-03-21T15:18:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504799",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:64" align="right">comment:64</div>

By the way, about eclib's 3 dependencies:  

- NTL is vital, used in many ways throughout.  

- FLINT is optional -- eclib can be configured and built without it, though I am not sure when I tested that.  The only difference would be in the speed of certain parts of linear algebra mod p which are used by Sage only in some modular symbols code.  That would still work without the FLINT use but larger examples (large enough to take hours anyway) would be slower.  It will be easy to write that using NTL instead, which I will do and if the performance is no worse than using FLINT then I will consider removing the FLINT version and hance that dependency.

- pari could be made optional, though there seems little point in  that. Until version 20190909, the only difference would have been that without it integer factorization would only use trial division.  Since the 2021 releases eclib also uses libpari's ellap function for point-counting on elliptic curves mod p.  I could  make that optional too since eclib can do its own point counting (it is just slower).



---

archive/issue_comments_504800.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@JohnCremona](#comment%3A61):\n> I just push a tag '20210318' to eclib on github and will make a release with the same name.\n\nYou may want to put the release tarball there.",
    "created_at": "2021-03-21T16:42:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504800",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@JohnCremona](#comment%3A61):
> I just push a tag '20210318' to eclib on github and will make a release with the same name.

You may want to put the release tarball there.



---

archive/issue_comments_504801.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nReplying to [@mkoeppe](#comment%3A65):\n> Replying to [@JohnCremona](#comment%3A61):\n> > I just push a tag '20210318' to eclib on github and will make a release with the same name.\n\n> \n> You may want to put the release tarball there.\n\nGithub makes a tarball whenever one makes a release, and it is at https://github.com/JohnCremona/eclib/releases/tag/20210318\nbut I don't think that it is identical in content to what one gets from autotools \"make dist\".  I would certainly prefer to having the tarball there instead of making a separate one and putting it on my own web page.",
    "created_at": "2021-03-21T17:46:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504801",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:66" align="right">comment:66</div>

Replying to [@mkoeppe](#comment%3A65):
> Replying to [@JohnCremona](#comment%3A61):
> > I just push a tag '20210318' to eclib on github and will make a release with the same name.

> 
> You may want to put the release tarball there.

Github makes a tarball whenever one makes a release, and it is at https://github.com/JohnCremona/eclib/releases/tag/20210318
but I don't think that it is identical in content to what one gets from autotools "make dist".  I would certainly prefer to having the tarball there instead of making a separate one and putting it on my own web page.



---

archive/issue_comments_504802.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nThat's right. What GitHub puts there is not a proper release tarball; it is merely an archive of what's in the repository. \n\nYou can use the \"edit\" button on the release page to upload the actual release tarball there.",
    "created_at": "2021-03-21T18:11:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504802",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:67" align="right">comment:67</div>

That's right. What GitHub puts there is not a proper release tarball; it is merely an archive of what's in the repository. 

You can use the "edit" button on the release page to upload the actual release tarball there.



---

archive/issue_comments_504803.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@mkoeppe](#comment%3A67):\n> That's right. What GitHub puts there is not a proper release tarball; it is merely an archive of what's in the repository. \n> \n> You can use the \"edit\" button on the release page to upload the actual release tarball there. \n\nAh I didn't know that . Thanks, I will do. Then Ill need to change vhecksums.ini again with the changed URL.",
    "created_at": "2021-03-21T18:15:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504803",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@mkoeppe](#comment%3A67):
> That's right. What GitHub puts there is not a proper release tarball; it is merely an archive of what's in the repository. 
> 
> You can use the "edit" button on the release page to upload the actual release tarball there. 

Ah I didn't know that . Thanks, I will do. Then Ill need to change vhecksums.ini again with the changed URL.



---

archive/issue_comments_504804.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nReplying to [@JohnCremona](#comment%3A64):\n> about eclib's 3 dependencies:  \n\nThanks for sharing this information. At the moment, and also for the Sage 9.4 release cycle (#29705), all of these three libraries are essential standard components of Sage; so from the viewpoint of Sage there is no immediate need to worry about making any of these dependencies optional.",
    "created_at": "2021-03-21T18:39:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504804",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:69" align="right">comment:69</div>

Replying to [@JohnCremona](#comment%3A64):
> about eclib's 3 dependencies:  

Thanks for sharing this information. At the moment, and also for the Sage 9.4 release cycle (#29705), all of these three libraries are essential standard components of Sage; so from the viewpoint of Sage there is no immediate need to worry about making any of these dependencies optional.



---

archive/issue_comments_504805.json:
```json
{
    "body": "<div id=\"comment:70\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d9e70a118b4cce4d2b526129a880ca7f4822485\"><code>5d9e70a</code></a></td><td><code>#31443: updated upstream tarball URL</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b64fed5ba394314edc1e0200bb6e194a5fa00f2\"><code>8b64fed</code></a></td><td><code>Merge remote-tracking branch 'trac/public/packages/eclib/31443' into 31443-eclib-saturation</code></td></tr></table>\n",
    "created_at": "2021-03-22T08:44:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504805",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:70"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d9e70a118b4cce4d2b526129a880ca7f4822485"><code>5d9e70a</code></a></td><td><code>#31443: updated upstream tarball URL</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b64fed5ba394314edc1e0200bb6e194a5fa00f2"><code>8b64fed</code></a></td><td><code>Merge remote-tracking branch 'trac/public/packages/eclib/31443' into 31443-eclib-saturation</code></td></tr></table>




---

archive/issue_comments_504806.json:
```json
{
    "body": "Changed commit from **[`926670f`](https://github.com/sagemath/sagetrac-mirror/commit/926670fc33cc68d86bf002db4acb45c63f4df9ef)** to **[`8b64fed`](https://github.com/sagemath/sagetrac-mirror/commit/8b64fed5ba394314edc1e0200bb6e194a5fa00f2)**",
    "created_at": "2021-03-22T08:44:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504806",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`926670f`](https://github.com/sagemath/sagetrac-mirror/commit/926670fc33cc68d86bf002db4acb45c63f4df9ef)** to **[`8b64fed`](https://github.com/sagemath/sagetrac-mirror/commit/8b64fed5ba394314edc1e0200bb6e194a5fa00f2)**



---

archive/issue_comments_504807.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nI put the proper release tarball onto github and updated both the link on this ticket and the last line of checksums.ini.  The latter now reads\n\n```\nupstream_url=https://github.com/JohnCremona/eclib/releases/download/VERSION/eclib-VERSION.tar.bz2\n```\nwith \"VERSION\" twice since the version string \"20210318\" appears twice in the URL.  I hope that Sage can handle that.",
    "created_at": "2021-03-22T08:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504807",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:71" align="right">comment:71</div>

I put the proper release tarball onto github and updated both the link on this ticket and the last line of checksums.ini.  The latter now reads

```
upstream_url=https://github.com/JohnCremona/eclib/releases/download/VERSION/eclib-VERSION.tar.bz2
```
with "VERSION" twice since the version string "20210318" appears twice in the URL.  I hope that Sage can handle that.



---

archive/issue_comments_504808.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,5 @@\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210318.tar.bz2](https://johncremona.github.io/ftp/eclib-20210318.tar.bz2)\n+New eclib source tarball at \n+[https://github.com/JohnCremona/eclib/releases/download/20210318/eclib-20210318.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210318/eclib-20210318.tar.bz2)\n``````\n",
    "created_at": "2021-03-22T08:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504808",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,5 @@
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
-New eclib source tarball at [https://johncremona.github.io/ftp/eclib-20210318.tar.bz2](https://johncremona.github.io/ftp/eclib-20210318.tar.bz2)
+New eclib source tarball at 
+[https://github.com/JohnCremona/eclib/releases/download/20210318/eclib-20210318.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210318/eclib-20210318.tar.bz2)
``````




---

archive/issue_comments_504809.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nReplying to [@mkoeppe](#comment%3A69):\n> Replying to [@JohnCremona](#comment%3A64):\n> > about eclib's 3 dependencies:  \n\n> \n> Thanks for sharing this information. At the moment, and also for the Sage 9.4 release cycle (#29705), all of these three libraries are essential standard components of Sage; so from the viewpoint of Sage there is no immediate need to worry about making any of these dependencies optional. \n\nI realize that Sage itself will carry on using FLINT, but it would help me not to have to build it on machines I use, and also it would make it slightly more likely that someone building Sage would not need to build eclib.\n\nFor the record, I now have a branch which uses an NTL function instead of eclib's own for reduction of dense matrices modulo a small (int or long) prime p when FLINT_LEVEL=0 -- i.e. for when FLINT is not available, or configure has been given --without-flint.   Testing shows that this is reasonable -- much better than using eclib's own naive function -- though slower than using FLINT.  So it will be there in some future release, which might make without-flint the default, but there is no urgency.",
    "created_at": "2021-03-22T08:49:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504809",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:72" align="right">comment:72</div>

Replying to [@mkoeppe](#comment%3A69):
> Replying to [@JohnCremona](#comment%3A64):
> > about eclib's 3 dependencies:  

> 
> Thanks for sharing this information. At the moment, and also for the Sage 9.4 release cycle (#29705), all of these three libraries are essential standard components of Sage; so from the viewpoint of Sage there is no immediate need to worry about making any of these dependencies optional. 

I realize that Sage itself will carry on using FLINT, but it would help me not to have to build it on machines I use, and also it would make it slightly more likely that someone building Sage would not need to build eclib.

For the record, I now have a branch which uses an NTL function instead of eclib's own for reduction of dense matrices modulo a small (int or long) prime p when FLINT_LEVEL=0 -- i.e. for when FLINT is not available, or configure has been given --without-flint.   Testing shows that this is reasonable -- much better than using eclib's own naive function -- though slower than using FLINT.  So it will be there in some future release, which might make without-flint the default, but there is no urgency.



---

archive/issue_comments_504810.json:
```json
{
    "body": "Changed reviewer from **Dima Pasechnik** to **Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/680630789**",
    "created_at": "2021-03-23T18:46:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504810",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Dima Pasechnik** to **Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/680630789**



---

archive/issue_comments_504811.json:
```json
{
    "body": "Changed reviewer from **Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/680630789** to **Dima Pasechnik, Matthias Koeppe**",
    "created_at": "2021-03-24T16:05:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504811",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Dima Pasechnik, https://github.com/mkoeppe/sage/actions/runs/680630789** to **Dima Pasechnik, Matthias Koeppe**



---

archive/issue_events_430268.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T16:05:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430268"
}
```



---

archive/issue_events_430269.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-24T16:05:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430269"
}
```



---

archive/issue_comments_504812.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nThe tests at https://github.com/mkoeppe/sage/actions/runs/680630789 have run successfully. LGTM.",
    "created_at": "2021-03-24T16:05:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504812",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:74" align="right">comment:74</div>

The tests at https://github.com/mkoeppe/sage/actions/runs/680630789 have run successfully. LGTM.



---

archive/issue_comments_504813.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nThanks to all for the reviewing and other help.",
    "created_at": "2021-03-24T16:22:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504813",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:75" align="right">comment:75</div>

Thanks to all for the reviewing and other help.



---

archive/issue_comments_504814.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nI found a bug in some eclib code which has the effect of making the \"saturation index bound\" much larger than necessary.  In the example I mentioned above (Comment 3) the bound is no longer ~86000 but ony ~11800, taking the time to saturate that example down from 15 minutes (which was many hours before I started) to under a minute.\n\nWhat this means is that is that there will be yet another eclib release soon (I am hoping for tomorrow), so I am quite relaxed about whether this version gets into 9.3, despite having a positive review a week ago.\n\nBy the way, the bug was found while comparing results with Bill Allombert (pari developer) who is implementing the same stuff in pari/gp.  By the time he has finished and newer versions of pari are in Sage, Sage will hardly need eclib at all...hooray!",
    "created_at": "2021-03-31T14:05:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504814",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:76" align="right">comment:76</div>

I found a bug in some eclib code which has the effect of making the "saturation index bound" much larger than necessary.  In the example I mentioned above (Comment 3) the bound is no longer ~86000 but ony ~11800, taking the time to saturate that example down from 15 minutes (which was many hours before I started) to under a minute.

What this means is that is that there will be yet another eclib release soon (I am hoping for tomorrow), so I am quite relaxed about whether this version gets into 9.3, despite having a positive review a week ago.

By the way, the bug was found while comparing results with Bill Allombert (pari developer) who is implementing the same stuff in pari/gp.  By the time he has finished and newer versions of pari are in Sage, Sage will hardly need eclib at all...hooray!



---

archive/issue_comments_504815.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nMoving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage",
    "created_at": "2021-04-02T20:21:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504815",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:77" align="right">comment:77</div>

Moving this ticket to 9.4, as it seems unlikely that it will be merged in 9.3, which is in the release candidate stage



---

archive/issue_events_430270.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-02T20:21:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430270"
}
```



---

archive/issue_events_430271.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-02T20:21:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430271"
}
```



---

archive/issue_comments_504816.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nI am about to update this with eclib version 20210408.",
    "created_at": "2021-04-09T08:02:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504816",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:78" align="right">comment:78</div>

I am about to update this with eclib version 20210408.



---

archive/issue_comments_504817.json:
```json
{
    "body": "<div id=\"comment:79\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17e91cae43bdd50b29fa4128c91097167c64e038\"><code>17e91ca</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f18fa6301c06a460cbae692d0f90eb332f3ef196\"><code>f18fa63</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f564931ed03e8a1d93dab328f256f30353ded1f6\"><code>f564931</code></a></td><td><code>updated eclib package version to 20210408 and checksums</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/07c5a20f8cfe7323fc5afb4c9a7a77472ac4d0b8\"><code>07c5a20</code></a></td><td><code>correct a docstring after eclib upgrade</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c4c115055b81b47860da66dbe0b0dde7bb55069\"><code>8c4c115</code></a></td><td><code>Merge branch 'public/packages/eclib/31443' of trac.sagemath.org:sage into 31443-eclib-saturation</code></td></tr></table>\n",
    "created_at": "2021-04-09T09:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504817",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:79"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17e91cae43bdd50b29fa4128c91097167c64e038"><code>17e91ca</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f18fa6301c06a460cbae692d0f90eb332f3ef196"><code>f18fa63</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f564931ed03e8a1d93dab328f256f30353ded1f6"><code>f564931</code></a></td><td><code>updated eclib package version to 20210408 and checksums</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/07c5a20f8cfe7323fc5afb4c9a7a77472ac4d0b8"><code>07c5a20</code></a></td><td><code>correct a docstring after eclib upgrade</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c4c115055b81b47860da66dbe0b0dde7bb55069"><code>8c4c115</code></a></td><td><code>Merge branch 'public/packages/eclib/31443' of trac.sagemath.org:sage into 31443-eclib-saturation</code></td></tr></table>




---

archive/issue_comments_504818.json:
```json
{
    "body": "Changed commit from **[`8b64fed`](https://github.com/sagemath/sagetrac-mirror/commit/8b64fed5ba394314edc1e0200bb6e194a5fa00f2)** to **[`8c4c115`](https://github.com/sagemath/sagetrac-mirror/commit/8c4c115055b81b47860da66dbe0b0dde7bb55069)**",
    "created_at": "2021-04-09T09:49:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504818",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8b64fed`](https://github.com/sagemath/sagetrac-mirror/commit/8b64fed5ba394314edc1e0200bb6e194a5fa00f2)** to **[`8c4c115`](https://github.com/sagemath/sagetrac-mirror/commit/8c4c115055b81b47860da66dbe0b0dde7bb55069)**



---

archive/issue_events_430272.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-04-09T09:49:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430272"
}
```



---

archive/issue_events_430273.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2021-04-09T09:49:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430273"
}
```



---

archive/issue_comments_504819.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,4 +5,4 @@\n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n New eclib source tarball at \n-[https://github.com/JohnCremona/eclib/releases/download/20210318/eclib-20210318.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210318/eclib-20210318.tar.bz2)\n+[https://github.com/JohnCremona/eclib/releases/download/20210408/eclib-20210318.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210408/eclib-20210318.tar.bz2)\n``````\n",
    "created_at": "2021-04-09T09:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504819",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,4 +5,4 @@
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
 New eclib source tarball at 
-[https://github.com/JohnCremona/eclib/releases/download/20210318/eclib-20210318.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210318/eclib-20210318.tar.bz2)
+[https://github.com/JohnCremona/eclib/releases/download/20210408/eclib-20210318.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210408/eclib-20210318.tar.bz2)
``````




---

archive/issue_comments_504820.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nUpdated tarball to eclib-20210408.  This has a bugfix but is otherwise compatible with the previous version.  The onlt Sage files changed are the package version and checksums, and one docstring (which used to say that one example took 45 minutes, but now it only takes 40 seconds.  In Sage-9.3 it will take many hours)",
    "created_at": "2021-04-09T09:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504820",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:80" align="right">comment:80</div>

Updated tarball to eclib-20210408.  This has a bugfix but is otherwise compatible with the previous version.  The onlt Sage files changed are the package version and checksums, and one docstring (which used to say that one example took 45 minutes, but now it only takes 40 seconds.  In Sage-9.3 it will take many hours)



---

archive/issue_comments_504821.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nThe version check in `build/pkgs/eclib/spkg-configure.m4` needs to be updated to match the new version string.\n\nI also spotted a typo \"casue\" in `sage/libs/eclib/interface.py`.",
    "created_at": "2021-04-09T11:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504821",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:81" align="right">comment:81</div>

The version check in `build/pkgs/eclib/spkg-configure.m4` needs to be updated to match the new version string.

I also spotted a typo "casue" in `sage/libs/eclib/interface.py`.



---

archive/issue_comments_504822.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nReplying to [@orlitzky](#comment%3A81):\n> The version check in `build/pkgs/eclib/spkg-configure.m4` needs to be updated to match the new version string.\n> \n> I also spotted a typo \"casue\" in `sage/libs/eclib/interface.py`.\n\nThanks, I will fix both right away.",
    "created_at": "2021-04-09T11:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504822",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:82" align="right">comment:82</div>

Replying to [@orlitzky](#comment%3A81):
> The version check in `build/pkgs/eclib/spkg-configure.m4` needs to be updated to match the new version string.
> 
> I also spotted a typo "casue" in `sage/libs/eclib/interface.py`.

Thanks, I will fix both right away.



---

archive/issue_comments_504823.json:
```json
{
    "body": "<div id=\"comment:83\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b1dedb02560d1b3fce444e5f88ac14f42786ce9\"><code>9b1dedb</code></a></td><td><code>correct typo and update eclib's m4 script</code></td></tr></table>\n",
    "created_at": "2021-04-09T11:23:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504823",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:83"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b1dedb02560d1b3fce444e5f88ac14f42786ce9"><code>9b1dedb</code></a></td><td><code>correct typo and update eclib's m4 script</code></td></tr></table>




---

archive/issue_comments_504824.json:
```json
{
    "body": "Changed commit from **[`8c4c115`](https://github.com/sagemath/sagetrac-mirror/commit/8c4c115055b81b47860da66dbe0b0dde7bb55069)** to **[`9b1dedb`](https://github.com/sagemath/sagetrac-mirror/commit/9b1dedb02560d1b3fce444e5f88ac14f42786ce9)**",
    "created_at": "2021-04-09T11:23:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504824",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8c4c115`](https://github.com/sagemath/sagetrac-mirror/commit/8c4c115055b81b47860da66dbe0b0dde7bb55069)** to **[`9b1dedb`](https://github.com/sagemath/sagetrac-mirror/commit/9b1dedb02560d1b3fce444e5f88ac14f42786ce9)**



---

archive/issue_comments_504825.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nUpdated tarball to 20210415, version + checksums + m4 script.  Some bugfixes compared with version 20210408.  No more Sage code changes needed.",
    "created_at": "2021-04-15T13:31:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504825",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:84" align="right">comment:84</div>

Updated tarball to 20210415, version + checksums + m4 script.  Some bugfixes compared with version 20210408.  No more Sage code changes needed.



---

archive/issue_comments_504826.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,5 +4,4 @@\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n-New eclib source tarball at \n-[https://github.com/JohnCremona/eclib/releases/download/20210408/eclib-20210318.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210408/eclib-20210318.tar.bz2)\n+New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210415/eclib-20210415.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210415/eclib-20210415.tar.bz2)\n``````\n",
    "created_at": "2021-04-15T13:31:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504826",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,5 +4,4 @@
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
-New eclib source tarball at 
-[https://github.com/JohnCremona/eclib/releases/download/20210408/eclib-20210318.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210408/eclib-20210318.tar.bz2)
+New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210415/eclib-20210415.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210415/eclib-20210415.tar.bz2)
``````




---

archive/issue_comments_504827.json:
```json
{
    "body": "<div id=\"comment:85\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53a03054b050dcb5b7c11ea972be272d8cd56618\"><code>53a0305</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3dca4e6c927053770c5e938f5a59be9047602cde\"><code>3dca4e6</code></a></td><td><code>#31443: undated pkg info for 20210415</code></td></tr></table>\n",
    "created_at": "2021-04-15T14:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504827",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:85"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53a03054b050dcb5b7c11ea972be272d8cd56618"><code>53a0305</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3dca4e6c927053770c5e938f5a59be9047602cde"><code>3dca4e6</code></a></td><td><code>#31443: undated pkg info for 20210415</code></td></tr></table>




---

archive/issue_comments_504828.json:
```json
{
    "body": "Changed commit from **[`9b1dedb`](https://github.com/sagemath/sagetrac-mirror/commit/9b1dedb02560d1b3fce444e5f88ac14f42786ce9)** to **[`3dca4e6`](https://github.com/sagemath/sagetrac-mirror/commit/3dca4e6c927053770c5e938f5a59be9047602cde)**",
    "created_at": "2021-04-15T14:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504828",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9b1dedb`](https://github.com/sagemath/sagetrac-mirror/commit/9b1dedb02560d1b3fce444e5f88ac14f42786ce9)** to **[`3dca4e6`](https://github.com/sagemath/sagetrac-mirror/commit/3dca4e6c927053770c5e938f5a59be9047602cde)**



---

archive/issue_comments_504829.json:
```json
{
    "body": "<div id=\"comment:86\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ed01dcf3e9c5a3b400395f98dee36e6c2a45a19\"><code>0ed01dc</code></a></td><td><code>Merge branch 'develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9443892b2e86d4edf4f040fa7b1736583ab4c29a\"><code>9443892</code></a></td><td><code>#31443: updated eclib tarball to 20210503</code></td></tr></table>\n",
    "created_at": "2021-05-05T08:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504829",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:86"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ed01dcf3e9c5a3b400395f98dee36e6c2a45a19"><code>0ed01dc</code></a></td><td><code>Merge branch 'develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9443892b2e86d4edf4f040fa7b1736583ab4c29a"><code>9443892</code></a></td><td><code>#31443: updated eclib tarball to 20210503</code></td></tr></table>




---

archive/issue_comments_504830.json:
```json
{
    "body": "Changed commit from **[`3dca4e6`](https://github.com/sagemath/sagetrac-mirror/commit/3dca4e6c927053770c5e938f5a59be9047602cde)** to **[`9443892`](https://github.com/sagemath/sagetrac-mirror/commit/9443892b2e86d4edf4f040fa7b1736583ab4c29a)**",
    "created_at": "2021-05-05T08:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504830",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3dca4e6`](https://github.com/sagemath/sagetrac-mirror/commit/3dca4e6c927053770c5e938f5a59be9047602cde)** to **[`9443892`](https://github.com/sagemath/sagetrac-mirror/commit/9443892b2e86d4edf4f040fa7b1736583ab4c29a)**



---

archive/issue_comments_504831.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n-New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210415/eclib-20210415.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210415/eclib-20210415.tar.bz2)\n+New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210503/eclib-20210503.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210503/eclib-20210503.tar.bz2)\n``````\n",
    "created_at": "2021-05-05T08:03:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504831",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
-New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210415/eclib-20210415.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210415/eclib-20210415.tar.bz2)
+New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210503/eclib-20210503.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210503/eclib-20210503.tar.bz2)
``````




---

archive/issue_comments_504832.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nI am taking the opportunity of the delay to make a small additional update to the eclib tarball (release 20210503), with a minor bugfix.  This version also keep debian happy on all its test platforms.  No further Sage code changes outside build/pks/eclib.",
    "created_at": "2021-05-05T08:03:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504832",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:87" align="right">comment:87</div>

I am taking the opportunity of the delay to make a small additional update to the eclib tarball (release 20210503), with a minor bugfix.  This version also keep debian happy on all its test platforms.  No further Sage code changes outside build/pks/eclib.



---

archive/issue_comments_504833.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nIs this tested with #30801 (upgrade to Pari 2.13.1) ?",
    "created_at": "2021-05-12T22:29:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504833",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:88" align="right">comment:88</div>

Is this tested with #30801 (upgrade to Pari 2.13.1) ?



---

archive/issue_comments_504834.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nReplying to [@dimpase](#comment%3A88):\n> Is this tested with #30801 (upgrade to Pari 2.13.1) ?\n\nI've been shipping both downstream for a while without issues",
    "created_at": "2021-05-13T05:44:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504834",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:89" align="right">comment:89</div>

Replying to [@dimpase](#comment%3A88):
> Is this tested with #30801 (upgrade to Pari 2.13.1) ?

I've been shipping both downstream for a while without issues



---

archive/issue_comments_504835.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nReplying to [@antonio-rojas](#comment%3A89):\n> Replying to [@dimpase](#comment%3A88):\n> > Is this tested with #30801 (upgrade to Pari 2.13.1) ?\n\n> \n> I've been shipping both downstream for a while without issues\n\nI have been using recent pari version for eclib development, though eclib does not use very much of pari and nothing at all new.",
    "created_at": "2021-05-13T15:58:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504835",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:90" align="right">comment:90</div>

Replying to [@antonio-rojas](#comment%3A89):
> Replying to [@dimpase](#comment%3A88):
> > Is this tested with #30801 (upgrade to Pari 2.13.1) ?

> 
> I've been shipping both downstream for a while without issues

I have been using recent pari version for eclib development, though eclib does not use very much of pari and nothing at all new.



---

archive/issue_comments_504836.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nOK, fine.",
    "created_at": "2021-05-13T23:02:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504836",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:91" align="right">comment:91</div>

OK, fine.



---

archive/issue_events_430274.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-05-13T23:02:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430274"
}
```



---

archive/issue_events_430275.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-05-13T23:02:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430275"
}
```



---

archive/issue_comments_504837.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nIs there a reason why this was not included in 9.4.beta0?",
    "created_at": "2021-05-27T09:09:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504837",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:92" align="right">comment:92</div>

Is there a reason why this was not included in 9.4.beta0?



---

archive/issue_comments_504838.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nI'm pretty sure it's simply a matter of backlog\nas many tickets have had positive review for a while.",
    "created_at": "2021-05-27T10:24:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504838",
    "user": "https://github.com/slel"
}
```

<div id="comment:93" align="right">comment:93</div>

I'm pretty sure it's simply a matter of backlog
as many tickets have had positive review for a while.



---

archive/issue_comments_504839.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nPDF docs don't build\n\n```\n[docpdf] ! Undefined control sequence.\n[docpdf] l.19194 ...q\\) of good reduction such that \\(E(\\FF\n[docpdf]                                                   _q)\\) has\n[docpdf] ? \n[docpdf] ! Emergency stop.\n```",
    "created_at": "2021-05-30T09:16:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504839",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:94" align="right">comment:94</div>

PDF docs don't build

```
[docpdf] ! Undefined control sequence.
[docpdf] l.19194 ...q\) of good reduction such that \(E(\FF
[docpdf]                                                   _q)\) has
[docpdf] ? 
[docpdf] ! Emergency stop.
```



---

archive/issue_events_430276.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-05-30T09:16:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430276"
}
```



---

archive/issue_events_430277.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-05-30T09:16:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430277"
}
```



---

archive/issue_comments_504840.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nChange `\\FF_q` to `\\GF{q}`:\n\n```diff\n-        modulo primes `q` of good reduction such that `E(\\FF_q)` has\n+        modulo primes `q` of good reduction such that `E(\\GF{q})` has\n```",
    "created_at": "2021-05-30T13:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504840",
    "user": "https://github.com/slel"
}
```

<div id="comment:95" align="right">comment:95</div>

Change `\FF_q` to `\GF{q}`:

```diff
-        modulo primes `q` of good reduction such that `E(\FF_q)` has
+        modulo primes `q` of good reduction such that `E(\GF{q})` has
```



---

archive/issue_comments_504841.json:
```json
{
    "body": "Changed commit from **[`9443892`](https://github.com/sagemath/sagetrac-mirror/commit/9443892b2e86d4edf4f040fa7b1736583ab4c29a)** to **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)**",
    "created_at": "2021-05-31T06:53:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504841",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9443892`](https://github.com/sagemath/sagetrac-mirror/commit/9443892b2e86d4edf4f040fa7b1736583ab4c29a)** to **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)**



---

archive/issue_comments_504842.json:
```json
{
    "body": "<div id=\"comment:96\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d193588ff7e20f3a1bf01b62254fe613281445a9\"><code>d193588</code></a></td><td><code>Merge tag '9.3' of github.com:sagemath/sage into public/packages/eclib/31443</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853\"><code>b50d9c6</code></a></td><td><code>Fix doc building</code></td></tr></table>\n",
    "created_at": "2021-05-31T06:53:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504842",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:96"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d193588ff7e20f3a1bf01b62254fe613281445a9"><code>d193588</code></a></td><td><code>Merge tag '9.3' of github.com:sagemath/sage into public/packages/eclib/31443</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853"><code>b50d9c6</code></a></td><td><code>Fix doc building</code></td></tr></table>




---

archive/issue_comments_504843.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nReplying to [@slel](#comment%3A95):\n> Change `\\FF_q` to `\\GF{q}`:\n> \n> ```diff\n> -        modulo primes `q` of good reduction such that `E(\\FF_q)` has\n> +        modulo primes `q` of good reduction such that `E(\\GF{q})` has\n> ```\n\nThanks for fixing this.",
    "created_at": "2021-06-01T07:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504843",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:97" align="right">comment:97</div>

Replying to [@slel](#comment%3A95):
> Change `\FF_q` to `\GF{q}`:
> 
> ```diff
> -        modulo primes `q` of good reduction such that `E(\FF_q)` has
> +        modulo primes `q` of good reduction such that `E(\GF{q})` has
> ```

Thanks for fixing this.



---

archive/issue_events_430278.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-06-01T08:52:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430278"
}
```



---

archive/issue_events_430279.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-06-01T08:52:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430279"
}
```



---

archive/issue_comments_504844.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nThanks Isuru for sending a commit implementing the suggested doc fix.\n\nBack to needs review I guess. Or should it be rebased on 9.4.beta0?",
    "created_at": "2021-06-01T08:52:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504844",
    "user": "https://github.com/slel"
}
```

<div id="comment:98" align="right">comment:98</div>

Thanks Isuru for sending a commit implementing the suggested doc fix.

Back to needs review I guess. Or should it be rebased on 9.4.beta0?



---

archive/issue_events_430280.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-02T08:53:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430280"
}
```



---

archive/issue_events_430281.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-02T08:53:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430281"
}
```



---

archive/issue_comments_504845.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nlgtm",
    "created_at": "2021-06-02T08:53:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504845",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:99" align="right">comment:99</div>

lgtm



---

archive/issue_events_430282.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-20T08:14:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430282"
}
```



---

archive/issue_events_430283.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-20T08:14:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430283"
}
```



---

archive/issue_comments_504846.json:
```json
{
    "body": "Changed branch from **[public/packages/eclib/31443](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/eclib/31443)** to **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)**",
    "created_at": "2021-06-20T08:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504846",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/packages/eclib/31443](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/eclib/31443)** to **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)**



---

archive/issue_comments_504847.json:
```json
{
    "body": "Changed commit from **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)** to none",
    "created_at": "2021-06-20T13:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504847",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)** to none



---

archive/issue_comments_504848.json:
```json
{
    "body": "<div id=\"comment:101\" align=\"right\">comment:101</div>\n\nOn 32-bit:\n\n```\n**********************************************************************\nFile \"src/sage/libs/eclib/interface.py\", line 555, in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate\nFailed example:\n    E.gens()\nExpected:\n    [[-1001107, -4004428, 1]]\nGot:\n    Attempt to convert -2004462486322 to long fails!\n    [[-1001107, -4004428, 1]]\n**********************************************************************\n1 item had failures:\n   1 of   9 in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate\n    [192 tests, 1 failure, 18.73 s]\n----------------------------------------------------------------------\nsage -t --long --random-seed=0 src/sage/libs/eclib/interface.py  # 1 doctest failed\n----------------------------------------------------------------------\n```",
    "created_at": "2021-06-20T13:34:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504848",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:101" align="right">comment:101</div>

On 32-bit:

```
**********************************************************************
File "src/sage/libs/eclib/interface.py", line 555, in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate
Failed example:
    E.gens()
Expected:
    [[-1001107, -4004428, 1]]
Got:
    Attempt to convert -2004462486322 to long fails!
    [[-1001107, -4004428, 1]]
**********************************************************************
1 item had failures:
   1 of   9 in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate
    [192 tests, 1 failure, 18.73 s]
----------------------------------------------------------------------
sage -t --long --random-seed=0 src/sage/libs/eclib/interface.py  # 1 doctest failed
----------------------------------------------------------------------
```



---

archive/issue_events_430284.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-20T13:34:05Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430284"
}
```



---

archive/issue_comments_504849.json:
```json
{
    "body": "<div id=\"comment:102\"></div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/926670fc33cc68d86bf002db4acb45c63f4df9ef\"><code>926670f</code></a></td><td><code>Merge remote-tracking branch 'jc/31443-eclib-saturation' into public/packages/eclib/31443</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b64fed5ba394314edc1e0200bb6e194a5fa00f2\"><code>8b64fed</code></a></td><td><code>Merge remote-tracking branch 'trac/public/packages/eclib/31443' into 31443-eclib-saturation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c4c115055b81b47860da66dbe0b0dde7bb55069\"><code>8c4c115</code></a></td><td><code>Merge branch 'public/packages/eclib/31443' of trac.sagemath.org:sage into 31443-eclib-saturation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b1dedb02560d1b3fce444e5f88ac14f42786ce9\"><code>9b1dedb</code></a></td><td><code>correct typo and update eclib's m4 script</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/53a03054b050dcb5b7c11ea972be272d8cd56618\"><code>53a0305</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3dca4e6c927053770c5e938f5a59be9047602cde\"><code>3dca4e6</code></a></td><td><code>#31443: undated pkg info for 20210415</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ed01dcf3e9c5a3b400395f98dee36e6c2a45a19\"><code>0ed01dc</code></a></td><td><code>Merge branch 'develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9443892b2e86d4edf4f040fa7b1736583ab4c29a\"><code>9443892</code></a></td><td><code>#31443: updated eclib tarball to 20210503</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d193588ff7e20f3a1bf01b62254fe613281445a9\"><code>d193588</code></a></td><td><code>Merge tag '9.3' of github.com:sagemath/sage into public/packages/eclib/31443</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853\"><code>b50d9c6</code></a></td><td><code>Fix doc building</code></td></tr></table>\n",
    "created_at": "2021-06-20T13:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504849",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:102"></div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/926670fc33cc68d86bf002db4acb45c63f4df9ef"><code>926670f</code></a></td><td><code>Merge remote-tracking branch 'jc/31443-eclib-saturation' into public/packages/eclib/31443</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b64fed5ba394314edc1e0200bb6e194a5fa00f2"><code>8b64fed</code></a></td><td><code>Merge remote-tracking branch 'trac/public/packages/eclib/31443' into 31443-eclib-saturation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c4c115055b81b47860da66dbe0b0dde7bb55069"><code>8c4c115</code></a></td><td><code>Merge branch 'public/packages/eclib/31443' of trac.sagemath.org:sage into 31443-eclib-saturation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b1dedb02560d1b3fce444e5f88ac14f42786ce9"><code>9b1dedb</code></a></td><td><code>correct typo and update eclib's m4 script</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/53a03054b050dcb5b7c11ea972be272d8cd56618"><code>53a0305</code></a></td><td><code>Merge remote-tracking branch 'trac/develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3dca4e6c927053770c5e938f5a59be9047602cde"><code>3dca4e6</code></a></td><td><code>#31443: undated pkg info for 20210415</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ed01dcf3e9c5a3b400395f98dee36e6c2a45a19"><code>0ed01dc</code></a></td><td><code>Merge branch 'develop' into 31443-eclib-saturation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9443892b2e86d4edf4f040fa7b1736583ab4c29a"><code>9443892</code></a></td><td><code>#31443: updated eclib tarball to 20210503</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d193588ff7e20f3a1bf01b62254fe613281445a9"><code>d193588</code></a></td><td><code>Merge tag '9.3' of github.com:sagemath/sage into public/packages/eclib/31443</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853"><code>b50d9c6</code></a></td><td><code>Fix doc building</code></td></tr></table>




---

archive/issue_comments_504850.json:
```json
{
    "body": "Commit: **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)**",
    "created_at": "2021-06-20T13:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504850",
    "user": "https://github.com/vbraun"
}
```

Commit: **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)**



---

archive/issue_comments_504851.json:
```json
{
    "body": "Changed branch from **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)** to **[public/packages/eclib/31443](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/eclib/31443)**",
    "created_at": "2021-06-20T13:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504851",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)** to **[public/packages/eclib/31443](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/eclib/31443)**



---

archive/issue_comments_504852.json:
```json
{
    "body": "<div id=\"comment:103\" align=\"right\">comment:103</div>\n\nReplying to [@vbraun](#comment%3A101):\n> On 32-bit:\n> \n> ```\n> **********************************************************************\n> File \"src/sage/libs/eclib/interface.py\", line 555, in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate\n> Failed example:\n>     E.gens()\n> Expected:\n>     [[-1001107, -4004428, 1]]\n> Got:\n>     Attempt to convert -2004462486322 to long fails!\n>     [[-1001107, -4004428, 1]]\n> **********************************************************************\n> 1 item had failures:\n>    1 of   9 in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate\n>     [192 tests, 1 failure, 18.73 s]\n> ----------------------------------------------------------------------\n> sage -t --long --random-seed=0 src/sage/libs/eclib/interface.py  # 1 doctest failed\n> ----------------------------------------------------------------------\n> ```\n\nAre we still supporting 32-bit?  What if an upstream package does not support it?  I have no way to test eclib on 32-bit.",
    "created_at": "2021-06-21T07:56:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504852",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:103" align="right">comment:103</div>

Replying to [@vbraun](#comment%3A101):
> On 32-bit:
> 
> ```
> **********************************************************************
> File "src/sage/libs/eclib/interface.py", line 555, in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate
> Failed example:
>     E.gens()
> Expected:
>     [[-1001107, -4004428, 1]]
> Got:
>     Attempt to convert -2004462486322 to long fails!
>     [[-1001107, -4004428, 1]]
> **********************************************************************
> 1 item had failures:
>    1 of   9 in sage.libs.eclib.interface.mwrank_EllipticCurve.saturate
>     [192 tests, 1 failure, 18.73 s]
> ----------------------------------------------------------------------
> sage -t --long --random-seed=0 src/sage/libs/eclib/interface.py  # 1 doctest failed
> ----------------------------------------------------------------------
> ```

Are we still supporting 32-bit?  What if an upstream package does not support it?  I have no way to test eclib on 32-bit.



---

archive/issue_comments_504853.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\none can test on 32-bit using [GitHub](../wiki/GitHub) Actions (this would be very easy to set up for standalone eclib),\nand we still support 32-bit, see  http://www.mirrorservice.org/sites/www.sagemath.org/linux/32bit/index.html",
    "created_at": "2021-06-21T09:01:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504853",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:104" align="right">comment:104</div>

one can test on 32-bit using [GitHub](../wiki/GitHub) Actions (this would be very easy to set up for standalone eclib),
and we still support 32-bit, see  http://www.mirrorservice.org/sites/www.sagemath.org/linux/32bit/index.html



---

archive/issue_comments_504854.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nReplying to [@dimpase](#comment%3A104):\n> one can test on 32-bit using [GitHub](../wiki/GitHub) Actions (this would be very easy to set up for standalone eclib),\n> and we still support 32-bit, see  http://www.mirrorservice.org/sites/www.sagemath.org/linux/32bit/index.html\n\nThanks, Dima.  If you ever feel like helping me set up [GitHub](../wiki/GitHub) actions for eclib, that would be good. I have been using Travis.",
    "created_at": "2021-06-21T10:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504854",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:105" align="right">comment:105</div>

Replying to [@dimpase](#comment%3A104):
> one can test on 32-bit using [GitHub](../wiki/GitHub) Actions (this would be very easy to set up for standalone eclib),
> and we still support 32-bit, see  http://www.mirrorservice.org/sites/www.sagemath.org/linux/32bit/index.html

Thanks, Dima.  If you ever feel like helping me set up [GitHub](../wiki/GitHub) actions for eclib, that would be good. I have been using Travis.



---

archive/issue_comments_504855.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">comment:106</div>\n\nThere is nothing special about the one example which triggers that error on 32-bit machines, and I will just change it to a smaller one.  This version of eclib contains may improvements to the code for saturation so it was tempting to put in a non-trivial example in this doctest but it is not necessary.",
    "created_at": "2021-06-23T15:31:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504855",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:106" align="right">comment:106</div>

There is nothing special about the one example which triggers that error on 32-bit machines, and I will just change it to a smaller one.  This version of eclib contains may improvements to the code for saturation so it was tempting to put in a non-trivial example in this doctest but it is not necessary.



---

archive/issue_comments_504856.json:
```json
{
    "body": "<div id=\"comment:107\" align=\"right\">comment:107</div>\n\nhow does one trigger it?\nperhaps put this into spkg-check?",
    "created_at": "2021-06-23T17:00:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504856",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:107" align="right">comment:107</div>

how does one trigger it?
perhaps put this into spkg-check?



---

archive/issue_comments_504857.json:
```json
{
    "body": "<div id=\"comment:108\" align=\"right\">comment:108</div>\n\nthere is also a way to make the test output dependent on the cpu, look up special tags 8n the code, `# 32-bit` if i recall right",
    "created_at": "2021-06-23T17:03:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504857",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:108" align="right">comment:108</div>

there is also a way to make the test output dependent on the cpu, look up special tags 8n the code, `# 32-bit` if i recall right



---

archive/issue_comments_504858.json:
```json
{
    "body": "<div id=\"comment:109\" align=\"right\">comment:109</div>\n\nYes I know about having 32-bit tests, when I started Sage development I had a 32-bit machine.  But now I have not yet been able to build a 32-bit eclib (it is not enough to add -m32 to the compiler flags, it seems, and it might need a 32-bit version of the dependent libraries too).\n\nThe only purpose of this test is to show that saturation may not change anything.  I'll patch it to use this smaller example instead:\n\n```\nsage: E = mwrank_EllipticCurve([0, 0, 0, -391, 0])                                                                                                                                                                           \nsage: E.gens()                                                                                                                                                                                                               \n[[196, 2730, 1]]\nsage: E.saturate()                                                                                                                                                                                                           \nsage: E.gens()                                                                                                                                                                                                               \n[[196, 2730, 1]]\n```",
    "created_at": "2021-06-24T07:38:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504858",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:109" align="right">comment:109</div>

Yes I know about having 32-bit tests, when I started Sage development I had a 32-bit machine.  But now I have not yet been able to build a 32-bit eclib (it is not enough to add -m32 to the compiler flags, it seems, and it might need a 32-bit version of the dependent libraries too).

The only purpose of this test is to show that saturation may not change anything.  I'll patch it to use this smaller example instead:

```
sage: E = mwrank_EllipticCurve([0, 0, 0, -391, 0])                                                                                                                                                                           
sage: E.gens()                                                                                                                                                                                                               
[[196, 2730, 1]]
sage: E.saturate()                                                                                                                                                                                                           
sage: E.gens()                                                                                                                                                                                                               
[[196, 2730, 1]]
```



---

archive/issue_comments_504859.json:
```json
{
    "body": "<div id=\"comment:110\" align=\"right\">comment:110</div>\n\nI've just built Sage 9.4.beta3 with this ticket on a 32-bit box, and checked that the following works:\n\n```diff\n--- a/src/sage/libs/eclib/interface.py\n+++ b/src/sage/libs/eclib/interface.py\n@@ -553,7 +553,9 @@ class mwrank_EllipticCurve(SageObject):\n \n             sage: E = mwrank_EllipticCurve([0, 0, 0, -1002231243161, 0])\n             sage: E.gens()\n-            [[-1001107, -4004428, 1]]\n+            [[-1001107, -4004428, 1]] # 64-bit\n+            ...                       # 32-bit\n+            [[-1001107, -4004428, 1]] # 32-bit\n             sage: E.saturate()\n             sage: E.gens()\n             [[-1001107, -4004428, 1]]\n```\n\nI can give you access to the box (well, it's old and slow) if you send me your public ssh key.",
    "created_at": "2021-06-24T10:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504859",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:110" align="right">comment:110</div>

I've just built Sage 9.4.beta3 with this ticket on a 32-bit box, and checked that the following works:

```diff
--- a/src/sage/libs/eclib/interface.py
+++ b/src/sage/libs/eclib/interface.py
@@ -553,7 +553,9 @@ class mwrank_EllipticCurve(SageObject):
 
             sage: E = mwrank_EllipticCurve([0, 0, 0, -1002231243161, 0])
             sage: E.gens()
-            [[-1001107, -4004428, 1]]
+            [[-1001107, -4004428, 1]] # 64-bit
+            ...                       # 32-bit
+            [[-1001107, -4004428, 1]] # 32-bit
             sage: E.saturate()
             sage: E.gens()
             [[-1001107, -4004428, 1]]
```

I can give you access to the box (well, it's old and slow) if you send me your public ssh key.



---

archive/issue_comments_504860.json:
```json
{
    "body": "<div id=\"comment:111\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bed91d083c7a6b97b37a4af18579be9cedb80e2\"><code>7bed91d</code></a></td><td><code>allow 32-bit boxes to complain</code></td></tr></table>\n",
    "created_at": "2021-06-24T10:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504860",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:111"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bed91d083c7a6b97b37a4af18579be9cedb80e2"><code>7bed91d</code></a></td><td><code>allow 32-bit boxes to complain</code></td></tr></table>




---

archive/issue_comments_504861.json:
```json
{
    "body": "Changed commit from **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)** to **[`7bed91d`](https://github.com/sagemath/sagetrac-mirror/commit/7bed91d083c7a6b97b37a4af18579be9cedb80e2)**",
    "created_at": "2021-06-24T10:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504861",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b50d9c6`](https://github.com/sagemath/sagetrac-mirror/commit/b50d9c6047c1ad5167af7db8a8127f72ab18a853)** to **[`7bed91d`](https://github.com/sagemath/sagetrac-mirror/commit/7bed91d083c7a6b97b37a4af18579be9cedb80e2)**



---

archive/issue_events_430285.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-24T10:07:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430285"
}
```



---

archive/issue_events_430286.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-24T10:08:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430286"
}
```



---

archive/issue_events_430287.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-24T10:08:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430287"
}
```



---

archive/issue_events_430288.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-06-24T13:25:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430288"
}
```



---

archive/issue_events_430289.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-06-24T13:25:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430289"
}
```



---

archive/issue_comments_504862.json:
```json
{
    "body": "<div id=\"comment:114\" align=\"right\">comment:114</div>\n\nI am tempted let this stand as is, but the warning line which 32-bit machines output could be fatal in that the code has attempted to convert a multiprecision integer to a long int (which is 64-bit or 32-bit, depending), and fails since 2004462486322 has 41 bits.  The conversion function returns 0. So the output cannot be trusted, though here it does not give an incorrect result.\n\nI have tracked down exactly where in eclib code this conversion happens.  It is in a new piece of code in this version of eclib.  It may occur when there are primes of bad reduction greater than (about) 2^31 (or 2^63).  A better solution which I can do here is to use multiprecision integers in one place where I did not, so I will make that change and make a new eclib version.\n\nThanks anyway, Dima.",
    "created_at": "2021-06-24T13:25:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504862",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:114" align="right">comment:114</div>

I am tempted let this stand as is, but the warning line which 32-bit machines output could be fatal in that the code has attempted to convert a multiprecision integer to a long int (which is 64-bit or 32-bit, depending), and fails since 2004462486322 has 41 bits.  The conversion function returns 0. So the output cannot be trusted, though here it does not give an incorrect result.

I have tracked down exactly where in eclib code this conversion happens.  It is in a new piece of code in this version of eclib.  It may occur when there are primes of bad reduction greater than (about) 2^31 (or 2^63).  A better solution which I can do here is to use multiprecision integers in one place where I did not, so I will make that change and make a new eclib version.

Thanks anyway, Dima.



---

archive/issue_comments_504863.json:
```json
{
    "body": "<div id=\"comment:115\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7bed91d083c7a6b97b37a4af18579be9cedb80e2\"><code>7bed91d</code></a></td><td><code>allow 32-bit boxes to complain</code></td></tr></table>\n",
    "created_at": "2021-06-25T10:37:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504863",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:115"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7bed91d083c7a6b97b37a4af18579be9cedb80e2"><code>7bed91d</code></a></td><td><code>allow 32-bit boxes to complain</code></td></tr></table>




---

archive/issue_comments_504864.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n \n Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).\n \n-New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210503/eclib-20210503.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210503/eclib-20210503.tar.bz2)\n+New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210625/eclib-20210625.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210625/eclib-20210625.tar.bz2)\n``````\n",
    "created_at": "2021-06-25T10:37:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504864",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 
 Incidentally, Sage has its own implementation of the same underlying algorithm for elliptic curves over number fields, as as well as all the above, there should be a parameter called 'implementation' which could be either 'sage' or 'eclib' (or 'pari' before long).
 
-New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210503/eclib-20210503.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210503/eclib-20210503.tar.bz2)
+New eclib source tarball at [https://github.com/JohnCremona/eclib/releases/download/20210625/eclib-20210625.tar.bz2](https://github.com/JohnCremona/eclib/releases/download/20210625/eclib-20210625.tar.bz2)
``````




---

archive/issue_comments_504865.json:
```json
{
    "body": "<div id=\"comment:116\" align=\"right\">comment:116</div>\n\nI'll revert that cosmetic 32-bit fix since after fixing the underlying issue in eclib (new version 20210625) it will not be needed.  New patch up soon.",
    "created_at": "2021-06-25T10:38:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504865",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:116" align="right">comment:116</div>

I'll revert that cosmetic 32-bit fix since after fixing the underlying issue in eclib (new version 20210625) it will not be needed.  New patch up soon.



---

archive/issue_comments_504866.json:
```json
{
    "body": "<div id=\"comment:117\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2c5b93b54fc3286b744b593fb0f1d2d77ec460d8\"><code>2c5b93b</code></a></td><td><code>Merge branch 'develop' into eclib31443</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1871cab5ff4d6d1e99dccf702fd4705a7a6d056\"><code>c1871ca</code></a></td><td><code>Merge branch 'public/packages/eclib/31443' of trac.sagemath.org:sage into eclib31443</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038\"><code>789550c</code></a></td><td><code>31443 updated for eclib version 20210625</code></td></tr></table>\n",
    "created_at": "2021-06-25T12:51:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504866",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:117"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2c5b93b54fc3286b744b593fb0f1d2d77ec460d8"><code>2c5b93b</code></a></td><td><code>Merge branch 'develop' into eclib31443</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1871cab5ff4d6d1e99dccf702fd4705a7a6d056"><code>c1871ca</code></a></td><td><code>Merge branch 'public/packages/eclib/31443' of trac.sagemath.org:sage into eclib31443</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038"><code>789550c</code></a></td><td><code>31443 updated for eclib version 20210625</code></td></tr></table>




---

archive/issue_comments_504867.json:
```json
{
    "body": "Changed commit from **[`7bed91d`](https://github.com/sagemath/sagetrac-mirror/commit/7bed91d083c7a6b97b37a4af18579be9cedb80e2)** to **[`789550c`](https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038)**",
    "created_at": "2021-06-25T12:51:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504867",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7bed91d`](https://github.com/sagemath/sagetrac-mirror/commit/7bed91d083c7a6b97b37a4af18579be9cedb80e2)** to **[`789550c`](https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038)**



---

archive/issue_comments_504868.json:
```json
{
    "body": "<div id=\"comment:118\" align=\"right\">comment:118</div>\n\nThis version should pass OK on 32-bit and 64.",
    "created_at": "2021-06-25T14:05:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504868",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:118" align="right">comment:118</div>

This version should pass OK on 32-bit and 64.



---

archive/issue_events_430290.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-06-25T14:05:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430290"
}
```



---

archive/issue_events_430291.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2021-06-25T14:05:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430291"
}
```



---

archive/issue_events_430292.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-25T19:32:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430292"
}
```



---

archive/issue_events_430293.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2021-06-25T19:32:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430293"
}
```



---

archive/issue_comments_504869.json:
```json
{
    "body": "<div id=\"comment:119\" align=\"right\">comment:119</div>\n\nboth on 32 and 64 bits I get this error:\n\n```\nsage -t --random-seed=0 src/sage/rings/number_field/number_field_ideal.py\n**********************************************************************\nFile \"src/sage/rings/number_field/number_field_ideal.py\", line 2199, in sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues\nFailed example:\n    list(K.ideal(8).invertible_residues())[:5]\nExpected:\n    [1, a - 1, -3*a, -2*a + 3, -a - 1]\nGot:\n    [1, a + 2, 3*a + 3, -2*a + 3, a]\n```\n\nbut this does not seem to be related to eclib. Positive review.",
    "created_at": "2021-06-25T19:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504869",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:119" align="right">comment:119</div>

both on 32 and 64 bits I get this error:

```
sage -t --random-seed=0 src/sage/rings/number_field/number_field_ideal.py
**********************************************************************
File "src/sage/rings/number_field/number_field_ideal.py", line 2199, in sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues
Failed example:
    list(K.ideal(8).invertible_residues())[:5]
Expected:
    [1, a - 1, -3*a, -2*a + 3, -a - 1]
Got:
    [1, a + 2, 3*a + 3, -2*a + 3, a]
```

but this does not seem to be related to eclib. Positive review.



---

archive/issue_comments_504870.json:
```json
{
    "body": "<div id=\"comment:120\" align=\"right\">comment:120</div>\n\nThanks -- and you are right, that error cannot have anything to do with eclib.  Though I wrote that function and test -- it uses pari.  Probably a good idea to sort the result of this method (which just calls a more general one which returns an iterator).",
    "created_at": "2021-06-25T20:15:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504870",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:120" align="right">comment:120</div>

Thanks -- and you are right, that error cannot have anything to do with eclib.  Though I wrote that function and test -- it uses pari.  Probably a good idea to sort the result of this method (which just calls a more general one which returns an iterator).



---

archive/issue_comments_504871.json:
```json
{
    "body": "<div id=\"comment:121\" align=\"right\">comment:121</div>\n\nReplying to [@JohnCremona](#comment%3A120):\n> Thanks -- and you are right, that error cannot have anything to do with eclib.  Though I wrote that function and test -- it uses pari.  Probably a good idea to sort the result of this method (which just calls a more general one which returns an iterator).\n\nit is not just sorting - the sets are not the same!",
    "created_at": "2021-06-25T20:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504871",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:121" align="right">comment:121</div>

Replying to [@JohnCremona](#comment%3A120):
> Thanks -- and you are right, that error cannot have anything to do with eclib.  Though I wrote that function and test -- it uses pari.  Probably a good idea to sort the result of this method (which just calls a more general one which returns an iterator).

it is not just sorting - the sets are not the same!



---

archive/issue_comments_504872.json:
```json
{
    "body": "<div id=\"comment:122\" align=\"right\">comment:122</div>\n\nA better test would be that the list contains 48 elements, namely x+y*a for x,y in range(8) not both even, up to congruence mod 8. Which is a bit messy, but writing such a test now would save having to go through all this again next time there's any change in pari.  Say\n\n```\nsage: L = K.ideal(8).invertible_residues()                                                                                                                                       \nsage: L1 = {(x%8,y%8) for x,y in L}                                                                                                                                              \nsage: L2 = {(x,y) for x in range(8) for y in range(8) if (x%2,y%2) != (0,0)}                                                                                                     \nsage: assert L1==L2 \n```\nor just\n\n```\nsage: {(x%8,y%8) for x,y in K.ideal(8).invertible_residues()} == {(x,y) for x in range(8) for y in range(8) if (x%2,y%2) != (0,0)}                                               \nTrue\n```\n\n-- but on a separate ticket!",
    "created_at": "2021-06-26T13:30:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504872",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:122" align="right">comment:122</div>

A better test would be that the list contains 48 elements, namely x+y*a for x,y in range(8) not both even, up to congruence mod 8. Which is a bit messy, but writing such a test now would save having to go through all this again next time there's any change in pari.  Say

```
sage: L = K.ideal(8).invertible_residues()                                                                                                                                       
sage: L1 = {(x%8,y%8) for x,y in L}                                                                                                                                              
sage: L2 = {(x,y) for x in range(8) for y in range(8) if (x%2,y%2) != (0,0)}                                                                                                     
sage: assert L1==L2 
```
or just

```
sage: {(x%8,y%8) for x,y in K.ideal(8).invertible_residues()} == {(x,y) for x in range(8) for y in range(8) if (x%2,y%2) != (0,0)}                                               
True
```

-- but on a separate ticket!



---

archive/issue_comments_504873.json:
```json
{
    "body": "Changed branch from **[public/packages/eclib/31443](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/eclib/31443)** to **[`789550c`](https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038)**",
    "created_at": "2021-06-29T23:08:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504873",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/packages/eclib/31443](https://github.com/sagemath/sagetrac-mirror/tree/public/packages/eclib/31443)** to **[`789550c`](https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038)**



---

archive/issue_events_430294.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-29T23:08:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430294"
}
```



---

archive/issue_events_430295.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "af77aabbc70586005d90881b7174ecae88f18837",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-06-29T23:08:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31443#event-430295"
}
```



---

archive/issue_comments_504874.json:
```json
{
    "body": "Changed commit from **[`789550c`](https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038)** to none",
    "created_at": "2021-07-02T07:13:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504874",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`789550c`](https://github.com/sagemath/sagetrac-mirror/commit/789550ca04c94acfb1e803251538996a34962038)** to none



---

archive/issue_comments_504875.json:
```json
{
    "body": "<div id=\"comment:124\" align=\"right\">comment:124</div>\n\nThis update appears to have broken `ubuntu-trusty`. https://github.com/sagemath/sage/runs/2967004002?check_suite_focus=true\n\n```\n/bin/bash ../libtool  --tag=CXX   --mode=compile g++ -std=gnu++11 -DPACKAGE_NAME=\\\"eclib\\\" -DPACKAGE_TARNAME=\\\"eclib\\\" -DPACKAGE_VERSION=\\\"20210625\\\" -DPACKAGE_STRING=\\\"eclib\\ 20210625\\\" -DPACKAGE_BUGREPORT=\\\"john.cremona@gmail.com\\\" -DPACKAGE_URL=\\\"\\\" -DPACKAGE=\\\"eclib\\\" -DVERSION=\\\"20210625\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\\\".libs/\\\" -DHAVE_CXX11=1 -DHAVE_PTHREAD_PRIO_INHERIT=1 -DHAVE_PTHREAD=1 -DHAVE_ALLOCA_H=1 -DHAVE_ALLOCA=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_UNISTD_H=1 -DHAVE__BOOL=1 -DHAVE_STDBOOL_H=1 -Drestrict=__restrict -DHAVE_MEMMOVE=1 -DHAVE_MEMSET=1 -DHAVE_STRCHR=1 -I.  -DFLINT_LEVEL=1 -I/sage/local/include -I/sage/local/include -I/sage/local/include   -pthread   -O2 -g  -c -o isogs.lo isogs.cc\nlibtool: compile:  g++ -std=gnu++11 -DPACKAGE_NAME=\\\"eclib\\\" -DPACKAGE_TARNAME=\\\"eclib\\\" -DPACKAGE_VERSION=\\\"20210625\\\" \"-DPACKAGE_STRING=\\\"eclib 20210625\\\"\" -DPACKAGE_BUGREPORT=\\\"john.cremona@gmail.com\\\" -DPACKAGE_URL=\\\"\\\" -DPACKAGE=\\\"eclib\\\" -DVERSION=\\\"20210625\\\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\\\".libs/\\\" -DHAVE_CXX11=1 -DHAVE_PTHREAD_PRIO_INHERIT=1 -DHAVE_PTHREAD=1 -DHAVE_ALLOCA_H=1 -DHAVE_ALLOCA=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_UNISTD_H=1 -DHAVE__BOOL=1 -DHAVE_STDBOOL_H=1 -Drestrict=__restrict -DHAVE_MEMMOVE=1 -DHAVE_MEMSET=1 -DHAVE_STRCHR=1 -I. -DFLINT_LEVEL=1 -I/sage/local/include -I/sage/local/include -I/sage/local/include -pthread -O2 -g -c isogs.cc  -fPIC -DPIC -o .libs/isogs.o\nIn file included from /usr/include/c++/4.8/algorithm:62:0,\n                 from ./eclib/interface.h:43,\n                 from ./eclib/arith.h:27,\n                 from ./eclib/marith.h:27,\n                 from ./eclib/gf.h:29,\n                 from ./eclib/polys.h:31,\n                 from ./eclib/points.h:30,\n                 from points.cc:26:\n/usr/include/c++/4.8/bits/stl_algo.h: In instantiation of '_RandomAccessIterator std::__unguarded_partition(_RandomAccessIterator, _RandomAccessIterator, const _Tp&, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Point*, std::vector<Point> >; _Tp = Point; _Compare = Point_comparer]':\n/usr/include/c++/4.8/bits/stl_algo.h:2296:78:   required from '_RandomAccessIterator std::__unguarded_partition_pivot(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Point*, std::vector<Point> >; _Compare = Point_comparer]'\n/usr/include/c++/4.8/bits/stl_algo.h:2337:62:   required from 'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Point*, std::vector<Point> >; _Size = long int; _Compare = Point_comparer]'\n/usr/include/c++/4.8/bits/stl_algo.h:5499:44:   required from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<Point*, std::vector<Point> >; _Compare = Point_comparer]'\npoints.cc:404:53:   required from here\n/usr/include/c++/4.8/bits/stl_algo.h:2263:35: error: no match for call to '(Point_comparer) (Point&, const Point&)'\n    while (__comp(*__first, __pivot))\n                                   ^\npoints.cc:307:8: note: candidate is:\n struct Point_comparer {\n        ^\npoints.cc:308:8: note: bool Point_comparer::operator()(Point&, Point&)\n   bool operator()(Point& P, Point& Q)\n        ^\npoints.cc:308:8: note:   no known conversion for argument 2 from 'const Point' to 'Point&'\nIn file included from /usr/include/c++/4.8/algorithm:62:0,\n                 from ./eclib/interface.h:43,\n                 from ./eclib/arith.h:27,\n                 from ./eclib/marith.h:27,\n                 from ./eclib/gf.h:29,\n                 from ./eclib/polys.h:31,\n                 from ./eclib/points.h:30,\n                 from points.cc:26:\n/usr/include/c++/4.8/bits/stl_algo.h:2266:34: error: no match for call to '(Point_comparer) (const Point&, Point&)'\n    while (__comp(__pivot, *__last))\n                                  ^\npoints.cc:307:8: note: candidate is:\n struct Point_comparer {\n        ^\npoints.cc:308:8: note: bool Point_comparer::operator()(Point&, Point&)\n   bool operator()(Point& P, Point& Q)\n        ^\npoints.cc:308:8: note:   no known conversion for argument 1 from 'const Point' to 'Point&'\nmake[4]: *** [points.lo] Error 1\n```",
    "created_at": "2021-07-02T07:13:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504875",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:124" align="right">comment:124</div>

This update appears to have broken `ubuntu-trusty`. https://github.com/sagemath/sage/runs/2967004002?check_suite_focus=true

```
/bin/bash ../libtool  --tag=CXX   --mode=compile g++ -std=gnu++11 -DPACKAGE_NAME=\"eclib\" -DPACKAGE_TARNAME=\"eclib\" -DPACKAGE_VERSION=\"20210625\" -DPACKAGE_STRING=\"eclib\ 20210625\" -DPACKAGE_BUGREPORT=\"john.cremona@gmail.com\" -DPACKAGE_URL=\"\" -DPACKAGE=\"eclib\" -DVERSION=\"20210625\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\".libs/\" -DHAVE_CXX11=1 -DHAVE_PTHREAD_PRIO_INHERIT=1 -DHAVE_PTHREAD=1 -DHAVE_ALLOCA_H=1 -DHAVE_ALLOCA=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_UNISTD_H=1 -DHAVE__BOOL=1 -DHAVE_STDBOOL_H=1 -Drestrict=__restrict -DHAVE_MEMMOVE=1 -DHAVE_MEMSET=1 -DHAVE_STRCHR=1 -I.  -DFLINT_LEVEL=1 -I/sage/local/include -I/sage/local/include -I/sage/local/include   -pthread   -O2 -g  -c -o isogs.lo isogs.cc
libtool: compile:  g++ -std=gnu++11 -DPACKAGE_NAME=\"eclib\" -DPACKAGE_TARNAME=\"eclib\" -DPACKAGE_VERSION=\"20210625\" "-DPACKAGE_STRING=\"eclib 20210625\"" -DPACKAGE_BUGREPORT=\"john.cremona@gmail.com\" -DPACKAGE_URL=\"\" -DPACKAGE=\"eclib\" -DVERSION=\"20210625\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\".libs/\" -DHAVE_CXX11=1 -DHAVE_PTHREAD_PRIO_INHERIT=1 -DHAVE_PTHREAD=1 -DHAVE_ALLOCA_H=1 -DHAVE_ALLOCA=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_UNISTD_H=1 -DHAVE__BOOL=1 -DHAVE_STDBOOL_H=1 -Drestrict=__restrict -DHAVE_MEMMOVE=1 -DHAVE_MEMSET=1 -DHAVE_STRCHR=1 -I. -DFLINT_LEVEL=1 -I/sage/local/include -I/sage/local/include -I/sage/local/include -pthread -O2 -g -c isogs.cc  -fPIC -DPIC -o .libs/isogs.o
In file included from /usr/include/c++/4.8/algorithm:62:0,
                 from ./eclib/interface.h:43,
                 from ./eclib/arith.h:27,
                 from ./eclib/marith.h:27,
                 from ./eclib/gf.h:29,
                 from ./eclib/polys.h:31,
                 from ./eclib/points.h:30,
                 from points.cc:26:
/usr/include/c++/4.8/bits/stl_algo.h: In instantiation of '_RandomAccessIterator std::__unguarded_partition(_RandomAccessIterator, _RandomAccessIterator, const _Tp&, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Point*, std::vector<Point> >; _Tp = Point; _Compare = Point_comparer]':
/usr/include/c++/4.8/bits/stl_algo.h:2296:78:   required from '_RandomAccessIterator std::__unguarded_partition_pivot(_RandomAccessIterator, _RandomAccessIterator, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Point*, std::vector<Point> >; _Compare = Point_comparer]'
/usr/include/c++/4.8/bits/stl_algo.h:2337:62:   required from 'void std::__introsort_loop(_RandomAccessIterator, _RandomAccessIterator, _Size, _Compare) [with _RandomAccessIterator = __gnu_cxx::__normal_iterator<Point*, std::vector<Point> >; _Size = long int; _Compare = Point_comparer]'
/usr/include/c++/4.8/bits/stl_algo.h:5499:44:   required from 'void std::sort(_RAIter, _RAIter, _Compare) [with _RAIter = __gnu_cxx::__normal_iterator<Point*, std::vector<Point> >; _Compare = Point_comparer]'
points.cc:404:53:   required from here
/usr/include/c++/4.8/bits/stl_algo.h:2263:35: error: no match for call to '(Point_comparer) (Point&, const Point&)'
    while (__comp(*__first, __pivot))
                                   ^
points.cc:307:8: note: candidate is:
 struct Point_comparer {
        ^
points.cc:308:8: note: bool Point_comparer::operator()(Point&, Point&)
   bool operator()(Point& P, Point& Q)
        ^
points.cc:308:8: note:   no known conversion for argument 2 from 'const Point' to 'Point&'
In file included from /usr/include/c++/4.8/algorithm:62:0,
                 from ./eclib/interface.h:43,
                 from ./eclib/arith.h:27,
                 from ./eclib/marith.h:27,
                 from ./eclib/gf.h:29,
                 from ./eclib/polys.h:31,
                 from ./eclib/points.h:30,
                 from points.cc:26:
/usr/include/c++/4.8/bits/stl_algo.h:2266:34: error: no match for call to '(Point_comparer) (const Point&, Point&)'
    while (__comp(__pivot, *__last))
                                  ^
points.cc:307:8: note: candidate is:
 struct Point_comparer {
        ^
points.cc:308:8: note: bool Point_comparer::operator()(Point&, Point&)
   bool operator()(Point& P, Point& Q)
        ^
points.cc:308:8: note:   no known conversion for argument 1 from 'const Point' to 'Point&'
make[4]: *** [points.lo] Error 1
```



---

archive/issue_comments_504876.json:
```json
{
    "body": "<div id=\"comment:125\" align=\"right\">comment:125</div>\n\nLooks like `Point_comparer::operator()(Point&, Point&)` needs some const-correctness",
    "created_at": "2021-07-02T07:18:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504876",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:125" align="right">comment:125</div>

Looks like `Point_comparer::operator()(Point&, Point&)` needs some const-correctness



---

archive/issue_comments_504877.json:
```json
{
    "body": "<div id=\"comment:126\" align=\"right\">comment:126</div>\n\nI will look at that but I hope we will not have to reopen this ticket. The code has passed with both gcc and clang using github-actions.\n\nThe Point_comparer is used to sort lists of torsion points (finite order) and uses the point's order as the first comparator, but calling order(P) has a side-effect of caching the order in P if it was not already there, so cannot be called on a const point.  Of course I could use copies within the comparer.\n\nWould this change get around the issue?\n\n```\ndiff --git a/libsrc/points.cc b/libsrc/points.cc\nindex 1c612f4..714b73d 100644\n--- a/libsrc/points.cc\n+++ b/libsrc/points.cc\n@@ -305,8 +305,9 @@ vector<Point> points_from_x(Curvedata &E, const bigrational& x)\n // (4) y-coordinate\n \n struct Point_comparer {\n-  bool operator()(Point& P, Point& Q)\n+  bool operator()(const Point& P0, const Point& Q0)\n   {\n+    Point P(P0), Q(Q0); // take copies as args must be const but order() requires non-const\n     int s = order(P)-order(Q);\n     if(s) return (s<0); // true if P has smaller order\n     bigint t = P.getZ()-Q.getZ();\n```\n\n\"trusty\" is ubuntu 14.04 I think....",
    "created_at": "2021-07-02T10:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504877",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:126" align="right">comment:126</div>

I will look at that but I hope we will not have to reopen this ticket. The code has passed with both gcc and clang using github-actions.

The Point_comparer is used to sort lists of torsion points (finite order) and uses the point's order as the first comparator, but calling order(P) has a side-effect of caching the order in P if it was not already there, so cannot be called on a const point.  Of course I could use copies within the comparer.

Would this change get around the issue?

```
diff --git a/libsrc/points.cc b/libsrc/points.cc
index 1c612f4..714b73d 100644
--- a/libsrc/points.cc
+++ b/libsrc/points.cc
@@ -305,8 +305,9 @@ vector<Point> points_from_x(Curvedata &E, const bigrational& x)
 // (4) y-coordinate
 
 struct Point_comparer {
-  bool operator()(Point& P, Point& Q)
+  bool operator()(const Point& P0, const Point& Q0)
   {
+    Point P(P0), Q(Q0); // take copies as args must be const but order() requires non-const
     int s = order(P)-order(Q);
     if(s) return (s<0); // true if P has smaller order
     bigint t = P.getZ()-Q.getZ();
```

"trusty" is ubuntu 14.04 I think....



---

archive/issue_comments_504878.json:
```json
{
    "body": "<div id=\"comment:127\" align=\"right\">comment:127</div>\n\nThanks, this patch fixes it. I have opened #32101 - I would just put this in as a patch.\n\nYes, `ubuntu-trusty` is ancient and we will likely drop support for it at some point (a recent discussion appeared in #32074).",
    "created_at": "2021-07-02T17:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504878",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:127" align="right">comment:127</div>

Thanks, this patch fixes it. I have opened #32101 - I would just put this in as a patch.

Yes, `ubuntu-trusty` is ancient and we will likely drop support for it at some point (a recent discussion appeared in #32074).



---

archive/issue_comments_504879.json:
```json
{
    "body": "<div id=\"comment:128\" align=\"right\">comment:128</div>\n\nReplying to [@dimpase](#comment%3A119):\n> both on 32 and 64 bits I get this error:\n> \n> ```\n> sage -t --random-seed=0 src/sage/rings/number_field/number_field_ideal.py\n> **********************************************************************\n> File \"src/sage/rings/number_field/number_field_ideal.py\", line 2199, in sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues\n> Failed example:\n>     list(K.ideal(8).invertible_residues())[:5]\n> Expected:\n>     [1, a - 1, -3*a, -2*a + 3, -a - 1]\n> Got:\n>     [1, a + 2, 3*a + 3, -2*a + 3, a]\n> ```\n\nThis is now #32165.",
    "created_at": "2021-07-08T20:25:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31443#issuecomment-504879",
    "user": "https://github.com/mwageringel"
}
```

<div id="comment:128" align="right">comment:128</div>

Replying to [@dimpase](#comment%3A119):
> both on 32 and 64 bits I get this error:
> 
> ```
> sage -t --random-seed=0 src/sage/rings/number_field/number_field_ideal.py
> **********************************************************************
> File "src/sage/rings/number_field/number_field_ideal.py", line 2199, in sage.rings.number_field.number_field_ideal.NumberFieldFractionalIdeal.invertible_residues
> Failed example:
>     list(K.ideal(8).invertible_residues())[:5]
> Expected:
>     [1, a - 1, -3*a, -2*a + 3, -a - 1]
> Got:
>     [1, a + 2, 3*a + 3, -2*a + 3, a]
> ```

This is now #32165.
