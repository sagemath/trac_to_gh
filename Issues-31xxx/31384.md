# Issue 31384: cython_aliases: Do not fail if one of the listed libraries is not known to pkgconfig

archive/issues_031147.json:
```json
{
    "assignees": [],
    "body": "(split out from #30371)\n\nThis helps with the modularization effort.\n\n\nCC:  @isuruf @kiwifb @antonio-rojas @collares @tobihan @infinity0\n\nBranch/Commit: **[`3cb8f90`](https://github.com/sagemath/sagetrac-mirror/commit/3cb8f901fc8ce87f8c01e63b0a6768eb6a008d33)**\n\nReviewer: **Matthias Koeppe, Jonathan Kliem**\n\nAuthor: **Tobias Diez, Matthias Koeppe**\n\nComponent: **build: configure**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31384_\n\n",
    "closed_at": "2021-05-27T20:29:53Z",
    "created_at": "2021-02-11T22:04:18Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "cython_aliases: Do not fail if one of the listed libraries is not known to pkgconfig",
    "type": "issue",
    "updated_at": "2021-05-27T20:29:53Z",
    "url": "https://github.com/sagemath/sage/issues/31384",
    "user": "https://github.com/mkoeppe"
}
```
(split out from #30371)

This helps with the modularization effort.


CC:  @isuruf @kiwifb @antonio-rojas @collares @tobihan @infinity0

Branch/Commit: **[`3cb8f90`](https://github.com/sagemath/sagetrac-mirror/commit/3cb8f901fc8ce87f8c01e63b0a6768eb6a008d33)**

Reviewer: **Matthias Koeppe, Jonathan Kliem**

Author: **Tobias Diez, Matthias Koeppe**

Component: **build: configure**

_Issue created by migration from https://trac.sagemath.org/ticket/31384_





---

archive/issue_events_432560.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-11T22:04:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432560"
}
```



---

archive/issue_events_432561.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-11T22:04:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build%3A%20configure",
    "label_color": "000080",
    "label_name": "c: build: configure",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432561"
}
```



---

archive/issue_events_432562.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-11T22:04:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432562"
}
```



---

archive/issue_events_432563.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-11T22:04:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432563"
}
```



---

archive/issue_comments_503621.json:
```json
{
    "body": "Branch: **[u/mkoeppe/cython_aliases__do_not_fail_if_one_of_the_listed_libraries_is_not_known_to_pkgconfig](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/cython_aliases__do_not_fail_if_one_of_the_listed_libraries_is_not_known_to_pkgconfig)**",
    "created_at": "2021-02-11T22:09:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503621",
    "user": "https://github.com/mkoeppe"
}
```

Branch: **[u/mkoeppe/cython_aliases__do_not_fail_if_one_of_the_listed_libraries_is_not_known_to_pkgconfig](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/cython_aliases__do_not_fail_if_one_of_the_listed_libraries_is_not_known_to_pkgconfig)**



---

archive/issue_comments_503622.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dace12540c32b28990e702a71cd3273fcb78f089\">dace125</a></td><td><code>sage.env.cython_aliases: Do not fail if one of the listed libraries is not known to pkgconfig</code></td></tr></table>\n",
    "created_at": "2021-02-11T22:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503622",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dace12540c32b28990e702a71cd3273fcb78f089">dace125</a></td><td><code>sage.env.cython_aliases: Do not fail if one of the listed libraries is not known to pkgconfig</code></td></tr></table>




---

archive/issue_comments_503623.json:
```json
{
    "body": "Commit: **[`dace125`](https://github.com/sagemath/sagetrac-mirror/commit/dace12540c32b28990e702a71cd3273fcb78f089)**",
    "created_at": "2021-02-11T22:09:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503623",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`dace125`](https://github.com/sagemath/sagetrac-mirror/commit/dace12540c32b28990e702a71cd3273fcb78f089)**



---

archive/issue_events_432564.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-11T22:11:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432564"
}
```



---

archive/issue_comments_503624.json:
```json
{
    "body": "Reviewer: **Matthias Koeppe**",
    "created_at": "2021-02-11T22:11:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503624",
    "user": "https://github.com/mkoeppe"
}
```

Reviewer: **Matthias Koeppe**



---

archive/issue_comments_503625.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nWhat did you need this for exactly in #30371?\n\nFor modularization we certainly need something like this; but I think when building all modules, with this patch the unresolved cython aliases will just stay as is and cause errors later.",
    "created_at": "2021-02-11T22:20:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503625",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:4" align="right">comment:4</div>

What did you need this for exactly in #30371?

For modularization we certainly need something like this; but I think when building all modules, with this patch the unresolved cython aliases will just stay as is and cause errors later.



---

archive/issue_events_432565.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-12T01:06:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432565"
}
```



---

archive/issue_events_432566.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-12T01:06:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432566"
}
```



---

archive/issue_comments_503626.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI changed this during my experiments where I tried to have everything work without any previous built sage's packages. So it's not needed for #30371.",
    "created_at": "2021-02-12T17:42:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503626",
    "user": "https://github.com/tobiasdiez"
}
```

<div id="comment:6" align="right">comment:6</div>

I changed this during my experiments where I tried to have everything work without any previous built sage's packages. So it's not needed for #30371.



---

archive/issue_comments_503627.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThanks! Then I will rework this ticket for the purposes of modularization, making the list of needed libraries an input.",
    "created_at": "2021-02-12T17:45:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503627",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:7" align="right">comment:7</div>

Thanks! Then I will rework this ticket for the purposes of modularization, making the list of needed libraries an input.



---

archive/issue_events_432567.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-12T17:45:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432567"
}
```



---

archive/issue_events_432568.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-12T17:45:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432568"
}
```



---

archive/issue_comments_503628.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-15T22:07:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503628",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_432569.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432569"
}
```



---

archive/issue_events_432570.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-15T22:07:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432570"
}
```



---

archive/issue_events_432571.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-22T20:33:05Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432571"
}
```



---

archive/issue_events_432572.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-22T20:33:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432572"
}
```



---

archive/issue_comments_503629.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nA version of this is needed for Sage 9.3: Since #29706, `cython_aliases` insists to find `lapack.pc` even though no `LAPACK_...` aliases are used anywhere in `src/`.\nIn the Sage distribution, of course, we have that; but it fails for example in conda when testing without build of the Sage distribution.",
    "created_at": "2021-03-22T20:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503629",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:10" align="right">comment:10</div>

A version of this is needed for Sage 9.3: Since #29706, `cython_aliases` insists to find `lapack.pc` even though no `LAPACK_...` aliases are used anywhere in `src/`.
In the Sage distribution, of course, we have that; but it fails for example in conda when testing without build of the Sage distribution.



---

archive/issue_comments_503630.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\n(Related previous ticket: #30706)",
    "created_at": "2021-03-22T20:44:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503630",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:11" align="right">comment:11</div>

(Related previous ticket: #30706)



---

archive/issue_comments_503631.json:
```json
{
    "body": "Changed commit from **[`dace125`](https://github.com/sagemath/sagetrac-mirror/commit/dace12540c32b28990e702a71cd3273fcb78f089)** to **[`4f42440`](https://github.com/sagemath/sagetrac-mirror/commit/4f4244004e7a2ad1da1f33d5151f77fb1e3137f1)**",
    "created_at": "2021-03-22T20:50:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503631",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`dace125`](https://github.com/sagemath/sagetrac-mirror/commit/dace12540c32b28990e702a71cd3273fcb78f089)** to **[`4f42440`](https://github.com/sagemath/sagetrac-mirror/commit/4f4244004e7a2ad1da1f33d5151f77fb1e3137f1)**



---

archive/issue_comments_503632.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f4244004e7a2ad1da1f33d5151f77fb1e3137f1\">4f42440</a></td><td><code>sage.env.cython_aliases: Do not fail if one of the listed libraries is not known to pkgconfig</code></td></tr></table>\n",
    "created_at": "2021-03-22T20:50:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503632",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f4244004e7a2ad1da1f33d5151f77fb1e3137f1">4f42440</a></td><td><code>sage.env.cython_aliases: Do not fail if one of the listed libraries is not known to pkgconfig</code></td></tr></table>




---

archive/issue_comments_503633.json:
```json
{
    "body": "Changed commit from **[`4f42440`](https://github.com/sagemath/sagetrac-mirror/commit/4f4244004e7a2ad1da1f33d5151f77fb1e3137f1)** to **[`3cb8f90`](https://github.com/sagemath/sagetrac-mirror/commit/3cb8f901fc8ce87f8c01e63b0a6768eb6a008d33)**",
    "created_at": "2021-03-22T21:41:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503633",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4f42440`](https://github.com/sagemath/sagetrac-mirror/commit/4f4244004e7a2ad1da1f33d5151f77fb1e3137f1)** to **[`3cb8f90`](https://github.com/sagemath/sagetrac-mirror/commit/3cb8f901fc8ce87f8c01e63b0a6768eb6a008d33)**



---

archive/issue_comments_503634.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3cb8f901fc8ce87f8c01e63b0a6768eb6a008d33\">3cb8f90</a></td><td><code>sage.env.cython_aliases: Make module lapack optional; generalize the interface</code></td></tr></table>\n",
    "created_at": "2021-03-22T21:41:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503634",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3cb8f901fc8ce87f8c01e63b0a6768eb6a008d33">3cb8f90</a></td><td><code>sage.env.cython_aliases: Make module lapack optional; generalize the interface</code></td></tr></table>




---

archive/issue_comments_503635.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIf any changes in `cython_aliases` would eliminate downstream patching, now would be the time...",
    "created_at": "2021-03-22T21:44:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503635",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:14" align="right">comment:14</div>

If any changes in `cython_aliases` would eliminate downstream patching, now would be the time...



---

archive/issue_events_432573.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-22T21:44:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432573"
}
```



---

archive/issue_events_432574.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-03-22T21:44:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432574"
}
```



---

archive/issue_comments_503636.json:
```json
{
    "body": "Changed author from **Tobias Diez** to **Tobias Diez, Matthias Koeppe**",
    "created_at": "2021-03-22T21:44:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503636",
    "user": "https://github.com/mkoeppe"
}
```

Changed author from **Tobias Diez** to **Tobias Diez, Matthias Koeppe**



---

archive/issue_comments_503637.json:
```json
{
    "body": "Changed reviewer from **Matthias Koeppe** to **Matthias Koeppe, ...**",
    "created_at": "2021-03-22T21:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503637",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Matthias Koeppe** to **Matthias Koeppe, ...**



---

archive/issue_comments_503638.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI don't know about other distros but Gentoo is good. This particular section hasn't needed patching in some time here.",
    "created_at": "2021-03-22T21:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503638",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:16" align="right">comment:16</div>

I don't know about other distros but Gentoo is good. This particular section hasn't needed patching in some time here.



---

archive/issue_comments_503639.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nDebian has a relevant patch: https://sources.debian.org/patches/sagemath/9.2-2/d0-gsl-cblas.patch/",
    "created_at": "2021-03-23T06:09:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503639",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:17" align="right">comment:17</div>

Debian has a relevant patch: https://sources.debian.org/patches/sagemath/9.2-2/d0-gsl-cblas.patch/



---

archive/issue_comments_503640.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThey are enforcing using gslcblas as their cblas library. That's a bit surprising and shocking. Their own comment is confusing, they seem to think gslcblas should be used which is not the case.\n\nI think it could be nice to provide them with a fallback option that could be provided by sage_conf.py if pkg-config cannot find a cblas module. Someone knowing more about what .pc files debian provides should comment.",
    "created_at": "2021-03-23T07:25:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503640",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:18" align="right">comment:18</div>

They are enforcing using gslcblas as their cblas library. That's a bit surprising and shocking. Their own comment is confusing, they seem to think gslcblas should be used which is not the case.

I think it could be nice to provide them with a fallback option that could be provided by sage_conf.py if pkg-config cannot find a cblas module. Someone knowing more about what .pc files debian provides should comment.



---

archive/issue_comments_503641.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nIn Debian BLAS is managed with the alternatives system (update-alternatives), which allows to install multiple implementations at the same time and define one of them as default.\nAs a result, libblas.so.3, cblas.h and blas.pc are symlinks managed by the alternatives system, so these files do not show up in any package, but they are created as symlinks when any BLAS implementation is installed.\n\nBut no BLAS implementation installs a libcblas.so or cblas.pc. Could it be that this is not really needed and provided by libblas.so together with cblas.h?",
    "created_at": "2021-03-23T19:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503641",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:20" align="right">comment:20</div>

In Debian BLAS is managed with the alternatives system (update-alternatives), which allows to install multiple implementations at the same time and define one of them as default.
As a result, libblas.so.3, cblas.h and blas.pc are symlinks managed by the alternatives system, so these files do not show up in any package, but they are created as symlinks when any BLAS implementation is installed.

But no BLAS implementation installs a libcblas.so or cblas.pc. Could it be that this is not really needed and provided by libblas.so together with cblas.h?



---

archive/issue_comments_503642.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@tobihan](#comment:20):\n> But no BLAS implementation installs a libcblas.so or cblas.pc. Could it be that this is not really needed and provided by libblas.so together with cblas.h?\n\nThat's a Debian specific thing\n\nhttps://salsa.debian.org/science-team/lapack/-/blob/master/debian/README.if-you-look-for-libcblas.so.3\n\nThe unpatched Netlib reference blas implementation does install a libcblas.so library.",
    "created_at": "2021-03-23T19:42:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503642",
    "user": "https://github.com/antonio-rojas"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@tobihan](#comment:20):
> But no BLAS implementation installs a libcblas.so or cblas.pc. Could it be that this is not really needed and provided by libblas.so together with cblas.h?

That's a Debian specific thing

https://salsa.debian.org/science-team/lapack/-/blob/master/debian/README.if-you-look-for-libcblas.so.3

The unpatched Netlib reference blas implementation does install a libcblas.so library.



---

archive/issue_comments_503643.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nOk, then the fallback for Debian should be to use blas.pc and link against libblas.",
    "created_at": "2021-03-23T19:47:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503643",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:22" align="right">comment:22</div>

Ok, then the fallback for Debian should be to use blas.pc and link against libblas.



---

archive/issue_comments_503644.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nSounds fair. If cblas.pc is not found, look for blas.pc instead. It should be doable.",
    "created_at": "2021-03-23T19:54:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503644",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">comment:23</div>

Sounds fair. If cblas.pc is not found, look for blas.pc instead. It should be doable.



---

archive/issue_comments_503645.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nYou can do this already without patching sagelib by setting `CBLAS_PC_MODULES = \"cblas:blas\"` in `sage_conf.py`.",
    "created_at": "2021-03-23T19:55:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503645",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:24" align="right">comment:24</div>

You can do this already without patching sagelib by setting `CBLAS_PC_MODULES = "cblas:blas"` in `sage_conf.py`.



---

archive/issue_comments_503646.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nYes, indeed the mechanics to do that is already there. So many good changes recently :)",
    "created_at": "2021-03-23T20:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503646",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:25" align="right">comment:25</div>

Yes, indeed the mechanics to do that is already there. So many good changes recently :)



---

archive/issue_comments_503647.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nSounds like no further changes are needed on this ticket. Let's get this into 9.3 please",
    "created_at": "2021-03-23T20:13:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503647",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:26" align="right">comment:26</div>

Sounds like no further changes are needed on this ticket. Let's get this into 9.3 please



---

archive/issue_comments_503648.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nLGTM.",
    "created_at": "2021-03-25T07:26:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503648",
    "user": "https://github.com/kliem"
}
```

<div id="comment:27" align="right">comment:27</div>

LGTM.



---

archive/issue_events_432575.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-03-25T07:26:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432575"
}
```



---

archive/issue_events_432576.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-03-25T07:26:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432576"
}
```



---

archive/issue_comments_503649.json:
```json
{
    "body": "Changed reviewer from **Matthias Koeppe, ...** to **Matthias Koeppe, Jonathan Kliem**",
    "created_at": "2021-03-25T07:26:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503649",
    "user": "https://github.com/kliem"
}
```

Changed reviewer from **Matthias Koeppe, ...** to **Matthias Koeppe, Jonathan Kliem**



---

archive/issue_comments_503650.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThanks!",
    "created_at": "2021-03-26T05:52:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503650",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:28" align="right">comment:28</div>

Thanks!



---

archive/issue_events_432577.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-18T16:17:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432577"
}
```



---

archive/issue_events_432578.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-18T16:17:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432578"
}
```



---

archive/issue_comments_503651.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/cython_aliases__do_not_fail_if_one_of_the_listed_libraries_is_not_known_to_pkgconfig](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/cython_aliases__do_not_fail_if_one_of_the_listed_libraries_is_not_known_to_pkgconfig)** to **[`3cb8f90`](https://github.com/sagemath/sagetrac-mirror/commit/3cb8f901fc8ce87f8c01e63b0a6768eb6a008d33)**",
    "created_at": "2021-05-27T20:29:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31384#issuecomment-503651",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/cython_aliases__do_not_fail_if_one_of_the_listed_libraries_is_not_known_to_pkgconfig](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/cython_aliases__do_not_fail_if_one_of_the_listed_libraries_is_not_known_to_pkgconfig)** to **[`3cb8f90`](https://github.com/sagemath/sagetrac-mirror/commit/3cb8f901fc8ce87f8c01e63b0a6768eb6a008d33)**



---

archive/issue_events_432579.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-05-27T20:29:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432579"
}
```



---

archive/issue_events_432580.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3d738182cdb3b8ecdf748ee32c4fe8e869e04d10",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-05-27T20:29:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31384",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31384#event-432580"
}
```
