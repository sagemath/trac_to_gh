# Issue 31086: Fix tensor product of dense matrix by sparse matrix

archive/issues_030849.json:
```json
{
    "assignees": [],
    "body": "The tensor product of a dense matrix by a sparse matrix\nfails for some base rings including cyclotomic fields.\nEverything works fine over `ZZ` or `QQ`.\n\nIllustration in Sage 9.3.beta4:\n\n```\nsage: k = CyclotomicField(3)\nsage: I = identity_matrix(k, 2)\nsage: J = identity_matrix(k, 2, sparse=True)\nsage: J.tensor_product(J)\n[1 0|0 0]\n[0 1|0 0]\n[---+---]\n[0 0|1 0]\n[0 0|0 1]\nsage: J.tensor_product(I)\n[1 0|0 0]\n[0 1|0 0]\n[---+---]\n[0 0|1 0]\n[0 0|0 1]\nsage: I.tensor_product(I)\n[1 0|0 0]\n[0 1|0 0]\n[---+---]\n[0 0|1 0]\n[0 0|0 1]\nsage: I.tensor_product(J)\nTraceback (most recent call last)\n...\nAttributeError: 'sage.matrix.matrix_generic_sparse.Matrix_generic_sparse'\nobject has no attribute '_rational_matrix'\n```\n\nInitial report by Will Orrick at\n\n- [Ask Sage question 54762: Tensor product of matrices over cyclotomic field](https://ask.sagemath.org/question/54762)\n\nCC:  @slel\n\nKeywords: **matrix, tensor_product, dense, sparse**\n\nComponent: **linear algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31086_\n\n",
    "created_at": "2020-12-20T02:31:48Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix tensor product of dense matrix by sparse matrix",
    "type": "issue",
    "updated_at": "2022-08-31T05:25:02Z",
    "url": "https://github.com/sagemath/sage/issues/31086",
    "user": "https://github.com/slel"
}
```
The tensor product of a dense matrix by a sparse matrix
fails for some base rings including cyclotomic fields.
Everything works fine over `ZZ` or `QQ`.

Illustration in Sage 9.3.beta4:

```
sage: k = CyclotomicField(3)
sage: I = identity_matrix(k, 2)
sage: J = identity_matrix(k, 2, sparse=True)
sage: J.tensor_product(J)
[1 0|0 0]
[0 1|0 0]
[---+---]
[0 0|1 0]
[0 0|0 1]
sage: J.tensor_product(I)
[1 0|0 0]
[0 1|0 0]
[---+---]
[0 0|1 0]
[0 0|0 1]
sage: I.tensor_product(I)
[1 0|0 0]
[0 1|0 0]
[---+---]
[0 0|1 0]
[0 0|0 1]
sage: I.tensor_product(J)
Traceback (most recent call last)
...
AttributeError: 'sage.matrix.matrix_generic_sparse.Matrix_generic_sparse'
object has no attribute '_rational_matrix'
```

Initial report by Will Orrick at

- [Ask Sage question 54762: Tensor product of matrices over cyclotomic field](https://ask.sagemath.org/question/54762)

CC:  @slel

Keywords: **matrix, tensor_product, dense, sparse**

Component: **linear algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/31086_





---

archive/issue_events_428653.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-12-20T02:31:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428653"
}
```



---

archive/issue_events_428654.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-12-20T02:31:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428654"
}
```



---

archive/issue_events_428655.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-12-20T02:31:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428655"
}
```



---

archive/issue_events_428656.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2020-12-20T02:31:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428656"
}
```



---

archive/issue_comments_498255.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -35,4 +35,4 @@\n \n Initial report by Will Orrick at\n \n-- [Ask Sage question 54762](https://ask.sagemath.org/question/54762)\n+- [Ask Sage question 54762: Tensor product of matrices over cyclotomic field](https://ask.sagemath.org/question/54762)\n``````\n",
    "created_at": "2020-12-20T02:58:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31086#issuecomment-498255",
    "user": "https://github.com/slel"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -35,4 +35,4 @@
 
 Initial report by Will Orrick at
 
-- [Ask Sage question 54762](https://ask.sagemath.org/question/54762)
+- [Ask Sage question 54762: Tensor product of matrices over cyclotomic field](https://ask.sagemath.org/question/54762)
``````




---

archive/issue_events_428657.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428657"
}
```



---

archive/issue_events_428658.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428658"
}
```



---

archive/issue_comments_498256.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31086#issuecomment-498256",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:2" align="right">comment:2</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_428659.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:26:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428659"
}
```



---

archive/issue_events_428660.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:26:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428660"
}
```



---

archive/issue_events_428661.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428661"
}
```



---

archive/issue_events_428662.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428662"
}
```



---

archive/issue_events_428663.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428663"
}
```



---

archive/issue_events_428664.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428664"
}
```



---

archive/issue_events_428665.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428665"
}
```



---

archive/issue_events_428666.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T05:25:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31086",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31086#event-428666"
}
```
