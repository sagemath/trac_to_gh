# Issue 31592: Upgrade/patch singular more to remove bad -rpath linker options

archive/issues_031355.json:
```json
{
    "body": "The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993) from 4.1.1p2 to 4.2.0p1.\nUpstream singular introduced some rather unfortunate linker flags in 4.1.3 or earlier.\n\nWe fix it by a number of PRs to the singular build system. The new snapshot release is made from the current singular `spielwiese` HEAD, which has merged the PRs. There are a number of other change since the last snapshot release built in #31552, which seem to be bugfixes.\n\nPrevious tickets: #25993, #31552\n\n\nCC:  justin @kiwifb @dimpase @slel @jhpalmieri @zlscherr @videlec @antonio-rojas\n\nBranch/Commit: 25715130d515ab607a0d715e9dbda3863e149611\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Matthias Koeppe\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31592\n\n",
    "closed_at": "2021-04-12T21:48:46Z",
    "created_at": "2021-04-01T16:43:37Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "Upgrade/patch singular more to remove bad -rpath linker options",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31592",
    "user": "https://github.com/mkoeppe"
}
```
The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993) from 4.1.1p2 to 4.2.0p1.
Upstream singular introduced some rather unfortunate linker flags in 4.1.3 or earlier.

We fix it by a number of PRs to the singular build system. The new snapshot release is made from the current singular `spielwiese` HEAD, which has merged the PRs. There are a number of other change since the last snapshot release built in #31552, which seem to be bugfixes.

Previous tickets: #25993, #31552


CC:  justin @kiwifb @dimpase @slel @jhpalmieri @zlscherr @videlec @antonio-rojas

Branch/Commit: 25715130d515ab607a0d715e9dbda3863e149611

Reviewer: Fran√ßois Bissey

Author: Matthias Koeppe

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31592





---

archive/issue_comments_628981.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993).\n+The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993) from 4.1.1p2 to 4.2.0p1.\n Upstream singular introduced some rather unfortunate linker flags in 4.1.3 or earlier.\n \n``````\n",
    "created_at": "2021-04-01T16:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628981",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993).
+The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993) from 4.1.1p2 to 4.2.0p1.
 Upstream singular introduced some rather unfortunate linker flags in 4.1.3 or earlier.
 
``````




---

archive/issue_comments_628982.json:
```json
{
    "body": "<a id='comment:2'></a>\nA first PR as preparation: https://github.com/Singular/Singular/pull/1072",
    "created_at": "2021-04-01T23:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628982",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:2'></a>
A first PR as preparation: https://github.com/Singular/Singular/pull/1072



---

archive/issue_comments_628983.json:
```json
{
    "body": "<a id='comment:4'></a>\nWhile `/usr and /usr/local` made it back in `DEFAULT_CHECKING_PATH` in `flint-check.m4`, if you use that variable that means they have not been found there previously by the bit that check standard paths - that I have added [https://github.com/Singular/Singular/pull/981](https://github.com/Singular/Singular/pull/981). So, I haven't asked for that re-addition to be removed. If you get to the bit checking `DEFAULT_CHECKING_PATH` they won't be found there anyway.\n\nIt would have been nice for `gmp-check.m4` to follow that model. That would also prevent `/usr/lib` and `/usr/local/lib` to ever end up in a `rpath` unless you explicitly pass it as a path to be checked.",
    "created_at": "2021-04-02T00:43:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628983",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>
While `/usr and /usr/local` made it back in `DEFAULT_CHECKING_PATH` in `flint-check.m4`, if you use that variable that means they have not been found there previously by the bit that check standard paths - that I have added [https://github.com/Singular/Singular/pull/981](https://github.com/Singular/Singular/pull/981). So, I haven't asked for that re-addition to be removed. If you get to the bit checking `DEFAULT_CHECKING_PATH` they won't be found there anyway.

It would have been nice for `gmp-check.m4` to follow that model. That would also prevent `/usr/lib` and `/usr/local/lib` to ever end up in a `rpath` unless you explicitly pass it as a path to be checked.



---

archive/issue_comments_628984.json:
```json
{
    "body": "<a id='comment:5'></a>\nYes, I plan to make more improvements in this direction later. The first PR is designed to make no difference in behavior",
    "created_at": "2021-04-02T00:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628984",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:5'></a>
Yes, I plan to make more improvements in this direction later. The first PR is designed to make no difference in behavior



---

archive/issue_comments_628985.json:
```json
{
    "body": "<a id='comment:6'></a>\nThe replacement of all those gmp detections by a single one is certainly overdue. Code duplication is such a maintenance mess. It is an improvement on that front already.",
    "created_at": "2021-04-02T00:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628985",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:6'></a>
The replacement of all those gmp detections by a single one is certainly overdue. Code duplication is such a maintenance mess. It is an improvement on that front already.



---

archive/issue_comments_628986.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [mkoeppe](#comment%3A2):\n> A first PR as preparation: https://github.com/Singular/Singular/pull/1072\n\nIt has been merged upstream.",
    "created_at": "2021-04-02T18:27:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628986",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Replying to [mkoeppe](#comment%3A2):
> A first PR as preparation: https://github.com/Singular/Singular/pull/1072

It has been merged upstream.



---

archive/issue_comments_628987.json:
```json
{
    "body": "<a id='comment:8'></a>\nNext PR: https://github.com/Singular/Singular/pull/1074 (Replace `-Wl,-rpath -Wl,...` by `-Wl,-rpath,...`)",
    "created_at": "2021-04-02T23:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628987",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Next PR: https://github.com/Singular/Singular/pull/1074 (Replace `-Wl,-rpath -Wl,...` by `-Wl,-rpath,...`)



---

archive/issue_comments_628988.json:
```json
{
    "body": "<a id='comment:9'></a>\nAnd another one: https://github.com/Singular/Singular/pull/1075 (Define `DEFAULT_CHECKING_PATH` once only)",
    "created_at": "2021-04-03T00:15:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628988",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:9'></a>
And another one: https://github.com/Singular/Singular/pull/1075 (Define `DEFAULT_CHECKING_PATH` once only)



---

archive/issue_comments_628989.json:
```json
{
    "body": "<a id='comment:10'></a>\nAnd another one: https://github.com/Singular/Singular/pull/1076 (m4/*.m4: In the search loops, test for the presence of headers using the compiler)",
    "created_at": "2021-04-03T01:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628989",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:10'></a>
And another one: https://github.com/Singular/Singular/pull/1076 (m4/*.m4: In the search loops, test for the presence of headers using the compiler)



---

archive/issue_comments_628990.json:
```json
{
    "body": "<a id='comment:11'></a>\nThese three are all merged by upstream, so here's the next one:\n\nhttps://github.com/Singular/Singular/pull/1078 (m4/flint-check.m4: Refactor)",
    "created_at": "2021-04-04T16:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628990",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
These three are all merged by upstream, so here's the next one:

https://github.com/Singular/Singular/pull/1078 (m4/flint-check.m4: Refactor)



---

archive/issue_comments_628991.json:
```json
{
    "body": "<a id='comment:12'></a>\nMerged, so here is the last one:\n\nhttps://github.com/Singular/Singular/pull/1080",
    "created_at": "2021-04-05T19:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628991",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:12'></a>
Merged, so here is the last one:

https://github.com/Singular/Singular/pull/1080



---

archive/issue_comments_628992.json:
```json
{
    "body": "<a id='comment:13'></a>\nI am not sure why you leave '/usr/local'? I would have thought anything in there would be found when testing `DEFAULTS`.",
    "created_at": "2021-04-05T20:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628992",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:13'></a>
I am not sure why you leave '/usr/local'? I would have thought anything in there would be found when testing `DEFAULTS`.



---

archive/issue_comments_628993.json:
```json
{
    "body": "<a id='comment:14'></a>\nNot true on macOS when using CC=`CC=gcc -isysroot ...`.",
    "created_at": "2021-04-05T20:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628993",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:14'></a>
Not true on macOS when using CC=`CC=gcc -isysroot ...`.



---

archive/issue_comments_628994.json:
```json
{
    "body": "<a id='comment:15'></a>\nOK, fair enough.",
    "created_at": "2021-04-05T20:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628994",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:15'></a>
OK, fair enough.



---

archive/issue_comments_628995.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993) from 4.1.1p2 to 4.2.0p1.\n Upstream singular introduced some rather unfortunate linker flags in 4.1.3 or earlier.\n \n+Previous tickets: #25993, #31552\n``````\n",
    "created_at": "2021-04-06T18:43:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628995",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,4 @@
 The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993) from 4.1.1p2 to 4.2.0p1.
 Upstream singular introduced some rather unfortunate linker flags in 4.1.3 or earlier.
 
+Previous tickets: #25993, #31552
``````




---

archive/issue_comments_628996.json:
```json
{
    "body": "Changing branch from \"\" to \"u/mkoeppe/upgrade_patch_singular_more_to_remove_bad__rpath_linker_options\"",
    "created_at": "2021-04-06T20:37:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628996",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "" to "u/mkoeppe/upgrade_patch_singular_more_to_remove_bad__rpath_linker_options"



---

archive/issue_comments_628997.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993) from 4.1.1p2 to 4.2.0p1.\n Upstream singular introduced some rather unfortunate linker flags in 4.1.3 or earlier.\n \n+We fix it by a number of PRs to the singular build system. The new snapshot release is made from the current singular `spielwiese` HEAD, which has merged the PRs. There are a number of other change since the last snapshot release built in #31552, which seem to be bugfixes.\n+\n Previous tickets: #25993, #31552\n+\n``````\n",
    "created_at": "2021-04-06T20:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628997",
    "user": "https://github.com/mkoeppe"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,7 @@
 The issue reported in https://groups.google.com/g/sage-release/c/fXpbYwaqt9o/m/929SlEXcCAAJ is likely caused by the upgrade to singular (#25993) from 4.1.1p2 to 4.2.0p1.
 Upstream singular introduced some rather unfortunate linker flags in 4.1.3 or earlier.
 
+We fix it by a number of PRs to the singular build system. The new snapshot release is made from the current singular `spielwiese` HEAD, which has merged the PRs. There are a number of other change since the last snapshot release built in #31552, which seem to be bugfixes.
+
 Previous tickets: #25993, #31552
+
``````




---

archive/issue_comments_628998.json:
```json
{
    "body": "<a id='comment:18'></a>\nAll of the above PRs have been merged by upstream.\n\nI have made another PR, https://github.com/Singular/Singular/pull/1081, just with minor fixes to the Singular docbuild so the process of making a release is simpler: `autoreconf -fi && ./configure --disable-pyobject-module --enable-doc-build && make && make dist`\n\nNew release for sage at https://github.com/mkoeppe/Singular/releases/tag/singular-4.2.0p1%2B2021-04-06%2Bsage\n\n---\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[ea8652b](https://github.com/sagemath/sagetrac-mirror/commit/ea8652bb55b4e8e41234a2d2cf71ff28f112f261)|`build/pkgs/singular: Use 4.2.0p1+2021-04-06+sage`|",
    "created_at": "2021-04-06T20:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628998",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:18'></a>
All of the above PRs have been merged by upstream.

I have made another PR, https://github.com/Singular/Singular/pull/1081, just with minor fixes to the Singular docbuild so the process of making a release is simpler: `autoreconf -fi && ./configure --disable-pyobject-module --enable-doc-build && make && make dist`

New release for sage at https://github.com/mkoeppe/Singular/releases/tag/singular-4.2.0p1%2B2021-04-06%2Bsage

---
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[ea8652b](https://github.com/sagemath/sagetrac-mirror/commit/ea8652bb55b4e8e41234a2d2cf71ff28f112f261)|`build/pkgs/singular: Use 4.2.0p1+2021-04-06+sage`|



---

archive/issue_comments_628999.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-04-06T20:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-628999",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_629000.json:
```json
{
    "body": "Changing commit from \"\" to \"ea8652bb55b4e8e41234a2d2cf71ff28f112f261\"",
    "created_at": "2021-04-06T20:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629000",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "" to "ea8652bb55b4e8e41234a2d2cf71ff28f112f261"



---

archive/issue_comments_629001.json:
```json
{
    "body": "Changing author from \"\" to \"Matthias Koeppe\"",
    "created_at": "2021-04-06T20:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629001",
    "user": "https://github.com/mkoeppe"
}
```

Changing author from "" to "Matthias Koeppe"



---

archive/issue_comments_629002.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2021-04-06T20:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629002",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "" to "Fran√ßois Bissey"



---

archive/issue_comments_629003.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-06T20:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629003",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_629004.json:
```json
{
    "body": "<a id='comment:19'></a>\nThanks for taking the time to go through that mess that likely represented years of accumulated hacks. I am satisfied that it should work out of the box. It needs to go to the bots.",
    "created_at": "2021-04-06T20:54:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629004",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:19'></a>
Thanks for taking the time to go through that mess that likely represented years of accumulated hacks. I am satisfied that it should work out of the box. It needs to go to the bots.



---

archive/issue_comments_629005.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-04-06T21:25:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629005",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_629006.json:
```json
{
    "body": "Changing commit from \"ea8652bb55b4e8e41234a2d2cf71ff28f112f261\" to \"1c005205f1cdd7167cb26449231f2d3052688ffe\"",
    "created_at": "2021-04-06T21:25:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629006",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "ea8652bb55b4e8e41234a2d2cf71ff28f112f261" to "1c005205f1cdd7167cb26449231f2d3052688ffe"



---

archive/issue_comments_629007.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                                                                                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------|\n|[1c00520](https://github.com/sagemath/sagetrac-mirror/commit/1c005205f1cdd7167cb26449231f2d3052688ffe)|`build/pkgs/singular/spkg-install.in: Use --with-libparse - just in case we use a tarball without built documentation`|",
    "created_at": "2021-04-06T21:25:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629007",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                                                                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------|
|[1c00520](https://github.com/sagemath/sagetrac-mirror/commit/1c005205f1cdd7167cb26449231f2d3052688ffe)|`build/pkgs/singular/spkg-install.in: Use --with-libparse - just in case we use a tarball without built documentation`|



---

archive/issue_comments_629008.json:
```json
{
    "body": "<a id='comment:21'></a>\nThat's a new option to me. I now see what objects it builds. I am unfamiliar with the documentation building, is that a component to help build it?",
    "created_at": "2021-04-06T21:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629008",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:21'></a>
That's a new option to me. I now see what objects it builds. I am unfamiliar with the documentation building, is that a component to help build it?



---

archive/issue_comments_629009.json:
```json
{
    "body": "<a id='comment:22'></a>\nYes, to my understanding it is needed by the docbuild to extract test cases from the library code.",
    "created_at": "2021-04-06T23:06:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629009",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:22'></a>
Yes, to my understanding it is needed by the docbuild to extract test cases from the library code.



---

archive/issue_comments_629010.json:
```json
{
    "body": "<a id='comment:23'></a>\nI am not against it but that may have been more appropriate for future tickets. On the other hand that would mean more bumping of singular, not like we need any more of that.\n\nI am happy to put it back to positive review, that commit doesn't add any requirements which was my first knee jerk reaction to it.",
    "created_at": "2021-04-06T23:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629010",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'></a>
I am not against it but that may have been more appropriate for future tickets. On the other hand that would mean more bumping of singular, not like we need any more of that.

I am happy to put it back to positive review, that commit doesn't add any requirements which was my first knee jerk reaction to it.



---

archive/issue_comments_629011.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-06T23:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629011",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_629012.json:
```json
{
    "body": "<a id='comment:24'></a>\nI added it here so that the upstream CI integration tests with Sage run properly: https://github.com/Singular/Singular/actions/runs/723960919",
    "created_at": "2021-04-06T23:18:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629012",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:24'></a>
I added it here so that the upstream CI integration tests with Sage run properly: https://github.com/Singular/Singular/actions/runs/723960919



---

archive/issue_comments_629013.json:
```json
{
    "body": "Changing commit from \"1c005205f1cdd7167cb26449231f2d3052688ffe\" to \"4769678e2b825d48420eddf5ab27b9be53dc9a20\"",
    "created_at": "2021-04-08T23:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629013",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1c005205f1cdd7167cb26449231f2d3052688ffe" to "4769678e2b825d48420eddf5ab27b9be53dc9a20"



---

archive/issue_comments_629014.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n|                                                                                                                                           |                                                                                                  |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|\n|[4769678](https://github.com/sagemath/sagetrac-mirror/commit/4769678e2b825d48420eddf5ab27b9be53dc9a20)|`Merge tag '9.3.rc2' into t/31592/upgrade_patch_singular_more_to_remove_bad__rpath_linker_options`|",
    "created_at": "2021-04-08T23:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629014",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
|                                                                                                                                           |                                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|
|[4769678](https://github.com/sagemath/sagetrac-mirror/commit/4769678e2b825d48420eddf5ab27b9be53dc9a20)|`Merge tag '9.3.rc2' into t/31592/upgrade_patch_singular_more_to_remove_bad__rpath_linker_options`|



---

archive/issue_comments_629015.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2021-04-08T23:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629015",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_629016.json:
```json
{
    "body": "<a id='comment:26'></a>\nnow on top of 9.3.rc2",
    "created_at": "2021-04-08T23:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629016",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
now on top of 9.3.rc2



---

archive/issue_comments_629017.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-08T23:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629017",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_629018.json:
```json
{
    "body": "<a id='comment:27'></a>\nJust saw this error on `cygwin-standard`, a cygwin-specific makefile bug related to libparse.\n\n```\ng++ -std=gnu++11 -O2 -g -march=native -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -fno-threadsafe-statics -fno-enforce-eh-specs -fconserve-space -funroll-loops -fno-delete-null-pointer-checks -fno-rtti  -L/opt/sage-ee023d7e18dfacf53b08fd0cf862661c48fe39c5/lib -Wl,-rpath,/opt/sage-ee023d7e18dfacf53b08fd0cf862661c48fe39c5/lib  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -fconserve-space -funroll-loops -fno-delete-null-pointer-checks  -Wl,-Bdynamic  libparse.cc   -o libparse\nlibparse.cc:31:10: fatal error: factory/globaldefs.h: No such file or directory\n   31 | #include \"factory/globaldefs.h\"\n      |          ^~~~~~~~~~~~~~~~~~~~~~\ncompilation terminated.\n```\nhttps://github.com/mkoeppe/sage/runs/2309214320\n(this run is on top of other tickets, in particular #28890, but let's play safe and remove 1c00520)",
    "created_at": "2021-04-10T16:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629018",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Just saw this error on `cygwin-standard`, a cygwin-specific makefile bug related to libparse.

```
g++ -std=gnu++11 -O2 -g -march=native -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -fno-threadsafe-statics -fno-enforce-eh-specs -fconserve-space -funroll-loops -fno-delete-null-pointer-checks -fno-rtti  -L/opt/sage-ee023d7e18dfacf53b08fd0cf862661c48fe39c5/lib -Wl,-rpath,/opt/sage-ee023d7e18dfacf53b08fd0cf862661c48fe39c5/lib  -pipe -fno-common -g0 -O3 -Wno-unused-function -Wno-trigraphs -Wno-unused-parameter -Wunknown-pragmas -Wno-unused-variable -fomit-frame-pointer -fwrapv -fvisibility=default -finline-functions -fno-exceptions -fconserve-space -funroll-loops -fno-delete-null-pointer-checks  -Wl,-Bdynamic  libparse.cc   -o libparse
libparse.cc:31:10: fatal error: factory/globaldefs.h: No such file or directory
   31 | #include "factory/globaldefs.h"
      |          ^~~~~~~~~~~~~~~~~~~~~~
compilation terminated.
```
https://github.com/mkoeppe/sage/runs/2309214320
(this run is on top of other tickets, in particular #28890, but let's play safe and remove 1c00520)



---

archive/issue_comments_629019.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-04-10T16:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629019",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_629020.json:
```json
{
    "body": "<a id='comment:28'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|\n|[2571513](https://github.com/sagemath/sagetrac-mirror/commit/25715130d515ab607a0d715e9dbda3863e149611)|`Revert \"build/pkgs/singular/spkg-install.in: Use --with-libparse - just in case we use a tarball without built documentation\"`|",
    "created_at": "2021-04-10T16:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629020",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|
|[2571513](https://github.com/sagemath/sagetrac-mirror/commit/25715130d515ab607a0d715e9dbda3863e149611)|`Revert "build/pkgs/singular/spkg-install.in: Use --with-libparse - just in case we use a tarball without built documentation"`|



---

archive/issue_comments_629021.json:
```json
{
    "body": "Changing commit from \"4769678e2b825d48420eddf5ab27b9be53dc9a20\" to \"25715130d515ab607a0d715e9dbda3863e149611\"",
    "created_at": "2021-04-10T16:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629021",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4769678e2b825d48420eddf5ab27b9be53dc9a20" to "25715130d515ab607a0d715e9dbda3863e149611"



---

archive/issue_comments_629022.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-04-10T16:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629022",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_629023.json:
```json
{
    "body": "<a id='comment:30'></a>\nSetting it back to positive review - back to the version reviewed in comment 19.",
    "created_at": "2021-04-10T16:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629023",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:30'></a>
Setting it back to positive review - back to the version reviewed in comment 19.



---

archive/issue_comments_629024.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-04-10T16:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629024",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_629025.json:
```json
{
    "body": "<a id='comment:32'></a>\nFollow-up in #31642, where 1c00520 is coming back",
    "created_at": "2021-04-10T19:44:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629025",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:32'></a>
Follow-up in #31642, where 1c00520 is coming back



---

archive/issue_comments_629026.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-04-12T21:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629026",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_093534.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-04-12T21:48:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31592#event-93534"
}
```



---

archive/issue_comments_629027.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/upgrade_patch_singular_more_to_remove_bad__rpath_linker_options\" to \"25715130d515ab607a0d715e9dbda3863e149611\"",
    "created_at": "2021-04-12T21:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31592",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31592#issuecomment-629027",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/upgrade_patch_singular_more_to_remove_bad__rpath_linker_options" to "25715130d515ab607a0d715e9dbda3863e149611"
