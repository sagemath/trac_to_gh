# Issue 31085: fix conversion of sign function to fricas

archive/issues_030848.json:
```json
{
    "body": "which apparently has no symbolic sign function\n\nCC:  @mantepse\n\nKeywords: FriCAS\n\nBranch/Commit: 65695c1081d8c8f2f496ac517d61489bd5ad661f\n\nReviewer: Martin Rubey\n\nAuthor: Fr\u00e9d\u00e9ric Chapoton\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31085\n\n",
    "closed_at": "2020-12-27T00:22:40Z",
    "created_at": "2020-12-19T20:13:53Z",
    "labels": [
        "component: interfaces: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "fix conversion of sign function to fricas",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31085",
    "user": "https://github.com/fchapoton"
}
```
which apparently has no symbolic sign function

CC:  @mantepse

Keywords: FriCAS

Branch/Commit: 65695c1081d8c8f2f496ac517d61489bd5ad661f

Reviewer: Martin Rubey

Author: Frédéric Chapoton

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31085





---

archive/issue_comments_617319.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-19T20:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617319",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_617320.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[9cdcb3f](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)|`fix conversion of sign function to fricas`|",
    "created_at": "2020-12-19T20:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617320",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[9cdcb3f](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)|`fix conversion of sign function to fricas`|



---

archive/issue_comments_617321.json:
```json
{
    "body": "Changing commit from \"\" to \"9cdcb3f9c106e4e93e9a908c22b5676ff560b9be\"",
    "created_at": "2020-12-19T20:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617321",
    "user": "https://github.com/fchapoton"
}
```

Changing commit from "" to "9cdcb3f9c106e4e93e9a908c22b5676ff560b9be"



---

archive/issue_comments_617322.json:
```json
{
    "body": "Changing branch from \"\" to \"u/chapoton/31085\"",
    "created_at": "2020-12-19T20:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617322",
    "user": "https://github.com/fchapoton"
}
```

Changing branch from "" to "u/chapoton/31085"



---

archive/issue_comments_617323.json:
```json
{
    "body": "<a id='comment:2'></a>\nI don't quite understand the patch.  If you want a sign function for symbolic expressions in fricas, you'll have to use ` x/abs(x) `, I guess.  But I don't think that fricas would be able to do anything with it.  There is a sign function for integers and integer fractions, but I don't see the point of providing a translation, because it should never show up in a result that fricas provides.",
    "created_at": "2020-12-19T20:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617323",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'></a>
I don't quite understand the patch.  If you want a sign function for symbolic expressions in fricas, you'll have to use ` x/abs(x) `, I guess.  But I don't think that fricas would be able to do anything with it.  There is a sign function for integers and integer fractions, but I don't see the point of providing a translation, because it should never show up in a result that fricas provides.



---

archive/issue_comments_617324.json:
```json
{
    "body": "<a id='comment:3'></a>\nI was trying the integral in #11590 with fricas, and it did not work. The existing conversion of the symbolic sign function is \"sign\", which cannot handle symbolic arguments.\n\nBut then apparently, Fricas cannot integrate functions containing abs.",
    "created_at": "2020-12-19T20:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617324",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
I was trying the integral in #11590 with fricas, and it did not work. The existing conversion of the symbolic sign function is "sign", which cannot handle symbolic arguments.

But then apparently, Fricas cannot integrate functions containing abs.



---

archive/issue_comments_617325.json:
```json
{
    "body": "<a id='comment:4'></a>\nYes, that's correct (as far as I know).\n\nSo, do you think it makes sense to convert sign to ```x/abs(x)```?  (I don't)",
    "created_at": "2020-12-19T20:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617325",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'></a>
Yes, that's correct (as far as I know).

So, do you think it makes sense to convert sign to ```x/abs(x)```?  (I don't)



---

archive/issue_comments_617326.json:
```json
{
    "body": "<a id='comment:5'></a>\nWell, at least by converting to `abs(x)/x` (I prefer this way, and did that), one can go to fricas and back to sage without error. Why do you think that it's not a good idea ?",
    "created_at": "2020-12-21T08:42:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617326",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
Well, at least by converting to `abs(x)/x` (I prefer this way, and did that), one can go to fricas and back to sage without error. Why do you think that it's not a good idea ?



---

archive/issue_comments_617327.json:
```json
{
    "body": "<a id='comment:6'></a>\nSorry, I missed that!  Yes, I agree with that!  A doctest might be good, I'll try to think of one.",
    "created_at": "2020-12-21T09:14:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617327",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'></a>
Sorry, I missed that!  Yes, I agree with that!  A doctest might be good, I'll try to think of one.



---

archive/issue_comments_617328.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Martin Rubey\"",
    "created_at": "2020-12-21T09:14:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617328",
    "user": "https://github.com/mantepse"
}
```

Changing reviewer from "" to "Martin Rubey"



---

archive/issue_comments_617329.json:
```json
{
    "body": "Changing keywords from \"\" to \"FriCAS\".",
    "created_at": "2020-12-21T09:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617329",
    "user": "https://github.com/mantepse"
}
```

Changing keywords from "" to "FriCAS".



---

archive/issue_comments_617330.json:
```json
{
    "body": "<a id='comment:9'></a>\nHere is a trival test, do you want to add it?\n\n```\nsage: fricas(sign(x)).eval(x=-3)\n- 1\n```\n\nOther than that, it looks good.  There is currently a giac failure, which I cannot say anything about.",
    "created_at": "2020-12-21T18:14:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617330",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'></a>
Here is a trival test, do you want to add it?

```
sage: fricas(sign(x)).eval(x=-3)
- 1
```

Other than that, it looks good.  There is currently a giac failure, which I cannot say anything about.



---

archive/issue_comments_617331.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[65695c1](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)|`add a doctest for fricas sign`|",
    "created_at": "2020-12-21T20:40:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617331",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[65695c1](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)|`add a doctest for fricas sign`|



---

archive/issue_comments_617332.json:
```json
{
    "body": "Changing commit from \"9cdcb3f9c106e4e93e9a908c22b5676ff560b9be\" to \"65695c1081d8c8f2f496ac517d61489bd5ad661f\"",
    "created_at": "2020-12-21T20:40:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617332",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9cdcb3f9c106e4e93e9a908c22b5676ff560b9be" to "65695c1081d8c8f2f496ac517d61489bd5ad661f"



---

archive/issue_comments_617333.json:
```json
{
    "body": "<a id='comment:11'></a>\nVoil\u00e0 !",
    "created_at": "2020-12-21T20:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617333",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
Voilà !



---

archive/issue_comments_617334.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-21T20:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617334",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_617335.json:
```json
{
    "body": "<a id='comment:12'></a>\nGreat, looks good.  I cannot reproduce the giac failure, I guess it's unrelated.",
    "created_at": "2020-12-21T20:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617335",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:12'></a>
Great, looks good.  I cannot reproduce the giac failure, I guess it's unrelated.



---

archive/issue_comments_617336.json:
```json
{
    "body": "Changing branch from \"u/chapoton/31085\" to \"65695c1081d8c8f2f496ac517d61489bd5ad661f\"",
    "created_at": "2020-12-27T00:22:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617336",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/chapoton/31085" to "65695c1081d8c8f2f496ac517d61489bd5ad661f"



---

archive/issue_events_091432.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-27T00:22:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31085#event-91432"
}
```



---

archive/issue_comments_617337.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-27T00:22:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31085#issuecomment-617337",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
