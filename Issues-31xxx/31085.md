# Issue 31085: fix conversion of sign function to fricas

archive/issues_030848.json:
```json
{
    "assignees": [],
    "body": "which apparently has no symbolic sign function\n\nCC:  @mantepse\n\nKeywords: **FriCAS**\n\nBranch/Commit: **[65695c1](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**\n\nReviewer: **Martin Rubey**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31085_\n\n",
    "closed_at": "2020-12-27T00:22:40Z",
    "created_at": "2020-12-19T20:13:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces%3A%20optional",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix conversion of sign function to fricas",
    "type": "issue",
    "updated_at": "2020-12-27T00:22:40Z",
    "url": "https://github.com/sagemath/sage/issues/31085",
    "user": "https://github.com/fchapoton"
}
```
which apparently has no symbolic sign function

CC:  @mantepse

Keywords: **FriCAS**

Branch/Commit: **[65695c1](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**

Reviewer: **Martin Rubey**

Author: **Frédéric Chapoton**

_Issue created by migration from https://trac.sagemath.org/ticket/31085_





---

archive/issue_events_396478.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:13:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396478"
}
```



---

archive/issue_events_396479.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:13:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces%3A%20optional",
    "label_color": "0000ff",
    "label_name": "component: interfaces: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396479"
}
```



---

archive/issue_events_396480.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:13:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396480"
}
```



---

archive/issue_events_396481.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:13:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396481"
}
```



---

archive/issue_events_396482.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:14:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396482"
}
```



---

archive/issue_comments_501149.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be\">9cdcb3f</a></td><td><code>fix conversion of sign function to fricas</code></td></tr></table>\n",
    "created_at": "2020-12-19T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501149",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:1'>Comment 1:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be">9cdcb3f</a></td><td><code>fix conversion of sign function to fricas</code></td></tr></table>




---

archive/issue_comments_501150.json:
```json
{
    "body": "Commit: **[9cdcb3f](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)**",
    "created_at": "2020-12-19T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501150",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[9cdcb3f](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)**



---

archive/issue_comments_501151.json:
```json
{
    "body": "Branch: **[u/chapoton/31085](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/31085)**",
    "created_at": "2020-12-19T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501151",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/31085](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/31085)**



---

archive/issue_comments_501152.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nI don't quite understand the patch.  If you want a sign function for symbolic expressions in fricas, you'll have to use ` x/abs(x) `, I guess.  But I don't think that fricas would be able to do anything with it.  There is a sign function for integers and integer fractions, but I don't see the point of providing a translation, because it should never show up in a result that fricas provides.",
    "created_at": "2020-12-19T20:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501152",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:2'>Comment 2:</a>
I don't quite understand the patch.  If you want a sign function for symbolic expressions in fricas, you'll have to use ` x/abs(x) `, I guess.  But I don't think that fricas would be able to do anything with it.  There is a sign function for integers and integer fractions, but I don't see the point of providing a translation, because it should never show up in a result that fricas provides.



---

archive/issue_comments_501153.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nI was trying the integral in #11590 with fricas, and it did not work. The existing conversion of the symbolic sign function is \"sign\", which cannot handle symbolic arguments.\n\nBut then apparently, Fricas cannot integrate functions containing abs.",
    "created_at": "2020-12-19T20:51:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501153",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'>Comment 3:</a>
I was trying the integral in #11590 with fricas, and it did not work. The existing conversion of the symbolic sign function is "sign", which cannot handle symbolic arguments.

But then apparently, Fricas cannot integrate functions containing abs.



---

archive/issue_comments_501154.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nYes, that's correct (as far as I know).\n\nSo, do you think it makes sense to convert sign to ```x/abs(x)```?  (I don't)",
    "created_at": "2020-12-19T20:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501154",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:4'>Comment 4:</a>
Yes, that's correct (as far as I know).

So, do you think it makes sense to convert sign to ```x/abs(x)```?  (I don't)



---

archive/issue_comments_501155.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nWell, at least by converting to `abs(x)/x` (I prefer this way, and did that), one can go to fricas and back to sage without error. Why do you think that it's not a good idea ?",
    "created_at": "2020-12-21T08:42:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501155",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'>Comment 5:</a>
Well, at least by converting to `abs(x)/x` (I prefer this way, and did that), one can go to fricas and back to sage without error. Why do you think that it's not a good idea ?



---

archive/issue_comments_501156.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nSorry, I missed that!  Yes, I agree with that!  A doctest might be good, I'll try to think of one.",
    "created_at": "2020-12-21T09:14:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501156",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:6'>Comment 6:</a>
Sorry, I missed that!  Yes, I agree with that!  A doctest might be good, I'll try to think of one.



---

archive/issue_comments_501157.json:
```json
{
    "body": "Reviewer: **Martin Rubey**",
    "created_at": "2020-12-21T09:14:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501157",
    "user": "https://github.com/mantepse"
}
```

Reviewer: **Martin Rubey**



---

archive/issue_comments_501158.json:
```json
{
    "body": "Changed keywords from **** to **FriCAS**",
    "created_at": "2020-12-21T09:15:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501158",
    "user": "https://github.com/mantepse"
}
```

Changed keywords from **** to **FriCAS**



---

archive/issue_comments_501159.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nHere is a trival test, do you want to add it?\n\n```\nsage: fricas(sign(x)).eval(x=-3)\n- 1\n```\n\nOther than that, it looks good.  There is currently a giac failure, which I cannot say anything about.",
    "created_at": "2020-12-21T18:14:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501159",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:9'>Comment 9:</a>
Here is a trival test, do you want to add it?

```
sage: fricas(sign(x)).eval(x=-3)
- 1
```

Other than that, it looks good.  There is currently a giac failure, which I cannot say anything about.



---

archive/issue_comments_501160.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f\">65695c1</a></td><td><code>add a doctest for fricas sign</code></td></tr></table>\n",
    "created_at": "2020-12-21T20:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501160",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:10'>Comment 10:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f">65695c1</a></td><td><code>add a doctest for fricas sign</code></td></tr></table>




---

archive/issue_comments_501161.json:
```json
{
    "body": "Changed commit from **[9cdcb3f](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)** to **[65695c1](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**",
    "created_at": "2020-12-21T20:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501161",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9cdcb3f](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)** to **[65695c1](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**



---

archive/issue_comments_501162.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nVoil\u00e0 !",
    "created_at": "2020-12-21T20:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501162",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'>Comment 11:</a>
Voilà !



---

archive/issue_events_396483.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2020-12-21T20:49:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396483"
}
```



---

archive/issue_events_396484.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2020-12-21T20:49:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396484"
}
```



---

archive/issue_comments_501163.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nGreat, looks good.  I cannot reproduce the giac failure, I guess it's unrelated.",
    "created_at": "2020-12-21T20:49:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501163",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:12'>Comment 12:</a>
Great, looks good.  I cannot reproduce the giac failure, I guess it's unrelated.



---

archive/issue_comments_501164.json:
```json
{
    "body": "Changed branch from **[u/chapoton/31085](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/31085)** to **[65695c1](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**",
    "created_at": "2020-12-27T00:22:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-501164",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/31085](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/31085)** to **[65695c1](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**



---

archive/issue_events_396485.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-27T00:22:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396485"
}
```



---

archive/issue_events_396486.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "33e237fe60f67c76a72167b05404139fc11e5b4d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-12-27T00:22:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-396486"
}
```
