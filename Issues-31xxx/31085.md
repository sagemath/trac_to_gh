# Issue 31085: fix conversion of sign function to fricas

archive/issues_030848.json:
```json
{
    "assignees": [],
    "body": "which apparently has no symbolic sign function\n\nCC:  @mantepse\n\nKeywords: **FriCAS**\n\nBranch/Commit: **[`65695c1`](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**\n\nReviewer: **Martin Rubey**\n\nAuthor: **Fr\u00e9d\u00e9ric Chapoton**\n\nComponent: **interfaces: optional**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31085_\n\n",
    "closed_at": "2020-12-27T00:22:40Z",
    "created_at": "2020-12-19T20:13:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20interfaces%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix conversion of sign function to fricas",
    "type": "issue",
    "updated_at": "2020-12-27T00:22:40Z",
    "url": "https://github.com/sagemath/sage/issues/31085",
    "user": "https://github.com/fchapoton"
}
```
which apparently has no symbolic sign function

CC:  @mantepse

Keywords: **FriCAS**

Branch/Commit: **[`65695c1`](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**

Reviewer: **Martin Rubey**

Author: **Frédéric Chapoton**

Component: **interfaces: optional**

_Issue created by migration from https://trac.sagemath.org/ticket/31085_





---

archive/issue_events_430741.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:13:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430741"
}
```



---

archive/issue_events_430742.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:13:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces%3A%20optional",
    "label_color": "0000ff",
    "label_name": "c: interfaces: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430742"
}
```



---

archive/issue_events_430743.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:13:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430743"
}
```



---

archive/issue_events_430744.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:13:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430744"
}
```



---

archive/issue_events_430745.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2020-12-19T20:14:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430745"
}
```



---

archive/issue_comments_498079.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be\"><code>9cdcb3f</code></a></td><td><code>fix conversion of sign function to fricas</code></td></tr></table>\n",
    "created_at": "2020-12-19T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498079",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be"><code>9cdcb3f</code></a></td><td><code>fix conversion of sign function to fricas</code></td></tr></table>




---

archive/issue_comments_498080.json:
```json
{
    "body": "Commit: **[`9cdcb3f`](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)**",
    "created_at": "2020-12-19T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498080",
    "user": "https://github.com/fchapoton"
}
```

Commit: **[`9cdcb3f`](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)**



---

archive/issue_comments_498081.json:
```json
{
    "body": "Branch: **[u/chapoton/31085](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/31085)**",
    "created_at": "2020-12-19T20:14:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498081",
    "user": "https://github.com/fchapoton"
}
```

Branch: **[u/chapoton/31085](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/31085)**



---

archive/issue_comments_498082.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI don't quite understand the patch.  If you want a sign function for symbolic expressions in fricas, you'll have to use ` x/abs(x) `, I guess.  But I don't think that fricas would be able to do anything with it.  There is a sign function for integers and integer fractions, but I don't see the point of providing a translation, because it should never show up in a result that fricas provides.",
    "created_at": "2020-12-19T20:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498082",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:2" align="right">comment:2</div>

I don't quite understand the patch.  If you want a sign function for symbolic expressions in fricas, you'll have to use ` x/abs(x) `, I guess.  But I don't think that fricas would be able to do anything with it.  There is a sign function for integers and integer fractions, but I don't see the point of providing a translation, because it should never show up in a result that fricas provides.



---

archive/issue_comments_498083.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI was trying the integral in #11590 with fricas, and it did not work. The existing conversion of the symbolic sign function is \"sign\", which cannot handle symbolic arguments.\n\nBut then apparently, Fricas cannot integrate functions containing abs.",
    "created_at": "2020-12-19T20:51:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498083",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">comment:3</div>

I was trying the integral in #11590 with fricas, and it did not work. The existing conversion of the symbolic sign function is "sign", which cannot handle symbolic arguments.

But then apparently, Fricas cannot integrate functions containing abs.



---

archive/issue_comments_498084.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nYes, that's correct (as far as I know).\n\nSo, do you think it makes sense to convert sign to ```x/abs(x)```?  (I don't)",
    "created_at": "2020-12-19T20:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498084",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:4" align="right">comment:4</div>

Yes, that's correct (as far as I know).

So, do you think it makes sense to convert sign to ```x/abs(x)```?  (I don't)



---

archive/issue_comments_498085.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nWell, at least by converting to `abs(x)/x` (I prefer this way, and did that), one can go to fricas and back to sage without error. Why do you think that it's not a good idea ?",
    "created_at": "2020-12-21T08:42:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498085",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

Well, at least by converting to `abs(x)/x` (I prefer this way, and did that), one can go to fricas and back to sage without error. Why do you think that it's not a good idea ?



---

archive/issue_comments_498086.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSorry, I missed that!  Yes, I agree with that!  A doctest might be good, I'll try to think of one.",
    "created_at": "2020-12-21T09:14:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498086",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:6" align="right">comment:6</div>

Sorry, I missed that!  Yes, I agree with that!  A doctest might be good, I'll try to think of one.



---

archive/issue_comments_498087.json:
```json
{
    "body": "Reviewer: **Martin Rubey**",
    "created_at": "2020-12-21T09:14:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498087",
    "user": "https://github.com/mantepse"
}
```

Reviewer: **Martin Rubey**



---

archive/issue_comments_498088.json:
```json
{
    "body": "Changed keywords from none to **FriCAS**",
    "created_at": "2020-12-21T09:15:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498088",
    "user": "https://github.com/mantepse"
}
```

Changed keywords from none to **FriCAS**



---

archive/issue_comments_498089.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHere is a trival test, do you want to add it?\n\n```\nsage: fricas(sign(x)).eval(x=-3)\n- 1\n```\n\nOther than that, it looks good.  There is currently a giac failure, which I cannot say anything about.",
    "created_at": "2020-12-21T18:14:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498089",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:9" align="right">comment:9</div>

Here is a trival test, do you want to add it?

```
sage: fricas(sign(x)).eval(x=-3)
- 1
```

Other than that, it looks good.  There is currently a giac failure, which I cannot say anything about.



---

archive/issue_comments_498090.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f\"><code>65695c1</code></a></td><td><code>add a doctest for fricas sign</code></td></tr></table>\n",
    "created_at": "2020-12-21T20:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498090",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f"><code>65695c1</code></a></td><td><code>add a doctest for fricas sign</code></td></tr></table>




---

archive/issue_comments_498091.json:
```json
{
    "body": "Changed commit from **[`9cdcb3f`](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)** to **[`65695c1`](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**",
    "created_at": "2020-12-21T20:40:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498091",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9cdcb3f`](https://github.com/sagemath/sagetrac-mirror/commit/9cdcb3f9c106e4e93e9a908c22b5676ff560b9be)** to **[`65695c1`](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**



---

archive/issue_comments_498092.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nVoil\u00e0 !",
    "created_at": "2020-12-21T20:42:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498092",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:11" align="right">comment:11</div>

Voilà !



---

archive/issue_events_430746.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2020-12-21T20:49:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430746"
}
```



---

archive/issue_events_430747.json:
```json
{
    "actor": "https://github.com/mantepse",
    "created_at": "2020-12-21T20:49:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430747"
}
```



---

archive/issue_comments_498093.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nGreat, looks good.  I cannot reproduce the giac failure, I guess it's unrelated.",
    "created_at": "2020-12-21T20:49:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498093",
    "user": "https://github.com/mantepse"
}
```

<div id="comment:12" align="right">comment:12</div>

Great, looks good.  I cannot reproduce the giac failure, I guess it's unrelated.



---

archive/issue_comments_498094.json:
```json
{
    "body": "Changed branch from **[u/chapoton/31085](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/31085)** to **[`65695c1`](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**",
    "created_at": "2020-12-27T00:22:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31085#issuecomment-498094",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chapoton/31085](https://github.com/sagemath/sagetrac-mirror/tree/u/chapoton/31085)** to **[`65695c1`](https://github.com/sagemath/sagetrac-mirror/commit/65695c1081d8c8f2f496ac517d61489bd5ad661f)**



---

archive/issue_events_430748.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-12-27T00:22:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430748"
}
```



---

archive/issue_events_430749.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "33e237fe60f67c76a72167b05404139fc11e5b4d",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2020-12-27T00:22:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31085",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31085#event-430749"
}
```
