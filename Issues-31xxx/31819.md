# Issue 31819: Only subfaces/supfaces for polyhedral face iterator

archive/issues_031582.json:
```json
{
    "body": "We allow for the face iterator to only visit subsets of the current face.\n\nCC:  @mkoeppe @yuan-zhou\n\nKeywords: face iterator, polyhedron\n\nBranch/Commit: 7f7e6301eb49ed48fd646beae85772344ba52338\n\nReviewer: Yuan Zhou, Matthias Koeppe\n\nAuthor: Jonathan Kliem\n\nDependencies: #29683, #31245\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/31819\n\n",
    "closed_at": "2021-07-01T20:45:00Z",
    "created_at": "2021-05-12T09:23:39Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.4",
    "title": "Only subfaces/supfaces for polyhedral face iterator",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31819",
    "user": "https://github.com/kliem"
}
```
We allow for the face iterator to only visit subsets of the current face.

CC:  @mkoeppe @yuan-zhou

Keywords: face iterator, polyhedron

Branch/Commit: 7f7e6301eb49ed48fd646beae85772344ba52338

Reviewer: Yuan Zhou, Matthias Koeppe

Author: Jonathan Kliem

Dependencies: #29683, #31245

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/31819





---

archive/issue_comments_632616.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-05-12T09:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632616",
    "user": "https://github.com/kliem"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_632617.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#29683\"",
    "created_at": "2021-05-12T09:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632617",
    "user": "https://github.com/kliem"
}
```

Changing dependencies from "" to "#29683"



---

archive/issue_comments_632618.json:
```json
{
    "body": "Changing commit from \"a95f8d7c5fa17c1dd0076e0c8cb7398e82182d2e\" to \"1cb1b7864dade6b479238c7db4dd9e66424382f1\"",
    "created_at": "2021-05-12T09:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632618",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a95f8d7c5fa17c1dd0076e0c8cb7398e82182d2e" to "1cb1b7864dade6b479238c7db4dd9e66424382f1"



---

archive/issue_comments_632619.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[69fcd71](https://git.sagemath.org/sage.git/commit/?id=69fcd712511f848e19004a65d5b90be1f7fdfd73)|`fix bug revealed by a_maximal_chain`|\n|[1cb1b78](https://git.sagemath.org/sage.git/commit/?id=1cb1b7864dade6b479238c7db4dd9e66424382f1)|`fix error message in doctest`|",
    "created_at": "2021-05-12T09:47:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632619",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[69fcd71](https://git.sagemath.org/sage.git/commit/?id=69fcd712511f848e19004a65d5b90be1f7fdfd73)|`fix bug revealed by a_maximal_chain`|
|[1cb1b78](https://git.sagemath.org/sage.git/commit/?id=1cb1b7864dade6b479238c7db4dd9e66424382f1)|`fix error message in doctest`|



---

archive/issue_comments_632620.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                               |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[2dc14f5](https://git.sagemath.org/sage.git/commit/?id=2dc14f5f761f967f654434bd027d797566dfc9da)|`fix the order of the coatoms when resetting the face iterator`|",
    "created_at": "2021-05-12T14:50:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632620",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                               |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[2dc14f5](https://git.sagemath.org/sage.git/commit/?id=2dc14f5f761f967f654434bd027d797566dfc9da)|`fix the order of the coatoms when resetting the face iterator`|



---

archive/issue_comments_632621.json:
```json
{
    "body": "Changing commit from \"1cb1b7864dade6b479238c7db4dd9e66424382f1\" to \"2dc14f5f761f967f654434bd027d797566dfc9da\"",
    "created_at": "2021-05-12T14:50:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632621",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1cb1b7864dade6b479238c7db4dd9e66424382f1" to "2dc14f5f761f967f654434bd027d797566dfc9da"



---

archive/issue_comments_632622.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                       |\n|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[2e41ed7](https://git.sagemath.org/sage.git/commit/?id=2e41ed7294ae4a1a7517b1de051074c162217cb6)|`fix a variable name and add a doctest`|",
    "created_at": "2021-05-13T18:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632622",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                       |
|-------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[2e41ed7](https://git.sagemath.org/sage.git/commit/?id=2e41ed7294ae4a1a7517b1de051074c162217cb6)|`fix a variable name and add a doctest`|



---

archive/issue_comments_632623.json:
```json
{
    "body": "Changing commit from \"2dc14f5f761f967f654434bd027d797566dfc9da\" to \"2e41ed7294ae4a1a7517b1de051074c162217cb6\"",
    "created_at": "2021-05-13T18:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2dc14f5f761f967f654434bd027d797566dfc9da" to "2e41ed7294ae4a1a7517b1de051074c162217cb6"



---

archive/issue_comments_632624.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n|                                                                                                                                           |                                    |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[2a5a782](https://git.sagemath.org/sage.git/commit/?id=2a5a7821e5575651b8cb18b2c23977af172368e4)|`expose in combinatorial_polyhedron`|\n|[6cecfd7](https://git.sagemath.org/sage.git/commit/?id=6cecfd7442e4b27ced16f554137687cdb226f9d6)|`raise index error for index error; fix doctests`|\n|[9a66e32](https://git.sagemath.org/sage.git/commit/?id=9a66e324a1e5dcd3b176e4a78e49599149bc4c93)|`expose in Polyhedron_base`|\n|[977c088](https://git.sagemath.org/sage.git/commit/?id=977c088966acadcb1b7fd6589e996a68793db697)|`fix doctests`|\n|[15e2c58](https://git.sagemath.org/sage.git/commit/?id=15e2c58d57980e142c8ac90e7081d4e6256a5e84)|`improved documentation`|\n|[deca8e0](https://git.sagemath.org/sage.git/commit/?id=deca8e0aa9df9eb7d4f77d9e6e984962c07c1543)|`fix a variable name and add a doctest`|\n|[be121ad](https://git.sagemath.org/sage.git/commit/?id=be121ad494ccdd78ae2e4e4ca7a15ae9a64c0d94)|`implement only subfaces/supfaces for face iterator`|\n|[ee42e98](https://git.sagemath.org/sage.git/commit/?id=ee42e9895eb8830089e328fae674616ca3e9245c)|`fix bug revealed by a_maximal_chain`|\n|[05ec5b2](https://git.sagemath.org/sage.git/commit/?id=05ec5b29b59e078d5601c4cfa5b1828aa940eab8)|`fix error message in doctest`|\n|[6ddf228](https://git.sagemath.org/sage.git/commit/?id=6ddf2284a5ae25d4680e78615e881df6ef5bf0d9)|`fix the order of the coatoms when resetting the face iterator`|",
    "created_at": "2021-05-13T18:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632624",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
|                                                                                                                                           |                                    |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[2a5a782](https://git.sagemath.org/sage.git/commit/?id=2a5a7821e5575651b8cb18b2c23977af172368e4)|`expose in combinatorial_polyhedron`|
|[6cecfd7](https://git.sagemath.org/sage.git/commit/?id=6cecfd7442e4b27ced16f554137687cdb226f9d6)|`raise index error for index error; fix doctests`|
|[9a66e32](https://git.sagemath.org/sage.git/commit/?id=9a66e324a1e5dcd3b176e4a78e49599149bc4c93)|`expose in Polyhedron_base`|
|[977c088](https://git.sagemath.org/sage.git/commit/?id=977c088966acadcb1b7fd6589e996a68793db697)|`fix doctests`|
|[15e2c58](https://git.sagemath.org/sage.git/commit/?id=15e2c58d57980e142c8ac90e7081d4e6256a5e84)|`improved documentation`|
|[deca8e0](https://git.sagemath.org/sage.git/commit/?id=deca8e0aa9df9eb7d4f77d9e6e984962c07c1543)|`fix a variable name and add a doctest`|
|[be121ad](https://git.sagemath.org/sage.git/commit/?id=be121ad494ccdd78ae2e4e4ca7a15ae9a64c0d94)|`implement only subfaces/supfaces for face iterator`|
|[ee42e98](https://git.sagemath.org/sage.git/commit/?id=ee42e9895eb8830089e328fae674616ca3e9245c)|`fix bug revealed by a_maximal_chain`|
|[05ec5b2](https://git.sagemath.org/sage.git/commit/?id=05ec5b29b59e078d5601c4cfa5b1828aa940eab8)|`fix error message in doctest`|
|[6ddf228](https://git.sagemath.org/sage.git/commit/?id=6ddf2284a5ae25d4680e78615e881df6ef5bf0d9)|`fix the order of the coatoms when resetting the face iterator`|



---

archive/issue_comments_632625.json:
```json
{
    "body": "Changing commit from \"2e41ed7294ae4a1a7517b1de051074c162217cb6\" to \"6ddf2284a5ae25d4680e78615e881df6ef5bf0d9\"",
    "created_at": "2021-05-13T18:52:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632625",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2e41ed7294ae4a1a7517b1de051074c162217cb6" to "6ddf2284a5ae25d4680e78615e881df6ef5bf0d9"



---

archive/issue_comments_632626.json:
```json
{
    "body": "<a id='comment:7'></a>\n(Edited)\nYou probably need to rebase this ticket on the #29683, or put `face.ambient_H_indices(add_equations=False) ` everywhere.",
    "created_at": "2021-05-20T02:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632626",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:7'></a>
(Edited)
You probably need to rebase this ticket on the #29683, or put `face.ambient_H_indices(add_equations=False) ` everywhere.



---

archive/issue_comments_632627.json:
```json
{
    "body": "<a id='comment:8'></a>\nDoes this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.\n\n```\ncdef inline int next_face_loop(iter_t structure) nogil except -1:\n    r\"\"\"\n    See :meth:`FaceIterator.next_face_loop`.\n    \"\"\"\n    if unlikely(structure.current_dimension == structure.dimension):\n        # The function is not supposed to be called,\n        # just prevent it from crashing.\n        raise StopIteration\n```",
    "created_at": "2021-05-20T03:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632627",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:8'></a>
Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.

```
cdef inline int next_face_loop(iter_t structure) nogil except -1:
    r"""
    See :meth:`FaceIterator.next_face_loop`.
    """
    if unlikely(structure.current_dimension == structure.dimension):
        # The function is not supposed to be called,
        # just prevent it from crashing.
        raise StopIteration
```



---

archive/issue_comments_632628.json:
```json
{
    "body": "<a id='comment:9'></a>\nDoes `self.structure.dimension` in `cdef int find_face(self, face_t face) except -1` need changing?",
    "created_at": "2021-05-20T03:35:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632628",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:9'></a>
Does `self.structure.dimension` in `cdef int find_face(self, face_t face) except -1` need changing?



---

archive/issue_comments_632629.json:
```json
{
    "body": "<a id='comment:10'></a>\nIn `face_iterator.pxd`: New value 3 to be added to the comment\n\n```\nint face_status            # 0 not initialized, 1 initialized, 2 added to visited_all\n```",
    "created_at": "2021-05-20T04:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632629",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:10'></a>
In `face_iterator.pxd`: New value 3 to be added to the comment

```
int face_status            # 0 not initialized, 1 initialized, 2 added to visited_all
```



---

archive/issue_comments_632630.json:
```json
{
    "body": "<a id='comment:11'></a>\n\n```\nraise ValueError(\"cannot only visit subsets after ignoring a face\")\nraise ValueError(\"cannot ignore a face after setting iterator to only visit subsets\")\n```\nI understood the first, but not the second. Why is it an error, rather than say that the iterator is consumed? \nI apologize if this is a silly question",
    "created_at": "2021-05-20T04:38:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632630",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:11'></a>

```
raise ValueError("cannot only visit subsets after ignoring a face")
raise ValueError("cannot ignore a face after setting iterator to only visit subsets")
```
I understood the first, but not the second. Why is it an error, rather than say that the iterator is consumed? 
I apologize if this is a silly question



---

archive/issue_comments_632631.json:
```json
{
    "body": "<a id='comment:12'></a>\n\n```\ncdef int only_subsets(self) except -1:\n    self.structure.highest_dimension = self.structure.current_dimension - 1\n```\nWhy doesn't it prevent visiting the (sub) faces of dimension >= `self.structure.current_dimension`?",
    "created_at": "2021-05-20T04:55:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632631",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:12'></a>

```
cdef int only_subsets(self) except -1:
    self.structure.highest_dimension = self.structure.current_dimension - 1
```
Why doesn't it prevent visiting the (sub) faces of dimension >= `self.structure.current_dimension`?



---

archive/issue_comments_632632.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n|                                                                                                                                           |                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[c3f028b](https://git.sagemath.org/sage.git/commit/?id=c3f028b45e1d365f6eee7ede2a0da604b34bd55a)|`check with a nice error for negative indices`|\n|[110228e](https://git.sagemath.org/sage.git/commit/?id=110228e91a23dd8d843f5514d988aac670366d03)|`better check for the far face containment`|\n|[ec79d1e](https://git.sagemath.org/sage.git/commit/?id=ec79d1e27afec272ad916214ba14b46cb50a0b66)|`implement only subfaces/supfaces for face iterator`|\n|[35c50d7](https://git.sagemath.org/sage.git/commit/?id=35c50d78b607588619e69cbe5b1d2f048d87b7e4)|`fix bug revealed by a_maximal_chain`|\n|[8609ee2](https://git.sagemath.org/sage.git/commit/?id=8609ee296dfae71c58f923731c6ed94385d125ef)|`fix error message in doctest`|\n|[1f508a8](https://git.sagemath.org/sage.git/commit/?id=1f508a8beb8e2abbe87289a7de4a24bcfece3edd)|`fix the order of the coatoms when resetting the face iterator`|\n|[b6e097d](https://git.sagemath.org/sage.git/commit/?id=b6e097d6dfbc0603aa2bee09f6ca41784f91e8b9)|`do not display equations for doctests illustrating how the iterator works`|\n|[ff87201](https://git.sagemath.org/sage.git/commit/?id=ff87201fb8b66ed71413ae21207ae1406381fdd8)|`update face status`|\n|[a1b4c12](https://git.sagemath.org/sage.git/commit/?id=a1b4c12248315a8758c4896cfa3ce0fea9dbd5e2)|`consume the iterator if running ignore_subsets after only_subsets`|\n|[40d5640](https://git.sagemath.org/sage.git/commit/?id=40d56400d156210c2c7c7b9751ac88b84b399acd)|`specify for `find_face` that we assume the iterator to be clean`|",
    "created_at": "2021-05-20T07:53:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632632",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
|                                                                                                                                           |                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[c3f028b](https://git.sagemath.org/sage.git/commit/?id=c3f028b45e1d365f6eee7ede2a0da604b34bd55a)|`check with a nice error for negative indices`|
|[110228e](https://git.sagemath.org/sage.git/commit/?id=110228e91a23dd8d843f5514d988aac670366d03)|`better check for the far face containment`|
|[ec79d1e](https://git.sagemath.org/sage.git/commit/?id=ec79d1e27afec272ad916214ba14b46cb50a0b66)|`implement only subfaces/supfaces for face iterator`|
|[35c50d7](https://git.sagemath.org/sage.git/commit/?id=35c50d78b607588619e69cbe5b1d2f048d87b7e4)|`fix bug revealed by a_maximal_chain`|
|[8609ee2](https://git.sagemath.org/sage.git/commit/?id=8609ee296dfae71c58f923731c6ed94385d125ef)|`fix error message in doctest`|
|[1f508a8](https://git.sagemath.org/sage.git/commit/?id=1f508a8beb8e2abbe87289a7de4a24bcfece3edd)|`fix the order of the coatoms when resetting the face iterator`|
|[b6e097d](https://git.sagemath.org/sage.git/commit/?id=b6e097d6dfbc0603aa2bee09f6ca41784f91e8b9)|`do not display equations for doctests illustrating how the iterator works`|
|[ff87201](https://git.sagemath.org/sage.git/commit/?id=ff87201fb8b66ed71413ae21207ae1406381fdd8)|`update face status`|
|[a1b4c12](https://git.sagemath.org/sage.git/commit/?id=a1b4c12248315a8758c4896cfa3ce0fea9dbd5e2)|`consume the iterator if running ignore_subsets after only_subsets`|
|[40d5640](https://git.sagemath.org/sage.git/commit/?id=40d56400d156210c2c7c7b9751ac88b84b399acd)|`specify for `find_face` that we assume the iterator to be clean`|



---

archive/issue_comments_632633.json:
```json
{
    "body": "Changing commit from \"6ddf2284a5ae25d4680e78615e881df6ef5bf0d9\" to \"40d56400d156210c2c7c7b9751ac88b84b399acd\"",
    "created_at": "2021-05-20T07:53:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632633",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6ddf2284a5ae25d4680e78615e881df6ef5bf0d9" to "40d56400d156210c2c7c7b9751ac88b84b399acd"



---

archive/issue_comments_632634.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [yzh](#comment%3A11):\n> {{{\n> raise ValueError(\"cannot only visit subsets after ignoring a face\")\n> raise ValueError(\"cannot ignore a face after setting iterator to only visit subsets\")\n> }}}\n> I understood the first, but not the second. Why is it an error, rather than say that the iterator is consumed? \n> I apologize if this is a silly question\n\n\nIt's not a silly question and even if it where: You are reviewing the ticket and I'm very thankful for this. You have every right to ask silly questions.\n\nFixed.",
    "created_at": "2021-05-20T07:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632634",
    "user": "https://github.com/kliem"
}
```

<a id='comment:14'></a>
Replying to [yzh](#comment%3A11):
> {{{
> raise ValueError("cannot only visit subsets after ignoring a face")
> raise ValueError("cannot ignore a face after setting iterator to only visit subsets")
> }}}
> I understood the first, but not the second. Why is it an error, rather than say that the iterator is consumed? 
> I apologize if this is a silly question


It's not a silly question and even if it where: You are reviewing the ticket and I'm very thankful for this. You have every right to ask silly questions.

Fixed.



---

archive/issue_comments_632635.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [yzh](#comment%3A9):\n> Does `self.structure.dimension` in `cdef int find_face(self, face_t face) except -1` need changing?\n\n\nI specified what I expect in `find_face`. It's a hidden cython method. So I think it is fine to assume things without checking.\n\nIt's not a terrible fail, if `self.structure.highest_dimension` was set. This would just be ignored in this case.",
    "created_at": "2021-05-20T07:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632635",
    "user": "https://github.com/kliem"
}
```

<a id='comment:15'></a>
Replying to [yzh](#comment%3A9):
> Does `self.structure.dimension` in `cdef int find_face(self, face_t face) except -1` need changing?


I specified what I expect in `find_face`. It's a hidden cython method. So I think it is fine to assume things without checking.

It's not a terrible fail, if `self.structure.highest_dimension` was set. This would just be ignored in this case.



---

archive/issue_comments_632636.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [yzh](#comment%3A8):\n> Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.\n> \n> ```\n> cdef inline int next_face_loop(iter_t structure) nogil except -1:\n>     r\"\"\"\n>     See :meth:`FaceIterator.next_face_loop`.\n>     \"\"\"\n>     if unlikely(structure.current_dimension == structure.dimension):\n>         # The function is not supposed to be called,\n>         # just prevent it from crashing.\n>         raise StopIteration\n> ```\n\n\nThis just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.",
    "created_at": "2021-05-20T07:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632636",
    "user": "https://github.com/kliem"
}
```

<a id='comment:16'></a>
Replying to [yzh](#comment%3A8):
> Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.
> 
> ```
> cdef inline int next_face_loop(iter_t structure) nogil except -1:
>     r"""
>     See :meth:`FaceIterator.next_face_loop`.
>     """
>     if unlikely(structure.current_dimension == structure.dimension):
>         # The function is not supposed to be called,
>         # just prevent it from crashing.
>         raise StopIteration
> ```


This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.



---

archive/issue_comments_632637.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [yzh](#comment%3A12):\n> {{{\n> cdef int only_subsets(self) except -1:\n>     self.structure.highest_dimension = self.structure.current_dimension - 1\n> }}}\n> Why doesn't it prevent visiting the (sub) faces of dimension >= `self.structure.current_dimension`?\n\n\nI don't understand the question.\n\n`next_dimension` first calls `next_face_loop`. `only_subsets` makes sure that `next_face_loop` actually gets to the point of calling `get_next_level` (unless our face is the the only face left, than there are no new subfaces). If `new_faces_counter` is non-zero, the current dimension is lowered and it holds that `current_dimension < highest_dimension`.\n\nIf `new_faces_counter` is zero and there are no new subfaces, then `next_face_loop` returns `0` and `next_dimension` terminates as `current_dimension = highest_dimension`.\n\nWhenever `next_face_loop` raises the dimension, it will return `0`. This way `next_dimension` will in fact check, that we still have `current_dimension <= highest_dimension`.",
    "created_at": "2021-05-20T08:16:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632637",
    "user": "https://github.com/kliem"
}
```

<a id='comment:17'></a>
Replying to [yzh](#comment%3A12):
> {{{
> cdef int only_subsets(self) except -1:
>     self.structure.highest_dimension = self.structure.current_dimension - 1
> }}}
> Why doesn't it prevent visiting the (sub) faces of dimension >= `self.structure.current_dimension`?


I don't understand the question.

`next_dimension` first calls `next_face_loop`. `only_subsets` makes sure that `next_face_loop` actually gets to the point of calling `get_next_level` (unless our face is the the only face left, than there are no new subfaces). If `new_faces_counter` is non-zero, the current dimension is lowered and it holds that `current_dimension < highest_dimension`.

If `new_faces_counter` is zero and there are no new subfaces, then `next_face_loop` returns `0` and `next_dimension` terminates as `current_dimension = highest_dimension`.

Whenever `next_face_loop` raises the dimension, it will return `0`. This way `next_dimension` will in fact check, that we still have `current_dimension <= highest_dimension`.



---

archive/issue_comments_632638.json:
```json
{
    "body": "Changing work_issues from \"\" to \"Merge conflict with #31245. One of them needs to be rebased.\"",
    "created_at": "2021-05-20T08:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632638",
    "user": "https://github.com/kliem"
}
```

Changing work_issues from "" to "Merge conflict with #31245. One of them needs to be rebased."



---

archive/issue_comments_632639.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [gh-kliem](#comment%3A16):\n> Replying to [yzh](#comment%3A8):\n> > Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.\n> > \n> > ```\n> > cdef inline int next_face_loop(iter_t structure) nogil except -1:\n> >     r\"\"\"\n> >     See :meth:`FaceIterator.next_face_loop`.\n> >     \"\"\"\n> >     if unlikely(structure.current_dimension == structure.dimension):\n> >         # The function is not supposed to be called,\n> >         # just prevent it from crashing.\n> >         raise StopIteration\n> > ```\n\n> \n> This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.\n\n\nI meant to change to `if unlikely(self.structure.current_dimension > self.structure.highest_dimension):` like all other checkings.\n\nSure, if it never happens, then the current version is fine.",
    "created_at": "2021-05-21T04:31:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632639",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:19'></a>
Replying to [gh-kliem](#comment%3A16):
> Replying to [yzh](#comment%3A8):
> > Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.
> > 
> > ```
> > cdef inline int next_face_loop(iter_t structure) nogil except -1:
> >     r"""
> >     See :meth:`FaceIterator.next_face_loop`.
> >     """
> >     if unlikely(structure.current_dimension == structure.dimension):
> >         # The function is not supposed to be called,
> >         # just prevent it from crashing.
> >         raise StopIteration
> > ```

> 
> This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.


I meant to change to `if unlikely(self.structure.current_dimension > self.structure.highest_dimension):` like all other checkings.

Sure, if it never happens, then the current version is fine.



---

archive/issue_comments_632640.json:
```json
{
    "body": "<a id='comment:20'></a>\n\n```\n    if n_faces <= 1:\n        # There will be no more faces from intersections.\n        structure.current_dimension += 1\n        return 0\n```\nWhat do you mean by \"no more faces from intersections\"? Why is it `n_faces <= 1`, not `n_faces == 0`, nor `n_faces == 1`?",
    "created_at": "2021-05-21T05:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632640",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:20'></a>

```
    if n_faces <= 1:
        # There will be no more faces from intersections.
        structure.current_dimension += 1
        return 0
```
What do you mean by "no more faces from intersections"? Why is it `n_faces <= 1`, not `n_faces == 0`, nor `n_faces == 1`?



---

archive/issue_comments_632641.json:
```json
{
    "body": "<a id='comment:21'></a>\nAll other things on this ticket look good to me. Thanks for the explanations!",
    "created_at": "2021-05-21T05:37:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632641",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:21'></a>
All other things on this ticket look good to me. Thanks for the explanations!



---

archive/issue_comments_632642.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [yzh](#comment%3A19):\n> Replying to [gh-kliem](#comment%3A16):\n> > Replying to [yzh](#comment%3A8):\n> > > Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.\n> > > \n> > > ```\n> > > cdef inline int next_face_loop(iter_t structure) nogil except -1:\n> > >     r\"\"\"\n> > >     See :meth:`FaceIterator.next_face_loop`.\n> > >     \"\"\"\n> > >     if unlikely(structure.current_dimension == structure.dimension):\n> > >         # The function is not supposed to be called,\n> > >         # just prevent it from crashing.\n> > >         raise StopIteration\n> > > ```\n\n> > \n> > This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.\n\n> \n> I meant to change to `if unlikely(self.structure.current_dimension > self.structure.highest_dimension):` like all other checkings.\n> \n> Sure, if it never happens, then the current version is fine.\n\n\nThat's what I figure you meant. But it does not work. E.g. when you want to only visit the elements below the first facet, the highest dimension will be set to `d-2`. But current dimension is `d-1`. Only after `next_face_loop` is called has the dimension changed to `d-2`. This is different from the start. At the start the facets are already known and hence the dimension starts at `d-1`. But when you want to visit everything below something, the elements below have not been computed yet.\n\nI could set this up differently, if you find it confusing and make `only_subsets` call `next_face_loop` once.",
    "created_at": "2021-05-21T19:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632642",
    "user": "https://github.com/kliem"
}
```

<a id='comment:22'></a>
Replying to [yzh](#comment%3A19):
> Replying to [gh-kliem](#comment%3A16):
> > Replying to [yzh](#comment%3A8):
> > > Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.
> > > 
> > > ```
> > > cdef inline int next_face_loop(iter_t structure) nogil except -1:
> > >     r"""
> > >     See :meth:`FaceIterator.next_face_loop`.
> > >     """
> > >     if unlikely(structure.current_dimension == structure.dimension):
> > >         # The function is not supposed to be called,
> > >         # just prevent it from crashing.
> > >         raise StopIteration
> > > ```

> > 
> > This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.

> 
> I meant to change to `if unlikely(self.structure.current_dimension > self.structure.highest_dimension):` like all other checkings.
> 
> Sure, if it never happens, then the current version is fine.


That's what I figure you meant. But it does not work. E.g. when you want to only visit the elements below the first facet, the highest dimension will be set to `d-2`. But current dimension is `d-1`. Only after `next_face_loop` is called has the dimension changed to `d-2`. This is different from the start. At the start the facets are already known and hence the dimension starts at `d-1`. But when you want to visit everything below something, the elements below have not been computed yet.

I could set this up differently, if you find it confusing and make `only_subsets` call `next_face_loop` once.



---

archive/issue_comments_632643.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [yzh](#comment%3A20):\n> {{{\n>     if n_faces <= 1:\n>         # There will be no more faces from intersections.\n>         structure.current_dimension += 1\n>         return 0\n> }}}\n> What do you mean by \"no more faces from intersections\"? Why is it `n_faces <= 1`, not `n_faces == 0`, nor `n_faces == 1`?\n\n\nThe intersections are obtained by intersecting the last face with each previous ones. If there is only one face, we can stop and don't need `get_next_level` to tell us that there are no intersections.\n\nI don't think `n_faces == 0` can happen, but it is better to be safe than sorry. Because `get_next_level` will intersect the last face with all previous ones. If there is zero faces we have an overflow and the face `2^64-1` is intersected with all previous once, which will result in an segmentation fault.\n\nBut maybe it is better to handle this check as a first thing in `get_next_level`. This is probably where it belongs anyway. What do you think?",
    "created_at": "2021-05-21T19:16:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632643",
    "user": "https://github.com/kliem"
}
```

<a id='comment:23'></a>
Replying to [yzh](#comment%3A20):
> {{{
>     if n_faces <= 1:
>         # There will be no more faces from intersections.
>         structure.current_dimension += 1
>         return 0
> }}}
> What do you mean by "no more faces from intersections"? Why is it `n_faces <= 1`, not `n_faces == 0`, nor `n_faces == 1`?


The intersections are obtained by intersecting the last face with each previous ones. If there is only one face, we can stop and don't need `get_next_level` to tell us that there are no intersections.

I don't think `n_faces == 0` can happen, but it is better to be safe than sorry. Because `get_next_level` will intersect the last face with all previous ones. If there is zero faces we have an overflow and the face `2^64-1` is intersected with all previous once, which will result in an segmentation fault.

But maybe it is better to handle this check as a first thing in `get_next_level`. This is probably where it belongs anyway. What do you think?



---

archive/issue_comments_632644.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [gh-kliem](#comment%3A22):\n\n> That's what I figure you meant. But it does not work. E.g. when you want to only visit the elements below the first facet, the highest dimension will be set to `d-2`. But current dimension is `d-1`. Only after `next_face_loop` is called has the dimension changed to `d-2`. This is different from the start. At the start the facets are already known and hence the dimension starts at `d-1`. But when you want to visit everything below something, the elements below have not been computed yet.\n> \n> I could set this up differently, if you find it confusing and make `only_subsets` call `next_face_loop` once.\n\n\nThank you for the patient answer! It makes sense to me now.",
    "created_at": "2021-05-22T02:27:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632644",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:24'></a>
Replying to [gh-kliem](#comment%3A22):

> That's what I figure you meant. But it does not work. E.g. when you want to only visit the elements below the first facet, the highest dimension will be set to `d-2`. But current dimension is `d-1`. Only after `next_face_loop` is called has the dimension changed to `d-2`. This is different from the start. At the start the facets are already known and hence the dimension starts at `d-1`. But when you want to visit everything below something, the elements below have not been computed yet.
> 
> I could set this up differently, if you find it confusing and make `only_subsets` call `next_face_loop` once.


Thank you for the patient answer! It makes sense to me now.



---

archive/issue_comments_632645.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [gh-kliem](#comment%3A23):\n> The intersections are obtained by intersecting the last face with each previous ones. If there is only one face, we can stop and don't need `get_next_level` to tell us that there are no intersections.\n> \n> I don't think `n_faces == 0` can happen, but it is better to be safe than sorry. Because `get_next_level` will intersect the last face with all previous ones. If there is zero faces we have an overflow and the face `2^64-1` is intersected with all previous once, which will result in an segmentation fault.\n> \n> But maybe it is better to handle this check as a first thing in `get_next_level`. This is probably where it belongs anyway. What do you think? \n\n\nI thought that `n_faces == 0` couldn't happen too; that's why I asked, in case I missed/misunderstood something. I was also wondering about the order of the `if` checks in `next_face_loop`, but I figured out that it doesn't really matter. Besides, `next_face_loop` and `get_next_level` are not objects of this ticket. The current implementation works well, so I don't think more changes are needed.",
    "created_at": "2021-05-22T02:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632645",
    "user": "https://github.com/yuan-zhou"
}
```

<a id='comment:25'></a>
Replying to [gh-kliem](#comment%3A23):
> The intersections are obtained by intersecting the last face with each previous ones. If there is only one face, we can stop and don't need `get_next_level` to tell us that there are no intersections.
> 
> I don't think `n_faces == 0` can happen, but it is better to be safe than sorry. Because `get_next_level` will intersect the last face with all previous ones. If there is zero faces we have an overflow and the face `2^64-1` is intersected with all previous once, which will result in an segmentation fault.
> 
> But maybe it is better to handle this check as a first thing in `get_next_level`. This is probably where it belongs anyway. What do you think? 


I thought that `n_faces == 0` couldn't happen too; that's why I asked, in case I missed/misunderstood something. I was also wondering about the order of the `if` checks in `next_face_loop`, but I figured out that it doesn't really matter. Besides, `next_face_loop` and `get_next_level` are not objects of this ticket. The current implementation works well, so I don't think more changes are needed.



---

archive/issue_comments_632646.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Yuan Zhou\"",
    "created_at": "2021-05-22T02:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632646",
    "user": "https://github.com/yuan-zhou"
}
```

Changing reviewer from "" to "Yuan Zhou"



---

archive/issue_comments_632647.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-05-22T02:39:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632647",
    "user": "https://github.com/yuan-zhou"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_632648.json:
```json
{
    "body": "<a id='comment:26'></a>\nThank you.\n\nHowever, I will set this on \"needs work\" due to merge conflict with #31245. Depending on whether #31245 gets in or not, I will either rebase here or rebase #31245 and then put it back on \"positive review\".",
    "created_at": "2021-05-22T08:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632648",
    "user": "https://github.com/kliem"
}
```

<a id='comment:26'></a>
Thank you.

However, I will set this on "needs work" due to merge conflict with #31245. Depending on whether #31245 gets in or not, I will either rebase here or rebase #31245 and then put it back on "positive review".



---

archive/issue_comments_632649.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2021-05-22T08:18:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632649",
    "user": "https://github.com/kliem"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_632650.json:
```json
{
    "body": "<a id='comment:27'></a>\nReady to merge #31245?",
    "created_at": "2021-06-19T20:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632650",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:27'></a>
Ready to merge #31245?



---

archive/issue_comments_632651.json:
```json
{
    "body": "<a id='comment:28'></a>\nI don't know, if #31245 will be rejected again. But it looks like it's done now. It just triggered an unrelated bug.\n\nWhat is the best way to proceed from here? I could just create a branch for this ticket here on top of #31245 and can always go back to the old branch if that fails.",
    "created_at": "2021-06-19T20:47:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632651",
    "user": "https://github.com/kliem"
}
```

<a id='comment:28'></a>
I don't know, if #31245 will be rejected again. But it looks like it's done now. It just triggered an unrelated bug.

What is the best way to proceed from here? I could just create a branch for this ticket here on top of #31245 and can always go back to the old branch if that fails.



---

archive/issue_comments_632652.json:
```json
{
    "body": "<a id='comment:29'></a>\nSure, it's easy to just back out the merge if necessary",
    "created_at": "2021-06-19T21:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632652",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:29'></a>
Sure, it's easy to just back out the merge if necessary



---

archive/issue_comments_632653.json:
```json
{
    "body": "Changing commit from \"40d56400d156210c2c7c7b9751ac88b84b399acd\" to \"d073ca56b926a795c5a22490aa9644accb7f9a1c\"",
    "created_at": "2021-06-19T23:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632653",
    "user": "https://github.com/kliem"
}
```

Changing commit from "40d56400d156210c2c7c7b9751ac88b84b399acd" to "d073ca56b926a795c5a22490aa9644accb7f9a1c"



---

archive/issue_comments_632654.json:
```json
{
    "body": "<a id='comment:30'></a>\nLast 10 new commits:\n|                                                                                                                                          |                                                                                                                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|\n|[70a8791](https://git.sagemath.org/sage.git/commit?id=70a8791eb07df89a7d3e2a40c35516ae93e6e0bb)|`Merge branch 'u/gh-kliem/check_openmp_at_configuration' of git://trac.sagemath.org/sage into u/gh-kliem/first_parallel_version_of_face_iterator_reb2`|\n|[fdbe95f](https://git.sagemath.org/sage.git/commit?id=fdbe95f9cf2b4787a59a459231074a7c528397f3)|`use cython.parallel.threadid instead of omp_get_thread_num`|\n|[4ae6966](https://git.sagemath.org/sage.git/commit?id=4ae6966e49618739268625fbe5b9767ca6175200)|`Merge tag '9.4.beta0' into t/31245/first_parallel_version_of_face_iterator_reb2`|\n|[bfb4efb](https://git.sagemath.org/sage.git/commit?id=bfb4efb24275dd80071451411f71094fe4084710)|`Merge branch 'u/mkoeppe/first_parallel_version_of_face_iterator_reb2' of git://trac.sagemath.org/sage into u/mkoeppe/first_parallel_version_of_face_iterator_reb3`|\n|[4c0a4ae](https://git.sagemath.org/sage.git/commit?id=4c0a4ae74c28680e48080c39c5e3b171a79a9ad3)|`initialize do_f_vector`|\n|[9119d8e](https://git.sagemath.org/sage.git/commit?id=9119d8e1e56a4bccc7b6e12d3b2707100bfca617)|`merge in #31245`|\n|[5dc2c8c](https://git.sagemath.org/sage.git/commit?id=5dc2c8c294d6a9cbe7bd3e4369f69e37e0db34d9)|`merge in public/31834`|\n|[f1270b0](https://git.sagemath.org/sage.git/commit?id=f1270b0cdd23dcf6d715f1e41a4f295e24448c8a)|`Merge branch 'public/31834-reb' of git://trac.sagemath.org/sage into public/31834-reb2`|\n|[297792a](https://git.sagemath.org/sage.git/commit?id=297792afd93108f916b60674e7a748bad2609087)|`equalities -> equations for #31821 as well`|\n|[d073ca5](https://git.sagemath.org/sage.git/commit?id=d073ca56b926a795c5a22490aa9644accb7f9a1c)|`Merge branch 'public/31834-reb2' of git://trac.sagemath.org/sage into u/gh-kliem/only_subsets_reb`|",
    "created_at": "2021-06-19T23:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632654",
    "user": "https://github.com/kliem"
}
```

<a id='comment:30'></a>
Last 10 new commits:
|                                                                                                                                          |                                                                                                                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|
|[70a8791](https://git.sagemath.org/sage.git/commit?id=70a8791eb07df89a7d3e2a40c35516ae93e6e0bb)|`Merge branch 'u/gh-kliem/check_openmp_at_configuration' of git://trac.sagemath.org/sage into u/gh-kliem/first_parallel_version_of_face_iterator_reb2`|
|[fdbe95f](https://git.sagemath.org/sage.git/commit?id=fdbe95f9cf2b4787a59a459231074a7c528397f3)|`use cython.parallel.threadid instead of omp_get_thread_num`|
|[4ae6966](https://git.sagemath.org/sage.git/commit?id=4ae6966e49618739268625fbe5b9767ca6175200)|`Merge tag '9.4.beta0' into t/31245/first_parallel_version_of_face_iterator_reb2`|
|[bfb4efb](https://git.sagemath.org/sage.git/commit?id=bfb4efb24275dd80071451411f71094fe4084710)|`Merge branch 'u/mkoeppe/first_parallel_version_of_face_iterator_reb2' of git://trac.sagemath.org/sage into u/mkoeppe/first_parallel_version_of_face_iterator_reb3`|
|[4c0a4ae](https://git.sagemath.org/sage.git/commit?id=4c0a4ae74c28680e48080c39c5e3b171a79a9ad3)|`initialize do_f_vector`|
|[9119d8e](https://git.sagemath.org/sage.git/commit?id=9119d8e1e56a4bccc7b6e12d3b2707100bfca617)|`merge in #31245`|
|[5dc2c8c](https://git.sagemath.org/sage.git/commit?id=5dc2c8c294d6a9cbe7bd3e4369f69e37e0db34d9)|`merge in public/31834`|
|[f1270b0](https://git.sagemath.org/sage.git/commit?id=f1270b0cdd23dcf6d715f1e41a4f295e24448c8a)|`Merge branch 'public/31834-reb' of git://trac.sagemath.org/sage into public/31834-reb2`|
|[297792a](https://git.sagemath.org/sage.git/commit?id=297792afd93108f916b60674e7a748bad2609087)|`equalities -> equations for #31821 as well`|
|[d073ca5](https://git.sagemath.org/sage.git/commit?id=d073ca56b926a795c5a22490aa9644accb7f9a1c)|`Merge branch 'public/31834-reb2' of git://trac.sagemath.org/sage into u/gh-kliem/only_subsets_reb`|



---

archive/issue_comments_632655.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-06-19T23:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632655",
    "user": "https://github.com/kliem"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_632656.json:
```json
{
    "body": "Changing branch from \"u/gh-kliem/only_subsets\" to \"u/gh-kliem/only_subsets_reb\"",
    "created_at": "2021-06-19T23:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632656",
    "user": "https://github.com/kliem"
}
```

Changing branch from "u/gh-kliem/only_subsets" to "u/gh-kliem/only_subsets_reb"



---

archive/issue_comments_632657.json:
```json
{
    "body": "<a id='comment:31'></a>\nRebased on #31245 and new version of #29683.\n\nNeeded to fix `max_dim` in `next_dimension` because of #31245.",
    "created_at": "2021-06-19T23:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632657",
    "user": "https://github.com/kliem"
}
```

<a id='comment:31'></a>
Rebased on #31245 and new version of #29683.

Needed to fix `max_dim` in `next_dimension` because of #31245.



---

archive/issue_comments_632658.json:
```json
{
    "body": "Changing work_issues from \"Merge conflict with #31245. One of them needs to be rebased.\" to \"\"",
    "created_at": "2021-06-19T23:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632658",
    "user": "https://github.com/kliem"
}
```

Changing work_issues from "Merge conflict with #31245. One of them needs to be rebased." to ""



---

archive/issue_comments_632659.json:
```json
{
    "body": "Changing dependencies from \"#29683\" to \"#29683, #31245\"",
    "created_at": "2021-06-19T23:25:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632659",
    "user": "https://github.com/kliem"
}
```

Changing dependencies from "#29683" to "#29683, #31245"



---

archive/issue_comments_632660.json:
```json
{
    "body": "<a id='comment:32'></a>\nActually rebasing on new version of #29683 and then pulling in #31245.\n\n---\nLast 10 new commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[99ddc2f](https://git.sagemath.org/sage.git/commit?id=99ddc2f635e0546be6ee4f9813fea85486c79817)|`better check for the far face containment`|\n|[0f78d2a](https://git.sagemath.org/sage.git/commit?id=0f78d2a6c05e0460cab8dea296c5d32ac25d2835)|`implement only subfaces/supfaces for face iterator`|\n|[6c88068](https://git.sagemath.org/sage.git/commit?id=6c88068c4c78450513ac5a84d482f3ef33c8ba4e)|`fix bug revealed by a_maximal_chain`|\n|[b72578b](https://git.sagemath.org/sage.git/commit?id=b72578bee43e31df4edf99cd1f140a607c8d714c)|`fix error message in doctest`|\n|[ad75abb](https://git.sagemath.org/sage.git/commit?id=ad75abb5acdf3ac6fbd6e652781e1fd555a5e6c2)|`fix the order of the coatoms when resetting the face iterator`|\n|[3d158ad](https://git.sagemath.org/sage.git/commit?id=3d158adfbc8eaa1fdc88559ea68a1debb37a317e)|`do not display equations for doctests illustrating how the iterator works`|\n|[353313c](https://git.sagemath.org/sage.git/commit?id=353313c3189b8d4da69980d0eba1cb9fcbc9ad3e)|`update face status`|\n|[842fb8e](https://git.sagemath.org/sage.git/commit?id=842fb8efea3c6c694a6469d19a52a5799a114d2c)|`consume the iterator if running ignore_subsets after only_subsets`|\n|[250f0e4](https://git.sagemath.org/sage.git/commit?id=250f0e41942ef94855d4d4391e7467cd191d2754)|`specify for `find_face` that we assume the iterator to be clean`|\n|[542baee](https://git.sagemath.org/sage.git/commit?id=542baee396e8db57d59020cc1fd905e1b045eaa7)|`merge in #31245`|",
    "created_at": "2021-06-19T23:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632660",
    "user": "https://github.com/kliem"
}
```

<a id='comment:32'></a>
Actually rebasing on new version of #29683 and then pulling in #31245.

---
Last 10 new commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[99ddc2f](https://git.sagemath.org/sage.git/commit?id=99ddc2f635e0546be6ee4f9813fea85486c79817)|`better check for the far face containment`|
|[0f78d2a](https://git.sagemath.org/sage.git/commit?id=0f78d2a6c05e0460cab8dea296c5d32ac25d2835)|`implement only subfaces/supfaces for face iterator`|
|[6c88068](https://git.sagemath.org/sage.git/commit?id=6c88068c4c78450513ac5a84d482f3ef33c8ba4e)|`fix bug revealed by a_maximal_chain`|
|[b72578b](https://git.sagemath.org/sage.git/commit?id=b72578bee43e31df4edf99cd1f140a607c8d714c)|`fix error message in doctest`|
|[ad75abb](https://git.sagemath.org/sage.git/commit?id=ad75abb5acdf3ac6fbd6e652781e1fd555a5e6c2)|`fix the order of the coatoms when resetting the face iterator`|
|[3d158ad](https://git.sagemath.org/sage.git/commit?id=3d158adfbc8eaa1fdc88559ea68a1debb37a317e)|`do not display equations for doctests illustrating how the iterator works`|
|[353313c](https://git.sagemath.org/sage.git/commit?id=353313c3189b8d4da69980d0eba1cb9fcbc9ad3e)|`update face status`|
|[842fb8e](https://git.sagemath.org/sage.git/commit?id=842fb8efea3c6c694a6469d19a52a5799a114d2c)|`consume the iterator if running ignore_subsets after only_subsets`|
|[250f0e4](https://git.sagemath.org/sage.git/commit?id=250f0e41942ef94855d4d4391e7467cd191d2754)|`specify for `find_face` that we assume the iterator to be clean`|
|[542baee](https://git.sagemath.org/sage.git/commit?id=542baee396e8db57d59020cc1fd905e1b045eaa7)|`merge in #31245`|



---

archive/issue_comments_632661.json:
```json
{
    "body": "Changing commit from \"d073ca56b926a795c5a22490aa9644accb7f9a1c\" to \"542baee396e8db57d59020cc1fd905e1b045eaa7\"",
    "created_at": "2021-06-19T23:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632661",
    "user": "https://github.com/kliem"
}
```

Changing commit from "d073ca56b926a795c5a22490aa9644accb7f9a1c" to "542baee396e8db57d59020cc1fd905e1b045eaa7"



---

archive/issue_comments_632662.json:
```json
{
    "body": "Changing branch from \"u/gh-kliem/only_subsets_reb\" to \"u/gh-kliem/only_subsets_reb2\"",
    "created_at": "2021-06-19T23:42:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632662",
    "user": "https://github.com/kliem"
}
```

Changing branch from "u/gh-kliem/only_subsets_reb" to "u/gh-kliem/only_subsets_reb2"



---

archive/issue_comments_632663.json:
```json
{
    "body": "Changing branch from \"u/gh-kliem/only_subsets_reb2\" to \"u/mkoeppe/only_subsets_reb2\"",
    "created_at": "2021-06-23T00:54:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632663",
    "user": "https://github.com/mkoeppe"
}
```

Changing branch from "u/gh-kliem/only_subsets_reb2" to "u/mkoeppe/only_subsets_reb2"



---

archive/issue_comments_632664.json:
```json
{
    "body": "Changing commit from \"542baee396e8db57d59020cc1fd905e1b045eaa7\" to \"7f7e6301eb49ed48fd646beae85772344ba52338\"",
    "created_at": "2021-06-23T01:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632664",
    "user": "https://github.com/mkoeppe"
}
```

Changing commit from "542baee396e8db57d59020cc1fd905e1b045eaa7" to "7f7e6301eb49ed48fd646beae85772344ba52338"



---

archive/issue_comments_632665.json:
```json
{
    "body": "Changing reviewer from \"Yuan Zhou\" to \"Yuan Zhou, Matthias Koeppe\"",
    "created_at": "2021-06-23T01:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632665",
    "user": "https://github.com/mkoeppe"
}
```

Changing reviewer from "Yuan Zhou" to "Yuan Zhou, Matthias Koeppe"



---

archive/issue_comments_632666.json:
```json
{
    "body": "<a id='comment:34'></a>\nBack to positive review. LGTM\n\n---\nNew commits:\n|                                                                                                                                          |                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[3e0229f](https://git.sagemath.org/sage.git/commit?id=3e0229f2d13cae98944d37ba5f6a1387334cf96f)|`Merge tag '9.4.beta3' into t/31834/public/31834-reb2`|\n|[8190917](https://git.sagemath.org/sage.git/commit?id=81909176a611e8a0ec32eab9990c25467c417552)|`Merge #31834`|\n|[7f7e630](https://git.sagemath.org/sage.git/commit?id=7f7e6301eb49ed48fd646beae85772344ba52338)|`Merge #29683`|",
    "created_at": "2021-06-23T01:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632666",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:34'></a>
Back to positive review. LGTM

---
New commits:
|                                                                                                                                          |                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[3e0229f](https://git.sagemath.org/sage.git/commit?id=3e0229f2d13cae98944d37ba5f6a1387334cf96f)|`Merge tag '9.4.beta3' into t/31834/public/31834-reb2`|
|[8190917](https://git.sagemath.org/sage.git/commit?id=81909176a611e8a0ec32eab9990c25467c417552)|`Merge #31834`|
|[7f7e630](https://git.sagemath.org/sage.git/commit?id=7f7e6301eb49ed48fd646beae85772344ba52338)|`Merge #29683`|



---

archive/issue_comments_632667.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-06-23T01:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632667",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_632668.json:
```json
{
    "body": "<a id='comment:35'></a>\nThank you.",
    "created_at": "2021-06-23T11:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632668",
    "user": "https://github.com/kliem"
}
```

<a id='comment:35'></a>
Thank you.



---

archive/issue_events_084040.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-01T20:45:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31819#event-84040"
}
```



---

archive/issue_comments_632669.json:
```json
{
    "body": "Changing branch from \"u/mkoeppe/only_subsets_reb2\" to \"7f7e6301eb49ed48fd646beae85772344ba52338\"",
    "created_at": "2021-07-01T20:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632669",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/mkoeppe/only_subsets_reb2" to "7f7e6301eb49ed48fd646beae85772344ba52338"



---

archive/issue_comments_632670.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2021-07-01T20:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31819#issuecomment-632670",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
