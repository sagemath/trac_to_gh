# Issue 31819: Only subfaces/supfaces for polyhedral face iterator

archive/issues_031582.json:
```json
{
    "assignees": [],
    "body": "We allow for the face iterator to only visit subsets of the current face.\n\nDepends on #29683\nDepends on #31245\n\nCC:  @mkoeppe @yuan-zhou\n\nKeywords: **face iterator, polyhedron**\n\nBranch/Commit: **[`7f7e630`](https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338)**\n\nReviewer: **Yuan Zhou, Matthias Koeppe**\n\nAuthor: **Jonathan Kliem**\n\nComponent: **geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31819_\n\n",
    "closed_at": "2021-07-01T20:45:00Z",
    "created_at": "2021-05-12T09:23:39Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Only subfaces/supfaces for polyhedral face iterator",
    "type": "issue",
    "updated_at": "2021-07-01T20:45:00Z",
    "url": "https://github.com/sagemath/sage/issues/31819",
    "user": "https://github.com/kliem"
}
```
We allow for the face iterator to only visit subsets of the current face.

Depends on #29683
Depends on #31245

CC:  @mkoeppe @yuan-zhou

Keywords: **face iterator, polyhedron**

Branch/Commit: **[`7f7e630`](https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338)**

Reviewer: **Yuan Zhou, Matthias Koeppe**

Author: **Jonathan Kliem**

Component: **geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/31819_





---

archive/issue_events_438848.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T09:23:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438848"
}
```



---

archive/issue_events_438849.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T09:23:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438849"
}
```



---

archive/issue_events_438850.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T09:23:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438850"
}
```



---

archive/issue_events_438851.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T09:23:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438851"
}
```



---

archive/issue_events_438852.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-12T09:23:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438852"
}
```



---

archive/issue_comments_511729.json:
```json
{
    "body": "Dependencies: **#29683**",
    "created_at": "2021-05-12T09:23:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511729",
    "user": "https://github.com/kliem"
}
```

Dependencies: **#29683**



---

archive/issue_comments_511730.json:
```json
{
    "body": "Changed commit from **[`a95f8d7`](https://github.com/sagemath/sagetrac-mirror/commit/a95f8d7c5fa17c1dd0076e0c8cb7398e82182d2e)** to **[`1cb1b78`](https://github.com/sagemath/sagetrac-mirror/commit/1cb1b7864dade6b479238c7db4dd9e66424382f1)**",
    "created_at": "2021-05-12T09:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511730",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a95f8d7`](https://github.com/sagemath/sagetrac-mirror/commit/a95f8d7c5fa17c1dd0076e0c8cb7398e82182d2e)** to **[`1cb1b78`](https://github.com/sagemath/sagetrac-mirror/commit/1cb1b7864dade6b479238c7db4dd9e66424382f1)**



---

archive/issue_comments_511731.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69fcd712511f848e19004a65d5b90be1f7fdfd73\">69fcd71</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cb1b7864dade6b479238c7db4dd9e66424382f1\">1cb1b78</a></td><td><code>fix error message in doctest</code></td></tr></table>\n",
    "created_at": "2021-05-12T09:47:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511731",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69fcd712511f848e19004a65d5b90be1f7fdfd73">69fcd71</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cb1b7864dade6b479238c7db4dd9e66424382f1">1cb1b78</a></td><td><code>fix error message in doctest</code></td></tr></table>




---

archive/issue_comments_511732.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2dc14f5f761f967f654434bd027d797566dfc9da\">2dc14f5</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr></table>\n",
    "created_at": "2021-05-12T14:50:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511732",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2dc14f5f761f967f654434bd027d797566dfc9da">2dc14f5</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr></table>




---

archive/issue_comments_511733.json:
```json
{
    "body": "Changed commit from **[`1cb1b78`](https://github.com/sagemath/sagetrac-mirror/commit/1cb1b7864dade6b479238c7db4dd9e66424382f1)** to **[`2dc14f5`](https://github.com/sagemath/sagetrac-mirror/commit/2dc14f5f761f967f654434bd027d797566dfc9da)**",
    "created_at": "2021-05-12T14:50:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511733",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1cb1b78`](https://github.com/sagemath/sagetrac-mirror/commit/1cb1b7864dade6b479238c7db4dd9e66424382f1)** to **[`2dc14f5`](https://github.com/sagemath/sagetrac-mirror/commit/2dc14f5f761f967f654434bd027d797566dfc9da)**



---

archive/issue_comments_511734.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e41ed7294ae4a1a7517b1de051074c162217cb6\">2e41ed7</a></td><td><code>fix a variable name and add a doctest</code></td></tr></table>\n",
    "created_at": "2021-05-13T18:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511734",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e41ed7294ae4a1a7517b1de051074c162217cb6">2e41ed7</a></td><td><code>fix a variable name and add a doctest</code></td></tr></table>




---

archive/issue_comments_511735.json:
```json
{
    "body": "Changed commit from **[`2dc14f5`](https://github.com/sagemath/sagetrac-mirror/commit/2dc14f5f761f967f654434bd027d797566dfc9da)** to **[`2e41ed7`](https://github.com/sagemath/sagetrac-mirror/commit/2e41ed7294ae4a1a7517b1de051074c162217cb6)**",
    "created_at": "2021-05-13T18:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511735",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2dc14f5`](https://github.com/sagemath/sagetrac-mirror/commit/2dc14f5f761f967f654434bd027d797566dfc9da)** to **[`2e41ed7`](https://github.com/sagemath/sagetrac-mirror/commit/2e41ed7294ae4a1a7517b1de051074c162217cb6)**



---

archive/issue_comments_511736.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a5a7821e5575651b8cb18b2c23977af172368e4\">2a5a782</a></td><td><code>expose in combinatorial_polyhedron</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6cecfd7442e4b27ced16f554137687cdb226f9d6\">6cecfd7</a></td><td><code>raise index error for index error; fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a66e324a1e5dcd3b176e4a78e49599149bc4c93\">9a66e32</a></td><td><code>expose in Polyhedron_base</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/977c088966acadcb1b7fd6589e996a68793db697\">977c088</a></td><td><code>fix doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15e2c58d57980e142c8ac90e7081d4e6256a5e84\">15e2c58</a></td><td><code>improved documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/deca8e0aa9df9eb7d4f77d9e6e984962c07c1543\">deca8e0</a></td><td><code>fix a variable name and add a doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/be121ad494ccdd78ae2e4e4ca7a15ae9a64c0d94\">be121ad</a></td><td><code>implement only subfaces/supfaces for face iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee42e9895eb8830089e328fae674616ca3e9245c\">ee42e98</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/05ec5b29b59e078d5601c4cfa5b1828aa940eab8\">05ec5b2</a></td><td><code>fix error message in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6ddf2284a5ae25d4680e78615e881df6ef5bf0d9\">6ddf228</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr></table>\n",
    "created_at": "2021-05-13T18:52:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511736",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a5a7821e5575651b8cb18b2c23977af172368e4">2a5a782</a></td><td><code>expose in combinatorial_polyhedron</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6cecfd7442e4b27ced16f554137687cdb226f9d6">6cecfd7</a></td><td><code>raise index error for index error; fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a66e324a1e5dcd3b176e4a78e49599149bc4c93">9a66e32</a></td><td><code>expose in Polyhedron_base</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/977c088966acadcb1b7fd6589e996a68793db697">977c088</a></td><td><code>fix doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15e2c58d57980e142c8ac90e7081d4e6256a5e84">15e2c58</a></td><td><code>improved documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/deca8e0aa9df9eb7d4f77d9e6e984962c07c1543">deca8e0</a></td><td><code>fix a variable name and add a doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/be121ad494ccdd78ae2e4e4ca7a15ae9a64c0d94">be121ad</a></td><td><code>implement only subfaces/supfaces for face iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee42e9895eb8830089e328fae674616ca3e9245c">ee42e98</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/05ec5b29b59e078d5601c4cfa5b1828aa940eab8">05ec5b2</a></td><td><code>fix error message in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6ddf2284a5ae25d4680e78615e881df6ef5bf0d9">6ddf228</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr></table>




---

archive/issue_comments_511737.json:
```json
{
    "body": "Changed commit from **[`2e41ed7`](https://github.com/sagemath/sagetrac-mirror/commit/2e41ed7294ae4a1a7517b1de051074c162217cb6)** to **[`6ddf228`](https://github.com/sagemath/sagetrac-mirror/commit/6ddf2284a5ae25d4680e78615e881df6ef5bf0d9)**",
    "created_at": "2021-05-13T18:52:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511737",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2e41ed7`](https://github.com/sagemath/sagetrac-mirror/commit/2e41ed7294ae4a1a7517b1de051074c162217cb6)** to **[`6ddf228`](https://github.com/sagemath/sagetrac-mirror/commit/6ddf2284a5ae25d4680e78615e881df6ef5bf0d9)**



---

archive/issue_comments_511738.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n(Edited)\nYou probably need to rebase this ticket on the #29683, or put `face.ambient_H_indices(add_equations=False) ` everywhere.",
    "created_at": "2021-05-20T02:28:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511738",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:7" align="right">comment:7</div>

(Edited)
You probably need to rebase this ticket on the #29683, or put `face.ambient_H_indices(add_equations=False) ` everywhere.



---

archive/issue_comments_511739.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nDoes this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.\n\n```\ncdef inline int next_face_loop(iter_t structure) nogil except -1:\n    r\"\"\"\n    See :meth:`FaceIterator.next_face_loop`.\n    \"\"\"\n    if unlikely(structure.current_dimension == structure.dimension):\n        # The function is not supposed to be called,\n        # just prevent it from crashing.\n        raise StopIteration\n```",
    "created_at": "2021-05-20T03:25:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511739",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:8" align="right">comment:8</div>

Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.

```
cdef inline int next_face_loop(iter_t structure) nogil except -1:
    r"""
    See :meth:`FaceIterator.next_face_loop`.
    """
    if unlikely(structure.current_dimension == structure.dimension):
        # The function is not supposed to be called,
        # just prevent it from crashing.
        raise StopIteration
```



---

archive/issue_comments_511740.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nDoes `self.structure.dimension` in `cdef int find_face(self, face_t face) except -1` need changing?",
    "created_at": "2021-05-20T03:35:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511740",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:9" align="right">comment:9</div>

Does `self.structure.dimension` in `cdef int find_face(self, face_t face) except -1` need changing?



---

archive/issue_comments_511741.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nIn `face_iterator.pxd`: New value 3 to be added to the comment\n\n```\nint face_status            # 0 not initialized, 1 initialized, 2 added to visited_all\n```",
    "created_at": "2021-05-20T04:12:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511741",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:10" align="right">comment:10</div>

In `face_iterator.pxd`: New value 3 to be added to the comment

```
int face_status            # 0 not initialized, 1 initialized, 2 added to visited_all
```



---

archive/issue_comments_511742.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\n\n```\nraise ValueError(\"cannot only visit subsets after ignoring a face\")\nraise ValueError(\"cannot ignore a face after setting iterator to only visit subsets\")\n```\nI understood the first, but not the second. Why is it an error, rather than say that the iterator is consumed? \nI apologize if this is a silly question",
    "created_at": "2021-05-20T04:38:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511742",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:11" align="right">comment:11</div>


```
raise ValueError("cannot only visit subsets after ignoring a face")
raise ValueError("cannot ignore a face after setting iterator to only visit subsets")
```
I understood the first, but not the second. Why is it an error, rather than say that the iterator is consumed? 
I apologize if this is a silly question



---

archive/issue_comments_511743.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\n\n```\ncdef int only_subsets(self) except -1:\n    self.structure.highest_dimension = self.structure.current_dimension - 1\n```\nWhy doesn't it prevent visiting the (sub) faces of dimension >= `self.structure.current_dimension`?",
    "created_at": "2021-05-20T04:55:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511743",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:12" align="right">comment:12</div>


```
cdef int only_subsets(self) except -1:
    self.structure.highest_dimension = self.structure.current_dimension - 1
```
Why doesn't it prevent visiting the (sub) faces of dimension >= `self.structure.current_dimension`?



---

archive/issue_comments_511744.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3f028b45e1d365f6eee7ede2a0da604b34bd55a\">c3f028b</a></td><td><code>check with a nice error for negative indices</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/110228e91a23dd8d843f5514d988aac670366d03\">110228e</a></td><td><code>better check for the far face containment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ec79d1e27afec272ad916214ba14b46cb50a0b66\">ec79d1e</a></td><td><code>implement only subfaces/supfaces for face iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35c50d78b607588619e69cbe5b1d2f048d87b7e4\">35c50d7</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8609ee296dfae71c58f923731c6ed94385d125ef\">8609ee2</a></td><td><code>fix error message in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1f508a8beb8e2abbe87289a7de4a24bcfece3edd\">1f508a8</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b6e097d6dfbc0603aa2bee09f6ca41784f91e8b9\">b6e097d</a></td><td><code>do not display equations for doctests illustrating how the iterator works</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff87201fb8b66ed71413ae21207ae1406381fdd8\">ff87201</a></td><td><code>update face status</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a1b4c12248315a8758c4896cfa3ce0fea9dbd5e2\">a1b4c12</a></td><td><code>consume the iterator if running ignore_subsets after only_subsets</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40d56400d156210c2c7c7b9751ac88b84b399acd\">40d5640</a></td><td><code>specify for `find_face` that we assume the iterator to be clean</code></td></tr></table>\n",
    "created_at": "2021-05-20T07:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511744",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3f028b45e1d365f6eee7ede2a0da604b34bd55a">c3f028b</a></td><td><code>check with a nice error for negative indices</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/110228e91a23dd8d843f5514d988aac670366d03">110228e</a></td><td><code>better check for the far face containment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ec79d1e27afec272ad916214ba14b46cb50a0b66">ec79d1e</a></td><td><code>implement only subfaces/supfaces for face iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35c50d78b607588619e69cbe5b1d2f048d87b7e4">35c50d7</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8609ee296dfae71c58f923731c6ed94385d125ef">8609ee2</a></td><td><code>fix error message in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1f508a8beb8e2abbe87289a7de4a24bcfece3edd">1f508a8</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b6e097d6dfbc0603aa2bee09f6ca41784f91e8b9">b6e097d</a></td><td><code>do not display equations for doctests illustrating how the iterator works</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff87201fb8b66ed71413ae21207ae1406381fdd8">ff87201</a></td><td><code>update face status</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a1b4c12248315a8758c4896cfa3ce0fea9dbd5e2">a1b4c12</a></td><td><code>consume the iterator if running ignore_subsets after only_subsets</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40d56400d156210c2c7c7b9751ac88b84b399acd">40d5640</a></td><td><code>specify for `find_face` that we assume the iterator to be clean</code></td></tr></table>




---

archive/issue_comments_511745.json:
```json
{
    "body": "Changed commit from **[`6ddf228`](https://github.com/sagemath/sagetrac-mirror/commit/6ddf2284a5ae25d4680e78615e881df6ef5bf0d9)** to **[`40d5640`](https://github.com/sagemath/sagetrac-mirror/commit/40d56400d156210c2c7c7b9751ac88b84b399acd)**",
    "created_at": "2021-05-20T07:53:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511745",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6ddf228`](https://github.com/sagemath/sagetrac-mirror/commit/6ddf2284a5ae25d4680e78615e881df6ef5bf0d9)** to **[`40d5640`](https://github.com/sagemath/sagetrac-mirror/commit/40d56400d156210c2c7c7b9751ac88b84b399acd)**



---

archive/issue_comments_511746.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@yuan-zhou](#comment:11):\n> \n> ```\n> raise ValueError(\"cannot only visit subsets after ignoring a face\")\n> raise ValueError(\"cannot ignore a face after setting iterator to only visit subsets\")\n> ```\n> I understood the first, but not the second. Why is it an error, rather than say that the iterator is consumed? \n> I apologize if this is a silly question\n\nIt's not a silly question and even if it where: You are reviewing the ticket and I'm very thankful for this. You have every right to ask silly questions.\n\nFixed.",
    "created_at": "2021-05-20T07:55:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511746",
    "user": "https://github.com/kliem"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@yuan-zhou](#comment:11):
> 
> ```
> raise ValueError("cannot only visit subsets after ignoring a face")
> raise ValueError("cannot ignore a face after setting iterator to only visit subsets")
> ```
> I understood the first, but not the second. Why is it an error, rather than say that the iterator is consumed? 
> I apologize if this is a silly question

It's not a silly question and even if it where: You are reviewing the ticket and I'm very thankful for this. You have every right to ask silly questions.

Fixed.



---

archive/issue_comments_511747.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@yuan-zhou](#comment:9):\n> Does `self.structure.dimension` in `cdef int find_face(self, face_t face) except -1` need changing?\n\nI specified what I expect in `find_face`. It's a hidden cython method. So I think it is fine to assume things without checking.\n\nIt's not a terrible fail, if `self.structure.highest_dimension` was set. This would just be ignored in this case.",
    "created_at": "2021-05-20T07:57:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511747",
    "user": "https://github.com/kliem"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@yuan-zhou](#comment:9):
> Does `self.structure.dimension` in `cdef int find_face(self, face_t face) except -1` need changing?

I specified what I expect in `find_face`. It's a hidden cython method. So I think it is fine to assume things without checking.

It's not a terrible fail, if `self.structure.highest_dimension` was set. This would just be ignored in this case.



---

archive/issue_comments_511748.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@yuan-zhou](#comment:8):\n> Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.\n> \n> ```\n> cdef inline int next_face_loop(iter_t structure) nogil except -1:\n>     r\"\"\"\n>     See :meth:`FaceIterator.next_face_loop`.\n>     \"\"\"\n>     if unlikely(structure.current_dimension == structure.dimension):\n>         # The function is not supposed to be called,\n>         # just prevent it from crashing.\n>         raise StopIteration\n> ```\n\nThis just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.",
    "created_at": "2021-05-20T07:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511748",
    "user": "https://github.com/kliem"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@yuan-zhou](#comment:8):
> Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.
> 
> ```
> cdef inline int next_face_loop(iter_t structure) nogil except -1:
>     r"""
>     See :meth:`FaceIterator.next_face_loop`.
>     """
>     if unlikely(structure.current_dimension == structure.dimension):
>         # The function is not supposed to be called,
>         # just prevent it from crashing.
>         raise StopIteration
> ```

This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.



---

archive/issue_comments_511749.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@yuan-zhou](#comment:12):\n> \n> ```\n> cdef int only_subsets(self) except -1:\n>     self.structure.highest_dimension = self.structure.current_dimension - 1\n> ```\n> Why doesn't it prevent visiting the (sub) faces of dimension >= `self.structure.current_dimension`?\n\nI don't understand the question.\n\n`next_dimension` first calls `next_face_loop`. `only_subsets` makes sure that `next_face_loop` actually gets to the point of calling `get_next_level` (unless our face is the the only face left, than there are no new subfaces). If `new_faces_counter` is non-zero, the current dimension is lowered and it holds that `current_dimension < highest_dimension`.\n\nIf `new_faces_counter` is zero and there are no new subfaces, then `next_face_loop` returns `0` and `next_dimension` terminates as `current_dimension = highest_dimension`.\n\nWhenever `next_face_loop` raises the dimension, it will return `0`. This way `next_dimension` will in fact check, that we still have `current_dimension <= highest_dimension`.",
    "created_at": "2021-05-20T08:16:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511749",
    "user": "https://github.com/kliem"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@yuan-zhou](#comment:12):
> 
> ```
> cdef int only_subsets(self) except -1:
>     self.structure.highest_dimension = self.structure.current_dimension - 1
> ```
> Why doesn't it prevent visiting the (sub) faces of dimension >= `self.structure.current_dimension`?

I don't understand the question.

`next_dimension` first calls `next_face_loop`. `only_subsets` makes sure that `next_face_loop` actually gets to the point of calling `get_next_level` (unless our face is the the only face left, than there are no new subfaces). If `new_faces_counter` is non-zero, the current dimension is lowered and it holds that `current_dimension < highest_dimension`.

If `new_faces_counter` is zero and there are no new subfaces, then `next_face_loop` returns `0` and `next_dimension` terminates as `current_dimension = highest_dimension`.

Whenever `next_face_loop` raises the dimension, it will return `0`. This way `next_dimension` will in fact check, that we still have `current_dimension <= highest_dimension`.



---

archive/issue_comments_511750.json:
```json
{
    "body": "Work Issues: **Merge conflict with #31245. One of them needs to be rebased.**",
    "created_at": "2021-05-20T08:56:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511750",
    "user": "https://github.com/kliem"
}
```

Work Issues: **Merge conflict with #31245. One of them needs to be rebased.**



---

archive/issue_comments_511751.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@kliem](#comment:16):\n> Replying to [@yuan-zhou](#comment:8):\n> > Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.\n> > \n> > ```\n> > cdef inline int next_face_loop(iter_t structure) nogil except -1:\n> >     r\"\"\"\n> >     See :meth:`FaceIterator.next_face_loop`.\n> >     \"\"\"\n> >     if unlikely(structure.current_dimension == structure.dimension):\n> >         # The function is not supposed to be called,\n> >         # just prevent it from crashing.\n> >         raise StopIteration\n> > ```\n\n> \n> This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.\n\nI meant to change to `if unlikely(self.structure.current_dimension > self.structure.highest_dimension):` like all other checkings.\n\nSure, if it never happens, then the current version is fine.",
    "created_at": "2021-05-21T04:31:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511751",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@kliem](#comment:16):
> Replying to [@yuan-zhou](#comment:8):
> > Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.
> > 
> > ```
> > cdef inline int next_face_loop(iter_t structure) nogil except -1:
> >     r"""
> >     See :meth:`FaceIterator.next_face_loop`.
> >     """
> >     if unlikely(structure.current_dimension == structure.dimension):
> >         # The function is not supposed to be called,
> >         # just prevent it from crashing.
> >         raise StopIteration
> > ```

> 
> This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.

I meant to change to `if unlikely(self.structure.current_dimension > self.structure.highest_dimension):` like all other checkings.

Sure, if it never happens, then the current version is fine.



---

archive/issue_comments_511752.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n\n```\n    if n_faces <= 1:\n        # There will be no more faces from intersections.\n        structure.current_dimension += 1\n        return 0\n```\nWhat do you mean by \"no more faces from intersections\"? Why is it `n_faces <= 1`, not `n_faces == 0`, nor `n_faces == 1`?",
    "created_at": "2021-05-21T05:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511752",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:20" align="right">comment:20</div>


```
    if n_faces <= 1:
        # There will be no more faces from intersections.
        structure.current_dimension += 1
        return 0
```
What do you mean by "no more faces from intersections"? Why is it `n_faces <= 1`, not `n_faces == 0`, nor `n_faces == 1`?



---

archive/issue_comments_511753.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAll other things on this ticket look good to me. Thanks for the explanations!",
    "created_at": "2021-05-21T05:37:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511753",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:21" align="right">comment:21</div>

All other things on this ticket look good to me. Thanks for the explanations!



---

archive/issue_comments_511754.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@yuan-zhou](#comment:19):\n> Replying to [@kliem](#comment:16):\n> > Replying to [@yuan-zhou](#comment:8):\n> > > Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.\n> > > \n> > > ```\n> > > cdef inline int next_face_loop(iter_t structure) nogil except -1:\n> > >     r\"\"\"\n> > >     See :meth:`FaceIterator.next_face_loop`.\n> > >     \"\"\"\n> > >     if unlikely(structure.current_dimension == structure.dimension):\n> > >         # The function is not supposed to be called,\n> > >         # just prevent it from crashing.\n> > >         raise StopIteration\n> > > ```\n\n> > \n> > This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.\n\n> \n> I meant to change to `if unlikely(self.structure.current_dimension > self.structure.highest_dimension):` like all other checkings.\n> \n> Sure, if it never happens, then the current version is fine.\n\nThat's what I figure you meant. But it does not work. E.g. when you want to only visit the elements below the first facet, the highest dimension will be set to `d-2`. But current dimension is `d-1`. Only after `next_face_loop` is called has the dimension changed to `d-2`. This is different from the start. At the start the facets are already known and hence the dimension starts at `d-1`. But when you want to visit everything below something, the elements below have not been computed yet.\n\nI could set this up differently, if you find it confusing and make `only_subsets` call `next_face_loop` once.",
    "created_at": "2021-05-21T19:07:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511754",
    "user": "https://github.com/kliem"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@yuan-zhou](#comment:19):
> Replying to [@kliem](#comment:16):
> > Replying to [@yuan-zhou](#comment:8):
> > > Does this need to be changed to `structure.highest_dimension`? Or maybe I'm looking at a wrong version of the code.
> > > 
> > > ```
> > > cdef inline int next_face_loop(iter_t structure) nogil except -1:
> > >     r"""
> > >     See :meth:`FaceIterator.next_face_loop`.
> > >     """
> > >     if unlikely(structure.current_dimension == structure.dimension):
> > >         # The function is not supposed to be called,
> > >         # just prevent it from crashing.
> > >         raise StopIteration
> > > ```

> > 
> > This just prevents segmentation fault. It's never supposed to happen anyway. In fact I can't even change this. Because when I set `highest_dimension` it will be equal to `current_dimension`. Only after running this, is `current_dimension` lower, if there are faces left.

> 
> I meant to change to `if unlikely(self.structure.current_dimension > self.structure.highest_dimension):` like all other checkings.
> 
> Sure, if it never happens, then the current version is fine.

That's what I figure you meant. But it does not work. E.g. when you want to only visit the elements below the first facet, the highest dimension will be set to `d-2`. But current dimension is `d-1`. Only after `next_face_loop` is called has the dimension changed to `d-2`. This is different from the start. At the start the facets are already known and hence the dimension starts at `d-1`. But when you want to visit everything below something, the elements below have not been computed yet.

I could set this up differently, if you find it confusing and make `only_subsets` call `next_face_loop` once.



---

archive/issue_comments_511755.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@yuan-zhou](#comment:20):\n> \n> ```\n>     if n_faces <= 1:\n>         # There will be no more faces from intersections.\n>         structure.current_dimension += 1\n>         return 0\n> ```\n> What do you mean by \"no more faces from intersections\"? Why is it `n_faces <= 1`, not `n_faces == 0`, nor `n_faces == 1`?\n\nThe intersections are obtained by intersecting the last face with each previous ones. If there is only one face, we can stop and don't need `get_next_level` to tell us that there are no intersections.\n\nI don't think `n_faces == 0` can happen, but it is better to be safe than sorry. Because `get_next_level` will intersect the last face with all previous ones. If there is zero faces we have an overflow and the face `2^64-1` is intersected with all previous once, which will result in an segmentation fault.\n\nBut maybe it is better to handle this check as a first thing in `get_next_level`. This is probably where it belongs anyway. What do you think?",
    "created_at": "2021-05-21T19:16:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511755",
    "user": "https://github.com/kliem"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@yuan-zhou](#comment:20):
> 
> ```
>     if n_faces <= 1:
>         # There will be no more faces from intersections.
>         structure.current_dimension += 1
>         return 0
> ```
> What do you mean by "no more faces from intersections"? Why is it `n_faces <= 1`, not `n_faces == 0`, nor `n_faces == 1`?

The intersections are obtained by intersecting the last face with each previous ones. If there is only one face, we can stop and don't need `get_next_level` to tell us that there are no intersections.

I don't think `n_faces == 0` can happen, but it is better to be safe than sorry. Because `get_next_level` will intersect the last face with all previous ones. If there is zero faces we have an overflow and the face `2^64-1` is intersected with all previous once, which will result in an segmentation fault.

But maybe it is better to handle this check as a first thing in `get_next_level`. This is probably where it belongs anyway. What do you think?



---

archive/issue_comments_511756.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@kliem](#comment:22):\n\n> That's what I figure you meant. But it does not work. E.g. when you want to only visit the elements below the first facet, the highest dimension will be set to `d-2`. But current dimension is `d-1`. Only after `next_face_loop` is called has the dimension changed to `d-2`. This is different from the start. At the start the facets are already known and hence the dimension starts at `d-1`. But when you want to visit everything below something, the elements below have not been computed yet.\n> \n> I could set this up differently, if you find it confusing and make `only_subsets` call `next_face_loop` once.\n\nThank you for the patient answer! It makes sense to me now.",
    "created_at": "2021-05-22T02:27:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511756",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@kliem](#comment:22):

> That's what I figure you meant. But it does not work. E.g. when you want to only visit the elements below the first facet, the highest dimension will be set to `d-2`. But current dimension is `d-1`. Only after `next_face_loop` is called has the dimension changed to `d-2`. This is different from the start. At the start the facets are already known and hence the dimension starts at `d-1`. But when you want to visit everything below something, the elements below have not been computed yet.
> 
> I could set this up differently, if you find it confusing and make `only_subsets` call `next_face_loop` once.

Thank you for the patient answer! It makes sense to me now.



---

archive/issue_comments_511757.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@kliem](#comment:23):\n> The intersections are obtained by intersecting the last face with each previous ones. If there is only one face, we can stop and don't need `get_next_level` to tell us that there are no intersections.\n> \n> I don't think `n_faces == 0` can happen, but it is better to be safe than sorry. Because `get_next_level` will intersect the last face with all previous ones. If there is zero faces we have an overflow and the face `2^64-1` is intersected with all previous once, which will result in an segmentation fault.\n> \n> But maybe it is better to handle this check as a first thing in `get_next_level`. This is probably where it belongs anyway. What do you think? \n\nI thought that `n_faces == 0` couldn't happen too; that's why I asked, in case I missed/misunderstood something. I was also wondering about the order of the `if` checks in `next_face_loop`, but I figured out that it doesn't really matter. Besides, `next_face_loop` and `get_next_level` are not objects of this ticket. The current implementation works well, so I don't think more changes are needed.",
    "created_at": "2021-05-22T02:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511757",
    "user": "https://github.com/yuan-zhou"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@kliem](#comment:23):
> The intersections are obtained by intersecting the last face with each previous ones. If there is only one face, we can stop and don't need `get_next_level` to tell us that there are no intersections.
> 
> I don't think `n_faces == 0` can happen, but it is better to be safe than sorry. Because `get_next_level` will intersect the last face with all previous ones. If there is zero faces we have an overflow and the face `2^64-1` is intersected with all previous once, which will result in an segmentation fault.
> 
> But maybe it is better to handle this check as a first thing in `get_next_level`. This is probably where it belongs anyway. What do you think? 

I thought that `n_faces == 0` couldn't happen too; that's why I asked, in case I missed/misunderstood something. I was also wondering about the order of the `if` checks in `next_face_loop`, but I figured out that it doesn't really matter. Besides, `next_face_loop` and `get_next_level` are not objects of this ticket. The current implementation works well, so I don't think more changes are needed.



---

archive/issue_comments_511758.json:
```json
{
    "body": "Reviewer: **Yuan Zhou**",
    "created_at": "2021-05-22T02:39:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511758",
    "user": "https://github.com/yuan-zhou"
}
```

Reviewer: **Yuan Zhou**



---

archive/issue_events_438853.json:
```json
{
    "actor": "https://github.com/yuan-zhou",
    "created_at": "2021-05-22T02:39:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438853"
}
```



---

archive/issue_events_438854.json:
```json
{
    "actor": "https://github.com/yuan-zhou",
    "created_at": "2021-05-22T02:39:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438854"
}
```



---

archive/issue_comments_511759.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nThank you.\n\nHowever, I will set this on \"needs work\" due to merge conflict with #31245. Depending on whether #31245 gets in or not, I will either rebase here or rebase #31245 and then put it back on \"positive review\".",
    "created_at": "2021-05-22T08:18:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511759",
    "user": "https://github.com/kliem"
}
```

<div id="comment:26" align="right">comment:26</div>

Thank you.

However, I will set this on "needs work" due to merge conflict with #31245. Depending on whether #31245 gets in or not, I will either rebase here or rebase #31245 and then put it back on "positive review".



---

archive/issue_events_438855.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-22T08:18:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438855"
}
```



---

archive/issue_events_438856.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-05-22T08:18:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438856"
}
```



---

archive/issue_comments_511760.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReady to merge #31245?",
    "created_at": "2021-06-19T20:41:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511760",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:27" align="right">comment:27</div>

Ready to merge #31245?



---

archive/issue_comments_511761.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI don't know, if #31245 will be rejected again. But it looks like it's done now. It just triggered an unrelated bug.\n\nWhat is the best way to proceed from here? I could just create a branch for this ticket here on top of #31245 and can always go back to the old branch if that fails.",
    "created_at": "2021-06-19T20:47:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511761",
    "user": "https://github.com/kliem"
}
```

<div id="comment:28" align="right">comment:28</div>

I don't know, if #31245 will be rejected again. But it looks like it's done now. It just triggered an unrelated bug.

What is the best way to proceed from here? I could just create a branch for this ticket here on top of #31245 and can always go back to the old branch if that fails.



---

archive/issue_comments_511762.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nSure, it's easy to just back out the merge if necessary",
    "created_at": "2021-06-19T21:04:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511762",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:29" align="right">comment:29</div>

Sure, it's easy to just back out the merge if necessary



---

archive/issue_comments_511763.json:
```json
{
    "body": "Changed commit from **[`40d5640`](https://github.com/sagemath/sagetrac-mirror/commit/40d56400d156210c2c7c7b9751ac88b84b399acd)** to **[`d073ca5`](https://github.com/sagemath/sagetrac-mirror/commit/d073ca56b926a795c5a22490aa9644accb7f9a1c)**",
    "created_at": "2021-06-19T23:24:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511763",
    "user": "https://github.com/kliem"
}
```

Changed commit from **[`40d5640`](https://github.com/sagemath/sagetrac-mirror/commit/40d56400d156210c2c7c7b9751ac88b84b399acd)** to **[`d073ca5`](https://github.com/sagemath/sagetrac-mirror/commit/d073ca56b926a795c5a22490aa9644accb7f9a1c)**



---

archive/issue_comments_511764.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70a8791eb07df89a7d3e2a40c35516ae93e6e0bb\">70a8791</a></td><td><code>Merge branch 'u/gh-kliem/check_openmp_at_configuration' of git://trac.sagemath.org/sage into u/gh-kliem/first_parallel_version_of_face_iterator_reb2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdbe95f9cf2b4787a59a459231074a7c528397f3\">fdbe95f</a></td><td><code>use cython.parallel.threadid instead of omp_get_thread_num</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ae6966e49618739268625fbe5b9767ca6175200\">4ae6966</a></td><td><code>Merge tag '9.4.beta0' into t/31245/first_parallel_version_of_face_iterator_reb2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfb4efb24275dd80071451411f71094fe4084710\">bfb4efb</a></td><td><code>Merge branch 'u/mkoeppe/first_parallel_version_of_face_iterator_reb2' of git://trac.sagemath.org/sage into u/mkoeppe/first_parallel_version_of_face_iterator_reb3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c0a4ae74c28680e48080c39c5e3b171a79a9ad3\">4c0a4ae</a></td><td><code>initialize do_f_vector</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9119d8e1e56a4bccc7b6e12d3b2707100bfca617\">9119d8e</a></td><td><code>merge in #31245</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5dc2c8c294d6a9cbe7bd3e4369f69e37e0db34d9\">5dc2c8c</a></td><td><code>merge in public/31834</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1270b0cdd23dcf6d715f1e41a4f295e24448c8a\">f1270b0</a></td><td><code>Merge branch 'public/31834-reb' of git://trac.sagemath.org/sage into public/31834-reb2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/297792afd93108f916b60674e7a748bad2609087\">297792a</a></td><td><code>equalities -> equations for #31821 as well</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d073ca56b926a795c5a22490aa9644accb7f9a1c\">d073ca5</a></td><td><code>Merge branch 'public/31834-reb2' of git://trac.sagemath.org/sage into u/gh-kliem/only_subsets_reb</code></td></tr></table>\n",
    "created_at": "2021-06-19T23:24:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511764",
    "user": "https://github.com/kliem"
}
```

<div id="comment:30" align="right">comment:30</div>

Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70a8791eb07df89a7d3e2a40c35516ae93e6e0bb">70a8791</a></td><td><code>Merge branch 'u/gh-kliem/check_openmp_at_configuration' of git://trac.sagemath.org/sage into u/gh-kliem/first_parallel_version_of_face_iterator_reb2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdbe95f9cf2b4787a59a459231074a7c528397f3">fdbe95f</a></td><td><code>use cython.parallel.threadid instead of omp_get_thread_num</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ae6966e49618739268625fbe5b9767ca6175200">4ae6966</a></td><td><code>Merge tag '9.4.beta0' into t/31245/first_parallel_version_of_face_iterator_reb2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfb4efb24275dd80071451411f71094fe4084710">bfb4efb</a></td><td><code>Merge branch 'u/mkoeppe/first_parallel_version_of_face_iterator_reb2' of git://trac.sagemath.org/sage into u/mkoeppe/first_parallel_version_of_face_iterator_reb3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c0a4ae74c28680e48080c39c5e3b171a79a9ad3">4c0a4ae</a></td><td><code>initialize do_f_vector</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9119d8e1e56a4bccc7b6e12d3b2707100bfca617">9119d8e</a></td><td><code>merge in #31245</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5dc2c8c294d6a9cbe7bd3e4369f69e37e0db34d9">5dc2c8c</a></td><td><code>merge in public/31834</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1270b0cdd23dcf6d715f1e41a4f295e24448c8a">f1270b0</a></td><td><code>Merge branch 'public/31834-reb' of git://trac.sagemath.org/sage into public/31834-reb2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/297792afd93108f916b60674e7a748bad2609087">297792a</a></td><td><code>equalities -> equations for #31821 as well</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d073ca56b926a795c5a22490aa9644accb7f9a1c">d073ca5</a></td><td><code>Merge branch 'public/31834-reb2' of git://trac.sagemath.org/sage into u/gh-kliem/only_subsets_reb</code></td></tr></table>




---

archive/issue_events_438857.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-06-19T23:24:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438857"
}
```



---

archive/issue_events_438858.json:
```json
{
    "actor": "https://github.com/kliem",
    "created_at": "2021-06-19T23:24:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438858"
}
```



---

archive/issue_comments_511765.json:
```json
{
    "body": "Changed branch from **[u/gh-kliem/only_subsets](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets)** to **[u/gh-kliem/only_subsets_reb](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets_reb)**",
    "created_at": "2021-06-19T23:24:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511765",
    "user": "https://github.com/kliem"
}
```

Changed branch from **[u/gh-kliem/only_subsets](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets)** to **[u/gh-kliem/only_subsets_reb](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets_reb)**



---

archive/issue_comments_511766.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nRebased on #31245 and new version of #29683.\n\nNeeded to fix `max_dim` in `next_dimension` because of #31245.",
    "created_at": "2021-06-19T23:25:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511766",
    "user": "https://github.com/kliem"
}
```

<div id="comment:31" align="right">comment:31</div>

Rebased on #31245 and new version of #29683.

Needed to fix `max_dim` in `next_dimension` because of #31245.



---

archive/issue_comments_511767.json:
```json
{
    "body": "Changed work issues from **Merge conflict with #31245. One of them needs to be rebased.** to none",
    "created_at": "2021-06-19T23:25:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511767",
    "user": "https://github.com/kliem"
}
```

Changed work issues from **Merge conflict with #31245. One of them needs to be rebased.** to none



---

archive/issue_comments_511768.json:
```json
{
    "body": "Changed dependencies from **#29683** to **#29683, #31245**",
    "created_at": "2021-06-19T23:25:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511768",
    "user": "https://github.com/kliem"
}
```

Changed dependencies from **#29683** to **#29683, #31245**



---

archive/issue_comments_511769.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nActually rebasing on new version of #29683 and then pulling in #31245.\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99ddc2f635e0546be6ee4f9813fea85486c79817\">99ddc2f</a></td><td><code>better check for the far face containment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f78d2a6c05e0460cab8dea296c5d32ac25d2835\">0f78d2a</a></td><td><code>implement only subfaces/supfaces for face iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c88068c4c78450513ac5a84d482f3ef33c8ba4e\">6c88068</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b72578bee43e31df4edf99cd1f140a607c8d714c\">b72578b</a></td><td><code>fix error message in doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad75abb5acdf3ac6fbd6e652781e1fd555a5e6c2\">ad75abb</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3d158adfbc8eaa1fdc88559ea68a1debb37a317e\">3d158ad</a></td><td><code>do not display equations for doctests illustrating how the iterator works</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/353313c3189b8d4da69980d0eba1cb9fcbc9ad3e\">353313c</a></td><td><code>update face status</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/842fb8efea3c6c694a6469d19a52a5799a114d2c\">842fb8e</a></td><td><code>consume the iterator if running ignore_subsets after only_subsets</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/250f0e41942ef94855d4d4391e7467cd191d2754\">250f0e4</a></td><td><code>specify for `find_face` that we assume the iterator to be clean</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/542baee396e8db57d59020cc1fd905e1b045eaa7\">542baee</a></td><td><code>merge in #31245</code></td></tr></table>\n",
    "created_at": "2021-06-19T23:42:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511769",
    "user": "https://github.com/kliem"
}
```

<div id="comment:32" align="right">comment:32</div>

Actually rebasing on new version of #29683 and then pulling in #31245.

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99ddc2f635e0546be6ee4f9813fea85486c79817">99ddc2f</a></td><td><code>better check for the far face containment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f78d2a6c05e0460cab8dea296c5d32ac25d2835">0f78d2a</a></td><td><code>implement only subfaces/supfaces for face iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c88068c4c78450513ac5a84d482f3ef33c8ba4e">6c88068</a></td><td><code>fix bug revealed by a_maximal_chain</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b72578bee43e31df4edf99cd1f140a607c8d714c">b72578b</a></td><td><code>fix error message in doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad75abb5acdf3ac6fbd6e652781e1fd555a5e6c2">ad75abb</a></td><td><code>fix the order of the coatoms when resetting the face iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3d158adfbc8eaa1fdc88559ea68a1debb37a317e">3d158ad</a></td><td><code>do not display equations for doctests illustrating how the iterator works</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/353313c3189b8d4da69980d0eba1cb9fcbc9ad3e">353313c</a></td><td><code>update face status</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/842fb8efea3c6c694a6469d19a52a5799a114d2c">842fb8e</a></td><td><code>consume the iterator if running ignore_subsets after only_subsets</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/250f0e41942ef94855d4d4391e7467cd191d2754">250f0e4</a></td><td><code>specify for `find_face` that we assume the iterator to be clean</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/542baee396e8db57d59020cc1fd905e1b045eaa7">542baee</a></td><td><code>merge in #31245</code></td></tr></table>




---

archive/issue_comments_511770.json:
```json
{
    "body": "Changed commit from **[`d073ca5`](https://github.com/sagemath/sagetrac-mirror/commit/d073ca56b926a795c5a22490aa9644accb7f9a1c)** to **[`542baee`](https://github.com/sagemath/sagetrac-mirror/commit/542baee396e8db57d59020cc1fd905e1b045eaa7)**",
    "created_at": "2021-06-19T23:42:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511770",
    "user": "https://github.com/kliem"
}
```

Changed commit from **[`d073ca5`](https://github.com/sagemath/sagetrac-mirror/commit/d073ca56b926a795c5a22490aa9644accb7f9a1c)** to **[`542baee`](https://github.com/sagemath/sagetrac-mirror/commit/542baee396e8db57d59020cc1fd905e1b045eaa7)**



---

archive/issue_comments_511771.json:
```json
{
    "body": "Changed branch from **[u/gh-kliem/only_subsets_reb](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets_reb)** to **[u/gh-kliem/only_subsets_reb2](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets_reb2)**",
    "created_at": "2021-06-19T23:42:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511771",
    "user": "https://github.com/kliem"
}
```

Changed branch from **[u/gh-kliem/only_subsets_reb](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets_reb)** to **[u/gh-kliem/only_subsets_reb2](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets_reb2)**



---

archive/issue_comments_511772.json:
```json
{
    "body": "Changed branch from **[u/gh-kliem/only_subsets_reb2](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets_reb2)** to **[u/mkoeppe/only_subsets_reb2](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/only_subsets_reb2)**",
    "created_at": "2021-06-23T00:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511772",
    "user": "https://github.com/mkoeppe"
}
```

Changed branch from **[u/gh-kliem/only_subsets_reb2](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-kliem/only_subsets_reb2)** to **[u/mkoeppe/only_subsets_reb2](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/only_subsets_reb2)**



---

archive/issue_comments_511773.json:
```json
{
    "body": "Changed commit from **[`542baee`](https://github.com/sagemath/sagetrac-mirror/commit/542baee396e8db57d59020cc1fd905e1b045eaa7)** to **[`7f7e630`](https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338)**",
    "created_at": "2021-06-23T01:21:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511773",
    "user": "https://github.com/mkoeppe"
}
```

Changed commit from **[`542baee`](https://github.com/sagemath/sagetrac-mirror/commit/542baee396e8db57d59020cc1fd905e1b045eaa7)** to **[`7f7e630`](https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338)**



---

archive/issue_comments_511774.json:
```json
{
    "body": "Changed reviewer from **Yuan Zhou** to **Yuan Zhou, Matthias Koeppe**",
    "created_at": "2021-06-23T01:21:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511774",
    "user": "https://github.com/mkoeppe"
}
```

Changed reviewer from **Yuan Zhou** to **Yuan Zhou, Matthias Koeppe**



---

archive/issue_comments_511775.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nBack to positive review. LGTM\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e0229f2d13cae98944d37ba5f6a1387334cf96f\">3e0229f</a></td><td><code>Merge tag '9.4.beta3' into t/31834/public/31834-reb2</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81909176a611e8a0ec32eab9990c25467c417552\">8190917</a></td><td><code>Merge #31834</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338\">7f7e630</a></td><td><code>Merge #29683</code></td></tr></table>\n",
    "created_at": "2021-06-23T01:21:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511775",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:34" align="right">comment:34</div>

Back to positive review. LGTM

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e0229f2d13cae98944d37ba5f6a1387334cf96f">3e0229f</a></td><td><code>Merge tag '9.4.beta3' into t/31834/public/31834-reb2</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81909176a611e8a0ec32eab9990c25467c417552">8190917</a></td><td><code>Merge #31834</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338">7f7e630</a></td><td><code>Merge #29683</code></td></tr></table>




---

archive/issue_events_438859.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T01:21:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438859"
}
```



---

archive/issue_events_438860.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-06-23T01:21:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438860"
}
```



---

archive/issue_comments_511776.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThank you.",
    "created_at": "2021-06-23T11:36:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511776",
    "user": "https://github.com/kliem"
}
```

<div id="comment:35" align="right">comment:35</div>

Thank you.



---

archive/issue_events_438861.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-07-01T20:45:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438861"
}
```



---

archive/issue_events_438862.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d29034d38adfa7c77d70ebf3a77e8bf73486f2a7",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-07-01T20:45:00Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31819#event-438862"
}
```



---

archive/issue_comments_511777.json:
```json
{
    "body": "Changed branch from **[u/mkoeppe/only_subsets_reb2](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/only_subsets_reb2)** to **[`7f7e630`](https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338)**",
    "created_at": "2021-07-01T20:45:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31819",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31819#issuecomment-511777",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mkoeppe/only_subsets_reb2](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/only_subsets_reb2)** to **[`7f7e630`](https://github.com/sagemath/sagetrac-mirror/commit/7f7e6301eb49ed48fd646beae85772344ba52338)**
