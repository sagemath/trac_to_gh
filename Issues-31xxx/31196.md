# Issue 31196: Code Improvements for Mutability module

archive/issues_030959.json:
```json
{
    "assignees": [],
    "body": "I suggest some code improvements for the documentation (adding a note that an attribute \u00e0 la `_is_immutable` is required to check immutability), an additional method `_require_immutable` (to require immutability in cases like hash functions) and Python 3 compatibility (using `format` instead of `%` as recommended in Python's doc).\n\nDepends on #31181\n\nCC:  @mkoeppe @tscrim\n\nComponent: **misc**\n\nAuthor: **Michael Jung**\n\nBranch/Commit: **[`b9f3c28`](https://github.com/sagemath/sagetrac-mirror/commit/b9f3c2837df1fb8d72221e855c87de75058d548e)**\n\nReviewer: **Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31196_\n\n",
    "closed_at": "2021-01-31T20:53:38Z",
    "created_at": "2021-01-07T14:49:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Code Improvements for Mutability module",
    "type": "issue",
    "updated_at": "2021-01-31T20:53:38Z",
    "url": "https://github.com/sagemath/sage/issues/31196",
    "user": "https://github.com/mjungmath"
}
```
I suggest some code improvements for the documentation (adding a note that an attribute à la `_is_immutable` is required to check immutability), an additional method `_require_immutable` (to require immutability in cases like hash functions) and Python 3 compatibility (using `format` instead of `%` as recommended in Python's doc).

Depends on #31181

CC:  @mkoeppe @tscrim

Component: **misc**

Author: **Michael Jung**

Branch/Commit: **[`b9f3c28`](https://github.com/sagemath/sagetrac-mirror/commit/b9f3c2837df1fb8d72221e855c87de75058d548e)**

Reviewer: **Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/31196_





---

archive/issue_events_426833.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-01-07T14:49:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31196#event-426833"
}
```



---

archive/issue_events_426834.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-01-07T14:49:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31196#event-426834"
}
```



---

archive/issue_events_426835.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-01-07T14:49:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31196#event-426835"
}
```



---

archive/issue_comments_499732.json:
```json
{
    "body": "Branch: **[u/gh-mjungmath/clean_mutibility_code](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/clean_mutibility_code)**",
    "created_at": "2021-01-07T14:50:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499732",
    "user": "https://github.com/mjungmath"
}
```

Branch: **[u/gh-mjungmath/clean_mutibility_code](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/clean_mutibility_code)**



---

archive/issue_comments_499733.json:
```json
{
    "body": "Commit: **[`aebc3f4`](https://github.com/sagemath/sagetrac-mirror/commit/aebc3f4fb9e0be8cbfc9fe01b5d94ae8c4a92fb7)**",
    "created_at": "2021-01-07T14:51:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499733",
    "user": "https://github.com/mjungmath"
}
```

Commit: **[`aebc3f4`](https://github.com/sagemath/sagetrac-mirror/commit/aebc3f4fb9e0be8cbfc9fe01b5d94ae8c4a92fb7)**



---

archive/issue_comments_499734.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable`. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for the manifolds module.\n+I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable`. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.\n``````\n",
    "created_at": "2021-01-07T14:51:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499734",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable`. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for the manifolds module.
+I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable`. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.
``````




---

archive/issue_comments_499735.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2e918ad562206590220d0bc74d0389183dcf55cd\"><code>2e918ad</code></a></td><td><code>Trac #31194: rename attribute</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aebc3f4fb9e0be8cbfc9fe01b5d94ae8c4a92fb7\"><code>aebc3f4</code></a></td><td><code>Trac #31196: code improvements</code></td></tr></table>\n",
    "created_at": "2021-01-07T14:51:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499735",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2e918ad562206590220d0bc74d0389183dcf55cd"><code>2e918ad</code></a></td><td><code>Trac #31194: rename attribute</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aebc3f4fb9e0be8cbfc9fe01b5d94ae8c4a92fb7"><code>aebc3f4</code></a></td><td><code>Trac #31196: code improvements</code></td></tr></table>




---

archive/issue_events_426836.json:
```json
{
    "actor": "https://github.com/mjungmath",
    "created_at": "2021-01-07T14:51:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31196#event-426836"
}
```



---

archive/issue_comments_499736.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable`. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.\n+I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable` for flexibility. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.\n``````\n",
    "created_at": "2021-01-07T14:53:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499736",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable`. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.
+I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable` for flexibility. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.
``````




---

archive/issue_comments_499737.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable` for flexibility. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.\n+I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable` for flexibility. Furthermore, the error message is aligned with that from the method `_require_immutable` and in accordance with preexisting error messages of that kind, so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.\n``````\n",
    "created_at": "2021-01-07T15:01:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499737",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable` for flexibility. Furthermore, the error message is aligned with the method `_require_immutable` so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.
+I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable` for flexibility. Furthermore, the error message is aligned with that from the method `_require_immutable` and in accordance with preexisting error messages of that kind, so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.
``````




---

archive/issue_comments_499738.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cc8f76b5bec041f17c26d4798fd462f03ef9d9c2\"><code>cc8f76b</code></a></td><td><code>Trac #31196: code improvements</code></td></tr></table>\n",
    "created_at": "2021-01-07T15:03:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499738",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cc8f76b5bec041f17c26d4798fd462f03ef9d9c2"><code>cc8f76b</code></a></td><td><code>Trac #31196: code improvements</code></td></tr></table>




---

archive/issue_comments_499739.json:
```json
{
    "body": "Changed commit from **[`aebc3f4`](https://github.com/sagemath/sagetrac-mirror/commit/aebc3f4fb9e0be8cbfc9fe01b5d94ae8c4a92fb7)** to **[`cc8f76b`](https://github.com/sagemath/sagetrac-mirror/commit/cc8f76b5bec041f17c26d4798fd462f03ef9d9c2)**",
    "created_at": "2021-01-07T15:03:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499739",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`aebc3f4`](https://github.com/sagemath/sagetrac-mirror/commit/aebc3f4fb9e0be8cbfc9fe01b5d94ae8c4a92fb7)** to **[`cc8f76b`](https://github.com/sagemath/sagetrac-mirror/commit/cc8f76b5bec041f17c26d4798fd462f03ef9d9c2)**



---

archive/issue_comments_499740.json:
```json
{
    "body": "Changed commit from **[`cc8f76b`](https://github.com/sagemath/sagetrac-mirror/commit/cc8f76b5bec041f17c26d4798fd462f03ef9d9c2)** to **[`1572085`](https://github.com/sagemath/sagetrac-mirror/commit/15720856853249d192eb56192ff589d3f88b1892)**",
    "created_at": "2021-01-07T15:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499740",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cc8f76b`](https://github.com/sagemath/sagetrac-mirror/commit/cc8f76b5bec041f17c26d4798fd462f03ef9d9c2)** to **[`1572085`](https://github.com/sagemath/sagetrac-mirror/commit/15720856853249d192eb56192ff589d3f88b1892)**



---

archive/issue_comments_499741.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15720856853249d192eb56192ff589d3f88b1892\"><code>1572085</code></a></td><td><code>Trac #31196: if logic error</code></td></tr></table>\n",
    "created_at": "2021-01-07T15:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499741",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15720856853249d192eb56192ff589d3f88b1892"><code>1572085</code></a></td><td><code>Trac #31196: if logic error</code></td></tr></table>




---

archive/issue_comments_499742.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nAlternatively, one could ask for the **method** `is_immutable()` instead of the *attribute*? Then it wouldn't matter what happens behind the scenes, that's most flexible.",
    "created_at": "2021-01-07T21:43:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499742",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:8" align="right">comment:8</div>

Alternatively, one could ask for the **method** `is_immutable()` instead of the *attribute*? Then it wouldn't matter what happens behind the scenes, that's most flexible.



---

archive/issue_comments_499743.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI strongly think the attribute name should be standardized and not look for the choice between the two. This will not only be faster but easier to maintain.",
    "created_at": "2021-01-08T00:30:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499743",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:9" align="right">comment:9</div>

I strongly think the attribute name should be standardized and not look for the choice between the two. This will not only be faster but easier to maintain.



---

archive/issue_comments_499744.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@tscrim](#comment%3A9):\n> I strongly think the attribute name should be standardized and not look for the choice between the two. This will not only be faster but easier to maintain.\n\nThat makes sense. What about this instead:\n\n> Alternatively, one could ask for the method is_immutable() instead of the attribute?\n\nThen, the method is standardized, which I would favorize.\n\nAnd what do you think about the change of error message?",
    "created_at": "2021-01-08T09:28:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499744",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@tscrim](#comment%3A9):
> I strongly think the attribute name should be standardized and not look for the choice between the two. This will not only be faster but easier to maintain.

That makes sense. What about this instead:

> Alternatively, one could ask for the method is_immutable() instead of the attribute?

Then, the method is standardized, which I would favorize.

And what do you think about the change of error message?



---

archive/issue_comments_499745.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df9a54cd7cef639c2875487635706317979b3304\"><code>df9a54c</code></a></td><td><code>Trac #31196: use \"is_immutable()\" + documentation</code></td></tr></table>\n",
    "created_at": "2021-01-08T10:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499745",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df9a54cd7cef639c2875487635706317979b3304"><code>df9a54c</code></a></td><td><code>Trac #31196: use "is_immutable()" + documentation</code></td></tr></table>




---

archive/issue_comments_499746.json:
```json
{
    "body": "Changed commit from **[`1572085`](https://github.com/sagemath/sagetrac-mirror/commit/15720856853249d192eb56192ff589d3f88b1892)** to **[`df9a54c`](https://github.com/sagemath/sagetrac-mirror/commit/df9a54cd7cef639c2875487635706317979b3304)**",
    "created_at": "2021-01-08T10:11:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499746",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1572085`](https://github.com/sagemath/sagetrac-mirror/commit/15720856853249d192eb56192ff589d3f88b1892)** to **[`df9a54c`](https://github.com/sagemath/sagetrac-mirror/commit/df9a54cd7cef639c2875487635706317979b3304)**



---

archive/issue_comments_499747.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@sagetrac-git](#comment%3A11):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/df9a54cd7cef639c2875487635706317979b3304\"><code>df9a54c</code></a></td><td><code>Trac #31196: use \"is_immutable()\" + documentation</code></td></tr></table>\n\nI had something like this in mind...\n\nShould be even faster since `getattr` is completely avoided. Moreover, the error message is now much clearer if the object doesn't support mutability.",
    "created_at": "2021-01-08T10:14:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499747",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@sagetrac-git](#comment%3A11):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/df9a54cd7cef639c2875487635706317979b3304"><code>df9a54c</code></a></td><td><code>Trac #31196: use "is_immutable()" + documentation</code></td></tr></table>

I had something like this in mind...

Should be even faster since `getattr` is completely avoided. Moreover, the error message is now much clearer if the object doesn't support mutability.



---

archive/issue_comments_499748.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/06b40bfcd0451da94249b73f46cdd29a70c7cb88\"><code>06b40bf</code></a></td><td><code>Trac #31196: comment indirect doctest</code></td></tr></table>\n",
    "created_at": "2021-01-08T10:19:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499748",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/06b40bfcd0451da94249b73f46cdd29a70c7cb88"><code>06b40bf</code></a></td><td><code>Trac #31196: comment indirect doctest</code></td></tr></table>




---

archive/issue_comments_499749.json:
```json
{
    "body": "Changed commit from **[`df9a54c`](https://github.com/sagemath/sagetrac-mirror/commit/df9a54cd7cef639c2875487635706317979b3304)** to **[`06b40bf`](https://github.com/sagemath/sagetrac-mirror/commit/06b40bfcd0451da94249b73f46cdd29a70c7cb88)**",
    "created_at": "2021-01-08T10:19:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499749",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`df9a54c`](https://github.com/sagemath/sagetrac-mirror/commit/df9a54cd7cef639c2875487635706317979b3304)** to **[`06b40bf`](https://github.com/sagemath/sagetrac-mirror/commit/06b40bfcd0451da94249b73f46cdd29a70c7cb88)**



---

archive/issue_comments_499750.json:
```json
{
    "body": "Dependencies: **#31181**",
    "created_at": "2021-01-08T10:20:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499750",
    "user": "https://github.com/mjungmath"
}
```

Dependencies: **#31181**



---

archive/issue_comments_499751.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable` for flexibility. Furthermore, the error message is aligned with that from the method `_require_immutable` and in accordance with preexisting error messages of that kind, so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.\n+I suggest some code improvements. For the decorator check, we require a method `\u00ecs_immutable()` to be implemented and avoid `getattr` completely. Furthermore, the error message is aligned with that from the method `_require_immutable` and in accordance with preexisting error messages of that kind, so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.\n``````\n",
    "created_at": "2021-01-08T10:21:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499751",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-I suggest some code improvements. For the decorator check, we should allow the attribute `_is_mutable` alongside with `_is_immutable` for flexibility. Furthermore, the error message is aligned with that from the method `_require_immutable` and in accordance with preexisting error messages of that kind, so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.
+I suggest some code improvements. For the decorator check, we require a method `ìs_immutable()` to be implemented and avoid `getattr` completely. Furthermore, the error message is aligned with that from the method `_require_immutable` and in accordance with preexisting error messages of that kind, so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.
``````




---

archive/issue_comments_499752.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nThe problem with this approach is that it will raise an attribute error if it is used on a class that does not implement an `is_immutable()` method. Although I mostly agree that it generally should if it is using this feature, but I could conceive of a reason why it wouldn't. I would say it is more likely that things will have some attribute to hold the mutability status than just a method to check it. Ultimately I would leave the check the way it currently is with somethign in the docstring stating that it is a requirement to use the decorator.\n\nI am not 100% convinced the error message is more clear, but I am okay with it (once you remove the trailing period).",
    "created_at": "2021-01-08T23:45:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499752",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:16" align="right">comment:16</div>

The problem with this approach is that it will raise an attribute error if it is used on a class that does not implement an `is_immutable()` method. Although I mostly agree that it generally should if it is using this feature, but I could conceive of a reason why it wouldn't. I would say it is more likely that things will have some attribute to hold the mutability status than just a method to check it. Ultimately I would leave the check the way it currently is with somethign in the docstring stating that it is a requirement to use the decorator.

I am not 100% convinced the error message is more clear, but I am okay with it (once you remove the trailing period).



---

archive/issue_comments_499753.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@tscrim](#comment%3A16):\n> The problem with this approach is that it will raise an attribute error if it is used on a class that does not implement an `is_immutable()` method. Although I mostly agree that it generally should if it is using this feature, but I could conceive of a reason why it wouldn't. I would say it is more likely that things will have some attribute to hold the mutability status than just a method to check it. Ultimately I would leave the check the way it currently is with somethign in the docstring stating that it is a requirement to use the decorator.\n\nI don't get your point entirely. Is your `AttributeError` concern related only to the method or generally speaking? If it's related, I'd say we use the attribute only (even though I personally like methods more, because they are not interested in implementation details), drop the `getattr` (because it's faster) and raise an attribute error if that is not implemented. I think it should definitely raise an attribute error in cases where we cannot say whether the object is immutable or not. The decorator wouldn't make much sense in situations like this, same for the error message.\n\n> I am not 100% convinced the error message is more clear, but I am okay with it (once you remove the trailing period).\n\nAny ideas for a compromise? I think, from a developer's viewpoint, the original error message was more clear. But my plan, so far, is that this decorator should be used for the mutability checks in the manifold setting (after the pickling in #31182 had been solved).",
    "created_at": "2021-01-09T00:06:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499753",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@tscrim](#comment%3A16):
> The problem with this approach is that it will raise an attribute error if it is used on a class that does not implement an `is_immutable()` method. Although I mostly agree that it generally should if it is using this feature, but I could conceive of a reason why it wouldn't. I would say it is more likely that things will have some attribute to hold the mutability status than just a method to check it. Ultimately I would leave the check the way it currently is with somethign in the docstring stating that it is a requirement to use the decorator.

I don't get your point entirely. Is your `AttributeError` concern related only to the method or generally speaking? If it's related, I'd say we use the attribute only (even though I personally like methods more, because they are not interested in implementation details), drop the `getattr` (because it's faster) and raise an attribute error if that is not implemented. I think it should definitely raise an attribute error in cases where we cannot say whether the object is immutable or not. The decorator wouldn't make much sense in situations like this, same for the error message.

> I am not 100% convinced the error message is more clear, but I am okay with it (once you remove the trailing period).

Any ideas for a compromise? I think, from a developer's viewpoint, the original error message was more clear. But my plan, so far, is that this decorator should be used for the mutability checks in the manifold setting (after the pickling in #31182 had been solved).



---

archive/issue_comments_499754.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nFor the records, I suggested this change because of #31194, to avoid possible incompatibilites in case of slight variations in the implementation.",
    "created_at": "2021-01-09T00:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499754",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:18" align="right">comment:18</div>

For the records, I suggested this change because of #31194, to avoid possible incompatibilites in case of slight variations in the implementation.



---

archive/issue_comments_499755.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@mjungmath](#comment%3A17):\n> Replying to [@tscrim](#comment%3A16):\n> > The problem with this approach is that it will raise an attribute error if it is used on a class that does not implement an `is_immutable()` method. Although I mostly agree that it generally should if it is using this feature, but I could conceive of a reason why it wouldn't. I would say it is more likely that things will have some attribute to hold the mutability status than just a method to check it. Ultimately I would leave the check the way it currently is with something in the docstring stating that it is a requirement to use the decorator.\n\n> \n> I don't get your point entirely. Is your `AttributeError` concern related only to the method or generally speaking? If it's related, I'd say we use the attribute only (even though I personally like methods more, because they are not interested in implementation details), drop the `getattr` (because it's faster) and raise an attribute error if that is not implemented. I think it should definitely raise an attribute error in cases where we cannot say whether the object is immutable or not. The decorator wouldn't make much sense in situations like this, same for the error message.\n\nI don't understand this distinction you're trying to make. If you use this decorator with a method on a class that does not implement an `is_immutable` method, then you get an `AttributeError`. However, it is potentially reasonable for a class to add an attribute `_is_immutable` when it becomes immutable. I agree with your point on not depending on implementation details, but because we are trying to set the API for implementations, I feel like that is somewhat moot. There is also something to be said for having different error messages, but having more flexibility I think trumps this, although just barely.\n\n> > I am not 100% convinced the error message is more clear, but I am okay with it (once you remove the trailing period).\n\n> \n> Any ideas for a compromise? I think, from a developer's viewpoint, the original error message was more clear. But my plan, so far, is that this decorator should be used for the mutability checks in the manifold setting (after the pickling in #31182 had been solved).\n\nI would generally avoid the decorator and just directly call stuff. It is nearly the same amount of code. While it does make it slightly easier to refactor, it obfuscates the code mode and slows it down. This is good for the more casual user, but for production code, I would avoid the decorator in this case.",
    "created_at": "2021-01-09T01:07:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499755",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@mjungmath](#comment%3A17):
> Replying to [@tscrim](#comment%3A16):
> > The problem with this approach is that it will raise an attribute error if it is used on a class that does not implement an `is_immutable()` method. Although I mostly agree that it generally should if it is using this feature, but I could conceive of a reason why it wouldn't. I would say it is more likely that things will have some attribute to hold the mutability status than just a method to check it. Ultimately I would leave the check the way it currently is with something in the docstring stating that it is a requirement to use the decorator.

> 
> I don't get your point entirely. Is your `AttributeError` concern related only to the method or generally speaking? If it's related, I'd say we use the attribute only (even though I personally like methods more, because they are not interested in implementation details), drop the `getattr` (because it's faster) and raise an attribute error if that is not implemented. I think it should definitely raise an attribute error in cases where we cannot say whether the object is immutable or not. The decorator wouldn't make much sense in situations like this, same for the error message.

I don't understand this distinction you're trying to make. If you use this decorator with a method on a class that does not implement an `is_immutable` method, then you get an `AttributeError`. However, it is potentially reasonable for a class to add an attribute `_is_immutable` when it becomes immutable. I agree with your point on not depending on implementation details, but because we are trying to set the API for implementations, I feel like that is somewhat moot. There is also something to be said for having different error messages, but having more flexibility I think trumps this, although just barely.

> > I am not 100% convinced the error message is more clear, but I am okay with it (once you remove the trailing period).

> 
> Any ideas for a compromise? I think, from a developer's viewpoint, the original error message was more clear. But my plan, so far, is that this decorator should be used for the mutability checks in the manifold setting (after the pickling in #31182 had been solved).

I would generally avoid the decorator and just directly call stuff. It is nearly the same amount of code. While it does make it slightly easier to refactor, it obfuscates the code mode and slows it down. This is good for the more casual user, but for production code, I would avoid the decorator in this case.



---

archive/issue_comments_499756.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@tscrim](#comment%3A19):\n> ...\n\nAlright then. I thought it might be convenient. Too much thinking, eh? I'll just add a warning to make clear that such objects require a `_is_immutable` attribute.\n\nAs for the manifold code, I should switch to `_require_immutable` in `Mutability` instead?",
    "created_at": "2021-01-09T01:51:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499756",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@tscrim](#comment%3A19):
> ...

Alright then. I thought it might be convenient. Too much thinking, eh? I'll just add a warning to make clear that such objects require a `_is_immutable` attribute.

As for the manifold code, I should switch to `_require_immutable` in `Mutability` instead?



---

archive/issue_comments_499757.json:
```json
{
    "body": "Changed commit from **[`06b40bf`](https://github.com/sagemath/sagetrac-mirror/commit/06b40bfcd0451da94249b73f46cdd29a70c7cb88)** to **[`4c33935`](https://github.com/sagemath/sagetrac-mirror/commit/4c3393509d75c6a040b312732a1801f190b88142)**",
    "created_at": "2021-01-09T13:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499757",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`06b40bf`](https://github.com/sagemath/sagetrac-mirror/commit/06b40bfcd0451da94249b73f46cdd29a70c7cb88)** to **[`4c33935`](https://github.com/sagemath/sagetrac-mirror/commit/4c3393509d75c6a040b312732a1801f190b88142)**



---

archive/issue_comments_499758.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ecbf3a4896e2ccc10f3f16d4100e197de6a6fea\"><code>5ecbf3a</code></a></td><td><code>Trac #31181: return added</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c3393509d75c6a040b312732a1801f190b88142\"><code>4c33935</code></a></td><td><code>Trac #31196: minor code improvements, py3 compatibility, documentation improved</code></td></tr></table>\n",
    "created_at": "2021-01-09T13:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499758",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ecbf3a4896e2ccc10f3f16d4100e197de6a6fea"><code>5ecbf3a</code></a></td><td><code>Trac #31181: return added</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c3393509d75c6a040b312732a1801f190b88142"><code>4c33935</code></a></td><td><code>Trac #31196: minor code improvements, py3 compatibility, documentation improved</code></td></tr></table>




---

archive/issue_comments_499759.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-I suggest some code improvements. For the decorator check, we require a method `\u00ecs_immutable()` to be implemented and avoid `getattr` completely. Furthermore, the error message is aligned with that from the method `_require_immutable` and in accordance with preexisting error messages of that kind, so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.\n+I suggest some code improvements for the documentation, an additional method `_require_immutable` and Python 3 compatibility.\n``````\n",
    "created_at": "2021-01-09T13:12:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499759",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-I suggest some code improvements. For the decorator check, we require a method `ìs_immutable()` to be implemented and avoid `getattr` completely. Furthermore, the error message is aligned with that from the method `_require_immutable` and in accordance with preexisting error messages of that kind, so that this decorator can conveniently and effortlessly be used for e.g. the manifolds module.
+I suggest some code improvements for the documentation, an additional method `_require_immutable` and Python 3 compatibility.
``````




---

archive/issue_comments_499760.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nLike this?",
    "created_at": "2021-01-09T13:12:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499760",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:22" align="right">comment:22</div>

Like this?



---

archive/issue_comments_499761.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-I suggest some code improvements for the documentation, an additional method `_require_immutable` and Python 3 compatibility.\n+I suggest some code improvements for the documentation (adding a note that an attribute \u00e0 la `_is_immutable` is required to check immutability), an additional method `_require_immutable` (to require immutability in cases like hash functions) and Python 3 compatibility (using `format` instead of `%` as recommended in Python's doc).\n``````\n",
    "created_at": "2021-01-09T15:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499761",
    "user": "https://github.com/mjungmath"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-I suggest some code improvements for the documentation, an additional method `_require_immutable` and Python 3 compatibility.
+I suggest some code improvements for the documentation (adding a note that an attribute à la `_is_immutable` is required to check immutability), an additional method `_require_immutable` (to require immutability in cases like hash functions) and Python 3 compatibility (using `format` instead of `%` as recommended in Python's doc).
``````




---

archive/issue_comments_499762.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@mjungmath](#comment%3A22):\n> Like this?\n\nI think this is good overall. However I have one question and comment:\n\nWhy is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`? I think you need an `except -1` added too.",
    "created_at": "2021-01-10T12:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499762",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@mjungmath](#comment%3A22):
> Like this?

I think this is good overall. However I have one question and comment:

Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`? I think you need an `except -1` added too.



---

archive/issue_comments_499763.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@tscrim](#comment%3A24):\n> I think this is good overall. However I have one question and comment:\n> \n> Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`?\n\nI actually don't know. That was the setup I found there. Actually, due to #31182, I think it is better to make this class completely Pythonic. If there is a need for a Cythonic version, I suggest to introduce a `SageObjectWithMutability`. See my [comment](https://github.com/sagemath/sage/issues/31182#comment:12).\n\n> I think you need an `except -1` too.\n\nWhat do you mean?",
    "created_at": "2021-01-10T15:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499763",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@tscrim](#comment%3A24):
> I think this is good overall. However I have one question and comment:
> 
> Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`?

I actually don't know. That was the setup I found there. Actually, due to #31182, I think it is better to make this class completely Pythonic. If there is a need for a Cythonic version, I suggest to introduce a `SageObjectWithMutability`. See my [comment](https://github.com/sagemath/sage/issues/31182#comment:12).

> I think you need an `except -1` too.

What do you mean?



---

archive/issue_comments_499764.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@mjungmath](#comment%3A25):\n> Replying to [@tscrim](#comment%3A24):\n> > I think this is good overall. However I have one question and comment:\n> > \n> > Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`?\n\n> \n> I actually don't know. That was the setup I found there. Actually, due to #31182, I think it is better to make this class completely Pythonic. If there is a need for a Cythonic version, I suggest to introduce a `SageObjectWithMutability`. See my [comment](https://github.com/sagemath/sage/issues/31182#comment:12).\n\n-1 on this. I will comment on #31182 for more about this.\n\n> > I think you need an `except -1` too.\n\n> \n> What do you mean?\n\nhttps://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#error-return-values",
    "created_at": "2021-01-12T00:14:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499764",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@mjungmath](#comment%3A25):
> Replying to [@tscrim](#comment%3A24):
> > I think this is good overall. However I have one question and comment:
> > 
> > Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`?

> 
> I actually don't know. That was the setup I found there. Actually, due to #31182, I think it is better to make this class completely Pythonic. If there is a need for a Cythonic version, I suggest to introduce a `SageObjectWithMutability`. See my [comment](https://github.com/sagemath/sage/issues/31182#comment:12).

-1 on this. I will comment on #31182 for more about this.

> > I think you need an `except -1` too.

> 
> What do you mean?

https://cython.readthedocs.io/en/latest/src/userguide/language_basics.html#error-return-values



---

archive/issue_comments_499765.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c805199394721b8957e88bebc79bffd9f319c856\"><code>c805199</code></a></td><td><code>Trac #31196: minor code improvements, py3 compatibility, documentation improved</code></td></tr></table>\n",
    "created_at": "2021-01-17T19:39:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499765",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c805199394721b8957e88bebc79bffd9f319c856"><code>c805199</code></a></td><td><code>Trac #31196: minor code improvements, py3 compatibility, documentation improved</code></td></tr></table>




---

archive/issue_comments_499766.json:
```json
{
    "body": "Changed commit from **[`4c33935`](https://github.com/sagemath/sagetrac-mirror/commit/4c3393509d75c6a040b312732a1801f190b88142)** to **[`c805199`](https://github.com/sagemath/sagetrac-mirror/commit/c805199394721b8957e88bebc79bffd9f319c856)**",
    "created_at": "2021-01-17T19:39:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499766",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4c33935`](https://github.com/sagemath/sagetrac-mirror/commit/4c3393509d75c6a040b312732a1801f190b88142)** to **[`c805199`](https://github.com/sagemath/sagetrac-mirror/commit/c805199394721b8957e88bebc79bffd9f319c856)**



---

archive/issue_comments_499767.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5ecbf3a4896e2ccc10f3f16d4100e197de6a6fea\"><code>5ecbf3a</code></a></td><td><code>Trac #31181: return added</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c3393509d75c6a040b312732a1801f190b88142\"><code>4c33935</code></a></td><td><code>Trac #31196: minor code improvements, py3 compatibility, documentation improved</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/65110905c2f11bca8eedacffbca0c9b32786147e\"><code>6511090</code></a></td><td><code>Trac #31196: cpdef require methods + except *</code></td></tr></table>\n",
    "created_at": "2021-01-17T19:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499767",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5ecbf3a4896e2ccc10f3f16d4100e197de6a6fea"><code>5ecbf3a</code></a></td><td><code>Trac #31181: return added</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c3393509d75c6a040b312732a1801f190b88142"><code>4c33935</code></a></td><td><code>Trac #31196: minor code improvements, py3 compatibility, documentation improved</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/65110905c2f11bca8eedacffbca0c9b32786147e"><code>6511090</code></a></td><td><code>Trac #31196: cpdef require methods + except *</code></td></tr></table>




---

archive/issue_comments_499768.json:
```json
{
    "body": "Changed commit from **[`c805199`](https://github.com/sagemath/sagetrac-mirror/commit/c805199394721b8957e88bebc79bffd9f319c856)** to **[`6511090`](https://github.com/sagemath/sagetrac-mirror/commit/65110905c2f11bca8eedacffbca0c9b32786147e)**",
    "created_at": "2021-01-17T19:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499768",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c805199`](https://github.com/sagemath/sagetrac-mirror/commit/c805199394721b8957e88bebc79bffd9f319c856)** to **[`6511090`](https://github.com/sagemath/sagetrac-mirror/commit/65110905c2f11bca8eedacffbca0c9b32786147e)**



---

archive/issue_comments_499769.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@tscrim](#comment%3A24):\n> Replying to [@mjungmath](#comment%3A22):\n> > Like this?\n\n> \n> I think this is good overall. However I have one question and comment:\n> \n> Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`? I think you need an `except -1` added too.\n\nIs that better? I think, the `except *` syntax is needed since these functions do not return anything.",
    "created_at": "2021-01-17T19:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499769",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@tscrim](#comment%3A24):
> Replying to [@mjungmath](#comment%3A22):
> > Like this?

> 
> I think this is good overall. However I have one question and comment:
> 
> Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`? I think you need an `except -1` added too.

Is that better? I think, the `except *` syntax is needed since these functions do not return anything.



---

archive/issue_comments_499770.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@mjungmath](#comment%3A29):\n> Replying to [@tscrim](#comment%3A24):\n> > Replying to [@mjungmath](#comment%3A22):\n> > > Like this?\n\n> > \n> > I think this is good overall. However I have one question and comment:\n> > \n> > Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`? I think you need an `except -1` added too.\n\n> \n> Is that better? I think, the `except *` syntax is needed since these functions do not return anything.\n\nBuilt won't work: *Exception clause not allowed for function returning Python object*. You sure that the exception clause is needed here?",
    "created_at": "2021-01-17T20:15:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499770",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@mjungmath](#comment%3A29):
> Replying to [@tscrim](#comment%3A24):
> > Replying to [@mjungmath](#comment%3A22):
> > > Like this?

> > 
> > I think this is good overall. However I have one question and comment:
> > 
> > Why is the `_require_immutable` not a `cpdef` method but instead a Python and `cdef`? I think you need an `except -1` added too.

> 
> Is that better? I think, the `except *` syntax is needed since these functions do not return anything.

Built won't work: *Exception clause not allowed for function returning Python object*. You sure that the exception clause is needed here?



---

archive/issue_comments_499771.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5228d3b87529167876c09b693f498e636677d49\"><code>e5228d3</code></a></td><td><code>Trac #31196: cpdef require methods + example added</code></td></tr></table>\n",
    "created_at": "2021-01-17T20:23:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499771",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5228d3b87529167876c09b693f498e636677d49"><code>e5228d3</code></a></td><td><code>Trac #31196: cpdef require methods + example added</code></td></tr></table>




---

archive/issue_comments_499772.json:
```json
{
    "body": "Changed commit from **[`6511090`](https://github.com/sagemath/sagetrac-mirror/commit/65110905c2f11bca8eedacffbca0c9b32786147e)** to **[`e5228d3`](https://github.com/sagemath/sagetrac-mirror/commit/e5228d3b87529167876c09b693f498e636677d49)**",
    "created_at": "2021-01-17T20:23:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499772",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6511090`](https://github.com/sagemath/sagetrac-mirror/commit/65110905c2f11bca8eedacffbca0c9b32786147e)** to **[`e5228d3`](https://github.com/sagemath/sagetrac-mirror/commit/e5228d3b87529167876c09b693f498e636677d49)**



---

archive/issue_comments_499773.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nOkay, I added an example that works perfectly and improved the documentation incidentally. The except clause is apparently not needed.",
    "created_at": "2021-01-17T20:23:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499773",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:32" align="right">comment:32</div>

Okay, I added an example that works perfectly and improved the documentation incidentally. The except clause is apparently not needed.



---

archive/issue_comments_499774.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d957f73a5ac9ab8f198e9d6eb0a3cac266e5d8ba\"><code>d957f73</code></a></td><td><code>Trac #31196: unnecessary line in docstring removed</code></td></tr></table>\n",
    "created_at": "2021-01-17T20:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499774",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d957f73a5ac9ab8f198e9d6eb0a3cac266e5d8ba"><code>d957f73</code></a></td><td><code>Trac #31196: unnecessary line in docstring removed</code></td></tr></table>




---

archive/issue_comments_499775.json:
```json
{
    "body": "Changed commit from **[`e5228d3`](https://github.com/sagemath/sagetrac-mirror/commit/e5228d3b87529167876c09b693f498e636677d49)** to **[`d957f73`](https://github.com/sagemath/sagetrac-mirror/commit/d957f73a5ac9ab8f198e9d6eb0a3cac266e5d8ba)**",
    "created_at": "2021-01-17T20:36:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499775",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e5228d3`](https://github.com/sagemath/sagetrac-mirror/commit/e5228d3b87529167876c09b693f498e636677d49)** to **[`d957f73`](https://github.com/sagemath/sagetrac-mirror/commit/d957f73a5ac9ab8f198e9d6eb0a3cac266e5d8ba)**



---

archive/issue_comments_499776.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw**",
    "created_at": "2021-01-18T00:08:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499776",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw**



---

archive/issue_comments_499777.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nAh, it's fine because it doesn't have a return value (and hence returns `None`). Let's wait for the patchbot. If that is green, then positive review.",
    "created_at": "2021-01-18T00:08:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499777",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:34" align="right">comment:34</div>

Ah, it's fine because it doesn't have a return value (and hence returns `None`). Let's wait for the patchbot. If that is green, then positive review.



---

archive/issue_comments_499778.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nAlso, while it is technically not your responsibility since it existed previously, it would be good add docstrings and tests to all methods, including `cpdef` ones.",
    "created_at": "2021-01-18T09:27:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499778",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:35" align="right">comment:35</div>

Also, while it is technically not your responsibility since it existed previously, it would be good add docstrings and tests to all methods, including `cpdef` ones.



---

archive/issue_comments_499779.json:
```json
{
    "body": "Changed commit from **[`d957f73`](https://github.com/sagemath/sagetrac-mirror/commit/d957f73a5ac9ab8f198e9d6eb0a3cac266e5d8ba)** to **[`b9f3c28`](https://github.com/sagemath/sagetrac-mirror/commit/b9f3c2837df1fb8d72221e855c87de75058d548e)**",
    "created_at": "2021-01-18T09:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499779",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d957f73`](https://github.com/sagemath/sagetrac-mirror/commit/d957f73a5ac9ab8f198e9d6eb0a3cac266e5d8ba)** to **[`b9f3c28`](https://github.com/sagemath/sagetrac-mirror/commit/b9f3c2837df1fb8d72221e855c87de75058d548e)**



---

archive/issue_comments_499780.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b9f3c2837df1fb8d72221e855c87de75058d548e\"><code>b9f3c28</code></a></td><td><code>Trac #31196: coverage</code></td></tr></table>\n",
    "created_at": "2021-01-18T09:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499780",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b9f3c2837df1fb8d72221e855c87de75058d548e"><code>b9f3c28</code></a></td><td><code>Trac #31196: coverage</code></td></tr></table>




---

archive/issue_comments_499781.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@tscrim](#comment%3A35):\n> Also, while it is technically not your responsibility since it existed previously, it would be good add docstrings and tests to all methods, including `cpdef` ones.\n\nDone.",
    "created_at": "2021-01-18T09:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499781",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@tscrim](#comment%3A35):
> Also, while it is technically not your responsibility since it existed previously, it would be good add docstrings and tests to all methods, including `cpdef` ones.

Done.



---

archive/issue_comments_499782.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nPatchbot is satisfied. :)",
    "created_at": "2021-01-18T21:41:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499782",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:38" align="right">comment:38</div>

Patchbot is satisfied. :)



---

archive/issue_comments_499783.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThank you. LGTM.",
    "created_at": "2021-01-20T06:03:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499783",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:39" align="right">comment:39</div>

Thank you. LGTM.



---

archive/issue_events_426837.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-01-20T06:03:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31196#event-426837"
}
```



---

archive/issue_events_426838.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-01-20T06:03:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31196#event-426838"
}
```



---

archive/issue_comments_499784.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThanks for the review!",
    "created_at": "2021-01-20T09:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499784",
    "user": "https://github.com/mjungmath"
}
```

<div id="comment:40" align="right">comment:40</div>

Thanks for the review!



---

archive/issue_comments_499785.json:
```json
{
    "body": "Changed branch from **[u/gh-mjungmath/clean_mutibility_code](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/clean_mutibility_code)** to **[`b9f3c28`](https://github.com/sagemath/sagetrac-mirror/commit/b9f3c2837df1fb8d72221e855c87de75058d548e)**",
    "created_at": "2021-01-31T20:53:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31196#issuecomment-499785",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gh-mjungmath/clean_mutibility_code](https://github.com/sagemath/sagetrac-mirror/tree/u/gh-mjungmath/clean_mutibility_code)** to **[`b9f3c28`](https://github.com/sagemath/sagetrac-mirror/commit/b9f3c2837df1fb8d72221e855c87de75058d548e)**



---

archive/issue_events_426839.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-01-31T20:53:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31196#event-426839"
}
```



---

archive/issue_events_426840.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3925e96e0a29df0b02df0fc16a66d41d38d8b241",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-01-31T20:53:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31196",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31196#event-426840"
}
```
