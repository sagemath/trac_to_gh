# Issue 31597: Pynac is buggy inside a hold context

archive/issues_031360.json:
```json
{
    "assignees": [],
    "body": "The [ginac documentation](https://www.ginac.de/tutorial/#Automatic-evaluation) says \"GiNaC performs some automatic transformations on expressions, to simplify them and put them into a canonical form. ... This behavior is usually referred to as *automatic* or *anonymous evaluation*. ... The general rule is that when you construct expressions, GiNaC automatically creates them in canonical form, ... All GiNaC methods that transform expressions, like `subs()` or `normal()`, automatically re-evaluate their results.\" \n\nIt seems that some (many?) pynac methods assume that their inputs have been sanitized in this way. Since applying a hold context disables this automatic evaluation, these methods may silently produce incorrect results inside a hold context. Examples of this can be seen in #31554.\n\nKeywords: **pynac, hold**\n\nComponent: **symbolics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/31597_\n\n",
    "created_at": "2021-04-03T05:38:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Pynac is buggy inside a hold context",
    "type": "issue",
    "updated_at": "2022-09-19T18:58:47Z",
    "url": "https://github.com/sagemath/sage/issues/31597",
    "user": "https://github.com/DaveWitteMorris"
}
```
The [ginac documentation](https://www.ginac.de/tutorial/#Automatic-evaluation) says "GiNaC performs some automatic transformations on expressions, to simplify them and put them into a canonical form. ... This behavior is usually referred to as *automatic* or *anonymous evaluation*. ... The general rule is that when you construct expressions, GiNaC automatically creates them in canonical form, ... All GiNaC methods that transform expressions, like `subs()` or `normal()`, automatically re-evaluate their results." 

It seems that some (many?) pynac methods assume that their inputs have been sanitized in this way. Since applying a hold context disables this automatic evaluation, these methods may silently produce incorrect results inside a hold context. Examples of this can be seen in #31554.

Keywords: **pynac, hold**

Component: **symbolics**

_Issue created by migration from https://trac.sagemath.org/ticket/31597_





---

archive/issue_events_435838.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-04-03T05:38:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435838"
}
```



---

archive/issue_events_435839.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-04-03T05:38:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435839"
}
```



---

archive/issue_events_435840.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-04-03T05:38:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "label": "https://github.com/sagemath/sage/labels/p%3A%202%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p: 2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435840"
}
```



---

archive/issue_events_435841.json:
```json
{
    "actor": "https://github.com/DaveWitteMorris",
    "created_at": "2021-04-03T05:38:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435841"
}
```



---

archive/issue_events_435842.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435842"
}
```



---

archive/issue_events_435843.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-22T20:35:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435843"
}
```



---

archive/issue_events_435844.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435844"
}
```



---

archive/issue_events_435845.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T20:12:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435845"
}
```



---

archive/issue_events_435846.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435846"
}
```



---

archive/issue_events_435847.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435847"
}
```



---

archive/issue_events_435848.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435848"
}
```



---

archive/issue_events_435849.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-09-19T18:58:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/31597",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31597#event-435849"
}
```
