# Issue 31686: Speed up factoring finite field multiplicative order

archive/issues_031449.json:
```json
{
    "assignees": [],
    "body": "Initially asked at \n\n- [Ask Sage question 56710: Computing the factored multiplicative order of an extension field tries to solve an unnecessarily hard factoring problem](https://ask.sagemath.org/question/56710)\n\nThere seems to be a unnecessary performance problem with constructing large extension fields:\n\n```python\nsage: p = Integer('0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5'\n....:             'cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001')\nsage: GF(p^2)\n```\nThis hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)\n\nIt is not unreasonable that constructing the extension field requires knowing the factorization of the multiplicative order. (You can get around this by constructing it with a specific modulus, but then many operations, e.g. taking roots, require this factorization anyway.)\n\nHowever, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:\n\n```python\nsage: factor(p - 1)\n2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097\n* 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\nsage: factor(p + 1)\n2 * 313 * 751 * 2003 * 2671 * 738231097\n* 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299\n```\n(this takes less than a second on my desktop).\n\nIn general, computing the multiplicative order of an extension field should take advantage of the factorization of p<sup>k</sup> - 1 as a polynomial. There might also be other cases where we know the factorization by construction, and should be able to provide it.\n\n**CC:**  @slel\n\n**Keywords:** extension-field\n\n**Branch/Commit:** [8704bb9d9a4391b2487b7027668047997b73f9f4](https://github.com/sagemath/sagetrac-mirror/commit/8704bb9d9a4391b2487b7027668047997b73f9f4)\n\n**Reviewer:** Vincent Delecroix\n\n**Author:** Daira Hopwood, Samuel Leli\u00e8vre\n\nIssue created by migration from https://trac.sagemath.org/ticket/31686\n\n",
    "closed_at": "2021-06-06T13:17:52Z",
    "created_at": "2021-04-18T18:22:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20finite%20rings",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Speed up factoring finite field multiplicative order",
    "type": "issue",
    "updated_at": "2021-06-06T13:17:52Z",
    "url": "https://github.com/sagemath/sage/issues/31686",
    "user": "https://github.com/daira"
}
```
Initially asked at 

- [Ask Sage question 56710: Computing the factored multiplicative order of an extension field tries to solve an unnecessarily hard factoring problem](https://ask.sagemath.org/question/56710)

There seems to be a unnecessary performance problem with constructing large extension fields:

```python
sage: p = Integer('0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5'
....:             'cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001')
sage: GF(p^2)
```
This hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)

It is not unreasonable that constructing the extension field requires knowing the factorization of the multiplicative order. (You can get around this by constructing it with a specific modulus, but then many operations, e.g. taking roots, require this factorization anyway.)

However, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:

```python
sage: factor(p - 1)
2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097
* 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
sage: factor(p + 1)
2 * 313 * 751 * 2003 * 2671 * 738231097
* 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299
```
(this takes less than a second on my desktop).

In general, computing the multiplicative order of an extension field should take advantage of the factorization of p<sup>k</sup> - 1 as a polynomial. There might also be other cases where we know the factorization by construction, and should be able to provide it.

**CC:**  @slel

**Keywords:** extension-field

**Branch/Commit:** [8704bb9d9a4391b2487b7027668047997b73f9f4](https://github.com/sagemath/sagetrac-mirror/commit/8704bb9d9a4391b2487b7027668047997b73f9f4)

**Reviewer:** Vincent Delecroix

**Author:** Daira Hopwood, Samuel Leli√®vre

Issue created by migration from https://trac.sagemath.org/ticket/31686





---

archive/issue_events_284578.json:
```json
{
    "actor": "https://github.com/daira",
    "created_at": "2021-04-18T18:23:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284578"
}
```



---

archive/issue_events_284579.json:
```json
{
    "actor": "https://github.com/daira",
    "created_at": "2021-04-18T18:23:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "08517b",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284579"
}
```



---

archive/issue_comments_512401.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"extension-field\".",
    "created_at": "2021-04-18T18:23:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512401",
    "user": "https://github.com/daira"
}
```

**Changing keywords** from "" to "extension-field".



---

archive/issue_comments_512402.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis appears to work but obviously only addresses the simplest case:\n\n```\ndiff --git a/src/sage/rings/finite_rings/finite_field_base.pyx b/src/sage/rings/finite_rings/finite_field_base.pyx\nindex a4b396621f..6900035193 100644\n--- a/src/sage/rings/finite_rings/finite_field_base.pyx\n+++ b/src/sage/rings/finite_rings/finite_field_base.pyx\n@@ -23,6 +23,7 @@ AUTHORS:\n #       Copyright (C) 2012 Xavier Caruso <xavier.caruso@normalesup.org>\n #       Copyright (C) 2013 Peter Bruin <P.Bruin@warwick.ac.uk>\n #       Copyright (C) 2014 Julian Rueth <julian.rueth@fsfe.org>\n+#       Copyright (C) 2021 Daira Hopwood <daira@jacaranda.org>\n #\n #  Distributed under the terms of the GNU General Public License (GPL)\n #  as published by the Free Software Foundation; either version 2 of\n@@ -829,7 +830,11 @@ cdef class FiniteField(Field):\n             sage: GF(7^2,'a').factored_unit_order()\n             (2^4 * 3,)\n         \"\"\"\n-        F = (self.order() - 1).factor()\n+        if self.degree() == 2:\n+            p = self.characteristic()\n+            F = (p-1).factor() * (p+1).factor()\n+        else:\n+            F = (self.order() - 1).factor()\n         return (F,)\n \n     def cardinality(self):\n```",
    "created_at": "2021-04-18T18:49:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512402",
    "user": "https://github.com/daira"
}
```

<a id='comment:2'></a>
This appears to work but obviously only addresses the simplest case:

```
diff --git a/src/sage/rings/finite_rings/finite_field_base.pyx b/src/sage/rings/finite_rings/finite_field_base.pyx
index a4b396621f..6900035193 100644
--- a/src/sage/rings/finite_rings/finite_field_base.pyx
+++ b/src/sage/rings/finite_rings/finite_field_base.pyx
@@ -23,6 +23,7 @@ AUTHORS:
 #       Copyright (C) 2012 Xavier Caruso <xavier.caruso@normalesup.org>
 #       Copyright (C) 2013 Peter Bruin <P.Bruin@warwick.ac.uk>
 #       Copyright (C) 2014 Julian Rueth <julian.rueth@fsfe.org>
+#       Copyright (C) 2021 Daira Hopwood <daira@jacaranda.org>
 #
 #  Distributed under the terms of the GNU General Public License (GPL)
 #  as published by the Free Software Foundation; either version 2 of
@@ -829,7 +830,11 @@ cdef class FiniteField(Field):
             sage: GF(7^2,'a').factored_unit_order()
             (2^4 * 3,)
         """
-        F = (self.order() - 1).factor()
+        if self.degree() == 2:
+            p = self.characteristic()
+            F = (p-1).factor() * (p+1).factor()
+        else:
+            F = (self.order() - 1).factor()
         return (F,)
 
     def cardinality(self):
```



---

archive/issue_comments_512403.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,20 +2,22 @@\n \n There seems to be a unnecessary performance problem with constructing large extension fields:\n \n+```\n     sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\n     sage: GF(p^2)\n-\n+```\n This hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)\n \n It is not unreasonable that constructing the extension field requires knowing the factorization of the multiplicative order. (You can get around this by constructing it with a specific modulus, but then many operations, e.g. taking roots, require this factorization anyway.)\n \n However, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:\n \n+```\n     sage: factor(p-1)                                                                                                                                                  \n     2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\n     sage: factor(p+1)                                                                                                                                                  \n     2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299\n-\n+```\n (this takes less than a second on my desktop).\n \n In general, computing the multiplicative order of an extension field should take advantage of the factorization of p<sup>k</sup> - 1 as a polynomial. There might also be other cases where we know the factorization by construction, and should be able to provide it.\n``````\n",
    "created_at": "2021-04-18T18:51:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512403",
    "user": "https://github.com/daira"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,20 +2,22 @@
 
 There seems to be a unnecessary performance problem with constructing large extension fields:
 
+```
     sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
     sage: GF(p^2)
-
+```
 This hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)
 
 It is not unreasonable that constructing the extension field requires knowing the factorization of the multiplicative order. (You can get around this by constructing it with a specific modulus, but then many operations, e.g. taking roots, require this factorization anyway.)
 
 However, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:
 
+```
     sage: factor(p-1)                                                                                                                                                  
     2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
     sage: factor(p+1)                                                                                                                                                  
     2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299
-
+```
 (this takes less than a second on my desktop).
 
 In general, computing the multiplicative order of an extension field should take advantage of the factorization of p<sup>k</sup> - 1 as a polynomial. There might also be other cases where we know the factorization by construction, and should be able to provide it.
``````




---

archive/issue_comments_512404.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,8 +3,8 @@\n There seems to be a unnecessary performance problem with constructing large extension fields:\n \n ```\n-    sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\n-    sage: GF(p^2)\n+sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\n+sage: GF(p^2)\n ```\n This hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)\n \n@@ -13,10 +13,10 @@\n However, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:\n \n ```\n-    sage: factor(p-1)                                                                                                                                                  \n-    2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\n-    sage: factor(p+1)                                                                                                                                                  \n-    2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299\n+sage: factor(p-1)                                                                                                                                                  \n+2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\n+sage: factor(p+1)                                                                                                                                                  \n+2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299\n ```\n (this takes less than a second on my desktop).\n \n``````\n",
    "created_at": "2021-04-18T18:51:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512404",
    "user": "https://github.com/daira"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,8 +3,8 @@
 There seems to be a unnecessary performance problem with constructing large extension fields:
 
 ```
-    sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
-    sage: GF(p^2)
+sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
+sage: GF(p^2)
 ```
 This hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)
 
@@ -13,10 +13,10 @@
 However, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:
 
 ```
-    sage: factor(p-1)                                                                                                                                                  
-    2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
-    sage: factor(p+1)                                                                                                                                                  
-    2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299
+sage: factor(p-1)                                                                                                                                                  
+2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
+sage: factor(p+1)                                                                                                                                                  
+2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299
 ```
 (this takes less than a second on my desktop).
 
``````




---

archive/issue_comments_512405.json:
```json
{
    "body": "<a id='comment:5'></a>\nFor the general case, you can try along the lines:\n\n```\nfrom sage.structure.factorization import Factorization\np = self.characteristic()\nd = self.degree()\nx = polygen(ZZ)\nF = Factorization([(P(p).factor(), m) for P,m in (x^d-1).factor()]).expand()\n```\n\nNote that for small degrees, it might slow down things, so it might be worth benchmarking first.",
    "created_at": "2021-04-18T20:18:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512405",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:5'></a>
For the general case, you can try along the lines:

```
from sage.structure.factorization import Factorization
p = self.characteristic()
d = self.degree()
x = polygen(ZZ)
F = Factorization([(P(p).factor(), m) for P,m in (x^d-1).factor()]).expand()
```

Note that for small degrees, it might slow down things, so it might be worth benchmarking first.



---

archive/issue_events_284580.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-04-18T22:20:19Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "rename": {
        "from": "Computing the factored multiplicative order of an extension field tries to solve an unnecessarily hard factoring problem",
        "to": "Speed up factoring finite field multiplicative order"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284580"
}
```



---

archive/issue_events_284581.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-04-18T22:20:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "08517b",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284581"
}
```



---

archive/issue_events_284582.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-04-18T22:20:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20finite%20rings",
    "label_color": "08517b",
    "label_name": "component: finite rings",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284582"
}
```



---

archive/issue_comments_512406.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-(Initially asked at https://ask.sagemath.org/question/56710/computing-the-factored-multiplicative-order-of-an-extension-field-tries-to-solve-an-unnecessarily-hard-factoring-problem/ )\n+Initially asked at \n+\n+- [Ask Sage question 56710: Computing the factored multiplicative order of an extension field tries to solve an unnecessarily hard factoring problem](https://ask.sagemath.org/question/56710)\n \n There seems to be a unnecessary performance problem with constructing large extension fields:\n \n``````\n",
    "created_at": "2021-04-18T22:20:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512406",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-(Initially asked at https://ask.sagemath.org/question/56710/computing-the-factored-multiplicative-order-of-an-extension-field-tries-to-solve-an-unnecessarily-hard-factoring-problem/ )
+Initially asked at 
+
+- [Ask Sage question 56710: Computing the factored multiplicative order of an extension field tries to solve an unnecessarily hard factoring problem](https://ask.sagemath.org/question/56710)
 
 There seems to be a unnecessary performance problem with constructing large extension fields:
 
``````




---

archive/issue_comments_512407.json:
```json
{
    "body": "<a id='comment:7'></a>\nCould `cyclotomic_value` help?\n\n```diff\n- F = Factorization([(P(p).factor(), m) for P, m in (x^d - 1).factor()]).expand()\n+ F = Factorization([(cyclotomic_value(n, p).factor(), 1)\n+                    for n in d.divisors()]).expand()\n```",
    "created_at": "2021-04-18T22:35:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512407",
    "user": "https://github.com/slel"
}
```

<a id='comment:7'></a>
Could `cyclotomic_value` help?

```diff
- F = Factorization([(P(p).factor(), m) for P, m in (x^d - 1).factor()]).expand()
+ F = Factorization([(cyclotomic_value(n, p).factor(), 1)
+                    for n in d.divisors()]).expand()
```



---

archive/issue_comments_512408.json:
```json
{
    "body": "<a id='comment:8'></a>\nEDIT: I wrongly thought that the program hangs at factoring `p^2`... this comment is not much relevant to the ticket.\n\nTo my mind it is a mistake that `GF` takes as input `p^2` and not the pair `(p, 2)`. I would suggest to\n- rework the `FiniteFieldFactory` to also accept `Factorization`\n\n```\nsage: p = 17\nsage: q = Factorization([[p, 2]])\nsage: GF(q)\n```\n- tweak the sage preparser so that the `p^2` in `GF(p^2)` is converted to `GF(Factorization([This is the Trac macro *p,2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#p,2-macro)))`.",
    "created_at": "2021-04-19T20:37:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512408",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>
EDIT: I wrongly thought that the program hangs at factoring `p^2`... this comment is not much relevant to the ticket.

To my mind it is a mistake that `GF` takes as input `p^2` and not the pair `(p, 2)`. I would suggest to
- rework the `FiniteFieldFactory` to also accept `Factorization`

```
sage: p = 17
sage: q = Factorization([[p, 2]])
sage: GF(q)
```
- tweak the sage preparser so that the `p^2` in `GF(p^2)` is converted to `GF(Factorization([This is the Trac macro *p,2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#p,2-macro)))`.



---

archive/issue_comments_512409.json:
```json
{
    "body": "<a id='comment:9'></a>\nAnother example where taking advantage of the cyclotomic factorization does succeed with the proposed fix\n\n```\nsage: p = 1100585370631\nsage: GF(p^24)\nFinite Field in z24 of size 1100585370631^24\n```\n\nThis is a very nice proposal! Coud you submit a branch?",
    "created_at": "2021-04-20T17:53:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512409",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>
Another example where taking advantage of the cyclotomic factorization does succeed with the proposed fix

```
sage: p = 1100585370631
sage: GF(p^24)
Finite Field in z24 of size 1100585370631^24
```

This is a very nice proposal! Coud you submit a branch?



---

archive/issue_comments_512410.json:
```json
{
    "body": "<a id='comment:10'></a>\nPlease open a ticket to allow `GF((p, d))` instead of `GF(p^d)`.\n\nOf course figuring out the prime and degree \nwhen factoring the argument `q` of `GF(q)` as `p^d`\nis easier than factoring general composite numbers.\nStill it seems a waste that in `GF(p^d)` the prime power\nis computed only to then recover the prime and degree.",
    "created_at": "2021-04-20T23:36:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512410",
    "user": "https://github.com/slel"
}
```

<a id='comment:10'></a>
Please open a ticket to allow `GF((p, d))` instead of `GF(p^d)`.

Of course figuring out the prime and degree 
when factoring the argument `q` of `GF(q)` as `p^d`
is easier than factoring general composite numbers.
Still it seems a waste that in `GF(p^d)` the prime power
is computed only to then recover the prime and degree.



---

archive/issue_comments_512411.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [@slel](#comment%3A10):\n> Please open a ticket to allow `GF((p, d))` instead of `GF(p^d)`.\n> \n> Of course figuring out the prime and degree \n> when factoring the argument `q` of `GF(q)` as `p^d`\n> is easier than factoring general composite numbers.\n> Still it seems a waste that in `GF(p^d)` the prime power\n> is computed only to then recover the prime and degree.\n\nThis is #31709",
    "created_at": "2021-04-21T06:15:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512411",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>
Replying to [@slel](#comment%3A10):
> Please open a ticket to allow `GF((p, d))` instead of `GF(p^d)`.
> 
> Of course figuring out the prime and degree 
> when factoring the argument `q` of `GF(q)` as `p^d`
> is easier than factoring general composite numbers.
> Still it seems a waste that in `GF(p^d)` the prime power
> is computed only to then recover the prime and degree.

This is #31709



---

archive/issue_comments_512412.json:
```json
{
    "body": "<a id='comment:12'></a>\nRelated:\n\n- #31434: Default to random modulus for finite field creation",
    "created_at": "2021-04-21T09:38:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512412",
    "user": "https://github.com/slel"
}
```

<a id='comment:12'></a>
Related:

- #31434: Default to random modulus for finite field creation



---

archive/issue_comments_512413.json:
```json
{
    "body": "<a id='comment:13'></a>\nThe attached branch achieves the proposed goal of the ticket,\nunderstood as speeding up (and often allowing at all)\nfactoring the unit order of non-prime finite fields.\n\n```python\nsage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\nsage: F = GF(p^2, 'a')\nsage: F.factored_unit_order()\n(2^33 * 3^4 * 17 * 67 * 293 * 313 * 349 * 751\n * 1997 * 2003 * 2671 * 19556633 * 738231097 * 44179799701097\n * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\n * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299,)\n```\n\n```python\nsage: p = 1100585370631\nsage: F = GF(p^24, 'a')\nsage: F.factored_unit_order()\n(2^6 * 3^2 * 5 * 7 * 11 * 13 * 17 * 53 * 97 * 229 * 337 * 421\n * 3929 * 215417 * 249737 * 262519 * 397897 * 59825761 * 692192057\n * 12506651939 * 37553789761 * 46950147799 * 172462808473 * 434045140817\n * 81866093016401 * 617237859576697 * 659156729361017707\n * 268083135725348991493995910983015600019336657\n * 90433843562394341719266736354746485652016132372842876085423636587989263202299569913,)\n```\n\nFinding a pseudo-Conway polynomial still takes longer\nthan using a random irreducible polynommial, see #31434.\n\n```python\nsage: p = 1100585370631\nsage: %time F = GF(p^24, 'a')\nCPU times: user 120 ms, sys: 12.3 ms, total: 132 ms\nWall time: 170 ms\nsage: %time F = GF(p^24)\nCPU times: user 1.76 s, sys: 303 ms, total: 2.07 s\nWall time: 2.46 s\n```\n\n```python\nsage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\nsage: %time F = GF(p^2, 'a')\nCPU times: user 1.94 s, sys: 9.62 ms, total: 1.95 s\nWall time: 2.05 s\nsage: %time F = GF(p^2)\nCPU times: user 14.7 s, sys: 49.9 ms, total: 14.8 s\nWall time: 17.7 s\n```\n\nPlease review.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8704bb9d9a4391b2487b7027668047997b73f9f4\">8704bb9</a></td><td><code>31686: Use cyclotomics to factor finite field unit order</code></td></tr></table>\n",
    "created_at": "2021-04-21T12:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512413",
    "user": "https://github.com/slel"
}
```

<a id='comment:13'></a>
The attached branch achieves the proposed goal of the ticket,
understood as speeding up (and often allowing at all)
factoring the unit order of non-prime finite fields.

```python
sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
sage: F = GF(p^2, 'a')
sage: F.factored_unit_order()
(2^33 * 3^4 * 17 * 67 * 293 * 313 * 349 * 751
 * 1997 * 2003 * 2671 * 19556633 * 738231097 * 44179799701097
 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299,)
```

```python
sage: p = 1100585370631
sage: F = GF(p^24, 'a')
sage: F.factored_unit_order()
(2^6 * 3^2 * 5 * 7 * 11 * 13 * 17 * 53 * 97 * 229 * 337 * 421
 * 3929 * 215417 * 249737 * 262519 * 397897 * 59825761 * 692192057
 * 12506651939 * 37553789761 * 46950147799 * 172462808473 * 434045140817
 * 81866093016401 * 617237859576697 * 659156729361017707
 * 268083135725348991493995910983015600019336657
 * 90433843562394341719266736354746485652016132372842876085423636587989263202299569913,)
```

Finding a pseudo-Conway polynomial still takes longer
than using a random irreducible polynommial, see #31434.

```python
sage: p = 1100585370631
sage: %time F = GF(p^24, 'a')
CPU times: user 120 ms, sys: 12.3 ms, total: 132 ms
Wall time: 170 ms
sage: %time F = GF(p^24)
CPU times: user 1.76 s, sys: 303 ms, total: 2.07 s
Wall time: 2.46 s
```

```python
sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
sage: %time F = GF(p^2, 'a')
CPU times: user 1.94 s, sys: 9.62 ms, total: 1.95 s
Wall time: 2.05 s
sage: %time F = GF(p^2)
CPU times: user 14.7 s, sys: 49.9 ms, total: 14.8 s
Wall time: 17.7 s
```

Please review.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8704bb9d9a4391b2487b7027668047997b73f9f4">8704bb9</a></td><td><code>31686: Use cyclotomics to factor finite field unit order</code></td></tr></table>




---

archive/issue_comments_512414.json:
```json
{
    "body": "**Author:** Samuel Leli\u00e8vre",
    "created_at": "2021-04-21T12:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512414",
    "user": "https://github.com/slel"
}
```

**Author:** Samuel Leli√®vre



---

archive/issue_comments_512415.json:
```json
{
    "body": "**Branch:** [public/31686](https://github.com/sagemath/sagetrac-mirror/tree/public/31686)",
    "created_at": "2021-04-21T12:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512415",
    "user": "https://github.com/slel"
}
```

**Branch:** [public/31686](https://github.com/sagemath/sagetrac-mirror/tree/public/31686)



---

archive/issue_comments_512416.json:
```json
{
    "body": "**Commit:** [8704bb9d9a4391b2487b7027668047997b73f9f4](https://github.com/sagemath/sagetrac-mirror/commit/8704bb9d9a4391b2487b7027668047997b73f9f4)",
    "created_at": "2021-04-21T12:53:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512416",
    "user": "https://github.com/slel"
}
```

**Commit:** [8704bb9d9a4391b2487b7027668047997b73f9f4](https://github.com/sagemath/sagetrac-mirror/commit/8704bb9d9a4391b2487b7027668047997b73f9f4)



---

archive/issue_events_284583.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2021-04-21T12:53:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284583"
}
```



---

archive/issue_comments_512417.json:
```json
{
    "body": "<a id='comment:14'></a>\nSome questions and thoughts.\n\nI added a doctest in a `TESTS` block, should it be\nin `EXAMPLES` instead?\n\nI decided to only include a quick one, to keep\ndoctesting time under control.\n\nOptionally, the example from #31434 and the first\nexample from here could be added too.\n\nMaybe Flint, NTL, PARI, ... have code we could use\ninstead of rolling our own?\n\nShould `d == 1` and maybe `d == 2` be special-cased\nto avoid imports in those frequent cases?",
    "created_at": "2021-04-21T13:27:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512417",
    "user": "https://github.com/slel"
}
```

<a id='comment:14'></a>
Some questions and thoughts.

I added a doctest in a `TESTS` block, should it be
in `EXAMPLES` instead?

I decided to only include a quick one, to keep
doctesting time under control.

Optionally, the example from #31434 and the first
example from here could be added too.

Maybe Flint, NTL, PARI, ... have code we could use
instead of rolling our own?

Should `d == 1` and maybe `d == 2` be special-cased
to avoid imports in those frequent cases?



---

archive/issue_comments_512418.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [@slel](#comment%3A14):\n> Some questions and thoughts.\n> \n> I added a doctest in a `TESTS` block, should it be\n> in `EXAMPLES` instead?\n\n>\n> I decided to only include a quick one, to keep\n> doctesting time under control.\n\nI think this is a good habit.\n \n> Optionally, the example from #31434 and the first\n> example from here could be added too.\n\nIf it does not exceed a couple of seconds, why not.\n\n> Maybe Flint, NTL, PARI, ... have code we could use\n> instead of rolling our own?\n\nFor PARI/GP\n\nhttps://pari.math.u-bordeaux.fr/dochtml/html/Arithmetic_functions.html#se:ffprimroot\n\n> Should `d == 1` and maybe `d == 2` be special-cased\n> to avoid imports in those frequent cases?\n\nI would say yes if it makes a difference in timings.",
    "created_at": "2021-04-21T13:35:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512418",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>
Replying to [@slel](#comment%3A14):
> Some questions and thoughts.
> 
> I added a doctest in a `TESTS` block, should it be
> in `EXAMPLES` instead?

>
> I decided to only include a quick one, to keep
> doctesting time under control.

I think this is a good habit.
 
> Optionally, the example from #31434 and the first
> example from here could be added too.

If it does not exceed a couple of seconds, why not.

> Maybe Flint, NTL, PARI, ... have code we could use
> instead of rolling our own?

For PARI/GP

https://pari.math.u-bordeaux.fr/dochtml/html/Arithmetic_functions.html#se:ffprimroot

> Should `d == 1` and maybe `d == 2` be special-cased
> to avoid imports in those frequent cases?

I would say yes if it makes a difference in timings.



---

archive/issue_comments_512419.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe other suggestion that I'd add is to use `factor_cunningham` from `sage.rings.factorint` when `p < 12`.",
    "created_at": "2021-04-21T19:59:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512419",
    "user": "https://github.com/roed314"
}
```

<a id='comment:16'></a>
The other suggestion that I'd add is to use `factor_cunningham` from `sage.rings.factorint` when `p < 12`.



---

archive/issue_comments_512420.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [@roed314](#comment%3A16):\n> The other suggestion that I'd add is to use `factor_cunningham` from `sage.rings.factorint` when `p < 12`.\n\nThat might provide a speed up. But in its current state, the package is not usable \"optionally\" as it lacks a `Feature`, see #31715.",
    "created_at": "2021-04-22T13:10:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512420",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>
Replying to [@roed314](#comment%3A16):
> The other suggestion that I'd add is to use `factor_cunningham` from `sage.rings.factorint` when `p < 12`.

That might provide a speed up. But in its current state, the package is not usable "optionally" as it lacks a `Feature`, see #31715.



---

archive/issue_comments_512421.json:
```json
{
    "body": "<a id='comment:18'></a>\nI did not notice any significant speed up by short cutting `d=1` or `d=2`. This ticket provides a great improvement!",
    "created_at": "2021-04-22T13:13:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512421",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>
I did not notice any significant speed up by short cutting `d=1` or `d=2`. This ticket provides a great improvement!



---

archive/issue_comments_512422.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2021-04-22T13:13:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512422",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_events_284584.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-22T13:13:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284584"
}
```



---

archive/issue_events_284585.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2021-04-22T13:13:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284585"
}
```



---

archive/issue_comments_512423.json:
```json
{
    "body": "<a id='comment:19'></a>\nPlease `@`gh-daira add your full name in the author field.",
    "created_at": "2021-04-22T13:34:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512423",
    "user": "https://github.com/slel"
}
```

<a id='comment:19'></a>
Please `@`gh-daira add your full name in the author field.



---

archive/issue_comments_512424.json:
```json
{
    "body": "**Changing author** from \"Samuel Leli\u00e8vre\" to \"Daira Hopwood, Samuel Leli\u00e8vre\".",
    "created_at": "2021-04-22T13:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512424",
    "user": "https://github.com/videlec"
}
```

**Changing author** from "Samuel Leli√®vre" to "Daira Hopwood, Samuel Leli√®vre".



---

archive/issue_comments_512425.json:
```json
{
    "body": "<a id='comment:21'></a>\n(from https://github.com/daira)",
    "created_at": "2021-04-22T13:42:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512425",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>
(from https://github.com/daira)



---

archive/issue_comments_512426.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,8 +4,9 @@\n \n There seems to be a unnecessary performance problem with constructing large extension fields:\n \n-```\n-sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001\n+```python\n+sage: p = Integer('0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5'\n+....:             'cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001')\n sage: GF(p^2)\n ```\n This hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)\n@@ -14,11 +15,13 @@\n \n However, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:\n \n-```\n-sage: factor(p-1)                                                                                                                                                  \n-2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\n-sage: factor(p+1)                                                                                                                                                  \n-2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299\n+```python\n+sage: factor(p - 1)\n+2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097\n+* 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877\n+sage: factor(p + 1)\n+2 * 313 * 751 * 2003 * 2671 * 738231097\n+* 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299\n ```\n (this takes less than a second on my desktop).\n \n``````\n",
    "created_at": "2021-04-25T11:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512426",
    "user": "https://github.com/slel"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,8 +4,9 @@
 
 There seems to be a unnecessary performance problem with constructing large extension fields:
 
-```
-sage: p = 0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001
+```python
+sage: p = Integer('0x24000000000024000130e0000d7f70e4a803ca76f439266f443f9a5'
+....:             'cda8a6c7be4a7a5fe8fadffd6a2a7e8c30006b9459ffffcd300000001')
 sage: GF(p^2)
 ```
 This hangs trying to factor the 891-bit integer p<sup>2</sup> - 1, which is longer than the longest solved RSA Challenge number. (As it happens, the hard part of this factorization is a 675-bit integer which is still impractical.)
@@ -14,11 +15,13 @@
 
 However, we know that p<sup>2</sup> - 1 splits as (p-1)(p+1), and factoring those may be much more feasible:
 
-```
-sage: factor(p-1)                                                                                                                                                  
-2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097 * 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
-sage: factor(p+1)                                                                                                                                                  
-2 * 313 * 751 * 2003 * 2671 * 738231097 * 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299
+```python
+sage: factor(p - 1)
+2^32 * 3^4 * 17 * 67 * 293 * 349 * 1997 * 19556633 * 44179799701097
+* 1461985442088199434216480729118540833655826472878315075486478169293801719414121837587283877
+sage: factor(p + 1)
+2 * 313 * 751 * 2003 * 2671 * 738231097
+* 55047696457335561580180364861378466840614260303507426009866606293225963076275651294902969015038913167956483928299
 ```
 (this takes less than a second on my desktop).
 
``````




---

archive/issue_comments_512427.json:
```json
{
    "body": "<a id='comment:23'></a>\nYes that's my name. Thankyou all for being so responsive to this ticket! :-)",
    "created_at": "2021-04-26T23:16:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512427",
    "user": "https://github.com/daira"
}
```

<a id='comment:23'></a>
Yes that's my name. Thankyou all for being so responsive to this ticket! :-)



---

archive/issue_events_284586.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-06-06T13:17:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284586"
}
```



---

archive/issue_events_284587.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "e30645c0554f2d537c79cea22ab14ce316a25054",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2021-06-06T13:17:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/31686#event-284587"
}
```



---

archive/issue_comments_512428.json:
```json
{
    "body": "**Changing branch** from \"[public/31686](https://github.com/sagemath/sagetrac-mirror/tree/public/31686)\" to \"[8704bb9d9a4391b2487b7027668047997b73f9f4](https://github.com/sagemath/sagetrac-mirror/commit/8704bb9d9a4391b2487b7027668047997b73f9f4)\".",
    "created_at": "2021-06-06T13:17:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/31686",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/31686#issuecomment-512428",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/31686](https://github.com/sagemath/sagetrac-mirror/tree/public/31686)" to "[8704bb9d9a4391b2487b7027668047997b73f9f4](https://github.com/sagemath/sagetrac-mirror/commit/8704bb9d9a4391b2487b7027668047997b73f9f4)".
